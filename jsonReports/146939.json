{"id":146939,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNDY5Mzk=","url":"https://hackerone.com/reports/146939","title":"DOM XSS в /activation.php?act=activate_mobile","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-06-24T04:12:59.876Z","submitted_at":"2016-06-24T04:12:59.876Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"abr1k0s","url":"/abr1k0s","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/019/444/d02d95b154076b11334a0a390542afc3c6365dad_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1254,"url":"https://hackerone.com/vkcom","handle":"vkcom","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/254/4d3964b90290d02f3b41d23a1452c08ca77eec3e_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/254/4d3964b90290d02f3b41d23a1452c08ca77eec3e_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"VK.com","twitter_handle":"vkontakte","website":"https://vk.com","about":"VK is the largest European social network with more than a 100 million active users."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2016-09-22T21:11:41.578Z","bug_reporter_agreed_on_going_public_at":"2016-08-23T21:11:35.777Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Поинтересовался тут функцией showOrderBox в API. Увидел там \"Тестовое спецпредложение. Тестовое спецпредложение для разработчиков приложений.\"\nПри щелчке по кнопке \"перейти в группу\" попал на страницу /activation.php?act=activate_mobile\u0026hash=мой_хэш\u0026return=%2Foffersdesk%3Fact%3Dstart_offer%26offer_id%3D1237%26hash%3D17634e2103b0a99782%26test_mode%3D1%26aid%3D4846993%26app_currency%3D0%26from%3\n\nОбратил внимание на параметр return. Увидел, что значение попадает в вывод страницы, предоставляя возможность осуществить xss атаку.\n\nСформировал следующую ссылку:\n/activation.php?act=activate_mobile\u0026hash=мой_хэш\u0026return=javascript:alert(1);//offersdesk%3Fact%3Dstart_offer%26offer_id%3D1237%26hash%3D17634e2103b0a99782%26test_mode%3D1%26aid%3D4846993%26app_currency%3D0%26from%3\n\nПолучил alert при вводе в поле ввода правильного кода из смс.\n\nФрагмент уязвимого кода js: \n    params = {code: code, hash: 'a0096404730f329021'};\n    callback = function(t) {\n      if (t) {\n        cur.phoneValidationMsg(t);\n        return stop();\n      }\n      document.location = winToUtf('javascript:alert(1);//offersdesk?act=start_offer\u0026amp;offer_id=1237\u0026amp;hash=17634e2103b0a99782\u0026amp;aid=4846993\u0026amp;app_currency=0\u0026amp;from=');\n    }","vulnerability_information_html":"\u003cp\u003eПоинтересовался тут функцией showOrderBox в API. Увидел там \u0026quot;Тестовое спецпредложение. Тестовое спецпредложение для разработчиков приложений.\u0026quot;\u003cbr\u003e\nПри щелчке по кнопке \u0026quot;перейти в группу\u0026quot; попал на страницу /activation.php?act=activate_mobile\u0026amp;hash=мой_хэш\u0026amp;return=%2Foffersdesk%3Fact%3Dstart_offer%26offer_id%3D1237%26hash%3D17634e2103b0a99782%26test_mode%3D1%26aid%3D4846993%26app_currency%3D0%26from%3\u003c/p\u003e\n\n\u003cp\u003eОбратил внимание на параметр return. Увидел, что значение попадает в вывод страницы, предоставляя возможность осуществить xss атаку.\u003c/p\u003e\n\n\u003cp\u003eСформировал следующую ссылку:\u003cbr\u003e\n/activation.php?act=activate_mobile\u0026amp;hash=мой_хэш\u0026amp;return=javascript:alert(1);//offersdesk%3Fact%3Dstart_offer%26offer_id%3D1237%26hash%3D17634e2103b0a99782%26test_mode%3D1%26aid%3D4846993%26app_currency%3D0%26from%3\u003c/p\u003e\n\n\u003cp\u003eПолучил alert при вводе в поле ввода правильного кода из смс.\u003c/p\u003e\n\n\u003cp\u003eФрагмент уязвимого кода js: \u003cbr\u003e\n    params = {code: code, hash: \u0026#39;a0096404730f329021\u0026#39;};\u003cbr\u003e\n    callback = function(t) {\u003cbr\u003e\n      if (t) {\u003cbr\u003e\n        cur.phoneValidationMsg(t);\u003cbr\u003e\n        return stop();\u003cbr\u003e\n      }\u003cbr\u003e\n      document.location = winToUtf(\u0026#39;javascript:alert(1);//offersdesk?act=start_offer\u0026amp;offer_id=1237\u0026amp;hash=17634e2103b0a99782\u0026amp;aid=4846993\u0026amp;app_currency=0\u0026amp;from=\u0026#39;);\u003cbr\u003e\n    }\u003c/p\u003e\n","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2016-09-22T21:11:35.826Z","allow_singular_disclosure_after":-134637581.18485937,"singular_disclosure_allowed":true,"vote_count":5,"voters":["mdv","kunal94","jens","spetr0x","dyabla"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1037314,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Скриншоты","markdown_message":"\u003cp\u003eСкриншоты\u003c/p\u003e\n","automated_response":false,"created_at":"2016-06-25T21:33:45.730Z","updated_at":"2016-06-25T21:33:45.730Z","actor":{"username":"abr1k0s","cleared":false,"url":"/abr1k0s","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/444/d02d95b154076b11334a0a390542afc3c6365dad_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":101647,"filename":"xss_phone_sms.jpg","type":"image/jpeg","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/101/647/27475225e4a26da9c3bc32883df84a50869a84d1/xss_phone_sms.jpg?response-content-disposition=attachment%3B%20filename%3D%22xss_phone_sms.jpg%22%3B%20filename%2A%3DUTF-8%27%27xss_phone_sms.jpg\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQTGH7D7G4%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T043117Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIF3bZwIuJVbBath9RBAagycfg6N290U9MaBDwIhhNMqjAiEA5QJFTUjUu%2BelINQ8mBSRMtPAJunx%2FkQdIQYoGvxoAn0qtAMIVRABGgwwMTM2MTkyNzQ4NDkiDKWCtAdrSoxlUzEo5CqRA2KbCK2gb0cQjXvMxG7rxH%2BqkR2WSbvaIs%2FZazFNKw1eZW2WrZTy5Q04uSJp6R8rbsBzRSLIFhyP9QTQMq5P15qLdwXnZbOxNVoADzWwgfUfGt%2BOwI%2BEjM3ovXNd1aGU0Ee1TBGk3LBN3uQ8ppV7Xii57PrmCtM4dm9usXbAaaa8f8QiQFPH1YTkHf%2FPe1cgMlFNJFqSrmu3ZMinUb9pxpphywkYT29wP%2Fak4Sy9A3St63iqnDzi8wrdG9%2FGdB7M03pSeaVTcH99G5j%2FqMpFpJxYN8TNlglA1OWgt7QlVOqnq65zCp4szGmwzF1FrjkS%2Bp3wB27lGxlw0v79ozRdwRBFBFvrSgSeToK8vpEBIlnO4uogSsVneM6zoYfyQw3%2F6HqcPg9mVWJmJS4QLMpQTMd%2FMeYn%2F%2Ffl2Vt%2Bb0X2rNtQPeWMGpzHpq6XAiCjZ%2F33fJuN%2B3j9Lmo023GSXKu%2B%2FkZTBp3waVREDqE%2BNeB30X8ZT5%2BW0bqtpGbJe8ig5jtSZzprCWg9v84Utvz3uaa%2Bcjz7MJPPqv8FOusBEHCYkRstnRk5lzIXoX3CRWjAJcL61b1gmhmecG%2Fow23IgJkGaQ5%2B%2FkCWvGrt4rLn9BlUKR84X6ifbCLPwMQevITvtVqg1wdT%2FzOjUyHnqnZVOyLFoqLXk9MNjw1VTb%2FmSNp%2Bd5NsBD5KiAAd50U1%2F1jl5yoSrl0DpEi6Yzv0bFigmUQPNRZeTImBJ2V75RxXBbDSoevWuBT70W%2F8%2BsoyTMqti7McilmsidA1BnI1f8HDTyMQGIoexlo%2BO7e5AiNtCUboKL2ZiertWXe5cEVF9mAVgHpVtz7pIIElyyZjsKslJzP%2B5WRhYUkMYg%3D%3D\u0026X-Amz-Signature=9876c4b06daf5ebb7f4648a293fc781fcaa9cc8e4c9b4ca6e398b5f0c436d996"},{"id":101646,"filename":"xss_phone_sms2.jpg","type":"image/jpeg","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/101/646/ad4f938a8430ef646c2055391a3b930f2d96426b/xss_phone_sms2.jpg?response-content-disposition=attachment%3B%20filename%3D%22xss_phone_sms2.jpg%22%3B%20filename%2A%3DUTF-8%27%27xss_phone_sms2.jpg\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQTGH7D7G4%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T043117Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIF3bZwIuJVbBath9RBAagycfg6N290U9MaBDwIhhNMqjAiEA5QJFTUjUu%2BelINQ8mBSRMtPAJunx%2FkQdIQYoGvxoAn0qtAMIVRABGgwwMTM2MTkyNzQ4NDkiDKWCtAdrSoxlUzEo5CqRA2KbCK2gb0cQjXvMxG7rxH%2BqkR2WSbvaIs%2FZazFNKw1eZW2WrZTy5Q04uSJp6R8rbsBzRSLIFhyP9QTQMq5P15qLdwXnZbOxNVoADzWwgfUfGt%2BOwI%2BEjM3ovXNd1aGU0Ee1TBGk3LBN3uQ8ppV7Xii57PrmCtM4dm9usXbAaaa8f8QiQFPH1YTkHf%2FPe1cgMlFNJFqSrmu3ZMinUb9pxpphywkYT29wP%2Fak4Sy9A3St63iqnDzi8wrdG9%2FGdB7M03pSeaVTcH99G5j%2FqMpFpJxYN8TNlglA1OWgt7QlVOqnq65zCp4szGmwzF1FrjkS%2Bp3wB27lGxlw0v79ozRdwRBFBFvrSgSeToK8vpEBIlnO4uogSsVneM6zoYfyQw3%2F6HqcPg9mVWJmJS4QLMpQTMd%2FMeYn%2F%2Ffl2Vt%2Bb0X2rNtQPeWMGpzHpq6XAiCjZ%2F33fJuN%2B3j9Lmo023GSXKu%2B%2FkZTBp3waVREDqE%2BNeB30X8ZT5%2BW0bqtpGbJe8ig5jtSZzprCWg9v84Utvz3uaa%2Bcjz7MJPPqv8FOusBEHCYkRstnRk5lzIXoX3CRWjAJcL61b1gmhmecG%2Fow23IgJkGaQ5%2B%2FkCWvGrt4rLn9BlUKR84X6ifbCLPwMQevITvtVqg1wdT%2FzOjUyHnqnZVOyLFoqLXk9MNjw1VTb%2FmSNp%2Bd5NsBD5KiAAd50U1%2F1jl5yoSrl0DpEi6Yzv0bFigmUQPNRZeTImBJ2V75RxXBbDSoevWuBT70W%2F8%2BsoyTMqti7McilmsidA1BnI1f8HDTyMQGIoexlo%2BO7e5AiNtCUboKL2ZiertWXe5cEVF9mAVgHpVtz7pIIElyyZjsKslJzP%2B5WRhYUkMYg%3D%3D\u0026X-Amz-Signature=d246f2efaef55a65d2396c666d9499b43263bcc398bbf99027f5b08c1c29fd64"}],"genius_execution_id":null,"team_handle":"vkcom","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1041912,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Здравствуйте! \n\nСпасибо за репорт. Мы его исследуем и сообщим Вам о результатах.","markdown_message":"\u003cp\u003eЗдравствуйте! \u003c/p\u003e\n\n\u003cp\u003eСпасибо за репорт. Мы его исследуем и сообщим Вам о результатах.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-06-27T22:53:01.131Z","updated_at":"2016-06-27T22:53:01.131Z","actor":{"username":"exe","cleared":false,"url":"/exe","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/058/768/cb3119e614f25ed716db2258fd649c2cd62b29b1_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vkcom","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1065415,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Добрый день. Есть какие-нибудь новости по баге?","markdown_message":"\u003cp\u003eДобрый день. Есть какие-нибудь новости по баге?\u003c/p\u003e\n","automated_response":false,"created_at":"2016-07-12T16:36:14.856Z","updated_at":"2016-07-12T16:36:14.856Z","actor":{"username":"abr1k0s","cleared":false,"url":"/abr1k0s","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/444/d02d95b154076b11334a0a390542afc3c6365dad_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vkcom","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1073787,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Починили, проверьте, пожалуйста.","markdown_message":"\u003cp\u003eПочинили, проверьте, пожалуйста.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-07-18T13:35:59.005Z","updated_at":"2016-07-18T13:35:59.005Z","actor":{"username":"explain","cleared":false,"url":"/explain","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/032/882/761056f842561692c2498887a441edfc6c013044_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"abr1k0s","url":"/abr1k0s"},"genius_execution_id":null,"team_handle":"vkcom","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1078131,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"На данный момент я больше не могу воспроизвести уязвимость. Все ок.","markdown_message":"\u003cp\u003eНа данный момент я больше не могу воспроизвести уязвимость. Все ок.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-07-20T14:58:10.439Z","updated_at":"2016-07-20T14:58:10.439Z","actor":{"username":"abr1k0s","cleared":false,"url":"/abr1k0s","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/444/d02d95b154076b11334a0a390542afc3c6365dad_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vkcom","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1150262,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"Спасибо за репорт, но это self-xss.","markdown_message":"\u003cp\u003eСпасибо за репорт, но это self-xss.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-23T21:08:53.684Z","updated_at":"2016-08-23T21:08:53.684Z","actor":{"url":"/vkcom","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/254/4d3964b90290d02f3b41d23a1452c08ca77eec3e_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"VK.com"}},"genius_execution_id":null,"team_handle":"vkcom","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1150272,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-08-23T21:11:35.803Z","updated_at":"2016-08-23T21:11:35.803Z","first_to_agree":true,"actor":{"username":"abr1k0s","cleared":false,"url":"/abr1k0s","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/444/d02d95b154076b11334a0a390542afc3c6365dad_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vkcom","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1211642,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-09-22T21:11:41.664Z","updated_at":"2016-09-22T21:11:41.664Z","actor":{"url":"/vkcom","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/254/4d3964b90290d02f3b41d23a1452c08ca77eec3e_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"VK.com"}},"genius_execution_id":null,"team_handle":"vkcom","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}