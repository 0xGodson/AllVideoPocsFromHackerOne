{"id":104931,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMDQ5MzE=","url":"https://hackerone.com/reports/104931","title":"CSRF in Connecting Pinterest Account","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2015-12-13T12:01:43.918Z","submitted_at":"2015-12-13T12:01:43.918Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"mercurii","url":"/mercurii","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1382,"url":"https://hackerone.com/shopify","handle":"shopify","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Shopify","twitter_handle":"","website":"https://www.shopify.com","about":"Shopify is a multi-channel commerce platform that helps people sell online, in-store, and everywhere in between."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2016-02-02T15:23:50.884Z","bug_reporter_agreed_on_going_public_at":"2016-02-02T15:23:50.678Z","team_member_agreed_on_going_public_at":"2016-02-02T15:14:01.256Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi,\n\nThe connect to Pinterest function is vulnerable to CSRF. This allows an attacker to connect his/her pinterest account to the victim's shopify. Even if the victim has already connected a pinterest account, this will allow the attacker to replace the existing connected pinterest account with the attacker's own pinterest account.\n\n\n#PoC\nNote: I have also attached screenshots showing each step\n1. Victim(mshop2-2) already has Pinterest account connected.\n2. Attacker(mshop3-2) doesn't have Pinterest account connected and attempts to connect a Pinterest account.\n3. Attacker authorize the shopify app to connect to his Pinterest account.\n4. Attacker intercepts the redirection back to `pinterest-commerce.shopifyapps.com` and drop the request. Attacker also captures the URL, e.g. `https://pinterest-commerce.shopifyapps.com/auth/pinterest/callback?code=d0c18854a3359866774d479614081453d235962f`\n5. Attacker induces Victim to load the above captured URL. \n6. Victim's connected Pinterest account has been replaced with the attacker's Pinterest account.\n\n#Possible Fixes\n* Make use of the state parameter in OAuth, which is used to prevent CSRF, when connecting to Pinterest.","vulnerability_information_html":"\u003cp\u003eHi,\u003c/p\u003e\n\n\u003cp\u003eThe connect to Pinterest function is vulnerable to CSRF. This allows an attacker to connect his/her pinterest account to the victim\u0026#39;s shopify. Even if the victim has already connected a pinterest account, this will allow the attacker to replace the existing connected pinterest account with the attacker\u0026#39;s own pinterest account.\u003c/p\u003e\n\n\u003ch1 id=\"poc\"\u003ePoC\u003c/h1\u003e\n\n\u003cp\u003eNote: I have also attached screenshots showing each step\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eVictim(mshop2-2) already has Pinterest account connected.\u003c/li\u003e\n\u003cli\u003eAttacker(mshop3-2) doesn\u0026#39;t have Pinterest account connected and attempts to connect a Pinterest account.\u003c/li\u003e\n\u003cli\u003eAttacker authorize the shopify app to connect to his Pinterest account.\u003c/li\u003e\n\u003cli\u003eAttacker intercepts the redirection back to \u003ccode\u003epinterest-commerce.shopifyapps.com\u003c/code\u003e and drop the request. Attacker also captures the URL, e.g. \u003ccode\u003ehttps://pinterest-commerce.shopifyapps.com/auth/pinterest/callback?code=d0c18854a3359866774d479614081453d235962f\u003c/code\u003e\n\u003c/li\u003e\n\u003cli\u003eAttacker induces Victim to load the above captured URL. \u003c/li\u003e\n\u003cli\u003eVictim\u0026#39;s connected Pinterest account has been replaced with the attacker\u0026#39;s Pinterest account.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003ch1 id=\"possible-fixes\"\u003ePossible Fixes\u003c/h1\u003e\n\n\u003cul\u003e\n\u003cli\u003eMake use of the state parameter in OAuth, which is used to prevent CSRF, when connecting to Pinterest.\u003c/li\u003e\n\u003c/ul\u003e\n","bounty_amount":"500.0","formatted_bounty":"$500","weakness":{"id":45,"name":"Cross-Site Request Forgery (CSRF)"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":65333,"file_name":"CSRF_Pinterest.zip","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/065/333/1968660331c43452452995f27356b7e96f506072/CSRF_Pinterest.zip?response-content-disposition=attachment%3B%20filename%3D%22CSRF_Pinterest.zip%22%3B%20filename%2A%3DUTF-8%27%27CSRF_Pinterest.zip\u0026response-content-type=application%2Fzip\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ3ORU3ZNE%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T041355Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIBDRduU%2FQiKN2Hy3Cc%2BFdvYldnR%2BI9yQ0JWu5Nd0q2n7AiBT09NYT9NM%2FNa1T7X7mPFfQEFunNsAbPoVngTqyDCvlCq0AwhSEAEaDDAxMzYxOTI3NDg0OSIMjho0%2F2dG4425KWNaKpEDfRP2JVIKEZKe%2Fu1DRJDnMt1hodmiYRHSHxVJXvZvnhQp68RTbgsA5dtRAFzhCl2p7oJWn2DfsUhN61oqH1cme2ydNbTr6cDG5AkVoiUMnjHvkMPTgbPahrduPs%2FdXuwFoyZMuPeBtzUlpjssIk0BfcIUtph2FGwzCuy6d0CQhdl914kkFpuTBp69z2htWslZiifdNkKWK0DIJcK%2FrSurcsk8WEaPiZ7tEJAcfYZS4SddR8orMY%2BhEfGsLc5RSVBGXY0UW6zTNw%2BYg82wPCY1Z9kgrjwVLQPpVTje3rfzRO3UEDh0xbd54m7t%2FSL0yItTAuaGshQmPLuW6S%2F5KOdoWWnwCmkruRqE1ZKMsnSko5gBnNELay%2BWeukQAQ6EyIB%2FWB06%2F%2FaYfBiWUzjgZyKRGg99IBpEO3zShFTod3huOdptlvO4PfWBvrB4632o9feKKn5CXqJUOE%2BTT%2BgjHEdWRLP2W3GZAibuc%2FbOIfOwee7%2Bn9cOimwp8NVS4U08VlgiSfhcWXonWb3aOkvnOfX46QkwoP6p%2FwU67AFSjWFI11fWgLkInKyx6Dx9AePw1c4qVefioOdfVonnQ3dNW7fXwjlRC5F1185jkAwhyCARy9%2F7sIPFHaI%2FEID5osYCwdvVwv0O6pPIknWS%2FVG7rXxUIgYk0xp3ln2eURcIkz%2F20YEsL73kMrgQLn%2BEd3AiGH%2F9wW5PEZOVPNqagqBYtUSWzNl9%2BrKCkhyVg8k79SdRjUkvdYLXtvxU1m6oAu2IjxFOCgwXqn1jFH1Lloh4Gp%2Fkq68ckYZB67%2B%2FdOzejM9ofYNi%2BpJRLwSwwu22w857sj9E%2BbC8Ei9i7KZOZGBCWe81d9lycwAH6Q%3D%3D\u0026X-Amz-Signature=5c67ce97f552ad2a5cad3916f426a04cdbc4bd193583a15ee20ebccd82d20c23","file_size":386199,"type":"application/zip"}],"allow_singular_disclosure_at":"2016-03-03T15:14:01.423Z","allow_singular_disclosure_after":-152197193.82481843,"singular_disclosure_allowed":true,"vote_count":1,"voters":["ahmed_abdalla"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":718760,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you for reporting this bug! This is an automated response to let you know that we've received your issue, and we'll process it as soon as possible.\r\n\r\nOur team is busy triaging and fixing HackerOne reports, and it may take us up to 1 week (or more) to triage any given issue. Don't worry, we'll get to yours!\r\n\r\nWhile you are waiting, you can read over our list of non applicable issues listed on our program page: https://hackerone.com/shopify. Make sure your issue isn't listed!","markdown_message":"\u003cp\u003eThank you for reporting this bug! This is an automated response to let you know that we\u0026#39;ve received your issue, and we\u0026#39;ll process it as soon as possible.\u003c/p\u003e\n\n\u003cp\u003eOur team is busy triaging and fixing HackerOne reports, and it may take us up to 1 week (or more) to triage any given issue. Don\u0026#39;t worry, we\u0026#39;ll get to yours!\u003c/p\u003e\n\n\u003cp\u003eWhile you are waiting, you can read over our list of non applicable issues listed on our program page: \u003ca title=\"https://hackerone.com/shopify\" href=\"https://hackerone.com/shopify\"\u003ehttps://hackerone.com/shopify\u003c/a\u003e. Make sure your issue isn\u0026#39;t listed!\u003c/p\u003e\n","automated_response":true,"created_at":"2015-12-13T12:01:44.701Z","updated_at":"2015-12-13T12:01:44.701Z","actor":{"url":"/shopify","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Shopify"}},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":719661,"is_internal":false,"editable":false,"type":"Activities::BugDuplicate","message":"Thank you for your report. This issue was already known to our security team, and we are working on a fix.","markdown_message":"\u003cp\u003eThank you for your report. This issue was already known to our security team, and we are working on a fix.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-12-14T16:24:23.787Z","updated_at":"2015-12-14T16:24:23.787Z","actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":780576,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi,\n\nReferring to this recently disclosed report: https://hackerone.com/reports/111218\n\nIn this report, I've reported the same issue on 13/12/2015 and it was marked as duplicate.\n\nHowever, in the above disclosed report. The issue was reported on 17/1/2016 and got marked as valid.\n\nCan you please re-check on why my report was marked as duplicate and the disclosed report marked as valid?","markdown_message":"\u003cp\u003eHi,\u003c/p\u003e\n\n\u003cp\u003eReferring to this recently disclosed report: \u003ca title=\"https://hackerone.com/reports/111218\" href=\"https://hackerone.com/reports/111218\"\u003ehttps://hackerone.com/reports/111218\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eIn this report, I\u0026#39;ve reported the same issue on 13/12/2015 and it was marked as duplicate.\u003c/p\u003e\n\n\u003cp\u003eHowever, in the above disclosed report. The issue was reported on 17/1/2016 and got marked as valid.\u003c/p\u003e\n\n\u003cp\u003eCan you please re-check on why my report was marked as duplicate and the disclosed report marked as valid?\u003c/p\u003e\n","automated_response":false,"created_at":"2016-02-02T05:41:04.814Z","updated_at":"2016-02-02T05:41:04.814Z","actor":{"username":"mercurii","cleared":true,"url":"/mercurii","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":781169,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@ke_ We may have made a mistake when triaging your issue. We'll look into it and get back to you.","markdown_message":"\u003cp\u003e\u003ca href=\"/ke_\"\u003e@ke_\u003c/a\u003e We may have made a mistake when triaging your issue. We\u0026#39;ll look into it and get back to you.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-02-02T14:46:59.285Z","updated_at":"2016-02-02T14:46:59.285Z","actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":781220,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"@ke_ Sorry about that. Upon further review, you were actually the first to report this issue, so we will award you a bounty for your report. Thanks for raising that with us.","markdown_message":"\u003cp\u003e\u003ca href=\"/ke_\"\u003e@ke_\u003c/a\u003e Sorry about that. Upon further review, you were actually the first to report this issue, so we will award you a bounty for your report. Thanks for raising that with us.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-02-02T15:13:14.829Z","updated_at":"2016-02-02T15:13:14.829Z","actor":{"url":"/shopify","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Shopify"}},"bounty_amount":"500.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"shopify","collaborator":{"username":"mercurii","url":"/mercurii"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":781221,"is_internal":false,"editable":false,"type":"Activities::BugReopened","message":"","markdown_message":"","automated_response":false,"created_at":"2016-02-02T15:13:43.264Z","updated_at":"2016-02-02T15:13:43.264Z","actor":{"username":"andrewdunbar","cleared":false,"url":"/andrewdunbar","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/164/5b0e89675ed6dbb9df87223e9f8f58e2125bb56b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":781222,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2016-02-02T15:13:51.406Z","updated_at":"2016-02-02T15:13:51.406Z","actor":{"username":"andrewdunbar","cleared":false,"url":"/andrewdunbar","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/164/5b0e89675ed6dbb9df87223e9f8f58e2125bb56b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"mercurii","url":"/mercurii"},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":781224,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-02-02T15:14:01.281Z","updated_at":"2016-02-02T15:14:01.281Z","first_to_agree":true,"actor":{"username":"andrewdunbar","cleared":false,"url":"/andrewdunbar","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/164/5b0e89675ed6dbb9df87223e9f8f58e2125bb56b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":781235,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-02-02T15:23:50.710Z","updated_at":"2016-02-02T15:23:50.710Z","actor":{"username":"mercurii","cleared":true,"url":"/mercurii","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":781236,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-02-02T15:23:50.911Z","updated_at":"2016-02-02T15:23:50.911Z","actor":{"username":"mercurii","cleared":true,"url":"/mercurii","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}