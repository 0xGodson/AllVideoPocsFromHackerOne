{"id":150586,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNTA1ODY=","url":"https://hackerone.com/reports/150586","title":"CSRF in account configuration leads to complete account compromise","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-07-11T12:50:34.703Z","submitted_at":"2016-07-11T12:50:34.703Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"cablej","url":"/cablej","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/042/859/7fdafea90092a305ae2cb6cec7d43461783abf0c_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":8146,"url":"https://hackerone.com/olx","handle":"olx","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/008/146/07ffc7e779ee301e61da60eda7f2bd862a7082ca_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/146/07ffc7e779ee301e61da60eda7f2bd862a7082ca_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"paused","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"OLX","twitter_handle":"OLX","website":"http://olx.com","about":"OLX is an online classifieds platform that enables its users to create ads and display them on social networks."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2016-10-05T14:08:02.297Z","bug_reporter_agreed_on_going_public_at":"2016-09-05T14:07:58.492Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hello,\n\nAlthough listed as out of scope, this vulnerability presents serious risk that can compromise any account, and hope you consider it as such.\n\nWhen updating a user in the configuration tab, there is no CSRF token to prevent other pages from updating the user. This allows any third party site to edit the user's email, then able to reset the password.\n\nPOC:\n\n1. Visit http://d214mfsab.org/olx.html while logged into your OLX account. This is a demo CSRF page I set up that changes your email to 'example@example.com'.\n2. Click 'Submit'.\n3. The JSON response will be returned, showing that your email was changed. An attacker could then reset your password using the 'Forgot Password' feature and gain access to your account.\n\nSuggested fix:\n\nRequire a CSRF token with all sensitive GET and POST requests.","vulnerability_information_html":"\u003cp\u003eHello,\u003c/p\u003e\n\n\u003cp\u003eAlthough listed as out of scope, this vulnerability presents serious risk that can compromise any account, and hope you consider it as such.\u003c/p\u003e\n\n\u003cp\u003eWhen updating a user in the configuration tab, there is no CSRF token to prevent other pages from updating the user. This allows any third party site to edit the user\u0026#39;s email, then able to reset the password.\u003c/p\u003e\n\n\u003cp\u003ePOC:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eVisit \u003ca title=\"http://d214mfsab.org/olx.html\" href=\"/redirect?url=http%3A%2F%2Fd214mfsab.org%2Folx.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://d214mfsab.org/olx.html\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e while logged into your OLX account. This is a demo CSRF page I set up that changes your email to \u0026#39;\u003ca title=\"example@example.com\" href=\"mailto:example@example.com\" rel=\"nofollow noopener noreferrer\"\u003eexample@example.com\u003c/a\u003e\u0026#39;.\u003c/li\u003e\n\u003cli\u003eClick \u0026#39;Submit\u0026#39;.\u003c/li\u003e\n\u003cli\u003eThe JSON response will be returned, showing that your email was changed. An attacker could then reset your password using the \u0026#39;Forgot Password\u0026#39; feature and gain access to your account.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eSuggested fix:\u003c/p\u003e\n\n\u003cp\u003eRequire a CSRF token with all sensitive GET and POST requests.\u003c/p\u003e\n","weakness":{"id":45,"name":"Cross-Site Request Forgery (CSRF)"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2016-10-05T14:07:58.593Z","allow_singular_disclosure_after":-133539891.88998967,"singular_disclosure_allowed":true,"vote_count":8,"voters":["cablej","bugdiscloseguys","eveeez","ak1t4","japz","sumit7","dyabla","sultana"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1062730,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"One modification: This does require knowledge of the target's user ID, which can be found by visiting a post of the user, which can be found by searching for \"sellerId\" in the source of a post. Once found, modify the form to include the userId in the url using a source editor, such as Chrome developer tools.","markdown_message":"\u003cp\u003eOne modification: This does require knowledge of the target\u0026#39;s user ID, which can be found by visiting a post of the user, which can be found by searching for \u0026quot;sellerId\u0026quot; in the source of a post. Once found, modify the form to include the userId in the url using a source editor, such as Chrome developer tools.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-07-11T12:59:05.832Z","updated_at":"2016-07-11T12:59:05.832Z","actor":{"username":"cablej","cleared":true,"url":"/cablej","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/042/859/7fdafea90092a305ae2cb6cec7d43461783abf0c_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"olx","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1070318,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hello,\n\nEven though CSRF is out of scope, we are deeply grateful for the security issue you shared with us. OLX's staff will we working on this issue to solve it because it's a high severity issue.\n\nSince we just launched our vulnerability disclosure program, we are currently not awarding bounties or cash rewards for reported vulnerabilities but hope to do so in the near future.\n\nWe would like to add you in our Security Hall of Fame site that is hosted in security.olx.com. Could you please provide a profile you would like to link to (social media, HackerOne, etc) in our Hall of Fame entry?\n\nBest regards,\n\nGlobal Security Infrastructure Team","markdown_message":"\u003cp\u003eHello,\u003c/p\u003e\n\n\u003cp\u003eEven though CSRF is out of scope, we are deeply grateful for the security issue you shared with us. OLX\u0026#39;s staff will we working on this issue to solve it because it\u0026#39;s a high severity issue.\u003c/p\u003e\n\n\u003cp\u003eSince we just launched our vulnerability disclosure program, we are currently not awarding bounties or cash rewards for reported vulnerabilities but hope to do so in the near future.\u003c/p\u003e\n\n\u003cp\u003eWe would like to add you in our Security Hall of Fame site that is hosted in security.olx.com. Could you please provide a profile you would like to link to (social media, HackerOne, etc) in our Hall of Fame entry?\u003c/p\u003e\n\n\u003cp\u003eBest regards,\u003c/p\u003e\n\n\u003cp\u003eGlobal Security Infrastructure Team\u003c/p\u003e\n","automated_response":false,"created_at":"2016-07-15T11:14:41.936Z","updated_at":"2016-07-15T11:14:41.936Z","actor":{"username":"joaquin_rinaudo","cleared":false,"url":"/joaquin_rinaudo","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/082/536/d33cf1cd7294a47bece9ee43f87d518c7f9872d0_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"olx","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1070390,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for the response.\n\nYou can link to my twitter profile, http://twitter.com/jackhcable.\n\nJack","markdown_message":"\u003cp\u003eThanks for the response.\u003c/p\u003e\n\n\u003cp\u003eYou can link to my twitter profile, \u003ca title=\"http://twitter.com/jackhcable\" href=\"/redirect?url=http%3A%2F%2Ftwitter.com%2Fjackhcable\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://twitter.com/jackhcable\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e.\u003c/p\u003e\n\n\u003cp\u003eJack\u003c/p\u003e\n","automated_response":false,"created_at":"2016-07-15T12:12:53.842Z","updated_at":"2016-07-15T12:12:53.842Z","actor":{"username":"cablej","cleared":true,"url":"/cablej","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/042/859/7fdafea90092a305ae2cb6cec7d43461783abf0c_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"olx","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1107585,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"The issue has already been fixed. Now the previous password is needed for input, making the CSRF unexploitable.\n\nThanks again for the report.\n\nBest regards,\nJoaquín ","markdown_message":"\u003cp\u003eThe issue has already been fixed. Now the previous password is needed for input, making the CSRF unexploitable.\u003c/p\u003e\n\n\u003cp\u003eThanks again for the report.\u003c/p\u003e\n\n\u003cp\u003eBest regards,\u003cbr\u003e\nJoaquín \u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-05T07:36:14.227Z","updated_at":"2016-08-05T07:36:14.227Z","actor":{"username":"joaquin_rinaudo","cleared":false,"url":"/joaquin_rinaudo","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/082/536/d33cf1cd7294a47bece9ee43f87d518c7f9872d0_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"cablej","url":"/cablej"},"genius_execution_id":null,"team_handle":"olx","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1174252,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-09-05T14:07:58.538Z","updated_at":"2016-09-05T14:07:58.538Z","first_to_agree":true,"actor":{"username":"cablej","cleared":true,"url":"/cablej","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/042/859/7fdafea90092a305ae2cb6cec7d43461783abf0c_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"olx","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1233262,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-10-05T14:08:02.320Z","updated_at":"2016-10-05T14:08:02.320Z","actor":{"url":"/olx","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/146/07ffc7e779ee301e61da60eda7f2bd862a7082ca_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"OLX"}},"genius_execution_id":null,"team_handle":"olx","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}