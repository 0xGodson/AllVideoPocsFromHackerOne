{"id":59659,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC81OTY1OQ==","url":"https://hackerone.com/reports/59659","title":"Reopen Disable Accounts/ Hidden Access After Disable","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2015-05-05T09:07:36.045Z","submitted_at":"2015-05-05T09:07:36.045Z","is_member_of_team?":false,"reporter":{"disabled":true,"username":"antrax","url":"/antrax","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13,"url":"https://hackerone.com/security","handle":"security","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"HackerOne","twitter_handle":"Hacker0x01","website":"https://hackerone.com","about":"Vulnerability disclosure should be safe, transparent, and rewarding."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2015-06-08T20:55:21.474Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2015-05-09T20:55:17.055Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"For POC:\r\nOriginal Email or banned email: def@gmail.com\r\nUpdating Email: abc@gmail.com\r\n\r\nHello team this bug is something interesting and critical..\r\n\r\nI have checked once the accounts are disable not easy to open, but i have found a \r\nvulnerability which allow a user to reopen disable accounts.\r\n\r\nDisable Accounts Are two types:\r\n1) Disable by user ownself.\r\n2) Disable by hackerone for any reason (abusive behaviour , breaking rules etc.)\r\n\r\nSo i am Brief second one how to exploit because second one is too much interesting exploit \r\nas compare to first one ;)\r\n\r\nI am looking digging and found something cool and reopen disable accounts.\r\n\r\nSteps To reproduce:\r\n1)  Goto Email option and put working email for updating like (abc@gmail.com) then recieve an email of confirmation token (don't use it).\r\n\r\n2) Now abusing and breaking hackerone rules which cause to lead banning :D\r\n\r\n3) OOPS i am ban and also check my also updating email token on (abc@gmail.com) also expire :/\r\n and not working anymore and links be like:\r\nhttps://hackerone.com/users/confirmation?confirmation_token=\u003cgenerated token\u003e\r\n\r\n4) But Confirmation Instructions give me some hints :D\r\n•\tConfirmation instructions\r\n•\tThe confirmation token you provided is invalid.\r\n•\tEnter the email address you signed up with to request a new confirmation token\r\n\r\n5) So again put this update email(abc@gmail.com) and BOOM recieved confirmation email\r\nthen  confirmed account , email successfully update.\r\n\r\n6) Now use forgot pass and access to your account again.\r\n\r\nAfter account ban i am not able to check my reports even not get forgot pass email but if i am hide my email on email updating then i am again access to my account.\r\nAfter this if anyone change identity like username , email , name etc .\r\n\r\n•\tAfter Disabling totally remove emails even they are on update mode or if they in update mode before sending confirmation email check account is disable or not or any other condition .\r\n\r\nYola disable accounts again access able or changing identity is simple so again and again spamming\r\nand via this bug again and again account open even old nicks :D\r\n\r\nSome Other Effects:\r\ni)Old reports back\r\nii) Account successfully shifted to new email.\r\niii) Old triaged bugs , not payable bounties everthing you have.\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nMay be this one is valid but scenrio be like:\r\nFirst Scenerio:\r\nWell i am playing some options and going to email and check if someone updating \r\nemail there is no option to cancel this new email even if i am updating old email also\r\neven they show me \r\n\r\n\"You have a pending confirmation for 1234@gmail.com.\"\r\n\r\nCool no option to remove this email but something is good after sometime token of confirmation is expire and not working anymore but tale of this lead to critical exploit.\r\n \r\nSteps To Reproduce:\r\n1)  Goto Email option and put working email then recieve an email of confirmation token (don't use it).\r\n\r\n2) After Checking some hours they expire and not working anymore and links be like:\r\nhttps://hackerone.com/users/confirmation?confirmation_token=\u003cgenerated token\u003e\r\n\r\n3) But Confirmation Instructions give me some hints :D\r\nConfirmation instructions\r\nThe confirmation token you provided is invalid.\r\nEnter the email address you signed up with to request a new confirmation token.\r\n\r\n4) So i can check and put another email (456@gmail.com )and see no email recieved about confirmation\r\nbut suddenly i can put my email which is above i can filled for updating (1234@gmail.com)\r\nand hit resend and see email recieved for confirmation :o\r\n\r\n5) I click the link and email successfully confirmed and further use forgot password functionality to takeover the full account or access to the account.\r\n\r\n\r\nReason behind is first time token generated on behalf of 1234@gmail.com\r\nand still alive until email was not removed on hackerone pending bar..\r\n\r\nIf someone mistakenly put wrong email confirmation link sent to user, but some hours \r\ntoken is expire ,but but attacker still user this token to use takeover account.\r\n\r\nSecond issue may be not valid but first one is interesting and valid...hope you fix it soon :)\r\n\r\n\r\n","vulnerability_information_html":"\u003cp\u003eFor POC:\u003cbr\u003e\nOriginal Email or banned email: \u003ca title=\"def@gmail.com\" href=\"mailto:def@gmail.com\" rel=\"nofollow noopener noreferrer\"\u003edef@gmail.com\u003c/a\u003e\u003cbr\u003e\nUpdating Email: \u003ca title=\"abc@gmail.com\" href=\"mailto:abc@gmail.com\" rel=\"nofollow noopener noreferrer\"\u003eabc@gmail.com\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eHello team this bug is something interesting and critical..\u003c/p\u003e\n\n\u003cp\u003eI have checked once the accounts are disable not easy to open, but i have found a \u003cbr\u003e\nvulnerability which allow a user to reopen disable accounts.\u003c/p\u003e\n\n\u003cp\u003eDisable Accounts Are two types:\u003cbr\u003e\n1) Disable by user ownself.\u003cbr\u003e\n2) Disable by hackerone for any reason (abusive behaviour , breaking rules etc.)\u003c/p\u003e\n\n\u003cp\u003eSo i am Brief second one how to exploit because second one is too much interesting exploit \u003cbr\u003e\nas compare to first one ;)\u003c/p\u003e\n\n\u003cp\u003eI am looking digging and found something cool and reopen disable accounts.\u003c/p\u003e\n\n\u003cp\u003eSteps To reproduce:\u003cbr\u003e\n1)  Goto Email option and put working email for updating like (\u003ca title=\"abc@gmail.com\" href=\"mailto:abc@gmail.com\" rel=\"nofollow noopener noreferrer\"\u003eabc@gmail.com\u003c/a\u003e) then recieve an email of confirmation token (don\u0026#39;t use it).\u003c/p\u003e\n\n\u003cp\u003e2) Now abusing and breaking hackerone rules which cause to lead banning :D\u003c/p\u003e\n\n\u003cp\u003e3) OOPS i am ban and also check my also updating email token on (\u003ca title=\"abc@gmail.com\" href=\"mailto:abc@gmail.com\" rel=\"nofollow noopener noreferrer\"\u003eabc@gmail.com\u003c/a\u003e) also expire :/\u003cbr\u003e\n and not working anymore and links be like:\u003cbr\u003e\n\u003ca title=\"https://hackerone.com/users/confirmation?confirmation_token=\" href=\"https://hackerone.com/users/confirmation?confirmation_token=\"\u003ehttps://hackerone.com/users/confirmation?confirmation_token=\u003c/a\u003e\u0026lt;generated token\u0026gt;\u003c/p\u003e\n\n\u003cp\u003e4) But Confirmation Instructions give me some hints :D\u003cbr\u003e\n• Confirmation instructions\u003cbr\u003e\n• The confirmation token you provided is invalid.\u003cbr\u003e\n• Enter the email address you signed up with to request a new confirmation token\u003c/p\u003e\n\n\u003cp\u003e5) So again put this update email(\u003ca title=\"abc@gmail.com\" href=\"mailto:abc@gmail.com\" rel=\"nofollow noopener noreferrer\"\u003eabc@gmail.com\u003c/a\u003e) and BOOM recieved confirmation email\u003cbr\u003e\nthen  confirmed account , email successfully update.\u003c/p\u003e\n\n\u003cp\u003e6) Now use forgot pass and access to your account again.\u003c/p\u003e\n\n\u003cp\u003eAfter account ban i am not able to check my reports even not get forgot pass email but if i am hide my email on email updating then i am again access to my account.\u003cbr\u003e\nAfter this if anyone change identity like username , email , name etc .\u003c/p\u003e\n\n\u003cp\u003e• After Disabling totally remove emails even they are on update mode or if they in update mode before sending confirmation email check account is disable or not or any other condition .\u003c/p\u003e\n\n\u003cp\u003eYola disable accounts again access able or changing identity is simple so again and again spamming\u003cbr\u003e\nand via this bug again and again account open even old nicks :D\u003c/p\u003e\n\n\u003cp\u003eSome Other Effects:\u003cbr\u003e\ni)Old reports back\u003cbr\u003e\nii) Account successfully shifted to new email.\u003cbr\u003e\niii) Old triaged bugs , not payable bounties everthing you have.\u003c/p\u003e\n\n\u003cp\u003eMay be this one is valid but scenrio be like:\u003cbr\u003e\nFirst Scenerio:\u003cbr\u003e\nWell i am playing some options and going to email and check if someone updating \u003cbr\u003e\nemail there is no option to cancel this new email even if i am updating old email also\u003cbr\u003e\neven they show me \u003c/p\u003e\n\n\u003cp\u003e\u0026quot;You have a pending confirmation for \u003ca title=\"1234@gmail.com\" href=\"mailto:1234@gmail.com\" rel=\"nofollow noopener noreferrer\"\u003e1234@gmail.com\u003c/a\u003e.\u0026quot;\u003c/p\u003e\n\n\u003cp\u003eCool no option to remove this email but something is good after sometime token of confirmation is expire and not working anymore but tale of this lead to critical exploit.\u003c/p\u003e\n\n\u003cp\u003eSteps To Reproduce:\u003cbr\u003e\n1)  Goto Email option and put working email then recieve an email of confirmation token (don\u0026#39;t use it).\u003c/p\u003e\n\n\u003cp\u003e2) After Checking some hours they expire and not working anymore and links be like:\u003cbr\u003e\n\u003ca title=\"https://hackerone.com/users/confirmation?confirmation_token=\" href=\"https://hackerone.com/users/confirmation?confirmation_token=\"\u003ehttps://hackerone.com/users/confirmation?confirmation_token=\u003c/a\u003e\u0026lt;generated token\u0026gt;\u003c/p\u003e\n\n\u003cp\u003e3) But Confirmation Instructions give me some hints :D\u003cbr\u003e\nConfirmation instructions\u003cbr\u003e\nThe confirmation token you provided is invalid.\u003cbr\u003e\nEnter the email address you signed up with to request a new confirmation token.\u003c/p\u003e\n\n\u003cp\u003e4) So i can check and put another email (\u003ca title=\"456@gmail.com\" href=\"mailto:456@gmail.com\" rel=\"nofollow noopener noreferrer\"\u003e456@gmail.com\u003c/a\u003e )and see no email recieved about confirmation\u003cbr\u003e\nbut suddenly i can put my email which is above i can filled for updating (\u003ca title=\"1234@gmail.com\" href=\"mailto:1234@gmail.com\" rel=\"nofollow noopener noreferrer\"\u003e1234@gmail.com\u003c/a\u003e)\u003cbr\u003e\nand hit resend and see email recieved for confirmation :o\u003c/p\u003e\n\n\u003cp\u003e5) I click the link and email successfully confirmed and further use forgot password functionality to takeover the full account or access to the account.\u003c/p\u003e\n\n\u003cp\u003eReason behind is first time token generated on behalf of \u003ca title=\"1234@gmail.com\" href=\"mailto:1234@gmail.com\" rel=\"nofollow noopener noreferrer\"\u003e1234@gmail.com\u003c/a\u003e\u003cbr\u003e\nand still alive until email was not removed on hackerone pending bar..\u003c/p\u003e\n\n\u003cp\u003eIf someone mistakenly put wrong email confirmation link sent to user, but some hours \u003cbr\u003e\ntoken is expire ,but but attacker still user this token to use takeover account.\u003c/p\u003e\n\n\u003cp\u003eSecond issue may be not valid but first one is interesting and valid...hope you fix it soon :)\u003c/p\u003e\n","bounty_amount":"500.0","formatted_bounty":"$500","weakness":{"id":27,"name":"Improper Authentication - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2015-06-08T20:55:17.847Z","allow_singular_disclosure_after":-175426442.86961251,"singular_disclosure_allowed":true,"vote_count":1,"voters":["dyabla"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":402937,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @antrax,\n\nThanks for your detailed report, we believe this may be a valid issue and will investigate it further. We'll report back when we have more information.","markdown_message":"\u003cp\u003eHey \u003ca href=\"/antrax\"\u003e@antrax\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThanks for your detailed report, we believe this may be a valid issue and will investigate it further. We\u0026#39;ll report back when we have more information.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-05-06T00:04:04.348Z","updated_at":"2015-05-06T00:04:04.348Z","actor":{"username":"bencode","cleared":false,"url":"/bencode","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/117/ddaa1da4e004e1234c6857c42f9bfa8df85b5ccf_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":403089,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2015-05-06T07:33:27.681Z","updated_at":"2015-05-06T07:33:27.681Z","actor":{"username":"jens","cleared":false,"url":"/jens","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/053/9c23f98571002dd0db70919126ae92746a6af99a_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":403104,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2015-05-06T07:42:54.357Z","updated_at":"2015-05-06T07:42:54.357Z","actor":{"username":"jens","cleared":false,"url":"/jens","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/053/9c23f98571002dd0db70919126ae92746a6af99a_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":405357,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @antrax, we have pushed a fix for this issue. Can you confirm it is resolved?","markdown_message":"\u003cp\u003eHi \u003ca href=\"/antrax\"\u003e@antrax\u003c/a\u003e, we have pushed a fix for this issue. Can you confirm it is resolved?\u003c/p\u003e\n","automated_response":false,"created_at":"2015-05-08T20:04:06.444Z","updated_at":"2015-05-08T20:04:06.444Z","actor":{"username":"bencode","cleared":false,"url":"/bencode","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/117/ddaa1da4e004e1234c6857c42f9bfa8df85b5ccf_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":405549,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2015-05-09T00:56:57.829Z","updated_at":"2015-05-09T00:56:57.829Z","actor":{"url":"/security","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"HackerOne"}},"bounty_amount":"500.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"security","collaborator":{"username":"antrax","url":"/antrax"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":405551,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2015-05-09T00:58:56.467Z","updated_at":"2015-05-09T00:58:56.467Z","actor":{"username":"reed","cleared":false,"url":"/reed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"reporter":{"username":"antrax","url":"/antrax"},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":405864,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for quick fix and the bounty ....\n\nWell its such a bypassing , bypassed your disabled systems ...please again take a look and increase the reward :) ","markdown_message":"\u003cp\u003eThanks for quick fix and the bounty ....\u003c/p\u003e\n\n\u003cp\u003eWell its such a bypassing , bypassed your disabled systems ...please again take a look and increase the reward :) \u003c/p\u003e\n","automated_response":false,"created_at":"2015-05-09T11:00:58.706Z","updated_at":"2015-05-09T11:00:58.706Z","actor":{"username":"antrax","cleared":false,"url":"/antrax","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":406064,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-05-09T20:55:17.165Z","updated_at":"2015-05-09T20:55:17.165Z","first_to_agree":true,"actor":{"username":"reed","cleared":false,"url":"/reed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":406065,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"We've made our bounty decision. Please respect our choice concerning bounty amount. Thanks.","markdown_message":"\u003cp\u003eWe\u0026#39;ve made our bounty decision. Please respect our choice concerning bounty amount. Thanks.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-05-09T20:56:27.210Z","updated_at":"2015-05-09T20:56:27.210Z","actor":{"username":"reed","cleared":false,"url":"/reed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":435500,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2015-06-01T21:05:51.655Z","updated_at":"2015-06-01T21:05:51.655Z","additional_data":{"old_title":"Reopen Disacle Accounts/ Hidden Access After Disable","new_title":"Reopen Disable Accounts/ Hidden Access After Disable"},"actor":{"username":"reed","cleared":false,"url":"/reed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":445072,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-06-08T20:55:21.579Z","updated_at":"2015-06-08T20:55:21.579Z","actor":{"url":"/security","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"HackerOne"}},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}