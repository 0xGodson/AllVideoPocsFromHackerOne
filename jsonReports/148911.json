{"id":148911,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNDg5MTE=","url":"https://hackerone.com/reports/148911","title":"User enumeration  via Password reset page [Minor]","state":"Closed","substate":"informative","readable_substate":"Informative","created_at":"2016-07-02T20:22:41.788Z","submitted_at":"2016-07-02T20:22:41.788Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"ahsan","url":"/ahsan","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/048/674/a85d1f36a4d4b4c6269951bc913cc6f4fc3fcb23_original.JPG/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":8539,"url":"https://hackerone.com/paragonie","handle":"paragonie","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/008/539/72f76fed45e5220b47ba2f679371ebf9ccb19c70_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/539/72f76fed45e5220b47ba2f679371ebf9ccb19c70_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Paragon Initiative Enterprises","twitter_handle":"ParagonIE","website":"https://github.com/paragonie","about":"Cryptography and Application Security Consultants - We Produce Various Open Source Libraries"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2016-07-02T20:44:55.473Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2016-07-02T20:24:41.555Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hey, I've found a 'minor' issue in bridge.cspr.ng [CMS Airship]\n\nThe issue is 'username enumeration' \n\nMeans, an attacker can know that if a user exists or not; just by noticing the error! So, once the attacker knows that a user exists, he can launch a *brute force* attack against it!\n\n### Steps of replication\n1. Go to password reset page\n2. Enter an username which exists, there would be no error, and it will be redirected to login page\n3. Enter an username which doesn't exists, there would be an error saying something like 'user account doesn't exists etc..'\n\n### Mediation\n- Error should be same in both conditions like, every time it should redirect to login page; or you can also fix by adding this: \"If email/username exists in our DB, an email for your password reset will be sent!\" etc..\n\nHope you'll fix this soon! \n\nThanks\n-Ahsan","vulnerability_information_html":"\u003cp\u003eHey, I\u0026#39;ve found a \u0026#39;minor\u0026#39; issue in bridge.cspr.ng [CMS Airship]\u003c/p\u003e\n\n\u003cp\u003eThe issue is \u0026#39;username enumeration\u0026#39; \u003c/p\u003e\n\n\u003cp\u003eMeans, an attacker can know that if a user exists or not; just by noticing the error! So, once the attacker knows that a user exists, he can launch a \u003cem\u003ebrute force\u003c/em\u003e attack against it!\u003c/p\u003e\n\n\u003ch3 id=\"steps-of-replication\"\u003eSteps of replication\u003c/h3\u003e\n\n\u003col\u003e\n\u003cli\u003eGo to password reset page\u003c/li\u003e\n\u003cli\u003eEnter an username which exists, there would be no error, and it will be redirected to login page\u003c/li\u003e\n\u003cli\u003eEnter an username which doesn\u0026#39;t exists, there would be an error saying something like \u0026#39;user account doesn\u0026#39;t exists etc..\u0026#39;\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003ch3 id=\"mediation\"\u003eMediation\u003c/h3\u003e\n\n\u003cul\u003e\n\u003cli\u003eError should be same in both conditions like, every time it should redirect to login page; or you can also fix by adding this: \u0026quot;If email/username exists in our DB, an email for your password reset will be sent!\u0026quot; etc..\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eHope you\u0026#39;ll fix this soon! \u003c/p\u003e\n\n\u003cp\u003eThanks\u003cbr\u003e\n-Ahsan\u003c/p\u003e\n","weakness":{"id":57,"name":"Violation of Secure Design Principles"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":3,"voters":["spetr0x","0x0ameer","dyabla"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1050684,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"Actually, it says the same message if the account doesn't exist or if the user opted out of account recovery.","markdown_message":"\u003cp\u003eActually, it says the same message if the account doesn\u0026#39;t exist or if the user opted out of account recovery.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-07-02T20:24:32.933Z","updated_at":"2016-07-02T20:24:32.933Z","actor":{"username":"paragonie-scott","cleared":false,"url":"/paragonie-scott","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/051/441/089de22b2f1b80a1e57a2792318dede5cbad81db_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"paragonie","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1050685,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-07-02T20:24:41.586Z","updated_at":"2016-07-02T20:24:41.586Z","first_to_agree":true,"actor":{"username":"paragonie-scott","cleared":false,"url":"/paragonie-scott","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/051/441/089de22b2f1b80a1e57a2792318dede5cbad81db_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"paragonie","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1050692,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @paragonie-scott, it's not an issue like you are saying, it's like, if your try the same thing with the login panel, either if we enter wrong email, or if we enter right email and wrong password the error in both conditions would be same!\n\nYou SHOULD add the same mechanism in 'forgot password' page!\n\nLike if a user enters am email which doesn't exists in bridge.cspr.ng's DB in password reset email field, it will say that user doesn't exists, and if the attacker enters an email which exists, the page will be redirected to login page!\n\n- If you still haven't got my point I can make a PoC video! :)\n\nIf you have any other questions or if anything needs clarification, please let me know.\n\nThanks\n-Ahsna\n","markdown_message":"\u003cp\u003eHey \u003ca href=\"/paragonie-scott\"\u003e@paragonie-scott\u003c/a\u003e, it\u0026#39;s not an issue like you are saying, it\u0026#39;s like, if your try the same thing with the login panel, either if we enter wrong email, or if we enter right email and wrong password the error in both conditions would be same!\u003c/p\u003e\n\n\u003cp\u003eYou SHOULD add the same mechanism in \u0026#39;forgot password\u0026#39; page!\u003c/p\u003e\n\n\u003cp\u003eLike if a user enters am email which doesn\u0026#39;t exists in bridge.cspr.ng\u0026#39;s DB in password reset email field, it will say that user doesn\u0026#39;t exists, and if the attacker enters an email which exists, the page will be redirected to login page!\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eIf you still haven\u0026#39;t got my point I can make a PoC video! :)\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eIf you have any other questions or if anything needs clarification, please let me know.\u003c/p\u003e\n\n\u003cp\u003eThanks\u003cbr\u003e\n-Ahsna\u003c/p\u003e\n","automated_response":false,"created_at":"2016-07-02T20:30:33.452Z","updated_at":"2016-07-02T20:30:33.452Z","actor":{"username":"ahsan","cleared":false,"url":"/ahsan","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/048/674/a85d1f36a4d4b4c6269951bc913cc6f4fc3fcb23_original.JPG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"paragonie","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1050695,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"It's not that I don't understand, it's that I don't consider this a vulnerability.","markdown_message":"\u003cp\u003eIt\u0026#39;s not that I don\u0026#39;t understand, it\u0026#39;s that I don\u0026#39;t consider this a vulnerability.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-07-02T20:32:34.013Z","updated_at":"2016-07-02T20:32:34.013Z","actor":{"username":"paragonie-scott","cleared":false,"url":"/paragonie-scott","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/051/441/089de22b2f1b80a1e57a2792318dede5cbad81db_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"paragonie","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1050696,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"But, when you closed the report as Informative, you said this: \"Actually, it says the same message if the account doesn't exist or if the user opted out of account recovery.\" \n\nBut, it gives different message!\n\nThanks\n-Ahsan","markdown_message":"\u003cp\u003eBut, when you closed the report as Informative, you said this: \u0026quot;Actually, it says the same message if the account doesn\u0026#39;t exist or if the user opted out of account recovery.\u0026quot; \u003c/p\u003e\n\n\u003cp\u003eBut, it gives different message!\u003c/p\u003e\n\n\u003cp\u003eThanks\u003cbr\u003e\n-Ahsan\u003c/p\u003e\n","automated_response":false,"created_at":"2016-07-02T20:34:06.312Z","updated_at":"2016-07-02T20:34:06.312Z","actor":{"username":"ahsan","cleared":false,"url":"/ahsan","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/048/674/a85d1f36a4d4b4c6269951bc913cc6f4fc3fcb23_original.JPG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"paragonie","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1050699,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Left: A random username.\nRight: A valid username for an account which has opted out of the account recovery feature.\n\nSame message.\n\nIf someone opts into account recovery, they've already made a convenience \u003e security trade-off.","markdown_message":"\u003cp\u003eLeft: A random username.\u003cbr\u003e\nRight: A valid username for an account which has opted out of the account recovery feature.\u003c/p\u003e\n\n\u003cp\u003eSame message.\u003c/p\u003e\n\n\u003cp\u003eIf someone opts into account recovery, they\u0026#39;ve already made a convenience \u0026gt; security trade-off.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-07-02T20:37:12.243Z","updated_at":"2016-07-02T20:37:12.243Z","actor":{"username":"paragonie-scott","cleared":false,"url":"/paragonie-scott","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/051/441/089de22b2f1b80a1e57a2792318dede5cbad81db_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":103000,"filename":"diff.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/103/000/bb7adb8579bd0fc08a666a53bd2166febbc32e94/diff.png?response-content-disposition=attachment%3B%20filename%3D%22diff.png%22%3B%20filename%2A%3DUTF-8%27%27diff.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSFCZ3AEE%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T043208Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJFMEMCIHWigdtf4V6jrDm66WbPrvAwAjkDkGwq6jJxHgkhTBQkAh8Pm59QJ1DW90Nm%2BqUZrqPeSIGh%2B3OcvgtVLmg10uTMKrQDCFQQARoMMDEzNjE5Mjc0ODQ5IgwfS9%2FiGaxXJhRExaMqkQM%2FioQKCRd2GEb49HBlLXjeVg1H%2FoNlCjm1k0hMZ2xM%2B0x4lmIPMnshxiw4gyq5WOKYTVNGzovcoxlJKVWJ0J8ot8jIAdBOEwL1e8YBnNwskpBMy96aUxeRhk0v3RC6PmoKg5jI4Qx3q41XFLoVNJzGZBMLXknGm%2FL%2F3r3TBQO0a%2Bho9Lw4jX%2FmwWvHj8d64twZuZ4naqUS%2FC5%2FMe%2BCb7di7nj2LrLyNCU3mwVZhuZqaKYU7%2BmpmzDXhPe6vg3i0Ag1ETmf%2B4HHFKIzD1arTf4NVMuk53Qk2BUuVm8UMmZQPvicVaLBXLt7ccHpSlZil%2FS4s09xyNkmhqsb4joFjYvki4ZCYJgj6f2HgZ9j5I5jB%2BkNBEx91sV072LTXsJZGus5vwgFqmgq6%2FLSGoCBv5WZ1%2FGuoZfgjyzvsmoBX8uKpu1MK2cCSfK2OOw%2BdQcJ893qtedMSb3E%2FljNUxJf3ge6DsNwKlGjDwu7tV2CwK5eoC8nnGnfgTFitfIQRa0%2BQ7r2Yiwaq1V%2FfpNlnllKKKKFFDD1uar%2FBTrtAcWSVbs%2BpUxv20hwqIlkNrNvMi6wkgf%2BLXOkTSYmrhZJiEvr012n0TMdj9Lpp5lSBvt%2BFmQOWfNxpY3OJBDwcWAiZ%2F2ed9lHQZ21qGQ3nsQfbuRvBliy0SDSXu3rFk%2F2YIvbptRB1WpaAx7N%2FhS0S%2Bs17TOirrod7lqA3UzbN3XBtY1r%2BegR7%2FcG%2BpTuKL1SZFmW4odML8bsKnPb2rSlOtAfW6UI5KEpZRuNPIpftSdXrAErjdLnGLehSWx7Q2Iysd3y2wS8%2BnA6TfU%2Fr7xOl0wvkOaOhwXKDLm%2BA5oHA3Mxg%2F%2FTNCq8BPNgEALt%2FQ%3D%3D\u0026X-Amz-Signature=5aa0021ef5156f3b10bf2d572dceba25b4f02fb8f0d0eeb400fb19435a90561a"}],"genius_execution_id":null,"team_handle":"paragonie","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1050701,"is_internal":false,"editable":false,"type":"Activities::ManuallyDisclosed","message":"","markdown_message":"","automated_response":false,"created_at":"2016-07-02T20:44:55.396Z","updated_at":"2016-07-02T20:44:55.396Z","actor":{"username":"paragonie-scott","cleared":false,"url":"/paragonie-scott","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/051/441/089de22b2f1b80a1e57a2792318dede5cbad81db_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"paragonie","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}