{"id":224927,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMjQ5Mjc=","url":"https://hackerone.com/reports/224927","title":"Missing Rate Limiting protection leading to mass triggering of e-mails","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2017-04-29T13:05:35.781Z","submitted_at":"2017-04-29T13:05:35.781Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"giligails","url":"/giligails","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13291,"url":"https://hackerone.com/nextcloud","handle":"nextcloud","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Nextcloud","twitter_handle":"nextclouders","website":"https://nextcloud.com","about":"Access, share and protect your files, calendars, contacts, communication \u0026 more at home and in your enterprise."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-06-05T06:35:55.592Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2017-05-06T06:35:44.125Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"The issue is that there is a speed bump missing in the subscription of e-mail for a user. This would eventually let the attacker spam to *any* random e-mail resulting in exhaustion of resources on your side and I see that you are using Amazon AWS's SES where you are charged per e-mail.  If a dedicated attacker wants to, he/she create significant loss at his/her whim and fancy. \n\nThe mails can be triggered to a specific user , post his/her confirmation to subscription thereby causing frustration to users due to flooded inbox, consequently forcing users to classify emails from your application as SPAM . \n\n This poses a significant threat to the integrity and reputation of your organisation. \n\nThe request which when captured triggers mails.\nPOST /?p=subscribe\u0026id=1 HTTP/1.1\nHost: newsletter.nextcloud.com\nHost: google.com\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64; rv:53.0) Gecko/20100101 Firefox/53.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: en-GB,en;q=0.5\nReferer: https://newsletter.nextcloud.com/?p=subscribe\u0026id=1\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 199\nCookie: PHPSESSID=15vcjnijfjq2vlo8ihpkcdk9f3\nConnection: close\nUpgrade-Insecure-Requests: 1\n\nemail=testonhackerone%40gmail.com\u0026emailconfirm=testonhackerone%40gmail.com\u0026htmlemail=1\u0026list%5B3%5D=signup\u0026listname%5B3%5D=Nextcloud+newsletter\u0026VerificationCodeX=\u0026subscribe=Subscribe+to+the+newsletter\n\nProof of Concept / Steps to reproduce: \n\n1. Copy the request to the Burp Intruder\n2. Now, paste the target and the request and set the options to Null Payloads. \n3. Intrude the request say 10 times to the target email. \n4. You can see the e-mails being spammed to your inbox. \n\nAttached is the screenshot showing count of mails triggered post confirmation of subscription(61) due to the capture of request.\n\nAlso, confirming the e-mail doesn't make that confirmed user immune to this attack. The e-mail spam attack can be performed even if the user has previously confirmed. \n\nPOC: \n1. Confirm the subscription once and try the same again. \n\nI'd be more than happy to assist you with anything regarding the issue. \n\nLook forward to hear from you. \n\nHave a happy day. \n","vulnerability_information_html":"\u003cp\u003eThe issue is that there is a speed bump missing in the subscription of e-mail for a user. This would eventually let the attacker spam to \u003cem\u003eany\u003c/em\u003e random e-mail resulting in exhaustion of resources on your side and I see that you are using Amazon AWS\u0026#39;s SES where you are charged per e-mail.  If a dedicated attacker wants to, he/she create significant loss at his/her whim and fancy. \u003c/p\u003e\n\n\u003cp\u003eThe mails can be triggered to a specific user , post his/her confirmation to subscription thereby causing frustration to users due to flooded inbox, consequently forcing users to classify emails from your application as SPAM . \u003c/p\u003e\n\n\u003cp\u003eThis poses a significant threat to the integrity and reputation of your organisation. \u003c/p\u003e\n\n\u003cp\u003eThe request which when captured triggers mails.\u003cbr\u003e\nPOST /?p=subscribe\u0026amp;id=1 HTTP/1.1\u003cbr\u003e\nHost: newsletter.nextcloud.com\u003cbr\u003e\nHost: google.com\u003cbr\u003e\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64; rv:53.0) Gecko/20100101 Firefox/53.0\u003cbr\u003e\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,\u003cem\u003e/\u003c/em\u003e;q=0.8\u003cbr\u003e\nAccept-Language: en-GB,en;q=0.5\u003cbr\u003e\nReferer: \u003ca title=\"https://newsletter.nextcloud.com/?p=subscribe\u0026amp;id=1\" href=\"/redirect?url=https%3A%2F%2Fnewsletter.nextcloud.com%2F%3Fp%3Dsubscribe%26id%3D1\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://newsletter.nextcloud.com/?p=subscribe\u0026amp;id=1\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nContent-Type: application/x-www-form-urlencoded\u003cbr\u003e\nContent-Length: 199\u003cbr\u003e\nCookie: PHPSESSID=15vcjnijfjq2vlo8ihpkcdk9f3\u003cbr\u003e\nConnection: close\u003cbr\u003e\nUpgrade-Insecure-Requests: 1\u003c/p\u003e\n\n\u003cp\u003eemail=testonhackerone%40gmail.com\u0026amp;emailconfirm=testonhackerone%40gmail.com\u0026amp;htmlemail=1\u0026amp;list%5B3%5D=signup\u0026amp;listname%5B3%5D=Nextcloud+newsletter\u0026amp;VerificationCodeX=\u0026amp;subscribe=Subscribe+to+the+newsletter\u003c/p\u003e\n\n\u003cp\u003eProof of Concept / Steps to reproduce: \u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eCopy the request to the Burp Intruder\u003c/li\u003e\n\u003cli\u003eNow, paste the target and the request and set the options to Null Payloads. \u003c/li\u003e\n\u003cli\u003eIntrude the request say 10 times to the target email. \u003c/li\u003e\n\u003cli\u003eYou can see the e-mails being spammed to your inbox. \u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eAttached is the screenshot showing count of mails triggered post confirmation of subscription(61) due to the capture of request.\u003c/p\u003e\n\n\u003cp\u003eAlso, confirming the e-mail doesn\u0026#39;t make that confirmed user immune to this attack. The e-mail spam attack can be performed even if the user has previously confirmed. \u003c/p\u003e\n\n\u003cp\u003ePOC: \u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eConfirm the subscription once and try the same again. \u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eI\u0026#39;d be more than happy to assist you with anything regarding the issue. \u003c/p\u003e\n\n\u003cp\u003eLook forward to hear from you. \u003c/p\u003e\n\n\u003cp\u003eHave a happy day. \u003c/p\u003e\n","weakness":{"id":57,"name":"Violation of Secure Design Principles"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":180637,"file_name":"NextCloud.PNG","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/180/637/05e34bb071e090a7a5195f8a57b217af7c1c7d20/NextCloud.PNG?response-content-disposition=attachment%3B%20filename%3D%22NextCloud.PNG%22%3B%20filename%2A%3DUTF-8%27%27NextCloud.PNG\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQUYGCYHJT%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T050227Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJj%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIAGSCCKi0CRpYJMt3KX5x%2BNM9j2K4mM4glLH6mZ%2B8ExKAiEAlsZG1%2FfIYq0ODDSxwLnZfWyc08bfINN86QAI3Hqr4MgqtAMIURABGgwwMTM2MTkyNzQ4NDkiDG9txF7r12Yekik2WSqRA6NC8vsgwir7JTQr5zVnxH1x6efNaMXQv0rW73VsI4xDf6Ldo8AdQq%2B7eYd4BvolwrfpyHLOFrZnF4wc7R9rEQKh%2FswFKL9GQ6Lp2ujYTvyC5dhdjS4Sq%2F%2BYvPk3joZ%2BEwcDqk%2B5AvxLFqoiv3Y3ts7f9HYBqcl%2Fu20T7ZA6XxU9V7asrN5LT6SJz4xOu7iZzuPeZs4%2BFaw8tgu5A3W6CYmUUmbBs9q%2FQ%2FCO3t50tS7Dm5k%2BKM04Ar1VaXlWDuLdZKMC%2FS80%2FwDwH66vWVAjLib7jCkgBWXGEa9VryBHJJUl3qrXQrTIED1gUKeOoKk3fYvvyyIMJs3ja%2BbbO56fim%2BodEtN1FBU6g%2BuddJ4Qz5521XYpzwatC5mjJs6D50zWyfJnn9Xf%2FrDe3EacAX3oOhEBj%2Fu9S%2B46jeCaMjfEHwW8T%2FFnFpu%2FZf3e1NchqIFhOkEcnGH%2FqNmQtJ54g5I6x8j4N2c70CE7tuCZI1qjgi%2BfUfSwopFGky44IARFjLnTewCnMtMfFUa7haJa9C%2BcuqvMJDfqf8FOusB7%2BAWx%2FH2B4H9I7hLf9GkPQtz9yMVcytbF7umUu9c2W6aIn%2FKCYsmcfqyPQD%2Fe6EdfKQiWwtKrHes32q91jeUCiYfrRJFByq7uDxHGN0MingOOUWy72n3fdpooUwYjRfpac06PpxBSGvwEeiL%2BJlq9wl2E%2FMxojMrovyONCSYEoBpeEbNgMNFb9rpTiIW%2BX8OzRH6ra3L9dgd9y8nuqoCkIGYzNActVtKbpERxbtmkIoGAgtSCCLLfHT65g2k6G9afrZJZC86IhNmvJrDSG%2BKELC3%2BeAfU64DhUDssT9Dd%2Bm2pU0nRk1s8PUjuQ%3D%3D\u0026X-Amz-Signature=1e6a44cc10a2bc55ba4c0bd5ffd34e42470c4d15acd41bf6038e86b312ccabe8","file_size":64852,"type":"image/png"}],"allow_singular_disclosure_at":"2017-06-05T06:35:44.178Z","allow_singular_disclosure_after":-112573603.18084328,"singular_disclosure_allowed":true,"vote_count":4,"voters":["eveeez","b3nac","japz","spetr0x"],"severity":{"rating":"medium","score":6.5,"author_type":"User","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"none","user_interaction":"none","scope":"unchanged","confidentiality":"none","integrity":"low","availability":"low"}},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1644427,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks a lot for reporting this potential issue back to us!\n\nOur security team will take a look at this issue as soon as possible. We will reply to your report within 72 hours, usually much faster. For obvious reasons we'd like to ask you to not disclose this issue to any other party.","markdown_message":"\u003cp\u003eThanks a lot for reporting this potential issue back to us!\u003c/p\u003e\n\n\u003cp\u003eOur security team will take a look at this issue as soon as possible. We will reply to your report within 72 hours, usually much faster. For obvious reasons we\u0026#39;d like to ask you to not disclose this issue to any other party.\u003c/p\u003e\n","automated_response":true,"created_at":"2017-04-29T13:05:36.010Z","updated_at":"2017-04-29T13:05:36.010Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Nextcloud"}},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1645256,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2017-04-30T12:07:43.735Z","updated_at":"2017-04-30T12:07:43.735Z","actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1657907,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"As per our bounty policy at the moment we don't award monetary bounties for issues within our infrastructure.","markdown_message":"\u003cp\u003eAs per our bounty policy at the moment we don\u0026#39;t award monetary bounties for issues within our infrastructure.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-05-06T06:34:45.768Z","updated_at":"2017-05-06T06:34:51.579Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Nextcloud"}},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1657909,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks a lot for your report again. This has been resolved now by deploying reCAPTCHA in front of our newsletter subscriptions.","markdown_message":"\u003cp\u003eThanks a lot for your report again. This has been resolved now by deploying reCAPTCHA in front of our newsletter subscriptions.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-05-06T06:35:35.190Z","updated_at":"2017-05-06T06:35:35.190Z","actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"giligails","url":"/giligails"},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1657910,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-05-06T06:35:44.146Z","updated_at":"2017-05-06T06:35:44.146Z","first_to_agree":true,"actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1665897,"is_internal":false,"editable":false,"type":"Activities::ExternalUserJoined","message":"","markdown_message":"","automated_response":false,"created_at":"2017-05-10T15:01:00.605Z","updated_at":"2017-05-10T15:01:00.605Z","additional_data":{"duplicate_report_id":227501},"actor":{"username":"0xelement","cleared":false,"url":"/0xelement","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1729599,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-06-05T06:35:55.610Z","updated_at":"2017-06-05T06:35:55.610Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Nextcloud"}},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}