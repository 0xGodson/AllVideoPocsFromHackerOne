{"id":268807,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yNjg4MDc=","url":"https://hackerone.com/reports/268807","title":"CVE-2017-13010 The BEEP parser in tcpdump before 4.9.2 has a buffer over-read in print-beep.c:l_strnstart().","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2017-09-15T23:45:26.787Z","submitted_at":"2017-09-15T23:45:26.787Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"geeknik","url":"/geeknik","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/7xfGZCKCxUuGLYGfuUZM3XyY/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":21653,"url":"https://hackerone.com/ibb-data","handle":"ibb-data","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/021/653/2abb8bf772c4bddda91f5a4744e4b7e74c88675d_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/021/653/2abb8bf772c4bddda91f5a4744e4b7e74c88675d_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Data Processing (IBB)","twitter_handle":"","website":"","about":""}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":["CVE-2017-13010"],"singular_disclosure_disabled":false,"disclosed_at":"2019-10-08T20:32:16.120Z","bug_reporter_agreed_on_going_public_at":"2019-10-04T16:23:29.177Z","team_member_agreed_on_going_public_at":"2019-10-08T20:32:16.044Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Reported to the devs on 6 March 2017.\nTcpdump 4.9.2 released on 8 September 2017.\nPatch: https://github.com/the-tcpdump-group/tcpdump/commit/877b66b398518d9501513e0860c9f3a8acc70892\n\n`The BEEP parser in tcpdump before 4.9.2 has a buffer over-read in print-beep.c:l_strnstart().`\n\n```\n./tcpdump -n -r test005\n\n==28756==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x60600000f004 at pc 0x000000448f71 bp 0x7ffe8e433bd0 sp 0x7ffe8e433388\nREAD of size 1 at 0x60600000f004 thread T0\n    #0 0x448f70 in strncmp (/root/tcpdump/tcpdump+0x448f70)\n    #1 0x508343 in l_strnstart /root/tcpdump/./print-beep.c:37:10\n    #2 0x508343 in beep_print /root/tcpdump/./print-beep.c:44\n    #3 0x671447 in tcp_print /root/tcpdump/./print-tcp.c:703:17\n    #4 0x57617c in ip6_print /root/tcpdump/./print-ip6.c:345:4\n    #5 0x57453c in ipN_print /root/tcpdump/./print-ip.c:700:3\n    #6 0x626c07 in raw_if_print /root/tcpdump/./print-raw.c:42:2\n    #7 0x4de2e9 in pretty_print_packet /root/tcpdump/./print.c:339:18\n    #8 0x4cc5fb in print_packet /root/tcpdump/./tcpdump.c:2556:2\n    #9 0x773e00 in pcap_offline_read /root/libpcap/./savefile.c:527:4\n    #10 0x6a257c in pcap_loop /root/libpcap/./pcap.c:1657:8\n    #11 0x4c8a6e in main /root/tcpdump/./tcpdump.c:2059:12\n    #12 0x7f651cfa4b44 in __libc_start_main /build/glibc-qK83Be/glibc-2.19/csu/libc-start.c:287\n    #13 0x4c3ccc in _start (/root/tcpdump/tcpdump+0x4c3ccc)\n\n0x60600000f004 is located 4 bytes to the right of 64-byte region [0x60600000efc0,0x60600000f000)\nallocated by thread T0 here:\n    #0 0x4a664b in __interceptor_malloc (/root/tcpdump/tcpdump+0x4a664b)\n    #1 0x775753 in pcap_check_header /root/libpcap/./sf-pcap.c:401:14\n    #2 0x773462 in pcap_fopen_offline_with_tstamp_precision /root/libpcap/./savefile.c:400:7\n    #3 0x7731f4 in pcap_open_offline_with_tstamp_precision /root/libpcap/./savefile.c:307:6\n\nSUMMARY: AddressSanitizer: heap-buffer-overflow ??:0 strncmp\n```","vulnerability_information_html":"\u003cp\u003eReported to the devs on 6 March 2017.\u003cbr\u003e\nTcpdump 4.9.2 released on 8 September 2017.\u003cbr\u003e\nPatch: \u003ca title=\"https://github.com/the-tcpdump-group/tcpdump/commit/877b66b398518d9501513e0860c9f3a8acc70892\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fthe-tcpdump-group%2Ftcpdump%2Fcommit%2F877b66b398518d9501513e0860c9f3a8acc70892\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/the-tcpdump-group/tcpdump/commit/877b66b398518d9501513e0860c9f3a8acc70892\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003ccode\u003eThe BEEP parser in tcpdump before 4.9.2 has a buffer over-read in print-beep.c:l_strnstart().\u003c/code\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e./tcpdump -n -r test005\n\n==28756==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x60600000f004 at pc 0x000000448f71 bp 0x7ffe8e433bd0 sp 0x7ffe8e433388\nREAD of size 1 at 0x60600000f004 thread T0\n    #0 0x448f70 in strncmp (/root/tcpdump/tcpdump+0x448f70)\n    #1 0x508343 in l_strnstart /root/tcpdump/./print-beep.c:37:10\n    #2 0x508343 in beep_print /root/tcpdump/./print-beep.c:44\n    #3 0x671447 in tcp_print /root/tcpdump/./print-tcp.c:703:17\n    #4 0x57617c in ip6_print /root/tcpdump/./print-ip6.c:345:4\n    #5 0x57453c in ipN_print /root/tcpdump/./print-ip.c:700:3\n    #6 0x626c07 in raw_if_print /root/tcpdump/./print-raw.c:42:2\n    #7 0x4de2e9 in pretty_print_packet /root/tcpdump/./print.c:339:18\n    #8 0x4cc5fb in print_packet /root/tcpdump/./tcpdump.c:2556:2\n    #9 0x773e00 in pcap_offline_read /root/libpcap/./savefile.c:527:4\n    #10 0x6a257c in pcap_loop /root/libpcap/./pcap.c:1657:8\n    #11 0x4c8a6e in main /root/tcpdump/./tcpdump.c:2059:12\n    #12 0x7f651cfa4b44 in __libc_start_main /build/glibc-qK83Be/glibc-2.19/csu/libc-start.c:287\n    #13 0x4c3ccc in _start (/root/tcpdump/tcpdump+0x4c3ccc)\n\n0x60600000f004 is located 4 bytes to the right of 64-byte region [0x60600000efc0,0x60600000f000)\nallocated by thread T0 here:\n    #0 0x4a664b in __interceptor_malloc (/root/tcpdump/tcpdump+0x4a664b)\n    #1 0x775753 in pcap_check_header /root/libpcap/./sf-pcap.c:401:14\n    #2 0x773462 in pcap_fopen_offline_with_tstamp_precision /root/libpcap/./savefile.c:400:7\n    #3 0x7731f4 in pcap_open_offline_with_tstamp_precision /root/libpcap/./savefile.c:307:6\n\nSUMMARY: AddressSanitizer: heap-buffer-overflow ??:0 strncmp\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","bounty_amount":"500.0","formatted_bounty":"$500","weakness":{"id":9,"name":"Buffer Over-read"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2019-11-03T16:23:29.228Z","allow_singular_disclosure_after":-36420887.00219006,"singular_disclosure_allowed":true,"vote_count":4,"voters":["brodie_codie","geeknik","japz","kishoretrommer"],"severity":{"rating":"high","score":7.3,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"none","user_interaction":"none","scope":"unchanged","confidentiality":"low","integrity":"low","availability":"low"}},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":2041369,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"This vulnerability can be exploited in two ways. The first is to produce a .pcap file with crafted packet(s) for the protocol(s) concerned and make the target system try to decode the file using tcpdump. The second is to send specially crafted packet(s) to the network segment where the target system is running a tcpdump process that is decoding a live packet capture. In the latter case it depends on the specific network protocol if the crafted packet(s) may be sent from the local segment only or from a remote Internet host.","markdown_message":"\u003cp\u003eThis vulnerability can be exploited in two ways. The first is to produce a .pcap file with crafted packet(s) for the protocol(s) concerned and make the target system try to decode the file using tcpdump. The second is to send specially crafted packet(s) to the network segment where the target system is running a tcpdump process that is decoding a live packet capture. In the latter case it depends on the specific network protocol if the crafted packet(s) may be sent from the local segment only or from a remote Internet host.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-10-03T16:57:27.551Z","updated_at":"2017-10-03T16:57:27.551Z","actor":{"username":"geeknik","cleared":true,"url":"/geeknik","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/7xfGZCKCxUuGLYGfuUZM3XyY/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ibb-data","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2216209,"is_internal":false,"editable":false,"type":"Activities::ReassignedToTeam","message":"","markdown_message":"","automated_response":false,"created_at":"2017-12-12T06:19:23.615Z","updated_at":"2017-12-12T06:19:23.615Z","additional_data":{"old_team":"The Internet","new_team":"Data Processing (IBB)"},"actor":{"username":"arice","cleared":false,"url":"/arice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/83152cb2d070f3f6a63c1b61bae47257722b5ad2_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"ibb-data","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2216427,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2017-12-12T06:40:05.063Z","updated_at":"2017-12-12T06:40:05.063Z","additional_data":{"old_severity":"High","new_severity":"High (7.3)","old_severity_id":75591,"new_severity_id":101067},"actor":{"username":"arice","cleared":false,"url":"/arice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/83152cb2d070f3f6a63c1b61bae47257722b5ad2_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"ibb-data","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2216428,"is_internal":false,"editable":false,"type":"Activities::CveIdAdded","message":"","markdown_message":"","automated_response":false,"created_at":"2017-12-12T06:40:11.960Z","updated_at":"2017-12-12T06:40:11.960Z","cve_ids":["CVE-2017-13010"],"actor":{"username":"arice","cleared":false,"url":"/arice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/83152cb2d070f3f6a63c1b61bae47257722b5ad2_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"ibb-data","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2216429,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2017-12-12T06:40:16.649Z","updated_at":"2017-12-12T06:40:16.649Z","actor":{"url":"/ibb-data","ibb":true,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/021/653/2abb8bf772c4bddda91f5a4744e4b7e74c88675d_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Data Processing (IBB)"}},"bounty_amount":"500.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"ibb-data","collaborator":{"username":"geeknik","url":"/geeknik"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2216430,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2017-12-12T06:40:23.883Z","updated_at":"2017-12-12T06:40:23.883Z","actor":{"username":"arice","cleared":false,"url":"/arice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/83152cb2d070f3f6a63c1b61bae47257722b5ad2_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"reporter":{"username":"geeknik","url":"/geeknik"},"genius_execution_id":null,"team_handle":"ibb-data","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5960682,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-10-04T16:23:29.199Z","updated_at":"2019-10-04T16:23:29.199Z","first_to_agree":true,"actor":{"username":"geeknik","cleared":true,"url":"/geeknik","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/7xfGZCKCxUuGLYGfuUZM3XyY/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ibb-data","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5989662,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-10-08T20:32:16.060Z","updated_at":"2019-10-08T20:32:16.060Z","actor":{"username":"reed","cleared":false,"url":"/reed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"ibb-data","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5989663,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-10-08T20:32:16.134Z","updated_at":"2019-10-08T20:32:16.134Z","actor":{"username":"reed","cleared":false,"url":"/reed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"ibb-data","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}