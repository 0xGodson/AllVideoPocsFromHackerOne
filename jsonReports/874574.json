{"id":874574,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC84NzQ1NzQ=","url":"https://hackerone.com/reports/874574","title":"Partner's non-verified business email change reflected into Shopify Collaborator Request","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2020-05-15T02:12:35.036Z","submitted_at":"2020-05-15T02:12:35.036Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"francisbeaudoin","url":"/francisbeaudoin","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/apkjpoNQK4P5JD7rCFCB2hcf/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1382,"url":"https://hackerone.com/shopify","handle":"shopify","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Shopify","twitter_handle":"","website":"https://www.shopify.com","about":"Shopify is a multi-channel commerce platform that helps people sell online, in-store, and everywhere in between."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2020-09-14T19:45:34.975Z","bug_reporter_agreed_on_going_public_at":"2020-09-14T19:45:34.925Z","team_member_agreed_on_going_public_at":"2020-09-14T19:14:45.383Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"## Details\n\nIn https://partners.shopify.com a Partner must validate his email address prior making a request to manage a store. An email is then being sent to the Shop owner and it only includes the Partner's Business Name and it also links to the **Collaborator Request Review** to either accept or decline it.\n\nTaking that into consideration, if a Partner's change his email address without validating it once a request is sent, the Shopify shop owner's is being displayed the non-verified business email which could lead him to accept a malicious user.\n\n## Steps to reproduce\n1. Login to your Partner's account which has a verified email\n2. Make a request to add a managed Shopify Store to your account\n3. Go to Settings and update your **Business Email** \n4. Login to the managed Shopify shop and review the Collaborator Request, the non-verified email will be displayed\n\nAs a side note, this also leads to Information Disclosure (https://hackerone.com/bugs?report_id=853919) as if the above process is done and you do change the Partner's email to let's say victim@shopify.com, once the Collaborator Request is accepted and you Log-in through the Partner's dashboard, you'll be shown victim@shopify.com stores into the dropdown.\n\n## Demo\n██████\n\n## Impact\n\nA Partner's is being able to spoof his confirmed email address by a non-verified one in store management request","vulnerability_information_html":"\u003ch2 id=\"details\"\u003eDetails\u003c/h2\u003e\n\n\u003cp\u003eIn \u003ca title=\"https://partners.shopify.com\" href=\"/redirect?url=https%3A%2F%2Fpartners.shopify.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://partners.shopify.com\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e a Partner must validate his email address prior making a request to manage a store. An email is then being sent to the Shop owner and it only includes the Partner\u0026#39;s Business Name and it also links to the \u003cstrong\u003eCollaborator Request Review\u003c/strong\u003e to either accept or decline it.\u003c/p\u003e\n\n\u003cp\u003eTaking that into consideration, if a Partner\u0026#39;s change his email address without validating it once a request is sent, the Shopify shop owner\u0026#39;s is being displayed the non-verified business email which could lead him to accept a malicious user.\u003c/p\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps to reproduce\u003c/h2\u003e\n\n\u003col\u003e\n\u003cli\u003eLogin to your Partner\u0026#39;s account which has a verified email\u003c/li\u003e\n\u003cli\u003eMake a request to add a managed Shopify Store to your account\u003c/li\u003e\n\u003cli\u003eGo to Settings and update your \u003cstrong\u003eBusiness Email\u003c/strong\u003e \u003c/li\u003e\n\u003cli\u003eLogin to the managed Shopify shop and review the Collaborator Request, the non-verified email will be displayed\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eAs a side note, this also leads to Information Disclosure (\u003ca title=\"https://hackerone.com/bugs?report_id=853919\" href=\"https://hackerone.com/bugs?report_id=853919\"\u003ehttps://hackerone.com/bugs?report_id=853919\u003c/a\u003e) as if the above process is done and you do change the Partner\u0026#39;s email to let\u0026#39;s say \u003ca title=\"victim@shopify.com\" href=\"mailto:victim@shopify.com\" rel=\"nofollow noopener noreferrer\"\u003evictim@shopify.com\u003c/a\u003e, once the Collaborator Request is accepted and you Log-in through the Partner\u0026#39;s dashboard, you\u0026#39;ll be shown \u003ca title=\"victim@shopify.com\" href=\"mailto:victim@shopify.com\" rel=\"nofollow noopener noreferrer\"\u003evictim@shopify.com\u003c/a\u003e stores into the dropdown.\u003c/p\u003e\n\n\u003ch2 id=\"demo\"\u003eDemo\u003c/h2\u003e\n\n\u003cp\u003e██████\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eA Partner\u0026#39;s is being able to spoof his confirmed email address by a non-verified one in store management request\u003c/p\u003e\n","bounty_amount":"1000.0","formatted_bounty":"$1,000","weakness":{"id":26,"name":"Improper Access Control - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":5,"voters":["mygf","lusiferwings","flok33","maximilienblank","hacker_hack5968"],"structured_scope":{"databaseId":422,"asset_type":"URL","asset_identifier":"partners.shopify.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":8015776,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hi @francisbeaudoin,\nThank you for your report! We have confirmed this issue and our engineering team is investigating. We will get back to you next week with an update.","markdown_message":"\u003cp\u003eHi \u003ca href=\"/francisbeaudoin\"\u003e@francisbeaudoin\u003c/a\u003e,\u003cbr\u003e\nThank you for your report! We have confirmed this issue and our engineering team is investigating. We will get back to you next week with an update.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-05-15T20:22:43.077Z","updated_at":"2020-05-15T20:22:43.077Z","actor":{"username":"jenn-shopify","cleared":false,"url":"/jenn-shopify","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8059442,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @francisbeaudoin,\nWe’re determining the impact of this issue, and we’re not actually able to reproduce the additional implications you describe in your side note. Are you able to see shops for an unconfirmed email in shop switcher? If so, are there any additional steps you are taking to do this?","markdown_message":"\u003cp\u003eHi \u003ca href=\"/francisbeaudoin\"\u003e@francisbeaudoin\u003c/a\u003e,\u003cbr\u003e\nWe’re determining the impact of this issue, and we’re not actually able to reproduce the additional implications you describe in your side note. Are you able to see shops for an unconfirmed email in shop switcher? If so, are there any additional steps you are taking to do this?\u003c/p\u003e\n","automated_response":false,"created_at":"2020-05-20T15:06:19.265Z","updated_at":"2020-05-20T15:06:19.265Z","actor":{"username":"jenn-shopify","cleared":false,"url":"/jenn-shopify","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8059705,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello @jenn-shopify, I'm also unable to reproduce the additional implications about viewing shops of an unconfirmed email in the shop switcher. \n\nEither I messed up something while testing when I created the issue or it has been fixed along with https://hackerone.com/bugs?report_id=853919, which has been closed yesterday. Thus, I guess it can be ignored for the current report.","markdown_message":"\u003cp\u003eHello \u003ca href=\"/jenn-shopify\"\u003e@jenn-shopify\u003c/a\u003e, I\u0026#39;m also unable to reproduce the additional implications about viewing shops of an unconfirmed email in the shop switcher. \u003c/p\u003e\n\n\u003cp\u003eEither I messed up something while testing when I created the issue or it has been fixed along with \u003ca title=\"https://hackerone.com/bugs?report_id=853919\" href=\"https://hackerone.com/bugs?report_id=853919\"\u003ehttps://hackerone.com/bugs?report_id=853919\u003c/a\u003e, which has been closed yesterday. Thus, I guess it can be ignored for the current report.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-05-20T15:35:16.464Z","updated_at":"2020-05-20T15:35:16.464Z","actor":{"username":"francisbeaudoin","cleared":false,"url":"/francisbeaudoin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/apkjpoNQK4P5JD7rCFCB2hcf/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8083151,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks again for your report.\n\nWhile this issue doesn't fall into any of the categories listed in our \"Typical Bounty Amounts\" table, we agree that the ability to present an unverified email address to the merchant in a collaborator account request is a security issue since it could result in the merchant granting access to an untrusted party. We've decided to award a $1,000 bounty for this issue.\n\nWe'll be in touch again once the issue is resolved.","markdown_message":"\u003cp\u003eThanks again for your report.\u003c/p\u003e\n\n\u003cp\u003eWhile this issue doesn\u0026#39;t fall into any of the categories listed in our \u0026quot;Typical Bounty Amounts\u0026quot; table, we agree that the ability to present an unverified email address to the merchant in a collaborator account request is a security issue since it could result in the merchant granting access to an untrusted party. We\u0026#39;ve decided to award a $1,000 bounty for this issue.\u003c/p\u003e\n\n\u003cp\u003eWe\u0026#39;ll be in touch again once the issue is resolved.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-05-22T20:31:33.490Z","updated_at":"2020-05-22T20:31:33.490Z","actor":{"url":"/shopify","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Shopify"}},"bounty_amount":"1000.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"shopify","collaborator":{"username":"francisbeaudoin","url":"/francisbeaudoin"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8086837,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Awesome, thanks!","markdown_message":"\u003cp\u003eAwesome, thanks!\u003c/p\u003e\n","automated_response":false,"created_at":"2020-05-23T13:17:14.029Z","updated_at":"2020-05-23T13:17:14.029Z","actor":{"username":"francisbeaudoin","cleared":false,"url":"/francisbeaudoin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/apkjpoNQK4P5JD7rCFCB2hcf/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8136296,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks again for your report. Our engineering team has deployed a fix for this so the issue should no longer be reproducible. If you are able to bypass the fix, please let us know.\n\nThanks for helping make Shopify more secure. We hope you'll continue to do so.\n\nHappy Hacking!","markdown_message":"\u003cp\u003eThanks again for your report. Our engineering team has deployed a fix for this so the issue should no longer be reproducible. If you are able to bypass the fix, please let us know.\u003c/p\u003e\n\n\u003cp\u003eThanks for helping make Shopify more secure. We hope you\u0026#39;ll continue to do so.\u003c/p\u003e\n\n\u003cp\u003eHappy Hacking!\u003c/p\u003e\n","automated_response":false,"created_at":"2020-05-28T19:59:08.257Z","updated_at":"2020-05-28T19:59:08.257Z","actor":{"username":"leanne_shapton","cleared":false,"url":"/leanne_shapton","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"francisbeaudoin","url":"/francisbeaudoin"},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9219971,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-09-14T19:14:45.428Z","updated_at":"2020-09-14T19:14:45.428Z","first_to_agree":true,"actor":{"username":"abdulwahaab_ahmed","cleared":false,"url":"/abdulwahaab_ahmed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/166/726/fa53e0dd37718653edc8e2abea4724f3d0af03e9_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9220214,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-09-14T19:45:34.950Z","updated_at":"2020-09-14T19:45:34.950Z","actor":{"username":"francisbeaudoin","cleared":false,"url":"/francisbeaudoin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/apkjpoNQK4P5JD7rCFCB2hcf/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9220215,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-09-14T19:45:35.004Z","updated_at":"2020-09-14T19:45:35.004Z","actor":{"username":"francisbeaudoin","cleared":false,"url":"/francisbeaudoin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/apkjpoNQK4P5JD7rCFCB2hcf/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}