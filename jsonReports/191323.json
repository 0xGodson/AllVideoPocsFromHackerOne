{"id":191323,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xOTEzMjM=","url":"https://hackerone.com/reports/191323","title":"Sub Domain Takeover at mk.prd.vine.co","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-12-15T07:09:31.204Z","submitted_at":"2016-12-15T07:09:31.204Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"punkrock","url":"/punkrock","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/104/138/3cd74a4e085fec455d0b00931ceff8385b4a8c40_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":61,"url":"https://hackerone.com/twitter","handle":"twitter","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/061/85a63a443f017ad8353de4f68ebf52fdd61c345a_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/061/85a63a443f017ad8353de4f68ebf52fdd61c345a_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Twitter","twitter_handle":"twittersecurity","website":"https://twitter.com","about":"Twitter helps you create and share ideas and information instantly, without barriers."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-02-13T22:04:02.039Z","bug_reporter_agreed_on_going_public_at":"2017-01-17T18:36:31.281Z","team_member_agreed_on_going_public_at":"2017-02-13T22:04:01.996Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hey\n\nIt looks like the EC2 Instance at `mk.prd.vine.co` has been stopped and now it has been assigned to someone else\n\n#### Proof of Concept\n\n1. `http://mk.prd.vine.co/` few days back didn't have port 443 open but now it does have an open port 443\n\nResponse \n```\n\u003c HTTP/1.1 426 Upgrade Required\n\u003c Date: Thu, 15 Dec 2016 07:06:34 GMT\n\u003c Content-Type: text/plain\n\u003c Content-Length: 16\n\u003c Connection: keep-alive\n```\n\nAlso `http://mk.prd.vine.co/%00` pops an error\n\n```\n\u003c HTTP/1.1 400 Bad Request\n* Server awselb/2.0 is not blacklisted\n\u003c Server: awselb/2.0\n\u003c Date: Thu, 15 Dec 2016 07:06:58 GMT\n\u003c Content-Type: text/html\n\u003c Content-Length: 171\n\u003c Connection: close\n\n\u003chtml\u003e\n\u003chead\u003e\u003ctitle\u003e400 Bad Request\u003c/title\u003e\u003c/head\u003e\n\u003cbody bgcolor=\"white\"\u003e\n\u003ccenter\u003e\u003ch1\u003e400 Bad Request\u003c/h1\u003e\u003c/center\u003e\n\u003chr\u003e\u003ccenter\u003eawselb/2.0\u003c/center\u003e\n\u003c/body\u003e\n\u003c/html\u003e\n```\n\nSo it looks like now someone's load balancer is pointing to `mk.prd.vine.co`","vulnerability_information_html":"\u003cp\u003eHey\u003c/p\u003e\n\n\u003cp\u003eIt looks like the EC2 Instance at \u003ccode\u003emk.prd.vine.co\u003c/code\u003e has been stopped and now it has been assigned to someone else\u003c/p\u003e\n\n\u003ch4 id=\"proof-of-concept\"\u003eProof of Concept\u003c/h4\u003e\n\n\u003col\u003e\n\u003cli\u003e\n\u003ccode\u003ehttp://mk.prd.vine.co/\u003c/code\u003e few days back didn\u0026#39;t have port 443 open but now it does have an open port 443\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eResponse \u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e\u0026lt; HTTP/1.1 426 Upgrade Required\n\u0026lt; Date: Thu, 15 Dec 2016 07:06:34 GMT\n\u0026lt; Content-Type: text/plain\n\u0026lt; Content-Length: 16\n\u0026lt; Connection: keep-alive\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eAlso \u003ccode\u003ehttp://mk.prd.vine.co/%00\u003c/code\u003e pops an error\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight html\"\u003e\u003ccode\u003e\u003cspan class=\"nt\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"nt\"\u003eHTTP\u003c/span\u003e\u003cspan class=\"err\"\u003e/\u003c/span\u003e\u003cspan class=\"na\"\u003e1\u003c/span\u003e\u003cspan class=\"err\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003e1\u003c/span\u003e \u003cspan class=\"na\"\u003e400\u003c/span\u003e \u003cspan class=\"na\"\u003eBad\u003c/span\u003e \u003cspan class=\"na\"\u003eRequest\u003c/span\u003e\n\u003cspan class=\"na\"\u003e*\u003c/span\u003e \u003cspan class=\"na\"\u003eServer\u003c/span\u003e \u003cspan class=\"na\"\u003eawselb\u003c/span\u003e\u003cspan class=\"err\"\u003e/\u003c/span\u003e\u003cspan class=\"na\"\u003e2\u003c/span\u003e\u003cspan class=\"err\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003e0\u003c/span\u003e \u003cspan class=\"na\"\u003eis\u003c/span\u003e \u003cspan class=\"na\"\u003enot\u003c/span\u003e \u003cspan class=\"na\"\u003eblacklisted\u003c/span\u003e\n\u003cspan class=\"err\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"na\"\u003eServer:\u003c/span\u003e \u003cspan class=\"na\"\u003eawselb\u003c/span\u003e\u003cspan class=\"err\"\u003e/\u003c/span\u003e\u003cspan class=\"na\"\u003e2\u003c/span\u003e\u003cspan class=\"err\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003e0\u003c/span\u003e\n\u003cspan class=\"err\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"na\"\u003eDate:\u003c/span\u003e \u003cspan class=\"na\"\u003eThu\u003c/span\u003e\u003cspan class=\"err\"\u003e,\u003c/span\u003e \u003cspan class=\"na\"\u003e15\u003c/span\u003e \u003cspan class=\"na\"\u003eDec\u003c/span\u003e \u003cspan class=\"na\"\u003e2016\u003c/span\u003e \u003cspan class=\"na\"\u003e07:06:58\u003c/span\u003e \u003cspan class=\"na\"\u003eGMT\u003c/span\u003e\n\u003cspan class=\"err\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"na\"\u003eContent-Type:\u003c/span\u003e \u003cspan class=\"na\"\u003etext\u003c/span\u003e\u003cspan class=\"err\"\u003e/\u003c/span\u003e\u003cspan class=\"na\"\u003ehtml\u003c/span\u003e\n\u003cspan class=\"err\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"na\"\u003eContent-Length:\u003c/span\u003e \u003cspan class=\"na\"\u003e171\u003c/span\u003e\n\u003cspan class=\"err\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"na\"\u003eConnection:\u003c/span\u003e \u003cspan class=\"na\"\u003eclose\u003c/span\u003e\n\n\u003cspan class=\"err\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"na\"\u003ehtml\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;head\u0026gt;\u0026lt;title\u0026gt;\u003c/span\u003e400 Bad Request\u003cspan class=\"nt\"\u003e\u0026lt;/title\u0026gt;\u0026lt;/head\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;body\u003c/span\u003e \u003cspan class=\"na\"\u003ebgcolor=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;white\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;center\u0026gt;\u0026lt;h1\u0026gt;\u003c/span\u003e400 Bad Request\u003cspan class=\"nt\"\u003e\u0026lt;/h1\u0026gt;\u0026lt;/center\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;hr\u0026gt;\u0026lt;center\u0026gt;\u003c/span\u003eawselb/2.0\u003cspan class=\"nt\"\u003e\u0026lt;/center\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/body\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/html\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eSo it looks like now someone\u0026#39;s load balancer is pointing to \u003ccode\u003emk.prd.vine.co\u003c/code\u003e\u003c/p\u003e\n","bounty_amount":"140.0","formatted_bounty":"$140","original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2017-02-16T18:36:31.332Z","allow_singular_disclosure_after":-121947165.48809567,"singular_disclosure_allowed":true,"vote_count":4,"voters":["spam404","0xatul","eveeez","spetr0x"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1367779,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Thank you for your report.\n\nGetting an error when navigating to a subdomain does not necessarily mean that the subdomain is vulnerable to a takeover. Can you elaborate on why you believe that a 3rd party has taken control of this subdomain?\n\nThank you for thinking of Twitter security.\n","markdown_message":"\u003cp\u003eThank you for your report.\u003c/p\u003e\n\n\u003cp\u003eGetting an error when navigating to a subdomain does not necessarily mean that the subdomain is vulnerable to a takeover. Can you elaborate on why you believe that a 3rd party has taken control of this subdomain?\u003c/p\u003e\n\n\u003cp\u003eThank you for thinking of Twitter security.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-12-15T21:10:24.237Z","updated_at":"2016-12-15T21:10:24.237Z","actor":{"username":"bugtriage-jason","cleared":false,"url":"/bugtriage-jason","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1368186,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"@bugtriage-jason \nYes\n\nWell I maintain the records of all the sub-domain I find along with the headers and body\n\n`mk.prd.vine.co` didn't respond few days ago at port `443`\nSo most likely this is yet another sub domain pointing to internal EC2 instance\n\nNow I see there's a open port `443` which says `AWSELB` as the server behind it\nI have reported the reports in the past on the same process which turned out to be true like `27.prd.vine.co`","markdown_message":"\u003cp\u003e\u003ca href=\"/bugtriage-jason\"\u003e@bugtriage-jason\u003c/a\u003e \u003cbr\u003e\nYes\u003c/p\u003e\n\n\u003cp\u003eWell I maintain the records of all the sub-domain I find along with the headers and body\u003c/p\u003e\n\n\u003cp\u003e\u003ccode\u003emk.prd.vine.co\u003c/code\u003e didn\u0026#39;t respond few days ago at port \u003ccode\u003e443\u003c/code\u003e\u003cbr\u003e\nSo most likely this is yet another sub domain pointing to internal EC2 instance\u003c/p\u003e\n\n\u003cp\u003eNow I see there\u0026#39;s a open port \u003ccode\u003e443\u003c/code\u003e which says \u003ccode\u003eAWSELB\u003c/code\u003e as the server behind it\u003cbr\u003e\nI have reported the reports in the past on the same process which turned out to be true like \u003ccode\u003e27.prd.vine.co\u003c/code\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2016-12-16T01:03:51.946Z","updated_at":"2016-12-16T01:03:51.946Z","actor":{"username":"punkrock","cleared":false,"url":"/punkrock","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/104/138/3cd74a4e085fec455d0b00931ceff8385b4a8c40_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1369684,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thank you for your report. We believe it may be a valid security issue and will investigate it further. It could take some time to find and update the root cause for an issue, so we thank you for your patience.\n\nThank you for helping keep Twitter secure!","markdown_message":"\u003cp\u003eThank you for your report. We believe it may be a valid security issue and will investigate it further. It could take some time to find and update the root cause for an issue, so we thank you for your patience.\u003c/p\u003e\n\n\u003cp\u003eThank you for helping keep Twitter secure!\u003c/p\u003e\n","automated_response":false,"created_at":"2016-12-16T18:08:15.441Z","updated_at":"2016-12-16T18:08:15.441Z","actor":{"username":"andrewsorensen","cleared":false,"url":"/andrewsorensen","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1370587,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks again. As mentioned we’ll keep you updated as we investigate further. As a reminder, please remember to keep the details of this report private until we have fully investigated and addressed the issue.","markdown_message":"\u003cp\u003eThanks again. As mentioned we’ll keep you updated as we investigate further. As a reminder, please remember to keep the details of this report private until we have fully investigated and addressed the issue.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-12-17T00:29:31.104Z","updated_at":"2016-12-17T00:29:31.104Z","actor":{"url":"/twitter","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/061/85a63a443f017ad8353de4f68ebf52fdd61c345a_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Twitter"}},"bounty_amount":"140.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"twitter","collaborator":{"username":"punkrock","url":"/punkrock"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1370874,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@andrewsorensen \nI can't resolve the domain, Seems fixed\nThanks for the bounty Sir","markdown_message":"\u003cp\u003e\u003ca href=\"/andrewsorensen\"\u003e@andrewsorensen\u003c/a\u003e \u003cbr\u003e\nI can\u0026#39;t resolve the domain, Seems fixed\u003cbr\u003e\nThanks for the bounty Sir\u003c/p\u003e\n","automated_response":false,"created_at":"2016-12-17T04:38:11.171Z","updated_at":"2016-12-17T04:38:46.913Z","actor":{"username":"punkrock","cleared":false,"url":"/punkrock","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/104/138/3cd74a4e085fec455d0b00931ceff8385b4a8c40_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1382966,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@andrewsorensen \nCan you please close this as resolved ?","markdown_message":"\u003cp\u003e\u003ca href=\"/andrewsorensen\"\u003e@andrewsorensen\u003c/a\u003e \u003cbr\u003e\nCan you please close this as resolved ?\u003c/p\u003e\n","automated_response":false,"created_at":"2016-12-23T02:39:04.201Z","updated_at":"2016-12-23T02:39:04.201Z","actor":{"username":"punkrock","cleared":false,"url":"/punkrock","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/104/138/3cd74a4e085fec455d0b00931ceff8385b4a8c40_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1409301,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"We consider this issue to be fixed now.\n\nThank you for helping keep Twitter secure!","markdown_message":"\u003cp\u003eWe consider this issue to be fixed now.\u003c/p\u003e\n\n\u003cp\u003eThank you for helping keep Twitter secure!\u003c/p\u003e\n","automated_response":false,"created_at":"2017-01-09T19:09:12.321Z","updated_at":"2017-01-09T19:09:12.321Z","actor":{"username":"andrewsorensen","cleared":false,"url":"/andrewsorensen","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"punkrock","url":"/punkrock"},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1425442,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Pretty Please ?","markdown_message":"\u003cp\u003ePretty Please ?\u003c/p\u003e\n","automated_response":false,"created_at":"2017-01-17T18:36:31.301Z","updated_at":"2017-01-17T18:36:31.301Z","first_to_agree":true,"actor":{"username":"punkrock","cleared":false,"url":"/punkrock","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/104/138/3cd74a4e085fec455d0b00931ceff8385b4a8c40_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1483514,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-02-13T22:04:02.012Z","updated_at":"2017-02-13T22:04:02.012Z","actor":{"username":"andrewsorensen","cleared":false,"url":"/andrewsorensen","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1483515,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-02-13T22:04:02.078Z","updated_at":"2017-02-13T22:04:02.078Z","actor":{"username":"andrewsorensen","cleared":false,"url":"/andrewsorensen","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}