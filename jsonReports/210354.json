{"id":210354,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMTAzNTQ=","url":"https://hackerone.com/reports/210354","title":"RTLO character in file names","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2017-03-03T12:24:59.551Z","submitted_at":"2017-03-03T12:24:59.551Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"inhibitor181","url":"/inhibitor181","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/iK9ytFYT28QM6G5xrCaphqnv/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":8906,"url":"https://hackerone.com/open-xchange","handle":"open-xchange","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/JtYLEsu5yRZxGitSmAjeAFtK/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/JtYLEsu5yRZxGitSmAjeAFtK/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Open-Xchange","twitter_handle":"openxchange","website":"https://www.open-xchange.com/","about":"Messaging, collaboration and office productivity software for service providers"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2017-09-28T07:19:38.117Z","bug_reporter_agreed_on_going_public_at":"2017-08-29T07:19:20.111Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"DESCRIPTION\n-------\nHello, I have noticed that you allow the RTLO (Right-To-Left-Override) character is not filtered from the names of the files saved to drive, or in the attachement names, thus allowing 2 things :\n1. Someone sends a malicious file (html or exe or something esle) via email that contains a strategically placed RTLO in the filename, making the filename be rendered like Testlmth.txt that is actually a html file or Testexe.txt that is an actual .exe file. Then, the OX user downloads the file and quickly wants to open it and triggers the html or exe on his machine.\n2. An OX user saves a file to drive with a strategically places a RTLO character and then shares it with somebody else, or waits another user to download it and open it.\n\nPOC\n---------\n2 videos attached. The first video contains the steps needed to rename a file using the RTLO character and in the second one, I have sent by email a file that was renamed on my machine using a RTLO character. After that, I have opened the file through the OX frontend.\n\n\n","vulnerability_information_html":"\u003ch2 id=\"description\"\u003eDESCRIPTION\u003c/h2\u003e\n\n\u003cp\u003eHello, I have noticed that you allow the RTLO (Right-To-Left-Override) character is not filtered from the names of the files saved to drive, or in the attachement names, thus allowing 2 things :\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eSomeone sends a malicious file (html or exe or something esle) via email that contains a strategically placed RTLO in the filename, making the filename be rendered like Testlmth.txt that is actually a html file or Testexe.txt that is an actual .exe file. Then, the OX user downloads the file and quickly wants to open it and triggers the html or exe on his machine.\u003c/li\u003e\n\u003cli\u003eAn OX user saves a file to drive with a strategically places a RTLO character and then shares it with somebody else, or waits another user to download it and open it.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003ch2 id=\"poc\"\u003ePOC\u003c/h2\u003e\n\n\u003cp\u003e2 videos attached. The first video contains the steps needed to rename a file using the RTLO character and in the second one, I have sent by email a file that was renamed on my machine using a RTLO character. After that, I have opened the file through the OX frontend.\u003c/p\u003e\n","bounty_amount":"250.0","formatted_bounty":"$250","weakness":{"id":74,"name":"UI Redressing (Clickjacking)"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2017-09-28T07:19:20.160Z","allow_singular_disclosure_after":-102634633.40810664,"singular_disclosure_allowed":true,"vote_count":8,"voters":["sp1d3rs","sameerphad72","chaosbolt","vijay_kumar","eveeez","r3y","sumit7","spetr0x"],"severity":{"rating":"low","author_type":"Team"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1521530,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Thanks for the report, please attach a sample mail which demonstrates this PoC.","markdown_message":"\u003cp\u003eThanks for the report, please attach a sample mail which demonstrates this PoC.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-03-06T11:20:59.637Z","updated_at":"2017-03-06T11:20:59.637Z","actor":{"username":"mheiland","cleared":false,"url":"/mheiland","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/425JKsXEnCYsDU1VA48SXXZV/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1521557,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Hi @mheiland . I have attached the file (hope hackerone uploading do not mess the name up -\u003e you can also see here that the text is inverted after a certain point). __But you cannot download the file and then re-upload it, because after downloading the real name will be written__. \n\nUpdate : __Yes, hackerone handles this character and strips it out, so I cannot upload it. You need to do like in the rtlo.mkv video to create the file locally__\n\nI have made a video in where I show you how to create a file like the one in the attachement on your computer, then you can send an email with that respective file as attachement to an OX user.\n\nAs a sandbox sample, you can login with user user2@sandbox-1.open-xchange.com, check the last mail from me. Also the file has been saved in drive under xxx folder from the email.","markdown_message":"\u003cp\u003eHi \u003ca href=\"/mheiland\"\u003e@mheiland\u003c/a\u003e . I have attached the file (hope hackerone uploading do not mess the name up -\u0026gt; you can also see here that the text is inverted after a certain point). \u003cstrong\u003eBut you cannot download the file and then re-upload it, because after downloading the real name will be written\u003c/strong\u003e. \u003c/p\u003e\n\n\u003cp\u003eUpdate : \u003cstrong\u003eYes, hackerone handles this character and strips it out, so I cannot upload it. You need to do like in the rtlo.mkv video to create the file locally\u003c/strong\u003e\u003c/p\u003e\n\n\u003cp\u003eI have made a video in where I show you how to create a file like the one in the attachement on your computer, then you can send an email with that respective file as attachement to an OX user.\u003c/p\u003e\n\n\u003cp\u003eAs a sandbox sample, you can login with user \u003ca title=\"user2@sandbox-1.open-xchange.com\" href=\"mailto:user2@sandbox-1.open-xchange.com\" rel=\"nofollow noopener noreferrer\"\u003euser2@sandbox-1.open-xchange.com\u003c/a\u003e, check the last mail from me. Also the file has been saved in drive under xxx folder from the email.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-03-06T11:37:41.482Z","updated_at":"2017-03-06T11:39:27.055Z","actor":{"username":"inhibitor181","cleared":true,"url":"/inhibitor181","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/iK9ytFYT28QM6G5xrCaphqnv/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":166671,"filename":"file_txt.html","type":"text/html","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/166/671/ea768522fdc9b9057f0aad7178f196bc63b55368/file_txt.html?response-content-disposition=attachment%3B%20filename%3D%22file_txt.html%22%3B%20filename%2A%3DUTF-8%27%27file_txt.html\u0026response-content-type=application%2Foctet-stream\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ2CQCXB7P%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T045633Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJj%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCKfc9uxh22FGIBSKNqNzEdwAGilNzlyCJlRQkk6L7ywwIgTF9zV46T%2F8NjN%2BIYnxBP9uKa%2FXVMex8eb6F8QfoW3wEqtAMIURABGgwwMTM2MTkyNzQ4NDkiDJ5ZNSNolCYK8UaqCyqRAzNhE%2Fm3zPdEHRm5WUEnZo0COkaeE9dAwJeLRl1TZ11d43Lhd%2FMikAINQoGyi4r4ILldIaNgVmSsjmb0fcorizPel9Yzwr4cFLsZOlxR5w1wIcH9%2B%2FXSVM%2FPyc6y3YiLMP%2BnfwLJ7AL67U%2BsYNgwrwRQCUMORslIWy4Bee0CRE37pQRcD%2BpnBGoZEqEgw%2FHEeFzSipLRBmOXQXxK8U%2FyZbCwKI3Y7jZdrKPqHfhEodvEeD0Wwknnt5JRb8OwCuT7%2BjnXPx7Ftl6fh7ZHEZSimVCNgNXHtQ7MayTMvGyEcE%2FGEdWIy%2BvUTFD59Sbk%2B4fSP5XGoClsVLqX8UQRsOAbpYFv8pGdRWsta2NjZfh4swj28Z1ENJENNBr0wiLwpBy4s4wlkmS86icFZ53iBsI3EOJmZJ5DZ5redWS7l%2BgYoOpzpgENRZcaEYNEAzZuOnjhHMp0RSoAnDuPybSiBCQrW8JftW%2Buq0QzjkbBqzj7nPJ0%2FbXQQzRl4pJZycpxagVMpzjAmvRed9%2BHfODrR1Wa1B9bMPDlqf8FOusBVFGMNirRKMu5AkI7qGagYnYSG4HpDqpKcH5QuM0jUoRkB5r%2BZWkCPAsBHe6t6p0Cfzk0IF3j5b1WbHsN2UHZ8rtF%2BtQ%2F7OawY4eFB8qp9BuOlUA1okg7%2BXvgui2gDL6mFoU2mzqz8v%2BmiFTIaBj8QjYyPX%2Ft4bj%2FyE7%2BzfsRuoeKoPtREJbjscDMF4yK366F0eCTIiw1cnRHt2i638RsSrY3MoN%2BD241aZxfV0getVCLrP4EjZE1CMOAzzhsZEa%2B%2BPrZg0WXd5TN40IoVxY7vjGdJo5rtxp6xBPK%2FbNPk5gPBu93zpBV2vOdiQ%3D%3D\u0026X-Amz-Signature=1f14a82851be0e9c1fbc9141087b6e1a3d00cc533ca664ba85ce35bb2b471884"}],"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1521835,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks i got the mail from user2's account. \"Save as file\" preserves the mails attachment file names and allows to create a file to reproduce the issue.","markdown_message":"\u003cp\u003eThanks i got the mail from user2\u0026#39;s account. \u0026quot;Save as file\u0026quot; preserves the mails attachment file names and allows to create a file to reproduce the issue.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-03-06T14:13:08.684Z","updated_at":"2017-03-06T14:13:08.684Z","actor":{"username":"mheiland","cleared":false,"url":"/mheiland","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/425JKsXEnCYsDU1VA48SXXZV/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1522093,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2017-03-06T15:59:27.941Z","updated_at":"2017-03-06T15:59:27.941Z","actor":{"username":"mheiland","cleared":false,"url":"/mheiland","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/425JKsXEnCYsDU1VA48SXXZV/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1537798,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2017-03-13T15:48:36.807Z","updated_at":"2017-03-13T15:48:36.807Z","actor":{"url":"/open-xchange","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/JtYLEsu5yRZxGitSmAjeAFtK/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Open-Xchange"}},"bounty_amount":"250.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"open-xchange","collaborator":{"username":"inhibitor181","url":"/inhibitor181"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1558912,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Closing this report as resolved, we're exploring various options to solve this and will provide a fix soon.","markdown_message":"\u003cp\u003eClosing this report as resolved, we\u0026#39;re exploring various options to solve this and will provide a fix soon.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-03-23T08:55:23.875Z","updated_at":"2017-03-23T08:55:23.875Z","actor":{"username":"mheiland","cleared":false,"url":"/mheiland","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/425JKsXEnCYsDU1VA48SXXZV/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"inhibitor181","url":"/inhibitor181"},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1962202,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-08-29T07:19:20.136Z","updated_at":"2017-08-29T07:19:20.136Z","first_to_agree":true,"actor":{"username":"inhibitor181","cleared":true,"url":"/inhibitor181","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/iK9ytFYT28QM6G5xrCaphqnv/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2029273,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-09-28T07:19:38.167Z","updated_at":"2017-09-28T07:19:38.167Z","actor":{"url":"/open-xchange","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/JtYLEsu5yRZxGitSmAjeAFtK/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Open-Xchange"}},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4916996,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2019-05-24T12:19:02.815Z","updated_at":"2019-05-24T12:19:02.815Z","additional_data":{"old_severity":null,"new_severity":"Low","old_severity_id":null,"new_severity_id":401097},"actor":{"username":"mheiland","cleared":false,"url":"/mheiland","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/425JKsXEnCYsDU1VA48SXXZV/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}