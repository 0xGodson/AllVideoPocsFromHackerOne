{"id":838127,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC84MzgxMjc=","url":"https://hackerone.com/reports/838127","title":"mb_strtolower (UTF-32LE): stack-buffer-overflow at php_unicode_tolower_full (CVE-2020-7065)","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2020-04-03T12:14:40.349Z","submitted_at":"2020-04-03T12:14:40.349Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"anatoliq","url":"/anatoliq","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":29,"url":"https://hackerone.com/ibb-php","handle":"ibb-php","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/029/99087dbbdf52fc3ce3acbf16aa33a5c4f5e2c111_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/029/99087dbbdf52fc3ce3acbf16aa33a5c4f5e2c111_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"paused","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"PHP (IBB)","twitter_handle":"","website":"http://www.php.net","about":""}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2020-10-21T07:56:56.251Z","bug_reporter_agreed_on_going_public_at":"2020-10-21T07:56:56.162Z","team_member_agreed_on_going_public_at":"2020-10-10T01:44:56.359Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"PHP bug report (made public by the maintainers at the time of writing): https://bugs.php.net/bug.php?id=79371\nMitre CVE page: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-7065\nLink to the release notes: https://www.php.net/ChangeLog-7.php#7.4.4\n\n## Impact\n\nOne of impacts is that the issue allows an attacker to straightforwardly crash the PHP interpreter provided a specific UTF character can be passed to `mb_strtolower` function dealing with UTF-32LE encoding. \n\nOriginal summary from the bug report:\n\u003e A call to `mb_strtolower` allows overwriting of a stack-allocated buffer with an overflown array from .rodata.\n\nDescription as provided by CVE database entry:\n\u003e In PHP versions 7.3.x below 7.3.16 and 7.4.x below 7.4.34, while using mb_strtolower() function with UTF-32LE encoding, certain invalid strings could cause PHP to overwrite stack-allocated buffer. This could lead to memory corruption, crashes and potentially code execution.","vulnerability_information_html":"\u003cp\u003ePHP bug report (made public by the maintainers at the time of writing): \u003ca title=\"https://bugs.php.net/bug.php?id=79371\" href=\"/redirect?url=https%3A%2F%2Fbugs.php.net%2Fbug.php%3Fid%3D79371\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://bugs.php.net/bug.php?id=79371\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nMitre CVE page: \u003ca title=\"https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-7065\" href=\"/redirect?url=https%3A%2F%2Fcve.mitre.org%2Fcgi-bin%2Fcvename.cgi%3Fname%3DCVE-2020-7065\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-7065\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nLink to the release notes: \u003ca title=\"https://www.php.net/ChangeLog-7.php#7.4.4\" href=\"/redirect?url=https%3A%2F%2Fwww.php.net%2FChangeLog-7.php%237.4.4\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.php.net/ChangeLog-7.php#7.4.4\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eOne of impacts is that the issue allows an attacker to straightforwardly crash the PHP interpreter provided a specific UTF character can be passed to \u003ccode\u003emb_strtolower\u003c/code\u003e function dealing with UTF-32LE encoding. \u003c/p\u003e\n\n\u003cp\u003eOriginal summary from the bug report:\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eA call to \u003ccode\u003emb_strtolower\u003c/code\u003e allows overwriting of a stack-allocated buffer with an overflown array from .rodata.\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eDescription as provided by CVE database entry:\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eIn PHP versions 7.3.x below 7.3.16 and 7.4.x below 7.4.34, while using mb_strtolower() function with UTF-32LE encoding, certain invalid strings could cause PHP to overwrite stack-allocated buffer. This could lead to memory corruption, crashes and potentially code execution.\u003c/p\u003e\n\u003c/blockquote\u003e\n","bounty_amount":"1500.0","formatted_bounty":"$1,500","weakness":{"id":4,"name":"Stack Overflow"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2020-11-09T01:44:56.469Z","allow_singular_disclosure_after":-4338899.314112549,"singular_disclosure_allowed":true,"vote_count":40,"voters":["secator","prophet","johndoe1492","qtros","grampae","mayurudiniya","4xrhd","ov3rflow1","katravath55","bf04117193c0b72a9009252","and 30 more..."],"severity":{"rating":"high","author_type":"Team"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":7531238,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @anatoliq,\n\nThank you for your submission. Your report is currently being reviewed and the HackerOne triage team will get back to you once there is additional information to share.\n\nKind regards,\n@celt","markdown_message":"\u003cp\u003eHi \u003ca href=\"/anatoliq\"\u003e@anatoliq\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThank you for your submission. Your report is currently being reviewed and the HackerOne triage team will get back to you once there is additional information to share.\u003c/p\u003e\n\n\u003cp\u003eKind regards,\u003cbr\u003e\n\u003ca href=\"/celt\"\u003e@celt\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2020-04-03T15:20:11.875Z","updated_at":"2020-04-03T15:20:11.875Z","actor":{"username":"celt","cleared":false,"url":"/celt","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/CbJ76SLbXk5Eh7qbt9ejXyQB/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"ibb-php","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7531254,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2020-04-03T15:21:32.833Z","updated_at":"2020-04-03T15:21:32.833Z","additional_data":{"old_severity":null,"new_severity":"High","old_severity_id":null,"new_severity_id":679856},"actor":{"username":"celt","cleared":false,"url":"/celt","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/CbJ76SLbXk5Eh7qbt9ejXyQB/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"ibb-php","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7531257,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hello @anatoliq,\n\nThank you for your submission! We were able to validate your report, and have submitted it to the appropriate remediation team for review. They will let us know the final ruling on this report, and when/if a fix will be implemented. Please note that the status and severity are subject to change.\n\nRegards,\n@celt","markdown_message":"\u003cp\u003eHello \u003ca href=\"/anatoliq\"\u003e@anatoliq\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThank you for your submission! We were able to validate your report, and have submitted it to the appropriate remediation team for review. They will let us know the final ruling on this report, and when/if a fix will be implemented. Please note that the status and severity are subject to change.\u003c/p\u003e\n\n\u003cp\u003eRegards,\u003cbr\u003e\n\u003ca href=\"/celt\"\u003e@celt\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2020-04-03T15:21:38.288Z","updated_at":"2020-04-03T15:21:38.288Z","actor":{"username":"celt","cleared":false,"url":"/celt","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/CbJ76SLbXk5Eh7qbt9ejXyQB/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"ibb-php","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9373074,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Ping.","markdown_message":"\u003cp\u003ePing.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-09-30T09:56:42.876Z","updated_at":"2020-09-30T09:56:42.876Z","actor":{"username":"anatoliq","cleared":false,"url":"/anatoliq","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"ibb-php","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9478558,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2020-10-10T00:54:42.760Z","updated_at":"2020-10-10T00:54:42.760Z","actor":{"url":"/ibb-php","ibb":true,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/029/99087dbbdf52fc3ce3acbf16aa33a5c4f5e2c111_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"PHP (IBB)"}},"bounty_amount":"1500.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"ibb-php","collaborator":{"username":"anatoliq","url":"/anatoliq"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9478559,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hello @anatoliq,\n\nOn behalf of the Internet Bug Bounty Panel, thank you for your continued patience on this report. The IBB requires that all in-scope open source projects be mutually engaged with us to ensure there is a good experience for all. Unfortunately, we have not been able to maintain that relationship with the upstream PHP community, and as a result, HackerOne and the IBB Panel have collectively agreed to shut down the program indefinitely.\n\nIn an effort to reward researchers for their hard work and patience thus far, the IBB panel has elected to pay bounties to all valid reports without PHP’s input. Bounty amounts are decided on based on the PHP policy and severity assigned on the accompanying CVE. \n\nAs an act of good faith, we will also close this report as Resolved.\n\nThank you for helping keep the internet safe and secure!\n-The Internet Bug Bounty Panel \n","markdown_message":"\u003cp\u003eHello \u003ca href=\"/anatoliq\"\u003e@anatoliq\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eOn behalf of the Internet Bug Bounty Panel, thank you for your continued patience on this report. The IBB requires that all in-scope open source projects be mutually engaged with us to ensure there is a good experience for all. Unfortunately, we have not been able to maintain that relationship with the upstream PHP community, and as a result, HackerOne and the IBB Panel have collectively agreed to shut down the program indefinitely.\u003c/p\u003e\n\n\u003cp\u003eIn an effort to reward researchers for their hard work and patience thus far, the IBB panel has elected to pay bounties to all valid reports without PHP’s input. Bounty amounts are decided on based on the PHP policy and severity assigned on the accompanying CVE. \u003c/p\u003e\n\n\u003cp\u003eAs an act of good faith, we will also close this report as Resolved.\u003c/p\u003e\n\n\u003cp\u003eThank you for helping keep the internet safe and secure!\u003cbr\u003e\n-The Internet Bug Bounty Panel \u003c/p\u003e\n","automated_response":false,"created_at":"2020-10-10T00:54:55.715Z","updated_at":"2020-10-10T00:54:55.715Z","actor":{"username":"reed","cleared":false,"url":"/reed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"reporter":{"username":"anatoliq","url":"/anatoliq"},"genius_execution_id":null,"team_handle":"ibb-php","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9478668,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-10-10T01:44:56.380Z","updated_at":"2020-10-10T01:44:56.380Z","first_to_agree":true,"actor":{"username":"reed","cleared":false,"url":"/reed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"ibb-php","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9585314,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Thank you!","markdown_message":"\u003cp\u003eThank you!\u003c/p\u003e\n","automated_response":false,"created_at":"2020-10-21T07:56:56.184Z","updated_at":"2020-10-21T07:56:56.184Z","actor":{"username":"anatoliq","cleared":false,"url":"/anatoliq","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"ibb-php","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9585315,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-10-21T07:56:56.275Z","updated_at":"2020-10-21T07:56:56.275Z","actor":{"username":"anatoliq","cleared":false,"url":"/anatoliq","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"ibb-php","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}