{"id":74518,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC83NDUxOA==","url":"https://hackerone.com/reports/74518","title":"The email updates issues","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2015-07-08T21:19:29.475Z","submitted_at":"2015-07-08T21:19:29.475Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"s_p_q_r","url":"/s_p_q_r","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/032/547/1d8b3feccf1a8281a2285cdbfc482aaf3b046b22_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":293,"url":"https://hackerone.com/digitalsellz","handle":"digitalsellz","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/293/1bb2ed357dd1bcaa52d338cb5dd93d1e1adf1b4d_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/293/1bb2ed357dd1bcaa52d338cb5dd93d1e1adf1b4d_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"paused","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"DigitalSellz","twitter_handle":null,"website":"https://www.digitalsellz.com/","about":"Planning to sell your files? Need a platform to sell your new e-book? May be just music, photos, articles, digital art or movies? Try DigitalSellz.com"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2015-08-25T21:30:41.362Z","bug_reporter_agreed_on_going_public_at":"2015-07-26T21:30:32.529Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"1. The email message content at the https://www.digitalsellz.com/user/#/email-updates page (contrary to the [email customization one](https://www.digitalsellz.com/user/#/custom-email)) is not validated properly. So this form allows all the html tags and their parameters. For example, all the following tags are sent as is:\r\n\r\n\u003e \u003ca href=\"javascript:alert(0)\"\u003eLink\u003c/a\u003e\r\n\u003ca href='javascript:alert(1)'\u003eLink\u003c/a\u003e\r\n\u003cimg src=x onerror=\"alert(2)\" /\u003e\r\n\u003cscript\u003ealert(3)\u003c/script\u003e\r\n\r\nand all their scripts will be executed if the email service the customer uses doesn't have a proper protection itself. Of course most of the modern email services do this, but there are still some not too widespread ones that don't. This also relates to the customers that have their own servers and have the emails there.\r\n\r\nWell, it's the recipient system's vulnerability mostly, but you also shouldn't send executable code there. Otherwise it would be something like distributing viruses over your clients and saying it's their fault they don't use antivirus software :) Especially since it won't be too hard to fix it, cause you already have this done for the [email customization page](https://www.digitalsellz.com/user/#/custom-email) mentioned above — all the unnecessary tags and parameters are properly sanitized, so you just have to copy the validating code from there.\r\n\r\n2\\. Also I don't think it's a good idea to let anyone send whatever he wants on your behalf in general\r\n\r\nFor example, the attacker can send emails as follows:\r\n\r\n\u003e Due to the recent security issue some of our accounts have been compromised.\r\n\u003e\r\n\u003e We recommend you to change your password as soon as possible. To do this please click the following link:\r\n\u003e\r\n\u003e[Change your password](http://phishing_link)\r\n\r\nBeing sent on behalf of support@digitalsellz.com and designed kinda like your forget password mail, it can easily mislead the customers, so they will open the attacker's phishing link and put their login and password there.\r\n\r\nHe can also send something abusive or prohibited by law.\r\n","vulnerability_information_html":"\u003col\u003e\n\u003cli\u003eThe email message content at the \u003ca title=\"https://www.digitalsellz.com/user/#/email-updates\" href=\"/redirect?url=https%3A%2F%2Fwww.digitalsellz.com%2Fuser%2F%23%2Femail-updates\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.digitalsellz.com/user/#/email-updates\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e page (contrary to the \u003ca href=\"/redirect?url=https%3A%2F%2Fwww.digitalsellz.com%2Fuser%2F%23%2Fcustom-email\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eemail customization one\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e) is not validated properly. So this form allows all the html tags and their parameters. For example, all the following tags are sent as is:\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003e\u0026lt;a href=\u0026quot;javascript:alert(0)\u0026quot;\u0026gt;Link\u0026lt;/a\u0026gt;\u003cbr\u003e\n\u0026lt;a href=\u0026#39;javascript:alert(1)\u0026#39;\u0026gt;Link\u0026lt;/a\u0026gt;\u003cbr\u003e\n\u0026lt;img src=x onerror=\u0026quot;alert(2)\u0026quot; /\u0026gt;\u003cbr\u003e\n\u0026lt;script\u0026gt;alert(3)\u0026lt;/script\u0026gt;\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eand all their scripts will be executed if the email service the customer uses doesn\u0026#39;t have a proper protection itself. Of course most of the modern email services do this, but there are still some not too widespread ones that don\u0026#39;t. This also relates to the customers that have their own servers and have the emails there.\u003c/p\u003e\n\n\u003cp\u003eWell, it\u0026#39;s the recipient system\u0026#39;s vulnerability mostly, but you also shouldn\u0026#39;t send executable code there. Otherwise it would be something like distributing viruses over your clients and saying it\u0026#39;s their fault they don\u0026#39;t use antivirus software :) Especially since it won\u0026#39;t be too hard to fix it, cause you already have this done for the \u003ca href=\"/redirect?url=https%3A%2F%2Fwww.digitalsellz.com%2Fuser%2F%23%2Fcustom-email\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eemail customization page\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e mentioned above — all the unnecessary tags and parameters are properly sanitized, so you just have to copy the validating code from there.\u003c/p\u003e\n\n\u003cp\u003e2. Also I don\u0026#39;t think it\u0026#39;s a good idea to let anyone send whatever he wants on your behalf in general\u003c/p\u003e\n\n\u003cp\u003eFor example, the attacker can send emails as follows:\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eDue to the recent security issue some of our accounts have been compromised.\u003c/p\u003e\n\n\u003cp\u003eWe recommend you to change your password as soon as possible. To do this please click the following link:\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"/redirect?url=http%3A%2F%2Fphishing_link\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eChange your password\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eBeing sent on behalf of \u003ca title=\"support@digitalsellz.com\" href=\"mailto:support@digitalsellz.com\" rel=\"nofollow noopener noreferrer\"\u003esupport@digitalsellz.com\u003c/a\u003e and designed kinda like your forget password mail, it can easily mislead the customers, so they will open the attacker\u0026#39;s phishing link and put their login and password there.\u003c/p\u003e\n\n\u003cp\u003eHe can also send something abusive or prohibited by law.\u003c/p\u003e\n","original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2015-08-25T21:30:32.886Z","allow_singular_disclosure_after":-168686097.00546348,"singular_disclosure_allowed":true,"vote_count":2,"voters":["sw33tlie","spetr0x"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":503689,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hello again @s_p_q_r. Nice approach  with \"the email being sent on behalf of support@digitalsellz.com\".  We will fix this by changing the email to no-reply@digitalsellz.com and adding a security message at the end of the page.","markdown_message":"\u003cp\u003eHello again \u003ca href=\"/s_p_q_r\"\u003e@s_p_q_r\u003c/a\u003e. Nice approach  with \u0026quot;the email being sent on behalf of \u003ca title=\"support@digitalsellz.com\" href=\"mailto:support@digitalsellz.com\" rel=\"nofollow noopener noreferrer\"\u003esupport@digitalsellz.com\u003c/a\u003e\u0026quot;.  We will fix this by changing the email to \u003ca title=\"no-reply@digitalsellz.com\" href=\"mailto:no-reply@digitalsellz.com\" rel=\"nofollow noopener noreferrer\"\u003eno-reply@digitalsellz.com\u003c/a\u003e and adding a security message at the end of the page.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-07-09T04:56:19.061Z","updated_at":"2015-07-09T04:56:19.061Z","actor":{"username":"panchocosil","cleared":true,"url":"/panchocosil","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/460/fcd3435c16cd3ee97e1862bdaf92c7409c7e4267_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"digitalsellz","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":503969,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"This bug has been fixed. Can you confirm?","markdown_message":"\u003cp\u003eThis bug has been fixed. Can you confirm?\u003c/p\u003e\n","automated_response":false,"created_at":"2015-07-09T15:20:21.504Z","updated_at":"2015-07-09T15:20:21.504Z","actor":{"username":"panchocosil","cleared":true,"url":"/panchocosil","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/460/fcd3435c16cd3ee97e1862bdaf92c7409c7e4267_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"digitalsellz","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":504000,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"This is not fix. Will check again this also.","markdown_message":"\u003cp\u003eThis is not fix. Will check again this also.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-07-09T16:17:06.204Z","updated_at":"2015-07-09T16:17:06.204Z","actor":{"username":"panchocosil","cleared":true,"url":"/panchocosil","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/460/fcd3435c16cd3ee97e1862bdaf92c7409c7e4267_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"digitalsellz","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":510858,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Can you please confirm this bug it has been fixed?","markdown_message":"\u003cp\u003eCan you please confirm this bug it has been fixed?\u003c/p\u003e\n","automated_response":false,"created_at":"2015-07-15T22:29:46.193Z","updated_at":"2015-07-15T22:29:46.193Z","actor":{"username":"panchocosil","cleared":true,"url":"/panchocosil","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/460/fcd3435c16cd3ee97e1862bdaf92c7409c7e4267_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"digitalsellz","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":511819,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"This one looks like not fixed\n\n\u003e We will fix this by changing the email to no-reply@digitalsellz.com\n\nEmails are still sent from support@digitalsellz.com\n\n\u003e and adding a security message at the end of the page\n\nThe message \"We will never ask you for your password information via e-mail.\" has been added to the very end. So if the message is quite big and colorful, the recepient will more likely not even notice it.\n\nFurthermore, as mentioned above, html tags are allowed. So I can simply add the comment tag at the vey end, and the security message will disappear.\n\n__PoC:__\n\n1. Go to https://www.digitalsellz.com/user/#/email-updates\n2. Put \"Test \u003c!--\" as the email message\n3. Click \"Send Test Email\"\n4. Check your inbox\n\nThe message received doesn't have the security message.\n\nChecked this for my mail.ru box (see the attached screenshot) and some temp mail one as well.","markdown_message":"\u003cp\u003eThis one looks like not fixed\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eWe will fix this by changing the email to \u003ca title=\"no-reply@digitalsellz.com\" href=\"mailto:no-reply@digitalsellz.com\" rel=\"nofollow noopener noreferrer\"\u003eno-reply@digitalsellz.com\u003c/a\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eEmails are still sent from \u003ca title=\"support@digitalsellz.com\" href=\"mailto:support@digitalsellz.com\" rel=\"nofollow noopener noreferrer\"\u003esupport@digitalsellz.com\u003c/a\u003e\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eand adding a security message at the end of the page\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eThe message \u0026quot;We will never ask you for your password information via e-mail.\u0026quot; has been added to the very end. So if the message is quite big and colorful, the recepient will more likely not even notice it.\u003c/p\u003e\n\n\u003cp\u003eFurthermore, as mentioned above, html tags are allowed. So I can simply add the comment tag at the vey end, and the security message will disappear.\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003ePoC:\u003c/strong\u003e\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eGo to \u003ca title=\"https://www.digitalsellz.com/user/#/email-updates\" href=\"/redirect?url=https%3A%2F%2Fwww.digitalsellz.com%2Fuser%2F%23%2Femail-updates\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.digitalsellz.com/user/#/email-updates\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003ePut \u0026quot;Test \u0026lt;!--\u0026quot; as the email message\u003c/li\u003e\n\u003cli\u003eClick \u0026quot;Send Test Email\u0026quot;\u003c/li\u003e\n\u003cli\u003eCheck your inbox\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eThe message received doesn\u0026#39;t have the security message.\u003c/p\u003e\n\n\u003cp\u003eChecked this for my mail.ru box (see the attached screenshot) and some temp mail one as well.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-07-16T11:03:26.069Z","updated_at":"2015-07-16T11:03:26.069Z","actor":{"username":"s_p_q_r","cleared":false,"url":"/s_p_q_r","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/032/547/1d8b3feccf1a8281a2285cdbfc482aaf3b046b22_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":45336,"filename":"mail.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/045/336/57e33c7e6afc0d7f8a96b644d94448e18bb13449/mail.png?response-content-disposition=attachment%3B%20filename%3D%22mail.png%22%3B%20filename%2A%3DUTF-8%27%27mail.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQTYNHLLAI%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T064530Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHZ%2BW3HUv1n%2B6aR51XKyQUoltUs4dpenL8C5Ngq%2FaRRRAiEAmfsKW6s44zslbtLbjio7lyByPFrM4HhkqWc4BlKqI%2FsqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDEk2ujSH9wgIeNJFfSqRA5L87pajd4uBiMOahwiQWY9MCcYfdnrcw1IGaRg5TpxW7DR87N3npEJ347tYQoNG4qvz83ZIfPJaoV16%2BHSbvgHCloy0L2IJebFkXavQ%2FqP76i9C%2Fflz0T%2FAY7BQexVBAB81BDbhmxnE9q9peEXcv7DxPs6yUKcdy540RKUrN7uslxSA7j3G9JiTuJ6qb2%2F4wYsuXqZAjjjsCgg1mXnpWD2MBpvjLmy20fnWfTyEpbZx69BhUOjIiXGUwMwyU3vIR8mTDDVd0lLxGqVwqo7wgDElekHdTEW3qhMPXMlt6DlI6yj8Gdba%2FBl9Vc01EccnsQcPWyVJry%2FS5ynL9DMtJAAAFirbxDGfh3YyQKCitVKKFFQ%2BXcUVp%2FSwwBBOTy19C2elhYtpl6vcpcY0%2FpxhMV%2FLT11lv%2FW2w21ED7vsm1c%2FDgyMyGhcc5jxtzWgSuplAxsWTwQc5B1WrLELk6MdDLXcvxB6lqSlYR3jek%2FEqa3e3t%2FxycmED7JcchnTpltDpgBiVe4qfO%2B85c9LeAT9plTAMKDqqv8FOusBsw37kCqQM4gZ7GwocFGWO%2Bb%2BbNa2dgEi%2Fv9cXsb1AOYUnwz%2B%2FyPyUSoTx0mdn2JtBFbkLI2hWmV1Y9Plg4ywi43mIKFY5BXMieUzgwCaeF0glcm8O%2F5kugCvuf01QuIauHjpwGSFMitZi1h52iDxD6TQNrXkM8ak7hW52tsH0VpvrBIvM3fFeRl4cr81y%2FuM3ueoyxszwreZZnbZK4WIuk8LU9YhohKDj6BRCCLOA1ZWZip14mKPOWPa8WaAzVovmI9BYDR0AxC4M%2FMywNMPj4r12n4DpTYCcHFvsA18GtoCtKML64R8uPhkQw%3D%3D\u0026X-Amz-Signature=e94a16def6223c34382ff213847eb80085974556c16d3d42d4bb64e0ba55bc51"}],"genius_execution_id":null,"team_handle":"digitalsellz","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":525577,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"For now we will only add a message and change the email sender. Thanks for your report.","markdown_message":"\u003cp\u003eFor now we will only add a message and change the email sender. Thanks for your report.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-07-25T17:37:20.977Z","updated_at":"2015-07-25T17:37:20.977Z","actor":{"username":"panchocosil","cleared":true,"url":"/panchocosil","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/460/fcd3435c16cd3ee97e1862bdaf92c7409c7e4267_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"s_p_q_r","url":"/s_p_q_r"},"genius_execution_id":null,"team_handle":"digitalsellz","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":526317,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"You're welcome!","markdown_message":"\u003cp\u003eYou\u0026#39;re welcome!\u003c/p\u003e\n","automated_response":false,"created_at":"2015-07-26T21:30:32.686Z","updated_at":"2015-07-26T21:30:32.686Z","first_to_agree":true,"actor":{"username":"s_p_q_r","cleared":false,"url":"/s_p_q_r","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/032/547/1d8b3feccf1a8281a2285cdbfc482aaf3b046b22_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"digitalsellz","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":563068,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-08-25T21:30:42.175Z","updated_at":"2015-08-25T21:30:42.175Z","actor":{"url":"/digitalsellz","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/293/1bb2ed357dd1bcaa52d338cb5dd93d1e1adf1b4d_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"DigitalSellz"}},"genius_execution_id":null,"team_handle":"digitalsellz","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}