{"id":172137,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNzIxMzc=","url":"https://hackerone.com/reports/172137","title":"Authentication bypass on sso.ubnt.com via subdomain takeover of ping.ubnt.com","state":"Closed","substate":"duplicate","severity_rating":"high","readable_substate":"Duplicate","created_at":"2016-09-26T15:18:13.317Z","submitted_at":"2016-09-26T15:18:13.317Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"arneswinnen","url":"/arneswinnen","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/061/086/26dedde13e2d4ec49acf71a95f522b54dd5e659c_original.JPG/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":800,"url":"https://hackerone.com/ui","handle":"ui","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/800/449ca06f77c3e1dd1979bae1e5f16150334f7479_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/800/449ca06f77c3e1dd1979bae1e5f16150334f7479_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Ubiquiti Inc.","twitter_handle":"ubnt","website":"https://ui.com","about":""}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2016-11-29T08:39:46.444Z","bug_reporter_agreed_on_going_public_at":"2016-10-28T20:32:51.252Z","team_member_agreed_on_going_public_at":"2016-11-29T08:39:46.398Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"# Summary\nThis is not a standard vulnerability, but a chain of two more exotic vulnerabilities leading to a full authentication bypass of your SSO login system at sso.ubnt.com (via account.ubnt.com). The root cause of this authentication bypass is two-fold:\n\n1. Subdomain ping.ubnt.com was pointing to Amazon Cloudfront CDN, but the hostname was not registered there anymore. This allowed me to fully takeover this domain. It is now serving content of my own webserver, both over http and https.\n2. The session cookie of your SSO subdomain sso.ubnt.com is (deliberately?) shared with all https://*.ubnt.com subdomains through its \"domain=.ubnt.com\" attribute. This allows leakage of this high-value session cookie to the overtaken subdomain https://ping.ubnt.com in all modern browsers.\n\n# Impact\n\nThe following attack scenario was invented: Assume that a victim is logged in in his/her browser to any of the `*.ubnt.com` services via the SSO system at account.ubnt.com, which uses sso.ubnt.com under the hood. If an attacker can then let the victim make a request to ping.ubnt.com in a second browser tab, either on purpose or unknowingly, the browser will transparently add the session cookie \"UBIC_AUTH\" set by sso.ubnt.com to this subdomain. Since the attacker has full visibility into incoming requests to his/her webserver (in this case, mine), the session cookie is now compromised. Once the attacker's got his/her hands on the session cookie, he/she can now hijack the victim's session on sso.ubnt.com. Since sso.ubnt.com is the centralized place where authentication occurs for all `*.ubnt.com` services (and perhaps even on other domains via OAuth?), this is a major risk, as an attacker can now impersonate the victim on **all** their Ubiquity services and connected devices who rely on SSO for authentication. \n\nIn order for this depicted attack to work, the following questions still remain:\n- Valid SSL Certificate: the \"UBIC_AUTH\" session cookie has the \"secure\" cookie attribute set, which instructs the browser to only send its value over a secured channel. This means that the browser will only send it to https://ping.ubnt.com but not to http://ping.ubnt.com, which now requires the attacker to have a valid SSL certificate for this domain. However, many Certificate Authorities support automated domain verification through hosting a specific HTML file in the root directory of a (sub)domain nowadays (e.g. [Lets Encrypt](https://letsencrypt.org/how-it-works/), [GoDaddy]( https://be.godaddy.com/help/verify-domain-ownership-html-or-dns-7452 ), ...). Since the subdomain takeover yields the attacker complete control over the webserver serving ping.ubnt.com, this would be trivial. This was not performed as a PoC to not upset you by generating a malicious SSL certificate for your domain and effectively deploying it on a production system, but feel free to give me a heads up if you would like me to actually proceed with this attack scenario. It is literally [one command with the certbot utility](https://certbot.eff.org/#ubuntutrusty-apache) and [free to deploy on AWS Cloudfront](https://aws.amazon.com/cloudfront/custom-ssl-domains/). \n- Request to ping.ubnt.com: In order for the attacker to convince his/her authenticated victim to make a request to the overtaken subdomain ping.ubnt.com, a number of techniques can be utilized:\n * Targeted attack: An attacker could simply send his/her victim a mail with an embedded 1x1 image hosted on https://ping.ubnt.com/ inside its HTML. Since email supports HTML by default, this would silently make a request to the overtaken subdomain when being rendered in the victim's browser. Another option would be to lure the victim to an arbitrary attacker-controlled domain which houses a hidden iframe to the overtaken subdomain. Again, the browser would stealthily make the request and leak the \"UBIC_AUTH\" session cookie of sso.ubnt.com to the attacker.\n * Mass exploitation: An attacker could again host a media resource on https://ping.ubnt.com/ and buy some advertisement space on popular websites to serve it. Every authenticated Ubiquity victim who browses here would leak his/her session cookie to the attacker unknowingly. However, to increase the likelihood that the victims are already authenticated to sso.ubnt.com, an attacker might just post a reply on https://community.ubnt.com with a hidden IMG tag and source https://ping.ubnt.com. Every logged-in reader of the reply would unknowingly make a request to the hijacked subdomain, which would go through IF there was a valid SSL Certificate installed (not currently). Here's the PoC link: https://community.ubnt.com/t5/Getting-Started-Product/2-week-old-wisp/m-p/1687239#M65439 (post of my testuser \"ferrariverdasco\" - see also attached screenshot \"1. Waterhole community reply.png\"). \n\n# 1. Subdomain takeover\nThe subdomain \"ping.ubnt.com\" was (and still is) a CNAME pointing to a AWS Cloudfront CDN server (depending on your location, the latter will resolve differently):\n```\n# nslookup ping.ubnt.com 8.8.8.8\nServer:\t\t8.8.8.8\nAddress:\t8.8.8.8#53\n\nNon-authoritative answer:\nping.ubnt.com\tcanonical name = dl.ubnt.com.\ndl.ubnt.com\tcanonical name = d2cnv2pop2xy4v.cloudfront.net.\nName:\td2cnv2pop2xy4v.cloudfront.net\nAddress: 54.192.96.244\n```\nHowever, the hostname \"ping.ubnt.com\" was not claimed anymore on Cloudfront, resulting in a Cloudfront error page when visiting the subdomain before the takeover (see screenshot \"2. Before takeover.png\"). Subsequently, a new Amazon Cloudfront CDN endpoint was created and linked to an attacker-controlled origin server. For the new Cloudfront CDN endpoint, \"ping.ubnt.com\" was designated as hostname successfully (\"3. CNAME takeover.png\"). This concluded the subdomain takeover (see screenshots \"4. After takeover.png\" and \"5. After takeover - source.png\"). PoC URL: http://ping.ubnt.com/34902385023958329058235.html (random filename chosen to not negatively affect Ubiquity's reputation during takeover period). \n\n# 2. Authentication bypass proof-of-concept\nIn the PoC below, the assumption is made that https://ping.ubnt.com is actually serving a valid certificate in the victim's browser, which currently is not the case (so there is currently no actual risk) - see above.\n\n1. Open browser \u0026 navigate to https://ping.ubnt.com. Accept the invalid SSL certificate for PoC reasons.  Then launch an intercepting proxy tool and configure your browser proxy settings to see traffic going back \u0026 forth.\n2. Browse to https://community.ubnt.com/t5/Getting-Started-Product/2-week-old-wisp/m-p/1687239#M65439. Find the request to https://ping.ubnt.com/imagefetch.php?f=thanks.png in the intercepting proxy and view its response (hidden in HTML comments). It should say \"Cookie named 'UBIC_AUTH' is not set!\".\n2. Login to account.ubnt.com in a second browser tab with the victim's account. Notice the \"UBIC_AUTH\" cookie being issued by sso.ubnt.com after successful authentication, with \"domain=.ubnt.com\" attribute.\n3. Refresh first tab https://community.ubnt.com/t5/Getting-Started-Product/2-week-old-wisp/m-p/1687239#M65439. Check in your intercepting proxy that a new request to https://ping.ubnt.com/imagefetch.php?f=thanks.png is made, with a bunch of cookies transparently added by the browser, among which UBIC_AUTH.\n4. The HTML comment body of the response should now show the value of the UBIC_AUTH value, clearly demonstrating that the session cookie's value was well-received. However, this PHP page will make a request to endpoint https://sso.ubnt.com/api/sso/v1/user/self with this cookie and show its response. This should be a JSON array containing victim-account sensitive information, hereby proving that the session cookie can actually be hijacked and used from another system (my webserver in this case). \n\nIn a real attack scenario, an attacker would probably want to store the received cookie locally and use a cookie addon for his/her specific browser, to inject the session cookie value in the browser more persistently, as opposed to in a webserver's PHP curl script. However, I believe this method was more clear for PoC purposes. From here on, an attacker has complete control over a victim's account. He/she can see and modify anything, as long as no extra verification is required (e.g. current password to update to a new password). This is a similar impact of a global XSS \u0026 CSRF vulnerability on all *.ubnt.com pages.\n\nYou can see all these PoC steps executed in attachment \"6. Authentication Bypass PoC video.mp4\". The code of the https://ping.ubnt.com/imagefetch.php page is also attached (\"7. imagefetch.php\"). \n\n# Recommendation\nThe root cause of the vulnerability is the dangling CNAME pointer to Cloudfront from the affected subdomain. It is advised to remove the DNS CNAME pointer from ping.ubnt.com to the Cloudfront CDN server. This will mitigate the root cause vulnerability. If you are interested in keeping the subdomain on the Cloudfront CDN, I'll have to release it first before you can reclaim it. In that case, just let me know.\n\nAdditionally, it is advised to investigate whether the session cookie \"UBIC_AUTH\" of sso.ubnt.com should really be shared among all subdomains. This makes subdomain takeovers significantly more impactful, as shown through this report. \n\n# References\n- https://labs.detectify.com/tag/hostile-subdomain-takeover/\n\nI know this is a very long and complex report for a non-standard issue. Please don't hesitate to contact me if I haven't explained something clearly enough, so I can elaborate. \n\nRegards,\n\nArne Swinnen\nhttps://www.arneswinnen.net","vulnerability_information_html":"\u003ch1 id=\"summary\"\u003eSummary\u003c/h1\u003e\n\n\u003cp\u003eThis is not a standard vulnerability, but a chain of two more exotic vulnerabilities leading to a full authentication bypass of your SSO login system at sso.ubnt.com (via account.ubnt.com). The root cause of this authentication bypass is two-fold:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eSubdomain ping.ubnt.com was pointing to Amazon Cloudfront CDN, but the hostname was not registered there anymore. This allowed me to fully takeover this domain. It is now serving content of my own webserver, both over http and https.\u003c/li\u003e\n\u003cli\u003eThe session cookie of your SSO subdomain sso.ubnt.com is (deliberately?) shared with all https://*.ubnt.com subdomains through its \u0026quot;domain=.ubnt.com\u0026quot; attribute. This allows leakage of this high-value session cookie to the overtaken subdomain \u003ca title=\"https://ping.ubnt.com\" href=\"/redirect?url=https%3A%2F%2Fping.ubnt.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://ping.ubnt.com\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e in all modern browsers.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003ch1 id=\"impact\"\u003eImpact\u003c/h1\u003e\n\n\u003cp\u003eThe following attack scenario was invented: Assume that a victim is logged in in his/her browser to any of the \u003ccode\u003e*.ubnt.com\u003c/code\u003e services via the SSO system at account.ubnt.com, which uses sso.ubnt.com under the hood. If an attacker can then let the victim make a request to ping.ubnt.com in a second browser tab, either on purpose or unknowingly, the browser will transparently add the session cookie \u0026quot;UBIC_AUTH\u0026quot; set by sso.ubnt.com to this subdomain. Since the attacker has full visibility into incoming requests to his/her webserver (in this case, mine), the session cookie is now compromised. Once the attacker\u0026#39;s got his/her hands on the session cookie, he/she can now hijack the victim\u0026#39;s session on sso.ubnt.com. Since sso.ubnt.com is the centralized place where authentication occurs for all \u003ccode\u003e*.ubnt.com\u003c/code\u003e services (and perhaps even on other domains via OAuth?), this is a major risk, as an attacker can now impersonate the victim on \u003cstrong\u003eall\u003c/strong\u003e their Ubiquity services and connected devices who rely on SSO for authentication. \u003c/p\u003e\n\n\u003cp\u003eIn order for this depicted attack to work, the following questions still remain:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eValid SSL Certificate: the \u0026quot;UBIC_AUTH\u0026quot; session cookie has the \u0026quot;secure\u0026quot; cookie attribute set, which instructs the browser to only send its value over a secured channel. This means that the browser will only send it to \u003ca title=\"https://ping.ubnt.com\" href=\"/redirect?url=https%3A%2F%2Fping.ubnt.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://ping.ubnt.com\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e but not to \u003ca title=\"http://ping.ubnt.com\" href=\"/redirect?url=http%3A%2F%2Fping.ubnt.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://ping.ubnt.com\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e, which now requires the attacker to have a valid SSL certificate for this domain. However, many Certificate Authorities support automated domain verification through hosting a specific HTML file in the root directory of a (sub)domain nowadays (e.g. \u003ca href=\"/redirect?url=https%3A%2F%2Fletsencrypt.org%2Fhow-it-works%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eLets Encrypt\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e, \u003ca href=\"/redirect?url=https%3A%2F%2Fbe.godaddy.com%2Fhelp%2Fverify-domain-ownership-html-or-dns-7452\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eGoDaddy\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e, ...). Since the subdomain takeover yields the attacker complete control over the webserver serving ping.ubnt.com, this would be trivial. This was not performed as a PoC to not upset you by generating a malicious SSL certificate for your domain and effectively deploying it on a production system, but feel free to give me a heads up if you would like me to actually proceed with this attack scenario. It is literally \u003ca href=\"/redirect?url=https%3A%2F%2Fcertbot.eff.org%2F%23ubuntutrusty-apache\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eone command with the certbot utility\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e and \u003ca href=\"/redirect?url=https%3A%2F%2Faws.amazon.com%2Fcloudfront%2Fcustom-ssl-domains%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003efree to deploy on AWS Cloudfront\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e. \u003c/li\u003e\n\u003cli\u003eRequest to ping.ubnt.com: In order for the attacker to convince his/her authenticated victim to make a request to the overtaken subdomain ping.ubnt.com, a number of techniques can be utilized:\n\n\u003cul\u003e\n\u003cli\u003eTargeted attack: An attacker could simply send his/her victim a mail with an embedded 1x1 image hosted on \u003ca title=\"https://ping.ubnt.com/\" href=\"/redirect?url=https%3A%2F%2Fping.ubnt.com%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://ping.ubnt.com/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e inside its HTML. Since email supports HTML by default, this would silently make a request to the overtaken subdomain when being rendered in the victim\u0026#39;s browser. Another option would be to lure the victim to an arbitrary attacker-controlled domain which houses a hidden iframe to the overtaken subdomain. Again, the browser would stealthily make the request and leak the \u0026quot;UBIC_AUTH\u0026quot; session cookie of sso.ubnt.com to the attacker.\u003c/li\u003e\n\u003cli\u003eMass exploitation: An attacker could again host a media resource on \u003ca title=\"https://ping.ubnt.com/\" href=\"/redirect?url=https%3A%2F%2Fping.ubnt.com%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://ping.ubnt.com/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e and buy some advertisement space on popular websites to serve it. Every authenticated Ubiquity victim who browses here would leak his/her session cookie to the attacker unknowingly. However, to increase the likelihood that the victims are already authenticated to sso.ubnt.com, an attacker might just post a reply on \u003ca title=\"https://community.ubnt.com\" href=\"/redirect?url=https%3A%2F%2Fcommunity.ubnt.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://community.ubnt.com\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e with a hidden IMG tag and source \u003ca title=\"https://ping.ubnt.com\" href=\"/redirect?url=https%3A%2F%2Fping.ubnt.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://ping.ubnt.com\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e. Every logged-in reader of the reply would unknowingly make a request to the hijacked subdomain, which would go through IF there was a valid SSL Certificate installed (not currently). Here\u0026#39;s the PoC link: \u003ca title=\"https://community.ubnt.com/t5/Getting-Started-Product/2-week-old-wisp/m-p/1687239#M65439\" href=\"/redirect?url=https%3A%2F%2Fcommunity.ubnt.com%2Ft5%2FGetting-Started-Product%2F2-week-old-wisp%2Fm-p%2F1687239%23M65439\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://community.ubnt.com/t5/Getting-Started-Product/2-week-old-wisp/m-p/1687239#M65439\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e (post of my testuser \u0026quot;ferrariverdasco\u0026quot; - see also attached screenshot \u0026quot;1. Waterhole community reply.png\u0026quot;). \u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch1 id=\"1-subdomain-takeover\"\u003e1. Subdomain takeover\u003c/h1\u003e\n\n\u003cp\u003eThe subdomain \u0026quot;ping.ubnt.com\u0026quot; was (and still is) a CNAME pointing to a AWS Cloudfront CDN server (depending on your location, the latter will resolve differently):\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e# nslookup ping.ubnt.com 8.8.8.8\nServer:     8.8.8.8\nAddress:    8.8.8.8#53\n\nNon-authoritative answer:\nping.ubnt.com   canonical name = dl.ubnt.com.\ndl.ubnt.com canonical name = d2cnv2pop2xy4v.cloudfront.net.\nName:   d2cnv2pop2xy4v.cloudfront.net\nAddress: 54.192.96.244\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eHowever, the hostname \u0026quot;ping.ubnt.com\u0026quot; was not claimed anymore on Cloudfront, resulting in a Cloudfront error page when visiting the subdomain before the takeover (see screenshot \u0026quot;2. Before takeover.png\u0026quot;). Subsequently, a new Amazon Cloudfront CDN endpoint was created and linked to an attacker-controlled origin server. For the new Cloudfront CDN endpoint, \u0026quot;ping.ubnt.com\u0026quot; was designated as hostname successfully (\u0026quot;3. CNAME takeover.png\u0026quot;). This concluded the subdomain takeover (see screenshots \u0026quot;4. After takeover.png\u0026quot; and \u0026quot;5. After takeover - source.png\u0026quot;). PoC URL: \u003ca title=\"http://ping.ubnt.com/34902385023958329058235.html\" href=\"/redirect?url=http%3A%2F%2Fping.ubnt.com%2F34902385023958329058235.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://ping.ubnt.com/34902385023958329058235.html\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e (random filename chosen to not negatively affect Ubiquity\u0026#39;s reputation during takeover period). \u003c/p\u003e\n\n\u003ch1 id=\"2-authentication-bypass-proof-of-concept\"\u003e2. Authentication bypass proof-of-concept\u003c/h1\u003e\n\n\u003cp\u003eIn the PoC below, the assumption is made that \u003ca title=\"https://ping.ubnt.com\" href=\"/redirect?url=https%3A%2F%2Fping.ubnt.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://ping.ubnt.com\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e is actually serving a valid certificate in the victim\u0026#39;s browser, which currently is not the case (so there is currently no actual risk) - see above.\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eOpen browser \u0026amp; navigate to \u003ca title=\"https://ping.ubnt.com\" href=\"/redirect?url=https%3A%2F%2Fping.ubnt.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://ping.ubnt.com\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e. Accept the invalid SSL certificate for PoC reasons.  Then launch an intercepting proxy tool and configure your browser proxy settings to see traffic going back \u0026amp; forth.\u003c/li\u003e\n\u003cli\u003eBrowse to \u003ca title=\"https://community.ubnt.com/t5/Getting-Started-Product/2-week-old-wisp/m-p/1687239#M65439\" href=\"/redirect?url=https%3A%2F%2Fcommunity.ubnt.com%2Ft5%2FGetting-Started-Product%2F2-week-old-wisp%2Fm-p%2F1687239%23M65439\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://community.ubnt.com/t5/Getting-Started-Product/2-week-old-wisp/m-p/1687239#M65439\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e. Find the request to \u003ca title=\"https://ping.ubnt.com/imagefetch.php?f=thanks.png\" href=\"/redirect?url=https%3A%2F%2Fping.ubnt.com%2Fimagefetch.php%3Ff%3Dthanks.png\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://ping.ubnt.com/imagefetch.php?f=thanks.png\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e in the intercepting proxy and view its response (hidden in HTML comments). It should say \u0026quot;Cookie named \u0026#39;UBIC_AUTH\u0026#39; is not set!\u0026quot;.\u003c/li\u003e\n\u003cli\u003eLogin to account.ubnt.com in a second browser tab with the victim\u0026#39;s account. Notice the \u0026quot;UBIC_AUTH\u0026quot; cookie being issued by sso.ubnt.com after successful authentication, with \u0026quot;domain=.ubnt.com\u0026quot; attribute.\u003c/li\u003e\n\u003cli\u003eRefresh first tab \u003ca title=\"https://community.ubnt.com/t5/Getting-Started-Product/2-week-old-wisp/m-p/1687239#M65439\" href=\"/redirect?url=https%3A%2F%2Fcommunity.ubnt.com%2Ft5%2FGetting-Started-Product%2F2-week-old-wisp%2Fm-p%2F1687239%23M65439\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://community.ubnt.com/t5/Getting-Started-Product/2-week-old-wisp/m-p/1687239#M65439\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e. Check in your intercepting proxy that a new request to \u003ca title=\"https://ping.ubnt.com/imagefetch.php?f=thanks.png\" href=\"/redirect?url=https%3A%2F%2Fping.ubnt.com%2Fimagefetch.php%3Ff%3Dthanks.png\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://ping.ubnt.com/imagefetch.php?f=thanks.png\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e is made, with a bunch of cookies transparently added by the browser, among which UBIC_AUTH.\u003c/li\u003e\n\u003cli\u003eThe HTML comment body of the response should now show the value of the UBIC_AUTH value, clearly demonstrating that the session cookie\u0026#39;s value was well-received. However, this PHP page will make a request to endpoint \u003ca title=\"https://sso.ubnt.com/api/sso/v1/user/self\" href=\"/redirect?url=https%3A%2F%2Fsso.ubnt.com%2Fapi%2Fsso%2Fv1%2Fuser%2Fself\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://sso.ubnt.com/api/sso/v1/user/self\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e with this cookie and show its response. This should be a JSON array containing victim-account sensitive information, hereby proving that the session cookie can actually be hijacked and used from another system (my webserver in this case). \u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eIn a real attack scenario, an attacker would probably want to store the received cookie locally and use a cookie addon for his/her specific browser, to inject the session cookie value in the browser more persistently, as opposed to in a webserver\u0026#39;s PHP curl script. However, I believe this method was more clear for PoC purposes. From here on, an attacker has complete control over a victim\u0026#39;s account. He/she can see and modify anything, as long as no extra verification is required (e.g. current password to update to a new password). This is a similar impact of a global XSS \u0026amp; CSRF vulnerability on all *.ubnt.com pages.\u003c/p\u003e\n\n\u003cp\u003eYou can see all these PoC steps executed in attachment \u0026quot;6. Authentication Bypass PoC video.mp4\u0026quot;. The code of the \u003ca title=\"https://ping.ubnt.com/imagefetch.php\" href=\"/redirect?url=https%3A%2F%2Fping.ubnt.com%2Fimagefetch.php\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://ping.ubnt.com/imagefetch.php\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e page is also attached (\u0026quot;7. imagefetch.php\u0026quot;). \u003c/p\u003e\n\n\u003ch1 id=\"recommendation\"\u003eRecommendation\u003c/h1\u003e\n\n\u003cp\u003eThe root cause of the vulnerability is the dangling CNAME pointer to Cloudfront from the affected subdomain. It is advised to remove the DNS CNAME pointer from ping.ubnt.com to the Cloudfront CDN server. This will mitigate the root cause vulnerability. If you are interested in keeping the subdomain on the Cloudfront CDN, I\u0026#39;ll have to release it first before you can reclaim it. In that case, just let me know.\u003c/p\u003e\n\n\u003cp\u003eAdditionally, it is advised to investigate whether the session cookie \u0026quot;UBIC_AUTH\u0026quot; of sso.ubnt.com should really be shared among all subdomains. This makes subdomain takeovers significantly more impactful, as shown through this report. \u003c/p\u003e\n\n\u003ch1 id=\"references\"\u003eReferences\u003c/h1\u003e\n\n\u003cul\u003e\n\u003cli\u003e\u003ca title=\"https://labs.detectify.com/tag/hostile-subdomain-takeover/\" href=\"/redirect?url=https%3A%2F%2Flabs.detectify.com%2Ftag%2Fhostile-subdomain-takeover%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://labs.detectify.com/tag/hostile-subdomain-takeover/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eI know this is a very long and complex report for a non-standard issue. Please don\u0026#39;t hesitate to contact me if I haven\u0026#39;t explained something clearly enough, so I can elaborate. \u003c/p\u003e\n\n\u003cp\u003eRegards,\u003c/p\u003e\n\n\u003cp\u003eArne Swinnen\u003cbr\u003e\n\u003ca title=\"https://www.arneswinnen.net\" href=\"/redirect?url=https%3A%2F%2Fwww.arneswinnen.net\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.arneswinnen.net\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","bounty_amount":"500.0","formatted_bounty":"$500","weakness":{"id":45,"name":"Cross-Site Request Forgery (CSRF)"},"original_report_id":145224,"original_report_url":"https://hackerone.com/reports/145224","attachments":[{"id":123069,"file_name":"5._After_takeover_-_source.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/123/069/6391a5ab9cf371fffa6e98c216a7a55960a5426b/5._After_takeover_-_source.png?response-content-disposition=attachment%3B%20filename%3D%225._After_takeover_-_source.png%22%3B%20filename%2A%3DUTF-8%27%275._After_takeover_-_source.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQUYGCYHJT%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T044107Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJj%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIAGSCCKi0CRpYJMt3KX5x%2BNM9j2K4mM4glLH6mZ%2B8ExKAiEAlsZG1%2FfIYq0ODDSxwLnZfWyc08bfINN86QAI3Hqr4MgqtAMIURABGgwwMTM2MTkyNzQ4NDkiDG9txF7r12Yekik2WSqRA6NC8vsgwir7JTQr5zVnxH1x6efNaMXQv0rW73VsI4xDf6Ldo8AdQq%2B7eYd4BvolwrfpyHLOFrZnF4wc7R9rEQKh%2FswFKL9GQ6Lp2ujYTvyC5dhdjS4Sq%2F%2BYvPk3joZ%2BEwcDqk%2B5AvxLFqoiv3Y3ts7f9HYBqcl%2Fu20T7ZA6XxU9V7asrN5LT6SJz4xOu7iZzuPeZs4%2BFaw8tgu5A3W6CYmUUmbBs9q%2FQ%2FCO3t50tS7Dm5k%2BKM04Ar1VaXlWDuLdZKMC%2FS80%2FwDwH66vWVAjLib7jCkgBWXGEa9VryBHJJUl3qrXQrTIED1gUKeOoKk3fYvvyyIMJs3ja%2BbbO56fim%2BodEtN1FBU6g%2BuddJ4Qz5521XYpzwatC5mjJs6D50zWyfJnn9Xf%2FrDe3EacAX3oOhEBj%2Fu9S%2B46jeCaMjfEHwW8T%2FFnFpu%2FZf3e1NchqIFhOkEcnGH%2FqNmQtJ54g5I6x8j4N2c70CE7tuCZI1qjgi%2BfUfSwopFGky44IARFjLnTewCnMtMfFUa7haJa9C%2BcuqvMJDfqf8FOusB7%2BAWx%2FH2B4H9I7hLf9GkPQtz9yMVcytbF7umUu9c2W6aIn%2FKCYsmcfqyPQD%2Fe6EdfKQiWwtKrHes32q91jeUCiYfrRJFByq7uDxHGN0MingOOUWy72n3fdpooUwYjRfpac06PpxBSGvwEeiL%2BJlq9wl2E%2FMxojMrovyONCSYEoBpeEbNgMNFb9rpTiIW%2BX8OzRH6ra3L9dgd9y8nuqoCkIGYzNActVtKbpERxbtmkIoGAgtSCCLLfHT65g2k6G9afrZJZC86IhNmvJrDSG%2BKELC3%2BeAfU64DhUDssT9Dd%2Bm2pU0nRk1s8PUjuQ%3D%3D\u0026X-Amz-Signature=f44273a863bb39bd968fbd4819d2e6d8d0997095a6a033a51566c8855e9b9a21","file_size":60574,"type":"image/png"},{"id":123070,"file_name":"4._After_takeover.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/123/070/74fdfb90511387417519c90977dfdd55748ddaf3/4._After_takeover.png?response-content-disposition=attachment%3B%20filename%3D%224._After_takeover.png%22%3B%20filename%2A%3DUTF-8%27%274._After_takeover.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQUYGCYHJT%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T044107Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJj%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIAGSCCKi0CRpYJMt3KX5x%2BNM9j2K4mM4glLH6mZ%2B8ExKAiEAlsZG1%2FfIYq0ODDSxwLnZfWyc08bfINN86QAI3Hqr4MgqtAMIURABGgwwMTM2MTkyNzQ4NDkiDG9txF7r12Yekik2WSqRA6NC8vsgwir7JTQr5zVnxH1x6efNaMXQv0rW73VsI4xDf6Ldo8AdQq%2B7eYd4BvolwrfpyHLOFrZnF4wc7R9rEQKh%2FswFKL9GQ6Lp2ujYTvyC5dhdjS4Sq%2F%2BYvPk3joZ%2BEwcDqk%2B5AvxLFqoiv3Y3ts7f9HYBqcl%2Fu20T7ZA6XxU9V7asrN5LT6SJz4xOu7iZzuPeZs4%2BFaw8tgu5A3W6CYmUUmbBs9q%2FQ%2FCO3t50tS7Dm5k%2BKM04Ar1VaXlWDuLdZKMC%2FS80%2FwDwH66vWVAjLib7jCkgBWXGEa9VryBHJJUl3qrXQrTIED1gUKeOoKk3fYvvyyIMJs3ja%2BbbO56fim%2BodEtN1FBU6g%2BuddJ4Qz5521XYpzwatC5mjJs6D50zWyfJnn9Xf%2FrDe3EacAX3oOhEBj%2Fu9S%2B46jeCaMjfEHwW8T%2FFnFpu%2FZf3e1NchqIFhOkEcnGH%2FqNmQtJ54g5I6x8j4N2c70CE7tuCZI1qjgi%2BfUfSwopFGky44IARFjLnTewCnMtMfFUa7haJa9C%2BcuqvMJDfqf8FOusB7%2BAWx%2FH2B4H9I7hLf9GkPQtz9yMVcytbF7umUu9c2W6aIn%2FKCYsmcfqyPQD%2Fe6EdfKQiWwtKrHes32q91jeUCiYfrRJFByq7uDxHGN0MingOOUWy72n3fdpooUwYjRfpac06PpxBSGvwEeiL%2BJlq9wl2E%2FMxojMrovyONCSYEoBpeEbNgMNFb9rpTiIW%2BX8OzRH6ra3L9dgd9y8nuqoCkIGYzNActVtKbpERxbtmkIoGAgtSCCLLfHT65g2k6G9afrZJZC86IhNmvJrDSG%2BKELC3%2BeAfU64DhUDssT9Dd%2Bm2pU0nRk1s8PUjuQ%3D%3D\u0026X-Amz-Signature=f5d059389111a0415ba637dc84fa68fe2a42d938c0040b6d8afad6458c06d54d","file_size":33664,"type":"image/png"},{"id":123071,"file_name":"3._CNAME_takeover.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/123/071/27a104f57daceb35423efac87f81e194c251f2cf/3._CNAME_takeover.png?response-content-disposition=attachment%3B%20filename%3D%223._CNAME_takeover.png%22%3B%20filename%2A%3DUTF-8%27%273._CNAME_takeover.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQUYGCYHJT%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T044107Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJj%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIAGSCCKi0CRpYJMt3KX5x%2BNM9j2K4mM4glLH6mZ%2B8ExKAiEAlsZG1%2FfIYq0ODDSxwLnZfWyc08bfINN86QAI3Hqr4MgqtAMIURABGgwwMTM2MTkyNzQ4NDkiDG9txF7r12Yekik2WSqRA6NC8vsgwir7JTQr5zVnxH1x6efNaMXQv0rW73VsI4xDf6Ldo8AdQq%2B7eYd4BvolwrfpyHLOFrZnF4wc7R9rEQKh%2FswFKL9GQ6Lp2ujYTvyC5dhdjS4Sq%2F%2BYvPk3joZ%2BEwcDqk%2B5AvxLFqoiv3Y3ts7f9HYBqcl%2Fu20T7ZA6XxU9V7asrN5LT6SJz4xOu7iZzuPeZs4%2BFaw8tgu5A3W6CYmUUmbBs9q%2FQ%2FCO3t50tS7Dm5k%2BKM04Ar1VaXlWDuLdZKMC%2FS80%2FwDwH66vWVAjLib7jCkgBWXGEa9VryBHJJUl3qrXQrTIED1gUKeOoKk3fYvvyyIMJs3ja%2BbbO56fim%2BodEtN1FBU6g%2BuddJ4Qz5521XYpzwatC5mjJs6D50zWyfJnn9Xf%2FrDe3EacAX3oOhEBj%2Fu9S%2B46jeCaMjfEHwW8T%2FFnFpu%2FZf3e1NchqIFhOkEcnGH%2FqNmQtJ54g5I6x8j4N2c70CE7tuCZI1qjgi%2BfUfSwopFGky44IARFjLnTewCnMtMfFUa7haJa9C%2BcuqvMJDfqf8FOusB7%2BAWx%2FH2B4H9I7hLf9GkPQtz9yMVcytbF7umUu9c2W6aIn%2FKCYsmcfqyPQD%2Fe6EdfKQiWwtKrHes32q91jeUCiYfrRJFByq7uDxHGN0MingOOUWy72n3fdpooUwYjRfpac06PpxBSGvwEeiL%2BJlq9wl2E%2FMxojMrovyONCSYEoBpeEbNgMNFb9rpTiIW%2BX8OzRH6ra3L9dgd9y8nuqoCkIGYzNActVtKbpERxbtmkIoGAgtSCCLLfHT65g2k6G9afrZJZC86IhNmvJrDSG%2BKELC3%2BeAfU64DhUDssT9Dd%2Bm2pU0nRk1s8PUjuQ%3D%3D\u0026X-Amz-Signature=1f49e194d2e3f81be43e7f4cd79605afe7050443684c5902791bc4b1abe53928","file_size":108998,"type":"image/png"},{"id":123072,"file_name":"2._Before_takeover.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/123/072/c3cbf3cadeecbe1210e2b177eb786953a9f2b528/2._Before_takeover.png?response-content-disposition=attachment%3B%20filename%3D%222._Before_takeover.png%22%3B%20filename%2A%3DUTF-8%27%272._Before_takeover.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQUYGCYHJT%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T044107Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJj%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIAGSCCKi0CRpYJMt3KX5x%2BNM9j2K4mM4glLH6mZ%2B8ExKAiEAlsZG1%2FfIYq0ODDSxwLnZfWyc08bfINN86QAI3Hqr4MgqtAMIURABGgwwMTM2MTkyNzQ4NDkiDG9txF7r12Yekik2WSqRA6NC8vsgwir7JTQr5zVnxH1x6efNaMXQv0rW73VsI4xDf6Ldo8AdQq%2B7eYd4BvolwrfpyHLOFrZnF4wc7R9rEQKh%2FswFKL9GQ6Lp2ujYTvyC5dhdjS4Sq%2F%2BYvPk3joZ%2BEwcDqk%2B5AvxLFqoiv3Y3ts7f9HYBqcl%2Fu20T7ZA6XxU9V7asrN5LT6SJz4xOu7iZzuPeZs4%2BFaw8tgu5A3W6CYmUUmbBs9q%2FQ%2FCO3t50tS7Dm5k%2BKM04Ar1VaXlWDuLdZKMC%2FS80%2FwDwH66vWVAjLib7jCkgBWXGEa9VryBHJJUl3qrXQrTIED1gUKeOoKk3fYvvyyIMJs3ja%2BbbO56fim%2BodEtN1FBU6g%2BuddJ4Qz5521XYpzwatC5mjJs6D50zWyfJnn9Xf%2FrDe3EacAX3oOhEBj%2Fu9S%2B46jeCaMjfEHwW8T%2FFnFpu%2FZf3e1NchqIFhOkEcnGH%2FqNmQtJ54g5I6x8j4N2c70CE7tuCZI1qjgi%2BfUfSwopFGky44IARFjLnTewCnMtMfFUa7haJa9C%2BcuqvMJDfqf8FOusB7%2BAWx%2FH2B4H9I7hLf9GkPQtz9yMVcytbF7umUu9c2W6aIn%2FKCYsmcfqyPQD%2Fe6EdfKQiWwtKrHes32q91jeUCiYfrRJFByq7uDxHGN0MingOOUWy72n3fdpooUwYjRfpac06PpxBSGvwEeiL%2BJlq9wl2E%2FMxojMrovyONCSYEoBpeEbNgMNFb9rpTiIW%2BX8OzRH6ra3L9dgd9y8nuqoCkIGYzNActVtKbpERxbtmkIoGAgtSCCLLfHT65g2k6G9afrZJZC86IhNmvJrDSG%2BKELC3%2BeAfU64DhUDssT9Dd%2Bm2pU0nRk1s8PUjuQ%3D%3D\u0026X-Amz-Signature=c5492666989d740dae8c05e6a1f01580b04525a5654706d7893cbc208983ca1b","file_size":65732,"type":"image/png"},{"id":123073,"file_name":"1._Waterhole_community_reply.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/123/073/9f450613e9b69dd6e2b60bcf5ae84236fc45ed91/1._Waterhole_community_reply.png?response-content-disposition=attachment%3B%20filename%3D%221._Waterhole_community_reply.png%22%3B%20filename%2A%3DUTF-8%27%271._Waterhole_community_reply.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQUYGCYHJT%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T044107Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJj%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIAGSCCKi0CRpYJMt3KX5x%2BNM9j2K4mM4glLH6mZ%2B8ExKAiEAlsZG1%2FfIYq0ODDSxwLnZfWyc08bfINN86QAI3Hqr4MgqtAMIURABGgwwMTM2MTkyNzQ4NDkiDG9txF7r12Yekik2WSqRA6NC8vsgwir7JTQr5zVnxH1x6efNaMXQv0rW73VsI4xDf6Ldo8AdQq%2B7eYd4BvolwrfpyHLOFrZnF4wc7R9rEQKh%2FswFKL9GQ6Lp2ujYTvyC5dhdjS4Sq%2F%2BYvPk3joZ%2BEwcDqk%2B5AvxLFqoiv3Y3ts7f9HYBqcl%2Fu20T7ZA6XxU9V7asrN5LT6SJz4xOu7iZzuPeZs4%2BFaw8tgu5A3W6CYmUUmbBs9q%2FQ%2FCO3t50tS7Dm5k%2BKM04Ar1VaXlWDuLdZKMC%2FS80%2FwDwH66vWVAjLib7jCkgBWXGEa9VryBHJJUl3qrXQrTIED1gUKeOoKk3fYvvyyIMJs3ja%2BbbO56fim%2BodEtN1FBU6g%2BuddJ4Qz5521XYpzwatC5mjJs6D50zWyfJnn9Xf%2FrDe3EacAX3oOhEBj%2Fu9S%2B46jeCaMjfEHwW8T%2FFnFpu%2FZf3e1NchqIFhOkEcnGH%2FqNmQtJ54g5I6x8j4N2c70CE7tuCZI1qjgi%2BfUfSwopFGky44IARFjLnTewCnMtMfFUa7haJa9C%2BcuqvMJDfqf8FOusB7%2BAWx%2FH2B4H9I7hLf9GkPQtz9yMVcytbF7umUu9c2W6aIn%2FKCYsmcfqyPQD%2Fe6EdfKQiWwtKrHes32q91jeUCiYfrRJFByq7uDxHGN0MingOOUWy72n3fdpooUwYjRfpac06PpxBSGvwEeiL%2BJlq9wl2E%2FMxojMrovyONCSYEoBpeEbNgMNFb9rpTiIW%2BX8OzRH6ra3L9dgd9y8nuqoCkIGYzNActVtKbpERxbtmkIoGAgtSCCLLfHT65g2k6G9afrZJZC86IhNmvJrDSG%2BKELC3%2BeAfU64DhUDssT9Dd%2Bm2pU0nRk1s8PUjuQ%3D%3D\u0026X-Amz-Signature=cc718830e3fff561130aa8e50a5d5a6a28f73c5ef64a1e98526891f0303ca9b5","file_size":263453,"type":"image/png"},{"id":123084,"file_name":"7._imagefetch.php","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/123/084/7d7d24390f97c96658dfc7f1761be70446562ebe/7._imagefetch.php?response-content-disposition=attachment%3B%20filename%3D%227._imagefetch.php%22%3B%20filename%2A%3DUTF-8%27%277._imagefetch.php\u0026response-content-type=application%2Foctet-stream\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQUYGCYHJT%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T044107Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJj%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIAGSCCKi0CRpYJMt3KX5x%2BNM9j2K4mM4glLH6mZ%2B8ExKAiEAlsZG1%2FfIYq0ODDSxwLnZfWyc08bfINN86QAI3Hqr4MgqtAMIURABGgwwMTM2MTkyNzQ4NDkiDG9txF7r12Yekik2WSqRA6NC8vsgwir7JTQr5zVnxH1x6efNaMXQv0rW73VsI4xDf6Ldo8AdQq%2B7eYd4BvolwrfpyHLOFrZnF4wc7R9rEQKh%2FswFKL9GQ6Lp2ujYTvyC5dhdjS4Sq%2F%2BYvPk3joZ%2BEwcDqk%2B5AvxLFqoiv3Y3ts7f9HYBqcl%2Fu20T7ZA6XxU9V7asrN5LT6SJz4xOu7iZzuPeZs4%2BFaw8tgu5A3W6CYmUUmbBs9q%2FQ%2FCO3t50tS7Dm5k%2BKM04Ar1VaXlWDuLdZKMC%2FS80%2FwDwH66vWVAjLib7jCkgBWXGEa9VryBHJJUl3qrXQrTIED1gUKeOoKk3fYvvyyIMJs3ja%2BbbO56fim%2BodEtN1FBU6g%2BuddJ4Qz5521XYpzwatC5mjJs6D50zWyfJnn9Xf%2FrDe3EacAX3oOhEBj%2Fu9S%2B46jeCaMjfEHwW8T%2FFnFpu%2FZf3e1NchqIFhOkEcnGH%2FqNmQtJ54g5I6x8j4N2c70CE7tuCZI1qjgi%2BfUfSwopFGky44IARFjLnTewCnMtMfFUa7haJa9C%2BcuqvMJDfqf8FOusB7%2BAWx%2FH2B4H9I7hLf9GkPQtz9yMVcytbF7umUu9c2W6aIn%2FKCYsmcfqyPQD%2Fe6EdfKQiWwtKrHes32q91jeUCiYfrRJFByq7uDxHGN0MingOOUWy72n3fdpooUwYjRfpac06PpxBSGvwEeiL%2BJlq9wl2E%2FMxojMrovyONCSYEoBpeEbNgMNFb9rpTiIW%2BX8OzRH6ra3L9dgd9y8nuqoCkIGYzNActVtKbpERxbtmkIoGAgtSCCLLfHT65g2k6G9afrZJZC86IhNmvJrDSG%2BKELC3%2BeAfU64DhUDssT9Dd%2Bm2pU0nRk1s8PUjuQ%3D%3D\u0026X-Amz-Signature=653d4ad6141dee22d5d2045659da8c24c1bf517fd98c00e39495e892c63b49ba","file_size":666,"type":"text/html"},{"id":123085,"file_name":"6._Authentication_Bypass_PoC_video.mp4","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/123/085/5c1943af79c71148721b75b4f92f88c983f6a240/6._Authentication_Bypass_PoC_video.mp4?response-content-disposition=attachment%3B%20filename%3D%226._Authentication_Bypass_PoC_video.mp4%22%3B%20filename%2A%3DUTF-8%27%276._Authentication_Bypass_PoC_video.mp4\u0026response-content-type=video%2Fmp4\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQUYGCYHJT%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T044107Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJj%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIAGSCCKi0CRpYJMt3KX5x%2BNM9j2K4mM4glLH6mZ%2B8ExKAiEAlsZG1%2FfIYq0ODDSxwLnZfWyc08bfINN86QAI3Hqr4MgqtAMIURABGgwwMTM2MTkyNzQ4NDkiDG9txF7r12Yekik2WSqRA6NC8vsgwir7JTQr5zVnxH1x6efNaMXQv0rW73VsI4xDf6Ldo8AdQq%2B7eYd4BvolwrfpyHLOFrZnF4wc7R9rEQKh%2FswFKL9GQ6Lp2ujYTvyC5dhdjS4Sq%2F%2BYvPk3joZ%2BEwcDqk%2B5AvxLFqoiv3Y3ts7f9HYBqcl%2Fu20T7ZA6XxU9V7asrN5LT6SJz4xOu7iZzuPeZs4%2BFaw8tgu5A3W6CYmUUmbBs9q%2FQ%2FCO3t50tS7Dm5k%2BKM04Ar1VaXlWDuLdZKMC%2FS80%2FwDwH66vWVAjLib7jCkgBWXGEa9VryBHJJUl3qrXQrTIED1gUKeOoKk3fYvvyyIMJs3ja%2BbbO56fim%2BodEtN1FBU6g%2BuddJ4Qz5521XYpzwatC5mjJs6D50zWyfJnn9Xf%2FrDe3EacAX3oOhEBj%2Fu9S%2B46jeCaMjfEHwW8T%2FFnFpu%2FZf3e1NchqIFhOkEcnGH%2FqNmQtJ54g5I6x8j4N2c70CE7tuCZI1qjgi%2BfUfSwopFGky44IARFjLnTewCnMtMfFUa7haJa9C%2BcuqvMJDfqf8FOusB7%2BAWx%2FH2B4H9I7hLf9GkPQtz9yMVcytbF7umUu9c2W6aIn%2FKCYsmcfqyPQD%2Fe6EdfKQiWwtKrHes32q91jeUCiYfrRJFByq7uDxHGN0MingOOUWy72n3fdpooUwYjRfpac06PpxBSGvwEeiL%2BJlq9wl2E%2FMxojMrovyONCSYEoBpeEbNgMNFb9rpTiIW%2BX8OzRH6ra3L9dgd9y8nuqoCkIGYzNActVtKbpERxbtmkIoGAgtSCCLLfHT65g2k6G9afrZJZC86IhNmvJrDSG%2BKELC3%2BeAfU64DhUDssT9Dd%2Bm2pU0nRk1s8PUjuQ%3D%3D\u0026X-Amz-Signature=414a95af20a1f18381d9a098198adab3a4ffc11f0f00c9942fbcd1450f647ff9","file_size":9847202,"type":"video/mp4"}],"allow_singular_disclosure_at":null,"vote_count":45,"voters":["arneswinnen","cyber_humans","michiel","mashoud1122","tk0","bogdantcaciuc","troubleshooter","skansing","logicmap","mdv","and 35 more..."],"severity":{"rating":"high","author_type":"User"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1219007,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for you report. \n\nWe're able to reproduce your proof of concept and our investigation is ongoing. We'll be sure to update you as soon as we have more information. \n\nThanks and good luck in your future bug hunting.  ","markdown_message":"\u003cp\u003eThanks for you report. \u003c/p\u003e\n\n\u003cp\u003eWe\u0026#39;re able to reproduce your proof of concept and our investigation is ongoing. We\u0026#39;ll be sure to update you as soon as we have more information. \u003c/p\u003e\n\n\u003cp\u003eThanks and good luck in your future bug hunting.  \u003c/p\u003e\n","automated_response":false,"created_at":"2016-09-27T14:26:23.027Z","updated_at":"2016-09-27T14:26:23.027Z","actor":{"username":"bugtriage-rob","cleared":false,"url":"/bugtriage-rob","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ui","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1219503,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi,\n\nThat's an impressive response time, congratulations! For the subdomain takeover resolution part: Just let me know if you'd like me to release the domain CNAME again, and I'll do that ASAP.\n\nIn addition, I made another PoC video which demonstrates how an attacker could inject the stolen cookie in his/her own browser and be logged in to any `*.ubnt.com` victim services transparently. In the PoC, I first pretend to be the victim in browser Google Chrome. I login and then \"accidentally\" visit https://ping.ubnt.com/imagefetch.php, hereby leaking my UBIC_AUTH session cookie to the attacker's webserver.\n\nThe attacker now injects this session cookie in his own browser (Mozilla Firefox in this case on the same system, for practical reasons) by setting the cookie via the Set-Cookie: directive in an UNAUTHORIZED response from the https://sso.ubnt.com/api/sso/v1/user/self endpoint. This instructs the attacker's browser to include the session cookie from then on in future requests to sso.ubnt.com, which now makes the attacker authenticated as the victim after refreshing. Furthermore, since it's on sso.ubnt.com, an attacker can now access any `*.ubnt.com` services from the victim transparently in his/her browser, in the PoC video's case account.ubnt.com, store.ubnt.com and community.ubnt.com. Even when the victim logs out in his/her browser (Google Chrome in the PoC), the attacker's session of the victim account keeps alive, as demonstrated at the end of the video.\n\nLet me know if anything is unclear.\nRegards,\n\nArne","markdown_message":"\u003cp\u003eHi,\u003c/p\u003e\n\n\u003cp\u003eThat\u0026#39;s an impressive response time, congratulations! For the subdomain takeover resolution part: Just let me know if you\u0026#39;d like me to release the domain CNAME again, and I\u0026#39;ll do that ASAP.\u003c/p\u003e\n\n\u003cp\u003eIn addition, I made another PoC video which demonstrates how an attacker could inject the stolen cookie in his/her own browser and be logged in to any \u003ccode\u003e*.ubnt.com\u003c/code\u003e victim services transparently. In the PoC, I first pretend to be the victim in browser Google Chrome. I login and then \u0026quot;accidentally\u0026quot; visit \u003ca title=\"https://ping.ubnt.com/imagefetch.php\" href=\"/redirect?url=https%3A%2F%2Fping.ubnt.com%2Fimagefetch.php\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://ping.ubnt.com/imagefetch.php\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e, hereby leaking my UBIC_AUTH session cookie to the attacker\u0026#39;s webserver.\u003c/p\u003e\n\n\u003cp\u003eThe attacker now injects this session cookie in his own browser (Mozilla Firefox in this case on the same system, for practical reasons) by setting the cookie via the Set-Cookie: directive in an UNAUTHORIZED response from the \u003ca title=\"https://sso.ubnt.com/api/sso/v1/user/self\" href=\"/redirect?url=https%3A%2F%2Fsso.ubnt.com%2Fapi%2Fsso%2Fv1%2Fuser%2Fself\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://sso.ubnt.com/api/sso/v1/user/self\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e endpoint. This instructs the attacker\u0026#39;s browser to include the session cookie from then on in future requests to sso.ubnt.com, which now makes the attacker authenticated as the victim after refreshing. Furthermore, since it\u0026#39;s on sso.ubnt.com, an attacker can now access any \u003ccode\u003e*.ubnt.com\u003c/code\u003e services from the victim transparently in his/her browser, in the PoC video\u0026#39;s case account.ubnt.com, store.ubnt.com and community.ubnt.com. Even when the victim logs out in his/her browser (Google Chrome in the PoC), the attacker\u0026#39;s session of the victim account keeps alive, as demonstrated at the end of the video.\u003c/p\u003e\n\n\u003cp\u003eLet me know if anything is unclear.\u003cbr\u003e\nRegards,\u003c/p\u003e\n\n\u003cp\u003eArne\u003c/p\u003e\n","automated_response":false,"created_at":"2016-09-27T17:46:34.437Z","updated_at":"2016-09-27T17:46:34.437Z","actor":{"username":"arneswinnen","cleared":true,"url":"/arneswinnen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/061/086/26dedde13e2d4ec49acf71a95f522b54dd5e659c_original.JPG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":123441,"filename":"Session_cookie_theft___injection_in_attacker's_browser.mp4","type":"video/mp4","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/123/441/5fe1cb37744bb8d5b4ce3e8a6ccb7b7a3c571c7a/Session_cookie_theft___injection_in_attacker%27s_browser.mp4?response-content-disposition=attachment%3B%20filename%3D%22Session_cookie_theft___injection_in_attacker%2527s_browser.mp4%22%3B%20filename%2A%3DUTF-8%27%27Session_cookie_theft___injection_in_attacker%2527s_browser.mp4\u0026response-content-type=video%2Fmp4\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQUYGCYHJT%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T044107Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJj%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIAGSCCKi0CRpYJMt3KX5x%2BNM9j2K4mM4glLH6mZ%2B8ExKAiEAlsZG1%2FfIYq0ODDSxwLnZfWyc08bfINN86QAI3Hqr4MgqtAMIURABGgwwMTM2MTkyNzQ4NDkiDG9txF7r12Yekik2WSqRA6NC8vsgwir7JTQr5zVnxH1x6efNaMXQv0rW73VsI4xDf6Ldo8AdQq%2B7eYd4BvolwrfpyHLOFrZnF4wc7R9rEQKh%2FswFKL9GQ6Lp2ujYTvyC5dhdjS4Sq%2F%2BYvPk3joZ%2BEwcDqk%2B5AvxLFqoiv3Y3ts7f9HYBqcl%2Fu20T7ZA6XxU9V7asrN5LT6SJz4xOu7iZzuPeZs4%2BFaw8tgu5A3W6CYmUUmbBs9q%2FQ%2FCO3t50tS7Dm5k%2BKM04Ar1VaXlWDuLdZKMC%2FS80%2FwDwH66vWVAjLib7jCkgBWXGEa9VryBHJJUl3qrXQrTIED1gUKeOoKk3fYvvyyIMJs3ja%2BbbO56fim%2BodEtN1FBU6g%2BuddJ4Qz5521XYpzwatC5mjJs6D50zWyfJnn9Xf%2FrDe3EacAX3oOhEBj%2Fu9S%2B46jeCaMjfEHwW8T%2FFnFpu%2FZf3e1NchqIFhOkEcnGH%2FqNmQtJ54g5I6x8j4N2c70CE7tuCZI1qjgi%2BfUfSwopFGky44IARFjLnTewCnMtMfFUa7haJa9C%2BcuqvMJDfqf8FOusB7%2BAWx%2FH2B4H9I7hLf9GkPQtz9yMVcytbF7umUu9c2W6aIn%2FKCYsmcfqyPQD%2Fe6EdfKQiWwtKrHes32q91jeUCiYfrRJFByq7uDxHGN0MingOOUWy72n3fdpooUwYjRfpac06PpxBSGvwEeiL%2BJlq9wl2E%2FMxojMrovyONCSYEoBpeEbNgMNFb9rpTiIW%2BX8OzRH6ra3L9dgd9y8nuqoCkIGYzNActVtKbpERxbtmkIoGAgtSCCLLfHT65g2k6G9afrZJZC86IhNmvJrDSG%2BKELC3%2BeAfU64DhUDssT9Dd%2Bm2pU0nRk1s8PUjuQ%3D%3D\u0026X-Amz-Signature=fb6489f680293ef45d0728908fec1d33cc1d2dcd84084e317528634478e1e4ca"}],"genius_execution_id":null,"team_handle":"ui","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1234217,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @Ubiquity,\n\nAny news about this? It does cost *some* money to keep serving this domain via Cloudfront from my own AWS account... \n\nRegards,\n\nArne","markdown_message":"\u003cp\u003eHi \u003ca href=\"/ubiquity\"\u003e@Ubiquity\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eAny news about this? It does cost \u003cem\u003esome\u003c/em\u003e money to keep serving this domain via Cloudfront from my own AWS account... \u003c/p\u003e\n\n\u003cp\u003eRegards,\u003c/p\u003e\n\n\u003cp\u003eArne\u003c/p\u003e\n","automated_response":false,"created_at":"2016-10-05T20:40:20.834Z","updated_at":"2016-10-05T20:40:20.834Z","actor":{"username":"arneswinnen","cleared":true,"url":"/arneswinnen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/061/086/26dedde13e2d4ec49acf71a95f522b54dd5e659c_original.JPG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ui","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1234963,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2016-10-06T08:56:12.373Z","updated_at":"2016-10-06T08:56:12.373Z","additional_data":{"old_severity":null,"new_severity":"High","old_severity_id":null,"new_severity_id":154},"actor":{"username":"arneswinnen","cleared":true,"url":"/arneswinnen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/061/086/26dedde13e2d4ec49acf71a95f522b54dd5e659c_original.JPG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ui","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1272486,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hi @arneswinnen \n\nThanks for your report and sorry for the delay, our team is fixing the problem.\n\nThanks for testing","markdown_message":"\u003cp\u003eHi \u003ca href=\"/arneswinnen\"\u003e@arneswinnen\u003c/a\u003e \u003c/p\u003e\n\n\u003cp\u003eThanks for your report and sorry for the delay, our team is fixing the problem.\u003c/p\u003e\n\n\u003cp\u003eThanks for testing\u003c/p\u003e\n","automated_response":false,"created_at":"2016-10-28T09:32:52.455Z","updated_at":"2016-10-28T09:32:52.455Z","actor":{"username":"ubnt-rubens","cleared":false,"url":"/ubnt-rubens","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ui","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1272502,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @arneswinnen can you release the domain?","markdown_message":"\u003cp\u003eHi \u003ca href=\"/arneswinnen\"\u003e@arneswinnen\u003c/a\u003e can you release the domain?\u003c/p\u003e\n","automated_response":false,"created_at":"2016-10-28T09:49:54.708Z","updated_at":"2016-10-28T09:49:54.708Z","actor":{"username":"ubnt-rubens","cleared":false,"url":"/ubnt-rubens","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ui","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1272538,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi,\n\nDomain released \u0026 already reclaimed by Ubiquity, so it seems :-).\n\nCheers,\n\nArne","markdown_message":"\u003cp\u003eHi,\u003c/p\u003e\n\n\u003cp\u003eDomain released \u0026amp; already reclaimed by Ubiquity, so it seems :-).\u003c/p\u003e\n\n\u003cp\u003eCheers,\u003c/p\u003e\n\n\u003cp\u003eArne\u003c/p\u003e\n","automated_response":false,"created_at":"2016-10-28T10:25:40.150Z","updated_at":"2016-10-28T10:25:40.150Z","actor":{"username":"arneswinnen","cleared":true,"url":"/arneswinnen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/061/086/26dedde13e2d4ec49acf71a95f522b54dd5e659c_original.JPG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ui","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1273043,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@arneswinnen Can you verify the domain takeover gain?","markdown_message":"\u003cp\u003e\u003ca href=\"/arneswinnen\"\u003e@arneswinnen\u003c/a\u003e Can you verify the domain takeover gain?\u003c/p\u003e\n","automated_response":false,"created_at":"2016-10-28T16:05:58.384Z","updated_at":"2016-10-28T16:05:58.384Z","actor":{"username":"ubnt-rubens","cleared":false,"url":"/ubnt-rubens","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ui","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1273049,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi,\n\nI double-checked and the issue seems resolved. It is still pointing to cloudfront, but now returns an Ubiquity-specific 404 error page, indicating that you have control over the domain again.\n\nThe Authentication Bypass issue on your sso. ubnt.com domain is also indirectly resolved because of this.\n\nCheers,\n\nArne","markdown_message":"\u003cp\u003eHi,\u003c/p\u003e\n\n\u003cp\u003eI double-checked and the issue seems resolved. It is still pointing to cloudfront, but now returns an Ubiquity-specific 404 error page, indicating that you have control over the domain again.\u003c/p\u003e\n\n\u003cp\u003eThe Authentication Bypass issue on your sso. ubnt.com domain is also indirectly resolved because of this.\u003c/p\u003e\n\n\u003cp\u003eCheers,\u003c/p\u003e\n\n\u003cp\u003eArne\u003c/p\u003e\n","automated_response":false,"created_at":"2016-10-28T16:12:13.933Z","updated_at":"2016-10-28T16:12:13.933Z","actor":{"username":"arneswinnen","cleared":true,"url":"/arneswinnen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/061/086/26dedde13e2d4ec49acf71a95f522b54dd5e659c_original.JPG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":130803,"filename":"Screenshot_20161028-180656.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/130/803/446f978337138ed400bcfb0bbd88ffbd5c95cf18/Screenshot_20161028-180656.png?response-content-disposition=attachment%3B%20filename%3D%22Screenshot_20161028-180656.png%22%3B%20filename%2A%3DUTF-8%27%27Screenshot_20161028-180656.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQUYGCYHJT%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T044107Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJj%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIAGSCCKi0CRpYJMt3KX5x%2BNM9j2K4mM4glLH6mZ%2B8ExKAiEAlsZG1%2FfIYq0ODDSxwLnZfWyc08bfINN86QAI3Hqr4MgqtAMIURABGgwwMTM2MTkyNzQ4NDkiDG9txF7r12Yekik2WSqRA6NC8vsgwir7JTQr5zVnxH1x6efNaMXQv0rW73VsI4xDf6Ldo8AdQq%2B7eYd4BvolwrfpyHLOFrZnF4wc7R9rEQKh%2FswFKL9GQ6Lp2ujYTvyC5dhdjS4Sq%2F%2BYvPk3joZ%2BEwcDqk%2B5AvxLFqoiv3Y3ts7f9HYBqcl%2Fu20T7ZA6XxU9V7asrN5LT6SJz4xOu7iZzuPeZs4%2BFaw8tgu5A3W6CYmUUmbBs9q%2FQ%2FCO3t50tS7Dm5k%2BKM04Ar1VaXlWDuLdZKMC%2FS80%2FwDwH66vWVAjLib7jCkgBWXGEa9VryBHJJUl3qrXQrTIED1gUKeOoKk3fYvvyyIMJs3ja%2BbbO56fim%2BodEtN1FBU6g%2BuddJ4Qz5521XYpzwatC5mjJs6D50zWyfJnn9Xf%2FrDe3EacAX3oOhEBj%2Fu9S%2B46jeCaMjfEHwW8T%2FFnFpu%2FZf3e1NchqIFhOkEcnGH%2FqNmQtJ54g5I6x8j4N2c70CE7tuCZI1qjgi%2BfUfSwopFGky44IARFjLnTewCnMtMfFUa7haJa9C%2BcuqvMJDfqf8FOusB7%2BAWx%2FH2B4H9I7hLf9GkPQtz9yMVcytbF7umUu9c2W6aIn%2FKCYsmcfqyPQD%2Fe6EdfKQiWwtKrHes32q91jeUCiYfrRJFByq7uDxHGN0MingOOUWy72n3fdpooUwYjRfpac06PpxBSGvwEeiL%2BJlq9wl2E%2FMxojMrovyONCSYEoBpeEbNgMNFb9rpTiIW%2BX8OzRH6ra3L9dgd9y8nuqoCkIGYzNActVtKbpERxbtmkIoGAgtSCCLLfHT65g2k6G9afrZJZC86IhNmvJrDSG%2BKELC3%2BeAfU64DhUDssT9Dd%2Bm2pU0nRk1s8PUjuQ%3D%3D\u0026X-Amz-Signature=4664f99c9841993119a80537cb293dbc9c75af7787b4872294ae16d82e39a336"}],"genius_execution_id":null,"team_handle":"ui","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1273057,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2016-10-28T16:16:44.303Z","updated_at":"2016-10-28T16:16:44.303Z","actor":{"url":"/ui","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/800/449ca06f77c3e1dd1979bae1e5f16150334f7479_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Ubiquiti Inc."}},"bounty_amount":"500.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"ui","collaborator":{"username":"arneswinnen","url":"/arneswinnen"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1273061,"is_internal":false,"editable":false,"type":"Activities::BugDuplicate","message":"Thanks for testing","markdown_message":"\u003cp\u003eThanks for testing\u003c/p\u003e\n","automated_response":false,"created_at":"2016-10-28T16:18:14.726Z","updated_at":"2016-10-28T16:18:14.726Z","original_report_id":145224,"actor":{"username":"ubnt-rubens","cleared":false,"url":"/ubnt-rubens","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ui","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1273159,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi,\n\nCould you please elaborate on the updated duplicate status? I effectively claimed this domain and held on to it for more than a month, so it would seem a bit odd to me in this case...\n\nThanks in advance,\n\nArne","markdown_message":"\u003cp\u003eHi,\u003c/p\u003e\n\n\u003cp\u003eCould you please elaborate on the updated duplicate status? I effectively claimed this domain and held on to it for more than a month, so it would seem a bit odd to me in this case...\u003c/p\u003e\n\n\u003cp\u003eThanks in advance,\u003c/p\u003e\n\n\u003cp\u003eArne\u003c/p\u003e\n","automated_response":false,"created_at":"2016-10-28T17:23:20.216Z","updated_at":"2016-10-28T17:23:20.216Z","actor":{"username":"arneswinnen","cleared":true,"url":"/arneswinnen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/061/086/26dedde13e2d4ec49acf71a95f522b54dd5e659c_original.JPG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ui","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1273169,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Sorry @arneswinnen we had fixed this domain takeover before, around 4 month ago, but it got reversed.","markdown_message":"\u003cp\u003eSorry \u003ca href=\"/arneswinnen\"\u003e@arneswinnen\u003c/a\u003e we had fixed this domain takeover before, around 4 month ago, but it got reversed.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-10-28T17:25:37.150Z","updated_at":"2016-10-28T17:25:37.150Z","actor":{"username":"ubnt-rubens","cleared":false,"url":"/ubnt-rubens","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ui","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1273175,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi,\n\nDoesn't this constitute a new vulnerability in that case? If the previous report was fixed 4 months ago and suddenly became vulnerable again to takeover around one month ago, this does seem as a new regression issue to me, as the timelines of both reports definitely do not overlap.\n\nArne\n\n","markdown_message":"\u003cp\u003eHi,\u003c/p\u003e\n\n\u003cp\u003eDoesn\u0026#39;t this constitute a new vulnerability in that case? If the previous report was fixed 4 months ago and suddenly became vulnerable again to takeover around one month ago, this does seem as a new regression issue to me, as the timelines of both reports definitely do not overlap.\u003c/p\u003e\n\n\u003cp\u003eArne\u003c/p\u003e\n","automated_response":false,"created_at":"2016-10-28T17:30:19.193Z","updated_at":"2016-10-28T17:30:19.193Z","actor":{"username":"arneswinnen","cleared":true,"url":"/arneswinnen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/061/086/26dedde13e2d4ec49acf71a95f522b54dd5e659c_original.JPG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ui","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1273182,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Yes but the original submitter reported the regression (1 mouth like you), creating a overlapping in our point of view. I'm sorry for the inconvenience :(","markdown_message":"\u003cp\u003eYes but the original submitter reported the regression (1 mouth like you), creating a overlapping in our point of view. I\u0026#39;m sorry for the inconvenience :(\u003c/p\u003e\n","automated_response":false,"created_at":"2016-10-28T17:35:40.617Z","updated_at":"2016-10-28T17:35:40.617Z","actor":{"username":"ubnt-rubens","cleared":false,"url":"/ubnt-rubens","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ui","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1273239,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi,\n\nOk, that clarifies things. In that case, thank you very much for still awarding a bounty for this duplicate issue!\n\nWould you mind public disclosure of this report?\n\nThanks in advance,\n\nArne","markdown_message":"\u003cp\u003eHi,\u003c/p\u003e\n\n\u003cp\u003eOk, that clarifies things. In that case, thank you very much for still awarding a bounty for this duplicate issue!\u003c/p\u003e\n\n\u003cp\u003eWould you mind public disclosure of this report?\u003c/p\u003e\n\n\u003cp\u003eThanks in advance,\u003c/p\u003e\n\n\u003cp\u003eArne\u003c/p\u003e\n","automated_response":false,"created_at":"2016-10-28T18:08:06.319Z","updated_at":"2016-10-28T18:08:06.319Z","actor":{"username":"arneswinnen","cleared":true,"url":"/arneswinnen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/061/086/26dedde13e2d4ec49acf71a95f522b54dd5e659c_original.JPG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ui","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1273290,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @arneswinnen,\n\nCan you wait 1 month? So we can be sure that the takeover will not happen again.\n\nThanks","markdown_message":"\u003cp\u003eHi \u003ca href=\"/arneswinnen\"\u003e@arneswinnen\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eCan you wait 1 month? So we can be sure that the takeover will not happen again.\u003c/p\u003e\n\n\u003cp\u003eThanks\u003c/p\u003e\n","automated_response":false,"created_at":"2016-10-28T18:28:31.689Z","updated_at":"2016-10-28T18:28:31.689Z","actor":{"username":"ubnt-rubens","cleared":false,"url":"/ubnt-rubens","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ui","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1273501,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Sure. As long as you don't explicitly accept/deny my request for public disclosure, it will only become active in 30 days from here.","markdown_message":"\u003cp\u003eSure. As long as you don\u0026#39;t explicitly accept/deny my request for public disclosure, it will only become active in 30 days from here.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-10-28T20:32:36.102Z","updated_at":"2016-10-28T20:32:36.102Z","actor":{"username":"arneswinnen","cleared":true,"url":"/arneswinnen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/061/086/26dedde13e2d4ec49acf71a95f522b54dd5e659c_original.JPG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ui","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1273502,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-10-28T20:32:51.283Z","updated_at":"2016-10-28T20:32:51.283Z","first_to_agree":true,"actor":{"username":"arneswinnen","cleared":true,"url":"/arneswinnen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/061/086/26dedde13e2d4ec49acf71a95f522b54dd5e659c_original.JPG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ui","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1325208,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @ubnt ,\n\nSince this is a duplicate report, it does require your approval to be disclosed publicly. Could you consider this? The [original report](https://hackerone.com/reports/145224) has already been made public, so I don't see any reason not to publicly disclose. \n\nThanks in advance,\n\nArne","markdown_message":"\u003cp\u003eHi \u003ca href=\"/ubnt\"\u003e@ubnt\u003c/a\u003e ,\u003c/p\u003e\n\n\u003cp\u003eSince this is a duplicate report, it does require your approval to be disclosed publicly. Could you consider this? The \u003ca href=\"https://hackerone.com/reports/145224\"\u003eoriginal report\u003c/a\u003e has already been made public, so I don\u0026#39;t see any reason not to publicly disclose. \u003c/p\u003e\n\n\u003cp\u003eThanks in advance,\u003c/p\u003e\n\n\u003cp\u003eArne\u003c/p\u003e\n","automated_response":false,"created_at":"2016-11-29T06:40:05.102Z","updated_at":"2016-11-29T06:40:05.102Z","actor":{"username":"arneswinnen","cleared":true,"url":"/arneswinnen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/061/086/26dedde13e2d4ec49acf71a95f522b54dd5e659c_original.JPG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ui","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1325357,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Ok, you can request public disclosure","markdown_message":"\u003cp\u003eOk, you can request public disclosure\u003c/p\u003e\n","automated_response":false,"created_at":"2016-11-29T08:37:15.827Z","updated_at":"2016-11-29T08:37:15.827Z","actor":{"username":"ubnt-rubens","cleared":false,"url":"/ubnt-rubens","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ui","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1325359,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi,\n\nThat should already be the case, I requested it around a month ago. Can you approve?\n\nThanks in advance,\n\nArne","markdown_message":"\u003cp\u003eHi,\u003c/p\u003e\n\n\u003cp\u003eThat should already be the case, I requested it around a month ago. Can you approve?\u003c/p\u003e\n\n\u003cp\u003eThanks in advance,\u003c/p\u003e\n\n\u003cp\u003eArne\u003c/p\u003e\n","automated_response":false,"created_at":"2016-11-29T08:38:12.341Z","updated_at":"2016-11-29T08:38:12.341Z","actor":{"username":"arneswinnen","cleared":true,"url":"/arneswinnen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/061/086/26dedde13e2d4ec49acf71a95f522b54dd5e659c_original.JPG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ui","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1325365,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-11-29T08:39:46.422Z","updated_at":"2016-11-29T08:39:46.422Z","actor":{"username":"ubnt-rubens","cleared":false,"url":"/ubnt-rubens","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ui","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1325366,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-11-29T08:39:48.268Z","updated_at":"2016-11-29T08:39:48.268Z","actor":{"username":"ubnt-rubens","cleared":false,"url":"/ubnt-rubens","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ui","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}