{"id":347282,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zNDcyODI=","url":"https://hackerone.com/reports/347282","title":"Linux kernel: CVE-2017-6074: DCCP double-free vulnerability","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2018-05-03T22:10:54.923Z","submitted_at":"2018-05-03T22:10:54.923Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"xairy","url":"/xairy","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":20,"url":"https://hackerone.com/internet","handle":"internet","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/e3e1c58882b2645d9108ec102731a354cbf5852e_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/e3e1c58882b2645d9108ec102731a354cbf5852e_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"The Internet","twitter_handle":null,"website":"","about":"Hack all the things."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":["CVE-2017-6074"],"singular_disclosure_disabled":false,"disclosed_at":"2019-08-27T21:07:09.510Z","bug_reporter_agreed_on_going_public_at":"2019-08-27T21:07:09.398Z","team_member_agreed_on_going_public_at":"2019-08-27T20:20:14.329Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi!\n\nCVE-2017-6074 [1]  is a double-free vulnerability I found in the Linux kernel. It can be exploited to gain\nkernel code execution from an unprivileged processes. The kernel needs to be built with CONFIG_IP_DCCP for the vulnerability to be present. A lot of modern distributions enable this option by default.\n\nFixed on Feb 17, 2017 [2]. The oldest version that I checked is 2.6.18 (Sep 2006), which is vulnerable. However, the bug was introduced before that, probably in the first release with DCCP support (2.6.14, Oct 2005).\n\nI initially reported this vulnerability to security@kernel.org following the coordinated disclosure process. The timeline and more details about the vulnerability can be found in my announcement on oss-security [3]. A proof-of-concept exploit for the 4.4.0-62-generic #83-Ubuntu kernel can be found here [4, 5].\n\nThe reason I'm reporting this now is that I just saw a similar bug [6] in the Windows kernel reported to this program and that reminded me of a Sandbox Escape program that used to be on HackerOne. I thought it makes sense to see if IBB would come back to considering this kind of bugs eligible for a bounty.\n\nThanks!\n\n[1] https://nvd.nist.gov/vuln/detail/CVE-2017-6074\n\n[2] https://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=5edabca9d4cff7f1f2b68f0bac55ef99d9798ba4\n\n[3] http://seclists.org/oss-sec/2017/q1/471\n\n[4] https://github.com/xairy/kernel-exploits/tree/master/CVE-2017-6074\n\n[5] http://seclists.org/oss-sec/2017/q1/503\n\n[6] https://hackerone.com/reports/48100\n\n## Impact\n\nThis vulnerability allows a local attacker to elevate privileges to root on a machine with vulnerable Linux kernel version.","vulnerability_information_html":"\u003cp\u003eHi!\u003c/p\u003e\n\n\u003cp\u003eCVE-2017-6074 [1]  is a double-free vulnerability I found in the Linux kernel. It can be exploited to gain\u003cbr\u003e\nkernel code execution from an unprivileged processes. The kernel needs to be built with CONFIG_IP_DCCP for the vulnerability to be present. A lot of modern distributions enable this option by default.\u003c/p\u003e\n\n\u003cp\u003eFixed on Feb 17, 2017 [2]. The oldest version that I checked is 2.6.18 (Sep 2006), which is vulnerable. However, the bug was introduced before that, probably in the first release with DCCP support (2.6.14, Oct 2005).\u003c/p\u003e\n\n\u003cp\u003eI initially reported this vulnerability to \u003ca title=\"security@kernel.org\" href=\"mailto:security@kernel.org\" rel=\"nofollow noopener noreferrer\"\u003esecurity@kernel.org\u003c/a\u003e following the coordinated disclosure process. The timeline and more details about the vulnerability can be found in my announcement on oss-security [3]. A proof-of-concept exploit for the 4.4.0-62-generic #83-Ubuntu kernel can be found here [4, 5].\u003c/p\u003e\n\n\u003cp\u003eThe reason I\u0026#39;m reporting this now is that I just saw a similar bug [6] in the Windows kernel reported to this program and that reminded me of a Sandbox Escape program that used to be on HackerOne. I thought it makes sense to see if IBB would come back to considering this kind of bugs eligible for a bounty.\u003c/p\u003e\n\n\u003cp\u003eThanks!\u003c/p\u003e\n\n\u003cp\u003e[1] \u003ca title=\"https://nvd.nist.gov/vuln/detail/CVE-2017-6074\" href=\"/redirect?url=https%3A%2F%2Fnvd.nist.gov%2Fvuln%2Fdetail%2FCVE-2017-6074\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://nvd.nist.gov/vuln/detail/CVE-2017-6074\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e[2] \u003ca title=\"https://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=5edabca9d4cff7f1f2b68f0bac55ef99d9798ba4\" href=\"/redirect?url=https%3A%2F%2Fgit.kernel.org%2Fcgit%2Flinux%2Fkernel%2Fgit%2Ftorvalds%2Flinux.git%2Fcommit%2F%3Fid%3D5edabca9d4cff7f1f2b68f0bac55ef99d9798ba4\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=5edabca9d4cff7f1f2b68f0bac55ef99d9798ba4\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e[3] \u003ca title=\"http://seclists.org/oss-sec/2017/q1/471\" href=\"/redirect?url=http%3A%2F%2Fseclists.org%2Foss-sec%2F2017%2Fq1%2F471\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://seclists.org/oss-sec/2017/q1/471\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e[4] \u003ca title=\"https://github.com/xairy/kernel-exploits/tree/master/CVE-2017-6074\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fxairy%2Fkernel-exploits%2Ftree%2Fmaster%2FCVE-2017-6074\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/xairy/kernel-exploits/tree/master/CVE-2017-6074\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e[5] \u003ca title=\"http://seclists.org/oss-sec/2017/q1/503\" href=\"/redirect?url=http%3A%2F%2Fseclists.org%2Foss-sec%2F2017%2Fq1%2F503\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://seclists.org/oss-sec/2017/q1/503\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e[6] \u003ca title=\"https://hackerone.com/reports/48100\" href=\"https://hackerone.com/reports/48100\"\u003ehttps://hackerone.com/reports/48100\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eThis vulnerability allows a local attacker to elevate privileges to root on a machine with vulnerable Linux kernel version.\u003c/p\u003e\n","bounty_amount":"1000.0","formatted_bounty":"$1,000","weakness":{"id":49,"name":"Double Free"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2019-09-26T20:20:14.419Z","allow_singular_disclosure_after":-39691217.60978139,"singular_disclosure_allowed":true,"vote_count":8,"voters":["bl4de","sameerphad72","cryptographer","b4bbl1n6br00k3","iverb","intx0x80","rad333","effenberg0x0"],"severity":{"rating":"high","score":7.8,"author_type":"User","metrics":{"attack_vector":"local","attack_complexity":"low","privileges_required":"low","user_interaction":"none","scope":"unchanged","confidentiality":"high","integrity":"high","availability":"high"}},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":2721211,"is_internal":false,"editable":false,"type":"Activities::CveIdAdded","message":"","markdown_message":"","automated_response":false,"created_at":"2018-05-09T19:38:04.676Z","updated_at":"2018-05-09T19:38:04.676Z","cve_ids":["CVE-2017-6074"],"actor":{"username":"arice","cleared":false,"url":"/arice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/83152cb2d070f3f6a63c1b61bae47257722b5ad2_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"internet","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2721234,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @xairy - \n\nThanks for the finding. We've sunset the sandbox escape program (which this likely would have been eligible under), and we haven't had a conversation on whether local privesc meets the criteria for our broader \"Internet\" bounty program. Possibly not, but now is as good of a time as any to have that discussion!\n\nWe'll review in our next monthly panel meeting and get back to you.\n\nThanks,\nalex","markdown_message":"\u003cp\u003eHi \u003ca href=\"/xairy\"\u003e@xairy\u003c/a\u003e - \u003c/p\u003e\n\n\u003cp\u003eThanks for the finding. We\u0026#39;ve sunset the sandbox escape program (which this likely would have been eligible under), and we haven\u0026#39;t had a conversation on whether local privesc meets the criteria for our broader \u0026quot;Internet\u0026quot; bounty program. Possibly not, but now is as good of a time as any to have that discussion!\u003c/p\u003e\n\n\u003cp\u003eWe\u0026#39;ll review in our next monthly panel meeting and get back to you.\u003c/p\u003e\n\n\u003cp\u003eThanks,\u003cbr\u003e\nalex\u003c/p\u003e\n","automated_response":false,"created_at":"2018-05-09T19:41:26.512Z","updated_at":"2018-05-09T19:41:26.512Z","actor":{"username":"arice","cleared":false,"url":"/arice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/83152cb2d070f3f6a63c1b61bae47257722b5ad2_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"internet","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2721235,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2018-05-09T19:41:32.274Z","updated_at":"2018-05-09T19:41:32.274Z","actor":{"username":"arice","cleared":false,"url":"/arice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/83152cb2d070f3f6a63c1b61bae47257722b5ad2_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"internet","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2794037,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Great! Looking forward to the results of the discussion!","markdown_message":"\u003cp\u003eGreat! Looking forward to the results of the discussion!\u003c/p\u003e\n","automated_response":false,"created_at":"2018-05-24T22:46:45.841Z","updated_at":"2018-05-24T22:46:45.841Z","actor":{"username":"xairy","cleared":false,"url":"/xairy","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"internet","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5222420,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Any updates on this? :)","markdown_message":"\u003cp\u003eAny updates on this? :)\u003c/p\u003e\n","automated_response":false,"created_at":"2019-06-29T23:41:48.009Z","updated_at":"2019-06-29T23:41:48.009Z","actor":{"username":"xairy","cleared":false,"url":"/xairy","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"internet","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5678244,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2019-08-27T20:19:54.237Z","updated_at":"2019-08-27T20:19:54.237Z","actor":{"url":"/internet","ibb":true,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/e3e1c58882b2645d9108ec102731a354cbf5852e_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"The Internet"}},"bounty_amount":"1000.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"internet","collaborator":{"username":"xairy","url":"/xairy"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5678245,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thank you for helping keep the Internet safe!","markdown_message":"\u003cp\u003eThank you for helping keep the Internet safe!\u003c/p\u003e\n","automated_response":false,"created_at":"2019-08-27T20:20:03.683Z","updated_at":"2019-08-27T20:20:03.683Z","actor":{"username":"reed","cleared":false,"url":"/reed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"reporter":{"username":"xairy","url":"/xairy"},"genius_execution_id":null,"team_handle":"internet","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5678247,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-08-27T20:20:14.345Z","updated_at":"2019-08-27T20:20:14.345Z","first_to_agree":true,"actor":{"username":"reed","cleared":false,"url":"/reed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"internet","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5678680,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-08-27T21:07:09.426Z","updated_at":"2019-08-27T21:07:09.426Z","actor":{"username":"xairy","cleared":false,"url":"/xairy","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"internet","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5678681,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-08-27T21:07:09.538Z","updated_at":"2019-08-27T21:07:09.538Z","actor":{"username":"xairy","cleared":false,"url":"/xairy","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"internet","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5691417,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you! Great to know that Linux LPE vulnerabilities are now again within the scope of IBB!","markdown_message":"\u003cp\u003eThank you! Great to know that Linux LPE vulnerabilities are now again within the scope of IBB!\u003c/p\u003e\n","automated_response":false,"created_at":"2019-08-29T14:09:13.231Z","updated_at":"2019-08-29T14:09:13.231Z","actor":{"username":"xairy","cleared":false,"url":"/xairy","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"internet","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}