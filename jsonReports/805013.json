{"id":805013,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC84MDUwMTM=","url":"https://hackerone.com/reports/805013","title":"DirectoryIterator class silently truncates after a null byte","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2020-02-26T05:07:29.054Z","submitted_at":"2020-02-26T05:07:29.054Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"ryat","url":"/ryat","profile_picture_urls":{"small":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/wfyfjk9cawbuzqqdx88azrvxmqt6/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a?response-content-disposition=inline%3B%20filename%3D%22chtg.jpeg%22%3B%20filename%2A%3DUTF-8%27%27chtg.jpeg\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ3UNE4J5L%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T065557Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCz7kjO3QyFP7jGDkA5krNaLE6O2p1tR4x0TQtjMemDwQIhALc5Qo7beEygqpMNylJrOurNEmXX%2FUaJ7i3JOGstSxsEKrQDCFcQARoMMDEzNjE5Mjc0ODQ5IgxX2Y8wmCeqyUWE5MQqkQO1SEq9Kl%2BewQlhrlfUoVvv9N1OLaMkWrWIlv8SukYusm40FYD0qUCOJT%2BzitdeP3Kr9dqa%2BJmxV7c3%2BjXo4WulUP6OrfhUn0Rcu3T1VRcH6Qpx%2FGLAa4zE5IBGMdsXZEcR335EaBEylCpdLxObdeJZ8wmT%2FiMsJqVnexQRWK0gOcg8%2BaAe0Z4MQhfL%2FVbk8%2Botr0dFlI%2FaPx8jXCrTw%2FTlRp0P9OtpSvUQA1RBVrS5L3ZNrC33bQ4md%2B9KmXmIycB047RJuvaypZW9qepGhczrUMsYabbxifZ%2FJ17yJLs39h1ENkrjIFD7f9gA%2F9u%2BsTKrtFMmGu8%2FrThH1%2FAJX2J2V%2FiXJ%2Fj2flmFEXmyNg7XqFuZ2VEFhEknqlw0sjyH5ibXryf8lYs%2FL9ye%2FbGye3G8MgjG1rQQkaNLm9nZxru2uR4y5NwW33D%2F%2F27wPuxj5YAD30GEm3l3%2BfNuoV8Y%2Fa6KBiEG2ZFNI%2Fu9t%2F7aALxmsSX49Fkt%2Fvbd%2B2ORICgPABnOO5GRZQldPJ3fh%2FPtVXm3oDDyjav%2FBTrqAWjMucnwKi73c9CZ4eV75rJ5%2B4PnghCALwGiHX4zE11a5NOtuIpj8v3a2y9AJMGR0JyOdjGEipkC8KkLqeEMFaYnCk4oCce5NwJVnhh%2F8yBh%2BJDy7WhfYG2qUirylB1Ud3rl1KSDWno%2BbVYDQgs2rcyOKmLb%2FH1USBmJPVZi3%2FK%2F%2FJ6%2BATEV10VMohl2iHY7GlXPewFvZ2tG%2FogGkzwNQUb%2BD2o7r0beeLXek5XslTtgqNCoDP9xL1i88F02X5Buj81GAIlEB1qQFUoRMd2N%2Fu0SnL64HSNiPSzstRRJidfEI6C%2F%2FcDv%2BmWfcA%3D%3D\u0026X-Amz-Signature=ce5dd4af4562b844eada2a442b28df5138fcf5b656524b7dfe56a168fd049383"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":29,"url":"https://hackerone.com/ibb-php","handle":"ibb-php","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/029/99087dbbdf52fc3ce3acbf16aa33a5c4f5e2c111_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/029/99087dbbdf52fc3ce3acbf16aa33a5c4f5e2c111_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"paused","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"PHP (IBB)","twitter_handle":"","website":"http://www.php.net","about":""}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2020-11-09T01:47:49.014Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2020-10-10T01:47:45.034Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"The bug submitted at: https://bugs.php.net/bug.php?id=78863\nThe security advisory at: https://nvd.nist.gov/vuln/detail/CVE-2019-11045\n\nThere's an issue with SPL PHP extension on spl_filesystem_object_construct() function. When creating a new DirectoryIterator() object spl_filesystem_object_construct() function is called and use zend to parse its arguments with the wrong parameter type specifier, this bug leads the zend_parse_parameters() to interprete the parameter as a simple string instead of a filesystem path. An attacker may leverage this by crafting a path name containing NULL bytes which will be badly parsed, allowing the attacker eventually by pass any path-based security validation or listing documents from a unexpected directory.\n\nThis flaw has a high Confidentiality impact as the actor may eventually seen the filesystem tree from the attacked machine but a high complexity as the attacker may need to have previous knowledge of filesystem organization or trick the user to run the malicious script.\n\n## Impact\n\nIn PHP versions 7.2.x below 7.2.26, 7.3.x below 7.3.13 and 7.4.0, PHP DirectoryIterator class accepts filenames with embedded \\0 byte and treats them as terminating at that byte. This could lead to security vulnerabilities, e.g. in applications checking paths that the code is allowed to access.","vulnerability_information_html":"\u003cp\u003eThe bug submitted at: \u003ca title=\"https://bugs.php.net/bug.php?id=78863\" href=\"/redirect?url=https%3A%2F%2Fbugs.php.net%2Fbug.php%3Fid%3D78863\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://bugs.php.net/bug.php?id=78863\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nThe security advisory at: \u003ca title=\"https://nvd.nist.gov/vuln/detail/CVE-2019-11045\" href=\"/redirect?url=https%3A%2F%2Fnvd.nist.gov%2Fvuln%2Fdetail%2FCVE-2019-11045\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://nvd.nist.gov/vuln/detail/CVE-2019-11045\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eThere\u0026#39;s an issue with SPL PHP extension on spl_filesystem_object_construct() function. When creating a new DirectoryIterator() object spl_filesystem_object_construct() function is called and use zend to parse its arguments with the wrong parameter type specifier, this bug leads the zend_parse_parameters() to interprete the parameter as a simple string instead of a filesystem path. An attacker may leverage this by crafting a path name containing NULL bytes which will be badly parsed, allowing the attacker eventually by pass any path-based security validation or listing documents from a unexpected directory.\u003c/p\u003e\n\n\u003cp\u003eThis flaw has a high Confidentiality impact as the actor may eventually seen the filesystem tree from the attacked machine but a high complexity as the attacker may need to have previous knowledge of filesystem organization or trick the user to run the malicious script.\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eIn PHP versions 7.2.x below 7.2.26, 7.3.x below 7.3.13 and 7.4.0, PHP DirectoryIterator class accepts filenames with embedded \\0 byte and treats them as terminating at that byte. This could lead to security vulnerabilities, e.g. in applications checking paths that the code is allowed to access.\u003c/p\u003e\n","bounty_amount":"500.0","formatted_bounty":"$500","weakness":{"id":14,"name":"Improper Null Termination"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2020-11-09T01:47:45.125Z","allow_singular_disclosure_after":-4338491.957210469,"singular_disclosure_allowed":true,"vote_count":0,"voters":[],"severity":{"rating":"medium","author_type":"User"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":7154021,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @ryat,\n\nThank you for your submission. Your report is currently being reviewed and the HackerOne triage team will get back to you once there is additional information to share.\n\nKind regards,\n@nochnoidozor","markdown_message":"\u003cp\u003eHi \u003ca href=\"/ryat\"\u003e@ryat\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThank you for your submission. Your report is currently being reviewed and the HackerOne triage team will get back to you once there is additional information to share.\u003c/p\u003e\n\n\u003cp\u003eKind regards,\u003cbr\u003e\n\u003ca href=\"/nochnoidozor\"\u003e@nochnoidozor\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2020-02-26T10:17:15.403Z","updated_at":"2020-02-26T10:17:15.403Z","actor":{"username":"nochnoidozor","cleared":false,"url":"/nochnoidozor","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"ibb-php","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":7154043,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hello @ryat,\n\nThank you for your submission! We were able to validate your report, and have submitted it to the appropriate remediation team for review. They will let us know the final ruling on this report, and when/if a fix will be implemented. Please note that the status and severity are subject to change.\n\nRegards,\n@nochnoidozor","markdown_message":"\u003cp\u003eHello \u003ca href=\"/ryat\"\u003e@ryat\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThank you for your submission! We were able to validate your report, and have submitted it to the appropriate remediation team for review. They will let us know the final ruling on this report, and when/if a fix will be implemented. Please note that the status and severity are subject to change.\u003c/p\u003e\n\n\u003cp\u003eRegards,\u003cbr\u003e\n\u003ca href=\"/nochnoidozor\"\u003e@nochnoidozor\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2020-02-26T10:19:15.260Z","updated_at":"2020-02-26T10:19:15.260Z","actor":{"username":"nochnoidozor","cleared":false,"url":"/nochnoidozor","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"ibb-php","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":9478495,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2020-10-10T00:39:26.910Z","updated_at":"2020-10-10T00:39:26.910Z","actor":{"url":"/ibb-php","ibb":true,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/029/99087dbbdf52fc3ce3acbf16aa33a5c4f5e2c111_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"PHP (IBB)"}},"bounty_amount":"500.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"ibb-php","collaborator":{"username":"ryat","url":"/ryat"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9478496,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hello @ryat,\n\nOn behalf of the Internet Bug Bounty Panel, thank you for your continued patience on this report. The IBB requires that all in-scope open source projects be mutually engaged with us to ensure there is a good experience for all. Unfortunately, we have not been able to maintain that relationship with the upstream PHP community, and as a result, HackerOne and the IBB Panel have collectively agreed to shut down the program indefinitely.\n\nIn an effort to reward researchers for their hard work and patience thus far, the IBB panel has elected to pay bounties to all valid reports without PHP’s input. Bounty amounts are decided on based on the PHP policy and severity assigned on the accompanying CVE. \n\nAs an act of good faith, we will also close this report as Resolved.\n\nThank you for helping keep the internet safe and secure!\n-The Internet Bug Bounty Panel \n","markdown_message":"\u003cp\u003eHello \u003ca href=\"/ryat\"\u003e@ryat\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eOn behalf of the Internet Bug Bounty Panel, thank you for your continued patience on this report. The IBB requires that all in-scope open source projects be mutually engaged with us to ensure there is a good experience for all. Unfortunately, we have not been able to maintain that relationship with the upstream PHP community, and as a result, HackerOne and the IBB Panel have collectively agreed to shut down the program indefinitely.\u003c/p\u003e\n\n\u003cp\u003eIn an effort to reward researchers for their hard work and patience thus far, the IBB panel has elected to pay bounties to all valid reports without PHP’s input. Bounty amounts are decided on based on the PHP policy and severity assigned on the accompanying CVE. \u003c/p\u003e\n\n\u003cp\u003eAs an act of good faith, we will also close this report as Resolved.\u003c/p\u003e\n\n\u003cp\u003eThank you for helping keep the internet safe and secure!\u003cbr\u003e\n-The Internet Bug Bounty Panel \u003c/p\u003e\n","automated_response":false,"created_at":"2020-10-10T00:39:37.181Z","updated_at":"2020-10-10T00:39:37.181Z","actor":{"username":"reed","cleared":false,"url":"/reed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"reporter":{"username":"ryat","url":"/ryat"},"genius_execution_id":null,"team_handle":"ibb-php","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9478691,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-10-10T01:47:45.052Z","updated_at":"2020-10-10T01:47:45.052Z","first_to_agree":true,"actor":{"username":"reed","cleared":false,"url":"/reed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"ibb-php","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9762800,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-11-09T01:47:49.033Z","updated_at":"2020-11-09T01:47:49.033Z","actor":{"url":"/ibb-php","ibb":true,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/029/99087dbbdf52fc3ce3acbf16aa33a5c4f5e2c111_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"PHP (IBB)"}},"genius_execution_id":null,"team_handle":"ibb-php","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}