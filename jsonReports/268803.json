{"id":268803,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yNjg4MDM=","url":"https://hackerone.com/reports/268803","title":"CVE-2017-12985: The IPv6 parser in tcpdump before 4.9.2 has a buffer over-read in ip6_print()","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2017-09-15T23:34:37.040Z","submitted_at":"2017-09-15T23:34:37.040Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"geeknik","url":"/geeknik","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/7xfGZCKCxUuGLYGfuUZM3XyY/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":21653,"url":"https://hackerone.com/ibb-data","handle":"ibb-data","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/021/653/2abb8bf772c4bddda91f5a4744e4b7e74c88675d_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/021/653/2abb8bf772c4bddda91f5a4744e4b7e74c88675d_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Data Processing (IBB)","twitter_handle":"","website":"","about":""}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":["CVE-2017-12985"],"singular_disclosure_disabled":false,"disclosed_at":"2019-10-08T20:32:03.897Z","bug_reporter_agreed_on_going_public_at":"2019-10-04T16:23:46.518Z","team_member_agreed_on_going_public_at":"2019-10-08T20:32:03.819Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Reported to the devs on 4 February 2017.\nTcpdump 4.9.2 released on 8 September 2017.\nPatch: https://github.com/the-tcpdump-group/tcpdump/commit/66df248b49095c261138b5a5e34d341a6bf9ac7f\n\n`The IPv6 parser in tcpdump before 4.9.2 has a buffer over-read in print-ip6.c.`\n\n```\n./tcpdump -nr test003\nreading from file test003, link-type IPV6 (Raw IPv6)\n=================================================================\n==31276==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x60400000e000 at pc 0x000000578cd5 bp 0x7ffe8e397cd0 sp 0x7ffe8e397cc8\nREAD of size 1 at 0x60400000e000 thread T0\n    #0 0x578cd4 in ip6_print /root/tcpdump/./print-ip6.c:348:4\n    #1 0x576fdc in ipN_print /root/tcpdump/./print-ip.c:700:3\n    #2 0x626677 in raw_if_print /root/tcpdump/./print-raw.c:42:2\n    #3 0x4de3c9 in pretty_print_packet /root/tcpdump/./print.c:339:18\n    #4 0x4ccb0b in print_packet /root/tcpdump/./tcpdump.c:2555:2\n    #5 0x775960 in pcap_offline_read /root/libpcap/./savefile.c:527:4\n    #6 0x6a3f3c in pcap_loop /root/libpcap/./pcap.c:1623:8\n    #7 0x4c8f1e in main /root/tcpdump/./tcpdump.c:2058:12\n    #8 0x7efcfe253b44 in __libc_start_main /build/glibc-qK83Be/glibc-2.19/csu/libc-start.c:287\n    #9 0x4c419c in _start (/root/tcpdump/tcpdump+0x4c419c)\n\n0x60400000e000 is located 0 bytes to the right of 48-byte region [0x60400000dfd0,0x60400000e000)\nallocated by thread T0 here:\n    #0 0x4a6b1b in malloc (/root/tcpdump/tcpdump+0x4a6b1b)\n    #1 0x7772b3 in pcap_check_header /root/libpcap/./sf-pcap.c:401:14\n    #2 0x774fc2 in pcap_fopen_offline_with_tstamp_precision /root/libpcap/./savefile.c:400:7\n    #3 0x774d54 in pcap_open_offline_with_tstamp_precision /root/libpcap/./savefile.c:307:6\n\nSUMMARY: AddressSanitizer: heap-buffer-overflow /root/tcpdump/./print-ip6.c:348 ip6_print\n```","vulnerability_information_html":"\u003cp\u003eReported to the devs on 4 February 2017.\u003cbr\u003e\nTcpdump 4.9.2 released on 8 September 2017.\u003cbr\u003e\nPatch: \u003ca title=\"https://github.com/the-tcpdump-group/tcpdump/commit/66df248b49095c261138b5a5e34d341a6bf9ac7f\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fthe-tcpdump-group%2Ftcpdump%2Fcommit%2F66df248b49095c261138b5a5e34d341a6bf9ac7f\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/the-tcpdump-group/tcpdump/commit/66df248b49095c261138b5a5e34d341a6bf9ac7f\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003ccode\u003eThe IPv6 parser in tcpdump before 4.9.2 has a buffer over-read in print-ip6.c.\u003c/code\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e./tcpdump -nr test003\nreading from file test003, link-type IPV6 (Raw IPv6)\n=================================================================\n==31276==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x60400000e000 at pc 0x000000578cd5 bp 0x7ffe8e397cd0 sp 0x7ffe8e397cc8\nREAD of size 1 at 0x60400000e000 thread T0\n    #0 0x578cd4 in ip6_print /root/tcpdump/./print-ip6.c:348:4\n    #1 0x576fdc in ipN_print /root/tcpdump/./print-ip.c:700:3\n    #2 0x626677 in raw_if_print /root/tcpdump/./print-raw.c:42:2\n    #3 0x4de3c9 in pretty_print_packet /root/tcpdump/./print.c:339:18\n    #4 0x4ccb0b in print_packet /root/tcpdump/./tcpdump.c:2555:2\n    #5 0x775960 in pcap_offline_read /root/libpcap/./savefile.c:527:4\n    #6 0x6a3f3c in pcap_loop /root/libpcap/./pcap.c:1623:8\n    #7 0x4c8f1e in main /root/tcpdump/./tcpdump.c:2058:12\n    #8 0x7efcfe253b44 in __libc_start_main /build/glibc-qK83Be/glibc-2.19/csu/libc-start.c:287\n    #9 0x4c419c in _start (/root/tcpdump/tcpdump+0x4c419c)\n\n0x60400000e000 is located 0 bytes to the right of 48-byte region [0x60400000dfd0,0x60400000e000)\nallocated by thread T0 here:\n    #0 0x4a6b1b in malloc (/root/tcpdump/tcpdump+0x4a6b1b)\n    #1 0x7772b3 in pcap_check_header /root/libpcap/./sf-pcap.c:401:14\n    #2 0x774fc2 in pcap_fopen_offline_with_tstamp_precision /root/libpcap/./savefile.c:400:7\n    #3 0x774d54 in pcap_open_offline_with_tstamp_precision /root/libpcap/./savefile.c:307:6\n\nSUMMARY: AddressSanitizer: heap-buffer-overflow /root/tcpdump/./print-ip6.c:348 ip6_print\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","bounty_amount":"500.0","formatted_bounty":"$500","weakness":{"id":9,"name":"Buffer Over-read"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2019-11-03T16:23:46.571Z","allow_singular_disclosure_after":-36420864.23695997,"singular_disclosure_allowed":true,"vote_count":2,"voters":["geeknik","japz"],"severity":{"rating":"high","score":7.3,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"none","user_interaction":"none","scope":"unchanged","confidentiality":"low","integrity":"low","availability":"low"}},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":2041371,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"This vulnerability can be exploited in two ways. The first is to produce a .pcap file with crafted packet(s) for the protocol(s) concerned and make the target system try to decode the file using tcpdump. The second is to send specially crafted packet(s) to the network segment where the target system is running a tcpdump process that is decoding a live packet capture. In the latter case it depends on the specific network protocol if the crafted packet(s) may be sent from the local segment only or from a remote Internet host.","markdown_message":"\u003cp\u003eThis vulnerability can be exploited in two ways. The first is to produce a .pcap file with crafted packet(s) for the protocol(s) concerned and make the target system try to decode the file using tcpdump. The second is to send specially crafted packet(s) to the network segment where the target system is running a tcpdump process that is decoding a live packet capture. In the latter case it depends on the specific network protocol if the crafted packet(s) may be sent from the local segment only or from a remote Internet host.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-10-03T16:57:36.519Z","updated_at":"2017-10-03T16:57:36.519Z","actor":{"username":"geeknik","cleared":true,"url":"/geeknik","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/7xfGZCKCxUuGLYGfuUZM3XyY/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ibb-data","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2216213,"is_internal":false,"editable":false,"type":"Activities::ReassignedToTeam","message":"","markdown_message":"","automated_response":false,"created_at":"2017-12-12T06:19:41.801Z","updated_at":"2017-12-12T06:19:41.801Z","additional_data":{"old_team":"The Internet","new_team":"Data Processing (IBB)"},"actor":{"username":"arice","cleared":false,"url":"/arice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/83152cb2d070f3f6a63c1b61bae47257722b5ad2_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"ibb-data","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2216417,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2017-12-12T06:38:52.601Z","updated_at":"2017-12-12T06:38:52.601Z","additional_data":{"old_severity":"High","new_severity":"High (7.3)","old_severity_id":75583,"new_severity_id":101065},"actor":{"username":"arice","cleared":false,"url":"/arice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/83152cb2d070f3f6a63c1b61bae47257722b5ad2_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"ibb-data","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2216418,"is_internal":false,"editable":false,"type":"Activities::CveIdAdded","message":"","markdown_message":"","automated_response":false,"created_at":"2017-12-12T06:39:00.209Z","updated_at":"2017-12-12T06:39:00.209Z","cve_ids":["CVE-2017-12985"],"actor":{"username":"arice","cleared":false,"url":"/arice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/83152cb2d070f3f6a63c1b61bae47257722b5ad2_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"ibb-data","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2216419,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2017-12-12T06:39:07.242Z","updated_at":"2017-12-12T06:39:07.242Z","actor":{"url":"/ibb-data","ibb":true,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/021/653/2abb8bf772c4bddda91f5a4744e4b7e74c88675d_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Data Processing (IBB)"}},"bounty_amount":"500.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"ibb-data","collaborator":{"username":"geeknik","url":"/geeknik"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2216420,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2017-12-12T06:39:13.664Z","updated_at":"2017-12-12T06:39:13.664Z","actor":{"username":"arice","cleared":false,"url":"/arice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/83152cb2d070f3f6a63c1b61bae47257722b5ad2_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"reporter":{"username":"geeknik","url":"/geeknik"},"genius_execution_id":null,"team_handle":"ibb-data","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5960686,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-10-04T16:23:46.536Z","updated_at":"2019-10-04T16:23:46.536Z","first_to_agree":true,"actor":{"username":"geeknik","cleared":true,"url":"/geeknik","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/7xfGZCKCxUuGLYGfuUZM3XyY/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ibb-data","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5989657,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-10-08T20:32:03.834Z","updated_at":"2019-10-08T20:32:03.834Z","actor":{"username":"reed","cleared":false,"url":"/reed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"ibb-data","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5989658,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-10-08T20:32:03.912Z","updated_at":"2019-10-08T20:32:03.912Z","actor":{"username":"reed","cleared":false,"url":"/reed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"ibb-data","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}