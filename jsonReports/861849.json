{"id":861849,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC84NjE4NDk=","url":"https://hackerone.com/reports/861849","title":"Idor on the DELETE /comments/","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2020-04-28T22:30:42.188Z","submitted_at":"2020-04-28T22:30:42.188Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"tandav","url":"/tandav","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/139/026/830527bfe114fed47518bd6da6b847a9ba998471_original.jpeg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":44956,"url":"https://hackerone.com/rghost","handle":"rghost","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/xTybduXFNu14khqtoGVurVEC/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/xTybduXFNu14khqtoGVurVEC/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"paused","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"RGhost","twitter_handle":null,"website":"https://rghost.net","about":null}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2020-05-13T17:17:24.324Z","bug_reporter_agreed_on_going_public_at":"2020-05-13T17:09:49.053Z","team_member_agreed_on_going_public_at":"2020-05-13T17:17:24.216Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"## Summary:\n[Idor on /comments]\n\n## Steps To Reproduce:\n[Make sure you have 2 different ID's to maintain 2 different session for ensurity]\n\n  1. The request can be tamper with the ID of different (comment) both the functions of edit/delete can be used\n  2. Delete gets hampered with the Captcha which is thrown but the Comment of different user can be observed in the request\n  3. Assume user 1\"victim\" made a comment \"comment X\" user 2 can edit the request for editing his comment \"Y\" to \"X\" further as the attacker failed editing the comment of victim, further disabling the edit option for user 1 :| that will make user 1\"victim\" left with only option to delete the comment. sed very sed\n  4. Even this works widely with Burp_Intruder that means it doesn't even have rate limit.\n\n## Impact\n\nAn attacker with a privilege to the user can harness the activities of any user around intentionally or target them widely.","vulnerability_information_html":"\u003ch2 id=\"summary\"\u003eSummary:\u003c/h2\u003e\n\n\u003cp\u003e[Idor on /comments]\u003c/p\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps To Reproduce:\u003c/h2\u003e\n\n\u003cp\u003e[Make sure you have 2 different ID\u0026#39;s to maintain 2 different session for ensurity]\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eThe request can be tamper with the ID of different (comment) both the functions of edit/delete can be used\u003c/li\u003e\n\u003cli\u003eDelete gets hampered with the Captcha which is thrown but the Comment of different user can be observed in the request\u003c/li\u003e\n\u003cli\u003eAssume user 1\u0026quot;victim\u0026quot; made a comment \u0026quot;comment X\u0026quot; user 2 can edit the request for editing his comment \u0026quot;Y\u0026quot; to \u0026quot;X\u0026quot; further as the attacker failed editing the comment of victim, further disabling the edit option for user 1 :| that will make user 1\u0026quot;victim\u0026quot; left with only option to delete the comment. sed very sed\u003c/li\u003e\n\u003cli\u003eEven this works widely with Burp_Intruder that means it doesn\u0026#39;t even have rate limit.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eAn attacker with a privilege to the user can harness the activities of any user around intentionally or target them widely.\u003c/p\u003e\n","weakness":{"id":55,"name":"Insecure Direct Object Reference (IDOR)"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":28,"voters":["mygf","noapearson","tandav","whereareyou","mase289","sunalil","analyticalspoon","wazzy","yashj97","dfoux","and 18 more..."],"severity":{"rating":"medium","author_type":"User"},"structured_scope":{"databaseId":39527,"asset_type":"URL","asset_identifier":"rghost.net","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":7836181,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hi, thanks for your report!\n\nI can confirm that 2) is a problem.\n\nCould you please elaborate on 3)?  I want to understand your points:\n\na) Are you able to actually save the content of the other user's comment?\nb) Are you saying that the victim can not edit the comment after that?","markdown_message":"\u003cp\u003eHi, thanks for your report!\u003c/p\u003e\n\n\u003cp\u003eI can confirm that 2) is a problem.\u003c/p\u003e\n\n\u003cp\u003eCould you please elaborate on 3)?  I want to understand your points:\u003c/p\u003e\n\n\u003cp\u003ea) Are you able to actually save the content of the other user\u0026#39;s comment?\u003cbr\u003e\nb) Are you saying that the victim can not edit the comment after that?\u003c/p\u003e\n","automated_response":false,"created_at":"2020-04-29T10:53:30.001Z","updated_at":"2020-04-29T10:53:30.001Z","actor":{"username":"lex_u7nbx","cleared":false,"url":"/lex_u7nbx","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"rghost","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7836649,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"In short yes you are correct with 2) it shouldn't be happening.\n\na) yes In point 3 the victim's comment can be seen with the altering in the request and I can grab as much as comments as they're integers in nature just by automating it.\nb) yes the yesterday it happened with one of my comment while I attacked my 2nd ID the comment id is in this URI \nhttps://rghost.net/comments/5969553 \"brought this up by burp history to give you a clearer explanation :D\" me being the user cannot edit it anymore because an attacker played worst with this. The only thing left now is to Delete the comment","markdown_message":"\u003cp\u003eIn short yes you are correct with 2) it shouldn\u0026#39;t be happening.\u003c/p\u003e\n\n\u003cp\u003ea) yes In point 3 the victim\u0026#39;s comment can be seen with the altering in the request and I can grab as much as comments as they\u0026#39;re integers in nature just by automating it.\u003cbr\u003e\nb) yes the yesterday it happened with one of my comment while I attacked my 2nd ID the comment id is in this URI \u003cbr\u003e\n\u003ca title=\"https://rghost.net/comments/5969553\" href=\"/redirect?url=https%3A%2F%2Frghost.net%2Fcomments%2F5969553\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://rghost.net/comments/5969553\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e \u0026quot;brought this up by burp history to give you a clearer explanation :D\u0026quot; me being the user cannot edit it anymore because an attacker played worst with this. The only thing left now is to Delete the comment\u003c/p\u003e\n","automated_response":false,"created_at":"2020-04-29T11:41:37.000Z","updated_at":"2020-04-29T11:41:37.000Z","actor":{"username":"tandav","cleared":false,"url":"/tandav","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/139/026/830527bfe114fed47518bd6da6b847a9ba998471_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"rghost","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7836785,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Following up on a)\n\nThe updated comment can be seen in the response, but I want to confirm that it actually gets updated on the server side. The way it works on the server side is that the comment content is not saved in the database, even though the attacker can see server response to update operation with attacker's content (it just indicates the error).\n\nHave you been able to actually save the comment / do you see updated comment on the page from victim's perspective?","markdown_message":"\u003cp\u003eFollowing up on a)\u003c/p\u003e\n\n\u003cp\u003eThe updated comment can be seen in the response, but I want to confirm that it actually gets updated on the server side. The way it works on the server side is that the comment content is not saved in the database, even though the attacker can see server response to update operation with attacker\u0026#39;s content (it just indicates the error).\u003c/p\u003e\n\n\u003cp\u003eHave you been able to actually save the comment / do you see updated comment on the page from victim\u0026#39;s perspective?\u003c/p\u003e\n","automated_response":false,"created_at":"2020-04-29T11:52:44.318Z","updated_at":"2020-04-29T11:52:44.318Z","actor":{"username":"lex_u7nbx","cleared":false,"url":"/lex_u7nbx","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"rghost","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7836897,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"a) In short. No, due to unknown reasons comment was not saved. The server response doesn't indicate an error at my side at least while saving it just loops up with the popup of edit/delete param with the captcha with it. \n\nNo, the comment was not saved with the victim/I do not see the updated comment with victim side.","markdown_message":"\u003cp\u003ea) In short. No, due to unknown reasons comment was not saved. The server response doesn\u0026#39;t indicate an error at my side at least while saving it just loops up with the popup of edit/delete param with the captcha with it. \u003c/p\u003e\n\n\u003cp\u003eNo, the comment was not saved with the victim/I do not see the updated comment with victim side.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-04-29T12:03:57.150Z","updated_at":"2020-04-29T12:03:57.150Z","actor":{"username":"tandav","cleared":false,"url":"/tandav","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/139/026/830527bfe114fed47518bd6da6b847a9ba998471_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"rghost","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7879611,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi, Lex Can we open it, please?","markdown_message":"\u003cp\u003eHi, Lex Can we open it, please?\u003c/p\u003e\n","automated_response":false,"created_at":"2020-05-03T15:40:04.846Z","updated_at":"2020-05-03T15:40:04.846Z","actor":{"username":"tandav","cleared":false,"url":"/tandav","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/139/026/830527bfe114fed47518bd6da6b847a9ba998471_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"rghost","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7892603,"is_internal":false,"editable":false,"type":"Activities::ExternalUserJoined","message":"","markdown_message":"","automated_response":false,"created_at":"2020-05-04T22:07:48.758Z","updated_at":"2020-05-04T22:07:48.758Z","additional_data":{"duplicate_report_id":865023},"actor":{"username":"zaidozaid","cleared":false,"url":"/zaidozaid","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"rghost","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7962177,"is_internal":false,"editable":false,"type":"Activities::ExternalUserJoined","message":"","markdown_message":"","automated_response":false,"created_at":"2020-05-11T12:41:45.957Z","updated_at":"2020-05-11T12:41:45.957Z","additional_data":{"duplicate_report_id":869545},"actor":{"username":"rio79","cleared":false,"url":"/rio79","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"rghost","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7962489,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"What's the take of the H1 on this? Could it be explained please.","markdown_message":"\u003cp\u003eWhat\u0026#39;s the take of the H1 on this? Could it be explained please.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-05-11T13:02:02.779Z","updated_at":"2020-05-11T13:02:02.779Z","actor":{"username":"tandav","cleared":false,"url":"/tandav","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/139/026/830527bfe114fed47518bd6da6b847a9ba998471_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"rghost","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7972970,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi and sorry for a long delay with reply.\n\nI have deployed a fix for this issue. Could you please check if it has been addressed properly?\n\nCheers!","markdown_message":"\u003cp\u003eHi and sorry for a long delay with reply.\u003c/p\u003e\n\n\u003cp\u003eI have deployed a fix for this issue. Could you please check if it has been addressed properly?\u003c/p\u003e\n\n\u003cp\u003eCheers!\u003c/p\u003e\n","automated_response":false,"created_at":"2020-05-12T09:42:38.542Z","updated_at":"2020-05-12T09:42:38.542Z","actor":{"username":"lex_u7nbx","cleared":false,"url":"/lex_u7nbx","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"rghost","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7991573,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Dear Lex_u7nbx the reflection of different comments while trying for IDOR is now patched. Will test again on your request.","markdown_message":"\u003cp\u003eDear Lex_u7nbx the reflection of different comments while trying for IDOR is now patched. Will test again on your request.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-05-13T17:01:47.544Z","updated_at":"2020-05-13T17:01:47.544Z","actor":{"username":"tandav","cleared":false,"url":"/tandav","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/139/026/830527bfe114fed47518bd6da6b847a9ba998471_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"rghost","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7991651,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Great, thank you!","markdown_message":"\u003cp\u003eGreat, thank you!\u003c/p\u003e\n","automated_response":false,"created_at":"2020-05-13T17:06:58.939Z","updated_at":"2020-05-13T17:06:58.939Z","actor":{"username":"lex_u7nbx","cleared":false,"url":"/lex_u7nbx","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"tandav","url":"/tandav"},"genius_execution_id":null,"team_handle":"rghost","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7991679,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-05-13T17:09:49.080Z","updated_at":"2020-05-13T17:09:49.080Z","first_to_agree":true,"actor":{"username":"tandav","cleared":false,"url":"/tandav","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/139/026/830527bfe114fed47518bd6da6b847a9ba998471_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"rghost","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7991752,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-05-13T17:17:24.245Z","updated_at":"2020-05-13T17:17:24.245Z","actor":{"username":"lex_u7nbx","cleared":false,"url":"/lex_u7nbx","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"rghost","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7991753,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-05-13T17:17:24.356Z","updated_at":"2020-05-13T17:17:24.356Z","actor":{"username":"lex_u7nbx","cleared":false,"url":"/lex_u7nbx","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"rghost","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"id":21723,"category":"researcher","content":"Here in the scenario, the attacker was able to abuse comment id of another user by manipulating the request, including delete function and edit. The interesting part was that the application was throwing the comment content after executing the request on the page itself.\nAs the comment ID's were in numbers the attacker used it with an intruder by their number range, further enumerating all the comments in every thread in the web application.","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eHere in the scenario, the attacker was able to abuse comment id of another user by manipulating the request, including delete function and edit. The interesting part was that the application was throwing the comment content after executing the request on the page itself.\u003cbr\u003e\nAs the comment ID\u0026#39;s were in numbers the attacker used it with an intruder by their number range, further enumerating all the comments in every thread in the web application.\u003c/p\u003e\n"}]}