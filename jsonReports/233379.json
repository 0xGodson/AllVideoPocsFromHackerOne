{"id":233379,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMzMzNzk=","url":"https://hackerone.com/reports/233379","title":"Attacker can trick other into logging in as themselves","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2017-05-30T20:23:22.648Z","submitted_at":"2017-05-30T20:23:22.648Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"fixit","url":"/fixit","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/056/390/cf403e97cd89a6ae9123b401d862963c6a8c6262_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":18483,"url":"https://hackerone.com/mixmax","handle":"mixmax","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/018/483/d40687c2b5a88f77509db9939536bfa150929851_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/018/483/d40687c2b5a88f77509db9939536bfa150929851_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"disabled","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Mixmax","twitter_handle":"","website":"https://mixmax.com","about":""}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-06-13T07:54:18.180Z","bug_reporter_agreed_on_going_public_at":"2017-06-13T07:54:18.113Z","team_member_agreed_on_going_public_at":"2017-06-13T00:02:32.673Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi Team,\n\nThis bug is similar to bug report https://hackerone.com/reports/2228 as this bug also allows a user to be logged in as the attacker. An attacker can escalate this to attach his account with the victims profile and monitor his activities.\n\nLogin CSRF is a type of attack where the attacker can force the user to log in to the attacker’s account on a website and thus reveal information about what the user is doing while logged in.\n\nAn attacker could exploit this bug as follows:\n1: Attacker initiates google OAuth process with mixmax.com\n2: Attacker allows access to mixmax app\n3: Attacker records and drops redirection to mixmax.com (in order not to consume token)\n4: Attacker directs victim to https://app.mixmax.com/_oauth/google/callback?state={state}\u0026code={ode}\n5: A white page see to victim and in backend, Victim is now logged in as attacker.\n\nTo mitigate this vulnerability,state parameter is solution for this but in this case state parameter is not getting validated on server side.\n\nLet me know if any additional info is needed.","vulnerability_information_html":"\u003cp\u003eHi Team,\u003c/p\u003e\n\n\u003cp\u003eThis bug is similar to bug report \u003ca title=\"https://hackerone.com/reports/2228\" href=\"https://hackerone.com/reports/2228\"\u003ehttps://hackerone.com/reports/2228\u003c/a\u003e as this bug also allows a user to be logged in as the attacker. An attacker can escalate this to attach his account with the victims profile and monitor his activities.\u003c/p\u003e\n\n\u003cp\u003eLogin CSRF is a type of attack where the attacker can force the user to log in to the attacker’s account on a website and thus reveal information about what the user is doing while logged in.\u003c/p\u003e\n\n\u003cp\u003eAn attacker could exploit this bug as follows:\u003cbr\u003e\n1: Attacker initiates google OAuth process with mixmax.com\u003cbr\u003e\n2: Attacker allows access to mixmax app\u003cbr\u003e\n3: Attacker records and drops redirection to mixmax.com (in order not to consume token)\u003cbr\u003e\n4: Attacker directs victim to \u003ca title=\"https://app.mixmax.com/_oauth/google/callback?state=%7Bstate%7D\u0026amp;code=%7Bode%7D\" href=\"/redirect?url=https%3A%2F%2Fapp.mixmax.com%2F_oauth%2Fgoogle%2Fcallback%3Fstate%3D%257Bstate%257D%26code%3D%257Bode%257D\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://app.mixmax.com/_oauth/google/callback?state=%7Bstate%7D\u0026amp;code=%7Bode%7D\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\n5: A white page see to victim and in backend, Victim is now logged in as attacker.\u003c/p\u003e\n\n\u003cp\u003eTo mitigate this vulnerability,state parameter is solution for this but in this case state parameter is not getting validated on server side.\u003c/p\u003e\n\n\u003cp\u003eLet me know if any additional info is needed.\u003c/p\u003e\n","original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2017-07-13T00:02:32.698Z","allow_singular_disclosure_after":-109314222.15372036,"singular_disclosure_allowed":true,"vote_count":2,"voters":["eveeez","japz"],"severity":{"rating":"medium","author_type":"Team"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1711362,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @fixit, thanks for the report. Can you provide a few more specifics:\n\n* what are the values of {state} and {code} in step 4? Which one(s) of them are from step 3?\n* What do you mean that the victim is now logged in as the attacker? What does the victim see/do after the blank page?","markdown_message":"\u003cp\u003eHi \u003ca href=\"/fixit\"\u003e@fixit\u003c/a\u003e, thanks for the report. Can you provide a few more specifics:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003ewhat are the values of {state} and {code} in step 4? Which one(s) of them are from step 3?\u003c/li\u003e\n\u003cli\u003eWhat do you mean that the victim is now logged in as the attacker? What does the victim see/do after the blank page?\u003c/li\u003e\n\u003c/ul\u003e\n","automated_response":false,"created_at":"2017-05-30T21:02:58.194Z","updated_at":"2017-05-30T21:05:20.481Z","actor":{"username":"mixmaxhq","cleared":false,"url":"/mixmaxhq","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"mixmax","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1711565,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"","markdown_message":"","automated_response":false,"created_at":"2017-05-30T22:07:07.311Z","updated_at":"2017-05-30T22:07:07.311Z","actor":{"username":"wearhere","cleared":false,"url":"/wearhere","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"mixmax","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1711703,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Hi,\n\nKindly follow the steps given in video to reproduce the issue and for the values of state and code.\nhttps://www.dropbox.com/s/cd5lbaobz905t8s/login%20csrf%20m.webm?dl=0\n\nWhen victim opens the URL he will be logged in form the attackers account. Security is as strong as its weakest point. The attacker might be interested in logging the user into his account. Let me describe exemplary scenarios:\n\nThe attacker logs the user into his account. The user thinks, that he uses his own account and perform actions like compose mail etc - now the attacker knows these details. There are many reasons why it would be profitable for the attacker (it depends on what the attacker wants to achieve).\n\nKindly let me know if any further information is needed.","markdown_message":"\u003cp\u003eHi,\u003c/p\u003e\n\n\u003cp\u003eKindly follow the steps given in video to reproduce the issue and for the values of state and code.\u003cbr\u003e\n\u003ca title=\"https://www.dropbox.com/s/cd5lbaobz905t8s/login%20csrf%20m.webm?dl=0\" href=\"/redirect?url=https%3A%2F%2Fwww.dropbox.com%2Fs%2Fcd5lbaobz905t8s%2Flogin%2520csrf%2520m.webm%3Fdl%3D0\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.dropbox.com/s/cd5lbaobz905t8s/login%20csrf%20m.webm?dl=0\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eWhen victim opens the URL he will be logged in form the attackers account. Security is as strong as its weakest point. The attacker might be interested in logging the user into his account. Let me describe exemplary scenarios:\u003c/p\u003e\n\n\u003cp\u003eThe attacker logs the user into his account. The user thinks, that he uses his own account and perform actions like compose mail etc - now the attacker knows these details. There are many reasons why it would be profitable for the attacker (it depends on what the attacker wants to achieve).\u003c/p\u003e\n\n\u003cp\u003eKindly let me know if any further information is needed.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-05-30T23:11:09.792Z","updated_at":"2017-05-30T23:11:56.292Z","actor":{"username":"fixit","cleared":true,"url":"/fixit","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/056/390/cf403e97cd89a6ae9123b401d862963c6a8c6262_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mixmax","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1711720,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2017-05-30T23:20:59.727Z","updated_at":"2017-05-30T23:20:59.727Z","additional_data":{"old_title":"Login CSRF using OAuth.","new_title":"Attacker can trick other into logging in as themselves"},"actor":{"username":"wearhere","cleared":false,"url":"/wearhere","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"mixmax","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1711737,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"The video clarifies everything, thanks! FYI we do validate the state parameter server-side by having state parameters expire within an hour but that might be enough time to get a victim to click on the link; we should also validate that the same browser began the flow as completed the flow.","markdown_message":"\u003cp\u003eThe video clarifies everything, thanks! FYI we do validate the state parameter server-side by having state parameters expire within an hour but that might be enough time to get a victim to click on the link; we should also validate that the same browser began the flow as completed the flow.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-05-30T23:29:01.572Z","updated_at":"2017-05-30T23:29:01.572Z","actor":{"username":"wearhere","cleared":false,"url":"/wearhere","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"mixmax","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1711741,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2017-05-30T23:29:36.939Z","updated_at":"2017-05-30T23:29:36.939Z","additional_data":{"old_severity":null,"new_severity":"Medium","old_severity_id":null,"new_severity_id":46040},"actor":{"username":"wearhere","cleared":false,"url":"/wearhere","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"mixmax","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1750812,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks again! We've fixed this by ensuring the same device completes the oauth flow as starts it.","markdown_message":"\u003cp\u003eThanks again! We\u0026#39;ve fixed this by ensuring the same device completes the oauth flow as starts it.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-06-12T21:26:14.852Z","updated_at":"2017-06-12T21:26:37.450Z","actor":{"username":"skeggse","cleared":false,"url":"/skeggse","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"fixit","url":"/fixit"},"genius_execution_id":null,"team_handle":"mixmax","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1751137,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-06-13T00:02:32.684Z","updated_at":"2017-06-13T00:02:32.684Z","first_to_agree":true,"actor":{"username":"wearhere","cleared":false,"url":"/wearhere","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"mixmax","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1751954,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"ok with Limited discloser.","markdown_message":"\u003cp\u003eok with Limited discloser.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-06-13T07:54:18.129Z","updated_at":"2017-06-13T07:54:18.129Z","actor":{"username":"fixit","cleared":true,"url":"/fixit","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/056/390/cf403e97cd89a6ae9123b401d862963c6a8c6262_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mixmax","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1751955,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-06-13T07:54:18.194Z","updated_at":"2017-06-13T07:54:18.194Z","actor":{"username":"fixit","cleared":true,"url":"/fixit","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/056/390/cf403e97cd89a6ae9123b401d862963c6a8c6262_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mixmax","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2864971,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"We took a pause on HackerOne for a while and have made substantial changes to our platform since then. As such, we're closing out bugs as `Informative` and will accept new bug reports that are in accordance with our new disclosure policy and bounty ladder. Thanks!","markdown_message":"\u003cp\u003eWe took a pause on HackerOne for a while and have made substantial changes to our platform since then. As such, we\u0026#39;re closing out bugs as \u003ccode\u003eInformative\u003c/code\u003e and will accept new bug reports that are in accordance with our new disclosure policy and bounty ladder. Thanks!\u003c/p\u003e\n","automated_response":false,"created_at":"2018-06-10T22:41:06.328Z","updated_at":"2018-06-10T22:41:06.328Z","actor":{"url":"/mixmax","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/018/483/d40687c2b5a88f77509db9939536bfa150929851_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Mixmax"}},"genius_execution_id":null,"team_handle":"mixmax","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}