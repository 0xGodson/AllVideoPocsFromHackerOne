{"id":244612,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yNDQ2MTI=","url":"https://hackerone.com/reports/244612","title":"Password reset links should expire after being used, instead of at specific time","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2017-06-30T03:08:35.234Z","submitted_at":"2017-06-30T03:08:35.234Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"silv3rpoision","url":"/silv3rpoision","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/178/089/e356a313dad691d6e677b53084df4387aae21eb4_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":21801,"url":"https://hackerone.com/wakatime","handle":"wakatime","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/021/801/c3af6aa265b9b7d7d6e5fd52bb768e43b06d4a44_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/021/801/c3af6aa265b9b7d7d6e5fd52bb768e43b06d4a44_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"WakaTime","twitter_handle":"wakatime","website":"https://wakatime.com","about":"Automated metrics about your programming from text editor plugins."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-07-23T16:37:40.454Z","bug_reporter_agreed_on_going_public_at":"2017-06-30T13:02:36.720Z","team_member_agreed_on_going_public_at":"2017-07-23T16:37:40.420Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi,\n\nHope you are good!\n\nSteps to repro:\n1) Create an account having any email address like \"a@x.com\".\n2) Now Logout and ask for password reset link. Don't use the password reset link sent to your mail address.\n3) Login using the same password back and update your email address to \"b@x.com\" and verify the same. Remove \"a@x.com\".\n4) Now logout and use the password reset link which was mailed to \"a@x.com\" in step 2.\n5) Password will be changed.\n\nFix:\n\nAll previous password reset links should automatically expire once a user changes his email address.\n\nSo below is the attack scenario:\n\n1) My email account is compromised. Attacker asks for password reset link for my account.\n2) I got to know, I change my email address on my account. I now assume i am safe.\n3) But the hacker can still use the old password reset links (which he had never used for single time) which were sent to my old email address.\n\n4) My account is now compromised again.\n\nPlease let me know if you need any other information and thanks again for looking into this.\n\nPlease fix this.\n\nBest Regards\nPiyush kumar","vulnerability_information_html":"\u003cp\u003eHi,\u003c/p\u003e\n\n\u003cp\u003eHope you are good!\u003c/p\u003e\n\n\u003cp\u003eSteps to repro:\u003cbr\u003e\n1) Create an account having any email address like \u0026quot;\u003ca title=\"a@x.com\" href=\"mailto:a@x.com\" rel=\"nofollow noopener noreferrer\"\u003ea@x.com\u003c/a\u003e\u0026quot;.\u003cbr\u003e\n2) Now Logout and ask for password reset link. Don\u0026#39;t use the password reset link sent to your mail address.\u003cbr\u003e\n3) Login using the same password back and update your email address to \u0026quot;\u003ca title=\"b@x.com\" href=\"mailto:b@x.com\" rel=\"nofollow noopener noreferrer\"\u003eb@x.com\u003c/a\u003e\u0026quot; and verify the same. Remove \u0026quot;\u003ca title=\"a@x.com\" href=\"mailto:a@x.com\" rel=\"nofollow noopener noreferrer\"\u003ea@x.com\u003c/a\u003e\u0026quot;.\u003cbr\u003e\n4) Now logout and use the password reset link which was mailed to \u0026quot;\u003ca title=\"a@x.com\" href=\"mailto:a@x.com\" rel=\"nofollow noopener noreferrer\"\u003ea@x.com\u003c/a\u003e\u0026quot; in step 2.\u003cbr\u003e\n5) Password will be changed.\u003c/p\u003e\n\n\u003cp\u003eFix:\u003c/p\u003e\n\n\u003cp\u003eAll previous password reset links should automatically expire once a user changes his email address.\u003c/p\u003e\n\n\u003cp\u003eSo below is the attack scenario:\u003c/p\u003e\n\n\u003cp\u003e1) My email account is compromised. Attacker asks for password reset link for my account.\u003cbr\u003e\n2) I got to know, I change my email address on my account. I now assume i am safe.\u003cbr\u003e\n3) But the hacker can still use the old password reset links (which he had never used for single time) which were sent to my old email address.\u003c/p\u003e\n\n\u003cp\u003e4) My account is now compromised again.\u003c/p\u003e\n\n\u003cp\u003ePlease let me know if you need any other information and thanks again for looking into this.\u003c/p\u003e\n\n\u003cp\u003ePlease fix this.\u003c/p\u003e\n\n\u003cp\u003eBest Regards\u003cbr\u003e\nPiyush kumar\u003c/p\u003e\n","weakness":{"id":27,"name":"Improper Authentication - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2017-07-30T13:02:36.794Z","allow_singular_disclosure_after":-107798812.92287207,"singular_disclosure_allowed":true,"vote_count":7,"voters":["eveeez","r3y","ronygigi","zerotoone","silv3rpoision","clarckowen_","b4gp4ck"],"severity":{"rating":"medium","author_type":"Team"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1793745,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks for the thorough report! It's fixed now by invalidating reset password links after changing email or password.","markdown_message":"\u003cp\u003eThanks for the thorough report! It\u0026#39;s fixed now by invalidating reset password links after changing email or password.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-06-30T10:03:03.367Z","updated_at":"2017-06-30T10:03:03.367Z","actor":{"username":"alanhamlett","cleared":false,"url":"/alanhamlett","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/175/849/7d4d213b7dc7d636a5abae089f1aa907e074bcdb_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"silv3rpoision","url":"/silv3rpoision"},"genius_execution_id":null,"team_handle":"wakatime","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1794078,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Can we??","markdown_message":"\u003cp\u003eCan we??\u003c/p\u003e\n","automated_response":false,"created_at":"2017-06-30T13:02:36.752Z","updated_at":"2017-06-30T13:02:36.752Z","first_to_agree":true,"actor":{"username":"silv3rpoision","cleared":false,"url":"/silv3rpoision","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/178/089/e356a313dad691d6e677b53084df4387aae21eb4_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"wakatime","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1794134,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for the response and the quick fix.\nAwesome Team","markdown_message":"\u003cp\u003eThanks for the response and the quick fix.\u003cbr\u003e\nAwesome Team\u003c/p\u003e\n","automated_response":false,"created_at":"2017-06-30T13:32:38.602Z","updated_at":"2017-06-30T13:32:38.602Z","actor":{"username":"silv3rpoision","cleared":false,"url":"/silv3rpoision","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/178/089/e356a313dad691d6e677b53084df4387aae21eb4_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"wakatime","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1811349,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2017-07-06T16:03:18.293Z","updated_at":"2017-07-06T16:03:18.293Z","additional_data":{"old_severity":"High","new_severity":"Medium","old_severity_id":54914,"new_severity_id":56490},"actor":{"username":"alanhamlett","cleared":false,"url":"/alanhamlett","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/175/849/7d4d213b7dc7d636a5abae089f1aa907e074bcdb_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"wakatime","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1811353,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2017-07-06T16:04:04.618Z","updated_at":"2017-07-06T16:04:04.618Z","additional_data":{"old_title":"Broken Authentication and Session Management leads to account takeover","new_title":"Password reset links should expire after being used"},"actor":{"username":"alanhamlett","cleared":false,"url":"/alanhamlett","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/175/849/7d4d213b7dc7d636a5abae089f1aa907e074bcdb_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"wakatime","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1811356,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2017-07-06T16:04:32.593Z","updated_at":"2017-07-06T16:04:32.593Z","additional_data":{"old_title":"Password reset links should expire after being used","new_title":"Password reset links should expire after being used, instead of at specific time"},"actor":{"username":"alanhamlett","cleared":false,"url":"/alanhamlett","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/175/849/7d4d213b7dc7d636a5abae089f1aa907e074bcdb_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"wakatime","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1811363,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2017-07-06T16:05:29.752Z","updated_at":"2017-07-06T16:05:29.752Z","additional_data":{"old_severity":"Medium","new_severity":"Low","old_severity_id":56490,"new_severity_id":56492},"actor":{"username":"alanhamlett","cleared":false,"url":"/alanhamlett","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/175/849/7d4d213b7dc7d636a5abae089f1aa907e074bcdb_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"wakatime","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1860901,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2017-07-23T16:37:34.573Z","updated_at":"2017-07-23T16:37:34.573Z","additional_data":{"old_severity":"Low","new_severity":"Medium","old_severity_id":56492,"new_severity_id":61569},"actor":{"username":"alanhamlett","cleared":false,"url":"/alanhamlett","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/175/849/7d4d213b7dc7d636a5abae089f1aa907e074bcdb_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"wakatime","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1860902,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-07-23T16:37:40.435Z","updated_at":"2017-07-23T16:37:40.435Z","actor":{"username":"alanhamlett","cleared":false,"url":"/alanhamlett","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/175/849/7d4d213b7dc7d636a5abae089f1aa907e074bcdb_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"wakatime","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1860903,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-07-23T16:37:40.487Z","updated_at":"2017-07-23T16:37:40.487Z","actor":{"username":"alanhamlett","cleared":false,"url":"/alanhamlett","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/175/849/7d4d213b7dc7d636a5abae089f1aa907e074bcdb_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"wakatime","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}