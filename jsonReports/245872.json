{"id":245872,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yNDU4NzI=","url":"https://hackerone.com/reports/245872","title":"[IDOR] The authenticated user can restart website build or view build logs on any another Federalist account","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2017-07-04T16:11:10.631Z","submitted_at":"2017-07-04T16:11:10.631Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"sp1d3rs","url":"/sp1d3rs","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/079/690/6853ada3e124bdd8616b1be752223b558de38195_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":21499,"url":"https://hackerone.com/tts","handle":"tts","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/021/499/a8abb6c9702d454ed2bcfa55bb077ac2e49988b9_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/021/499/a8abb6c9702d454ed2bcfa55bb077ac2e49988b9_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"TTS Bug Bounty","twitter_handle":"gsa_tts","website":"https://18f.gsa.gov","about":"The First Civilian Agency Public Bug Bounty Program"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2017-09-05T20:08:47.988Z","bug_reporter_agreed_on_going_public_at":"2017-08-26T11:09:18.326Z","team_member_agreed_on_going_public_at":"2017-09-05T20:08:47.935Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"##Description\nHi. I found an Insecure Direct Object Reference vulnerability on the `http://192.168.119.128:1337/v0/build/` endpoint.\n{F200108}\nWhen the user wants to restart the build, next request are sent to the endpoint:\n```\n{\"site\":\u003csiteid\u003e,\"branch\":\"master\"}\n```\nwhere siteid is numeric ID of the site.\nHowever, this endpoint does not check, do this site ID belongs to this user. So the any user can restart the build of the site on any other user account. So it can be classified as partial authentication bypass.\n\n##POC\nI restarted the build on my localhost inscance on behalf of another user:\n{F200109}\n\n##Steps to reproduce\n1. Login to the Federalist with your test account (we call it `user1`).\n2. Restart the build on one of the sites belongs to you.\n3. Catch the request to the \n```\nhttp://192.168.119.128:1337/v0/build/\n```\nand change `site` parameter to the siteID, which was created on some other account (we call it `user2`).\n4. Execute the request. It will be accepted.\n5. Login as `user2` and go to this site's builds. You will notice that build was restarted by another user.\n\n##Suggested fix\nIt looks like other endpoint (e.g. site settings modify) checks the site id correctly. The fix is add additional check too on this specific endpoint.\n","vulnerability_information_html":"\u003ch2 id=\"description\"\u003eDescription\u003c/h2\u003e\n\n\u003cp\u003eHi. I found an Insecure Direct Object Reference vulnerability on the \u003ccode\u003ehttp://192.168.119.128:1337/v0/build/\u003c/code\u003e endpoint.\u003cbr\u003e\n\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"vv.PNG\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/200/108/9ae26af74e44720b9eba34cf90066b9f3b51a13e/vv.PNG?response-content-disposition=attachment%3B%20filename%3D%22vv.PNG%22%3B%20filename%2A%3DUTF-8%27%27vv.PNG\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQUYGCYHJT%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T051019Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJj%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIAGSCCKi0CRpYJMt3KX5x%2BNM9j2K4mM4glLH6mZ%2B8ExKAiEAlsZG1%2FfIYq0ODDSxwLnZfWyc08bfINN86QAI3Hqr4MgqtAMIURABGgwwMTM2MTkyNzQ4NDkiDG9txF7r12Yekik2WSqRA6NC8vsgwir7JTQr5zVnxH1x6efNaMXQv0rW73VsI4xDf6Ldo8AdQq%2B7eYd4BvolwrfpyHLOFrZnF4wc7R9rEQKh%2FswFKL9GQ6Lp2ujYTvyC5dhdjS4Sq%2F%2BYvPk3joZ%2BEwcDqk%2B5AvxLFqoiv3Y3ts7f9HYBqcl%2Fu20T7ZA6XxU9V7asrN5LT6SJz4xOu7iZzuPeZs4%2BFaw8tgu5A3W6CYmUUmbBs9q%2FQ%2FCO3t50tS7Dm5k%2BKM04Ar1VaXlWDuLdZKMC%2FS80%2FwDwH66vWVAjLib7jCkgBWXGEa9VryBHJJUl3qrXQrTIED1gUKeOoKk3fYvvyyIMJs3ja%2BbbO56fim%2BodEtN1FBU6g%2BuddJ4Qz5521XYpzwatC5mjJs6D50zWyfJnn9Xf%2FrDe3EacAX3oOhEBj%2Fu9S%2B46jeCaMjfEHwW8T%2FFnFpu%2FZf3e1NchqIFhOkEcnGH%2FqNmQtJ54g5I6x8j4N2c70CE7tuCZI1qjgi%2BfUfSwopFGky44IARFjLnTewCnMtMfFUa7haJa9C%2BcuqvMJDfqf8FOusB7%2BAWx%2FH2B4H9I7hLf9GkPQtz9yMVcytbF7umUu9c2W6aIn%2FKCYsmcfqyPQD%2Fe6EdfKQiWwtKrHes32q91jeUCiYfrRJFByq7uDxHGN0MingOOUWy72n3fdpooUwYjRfpac06PpxBSGvwEeiL%2BJlq9wl2E%2FMxojMrovyONCSYEoBpeEbNgMNFb9rpTiIW%2BX8OzRH6ra3L9dgd9y8nuqoCkIGYzNActVtKbpERxbtmkIoGAgtSCCLLfHT65g2k6G9afrZJZC86IhNmvJrDSG%2BKELC3%2BeAfU64DhUDssT9Dd%2Bm2pU0nRk1s8PUjuQ%3D%3D\u0026amp;X-Amz-Signature=933488bd97a5e48881287b72a5e75bc7d2fec905295282294a74079e4a10a4f1\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/200/108/9ae26af74e44720b9eba34cf90066b9f3b51a13e/vv.PNG?response-content-disposition=attachment%3B%20filename%3D%22vv.PNG%22%3B%20filename%2A%3DUTF-8%27%27vv.PNG\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQUYGCYHJT%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T051019Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJj%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIAGSCCKi0CRpYJMt3KX5x%2BNM9j2K4mM4glLH6mZ%2B8ExKAiEAlsZG1%2FfIYq0ODDSxwLnZfWyc08bfINN86QAI3Hqr4MgqtAMIURABGgwwMTM2MTkyNzQ4NDkiDG9txF7r12Yekik2WSqRA6NC8vsgwir7JTQr5zVnxH1x6efNaMXQv0rW73VsI4xDf6Ldo8AdQq%2B7eYd4BvolwrfpyHLOFrZnF4wc7R9rEQKh%2FswFKL9GQ6Lp2ujYTvyC5dhdjS4Sq%2F%2BYvPk3joZ%2BEwcDqk%2B5AvxLFqoiv3Y3ts7f9HYBqcl%2Fu20T7ZA6XxU9V7asrN5LT6SJz4xOu7iZzuPeZs4%2BFaw8tgu5A3W6CYmUUmbBs9q%2FQ%2FCO3t50tS7Dm5k%2BKM04Ar1VaXlWDuLdZKMC%2FS80%2FwDwH66vWVAjLib7jCkgBWXGEa9VryBHJJUl3qrXQrTIED1gUKeOoKk3fYvvyyIMJs3ja%2BbbO56fim%2BodEtN1FBU6g%2BuddJ4Qz5521XYpzwatC5mjJs6D50zWyfJnn9Xf%2FrDe3EacAX3oOhEBj%2Fu9S%2B46jeCaMjfEHwW8T%2FFnFpu%2FZf3e1NchqIFhOkEcnGH%2FqNmQtJ54g5I6x8j4N2c70CE7tuCZI1qjgi%2BfUfSwopFGky44IARFjLnTewCnMtMfFUa7haJa9C%2BcuqvMJDfqf8FOusB7%2BAWx%2FH2B4H9I7hLf9GkPQtz9yMVcytbF7umUu9c2W6aIn%2FKCYsmcfqyPQD%2Fe6EdfKQiWwtKrHes32q91jeUCiYfrRJFByq7uDxHGN0MingOOUWy72n3fdpooUwYjRfpac06PpxBSGvwEeiL%2BJlq9wl2E%2FMxojMrovyONCSYEoBpeEbNgMNFb9rpTiIW%2BX8OzRH6ra3L9dgd9y8nuqoCkIGYzNActVtKbpERxbtmkIoGAgtSCCLLfHT65g2k6G9afrZJZC86IhNmvJrDSG%2BKELC3%2BeAfU64DhUDssT9Dd%2Bm2pU0nRk1s8PUjuQ%3D%3D\u0026amp;X-Amz-Signature=933488bd97a5e48881287b72a5e75bc7d2fec905295282294a74079e4a10a4f1\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003cbr\u003e\nWhen the user wants to restart the build, next request are sent to the endpoint:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e{\u0026quot;site\u0026quot;:\u0026lt;siteid\u0026gt;,\u0026quot;branch\u0026quot;:\u0026quot;master\u0026quot;}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003ewhere siteid is numeric ID of the site.\u003cbr\u003e\nHowever, this endpoint does not check, do this site ID belongs to this user. So the any user can restart the build of the site on any other user account. So it can be classified as partial authentication bypass.\u003c/p\u003e\n\n\u003ch2 id=\"poc\"\u003ePOC\u003c/h2\u003e\n\n\u003cp\u003eI restarted the build on my localhost inscance on behalf of another user:\u003cbr\u003e\n\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"x.PNG\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/200/109/7980b5381ddc5b6d82c218d6d8ff78b5598cdaec/x.PNG?response-content-disposition=attachment%3B%20filename%3D%22x.PNG%22%3B%20filename%2A%3DUTF-8%27%27x.PNG\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQUYGCYHJT%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T051019Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJj%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIAGSCCKi0CRpYJMt3KX5x%2BNM9j2K4mM4glLH6mZ%2B8ExKAiEAlsZG1%2FfIYq0ODDSxwLnZfWyc08bfINN86QAI3Hqr4MgqtAMIURABGgwwMTM2MTkyNzQ4NDkiDG9txF7r12Yekik2WSqRA6NC8vsgwir7JTQr5zVnxH1x6efNaMXQv0rW73VsI4xDf6Ldo8AdQq%2B7eYd4BvolwrfpyHLOFrZnF4wc7R9rEQKh%2FswFKL9GQ6Lp2ujYTvyC5dhdjS4Sq%2F%2BYvPk3joZ%2BEwcDqk%2B5AvxLFqoiv3Y3ts7f9HYBqcl%2Fu20T7ZA6XxU9V7asrN5LT6SJz4xOu7iZzuPeZs4%2BFaw8tgu5A3W6CYmUUmbBs9q%2FQ%2FCO3t50tS7Dm5k%2BKM04Ar1VaXlWDuLdZKMC%2FS80%2FwDwH66vWVAjLib7jCkgBWXGEa9VryBHJJUl3qrXQrTIED1gUKeOoKk3fYvvyyIMJs3ja%2BbbO56fim%2BodEtN1FBU6g%2BuddJ4Qz5521XYpzwatC5mjJs6D50zWyfJnn9Xf%2FrDe3EacAX3oOhEBj%2Fu9S%2B46jeCaMjfEHwW8T%2FFnFpu%2FZf3e1NchqIFhOkEcnGH%2FqNmQtJ54g5I6x8j4N2c70CE7tuCZI1qjgi%2BfUfSwopFGky44IARFjLnTewCnMtMfFUa7haJa9C%2BcuqvMJDfqf8FOusB7%2BAWx%2FH2B4H9I7hLf9GkPQtz9yMVcytbF7umUu9c2W6aIn%2FKCYsmcfqyPQD%2Fe6EdfKQiWwtKrHes32q91jeUCiYfrRJFByq7uDxHGN0MingOOUWy72n3fdpooUwYjRfpac06PpxBSGvwEeiL%2BJlq9wl2E%2FMxojMrovyONCSYEoBpeEbNgMNFb9rpTiIW%2BX8OzRH6ra3L9dgd9y8nuqoCkIGYzNActVtKbpERxbtmkIoGAgtSCCLLfHT65g2k6G9afrZJZC86IhNmvJrDSG%2BKELC3%2BeAfU64DhUDssT9Dd%2Bm2pU0nRk1s8PUjuQ%3D%3D\u0026amp;X-Amz-Signature=d9299d1cf997be6c4e07f3396d10f427efd8cdaa148921b17a602ebdde20c243\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/200/109/7980b5381ddc5b6d82c218d6d8ff78b5598cdaec/x.PNG?response-content-disposition=attachment%3B%20filename%3D%22x.PNG%22%3B%20filename%2A%3DUTF-8%27%27x.PNG\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQUYGCYHJT%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T051019Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJj%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIAGSCCKi0CRpYJMt3KX5x%2BNM9j2K4mM4glLH6mZ%2B8ExKAiEAlsZG1%2FfIYq0ODDSxwLnZfWyc08bfINN86QAI3Hqr4MgqtAMIURABGgwwMTM2MTkyNzQ4NDkiDG9txF7r12Yekik2WSqRA6NC8vsgwir7JTQr5zVnxH1x6efNaMXQv0rW73VsI4xDf6Ldo8AdQq%2B7eYd4BvolwrfpyHLOFrZnF4wc7R9rEQKh%2FswFKL9GQ6Lp2ujYTvyC5dhdjS4Sq%2F%2BYvPk3joZ%2BEwcDqk%2B5AvxLFqoiv3Y3ts7f9HYBqcl%2Fu20T7ZA6XxU9V7asrN5LT6SJz4xOu7iZzuPeZs4%2BFaw8tgu5A3W6CYmUUmbBs9q%2FQ%2FCO3t50tS7Dm5k%2BKM04Ar1VaXlWDuLdZKMC%2FS80%2FwDwH66vWVAjLib7jCkgBWXGEa9VryBHJJUl3qrXQrTIED1gUKeOoKk3fYvvyyIMJs3ja%2BbbO56fim%2BodEtN1FBU6g%2BuddJ4Qz5521XYpzwatC5mjJs6D50zWyfJnn9Xf%2FrDe3EacAX3oOhEBj%2Fu9S%2B46jeCaMjfEHwW8T%2FFnFpu%2FZf3e1NchqIFhOkEcnGH%2FqNmQtJ54g5I6x8j4N2c70CE7tuCZI1qjgi%2BfUfSwopFGky44IARFjLnTewCnMtMfFUa7haJa9C%2BcuqvMJDfqf8FOusB7%2BAWx%2FH2B4H9I7hLf9GkPQtz9yMVcytbF7umUu9c2W6aIn%2FKCYsmcfqyPQD%2Fe6EdfKQiWwtKrHes32q91jeUCiYfrRJFByq7uDxHGN0MingOOUWy72n3fdpooUwYjRfpac06PpxBSGvwEeiL%2BJlq9wl2E%2FMxojMrovyONCSYEoBpeEbNgMNFb9rpTiIW%2BX8OzRH6ra3L9dgd9y8nuqoCkIGYzNActVtKbpERxbtmkIoGAgtSCCLLfHT65g2k6G9afrZJZC86IhNmvJrDSG%2BKELC3%2BeAfU64DhUDssT9Dd%2Bm2pU0nRk1s8PUjuQ%3D%3D\u0026amp;X-Amz-Signature=d9299d1cf997be6c4e07f3396d10f427efd8cdaa148921b17a602ebdde20c243\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps to reproduce\u003c/h2\u003e\n\n\u003col\u003e\n\u003cli\u003eLogin to the Federalist with your test account (we call it \u003ccode\u003euser1\u003c/code\u003e).\u003c/li\u003e\n\u003cli\u003eRestart the build on one of the sites belongs to you.\u003c/li\u003e\n\u003cli\u003eCatch the request to the \n\u003ccode\u003e\nhttp://192.168.119.128:1337/v0/build/\n\u003c/code\u003e\nand change \u003ccode\u003esite\u003c/code\u003e parameter to the siteID, which was created on some other account (we call it \u003ccode\u003euser2\u003c/code\u003e).\u003c/li\u003e\n\u003cli\u003eExecute the request. It will be accepted.\u003c/li\u003e\n\u003cli\u003eLogin as \u003ccode\u003euser2\u003c/code\u003e and go to this site\u0026#39;s builds. You will notice that build was restarted by another user.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003ch2 id=\"suggested-fix\"\u003eSuggested fix\u003c/h2\u003e\n\n\u003cp\u003eIt looks like other endpoint (e.g. site settings modify) checks the site id correctly. The fix is add additional check too on this specific endpoint.\u003c/p\u003e\n","bounty_amount":"350.0","formatted_bounty":"$350","weakness":{"id":55,"name":"Insecure Direct Object Reference (IDOR)"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":200108,"file_name":"vv.PNG","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/200/108/9ae26af74e44720b9eba34cf90066b9f3b51a13e/vv.PNG?response-content-disposition=attachment%3B%20filename%3D%22vv.PNG%22%3B%20filename%2A%3DUTF-8%27%27vv.PNG\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQUYGCYHJT%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T051019Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJj%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIAGSCCKi0CRpYJMt3KX5x%2BNM9j2K4mM4glLH6mZ%2B8ExKAiEAlsZG1%2FfIYq0ODDSxwLnZfWyc08bfINN86QAI3Hqr4MgqtAMIURABGgwwMTM2MTkyNzQ4NDkiDG9txF7r12Yekik2WSqRA6NC8vsgwir7JTQr5zVnxH1x6efNaMXQv0rW73VsI4xDf6Ldo8AdQq%2B7eYd4BvolwrfpyHLOFrZnF4wc7R9rEQKh%2FswFKL9GQ6Lp2ujYTvyC5dhdjS4Sq%2F%2BYvPk3joZ%2BEwcDqk%2B5AvxLFqoiv3Y3ts7f9HYBqcl%2Fu20T7ZA6XxU9V7asrN5LT6SJz4xOu7iZzuPeZs4%2BFaw8tgu5A3W6CYmUUmbBs9q%2FQ%2FCO3t50tS7Dm5k%2BKM04Ar1VaXlWDuLdZKMC%2FS80%2FwDwH66vWVAjLib7jCkgBWXGEa9VryBHJJUl3qrXQrTIED1gUKeOoKk3fYvvyyIMJs3ja%2BbbO56fim%2BodEtN1FBU6g%2BuddJ4Qz5521XYpzwatC5mjJs6D50zWyfJnn9Xf%2FrDe3EacAX3oOhEBj%2Fu9S%2B46jeCaMjfEHwW8T%2FFnFpu%2FZf3e1NchqIFhOkEcnGH%2FqNmQtJ54g5I6x8j4N2c70CE7tuCZI1qjgi%2BfUfSwopFGky44IARFjLnTewCnMtMfFUa7haJa9C%2BcuqvMJDfqf8FOusB7%2BAWx%2FH2B4H9I7hLf9GkPQtz9yMVcytbF7umUu9c2W6aIn%2FKCYsmcfqyPQD%2Fe6EdfKQiWwtKrHes32q91jeUCiYfrRJFByq7uDxHGN0MingOOUWy72n3fdpooUwYjRfpac06PpxBSGvwEeiL%2BJlq9wl2E%2FMxojMrovyONCSYEoBpeEbNgMNFb9rpTiIW%2BX8OzRH6ra3L9dgd9y8nuqoCkIGYzNActVtKbpERxbtmkIoGAgtSCCLLfHT65g2k6G9afrZJZC86IhNmvJrDSG%2BKELC3%2BeAfU64DhUDssT9Dd%2Bm2pU0nRk1s8PUjuQ%3D%3D\u0026X-Amz-Signature=933488bd97a5e48881287b72a5e75bc7d2fec905295282294a74079e4a10a4f1","file_size":6343,"type":"image/png"},{"id":200109,"file_name":"x.PNG","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/200/109/7980b5381ddc5b6d82c218d6d8ff78b5598cdaec/x.PNG?response-content-disposition=attachment%3B%20filename%3D%22x.PNG%22%3B%20filename%2A%3DUTF-8%27%27x.PNG\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQUYGCYHJT%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T051019Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJj%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIAGSCCKi0CRpYJMt3KX5x%2BNM9j2K4mM4glLH6mZ%2B8ExKAiEAlsZG1%2FfIYq0ODDSxwLnZfWyc08bfINN86QAI3Hqr4MgqtAMIURABGgwwMTM2MTkyNzQ4NDkiDG9txF7r12Yekik2WSqRA6NC8vsgwir7JTQr5zVnxH1x6efNaMXQv0rW73VsI4xDf6Ldo8AdQq%2B7eYd4BvolwrfpyHLOFrZnF4wc7R9rEQKh%2FswFKL9GQ6Lp2ujYTvyC5dhdjS4Sq%2F%2BYvPk3joZ%2BEwcDqk%2B5AvxLFqoiv3Y3ts7f9HYBqcl%2Fu20T7ZA6XxU9V7asrN5LT6SJz4xOu7iZzuPeZs4%2BFaw8tgu5A3W6CYmUUmbBs9q%2FQ%2FCO3t50tS7Dm5k%2BKM04Ar1VaXlWDuLdZKMC%2FS80%2FwDwH66vWVAjLib7jCkgBWXGEa9VryBHJJUl3qrXQrTIED1gUKeOoKk3fYvvyyIMJs3ja%2BbbO56fim%2BodEtN1FBU6g%2BuddJ4Qz5521XYpzwatC5mjJs6D50zWyfJnn9Xf%2FrDe3EacAX3oOhEBj%2Fu9S%2B46jeCaMjfEHwW8T%2FFnFpu%2FZf3e1NchqIFhOkEcnGH%2FqNmQtJ54g5I6x8j4N2c70CE7tuCZI1qjgi%2BfUfSwopFGky44IARFjLnTewCnMtMfFUa7haJa9C%2BcuqvMJDfqf8FOusB7%2BAWx%2FH2B4H9I7hLf9GkPQtz9yMVcytbF7umUu9c2W6aIn%2FKCYsmcfqyPQD%2Fe6EdfKQiWwtKrHes32q91jeUCiYfrRJFByq7uDxHGN0MingOOUWy72n3fdpooUwYjRfpac06PpxBSGvwEeiL%2BJlq9wl2E%2FMxojMrovyONCSYEoBpeEbNgMNFb9rpTiIW%2BX8OzRH6ra3L9dgd9y8nuqoCkIGYzNActVtKbpERxbtmkIoGAgtSCCLLfHT65g2k6G9afrZJZC86IhNmvJrDSG%2BKELC3%2BeAfU64DhUDssT9Dd%2Bm2pU0nRk1s8PUjuQ%3D%3D\u0026X-Amz-Signature=d9299d1cf997be6c4e07f3396d10f427efd8cdaa148921b17a602ebdde20c243","file_size":33067,"type":"image/png"}],"allow_singular_disclosure_at":"2017-09-25T11:09:18.400Z","allow_singular_disclosure_after":-102880860.97859414,"singular_disclosure_allowed":true,"vote_count":17,"voters":["spam404","cuso4","edoverflow","michan","eveeez","r3y","test_universe","mr_r3boot","shepard","whitesector","and 7 more..."],"severity":{"rating":"medium","author_type":"User"},"structured_scope":{"databaseId":978,"asset_type":"SOURCE_CODE","asset_identifier":"https://github.com/18F/federalist","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1802294,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Same issue on the `http://192.168.119.128:1337/v0/build/\u003csiteid\u003e/log` endpoint - the authenticated user can view build logs on any site from any other account.","markdown_message":"\u003cp\u003eSame issue on the \u003ccode\u003ehttp://192.168.119.128:1337/v0/build/\u0026lt;siteid\u0026gt;/log\u003c/code\u003e endpoint - the authenticated user can view build logs on any site from any other account.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-07-04T16:12:29.320Z","updated_at":"2017-07-04T16:13:12.530Z","actor":{"username":"sp1d3rs","cleared":true,"url":"/sp1d3rs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/079/690/6853ada3e124bdd8616b1be752223b558de38195_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1802309,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"`192.168.119.128` - it is my localhost instance, i forgot to clarify this in the report.\n\nP.S. if described behavior is \"by design\" - let me know please, i'll close the ticket.","markdown_message":"\u003cp\u003e\u003ccode\u003e192.168.119.128\u003c/code\u003e - it is my localhost instance, i forgot to clarify this in the report.\u003c/p\u003e\n\n\u003cp\u003eP.S. if described behavior is \u0026quot;by design\u0026quot; - let me know please, i\u0026#39;ll close the ticket.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-07-04T16:17:00.771Z","updated_at":"2017-07-04T16:19:24.781Z","actor":{"username":"sp1d3rs","cleared":true,"url":"/sp1d3rs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/079/690/6853ada3e124bdd8616b1be752223b558de38195_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1802318,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2017-07-04T16:19:46.241Z","updated_at":"2017-07-04T16:19:46.241Z","additional_data":{"old_title":"[IDOR] The privileged user can restart website build on any another Federalist account","new_title":"[IDOR] The privileged user can restart website build or viev build logs on any another Federalist account"},"actor":{"username":"sp1d3rs","cleared":true,"url":"/sp1d3rs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/079/690/6853ada3e124bdd8616b1be752223b558de38195_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1802319,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2017-07-04T16:19:52.307Z","updated_at":"2017-07-04T16:19:52.307Z","additional_data":{"old_title":"[IDOR] The privileged user can restart website build or viev build logs on any another Federalist account","new_title":"[IDOR] The privileged user can restart website build or view build logs on any another Federalist account"},"actor":{"username":"sp1d3rs","cleared":true,"url":"/sp1d3rs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/079/690/6853ada3e124bdd8616b1be752223b558de38195_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1802321,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2017-07-04T16:20:01.355Z","updated_at":"2017-07-04T16:20:01.355Z","additional_data":{"old_title":"[IDOR] The privileged user can restart website build or view build logs on any another Federalist account","new_title":"[IDOR] The authenticated user can restart website build or view build logs on any another Federalist account"},"actor":{"username":"sp1d3rs","cleared":true,"url":"/sp1d3rs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/079/690/6853ada3e124bdd8616b1be752223b558de38195_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1808329,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Filed as https://github.com/18F/federalist/issues/1054","markdown_message":"\u003cp\u003eFiled as \u003ca title=\"https://github.com/18F/federalist/issues/1054\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2F18F%2Ffederalist%2Fissues%2F1054\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/18F/federalist/issues/1054\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2017-07-05T18:02:02.541Z","updated_at":"2017-07-05T18:02:02.541Z","actor":{"username":"jseppi","cleared":false,"url":"/jseppi","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/177/387/972024bbd271356385d763e52932ebf4b887dea6_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1809325,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hi @sp1d3rs, \n\nWe have validated the vulnerability and have opened an issue in Github for a fix to be in place. Moving this to `Triaged` now. \n\nThank you for the reports. Keep them coming! ","markdown_message":"\u003cp\u003eHi \u003ca href=\"/sp1d3rs\"\u003e@sp1d3rs\u003c/a\u003e, \u003c/p\u003e\n\n\u003cp\u003eWe have validated the vulnerability and have opened an issue in Github for a fix to be in place. Moving this to \u003ccode\u003eTriaged\u003c/code\u003e now. \u003c/p\u003e\n\n\u003cp\u003eThank you for the reports. Keep them coming! \u003c/p\u003e\n","automated_response":false,"created_at":"2017-07-05T23:07:02.713Z","updated_at":"2017-07-05T23:07:02.713Z","actor":{"username":"rockyrobot","cleared":false,"url":"/rockyrobot","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/112/256/061431018bdae2144e25297602c95722e8f2beed_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1813352,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Hi @sp1d3rs, Congratulations!\n\nYour bug was marked \"Triaged\" and is on the queue for a fix to be merged. This falls under Medium severity based on our bounty table so we have decided to pay $350 for this. Thank you for the report once again! We would love to see more reports from you in the future!\n\nCheers! Happy Hacking!","markdown_message":"\u003cp\u003eHi \u003ca href=\"/sp1d3rs\"\u003e@sp1d3rs\u003c/a\u003e, Congratulations!\u003c/p\u003e\n\n\u003cp\u003eYour bug was marked \u0026quot;Triaged\u0026quot; and is on the queue for a fix to be merged. This falls under Medium severity based on our bounty table so we have decided to pay $350 for this. Thank you for the report once again! We would love to see more reports from you in the future!\u003c/p\u003e\n\n\u003cp\u003eCheers! Happy Hacking!\u003c/p\u003e\n","automated_response":false,"created_at":"2017-07-07T05:42:57.145Z","updated_at":"2017-07-07T05:42:57.145Z","actor":{"url":"/tts","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/021/499/a8abb6c9702d454ed2bcfa55bb077ac2e49988b9_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"TTS Bug Bounty"}},"bounty_amount":"350.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"tts","collaborator":{"username":"sp1d3rs","url":"/sp1d3rs"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1814090,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Fixed in PR https://github.com/18F/federalist/pull/1061\nWill be rolled out to next production deploy.","markdown_message":"\u003cp\u003eFixed in PR \u003ca title=\"https://github.com/18F/federalist/pull/1061\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2F18F%2Ffederalist%2Fpull%2F1061\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/18F/federalist/pull/1061\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nWill be rolled out to next production deploy.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-07-07T13:06:53.506Z","updated_at":"2017-07-07T13:06:53.506Z","actor":{"username":"jseppi","cleared":false,"url":"/jseppi","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/177/387/972024bbd271356385d763e52932ebf4b887dea6_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1814502,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I updated my Federalist instance, and confirmed the fix. Very great and fast work!","markdown_message":"\u003cp\u003eI updated my Federalist instance, and confirmed the fix. Very great and fast work!\u003c/p\u003e\n","automated_response":false,"created_at":"2017-07-07T15:11:59.258Z","updated_at":"2017-07-07T15:12:13.624Z","actor":{"username":"sp1d3rs","cleared":true,"url":"/sp1d3rs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/079/690/6853ada3e124bdd8616b1be752223b558de38195_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1815550,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hi @sp1d3rs, \nCongrats! The bug you reported has been fixed in both the codebase and the production. That said, I am closing this report as `Resolved`. \nThank you for the report. We look forward to more reports from you in the future! ","markdown_message":"\u003cp\u003eHi \u003ca href=\"/sp1d3rs\"\u003e@sp1d3rs\u003c/a\u003e, \u003cbr\u003e\nCongrats! The bug you reported has been fixed in both the codebase and the production. That said, I am closing this report as \u003ccode\u003eResolved\u003c/code\u003e. \u003cbr\u003e\nThank you for the report. We look forward to more reports from you in the future! \u003c/p\u003e\n","automated_response":false,"created_at":"2017-07-07T20:15:10.701Z","updated_at":"2017-07-07T20:15:10.701Z","actor":{"username":"rockyrobot","cleared":false,"url":"/rockyrobot","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/112/256/061431018bdae2144e25297602c95722e8f2beed_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"sp1d3rs","url":"/sp1d3rs"},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1956123,"is_internal":false,"editable":false,"type":"Activities::ReassignedToTeam","message":"","markdown_message":"","automated_response":false,"created_at":"2017-08-25T22:35:39.431Z","updated_at":"2017-08-25T22:35:39.431Z","additional_data":{"old_team":"TTS Private Bug Bounty","new_team":"TTS Bug Bounty"},"actor":{"username":"arice","cleared":false,"url":"/arice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/83152cb2d070f3f6a63c1b61bae47257722b5ad2_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1956761,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Since the program moved to the public, can we disclose it?","markdown_message":"\u003cp\u003eSince the program moved to the public, can we disclose it?\u003c/p\u003e\n","automated_response":false,"created_at":"2017-08-26T11:09:18.359Z","updated_at":"2017-08-26T11:09:18.359Z","first_to_agree":true,"actor":{"username":"sp1d3rs","cleared":true,"url":"/sp1d3rs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/079/690/6853ada3e124bdd8616b1be752223b558de38195_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1958329,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @sp1d3rs,\n\nGood question! We don't yet have a finalized disclosure policy. Is it ok if we finalize that before further action? (If there is a reason to be more urgent, please let me know. I want to be deliberate and methodical about how we roll this out).","markdown_message":"\u003cp\u003eHi \u003ca href=\"/sp1d3rs\"\u003e@sp1d3rs\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eGood question! We don\u0026#39;t yet have a finalized disclosure policy. Is it ok if we finalize that before further action? (If there is a reason to be more urgent, please let me know. I want to be deliberate and methodical about how we roll this out).\u003c/p\u003e\n","automated_response":false,"created_at":"2017-08-27T17:42:22.522Z","updated_at":"2017-08-27T17:42:22.522Z","actor":{"username":"wslack","cleared":false,"url":"/wslack","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/177/495/0f325c9db6586788cf1fd586777192815ef1d496_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1958367,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @wslack, sure, it looks fine for me.","markdown_message":"\u003cp\u003eHi \u003ca href=\"/wslack\"\u003e@wslack\u003c/a\u003e, sure, it looks fine for me.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-08-27T18:30:50.645Z","updated_at":"2017-08-27T18:31:33.456Z","actor":{"username":"sp1d3rs","cleared":true,"url":"/sp1d3rs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/079/690/6853ada3e124bdd8616b1be752223b558de38195_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1975422,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@sp1d3rs Ok! We've now published an update to our disclosure policy on coordinated disclosure: https://github.com/18F/vulnerability-disclosure-policy/blob/master/vulnerability-disclosure-policy.md\n\nI believe there is nothing worth redacting in this report; please give me a day or two to confirm that with colleagues, and then we will disclose!","markdown_message":"\u003cp\u003e\u003ca href=\"/sp1d3rs\"\u003e@sp1d3rs\u003c/a\u003e Ok! We\u0026#39;ve now published an update to our disclosure policy on coordinated disclosure: \u003ca title=\"https://github.com/18F/vulnerability-disclosure-policy/blob/master/vulnerability-disclosure-policy.md\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2F18F%2Fvulnerability-disclosure-policy%2Fblob%2Fmaster%2Fvulnerability-disclosure-policy.md\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/18F/vulnerability-disclosure-policy/blob/master/vulnerability-disclosure-policy.md\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eI believe there is nothing worth redacting in this report; please give me a day or two to confirm that with colleagues, and then we will disclose!\u003c/p\u003e\n","automated_response":false,"created_at":"2017-09-04T17:17:02.094Z","updated_at":"2017-09-04T17:17:40.532Z","actor":{"username":"wslack","cleared":false,"url":"/wslack","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/177/495/0f325c9db6586788cf1fd586777192815ef1d496_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1975455,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @wslack, it's a great news!\n\nI noticed that i disclosed some usernames on the POC screenshost, which i'm using on other sites. So i wrote the report Summary above, where screenshots were removed, and also some grammar mistakes corrected. \n\nIf you mind, we can disclose this particular report with Limited Visibility (the Summaries of the report will be visible only, but not the report content - i included all details of the issue in Summary, so it should be not much different from full disclosure). You can also add your summary too.\n","markdown_message":"\u003cp\u003eHi \u003ca href=\"/wslack\"\u003e@wslack\u003c/a\u003e, it\u0026#39;s a great news!\u003c/p\u003e\n\n\u003cp\u003eI noticed that i disclosed some usernames on the POC screenshost, which i\u0026#39;m using on other sites. So i wrote the report Summary above, where screenshots were removed, and also some grammar mistakes corrected. \u003c/p\u003e\n\n\u003cp\u003eIf you mind, we can disclose this particular report with Limited Visibility (the Summaries of the report will be visible only, but not the report content - i included all details of the issue in Summary, so it should be not much different from full disclosure). You can also add your summary too.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-09-04T17:40:56.049Z","updated_at":"2017-09-04T17:55:49.768Z","actor":{"username":"sp1d3rs","cleared":true,"url":"/sp1d3rs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/079/690/6853ada3e124bdd8616b1be752223b558de38195_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1978182,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-09-05T20:08:47.961Z","updated_at":"2017-09-05T20:08:47.961Z","actor":{"username":"wslack","cleared":false,"url":"/wslack","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/177/495/0f325c9db6586788cf1fd586777192815ef1d496_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1978183,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-09-05T20:08:48.021Z","updated_at":"2017-09-05T20:08:48.021Z","actor":{"username":"wslack","cleared":false,"url":"/wslack","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/177/495/0f325c9db6586788cf1fd586777192815ef1d496_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":5271,"category":"team","content":"We endorse sp1d3rs's summary! The PR fixing this ticket is here: https://github.com/18F/federalist/pull/1061","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eWe endorse sp1d3rs\u0026#39;s summary! The PR fixing this ticket is here: \u003ca title=\"https://github.com/18F/federalist/pull/1061\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2F18F%2Ffederalist%2Fpull%2F1061\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/18F/federalist/pull/1061\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n"},{"id":5254,"category":"researcher","content":"*Thanks to the 18F team for the great experience, fast fix, and the bounty!*\n*The report details (i requested the limited disclosure due to sensitive info in the attachments):*\n\n##Description\nI found an Insecure Direct Object Reference vulnerability on the `/v0/build/` and `/v0/build/\u003csiteid\u003e/log` API endpoints.\n\nFor example, when the user wants to restart the build, next request is sent to the endpoint:\n```\n{\"site\":\u003csiteid\u003e,\"branch\":\"master\"}\n```\nwhere siteid is numeric ID of the site.\nHowever, this endpoint does not check, do this site ID belongs to this user. So any user can restart the build of the site on any other user account.\n\n##Steps to reproduce\n1. Login to the Federalist with your test account (we can call it `user1`).\n2. Restart the build of some site which belongs to you.\n3. Catch the request to the \n```\nhttp://localhost:1337/v0/build/\n```\nand change `site` parameter to the siteID, which was created on some other account (we can call it `user2`).\n4. Execute the request. It will be accepted and processed.\n5. Login as `user2` and go to the builds page. You will notice that build was restarted by another user.\n\n##Suggested fix\nCorrect checking of user permissions on this endpoints should fix the issue.\n\n##References\n[Running Federalist locally](https://federalist-docs.18f.gov/pages/how-federalist-works/running-federalist-locally/ \"Running Federalist locally\")","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003e\u003cem\u003eThanks to the 18F team for the great experience, fast fix, and the bounty!\u003c/em\u003e\u003cbr\u003e\n\u003cem\u003eThe report details (i requested the limited disclosure due to sensitive info in the attachments):\u003c/em\u003e\u003c/p\u003e\n\n\u003ch2 id=\"description\"\u003eDescription\u003c/h2\u003e\n\n\u003cp\u003eI found an Insecure Direct Object Reference vulnerability on the \u003ccode\u003e/v0/build/\u003c/code\u003e and \u003ccode\u003e/v0/build/\u0026lt;siteid\u0026gt;/log\u003c/code\u003e API endpoints.\u003c/p\u003e\n\n\u003cp\u003eFor example, when the user wants to restart the build, next request is sent to the endpoint:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e{\u0026quot;site\u0026quot;:\u0026lt;siteid\u0026gt;,\u0026quot;branch\u0026quot;:\u0026quot;master\u0026quot;}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003ewhere siteid is numeric ID of the site.\u003cbr\u003e\nHowever, this endpoint does not check, do this site ID belongs to this user. So any user can restart the build of the site on any other user account.\u003c/p\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps to reproduce\u003c/h2\u003e\n\n\u003col\u003e\n\u003cli\u003eLogin to the Federalist with your test account (we can call it \u003ccode\u003euser1\u003c/code\u003e).\u003c/li\u003e\n\u003cli\u003eRestart the build of some site which belongs to you.\u003c/li\u003e\n\u003cli\u003eCatch the request to the \n\u003ccode\u003e\nhttp://localhost:1337/v0/build/\n\u003c/code\u003e\nand change \u003ccode\u003esite\u003c/code\u003e parameter to the siteID, which was created on some other account (we can call it \u003ccode\u003euser2\u003c/code\u003e).\u003c/li\u003e\n\u003cli\u003eExecute the request. It will be accepted and processed.\u003c/li\u003e\n\u003cli\u003eLogin as \u003ccode\u003euser2\u003c/code\u003e and go to the builds page. You will notice that build was restarted by another user.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003ch2 id=\"suggested-fix\"\u003eSuggested fix\u003c/h2\u003e\n\n\u003cp\u003eCorrect checking of user permissions on this endpoints should fix the issue.\u003c/p\u003e\n\n\u003ch2 id=\"references\"\u003eReferences\u003c/h2\u003e\n\n\u003cp\u003e\u003ca title=\"Running Federalist locally\" href=\"/redirect?url=https%3A%2F%2Ffederalist-docs.18f.gov%2Fpages%2Fhow-federalist-works%2Frunning-federalist-locally%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eRunning Federalist locally\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n"}]}