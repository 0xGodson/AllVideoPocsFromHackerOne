{"id":270068,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yNzAwNjg=","url":"https://hackerone.com/reports/270068","title":"Installer can modify other gems if gem name is specially crafted","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2017-09-21T02:26:57.258Z","submitted_at":"2017-09-21T02:26:57.258Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"nmalkin","url":"/nmalkin","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":8212,"url":"https://hackerone.com/rubygems","handle":"rubygems","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/008/212/e65eca09896d23bc029c08d3147a79a48ec1ee2f_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/212/e65eca09896d23bc029c08d3147a79a48ec1ee2f_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"RubyGems","twitter_handle":"rubygems_status","website":"https://rubygems.org","about":"RubyGems.org is the Ruby communityâ€™s gem hosting service."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2018-03-22T04:54:02.816Z","bug_reporter_agreed_on_going_public_at":"2018-02-20T04:53:55.629Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"# Installer can modify other gems if gem name is specially crafted\n\nThe `install_location` function allows writing to certain files outside the installation directory.\n\nThe `install_location` function in lib/rubygems/package.rb attempts to ensure that files are not installed outside `destination_dir`.  However the test it employs, a string comparison using `start_with?`, fails to prevent the case when `destination_dir` is a prefix of the path being written.\n\nExample that should be prevented but is allowed:\n```\ninstall_location '../install-whatever-foobar/hello.txt', '/tmp/install'\n# outputs '/tmp/install-whatever-foobar/hello.txt'\n```\n\n`gem install` always constructs `destination_dir` as `'#{name}-#{version}'`, so the vulnerability cannot overwrite arbitrary files.  However, a malicious gem with `name='rails'` and an empty version number (`version=''`), for example, could overwrite the files of any other gem whose name begins with `rails-`, like rails-i18n or rails-letsencrypt.\n\n## Proof of concept\n\nThe attached ra.gem demonstrates the vulnerability. It assumes that some other gems have already been installed.\n\n```bash\ngem install --install-dir=/tmp/install rails-i18n rails-letsencrypt rails-html-sanitizer\ngem install --install-dir=/tmp/install ra.gem\n```\n\nThe malicious gem will do three things, each of which could potentially lead to code execution:\n\n- delete an existing rails-letsencrypt-0.5.3 gem\n- overwrite a code file in the rails-i18n-5.0.4 gem\n- symlink rails-html-sanitizer-1.0.3 to a world-writable directory\n\nThe structure of the gem file reveals how the attack works:\n\n```sh\n$ tar -xvf ra.gem\nmetadata.gz\ndata.tar.gz\n$ gzip -dc metadata.gz | head -n 4\n--- !ruby/object:Gem::Specification\nname: rails\nversion: !ruby/object:Gem::Version\n  version: ''\n$ tar -tvf data.tar.gz\n-rw-r--r-- 0/0              12 1969-12-31 16:00 README\ndrwxr-xr-x 0/0               0 1969-12-31 16:00 ../rails-letsencrypt-0.5.3/\n-rw-r--r-- 0/0              12 1969-12-31 16:00 ../rails-i18n-5.0.4/lib/rails_i18n.rb\nlrw-r--r-- 0/0               0 1969-12-31 16:00 ../rails-html-sanitizer-1.0.3 -\u003e /tmp/attacker-controlled\n```\n\n## Remediation\n\nA sufficient fix is to append a directory separator to `destination_dir` before doing the `start_with?` check.\n\n```\ndiff --git a/lib/rubygems/package.rb b/lib/rubygems/package.rb\nindex c36e71d8..f73f9d30 100644\n--- a/lib/rubygems/package.rb\n+++ b/lib/rubygems/package.rb\n@@ -424,7 +424,7 @@ EOM\n     destination = File.expand_path destination\n\n     raise Gem::Package::PathError.new(destination, destination_dir) unless\n-      destination.start_with? destination_dir\n+      destination.start_with? destination_dir + '/'\n\n     destination.untaint\n     destination\n```\n\n## Attached files\n\n- `ra.gem`, an example of a vulnerable gem\n- `make-ra-gem.py`, sample code that generates the proof of concept (to run: `./make-ra-gem.py \u003e ra.gem`)\n- `0001-Add-test_install_location_suffix.patch`, test code that checks for this vulnerability. Run with `ruby -I\"lib:test\" test/rubygems/test_gem_package.rb`.\n","vulnerability_information_html":"\u003ch1 id=\"installer-can-modify-other-gems-if-gem-name-is-specially-crafted\"\u003eInstaller can modify other gems if gem name is specially crafted\u003c/h1\u003e\n\n\u003cp\u003eThe \u003ccode\u003einstall_location\u003c/code\u003e function allows writing to certain files outside the installation directory.\u003c/p\u003e\n\n\u003cp\u003eThe \u003ccode\u003einstall_location\u003c/code\u003e function in lib/rubygems/package.rb attempts to ensure that files are not installed outside \u003ccode\u003edestination_dir\u003c/code\u003e.  However the test it employs, a string comparison using \u003ccode\u003estart_with?\u003c/code\u003e, fails to prevent the case when \u003ccode\u003edestination_dir\u003c/code\u003e is a prefix of the path being written.\u003c/p\u003e\n\n\u003cp\u003eExample that should be prevented but is allowed:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003einstall_location \u0026#39;../install-whatever-foobar/hello.txt\u0026#39;, \u0026#39;/tmp/install\u0026#39;\n# outputs \u0026#39;/tmp/install-whatever-foobar/hello.txt\u0026#39;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e\u003ccode\u003egem install\u003c/code\u003e always constructs \u003ccode\u003edestination_dir\u003c/code\u003e as \u003ccode\u003e\u0026#39;#{name}-#{version}\u0026#39;\u003c/code\u003e, so the vulnerability cannot overwrite arbitrary files.  However, a malicious gem with \u003ccode\u003ename=\u0026#39;rails\u0026#39;\u003c/code\u003e and an empty version number (\u003ccode\u003eversion=\u0026#39;\u0026#39;\u003c/code\u003e), for example, could overwrite the files of any other gem whose name begins with \u003ccode\u003erails-\u003c/code\u003e, like rails-i18n or rails-letsencrypt.\u003c/p\u003e\n\n\u003ch2 id=\"proof-of-concept\"\u003eProof of concept\u003c/h2\u003e\n\n\u003cp\u003eThe attached ra.gem demonstrates the vulnerability. It assumes that some other gems have already been installed.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight shell\"\u003e\u003ccode\u003egem \u003cspan class=\"nb\"\u003einstall\u003c/span\u003e \u003cspan class=\"nt\"\u003e--install-dir\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e/tmp/install rails-i18n rails-letsencrypt rails-html-sanitizer\ngem \u003cspan class=\"nb\"\u003einstall\u003c/span\u003e \u003cspan class=\"nt\"\u003e--install-dir\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e/tmp/install ra.gem\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThe malicious gem will do three things, each of which could potentially lead to code execution:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003edelete an existing rails-letsencrypt-0.5.3 gem\u003c/li\u003e\n\u003cli\u003eoverwrite a code file in the rails-i18n-5.0.4 gem\u003c/li\u003e\n\u003cli\u003esymlink rails-html-sanitizer-1.0.3 to a world-writable directory\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eThe structure of the gem file reveals how the attack works:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight shell\"\u003e\u003ccode\u003e\u003cspan class=\"nv\"\u003e$ \u003c/span\u003e\u003cspan class=\"nb\"\u003etar\u003c/span\u003e \u003cspan class=\"nt\"\u003e-xvf\u003c/span\u003e ra.gem\nmetadata.gz\ndata.tar.gz\n\u003cspan class=\"nv\"\u003e$ \u003c/span\u003e\u003cspan class=\"nb\"\u003egzip\u003c/span\u003e \u003cspan class=\"nt\"\u003e-dc\u003c/span\u003e metadata.gz | \u003cspan class=\"nb\"\u003ehead\u003c/span\u003e \u003cspan class=\"nt\"\u003e-n\u003c/span\u003e 4\n\u003cspan class=\"nt\"\u003e---\u003c/span\u003e \u003cspan class=\"o\"\u003e!\u003c/span\u003eruby/object:Gem::Specification\nname: rails\nversion: \u003cspan class=\"o\"\u003e!\u003c/span\u003eruby/object:Gem::Version\n  version: \u003cspan class=\"s1\"\u003e\u0026#39;\u0026#39;\u003c/span\u003e\n\u003cspan class=\"nv\"\u003e$ \u003c/span\u003e\u003cspan class=\"nb\"\u003etar\u003c/span\u003e \u003cspan class=\"nt\"\u003e-tvf\u003c/span\u003e data.tar.gz\n\u003cspan class=\"nt\"\u003e-rw-r--r--\u003c/span\u003e 0/0              12 1969-12-31 16:00 README\ndrwxr-xr-x 0/0               0 1969-12-31 16:00 ../rails-letsencrypt-0.5.3/\n\u003cspan class=\"nt\"\u003e-rw-r--r--\u003c/span\u003e 0/0              12 1969-12-31 16:00 ../rails-i18n-5.0.4/lib/rails_i18n.rb\nlrw-r--r-- 0/0               0 1969-12-31 16:00 ../rails-html-sanitizer-1.0.3 -\u0026gt; /tmp/attacker-controlled\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2 id=\"remediation\"\u003eRemediation\u003c/h2\u003e\n\n\u003cp\u003eA sufficient fix is to append a directory separator to \u003ccode\u003edestination_dir\u003c/code\u003e before doing the \u003ccode\u003estart_with?\u003c/code\u003e check.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight diff\"\u003e\u003ccode\u003e\u003cspan class=\"gh\"\u003ediff --git a/lib/rubygems/package.rb b/lib/rubygems/package.rb\nindex c36e71d8..f73f9d30 100644\n\u003c/span\u003e\u003cspan class=\"gd\"\u003e--- a/lib/rubygems/package.rb\n\u003c/span\u003e\u003cspan class=\"gi\"\u003e+++ b/lib/rubygems/package.rb\n\u003c/span\u003e\u003cspan class=\"p\"\u003e@@ -424,7 +424,7 @@\u003c/span\u003e EOM\n     destination = File.expand_path destination\n\n     raise Gem::Package::PathError.new(destination, destination_dir) unless\n\u003cspan class=\"gd\"\u003e-      destination.start_with? destination_dir\n\u003c/span\u003e\u003cspan class=\"gi\"\u003e+      destination.start_with? destination_dir + \u0026#39;/\u0026#39;\n\u003c/span\u003e\n     destination.untaint\n     destination\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2 id=\"attached-files\"\u003eAttached files\u003c/h2\u003e\n\n\u003cul\u003e\n\u003cli\u003e\n\u003ccode\u003era.gem\u003c/code\u003e, an example of a vulnerable gem\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003emake-ra-gem.py\u003c/code\u003e, sample code that generates the proof of concept (to run: \u003ccode\u003e./make-ra-gem.py \u0026gt; ra.gem\u003c/code\u003e)\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003e0001-Add-test_install_location_suffix.patch\u003c/code\u003e, test code that checks for this vulnerability. Run with \u003ccode\u003eruby -I\u0026quot;lib:test\u0026quot; test/rubygems/test_gem_package.rb\u003c/code\u003e.\u003c/li\u003e\n\u003c/ul\u003e\n","weakness":{"id":19,"name":"Path Traversal"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":222676,"file_name":"ra.gem","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/222/676/02d197ea3b2a89e5b03f26af39d43e984c584b30/ra.gem?response-content-disposition=attachment%3B%20filename%3D%22ra.gem%22%3B%20filename%2A%3DUTF-8%27%27ra.gem\u0026response-content-type=application%2Fx-tar\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ4BCTVX7H%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T051850Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQD9KoIrMtYjsPMNAoz3fkIjMCGzGeE4AC6fZNsgc%2FNK1QIhANJsfJivva8u7YF1XCVwz2O44bXLlD4DSJhj7xaMke6RKrQDCFYQARoMMDEzNjE5Mjc0ODQ5IgzmYD94JaVjjIU2krEqkQPkOp7o1Y%2F3O46uPVkJpWKluhPjw6yqgkTOXGekCyVjJWTTKaV%2Fg4VslprjcyOrHq6Kvjx6FFrvI%2F0oeazfhhuVbsGzIX%2FDNyDl86o7E8p7xdE9njyFrZSTuG%2BcoCSQTNZm6K7xytZ808%2FmbOq1EsQaswjTfJE49knSO3dd6P9o4TMruMzu8iALfM0IqlU4CgtICPjNu1SwD5gIiOjS3JXo97WJ%2FeXaWM7uiiaZIfnwM1%2FJh%2B%2Bf4y2CVgdWsivBsUOOKr5Ffs4r9dvRgpxa%2BT%2FmspuhFLSjdwidy384ywNVej%2Fu5TtU0RmHvya7IsEPuuyEVKZ9GXWYeHJPMuJLhkj%2F9NgnnqTSYay6UqseBG9goY2oONYS%2Fy7uIy6pIkzSjH260rcLKe0FPxGZ3OZNA097jOWSnOIGGcV1YZW18F%2FQaHb3tqnILMft5hGAudbC%2F2kJRmQyb4mArK%2Bic9Gh50TdBT%2BX29t3Wo5dLJweBsKIOOdeF41%2BqY1abZEgoOIbiscyoLBMO4ChJxBEiM%2By%2Bjg8FjC%2B6ar%2FBTrqAdRlQf357Lw7olVqK9BuDw0RNDzAgG1%2BRjmEy94ivfSQKRkYnOaGVWNx1MekakiogYuOKzbAujbete9Cin2JFJP4a22qFOVAg7tsJ%2FeJITiLIkogRaku8DmGovq%2B04Yxq2jfRp5la%2FeG3Fqca5Jc2WM%2BO7QxCdRE21wSAgKnCwsy8vQV1X0gGJjUOV6UsIimNdWCtKUego7nGl1OprelVr%2FiPIFvPy%2BhWrWWJF9nHO59wa4OZtoRJ5df5%2ByoAAAuIWDBKZfHRv45K8z7hZFmm4sjyreHKi0tXU9Fadu828o5w%2B3CHi4r%2BAT0Pg%3D%3D\u0026X-Amz-Signature=14cb06cd51b1233eee1d70c92d01eef98f5e36780a48f78eff2aa404f19ce527","file_size":10240,"type":"application/x-tar"},{"id":222677,"file_name":"make-ra-gem.py","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/222/677/02b8c15db2a4e9b534e85b37a66c808caed25304/make-ra-gem.py?response-content-disposition=attachment%3B%20filename%3D%22make-ra-gem.py%22%3B%20filename%2A%3DUTF-8%27%27make-ra-gem.py\u0026response-content-type=text%2Fx-python\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ4BCTVX7H%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T051850Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQD9KoIrMtYjsPMNAoz3fkIjMCGzGeE4AC6fZNsgc%2FNK1QIhANJsfJivva8u7YF1XCVwz2O44bXLlD4DSJhj7xaMke6RKrQDCFYQARoMMDEzNjE5Mjc0ODQ5IgzmYD94JaVjjIU2krEqkQPkOp7o1Y%2F3O46uPVkJpWKluhPjw6yqgkTOXGekCyVjJWTTKaV%2Fg4VslprjcyOrHq6Kvjx6FFrvI%2F0oeazfhhuVbsGzIX%2FDNyDl86o7E8p7xdE9njyFrZSTuG%2BcoCSQTNZm6K7xytZ808%2FmbOq1EsQaswjTfJE49knSO3dd6P9o4TMruMzu8iALfM0IqlU4CgtICPjNu1SwD5gIiOjS3JXo97WJ%2FeXaWM7uiiaZIfnwM1%2FJh%2B%2Bf4y2CVgdWsivBsUOOKr5Ffs4r9dvRgpxa%2BT%2FmspuhFLSjdwidy384ywNVej%2Fu5TtU0RmHvya7IsEPuuyEVKZ9GXWYeHJPMuJLhkj%2F9NgnnqTSYay6UqseBG9goY2oONYS%2Fy7uIy6pIkzSjH260rcLKe0FPxGZ3OZNA097jOWSnOIGGcV1YZW18F%2FQaHb3tqnILMft5hGAudbC%2F2kJRmQyb4mArK%2Bic9Gh50TdBT%2BX29t3Wo5dLJweBsKIOOdeF41%2BqY1abZEgoOIbiscyoLBMO4ChJxBEiM%2By%2Bjg8FjC%2B6ar%2FBTrqAdRlQf357Lw7olVqK9BuDw0RNDzAgG1%2BRjmEy94ivfSQKRkYnOaGVWNx1MekakiogYuOKzbAujbete9Cin2JFJP4a22qFOVAg7tsJ%2FeJITiLIkogRaku8DmGovq%2B04Yxq2jfRp5la%2FeG3Fqca5Jc2WM%2BO7QxCdRE21wSAgKnCwsy8vQV1X0gGJjUOV6UsIimNdWCtKUego7nGl1OprelVr%2FiPIFvPy%2BhWrWWJF9nHO59wa4OZtoRJ5df5%2ByoAAAuIWDBKZfHRv45K8z7hZFmm4sjyreHKi0tXU9Fadu828o5w%2B3CHi4r%2BAT0Pg%3D%3D\u0026X-Amz-Signature=724515162da742732302ff7fd43415f291e5e466b3097ff510151a272c07c2b9","file_size":2339,"type":"text/x-python"},{"id":222679,"file_name":"0001-Add-test_install_location_suffix.patch","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/222/679/0c3a9b59226ba0d350654f09f6368f01f730f0c9/0001-Add-test_install_location_suffix.patch?response-content-disposition=attachment%3B%20filename%3D%220001-Add-test_install_location_suffix.patch%22%3B%20filename%2A%3DUTF-8%27%270001-Add-test_install_location_suffix.patch\u0026response-content-type=text%2Fx-diff\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ4BCTVX7H%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T051850Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQD9KoIrMtYjsPMNAoz3fkIjMCGzGeE4AC6fZNsgc%2FNK1QIhANJsfJivva8u7YF1XCVwz2O44bXLlD4DSJhj7xaMke6RKrQDCFYQARoMMDEzNjE5Mjc0ODQ5IgzmYD94JaVjjIU2krEqkQPkOp7o1Y%2F3O46uPVkJpWKluhPjw6yqgkTOXGekCyVjJWTTKaV%2Fg4VslprjcyOrHq6Kvjx6FFrvI%2F0oeazfhhuVbsGzIX%2FDNyDl86o7E8p7xdE9njyFrZSTuG%2BcoCSQTNZm6K7xytZ808%2FmbOq1EsQaswjTfJE49knSO3dd6P9o4TMruMzu8iALfM0IqlU4CgtICPjNu1SwD5gIiOjS3JXo97WJ%2FeXaWM7uiiaZIfnwM1%2FJh%2B%2Bf4y2CVgdWsivBsUOOKr5Ffs4r9dvRgpxa%2BT%2FmspuhFLSjdwidy384ywNVej%2Fu5TtU0RmHvya7IsEPuuyEVKZ9GXWYeHJPMuJLhkj%2F9NgnnqTSYay6UqseBG9goY2oONYS%2Fy7uIy6pIkzSjH260rcLKe0FPxGZ3OZNA097jOWSnOIGGcV1YZW18F%2FQaHb3tqnILMft5hGAudbC%2F2kJRmQyb4mArK%2Bic9Gh50TdBT%2BX29t3Wo5dLJweBsKIOOdeF41%2BqY1abZEgoOIbiscyoLBMO4ChJxBEiM%2By%2Bjg8FjC%2B6ar%2FBTrqAdRlQf357Lw7olVqK9BuDw0RNDzAgG1%2BRjmEy94ivfSQKRkYnOaGVWNx1MekakiogYuOKzbAujbete9Cin2JFJP4a22qFOVAg7tsJ%2FeJITiLIkogRaku8DmGovq%2B04Yxq2jfRp5la%2FeG3Fqca5Jc2WM%2BO7QxCdRE21wSAgKnCwsy8vQV1X0gGJjUOV6UsIimNdWCtKUego7nGl1OprelVr%2FiPIFvPy%2BhWrWWJF9nHO59wa4OZtoRJ5df5%2ByoAAAuIWDBKZfHRv45K8z7hZFmm4sjyreHKi0tXU9Fadu828o5w%2B3CHi4r%2BAT0Pg%3D%3D\u0026X-Amz-Signature=8093518cb7d9b794a504991f35fffc1879e619892a418a42f8b98e977b53c539","file_size":1532,"type":"text/x-diff"}],"allow_singular_disclosure_at":"2018-03-22T04:53:55.684Z","allow_singular_disclosure_after":-87524694.75954226,"singular_disclosure_allowed":true,"vote_count":8,"voters":["jokebookservice1","muon4","eveeez","apapedulimu","japz","amykruse","lowebrew","baharnarenj"],"severity":{"rating":"medium","score":5.5,"author_type":"Team","metrics":{"attack_vector":"local","attack_complexity":"high","privileges_required":"none","user_interaction":"required","scope":"changed","confidentiality":"none","integrity":"high","availability":"none"}},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":2010447,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for submitting this report to RubyGems. Our team will review and investigate the issue. Please note that only issues in the rubygems library are eligible for our bug bounty program.","markdown_message":"\u003cp\u003eThanks for submitting this report to RubyGems. Our team will review and investigate the issue. Please note that only issues in the rubygems library are eligible for our bug bounty program.\u003c/p\u003e\n","automated_response":true,"created_at":"2017-09-21T02:26:57.440Z","updated_at":"2017-09-21T02:26:57.440Z","actor":{"url":"/rubygems","ibb":true,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/212/e65eca09896d23bc029c08d3147a79a48ec1ee2f_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"RubyGems"}},"genius_execution_id":null,"team_handle":"rubygems","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2340955,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2018-02-01T04:10:34.570Z","updated_at":"2018-02-01T04:10:34.570Z","additional_data":{"old_severity":null,"new_severity":"Medium (5.5)","old_severity_id":null,"new_severity_id":114221},"actor":{"username":"claudijd","cleared":false,"url":"/claudijd","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/131/3c373767fbd4f34648ab754b0f692fb718bfb8e5_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rubygems","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2364296,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2018-02-08T23:05:37.841Z","updated_at":"2018-02-08T23:05:37.841Z","actor":{"username":"claudijd","cleared":false,"url":"/claudijd","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/131/3c373767fbd4f34648ab754b0f692fb718bfb8e5_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rubygems","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2395706,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2018-02-18T04:29:25.087Z","updated_at":"2018-02-18T04:29:25.087Z","actor":{"username":"claudijd","cleared":false,"url":"/claudijd","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/131/3c373767fbd4f34648ab754b0f692fb718bfb8e5_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"nmalkin","url":"/nmalkin"},"genius_execution_id":null,"team_handle":"rubygems","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2395713,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"","markdown_message":"","automated_response":false,"created_at":"2018-02-18T04:37:39.047Z","updated_at":"2018-02-18T04:37:39.047Z","actor":{"url":"/rubygems","ibb":true,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/212/e65eca09896d23bc029c08d3147a79a48ec1ee2f_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"RubyGems"}},"genius_execution_id":null,"team_handle":"rubygems","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2405842,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"As with Report #270072, I would appreciate if this bug could be jointly attributed to David Fifield and me.","markdown_message":"\u003cp\u003eAs with Report \u003ca href=\"/reports/270072\"\u003e#270072\u003c/a\u003e, I would appreciate if this bug could be jointly attributed to David Fifield and me.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-02-20T04:53:47.468Z","updated_at":"2018-02-20T04:53:47.468Z","actor":{"username":"nmalkin","cleared":false,"url":"/nmalkin","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rubygems","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2405843,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-02-20T04:53:55.655Z","updated_at":"2018-02-20T04:53:55.655Z","first_to_agree":true,"actor":{"username":"nmalkin","cleared":false,"url":"/nmalkin","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rubygems","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2445053,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@nmalkin since our blog is open source, I would ask that you file a PR against our blog, much like I did [here](https://github.com/rubygems/rubygems.github.io/pull/31/files) as an example.","markdown_message":"\u003cp\u003e\u003ca href=\"/nmalkin\"\u003e@nmalkin\u003c/a\u003e since our blog is open source, I would ask that you file a PR against our blog, much like I did \u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Frubygems%2Frubygems.github.io%2Fpull%2F31%2Ffiles\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehere\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e as an example.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-03-01T05:49:51.432Z","updated_at":"2018-03-01T05:49:51.432Z","actor":{"username":"claudijd","cleared":false,"url":"/claudijd","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/131/3c373767fbd4f34648ab754b0f692fb718bfb8e5_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rubygems","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2516666,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-03-22T04:54:02.840Z","updated_at":"2018-03-22T04:54:02.840Z","actor":{"url":"/rubygems","ibb":true,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/212/e65eca09896d23bc029c08d3147a79a48ec1ee2f_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"RubyGems"}},"genius_execution_id":null,"team_handle":"rubygems","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}