{"id":313050,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zMTMwNTA=","url":"https://hackerone.com/reports/313050","title":"IDOR in treat subscriptions","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2018-02-07T02:38:01.307Z","submitted_at":"2018-02-07T02:38:01.307Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"harsh13","url":"/harsh13","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":2943,"url":"https://hackerone.com/zomato","handle":"zomato","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/002/943/71b47f9aa21166f0989dfb97112ca10c66a9d0b2_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/943/71b47f9aa21166f0989dfb97112ca10c66a9d0b2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Zomato","twitter_handle":"Zomato","website":"https://www.zomato.com","about":"The fastest way to search for great places to eat at and order from around you. Serving 24 countries worldwide."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2018-04-25T12:25:30.883Z","bug_reporter_agreed_on_going_public_at":"2018-04-24T13:22:47.565Z","team_member_agreed_on_going_public_at":"2018-04-25T12:25:30.785Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"The treat subscriptions tab in my profile has an IDOR.\n\nThe corresponding api:\n\nPOST /php/filter_user_tab_content.php HTTP/1.1\nuser_id=██████\u0026tab=treat_subscription\u0026order_history_offset=0\u0026order_history_limit=20\n\n\nYou can give any user id and you will be able to see the treat subscriptions of that user.\n\n## Impact\n\nA user can view treat subscriptions of any other user.","vulnerability_information_html":"\u003cp\u003eThe treat subscriptions tab in my profile has an IDOR.\u003c/p\u003e\n\n\u003cp\u003eThe corresponding api:\u003c/p\u003e\n\n\u003cp\u003ePOST /php/filter_user_tab_content.php HTTP/1.1\u003cbr\u003e\nuser_id=██████\u0026amp;tab=treat_subscription\u0026amp;order_history_offset=0\u0026amp;order_history_limit=20\u003c/p\u003e\n\n\u003cp\u003eYou can give any user id and you will be able to see the treat subscriptions of that user.\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eA user can view treat subscriptions of any other user.\u003c/p\u003e\n","bounty_amount":"100.0","formatted_bounty":"$100","weakness":{"id":55,"name":"Insecure Direct Object Reference (IDOR)"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2018-05-24T13:22:47.635Z","allow_singular_disclosure_after":-82051794.511207,"singular_disclosure_allowed":true,"vote_count":5,"voters":["muon4","eveeez","japz","sumit7","wargsec"],"severity":{"rating":"medium","author_type":"Team"},"structured_scope":{"databaseId":383,"asset_type":"URL","asset_identifier":"*.zomato.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":2357419,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for your report! We need some more information before we can properly review this report. Is it possible you could provide a clear step-by-step PoC showing your vulnerability?  Thanks again for your report and we hope to hear back from you soon.\n\nKind regards.","markdown_message":"\u003cp\u003eThanks for your report! We need some more information before we can properly review this report. Is it possible you could provide a clear step-by-step PoC showing your vulnerability?  Thanks again for your report and we hope to hear back from you soon.\u003c/p\u003e\n\n\u003cp\u003eKind regards.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-02-07T03:44:25.140Z","updated_at":"2018-02-07T03:44:25.140Z","actor":{"username":"chocolatechipmuffin","cleared":false,"url":"/chocolatechipmuffin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/222/995/e06f83c3c2c49aec68debce80fce012d52d56729_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2357541,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"1. In the Profile section, there is a tab called My Subscriptions.\n2. The api used to get the subscriptions of a user is as follows:\n\nPOST /php/filter_user_tab_content.php HTTP/1.1\nHost: www.zomato.com\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.12; rv:58.0) Gecko/20100101 Firefox/58.0\nAccept: application/json, text/javascript, */*; q=0.01\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nReferer: https://www.zomato.com/\nContent-Type: application/x-www-form-urlencoded; charset=UTF-8\nX-Requested-With: XMLHttpRequest\nContent-Length: 85\n\n\nuser_id=█████\u0026tab=treat_subscription\u0026order_history_offset=0\u0026order_history_limit=20\n\n\n(Note: Have removed the cookie and csrf token. Please add your own session id. Only logged in users are allowed to use this api.)\n\n3. The user_id field in the post parameter is vulnerable to IDOR. \n4. You can use any user id, and you will get the subscription details.\n5. To verify, ask zomato to share the user id of a customer who has subscribed to \"Zomato Treats.\"\n6. You can then use this user id, with your session to get the subscription details.\n","markdown_message":"\u003col\u003e\n\u003cli\u003eIn the Profile section, there is a tab called My Subscriptions.\u003c/li\u003e\n\u003cli\u003eThe api used to get the subscriptions of a user is as follows:\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003ePOST /php/filter_user_tab_content.php HTTP/1.1\u003cbr\u003e\nHost: \u003ca href=\"/redirect?url=http%3A%2F%2Fwww.zomato.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ewww.zomato.com\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.12; rv:58.0) Gecko/20100101 Firefox/58.0\u003cbr\u003e\nAccept: application/json, text/javascript, \u003cem\u003e/\u003c/em\u003e; q=0.01\u003cbr\u003e\nAccept-Language: en-US,en;q=0.5\u003cbr\u003e\nAccept-Encoding: gzip, deflate\u003cbr\u003e\nReferer: \u003ca title=\"https://www.zomato.com/\" href=\"/redirect?url=https%3A%2F%2Fwww.zomato.com%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.zomato.com/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nContent-Type: application/x-www-form-urlencoded; charset=UTF-8\u003cbr\u003e\nX-Requested-With: XMLHttpRequest\u003cbr\u003e\nContent-Length: 85\u003c/p\u003e\n\n\u003cp\u003euser_id=█████\u0026amp;tab=treat_subscription\u0026amp;order_history_offset=0\u0026amp;order_history_limit=20\u003c/p\u003e\n\n\u003cp\u003e(Note: Have removed the cookie and csrf token. Please add your own session id. Only logged in users are allowed to use this api.)\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eThe user_id field in the post parameter is vulnerable to IDOR. \u003c/li\u003e\n\u003cli\u003eYou can use any user id, and you will get the subscription details.\u003c/li\u003e\n\u003cli\u003eTo verify, ask zomato to share the user id of a customer who has subscribed to \u0026quot;Zomato Treats.\u0026quot;\u003c/li\u003e\n\u003cli\u003eYou can then use this user id, with your session to get the subscription details.\u003c/li\u003e\n\u003c/ol\u003e\n","automated_response":false,"created_at":"2018-02-07T05:16:06.522Z","updated_at":"2018-04-25T06:15:40.358Z","actor":{"username":"harsh13","cleared":false,"url":"/harsh13","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2357580,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello, \nYou can use \"user_id=4\", to get the 'treat subscription' details of that user id.\n\nNote: YOU NEED TO BE LOGGED IN TO ZOMATO.\n","markdown_message":"\u003cp\u003eHello, \u003cbr\u003e\nYou can use \u0026quot;user_id=4\u0026quot;, to get the \u0026#39;treat subscription\u0026#39; details of that user id.\u003c/p\u003e\n\n\u003cp\u003eNote: YOU NEED TO BE LOGGED IN TO ZOMATO.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-02-07T05:55:36.195Z","updated_at":"2018-02-07T05:55:36.195Z","actor":{"username":"harsh13","cleared":false,"url":"/harsh13","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2365546,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"This seems to be fixed. Any update on this?","markdown_message":"\u003cp\u003eThis seems to be fixed. Any update on this?\u003c/p\u003e\n","automated_response":false,"created_at":"2018-02-09T06:35:15.470Z","updated_at":"2018-02-09T06:35:15.470Z","actor":{"username":"harsh13","cleared":false,"url":"/harsh13","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2369742,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @harsh13, \n\nThank you for the additional information!  We are not sure if any changes have been made, but we will let you know once we have information to share.\n\nRegards.","markdown_message":"\u003cp\u003eHi \u003ca href=\"/harsh13\"\u003e@harsh13\u003c/a\u003e, \u003c/p\u003e\n\n\u003cp\u003eThank you for the additional information!  We are not sure if any changes have been made, but we will let you know once we have information to share.\u003c/p\u003e\n\n\u003cp\u003eRegards.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-02-10T00:52:13.384Z","updated_at":"2018-02-10T00:52:33.273Z","actor":{"username":"chessmast3r","cleared":false,"url":"/chessmast3r","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/220/459/6b3c5fca9df9cde7fe36b55238b13d2cea86ea80_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2385130,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @chessmast3r \nAny update on this?","markdown_message":"\u003cp\u003eHi \u003ca href=\"/chessmast3r\"\u003e@chessmast3r\u003c/a\u003e \u003cbr\u003e\nAny update on this?\u003c/p\u003e\n","automated_response":false,"created_at":"2018-02-15T05:01:50.607Z","updated_at":"2018-02-15T05:01:50.607Z","actor":{"username":"harsh13","cleared":false,"url":"/harsh13","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2437021,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @chessmast3r  @chocolatechipmuffin,\nIts been 3 weeks. Any update on this?","markdown_message":"\u003cp\u003eHi \u003ca href=\"/chessmast3r\"\u003e@chessmast3r\u003c/a\u003e  \u003ca href=\"/chocolatechipmuffin\"\u003e@chocolatechipmuffin\u003c/a\u003e,\u003cbr\u003e\nIts been 3 weeks. Any update on this?\u003c/p\u003e\n","automated_response":false,"created_at":"2018-02-27T02:41:16.595Z","updated_at":"2018-02-27T02:41:16.595Z","actor":{"username":"harsh13","cleared":false,"url":"/harsh13","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2469960,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"This is resolved.","markdown_message":"\u003cp\u003eThis is resolved.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-03-07T12:52:37.148Z","updated_at":"2018-03-07T12:52:37.148Z","actor":{"username":"neeraj_szqir","cleared":false,"url":"/neeraj_szqir","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"harsh13","url":"/harsh13"},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2472191,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"eligible for bounty?","markdown_message":"\u003cp\u003eeligible for bounty?\u003c/p\u003e\n","automated_response":false,"created_at":"2018-03-08T06:12:26.485Z","updated_at":"2018-03-08T06:12:26.485Z","actor":{"username":"harsh13","cleared":false,"url":"/harsh13","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2472250,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2018-03-08T06:44:31.765Z","updated_at":"2018-03-08T06:44:31.765Z","actor":{"url":"/zomato","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/943/71b47f9aa21166f0989dfb97112ca10c66a9d0b2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Zomato"}},"bounty_amount":"100.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"zomato","collaborator":{"username":"harsh13","url":"/harsh13"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2472251,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2018-03-08T06:44:46.553Z","updated_at":"2018-03-08T06:44:46.553Z","additional_data":{"old_severity":"High","new_severity":"Medium","old_severity_id":115964,"new_severity_id":126571},"actor":{"username":"chicken-tikka","cleared":false,"url":"/chicken-tikka","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/059/568/cdbb30fd8932f00a06868a737ab5bdc5c57e5f00_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2659767,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-04-24T13:22:47.594Z","updated_at":"2018-04-24T13:22:47.594Z","first_to_agree":true,"actor":{"username":"harsh13","cleared":false,"url":"/harsh13","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2663892,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-04-25T12:25:30.816Z","updated_at":"2018-04-25T12:25:30.816Z","actor":{"username":"prateek_0490-zomato","cleared":false,"url":"/prateek_0490-zomato","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/CL56d6XwY4TN3eHc73df8AEU/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2663893,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-04-25T12:25:30.913Z","updated_at":"2018-04-25T12:25:30.913Z","actor":{"username":"prateek_0490-zomato","cleared":false,"url":"/prateek_0490-zomato","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/CL56d6XwY4TN3eHc73df8AEU/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":7233,"category":"team","content":"@harsh13 found an IDOR which leaked `Subscription ID`, `Purchased Date`, `Validity of Zomato Treats`. Thanks @harsh13 for helping us in making @zomato secure :)\n\nCheers.","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003e\u003ca href=\"/harsh13\"\u003e@harsh13\u003c/a\u003e found an IDOR which leaked \u003ccode\u003eSubscription ID\u003c/code\u003e, \u003ccode\u003ePurchased Date\u003c/code\u003e, \u003ccode\u003eValidity of Zomato Treats\u003c/code\u003e. Thanks \u003ca href=\"/harsh13\"\u003e@harsh13\u003c/a\u003e for helping us in making \u003ca href=\"/zomato\"\u003e@zomato\u003c/a\u003e secure :)\u003c/p\u003e\n\n\u003cp\u003eCheers.\u003c/p\u003e\n"},{"category":"researcher","can_view?":true,"can_create?":false}]}