{"id":273803,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yNzM4MDM=","url":"https://hackerone.com/reports/273803","title":"[werkenbijmcdonalds.nl] Unsafe-inline in \"script-src\" results in \"bootstrapping\" or passing data to JavaScript from HTML pages. ","state":"Closed","substate":"informative","severity_rating":"medium","readable_substate":"Informative","created_at":"2017-10-02T16:29:09.824Z","submitted_at":"2017-10-02T16:29:09.824Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"sumit7","url":"/sumit7","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/EjyfxvKEgAnMvPDhA1prW6uH/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":2450,"url":"https://hackerone.com/maximum","handle":"maximum","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/002/450/6cac31c0a6ad854c086c328817a688e4720a3306_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/450/6cac31c0a6ad854c086c328817a688e4720a3306_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Maximum","twitter_handle":"maximum_NL","website":"https://maximum.nl","about":"Maximum is a full-service agency specialised in employer branding and recruitment advertising."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2017-11-15T09:01:29.061Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2017-10-03T09:30:59.652Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi Dear Maximum Team\n\nHope you are good!\n\n**Vulnerablity Summary**\nThe HTTP header of the werkenbijmcdonalds.nl website includes an unsafe-inline parameter for \"script-src\".\n\n**Impact:**\nHowever, the \"script-src\" parameter is set to \"unsafe-inline\" or \"unsafe-eval\", which allows injection of user passed values, which in result can be misused for Cross-Site Scripting attacks.This is to allow \"bootstrapping\" or passing data to JavaScript from HTML pages. It's a dangerous setting, so I recommend here to fix it soon by passing data to JavaScript in the DOM instead of creating JavaScript variables from HTML.\n\n\n**Mitigation**\nPlease remove \"unsafe-inline\" from \"script-src\", to  resolve. Thanks for reading this!\n\nIf you need help, be free to ask.\n\nHappy to help.\n\nRegards,\n@smit\n\n\n","vulnerability_information_html":"\u003cp\u003eHi Dear Maximum Team\u003c/p\u003e\n\n\u003cp\u003eHope you are good!\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eVulnerablity Summary\u003c/strong\u003e\u003cbr\u003e\nThe HTTP header of the werkenbijmcdonalds.nl website includes an unsafe-inline parameter for \u0026quot;script-src\u0026quot;.\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eImpact:\u003c/strong\u003e\u003cbr\u003e\nHowever, the \u0026quot;script-src\u0026quot; parameter is set to \u0026quot;unsafe-inline\u0026quot; or \u0026quot;unsafe-eval\u0026quot;, which allows injection of user passed values, which in result can be misused for Cross-Site Scripting attacks.This is to allow \u0026quot;bootstrapping\u0026quot; or passing data to JavaScript from HTML pages. It\u0026#39;s a dangerous setting, so I recommend here to fix it soon by passing data to JavaScript in the DOM instead of creating JavaScript variables from HTML.\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eMitigation\u003c/strong\u003e\u003cbr\u003e\nPlease remove \u0026quot;unsafe-inline\u0026quot; from \u0026quot;script-src\u0026quot;, to  resolve. Thanks for reading this!\u003c/p\u003e\n\n\u003cp\u003eIf you need help, be free to ask.\u003c/p\u003e\n\n\u003cp\u003eHappy to help.\u003c/p\u003e\n\n\u003cp\u003eRegards,\u003cbr\u003e\n\u003ca href=\"/smit\"\u003e@smit\u003c/a\u003e\u003c/p\u003e\n","weakness":{"id":57,"name":"Violation of Secure Design Principles"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":2,"voters":["khizer47","hackworld"],"severity":{"rating":"medium","author_type":"User"},"structured_scope":{"databaseId":1343,"asset_type":"URL","asset_identifier":"werkenbijmcdonalds.nl","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":2040356,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"Hey Smit,\n\nThanks for your report.\nIt's a known issue, unfortunately we are unable to restrict the CSP any further due to GTM (Google Tag Manager).\nYou can read specifics here: https://www.lunametrics.com/blog/2017/07/20/using-google-analytics-google-tag-manager-content-security-policy/","markdown_message":"\u003cp\u003eHey Smit,\u003c/p\u003e\n\n\u003cp\u003eThanks for your report.\u003cbr\u003e\nIt\u0026#39;s a known issue, unfortunately we are unable to restrict the CSP any further due to GTM (Google Tag Manager).\u003cbr\u003e\nYou can read specifics here: \u003ca title=\"https://www.lunametrics.com/blog/2017/07/20/using-google-analytics-google-tag-manager-content-security-policy/\" href=\"/redirect?url=https%3A%2F%2Fwww.lunametrics.com%2Fblog%2F2017%2F07%2F20%2Fusing-google-analytics-google-tag-manager-content-security-policy%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.lunametrics.com/blog/2017/07/20/using-google-analytics-google-tag-manager-content-security-policy/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2017-10-03T07:49:08.481Z","updated_at":"2017-10-03T07:49:08.481Z","actor":{"username":"bamie","cleared":false,"url":"/bamie","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/039/631/8aff5981b7c2a3519ed7170def4f7ad2392d13da_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"maximum","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2040433,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-10-03T09:30:59.671Z","updated_at":"2017-10-03T09:30:59.671Z","first_to_agree":true,"actor":{"username":"bamie","cleared":false,"url":"/bamie","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/039/631/8aff5981b7c2a3519ed7170def4f7ad2392d13da_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"maximum","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2040434,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Publicly disclosed to avoid duplicate reports.","markdown_message":"\u003cp\u003ePublicly disclosed to avoid duplicate reports.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-10-03T09:31:16.360Z","updated_at":"2017-10-03T09:31:16.360Z","actor":{"username":"bamie","cleared":false,"url":"/bamie","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/039/631/8aff5981b7c2a3519ed7170def4f7ad2392d13da_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"maximum","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2158885,"is_internal":false,"editable":false,"type":"Activities::ManuallyDisclosed","message":"","markdown_message":"","automated_response":false,"created_at":"2017-11-15T09:01:29.006Z","updated_at":"2017-11-15T09:01:29.006Z","actor":{"username":"bamie","cleared":false,"url":"/bamie","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/039/631/8aff5981b7c2a3519ed7170def4f7ad2392d13da_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"maximum","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":5908,"category":"team","content":"CSP script-src unsafe directive needed for Google Tag Manager","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eCSP script-src unsafe directive needed for Google Tag Manager\u003c/p\u003e\n"},{"category":"researcher","can_view?":true,"can_create?":false}]}