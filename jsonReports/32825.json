{"id":32825,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zMjgyNQ==","url":"https://hackerone.com/reports/32825","title":"URGENT - Subdomain Takeover on media.vine.co due to unclaimed domain pointing to AWS","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2014-10-25T23:46:23.949Z","submitted_at":"2014-10-25T23:46:23.949Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"fransrosen","url":"/fransrosen","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/634/6569f1cff6ac26c01a91db469d8707228965f09f_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":61,"url":"https://hackerone.com/twitter","handle":"twitter","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/061/85a63a443f017ad8353de4f68ebf52fdd61c345a_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/061/85a63a443f017ad8353de4f68ebf52fdd61c345a_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Twitter","twitter_handle":"twittersecurity","website":"https://twitter.com","about":"Twitter helps you create and share ideas and information instantly, without barriers."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2014-11-03T23:37:26.039Z","bug_reporter_agreed_on_going_public_at":"2014-11-03T23:37:25.738Z","team_member_agreed_on_going_public_at":"2014-11-03T23:36:10.062Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi,\r\nThis is an urgent issue and I hope you will act on it likewise.\r\nYour subdomain media.vine.co is pointing to AWS S3, but no bucket was connected to it. Actually, the reason to it is due to the CNAME of the meda.vine.co-DNS-entry:\r\n\r\n```\r\nmedia.vine.co\r\n -\u003e media.vine.co is an alias for vines.s3.amazonaws.com.\r\n```\r\n\r\nThis might have worked before, since there is a bucket with the name \"vines\". However, these are the rules for how CNAMEs to S3 are working currently:\r\n\r\n\u003e Customizing Amazon S3 URLs with CNAMEs\r\n\u003e \r\n\u003e Depending on your needs, you might not want \"s3.amazonaws.com\" to appear on your website or service. For example, if you host your website images on Amazon S3, you might prefer http://images.johnsmith.net/ instead of http://johnsmith-images.s3.amazonaws.com/.\r\n\u003e \r\n\u003e The bucket name must be the same as the CNAME. So http://images.johnsmith.net/filename would be the same as http://images.johnsmith.net.s3.amazonaws.com/filename if a CNAME were created to map images.johnsmith.net to images.johnsmith.net.s3.amazonaws.com.\r\n\r\nSo what happens here is actually that, since media.vine.co is pointing to S3, S3 is actually checking if there's a bucket with that name. Which in this case was not true. So I was able to claim the bucket media.vine.co and thus, can place content on this URL.\r\n\r\n _You should immediately remove the DNS-entry for media.vine.co pointing to AWS S3._ \r\n\r\nSince I have complete control over the subdomain I can do whatever I want on it. The restriction I have now is that I'm not able to serve anything on the root-URL ( http://media.vine.co/ ) – however – if I would have created the bucket in the correct region (West-1) in AWS, this would've worked.\r\n\r\nCreating a login form that would fool anyone, since it's present on a Vine.co domain.\r\n\r\nPOC-link:\r\nhttp://media.vine.co/login\r\n\r\nPOC-image attached.\r\n\r\nThis is really severe. Foolproof phishing. XSS on vine.co. Potential malware spread through a domain you – in this case – do not control. Extremely painful for the Company Brand.\r\n\r\nPlease make sure you're always going through your DNS-entries so no subdomains are pointing to external services you do not use.\r\n\r\nWe've written an advisory about this at Detectify:\r\nhttp://blog.detectify.com/post/100600514143/hostile-subdomain-takeover-using-heroku-github-desk\r\n\r\nWhere you can read more about this sort of attack.\r\n\r\nRegards,\r\nFrans","vulnerability_information_html":"\u003cp\u003eHi,\u003cbr\u003e\nThis is an urgent issue and I hope you will act on it likewise.\u003cbr\u003e\nYour subdomain media.vine.co is pointing to AWS S3, but no bucket was connected to it. Actually, the reason to it is due to the CNAME of the meda.vine.co-DNS-entry:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003emedia.vine.co\n -\u0026gt; media.vine.co is an alias for vines.s3.amazonaws.com.\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThis might have worked before, since there is a bucket with the name \u0026quot;vines\u0026quot;. However, these are the rules for how CNAMEs to S3 are working currently:\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eCustomizing Amazon S3 URLs with CNAMEs\u003c/p\u003e\n\n\u003cp\u003eDepending on your needs, you might not want \u0026quot;s3.amazonaws.com\u0026quot; to appear on your website or service. For example, if you host your website images on Amazon S3, you might prefer \u003ca title=\"http://images.johnsmith.net/\" href=\"/redirect?url=http%3A%2F%2Fimages.johnsmith.net%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://images.johnsmith.net/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e instead of \u003ca title=\"http://johnsmith-images.s3.amazonaws.com/\" href=\"/redirect?url=http%3A%2F%2Fjohnsmith-images.s3.amazonaws.com%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://johnsmith-images.s3.amazonaws.com/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e.\u003c/p\u003e\n\n\u003cp\u003eThe bucket name must be the same as the CNAME. So \u003ca title=\"http://images.johnsmith.net/filename\" href=\"/redirect?url=http%3A%2F%2Fimages.johnsmith.net%2Ffilename\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://images.johnsmith.net/filename\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e would be the same as \u003ca title=\"http://images.johnsmith.net.s3.amazonaws.com/filename\" href=\"/redirect?url=http%3A%2F%2Fimages.johnsmith.net.s3.amazonaws.com%2Ffilename\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://images.johnsmith.net.s3.amazonaws.com/filename\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e if a CNAME were created to map images.johnsmith.net to images.johnsmith.net.s3.amazonaws.com.\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eSo what happens here is actually that, since media.vine.co is pointing to S3, S3 is actually checking if there\u0026#39;s a bucket with that name. Which in this case was not true. So I was able to claim the bucket media.vine.co and thus, can place content on this URL.\u003c/p\u003e\n\n\u003cp\u003e\u003cu\u003eYou should immediately remove the DNS-entry for media.vine.co pointing to AWS S3.\u003c/u\u003e \u003c/p\u003e\n\n\u003cp\u003eSince I have complete control over the subdomain I can do whatever I want on it. The restriction I have now is that I\u0026#39;m not able to serve anything on the root-URL ( \u003ca title=\"http://media.vine.co/\" href=\"/redirect?url=http%3A%2F%2Fmedia.vine.co%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://media.vine.co/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e ) – however – if I would have created the bucket in the correct region (West-1) in AWS, this would\u0026#39;ve worked.\u003c/p\u003e\n\n\u003cp\u003eCreating a login form that would fool anyone, since it\u0026#39;s present on a Vine.co domain.\u003c/p\u003e\n\n\u003cp\u003ePOC-link:\u003cbr\u003e\n\u003ca title=\"http://media.vine.co/login\" href=\"/redirect?url=http%3A%2F%2Fmedia.vine.co%2Flogin\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://media.vine.co/login\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003ePOC-image attached.\u003c/p\u003e\n\n\u003cp\u003eThis is really severe. Foolproof phishing. XSS on vine.co. Potential malware spread through a domain you – in this case – do not control. Extremely painful for the Company Brand.\u003c/p\u003e\n\n\u003cp\u003ePlease make sure you\u0026#39;re always going through your DNS-entries so no subdomains are pointing to external services you do not use.\u003c/p\u003e\n\n\u003cp\u003eWe\u0026#39;ve written an advisory about this at Detectify:\u003cbr\u003e\n\u003ca title=\"http://blog.detectify.com/post/100600514143/hostile-subdomain-takeover-using-heroku-github-desk\" href=\"/redirect?url=http%3A%2F%2Fblog.detectify.com%2Fpost%2F100600514143%2Fhostile-subdomain-takeover-using-heroku-github-desk\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://blog.detectify.com/post/100600514143/hostile-subdomain-takeover-using-heroku-github-desk\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eWhere you can read more about this sort of attack.\u003c/p\u003e\n\n\u003cp\u003eRegards,\u003cbr\u003e\nFrans\u003c/p\u003e\n","bounty_amount":"1680.0","formatted_bounty":"$1,680","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":19491,"file_name":"Screen_Shot_2014-10-26_at_01.38.37.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/019/491/63a59835d3f8a8f614e2f93fece81571eac9d710/Screen_Shot_2014-10-26_at_01.38.37.png?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2014-10-26_at_01.38.37.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2014-10-26_at_01.38.37.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ37US5OJ5%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T053605Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCICX%2BZzEwV7S7tK2Teu4enaTjTMNodN0T8CBwGyp3%2FdhpAiBcDP7u5XE0svrQAEReRRQSWfUQfGu9%2F0dDFi9HZXbFlSq0AwhUEAEaDDAxMzYxOTI3NDg0OSIMqovxw%2Fi0N89X43L%2FKpEDQix1tw9gEfEoYbXT5osPFpMOwfBuizjPU7n9OmST3GiDPuXEgYLvbvfAQGYte9YY2QoNfSH%2Bs3y1JVdVw8yUicjfLoFaEW6wkvABFFfNqnjSBFzSElON%2F%2B3j8UNBRmn2xcLmCFWjMnOAbTftnafIeYcBCAYh2gO4XfF%2FteefEF5baEqal82tljdlrWvxdb4xY%2BeiVvoO6eYgRa7kp50RAoYeprdo02AYM%2F61DJSrZXwMLYr6Xgv6MB1iMnaxJ5rMcXXMrHucVPXBHEcRWopMmQkkB%2FPc9SAPzXjSXPb7jJbEGBrLze60DYXEBrpIFUG1Kick24m%2B5k5jryTy4Jw50w8CXizU5ICguGu3KHM1om3lDn5KQPJLn1HdcT%2BsfoJiJu6SGt9hXKzCtCfUH3%2FFvhBtwm8JD87PMGYoEwVm%2FlNfMX0wjZsROXJIlnxZXImztW5C0Q8%2B8vUj4F7brk0S72obIPPXA9sraxsX4VqG%2BXQBK%2B1E%2BcproSDOuO49QLzWGa%2ByNqmZvUzlIRh6xUU3P5owvrOq%2FwU67AGtB67YYS3OrDI7mh5rocz4yCfx2WY%2BOcICeNC4fwRACHwc09Uiz%2FFPJoVVVUxZVu%2BGwd0PK0Cv2KxEe%2F6DbJ%2F4dqWms9lNmfzBIAqvj8iCblJU7lJE5gNjjGio7mXbIVYDlATJCq41LKJBckyAK5GaLf5E3hKwYqawTi1drEQoAWGm0MLdRWPWFAAmAH9lq7XnOuVzoaZV9I6BQOa6%2Bsw888c6CCB%2BW6%2Fs%2FWznBvXU9NUgtAV0VB3hWt7rH3AQXIkYZTG86Yk6TyvtNdyHfs%2FoRwKKnb1x1yTXlrvbtiAXPCAeCL0oqSsvNwFJhw%3D%3D\u0026X-Amz-Signature=7c58c6526a10375b6bb9a4e6afbb4e475bd609b3d85841c7563e3f62c240c121","file_size":221140,"type":"image/png"}],"allow_singular_disclosure_at":"2014-12-03T23:36:10.366Z","allow_singular_disclosure_after":-191570395.38659033,"singular_disclosure_allowed":true,"vote_count":35,"voters":["sat0shi","spam404","sameerphad72","youngsheldon","dilawer01","r3y","realtess","fantam1","japz","mr_jay","and 25 more..."],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":148984,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thank you for your report! We believe it may be a valid security issue and will investigate it further. It could take some time to find and update the root cause for an issue, so we thank you for your patience.\n\nThank you for helping keep Twitter secure!","markdown_message":"\u003cp\u003eThank you for your report! We believe it may be a valid security issue and will investigate it further. It could take some time to find and update the root cause for an issue, so we thank you for your patience.\u003c/p\u003e\n\n\u003cp\u003eThank you for helping keep Twitter secure!\u003c/p\u003e\n","automated_response":false,"created_at":"2014-10-27T17:51:38.942Z","updated_at":"2014-10-27T17:51:38.942Z","actor":{"username":"jcollins","cleared":false,"url":"/jcollins","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/114/d24b9beb256b432cb38b64b8e3620e03aef9332a_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":149025,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"We consider this issue to be fixed now. Can you please confirm?\n\nThank you for helping keep Twitter secure!","markdown_message":"\u003cp\u003eWe consider this issue to be fixed now. Can you please confirm?\u003c/p\u003e\n\n\u003cp\u003eThank you for helping keep Twitter secure!\u003c/p\u003e\n","automated_response":false,"created_at":"2014-10-27T18:15:42.853Z","updated_at":"2014-10-27T18:15:42.853Z","actor":{"username":"jcollins","cleared":false,"url":"/jcollins","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/114/d24b9beb256b432cb38b64b8e3620e03aef9332a_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"fransrosen","url":"/fransrosen"},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":149140,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi,\nYes! It is fixed, it does not resolve to anything anymore. Great work!","markdown_message":"\u003cp\u003eHi,\u003cbr\u003e\nYes! It is fixed, it does not resolve to anything anymore. Great work!\u003c/p\u003e\n","automated_response":false,"created_at":"2014-10-27T19:24:38.202Z","updated_at":"2014-10-27T19:24:38.202Z","actor":{"username":"fransrosen","cleared":true,"url":"/fransrosen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/634/6569f1cff6ac26c01a91db469d8707228965f09f_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":149169,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Great, thank you for a confirming. A bounty amount will be awarded at the end of the week.\n\nThanks again!","markdown_message":"\u003cp\u003eGreat, thank you for a confirming. A bounty amount will be awarded at the end of the week.\u003c/p\u003e\n\n\u003cp\u003eThanks again!\u003c/p\u003e\n","automated_response":false,"created_at":"2014-10-27T20:00:36.913Z","updated_at":"2014-10-27T20:00:36.913Z","actor":{"username":"jcollins","cleared":false,"url":"/jcollins","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/114/d24b9beb256b432cb38b64b8e3620e03aef9332a_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":153061,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks again for helping us keep Twitter safe and secure for our users!","markdown_message":"\u003cp\u003eThanks again for helping us keep Twitter safe and secure for our users!\u003c/p\u003e\n","automated_response":false,"created_at":"2014-11-03T16:43:19.048Z","updated_at":"2014-11-03T16:43:19.048Z","actor":{"url":"/twitter","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/061/85a63a443f017ad8353de4f68ebf52fdd61c345a_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Twitter"}},"bounty_amount":"1680.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"twitter","collaborator":{"username":"fransrosen","url":"/fransrosen"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":153278,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Hi, we are requesting public disclosure of this issue to encourage other whitehats to submit quality reports like yours!","markdown_message":"\u003cp\u003eHi, we are requesting public disclosure of this issue to encourage other whitehats to submit quality reports like yours!\u003c/p\u003e\n","automated_response":false,"created_at":"2014-11-03T23:36:10.078Z","updated_at":"2014-11-03T23:36:10.078Z","first_to_agree":true,"actor":{"username":"jcollins","cleared":false,"url":"/jcollins","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/114/d24b9beb256b432cb38b64b8e3620e03aef9332a_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":153279,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Sure! Btw, thanks alot!","markdown_message":"\u003cp\u003eSure! Btw, thanks alot!\u003c/p\u003e\n","automated_response":false,"created_at":"2014-11-03T23:37:25.754Z","updated_at":"2014-11-03T23:37:25.754Z","actor":{"username":"fransrosen","cleared":true,"url":"/fransrosen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/634/6569f1cff6ac26c01a91db469d8707228965f09f_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":153280,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2014-11-03T23:37:26.054Z","updated_at":"2014-11-03T23:37:26.054Z","actor":{"username":"fransrosen","cleared":true,"url":"/fransrosen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/634/6569f1cff6ac26c01a91db469d8707228965f09f_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}