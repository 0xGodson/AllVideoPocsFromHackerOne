{"id":48065,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC80ODA2NQ==","url":"https://hackerone.com/reports/48065","title":"open authentication bug","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2015-02-18T13:26:26.398Z","submitted_at":"2015-02-18T13:26:26.398Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"ckmk44","url":"/ckmk44","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":104,"url":"https://hackerone.com/coinbase","handle":"coinbase","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/104/b151e01a4adbf5ad9067fc30fb2dfe5d5997fa5c_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/104/b151e01a4adbf5ad9067fc30fb2dfe5d5997fa5c_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Coinbase","twitter_handle":"","website":"https://coinbase.com/security","about":"Creating an open financial system for the world"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2015-03-11T16:19:22.122Z","bug_reporter_agreed_on_going_public_at":"2015-03-11T15:51:31.204Z","team_member_agreed_on_going_public_at":"2015-03-11T16:19:21.041Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi,\r\nIf developer registers one of the three url's with out http protocol (ex:example.com) in oauth registration then he would be redirected to www.coinbase.comexample.com.This makes the user to redirect to another site than the real application.Attacker could take advantage of this and steal the token using that site as a medium.\r\nType:Oauth\r\nimpact:high\r\nauthentication:yes\r\nthis works if developer does a mistake but the vulnerability lies in the coinbase oauth.\r\nProof of concept:\r\nhttps://www.coinbase.com/oauth/authorize?response_type=code\u0026client_id=3616ab93541ef90540a0c991e113b22c1ccefa96996f70fcdc49a68d900cb761\u0026redirect_uri=prashanthvarma.in/code.php\u0026scope=user\r\n\r\nThank you,\r\nprashanth varma ","vulnerability_information_html":"\u003cp\u003eHi,\u003cbr\u003e\nIf developer registers one of the three url\u0026#39;s with out http protocol (ex:example.com) in oauth registration then he would be redirected to \u003ca href=\"/redirect?url=http%3A%2F%2Fwww.coinbase.comexample.com.this\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ewww.coinbase.comexample.com.This\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e makes the user to redirect to another site than the real application.Attacker could take advantage of this and steal the token using that site as a medium.\u003cbr\u003e\nType:Oauth\u003cbr\u003e\nimpact:high\u003cbr\u003e\nauthentication:yes\u003cbr\u003e\nthis works if developer does a mistake but the vulnerability lies in the coinbase oauth.\u003cbr\u003e\nProof of concept:\u003cbr\u003e\n\u003ca title=\"https://www.coinbase.com/oauth/authorize?response_type=code\u0026amp;client_id=3616ab93541ef90540a0c991e113b22c1ccefa96996f70fcdc49a68d900cb761\u0026amp;redirect_uri=prashanthvarma.in/code.php\u0026amp;scope=user\" href=\"/redirect?url=https%3A%2F%2Fwww.coinbase.com%2Foauth%2Fauthorize%3Fresponse_type%3Dcode%26client_id%3D3616ab93541ef90540a0c991e113b22c1ccefa96996f70fcdc49a68d900cb761%26redirect_uri%3Dprashanthvarma.in%2Fcode.php%26scope%3Duser\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.coinbase.com/oauth/authorize?response_type=code\u0026amp;client_id=3616ab93541ef90540a0c991e113b22c1ccefa96996f70fcdc49a68d900cb761\u0026amp;redirect_uri=prashanthvarma.in/code.php\u0026amp;scope=user\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eThank you,\u003cbr\u003e\nprashanth varma \u003c/p\u003e\n","bounty_amount":"100.0","formatted_bounty":"$100","weakness":{"id":27,"name":"Improper Authentication - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2015-04-10T15:51:32.119Z","allow_singular_disclosure_after":-180540801.8016364,"singular_disclosure_allowed":true,"vote_count":0,"voters":[],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":336318,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thank you for your submission, we will look into this and get back to you.","markdown_message":"\u003cp\u003eThank you for your submission, we will look into this and get back to you.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-02-20T21:55:59.146Z","updated_at":"2015-02-20T21:55:59.146Z","actor":{"username":"redsteve","cleared":false,"url":"/redsteve","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/007/436/70ebaee63eb8924e245bda9bd84923047c71cdeb_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":336337,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Thank you for your submission.  Could you give me more information on a possible attack scenario?  Once I click 'Authorize' it does indeed redirect me to a 'bad' address, but I'm not sure that I see the security impact.  Any attacker that did this on purpose would have to convince a user to give their app authorization in the first place.  And if a developer mistyped an address for the callback, they would likely catch it very quickly as the callback wouldn't be receiving any data.  This is a bug, but I don't know that it is a security issue.  I would love to hear your thoughts.","markdown_message":"\u003cp\u003eThank you for your submission.  Could you give me more information on a possible attack scenario?  Once I click \u0026#39;Authorize\u0026#39; it does indeed redirect me to a \u0026#39;bad\u0026#39; address, but I\u0026#39;m not sure that I see the security impact.  Any attacker that did this on purpose would have to convince a user to give their app authorization in the first place.  And if a developer mistyped an address for the callback, they would likely catch it very quickly as the callback wouldn\u0026#39;t be receiving any data.  This is a bug, but I don\u0026#39;t know that it is a security issue.  I would love to hear your thoughts.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-02-20T22:11:13.869Z","updated_at":"2015-02-20T22:11:13.869Z","actor":{"username":"redsteve","cleared":false,"url":"/redsteve","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/007/436/70ebaee63eb8924e245bda9bd84923047c71cdeb_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":336421,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Thanks for the reply .If the developer registers three uri's \nex:\n(with https)\nhttps://www.prashanthvarma.in/code.php\n(with http):\nhttp://www.prashanthvarma.in/code.php\n(without http and https):\nprashanthvarma.in/code.php\n\nnormal oauth applications automatically add the http:// tag without mentioning . The developer misses or stops using the third callback because he gets a https:// or for some reason.Attacker normally or luckily  finds that the callback is redirecting to some domain that is not registered then attacker registers the domain and steals the oauth code generated .This is a bug in some cases it is security issue.\n","markdown_message":"\u003cp\u003eThanks for the reply .If the developer registers three uri\u0026#39;s \u003cbr\u003e\nex:\u003cbr\u003e\n(with https)\u003cbr\u003e\n\u003ca title=\"https://www.prashanthvarma.in/code.php\" href=\"/redirect?url=https%3A%2F%2Fwww.prashanthvarma.in%2Fcode.php\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.prashanthvarma.in/code.php\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\n(with http):\u003cbr\u003e\n\u003ca title=\"http://www.prashanthvarma.in/code.php\" href=\"/redirect?url=http%3A%2F%2Fwww.prashanthvarma.in%2Fcode.php\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://www.prashanthvarma.in/code.php\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\n(without http and https):\u003cbr\u003e\nprashanthvarma.in/code.php\u003c/p\u003e\n\n\u003cp\u003enormal oauth applications automatically add the http:// tag without mentioning . The developer misses or stops using the third callback because he gets a https:// or for some reason.Attacker normally or luckily  finds that the callback is redirecting to some domain that is not registered then attacker registers the domain and steals the oauth code generated .This is a bug in some cases it is security issue.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-02-21T00:03:14.012Z","updated_at":"2015-02-21T00:12:28.384Z","actor":{"username":"ckmk44","cleared":false,"url":"/ckmk44","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":344676,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"We added some extra validation to make sure only absolute URIs can be used as redirect URIs. Can you confirm this issue is resolved?","markdown_message":"\u003cp\u003eWe added some extra validation to make sure only absolute URIs can be used as redirect URIs. Can you confirm this issue is resolved?\u003c/p\u003e\n","automated_response":false,"created_at":"2015-03-02T21:34:22.002Z","updated_at":"2015-03-02T21:34:22.002Z","actor":{"username":"coinbase2","cleared":false,"url":"/coinbase2","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":345742,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"yeah this issue is resolved and it is a good patch","markdown_message":"\u003cp\u003eyeah this issue is resolved and it is a good patch\u003c/p\u003e\n","automated_response":false,"created_at":"2015-03-04T09:49:06.550Z","updated_at":"2015-03-04T09:49:06.550Z","actor":{"username":"ckmk44","cleared":false,"url":"/ckmk44","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":351116,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2015-03-11T14:44:42.247Z","updated_at":"2015-03-11T14:44:42.247Z","actor":{"username":"coinbase2","cleared":false,"url":"/coinbase2","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"ckmk44","url":"/ckmk44"},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":351117,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2015-03-11T14:44:52.353Z","updated_at":"2015-03-11T14:44:52.353Z","actor":{"url":"/coinbase","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/104/b151e01a4adbf5ad9067fc30fb2dfe5d5997fa5c_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Coinbase"}},"bounty_amount":"100.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"coinbase","collaborator":{"username":"ckmk44","url":"/ckmk44"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":351189,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-03-11T15:51:31.282Z","updated_at":"2015-03-11T15:51:31.282Z","first_to_agree":true,"actor":{"username":"ckmk44","cleared":false,"url":"/ckmk44","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":351226,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-03-11T16:19:21.076Z","updated_at":"2015-03-11T16:19:21.076Z","actor":{"username":"coinbase2","cleared":false,"url":"/coinbase2","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":351227,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-03-11T16:19:22.156Z","updated_at":"2015-03-11T16:19:22.156Z","actor":{"username":"coinbase2","cleared":false,"url":"/coinbase2","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}