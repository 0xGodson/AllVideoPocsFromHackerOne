{"id":1048457,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMDQ4NDU3","url":"https://hackerone.com/reports/1048457","title":"CVE-2020-8286: Inferior OCSP verification","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2020-12-01T20:53:56.493Z","submitted_at":"2020-12-01T20:53:56.556Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"ospoco","url":"/ospoco","profile_picture_urls":{"small":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/ju3m9hfzkrsetxlsoewj0rkxq9pu/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a?response-content-disposition=inline%3B%20filename%3D%22logo_500.jpg%22%3B%20filename%2A%3DUTF-8%27%27logo_500.jpg\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQVN4C5GIR%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T041349Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCICjdrX7ABZ%2BvfX76vY4hAT36HAFa7ABTRFnFNWlME3RsAiA6spUqHGGbpGIJMpDYYPRLrN21uLj3JvPgDLV04KLXWCq0AwhSEAEaDDAxMzYxOTI3NDg0OSIM%2BwbYtZgzO0HRNuilKpED0QRzghA3dQ82LDNvNHg%2F%2Bapjkbzzquj0OQyaslf6lhZ6ae5aaEALaU1htc90%2FTkEnCjK7YAB%2BOOqYauHnXFwgnicH8P2qB1b6qq8ByPdiyv%2F6FeKLaeKEKd1ked0wxhxGILfvv9geWvP9kPkCkrnpW%2Bk3I2nWFhXQ59oSwcUQzXUMoZ0agtptlqAo0vIB0BQ8w3QdM1eyZALy%2Fa2aEoAk0NEEkFhGgVq6y7NSlne0HYNYsnTubU1gtBiWgKFN75WWxAKzP41DZr9biaTv2LpKz%2BS54%2B0D7gM01Pv9DWNFSxduldCjFNWMHaz53TpINKZivByzZ%2FZritkdAHNoYR8NUHdDo4fG9KADtaMgItKYoCYS9dQ3VQKUnEB%2FG5XIqiEWJNuiVPw9Xo1zZJ7ItciKJ%2F2lZOYbSY5IWLtOLK3LAXfBln%2BqWM6KN%2BYSgAqj80OMMoKJozuCJRCLPgT%2BsuXVxgkfPMjWm0msUwRdOuNqAG3PPIFx7Qi20ur1fS33s63LIR24RY3pe1aeEm14DkixQAwqvyp%2FwU67AFUTZKxgkosuC9%2FFnLTDWAcFKkGbWeTSyQlX9WvARJtmEGSKKE3O3RCz4o1fvK2y8cIWG4ZDqIQnnY30DkA5lvQ1S96196eUcIlxUE3IU6WzlYzirsAJvCXzxdcKxl0gn59sA3vLFJkUTgoas7IMyJTtRG6%2B0%2BVBuYKCHqJR1eTwSQxZvSP%2Bzn9VyHRQJZnA1hWcpkteF706gKj%2FXnieX9VW%2FOBOoEUExU1kfEmA0ZpoQRXSm8ma7vzsQoYhwoevAvKutaOvkhM8WM71tgT1%2FjC27FmA%2F%2FsDsAjQs2Rv9IujFElYACO0n6OSheOZw%3D%3D\u0026X-Amz-Signature=908db7936a35ed438102c6126c75a5d175c4fc7daa3168459e74694448d2274c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":35663,"url":"https://hackerone.com/curl","handle":"curl","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/035/663/2faf4c279d437d64bfda6d23d62ce1833813a4d9_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/035/663/2faf4c279d437d64bfda6d23d62ce1833813a4d9_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"curl","twitter_handle":"","website":"https://curl.se","about":"cURL is a computer software project providing a library and command-line tool for transferring data using various protocols."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":["CVE-2020-8286"],"singular_disclosure_disabled":false,"disclosed_at":"2020-12-09T14:26:33.412Z","bug_reporter_agreed_on_going_public_at":"2020-12-09T14:26:33.342Z","team_member_agreed_on_going_public_at":"2020-12-09T07:49:33.480Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"cURL (in /lib/vtls/openssl.c) does not check that the certificate serial number in the stapled OCSP response matches the serial number of the certificate it is trying to validate (the peer certificate). This results in a passed validity challenge even when connecting to a site that has had its certificate revoked.\n An example program showing the vulnerability and a suggested patch are included.\n\nEXAMPLE: \n1. Identify a site with a revoked certificate. (https://revoked.grc.com) \n2. Obtain a valid OCSP response for a site signed by the same issuer as \n   the revoked site. (https://www.grc.com). See \n   https://akshayranganath.github.io/OCSP-Validation-With-Openssl/ for a \n   how-to. Use the ocsp option 'respout' to obtain the DER encoded OCSP \n   response. \n   Certificates for www.grc.com are provided. Use the following \n   command to obtain an OCSP response for the example certificates: \n   $ openssl ocsp -issuer grc_chain.pem -cert grc_cert.pem -text -url http://ocsp.digicert.com -respout grc_ocsp_resp.der \n3. See the OCSP behavior without replacing the OCSP response: \n     $ ./curl_ocsp_vuln_test https://revoked.grc.com \n     Curl Error: SSL server certificate status verification FAILED \n   Curl correctly fails. \n4. See the OCSP behavior when replacing the OCSP response with that \n   from www.grc.com: \n     $ ./curl_ocsp_vuln_test https://revoked.grc.com --replace_ocsp grc_ocsp_resp.der \n     \u003c!DOCTYPE html PUBLIC... \n   \nThe result is that cURL succeeds despite the site having a revoked certificate.\n\n## Impact\n\nCertificates are usually revoked because important information, such as the private key, has become known. This could allow an attacker to cause a \"validated\" connection to an attacker-controlled site by substituting the OCSP response.","vulnerability_information_html":"\u003cp\u003ecURL (in /lib/vtls/openssl.c) does not check that the certificate serial number in the stapled OCSP response matches the serial number of the certificate it is trying to validate (the peer certificate). This results in a passed validity challenge even when connecting to a site that has had its certificate revoked.\u003cbr\u003e\n An example program showing the vulnerability and a suggested patch are included.\u003c/p\u003e\n\n\u003cp\u003eEXAMPLE: \u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eIdentify a site with a revoked certificate. (\u003ca title=\"https://revoked.grc.com\" href=\"/redirect?url=https%3A%2F%2Frevoked.grc.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://revoked.grc.com\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e) \u003c/li\u003e\n\u003cli\u003eObtain a valid OCSP response for a site signed by the same issuer as \nthe revoked site. (\u003ca title=\"https://www.grc.com\" href=\"/redirect?url=https%3A%2F%2Fwww.grc.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.grc.com\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e). See \n\u003ca title=\"https://akshayranganath.github.io/OCSP-Validation-With-Openssl/\" href=\"/redirect?url=https%3A%2F%2Fakshayranganath.github.io%2FOCSP-Validation-With-Openssl%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://akshayranganath.github.io/OCSP-Validation-With-Openssl/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e for a \nhow-to. Use the ocsp option \u0026#39;respout\u0026#39; to obtain the DER encoded OCSP \nresponse. \nCertificates for \u003ca href=\"/redirect?url=http%3A%2F%2Fwww.grc.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ewww.grc.com\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e are provided. Use the following \ncommand to obtain an OCSP response for the example certificates: \n$ openssl ocsp -issuer grc_chain.pem -cert grc_cert.pem -text -url \u003ca title=\"http://ocsp.digicert.com\" href=\"/redirect?url=http%3A%2F%2Focsp.digicert.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://ocsp.digicert.com\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e -respout grc_ocsp_resp.der \u003c/li\u003e\n\u003cli\u003eSee the OCSP behavior without replacing the OCSP response: \n $ ./curl_ocsp_vuln_test \u003ca title=\"https://revoked.grc.com\" href=\"/redirect?url=https%3A%2F%2Frevoked.grc.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://revoked.grc.com\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e \n Curl Error: SSL server certificate status verification FAILED \nCurl correctly fails. \u003c/li\u003e\n\u003cli\u003eSee the OCSP behavior when replacing the OCSP response with that \nfrom \u003ca href=\"/redirect?url=http%3A%2F%2Fwww.grc.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ewww.grc.com:\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e \n $ ./curl_ocsp_vuln_test \u003ca title=\"https://revoked.grc.com\" href=\"/redirect?url=https%3A%2F%2Frevoked.grc.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://revoked.grc.com\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e --replace_ocsp grc_ocsp_resp.der \n \u0026lt;!DOCTYPE html PUBLIC... \u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eThe result is that cURL succeeds despite the site having a revoked certificate.\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eCertificates are usually revoked because important information, such as the private key, has become known. This could allow an attacker to cause a \u0026quot;validated\u0026quot; connection to an attacker-controlled site by substituting the OCSP response.\u003c/p\u003e\n","bounty_amount":"900.0","formatted_bounty":"$900","weakness":{"id":28,"name":"Improper Certificate Validation"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":1100327,"file_name":"curl_ocsp_vuln.zip","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/pfoker9t3z7mm4uul1p28oehi53w?response-content-disposition=attachment%3B%20filename%3D%22curl_ocsp_vuln.zip%22%3B%20filename%2A%3DUTF-8%27%27curl_ocsp_vuln.zip\u0026response-content-type=application%2Fzip\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQVN4C5GIR%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T041349Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCICjdrX7ABZ%2BvfX76vY4hAT36HAFa7ABTRFnFNWlME3RsAiA6spUqHGGbpGIJMpDYYPRLrN21uLj3JvPgDLV04KLXWCq0AwhSEAEaDDAxMzYxOTI3NDg0OSIM%2BwbYtZgzO0HRNuilKpED0QRzghA3dQ82LDNvNHg%2F%2Bapjkbzzquj0OQyaslf6lhZ6ae5aaEALaU1htc90%2FTkEnCjK7YAB%2BOOqYauHnXFwgnicH8P2qB1b6qq8ByPdiyv%2F6FeKLaeKEKd1ked0wxhxGILfvv9geWvP9kPkCkrnpW%2Bk3I2nWFhXQ59oSwcUQzXUMoZ0agtptlqAo0vIB0BQ8w3QdM1eyZALy%2Fa2aEoAk0NEEkFhGgVq6y7NSlne0HYNYsnTubU1gtBiWgKFN75WWxAKzP41DZr9biaTv2LpKz%2BS54%2B0D7gM01Pv9DWNFSxduldCjFNWMHaz53TpINKZivByzZ%2FZritkdAHNoYR8NUHdDo4fG9KADtaMgItKYoCYS9dQ3VQKUnEB%2FG5XIqiEWJNuiVPw9Xo1zZJ7ItciKJ%2F2lZOYbSY5IWLtOLK3LAXfBln%2BqWM6KN%2BYSgAqj80OMMoKJozuCJRCLPgT%2BsuXVxgkfPMjWm0msUwRdOuNqAG3PPIFx7Qi20ur1fS33s63LIR24RY3pe1aeEm14DkixQAwqvyp%2FwU67AFUTZKxgkosuC9%2FFnLTDWAcFKkGbWeTSyQlX9WvARJtmEGSKKE3O3RCz4o1fvK2y8cIWG4ZDqIQnnY30DkA5lvQ1S96196eUcIlxUE3IU6WzlYzirsAJvCXzxdcKxl0gn59sA3vLFJkUTgoas7IMyJTtRG6%2B0%2BVBuYKCHqJR1eTwSQxZvSP%2Bzn9VyHRQJZnA1hWcpkteF706gKj%2FXnieX9VW%2FOBOoEUExU1kfEmA0ZpoQRXSm8ma7vzsQoYhwoevAvKutaOvkhM8WM71tgT1%2FjC27FmA%2F%2FsDsAjQs2Rv9IujFElYACO0n6OSheOZw%3D%3D\u0026X-Amz-Signature=01e40efd8832c33a985fe68b09fdccb6a8ef6ccfa4923f47fc40b69c2818c316","file_size":8414,"type":"application/zip"}],"allow_singular_disclosure_at":"2021-01-08T07:49:33.551Z","allow_singular_disclosure_after":876943.679200487,"singular_disclosure_allowed":false,"vote_count":47,"voters":["sw33tlie","mygf","balerion","mainteemoforfun","realtess","exploit_db","h4x0r-dz","abdullahrehman2","h1-qualys-scan","hallbryght","and 37 more..."],"severity":{"rating":"medium","score":6.6,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"high","privileges_required":"high","user_interaction":"none","scope":"unchanged","confidentiality":"high","integrity":"high","availability":"high"}},"structured_scope":{"databaseId":18844,"asset_type":"SOURCE_CODE","asset_identifier":"https://github.com/curl/curl","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":9985738,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks! We will investigate.","markdown_message":"\u003cp\u003eThanks! We will investigate.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-12-02T14:53:08.340Z","updated_at":"2020-12-02T14:53:08.340Z","actor":{"username":"bagder","cleared":false,"url":"/bagder","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/459/380/963f64725677dda4f5113219588e7d0c1ab9abaa_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9989156,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"We're just 7 days away from the next release, this might be tough to make a fix for before then. If not, we need to consider that next.\n\n@ospoco, do you happen to have a proposed fix for this issue?\n\nAlso, I feel a bit lost in the OCSP (stapling) specs, but do you have any pointer to the details on how a client should verify the serial number as you mention here?\n\nI figure my next step will be to check out the code for this in the openssl tool. I presume it has code for this somewhere.","markdown_message":"\u003cp\u003eWe\u0026#39;re just 7 days away from the next release, this might be tough to make a fix for before then. If not, we need to consider that next.\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"/ospoco\"\u003e@ospoco\u003c/a\u003e, do you happen to have a proposed fix for this issue?\u003c/p\u003e\n\n\u003cp\u003eAlso, I feel a bit lost in the OCSP (stapling) specs, but do you have any pointer to the details on how a client should verify the serial number as you mention here?\u003c/p\u003e\n\n\u003cp\u003eI figure my next step will be to check out the code for this in the openssl tool. I presume it has code for this somewhere.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-12-02T21:30:17.890Z","updated_at":"2020-12-02T21:30:17.890Z","actor":{"username":"bagder","cleared":false,"url":"/bagder","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/459/380/963f64725677dda4f5113219588e7d0c1ab9abaa_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9989272,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @bagder, I don't know if you were able to download the attached zip file. It has a proposed patch that fixes the issue. If not I can inline it or attach it separately.\n\nThe OpenSSL OCSP logic seems correct. The issue is that the information provided in the OCSP response is not used correctly. It only checks for a valid response from the same domain, not that the valid response corresponds to the certificate provided.\n\nThe core of the patch is this:\n```\n+  // Find the single OCSP response corresponding to the certificate ID\n+  ret = OCSP_resp_find_status(br, id, \u0026cert_status, \u0026crl_reason, \u0026rev, \u0026thisupd,\n+                              \u0026nextupd);\n+  OCSP_CERTID_free(id);\n+  if (ret != 1) {\n+    failf(data, \"Could not find certificate ID in OCSP response\");\n+    result = CURLE_SSL_INVALIDCERTSTATUS;\n+    goto end;\n+  }\n \n+  // Validate the corresponding single OCSP response\n+  if(!OCSP_check_validity(thisupd, nextupd, 300L, -1L)) {\n+    failf(data, \"OCSP response has expired\"); \n+    result = CURLE_SSL_INVALIDCERTSTATUS;\n+    goto end;\n+  }\n```","markdown_message":"\u003cp\u003eHi \u003ca href=\"/bagder\"\u003e@bagder\u003c/a\u003e, I don\u0026#39;t know if you were able to download the attached zip file. It has a proposed patch that fixes the issue. If not I can inline it or attach it separately.\u003c/p\u003e\n\n\u003cp\u003eThe OpenSSL OCSP logic seems correct. The issue is that the information provided in the OCSP response is not used correctly. It only checks for a valid response from the same domain, not that the valid response corresponds to the certificate provided.\u003c/p\u003e\n\n\u003cp\u003eThe core of the patch is this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e+  // Find the single OCSP response corresponding to the certificate ID\n+  ret = OCSP_resp_find_status(br, id, \u0026amp;cert_status, \u0026amp;crl_reason, \u0026amp;rev, \u0026amp;thisupd,\n+                              \u0026amp;nextupd);\n+  OCSP_CERTID_free(id);\n+  if (ret != 1) {\n+    failf(data, \u0026quot;Could not find certificate ID in OCSP response\u0026quot;);\n+    result = CURLE_SSL_INVALIDCERTSTATUS;\n+    goto end;\n+  }\n\n+  // Validate the corresponding single OCSP response\n+  if(!OCSP_check_validity(thisupd, nextupd, 300L, -1L)) {\n+    failf(data, \u0026quot;OCSP response has expired\u0026quot;); \n+    result = CURLE_SSL_INVALIDCERTSTATUS;\n+    goto end;\n+  }\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","automated_response":false,"created_at":"2020-12-02T21:52:30.203Z","updated_at":"2020-12-02T21:52:30.203Z","actor":{"username":"ospoco","cleared":false,"url":"/ospoco","profile_picture_urls":{"medium":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/ju3m9hfzkrsetxlsoewj0rkxq9pu/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5?response-content-disposition=inline%3B%20filename%3D%22logo_500.jpg%22%3B%20filename%2A%3DUTF-8%27%27logo_500.jpg\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQVN4C5GIR%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T041349Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCICjdrX7ABZ%2BvfX76vY4hAT36HAFa7ABTRFnFNWlME3RsAiA6spUqHGGbpGIJMpDYYPRLrN21uLj3JvPgDLV04KLXWCq0AwhSEAEaDDAxMzYxOTI3NDg0OSIM%2BwbYtZgzO0HRNuilKpED0QRzghA3dQ82LDNvNHg%2F%2Bapjkbzzquj0OQyaslf6lhZ6ae5aaEALaU1htc90%2FTkEnCjK7YAB%2BOOqYauHnXFwgnicH8P2qB1b6qq8ByPdiyv%2F6FeKLaeKEKd1ked0wxhxGILfvv9geWvP9kPkCkrnpW%2Bk3I2nWFhXQ59oSwcUQzXUMoZ0agtptlqAo0vIB0BQ8w3QdM1eyZALy%2Fa2aEoAk0NEEkFhGgVq6y7NSlne0HYNYsnTubU1gtBiWgKFN75WWxAKzP41DZr9biaTv2LpKz%2BS54%2B0D7gM01Pv9DWNFSxduldCjFNWMHaz53TpINKZivByzZ%2FZritkdAHNoYR8NUHdDo4fG9KADtaMgItKYoCYS9dQ3VQKUnEB%2FG5XIqiEWJNuiVPw9Xo1zZJ7ItciKJ%2F2lZOYbSY5IWLtOLK3LAXfBln%2BqWM6KN%2BYSgAqj80OMMoKJozuCJRCLPgT%2BsuXVxgkfPMjWm0msUwRdOuNqAG3PPIFx7Qi20ur1fS33s63LIR24RY3pe1aeEm14DkixQAwqvyp%2FwU67AFUTZKxgkosuC9%2FFnLTDWAcFKkGbWeTSyQlX9WvARJtmEGSKKE3O3RCz4o1fvK2y8cIWG4ZDqIQnnY30DkA5lvQ1S96196eUcIlxUE3IU6WzlYzirsAJvCXzxdcKxl0gn59sA3vLFJkUTgoas7IMyJTtRG6%2B0%2BVBuYKCHqJR1eTwSQxZvSP%2Bzn9VyHRQJZnA1hWcpkteF706gKj%2FXnieX9VW%2FOBOoEUExU1kfEmA0ZpoQRXSm8ma7vzsQoYhwoevAvKutaOvkhM8WM71tgT1%2FjC27FmA%2F%2FsDsAjQs2Rv9IujFElYACO0n6OSheOZw%3D%3D\u0026X-Amz-Signature=1bd6d908444d904108af34aac181b9f2c6a8ae58150ec5062dc62c32599203f5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9989306,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks, my mistake. I didn't check the zip file until now.","markdown_message":"\u003cp\u003eThanks, my mistake. I didn\u0026#39;t check the zip file until now.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-12-02T22:00:21.292Z","updated_at":"2020-12-02T22:00:21.292Z","actor":{"username":"bagder","cleared":false,"url":"/bagder","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/459/380/963f64725677dda4f5113219588e7d0c1ab9abaa_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9989337,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Here's @ospoco's patch, just ever so slightly edited to comply with 'checksrc' but with no changes to the logic.","markdown_message":"\u003cp\u003eHere\u0026#39;s \u003ca href=\"/ospoco\"\u003e@ospoco\u003c/a\u003e\u0026#39;s patch, just ever so slightly edited to comply with \u0026#39;checksrc\u0026#39; but with no changes to the logic.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-12-02T22:06:32.864Z","updated_at":"2020-12-02T22:06:32.864Z","actor":{"username":"bagder","cleared":false,"url":"/bagder","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/459/380/963f64725677dda4f5113219588e7d0c1ab9abaa_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"attachments":[{"id":1101829,"filename":"0001-openssl-make-the-OCSP-verification-verify-the-certif.patch","type":"text/x-patch","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/c0z96wxjp8dqxcz2ai5zrkqwqzp9?response-content-disposition=attachment%3B%20filename%3D%220001-openssl-make-the-OCSP-verification-verify-the-certif.patch%22%3B%20filename%2A%3DUTF-8%27%270001-openssl-make-the-OCSP-verification-verify-the-certif.patch\u0026response-content-type=text%2Fx-patch\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQVN4C5GIR%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T041349Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCICjdrX7ABZ%2BvfX76vY4hAT36HAFa7ABTRFnFNWlME3RsAiA6spUqHGGbpGIJMpDYYPRLrN21uLj3JvPgDLV04KLXWCq0AwhSEAEaDDAxMzYxOTI3NDg0OSIM%2BwbYtZgzO0HRNuilKpED0QRzghA3dQ82LDNvNHg%2F%2Bapjkbzzquj0OQyaslf6lhZ6ae5aaEALaU1htc90%2FTkEnCjK7YAB%2BOOqYauHnXFwgnicH8P2qB1b6qq8ByPdiyv%2F6FeKLaeKEKd1ked0wxhxGILfvv9geWvP9kPkCkrnpW%2Bk3I2nWFhXQ59oSwcUQzXUMoZ0agtptlqAo0vIB0BQ8w3QdM1eyZALy%2Fa2aEoAk0NEEkFhGgVq6y7NSlne0HYNYsnTubU1gtBiWgKFN75WWxAKzP41DZr9biaTv2LpKz%2BS54%2B0D7gM01Pv9DWNFSxduldCjFNWMHaz53TpINKZivByzZ%2FZritkdAHNoYR8NUHdDo4fG9KADtaMgItKYoCYS9dQ3VQKUnEB%2FG5XIqiEWJNuiVPw9Xo1zZJ7ItciKJ%2F2lZOYbSY5IWLtOLK3LAXfBln%2BqWM6KN%2BYSgAqj80OMMoKJozuCJRCLPgT%2BsuXVxgkfPMjWm0msUwRdOuNqAG3PPIFx7Qi20ur1fS33s63LIR24RY3pe1aeEm14DkixQAwqvyp%2FwU67AFUTZKxgkosuC9%2FFnLTDWAcFKkGbWeTSyQlX9WvARJtmEGSKKE3O3RCz4o1fvK2y8cIWG4ZDqIQnnY30DkA5lvQ1S96196eUcIlxUE3IU6WzlYzirsAJvCXzxdcKxl0gn59sA3vLFJkUTgoas7IMyJTtRG6%2B0%2BVBuYKCHqJR1eTwSQxZvSP%2Bzn9VyHRQJZnA1hWcpkteF706gKj%2FXnieX9VW%2FOBOoEUExU1kfEmA0ZpoQRXSm8ma7vzsQoYhwoevAvKutaOvkhM8WM71tgT1%2FjC27FmA%2F%2FsDsAjQs2Rv9IujFElYACO0n6OSheOZw%3D%3D\u0026X-Amz-Signature=005c44edf676ef87c1f8b3cd4d85ed6ee777a61a745702aa982ec77e615a1a40"}],"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9989376,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":null,"markdown_message":"","automated_response":false,"created_at":"2020-12-02T22:13:39.035Z","updated_at":"2020-12-02T22:13:39.035Z","additional_data":{"old_severity":"High","new_severity":"Medium (6.6)","old_severity_id":921625,"new_severity_id":922631},"actor":{"username":"bagder","cleared":false,"url":"/bagder","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/459/380/963f64725677dda4f5113219588e7d0c1ab9abaa_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9989385,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I used the CVSS calculator to update the severity, and I think a 6.6 score seems accurate.\n\nIt can also be noted that this is only an attack on libcurl when `CURLOPT_SSL_VERIFYSTATUS` is set by the application, which it isn't by default.","markdown_message":"\u003cp\u003eI used the CVSS calculator to update the severity, and I think a 6.6 score seems accurate.\u003c/p\u003e\n\n\u003cp\u003eIt can also be noted that this is only an attack on libcurl when \u003ccode\u003eCURLOPT_SSL_VERIFYSTATUS\u003c/code\u003e is set by the application, which it isn\u0026#39;t by default.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-12-02T22:15:33.499Z","updated_at":"2020-12-02T22:15:33.499Z","actor":{"username":"bagder","cleared":false,"url":"/bagder","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/459/380/963f64725677dda4f5113219588e7d0c1ab9abaa_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9989561,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"While awaiting possible responses from my security team mates, I wrote up a first advisory draft. In an attempt to get this fixed in the 7.74.0 release next week.\n\n@ospoco: let me know how you want to get credited in the advisory.\n\n---\n\nInferior OCSP verification\n==========================\n\nProject curl Security Advisory, December 9th 2020 -\n[Permalink](https://curl.se/docs/CVE-2020-XXXX.html)\n\nVULNERABILITY\n-------------\n\nlibcurl offers \"OCSP stapling\" via the `CURLOPT_SSL_VERIFYSTATUS` option. When\nset, libcurl verifies the OCSP response that a server responds with as part of\nthe TLS handshake. It then aborts the TLS negotiation of something is wrong\nwith the response. The same feature can be enabled with `--cert-status` using\nthe curl tool.\n\nAs part of the OCSP response verification, a client should verify that the\nresponse is indeed set out for the correct certficate. This step was not\nperformed by libcurl when built or told to use OpenSSL as TLS backend.\n\nThis flaw would allow an attacker, who perhaps could have breached a TLS\nserver, to provide a fraudulent OCSP response that would appear fine, instead\nof the real one. Like if the original certificate actually has been revoked.\n\nWe are not aware of any exploit of this flaw.\n\nINFO\n----\n\nThis flaw has existed in curl since commit\n[d1cf5d570663d](https://github.com/curl/curl/commit/d1cf5d570663d) in curl\n7.41.0.\n\nThe vulnerability is present only if OpenSSL is the designated TLS backend.\nOCSP stapling is not enabled by default by libcurl, it needs to be explicitly\nenabled by the application to get used.\n\nOCSP Stapling can be used with any of the TLS based protocols curl supports,\nincluding HTTPS, FTPS, SMTPS, POP3S, IMAPS, HTTPS-proxy and more.\n\nThe Common Vulnerabilities and Exposures (CVE) project has assigned the name\nCVE-2020-XXXX to this issue.\n\nCWE-299: Improper Check for Certificate Revocation\n\nSeverity: Medium\n\nAFFECTED VERSIONS\n-----------------\n\n- Affected versions: libcurl 7.41.0 to and including 7.73.0\n- Not affected versions: libcurl \u003c 7.41.0 and libcurl \u003e= 7.74.0\n\nAlso note that libcurl is used by many applications, and not always\nadvertised as such.\n\nTHE SOLUTION\n------------\n\nThe OCSP response checker function now also verifies that the certificate id\nis the correct one.\n\nA [fix for CVE-2020-XXXX](https://curl.se/.patch)\n\nRECOMMENDATIONS\n--------------\n\nWe suggest you take one of the following actions immediately, in order of\npreference:\n\n A - Upgrade curl to version 7.74.0\n\n B - Maybe use GnuTLS as a backend ?\n \n C - backport the patch to your curl version\n\nTIMELINE\n--------\n\nThis issue was first reported to the curl project on December 2, 2020.\n\nThis advisory was posted on December 9th 2020.\n\nCREDITS\n-------\n\nThis issue was initially reported by XXXXX. Patch by XXXXX.\n\nThanks a lot!\n\n","markdown_message":"\u003cp\u003eWhile awaiting possible responses from my security team mates, I wrote up a first advisory draft. In an attempt to get this fixed in the 7.74.0 release next week.\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"/ospoco\"\u003e@ospoco\u003c/a\u003e: let me know how you want to get credited in the advisory.\u003c/p\u003e\n\n\u003chr\u003e\n\n\u003ch1 id=\"inferior-ocsp-verification\"\u003eInferior OCSP verification\u003c/h1\u003e\n\n\u003cp\u003eProject curl Security Advisory, December 9th 2020 -\u003cbr\u003e\n\u003ca href=\"/redirect?url=https%3A%2F%2Fcurl.se%2Fdocs%2FCVE-2020-XXXX.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ePermalink\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2 id=\"vulnerability\"\u003eVULNERABILITY\u003c/h2\u003e\n\n\u003cp\u003elibcurl offers \u0026quot;OCSP stapling\u0026quot; via the \u003ccode\u003eCURLOPT_SSL_VERIFYSTATUS\u003c/code\u003e option. When\u003cbr\u003e\nset, libcurl verifies the OCSP response that a server responds with as part of\u003cbr\u003e\nthe TLS handshake. It then aborts the TLS negotiation of something is wrong\u003cbr\u003e\nwith the response. The same feature can be enabled with \u003ccode\u003e--cert-status\u003c/code\u003e using\u003cbr\u003e\nthe curl tool.\u003c/p\u003e\n\n\u003cp\u003eAs part of the OCSP response verification, a client should verify that the\u003cbr\u003e\nresponse is indeed set out for the correct certficate. This step was not\u003cbr\u003e\nperformed by libcurl when built or told to use OpenSSL as TLS backend.\u003c/p\u003e\n\n\u003cp\u003eThis flaw would allow an attacker, who perhaps could have breached a TLS\u003cbr\u003e\nserver, to provide a fraudulent OCSP response that would appear fine, instead\u003cbr\u003e\nof the real one. Like if the original certificate actually has been revoked.\u003c/p\u003e\n\n\u003cp\u003eWe are not aware of any exploit of this flaw.\u003c/p\u003e\n\n\u003ch2 id=\"info\"\u003eINFO\u003c/h2\u003e\n\n\u003cp\u003eThis flaw has existed in curl since commit\u003cbr\u003e\n\u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fcurl%2Fcurl%2Fcommit%2Fd1cf5d570663d\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ed1cf5d570663d\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e in curl\u003cbr\u003e\n7.41.0.\u003c/p\u003e\n\n\u003cp\u003eThe vulnerability is present only if OpenSSL is the designated TLS backend.\u003cbr\u003e\nOCSP stapling is not enabled by default by libcurl, it needs to be explicitly\u003cbr\u003e\nenabled by the application to get used.\u003c/p\u003e\n\n\u003cp\u003eOCSP Stapling can be used with any of the TLS based protocols curl supports,\u003cbr\u003e\nincluding HTTPS, FTPS, SMTPS, POP3S, IMAPS, HTTPS-proxy and more.\u003c/p\u003e\n\n\u003cp\u003eThe Common Vulnerabilities and Exposures (CVE) project has assigned the name\u003cbr\u003e\nCVE-2020-XXXX to this issue.\u003c/p\u003e\n\n\u003cp\u003eCWE-299: Improper Check for Certificate Revocation\u003c/p\u003e\n\n\u003cp\u003eSeverity: Medium\u003c/p\u003e\n\n\u003ch2 id=\"affected-versions\"\u003eAFFECTED VERSIONS\u003c/h2\u003e\n\n\u003cul\u003e\n\u003cli\u003eAffected versions: libcurl 7.41.0 to and including 7.73.0\u003c/li\u003e\n\u003cli\u003eNot affected versions: libcurl \u0026lt; 7.41.0 and libcurl \u0026gt;= 7.74.0\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eAlso note that libcurl is used by many applications, and not always\u003cbr\u003e\nadvertised as such.\u003c/p\u003e\n\n\u003ch2 id=\"the-solution\"\u003eTHE SOLUTION\u003c/h2\u003e\n\n\u003cp\u003eThe OCSP response checker function now also verifies that the certificate id\u003cbr\u003e\nis the correct one.\u003c/p\u003e\n\n\u003cp\u003eA \u003ca href=\"/redirect?url=https%3A%2F%2Fcurl.se%2F.patch\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003efix for CVE-2020-XXXX\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2 id=\"recommendations\"\u003eRECOMMENDATIONS\u003c/h2\u003e\n\n\u003cp\u003eWe suggest you take one of the following actions immediately, in order of\u003cbr\u003e\npreference:\u003c/p\u003e\n\n\u003cp\u003eA - Upgrade curl to version 7.74.0\u003c/p\u003e\n\n\u003cp\u003eB - Maybe use GnuTLS as a backend ?\u003c/p\u003e\n\n\u003cp\u003eC - backport the patch to your curl version\u003c/p\u003e\n\n\u003ch2 id=\"timeline\"\u003eTIMELINE\u003c/h2\u003e\n\n\u003cp\u003eThis issue was first reported to the curl project on December 2, 2020.\u003c/p\u003e\n\n\u003cp\u003eThis advisory was posted on December 9th 2020.\u003c/p\u003e\n\n\u003ch2 id=\"credits\"\u003eCREDITS\u003c/h2\u003e\n\n\u003cp\u003eThis issue was initially reported by XXXXX. Patch by XXXXX.\u003c/p\u003e\n\n\u003cp\u003eThanks a lot!\u003c/p\u003e\n","automated_response":false,"created_at":"2020-12-02T22:44:36.135Z","updated_at":"2020-12-02T22:44:36.135Z","actor":{"username":"bagder","cleared":false,"url":"/bagder","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/459/380/963f64725677dda4f5113219588e7d0c1ab9abaa_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9989717,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@bagder: Could you say:\n\nThis issue was identified by an Ospoco customer who wishes to remain anonymous and reported by Ospoco (https://ospo.co).","markdown_message":"\u003cp\u003e\u003ca href=\"/bagder\"\u003e@bagder\u003c/a\u003e: Could you say:\u003c/p\u003e\n\n\u003cp\u003eThis issue was identified by an Ospoco customer who wishes to remain anonymous and reported by Ospoco (\u003ca title=\"https://ospo.co\" href=\"/redirect?url=https%3A%2F%2Fospo.co\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://ospo.co\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e).\u003c/p\u003e\n","automated_response":false,"created_at":"2020-12-02T23:16:24.739Z","updated_at":"2020-12-02T23:16:24.739Z","actor":{"username":"ospoco","cleared":false,"url":"/ospoco","profile_picture_urls":{"medium":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/ju3m9hfzkrsetxlsoewj0rkxq9pu/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5?response-content-disposition=inline%3B%20filename%3D%22logo_500.jpg%22%3B%20filename%2A%3DUTF-8%27%27logo_500.jpg\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQVN4C5GIR%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T041349Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCICjdrX7ABZ%2BvfX76vY4hAT36HAFa7ABTRFnFNWlME3RsAiA6spUqHGGbpGIJMpDYYPRLrN21uLj3JvPgDLV04KLXWCq0AwhSEAEaDDAxMzYxOTI3NDg0OSIM%2BwbYtZgzO0HRNuilKpED0QRzghA3dQ82LDNvNHg%2F%2Bapjkbzzquj0OQyaslf6lhZ6ae5aaEALaU1htc90%2FTkEnCjK7YAB%2BOOqYauHnXFwgnicH8P2qB1b6qq8ByPdiyv%2F6FeKLaeKEKd1ked0wxhxGILfvv9geWvP9kPkCkrnpW%2Bk3I2nWFhXQ59oSwcUQzXUMoZ0agtptlqAo0vIB0BQ8w3QdM1eyZALy%2Fa2aEoAk0NEEkFhGgVq6y7NSlne0HYNYsnTubU1gtBiWgKFN75WWxAKzP41DZr9biaTv2LpKz%2BS54%2B0D7gM01Pv9DWNFSxduldCjFNWMHaz53TpINKZivByzZ%2FZritkdAHNoYR8NUHdDo4fG9KADtaMgItKYoCYS9dQ3VQKUnEB%2FG5XIqiEWJNuiVPw9Xo1zZJ7ItciKJ%2F2lZOYbSY5IWLtOLK3LAXfBln%2BqWM6KN%2BYSgAqj80OMMoKJozuCJRCLPgT%2BsuXVxgkfPMjWm0msUwRdOuNqAG3PPIFx7Qi20ur1fS33s63LIR24RY3pe1aeEm14DkixQAwqvyp%2FwU67AFUTZKxgkosuC9%2FFnLTDWAcFKkGbWeTSyQlX9WvARJtmEGSKKE3O3RCz4o1fvK2y8cIWG4ZDqIQnnY30DkA5lvQ1S96196eUcIlxUE3IU6WzlYzirsAJvCXzxdcKxl0gn59sA3vLFJkUTgoas7IMyJTtRG6%2B0%2BVBuYKCHqJR1eTwSQxZvSP%2Bzn9VyHRQJZnA1hWcpkteF706gKj%2FXnieX9VW%2FOBOoEUExU1kfEmA0ZpoQRXSm8ma7vzsQoYhwoevAvKutaOvkhM8WM71tgT1%2FjC27FmA%2F%2FsDsAjQs2Rv9IujFElYACO0n6OSheOZw%3D%3D\u0026X-Amz-Signature=1bd6d908444d904108af34aac181b9f2c6a8ae58150ec5062dc62c32599203f5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9989778,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Or better: This issue was identified and patched by an Ospoco customer who wishes to remain anonymous. Reported by Ospoco (https://ospo.co).","markdown_message":"\u003cp\u003eOr better: This issue was identified and patched by an Ospoco customer who wishes to remain anonymous. Reported by Ospoco (\u003ca title=\"https://ospo.co\" href=\"/redirect?url=https%3A%2F%2Fospo.co\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://ospo.co\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e).\u003c/p\u003e\n","automated_response":false,"created_at":"2020-12-02T23:38:02.908Z","updated_at":"2020-12-02T23:38:02.908Z","actor":{"username":"ospoco","cleared":false,"url":"/ospoco","profile_picture_urls":{"medium":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/ju3m9hfzkrsetxlsoewj0rkxq9pu/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5?response-content-disposition=inline%3B%20filename%3D%22logo_500.jpg%22%3B%20filename%2A%3DUTF-8%27%27logo_500.jpg\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQVN4C5GIR%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T041349Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCICjdrX7ABZ%2BvfX76vY4hAT36HAFa7ABTRFnFNWlME3RsAiA6spUqHGGbpGIJMpDYYPRLrN21uLj3JvPgDLV04KLXWCq0AwhSEAEaDDAxMzYxOTI3NDg0OSIM%2BwbYtZgzO0HRNuilKpED0QRzghA3dQ82LDNvNHg%2F%2Bapjkbzzquj0OQyaslf6lhZ6ae5aaEALaU1htc90%2FTkEnCjK7YAB%2BOOqYauHnXFwgnicH8P2qB1b6qq8ByPdiyv%2F6FeKLaeKEKd1ked0wxhxGILfvv9geWvP9kPkCkrnpW%2Bk3I2nWFhXQ59oSwcUQzXUMoZ0agtptlqAo0vIB0BQ8w3QdM1eyZALy%2Fa2aEoAk0NEEkFhGgVq6y7NSlne0HYNYsnTubU1gtBiWgKFN75WWxAKzP41DZr9biaTv2LpKz%2BS54%2B0D7gM01Pv9DWNFSxduldCjFNWMHaz53TpINKZivByzZ%2FZritkdAHNoYR8NUHdDo4fG9KADtaMgItKYoCYS9dQ3VQKUnEB%2FG5XIqiEWJNuiVPw9Xo1zZJ7ItciKJ%2F2lZOYbSY5IWLtOLK3LAXfBln%2BqWM6KN%2BYSgAqj80OMMoKJozuCJRCLPgT%2BsuXVxgkfPMjWm0msUwRdOuNqAG3PPIFx7Qi20ur1fS33s63LIR24RY3pe1aeEm14DkixQAwqvyp%2FwU67AFUTZKxgkosuC9%2FFnLTDWAcFKkGbWeTSyQlX9WvARJtmEGSKKE3O3RCz4o1fvK2y8cIWG4ZDqIQnnY30DkA5lvQ1S96196eUcIlxUE3IU6WzlYzirsAJvCXzxdcKxl0gn59sA3vLFJkUTgoas7IMyJTtRG6%2B0%2BVBuYKCHqJR1eTwSQxZvSP%2Bzn9VyHRQJZnA1hWcpkteF706gKj%2FXnieX9VW%2FOBOoEUExU1kfEmA0ZpoQRXSm8ma7vzsQoYhwoevAvKutaOvkhM8WM71tgT1%2FjC27FmA%2F%2FsDsAjQs2Rv9IujFElYACO0n6OSheOZw%3D%3D\u0026X-Amz-Signature=1bd6d908444d904108af34aac181b9f2c6a8ae58150ec5062dc62c32599203f5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9993936,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"First off, let me say thanks for the report and for working with the curl security to resolve this. While far from well-versed in OCSP I took a look as well. As far as I can tell from reading the (updated) patch, RFC and OpenSSL code this report is a legitimate flaw and the proposed fix correct.\n\nA small nit on the patch: I think the `switch(cert_status)` should have a comment specifying that the three  covered cases are the only possible ones. Seeing that statement without a default made me look for dangerous fallthroughs and I doubt I'll be the only reacting like that.\n\nRegarding the advisory:\n\u003e It then aborts the TLS negotiation of something is wrong with the response.\n\ns/of/if/\n\n\u003e a client should verify that the response is indeed set out for the correct certficate.\n\ns/certficate/certificate/\n\n\u003e B - Maybe use GnuTLS as a backend ?\n\nThis doesn't seem altogether clear. I assume this refers to fixing scripts/programs which may invoke OCSP stapling using the system supplied curl binary. Since there is nothing that makes GnuTLS a better choice than others, I would say \"another TLS backend\" instead. Fixing this in an app using libcurl requires recompilation the user might as well recompile without OCSP stapling enabled and still use OpenSSL?\n\nReading this code I'm a bit confused about why we don't set up the OCSP callback and instead run `verifystatus` explicitly? While not necessarily wrong, it seems to go against OpenSSL documentation.\nAs a follow-up patch I think we should consider adding the revocation time to the `failf` print on revoked certificate, but that's not related to the issue so not here.\n\n","markdown_message":"\u003cp\u003eFirst off, let me say thanks for the report and for working with the curl security to resolve this. While far from well-versed in OCSP I took a look as well. As far as I can tell from reading the (updated) patch, RFC and OpenSSL code this report is a legitimate flaw and the proposed fix correct.\u003c/p\u003e\n\n\u003cp\u003eA small nit on the patch: I think the \u003ccode\u003eswitch(cert_status)\u003c/code\u003e should have a comment specifying that the three  covered cases are the only possible ones. Seeing that statement without a default made me look for dangerous fallthroughs and I doubt I\u0026#39;ll be the only reacting like that.\u003c/p\u003e\n\n\u003cp\u003eRegarding the advisory:\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eIt then aborts the TLS negotiation of something is wrong with the response.\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003es/of/if/\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003ea client should verify that the response is indeed set out for the correct certficate.\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003es/certficate/certificate/\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eB - Maybe use GnuTLS as a backend ?\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eThis doesn\u0026#39;t seem altogether clear. I assume this refers to fixing scripts/programs which may invoke OCSP stapling using the system supplied curl binary. Since there is nothing that makes GnuTLS a better choice than others, I would say \u0026quot;another TLS backend\u0026quot; instead. Fixing this in an app using libcurl requires recompilation the user might as well recompile without OCSP stapling enabled and still use OpenSSL?\u003c/p\u003e\n\n\u003cp\u003eReading this code I\u0026#39;m a bit confused about why we don\u0026#39;t set up the OCSP callback and instead run \u003ccode\u003everifystatus\u003c/code\u003e explicitly? While not necessarily wrong, it seems to go against OpenSSL documentation.\u003cbr\u003e\nAs a follow-up patch I think we should consider adding the revocation time to the \u003ccode\u003efailf\u003c/code\u003e print on revoked certificate, but that\u0026#39;s not related to the issue so not here.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-12-03T12:01:22.396Z","updated_at":"2020-12-03T12:01:22.396Z","actor":{"username":"dgustafsson","cleared":false,"url":"/dgustafsson","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9994311,"is_internal":false,"editable":false,"type":"Activities::CveIdAdded","message":"","markdown_message":"","automated_response":false,"created_at":"2020-12-03T13:03:02.873Z","updated_at":"2020-12-03T13:03:02.873Z","cve_ids":["CVE-2020-8286"],"actor":{"username":"bagder","cleared":false,"url":"/bagder","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/459/380/963f64725677dda4f5113219588e7d0c1ab9abaa_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9994340,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I wasn't very happy with the GnuTLS mention, but OCSP stapling is only supported in three backends and the third one is NSS... I'll remove that advice all together and instead say \"don't rely on OCSP stapling\" for B and remove C.","markdown_message":"\u003cp\u003eI wasn\u0026#39;t very happy with the GnuTLS mention, but OCSP stapling is only supported in three backends and the third one is NSS... I\u0026#39;ll remove that advice all together and instead say \u0026quot;don\u0026#39;t rely on OCSP stapling\u0026quot; for B and remove C.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-12-03T13:08:07.698Z","updated_at":"2020-12-03T13:08:07.698Z","actor":{"username":"bagder","cleared":false,"url":"/bagder","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/459/380/963f64725677dda4f5113219588e7d0c1ab9abaa_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9994561,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"On the patch: I think I rather insert a 'default' to equal unknown, just to remove the doubt for readers.","markdown_message":"\u003cp\u003eOn the patch: I think I rather insert a \u0026#39;default\u0026#39; to equal unknown, just to remove the doubt for readers.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-12-03T13:10:47.387Z","updated_at":"2020-12-03T13:10:47.387Z","actor":{"username":"bagder","cleared":false,"url":"/bagder","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/459/380/963f64725677dda4f5113219588e7d0c1ab9abaa_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9994693,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Here's the updated patch","markdown_message":"\u003cp\u003eHere\u0026#39;s the updated patch\u003c/p\u003e\n","automated_response":false,"created_at":"2020-12-03T13:15:04.374Z","updated_at":"2020-12-03T13:15:04.374Z","actor":{"username":"bagder","cleared":false,"url":"/bagder","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/459/380/963f64725677dda4f5113219588e7d0c1ab9abaa_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"attachments":[{"id":1102720,"filename":"0001-openssl-make-the-OCSP-verification-verify-the-certif.patch","type":"text/x-patch","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/q307ra4ilcv970pcqm32ao50n22l?response-content-disposition=attachment%3B%20filename%3D%220001-openssl-make-the-OCSP-verification-verify-the-certif.patch%22%3B%20filename%2A%3DUTF-8%27%270001-openssl-make-the-OCSP-verification-verify-the-certif.patch\u0026response-content-type=text%2Fx-patch\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQVN4C5GIR%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T041350Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCICjdrX7ABZ%2BvfX76vY4hAT36HAFa7ABTRFnFNWlME3RsAiA6spUqHGGbpGIJMpDYYPRLrN21uLj3JvPgDLV04KLXWCq0AwhSEAEaDDAxMzYxOTI3NDg0OSIM%2BwbYtZgzO0HRNuilKpED0QRzghA3dQ82LDNvNHg%2F%2Bapjkbzzquj0OQyaslf6lhZ6ae5aaEALaU1htc90%2FTkEnCjK7YAB%2BOOqYauHnXFwgnicH8P2qB1b6qq8ByPdiyv%2F6FeKLaeKEKd1ked0wxhxGILfvv9geWvP9kPkCkrnpW%2Bk3I2nWFhXQ59oSwcUQzXUMoZ0agtptlqAo0vIB0BQ8w3QdM1eyZALy%2Fa2aEoAk0NEEkFhGgVq6y7NSlne0HYNYsnTubU1gtBiWgKFN75WWxAKzP41DZr9biaTv2LpKz%2BS54%2B0D7gM01Pv9DWNFSxduldCjFNWMHaz53TpINKZivByzZ%2FZritkdAHNoYR8NUHdDo4fG9KADtaMgItKYoCYS9dQ3VQKUnEB%2FG5XIqiEWJNuiVPw9Xo1zZJ7ItciKJ%2F2lZOYbSY5IWLtOLK3LAXfBln%2BqWM6KN%2BYSgAqj80OMMoKJozuCJRCLPgT%2BsuXVxgkfPMjWm0msUwRdOuNqAG3PPIFx7Qi20ur1fS33s63LIR24RY3pe1aeEm14DkixQAwqvyp%2FwU67AFUTZKxgkosuC9%2FFnLTDWAcFKkGbWeTSyQlX9WvARJtmEGSKKE3O3RCz4o1fvK2y8cIWG4ZDqIQnnY30DkA5lvQ1S96196eUcIlxUE3IU6WzlYzirsAJvCXzxdcKxl0gn59sA3vLFJkUTgoas7IMyJTtRG6%2B0%2BVBuYKCHqJR1eTwSQxZvSP%2Bzn9VyHRQJZnA1hWcpkteF706gKj%2FXnieX9VW%2FOBOoEUExU1kfEmA0ZpoQRXSm8ma7vzsQoYhwoevAvKutaOvkhM8WM71tgT1%2FjC27FmA%2F%2FsDsAjQs2Rv9IujFElYACO0n6OSheOZw%3D%3D\u0026X-Amz-Signature=a83115843af468ab69584d421c6e1b79b75aa5ae70e8002dc493b52aa0f623ef"}],"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9994703,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Here's the updated advisory.","markdown_message":"\u003cp\u003eHere\u0026#39;s the updated advisory.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-12-03T13:15:35.891Z","updated_at":"2020-12-03T13:15:35.891Z","actor":{"username":"bagder","cleared":false,"url":"/bagder","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/459/380/963f64725677dda4f5113219588e7d0c1ab9abaa_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"attachments":[{"id":1102721,"filename":"CVE-2020-8286.md","type":"text/markdown","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/f6ssmfdmiuenxhxe50bksruwhg0k?response-content-disposition=attachment%3B%20filename%3D%22CVE-2020-8286.md%22%3B%20filename%2A%3DUTF-8%27%27CVE-2020-8286.md\u0026response-content-type=text%2Fmarkdown\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQVN4C5GIR%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T041350Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCICjdrX7ABZ%2BvfX76vY4hAT36HAFa7ABTRFnFNWlME3RsAiA6spUqHGGbpGIJMpDYYPRLrN21uLj3JvPgDLV04KLXWCq0AwhSEAEaDDAxMzYxOTI3NDg0OSIM%2BwbYtZgzO0HRNuilKpED0QRzghA3dQ82LDNvNHg%2F%2Bapjkbzzquj0OQyaslf6lhZ6ae5aaEALaU1htc90%2FTkEnCjK7YAB%2BOOqYauHnXFwgnicH8P2qB1b6qq8ByPdiyv%2F6FeKLaeKEKd1ked0wxhxGILfvv9geWvP9kPkCkrnpW%2Bk3I2nWFhXQ59oSwcUQzXUMoZ0agtptlqAo0vIB0BQ8w3QdM1eyZALy%2Fa2aEoAk0NEEkFhGgVq6y7NSlne0HYNYsnTubU1gtBiWgKFN75WWxAKzP41DZr9biaTv2LpKz%2BS54%2B0D7gM01Pv9DWNFSxduldCjFNWMHaz53TpINKZivByzZ%2FZritkdAHNoYR8NUHdDo4fG9KADtaMgItKYoCYS9dQ3VQKUnEB%2FG5XIqiEWJNuiVPw9Xo1zZJ7ItciKJ%2F2lZOYbSY5IWLtOLK3LAXfBln%2BqWM6KN%2BYSgAqj80OMMoKJozuCJRCLPgT%2BsuXVxgkfPMjWm0msUwRdOuNqAG3PPIFx7Qi20ur1fS33s63LIR24RY3pe1aeEm14DkixQAwqvyp%2FwU67AFUTZKxgkosuC9%2FFnLTDWAcFKkGbWeTSyQlX9WvARJtmEGSKKE3O3RCz4o1fvK2y8cIWG4ZDqIQnnY30DkA5lvQ1S96196eUcIlxUE3IU6WzlYzirsAJvCXzxdcKxl0gn59sA3vLFJkUTgoas7IMyJTtRG6%2B0%2BVBuYKCHqJR1eTwSQxZvSP%2Bzn9VyHRQJZnA1hWcpkteF706gKj%2FXnieX9VW%2FOBOoEUExU1kfEmA0ZpoQRXSm8ma7vzsQoYhwoevAvKutaOvkhM8WM71tgT1%2FjC27FmA%2F%2FsDsAjQs2Rv9IujFElYACO0n6OSheOZw%3D%3D\u0026X-Amz-Signature=38f249c596f2b4c92330b8d581d0aa80850238c6e5b70571c9fa67d9f42e5078"}],"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9995094,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2020-12-03T13:39:25.543Z","updated_at":"2020-12-03T13:39:25.543Z","actor":{"username":"bagder","cleared":false,"url":"/bagder","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/459/380/963f64725677dda4f5113219588e7d0c1ab9abaa_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9995102,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2020-12-03T13:40:02.206Z","updated_at":"2020-12-03T13:40:02.206Z","additional_data":{"old_title":"Flaw in OCSP validation logic allows \"validated\" connection to site with revoked certificate","new_title":"CVE-2020-8286: Inferior OCSP verification"},"actor":{"username":"bagder","cleared":false,"url":"/bagder","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/459/380/963f64725677dda4f5113219588e7d0c1ab9abaa_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9995137,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"+1 on the updated patch and advisory.","markdown_message":"\u003cp\u003e+1 on the updated patch and advisory.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-12-03T13:43:14.561Z","updated_at":"2020-12-03T13:43:14.561Z","actor":{"username":"dgustafsson","cleared":false,"url":"/dgustafsson","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9995143,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I think we can manage get this into the 7.74.0 release as stated in the advisory. I will alert the distros about it tomorrow morning my time. Just in case anyone reading this wants to jump in and do some edits before that happens.","markdown_message":"\u003cp\u003eI think we can manage get this into the 7.74.0 release as stated in the advisory. I will alert the distros about it tomorrow morning my time. Just in case anyone reading this wants to jump in and do some edits before that happens.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-12-03T13:43:53.275Z","updated_at":"2020-12-03T13:43:53.275Z","actor":{"username":"bagder","cleared":false,"url":"/bagder","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/459/380/963f64725677dda4f5113219588e7d0c1ab9abaa_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9995261,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"The curl security team has decided to reward hacker @ospoco  with the amount of 900 USD for finding, reporting and fixing this issue. Many thanks for your great work!","markdown_message":"\u003cp\u003eThe curl security team has decided to reward hacker \u003ca href=\"/ospoco\"\u003e@ospoco\u003c/a\u003e  with the amount of 900 USD for finding, reporting and fixing this issue. Many thanks for your great work!\u003c/p\u003e\n","automated_response":false,"created_at":"2020-12-03T14:03:40.708Z","updated_at":"2020-12-03T14:03:40.708Z","actor":{"url":"/curl","ibb":true,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/035/663/2faf4c279d437d64bfda6d23d62ce1833813a4d9_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"curl"}},"bounty_amount":"900.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"curl","collaborator":{"username":"ospoco","url":"/ospoco"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9996610,"is_internal":false,"editable":false,"type":"Activities::ExternalUserJoined","message":"","markdown_message":"","automated_response":false,"created_at":"2020-12-03T16:10:21.121Z","updated_at":"2020-12-03T16:10:21.121Z","actor":{"username":"ghedo","cleared":false,"url":"/ghedo","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":10048066,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Announced to the world.","markdown_message":"\u003cp\u003eAnnounced to the world.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-12-09T07:49:19.366Z","updated_at":"2020-12-09T07:49:19.366Z","actor":{"username":"bagder","cleared":false,"url":"/bagder","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/459/380/963f64725677dda4f5113219588e7d0c1ab9abaa_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"ospoco","url":"/ospoco"},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":10048067,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-12-09T07:49:33.498Z","updated_at":"2020-12-09T07:49:33.498Z","first_to_agree":true,"actor":{"username":"bagder","cleared":false,"url":"/bagder","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/459/380/963f64725677dda4f5113219588e7d0c1ab9abaa_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":10052236,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-12-09T14:26:33.375Z","updated_at":"2020-12-09T14:26:33.375Z","actor":{"username":"ospoco","cleared":false,"url":"/ospoco","profile_picture_urls":{"medium":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/ju3m9hfzkrsetxlsoewj0rkxq9pu/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5?response-content-disposition=inline%3B%20filename%3D%22logo_500.jpg%22%3B%20filename%2A%3DUTF-8%27%27logo_500.jpg\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQVN4C5GIR%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T041349Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCICjdrX7ABZ%2BvfX76vY4hAT36HAFa7ABTRFnFNWlME3RsAiA6spUqHGGbpGIJMpDYYPRLrN21uLj3JvPgDLV04KLXWCq0AwhSEAEaDDAxMzYxOTI3NDg0OSIM%2BwbYtZgzO0HRNuilKpED0QRzghA3dQ82LDNvNHg%2F%2Bapjkbzzquj0OQyaslf6lhZ6ae5aaEALaU1htc90%2FTkEnCjK7YAB%2BOOqYauHnXFwgnicH8P2qB1b6qq8ByPdiyv%2F6FeKLaeKEKd1ked0wxhxGILfvv9geWvP9kPkCkrnpW%2Bk3I2nWFhXQ59oSwcUQzXUMoZ0agtptlqAo0vIB0BQ8w3QdM1eyZALy%2Fa2aEoAk0NEEkFhGgVq6y7NSlne0HYNYsnTubU1gtBiWgKFN75WWxAKzP41DZr9biaTv2LpKz%2BS54%2B0D7gM01Pv9DWNFSxduldCjFNWMHaz53TpINKZivByzZ%2FZritkdAHNoYR8NUHdDo4fG9KADtaMgItKYoCYS9dQ3VQKUnEB%2FG5XIqiEWJNuiVPw9Xo1zZJ7ItciKJ%2F2lZOYbSY5IWLtOLK3LAXfBln%2BqWM6KN%2BYSgAqj80OMMoKJozuCJRCLPgT%2BsuXVxgkfPMjWm0msUwRdOuNqAG3PPIFx7Qi20ur1fS33s63LIR24RY3pe1aeEm14DkixQAwqvyp%2FwU67AFUTZKxgkosuC9%2FFnLTDWAcFKkGbWeTSyQlX9WvARJtmEGSKKE3O3RCz4o1fvK2y8cIWG4ZDqIQnnY30DkA5lvQ1S96196eUcIlxUE3IU6WzlYzirsAJvCXzxdcKxl0gn59sA3vLFJkUTgoas7IMyJTtRG6%2B0%2BVBuYKCHqJR1eTwSQxZvSP%2Bzn9VyHRQJZnA1hWcpkteF706gKj%2FXnieX9VW%2FOBOoEUExU1kfEmA0ZpoQRXSm8ma7vzsQoYhwoevAvKutaOvkhM8WM71tgT1%2FjC27FmA%2F%2FsDsAjQs2Rv9IujFElYACO0n6OSheOZw%3D%3D\u0026X-Amz-Signature=1bd6d908444d904108af34aac181b9f2c6a8ae58150ec5062dc62c32599203f5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":10052237,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-12-09T14:26:33.518Z","updated_at":"2020-12-09T14:26:33.518Z","actor":{"username":"ospoco","cleared":false,"url":"/ospoco","profile_picture_urls":{"medium":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/ju3m9hfzkrsetxlsoewj0rkxq9pu/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5?response-content-disposition=inline%3B%20filename%3D%22logo_500.jpg%22%3B%20filename%2A%3DUTF-8%27%27logo_500.jpg\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQVN4C5GIR%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T041349Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCICjdrX7ABZ%2BvfX76vY4hAT36HAFa7ABTRFnFNWlME3RsAiA6spUqHGGbpGIJMpDYYPRLrN21uLj3JvPgDLV04KLXWCq0AwhSEAEaDDAxMzYxOTI3NDg0OSIM%2BwbYtZgzO0HRNuilKpED0QRzghA3dQ82LDNvNHg%2F%2Bapjkbzzquj0OQyaslf6lhZ6ae5aaEALaU1htc90%2FTkEnCjK7YAB%2BOOqYauHnXFwgnicH8P2qB1b6qq8ByPdiyv%2F6FeKLaeKEKd1ked0wxhxGILfvv9geWvP9kPkCkrnpW%2Bk3I2nWFhXQ59oSwcUQzXUMoZ0agtptlqAo0vIB0BQ8w3QdM1eyZALy%2Fa2aEoAk0NEEkFhGgVq6y7NSlne0HYNYsnTubU1gtBiWgKFN75WWxAKzP41DZr9biaTv2LpKz%2BS54%2B0D7gM01Pv9DWNFSxduldCjFNWMHaz53TpINKZivByzZ%2FZritkdAHNoYR8NUHdDo4fG9KADtaMgItKYoCYS9dQ3VQKUnEB%2FG5XIqiEWJNuiVPw9Xo1zZJ7ItciKJ%2F2lZOYbSY5IWLtOLK3LAXfBln%2BqWM6KN%2BYSgAqj80OMMoKJozuCJRCLPgT%2BsuXVxgkfPMjWm0msUwRdOuNqAG3PPIFx7Qi20ur1fS33s63LIR24RY3pe1aeEm14DkixQAwqvyp%2FwU67AFUTZKxgkosuC9%2FFnLTDWAcFKkGbWeTSyQlX9WvARJtmEGSKKE3O3RCz4o1fvK2y8cIWG4ZDqIQnnY30DkA5lvQ1S96196eUcIlxUE3IU6WzlYzirsAJvCXzxdcKxl0gn59sA3vLFJkUTgoas7IMyJTtRG6%2B0%2BVBuYKCHqJR1eTwSQxZvSP%2Bzn9VyHRQJZnA1hWcpkteF706gKj%2FXnieX9VW%2FOBOoEUExU1kfEmA0ZpoQRXSm8ma7vzsQoYhwoevAvKutaOvkhM8WM71tgT1%2FjC27FmA%2F%2FsDsAjQs2Rv9IujFElYACO0n6OSheOZw%3D%3D\u0026X-Amz-Signature=1bd6d908444d904108af34aac181b9f2c6a8ae58150ec5062dc62c32599203f5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}