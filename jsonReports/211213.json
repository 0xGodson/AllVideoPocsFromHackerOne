{"id":211213,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMTEyMTM=","url":"https://hackerone.com/reports/211213","title":"https://xmpp.nextcloud.com///;@www.google.com allows open redirect","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2017-03-06T22:14:35.183Z","submitted_at":"2017-03-06T22:14:35.183Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"todayisnew","url":"/todayisnew","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/vyC75Ahqgs71NFmwarUBLqSD/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13291,"url":"https://hackerone.com/nextcloud","handle":"nextcloud","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Nextcloud","twitter_handle":"nextclouders","website":"https://nextcloud.com","about":"Access, share and protect your files, calendars, contacts, communication \u0026 more at home and in your enterprise."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-08-13T13:32:34.718Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2017-07-14T13:32:29.161Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"\nGood day :)\n\nHope it goes well, an open redirect exists on the main xmpp.nextcloud.com domain allowing \"bad hackers\" to do bad things :)\n\nPoc \n\nhttps://xmpp.nextcloud.com///;@www.google.com\n\nMay you be well on your side of the screen :)\n\n-Eric\n\n","vulnerability_information_html":"\u003cp\u003eGood day :)\u003c/p\u003e\n\n\u003cp\u003eHope it goes well, an open redirect exists on the main xmpp.nextcloud.com domain allowing \u0026quot;bad hackers\u0026quot; to do bad things :)\u003c/p\u003e\n\n\u003cp\u003ePoc \u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"https://xmpp.nextcloud.com///;@www.google.com\" href=\"/redirect?url=https%3A%2F%2Fxmpp.nextcloud.com%2F%2F%2F%3B%40www.google.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://xmpp.nextcloud.com///;@www.google.com\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eMay you be well on your side of the screen :)\u003c/p\u003e\n\n\u003cp\u003e-Eric\u003c/p\u003e\n","weakness":{"id":53,"name":"Open Redirect"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2017-08-13T13:32:29.209Z","allow_singular_disclosure_after":-106586665.09862265,"singular_disclosure_allowed":true,"vote_count":11,"voters":["yumi","cuso4","eveeez","r3y","apapedulimu","vulnh0lic","f_m","japz","secdoor","franscois","and 1 more..."],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1523008,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks a lot for reporting this potential issue back to us!\n\nOur security team will take a look at this issue as soon as possible. We will reply to your report within 72 hours, usually much faster. For obvious reasons we'd like to ask you to not disclose this issue to any other party.","markdown_message":"\u003cp\u003eThanks a lot for reporting this potential issue back to us!\u003c/p\u003e\n\n\u003cp\u003eOur security team will take a look at this issue as soon as possible. We will reply to your report within 72 hours, usually much faster. For obvious reasons we\u0026#39;d like to ask you to not disclose this issue to any other party.\u003c/p\u003e\n","automated_response":true,"created_at":"2017-03-06T22:14:35.311Z","updated_at":"2017-03-06T22:14:35.311Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Nextcloud"}},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1523940,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thanks a lot for your report. I can confirm this in this case and will look into this. Since the domain has anyways an invalid certificate and is not intended for public use this is though not really a high severity for us.\n\n```\n➜  ~ curl -v https://xmpp.nextcloud.com///\\;@www.google.com -k\n*   Trying 88.198.160.138...\n* TCP_NODELAY set\n* Connected to xmpp.nextcloud.com (88.198.160.138) port 443 (#0)\n* TLS 1.2 connection using TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256\n* Server certificate: demo.nextcloud.com\n* Server certificate: Let's Encrypt Authority X3\n* Server certificate: DST Root CA X3\n\u003e GET ///;@www.google.com HTTP/1.1\n\u003e Host: xmpp.nextcloud.com\n\u003e User-Agent: curl/7.51.0\n\u003e Accept: */*\n\u003e\n\u003c HTTP/1.1 302 Found\n\u003c Date: Tue, 07 Mar 2017 10:53:13 GMT\n\u003c Server: Apache\n\u003c Strict-Transport-Security: max-age=15768000; includeSubDomains; preload\n\u003c Location: https://nextcloud.com%3b@www.google.com\n\u003c Content-Length: 223\n\u003c Content-Type: text/html; charset=iso-8859-1\n\u003c\n\u003c!DOCTYPE HTML PUBLIC \"-//IETF//DTD HTML 2.0//EN\"\u003e\n\u003chtml\u003e\u003chead\u003e\n\u003ctitle\u003e302 Found\u003c/title\u003e\n\u003c/head\u003e\u003cbody\u003e\n\u003ch1\u003eFound\u003c/h1\u003e\n\u003cp\u003eThe document has moved \u003ca href=\"https://nextcloud.com%3b@www.google.com\"\u003ehere\u003c/a\u003e.\u003c/p\u003e\n\u003c/body\u003e\u003c/html\u003e\n* Curl_http_done: called premature == 0\n* Connection #0 to host xmpp.nextcloud.com left intact\n```","markdown_message":"\u003cp\u003eThanks a lot for your report. I can confirm this in this case and will look into this. Since the domain has anyways an invalid certificate and is not intended for public use this is though not really a high severity for us.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight html\"\u003e\u003ccode\u003e➜  ~ curl -v https://xmpp.nextcloud.com///\\;@www.google.com -k\n*   Trying 88.198.160.138...\n* TCP_NODELAY set\n* Connected to xmpp.nextcloud.com (88.198.160.138) port 443 (#0)\n* TLS 1.2 connection using TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256\n* Server certificate: demo.nextcloud.com\n* Server certificate: Let\u0026#39;s Encrypt Authority X3\n* Server certificate: DST Root CA X3\n\u0026gt; GET ///;@www.google.com HTTP/1.1\n\u0026gt; Host: xmpp.nextcloud.com\n\u0026gt; User-Agent: curl/7.51.0\n\u0026gt; Accept: */*\n\u0026gt;\n\u003cspan class=\"nt\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"nt\"\u003eHTTP\u003c/span\u003e\u003cspan class=\"err\"\u003e/\u003c/span\u003e\u003cspan class=\"na\"\u003e1\u003c/span\u003e\u003cspan class=\"err\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003e1\u003c/span\u003e \u003cspan class=\"na\"\u003e302\u003c/span\u003e \u003cspan class=\"na\"\u003eFound\u003c/span\u003e\n\u003cspan class=\"err\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"na\"\u003eDate:\u003c/span\u003e \u003cspan class=\"na\"\u003eTue\u003c/span\u003e\u003cspan class=\"err\"\u003e,\u003c/span\u003e \u003cspan class=\"na\"\u003e07\u003c/span\u003e \u003cspan class=\"na\"\u003eMar\u003c/span\u003e \u003cspan class=\"na\"\u003e2017\u003c/span\u003e \u003cspan class=\"na\"\u003e10:53:13\u003c/span\u003e \u003cspan class=\"na\"\u003eGMT\u003c/span\u003e\n\u003cspan class=\"err\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"na\"\u003eServer:\u003c/span\u003e \u003cspan class=\"na\"\u003eApache\u003c/span\u003e\n\u003cspan class=\"err\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"na\"\u003eStrict-Transport-Security:\u003c/span\u003e \u003cspan class=\"na\"\u003emax-age=\u003c/span\u003e\u003cspan class=\"s\"\u003e15768000;\u003c/span\u003e \u003cspan class=\"na\"\u003eincludeSubDomains\u003c/span\u003e\u003cspan class=\"err\"\u003e;\u003c/span\u003e \u003cspan class=\"na\"\u003epreload\u003c/span\u003e\n\u003cspan class=\"err\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"na\"\u003eLocation:\u003c/span\u003e \u003cspan class=\"na\"\u003ehttps:\u003c/span\u003e\u003cspan class=\"err\"\u003e//\u003c/span\u003e\u003cspan class=\"na\"\u003enextcloud\u003c/span\u003e\u003cspan class=\"err\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003ecom\u003c/span\u003e\u003cspan class=\"err\"\u003e%\u003c/span\u003e\u003cspan class=\"na\"\u003e3b\u003c/span\u003e\u003cspan class=\"err\"\u003e@\u003c/span\u003e\u003cspan class=\"na\"\u003ewww\u003c/span\u003e\u003cspan class=\"err\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003egoogle\u003c/span\u003e\u003cspan class=\"err\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003ecom\u003c/span\u003e\n\u003cspan class=\"err\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"na\"\u003eContent-Length:\u003c/span\u003e \u003cspan class=\"na\"\u003e223\u003c/span\u003e\n\u003cspan class=\"err\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"na\"\u003eContent-Type:\u003c/span\u003e \u003cspan class=\"na\"\u003etext\u003c/span\u003e\u003cspan class=\"err\"\u003e/\u003c/span\u003e\u003cspan class=\"na\"\u003ehtml\u003c/span\u003e\u003cspan class=\"err\"\u003e;\u003c/span\u003e \u003cspan class=\"na\"\u003echarset=\u003c/span\u003e\u003cspan class=\"s\"\u003eiso-8859-1\u003c/span\u003e\n\u003cspan class=\"err\"\u003e\u0026lt;\u003c/span\u003e\n\u003cspan class=\"err\"\u003e\u0026lt;!\u003c/span\u003e\u003cspan class=\"na\"\u003eDOCTYPE\u003c/span\u003e \u003cspan class=\"na\"\u003eHTML\u003c/span\u003e \u003cspan class=\"na\"\u003ePUBLIC\u003c/span\u003e \u003cspan class=\"err\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"na\"\u003e-\u003c/span\u003e\u003cspan class=\"err\"\u003e//\u003c/span\u003e\u003cspan class=\"na\"\u003eIETF\u003c/span\u003e\u003cspan class=\"err\"\u003e//\u003c/span\u003e\u003cspan class=\"na\"\u003eDTD\u003c/span\u003e \u003cspan class=\"na\"\u003eHTML\u003c/span\u003e \u003cspan class=\"na\"\u003e2\u003c/span\u003e\u003cspan class=\"err\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003e0\u003c/span\u003e\u003cspan class=\"err\"\u003e//\u003c/span\u003e\u003cspan class=\"na\"\u003eEN\u003c/span\u003e\u003cspan class=\"err\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;html\u0026gt;\u0026lt;head\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;title\u0026gt;\u003c/span\u003e302 Found\u003cspan class=\"nt\"\u003e\u0026lt;/title\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/head\u0026gt;\u0026lt;body\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;h1\u0026gt;\u003c/span\u003eFound\u003cspan class=\"nt\"\u003e\u0026lt;/h1\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;p\u0026gt;\u003c/span\u003eThe document has moved \u003cspan class=\"nt\"\u003e\u0026lt;a\u003c/span\u003e \u003cspan class=\"na\"\u003ehref=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;https://nextcloud.com%3b@www.google.com\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003ehere\u003cspan class=\"nt\"\u003e\u0026lt;/a\u0026gt;\u003c/span\u003e.\u003cspan class=\"nt\"\u003e\u0026lt;/p\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/body\u0026gt;\u0026lt;/html\u0026gt;\u003c/span\u003e\n* Curl_http_done: called premature == 0\n* Connection #0 to host xmpp.nextcloud.com left intact\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","automated_response":false,"created_at":"2017-03-07T10:53:21.824Z","updated_at":"2017-03-07T10:53:21.824Z","actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1549280,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"","markdown_message":"","automated_response":false,"created_at":"2017-03-18T06:35:13.519Z","updated_at":"2017-03-18T06:35:13.519Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Nextcloud"}},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1835649,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Apologies for the delay on this one. This has been meanwhile fixed by the following Apache configuration change:\n\n```apache\nRedirect / https://nextcloud.com/\n```\n\nto\n\n```apache\nRedirectMatch permanent ^/(.*)$ https://nextcloud.com/\n```","markdown_message":"\u003cp\u003eApologies for the delay on this one. This has been meanwhile fixed by the following Apache configuration change:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight apache\"\u003e\u003ccode\u003e\u003cspan class=\"nc\"\u003eRedirect\u003c/span\u003e / https://nextcloud.com/\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eto\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight apache\"\u003e\u003ccode\u003e\u003cspan class=\"nc\"\u003eRedirectMatch\u003c/span\u003e \u003cspan class=\"ss\"\u003epermanent\u003c/span\u003e ^/(.*)$ https://nextcloud.com/\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","automated_response":false,"created_at":"2017-07-14T13:32:07.401Z","updated_at":"2017-07-14T13:32:07.401Z","actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"todayisnew","url":"/todayisnew"},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1835650,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-07-14T13:32:29.180Z","updated_at":"2017-07-14T13:32:29.180Z","first_to_agree":true,"actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1924614,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-08-13T13:32:34.753Z","updated_at":"2017-08-13T13:32:34.753Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Nextcloud"}},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}