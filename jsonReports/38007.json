{"id":38007,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zODAwNw==","url":"https://hackerone.com/reports/38007","title":"Subdomain Takeover using blog.greenhouse.io pointing to Hubspot","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2014-12-01T23:27:54.941Z","submitted_at":"2014-12-01T23:27:54.941Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"fransrosen","url":"/fransrosen","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/634/6569f1cff6ac26c01a91db469d8707228965f09f_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":312,"url":"https://hackerone.com/greenhouse","handle":"greenhouse","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/312/2b811c151c20eedf86c0458beeaa67210510235e_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/312/2b811c151c20eedf86c0458beeaa67210510235e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Greenhouse.io","twitter_handle":"","website":"https://app.greenhouse.io","about":"Software to optimize your entire recruiting and onboarding process."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2015-02-26T13:51:15.430Z","bug_reporter_agreed_on_going_public_at":"2015-01-27T13:51:10.665Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi,\r\n\r\nYour subdomain blog.greenhouse.io is pointing to the service called Hubspot. However, your account at Hubspot has expired or has been cancelled. This basically means that anyone can claim your subdomain pointing to Hubspot and create their own site at this URL. This is EXTREMELY dangerous as whatever the attacker want can be placed on this domain. This is also a foolproof phishing attack since no one would be able to verify that this is not a legit greenhouse.io-login form.\r\n\r\nI have temporarily claimed this domain for PoC. You should immediately remove the DNS-entry for blog.greenhouse.io pointing to Hubspot.\r\n\r\nAnd since I'm able to run javascript at Hubspot, I'm able to do whatever I like on that domain. Creating a login form that would fool anyone, since it's present on a greenhouse.io domain.\r\n\r\n```\r\n$ host blog.greenhouse.io\r\nblog.greenhouse.io is an alias for san.secure001.hubspot.com.edgekey.net.\r\nsan.secure001.hubspot.com.edgekey.net is an alias for e1395.b.akamaiedge.net.\r\n```\r\n\r\nPoC-link: \r\nhttp://blog.greenhouse.io/\r\n\r\nPoC-images attached.\r\n\r\nAs you might understand, this is really bad. Foolproof phishing. XSS on greenhouse.io. Potential malware spread through a domain you - in this case - do not control. Extremely painful for the company brand.\r\n\r\nPlease make sure you're always going through your DNS-entries so no subdomains are pointing to external services you do not use.\r\n\r\nWe've written an advisory about this at Detectify: \r\nhttp://blog.detectify.com/post/100600514143/hostile-subdomain-takeover-using-heroku-github-desk\r\n\r\nWhere you can read more about this sort of attack.\r\n\r\nRegards,\r\nFrans Rosén","vulnerability_information_html":"\u003cp\u003eHi,\u003c/p\u003e\n\n\u003cp\u003eYour subdomain blog.greenhouse.io is pointing to the service called Hubspot. However, your account at Hubspot has expired or has been cancelled. This basically means that anyone can claim your subdomain pointing to Hubspot and create their own site at this URL. This is EXTREMELY dangerous as whatever the attacker want can be placed on this domain. This is also a foolproof phishing attack since no one would be able to verify that this is not a legit greenhouse.io-login form.\u003c/p\u003e\n\n\u003cp\u003eI have temporarily claimed this domain for PoC. You should immediately remove the DNS-entry for blog.greenhouse.io pointing to Hubspot.\u003c/p\u003e\n\n\u003cp\u003eAnd since I\u0026#39;m able to run javascript at Hubspot, I\u0026#39;m able to do whatever I like on that domain. Creating a login form that would fool anyone, since it\u0026#39;s present on a greenhouse.io domain.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e$ host blog.greenhouse.io\nblog.greenhouse.io is an alias for san.secure001.hubspot.com.edgekey.net.\nsan.secure001.hubspot.com.edgekey.net is an alias for e1395.b.akamaiedge.net.\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003ePoC-link: \u003cbr\u003e\n\u003ca title=\"http://blog.greenhouse.io/\" href=\"/redirect?url=http%3A%2F%2Fblog.greenhouse.io%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://blog.greenhouse.io/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003ePoC-images attached.\u003c/p\u003e\n\n\u003cp\u003eAs you might understand, this is really bad. Foolproof phishing. XSS on greenhouse.io. Potential malware spread through a domain you - in this case - do not control. Extremely painful for the company brand.\u003c/p\u003e\n\n\u003cp\u003ePlease make sure you\u0026#39;re always going through your DNS-entries so no subdomains are pointing to external services you do not use.\u003c/p\u003e\n\n\u003cp\u003eWe\u0026#39;ve written an advisory about this at Detectify: \u003cbr\u003e\n\u003ca title=\"http://blog.detectify.com/post/100600514143/hostile-subdomain-takeover-using-heroku-github-desk\" href=\"/redirect?url=http%3A%2F%2Fblog.detectify.com%2Fpost%2F100600514143%2Fhostile-subdomain-takeover-using-heroku-github-desk\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://blog.detectify.com/post/100600514143/hostile-subdomain-takeover-using-heroku-github-desk\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eWhere you can read more about this sort of attack.\u003c/p\u003e\n\n\u003cp\u003eRegards,\u003cbr\u003e\nFrans Rosén\u003c/p\u003e\n","bounty_amount":"1000.0","formatted_bounty":"$1,000","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":22320,"file_name":"Screen_Shot_2014-12-02_at_00.23.26.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/022/320/943690d67e19cd06a2ff4b6ba5944c92130aeea2/Screen_Shot_2014-12-02_at_00.23.26.png?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2014-12-02_at_00.23.26.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2014-12-02_at_00.23.26.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSUJSTWNA%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T054634Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQDC4LZo82wc2eCvBFlhjwE027CwJoHB88%2BMK2v03JEf7AIgTsNTuR7XI5zLkpcU%2F192zliPMALv25wXWHyoW56mHW0qtAMIVRABGgwwMTM2MTkyNzQ4NDkiDDQxd6Ep%2FudaJolhjiqRA%2FV9m3Q5qTHiEf%2B0F56QxIa0FX4xcw3kyVQ754zuEWG6%2FFHm5u50c%2FkjIZTK4iokf%2F5bg8%2F9lzPcfaf%2FlyMeeuZQiIR66c8Q0ZynlQYFFg39COCCRcmQH0rk4Py7SioeZK1WX50szdnMCAEBM0%2FYGIJRFlpJYz5%2BF7cuCEDZDVFz70QPaeLM9Aq2Hp0OWlaD%2BlKU2Ya8oXmKGTVLeV6xTf66mRdzvW8I4qKgZpByKnAcip5WWnkttPjUxPiLaEeZ%2BClnUyHZas2bB1iPmPH0rQXcKWbTOq%2BJJm8xX%2FgqtqSgjGTmncJVZJxe0UaRUPXS%2BxPh0KYERT9Te4D5sREOcmaPJ0lojWm5AuNIxK3S30FeTamdldG5jOgcjm7r6e2HjWcB7yfe4%2BCsYd2eVLbbXk95jZRHQohr%2B7Z9YEqq00TUANe07BXm%2FKoAPBMy0bYQHYmVJaGS31XhmN6DRKUn5mwwU6NQ87eIymigu48swQSaSOa0S3Ve15n99tYKCLxw%2FqcLrXK9DmAPRXyB2cTH85tpMJ7Qqv8FOusB0TY7T%2F8PPlS9Pw17cj5sLPnZSdHFb4OJ7xNuArhvZUxC%2FDdQIpfgbN40hDHy3r94ejzq63ULcWroBoxExSJ8F%2BIqLrT2jEE%2BHYV9rJ3uN20mlrWN07M1wfpVQeu7mZyiWu%2BTKEOjyLznji7d3Efn7A1SwzF%2FWi11RcA9%2BGeNTFCiOeyJRV4JWopx6NNi8TVr6hBraJmZeqXIUCIj4yW%2BvdbZ%2F7b%2BDWNq1S8BMna3Htt9r6lmeANRYdDH%2BkiA2F6n7nJrrrNm3hF7NHjHy1GdUin3XffXKseDfHdRNqxNelH1SrChi2zziLtHrQ%3D%3D\u0026X-Amz-Signature=262e9c3bf7282c7ebe9853a0a13ba68b3bbe5976bb845252af3de01fbc6e3172","file_size":91955,"type":"image/png"},{"id":22321,"file_name":"Screen_Shot_2014-12-02_at_00.23.23.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/022/321/18709a79a7fa249f6a8b9b5aca75b7ac39f7b77d/Screen_Shot_2014-12-02_at_00.23.23.png?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2014-12-02_at_00.23.23.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2014-12-02_at_00.23.23.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSUJSTWNA%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T054634Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQDC4LZo82wc2eCvBFlhjwE027CwJoHB88%2BMK2v03JEf7AIgTsNTuR7XI5zLkpcU%2F192zliPMALv25wXWHyoW56mHW0qtAMIVRABGgwwMTM2MTkyNzQ4NDkiDDQxd6Ep%2FudaJolhjiqRA%2FV9m3Q5qTHiEf%2B0F56QxIa0FX4xcw3kyVQ754zuEWG6%2FFHm5u50c%2FkjIZTK4iokf%2F5bg8%2F9lzPcfaf%2FlyMeeuZQiIR66c8Q0ZynlQYFFg39COCCRcmQH0rk4Py7SioeZK1WX50szdnMCAEBM0%2FYGIJRFlpJYz5%2BF7cuCEDZDVFz70QPaeLM9Aq2Hp0OWlaD%2BlKU2Ya8oXmKGTVLeV6xTf66mRdzvW8I4qKgZpByKnAcip5WWnkttPjUxPiLaEeZ%2BClnUyHZas2bB1iPmPH0rQXcKWbTOq%2BJJm8xX%2FgqtqSgjGTmncJVZJxe0UaRUPXS%2BxPh0KYERT9Te4D5sREOcmaPJ0lojWm5AuNIxK3S30FeTamdldG5jOgcjm7r6e2HjWcB7yfe4%2BCsYd2eVLbbXk95jZRHQohr%2B7Z9YEqq00TUANe07BXm%2FKoAPBMy0bYQHYmVJaGS31XhmN6DRKUn5mwwU6NQ87eIymigu48swQSaSOa0S3Ve15n99tYKCLxw%2FqcLrXK9DmAPRXyB2cTH85tpMJ7Qqv8FOusB0TY7T%2F8PPlS9Pw17cj5sLPnZSdHFb4OJ7xNuArhvZUxC%2FDdQIpfgbN40hDHy3r94ejzq63ULcWroBoxExSJ8F%2BIqLrT2jEE%2BHYV9rJ3uN20mlrWN07M1wfpVQeu7mZyiWu%2BTKEOjyLznji7d3Efn7A1SwzF%2FWi11RcA9%2BGeNTFCiOeyJRV4JWopx6NNi8TVr6hBraJmZeqXIUCIj4yW%2BvdbZ%2F7b%2BDWNq1S8BMna3Htt9r6lmeANRYdDH%2BkiA2F6n7nJrrrNm3hF7NHjHy1GdUin3XffXKseDfHdRNqxNelH1SrChi2zziLtHrQ%3D%3D\u0026X-Amz-Signature=60d808a56fe84487271b0393a8d65d01a665b7dff1ecfd14460478eab0874778","file_size":164718,"type":"image/png"}],"allow_singular_disclosure_at":"2015-02-26T13:51:11.256Z","allow_singular_disclosure_after":-184262123.23464185,"singular_disclosure_allowed":true,"vote_count":25,"voters":["dilawer01","cyanpiny","brodie_codie","r3y","realtess","khizer47","dpgribkov","l00p3r","fantam1","japz","and 15 more..."],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":170542,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hi fransrosen, thanks for the report! We actually had a previous report about this, which cited your blog post. The previous report didn't actually point out our misconfigured domain. Hubspot doesn't seem to have a way for me to redirect blog.greenhouse.io to www.greenhouse.io/blog, so I just removed that CNAME. I checked to make sure that we don't have any other stray domains pointing at Hubspot.\n\nI'll get back to you tomorrow about a reward. Thanks a lot for this, Frans!","markdown_message":"\u003cp\u003eHi fransrosen, thanks for the report! We actually had a previous report about this, which cited your blog post. The previous report didn\u0026#39;t actually point out our misconfigured domain. Hubspot doesn\u0026#39;t seem to have a way for me to redirect blog.greenhouse.io to \u003ca href=\"/redirect?url=http%3A%2F%2Fwww.greenhouse.io%2Fblog\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ewww.greenhouse.io/blog\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e, so I just removed that CNAME. I checked to make sure that we don\u0026#39;t have any other stray domains pointing at Hubspot.\u003c/p\u003e\n\n\u003cp\u003eI\u0026#39;ll get back to you tomorrow about a reward. Thanks a lot for this, Frans!\u003c/p\u003e\n","automated_response":false,"created_at":"2014-12-02T00:54:08.381Z","updated_at":"2014-12-02T00:54:08.381Z","actor":{"username":"mcclurmc","cleared":false,"url":"/mcclurmc","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"greenhouse","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":170712,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2014-12-02T14:52:38.493Z","updated_at":"2014-12-02T14:52:38.493Z","actor":{"username":"mcclurmc","cleared":false,"url":"/mcclurmc","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"fransrosen","url":"/fransrosen"},"genius_execution_id":null,"team_handle":"greenhouse","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":170713,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Hi Frans, thanks again for the report. We feel that this was severe enough that we should award the higher bounty level. Please let us know if you have anything else to report!","markdown_message":"\u003cp\u003eHi Frans, thanks again for the report. We feel that this was severe enough that we should award the higher bounty level. Please let us know if you have anything else to report!\u003c/p\u003e\n","automated_response":false,"created_at":"2014-12-02T14:53:51.013Z","updated_at":"2014-12-02T14:53:51.013Z","actor":{"url":"/greenhouse","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/312/2b811c151c20eedf86c0458beeaa67210510235e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Greenhouse.io"}},"bounty_amount":"1000.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"greenhouse","collaborator":{"username":"fransrosen","url":"/fransrosen"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":170761,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Woah! Thanks alot guys! I really appreciate it. Will let you know if there's anything!\nRegards,\nFrans","markdown_message":"\u003cp\u003eWoah! Thanks alot guys! I really appreciate it. Will let you know if there\u0026#39;s anything!\u003cbr\u003e\nRegards,\u003cbr\u003e\nFrans\u003c/p\u003e\n","automated_response":false,"created_at":"2014-12-02T17:02:18.893Z","updated_at":"2014-12-02T17:02:18.893Z","actor":{"username":"fransrosen","cleared":true,"url":"/fransrosen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/634/6569f1cff6ac26c01a91db469d8707228965f09f_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"greenhouse","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":318808,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Would be great if I could publish this one, thanks!\nRegards,\nFrans","markdown_message":"\u003cp\u003eWould be great if I could publish this one, thanks!\u003cbr\u003e\nRegards,\u003cbr\u003e\nFrans\u003c/p\u003e\n","automated_response":false,"created_at":"2015-01-27T13:51:10.738Z","updated_at":"2015-01-27T13:51:10.738Z","first_to_agree":true,"actor":{"username":"fransrosen","cleared":true,"url":"/fransrosen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/634/6569f1cff6ac26c01a91db469d8707228965f09f_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"greenhouse","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":340742,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-02-26T13:51:15.552Z","updated_at":"2015-02-26T13:51:15.552Z","actor":{"url":"/greenhouse","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/312/2b811c151c20eedf86c0458beeaa67210510235e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Greenhouse.io"}},"genius_execution_id":null,"team_handle":"greenhouse","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}