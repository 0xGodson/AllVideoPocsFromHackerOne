{"id":220737,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMjA3Mzc=","url":"https://hackerone.com/reports/220737","title":"Tabnabbing via Window.Opener @Mavenlink","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2017-04-13T11:34:41.678Z","submitted_at":"2017-04-13T11:34:41.678Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"chols","url":"/chols","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/157/511/30ea07c3b13f65ca154d0594aff1e65744c59715_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":48,"url":"https://hackerone.com/mavenlink","handle":"mavenlink","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/048/f0b795a31dcd39219030322524224cd0b61cc45e_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/048/f0b795a31dcd39219030322524224cd0b61cc45e_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"paused","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Mavenlink","twitter_handle":"","website":"https://www.mavenlink.com","about":"Mavenlink provides sophisticated software and services to help organizations conduct business online, improve productivity, and grow profitably."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-05-09T19:19:11.434Z","bug_reporter_agreed_on_going_public_at":"2017-05-09T19:19:11.392Z","team_member_agreed_on_going_public_at":"2017-05-09T17:36:30.603Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Details:\nWhen you open a link in a new tab ( target=\"_blank\" ), the page that opens in a new tab can access the initial tab and change it's location using the window.opener property.\n\nPOC: \nEdit your website in work sample, with the website URL of http://daniel-tomescu.com/hackerone/landpage.php, which has the following code.\n\n\u003chtml\u003e\n\u003cscript\u003e\nwindow.opener.location.replace('http://daniel-tomescu.com/hackerone/scampage.php');\n\u003c/script\u003e\n\nMy cool page with some funny cat pictures.\u003cbr\u003e \u003cbr\u003e\n\n\u003cimg style=\"height:400px; width:300px;\" src=\"http://static.tumblr.com/81b6d42b4064def5e9062d5f4410c820/betml74/Yl5ml0lia/tumblr_static_impress.jpg\"\u003e\n\u003c/html\u003e\n\nCreate a work sample, and add that website, but make sure to publicize your profile, in order for other users to see,  you can then click on the link to the website. This opens in a new tab, and the existing tab is silently redirected to the a website without asking the user. In a real life example, this would redirect to a phishing site to try gain credentials for users.\n\nThe javascript code that does all the magic: \nwindow.opener.location.replace(newURL);\n\nWays to solve this:\n\nDon't open links in new tabs using the target=\"_blank\"\nAdd attribute rel=\"noreferrer\" which also disables referrer\nSet the window.opener attribute to null on the new tab before redirecting, like this: \u003cscript\u003evar w=window.open(url, \"target=_blank\");w.opener=null;\u003c/script\u003e\nI hope you see why this is dangerous: this method has huge potential for tricking users that click on external links from this site to be a victim of a scam page because the redirecting is made in the background, while the user is focused on another tab.\n\nMore then that, some browsers like Mozilla for Android don't even display the URL, just the page title, so the user has no way of knowing that he was redirected to a scam page.\n\nNote that the target page doesn't have to be in the same-origin policy, so can be an entirely different domain, and the redirect happens silently while user is viewing another page.\n\nHope that all helps, let me know if you need more information. I can provide screenshots and/or screencasts if necessary.\n\nWonder if this is eligible for a bounty? :)\nHope you'll triaged this.\n\nKind Regards,\nJolan Saluria","vulnerability_information_html":"\u003cp\u003eDetails:\u003cbr\u003e\nWhen you open a link in a new tab ( target=\u0026quot;_blank\u0026quot; ), the page that opens in a new tab can access the initial tab and change it\u0026#39;s location using the window.opener property.\u003c/p\u003e\n\n\u003cp\u003ePOC: \u003cbr\u003e\nEdit your website in work sample, with the website URL of \u003ca title=\"http://daniel-tomescu.com/hackerone/landpage.php\" href=\"/redirect?url=http%3A%2F%2Fdaniel-tomescu.com%2Fhackerone%2Flandpage.php\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://daniel-tomescu.com/hackerone/landpage.php\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e, which has the following code.\u003c/p\u003e\n\n\u003cp\u003e\u0026lt;html\u0026gt;\u003cbr\u003e\n\u0026lt;script\u0026gt;\u003cbr\u003e\nwindow.opener.location.replace(\u0026#39;\u003ca title=\"http://daniel-tomescu.com/hackerone/scampage.php\u0026#39;\" href=\"/redirect?url=http%3A%2F%2Fdaniel-tomescu.com%2Fhackerone%2Fscampage.php%27\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://daniel-tomescu.com/hackerone/scampage.php\u0026#39;\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e);\u003cbr\u003e\n\u0026lt;/script\u0026gt;\u003c/p\u003e\n\n\u003cp\u003eMy cool page with some funny cat pictures.\u0026lt;br\u0026gt; \u0026lt;br\u0026gt;\u003c/p\u003e\n\n\u003cp\u003e\u0026lt;img style=\u0026quot;height:400px; width:300px;\u0026quot; src=\u0026quot;http://static.tumblr.com/81b6d42b4064def5e9062d5f4410c820/betml74/Yl5ml0lia/tumblr_static_impress.jpg\u0026quot;\u0026gt;\u003cbr\u003e\n\u0026lt;/html\u0026gt;\u003c/p\u003e\n\n\u003cp\u003eCreate a work sample, and add that website, but make sure to publicize your profile, in order for other users to see,  you can then click on the link to the website. This opens in a new tab, and the existing tab is silently redirected to the a website without asking the user. In a real life example, this would redirect to a phishing site to try gain credentials for users.\u003c/p\u003e\n\n\u003cp\u003eThe javascript code that does all the magic: \u003cbr\u003e\nwindow.opener.location.replace(newURL);\u003c/p\u003e\n\n\u003cp\u003eWays to solve this:\u003c/p\u003e\n\n\u003cp\u003eDon\u0026#39;t open links in new tabs using the target=\u0026quot;_blank\u0026quot;\u003cbr\u003e\nAdd attribute rel=\u0026quot;noreferrer\u0026quot; which also disables referrer\u003cbr\u003e\nSet the window.opener attribute to null on the new tab before redirecting, like this: \u0026lt;script\u0026gt;var w=window.open(url, \u0026quot;target=_blank\u0026quot;);w.opener=null;\u0026lt;/script\u0026gt;\u003cbr\u003e\nI hope you see why this is dangerous: this method has huge potential for tricking users that click on external links from this site to be a victim of a scam page because the redirecting is made in the background, while the user is focused on another tab.\u003c/p\u003e\n\n\u003cp\u003eMore then that, some browsers like Mozilla for Android don\u0026#39;t even display the URL, just the page title, so the user has no way of knowing that he was redirected to a scam page.\u003c/p\u003e\n\n\u003cp\u003eNote that the target page doesn\u0026#39;t have to be in the same-origin policy, so can be an entirely different domain, and the redirect happens silently while user is viewing another page.\u003c/p\u003e\n\n\u003cp\u003eHope that all helps, let me know if you need more information. I can provide screenshots and/or screencasts if necessary.\u003c/p\u003e\n\n\u003cp\u003eWonder if this is eligible for a bounty? :)\u003cbr\u003e\nHope you\u0026#39;ll triaged this.\u003c/p\u003e\n\n\u003cp\u003eKind Regards,\u003cbr\u003e\nJolan Saluria\u003c/p\u003e\n","bounty_amount":"50.0","formatted_bounty":"$50","weakness":{"id":53,"name":"Open Redirect"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":175577,"file_name":"5db38cb3-6727-49c6-ba49-0733fa06b668.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/175/577/9ad4c64c535e45e8b55d7722bb601280d7a93d84/5db38cb3-6727-49c6-ba49-0733fa06b668.png?response-content-disposition=attachment%3B%20filename%3D%225db38cb3-6727-49c6-ba49-0733fa06b668.png%22%3B%20filename%2A%3DUTF-8%27%275db38cb3-6727-49c6-ba49-0733fa06b668.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ4IZIDGEJ%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T050001Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHgvhPRXI%2B7x6zNGnfFbWtzZacTUlKPt3VwSApQji3YyAiEA2Y%2FuJ72LgjXuchHTkycORzGcHp9y6ZUl%2BeyKz%2FFfjlAqtAMIVBABGgwwMTM2MTkyNzQ4NDkiDHblJHa0bCSVtoiX8yqRA7Ct%2F1l8ihdf2xXnJNUaJGv7nq%2F1b1xXdqHLpOjb5bN22Ac%2BQjHl%2Bna1KjqQx0Qu8Fcs0WQUm6dGPZbHLiP%2FRkIHh6FlY41MtajX39mvBrMgWCmioQD4vc7NSsiqHLG4GmvgnIM0wWXfwwv%2Fmq%2BjRWJQacOyz7e9kYXzI%2BQkViUKmcuV48xoXGswHYXnPSqKC6IqSk0Rgc6j2xAmne60g5PNHQf%2BehWLSoXupow19n2vF%2BE4dhw1ZLX%2B9fBct02t5%2B41MEA5z30yhC52UxDX9%2BedHi3rXpTTyV%2FX%2BWfdeGSGSqmwrTAcipCpz01NR%2Fkk3srD5BLQB%2B6BdeDlwwcltfcgYdKO39yRPNyZePA9ihdN%2B4YHA7%2FY9ufCPbEevGDvtv3mVStbES31aUOxSmGNj%2B8fMMJqFBAtD4Qx54l8UFyMf%2BQ8PPbA0OLpU9rjip1L0zxevK6IGISP%2FPlDldWsNQvfi1Xn6QvRkmL1ANNGXqycx5MDUJExPyV801VOQ68%2FfbB87Cmdd8xIJWUNtmpsIgDtMO2wqv8FOusBRxy8OOzTGCKFydY5xn2aZtaPj3obazs55j%2BS5FoY%2BdkqAuB4pbyPDlTBBI%2Fe4ZIYYBH9t51VaQaRwrhKPTTntuBcC2b5uuKcGXYq9rnIAgbUHulNqSoxgZep0wAjzrLEFeECcDfqDCjG1QyXJkGQyq3UjLElJNKzeGgK4y5hW9emXis3wfoUPLixiL7W8M52b0Q9HQrT0RxnkkNSLj7aPyOAVCPImHNwjJ%2FI2KIbB5iD4e9PbxcHFvjKgkNUQh2pESECovpzx%2BAz7wsT%2FUMRieGT%2BFtMt1o90%2BewPxe95i025ZqzwWI1aVcXtA%3D%3D\u0026X-Amz-Signature=f02cbcce4908acef75698a0c6207cef3cacd2de0b2fdb55ce64c32656955d21a","file_size":7241,"type":"image/png"}],"allow_singular_disclosure_at":"2017-06-08T17:36:30.642Z","allow_singular_disclosure_after":-112274611.06253251,"singular_disclosure_allowed":true,"vote_count":8,"voters":["gamliel","muhammad_uwais","eveeez","japz","chols","jivan","spetr0x","k3nt0y"],"severity":{"rating":"low","author_type":"User"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1630574,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Any update? It's been a week now.","markdown_message":"\u003cp\u003eAny update? It\u0026#39;s been a week now.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-04-24T13:23:28.729Z","updated_at":"2017-04-24T13:23:28.729Z","actor":{"username":"chols","cleared":false,"url":"/chols","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/157/511/30ea07c3b13f65ca154d0594aff1e65744c59715_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"mavenlink","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1649792,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2017-05-02T19:09:00.305Z","updated_at":"2017-05-02T19:09:00.305Z","actor":{"username":"mavenlink-jon","cleared":false,"url":"/mavenlink-jon","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mavenlink","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1654505,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@chols This has been fixed, can you please re-test?","markdown_message":"\u003cp\u003e\u003ca href=\"/chols\"\u003e@chols\u003c/a\u003e This has been fixed, can you please re-test?\u003c/p\u003e\n","automated_response":false,"created_at":"2017-05-04T18:33:03.633Z","updated_at":"2017-05-04T18:33:03.633Z","actor":{"username":"racerpeter","cleared":false,"url":"/racerpeter","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mavenlink","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1656081,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @racerpeter, \nThanks for the heads up!\nYes I can confirm the fix now.\n\nCheerz,\nJolan Saluria","markdown_message":"\u003cp\u003eHi \u003ca href=\"/racerpeter\"\u003e@racerpeter\u003c/a\u003e, \u003cbr\u003e\nThanks for the heads up!\u003cbr\u003e\nYes I can confirm the fix now.\u003c/p\u003e\n\n\u003cp\u003eCheerz,\u003cbr\u003e\nJolan Saluria\u003c/p\u003e\n","automated_response":false,"created_at":"2017-05-05T09:37:32.018Z","updated_at":"2017-05-05T09:37:32.018Z","actor":{"username":"chols","cleared":false,"url":"/chols","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/157/511/30ea07c3b13f65ca154d0594aff1e65744c59715_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"mavenlink","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1662065,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks for helping make Mavenlink more secure!","markdown_message":"\u003cp\u003eThanks for helping make Mavenlink more secure!\u003c/p\u003e\n","automated_response":false,"created_at":"2017-05-09T02:42:51.165Z","updated_at":"2017-05-09T02:42:51.165Z","actor":{"url":"/mavenlink","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/048/f0b795a31dcd39219030322524224cd0b61cc45e_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Mavenlink"}},"bounty_amount":"50.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"mavenlink","collaborator":{"username":"chols","url":"/chols"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1662143,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for the bounty$ Mavenlink!\nCan we please change the state from triaged to resolved?\nSo that we can disclose it?\n","markdown_message":"\u003cp\u003eThanks for the bounty$ Mavenlink!\u003cbr\u003e\nCan we please change the state from triaged to resolved?\u003cbr\u003e\nSo that we can disclose it?\u003c/p\u003e\n","automated_response":false,"created_at":"2017-05-09T04:03:00.492Z","updated_at":"2017-05-09T04:03:00.492Z","actor":{"username":"chols","cleared":false,"url":"/chols","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/157/511/30ea07c3b13f65ca154d0594aff1e65744c59715_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"mavenlink","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1663843,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2017-05-09T17:35:59.764Z","updated_at":"2017-05-09T17:35:59.764Z","actor":{"username":"racerpeter","cleared":false,"url":"/racerpeter","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"chols","url":"/chols"},"genius_execution_id":null,"team_handle":"mavenlink","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1663847,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-05-09T17:36:30.620Z","updated_at":"2017-05-09T17:36:30.620Z","first_to_agree":true,"actor":{"username":"racerpeter","cleared":false,"url":"/racerpeter","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mavenlink","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1664209,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Hi @racerpeter can we please limit / summarized the disclosure?  Before being publicized?","markdown_message":"\u003cp\u003eHi \u003ca href=\"/racerpeter\"\u003e@racerpeter\u003c/a\u003e can we please limit / summarized the disclosure?  Before being publicized?\u003c/p\u003e\n","automated_response":false,"created_at":"2017-05-09T19:19:11.405Z","updated_at":"2017-05-09T19:19:11.405Z","actor":{"username":"chols","cleared":false,"url":"/chols","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/157/511/30ea07c3b13f65ca154d0594aff1e65744c59715_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"mavenlink","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1664210,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-05-09T19:19:11.448Z","updated_at":"2017-05-09T19:19:11.448Z","actor":{"username":"chols","cleared":false,"url":"/chols","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/157/511/30ea07c3b13f65ca154d0594aff1e65744c59715_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"mavenlink","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}