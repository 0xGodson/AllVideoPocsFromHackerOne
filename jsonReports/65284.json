{"id":65284,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC82NTI4NA==","url":"https://hackerone.com/reports/65284","title":"Stored Cross-Site Scripting in Map Share Page","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2015-06-01T18:54:36.379Z","submitted_at":"2015-06-01T18:54:36.379Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"hussain_0x3c","url":"/hussain_0x3c","profile_picture_urls":{"small":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/d2wgu8uwsaisagfzk12aibdqa9jh/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a?response-content-disposition=inline%3B%20filename%3D%2224a3fd8a-3718-4f8d-9710-3aa00325b07a.jpg%22%3B%20filename%2A%3DUTF-8%27%2724a3fd8a-3718-4f8d-9710-3aa00325b07a.jpg\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQRF2F3DNN%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T063354Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCq%2BvKnwl6LFdj00DiqFKaUHM8vK%2Fo1tPHwYahCeGa93QIgIGXi89nBgDj4GiNdSy8pbzTFSts%2FsTmVKSM%2B7%2BKO9T4qtAMIVxABGgwwMTM2MTkyNzQ4NDkiDC9ugoHsMNk43keJ8SqRA8JrBBYsK5T0HiaJ%2F4T50sG1Ri6J%2BT91kOgNavpYRolFX7jpLcV0V81FUABPzsjSnAxRmYBypjIaPqZGQ8oq%2F9n27wPLgj8hUTl8O3SfU1GWCMHbROvW%2BF2K77xGt0sJKNZYVxNdbqrYwCp5MFfMpJjwvv%2BhMkb%2BfRRyL7GEsu82VMU41lKH3RgrBDJApguUYlLANZ1Ej8ImBTuQa0PTHDqpwoWpjaPcrnIHZqTdHOI5Wm1eCoy5eaHGFikwjjvjuMJ%2F1a5ex%2FCIOhGcwoqCBDet1aBO%2BZq78RzS1QY34XnoChAp%2BaikZB20FcxjUwn%2BkvJECosM%2B4F4PQHepofUS3ejTLZPjeYi9qQNjzq%2Fm%2Fv%2FV4Vqc3IwmTFe06OdDxIgpZyAcTQoSU8vA7sbEDpB%2F3XQDS%2BUqZejbvdrbfU8WGZYnfYRHIKZtByJaRcPB8vqFX9lX0oeLxz0IEswNXH%2FFNMPBsLv79pLu3OV6Lzfbgb36AT8ui2UZLwoOGRrSo71Tb%2FsYvBelBr2drk9Yi%2Fa%2FnGwML2Fq%2F8FOusBbN3FmFgpQ8hwRzpol0ZxBWjfkVayY1CeW8JmiNjsl1ndCgMmcPk10W64GF1qbk7fF0uPQopY1SymUfLnKrk2DYd5OUiFjtVktJLGKZ7wkgrDfWYDpQHSQRJQyMvnd2nX1QfEA0AlGzRulOvM2iwTIk241T4DuFrDCiCqYL8Mv%2FPeDbSAy7t6gkKpJ8C2PUVCIivsXSH1HvLfNTen1g5wD0tpM%2FnXwZxdxfuh8W3doYRnkWcmf8W%2F2IdcL3V8Ca3%2FV7qrIFxbsZIzSmpnSBl18cNkli7atg7%2FBcRNrqYiFsXMe5OsMSXyZkZK%2BQ%3D%3D\u0026X-Amz-Signature=fabda02aa5b7da3705e28bc32eca383143c1b98e2dd8a8c2d8e686d6d32a32b4"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1366,"url":"https://hackerone.com/mapbox","handle":"mapbox","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/366/d4dfa3c8752e3849cdfb22fea49c17bd37f03850_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/366/d4dfa3c8752e3849cdfb22fea49c17bd37f03850_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Mapbox","twitter_handle":"mapbox","website":"https://www.mapbox.com/security","about":"Mapbox is an open source mapping platform, providing building blocks for developers to integrate location into any mobile or online application."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2016-04-19T21:23:39.661Z","bug_reporter_agreed_on_going_public_at":"2016-03-24T15:32:08.653Z","team_member_agreed_on_going_public_at":"2016-04-19T21:23:39.589Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi Team Mapbox Security \r\nThis is Copy From message email ( ‫security@mapbox.com‬ ) \r\n\r\nintro.\r\nI'm Hussain Adnan Researcher Security,\r\nIam Have  Found  Vulnerability *Bug* in form project profile ( Map )\r\n\r\nType Vulnerability : Cross-Site Scripting ( Stored - Reflected ) \r\nAffected Domain : Affected Domain : mapbox.com - a.tiles.mapbox.com\r\nlink Demo to execute : Reflected \r\n~~~ \r\nhttps://a.tiles.mapbox.com/v4/ibmsecurity.ma91e43j/page.html?access_token=pk.eyJ1IjoiaWJtc2VjdXJpdHkiLCJhIjoiOWI0NDYxYjVmMjYzNjE2Yjc1ODM5NDgxOTBmMTFkODEifQ.EIBxJM1o7YiuI4pgZ7bsjg \r\n~~~\r\nCode javascript  execute   in mapbox.com on form  search map edited.\r\nand  execute    in a.tiles.mapbox.com on URL \r\n\r\nSteps to reproduce\r\n-----\r\nan attacker delete #  from  url  and  get  url  code  execute    Stored  - Reflected \r\nhttp://im54.gulfup.com/0gseLU.gif\r\n\r\n----\r\nPOC   : https://youtu.be/N_4mqOtp07c - http://im54.gulfup.com/0gseLU.gif\r\n\r\n\r\n\r\n\r\nBe Safe\r\nBest Regards ","vulnerability_information_html":"\u003cp\u003eHi Team Mapbox Security \u003cbr\u003e\nThis is Copy From message email ( ‫\u003ca title=\"security@mapbox.com\" href=\"mailto:security@mapbox.com\" rel=\"nofollow noopener noreferrer\"\u003esecurity@mapbox.com\u003c/a\u003e‬ ) \u003c/p\u003e\n\n\u003cp\u003eintro.\u003cbr\u003e\nI\u0026#39;m Hussain Adnan Researcher Security,\u003cbr\u003e\nIam Have  Found  Vulnerability \u003cem\u003eBug\u003c/em\u003e in form project profile ( Map )\u003c/p\u003e\n\n\u003cp\u003eType Vulnerability : Cross-Site Scripting ( Stored - Reflected ) \u003cbr\u003e\nAffected Domain : Affected Domain : mapbox.com - a.tiles.mapbox.com\u003cbr\u003e\nlink Demo to execute : Reflected \u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ehttps://a.tiles.mapbox.com/v4/ibmsecurity.ma91e43j/page.html?access_token=pk.eyJ1IjoiaWJtc2VjdXJpdHkiLCJhIjoiOWI0NDYxYjVmMjYzNjE2Yjc1ODM5NDgxOTBmMTFkODEifQ.EIBxJM1o7YiuI4pgZ7bsjg \n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eCode javascript  execute   in mapbox.com on form  search map edited.\u003cbr\u003e\nand  execute    in a.tiles.mapbox.com on URL \u003c/p\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps to reproduce\u003c/h2\u003e\n\n\u003cp\u003ean attacker delete #  from  url  and  get  url  code  execute    Stored  - Reflected \u003cbr\u003e\n\u003ca title=\"http://im54.gulfup.com/0gseLU.gif\" href=\"/redirect?url=http%3A%2F%2Fim54.gulfup.com%2F0gseLU.gif\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://im54.gulfup.com/0gseLU.gif\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003chr\u003e\n\n\u003cp\u003ePOC   : \u003ca title=\"https://youtu.be/N_4mqOtp07c\" href=\"/redirect?url=https%3A%2F%2Fyoutu.be%2FN_4mqOtp07c\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://youtu.be/N_4mqOtp07c\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e - \u003ca title=\"http://im54.gulfup.com/0gseLU.gif\" href=\"/redirect?url=http%3A%2F%2Fim54.gulfup.com%2F0gseLU.gif\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://im54.gulfup.com/0gseLU.gif\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eBe Safe\u003cbr\u003e\nBest Regards \u003c/p\u003e\n","bounty_amount":"1000.0","formatted_bounty":"$1,000","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2016-04-23T15:32:09.184Z","allow_singular_disclosure_after":-147798105.38957497,"singular_disclosure_allowed":true,"vote_count":2,"voters":["spetr0x","dyabla"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":435457,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Hi, thanks for the report.\n\nCan you please provide the XSS payload you are using, and specify where you inserted it?","markdown_message":"\u003cp\u003eHi, thanks for the report.\u003c/p\u003e\n\n\u003cp\u003eCan you please provide the XSS payload you are using, and specify where you inserted it?\u003c/p\u003e\n","automated_response":false,"created_at":"2015-06-01T20:35:18.416Z","updated_at":"2015-06-01T20:35:18.416Z","actor":{"username":"jfirebaugh","cleared":false,"url":"/jfirebaugh","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mapbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":435707,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Hello @jfirebaugh\nForm Data - Line  for edit project  He Accept The Codes encoded HTML  URL \nYou Can Encode Code HTML For  Payload  \nPayload Used : \u0026quot;\u0026gt;\u0026lt;svg/onload=prompt(0)\u0026gt;\nWebsite Used : http://meyerweb.com/eric/tools/dencoder/\n\nNOTE \nEncrypt Code By YourSelf  Because The Edit Not Accept  Code HTML and He Will The collecting automatically\n\nBe Safe \nThanks","markdown_message":"\u003cp\u003eHello \u003ca href=\"/jfirebaugh\"\u003e@jfirebaugh\u003c/a\u003e\u003cbr\u003e\nForm Data - Line  for edit project  He Accept The Codes encoded HTML  URL \u003cbr\u003e\nYou Can Encode Code HTML For  Payload\u003cbr\u003e\u003cbr\u003e\nPayload Used : \u0026quot;\u0026gt;\u0026lt;svg/onload=prompt(0)\u0026gt;\u003cbr\u003e\nWebsite Used : \u003ca title=\"http://meyerweb.com/eric/tools/dencoder/\" href=\"/redirect?url=http%3A%2F%2Fmeyerweb.com%2Feric%2Ftools%2Fdencoder%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://meyerweb.com/eric/tools/dencoder/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eNOTE \u003cbr\u003e\nEncrypt Code By YourSelf  Because The Edit Not Accept  Code HTML and He Will The collecting automatically\u003c/p\u003e\n\n\u003cp\u003eBe Safe \u003cbr\u003e\nThanks\u003c/p\u003e\n","automated_response":false,"created_at":"2015-06-02T00:57:10.700Z","updated_at":"2015-06-02T00:57:10.700Z","actor":{"username":"hussain_0x3c","cleared":false,"url":"/hussain_0x3c","profile_picture_urls":{"medium":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/d2wgu8uwsaisagfzk12aibdqa9jh/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5?response-content-disposition=inline%3B%20filename%3D%2224a3fd8a-3718-4f8d-9710-3aa00325b07a.jpg%22%3B%20filename%2A%3DUTF-8%27%2724a3fd8a-3718-4f8d-9710-3aa00325b07a.jpg\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQRF2F3DNN%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T063354Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCq%2BvKnwl6LFdj00DiqFKaUHM8vK%2Fo1tPHwYahCeGa93QIgIGXi89nBgDj4GiNdSy8pbzTFSts%2FsTmVKSM%2B7%2BKO9T4qtAMIVxABGgwwMTM2MTkyNzQ4NDkiDC9ugoHsMNk43keJ8SqRA8JrBBYsK5T0HiaJ%2F4T50sG1Ri6J%2BT91kOgNavpYRolFX7jpLcV0V81FUABPzsjSnAxRmYBypjIaPqZGQ8oq%2F9n27wPLgj8hUTl8O3SfU1GWCMHbROvW%2BF2K77xGt0sJKNZYVxNdbqrYwCp5MFfMpJjwvv%2BhMkb%2BfRRyL7GEsu82VMU41lKH3RgrBDJApguUYlLANZ1Ej8ImBTuQa0PTHDqpwoWpjaPcrnIHZqTdHOI5Wm1eCoy5eaHGFikwjjvjuMJ%2F1a5ex%2FCIOhGcwoqCBDet1aBO%2BZq78RzS1QY34XnoChAp%2BaikZB20FcxjUwn%2BkvJECosM%2B4F4PQHepofUS3ejTLZPjeYi9qQNjzq%2Fm%2Fv%2FV4Vqc3IwmTFe06OdDxIgpZyAcTQoSU8vA7sbEDpB%2F3XQDS%2BUqZejbvdrbfU8WGZYnfYRHIKZtByJaRcPB8vqFX9lX0oeLxz0IEswNXH%2FFNMPBsLv79pLu3OV6Lzfbgb36AT8ui2UZLwoOGRrSo71Tb%2FsYvBelBr2drk9Yi%2Fa%2FnGwML2Fq%2F8FOusBbN3FmFgpQ8hwRzpol0ZxBWjfkVayY1CeW8JmiNjsl1ndCgMmcPk10W64GF1qbk7fF0uPQopY1SymUfLnKrk2DYd5OUiFjtVktJLGKZ7wkgrDfWYDpQHSQRJQyMvnd2nX1QfEA0AlGzRulOvM2iwTIk241T4DuFrDCiCqYL8Mv%2FPeDbSAy7t6gkKpJ8C2PUVCIivsXSH1HvLfNTen1g5wD0tpM%2FnXwZxdxfuh8W3doYRnkWcmf8W%2F2IdcL3V8Ca3%2FV7qrIFxbsZIzSmpnSBl18cNkli7atg7%2FBcRNrqYiFsXMe5OsMSXyZkZK%2BQ%3D%3D\u0026X-Amz-Signature=e719d971f6cca12239ae0555b52f50458f4ea8724c4a12da7292b2bf5f4dc257"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mapbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":437145,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"I haven't been able to replicate an XSS using the payload `\"\u003e\u003csvg/onload=prompt(0)\u003e`. Is this the exact payload used? Can you please specify the field that you put the payload in?\n\nIf you don't speak English, feel free to leave your report in your own language, and we'll try our best to find someone who can help translate.\n","markdown_message":"\u003cp\u003eI haven\u0026#39;t been able to replicate an XSS using the payload \u003ccode\u003e\u0026quot;\u0026gt;\u0026lt;svg/onload=prompt(0)\u0026gt;\u003c/code\u003e. Is this the exact payload used? Can you please specify the field that you put the payload in?\u003c/p\u003e\n\n\u003cp\u003eIf you don\u0026#39;t speak English, feel free to leave your report in your own language, and we\u0026#39;ll try our best to find someone who can help translate.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-06-02T15:10:49.386Z","updated_at":"2015-06-02T15:10:49.386Z","actor":{"username":"jfirebaugh","cleared":false,"url":"/jfirebaugh","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mapbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":437174,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2015-06-02T15:31:41.646Z","updated_at":"2015-06-02T15:31:41.646Z","actor":{"username":"jfirebaugh","cleared":false,"url":"/jfirebaugh","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mapbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":437403,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you for Triaged\nI've injected code in the list\nProject in the selection of settings \nfor  edit Name and  Description\n\n\nI'm Use translate google an understanding with you\n\nHope this bug will be fixed soon\nRegards","markdown_message":"\u003cp\u003eThank you for Triaged\u003cbr\u003e\nI\u0026#39;ve injected code in the list\u003cbr\u003e\nProject in the selection of settings \u003cbr\u003e\nfor  edit Name and  Description\u003c/p\u003e\n\n\u003cp\u003eI\u0026#39;m Use translate google an understanding with you\u003c/p\u003e\n\n\u003cp\u003eHope this bug will be fixed soon\u003cbr\u003e\nRegards\u003c/p\u003e\n","automated_response":false,"created_at":"2015-06-02T18:12:59.098Z","updated_at":"2015-06-02T18:12:59.098Z","actor":{"username":"hussain_0x3c","cleared":false,"url":"/hussain_0x3c","profile_picture_urls":{"medium":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/d2wgu8uwsaisagfzk12aibdqa9jh/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5?response-content-disposition=inline%3B%20filename%3D%2224a3fd8a-3718-4f8d-9710-3aa00325b07a.jpg%22%3B%20filename%2A%3DUTF-8%27%2724a3fd8a-3718-4f8d-9710-3aa00325b07a.jpg\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQRF2F3DNN%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T063354Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCq%2BvKnwl6LFdj00DiqFKaUHM8vK%2Fo1tPHwYahCeGa93QIgIGXi89nBgDj4GiNdSy8pbzTFSts%2FsTmVKSM%2B7%2BKO9T4qtAMIVxABGgwwMTM2MTkyNzQ4NDkiDC9ugoHsMNk43keJ8SqRA8JrBBYsK5T0HiaJ%2F4T50sG1Ri6J%2BT91kOgNavpYRolFX7jpLcV0V81FUABPzsjSnAxRmYBypjIaPqZGQ8oq%2F9n27wPLgj8hUTl8O3SfU1GWCMHbROvW%2BF2K77xGt0sJKNZYVxNdbqrYwCp5MFfMpJjwvv%2BhMkb%2BfRRyL7GEsu82VMU41lKH3RgrBDJApguUYlLANZ1Ej8ImBTuQa0PTHDqpwoWpjaPcrnIHZqTdHOI5Wm1eCoy5eaHGFikwjjvjuMJ%2F1a5ex%2FCIOhGcwoqCBDet1aBO%2BZq78RzS1QY34XnoChAp%2BaikZB20FcxjUwn%2BkvJECosM%2B4F4PQHepofUS3ejTLZPjeYi9qQNjzq%2Fm%2Fv%2FV4Vqc3IwmTFe06OdDxIgpZyAcTQoSU8vA7sbEDpB%2F3XQDS%2BUqZejbvdrbfU8WGZYnfYRHIKZtByJaRcPB8vqFX9lX0oeLxz0IEswNXH%2FFNMPBsLv79pLu3OV6Lzfbgb36AT8ui2UZLwoOGRrSo71Tb%2FsYvBelBr2drk9Yi%2Fa%2FnGwML2Fq%2F8FOusBbN3FmFgpQ8hwRzpol0ZxBWjfkVayY1CeW8JmiNjsl1ndCgMmcPk10W64GF1qbk7fF0uPQopY1SymUfLnKrk2DYd5OUiFjtVktJLGKZ7wkgrDfWYDpQHSQRJQyMvnd2nX1QfEA0AlGzRulOvM2iwTIk241T4DuFrDCiCqYL8Mv%2FPeDbSAy7t6gkKpJ8C2PUVCIivsXSH1HvLfNTen1g5wD0tpM%2FnXwZxdxfuh8W3doYRnkWcmf8W%2F2IdcL3V8Ca3%2FV7qrIFxbsZIzSmpnSBl18cNkli7atg7%2FBcRNrqYiFsXMe5OsMSXyZkZK%2BQ%3D%3D\u0026X-Amz-Signature=e719d971f6cca12239ae0555b52f50458f4ea8724c4a12da7292b2bf5f4dc257"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mapbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":438232,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"We have deployed a fix for this vulnerability. Could you take a look and confirm? Thank you.","markdown_message":"\u003cp\u003eWe have deployed a fix for this vulnerability. Could you take a look and confirm? Thank you.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-06-03T01:25:02.541Z","updated_at":"2015-06-03T01:25:02.541Z","actor":{"username":"jfirebaugh","cleared":false,"url":"/jfirebaugh","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mapbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":438469,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Verified this as fixed","markdown_message":"\u003cp\u003eVerified this as fixed\u003c/p\u003e\n","automated_response":false,"created_at":"2015-06-03T07:41:50.171Z","updated_at":"2015-06-03T07:41:50.171Z","actor":{"username":"hussain_0x3c","cleared":false,"url":"/hussain_0x3c","profile_picture_urls":{"medium":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/d2wgu8uwsaisagfzk12aibdqa9jh/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5?response-content-disposition=inline%3B%20filename%3D%2224a3fd8a-3718-4f8d-9710-3aa00325b07a.jpg%22%3B%20filename%2A%3DUTF-8%27%2724a3fd8a-3718-4f8d-9710-3aa00325b07a.jpg\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQRF2F3DNN%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T063354Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCq%2BvKnwl6LFdj00DiqFKaUHM8vK%2Fo1tPHwYahCeGa93QIgIGXi89nBgDj4GiNdSy8pbzTFSts%2FsTmVKSM%2B7%2BKO9T4qtAMIVxABGgwwMTM2MTkyNzQ4NDkiDC9ugoHsMNk43keJ8SqRA8JrBBYsK5T0HiaJ%2F4T50sG1Ri6J%2BT91kOgNavpYRolFX7jpLcV0V81FUABPzsjSnAxRmYBypjIaPqZGQ8oq%2F9n27wPLgj8hUTl8O3SfU1GWCMHbROvW%2BF2K77xGt0sJKNZYVxNdbqrYwCp5MFfMpJjwvv%2BhMkb%2BfRRyL7GEsu82VMU41lKH3RgrBDJApguUYlLANZ1Ej8ImBTuQa0PTHDqpwoWpjaPcrnIHZqTdHOI5Wm1eCoy5eaHGFikwjjvjuMJ%2F1a5ex%2FCIOhGcwoqCBDet1aBO%2BZq78RzS1QY34XnoChAp%2BaikZB20FcxjUwn%2BkvJECosM%2B4F4PQHepofUS3ejTLZPjeYi9qQNjzq%2Fm%2Fv%2FV4Vqc3IwmTFe06OdDxIgpZyAcTQoSU8vA7sbEDpB%2F3XQDS%2BUqZejbvdrbfU8WGZYnfYRHIKZtByJaRcPB8vqFX9lX0oeLxz0IEswNXH%2FFNMPBsLv79pLu3OV6Lzfbgb36AT8ui2UZLwoOGRrSo71Tb%2FsYvBelBr2drk9Yi%2Fa%2FnGwML2Fq%2F8FOusBbN3FmFgpQ8hwRzpol0ZxBWjfkVayY1CeW8JmiNjsl1ndCgMmcPk10W64GF1qbk7fF0uPQopY1SymUfLnKrk2DYd5OUiFjtVktJLGKZ7wkgrDfWYDpQHSQRJQyMvnd2nX1QfEA0AlGzRulOvM2iwTIk241T4DuFrDCiCqYL8Mv%2FPeDbSAy7t6gkKpJ8C2PUVCIivsXSH1HvLfNTen1g5wD0tpM%2FnXwZxdxfuh8W3doYRnkWcmf8W%2F2IdcL3V8Ca3%2FV7qrIFxbsZIzSmpnSBl18cNkli7atg7%2FBcRNrqYiFsXMe5OsMSXyZkZK%2BQ%3D%3D\u0026X-Amz-Signature=e719d971f6cca12239ae0555b52f50458f4ea8724c4a12da7292b2bf5f4dc257"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mapbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":439702,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2015-06-03T15:54:08.070Z","updated_at":"2015-06-03T15:54:08.070Z","actor":{"username":"jfirebaugh","cleared":false,"url":"/jfirebaugh","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"hussain_0x3c","url":"/hussain_0x3c"},"genius_execution_id":null,"team_handle":"mapbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":439703,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2015-06-03T15:54:17.282Z","updated_at":"2015-06-03T15:54:17.282Z","actor":{"url":"/mapbox","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/366/d4dfa3c8752e3849cdfb22fea49c17bd37f03850_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Mapbox"}},"bounty_amount":"1000.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"mapbox","collaborator":{"username":"hussain_0x3c","url":"/hussain_0x3c"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":439717,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Woah! Nice Bounty  \nthanks alot guys! ","markdown_message":"\u003cp\u003eWoah! Nice Bounty\u003cbr\u003e\u003cbr\u003e\nthanks alot guys! \u003c/p\u003e\n","automated_response":false,"created_at":"2015-06-03T16:01:16.941Z","updated_at":"2015-06-03T16:08:25.470Z","actor":{"username":"hussain_0x3c","cleared":false,"url":"/hussain_0x3c","profile_picture_urls":{"medium":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/d2wgu8uwsaisagfzk12aibdqa9jh/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5?response-content-disposition=inline%3B%20filename%3D%2224a3fd8a-3718-4f8d-9710-3aa00325b07a.jpg%22%3B%20filename%2A%3DUTF-8%27%2724a3fd8a-3718-4f8d-9710-3aa00325b07a.jpg\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQRF2F3DNN%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T063354Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCq%2BvKnwl6LFdj00DiqFKaUHM8vK%2Fo1tPHwYahCeGa93QIgIGXi89nBgDj4GiNdSy8pbzTFSts%2FsTmVKSM%2B7%2BKO9T4qtAMIVxABGgwwMTM2MTkyNzQ4NDkiDC9ugoHsMNk43keJ8SqRA8JrBBYsK5T0HiaJ%2F4T50sG1Ri6J%2BT91kOgNavpYRolFX7jpLcV0V81FUABPzsjSnAxRmYBypjIaPqZGQ8oq%2F9n27wPLgj8hUTl8O3SfU1GWCMHbROvW%2BF2K77xGt0sJKNZYVxNdbqrYwCp5MFfMpJjwvv%2BhMkb%2BfRRyL7GEsu82VMU41lKH3RgrBDJApguUYlLANZ1Ej8ImBTuQa0PTHDqpwoWpjaPcrnIHZqTdHOI5Wm1eCoy5eaHGFikwjjvjuMJ%2F1a5ex%2FCIOhGcwoqCBDet1aBO%2BZq78RzS1QY34XnoChAp%2BaikZB20FcxjUwn%2BkvJECosM%2B4F4PQHepofUS3ejTLZPjeYi9qQNjzq%2Fm%2Fv%2FV4Vqc3IwmTFe06OdDxIgpZyAcTQoSU8vA7sbEDpB%2F3XQDS%2BUqZejbvdrbfU8WGZYnfYRHIKZtByJaRcPB8vqFX9lX0oeLxz0IEswNXH%2FFNMPBsLv79pLu3OV6Lzfbgb36AT8ui2UZLwoOGRrSo71Tb%2FsYvBelBr2drk9Yi%2Fa%2FnGwML2Fq%2F8FOusBbN3FmFgpQ8hwRzpol0ZxBWjfkVayY1CeW8JmiNjsl1ndCgMmcPk10W64GF1qbk7fF0uPQopY1SymUfLnKrk2DYd5OUiFjtVktJLGKZ7wkgrDfWYDpQHSQRJQyMvnd2nX1QfEA0AlGzRulOvM2iwTIk241T4DuFrDCiCqYL8Mv%2FPeDbSAy7t6gkKpJ8C2PUVCIivsXSH1HvLfNTen1g5wD0tpM%2FnXwZxdxfuh8W3doYRnkWcmf8W%2F2IdcL3V8Ca3%2FV7qrIFxbsZIzSmpnSBl18cNkli7atg7%2FBcRNrqYiFsXMe5OsMSXyZkZK%2BQ%3D%3D\u0026X-Amz-Signature=e719d971f6cca12239ae0555b52f50458f4ea8724c4a12da7292b2bf5f4dc257"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mapbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":869398,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"if you can please ^_^  ","markdown_message":"\u003cp\u003eif you can please ^_^  \u003c/p\u003e\n","automated_response":false,"created_at":"2016-03-24T15:32:08.813Z","updated_at":"2016-03-24T15:32:08.813Z","first_to_agree":true,"actor":{"username":"hussain_0x3c","cleared":false,"url":"/hussain_0x3c","profile_picture_urls":{"medium":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/d2wgu8uwsaisagfzk12aibdqa9jh/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5?response-content-disposition=inline%3B%20filename%3D%2224a3fd8a-3718-4f8d-9710-3aa00325b07a.jpg%22%3B%20filename%2A%3DUTF-8%27%2724a3fd8a-3718-4f8d-9710-3aa00325b07a.jpg\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQRF2F3DNN%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T063354Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCq%2BvKnwl6LFdj00DiqFKaUHM8vK%2Fo1tPHwYahCeGa93QIgIGXi89nBgDj4GiNdSy8pbzTFSts%2FsTmVKSM%2B7%2BKO9T4qtAMIVxABGgwwMTM2MTkyNzQ4NDkiDC9ugoHsMNk43keJ8SqRA8JrBBYsK5T0HiaJ%2F4T50sG1Ri6J%2BT91kOgNavpYRolFX7jpLcV0V81FUABPzsjSnAxRmYBypjIaPqZGQ8oq%2F9n27wPLgj8hUTl8O3SfU1GWCMHbROvW%2BF2K77xGt0sJKNZYVxNdbqrYwCp5MFfMpJjwvv%2BhMkb%2BfRRyL7GEsu82VMU41lKH3RgrBDJApguUYlLANZ1Ej8ImBTuQa0PTHDqpwoWpjaPcrnIHZqTdHOI5Wm1eCoy5eaHGFikwjjvjuMJ%2F1a5ex%2FCIOhGcwoqCBDet1aBO%2BZq78RzS1QY34XnoChAp%2BaikZB20FcxjUwn%2BkvJECosM%2B4F4PQHepofUS3ejTLZPjeYi9qQNjzq%2Fm%2Fv%2FV4Vqc3IwmTFe06OdDxIgpZyAcTQoSU8vA7sbEDpB%2F3XQDS%2BUqZejbvdrbfU8WGZYnfYRHIKZtByJaRcPB8vqFX9lX0oeLxz0IEswNXH%2FFNMPBsLv79pLu3OV6Lzfbgb36AT8ui2UZLwoOGRrSo71Tb%2FsYvBelBr2drk9Yi%2Fa%2FnGwML2Fq%2F8FOusBbN3FmFgpQ8hwRzpol0ZxBWjfkVayY1CeW8JmiNjsl1ndCgMmcPk10W64GF1qbk7fF0uPQopY1SymUfLnKrk2DYd5OUiFjtVktJLGKZ7wkgrDfWYDpQHSQRJQyMvnd2nX1QfEA0AlGzRulOvM2iwTIk241T4DuFrDCiCqYL8Mv%2FPeDbSAy7t6gkKpJ8C2PUVCIivsXSH1HvLfNTen1g5wD0tpM%2FnXwZxdxfuh8W3doYRnkWcmf8W%2F2IdcL3V8Ca3%2FV7qrIFxbsZIzSmpnSBl18cNkli7atg7%2FBcRNrqYiFsXMe5OsMSXyZkZK%2BQ%3D%3D\u0026X-Amz-Signature=e719d971f6cca12239ae0555b52f50458f4ea8724c4a12da7292b2bf5f4dc257"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mapbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":880313,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"May I disclose this vulnerability ?\n\nThank you. ","markdown_message":"\u003cp\u003eMay I disclose this vulnerability ?\u003c/p\u003e\n\n\u003cp\u003eThank you. \u003c/p\u003e\n","automated_response":false,"created_at":"2016-03-31T17:18:25.275Z","updated_at":"2016-03-31T17:18:25.275Z","actor":{"username":"hussain_0x3c","cleared":false,"url":"/hussain_0x3c","profile_picture_urls":{"medium":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/d2wgu8uwsaisagfzk12aibdqa9jh/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5?response-content-disposition=inline%3B%20filename%3D%2224a3fd8a-3718-4f8d-9710-3aa00325b07a.jpg%22%3B%20filename%2A%3DUTF-8%27%2724a3fd8a-3718-4f8d-9710-3aa00325b07a.jpg\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQRF2F3DNN%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T063354Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCq%2BvKnwl6LFdj00DiqFKaUHM8vK%2Fo1tPHwYahCeGa93QIgIGXi89nBgDj4GiNdSy8pbzTFSts%2FsTmVKSM%2B7%2BKO9T4qtAMIVxABGgwwMTM2MTkyNzQ4NDkiDC9ugoHsMNk43keJ8SqRA8JrBBYsK5T0HiaJ%2F4T50sG1Ri6J%2BT91kOgNavpYRolFX7jpLcV0V81FUABPzsjSnAxRmYBypjIaPqZGQ8oq%2F9n27wPLgj8hUTl8O3SfU1GWCMHbROvW%2BF2K77xGt0sJKNZYVxNdbqrYwCp5MFfMpJjwvv%2BhMkb%2BfRRyL7GEsu82VMU41lKH3RgrBDJApguUYlLANZ1Ej8ImBTuQa0PTHDqpwoWpjaPcrnIHZqTdHOI5Wm1eCoy5eaHGFikwjjvjuMJ%2F1a5ex%2FCIOhGcwoqCBDet1aBO%2BZq78RzS1QY34XnoChAp%2BaikZB20FcxjUwn%2BkvJECosM%2B4F4PQHepofUS3ejTLZPjeYi9qQNjzq%2Fm%2Fv%2FV4Vqc3IwmTFe06OdDxIgpZyAcTQoSU8vA7sbEDpB%2F3XQDS%2BUqZejbvdrbfU8WGZYnfYRHIKZtByJaRcPB8vqFX9lX0oeLxz0IEswNXH%2FFNMPBsLv79pLu3OV6Lzfbgb36AT8ui2UZLwoOGRrSo71Tb%2FsYvBelBr2drk9Yi%2Fa%2FnGwML2Fq%2F8FOusBbN3FmFgpQ8hwRzpol0ZxBWjfkVayY1CeW8JmiNjsl1ndCgMmcPk10W64GF1qbk7fF0uPQopY1SymUfLnKrk2DYd5OUiFjtVktJLGKZ7wkgrDfWYDpQHSQRJQyMvnd2nX1QfEA0AlGzRulOvM2iwTIk241T4DuFrDCiCqYL8Mv%2FPeDbSAy7t6gkKpJ8C2PUVCIivsXSH1HvLfNTen1g5wD0tpM%2FnXwZxdxfuh8W3doYRnkWcmf8W%2F2IdcL3V8Ca3%2FV7qrIFxbsZIzSmpnSBl18cNkli7atg7%2FBcRNrqYiFsXMe5OsMSXyZkZK%2BQ%3D%3D\u0026X-Amz-Signature=e719d971f6cca12239ae0555b52f50458f4ea8724c4a12da7292b2bf5f4dc257"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mapbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":915935,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2016-04-19T21:19:36.264Z","updated_at":"2016-04-19T21:19:36.264Z","additional_data":{"old_title":"Cross-Site Scripting on  Maps  ( Stored - Reflected )","new_title":"Stored Cross-Site Scripting in Map Share Page"},"actor":{"username":"alulsh","cleared":false,"url":"/alulsh","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/039/856/496b75e2cc4a4ce5798ef27243d139b9dd38fea5_original.JPG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mapbox","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":915944,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-04-19T21:23:39.612Z","updated_at":"2016-04-19T21:23:39.612Z","actor":{"username":"alulsh","cleared":false,"url":"/alulsh","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/039/856/496b75e2cc4a4ce5798ef27243d139b9dd38fea5_original.JPG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mapbox","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":915945,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-04-19T21:23:39.678Z","updated_at":"2016-04-19T21:23:39.678Z","actor":{"username":"alulsh","cleared":false,"url":"/alulsh","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/039/856/496b75e2cc4a4ce5798ef27243d139b9dd38fea5_original.JPG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mapbox","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":1719,"category":"team","content":"In June 2015, @hussain found a stored cross-site scripting (XSS) vulnerability in the share page of our v3 and v4 Mapbox classic maps. This vulnerability did not affect mapbox.js, Mapbox GL JS, or any of our mobile SDKs, it only affected the share page for v3 and v4 maps hosted on *.tiles.mapbox.com. In order to be subject to the XSS attack, a user had to either directly visit the share URL of a malicious map or visit an attacker-controlled web page with a malicious map embedded via an `iframe`. \n\nHussain created a [map](https://a.tiles.mapbox.com/v4/ibmsecurity.ma91e43j/page.html?access_token=pk.eyJ1IjoiaWJtc2VjdXJpdHkiLCJhIjoiOWI0NDYxYjVmMjYzNjE2Yjc1ODM5NDgxOTBmMTFkODEifQ.EIBxJM1o7YiuI4pgZ7bsjg) in the online classic map editor and added several XSS payloads to a few map markers.\n\nThe payload `\u0026lt;img src=x onerror=alert(1) \"` evaded sanitization and executed arbitrary JavaScript immediately. The payload was added to the DOM as part of a list of map marker titles in the top left hand corner of the share page.\n\nThe following old code in https://a.tiles.mapbox.com/v3/embed/share.js and https://a.tiles.mapbox.com/v4/embed/share.js was vulnerable:\n\n```\nfunction stripHTML(html) {\n   var tmp = document.createElement('DIV');\n   tmp.innerHTML = L.mapbox.sanitize(html);\n   return tmp.textContent || tmp.innerText || '';\n}\n```\n\nThe `stripHTML` function returned `\u003cimg src=x onerror=alert(1) \"` due to the use of `textContent`, which converted the `\u0026lt;` HTML entity into the left angle bracket unicode character (`\u003c`). As a result, the payload was added to the share page as `\u003cimg src=x onerror=alert(1) \"`, executing `alert(1)` on error when loading the image with no source.\n\nWe resolved the issue by using underscore's [escape function](http://underscorejs.org/#escape) before returning the `textContent` of the marker. \n\n```\nfunction stripHTML(html) {\n   var tmp = document.createElement('DIV');\n   tmp.innerHTML = L.mapbox.sanitize(html);\n   return _.escape(tmp.textContent || tmp.innerText || '');\n}\n```\n\nAs seen in [this map](https://a.tiles.mapbox.com/v4/alulsh.pnbm6b4b/page.html?access_token=pk.eyJ1IjoiYWx1bHNoIiwiYSI6ImY0NDBjYTQ1NjU4OGJmMDFiMWQ1Y2RmYjRlMGI1ZjIzIn0.pngboKEPsfuC4j54XDT3VA#3/61.73/41.92), the map marker title is `\u003cimg src=x onerror=alert(1)\"` now instead of a broken image tag.","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eIn June 2015, \u003ca href=\"/hussain\"\u003e@hussain\u003c/a\u003e found a stored cross-site scripting (XSS) vulnerability in the share page of our v3 and v4 Mapbox classic maps. This vulnerability did not affect mapbox.js, Mapbox GL JS, or any of our mobile SDKs, it only affected the share page for v3 and v4 maps hosted on *.tiles.mapbox.com. In order to be subject to the XSS attack, a user had to either directly visit the share URL of a malicious map or visit an attacker-controlled web page with a malicious map embedded via an \u003ccode\u003eiframe\u003c/code\u003e. \u003c/p\u003e\n\n\u003cp\u003eHussain created a \u003ca href=\"/redirect?url=https%3A%2F%2Fa.tiles.mapbox.com%2Fv4%2Fibmsecurity.ma91e43j%2Fpage.html%3Faccess_token%3Dpk.eyJ1IjoiaWJtc2VjdXJpdHkiLCJhIjoiOWI0NDYxYjVmMjYzNjE2Yjc1ODM5NDgxOTBmMTFkODEifQ.EIBxJM1o7YiuI4pgZ7bsjg\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003emap\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e in the online classic map editor and added several XSS payloads to a few map markers.\u003c/p\u003e\n\n\u003cp\u003eThe payload \u003ccode\u003e\u0026amp;lt;img src=x onerror=alert(1) \u0026quot;\u003c/code\u003e evaded sanitization and executed arbitrary JavaScript immediately. The payload was added to the DOM as part of a list of map marker titles in the top left hand corner of the share page.\u003c/p\u003e\n\n\u003cp\u003eThe following old code in \u003ca title=\"https://a.tiles.mapbox.com/v3/embed/share.js\" href=\"/redirect?url=https%3A%2F%2Fa.tiles.mapbox.com%2Fv3%2Fembed%2Fshare.js\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://a.tiles.mapbox.com/v3/embed/share.js\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e and \u003ca title=\"https://a.tiles.mapbox.com/v4/embed/share.js\" href=\"/redirect?url=https%3A%2F%2Fa.tiles.mapbox.com%2Fv4%2Fembed%2Fshare.js\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://a.tiles.mapbox.com/v4/embed/share.js\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e was vulnerable:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003efunction stripHTML(html) {\n   var tmp = document.createElement(\u0026#39;DIV\u0026#39;);\n   tmp.innerHTML = L.mapbox.sanitize(html);\n   return tmp.textContent || tmp.innerText || \u0026#39;\u0026#39;;\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThe \u003ccode\u003estripHTML\u003c/code\u003e function returned \u003ccode\u003e\u0026lt;img src=x onerror=alert(1) \u0026quot;\u003c/code\u003e due to the use of \u003ccode\u003etextContent\u003c/code\u003e, which converted the \u003ccode\u003e\u0026amp;lt;\u003c/code\u003e HTML entity into the left angle bracket unicode character (\u003ccode\u003e\u0026lt;\u003c/code\u003e). As a result, the payload was added to the share page as \u003ccode\u003e\u0026lt;img src=x onerror=alert(1) \u0026quot;\u003c/code\u003e, executing \u003ccode\u003ealert(1)\u003c/code\u003e on error when loading the image with no source.\u003c/p\u003e\n\n\u003cp\u003eWe resolved the issue by using underscore\u0026#39;s \u003ca href=\"/redirect?url=http%3A%2F%2Funderscorejs.org%2F%23escape\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eescape function\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e before returning the \u003ccode\u003etextContent\u003c/code\u003e of the marker. \u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003efunction stripHTML(html) {\n   var tmp = document.createElement(\u0026#39;DIV\u0026#39;);\n   tmp.innerHTML = L.mapbox.sanitize(html);\n   return _.escape(tmp.textContent || tmp.innerText || \u0026#39;\u0026#39;);\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eAs seen in \u003ca href=\"/redirect?url=https%3A%2F%2Fa.tiles.mapbox.com%2Fv4%2Falulsh.pnbm6b4b%2Fpage.html%3Faccess_token%3Dpk.eyJ1IjoiYWx1bHNoIiwiYSI6ImY0NDBjYTQ1NjU4OGJmMDFiMWQ1Y2RmYjRlMGI1ZjIzIn0.pngboKEPsfuC4j54XDT3VA%233%2F61.73%2F41.92\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ethis map\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e, the map marker title is \u003ccode\u003e\u0026lt;img src=x onerror=alert(1)\u0026quot;\u003c/code\u003e now instead of a broken image tag.\u003c/p\u003e\n"},{"category":"researcher","can_view?":true,"can_create?":false}]}