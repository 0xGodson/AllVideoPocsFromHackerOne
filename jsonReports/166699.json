{"id":166699,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNjY2OTk=","url":"https://hackerone.com/reports/166699","title":"Reflected xss on websummit.net","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-09-07T22:51:25.008Z","submitted_at":"2016-09-07T22:51:25.008Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"rubyroobs","url":"/rubyroobs","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/YuP2sjmN1w1T8hg6ohLXKcbn/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":11973,"url":"https://hackerone.com/websummit","handle":"websummit","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/011/973/3423163f6fc6f425635d7f0695cf789524e11872_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/011/973/3423163f6fc6f425635d7f0695cf789524e11872_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"paused","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"WebSummit","twitter_handle":"","website":"http://videos.websummit.net","about":"Videos of Web Summit Talks"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2016-10-04T23:32:19.401Z","bug_reporter_agreed_on_going_public_at":"2016-10-04T23:32:19.361Z","team_member_agreed_on_going_public_at":"2016-10-04T23:31:31.317Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hey guys,\n\n**TL;DR:** Reflected XSS on `websummit.net/attendees/featured-attendees` as the `q` parameter is directly reflecting special characters in the `data-url` on the handlebars template section of the page, as opposed to URL encoding them.\n\n**Proof of Concept:**\nVisit [https://websummit.net/attendees/featured-attendees?q=rubyoob%27%3E%3Ciframe/onload=alert(document.domain)%3E%3C/iframe%3E](https://websummit.net/attendees/featured-attendees?q=rubyoob%27%3E%3Ciframe/onload=alert\\(document.domain\\)%3E%3C/iframe%3E]). I've tested this on all modern browsers (latest Chrome, Firefox and Edge).\n\n**Mitigation:** \nTo mitigate this issue, I'd recommend URL encoding special characters when creating the `data-url` parameter server-side.\n\nAt the moment, visiting my proof of concept would generate HTML like:\n`\u003cscript id=\"fa-list\" class='api-json' data-target='#attendees' data-url='https://api.cilabs.net/v1/conferences/ws16/info/attendees?limit=25\u0026q=rubyoob'\u003e\u003ciframe/onload=alert(document.domain)\u003e\u003c/iframe\u003e,' type='text/x-handlebars-template' data-page=\"1\"\u003e`\n\nIt should be generating something similar to:\n`\u003cscript id=\"fa-list\" class='api-json' data-target='#attendees' data-url='https://api.cilabs.net/v1/conferences/ws16/info/attendees?limit=25\u0026q=rubyoob%27%3E%3Ciframe%2Fonload%3Dalert(document.domain)%3E%3C%2Fiframe%3E,' type='text/x-handlebars-template' data-page=\"1\"\u003e`\n\nThis would allow all API requests to go through without interruption and stop attackers from executing arbitrary javascript on the page.\n\nCheers,\n@rubyroobs","vulnerability_information_html":"\u003cp\u003eHey guys,\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eTL;DR:\u003c/strong\u003e Reflected XSS on \u003ccode\u003ewebsummit.net/attendees/featured-attendees\u003c/code\u003e as the \u003ccode\u003eq\u003c/code\u003e parameter is directly reflecting special characters in the \u003ccode\u003edata-url\u003c/code\u003e on the handlebars template section of the page, as opposed to URL encoding them.\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eProof of Concept:\u003c/strong\u003e\u003cbr\u003e\nVisit \u003ca href=\"/redirect?url=https%3A%2F%2Fwebsummit.net%2Fattendees%2Ffeatured-attendees%3Fq%3Drubyoob%2527%253E%253Ciframe%2Fonload%3Dalert%28document.domain%29%253E%253C%2Fiframe%253E%255D\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://websummit.net/attendees/featured-attendees?q=rubyoob%27%3E%3Ciframe/onload=alert(document.domain)%3E%3C/iframe%3E\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e. I\u0026#39;ve tested this on all modern browsers (latest Chrome, Firefox and Edge).\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eMitigation:\u003c/strong\u003e \u003cbr\u003e\nTo mitigate this issue, I\u0026#39;d recommend URL encoding special characters when creating the \u003ccode\u003edata-url\u003c/code\u003e parameter server-side.\u003c/p\u003e\n\n\u003cp\u003eAt the moment, visiting my proof of concept would generate HTML like:\u003cbr\u003e\n\u003ccode\u003e\u0026lt;script id=\u0026quot;fa-list\u0026quot; class=\u0026#39;api-json\u0026#39; data-target=\u0026#39;#attendees\u0026#39; data-url=\u0026#39;https://api.cilabs.net/v1/conferences/ws16/info/attendees?limit=25\u0026amp;q=rubyoob\u0026#39;\u0026gt;\u0026lt;iframe/onload=alert(document.domain)\u0026gt;\u0026lt;/iframe\u0026gt;,\u0026#39; type=\u0026#39;text/x-handlebars-template\u0026#39; data-page=\u0026quot;1\u0026quot;\u0026gt;\u003c/code\u003e\u003c/p\u003e\n\n\u003cp\u003eIt should be generating something similar to:\u003cbr\u003e\n\u003ccode\u003e\u0026lt;script id=\u0026quot;fa-list\u0026quot; class=\u0026#39;api-json\u0026#39; data-target=\u0026#39;#attendees\u0026#39; data-url=\u0026#39;https://api.cilabs.net/v1/conferences/ws16/info/attendees?limit=25\u0026amp;q=rubyoob%27%3E%3Ciframe%2Fonload%3Dalert(document.domain)%3E%3C%2Fiframe%3E,\u0026#39; type=\u0026#39;text/x-handlebars-template\u0026#39; data-page=\u0026quot;1\u0026quot;\u0026gt;\u003c/code\u003e\u003c/p\u003e\n\n\u003cp\u003eThis would allow all API requests to go through without interruption and stop attackers from executing arbitrary javascript on the page.\u003c/p\u003e\n\n\u003cp\u003eCheers,\u003cbr\u003e\n\u003ca href=\"/rubyroobs\"\u003e@rubyroobs\u003c/a\u003e\u003c/p\u003e\n","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2016-11-03T23:31:31.359Z","allow_singular_disclosure_after":-131000866.02927534,"singular_disclosure_allowed":true,"vote_count":3,"voters":["spetr0x","dyabla","mizutani"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1181281,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"(By the way, I'm aware this is out of scope but I thought it was worth a mention as it's your main website! Apologies if it's not something you're interested in.)","markdown_message":"\u003cp\u003e(By the way, I\u0026#39;m aware this is out of scope but I thought it was worth a mention as it\u0026#39;s your main website! Apologies if it\u0026#39;s not something you\u0026#39;re interested in.)\u003c/p\u003e\n","automated_response":false,"created_at":"2016-09-07T22:52:29.104Z","updated_at":"2016-09-07T22:52:29.104Z","actor":{"username":"rubyroobs","cleared":true,"url":"/rubyroobs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YuP2sjmN1w1T8hg6ohLXKcbn/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"websummit","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1181755,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hi Ruby,\nVerified, looking into a fix now.\nMany thanks,\nVinny","markdown_message":"\u003cp\u003eHi Ruby,\u003cbr\u003e\nVerified, looking into a fix now.\u003cbr\u003e\nMany thanks,\u003cbr\u003e\nVinny\u003c/p\u003e\n","automated_response":false,"created_at":"2016-09-08T07:34:30.835Z","updated_at":"2016-09-08T07:34:30.835Z","actor":{"username":"vinnyglennon","cleared":false,"url":"/vinnyglennon","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"websummit","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1196266,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I plan to move over to Algolia for this, which will also fix the XSS attack. I will keep you informed\nBest,\nVinny","markdown_message":"\u003cp\u003eI plan to move over to Algolia for this, which will also fix the XSS attack. I will keep you informed\u003cbr\u003e\nBest,\u003cbr\u003e\nVinny\u003c/p\u003e\n","automated_response":false,"created_at":"2016-09-15T13:30:46.877Z","updated_at":"2016-09-15T13:30:46.877Z","actor":{"username":"vinnyglennon","cleared":false,"url":"/vinnyglennon","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"websummit","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1196276,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Awesome @vinnyglennon! Algolia [have a paid bug bounty programme](https://hackerone.com/algolia) - could you ask them if it's something they'd payout on and whether I should submit it there?\n\nCheers.\n@rubyroobs ","markdown_message":"\u003cp\u003eAwesome \u003ca href=\"/vinnyglennon\"\u003e@vinnyglennon\u003c/a\u003e! Algolia \u003ca href=\"https://hackerone.com/algolia\"\u003ehave a paid bug bounty programme\u003c/a\u003e - could you ask them if it\u0026#39;s something they\u0026#39;d payout on and whether I should submit it there?\u003c/p\u003e\n\n\u003cp\u003eCheers.\u003cbr\u003e\n\u003ca href=\"/rubyroobs\"\u003e@rubyroobs\u003c/a\u003e \u003c/p\u003e\n","automated_response":false,"created_at":"2016-09-15T13:35:16.396Z","updated_at":"2016-09-15T13:35:16.396Z","actor":{"username":"rubyroobs","cleared":true,"url":"/rubyroobs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YuP2sjmN1w1T8hg6ohLXKcbn/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"websummit","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1196396,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@vinnyglennon my bad sorry - I thought you meant you were passing this issue on to Algolia! Apologies. Thanks for the update!","markdown_message":"\u003cp\u003e\u003ca href=\"/vinnyglennon\"\u003e@vinnyglennon\u003c/a\u003e my bad sorry - I thought you meant you were passing this issue on to Algolia! Apologies. Thanks for the update!\u003c/p\u003e\n","automated_response":false,"created_at":"2016-09-15T14:26:18.570Z","updated_at":"2016-09-15T14:26:18.570Z","actor":{"username":"rubyroobs","cleared":true,"url":"/rubyroobs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YuP2sjmN1w1T8hg6ohLXKcbn/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"websummit","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1232176,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@vinnyglennon issue appears to be fixed!","markdown_message":"\u003cp\u003e\u003ca href=\"/vinnyglennon\"\u003e@vinnyglennon\u003c/a\u003e issue appears to be fixed!\u003c/p\u003e\n","automated_response":false,"created_at":"2016-10-04T20:54:39.768Z","updated_at":"2016-10-04T20:54:39.768Z","actor":{"username":"rubyroobs","cleared":true,"url":"/rubyroobs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YuP2sjmN1w1T8hg6ohLXKcbn/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"websummit","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1232429,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Correct, we just pushed a fix today, to use Algolia instead. \nMany thanks,\nLet me know if you find any others,\nVinny","markdown_message":"\u003cp\u003eCorrect, we just pushed a fix today, to use Algolia instead. \u003cbr\u003e\nMany thanks,\u003cbr\u003e\nLet me know if you find any others,\u003cbr\u003e\nVinny\u003c/p\u003e\n","automated_response":false,"created_at":"2016-10-04T23:31:03.166Z","updated_at":"2016-10-04T23:31:03.166Z","actor":{"username":"vinnyglennon","cleared":false,"url":"/vinnyglennon","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"rubyroobs","url":"/rubyroobs"},"genius_execution_id":null,"team_handle":"websummit","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1232432,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-10-04T23:31:31.338Z","updated_at":"2016-10-04T23:31:31.338Z","first_to_agree":true,"actor":{"username":"vinnyglennon","cleared":false,"url":"/vinnyglennon","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"websummit","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1232437,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Awesome :) Let's disclose!","markdown_message":"\u003cp\u003eAwesome :) Let\u0026#39;s disclose!\u003c/p\u003e\n","automated_response":false,"created_at":"2016-10-04T23:32:19.375Z","updated_at":"2016-10-04T23:32:19.375Z","actor":{"username":"rubyroobs","cleared":true,"url":"/rubyroobs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YuP2sjmN1w1T8hg6ohLXKcbn/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"websummit","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1232438,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-10-04T23:32:19.415Z","updated_at":"2016-10-04T23:32:19.415Z","actor":{"username":"rubyroobs","cleared":true,"url":"/rubyroobs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YuP2sjmN1w1T8hg6ohLXKcbn/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"websummit","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}