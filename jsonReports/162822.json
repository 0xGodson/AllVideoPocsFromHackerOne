{"id":162822,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNjI4MjI=","url":"https://hackerone.com/reports/162822","title":"Fetch private list metadata and any user's personal name","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-08-23T20:34:15.225Z","submitted_at":"2016-08-23T20:34:15.225Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"sameoldstory","url":"/sameoldstory","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/096/923/44c14c32450369140f1d9943753d37475ae8884c_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":555,"url":"https://hackerone.com/instacart","handle":"instacart","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/555/df662b77c791ed1296275d032f446300e1a5a6b3_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/555/df662b77c791ed1296275d032f446300e1a5a6b3_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Instacart","twitter_handle":"instacart","website":"https://www.instacart.com/","about":"Same-day grocery delivery"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2016-09-12T20:00:01.013Z","bug_reporter_agreed_on_going_public_at":"2016-08-27T07:14:07.632Z","team_member_agreed_on_going_public_at":"2016-09-12T20:00:00.886Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Overview\n==\nWhen a user creates a list, they can choose whether to make the list visible in search and whether to show their name with the list. The problem is that the attacker can still access the information that the user chose to hide. Furthermore, if the attacker gets hold of a user's ID, they can find out user's personal name irrespective of whether the user has created any lists at all.\n\nSteps to Reproduce\n==\nBoth the victim and the attacker have to be Instacart users.\n\n1. Victim creates a list and unchecks both \"visible in search\" and \"show my name\" boxes.\n2. Victim shares the link publicly.\n3. Attacker follows the shared link and adds the list to favorites. The response from the server reveals the list metadata including victim's personal name, list title, description and images:\n\n    ```\n    POST /api/v2/lists/10/star_toggle\n    \n    {\n      \"meta\": {\n        \"code\": 200\n      },\n      \"data\": {\n        \"id\": 10,\n        \"name\": \"Test\",\n        \"description\": \"This is the description of a shopping list\",\n        \"user_id\": 10,\n        \"visible\": false,\n        ...\n        \"user_name\": \"Apoorva M\",\n        ...\n      }\n    ```\n\nSecurity Implications\n==\n\nThe attacker can use the `star_toggle` endpoint to obtain metadata of any list regardless of what the `visible` flag is set to. Since list ID is incremental it doesn't take much effort to obtain metadata for all Instacart lists, both public and private.\n\nAdditional Exploit\n==\n\nThere's one more endpoint that, although doesn't reveal nearly as much information, does reveal victim's personal name and doesn't even require the victim to have any lists:\n\n```\nGET /api/v2/lists?user_id=10\n\n{\"meta\":{\"code\":200,\"author_name\":\"Apoorva M\"},\"data\":[],\"pagination\":{\"total\":0,\"per_page\":0,\"page\":1}}\n```\n\nThe attacker can either look up personal name of the user they're interested in, or simply dump whole list of Instacart users personal names, since the user ID is also incremental.","vulnerability_information_html":"\u003ch1 id=\"overview\"\u003eOverview\u003c/h1\u003e\n\n\u003cp\u003eWhen a user creates a list, they can choose whether to make the list visible in search and whether to show their name with the list. The problem is that the attacker can still access the information that the user chose to hide. Furthermore, if the attacker gets hold of a user\u0026#39;s ID, they can find out user\u0026#39;s personal name irrespective of whether the user has created any lists at all.\u003c/p\u003e\n\n\u003ch1 id=\"steps-to-reproduce\"\u003eSteps to Reproduce\u003c/h1\u003e\n\n\u003cp\u003eBoth the victim and the attacker have to be Instacart users.\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eVictim creates a list and unchecks both \u0026quot;visible in search\u0026quot; and \u0026quot;show my name\u0026quot; boxes.\u003c/li\u003e\n\u003cli\u003eVictim shares the link publicly.\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eAttacker follows the shared link and adds the list to favorites. The response from the server reveals the list metadata including victim\u0026#39;s personal name, list title, description and images:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ePOST /api/v2/lists/10/star_toggle\n\n{\n  \u0026quot;meta\u0026quot;: {\n    \u0026quot;code\u0026quot;: 200\n  },\n  \u0026quot;data\u0026quot;: {\n    \u0026quot;id\u0026quot;: 10,\n    \u0026quot;name\u0026quot;: \u0026quot;Test\u0026quot;,\n    \u0026quot;description\u0026quot;: \u0026quot;This is the description of a shopping list\u0026quot;,\n    \u0026quot;user_id\u0026quot;: 10,\n    \u0026quot;visible\u0026quot;: false,\n    ...\n    \u0026quot;user_name\u0026quot;: \u0026quot;Apoorva M\u0026quot;,\n    ...\n  }\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003ch1 id=\"security-implications\"\u003eSecurity Implications\u003c/h1\u003e\n\n\u003cp\u003eThe attacker can use the \u003ccode\u003estar_toggle\u003c/code\u003e endpoint to obtain metadata of any list regardless of what the \u003ccode\u003evisible\u003c/code\u003e flag is set to. Since list ID is incremental it doesn\u0026#39;t take much effort to obtain metadata for all Instacart lists, both public and private.\u003c/p\u003e\n\n\u003ch1 id=\"additional-exploit\"\u003eAdditional Exploit\u003c/h1\u003e\n\n\u003cp\u003eThere\u0026#39;s one more endpoint that, although doesn\u0026#39;t reveal nearly as much information, does reveal victim\u0026#39;s personal name and doesn\u0026#39;t even require the victim to have any lists:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eGET /api/v2/lists?user_id=10\n\n{\u0026quot;meta\u0026quot;:{\u0026quot;code\u0026quot;:200,\u0026quot;author_name\u0026quot;:\u0026quot;Apoorva M\u0026quot;},\u0026quot;data\u0026quot;:[],\u0026quot;pagination\u0026quot;:{\u0026quot;total\u0026quot;:0,\u0026quot;per_page\u0026quot;:0,\u0026quot;page\u0026quot;:1}}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThe attacker can either look up personal name of the user they\u0026#39;re interested in, or simply dump whole list of Instacart users personal names, since the user ID is also incremental.\u003c/p\u003e\n","bounty_amount":"150.0","formatted_bounty":"$150","weakness":{"id":18,"name":"Information Disclosure"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2016-09-26T07:14:07.764Z","allow_singular_disclosure_after":-134342603.45226383,"singular_disclosure_allowed":true,"vote_count":6,"voters":["yaworsk","sasi2103","mr_sharma_","s44mux","dyabla","thomas702"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1151877,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2016-08-24T15:50:05.769Z","updated_at":"2016-08-24T15:50:05.769Z","actor":{"username":"anf","cleared":false,"url":"/anf","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/569/6f3c5a7f7e76bc75a837f2b4ce698afe4e88d5e6_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"instacart","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1151880,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you for the report, I'm looking into it.","markdown_message":"\u003cp\u003eThank you for the report, I\u0026#39;m looking into it.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-24T15:50:24.659Z","updated_at":"2016-08-24T15:50:24.659Z","actor":{"username":"anf","cleared":false,"url":"/anf","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/569/6f3c5a7f7e76bc75a837f2b4ce698afe4e88d5e6_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"instacart","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1156235,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hello @sameoldstory,\n\nThis should now be fixed, can you confirm?","markdown_message":"\u003cp\u003eHello \u003ca href=\"/sameoldstory\"\u003e@sameoldstory\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThis should now be fixed, can you confirm?\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-26T17:16:03.392Z","updated_at":"2016-08-26T17:16:03.392Z","actor":{"username":"anf","cleared":false,"url":"/anf","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/569/6f3c5a7f7e76bc75a837f2b4ce698afe4e88d5e6_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"sameoldstory","url":"/sameoldstory"},"genius_execution_id":null,"team_handle":"instacart","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1156375,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"The vulnerabilities seem to be fixed, however have you tried to add any public recipe to your favorites? The endpoint seems to return 400 to me even for public recipes.","markdown_message":"\u003cp\u003eThe vulnerabilities seem to be fixed, however have you tried to add any public recipe to your favorites? The endpoint seems to return 400 to me even for public recipes.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-26T18:06:48.468Z","updated_at":"2016-08-26T18:06:48.468Z","actor":{"username":"sameoldstory","cleared":false,"url":"/sameoldstory","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/096/923/44c14c32450369140f1d9943753d37475ae8884c_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"instacart","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1156837,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Haha you are totally right, I went a little overboard with the fix. Deploying the new fix right now. Thanks for checking!","markdown_message":"\u003cp\u003eHaha you are totally right, I went a little overboard with the fix. Deploying the new fix right now. Thanks for checking!\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-26T21:08:22.922Z","updated_at":"2016-08-26T21:08:22.922Z","actor":{"url":"/instacart","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/555/df662b77c791ed1296275d032f446300e1a5a6b3_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Instacart"}},"bounty_amount":"150.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"instacart","collaborator":{"username":"sameoldstory","url":"/sameoldstory"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1157333,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Let's disclose the report publicly? I don't think there is any sensitive info in either the report or the commets, but feel free to redact any parts that you consider confidential.","markdown_message":"\u003cp\u003eLet\u0026#39;s disclose the report publicly? I don\u0026#39;t think there is any sensitive info in either the report or the commets, but feel free to redact any parts that you consider confidential.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-27T07:14:07.712Z","updated_at":"2016-08-27T07:14:07.712Z","first_to_agree":true,"actor":{"username":"sameoldstory","cleared":false,"url":"/sameoldstory","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/096/923/44c14c32450369140f1d9943753d37475ae8884c_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"instacart","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1189473,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-09-12T20:00:00.945Z","updated_at":"2016-09-12T20:00:00.945Z","actor":{"username":"anf","cleared":false,"url":"/anf","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/569/6f3c5a7f7e76bc75a837f2b4ce698afe4e88d5e6_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"instacart","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1189474,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-09-12T20:00:01.071Z","updated_at":"2016-09-12T20:00:01.071Z","actor":{"username":"anf","cleared":false,"url":"/anf","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/569/6f3c5a7f7e76bc75a837f2b4ce698afe4e88d5e6_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"instacart","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}