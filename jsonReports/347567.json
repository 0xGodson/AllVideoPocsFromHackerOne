{"id":347567,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zNDc1Njc=","url":"https://hackerone.com/reports/347567","title":"XSS in \"explore-keywords-dropdown\" results.","state":"Closed","substate":"resolved","severity_rating":"none","readable_substate":"Resolved","created_at":"2018-05-04T17:16:05.673Z","submitted_at":"2018-05-04T17:16:05.673Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"gcurtiss_","url":"/gcurtiss_","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":2943,"url":"https://hackerone.com/zomato","handle":"zomato","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/002/943/71b47f9aa21166f0989dfb97112ca10c66a9d0b2_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/943/71b47f9aa21166f0989dfb97112ca10c66a9d0b2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Zomato","twitter_handle":"Zomato","website":"https://www.zomato.com","about":"The fastest way to search for great places to eat at and order from around you. Serving 24 countries worldwide."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2018-05-09T18:06:18.659Z","bug_reporter_agreed_on_going_public_at":"2018-05-09T18:06:18.593Z","team_member_agreed_on_going_public_at":"2018-05-09T18:03:18.137Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"It seems that people have exploited this vulnerability before on this website, however, it remains unpatched, so here I am reporting the vulnerability.\n\nA XSS vulnerability exists when a restaurant or dish is created with a malicious name. The title of the dish or restaurant is not properly filtered by the web application. Any code in the dish or restaurant name is executed on the client.\n\nDEMO: https://www.zomato.com/kingman-ks/restaurants, search for: single quote, double quote, GT angle bracket. '\"\u003e\n\n## Impact\n\nAn attacker could achieve XSS and inject hooks into the web browser (e.g. BeEF)","vulnerability_information_html":"\u003cp\u003eIt seems that people have exploited this vulnerability before on this website, however, it remains unpatched, so here I am reporting the vulnerability.\u003c/p\u003e\n\n\u003cp\u003eA XSS vulnerability exists when a restaurant or dish is created with a malicious name. The title of the dish or restaurant is not properly filtered by the web application. Any code in the dish or restaurant name is executed on the client.\u003c/p\u003e\n\n\u003cp\u003eDEMO: \u003ca title=\"https://www.zomato.com/kingman-ks/restaurants\" href=\"/redirect?url=https%3A%2F%2Fwww.zomato.com%2Fkingman-ks%2Frestaurants\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.zomato.com/kingman-ks/restaurants\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e, search for: single quote, double quote, GT angle bracket. \u0026#39;\u0026quot;\u0026gt;\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eAn attacker could achieve XSS and inject hooks into the web browser (e.g. BeEF)\u003c/p\u003e\n","weakness":{"id":61,"name":"Cross-site Scripting (XSS) - Reflected"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":2,"voters":["eveeez","apapedulimu"],"severity":{"rating":"none","author_type":"Team"},"structured_scope":{"databaseId":383,"asset_type":"URL","asset_identifier":"*.zomato.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":2701357,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2018-05-04T17:41:50.966Z","updated_at":"2018-05-04T17:41:50.966Z","additional_data":{"old_severity":null,"new_severity":"Medium","old_severity_id":null,"new_severity_id":149561},"actor":{"username":"gcurtiss_","cleared":false,"url":"/gcurtiss_","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2704011,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for your report! We need some more information before we can adequately review this report. Is it possible you could provide a clear step-by-step PoC showing your vulnerability?  Thanks again for your report and we hope to hear back from you soon.\n\nKind regards.","markdown_message":"\u003cp\u003eThanks for your report! We need some more information before we can adequately review this report. Is it possible you could provide a clear step-by-step PoC showing your vulnerability?  Thanks again for your report and we hope to hear back from you soon.\u003c/p\u003e\n\n\u003cp\u003eKind regards.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-05-05T15:59:31.717Z","updated_at":"2018-05-05T15:59:31.717Z","actor":{"username":"chessmast3r","cleared":false,"url":"/chessmast3r","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/220/459/6b3c5fca9df9cde7fe36b55238b13d2cea86ea80_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2704169,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"1. Create a restaurant at https://www.zomato.com/addrestaurant. A bit of social engineering has to be used here since it is ran through a content moderation team. Make the restaurant seem legitimate.\n2. Once approved by the content moderation team, you may modify the restaurant.\n3. Add a dish with a unique name so that when searched for it will show up in the search results uniquely. (e.g. \"THISISACOOLNAME(payload)\"\n\n**There is absolutely no escaping or filtering in the explore-keywords-dropdown field. You can use numerous payloads:**\n\n'\"\u003e%0D%0A%0D%0A\u003csvg/onload=alert(1);\u003e\nor, in this extreme payload that somebody executed (see attachment) (note that in the screenshot i disabled alerts because it constantly was flooding me with alerts)","markdown_message":"\u003col\u003e\n\u003cli\u003eCreate a restaurant at \u003ca title=\"https://www.zomato.com/addrestaurant\" href=\"/redirect?url=https%3A%2F%2Fwww.zomato.com%2Faddrestaurant\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.zomato.com/addrestaurant\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e. A bit of social engineering has to be used here since it is ran through a content moderation team. Make the restaurant seem legitimate.\u003c/li\u003e\n\u003cli\u003eOnce approved by the content moderation team, you may modify the restaurant.\u003c/li\u003e\n\u003cli\u003eAdd a dish with a unique name so that when searched for it will show up in the search results uniquely. (e.g. \u0026quot;THISISACOOLNAME(payload)\u0026quot;\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003e\u003cstrong\u003eThere is absolutely no escaping or filtering in the explore-keywords-dropdown field. You can use numerous payloads:\u003c/strong\u003e\u003c/p\u003e\n\n\u003cp\u003e\u0026#39;\u0026quot;\u0026gt;%0D%0A%0D%0A\u0026lt;svg/onload=alert(1);\u0026gt;\u003cbr\u003e\nor, in this extreme payload that somebody executed (see attachment) (note that in the screenshot i disabled alerts because it constantly was flooding me with alerts)\u003c/p\u003e\n","automated_response":false,"created_at":"2018-05-05T17:29:42.400Z","updated_at":"2018-05-05T17:29:42.400Z","actor":{"username":"gcurtiss_","cleared":false,"url":"/gcurtiss_","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"attachments":[{"id":294100,"filename":"Capture.PNG","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/294/100/2be7defd82f124232dcd3167db65813c9103e4cb/Capture.PNG?response-content-disposition=attachment%3B%20filename%3D%22Capture.PNG%22%3B%20filename%2A%3DUTF-8%27%27Capture.PNG\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQYENXQUKC%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T054036Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHXwr%2Bz%2B7j54GXjIZDeFjE7V4KhtcLVpveDKyRp%2FgHMpAiEA%2FzBLaI4tlPUnNvgzY0X8n68OkDDLSfCBmjTZSd2A%2BM8qtAMIVRABGgwwMTM2MTkyNzQ4NDkiDOLyu53NKIhzdiDnLyqRA1YiznmwUquOZL6cfEwHlrCEbfV1uip5mxrCKpzmpc9DKyYejzEqNMg8%2Fo1XQZiQbQ9Mn8QGMjtqUBvpzsRmfLsdw4KO6Yix26%2Foq9H6jcEfUIX3EyFaY0ofGk42HT5lnakJ%2FUAtv5lyqirA3laDcoq6u60WpxBZh0jLi92Ajs9kGkzDbgWJPXMK2%2FlVglZWa%2BjQNhDftrEqJh4ZV%2FIwfbcJ6s89eju9B4Xkun1IUiVjrUtA5LTMlkDAEwqtGdl3pucepUSB2hZBvbqUfgiT65T%2BpLDNg0LFqEXPPPqqyrYG3%2BqTXIZxR1FfbdXOQjx1UoPwboCHOwSOpOKGaPs6TEM2o6Sg2U%2BGvuy3dMdtNBCfH4SIfBdeUa84eWUftCR4OwBiC0F1Cl6iPIZXa92zkJSAVTz9swPvr%2BghYLYGIjX%2F8jqVGlADsLB1sl%2BqlNRFkwYrvTDOWwnYmDuvQmmhpAQ6Mg%2Fp05v07WKHRsbG%2BAUzVJ3M02i0HIdWCGKjqKXgGZi%2FLBrHUEV9bzaVWmpeFEE3MObUqv8FOusBMEus3670kEKa62xVKQkID%2Fav5Xylzf384wPv9i4fBKmwghqKR67wSDPkErUtnTlN6wJNos0uBd5jibop6zjPh%2BDMaeI%2Bt4z0CbNpMS83WKn2xS%2FvSK0QFyg217PkDWCKklNPmbumtDteHdU2qRRX%2BQwVoTBmoRFgs97OyKXEz2rc7ZIcHuDnAibsNVPNZEuX9m%2B04KKBBkwdIr0sY3zEiVHvTVxPYBSsKfBPuZwzi6W3T3aq%2BF9l860FnFBaV964%2BlbASqZkuTd4cEZ8C2GJad6RyY164GfHgpKnmQ6aYbLhiDTz0xF3adlmhg%3D%3D\u0026X-Amz-Signature=6f9af451047199e9c12a6cb2f5c46cbed8bf3f1177360e279564ab9a42d18947"}],"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2706145,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"Hi @gcurtiss_ \n\nThanks for your submission. Unfortunately Social Engineering is OOS. Also, the one's you're seeing are the old payloads which haven't been removed yet and would be removed soon.\n\n\u003e Add a dish with a unique name so that when searched for it will show up in the search results uniquely. (e.g. \"THISISACOOLNAME(payload)\"\n\nThis use to happen earlier and was fixed. Nonetheless, we appreciate your efforts and we will look forward to receive interesting reports from you.\n\nHappy Hunting :) Cheers.","markdown_message":"\u003cp\u003eHi \u003ca href=\"/gcurtiss_\"\u003e@gcurtiss_\u003c/a\u003e \u003c/p\u003e\n\n\u003cp\u003eThanks for your submission. Unfortunately Social Engineering is OOS. Also, the one\u0026#39;s you\u0026#39;re seeing are the old payloads which haven\u0026#39;t been removed yet and would be removed soon.\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eAdd a dish with a unique name so that when searched for it will show up in the search results uniquely. (e.g. \u0026quot;THISISACOOLNAME(payload)\u0026quot;\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eThis use to happen earlier and was fixed. Nonetheless, we appreciate your efforts and we will look forward to receive interesting reports from you.\u003c/p\u003e\n\n\u003cp\u003eHappy Hunting :) Cheers.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-05-06T14:27:28.398Z","updated_at":"2018-05-06T14:27:28.398Z","actor":{"username":"prateek_0490-zomato","cleared":false,"url":"/prateek_0490-zomato","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/CL56d6XwY4TN3eHc73df8AEU/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2720849,"is_internal":false,"editable":false,"type":"Activities::BugReopened","message":"Hi @gcurtiss_ \n\nAlthough this didn't posed any risk as these were old payload(s) which were just not removed from our db, but since we took action based on your report and cleaned up the malicious scripts, we're happy to provide you with the reputation points which would help your Signal :)\n\nCheers.","markdown_message":"\u003cp\u003eHi \u003ca href=\"/gcurtiss_\"\u003e@gcurtiss_\u003c/a\u003e \u003c/p\u003e\n\n\u003cp\u003eAlthough this didn\u0026#39;t posed any risk as these were old payload(s) which were just not removed from our db, but since we took action based on your report and cleaned up the malicious scripts, we\u0026#39;re happy to provide you with the reputation points which would help your Signal :)\u003c/p\u003e\n\n\u003cp\u003eCheers.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-05-09T17:32:52.251Z","updated_at":"2018-05-09T17:32:52.251Z","actor":{"username":"prateek_0490-zomato","cleared":false,"url":"/prateek_0490-zomato","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/CL56d6XwY4TN3eHc73df8AEU/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2720851,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2018-05-09T17:33:07.806Z","updated_at":"2018-05-09T17:33:07.806Z","actor":{"username":"prateek_0490-zomato","cleared":false,"url":"/prateek_0490-zomato","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/CL56d6XwY4TN3eHc73df8AEU/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"gcurtiss_","url":"/gcurtiss_"},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2720852,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"","markdown_message":"","automated_response":false,"created_at":"2018-05-09T17:33:22.537Z","updated_at":"2018-05-09T17:33:22.537Z","actor":{"url":"/zomato","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/943/71b47f9aa21166f0989dfb97112ca10c66a9d0b2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Zomato"}},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2720853,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2018-05-09T17:33:33.415Z","updated_at":"2018-05-09T17:33:33.415Z","additional_data":{"old_severity":"Medium","new_severity":"None","old_severity_id":149561,"new_severity_id":151477},"actor":{"username":"prateek_0490-zomato","cleared":false,"url":"/prateek_0490-zomato","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/CL56d6XwY4TN3eHc73df8AEU/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2720858,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you!","markdown_message":"\u003cp\u003eThank you!\u003c/p\u003e\n","automated_response":false,"created_at":"2018-05-09T17:34:32.912Z","updated_at":"2018-05-09T17:34:32.912Z","actor":{"username":"gcurtiss_","cleared":false,"url":"/gcurtiss_","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2720916,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-05-09T18:03:18.181Z","updated_at":"2018-05-09T18:03:18.181Z","first_to_agree":true,"actor":{"username":"prateek_0490-zomato","cleared":false,"url":"/prateek_0490-zomato","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/CL56d6XwY4TN3eHc73df8AEU/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2720923,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-05-09T18:06:18.622Z","updated_at":"2018-05-09T18:06:18.622Z","actor":{"username":"gcurtiss_","cleared":false,"url":"/gcurtiss_","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2720924,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-05-09T18:06:18.691Z","updated_at":"2018-05-09T18:06:18.691Z","actor":{"username":"gcurtiss_","cleared":false,"url":"/gcurtiss_","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}