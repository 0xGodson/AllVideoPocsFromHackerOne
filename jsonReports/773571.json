{"id":773571,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC83NzM1NzE=","url":"https://hackerone.com/reports/773571","title":"Local Privilege Escalation on Dropbox Desktop for Windows","state":"Closed","substate":"duplicate","severity_rating":"medium","readable_substate":"Duplicate","created_at":"2020-01-13T14:31:09.103Z","submitted_at":"2020-01-13T14:31:09.103Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"tesitura","url":"/tesitura","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/vwGwBUTaM4GmT3w4rbaowW6F/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":461,"url":"https://hackerone.com/dropbox","handle":"dropbox","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/461/76f193964f418c594dd74ae1326cf4d9223f481b_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/461/76f193964f418c594dd74ae1326cf4d9223f481b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Dropbox","twitter_handle":"","website":"https://www.dropbox.com","about":"Your stuff, anywhere"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"no-content","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2020-09-03T18:50:34.362Z","bug_reporter_agreed_on_going_public_at":"2020-08-18T14:18:09.658Z","team_member_agreed_on_going_public_at":"2020-09-03T18:50:34.197Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"","vulnerability_information_html":"","weakness":{"id":75,"name":"Privilege Escalation"},"original_report_id":382700,"original_report_url":"https://hackerone.com/reports/382700","attachments":[],"allow_singular_disclosure_at":null,"vote_count":7,"voters":["mashoud1122","mygf","salahhasoneh","sa1tama0","h1-qualys-scan","aliasnotallowed","marshrootka"],"severity":{"rating":"medium","author_type":"User"},"structured_scope":{"databaseId":6871,"asset_type":"DOWNLOADABLE_EXECUTABLES","asset_identifier":"Dropbox Desktop","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":6760149,"is_internal":false,"editable":false,"type":"Activities::BugDuplicate","message":"","markdown_message":"","automated_response":false,"created_at":"2020-01-13T20:02:14.595Z","updated_at":"2020-01-13T20:02:14.595Z","original_report_id":382700,"actor":{"username":"rohan","cleared":false,"url":"/rohan","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"dropbox","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6763774,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2020-01-14T08:19:26.312Z","updated_at":"2020-01-14T08:19:26.312Z","actor":{"username":"tesitura","cleared":false,"url":"/tesitura","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/vwGwBUTaM4GmT3w4rbaowW6F/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"dropbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8969298,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-08-18T14:18:09.682Z","updated_at":"2020-08-18T14:18:09.682Z","first_to_agree":true,"actor":{"username":"tesitura","cleared":false,"url":"/tesitura","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/vwGwBUTaM4GmT3w4rbaowW6F/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"dropbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9104590,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2020-09-01T22:59:44.806Z","updated_at":"2020-09-01T22:59:44.806Z","actor":{"username":"bradg-dbx","cleared":false,"url":"/bradg-dbx","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"dropbox","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9104853,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2020-09-02T00:29:31.103Z","updated_at":"2020-09-02T00:29:31.103Z","actor":{"username":"tesitura","cleared":false,"url":"/tesitura","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/vwGwBUTaM4GmT3w4rbaowW6F/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"dropbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9123080,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-09-03T18:50:34.226Z","updated_at":"2020-09-03T18:50:34.226Z","actor":{"username":"bradg-dbx","cleared":false,"url":"/bradg-dbx","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"dropbox","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9123081,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-09-03T18:50:34.402Z","updated_at":"2020-09-03T18:50:34.402Z","actor":{"username":"bradg-dbx","cleared":false,"url":"/bradg-dbx","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"dropbox","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":24273,"category":"team","content":"This report describes a local privilege escalation in the Dropbox automatic updater process on Windows. It would allow a malicious actor who had already gained non-admin access to a Windows computer to obtain admin privileges, if Dropbox had previously been installed with admin privileges. This means the issue is not exploitable remotely (unless a malicious actor has already compromised the computer to obtain remote access). A fix for the issue has been released, and it was applied for existing users through an automatic update.\n\n**Technical Details**\nWhen Dropbox is installed with admin privileges, the automatic updater runs as the Windows `SYSTEM` account. The updater stores logs in the `C:\\ProgramData\\Dropbox\\Update\\Log` directory, which by default is writable by unprivileged users, and it set permissions on the log files that allowed any user to modify them.\n\nAn unprivileged attacker could cause the updater to write log files in a different, privileged directory like `C:\\Windows\\System32` on its next run by modifying the log directory to be a reparse point or creating crafted hard links. After the updater ran, the attacker would be able to replace the log file with malicious content. This would then allow the attacker to run malicious code as a privileged user.\n\nThis issue was fixed by requiring the same privileges as the updater has to modify its log files.","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eThis report describes a local privilege escalation in the Dropbox automatic updater process on Windows. It would allow a malicious actor who had already gained non-admin access to a Windows computer to obtain admin privileges, if Dropbox had previously been installed with admin privileges. This means the issue is not exploitable remotely (unless a malicious actor has already compromised the computer to obtain remote access). A fix for the issue has been released, and it was applied for existing users through an automatic update.\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eTechnical Details\u003c/strong\u003e\u003cbr\u003e\nWhen Dropbox is installed with admin privileges, the automatic updater runs as the Windows \u003ccode\u003eSYSTEM\u003c/code\u003e account. The updater stores logs in the \u003ccode\u003eC:\\ProgramData\\Dropbox\\Update\\Log\u003c/code\u003e directory, which by default is writable by unprivileged users, and it set permissions on the log files that allowed any user to modify them.\u003c/p\u003e\n\n\u003cp\u003eAn unprivileged attacker could cause the updater to write log files in a different, privileged directory like \u003ccode\u003eC:\\Windows\\System32\u003c/code\u003e on its next run by modifying the log directory to be a reparse point or creating crafted hard links. After the updater ran, the attacker would be able to replace the log file with malicious content. This would then allow the attacker to run malicious code as a privileged user.\u003c/p\u003e\n\n\u003cp\u003eThis issue was fixed by requiring the same privileges as the updater has to modify its log files.\u003c/p\u003e\n"},{"category":"researcher","can_view?":true,"can_create?":false}]}