{"id":335495,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zMzU0OTU=","url":"https://hackerone.com/reports/335495","title":"Out of order TLS handshake / application data messages lead to segmentation fault","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2018-04-10T15:22:13.135Z","submitted_at":"2018-04-10T15:22:13.135Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"jzebor","url":"/jzebor","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":22984,"url":"https://hackerone.com/nodejs","handle":"nodejs","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/022/984/e600648ace4a8553247bce967d461a030aa81d49_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/022/984/e600648ace4a8553247bce967d461a030aa81d49_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Node.js","twitter_handle":"nodejs","website":"https://nodejs.org","about":"The Node.js JavaScript Runtime"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2020-02-13T23:47:34.586Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2020-01-14T23:47:33.938Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"**Summary:** \nIMPORTANT NOTE: I have already been working with the NodeJS core security team on this issue and have provided core files, POC and many other pieces of information. I was told by James Snell to report via Hackerone to make it official however all the relevant details on this issue have already been provided to NodeJS team. This report will be minimal since all details are already with the team which needs them.\n\n**Description:** Sending interleaved handshake messages in the TLS handshake OR sending TLS handshake messages AFTER the handshake has completed (after finished msg) causes a segmentation fault of the NodeJS process. This is present in v9 and v10, using TLS module. The issue can be exposed with servers which use TLS in normal \"server authentication\" mode AND servers which require mutual authentication (client certificates).\n\n\n## Steps To Reproduce:\n\n  1. Setup TLS server with node. \n  2. Perform a normal handshake but insert a Client Key Exchange message AFTER the TLS handshake finished message.\n  3. Observe segmentation fault of node process.\n\nStacktrace, core file and reproduction script(s) have all been provided to Anna Henningsen on the NodeJS core team.\n\n## Impact: Denial of service, seg fault leads to the node instance inability to service additional clients.\n\n## Supporting Material/References: All of this has already been provided to Core NodeJS security team.\n\n  * List any additional material (e.g. screenshots, logs, references, commits, code examples, etc.).\n\n## Impact\n\nSegmentation fault of the process leads to denial of service.","vulnerability_information_html":"\u003cp\u003e\u003cstrong\u003eSummary:\u003c/strong\u003e \u003cbr\u003e\nIMPORTANT NOTE: I have already been working with the NodeJS core security team on this issue and have provided core files, POC and many other pieces of information. I was told by James Snell to report via Hackerone to make it official however all the relevant details on this issue have already been provided to NodeJS team. This report will be minimal since all details are already with the team which needs them.\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eDescription:\u003c/strong\u003e Sending interleaved handshake messages in the TLS handshake OR sending TLS handshake messages AFTER the handshake has completed (after finished msg) causes a segmentation fault of the NodeJS process. This is present in v9 and v10, using TLS module. The issue can be exposed with servers which use TLS in normal \u0026quot;server authentication\u0026quot; mode AND servers which require mutual authentication (client certificates).\u003c/p\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps To Reproduce:\u003c/h2\u003e\n\n\u003col\u003e\n\u003cli\u003eSetup TLS server with node. \u003c/li\u003e\n\u003cli\u003ePerform a normal handshake but insert a Client Key Exchange message AFTER the TLS handshake finished message.\u003c/li\u003e\n\u003cli\u003eObserve segmentation fault of node process.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eStacktrace, core file and reproduction script(s) have all been provided to Anna Henningsen on the NodeJS core team.\u003c/p\u003e\n\n\u003ch2 id=\"impact-denial-of-service-seg-fault-leads-to-the-node-instance-inability-to-service-additional-clients\"\u003eImpact: Denial of service, seg fault leads to the node instance inability to service additional clients.\u003c/h2\u003e\n\n\u003ch2 id=\"supporting-material-references-all-of-this-has-already-been-provided-to-core-nodejs-security-team\"\u003eSupporting Material/References: All of this has already been provided to Core NodeJS security team.\u003c/h2\u003e\n\n\u003cul\u003e\n\u003cli\u003eList any additional material (e.g. screenshots, logs, references, commits, code examples, etc.).\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eSegmentation fault of the process leads to denial of service.\u003c/p\u003e\n","weakness":{"id":5,"name":"Heap Overflow"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2020-02-13T23:47:34.042Z","allow_singular_disclosure_after":-27582631.344086144,"singular_disclosure_allowed":true,"vote_count":3,"voters":["eveeez","ihsinme","mechboy"],"severity":{"rating":"high","score":7.5,"author_type":"User","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"none","user_interaction":"none","scope":"unchanged","confidentiality":"none","integrity":"none","availability":"high"}},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":2586729,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Already in triage and discussing... added here for record keeping :-)","markdown_message":"\u003cp\u003eAlready in triage and discussing... added here for record keeping :-)\u003c/p\u003e\n","automated_response":false,"created_at":"2018-04-10T16:16:04.715Z","updated_at":"2018-04-10T16:16:04.715Z","actor":{"username":"jasnell","cleared":false,"url":"/jasnell","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/211/162/109187a55a3f81113d4b61b965ec72cbaa4970e3_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2687807,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"James, hope you are doing well. I just found out from my company HR team that I will be unable to accept any cash bounty for this bug. While it's not my favorite decision, I understand and accept the reasoning.\n\nThis bug report is free and does not request any cash bounty.\n\nTake care,\nJordan","markdown_message":"\u003cp\u003eJames, hope you are doing well. I just found out from my company HR team that I will be unable to accept any cash bounty for this bug. While it\u0026#39;s not my favorite decision, I understand and accept the reasoning.\u003c/p\u003e\n\n\u003cp\u003eThis bug report is free and does not request any cash bounty.\u003c/p\u003e\n\n\u003cp\u003eTake care,\u003cbr\u003e\nJordan\u003c/p\u003e\n","automated_response":false,"created_at":"2018-05-01T20:46:46.098Z","updated_at":"2018-05-01T20:46:46.098Z","actor":{"username":"jzebor","cleared":false,"url":"/jzebor","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nodejs","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2793639,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"James, hope you are doing well. Can you please let me know the disclosure timeline for this issue and #335533 ? It's been roughly a month since I've heard from you. \n\nLet me know,\n\nThanks\nJordan\n","markdown_message":"\u003cp\u003eJames, hope you are doing well. Can you please let me know the disclosure timeline for this issue and \u003ca href=\"/reports/335533\"\u003e#335533\u003c/a\u003e ? It\u0026#39;s been roughly a month since I\u0026#39;ve heard from you. \u003c/p\u003e\n\n\u003cp\u003eLet me know,\u003c/p\u003e\n\n\u003cp\u003eThanks\u003cbr\u003e\nJordan\u003c/p\u003e\n","automated_response":false,"created_at":"2018-05-24T20:21:10.543Z","updated_at":"2018-05-24T20:21:10.543Z","actor":{"username":"jzebor","cleared":false,"url":"/jzebor","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nodejs","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2793681,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"My sorry for the delay. We have the fixes ready to go (and have for a few weeks) but we had a delay on coordinating the release for the Node.js 8.x release line. I'm still not 100% certain when the release is scheduled for but I *will* follow up and get this figured out.\n\nI did want to follow up with you and ask if you had a chance to clarify if you were able to receive the bounty on these reports?","markdown_message":"\u003cp\u003eMy sorry for the delay. We have the fixes ready to go (and have for a few weeks) but we had a delay on coordinating the release for the Node.js 8.x release line. I\u0026#39;m still not 100% certain when the release is scheduled for but I \u003cem\u003ewill\u003c/em\u003e follow up and get this figured out.\u003c/p\u003e\n\n\u003cp\u003eI did want to follow up with you and ask if you had a chance to clarify if you were able to receive the bounty on these reports?\u003c/p\u003e\n","automated_response":false,"created_at":"2018-05-24T20:26:39.814Z","updated_at":"2018-05-24T20:26:39.814Z","actor":{"username":"jasnell","cleared":false,"url":"/jasnell","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/211/162/109187a55a3f81113d4b61b965ec72cbaa4970e3_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2793690,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Ok, I'm going to push for the release to go out week after next. We need to publish an announcement giving folks a heads up that a security release is coming... those usually go out a week in advance of the actual disclosure and release.","markdown_message":"\u003cp\u003eOk, I\u0026#39;m going to push for the release to go out week after next. We need to publish an announcement giving folks a heads up that a security release is coming... those usually go out a week in advance of the actual disclosure and release.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-05-24T20:30:38.514Z","updated_at":"2018-05-24T20:30:38.514Z","actor":{"username":"jasnell","cleared":false,"url":"/jasnell","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/211/162/109187a55a3f81113d4b61b965ec72cbaa4970e3_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2793695,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Re: Bounty -- See my message from May 1st. I cannot accept the bounty. This one is free.\n\nThanks and take care.\n","markdown_message":"\u003cp\u003eRe: Bounty -- See my message from May 1st. I cannot accept the bounty. This one is free.\u003c/p\u003e\n\n\u003cp\u003eThanks and take care.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-05-24T20:32:22.698Z","updated_at":"2018-05-24T20:32:22.698Z","actor":{"username":"jzebor","cleared":false,"url":"/jzebor","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nodejs","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2932064,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"This has been fixed in our most recent release. Thank you very much for reporting!","markdown_message":"\u003cp\u003eThis has been fixed in our most recent release. Thank you very much for reporting!\u003c/p\u003e\n","automated_response":false,"created_at":"2018-06-25T17:25:37.806Z","updated_at":"2018-06-25T17:25:37.806Z","actor":{"username":"mylesborins","cleared":false,"url":"/mylesborins","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/234/978/b951e9a05b9f7c327b55bd697d5bd52293856002_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"jzebor","url":"/jzebor"},"genius_execution_id":null,"team_handle":"nodejs","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2932066,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"DOS not eligible for bounty.","markdown_message":"\u003cp\u003eDOS not eligible for bounty.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-06-25T17:26:16.719Z","updated_at":"2018-06-25T17:26:16.719Z","actor":{"url":"/nodejs","ibb":true,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/022/984/e600648ace4a8553247bce967d461a030aa81d49_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Node.js"}},"genius_execution_id":null,"team_handle":"nodejs","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6772364,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-01-14T23:47:33.958Z","updated_at":"2020-01-14T23:47:33.958Z","first_to_agree":true,"actor":{"username":"octetcloud","cleared":false,"url":"/octetcloud","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/210/672/27b2c0c2193cfb366f7889374e7ce71077431f74_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7048886,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-02-13T23:47:34.605Z","updated_at":"2020-02-13T23:47:34.605Z","actor":{"url":"/nodejs","ibb":true,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/022/984/e600648ace4a8553247bce967d461a030aa81d49_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Node.js"}},"genius_execution_id":null,"team_handle":"nodejs","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}