{"id":172711,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNzI3MTE=","url":"https://hackerone.com/reports/172711","title":"Content Spoofing in udemy","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2016-09-28T18:34:26.531Z","submitted_at":"2016-09-28T18:34:26.531Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"csanuragjain","url":"/csanuragjain","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/058/139/bbabf05f3cf79c652d18dd0fbfe79e515798b03e_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1566,"url":"https://hackerone.com/udemy","handle":"udemy","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/566/398b1c3549d5e2e989f232e944cde54216f910b6_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/566/398b1c3549d5e2e989f232e944cde54216f910b6_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Udemy","twitter_handle":"","website":"http://udemy.com","about":"We’re the world’s online learning marketplace, with courses in everything from programming to yoga to photography."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2017-07-23T10:29:19.948Z","bug_reporter_agreed_on_going_public_at":"2017-06-23T10:29:19.485Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"**Scenerio**\nAn attacker can include any arbitrary text using specially crafted udemy url.\nReporting this but not sure if this is in scope (text injection not marked in exclusion list)\nKindly mark it as informative in case if it is out of scope\n\nIssue seems to be because of source_page=clp param. If this is removed text injection wont work. Also it seems error handling is not proper in case of source_object_id param since this vulnerability occur when you insert a string inside source_object_id param.\n\n**Steps**\n1) Attacker distributed the below url by means of spamming or through his website\nhttps://www.udemy.com/api-2.0/recommended-courses/?source_action=view\u0026source_object=course\u0026source_object_id=},{Kindly%20move%20to%20our%20new%20beta%20website%20evil.com\u0026source_page=clp\n2) Victim see below text \n{\"detail\": \"Invalid source object id: },{Kindly move to our new beta website evil.com\"}\n3) Since the text came from official site so user believes and gets into attacker trap\n\n**Resolution**\nCrafted text should not be responded back in the response HTML","vulnerability_information_html":"\u003cp\u003e\u003cstrong\u003eScenerio\u003c/strong\u003e\u003cbr\u003e\nAn attacker can include any arbitrary text using specially crafted udemy url.\u003cbr\u003e\nReporting this but not sure if this is in scope (text injection not marked in exclusion list)\u003cbr\u003e\nKindly mark it as informative in case if it is out of scope\u003c/p\u003e\n\n\u003cp\u003eIssue seems to be because of source_page=clp param. If this is removed text injection wont work. Also it seems error handling is not proper in case of source_object_id param since this vulnerability occur when you insert a string inside source_object_id param.\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eSteps\u003c/strong\u003e\u003cbr\u003e\n1) Attacker distributed the below url by means of spamming or through his website\u003cbr\u003e\n\u003ca title=\"https://www.udemy.com/api-2.0/recommended-courses/?source_action=view\u0026amp;source_object=course\u0026amp;source_object_id=%7D,%7BKindly%20move%20to%20our%20new%20beta%20website%20evil.com\u0026amp;source_page=clp\" href=\"/redirect?url=https%3A%2F%2Fwww.udemy.com%2Fapi-2.0%2Frecommended-courses%2F%3Fsource_action%3Dview%26source_object%3Dcourse%26source_object_id%3D%257D%2C%257BKindly%2520move%2520to%2520our%2520new%2520beta%2520website%2520evil.com%26source_page%3Dclp\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.udemy.com/api-2.0/recommended-courses/?source_action=view\u0026amp;source_object=course\u0026amp;source_object_id=%7D,%7BKindly%20move%20to%20our%20new%20beta%20website%20evil.com\u0026amp;source_page=clp\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\n2) Victim see below text \u003cbr\u003e\n{\u0026quot;detail\u0026quot;: \u0026quot;Invalid source object id: },{Kindly move to our new beta website evil.com\u0026quot;}\u003cbr\u003e\n3) Since the text came from official site so user believes and gets into attacker trap\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eResolution\u003c/strong\u003e\u003cbr\u003e\nCrafted text should not be responded back in the response HTML\u003c/p\u003e\n","bounty_amount":"50.0","formatted_bounty":"$50","weakness":{"id":57,"name":"Violation of Secure Design Principles"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":123681,"file_name":"ContentSpoofing.PNG","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/123/681/ef756eacc699b37cfab486255fd569ed7703840c/ContentSpoofing.PNG?response-content-disposition=attachment%3B%20filename%3D%22ContentSpoofing.PNG%22%3B%20filename%2A%3DUTF-8%27%27ContentSpoofing.PNG\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ2QYQVMVU%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T044132Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJj%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQC3%2FsiyUovDMMRPwfmXSSMky3lQNd33wh1MrBmbWJC8HQIhAOSX92QvRr3Mllw0zHuI%2FUP9sF%2FDNWps6wYRKsfiEgbIKrQDCFEQARoMMDEzNjE5Mjc0ODQ5IgyayWzpgkc86ZJmRDMqkQNBHcx9TN8Qq3EOCDOHxZVSoo84ar5w931vjsPd%2BYQ3i%2Bx9eqo2ZtgVN1Jmoq8zs6hsL0mQ%2F20wJFKZixbR7HjPc8i4juMIQlnM8TPeS1SJgwLfpmO12sSyoWk3fn%2BevsZ74MOTjvipPhl7l4ysY7gvLSMb%2F%2FbZmlTb%2BRp9ew5nOoiXNI8oQZMkhOihsn1Q92Wzljmz7rLHf0SWhEVdMvtgNqYyJz%2FGfq5QgT7Ex9q0a8OeRuv2WivmkS0ItLzdLr4AZp8G9M8TS3hFKV7sBxW2jeQmBIgcwsfh6l5Kj2o1EeFByIjeAOeU8CtQvJjf1AYwsXig5iiWG1PDqO74ZMYim9a1AVJfIRMHELC9hgi%2BNRVkqsPBurY%2BhFIchB3A6MS0Fup9FcpwDiSPwMu92UsjrPwWcQSy7wF8W7uVHoWmYKo2Jie7uXX2WbkNvQn%2BVJkd%2ByJui6LuEsoOf46y4OUr9by1ZfOQEMvwaiEcDXAKt7msARgVRUaigRb1ZF8hYom2qPLbi%2BKKBIE%2FJ21mcK79gjDj36n%2FBTrqAbyLw6dOEWEdRc%2BQghV%2BGs0mxf6YcBEQ0xaDSLE5OQXQJX90aqhTYFzi15%2BtXM5rF%2FkTq%2FNonb0szkAGwKve9Fh2LyQ%2F7WBSh9XEjPVQ%2B94j5PqLLrVbqfO7RsbRpSefivNmepJrQv52y49fC1tTXoR893JVWe1bnDoXfPRtykz2CLE1WIUrJm7g0MwlQ4%2FYhjLC7FTb6WIejkEPZ0nJdYi90iaGNGoKuvlj2kpGsqCTPjBW8Vhu9R9qXAbPR%2Bj24hpsPhyGFzBe%2F1%2BqYcze%2B4BoEFO8hgcUAqm5L0zeqYMYIdqkfREAB0cTeQ%3D%3D\u0026X-Amz-Signature=1c2ed8851111921dfe6215fd4a9469c7cfe8411e651c9eec6e9019fb2ea88c22","file_size":14757,"type":"image/png"}],"allow_singular_disclosure_at":"2017-07-23T10:29:19.558Z","allow_singular_disclosure_after":-108411133.27424957,"singular_disclosure_allowed":true,"vote_count":3,"voters":["eveeez","japz","spetr0x"],"severity":{"rating":"low","author_type":"Team"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1222414,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for your report - we will investigate.","markdown_message":"\u003cp\u003eThanks for your report - we will investigate.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-09-28T20:51:10.482Z","updated_at":"2016-09-28T20:51:10.482Z","actor":{"username":"acima","cleared":false,"url":"/acima","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"udemy","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1233883,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@acima\nAny update for this issue?","markdown_message":"\u003cp\u003e\u003ca href=\"/acima\"\u003e@acima\u003c/a\u003e\u003cbr\u003e\nAny update for this issue?\u003c/p\u003e\n","automated_response":false,"created_at":"2016-10-05T18:44:26.991Z","updated_at":"2016-10-05T18:44:26.991Z","actor":{"username":"csanuragjain","cleared":true,"url":"/csanuragjain","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/058/139/bbabf05f3cf79c652d18dd0fbfe79e515798b03e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"udemy","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1244470,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@acima, Can the state of this bug be changed to triaged if it is verified as valid issue?","markdown_message":"\u003cp\u003e\u003ca href=\"/acima\"\u003e@acima\u003c/a\u003e, Can the state of this bug be changed to triaged if it is verified as valid issue?\u003c/p\u003e\n","automated_response":false,"created_at":"2016-10-12T17:34:03.709Z","updated_at":"2016-10-12T17:34:03.709Z","actor":{"username":"csanuragjain","cleared":true,"url":"/csanuragjain","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/058/139/bbabf05f3cf79c652d18dd0fbfe79e515798b03e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"udemy","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1270265,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@acima\nI checked and now this issue is resolved. Can you please triage and resolve my report now :)","markdown_message":"\u003cp\u003e\u003ca href=\"/acima\"\u003e@acima\u003c/a\u003e\u003cbr\u003e\nI checked and now this issue is resolved. Can you please triage and resolve my report now :)\u003c/p\u003e\n","automated_response":false,"created_at":"2016-10-27T02:32:08.148Z","updated_at":"2016-10-27T02:32:08.148Z","actor":{"username":"csanuragjain","cleared":true,"url":"/csanuragjain","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/058/139/bbabf05f3cf79c652d18dd0fbfe79e515798b03e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"udemy","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1278168,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@acima,\nCould you please help to change this to Resolved (checked and the issue has been fixed now)\nSorry for bugging, actually I needed to submit some critical issues to some program but can't do so because of low signal. Since this issue is already resolved, so I can gain signal once you resolve it :)","markdown_message":"\u003cp\u003e\u003ca href=\"/acima\"\u003e@acima\u003c/a\u003e,\u003cbr\u003e\nCould you please help to change this to Resolved (checked and the issue has been fixed now)\u003cbr\u003e\nSorry for bugging, actually I needed to submit some critical issues to some program but can\u0026#39;t do so because of low signal. Since this issue is already resolved, so I can gain signal once you resolve it :)\u003c/p\u003e\n","automated_response":false,"created_at":"2016-11-01T12:02:07.648Z","updated_at":"2016-11-01T12:02:07.648Z","actor":{"username":"csanuragjain","cleared":true,"url":"/csanuragjain","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/058/139/bbabf05f3cf79c652d18dd0fbfe79e515798b03e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"udemy","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1281271,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2016-11-02T21:56:22.576Z","updated_at":"2016-11-02T21:56:22.576Z","additional_data":{"old_severity":null,"new_severity":"Low","old_severity_id":null,"new_severity_id":5618},"actor":{"username":"acima","cleared":false,"url":"/acima","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"udemy","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1290011,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@acima any update for this?","markdown_message":"\u003cp\u003e\u003ca href=\"/acima\"\u003e@acima\u003c/a\u003e any update for this?\u003c/p\u003e\n","automated_response":false,"created_at":"2016-11-08T15:24:18.674Z","updated_at":"2016-11-08T15:24:18.674Z","actor":{"username":"csanuragjain","cleared":true,"url":"/csanuragjain","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/058/139/bbabf05f3cf79c652d18dd0fbfe79e515798b03e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"udemy","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1619247,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@acima any update on this?","markdown_message":"\u003cp\u003e\u003ca href=\"/acima\"\u003e@acima\u003c/a\u003e any update on this?\u003c/p\u003e\n","automated_response":false,"created_at":"2017-04-18T18:25:51.130Z","updated_at":"2017-04-18T18:25:51.130Z","actor":{"username":"csanuragjain","cleared":true,"url":"/csanuragjain","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/058/139/bbabf05f3cf79c652d18dd0fbfe79e515798b03e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"udemy","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1630406,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@acima this seems to be fixed now. Can you please mark this as Resolved.","markdown_message":"\u003cp\u003e\u003ca href=\"/acima\"\u003e@acima\u003c/a\u003e this seems to be fixed now. Can you please mark this as Resolved.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-04-24T12:45:06.495Z","updated_at":"2017-04-24T12:45:06.495Z","actor":{"username":"csanuragjain","cleared":true,"url":"/csanuragjain","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/058/139/bbabf05f3cf79c652d18dd0fbfe79e515798b03e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"udemy","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1651888,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@acima, can this be marked resolved please.","markdown_message":"\u003cp\u003e\u003ca href=\"/acima\"\u003e@acima\u003c/a\u003e, can this be marked resolved please.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-05-03T17:11:45.453Z","updated_at":"2017-05-03T17:11:45.453Z","actor":{"username":"csanuragjain","cleared":true,"url":"/csanuragjain","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/058/139/bbabf05f3cf79c652d18dd0fbfe79e515798b03e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"udemy","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1653810,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Sorry for the delay. Since this was resolved independently, not giving any bounty.","markdown_message":"\u003cp\u003eSorry for the delay. Since this was resolved independently, not giving any bounty.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-05-04T14:12:27.397Z","updated_at":"2017-05-04T14:14:14.434Z","actor":{"username":"acima","cleared":false,"url":"/acima","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"csanuragjain","url":"/csanuragjain"},"genius_execution_id":null,"team_handle":"udemy","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1653818,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Since this was resolved independently, not giving any bounty.","markdown_message":"\u003cp\u003eSince this was resolved independently, not giving any bounty.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-05-04T14:14:34.592Z","updated_at":"2017-05-04T14:14:34.592Z","actor":{"url":"/udemy","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/566/398b1c3549d5e2e989f232e944cde54216f910b6_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Udemy"}},"bounty_amount":"0.0","bounty_currency":"usd","bonus_amount":"50.0","genius_execution_id":null,"team_handle":"udemy","collaborator":{"username":"csanuragjain","url":"/csanuragjain"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1776262,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-06-23T10:29:19.534Z","updated_at":"2017-06-23T10:29:19.534Z","first_to_agree":true,"actor":{"username":"csanuragjain","cleared":true,"url":"/csanuragjain","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/058/139/bbabf05f3cf79c652d18dd0fbfe79e515798b03e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"udemy","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1860612,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-07-23T10:29:19.984Z","updated_at":"2017-07-23T10:29:19.984Z","actor":{"url":"/udemy","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/566/398b1c3549d5e2e989f232e944cde54216f910b6_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Udemy"}},"genius_execution_id":null,"team_handle":"udemy","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}