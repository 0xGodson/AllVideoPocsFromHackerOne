{"id":112955,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMTI5NTU=","url":"https://hackerone.com/reports/112955","title":"WordPress Failure Notice page will generate arbitrary hyperlinks","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-01-26T21:45:46.762Z","submitted_at":"2016-01-26T21:45:46.762Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"ilikeleeks","url":"/ilikeleeks","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":7109,"url":"https://hackerone.com/withinsecurity","handle":"withinsecurity","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/007/109/11798ac6bc0ba8d82c71807889b53264f0cddd4e_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/007/109/11798ac6bc0ba8d82c71807889b53264f0cddd4e_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"disabled","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"withinsecurity","twitter_handle":"withinsecurity","website":"https://withinsecurity.com","about":"Security Industry News"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2016-03-25T19:14:36.282Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2016-02-24T19:14:32.007Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"### Description:\nWhen the \"WordPress Failure Notice\" page is returned, if the parameter `_wp_http_referer` was supplied with a valid URL, this URL will be used as the \"Please try again.\" link (see attachment). A way to reliably generate this page, is to append `?wpcspReceiveCSPviol=1\u0026_wp_http_referer=example.com` to any page address.\n\n### Impact:\nAn obvious situation where this could lead to a problem, is if a malicious party is able to force the WordPress Failure Notice page with a parameter pointing to a site he controls. The unsuspecting user would be presented with a seemingly harmless page from a trusted domain, with an innocent looking \"Please try again.\" link, which points to an attacker controlled location.\n\nThe severity of this issue is arguably small, however. It would involve some considerable amount of work on the attackers part, to create a situation where this could become a problem. As far as I could tell, the only way to reliably force the \"WordPress Failure Notice\" page, is to append `?wpcspReceiveCSPviol=1` to an URL.\n\n### Fix:\nA fix would be to check that supplied arguments to the `_wp_http_referer` parameter, is restricted to the same domain as the page or to ensure that users aren't able to force Failure pages.","vulnerability_information_html":"\u003ch3 id=\"description\"\u003eDescription:\u003c/h3\u003e\n\n\u003cp\u003eWhen the \u0026quot;WordPress Failure Notice\u0026quot; page is returned, if the parameter \u003ccode\u003e_wp_http_referer\u003c/code\u003e was supplied with a valid URL, this URL will be used as the \u0026quot;Please try again.\u0026quot; link (see attachment). A way to reliably generate this page, is to append \u003ccode\u003e?wpcspReceiveCSPviol=1\u0026amp;_wp_http_referer=example.com\u003c/code\u003e to any page address.\u003c/p\u003e\n\n\u003ch3 id=\"impact\"\u003eImpact:\u003c/h3\u003e\n\n\u003cp\u003eAn obvious situation where this could lead to a problem, is if a malicious party is able to force the WordPress Failure Notice page with a parameter pointing to a site he controls. The unsuspecting user would be presented with a seemingly harmless page from a trusted domain, with an innocent looking \u0026quot;Please try again.\u0026quot; link, which points to an attacker controlled location.\u003c/p\u003e\n\n\u003cp\u003eThe severity of this issue is arguably small, however. It would involve some considerable amount of work on the attackers part, to create a situation where this could become a problem. As far as I could tell, the only way to reliably force the \u0026quot;WordPress Failure Notice\u0026quot; page, is to append \u003ccode\u003e?wpcspReceiveCSPviol=1\u003c/code\u003e to an URL.\u003c/p\u003e\n\n\u003ch3 id=\"fix\"\u003eFix:\u003c/h3\u003e\n\n\u003cp\u003eA fix would be to check that supplied arguments to the \u003ccode\u003e_wp_http_referer\u003c/code\u003e parameter, is restricted to the same domain as the page or to ensure that users aren\u0026#39;t able to force Failure pages.\u003c/p\u003e\n","bounty_amount":"250.0","formatted_bounty":"$250","original_report_id":null,"original_report_url":null,"attachments":[{"id":70979,"file_name":"2016-01-26-224250_1460x283_scrot.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/070/979/a968dcf54ac860d474819d13e1b96134cd9ab077/2016-01-26-224250_1460x283_scrot.png?response-content-disposition=attachment%3B%20filename%3D%222016-01-26-224250_1460x283_scrot.png%22%3B%20filename%2A%3DUTF-8%27%272016-01-26-224250_1460x283_scrot.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ65C6B2IJ%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T041701Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJr%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIDUDlftdKCwahQOnPUKizOkg2EzWpa90Y7MV2cJRjoCFAiEA7Y2OQGIwYjcI2ewX5wzy7TrFHvDUf%2BCIL8e2DBoQ8fsqtAMIUxABGgwwMTM2MTkyNzQ4NDkiDKstxWWwDBb9kBJ3SSqRAyYWn3xpHc0USlh6j0wUSD0P5lO2wLxrjvfOA2dyjKZVBt1gxJU12nqIqX3KIg9FMETGEwUxbJSTMSoAcGPp86A4SMVO8Ppo%2FbSGSoejkYE57Bm25m03qu80tv22vPGnS25uBEQwCGHzeB2vvgj1L%2F15%2FdzT0%2BG4%2F74LUGHuubNg%2B1XOneA7L7zqEmAAr70tzAVWPrguJqems75lbK%2BgcQwymG9sVI%2Fc6Td6ZStY2vC4MGQhtj%2FB2Gxx7UAazrOqjIGb1G9qSrFARMAiCA7vgzOMlozejJvfAqou2z6NM3lDtH8wHmf%2B04QN5xiDr1wHZOWKVAIeC5Ng5ZOHrGZHtIwdpNYeb2lpY41KE2SAlCRzfQencarj%2BFbPOGd%2BdHnCDIJlkJ1M1OhMbkMpBhgRTzJvpjEERD9SlENQz5LcU8UE9skEafYGlX74JBQCbHp8ggo6mahYoFYYmhlSHgdatm%2B%2B80xz%2FD0LdF7MbyN1WO9WSpnnpVn2rGssLX2aL6wHE4ounfUDQ%2B4P4CmCmYXO1gdWMISXqv8FOusBPH9k2FVakiaEQK4YvWltErNybc3TWS8xjxBe6uFjakG136A%2F7cfMlNRnx071vXJ5t%2FnQ0DZo2Y862T0BMLrHkL3Pal5DQwlhftJzzG0wIFtIf3KfvhKUoOTyenebyJM9PSNwU%2Faz7Lk6mjCUBlIcBPoaXxLvWVV5GfzpPmZeYyz44K91%2B%2BJNPxEcwRShDiit42CCyNfZyC8VIfo21uwKB4nV6gkhX8R%2Blh0KSG1wieFtWcFGCxcDONA9mTKdk1sq7POkUsFpKtFYS%2BgWPlrqp9a%2FEOoUGn3Q91oQVzp5eFzuVvos0aQZvs39%2Bw%3D%3D\u0026X-Amz-Signature=91e566ced29d9523c79ccbb7a3de0d6244cae1a7476a40ad9068a4c33907db62","file_size":57694,"type":"image/png"}],"allow_singular_disclosure_at":"2016-03-25T19:14:32.279Z","allow_singular_disclosure_after":-150282148.93321663,"singular_disclosure_allowed":true,"vote_count":1,"voters":["dyabla"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":774685,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello @hgjjj!\n\nThank you for the report! We'll look into this and get back to you as soon as possible!\n\nThanks,\n\n\nEvan","markdown_message":"\u003cp\u003eHello \u003ca href=\"/hgjjj\"\u003e@hgjjj\u003c/a\u003e!\u003c/p\u003e\n\n\u003cp\u003eThank you for the report! We\u0026#39;ll look into this and get back to you as soon as possible!\u003c/p\u003e\n\n\u003cp\u003eThanks,\u003c/p\u003e\n\n\u003cp\u003eEvan\u003c/p\u003e\n","automated_response":false,"created_at":"2016-01-28T00:45:58.370Z","updated_at":"2016-01-28T00:45:58.370Z","actor":{"username":"ebrynne","cleared":false,"url":"/ebrynne","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/191/f333df32e9b61845f5c823b77d968fa6d246d336_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"withinsecurity","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":782358,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2016-02-03T06:21:08.884Z","updated_at":"2016-02-03T06:21:08.884Z","actor":{"username":"martijn","cleared":false,"url":"/martijn","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5sJxxikBF7fwfkWs531JPtef/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"withinsecurity","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":808612,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks for your patience. We took down https://withinsecurity.com and redirected the domain to our own blog instead. ","markdown_message":"\u003cp\u003eThanks for your patience. We took down \u003ca title=\"https://withinsecurity.com\" href=\"/redirect?url=https%3A%2F%2Fwithinsecurity.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://withinsecurity.com\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e and redirected the domain to our own blog instead. \u003c/p\u003e\n","automated_response":false,"created_at":"2016-02-23T11:06:36.027Z","updated_at":"2016-02-23T11:06:36.027Z","actor":{"username":"martijn","cleared":false,"url":"/martijn","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5sJxxikBF7fwfkWs531JPtef/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"reporter":{"username":"ilikeleeks","url":"/ilikeleeks"},"genius_execution_id":null,"team_handle":"withinsecurity","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":811074,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2016-02-24T19:14:25.726Z","updated_at":"2016-02-24T19:14:25.726Z","actor":{"url":"/withinsecurity","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/007/109/11798ac6bc0ba8d82c71807889b53264f0cddd4e_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"withinsecurity"}},"bounty_amount":"250.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"withinsecurity","collaborator":{"username":"ilikeleeks","url":"/ilikeleeks"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":811077,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-02-24T19:14:32.040Z","updated_at":"2016-02-24T19:14:32.040Z","first_to_agree":true,"actor":{"username":"reed","cleared":false,"url":"/reed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"withinsecurity","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":811122,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for the bounty.","markdown_message":"\u003cp\u003eThanks for the bounty.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-02-24T19:28:33.557Z","updated_at":"2016-02-24T19:28:33.557Z","actor":{"username":"ilikeleeks","cleared":false,"url":"/ilikeleeks","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"withinsecurity","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":871481,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-03-25T19:14:36.317Z","updated_at":"2016-03-25T19:14:36.317Z","actor":{"url":"/withinsecurity","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/007/109/11798ac6bc0ba8d82c71807889b53264f0cddd4e_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"withinsecurity"}},"genius_execution_id":null,"team_handle":"withinsecurity","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}