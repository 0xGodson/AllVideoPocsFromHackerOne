{"id":380207,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zODAyMDc=","url":"https://hackerone.com/reports/380207","title":"Stored XSS in galleries - https://www.redtube.com/gallery/[id] path","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2018-07-10T16:31:51.794Z","submitted_at":"2018-07-10T16:31:51.794Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"sp1d3rs","url":"/sp1d3rs","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/079/690/6853ada3e124bdd8616b1be752223b558de38195_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":21831,"url":"https://hackerone.com/redtube","handle":"redtube","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/021/831/b2049f7ede4a4bf12b8421e81bf2b978c3b0285f_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/021/831/b2049f7ede4a4bf12b8421e81bf2b978c3b0285f_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Redtube","twitter_handle":"RedTube","website":"https://www.redtube.com","about":"Millions of free videos, millions of visitors, millions of active members: welcome to the Home of Porn."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"no-content","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2018-10-10T14:42:49.160Z","bug_reporter_agreed_on_going_public_at":"2018-09-16T23:48:21.505Z","team_member_agreed_on_going_public_at":"2018-10-10T14:42:49.070Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"","vulnerability_information_html":"","bounty_amount":"1500.0","formatted_bounty":"$1,500","weakness":{"id":62,"name":"Cross-site Scripting (XSS) - Stored"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2018-10-16T23:48:21.656Z","allow_singular_disclosure_after":-69487099.62491295,"singular_disclosure_allowed":true,"vote_count":35,"voters":["hunter","bl4de","spam404","mik317","ta8ahi","jarvis7","johndoe1492","ahiezer","mygf","aryan2808","and 25 more..."],"severity":{"rating":"high","author_type":"User"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":3026623,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2018-07-10T20:54:23.633Z","updated_at":"2018-07-10T21:00:02.944Z","actor":{"username":"sp1d3rs","cleared":true,"url":"/sp1d3rs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/079/690/6853ada3e124bdd8616b1be752223b558de38195_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"redtube","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3026853,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2018-07-10T21:26:22.074Z","updated_at":"2018-07-10T21:26:22.074Z","actor":{"username":"dsimmons","cleared":false,"url":"/dsimmons","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"redtube","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3092706,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2018-07-24T16:21:01.240Z","updated_at":"2018-07-24T16:21:01.240Z","actor":{"url":"/redtube","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/021/831/b2049f7ede4a4bf12b8421e81bf2b978c3b0285f_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Redtube"}},"bounty_amount":"1500.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"redtube","collaborator":{"username":"sp1d3rs","url":"/sp1d3rs"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3320179,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2018-09-11T08:54:28.962Z","updated_at":"2018-09-11T08:54:28.962Z","actor":{"username":"ghooks","cleared":false,"url":"/ghooks","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/305/825/34ce1b551efd68766070c3b364ccd73a4b1b9730_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"sp1d3rs","url":"/sp1d3rs"},"genius_execution_id":null,"team_handle":"redtube","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3346339,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-09-16T23:48:21.567Z","updated_at":"2018-09-16T23:48:21.567Z","first_to_agree":true,"actor":{"username":"sp1d3rs","cleared":true,"url":"/sp1d3rs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/079/690/6853ada3e124bdd8616b1be752223b558de38195_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"redtube","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3460758,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-10-10T14:42:49.101Z","updated_at":"2018-10-10T14:42:49.101Z","actor":{"username":"dsimmons","cleared":false,"url":"/dsimmons","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"redtube","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3460759,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-10-10T14:42:49.181Z","updated_at":"2018-10-10T14:42:49.181Z","actor":{"username":"dsimmons","cleared":false,"url":"/dsimmons","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"redtube","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":11007,"category":"team","content":"Researcher successfully closed the image 'alt' attribute and injected javascript by intercepting the album creation request and submitting an XSS payload as the album title. This led to stored cross-site scripting on the user's album page, executed against any users who visited the album.","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eResearcher successfully closed the image \u0026#39;alt\u0026#39; attribute and injected javascript by intercepting the album creation request and submitting an XSS payload as the album title. This led to stored cross-site scripting on the user\u0026#39;s album page, executed against any users who visited the album.\u003c/p\u003e\n"},{"id":10553,"category":"researcher","content":"Stored XSS on the `/gallery/` endpoint. Discovered in the day of public program launch.\nRequest interception was necessary.\n\nContext:\n```\n\u003cimg src=\"...\" alt=\"[injection]\"\u003e\n```\nSanitized characters:\n```\n\u003c\u003e\n```\nPayload:\n```\n\"onload=[js]//\n```\nwhere `[js]` is any arbitrary javascript.\n\nSimilar to the #380204, but with different root cause.\nSeverity was set due to the factors such as: number of potential users affected, attack complexity, no user interaction vector, and possibility to steal sensitive information or bypass CSRF protection on the user's side. \nI had previously some experience with triage team, so in this case it was enough to demonstrate simple popup, without complex payload.\nThanks to the team for great report handling and bounty!","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eStored XSS on the \u003ccode\u003e/gallery/\u003c/code\u003e endpoint. Discovered in the day of public program launch.\u003cbr\u003e\nRequest interception was necessary.\u003c/p\u003e\n\n\u003cp\u003eContext:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e\u0026lt;img src=\u0026quot;...\u0026quot; alt=\u0026quot;[injection]\u0026quot;\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eSanitized characters:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e\u0026lt;\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003ePayload:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e\u0026quot;onload=[js]//\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003ewhere \u003ccode\u003e[js]\u003c/code\u003e is any arbitrary javascript.\u003c/p\u003e\n\n\u003cp\u003eSimilar to the \u003ca href=\"/reports/380204\"\u003e#380204\u003c/a\u003e, but with different root cause.\u003cbr\u003e\nSeverity was set due to the factors such as: number of potential users affected, attack complexity, no user interaction vector, and possibility to steal sensitive information or bypass CSRF protection on the user\u0026#39;s side. \u003cbr\u003e\nI had previously some experience with triage team, so in this case it was enough to demonstrate simple popup, without complex payload.\u003cbr\u003e\nThanks to the team for great report handling and bounty!\u003c/p\u003e\n"}]}