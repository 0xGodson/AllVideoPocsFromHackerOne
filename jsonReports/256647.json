{"id":256647,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yNTY2NDc=","url":"https://hackerone.com/reports/256647","title":"Simple CSS line-height identifies platform","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2017-08-03T17:17:04.960Z","submitted_at":"2017-08-03T17:17:04.960Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"hackerfactor","url":"/hackerfactor","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/069/990/4826a26d83341c89c50de594442aec041043f7e7_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1800,"url":"https://hackerone.com/torproject","handle":"torproject","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/800/6e575d0a9127b91e83833cf4a9e6be6e8b30cbc3_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/800/6e575d0a9127b91e83833cf4a9e6be6e8b30cbc3_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"paused","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Tor","twitter_handle":"torproject","website":"https://www.torproject.org/","about":"Anonymity Online"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-10-20T14:25:52.280Z","bug_reporter_agreed_on_going_public_at":"2017-10-20T14:25:52.161Z","team_member_agreed_on_going_public_at":"2017-10-19T09:41:23.959Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"There are lots of ways to identify the Tor Browser. (User-Agent string, limited time resolution, no media, etc.) Assume you know it is the Tor Browser. Can you tell what platform?\n\nNOTE: This assumption is well within the scope of the Tor Browser. The Tor Browser does not hide the fact that it is the Tor Browser. Instead, the Tor Browser tries to make all instances of the browser look the same. \n\nCSS line-height: Different browsers on different platforms have different default line heights. (You can tell this if you have two different browsers set to the same height and showing the same long web page. Paging down will scroll at different rates.) The default value of the CSS line-height identifies the browser and platform. Sample default values:\n\n    normal: IE, Edge, Chrome, Chromium, Opera, or Konqueror\n    18px: Safari on MacOSX\n    19px: Firefox on Linux or Tor Browser on Linux\n    19.2px: Tor Browser on Windows\n    19.5167px: Firefox on MacOSX or Tor Browser on MacOSX\n    20px: Firefox on Windows or Tor Browser on Windows\n\nFor profiling: If the TOR-Browser is identified, then the CSS line-height will specify the platform.\n\nTo fix: The TOR-Browser should specify the default line-height. Since the user-agent string claims to be Windows, specifying a line-height of '20px' will appear to be Windows.\n\nThis profiling issue permits very simple JavaScript to identify the TOR-Browser platform (MacOS, Windows, Linux).\n\nWorking demonstration:\nhttps://hackerfactor.com/private/torture-test21.html","vulnerability_information_html":"\u003cp\u003eThere are lots of ways to identify the Tor Browser. (User-Agent string, limited time resolution, no media, etc.) Assume you know it is the Tor Browser. Can you tell what platform?\u003c/p\u003e\n\n\u003cp\u003eNOTE: This assumption is well within the scope of the Tor Browser. The Tor Browser does not hide the fact that it is the Tor Browser. Instead, the Tor Browser tries to make all instances of the browser look the same. \u003c/p\u003e\n\n\u003cp\u003eCSS line-height: Different browsers on different platforms have different default line heights. (You can tell this if you have two different browsers set to the same height and showing the same long web page. Paging down will scroll at different rates.) The default value of the CSS line-height identifies the browser and platform. Sample default values:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003enormal: IE, Edge, Chrome, Chromium, Opera, or Konqueror\n18px: Safari on MacOSX\n19px: Firefox on Linux or Tor Browser on Linux\n19.2px: Tor Browser on Windows\n19.5167px: Firefox on MacOSX or Tor Browser on MacOSX\n20px: Firefox on Windows or Tor Browser on Windows\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eFor profiling: If the TOR-Browser is identified, then the CSS line-height will specify the platform.\u003c/p\u003e\n\n\u003cp\u003eTo fix: The TOR-Browser should specify the default line-height. Since the user-agent string claims to be Windows, specifying a line-height of \u0026#39;20px\u0026#39; will appear to be Windows.\u003c/p\u003e\n\n\u003cp\u003eThis profiling issue permits very simple JavaScript to identify the TOR-Browser platform (MacOS, Windows, Linux).\u003c/p\u003e\n\n\u003cp\u003eWorking demonstration:\u003cbr\u003e\n\u003ca title=\"https://hackerfactor.com/private/torture-test21.html\" href=\"/redirect?url=https%3A%2F%2Fhackerfactor.com%2Fprivate%2Ftorture-test21.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://hackerfactor.com/private/torture-test21.html\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","bounty_amount":"100.0","formatted_bounty":"$100","weakness":{"id":18,"name":"Information Disclosure"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2017-11-18T09:41:23.990Z","allow_singular_disclosure_after":-98220731.65027222,"singular_disclosure_allowed":true,"vote_count":10,"voters":["irek","jensec","bigbear_","eveeez","hackerfactor","spetr0x","saidon_1015","harleyquinn","hongen","b4155f7c29acd42c27d007a"],"severity":{"rating":"low","author_type":"User"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1892964,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Nice find. We are currently not really trying to defend against platform detection. See: https://www.torproject.org/projects/torbrowser/design/#fingerprinting-linkability subsection 24 Operating System Type Fingerprinting for the rationale for having this as low priority. Still, after some testing I can reproduce your findings and opened https://trac.torproject.org/projects/tor/ticket/23104.","markdown_message":"\u003cp\u003eNice find. We are currently not really trying to defend against platform detection. See: \u003ca title=\"https://www.torproject.org/projects/torbrowser/design/#fingerprinting-linkability\" href=\"/redirect?url=https%3A%2F%2Fwww.torproject.org%2Fprojects%2Ftorbrowser%2Fdesign%2F%23fingerprinting-linkability\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.torproject.org/projects/torbrowser/design/#fingerprinting-linkability\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e subsection 24 Operating System Type Fingerprinting for the rationale for having this as low priority. Still, after some testing I can reproduce your findings and opened \u003ca title=\"https://trac.torproject.org/projects/tor/ticket/23104\" href=\"/redirect?url=https%3A%2F%2Ftrac.torproject.org%2Fprojects%2Ftor%2Fticket%2F23104\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://trac.torproject.org/projects/tor/ticket/23104\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-08-04T13:49:42.492Z","updated_at":"2017-08-04T13:49:42.492Z","actor":{"username":"geko","cleared":false,"url":"/geko","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"torproject","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1892966,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Tracking this from now on in our public bug tracker.","markdown_message":"\u003cp\u003eTracking this from now on in our public bug tracker.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-08-04T13:50:20.869Z","updated_at":"2017-08-04T13:50:20.869Z","actor":{"username":"geko","cleared":false,"url":"/geko","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"hackerfactor","url":"/hackerfactor"},"genius_execution_id":null,"team_handle":"torproject","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1892968,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2017-08-04T13:50:44.264Z","updated_at":"2017-08-04T13:50:44.264Z","actor":{"url":"/torproject","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/800/6e575d0a9127b91e83833cf4a9e6be6e8b30cbc3_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Tor"}},"bounty_amount":"100.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"torproject","collaborator":{"username":"hackerfactor","url":"/hackerfactor"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2083681,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-10-19T09:41:23.974Z","updated_at":"2017-10-19T09:41:23.974Z","first_to_agree":true,"actor":{"username":"geko","cleared":false,"url":"/geko","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"torproject","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2088292,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-10-20T14:25:52.189Z","updated_at":"2017-10-20T14:25:52.189Z","actor":{"username":"hackerfactor","cleared":false,"url":"/hackerfactor","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/069/990/4826a26d83341c89c50de594442aec041043f7e7_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"torproject","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2088293,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-10-20T14:25:52.307Z","updated_at":"2017-10-20T14:25:52.307Z","actor":{"username":"hackerfactor","cleared":false,"url":"/hackerfactor","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/069/990/4826a26d83341c89c50de594442aec041043f7e7_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"torproject","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}