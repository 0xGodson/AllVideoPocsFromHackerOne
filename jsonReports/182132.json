{"id":182132,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xODIxMzI=","url":"https://hackerone.com/reports/182132","title":"Reflected cross-site scripting (XSS) vulnerability in pornhub.com allows attackers to inject arbitrary web script or HTML.","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2016-11-14T18:54:21.822Z","submitted_at":"2016-11-14T18:54:21.822Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"edoverflow","url":"/edoverflow","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/116/374/9a3cf4d62b2f507a0d33808aacbad863ec4455ac_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":952,"url":"https://hackerone.com/pornhub","handle":"pornhub","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/952/77ffeabeff6e89172004356249a1de19b6a45424_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/952/77ffeabeff6e89172004356249a1de19b6a45424_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Pornhub","twitter_handle":"Pornhub","website":"https://pornhub.com","about":"The premiere destination for adult entertainment"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"no-content","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-02-14T15:45:40.356Z","bug_reporter_agreed_on_going_public_at":"2017-02-14T07:48:42.733Z","team_member_agreed_on_going_public_at":"2017-02-14T15:45:40.301Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"","vulnerability_information_html":"","bounty_amount":"200.0","formatted_bounty":"$200","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2017-03-16T07:48:42.791Z","allow_singular_disclosure_after":-119566636.2718672,"singular_disclosure_allowed":true,"vote_count":5,"voters":["madrobot","eveeez","khizer47","b3nac","hacklad"],"severity":{"rating":"medium","author_type":"User"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1300050,"is_internal":false,"editable":false,"type":"Activities::BugDuplicate","message":"","markdown_message":"","automated_response":false,"created_at":"2016-11-15T09:51:06.166Z","updated_at":"2016-11-15T09:51:06.166Z","actor":{"username":"cyrus","cleared":false,"url":"/cyrus","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/089/055/8c60a8494f91468ca6e1cb26e79d36093d56bca2_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"pornhub","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1300116,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2016-11-15T10:44:16.165Z","updated_at":"2016-11-15T10:44:16.165Z","actor":{"username":"edoverflow","cleared":true,"url":"/edoverflow","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/116/374/9a3cf4d62b2f507a0d33808aacbad863ec4455ac_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"pornhub","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1300499,"is_internal":false,"editable":false,"type":"Activities::BugReopened","message":"","markdown_message":"","automated_response":false,"created_at":"2016-11-15T15:39:26.241Z","updated_at":"2016-11-15T15:39:26.241Z","actor":{"username":"dsimmons","cleared":false,"url":"/dsimmons","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"pornhub","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1300504,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2016-11-15T15:40:58.003Z","updated_at":"2016-11-15T15:40:58.003Z","actor":{"username":"dsimmons","cleared":false,"url":"/dsimmons","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"pornhub","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1300513,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2016-11-15T15:46:26.534Z","updated_at":"2016-11-15T15:46:26.534Z","actor":{"username":"edoverflow","cleared":true,"url":"/edoverflow","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/116/374/9a3cf4d62b2f507a0d33808aacbad863ec4455ac_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"pornhub","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1307468,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2016-11-18T21:25:54.928Z","updated_at":"2016-11-18T21:25:54.928Z","actor":{"url":"/pornhub","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/952/77ffeabeff6e89172004356249a1de19b6a45424_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Pornhub"}},"bounty_amount":"200.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"pornhub","collaborator":{"username":"edoverflow","url":"/edoverflow"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1308025,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2016-11-19T09:11:44.200Z","updated_at":"2016-11-19T09:11:44.200Z","actor":{"username":"edoverflow","cleared":true,"url":"/edoverflow","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/116/374/9a3cf4d62b2f507a0d33808aacbad863ec4455ac_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"pornhub","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1310048,"is_internal":false,"editable":false,"type":"Activities::SwagAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2016-11-21T16:56:26.316Z","updated_at":"2016-11-21T16:56:26.316Z","actor":{"url":"/pornhub","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/952/77ffeabeff6e89172004356249a1de19b6a45424_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Pornhub"}},"reporter":{"username":"edoverflow","url":"/edoverflow"},"genius_execution_id":null,"team_handle":"pornhub","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1310062,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2016-11-21T17:07:00.633Z","updated_at":"2016-11-21T17:07:00.633Z","actor":{"username":"edoverflow","cleared":true,"url":"/edoverflow","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/116/374/9a3cf4d62b2f507a0d33808aacbad863ec4455ac_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"pornhub","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1351624,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2016-12-08T19:10:35.845Z","updated_at":"2016-12-08T19:10:35.845Z","additional_data":{},"actor":{"username":"edoverflow","cleared":true,"url":"/edoverflow","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/116/374/9a3cf4d62b2f507a0d33808aacbad863ec4455ac_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"pornhub","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1395907,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2017-01-03T09:48:33.925Z","updated_at":"2017-01-03T09:48:33.925Z","actor":{"username":"edoverflow","cleared":true,"url":"/edoverflow","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/116/374/9a3cf4d62b2f507a0d33808aacbad863ec4455ac_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"pornhub","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1396709,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2017-01-03T17:26:12.986Z","updated_at":"2017-01-03T17:26:12.986Z","actor":{"username":"dsimmons","cleared":false,"url":"/dsimmons","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"pornhub","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1483841,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2017-02-14T00:11:45.321Z","updated_at":"2017-02-14T00:11:45.321Z","actor":{"username":"dsimmons","cleared":false,"url":"/dsimmons","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"edoverflow","url":"/edoverflow"},"genius_execution_id":null,"team_handle":"pornhub","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1484289,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-02-14T07:48:42.754Z","updated_at":"2017-02-14T07:48:42.754Z","first_to_agree":true,"actor":{"username":"edoverflow","cleared":true,"url":"/edoverflow","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/116/374/9a3cf4d62b2f507a0d33808aacbad863ec4455ac_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"pornhub","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1485044,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-02-14T15:45:40.320Z","updated_at":"2017-02-14T15:45:40.320Z","actor":{"username":"jsacks","cleared":false,"url":"/jsacks","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/032/836/f0af647bfa82105c5663ed0feb9d1d6dae1eec8b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"pornhub","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1485046,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-02-14T15:45:40.371Z","updated_at":"2017-02-14T15:45:40.371Z","actor":{"username":"jsacks","cleared":false,"url":"/jsacks","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/032/836/f0af647bfa82105c5663ed0feb9d1d6dae1eec8b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"pornhub","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":3370,"category":"team","content":"The researcher discovered a reflected cross-site scripting vulnerability on the users' page.","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eThe researcher discovered a reflected cross-site scripting vulnerability on the users\u0026#39; page.\u003c/p\u003e\n"},{"id":3420,"category":"researcher","content":"# Short Description\n---\n\nI managed to bypass the fix to ZephrFish's [report](https://hackerone.com/reports/100552) by encoding the `=` symbol (`%3D`).\n\nTherefore, pornhub.com was still vulnerable to reflected XSS, a form of client-side code injection wherein one can execute malicious scripts into a page.\n\n# Why did this vulnerability exist?\n---\n\nCross-site scripting exists whenever input can be interpreted as code. In order to prevent XSS all input should be escaped on the server-side [1]. This specific XSS was an HTML Context Inline Injection.\n\nScripts could be injected into the page as follows:\n\n~~~\nhttp://www.pornhub.com/users/daisydabs?cf090\"oncontextmenu%3Dalert(1);\"cf090=1\n~~~\n\nIn the page's source code this appeared as follows:\n\n~~~\n\u003cli class=\"de\"\u003e\u003ca href=\"http://de.pornhub.com/users/daisydabs?cf090\"oncontextmenu=alert(1);\"cf090=1\" data-lang=\"de\" data-root=\"pornhub.com\" onclick=\"ga('send', 'event', 'Language Flags Header', 'click', 'Deutsch');\"\u003e\u003cspan\u003eDeutsch\u003c/span\u003e\u003c/a\u003e\u003c/li\u003e\n~~~\n\n# What were the exploits?\n---\n\nA cross-site scripting vulnerability allows an attacker to modify the page. This means he/she can inject forms to steal usernames, passwords, cookies (no HttpOnly flag present) and so forth. In short, XSS opens the doors to plenty of phishing techniques.\n\nA very good list of malicious payloads can be found here: http://www.xss-payloads.com/payloads.html\n\n[1] - [XSS (Cross Site Scripting) Prevention Cheat Sheet](https://www.owasp.org/index.php/XSS_(Cross_Site_Scripting)_Prevention_Cheat_Sheet)","can_view?":true,"can_edit?":false,"content_html":"\u003ch1 id=\"short-description\"\u003eShort Description\u003c/h1\u003e\n\n\u003chr\u003e\n\n\u003cp\u003eI managed to bypass the fix to ZephrFish\u0026#39;s \u003ca href=\"https://hackerone.com/reports/100552\"\u003ereport\u003c/a\u003e by encoding the \u003ccode\u003e=\u003c/code\u003e symbol (\u003ccode\u003e%3D\u003c/code\u003e).\u003c/p\u003e\n\n\u003cp\u003eTherefore, pornhub.com was still vulnerable to reflected XSS, a form of client-side code injection wherein one can execute malicious scripts into a page.\u003c/p\u003e\n\n\u003ch1 id=\"why-did-this-vulnerability-exist\"\u003eWhy did this vulnerability exist?\u003c/h1\u003e\n\n\u003chr\u003e\n\n\u003cp\u003eCross-site scripting exists whenever input can be interpreted as code. In order to prevent XSS all input should be escaped on the server-side [1]. This specific XSS was an HTML Context Inline Injection.\u003c/p\u003e\n\n\u003cp\u003eScripts could be injected into the page as follows:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ehttp://www.pornhub.com/users/daisydabs?cf090\u0026quot;oncontextmenu%3Dalert(1);\u0026quot;cf090=1\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eIn the page\u0026#39;s source code this appeared as follows:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e\u0026lt;li class=\u0026quot;de\u0026quot;\u0026gt;\u0026lt;a href=\u0026quot;http://de.pornhub.com/users/daisydabs?cf090\u0026quot;oncontextmenu=alert(1);\u0026quot;cf090=1\u0026quot; data-lang=\u0026quot;de\u0026quot; data-root=\u0026quot;pornhub.com\u0026quot; onclick=\u0026quot;ga(\u0026#39;send\u0026#39;, \u0026#39;event\u0026#39;, \u0026#39;Language Flags Header\u0026#39;, \u0026#39;click\u0026#39;, \u0026#39;Deutsch\u0026#39;);\u0026quot;\u0026gt;\u0026lt;span\u0026gt;Deutsch\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/li\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch1 id=\"what-were-the-exploits\"\u003eWhat were the exploits?\u003c/h1\u003e\n\n\u003chr\u003e\n\n\u003cp\u003eA cross-site scripting vulnerability allows an attacker to modify the page. This means he/she can inject forms to steal usernames, passwords, cookies (no HttpOnly flag present) and so forth. In short, XSS opens the doors to plenty of phishing techniques.\u003c/p\u003e\n\n\u003cp\u003eA very good list of malicious payloads can be found here: \u003ca title=\"http://www.xss-payloads.com/payloads.html\" href=\"/redirect?url=http%3A%2F%2Fwww.xss-payloads.com%2Fpayloads.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://www.xss-payloads.com/payloads.html\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e[1] - \u003ca href=\"/redirect?url=https%3A%2F%2Fwww.owasp.org%2Findex.php%2FXSS_%28Cross_Site_Scripting%29_Prevention_Cheat_Sheet\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eXSS (Cross Site Scripting) Prevention Cheat Sheet\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n"}]}