{"id":163904,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNjM5MDQ=","url":"https://hackerone.com/reports/163904","title":"Username can be used to trick the victim on the name of www.gratipay.com","state":"Closed","substate":"informative","readable_substate":"Informative","created_at":"2016-08-27T22:33:45.000Z","submitted_at":"2016-08-27T22:33:45.000Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"akash_9021","url":"/akash_9021","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1868,"url":"https://hackerone.com/gratipay","handle":"gratipay","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/868/a75c6649c5b4671b3cf44160af884a7da9fd0b67_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/868/a75c6649c5b4671b3cf44160af884a7da9fd0b67_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"disabled","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Gratipay","twitter_handle":"Gratipay","website":"https://gratipay.com/","about":"Gratitude? Gratipay! The easiest way for your company to pay for open source."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2016-12-30T07:47:33.396Z","bug_reporter_agreed_on_going_public_at":"2016-12-30T07:47:33.366Z","team_member_agreed_on_going_public_at":"2016-08-27T23:11:01.881Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi,\n\nI found a vulnerability in www.gratipay.com\n\n**Steps to reproduce:**\n1. Login in gratipay using any social account which do not provide the email to gratipay.\n2. In my case i use twiiter.com, i got the message from gratipay that no Email id is associated with this account.\n3. Click on settings and change the username to the malicious site. (I used www.attacker.com)\n4. Click on the email.\n5. Add the Victim's Email Id.\n6. Done. Email Sent to Victim with attacker's malicious site or phising page.\n\n**Impact:**\nUsing this vulnerability an attacker can use a malcious script or a phising page to trick the victims. Username of gratipay (In case of this report attacker's site) will be renders as a link. Victim Just need to click on that link. since the email is from trusted domain like gratipay.com, victim will definitely want to click on the link which could be end up to takeover his account etc.\n\n**Fix:** It can be fixed by do not allowing . (dot) in usernames of gratipay. \n\n\nI also attached the screen shot of email sent for invitation to victim, in which account name is renders as a link.\n\nThanks,\nAkash Saxena\n\n\n","vulnerability_information_html":"\u003cp\u003eHi,\u003c/p\u003e\n\n\u003cp\u003eI found a vulnerability in \u003ca href=\"/redirect?url=http%3A%2F%2Fwww.gratipay.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ewww.gratipay.com\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eSteps to reproduce:\u003c/strong\u003e\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eLogin in gratipay using any social account which do not provide the email to gratipay.\u003c/li\u003e\n\u003cli\u003eIn my case i use twiiter.com, i got the message from gratipay that no Email id is associated with this account.\u003c/li\u003e\n\u003cli\u003eClick on settings and change the username to the malicious site. (I used \u003ca href=\"/redirect?url=http%3A%2F%2Fwww.attacker.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ewww.attacker.com\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e)\u003c/li\u003e\n\u003cli\u003eClick on the email.\u003c/li\u003e\n\u003cli\u003eAdd the Victim\u0026#39;s Email Id.\u003c/li\u003e\n\u003cli\u003eDone. Email Sent to Victim with attacker\u0026#39;s malicious site or phising page.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003e\u003cstrong\u003eImpact:\u003c/strong\u003e\u003cbr\u003e\nUsing this vulnerability an attacker can use a malcious script or a phising page to trick the victims. Username of gratipay (In case of this report attacker\u0026#39;s site) will be renders as a link. Victim Just need to click on that link. since the email is from trusted domain like gratipay.com, victim will definitely want to click on the link which could be end up to takeover his account etc.\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eFix:\u003c/strong\u003e It can be fixed by do not allowing . (dot) in usernames of gratipay. \u003c/p\u003e\n\n\u003cp\u003eI also attached the screen shot of email sent for invitation to victim, in which account name is renders as a link.\u003c/p\u003e\n\n\u003cp\u003eThanks,\u003cbr\u003e\nAkash Saxena\u003c/p\u003e\n","weakness":{"id":57,"name":"Violation of Secure Design Principles"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":115430,"file_name":"Email_recieved_by_victim_gratipay.jpg","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/115/430/b62347ba0253a75f8ae0d9b57c6ed2cca457942b/Email_recieved_by_victim_gratipay.jpg?response-content-disposition=attachment%3B%20filename%3D%22Email_recieved_by_victim_gratipay.jpg%22%3B%20filename%2A%3DUTF-8%27%27Email_recieved_by_victim_gratipay.jpg\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ7CRG7HV6%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T043809Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJr%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQDL%2Fh5fBqFuBTrSaxf4ul00epLofNZKIzXDvPOgqBem3gIgF5Ifd19unBAIXFVhlAdK7Dz%2BXRueBIEefq1h8PnVNUcqtAMIUxABGgwwMTM2MTkyNzQ4NDkiDHq1f4SdtjvvsqEDkiqRA6wce2S%2BY%2BLnEHDBgCnsZfUbiPKecdoCmcNJUJqqppT5i9J8dP%2F2fba5bYABF8ZuzkHl4XJSnFH2owLOqvZ1TrltwAFuY4ncs1Jr6E5dk03Cb7kVB6l0qyffs%2BzhlEPNEglLW14kNtVd7%2FPlxYT3WTnqlpN9WNxZVTKe6nHnIA2rEKe3kzpe7Uj8z2MAyKCT0U3otOG%2BlWHdtt5ig9bMR3SNjGFolrk38P9HhFFgDOcoWubRFYuIxY3W9QlpK6WwMtceMKB2rKybcLy%2FCu7FY6od5U0wD%2BrVaoG8o0hkLqjelXnmG%2BwaXNSJ0zWeBpSbvMIsGklaxmLdMs%2FWfhNO5hltzjw9S8JmXHM5mnEGgpOeyY55xS%2FRF4KXm2vq7P0xIG0N1uySOZyyBiaHvnvBLQAO16HibxSCcvFtjxhoLrPbKokc%2FXlEt7qcOw7yxuuSobEGC3W5Kz7%2FI8BtkRZi8d%2BIdr9n1GExy950JM4hMjf2EPY5H1%2FpDtNFNyjy6q77GO7WdZ9HnxIGGy13hwo1rkv3MJKWqv8FOusB54wjFwD3k86QFrRw4z0edoc8DqEBnoRuycpIArk5pjY7Rir50ajFXpxBXlJZLomTmEFRg3z%2Bmy%2FJDhh9LBMOlFzL6Z9QZyJK7IboUJnUHp5evKkvnsL12d%2FlyOgC5GOic698ipYcjcdl3Cqs%2BqI72pfMuKj3OhKGb76diM%2BGzlaRwzVXzgiScmWRSPJqjLuzqm6lg3royiDSJ1ei3ceKA%2FgDJfJt1bkij5egZ49LCsf1z9jhgyxCgp3pr9%2BgxMe4D7zVwkSKse8Z9ZfkjovaOSPqr3fj4zhDDcfkrqqN8%2FIEgCwrpVkjKTRQ%2FA%3D%3D\u0026X-Amz-Signature=2e5ebd41b5fe6d05dc9bb2fc0394a0eea75b3ef5fb7851ec037ce95886b3e76d","file_size":59058,"type":"image/jpeg"}],"allow_singular_disclosure_at":null,"vote_count":5,"voters":["mpz","spetr0x","akash_9021","ariyansarma","davids"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1158010,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"Hi @password_change,\n\nThanks for this report! Since the content of the mail is verbose (\"We received a request to connect \u003cyourmail\u003e to the \u003cfake link\u003e account on Gratipay\") and there is a big green button, I don't think this is a good vector for phishing. In addition, I don't really see how you phish the user to take over his account since as far I know, one email can be used only once on Gratipay and you won't be able to send this message if the user already has one account. That's why I'm not categorizing this report as a security vulnerability, closing as \"Informative\".\n\nThank you for making Gratipay a safer place! ","markdown_message":"\u003cp\u003eHi \u003ca href=\"/password_change\"\u003e@password_change\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThanks for this report! Since the content of the mail is verbose (\u0026quot;We received a request to connect \u0026lt;yourmail\u0026gt; to the \u0026lt;fake link\u0026gt; account on Gratipay\u0026quot;) and there is a big green button, I don\u0026#39;t think this is a good vector for phishing. In addition, I don\u0026#39;t really see how you phish the user to take over his account since as far I know, one email can be used only once on Gratipay and you won\u0026#39;t be able to send this message if the user already has one account. That\u0026#39;s why I\u0026#39;m not categorizing this report as a security vulnerability, closing as \u0026quot;Informative\u0026quot;.\u003c/p\u003e\n\n\u003cp\u003eThank you for making Gratipay a safer place! \u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-27T23:10:57.741Z","updated_at":"2016-08-27T23:10:57.741Z","actor":{"username":"nashe_","cleared":false,"url":"/nashe_","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1158011,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-08-27T23:11:01.907Z","updated_at":"2016-08-27T23:11:01.907Z","first_to_agree":true,"actor":{"username":"nashe_","cleared":false,"url":"/nashe_","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1158025,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @nashe_,\nThanks for the prompt reply.\nYes i understand it is a low severity issue but has some risk as you are providing the platform to an attacker to trick the victim (May or may not gratipay users)\n\nYou can check the report #114796 with same issue.\n\nEven It needs a very small fix. I think this should be taken care in user name. Most of the websites use this as a best practice and do not allow . (dot) in the usernames.\n\nWarm Regards,\nAkash Saxena","markdown_message":"\u003cp\u003eHi \u003ca href=\"/nashe_\"\u003e@nashe_\u003c/a\u003e,\u003cbr\u003e\nThanks for the prompt reply.\u003cbr\u003e\nYes i understand it is a low severity issue but has some risk as you are providing the platform to an attacker to trick the victim (May or may not gratipay users)\u003c/p\u003e\n\n\u003cp\u003eYou can check the report \u003ca href=\"/reports/114796\"\u003e#114796\u003c/a\u003e with same issue.\u003c/p\u003e\n\n\u003cp\u003eEven It needs a very small fix. I think this should be taken care in user name. Most of the websites use this as a best practice and do not allow . (dot) in the usernames.\u003c/p\u003e\n\n\u003cp\u003eWarm Regards,\u003cbr\u003e\nAkash Saxena\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-27T23:34:31.673Z","updated_at":"2016-08-27T23:34:31.673Z","actor":{"username":"akash_9021","cleared":false,"url":"/akash_9021","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1391901,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-12-30T07:47:33.382Z","updated_at":"2016-12-30T07:47:33.382Z","actor":{"username":"akash_9021","cleared":false,"url":"/akash_9021","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1391902,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-12-30T07:47:33.407Z","updated_at":"2016-12-30T07:47:33.407Z","actor":{"username":"akash_9021","cleared":false,"url":"/akash_9021","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}