{"id":77231,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC83NzIzMQ==","url":"https://hackerone.com/reports/77231","title":"Weak Cryptographic Hash","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2015-07-21T07:29:14.331Z","submitted_at":"2015-07-21T07:29:14.331Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"ru94mb","url":"/ru94mb","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/KoV6xpuAmE7m34HY1huchq2f/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":361,"url":"https://hackerone.com/wordpoints","handle":"wordpoints","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/361/a0559c0ee47289ddff142d66426b278b32961dc9_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/361/a0559c0ee47289ddff142d66426b278b32961dc9_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"WordPoints","twitter_handle":"","website":"","about":"Open source points plugin for WordPress."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2015-07-23T06:47:08.280Z","bug_reporter_agreed_on_going_public_at":"2015-07-23T06:47:08.175Z","team_member_agreed_on_going_public_at":"2015-07-22T21:38:17.044Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Issue:\r\n\r\nThe following files are vulnerable to this issue:\r\n\r\n\\src\\includes\\class-breaking-updater.php line 246 and 247\r\n\r\nprotected function check_module( $module ) {\r\n\r\n\t\t$rand_str = str_shuffle( md5( microtime() ) );\r\n\t\t$nonce = md5( $rand_str . 'wordpoints_check_modules-' . $module );\r\n\r\n\\src\\admin\\includes\\class-wordpoints-modules-list-table.php line 541\r\n\r\nswitch ( $column_name ) {\r\n\r\n\t\t\t\t\tcase 'cb':\r\n\t\t\t\t\t\t$checkbox_id = 'checkbox_' . md5( $module_data['name'] );\r\n\r\n\\src\\components\\points\\includes\\class-wordpoints-points-logs-query.php line 705\r\n\r\nprivate function _calc_cache_query_md5() {\r\n\r\n\t\tif ( ! isset( $this-\u003e_cache_query_md5 ) ) {\r\n\t\t\t$this-\u003e_cache_query_md5 = md5( $this-\u003eget_sql() );\r\n\t\t}\r\n\t}\r\n\r\nExplanation:\r\n\r\nWeak cryptographic hashes are susceptible to attacks like rainbow table searches. Hashing algorithms like MD5 and SHA-1 has been marked obsolete according to latest coding standards. This risk the integrity of security critical data to be compromised.\r\n\r\nRecommendation:\r\n\r\nDiscontinue the use of MD5 and SHA-1 algorithms. Use SHA-256 or above to perform one way hashing for better security and integrity of data.","vulnerability_information_html":"\u003cp\u003eIssue:\u003c/p\u003e\n\n\u003cp\u003eThe following files are vulnerable to this issue:\u003c/p\u003e\n\n\u003cp\u003e\\src\\includes\\class-breaking-updater.php line 246 and 247\u003c/p\u003e\n\n\u003cp\u003eprotected function check_module( $module ) {\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e    $rand_str = str_shuffle( md5( microtime() ) );\n    $nonce = md5( $rand_str . \u0026#39;wordpoints_check_modules-\u0026#39; . $module );\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e\\src\\admin\\includes\\class-wordpoints-modules-list-table.php line 541\u003c/p\u003e\n\n\u003cp\u003eswitch ( $column_name ) {\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e                case \u0026#39;cb\u0026#39;:\n                    $checkbox_id = \u0026#39;checkbox_\u0026#39; . md5( $module_data[\u0026#39;name\u0026#39;] );\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e\\src\\components\\points\\includes\\class-wordpoints-points-logs-query.php line 705\u003c/p\u003e\n\n\u003cp\u003eprivate function _calc_cache_query_md5() {\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e    if ( ! isset( $this-\u0026gt;_cache_query_md5 ) ) {\n        $this-\u0026gt;_cache_query_md5 = md5( $this-\u0026gt;get_sql() );\n    }\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eExplanation:\u003c/p\u003e\n\n\u003cp\u003eWeak cryptographic hashes are susceptible to attacks like rainbow table searches. Hashing algorithms like MD5 and SHA-1 has been marked obsolete according to latest coding standards. This risk the integrity of security critical data to be compromised.\u003c/p\u003e\n\n\u003cp\u003eRecommendation:\u003c/p\u003e\n\n\u003cp\u003eDiscontinue the use of MD5 and SHA-1 algorithms. Use SHA-256 or above to perform one way hashing for better security and integrity of data.\u003c/p\u003e\n","bounty_amount":"25.0","formatted_bounty":"$25","weakness":{"id":57,"name":"Violation of Secure Design Principles"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2015-08-21T21:38:17.151Z","allow_singular_disclosure_after":-169031489.62710682,"singular_disclosure_allowed":true,"vote_count":0,"voters":[],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":519029,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"I will respond to each of the three different uses of `md5()`individually.\n\n##\\src\\includes\\class-breaking-updater.php line 246 and 247\n\nThis hash value is used only when the plugin is performing a breaking update. An example of a breaking update would be the update from version 1.x to version 2.x, or version 2.x to version 3.x. When a breaking update happens, the plugin runs a special compatibility check on each of the modules. During the check for a module, this hash is generated and saved to the database. The compatibility check only takes a few moments, and after it is finished the hash is deleted from the database.\n\nSo, in order for an attacker to exploit the weak hashing algorithm, he would need to guess the exact time that the compatibility check for a module was being performed. He would then have only a few seconds to perform the exploit. If he did guess the time a breaking update was being performed, he would only be able to achieve a minor information disclosure.\n\nBecause breaking updates are rare occurrences, and only last a few seconds, I made a deliberate choice to use a weak hashing algorithm. I thought that it would be an accepted risk. And I admit that using PHP's `md5()` function was just an easy thing to do. However, now I do think that maybe it would be better to use a stronger hashing algorithm. At least it would be a better example to new coders who do not know that md5 is unsafe.\n\n##\\src\\admin\\includes\\class-wordpoints-modules-list-table.php line 541\n\nI think that the value is hashed here just to generate a unique `id` attribute for the checkbox element. I will explore this further. Maybe hashing is not needed here at all.\n\n##\\src\\components\\points\\includes\\class-wordpoints-points-logs-query.php line 705\n\nI think this is the most serious case. Thank you for bringing it to my attention.\n\nHere the hash is being used as a key for the cache. The attacker can manipulate the hash value if user-supplied data is incorporated into the query to be cached. This could allow an attacker to expose the results for a different query by causing a hash collision.\n\nThe query results which could be exposed to the attacker would not be very sensitive. But the vulnerability should still be fixed.\n\n## Summary\n\nI will study each of these cases more. I will remove the use of the md5 hashing algorithm in each case, and replace it with a stronger algorithm. I will keep you updated.","markdown_message":"\u003cp\u003eI will respond to each of the three different uses of \u003ccode\u003emd5()\u003c/code\u003eindividually.\u003c/p\u003e\n\n\u003ch2 id=\"src-includes-class-breaking-updater-php-line-246-and-247\"\u003e\\src\\includes\\class-breaking-updater.php line 246 and 247\u003c/h2\u003e\n\n\u003cp\u003eThis hash value is used only when the plugin is performing a breaking update. An example of a breaking update would be the update from version 1.x to version 2.x, or version 2.x to version 3.x. When a breaking update happens, the plugin runs a special compatibility check on each of the modules. During the check for a module, this hash is generated and saved to the database. The compatibility check only takes a few moments, and after it is finished the hash is deleted from the database.\u003c/p\u003e\n\n\u003cp\u003eSo, in order for an attacker to exploit the weak hashing algorithm, he would need to guess the exact time that the compatibility check for a module was being performed. He would then have only a few seconds to perform the exploit. If he did guess the time a breaking update was being performed, he would only be able to achieve a minor information disclosure.\u003c/p\u003e\n\n\u003cp\u003eBecause breaking updates are rare occurrences, and only last a few seconds, I made a deliberate choice to use a weak hashing algorithm. I thought that it would be an accepted risk. And I admit that using PHP\u0026#39;s \u003ccode\u003emd5()\u003c/code\u003e function was just an easy thing to do. However, now I do think that maybe it would be better to use a stronger hashing algorithm. At least it would be a better example to new coders who do not know that md5 is unsafe.\u003c/p\u003e\n\n\u003ch2 id=\"src-admin-includes-class-wordpoints-modules-list-table-php-line-541\"\u003e\\src\\admin\\includes\\class-wordpoints-modules-list-table.php line 541\u003c/h2\u003e\n\n\u003cp\u003eI think that the value is hashed here just to generate a unique \u003ccode\u003eid\u003c/code\u003e attribute for the checkbox element. I will explore this further. Maybe hashing is not needed here at all.\u003c/p\u003e\n\n\u003ch2 id=\"src-components-points-includes-class-wordpoints-points-logs-query-php-line-705\"\u003e\\src\\components\\points\\includes\\class-wordpoints-points-logs-query.php line 705\u003c/h2\u003e\n\n\u003cp\u003eI think this is the most serious case. Thank you for bringing it to my attention.\u003c/p\u003e\n\n\u003cp\u003eHere the hash is being used as a key for the cache. The attacker can manipulate the hash value if user-supplied data is incorporated into the query to be cached. This could allow an attacker to expose the results for a different query by causing a hash collision.\u003c/p\u003e\n\n\u003cp\u003eThe query results which could be exposed to the attacker would not be very sensitive. But the vulnerability should still be fixed.\u003c/p\u003e\n\n\u003ch2 id=\"summary\"\u003eSummary\u003c/h2\u003e\n\n\u003cp\u003eI will study each of these cases more. I will remove the use of the md5 hashing algorithm in each case, and replace it with a stronger algorithm. I will keep you updated.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-07-21T13:44:33.668Z","updated_at":"2015-07-21T13:44:33.668Z","actor":{"username":"jdgrimes","cleared":false,"url":"/jdgrimes","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/009/109/d46d46e7dd9a78c3bd46390279cd42d1c1e76124_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wordpoints","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":519030,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2015-07-21T13:46:08.660Z","updated_at":"2015-07-21T13:46:08.660Z","actor":{"url":"/wordpoints","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/361/a0559c0ee47289ddff142d66426b278b32961dc9_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"WordPoints"}},"bounty_amount":"25.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"wordpoints","collaborator":{"username":"ru94mb","url":"/ru94mb"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":519069,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@jdgrimes Thank you for detailed analysis of the issues. MD5 and as well as SHA-1 now a days is a strict no to new coders. N I suppose the risk will keep increasing with time.\n\nIt's ideal to fix these before it's too late.","markdown_message":"\u003cp\u003e\u003ca href=\"/jdgrimes\"\u003e@jdgrimes\u003c/a\u003e Thank you for detailed analysis of the issues. MD5 and as well as SHA-1 now a days is a strict no to new coders. N I suppose the risk will keep increasing with time.\u003c/p\u003e\n\n\u003cp\u003eIt\u0026#39;s ideal to fix these before it\u0026#39;s too late.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-07-21T14:16:11.618Z","updated_at":"2015-07-21T14:16:11.618Z","actor":{"username":"ru94mb","cleared":false,"url":"/ru94mb","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/KoV6xpuAmE7m34HY1huchq2f/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wordpoints","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":519793,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@ru94mb I've fixed these and will be releasing an update including the fixes later this week.\n\nI've removed the use of hashing from `\\src\\admin\\includes\\class-wordpoints-modules-list-table.php`, because I discovered that it wasn't needed.","markdown_message":"\u003cp\u003e\u003ca href=\"/ru94mb\"\u003e@ru94mb\u003c/a\u003e I\u0026#39;ve fixed these and will be releasing an update including the fixes later this week.\u003c/p\u003e\n\n\u003cp\u003eI\u0026#39;ve removed the use of hashing from \u003ccode\u003e\\src\\admin\\includes\\class-wordpoints-modules-list-table.php\u003c/code\u003e, because I discovered that it wasn\u0026#39;t needed.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-07-21T22:28:34.511Z","updated_at":"2015-07-21T22:28:34.511Z","actor":{"username":"jdgrimes","cleared":false,"url":"/jdgrimes","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/009/109/d46d46e7dd9a78c3bd46390279cd42d1c1e76124_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wordpoints","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":520056,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@jdgrimes Cool. I will have a look into the new code as well and see if there are any new issues.","markdown_message":"\u003cp\u003e\u003ca href=\"/jdgrimes\"\u003e@jdgrimes\u003c/a\u003e Cool. I will have a look into the new code as well and see if there are any new issues.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-07-22T06:46:48.842Z","updated_at":"2015-07-22T06:46:48.842Z","actor":{"username":"ru94mb","cleared":false,"url":"/ru94mb","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/KoV6xpuAmE7m34HY1huchq2f/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wordpoints","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":520579,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@ru94mb I've just published the [changes on GitHub](https://github.com/WordPoints/wordpoints/compare/security/77231?expand=1). You can review them and let me know if you have any feedback. I plan to release an update later today. ","markdown_message":"\u003cp\u003e\u003ca href=\"/ru94mb\"\u003e@ru94mb\u003c/a\u003e I\u0026#39;ve just published the \u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2FWordPoints%2Fwordpoints%2Fcompare%2Fsecurity%2F77231%3Fexpand%3D1\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003echanges on GitHub\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e. You can review them and let me know if you have any feedback. I plan to release an update later today. \u003c/p\u003e\n","automated_response":false,"created_at":"2015-07-22T13:00:41.720Z","updated_at":"2015-07-22T13:00:41.720Z","actor":{"username":"jdgrimes","cleared":false,"url":"/jdgrimes","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/009/109/d46d46e7dd9a78c3bd46390279cd42d1c1e76124_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wordpoints","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":521533,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"@ru94mb I've just released version 2.0.1, which includes these fixes. Thank you again for the report. If you find anything else, let us know.","markdown_message":"\u003cp\u003e\u003ca href=\"/ru94mb\"\u003e@ru94mb\u003c/a\u003e I\u0026#39;ve just released version 2.0.1, which includes these fixes. Thank you again for the report. If you find anything else, let us know.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-07-22T21:37:44.490Z","updated_at":"2015-07-22T21:37:44.490Z","actor":{"username":"jdgrimes","cleared":false,"url":"/jdgrimes","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/009/109/d46d46e7dd9a78c3bd46390279cd42d1c1e76124_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"ru94mb","url":"/ru94mb"},"genius_execution_id":null,"team_handle":"wordpoints","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":521534,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-07-22T21:38:17.069Z","updated_at":"2015-07-22T21:38:17.069Z","first_to_agree":true,"actor":{"username":"jdgrimes","cleared":false,"url":"/jdgrimes","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/009/109/d46d46e7dd9a78c3bd46390279cd42d1c1e76124_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wordpoints","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":521933,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Awesome. ","markdown_message":"\u003cp\u003eAwesome. \u003c/p\u003e\n","automated_response":false,"created_at":"2015-07-23T06:24:30.083Z","updated_at":"2015-07-23T06:24:30.083Z","actor":{"username":"ru94mb","cleared":false,"url":"/ru94mb","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/KoV6xpuAmE7m34HY1huchq2f/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wordpoints","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":521945,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-07-23T06:47:08.201Z","updated_at":"2015-07-23T06:47:08.201Z","actor":{"username":"ru94mb","cleared":false,"url":"/ru94mb","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/KoV6xpuAmE7m34HY1huchq2f/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wordpoints","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":521946,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-07-23T06:47:08.304Z","updated_at":"2015-07-23T06:47:08.304Z","actor":{"username":"ru94mb","cleared":false,"url":"/ru94mb","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/KoV6xpuAmE7m34HY1huchq2f/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wordpoints","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}