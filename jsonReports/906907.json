{"id":906907,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC85MDY5MDc=","url":"https://hackerone.com/reports/906907","title":"IDOR with Geolocation data not stripped from images","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2020-06-24T15:26:46.071Z","submitted_at":"2020-06-24T15:26:46.071Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"do_some_hack","url":"/do_some_hack","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/fkhFantF7F8JRHomgeirT45R/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":140,"url":"https://hackerone.com/irccloud","handle":"irccloud","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/140/c90be8ce0ea099d908ca652a82df9952b782e7c2_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/140/c90be8ce0ea099d908ca652a82df9952b782e7c2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"IRCCloud","twitter_handle":"irccloud","website":"https://www.irccloud.com","about":"Group chat for teams, friends, and communities. IRCCloud is an IRC client with a future. Stay connected, chat from anywhere, and never miss a message."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2020-07-26T15:36:33.868Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2020-06-26T15:36:31.539Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Vulnerable URL :-   https://usercontent.irccloud-cdn.com/file/0wXMTrPu/hgjbk\n\nVulnerability Discription:\nWhen an image is taken using a smartphone or camera certain metadata fields are often attached to it. These fields could include the model of the camera, the time it was taken, whether the flash was used, the shutter speed, focal length, light value and even the location. In Inturn, while uploading the image as a profile picture, the exif data is not stripped from images. The exif data in images contains sensitive data like Geoloacation, latitude, longitude, etc. Also it contains the camera information and other details. \n\nAnd your website vulnerable to image IDOR which allows attacker to see other users images and retrive data using tool.\n\nTools Used: exiftool.\n\nSteps TO reproduce:\n\nUse  2 accounts in two browser\n\nDownload images from here \n\nhttps://github.com/ianare/exif-samples/tree/master/jpg/gps\n\n1)In 1st account in network user can upload files just upload the image their and open image link in new tab.\n\n new tab that image url like\n\nhttps://usercontent.irccloud-cdn.com/file/0wXMTrPu/hgjbk\n\n2)In second account do same things and that url like down \n\nhttps://usercontent.irccloud-cdn.com/file/ZUsZU7az/3.jpg\n\n3) Change 1st account Url parameter value to 2nd acoount Url parameter(see poc for it).\n\n4) now image will shows up copy that url again and paste it to image data retrival website\n\nhttp://exif.regex.info/exif.cgi\n\n5) and see sensitive data   exposed.\n\n## Impact\n\n1) By this the attacker tracks your location and use it for personal things.\n2) Sensitive data exposed.","vulnerability_information_html":"\u003cp\u003eVulnerable URL :-   \u003ca title=\"https://usercontent.irccloud-cdn.com/file/0wXMTrPu/hgjbk\" href=\"/redirect?url=https%3A%2F%2Fusercontent.irccloud-cdn.com%2Ffile%2F0wXMTrPu%2Fhgjbk\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://usercontent.irccloud-cdn.com/file/0wXMTrPu/hgjbk\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eVulnerability Discription:\u003cbr\u003e\nWhen an image is taken using a smartphone or camera certain metadata fields are often attached to it. These fields could include the model of the camera, the time it was taken, whether the flash was used, the shutter speed, focal length, light value and even the location. In Inturn, while uploading the image as a profile picture, the exif data is not stripped from images. The exif data in images contains sensitive data like Geoloacation, latitude, longitude, etc. Also it contains the camera information and other details. \u003c/p\u003e\n\n\u003cp\u003eAnd your website vulnerable to image IDOR which allows attacker to see other users images and retrive data using tool.\u003c/p\u003e\n\n\u003cp\u003eTools Used: exiftool.\u003c/p\u003e\n\n\u003cp\u003eSteps TO reproduce:\u003c/p\u003e\n\n\u003cp\u003eUse  2 accounts in two browser\u003c/p\u003e\n\n\u003cp\u003eDownload images from here \u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"https://github.com/ianare/exif-samples/tree/master/jpg/gps\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fianare%2Fexif-samples%2Ftree%2Fmaster%2Fjpg%2Fgps\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/ianare/exif-samples/tree/master/jpg/gps\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e1)In 1st account in network user can upload files just upload the image their and open image link in new tab.\u003c/p\u003e\n\n\u003cp\u003enew tab that image url like\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"https://usercontent.irccloud-cdn.com/file/0wXMTrPu/hgjbk\" href=\"/redirect?url=https%3A%2F%2Fusercontent.irccloud-cdn.com%2Ffile%2F0wXMTrPu%2Fhgjbk\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://usercontent.irccloud-cdn.com/file/0wXMTrPu/hgjbk\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e2)In second account do same things and that url like down \u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"https://usercontent.irccloud-cdn.com/file/ZUsZU7az/3.jpg\" href=\"/redirect?url=https%3A%2F%2Fusercontent.irccloud-cdn.com%2Ffile%2FZUsZU7az%2F3.jpg\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://usercontent.irccloud-cdn.com/file/ZUsZU7az/3.jpg\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e3) Change 1st account Url parameter value to 2nd acoount Url parameter(see poc for it).\u003c/p\u003e\n\n\u003cp\u003e4) now image will shows up copy that url again and paste it to image data retrival website\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"http://exif.regex.info/exif.cgi\" href=\"/redirect?url=http%3A%2F%2Fexif.regex.info%2Fexif.cgi\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://exif.regex.info/exif.cgi\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e5) and see sensitive data   exposed.\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003e1) By this the attacker tracks your location and use it for personal things.\u003cbr\u003e\n2) Sensitive data exposed.\u003c/p\u003e\n","bounty_amount":"200.0","formatted_bounty":"$200","weakness":{"id":55,"name":"Insecure Direct Object Reference (IDOR)"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":881191,"file_name":"2020-06-24_08-17-01.mkv","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/o6p2Wf6DCER29AMPcBRPZxEH?response-content-disposition=attachment%3B%20filename%3D%222020-06-24_08-17-01.mkv%22%3B%20filename%2A%3DUTF-8%27%272020-06-24_08-17-01.mkv\u0026response-content-type=video%2Fx-matroska\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQRF2F3DNN%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T070941Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCq%2BvKnwl6LFdj00DiqFKaUHM8vK%2Fo1tPHwYahCeGa93QIgIGXi89nBgDj4GiNdSy8pbzTFSts%2FsTmVKSM%2B7%2BKO9T4qtAMIVxABGgwwMTM2MTkyNzQ4NDkiDC9ugoHsMNk43keJ8SqRA8JrBBYsK5T0HiaJ%2F4T50sG1Ri6J%2BT91kOgNavpYRolFX7jpLcV0V81FUABPzsjSnAxRmYBypjIaPqZGQ8oq%2F9n27wPLgj8hUTl8O3SfU1GWCMHbROvW%2BF2K77xGt0sJKNZYVxNdbqrYwCp5MFfMpJjwvv%2BhMkb%2BfRRyL7GEsu82VMU41lKH3RgrBDJApguUYlLANZ1Ej8ImBTuQa0PTHDqpwoWpjaPcrnIHZqTdHOI5Wm1eCoy5eaHGFikwjjvjuMJ%2F1a5ex%2FCIOhGcwoqCBDet1aBO%2BZq78RzS1QY34XnoChAp%2BaikZB20FcxjUwn%2BkvJECosM%2B4F4PQHepofUS3ejTLZPjeYi9qQNjzq%2Fm%2Fv%2FV4Vqc3IwmTFe06OdDxIgpZyAcTQoSU8vA7sbEDpB%2F3XQDS%2BUqZejbvdrbfU8WGZYnfYRHIKZtByJaRcPB8vqFX9lX0oeLxz0IEswNXH%2FFNMPBsLv79pLu3OV6Lzfbgb36AT8ui2UZLwoOGRrSo71Tb%2FsYvBelBr2drk9Yi%2Fa%2FnGwML2Fq%2F8FOusBbN3FmFgpQ8hwRzpol0ZxBWjfkVayY1CeW8JmiNjsl1ndCgMmcPk10W64GF1qbk7fF0uPQopY1SymUfLnKrk2DYd5OUiFjtVktJLGKZ7wkgrDfWYDpQHSQRJQyMvnd2nX1QfEA0AlGzRulOvM2iwTIk241T4DuFrDCiCqYL8Mv%2FPeDbSAy7t6gkKpJ8C2PUVCIivsXSH1HvLfNTen1g5wD0tpM%2FnXwZxdxfuh8W3doYRnkWcmf8W%2F2IdcL3V8Ca3%2FV7qrIFxbsZIzSmpnSBl18cNkli7atg7%2FBcRNrqYiFsXMe5OsMSXyZkZK%2BQ%3D%3D\u0026X-Amz-Signature=9e3b8f2b71948371f5f4f4d7e7d4d44dead4707ced8822cf0598cfac2a22a626","file_size":12503328,"type":"video/x-matroska"}],"allow_singular_disclosure_at":"2020-07-26T15:36:31.619Z","allow_singular_disclosure_after":-13447989.767820705,"singular_disclosure_allowed":true,"vote_count":34,"voters":["mohammedmagdi","mik317","prophet","youngsheldon","ashima255","the0utcastcoder","mygf","darkshadow1733","klau5","vishwaratna","and 24 more..."],"severity":{"rating":"high","author_type":"User"},"structured_scope":{"databaseId":256,"asset_type":"URL","asset_identifier":"www.irccloud.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":8402779,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks for the report. We have identified the issue where EXIF info is not being removed and have deployed a fix. The fix applies to all existing file, but existing URLs may still show cached content. Please can you verify from your side?","markdown_message":"\u003cp\u003eThanks for the report. We have identified the issue where EXIF info is not being removed and have deployed a fix. The fix applies to all existing file, but existing URLs may still show cached content. Please can you verify from your side?\u003c/p\u003e\n","automated_response":false,"created_at":"2020-06-25T06:44:12.642Z","updated_at":"2020-06-25T06:44:12.642Z","actor":{"url":"/irccloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/140/c90be8ce0ea099d908ca652a82df9952b782e7c2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"IRCCloud"}},"bounty_amount":"200.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"irccloud","collaborator":{"username":"do_some_hack","url":"/do_some_hack"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8407002,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for the bounty but i am expecting more but its ok.\nand i verified the bug but it still showing me EXIF data  and IDOR still exist.","markdown_message":"\u003cp\u003eThanks for the bounty but i am expecting more but its ok.\u003cbr\u003e\nand i verified the bug but it still showing me EXIF data  and IDOR still exist.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-06-25T14:21:29.770Z","updated_at":"2020-06-25T14:21:29.770Z","actor":{"username":"do_some_hack","cleared":false,"url":"/do_some_hack","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fkhFantF7F8JRHomgeirT45R/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"irccloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8410053,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"As I mentioned, the existing URLs may still be cached. Please try uploading a new image and see if you still get EXIF geo location.\n\nIf by IDOR, you mean that file upload URLs are not private, then yes, this is by design. Files are intended to be shared on public IRC networks with people who are not IRCCloud users. This is similar to imgur URLs.","markdown_message":"\u003cp\u003eAs I mentioned, the existing URLs may still be cached. Please try uploading a new image and see if you still get EXIF geo location.\u003c/p\u003e\n\n\u003cp\u003eIf by IDOR, you mean that file upload URLs are not private, then yes, this is by design. Files are intended to be shared on public IRC networks with people who are not IRCCloud users. This is similar to imgur URLs.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-06-25T18:23:49.521Z","updated_at":"2020-06-25T18:23:49.521Z","actor":{"username":"jwheare","cleared":false,"url":"/jwheare","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/778/b500b506bad385a82e5e0da28a0214d263822656_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"irccloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8415001,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"you are right i am not able to get EXIF data , now i can say that issue is resolved.","markdown_message":"\u003cp\u003eyou are right i am not able to get EXIF data , now i can say that issue is resolved.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-06-26T08:11:58.557Z","updated_at":"2020-06-26T08:11:58.557Z","actor":{"username":"do_some_hack","cleared":false,"url":"/do_some_hack","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fkhFantF7F8JRHomgeirT45R/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"irccloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8415012,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thank you for verifying and reporting the issue.","markdown_message":"\u003cp\u003eThank you for verifying and reporting the issue.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-06-26T08:12:44.377Z","updated_at":"2020-06-26T08:12:44.377Z","actor":{"username":"jwheare","cleared":false,"url":"/jwheare","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/778/b500b506bad385a82e5e0da28a0214d263822656_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"do_some_hack","url":"/do_some_hack"},"genius_execution_id":null,"team_handle":"irccloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8415082,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"hello jwheare,\n    I want to disclose this vulnerability.please help me to disclose it.","markdown_message":"\u003cp\u003ehello jwheare,\u003cbr\u003e\n    I want to disclose this vulnerability.please help me to disclose it.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-06-26T08:19:37.517Z","updated_at":"2020-06-26T08:19:37.517Z","actor":{"username":"do_some_hack","cleared":false,"url":"/do_some_hack","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fkhFantF7F8JRHomgeirT45R/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"irccloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8420373,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"You can usually request disclosure yourself directly. Here you go.","markdown_message":"\u003cp\u003eYou can usually request disclosure yourself directly. Here you go.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-06-26T15:36:31.556Z","updated_at":"2020-06-26T15:36:31.556Z","first_to_agree":true,"actor":{"username":"jwheare","cleared":false,"url":"/jwheare","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/778/b500b506bad385a82e5e0da28a0214d263822656_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"irccloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8420933,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks","markdown_message":"\u003cp\u003eThanks\u003c/p\u003e\n","automated_response":false,"created_at":"2020-06-26T16:29:44.561Z","updated_at":"2020-06-26T16:29:44.561Z","actor":{"username":"do_some_hack","cleared":false,"url":"/do_some_hack","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fkhFantF7F8JRHomgeirT45R/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"irccloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8757638,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-07-26T15:36:33.900Z","updated_at":"2020-07-26T15:36:33.900Z","actor":{"url":"/irccloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/140/c90be8ce0ea099d908ca652a82df9952b782e7c2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"IRCCloud"}},"genius_execution_id":null,"team_handle":"irccloud","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}