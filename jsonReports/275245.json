{"id":275245,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yNzUyNDU=","url":"https://hackerone.com/reports/275245","title":"Can link to websites from profile","state":"Closed","substate":"informative","severity_rating":"low","readable_substate":"Informative","created_at":"2017-10-06T21:32:10.914Z","submitted_at":"2017-10-06T21:32:10.914Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"flex0geek","url":"/flex0geek","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/sbkCyki1w48i7VHpDN8Y9aoQ/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":21801,"url":"https://hackerone.com/wakatime","handle":"wakatime","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/021/801/c3af6aa265b9b7d7d6e5fd52bb768e43b06d4a44_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/021/801/c3af6aa265b9b7d7d6e5fd52bb768e43b06d4a44_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"WakaTime","twitter_handle":"wakatime","website":"https://wakatime.com","about":"Automated metrics about your programming from text editor plugins."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2017-10-07T18:24:44.033Z","bug_reporter_agreed_on_going_public_at":"2017-10-07T18:19:16.413Z","team_member_agreed_on_going_public_at":"2017-10-07T18:24:43.996Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"when I input a website to my profile it creates tag link:\n\u003ccode\u003e\u003ca href=\"http://test.org\" rel=\"nofollow me\"\u003etest.org\u003c/a\u003e\u003c/code\u003e\nthis is a flaw, how? if the owner of the profile and a malicious link it is possible to redirect the user to a phishing page of wakatime.\n\nHere's the scenario of this attack:\n\n1) Attacker put a malicious link on his profile.\n2) Once the victim clicks the link, it will be redirected to the malicious link but the malicious link has a malicious code inside that makes an action that it should do something to referral(where it came from before redirection) then the referral is wakatime. Using the malicious code, the malicious code will refresh the wakatime site to a fake wakatime site that will ask for sign in details like that.\n\nyou can fix it with:\n\u003ca href=\"http://google.com\" rel=\"noreferrer\"\u003egoogle.com\u003c/a\u003e\n\nSetting this on user provided links provides protection against this kind of attack. The cost of this solution is that the referring site won't show up as a referrer in analytics on the referred sites.\n\nThanks.","vulnerability_information_html":"\u003cp\u003ewhen I input a website to my profile it creates tag link:\u003cbr\u003e\n\u0026lt;code\u0026gt;\u0026lt;a href=\u0026quot;http://test.org\u0026quot; rel=\u0026quot;nofollow me\u0026quot;\u0026gt;test.org\u0026lt;/a\u0026gt;\u0026lt;/code\u0026gt;\u003cbr\u003e\nthis is a flaw, how? if the owner of the profile and a malicious link it is possible to redirect the user to a phishing page of wakatime.\u003c/p\u003e\n\n\u003cp\u003eHere\u0026#39;s the scenario of this attack:\u003c/p\u003e\n\n\u003cp\u003e1) Attacker put a malicious link on his profile.\u003cbr\u003e\n2) Once the victim clicks the link, it will be redirected to the malicious link but the malicious link has a malicious code inside that makes an action that it should do something to referral(where it came from before redirection) then the referral is wakatime. Using the malicious code, the malicious code will refresh the wakatime site to a fake wakatime site that will ask for sign in details like that.\u003c/p\u003e\n\n\u003cp\u003eyou can fix it with:\u003cbr\u003e\n\u0026lt;a href=\u0026quot;http://google.com\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;google.com\u0026lt;/a\u0026gt;\u003c/p\u003e\n\n\u003cp\u003eSetting this on user provided links provides protection against this kind of attack. The cost of this solution is that the referring site won\u0026#39;t show up as a referrer in analytics on the referred sites.\u003c/p\u003e\n\n\u003cp\u003eThanks.\u003c/p\u003e\n","weakness":{"id":27,"name":"Improper Authentication - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":3,"voters":["r3y","fadel","khaledibnalwalid"],"severity":{"rating":"low","author_type":"User"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":2050359,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"without \u003ccode\u003e (sorry).","markdown_message":"\u003cp\u003ewithout \u0026lt;code\u0026gt; (sorry).\u003c/p\u003e\n","automated_response":false,"created_at":"2017-10-06T21:32:57.826Z","updated_at":"2017-10-06T21:32:57.826Z","actor":{"username":"flex0geek","cleared":false,"url":"/flex0geek","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/sbkCyki1w48i7VHpDN8Y9aoQ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"wakatime","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2050642,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"What is the vulnerability here? Being able to link to a personal website from your profile is the intended behavior of links on profile pages.","markdown_message":"\u003cp\u003eWhat is the vulnerability here? Being able to link to a personal website from your profile is the intended behavior of links on profile pages.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-10-07T02:30:53.436Z","updated_at":"2017-10-07T02:30:53.436Z","actor":{"username":"alanhamlett","cleared":false,"url":"/alanhamlett","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/175/849/7d4d213b7dc7d636a5abae089f1aa907e074bcdb_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"wakatime","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2050821,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"when the attacker redirected the victim to a malicious page now he can steal data from him or affect him with a malware.\n\nin the video, a simple explanation https://youtu.be/g1HDxR2xHC4.\nthe code from the video:\n```\n\u003c?php\n\nforeach($_POST as $variable =\u003e $value) {\n    echo $variable.\" : \".$value.'\u003cbr\u003e';\n}\n\n?\u003e\n```\nThanks.","markdown_message":"\u003cp\u003ewhen the attacker redirected the victim to a malicious page now he can steal data from him or affect him with a malware.\u003c/p\u003e\n\n\u003cp\u003ein the video, a simple explanation \u003ca title=\"https://youtu.be/g1HDxR2xHC4\" href=\"/redirect?url=https%3A%2F%2Fyoutu.be%2Fg1HDxR2xHC4\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://youtu.be/g1HDxR2xHC4\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e.\u003cbr\u003e\nthe code from the video:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight php\"\u003e\u003ccode\u003e\u003cspan class=\"cp\"\u003e\u0026lt;?php\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003eforeach\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$_POST\u003c/span\u003e \u003cspan class=\"k\"\u003eas\u003c/span\u003e \u003cspan class=\"nv\"\u003e$variable\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"nv\"\u003e$value\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eecho\u003c/span\u003e \u003cspan class=\"nv\"\u003e$variable\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot; : \u0026quot;\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"nv\"\u003e$value\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;\u0026lt;br\u0026gt;\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"cp\"\u003e?\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThanks.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-10-07T07:06:00.857Z","updated_at":"2017-10-07T07:06:00.857Z","actor":{"username":"flex0geek","cleared":false,"url":"/flex0geek","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/sbkCyki1w48i7VHpDN8Y9aoQ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"wakatime","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2050978,"is_internal":false,"editable":false,"type":"Activities::BugNotApplicable","message":"That's not a vulnerability, but just how links work.","markdown_message":"\u003cp\u003eThat\u0026#39;s not a vulnerability, but just how links work.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-10-07T10:13:18.154Z","updated_at":"2017-10-07T10:13:48.705Z","actor":{"username":"alanhamlett","cleared":false,"url":"/alanhamlett","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/175/849/7d4d213b7dc7d636a5abae089f1aa907e074bcdb_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"wakatime","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2051079,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"before I send the report I searched and my report looks like this #109161 can you see it.\nThanks.","markdown_message":"\u003cp\u003ebefore I send the report I searched and my report looks like this \u003ca href=\"/reports/109161\"\u003e#109161\u003c/a\u003e can you see it.\u003cbr\u003e\nThanks.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-10-07T13:31:02.598Z","updated_at":"2017-10-07T13:31:02.598Z","actor":{"username":"flex0geek","cleared":false,"url":"/flex0geek","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/sbkCyki1w48i7VHpDN8Y9aoQ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"wakatime","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2051288,"is_internal":false,"editable":false,"type":"Activities::BugReopened","message":"","markdown_message":"","automated_response":false,"created_at":"2017-10-07T18:15:57.021Z","updated_at":"2017-10-07T18:15:57.021Z","actor":{"username":"alanhamlett","cleared":false,"url":"/alanhamlett","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/175/849/7d4d213b7dc7d636a5abae089f1aa907e074bcdb_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"wakatime","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2051289,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"For tabnabbing attacks, the external link must use `target=\"_blank\"`, so this link is not vulnerable.\n\nAnyway I'll change to \"Informative\", but no fix is necessary.","markdown_message":"\u003cp\u003eFor tabnabbing attacks, the external link must use \u003ccode\u003etarget=\u0026quot;_blank\u0026quot;\u003c/code\u003e, so this link is not vulnerable.\u003c/p\u003e\n\n\u003cp\u003eAnyway I\u0026#39;ll change to \u0026quot;Informative\u0026quot;, but no fix is necessary.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-10-07T18:17:54.225Z","updated_at":"2017-10-07T18:17:54.225Z","actor":{"username":"alanhamlett","cleared":false,"url":"/alanhamlett","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/175/849/7d4d213b7dc7d636a5abae089f1aa907e074bcdb_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"wakatime","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2051290,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Ok, Thanks.","markdown_message":"\u003cp\u003eOk, Thanks.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-10-07T18:19:03.684Z","updated_at":"2017-10-07T18:19:03.684Z","actor":{"username":"flex0geek","cleared":false,"url":"/flex0geek","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/sbkCyki1w48i7VHpDN8Y9aoQ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"wakatime","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2051291,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-10-07T18:19:16.428Z","updated_at":"2017-10-07T18:19:16.428Z","first_to_agree":true,"actor":{"username":"flex0geek","cleared":false,"url":"/flex0geek","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/sbkCyki1w48i7VHpDN8Y9aoQ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"wakatime","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2051298,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-10-07T18:24:44.015Z","updated_at":"2017-10-07T18:24:44.015Z","actor":{"username":"alanhamlett","cleared":false,"url":"/alanhamlett","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/175/849/7d4d213b7dc7d636a5abae089f1aa907e074bcdb_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"wakatime","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2051299,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-10-07T18:24:44.047Z","updated_at":"2017-10-07T18:24:44.047Z","actor":{"username":"alanhamlett","cleared":false,"url":"/alanhamlett","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/175/849/7d4d213b7dc7d636a5abae089f1aa907e074bcdb_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"wakatime","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2051300,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2017-10-07T18:26:09.144Z","updated_at":"2017-10-07T18:26:09.144Z","additional_data":{"old_title":"inject a malicious link","new_title":"can link to malicious websites from profile"},"actor":{"username":"alanhamlett","cleared":false,"url":"/alanhamlett","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/175/849/7d4d213b7dc7d636a5abae089f1aa907e074bcdb_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"wakatime","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2051301,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2017-10-07T18:26:28.424Z","updated_at":"2017-10-07T18:26:28.424Z","additional_data":{"old_title":"can link to malicious websites from profile","new_title":"Can link to websites from profile"},"actor":{"username":"alanhamlett","cleared":false,"url":"/alanhamlett","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/175/849/7d4d213b7dc7d636a5abae089f1aa907e074bcdb_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"wakatime","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}