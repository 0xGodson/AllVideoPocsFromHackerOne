{"id":138244,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMzgyNDQ=","url":"https://hackerone.com/reports/138244","title":"Missing access control exposing detailed information on all users","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-05-12T10:25:47.029Z","submitted_at":"2016-05-12T10:25:47.029Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"albinowax","url":"/albinowax","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/056/414/9d843d496965d8c0e710de3867a41720c1577dc4_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":297,"url":"https://hackerone.com/wp-api","handle":"wp-api","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/297/8a03fc5b57d0e730312ead031cb0d438a490c28e_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/297/8a03fc5b57d0e730312ead031cb0d438a490c28e_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"paused","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"WP API","twitter_handle":null,"website":"http://wp-api.org/","about":"Access your WordPress siteâ€™s data through an easy-to-use HTTP REST API."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2016-10-17T23:40:44.282Z","bug_reporter_agreed_on_going_public_at":"2016-09-26T12:07:30.353Z","team_member_agreed_on_going_public_at":"2016-10-17T23:40:44.224Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"The WP REST API WordPress plugin fails to apply access controls for the 'edit' context. This means that with a single HTTP request, an attacker can obtain the following information for every single registered user: username, email address, first name, last name, date of registration, and detailed privilege information. This is a treasure trove of information for someone planning an attack - they know exactly which email addresses to target in order to gain admin privileges and complete control over the webserver.\n\nTo replicate this issue, simply send the following request while unauthenticated:\nGET /wp-json/wp/v2/users?context=edit\n\nPlease note that I've submitted this report to a couple of entities directly affected by this vulnerability so they can implement a workaround.","vulnerability_information_html":"\u003cp\u003eThe WP REST API WordPress plugin fails to apply access controls for the \u0026#39;edit\u0026#39; context. This means that with a single HTTP request, an attacker can obtain the following information for every single registered user: username, email address, first name, last name, date of registration, and detailed privilege information. This is a treasure trove of information for someone planning an attack - they know exactly which email addresses to target in order to gain admin privileges and complete control over the webserver.\u003c/p\u003e\n\n\u003cp\u003eTo replicate this issue, simply send the following request while unauthenticated:\u003cbr\u003e\nGET /wp-json/wp/v2/users?context=edit\u003c/p\u003e\n\n\u003cp\u003ePlease note that I\u0026#39;ve submitted this report to a couple of entities directly affected by this vulnerability so they can implement a workaround.\u003c/p\u003e\n","bounty_amount":"100.0","formatted_bounty":"$100","weakness":{"id":27,"name":"Improper Authentication - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2016-10-26T12:07:30.506Z","allow_singular_disclosure_after":-131732383.40500678,"singular_disclosure_allowed":true,"vote_count":14,"voters":["arneswinnen","albinowax","dawgyg","yaworsk","supernatural","c1231665","exception","sumit7","spetr0x","clarckowen_","and 4 more..."],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":964791,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Anyone there?","markdown_message":"\u003cp\u003eAnyone there?\u003c/p\u003e\n","automated_response":false,"created_at":"2016-05-19T14:48:42.879Z","updated_at":"2016-05-19T14:48:42.879Z","actor":{"username":"albinowax","cleared":true,"url":"/albinowax","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/056/414/9d843d496965d8c0e710de3867a41720c1577dc4_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wp-api","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":975438,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"So so sorry for not getting back to you earlier, this totally slipped past my radar, and I've been sick. My sincere apologies.\n\nCan you provide an example of a site that has this vulnerability, as well as the version(s) this affects? I'm not seeing this on the demo site: https://demo.wp-api.org/wp-json/wp/v2/users?context=edit","markdown_message":"\u003cp\u003eSo so sorry for not getting back to you earlier, this totally slipped past my radar, and I\u0026#39;ve been sick. My sincere apologies.\u003c/p\u003e\n\n\u003cp\u003eCan you provide an example of a site that has this vulnerability, as well as the version(s) this affects? I\u0026#39;m not seeing this on the demo site: \u003ca title=\"https://demo.wp-api.org/wp-json/wp/v2/users?context=edit\" href=\"/redirect?url=https%3A%2F%2Fdemo.wp-api.org%2Fwp-json%2Fwp%2Fv2%2Fusers%3Fcontext%3Dedit\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://demo.wp-api.org/wp-json/wp/v2/users?context=edit\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2016-05-24T13:35:28.340Z","updated_at":"2016-05-24T13:35:28.340Z","actor":{"username":"rmccue","cleared":false,"url":"/rmccue","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/AKpDLiG2wr6QTg7CvMCuBLX1/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wp-api","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":975683,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Here's a live one: http://blogs.informatica.com/wp-json/wp/v2/users?context=edit\u0026per_page=100\n\nI personally found this issue on a locally hosted site running WordPress 4.5.2 with WP REST API Version 2.0-beta13.","markdown_message":"\u003cp\u003eHere\u0026#39;s a live one: \u003ca title=\"http://blogs.informatica.com/wp-json/wp/v2/users?context=edit\u0026amp;per_page=100\" href=\"/redirect?url=http%3A%2F%2Fblogs.informatica.com%2Fwp-json%2Fwp%2Fv2%2Fusers%3Fcontext%3Dedit%26per_page%3D100\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://blogs.informatica.com/wp-json/wp/v2/users?context=edit\u0026amp;per_page=100\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eI personally found this issue on a locally hosted site running WordPress 4.5.2 with WP REST API Version 2.0-beta13.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-05-24T14:54:39.680Z","updated_at":"2016-05-24T14:54:39.680Z","actor":{"username":"albinowax","cleared":true,"url":"/albinowax","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/056/414/9d843d496965d8c0e710de3867a41720c1577dc4_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wp-api","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":982430,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for that; investigating now to replicate.. This might be a recent change that we missed during review, but this is definitely unintended behaviour and a regression from previous behaviour.","markdown_message":"\u003cp\u003eThanks for that; investigating now to replicate.. This might be a recent change that we missed during review, but this is definitely unintended behaviour and a regression from previous behaviour.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-05-25T00:18:16.798Z","updated_at":"2016-05-25T00:18:16.798Z","actor":{"username":"rmccue","cleared":false,"url":"/rmccue","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/AKpDLiG2wr6QTg7CvMCuBLX1/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wp-api","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":982442,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Confirmed with Beta 13, but it has already been fixed: https://github.com/WP-API/WP-API/pull/2463\n\nGoing to double-check with the other committers as to whether this has always been the case, definitely still seems like a regression in B13 to me. We should also push a release with a big red warning about this, because it's a large privacy issue.","markdown_message":"\u003cp\u003eConfirmed with Beta 13, but it has already been fixed: \u003ca title=\"https://github.com/WP-API/WP-API/pull/2463\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2FWP-API%2FWP-API%2Fpull%2F2463\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/WP-API/WP-API/pull/2463\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eGoing to double-check with the other committers as to whether this has always been the case, definitely still seems like a regression in B13 to me. We should also push a release with a big red warning about this, because it\u0026#39;s a large privacy issue.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-05-25T00:44:10.481Z","updated_at":"2016-05-25T00:44:10.481Z","actor":{"username":"rmccue","cleared":false,"url":"/rmccue","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/AKpDLiG2wr6QTg7CvMCuBLX1/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wp-api","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":982800,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Sounds good, I agree that it's worth drawing attention to this so people are aware there may have been some data disclosure. Hopefully the test in that pull request will prevent it from reoccurring. ","markdown_message":"\u003cp\u003eSounds good, I agree that it\u0026#39;s worth drawing attention to this so people are aware there may have been some data disclosure. Hopefully the test in that pull request will prevent it from reoccurring. \u003c/p\u003e\n","automated_response":false,"created_at":"2016-05-25T09:11:21.339Z","updated_at":"2016-05-25T09:11:21.339Z","actor":{"username":"albinowax","cleared":true,"url":"/albinowax","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/056/414/9d843d496965d8c0e710de3867a41720c1577dc4_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wp-api","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":982918,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"We're going to push security releases for Beta 12 and Beta 13, which are the only releases effected. How would you like to be credited in the release post? :)","markdown_message":"\u003cp\u003eWe\u0026#39;re going to push security releases for Beta 12 and Beta 13, which are the only releases effected. How would you like to be credited in the release post? :)\u003c/p\u003e\n","automated_response":false,"created_at":"2016-05-25T12:07:52.566Z","updated_at":"2016-05-25T12:07:52.566Z","actor":{"username":"rmccue","cleared":false,"url":"/rmccue","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/AKpDLiG2wr6QTg7CvMCuBLX1/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wp-api","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":982944,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Cool. Could you credit me as: James Kettle (PortSwigger Web Security)\n\n(I found this by accident at work while investigating something different)","markdown_message":"\u003cp\u003eCool. Could you credit me as: James Kettle (PortSwigger Web Security)\u003c/p\u003e\n\n\u003cp\u003e(I found this by accident at work while investigating something different)\u003c/p\u003e\n","automated_response":false,"created_at":"2016-05-25T12:42:25.715Z","updated_at":"2016-05-25T12:42:25.715Z","actor":{"username":"albinowax","cleared":true,"url":"/albinowax","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/056/414/9d843d496965d8c0e710de3867a41720c1577dc4_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wp-api","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":982945,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"We've credited you on the blog post as \"James Kettle (albinowax)\", let me know if you'd prefer something else: https://make.wordpress.org/core/2016/05/25/wp-rest-api-versions-2-0-beta-12-1-and-2-0-beta-13-1/\n\nAlso going to issue a bounty for this, for bringing it to our attention, although the issue had already been fixed beforehand. Thanks for letting us know, and apologies again on the delay.","markdown_message":"\u003cp\u003eWe\u0026#39;ve credited you on the blog post as \u0026quot;James Kettle (albinowax)\u0026quot;, let me know if you\u0026#39;d prefer something else: \u003ca title=\"https://make.wordpress.org/core/2016/05/25/wp-rest-api-versions-2-0-beta-12-1-and-2-0-beta-13-1/\" href=\"/redirect?url=https%3A%2F%2Fmake.wordpress.org%2Fcore%2F2016%2F05%2F25%2Fwp-rest-api-versions-2-0-beta-12-1-and-2-0-beta-13-1%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://make.wordpress.org/core/2016/05/25/wp-rest-api-versions-2-0-beta-12-1-and-2-0-beta-13-1/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eAlso going to issue a bounty for this, for bringing it to our attention, although the issue had already been fixed beforehand. Thanks for letting us know, and apologies again on the delay.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-05-25T12:43:03.968Z","updated_at":"2016-05-25T12:43:03.968Z","actor":{"url":"/wp-api","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/297/8a03fc5b57d0e730312ead031cb0d438a490c28e_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"WP API"}},"bounty_amount":"100.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"wp-api","collaborator":{"username":"albinowax","url":"/albinowax"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":982946,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2016-05-25T12:43:26.844Z","updated_at":"2016-05-25T12:43:26.844Z","actor":{"username":"rmccue","cleared":false,"url":"/rmccue","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/AKpDLiG2wr6QTg7CvMCuBLX1/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"albinowax","url":"/albinowax"},"genius_execution_id":null,"team_handle":"wp-api","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":982958,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Apologies, message didn't come through immediately; I've updated the post now. Thanks again.","markdown_message":"\u003cp\u003eApologies, message didn\u0026#39;t come through immediately; I\u0026#39;ve updated the post now. Thanks again.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-05-25T12:50:36.431Z","updated_at":"2016-05-25T12:50:36.431Z","actor":{"username":"rmccue","cleared":false,"url":"/rmccue","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/AKpDLiG2wr6QTg7CvMCuBLX1/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wp-api","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1216051,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-09-26T12:07:30.440Z","updated_at":"2016-09-26T12:07:30.440Z","first_to_agree":true,"actor":{"username":"albinowax","cleared":true,"url":"/albinowax","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/056/414/9d843d496965d8c0e710de3867a41720c1577dc4_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wp-api","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1252102,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-10-17T23:40:44.242Z","updated_at":"2016-10-17T23:40:44.242Z","actor":{"username":"rmccue","cleared":false,"url":"/rmccue","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/AKpDLiG2wr6QTg7CvMCuBLX1/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wp-api","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1252103,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-10-17T23:40:44.298Z","updated_at":"2016-10-17T23:40:44.298Z","actor":{"username":"rmccue","cleared":false,"url":"/rmccue","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/AKpDLiG2wr6QTg7CvMCuBLX1/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wp-api","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}