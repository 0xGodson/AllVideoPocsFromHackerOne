{"id":122791,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMjI3OTE=","url":"https://hackerone.com/reports/122791","title":"Active Email Hyperlink Sent on riders.uber.com","state":"Closed","substate":"informative","readable_substate":"Informative","created_at":"2016-03-13T11:08:47.517Z","submitted_at":"2016-03-13T11:08:47.517Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"rohk","url":"/rohk","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/041/719/1c7576ebac110bb0402894581907c289e6c9263a_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":314,"url":"https://hackerone.com/uber","handle":"uber","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/314/24ea21370a71b18eafb5722d5855825ab622b5dd_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/314/24ea21370a71b18eafb5722d5855825ab622b5dd_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Uber","twitter_handle":"","website":"https://www.uber.com","about":""}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2016-06-13T21:55:40.940Z","bug_reporter_agreed_on_going_public_at":"2016-04-12T07:11:01.768Z","team_member_agreed_on_going_public_at":"2016-06-13T21:55:40.814Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"On `riders.uber.com` when the rider changes their information an email will be sent to their email informing them a change has been made on their rider account.\n\nThe rider can change their first name to anything within 45 characters and once the change has been made they can add an email to their account. But once they add the email, a confirmation email will be sent but will contain the riders first name. If the rider changed their first name to `Rider. Visit www.yahoo.com for more info.` the URL posted will have an active hyperlink.\n\n`Hi Rider. Visit www.yahoo.com for more info.,\n\nPlease visit this link to confirm your email address:\n\nhttps://riders.uber.com/confirm-email?email_token=\n\nLove,\nTeam Uber`\n\nPoC:\nThis issue does reply on some type of `social engineering`\n\nThe attacker can purchase a short domain and put a message within 45 characters as their first name.\nOnce they have done that they can start adding and/or replacing emails a bunch of times to send mass emails and these emails will be coming from `support@uber.com`\n\nOnce the person receiving the emails clicks on the link, they will be redirected to some malicious website.\n\nVideo: https://www.dropbox.com/s/84e7oftmcdmb4sw/emailhyperlink.mov?dl=0\n\nPossible Fix:\nDo not allow links to be set as the riders names.\nDo not allow special characters (. , / \\ etc.)","vulnerability_information_html":"\u003cp\u003eOn \u003ccode\u003eriders.uber.com\u003c/code\u003e when the rider changes their information an email will be sent to their email informing them a change has been made on their rider account.\u003c/p\u003e\n\n\u003cp\u003eThe rider can change their first name to anything within 45 characters and once the change has been made they can add an email to their account. But once they add the email, a confirmation email will be sent but will contain the riders first name. If the rider changed their first name to \u003ccode\u003eRider. Visit www.yahoo.com for more info.\u003c/code\u003e the URL posted will have an active hyperlink.\u003c/p\u003e\n\n\u003cp\u003e`Hi Rider. Visit \u003ca href=\"/redirect?url=http%3A%2F%2Fwww.yahoo.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ewww.yahoo.com\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e for more info.,\u003c/p\u003e\n\n\u003cp\u003ePlease visit this link to confirm your email address:\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"https://riders.uber.com/confirm-email?email_token=\" href=\"/redirect?url=https%3A%2F%2Friders.uber.com%2Fconfirm-email%3Femail_token%3D\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://riders.uber.com/confirm-email?email_token=\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eLove,\u003cbr\u003e\nTeam Uber`\u003c/p\u003e\n\n\u003cp\u003ePoC:\u003cbr\u003e\nThis issue does reply on some type of \u003ccode\u003esocial engineering\u003c/code\u003e\u003c/p\u003e\n\n\u003cp\u003eThe attacker can purchase a short domain and put a message within 45 characters as their first name.\u003cbr\u003e\nOnce they have done that they can start adding and/or replacing emails a bunch of times to send mass emails and these emails will be coming from \u003ccode\u003esupport@uber.com\u003c/code\u003e\u003c/p\u003e\n\n\u003cp\u003eOnce the person receiving the emails clicks on the link, they will be redirected to some malicious website.\u003c/p\u003e\n\n\u003cp\u003eVideo: \u003ca title=\"https://www.dropbox.com/s/84e7oftmcdmb4sw/emailhyperlink.mov?dl=0\" href=\"/redirect?url=https%3A%2F%2Fwww.dropbox.com%2Fs%2F84e7oftmcdmb4sw%2Femailhyperlink.mov%3Fdl%3D0\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.dropbox.com/s/84e7oftmcdmb4sw/emailhyperlink.mov?dl=0\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003ePossible Fix:\u003cbr\u003e\nDo not allow links to be set as the riders names.\u003cbr\u003e\nDo not allow special characters (. , / \\ etc.)\u003c/p\u003e\n","weakness":{"id":57,"name":"Violation of Secure Design Principles"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2016-05-12T07:11:02.272Z","allow_singular_disclosure_after":-146178599.7450576,"singular_disclosure_allowed":true,"vote_count":2,"voters":["beezlewaxin","dyabla"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":838131,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Here are some screenshots of the emails","markdown_message":"\u003cp\u003eHere are some screenshots of the emails\u003c/p\u003e\n","automated_response":false,"created_at":"2016-03-14T09:09:23.366Z","updated_at":"2016-03-14T09:09:23.366Z","actor":{"username":"rohk","cleared":true,"url":"/rohk","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/041/719/1c7576ebac110bb0402894581907c289e6c9263a_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":78658,"filename":"Screen_Shot_2016-03-14_at_2.08.27_AM.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/078/658/0bdda57122ed30bb4326caec0c840a10c81ecf6b/Screen_Shot_2016-03-14_at_2.08.27_AM.png?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2016-03-14_at_2.08.27_AM.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2016-03-14_at_2.08.27_AM.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ6J7UOFHP%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T042102Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDamJ7YR2N3cIBOa8zjuSmUd9OCX8zCykCDx%2B6kH2J%2BlQIhAPFk51DuoGb47ygm%2F46VUWXIRiNzzPuAJCxpuNY6C9r8KrQDCFIQARoMMDEzNjE5Mjc0ODQ5IgwfJ9Wm2OgZB0TD5wEqkQMAyHxawucw3AMqEaVZmpdf%2FWoK6P8gu%2FCj%2FoC7vu86houcl7d5S1aesU3sbrOzgm6RSEhwz%2FFS3jL7D6T4JI4Ce1ND%2FrgO0lyXrQzDIcV61dzQW3FvNLr0ZImyyUdtac%2BXOj%2B4Yuxg3B%2Fw8%2FASrjXwhjBS66Kymk3L6dUfBdgwlGyaWjSrEj7pUe4QmHItRfpiYrIugF6V0YbiwTzCRnupZGkhFUvdnKltp%2B4hMIJ8ZpZXjRaPMFGYbJODmmGmpbXrkLNmtpD9ssAfsLLmMNbkAbfGTVhz1jb8jNtS70QChWZUcaVF%2BUJ%2BnjyviI%2BzOI3PvJo6%2BFF7nuwLNAutvngzDIQqSSVMoO%2F3MB45%2Bi7mOnnapSDDsV974XkQgCuM7vsb5p2hLCxzrxps5NEHGajQr5tkHe3qivszLUiVfsV43w8FYD%2BBONxEK7W9P8Fz8NZ67SyH7GG2ksQHMqmv0OcEaprPoRqnV3X2FUQMilKfrm8Mwo6y2b3BolwJdahB%2FiN%2B4DEDiSex%2FihlgZtj7Y4SxDDk%2FKn%2FBTrqAf559VpL8gNLdFBoVG3N%2FZOK1jnsPcfoIUSZtPAKUZCx%2FfYM8b4F5pg%2FUgEn1Lv%2B2LBdmNBasw6RmzajA5OSfdAMndyjJN9XxpB%2BQCxuWhR%2B4l3UYvcHCs0ptmeXrxe03i6oCQg6cNND1wBmViOKSrRB7ycvKEbOUFZtkHoRDVaID3Z%2BuOzyOMaLFXSvzsVsAcCFgFhIk5QJcY%2B1scZVna72pH8jnKw%2FwC1cIv1j%2FAmz0zBabFT7deSC5tUMl0pZQVYKiEGsgryYN9fSfaoMv2wR80e4kst1hVdlJHDktel9plUkLBliVB9%2BDQ%3D%3D\u0026X-Amz-Signature=0ed33904e9405996c1f4a75ae230017def9b29e206af76d97de02d1e5dafa1ac"},{"id":78657,"filename":"Screen_Shot_2016-03-14_at_2.08.53_AM.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/078/657/7534a72676470a50a67ab92561ac518fc1ce387e/Screen_Shot_2016-03-14_at_2.08.53_AM.png?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2016-03-14_at_2.08.53_AM.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2016-03-14_at_2.08.53_AM.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ6J7UOFHP%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T042102Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDamJ7YR2N3cIBOa8zjuSmUd9OCX8zCykCDx%2B6kH2J%2BlQIhAPFk51DuoGb47ygm%2F46VUWXIRiNzzPuAJCxpuNY6C9r8KrQDCFIQARoMMDEzNjE5Mjc0ODQ5IgwfJ9Wm2OgZB0TD5wEqkQMAyHxawucw3AMqEaVZmpdf%2FWoK6P8gu%2FCj%2FoC7vu86houcl7d5S1aesU3sbrOzgm6RSEhwz%2FFS3jL7D6T4JI4Ce1ND%2FrgO0lyXrQzDIcV61dzQW3FvNLr0ZImyyUdtac%2BXOj%2B4Yuxg3B%2Fw8%2FASrjXwhjBS66Kymk3L6dUfBdgwlGyaWjSrEj7pUe4QmHItRfpiYrIugF6V0YbiwTzCRnupZGkhFUvdnKltp%2B4hMIJ8ZpZXjRaPMFGYbJODmmGmpbXrkLNmtpD9ssAfsLLmMNbkAbfGTVhz1jb8jNtS70QChWZUcaVF%2BUJ%2BnjyviI%2BzOI3PvJo6%2BFF7nuwLNAutvngzDIQqSSVMoO%2F3MB45%2Bi7mOnnapSDDsV974XkQgCuM7vsb5p2hLCxzrxps5NEHGajQr5tkHe3qivszLUiVfsV43w8FYD%2BBONxEK7W9P8Fz8NZ67SyH7GG2ksQHMqmv0OcEaprPoRqnV3X2FUQMilKfrm8Mwo6y2b3BolwJdahB%2FiN%2B4DEDiSex%2FihlgZtj7Y4SxDDk%2FKn%2FBTrqAf559VpL8gNLdFBoVG3N%2FZOK1jnsPcfoIUSZtPAKUZCx%2FfYM8b4F5pg%2FUgEn1Lv%2B2LBdmNBasw6RmzajA5OSfdAMndyjJN9XxpB%2BQCxuWhR%2B4l3UYvcHCs0ptmeXrxe03i6oCQg6cNND1wBmViOKSrRB7ycvKEbOUFZtkHoRDVaID3Z%2BuOzyOMaLFXSvzsVsAcCFgFhIk5QJcY%2B1scZVna72pH8jnKw%2FwC1cIv1j%2FAmz0zBabFT7deSC5tUMl0pZQVYKiEGsgryYN9fSfaoMv2wR80e4kst1hVdlJHDktel9plUkLBliVB9%2BDQ%3D%3D\u0026X-Amz-Signature=f654e17724458d72ed025f835c23125699bc7f7a36b18d84c6a7c45706d57850"}],"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":839824,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Video Update: https://drive.google.com/file/d/0B1sebj6Vi6SKY1ZlaFRoU0UxeDg/view?usp=sharing","markdown_message":"\u003cp\u003eVideo Update: \u003ca title=\"https://drive.google.com/file/d/0B1sebj6Vi6SKY1ZlaFRoU0UxeDg/view?usp=sharing\" href=\"/redirect?url=https%3A%2F%2Fdrive.google.com%2Ffile%2Fd%2F0B1sebj6Vi6SKY1ZlaFRoU0UxeDg%2Fview%3Fusp%3Dsharing\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://drive.google.com/file/d/0B1sebj6Vi6SKY1ZlaFRoU0UxeDg/view?usp=sharing\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2016-03-15T02:01:15.426Z","updated_at":"2016-03-15T02:01:15.426Z","actor":{"username":"rohk","cleared":true,"url":"/rohk","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/041/719/1c7576ebac110bb0402894581907c289e6c9263a_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":846430,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"Hey @rohk, thanks for the report. It appears that this issue is with Gmail doing the actual \"linkifying\" of the content. Our username validation is already fairly strong (many people will have periods in their names, for example so we allow that). Due to the low impact of this issue (requires social engineering) and the fact that we don't do the \"linkifying\" I'm going to close this as `Informative`. Let me know if you have any issues with that/further impact you'd like to state.","markdown_message":"\u003cp\u003eHey \u003ca href=\"/rohk\"\u003e@rohk\u003c/a\u003e, thanks for the report. It appears that this issue is with Gmail doing the actual \u0026quot;linkifying\u0026quot; of the content. Our username validation is already fairly strong (many people will have periods in their names, for example so we allow that). Due to the low impact of this issue (requires social engineering) and the fact that we don\u0026#39;t do the \u0026quot;linkifying\u0026quot; I\u0026#39;m going to close this as \u003ccode\u003eInformative\u003c/code\u003e. Let me know if you have any issues with that/further impact you\u0026#39;d like to state.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-03-17T17:46:06.168Z","updated_at":"2016-03-17T17:46:06.168Z","actor":{"username":"mandatoryuber","cleared":false,"url":"/mandatoryuber","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/040/287/fe7ca43da855a13d789192535962231dc7bee6ec_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":846463,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for the update! ","markdown_message":"\u003cp\u003eThanks for the update! \u003c/p\u003e\n","automated_response":false,"created_at":"2016-03-17T17:59:04.970Z","updated_at":"2016-03-17T17:59:04.970Z","actor":{"username":"rohk","cleared":true,"url":"/rohk","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/041/719/1c7576ebac110bb0402894581907c289e6c9263a_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":900872,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"@mandatoryuber would like to publicly disclose this to use as an example of the type of responses can make a huge difference between hackers and companies :)\n\nThanks!","markdown_message":"\u003cp\u003e\u003ca href=\"/mandatoryuber\"\u003e@mandatoryuber\u003c/a\u003e would like to publicly disclose this to use as an example of the type of responses can make a huge difference between hackers and companies :)\u003c/p\u003e\n\n\u003cp\u003eThanks!\u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-12T07:11:01.798Z","updated_at":"2016-04-12T07:11:01.798Z","first_to_agree":true,"actor":{"username":"rohk","cleared":true,"url":"/rohk","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/041/719/1c7576ebac110bb0402894581907c289e6c9263a_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1012024,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Hey @rohk, totally down to disclose this - sorry for the delay!","markdown_message":"\u003cp\u003eHey \u003ca href=\"/rohk\"\u003e@rohk\u003c/a\u003e, totally down to disclose this - sorry for the delay!\u003c/p\u003e\n","automated_response":false,"created_at":"2016-06-13T21:55:40.891Z","updated_at":"2016-06-13T21:55:40.891Z","actor":{"username":"mandatoryuber","cleared":false,"url":"/mandatoryuber","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/040/287/fe7ca43da855a13d789192535962231dc7bee6ec_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1012025,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-06-13T21:55:40.959Z","updated_at":"2016-06-13T21:55:40.959Z","actor":{"username":"mandatoryuber","cleared":false,"url":"/mandatoryuber","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/040/287/fe7ca43da855a13d789192535962231dc7bee6ec_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"id":2054,"category":"researcher","content":"Blog post: http://www.rohk.xyz/hackers-and-companies-responses/\n\nThe type of responses companies give to researchers is crucial to developing relationships. Check out the blog post I wrote which talks about the importance of proper responses.","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eBlog post: \u003ca title=\"http://www.rohk.xyz/hackers-and-companies-responses/\" href=\"/redirect?url=http%3A%2F%2Fwww.rohk.xyz%2Fhackers-and-companies-responses%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://www.rohk.xyz/hackers-and-companies-responses/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eThe type of responses companies give to researchers is crucial to developing relationships. Check out the blog post I wrote which talks about the importance of proper responses.\u003c/p\u003e\n"}]}