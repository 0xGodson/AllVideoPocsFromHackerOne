{"id":173268,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNzMyNjg=","url":"https://hackerone.com/reports/173268","title":"Login credentials transmitted in cleartext on index.rubygems.org","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-09-30T23:42:29.158Z","submitted_at":"2016-09-30T23:42:29.158Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"eterm","url":"/eterm","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":8212,"url":"https://hackerone.com/rubygems","handle":"rubygems","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/008/212/e65eca09896d23bc029c08d3147a79a48ec1ee2f_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/212/e65eca09896d23bc029c08d3147a79a48ec1ee2f_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"RubyGems","twitter_handle":"rubygems_status","website":"https://rubygems.org","about":"RubyGems.org is the Ruby community’s gem hosting service."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2016-10-17T11:58:37.037Z","bug_reporter_agreed_on_going_public_at":"2016-10-05T19:40:52.106Z","team_member_agreed_on_going_public_at":"2016-10-17T11:58:36.987Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"If someone links their target to http://index.rubygems.org then if they click \"sign in\" their credentials are transmitted plaintext as there is no https redirect or enforcing of https on the login form.\n\nStep 1: Link to http://index.rubuygems.org \nStep 2: sniff traffic (open wifi / proxy / etc)\n\nSee the following parameters POST to the session endpoint. The user is confronted with an error since the session cookie is marked secure so they can't continue to logged in resources. But the attacker already has their username and password:\n\nRequest captured.\n```\nPOST /session HTTP/1.1\nHost: index.rubygems.org\nUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:49.0) Gecko/20100101 Firefox/49.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nReferer: http://index.rubygems.org/sign_in\nCookie: _gauges_unique_hour=1; _gauges_unique_day=1; _gauges_unique_month=1; _gauges_unique_year=1; _gauges_unique=1; _ga=GA1.2.406017651.1475277378\nDNT: 1\nConnection: keep-alive\nUpgrade-Insecure-Requests: 1\nPragma: no-cache\nCache-Control: no-cache\n```\n\nPost Data Captured:\n```\nutf8=✓\nauthenticity_token=9dML75aXwXcw4rqJlOeKDK2/SdRK78+5ciMEtrMbDgEf160r9v1TX0/pXynzDC+pYSp5M1oGLsmtvkixo+MfdA==\nsession[who]=Eterm1\nsession[password]=5[redacted]W\ncommit=Sign+in\n```\n\nFurthermore, _rubygems_session cookie is transmitted over http. It has a \"secure\" flag which stops the client resubmitting over http, but an attacker can see it clear in the response headers.","vulnerability_information_html":"\u003cp\u003eIf someone links their target to \u003ca title=\"http://index.rubygems.org\" href=\"/redirect?url=http%3A%2F%2Findex.rubygems.org\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://index.rubygems.org\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e then if they click \u0026quot;sign in\u0026quot; their credentials are transmitted plaintext as there is no https redirect or enforcing of https on the login form.\u003c/p\u003e\n\n\u003cp\u003eStep 1: Link to \u003ca title=\"http://index.rubuygems.org\" href=\"/redirect?url=http%3A%2F%2Findex.rubuygems.org\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://index.rubuygems.org\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e \u003cbr\u003e\nStep 2: sniff traffic (open wifi / proxy / etc)\u003c/p\u003e\n\n\u003cp\u003eSee the following parameters POST to the session endpoint. The user is confronted with an error since the session cookie is marked secure so they can\u0026#39;t continue to logged in resources. But the attacker already has their username and password:\u003c/p\u003e\n\n\u003cp\u003eRequest captured.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ePOST /session HTTP/1.1\nHost: index.rubygems.org\nUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:49.0) Gecko/20100101 Firefox/49.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nReferer: http://index.rubygems.org/sign_in\nCookie: _gauges_unique_hour=1; _gauges_unique_day=1; _gauges_unique_month=1; _gauges_unique_year=1; _gauges_unique=1; _ga=GA1.2.406017651.1475277378\nDNT: 1\nConnection: keep-alive\nUpgrade-Insecure-Requests: 1\nPragma: no-cache\nCache-Control: no-cache\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003ePost Data Captured:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eutf8=✓\nauthenticity_token=9dML75aXwXcw4rqJlOeKDK2/SdRK78+5ciMEtrMbDgEf160r9v1TX0/pXynzDC+pYSp5M1oGLsmtvkixo+MfdA==\nsession[who]=Eterm1\nsession[password]=5[redacted]W\ncommit=Sign+in\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eFurthermore, _rubygems_session cookie is transmitted over http. It has a \u0026quot;secure\u0026quot; flag which stops the client resubmitting over http, but an attacker can see it clear in the response headers.\u003c/p\u003e\n","weakness":{"id":57,"name":"Violation of Secure Design Principles"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2016-11-04T19:40:52.148Z","allow_singular_disclosure_after":-130928462.33827418,"singular_disclosure_allowed":true,"vote_count":2,"voters":["spetr0x","nanaoaries"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1226969,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for submitting this report to RubyGems. Our team will review and investigate the issue. Please note that only issues in the rubygems library are eligible for our bug bounty program.","markdown_message":"\u003cp\u003eThanks for submitting this report to RubyGems. Our team will review and investigate the issue. Please note that only issues in the rubygems library are eligible for our bug bounty program.\u003c/p\u003e\n","automated_response":true,"created_at":"2016-09-30T23:42:29.518Z","updated_at":"2016-09-30T23:42:29.518Z","actor":{"url":"/rubygems","ibb":true,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/212/e65eca09896d23bc029c08d3147a79a48ec1ee2f_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"RubyGems"}},"genius_execution_id":null,"team_handle":"rubygems","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1228461,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"While that domain is not intended to be used in the browser, and it's hard to stop people from submitting credentials in bad places, we have fixed the https redirect so anyone who visits that domain should be redirected to https version. Thanks!","markdown_message":"\u003cp\u003eWhile that domain is not intended to be used in the browser, and it\u0026#39;s hard to stop people from submitting credentials in bad places, we have fixed the https redirect so anyone who visits that domain should be redirected to https version. Thanks!\u003c/p\u003e\n","automated_response":false,"created_at":"2016-10-03T01:19:10.043Z","updated_at":"2016-10-03T01:19:10.043Z","actor":{"username":"dwradcliffe","cleared":false,"url":"/dwradcliffe","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/082/355/821154e381fe27d2273bc54a18049a3a87e1591d_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"eterm","url":"/eterm"},"genius_execution_id":null,"team_handle":"rubygems","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1228462,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"Only issues within the rubygems client library are eligible for a bounty.","markdown_message":"\u003cp\u003eOnly issues within the rubygems client library are eligible for a bounty.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-10-03T01:19:48.619Z","updated_at":"2016-10-03T01:19:48.619Z","actor":{"url":"/rubygems","ibb":true,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/212/e65eca09896d23bc029c08d3147a79a48ec1ee2f_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"RubyGems"}},"genius_execution_id":null,"team_handle":"rubygems","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1234000,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you for dealing with this issue quickly, I have checked now and the redirect is in place as described. Are you happy for me to move to request public disclosure?","markdown_message":"\u003cp\u003eThank you for dealing with this issue quickly, I have checked now and the redirect is in place as described. Are you happy for me to move to request public disclosure?\u003c/p\u003e\n","automated_response":false,"created_at":"2016-10-05T19:20:14.286Z","updated_at":"2016-10-05T19:20:14.286Z","actor":{"username":"eterm","cleared":false,"url":"/eterm","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rubygems","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1234026,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Sure","markdown_message":"\u003cp\u003eSure\u003c/p\u003e\n","automated_response":false,"created_at":"2016-10-05T19:29:10.129Z","updated_at":"2016-10-05T19:29:10.129Z","actor":{"username":"dwradcliffe","cleared":false,"url":"/dwradcliffe","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/082/355/821154e381fe27d2273bc54a18049a3a87e1591d_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rubygems","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1234044,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-10-05T19:40:52.126Z","updated_at":"2016-10-05T19:40:52.126Z","first_to_agree":true,"actor":{"username":"eterm","cleared":false,"url":"/eterm","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rubygems","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1250639,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-10-17T11:58:37.009Z","updated_at":"2016-10-17T11:58:37.009Z","actor":{"username":"dwradcliffe","cleared":false,"url":"/dwradcliffe","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/082/355/821154e381fe27d2273bc54a18049a3a87e1591d_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rubygems","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1250640,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-10-17T11:58:37.056Z","updated_at":"2016-10-17T11:58:37.056Z","actor":{"username":"dwradcliffe","cleared":false,"url":"/dwradcliffe","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/082/355/821154e381fe27d2273bc54a18049a3a87e1591d_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rubygems","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}