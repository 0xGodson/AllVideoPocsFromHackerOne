{"id":159399,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNTkzOTk=","url":"https://hackerone.com/reports/159399","title":"Unauthorized read access to Invoices by PM (Access control Issues)","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-08-15T02:45:15.238Z","submitted_at":"2016-08-15T02:45:15.238Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"indoappsec","url":"/indoappsec","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/QUAjqUf576QNBhxg691WB8YG/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":237,"url":"https://hackerone.com/harvest","handle":"harvest","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/237/ce650f9fba222040127528a7c95dab237f8a9734_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/237/ce650f9fba222040127528a7c95dab237f8a9734_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Harvest","twitter_handle":"","website":"http://getharvest.com","about":"Harvest is a leader in online time tracking and invoicing. Work better, and make smarter decisions for your business."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2016-09-29T23:03:56.508Z","bug_reporter_agreed_on_going_public_at":"2016-08-30T23:03:43.277Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi Team,\n\nDescription : Project Manager have access to limited projects and corresponding Invoices. But he can view any private Invoices of the company which he doesn't have access to. Sending Invoice Request is Vulnerable to Indirect Object Reference Attack. Any Unprivileged Project manager can send this request to get Invoices over mail and view all the attachments and details to the Invoice.\n\nSteps to reproduce : \n1.Create a Account with Admin and Add a project manager with Full access. Assign him Some project. Add some more projects and invoices but don't assign these to the project manager. \n2.Now login from Project manager's account you will see that you won't have access to all the invoices . You can only create the invoices based on your assigned projects. \n3.Open a Invoice and you will see Send/Resend Invoice Option by which you can send this Invoice to Any user . Also you can Click on the option of send a copy to my mail option here which will send you the copy of that invoice. \n4.Now Intercept the Send request and it will look something like : \n\nPOST /invoices/[Invoice_ID]/messages HTTP/1.1\nHost: vijaygangani.harvestapp.com\nUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:47.0) Gecko/20100101 Firefox/47.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate, br\nReferer: https://vijaygangani.harvestapp.com/invoices/10392603\nCookie: [Cookie_Values]\nConnection: keep-alive\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 772\n\nPost_paramenters \n\n5.Now change the Invoice ID to any invoice ID of your company And the Invoice Copy will be sent your email with Attachments and PDF of it. \n\n\n\nLet me know if you need any video Poc or Detailed steps to reproduce.\n\n\nBest Regards !\nVijay Kumar \n","vulnerability_information_html":"\u003cp\u003eHi Team,\u003c/p\u003e\n\n\u003cp\u003eDescription : Project Manager have access to limited projects and corresponding Invoices. But he can view any private Invoices of the company which he doesn\u0026#39;t have access to. Sending Invoice Request is Vulnerable to Indirect Object Reference Attack. Any Unprivileged Project manager can send this request to get Invoices over mail and view all the attachments and details to the Invoice.\u003c/p\u003e\n\n\u003cp\u003eSteps to reproduce : \u003cbr\u003e\n1.Create a Account with Admin and Add a project manager with Full access. Assign him Some project. Add some more projects and invoices but don\u0026#39;t assign these to the project manager. \u003cbr\u003e\n2.Now login from Project manager\u0026#39;s account you will see that you won\u0026#39;t have access to all the invoices . You can only create the invoices based on your assigned projects. \u003cbr\u003e\n3.Open a Invoice and you will see Send/Resend Invoice Option by which you can send this Invoice to Any user . Also you can Click on the option of send a copy to my mail option here which will send you the copy of that invoice. \u003cbr\u003e\n4.Now Intercept the Send request and it will look something like : \u003c/p\u003e\n\n\u003cp\u003ePOST /invoices/[Invoice_ID]/messages HTTP/1.1\u003cbr\u003e\nHost: vijaygangani.harvestapp.com\u003cbr\u003e\nUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:47.0) Gecko/20100101 Firefox/47.0\u003cbr\u003e\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,\u003cem\u003e/\u003c/em\u003e;q=0.8\u003cbr\u003e\nAccept-Language: en-US,en;q=0.5\u003cbr\u003e\nAccept-Encoding: gzip, deflate, br\u003cbr\u003e\nReferer: \u003ca title=\"https://vijaygangani.harvestapp.com/invoices/10392603\" href=\"/redirect?url=https%3A%2F%2Fvijaygangani.harvestapp.com%2Finvoices%2F10392603\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://vijaygangani.harvestapp.com/invoices/10392603\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nCookie: [Cookie_Values]\u003cbr\u003e\nConnection: keep-alive\u003cbr\u003e\nContent-Type: application/x-www-form-urlencoded\u003cbr\u003e\nContent-Length: 772\u003c/p\u003e\n\n\u003cp\u003ePost_paramenters \u003c/p\u003e\n\n\u003cp\u003e5.Now change the Invoice ID to any invoice ID of your company And the Invoice Copy will be sent your email with Attachments and PDF of it. \u003c/p\u003e\n\n\u003cp\u003eLet me know if you need any video Poc or Detailed steps to reproduce.\u003c/p\u003e\n\n\u003cp\u003eBest Regards !\u003cbr\u003e\nVijay Kumar \u003c/p\u003e\n","bounty_amount":"150.0","formatted_bounty":"$150","weakness":{"id":27,"name":"Improper Authentication - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2016-09-29T23:03:43.343Z","allow_singular_disclosure_after":-134026360.78488776,"singular_disclosure_allowed":true,"vote_count":13,"voters":["thisishrsh","dmatrix","dilawer01","madrobot","vijay_kumar","jens","mr_sharma_","gopi","jbbbkj","sumit7","and 3 more..."],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1149163,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hi again,\n\nWe also confirmed this one! We will contact you as soon as it is fixed.\nThanks a lot!\n\nJorge","markdown_message":"\u003cp\u003eHi again,\u003c/p\u003e\n\n\u003cp\u003eWe also confirmed this one! We will contact you as soon as it is fixed.\u003cbr\u003e\nThanks a lot!\u003c/p\u003e\n\n\u003cp\u003eJorge\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-23T13:44:43.484Z","updated_at":"2016-08-23T13:44:43.484Z","actor":{"username":"jorgeleria","cleared":false,"url":"/jorgeleria","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/680/84ed9b9afaf2905ae339b479cf97d7161fd1ae64_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"harvest","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1159985,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hi again :)\nAnother fixed report. \nCould you check if you can reproduce this one? \n\nJorge","markdown_message":"\u003cp\u003eHi again :)\u003cbr\u003e\nAnother fixed report. \u003cbr\u003e\nCould you check if you can reproduce this one? \u003c/p\u003e\n\n\u003cp\u003eJorge\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-29T15:29:17.821Z","updated_at":"2016-08-29T15:29:17.821Z","actor":{"username":"jorgeleria","cleared":false,"url":"/jorgeleria","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/680/84ed9b9afaf2905ae339b479cf97d7161fd1ae64_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"indoappsec","url":"/indoappsec"},"genius_execution_id":null,"team_handle":"harvest","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1162659,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks for helping make Harvest more secure!","markdown_message":"\u003cp\u003eThanks for helping make Harvest more secure!\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-30T16:47:37.795Z","updated_at":"2016-08-30T16:47:37.795Z","actor":{"url":"/harvest","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/237/ce650f9fba222040127528a7c95dab237f8a9734_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Harvest"}},"bounty_amount":"150.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"harvest","collaborator":{"username":"indoappsec","url":"/indoappsec"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1163627,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-08-30T23:03:43.312Z","updated_at":"2016-08-30T23:03:43.312Z","first_to_agree":true,"actor":{"username":"indoappsec","cleared":true,"url":"/indoappsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/QUAjqUf576QNBhxg691WB8YG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"harvest","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1223865,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2016-09-29T15:58:10.092Z","updated_at":"2016-09-29T15:58:10.092Z","additional_data":{"old_title":"Unauthorized Read access to Private Invoices by Project Manager(Access control Issues)","new_title":"Unauthorized read access to Invoices by PM (Access control Issues)"},"actor":{"username":"jorgeleria","cleared":false,"url":"/jorgeleria","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/680/84ed9b9afaf2905ae339b479cf97d7161fd1ae64_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"harvest","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1224820,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-09-29T23:03:56.536Z","updated_at":"2016-09-29T23:03:56.536Z","actor":{"url":"/harvest","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/237/ce650f9fba222040127528a7c95dab237f8a9734_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Harvest"}},"genius_execution_id":null,"team_handle":"harvest","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}