{"id":283821,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yODM4MjE=","url":"https://hackerone.com/reports/283821","title":"XSS when Shared","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2017-10-28T19:34:41.914Z","submitted_at":"2017-10-28T19:34:41.914Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"haystack_needle","url":"/haystack_needle","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/196/164/0980e9f391e5a3af9071d16244e802b7cd5a3d80_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":21745,"url":"https://hackerone.com/infogram","handle":"infogram","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/021/745/553edf21f45ba8f73faba5d308e0d91fc026fef0_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/021/745/553edf21f45ba8f73faba5d308e0d91fc026fef0_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Infogram","twitter_handle":"infogram","website":"http://infogram.com","about":"Make Infographics and Charts that People Love"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-11-01T09:58:30.767Z","bug_reporter_agreed_on_going_public_at":"2017-10-31T17:53:34.819Z","team_member_agreed_on_going_public_at":"2017-11-01T09:58:30.590Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"## Introduction\nXSS on an embedded piece of code that, when shared, may make it seem as if it was infogram.com that was doing the malicious act.\n\n## Proof of Concept\n1. Create an account\n2. Create a project titled \"script\u003ealert(1);\u003c/script\u003e\"\n3. Click on share \n\nHere's an example of the share embedded code:\n```\n\u003cdiv class=\"infogram-embed\" data-id=\"d08ad077-3490-4241-b9a9-057da53e2e7d\" data-type=\"interactive\" data-title=\"\u003cscript\u003ealert(1);\u003c/script\u003e\"\u003e\u003c/div\u003e\u003cscript\u003e!function(e,t,s,i){var n=\"InfogramEmbeds\",o=e.getElementsByTagName(\"script\"),d=o[0],r=/^http:/.test(e.location)?\"http:\":\"https:\";if(/^\\/{2}/.test(i)\u0026\u0026(i=r+i),window[n]\u0026\u0026window[n].initialized)window[n].process\u0026\u0026window[n].process();else if(!e.getElementById(s)){var a=e.createElement(\"script\");a.async=1,a.id=s,a.src=i,d.parentNode.insertBefore(a,d)}}(document,0,\"infogram-async\",\"https://e.infogram.com/js/dist/embed-loader-min.js\");\u003c/script\u003e\u003cdiv style=\"padding:8px 0;font-family:Arial!important;font-size:13px!important;line-height:15px!important;text-align:center;border-top:1px solid #dadada;margin:0 30px\"\u003e\u003ca href=\"https://infogram.com/d08ad077-3490-4241-b9a9-057da53e2e7d\" style=\"color:#989898!important;text-decoration:none!important;\" target=\"_blank\"\u003e\u003cscript\u003ealert(1);\u003c/script\u003e\u003c/a\u003e\u003cbr\u003e\u003ca href=\"https://infogram.com\" style=\"color:#989898!important;text-decoration:none!important;\" target=\"_blank\" rel=\"nofollow\"\u003eInfogram\u003c/a\u003e\u003c/div\u003e\n```\n\n## Potential Fixes\n* Display the project title so the web surfer knows it's not actually infogram.com that is that's doing the malicious act\n* Prevent the project name to be created in the first place. \n\n\n## Consequences:\nAn XSS like this is likely to **tarnish the trust between the Infogram.com brand and its customers**. A hacker can make an html page of just solely this embeded piece of HTML code. When a customer or user clicks on a link that would redirect the user to the embedded infogram.com page, it would seem as though infogram.com is not trustable by the user. Therefore, the brand gets less trusted over time. This is just one of many malicious acts a hacker can do.","vulnerability_information_html":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\n\u003cp\u003eXSS on an embedded piece of code that, when shared, may make it seem as if it was infogram.com that was doing the malicious act.\u003c/p\u003e\n\n\u003ch2 id=\"proof-of-concept\"\u003eProof of Concept\u003c/h2\u003e\n\n\u003col\u003e\n\u003cli\u003eCreate an account\u003c/li\u003e\n\u003cli\u003eCreate a project titled \u0026quot;script\u0026gt;alert(1);\u0026lt;/script\u0026gt;\u0026quot;\u003c/li\u003e\n\u003cli\u003eClick on share \u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eHere\u0026#39;s an example of the share embedded code:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e\u0026lt;div class=\u0026quot;infogram-embed\u0026quot; data-id=\u0026quot;d08ad077-3490-4241-b9a9-057da53e2e7d\u0026quot; data-type=\u0026quot;interactive\u0026quot; data-title=\u0026quot;\u0026lt;script\u0026gt;alert(1);\u0026lt;/script\u0026gt;\u0026quot;\u0026gt;\u0026lt;/div\u0026gt;\u0026lt;script\u0026gt;!function(e,t,s,i){var n=\u0026quot;InfogramEmbeds\u0026quot;,o=e.getElementsByTagName(\u0026quot;script\u0026quot;),d=o[0],r=/^http:/.test(e.location)?\u0026quot;http:\u0026quot;:\u0026quot;https:\u0026quot;;if(/^\\/{2}/.test(i)\u0026amp;\u0026amp;(i=r+i),window[n]\u0026amp;\u0026amp;window[n].initialized)window[n].process\u0026amp;\u0026amp;window[n].process();else if(!e.getElementById(s)){var a=e.createElement(\u0026quot;script\u0026quot;);a.async=1,a.id=s,a.src=i,d.parentNode.insertBefore(a,d)}}(document,0,\u0026quot;infogram-async\u0026quot;,\u0026quot;https://e.infogram.com/js/dist/embed-loader-min.js\u0026quot;);\u0026lt;/script\u0026gt;\u0026lt;div style=\u0026quot;padding:8px 0;font-family:Arial!important;font-size:13px!important;line-height:15px!important;text-align:center;border-top:1px solid #dadada;margin:0 30px\u0026quot;\u0026gt;\u0026lt;a href=\u0026quot;https://infogram.com/d08ad077-3490-4241-b9a9-057da53e2e7d\u0026quot; style=\u0026quot;color:#989898!important;text-decoration:none!important;\u0026quot; target=\u0026quot;_blank\u0026quot;\u0026gt;\u0026lt;script\u0026gt;alert(1);\u0026lt;/script\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;br\u0026gt;\u0026lt;a href=\u0026quot;https://infogram.com\u0026quot; style=\u0026quot;color:#989898!important;text-decoration:none!important;\u0026quot; target=\u0026quot;_blank\u0026quot; rel=\u0026quot;nofollow\u0026quot;\u0026gt;Infogram\u0026lt;/a\u0026gt;\u0026lt;/div\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2 id=\"potential-fixes\"\u003ePotential Fixes\u003c/h2\u003e\n\n\u003cul\u003e\n\u003cli\u003eDisplay the project title so the web surfer knows it\u0026#39;s not actually infogram.com that is that\u0026#39;s doing the malicious act\u003c/li\u003e\n\u003cli\u003ePrevent the project name to be created in the first place. \u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch2 id=\"consequences\"\u003eConsequences:\u003c/h2\u003e\n\n\u003cp\u003eAn XSS like this is likely to \u003cstrong\u003etarnish the trust between the Infogram.com brand and its customers\u003c/strong\u003e. A hacker can make an html page of just solely this embeded piece of HTML code. When a customer or user clicks on a link that would redirect the user to the embedded infogram.com page, it would seem as though infogram.com is not trustable by the user. Therefore, the brand gets less trusted over time. This is just one of many malicious acts a hacker can do.\u003c/p\u003e\n","weakness":{"id":61,"name":"Cross-site Scripting (XSS) - Reflected"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":233765,"file_name":"infogram-test.html","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/233/765/ae1246d881090e8b2adb0bb2881f8b9447f7ec6c/infogram-test.html?response-content-disposition=attachment%3B%20filename%3D%22infogram-test.html%22%3B%20filename%2A%3DUTF-8%27%27infogram-test.html\u0026response-content-type=application%2Foctet-stream\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQTYNHLLAI%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T052327Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHZ%2BW3HUv1n%2B6aR51XKyQUoltUs4dpenL8C5Ngq%2FaRRRAiEAmfsKW6s44zslbtLbjio7lyByPFrM4HhkqWc4BlKqI%2FsqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDEk2ujSH9wgIeNJFfSqRA5L87pajd4uBiMOahwiQWY9MCcYfdnrcw1IGaRg5TpxW7DR87N3npEJ347tYQoNG4qvz83ZIfPJaoV16%2BHSbvgHCloy0L2IJebFkXavQ%2FqP76i9C%2Fflz0T%2FAY7BQexVBAB81BDbhmxnE9q9peEXcv7DxPs6yUKcdy540RKUrN7uslxSA7j3G9JiTuJ6qb2%2F4wYsuXqZAjjjsCgg1mXnpWD2MBpvjLmy20fnWfTyEpbZx69BhUOjIiXGUwMwyU3vIR8mTDDVd0lLxGqVwqo7wgDElekHdTEW3qhMPXMlt6DlI6yj8Gdba%2FBl9Vc01EccnsQcPWyVJry%2FS5ynL9DMtJAAAFirbxDGfh3YyQKCitVKKFFQ%2BXcUVp%2FSwwBBOTy19C2elhYtpl6vcpcY0%2FpxhMV%2FLT11lv%2FW2w21ED7vsm1c%2FDgyMyGhcc5jxtzWgSuplAxsWTwQc5B1WrLELk6MdDLXcvxB6lqSlYR3jek%2FEqa3e3t%2FxycmED7JcchnTpltDpgBiVe4qfO%2B85c9LeAT9plTAMKDqqv8FOusBsw37kCqQM4gZ7GwocFGWO%2Bb%2BbNa2dgEi%2Fv9cXsb1AOYUnwz%2B%2FyPyUSoTx0mdn2JtBFbkLI2hWmV1Y9Plg4ywi43mIKFY5BXMieUzgwCaeF0glcm8O%2F5kugCvuf01QuIauHjpwGSFMitZi1h52iDxD6TQNrXkM8ak7hW52tsH0VpvrBIvM3fFeRl4cr81y%2FuM3ueoyxszwreZZnbZK4WIuk8LU9YhohKDj6BRCCLOA1ZWZip14mKPOWPa8WaAzVovmI9BYDR0AxC4M%2FMywNMPj4r12n4DpTYCcHFvsA18GtoCtKML64R8uPhkQw%3D%3D\u0026X-Amz-Signature=6f41beeade0e39bbf0d6619a6959ba7f68b49a9fb4a57d387a98d1c977ab7563","file_size":1089,"type":"text/html"}],"allow_singular_disclosure_at":"2017-11-30T17:53:34.931Z","allow_singular_disclosure_after":-97154992.97334209,"singular_disclosure_allowed":true,"vote_count":6,"voters":["eveeez","r3y","zerotoone","jarmouz","b4155f7c29acd42c27d007a","haystack_needle"],"severity":{"rating":"medium","author_type":"User"},"structured_scope":{"databaseId":870,"asset_type":"URL","asset_identifier":"infogram.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":2117244,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks, it should be fixed now (but not in already published embeds, of course).\n\nBest regards,\nKaspars","markdown_message":"\u003cp\u003eThanks, it should be fixed now (but not in already published embeds, of course).\u003c/p\u003e\n\n\u003cp\u003eBest regards,\u003cbr\u003e\nKaspars\u003c/p\u003e\n","automated_response":false,"created_at":"2017-10-31T12:48:43.357Z","updated_at":"2017-10-31T12:48:43.357Z","actor":{"username":"kaspars","cleared":false,"url":"/kaspars","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"haystack_needle","url":"/haystack_needle"},"genius_execution_id":null,"team_handle":"infogram","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2118276,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Thanks! I'm glad to help!","markdown_message":"\u003cp\u003eThanks! I\u0026#39;m glad to help!\u003c/p\u003e\n","automated_response":false,"created_at":"2017-10-31T17:53:34.868Z","updated_at":"2017-10-31T17:53:34.868Z","first_to_agree":true,"actor":{"username":"haystack_needle","cleared":false,"url":"/haystack_needle","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/196/164/0980e9f391e5a3af9071d16244e802b7cd5a3d80_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"infogram","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2119850,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"May this be publicly disclosed?","markdown_message":"\u003cp\u003eMay this be publicly disclosed?\u003c/p\u003e\n","automated_response":false,"created_at":"2017-11-01T00:10:55.397Z","updated_at":"2017-11-01T00:10:55.397Z","actor":{"username":"haystack_needle","cleared":false,"url":"/haystack_needle","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/196/164/0980e9f391e5a3af9071d16244e802b7cd5a3d80_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"infogram","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2120400,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Yes, sure.","markdown_message":"\u003cp\u003eYes, sure.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-11-01T09:58:14.958Z","updated_at":"2017-11-01T09:58:14.958Z","actor":{"username":"kaspars","cleared":false,"url":"/kaspars","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"infogram","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2120401,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-11-01T09:58:30.662Z","updated_at":"2017-11-01T09:58:30.662Z","actor":{"username":"kaspars","cleared":false,"url":"/kaspars","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"infogram","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2120402,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-11-01T09:58:30.825Z","updated_at":"2017-11-01T09:58:30.825Z","actor":{"username":"kaspars","cleared":false,"url":"/kaspars","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"infogram","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}