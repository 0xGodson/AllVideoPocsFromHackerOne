{"id":425200,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC80MjUyMDA=","url":"https://hackerone.com/reports/425200","title":"XSS [flow] - on www.paypal.com/paypalme/my/landing (requires user interaction)","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2018-10-18T00:36:35.334Z","submitted_at":"2018-10-18T00:36:35.334Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"stefanofinding","url":"/stefanofinding","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/002/171/2558843b6d2b90f4dd826a661bcef3fd1abb2906_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1915,"url":"https://hackerone.com/paypal","handle":"paypal","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/E9WYrLcvXzomLyDprWfN7bq1/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/E9WYrLcvXzomLyDprWfN7bq1/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"PayPal","twitter_handle":"paypal","website":"http://paypal.com/","about":"Send Money, Pay Online or Set Up a Merchant Account - PayPal."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2018-11-06T16:40:59.057Z","bug_reporter_agreed_on_going_public_at":"2018-11-02T21:04:59.502Z","team_member_agreed_on_going_public_at":"2018-11-06T16:40:58.970Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"### Steps to reproduce\nOn _Chrome and Firefox_:\n1. Go to `https://www.paypal.com/paypalme/my/landing?flow=cmV0dXJuVXJsPWphdmFzY3JpcFQ6UEFZUEFMLmNvbSUzZDEsbG9jYXRpb24lM2QnamF2YXNjcmlwdDpceDNjc3ZnXHgyMG9ubG9hZD1hbGVydFx4Mjhkb2N1bWVudC5kb21haW5ceDI5XHgzZScmY2FuY2VsVXJsPWphdmFzY3JpcFQ6UEFZUEFMLmNvbSUzZDEsbG9jYXRpb24lM2QnamF2YXNjcmlwdDpceDNjc3ZnXHgyMG9ubG9hZD1hbGVydFx4Mjhkb2N1bWVudC5kb21haW5ceDI5XHgzZSc=`\n1. Click on the __X__ at the top right of the modal window\n\nOn _Safari_:\n1. Go to `https://www.paypal.com/paypalme/my/landing?flow=cmV0dXJuVXJsPWphdmFzY3JpcFQ6UEFZUEFMLmNvbSUzZDEsbG9jYXRpb24lM2QnamF2YXNjcmlwdDphbGVydFx4Mjhkb2N1bWVudC5kb21haW5ceDI5JyZjYW5jZWxVcmw9amF2YXNjcmlwVDpQQVlQQUwuY29tJTNkMSxsb2NhdGlvbiUzZCdqYXZhc2NyaXB0OmFsZXJ0XHgyOGRvY3VtZW50LmRvbWFpblx4Mjkn`\n1. Click on the __X__ at the top right of the modal window\n\n### Explanation\nThe value of the paramter `flow` is a base64 value which decoded looks like this:\n```\nreturnUrl={paypal_url}\u0026cancelUrl={paypal_url}\n```\n`cancelUrl` is passed as the `href` value of the __X__ button at the top right of the modal window that appears. It doesn't matter if you already created a paypal.me address.\n`returnUrl` is passed as the `href` value of the __Done__ button when you follow the instructions to create a paypal.me profile.\n\nThe problem is that `javascripT:paypal.com` is considered a valid value for `returnUrl` and `cancelUrl`. However, there a few restrictions already: you can't add a `%0a` character (or almost any special character, even using HTML encoding) and the URL has to start with `javascripT:*.paypal.com` or `javascripT:paypal.com` or `javascripT://paypal.com` or `javascripT://*.paypal.com`. \nFirst thing you have to take care of is about `paypal.com` because the object `paypal` doesn't exist, which will stop anything from working. The good thing is that `PAYPAL` does exist and `PAYPAL.com` is accepted as a valid value in the URL.\nThe second thing is that parentheses, quotes, semicolons and new lines are not allowed. But equal signs, commas and single quotes are allowed. So, you can set `PAYAPL.com` to any valid value you want like `PAYPAL.com=1`. Then you can use `location` and set it to something like `'javascript:alert\\x28\\x29'`. I encoded the invalid special characters in a encoding that Javascript understands and will decode before changing the `location`. Now you can put anything you want.\n\nOn Firefox and Chrome, the `location='javascript:alert\\x28\\x29'` writes `javascript:alert()` in the document, so I had to change it to make it work. Ended up with this: `location='javascript:\\x3csvg\\x20onload=alert\\x28document.domain\\x29\\x3e'`.\n\n## Impact\n\nYou could make actions as the authenticated user and probably more but I didn't tried.","vulnerability_information_html":"\u003ch3 id=\"steps-to-reproduce\"\u003eSteps to reproduce\u003c/h3\u003e\n\n\u003cp\u003eOn \u003cu\u003eChrome and Firefox\u003c/u\u003e:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eGo to \u003ccode\u003ehttps://www.paypal.com/paypalme/my/landing?flow=cmV0dXJuVXJsPWphdmFzY3JpcFQ6UEFZUEFMLmNvbSUzZDEsbG9jYXRpb24lM2QnamF2YXNjcmlwdDpceDNjc3ZnXHgyMG9ubG9hZD1hbGVydFx4Mjhkb2N1bWVudC5kb21haW5ceDI5XHgzZScmY2FuY2VsVXJsPWphdmFzY3JpcFQ6UEFZUEFMLmNvbSUzZDEsbG9jYXRpb24lM2QnamF2YXNjcmlwdDpceDNjc3ZnXHgyMG9ubG9hZD1hbGVydFx4Mjhkb2N1bWVudC5kb21haW5ceDI5XHgzZSc=\u003c/code\u003e\n\u003c/li\u003e\n\u003cli\u003eClick on the \u003cstrong\u003eX\u003c/strong\u003e at the top right of the modal window\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eOn \u003cu\u003eSafari\u003c/u\u003e:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eGo to \u003ccode\u003ehttps://www.paypal.com/paypalme/my/landing?flow=cmV0dXJuVXJsPWphdmFzY3JpcFQ6UEFZUEFMLmNvbSUzZDEsbG9jYXRpb24lM2QnamF2YXNjcmlwdDphbGVydFx4Mjhkb2N1bWVudC5kb21haW5ceDI5JyZjYW5jZWxVcmw9amF2YXNjcmlwVDpQQVlQQUwuY29tJTNkMSxsb2NhdGlvbiUzZCdqYXZhc2NyaXB0OmFsZXJ0XHgyOGRvY3VtZW50LmRvbWFpblx4Mjkn\u003c/code\u003e\n\u003c/li\u003e\n\u003cli\u003eClick on the \u003cstrong\u003eX\u003c/strong\u003e at the top right of the modal window\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003ch3 id=\"explanation\"\u003eExplanation\u003c/h3\u003e\n\n\u003cp\u003eThe value of the paramter \u003ccode\u003eflow\u003c/code\u003e is a base64 value which decoded looks like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ereturnUrl={paypal_url}\u0026amp;cancelUrl={paypal_url}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e\u003ccode\u003ecancelUrl\u003c/code\u003e is passed as the \u003ccode\u003ehref\u003c/code\u003e value of the \u003cstrong\u003eX\u003c/strong\u003e button at the top right of the modal window that appears. It doesn\u0026#39;t matter if you already created a paypal.me address.\u003cbr\u003e\n\u003ccode\u003ereturnUrl\u003c/code\u003e is passed as the \u003ccode\u003ehref\u003c/code\u003e value of the \u003cstrong\u003eDone\u003c/strong\u003e button when you follow the instructions to create a paypal.me profile.\u003c/p\u003e\n\n\u003cp\u003eThe problem is that \u003ccode\u003ejavascripT:paypal.com\u003c/code\u003e is considered a valid value for \u003ccode\u003ereturnUrl\u003c/code\u003e and \u003ccode\u003ecancelUrl\u003c/code\u003e. However, there a few restrictions already: you can\u0026#39;t add a \u003ccode\u003e%0a\u003c/code\u003e character (or almost any special character, even using HTML encoding) and the URL has to start with \u003ccode\u003ejavascripT:*.paypal.com\u003c/code\u003e or \u003ccode\u003ejavascripT:paypal.com\u003c/code\u003e or \u003ccode\u003ejavascripT://paypal.com\u003c/code\u003e or \u003ccode\u003ejavascripT://*.paypal.com\u003c/code\u003e. \u003cbr\u003e\nFirst thing you have to take care of is about \u003ccode\u003epaypal.com\u003c/code\u003e because the object \u003ccode\u003epaypal\u003c/code\u003e doesn\u0026#39;t exist, which will stop anything from working. The good thing is that \u003ccode\u003ePAYPAL\u003c/code\u003e does exist and \u003ccode\u003ePAYPAL.com\u003c/code\u003e is accepted as a valid value in the URL.\u003cbr\u003e\nThe second thing is that parentheses, quotes, semicolons and new lines are not allowed. But equal signs, commas and single quotes are allowed. So, you can set \u003ccode\u003ePAYAPL.com\u003c/code\u003e to any valid value you want like \u003ccode\u003ePAYPAL.com=1\u003c/code\u003e. Then you can use \u003ccode\u003elocation\u003c/code\u003e and set it to something like \u003ccode\u003e\u0026#39;javascript:alert\\x28\\x29\u0026#39;\u003c/code\u003e. I encoded the invalid special characters in a encoding that Javascript understands and will decode before changing the \u003ccode\u003elocation\u003c/code\u003e. Now you can put anything you want.\u003c/p\u003e\n\n\u003cp\u003eOn Firefox and Chrome, the \u003ccode\u003elocation=\u0026#39;javascript:alert\\x28\\x29\u0026#39;\u003c/code\u003e writes \u003ccode\u003ejavascript:alert()\u003c/code\u003e in the document, so I had to change it to make it work. Ended up with this: \u003ccode\u003elocation=\u0026#39;javascript:\\x3csvg\\x20onload=alert\\x28document.domain\\x29\\x3e\u0026#39;\u003c/code\u003e.\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eYou could make actions as the authenticated user and probably more but I didn\u0026#39;t tried.\u003c/p\u003e\n","bounty_amount":"2900.0","formatted_bounty":"$2,900","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":92,"voters":["honoki","sp1d3rs","foobar7","shailesh4594","mashoud1122","ramsexy","bogdantcaciuc","spam404","sameerphad72","samux","and 82 more..."],"severity":{"rating":"medium","score":4.6,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"low","user_interaction":"required","scope":"unchanged","confidentiality":"low","integrity":"low","availability":"none"}},"structured_scope":{"databaseId":13591,"asset_type":"URL","asset_identifier":"*.paypal.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":3513871,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2018-10-22T13:19:20.371Z","updated_at":"2018-10-22T13:19:20.371Z","additional_data":{"old_severity":null,"new_severity":"Medium","old_severity_id":null,"new_severity_id":227117},"actor":{"username":"bassguitar","cleared":false,"url":"/bassguitar","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/352/794/5d82b321348f78aa4ac9c82c0bdd004828bcb414_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"paypal","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":3513872,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thank you for your submission! We were able to validate your report, and we have submitted it to the appropriate remediation team for review. They will let us know the final ruling on this report, and if/when a fix will be implemented. Please note that the status and severity are subject to change.","markdown_message":"\u003cp\u003eThank you for your submission! We were able to validate your report, and we have submitted it to the appropriate remediation team for review. They will let us know the final ruling on this report, and if/when a fix will be implemented. Please note that the status and severity are subject to change.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-10-22T13:19:28.415Z","updated_at":"2018-10-22T13:19:28.415Z","actor":{"username":"bassguitar","cleared":false,"url":"/bassguitar","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/352/794/5d82b321348f78aa4ac9c82c0bdd004828bcb414_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"paypal","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":3516692,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2018-10-22T22:36:11.596Z","updated_at":"2018-10-22T22:36:11.596Z","additional_data":{"old_severity":"Medium","new_severity":"Medium (4.6)","old_severity_id":227117,"new_severity_id":227428},"actor":{"username":"meteor_pp","cleared":false,"url":"/meteor_pp","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/322/461/7e6cf8c966a0ebcdcce47354fa3eaa421eaab15f_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"paypal","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3516693,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Congratulations! Your submission has been validated and you will be rewarded a bounty. In order to receive your payment, please ensure your [HackerOne email alias](https://docs.hackerone.com/hackers/hacker-email-alias.html#___gatsby) is added to your PayPal account.\n\nTo add and confirm your email address:\n\n1. Log in to your PayPal account.\n2. Click the **Settings** icon near the top right corner of the page.\n3. Click the \"+\" beside \"Email address\".\n4. Enter your new email address and click **Add Email Address.**\n5. Click **Edit** next to the email you want to confirm.\n6. Click **Confirm this email.**\n\nOpen the email, and click the link to confirm your address. You will automatically return to the PayPal site where you will be asked to enter your password. When you receive the code in the mail, log in to your PayPal account and click Confirm address in the Activate Account box. Then enter your code.","markdown_message":"\u003cp\u003eCongratulations! Your submission has been validated and you will be rewarded a bounty. In order to receive your payment, please ensure your \u003ca href=\"https://docs.hackerone.com/hackers/hacker-email-alias.html#___gatsby\"\u003eHackerOne email alias\u003c/a\u003e is added to your PayPal account.\u003c/p\u003e\n\n\u003cp\u003eTo add and confirm your email address:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eLog in to your PayPal account.\u003c/li\u003e\n\u003cli\u003eClick the \u003cstrong\u003eSettings\u003c/strong\u003e icon near the top right corner of the page.\u003c/li\u003e\n\u003cli\u003eClick the \u0026quot;+\u0026quot; beside \u0026quot;Email address\u0026quot;.\u003c/li\u003e\n\u003cli\u003eEnter your new email address and click \u003cstrong\u003eAdd Email Address.\u003c/strong\u003e\n\u003c/li\u003e\n\u003cli\u003eClick \u003cstrong\u003eEdit\u003c/strong\u003e next to the email you want to confirm.\u003c/li\u003e\n\u003cli\u003eClick \u003cstrong\u003eConfirm this email.\u003c/strong\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eOpen the email, and click the link to confirm your address. You will automatically return to the PayPal site where you will be asked to enter your password. When you receive the code in the mail, log in to your PayPal account and click Confirm address in the Activate Account box. Then enter your code.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-10-22T22:36:41.426Z","updated_at":"2018-10-22T22:36:41.426Z","actor":{"url":"/paypal","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/E9WYrLcvXzomLyDprWfN7bq1/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"PayPal"}},"bounty_amount":"2900.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"paypal","collaborator":{"username":"stefanofinding","url":"/stefanofinding"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3517159,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you very much for the reward!!\nI just added the email alias to my PayPal account and confirmed it.","markdown_message":"\u003cp\u003eThank you very much for the reward!!\u003cbr\u003e\nI just added the email alias to my PayPal account and confirmed it.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-10-23T01:45:32.643Z","updated_at":"2018-10-23T01:45:32.643Z","actor":{"username":"stefanofinding","cleared":true,"url":"/stefanofinding","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/171/2558843b6d2b90f4dd826a661bcef3fd1abb2906_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"paypal","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3577596,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2018-11-02T19:48:12.112Z","updated_at":"2018-11-02T19:48:12.112Z","actor":{"username":"meteor_pp","cleared":false,"url":"/meteor_pp","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/322/461/7e6cf8c966a0ebcdcce47354fa3eaa421eaab15f_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"stefanofinding","url":"/stefanofinding"},"genius_execution_id":null,"team_handle":"paypal","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3577915,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"🙂","markdown_message":"\u003cp\u003e🙂\u003c/p\u003e\n","automated_response":false,"created_at":"2018-11-02T21:04:59.571Z","updated_at":"2018-11-02T21:04:59.571Z","first_to_agree":true,"actor":{"username":"stefanofinding","cleared":true,"url":"/stefanofinding","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/171/2558843b6d2b90f4dd826a661bcef3fd1abb2906_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"paypal","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3594346,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-11-06T16:40:59.000Z","updated_at":"2018-11-06T16:40:59.000Z","actor":{"username":"dust_pp","cleared":false,"url":"/dust_pp","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/jqtrCQrf4wrFi6RUZEq9xmkD/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"paypal","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3594347,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-11-06T16:40:59.083Z","updated_at":"2018-11-06T16:40:59.083Z","actor":{"username":"dust_pp","cleared":false,"url":"/dust_pp","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/jqtrCQrf4wrFi6RUZEq9xmkD/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"paypal","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3594421,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks!","markdown_message":"\u003cp\u003eThanks!\u003c/p\u003e\n","automated_response":false,"created_at":"2018-11-06T16:42:39.833Z","updated_at":"2018-11-06T16:42:39.833Z","actor":{"username":"stefanofinding","cleared":true,"url":"/stefanofinding","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/171/2558843b6d2b90f4dd826a661bcef3fd1abb2906_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"paypal","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}