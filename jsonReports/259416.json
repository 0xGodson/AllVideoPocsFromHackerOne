{"id":259416,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yNTk0MTY=","url":"https://hackerone.com/reports/259416","title":"Incorrect email content when disabling 2FA","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2017-08-13T12:57:15.922Z","submitted_at":"2017-08-13T12:57:15.922Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"goodhackonly","url":"/goodhackonly","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/111/089/25eda73922232abc37f9e3077a76b9488fae319c_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1601,"url":"https://hackerone.com/legalrobot","handle":"legalrobot","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/601/0f164c3d9618b04b006b859517ff032ec57ab42a_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/601/0f164c3d9618b04b006b859517ff032ec57ab42a_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"paused","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Legal Robot","twitter_handle":"LegalRobot","website":"https://www.legalrobot.com","about":"Automated legal document review using artificial intelligence"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-08-15T05:18:37.554Z","bug_reporter_agreed_on_going_public_at":"2017-08-15T05:18:37.494Z","team_member_agreed_on_going_public_at":"2017-08-15T05:11:49.189Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hello @team,\n\nI found that there is false statement in the 2FA disabled mails sent by the legalrobot.\n\nwhat is the issue?\nWhen user is disabling the 2fa authenticator app Registration.He will get a notification regarding the Disabling of the 2FA .the mail structure is like this:\n**\n2FA disabled\n\nThe 2FA Authenticator App registration was just removed from your Legal Robot (TEST) account. 2-Factor Authentication is still enabled since you registered a security key.\n\n**\n\n\nbut the user haven't registered any security key.\n\nsteps to reproduce:\n1.Create a new account.\n2.login to your account and enable the 2FA authentication.\n3.dont make any changed to the FIDO U2F Security Key .\n4.disable the 2FA Authenticator App registration.\n5.now you will receive mail from legalrobot updating about the 2FA disabled.\n6.but still you can find the statement \" 2-Factor Authentication is still enabled since you registered a security key.\"\n\nThis will create confusion among the users and the trust will break.\n\nKindly find the attached video poc for better understanding.\n\nThanks!\n\n","vulnerability_information_html":"\u003cp\u003eHello @team,\u003c/p\u003e\n\n\u003cp\u003eI found that there is false statement in the 2FA disabled mails sent by the legalrobot.\u003c/p\u003e\n\n\u003cp\u003ewhat is the issue?\u003cbr\u003e\nWhen user is disabling the 2fa authenticator app Registration.He will get a notification regarding the Disabling of the 2FA .the mail structure is like this:\u003cbr\u003e\n**\u003cbr\u003e\n2FA disabled\u003c/p\u003e\n\n\u003cp\u003eThe 2FA Authenticator App registration was just removed from your Legal Robot (TEST) account. 2-Factor Authentication is still enabled since you registered a security key.\u003c/p\u003e\n\n\u003cp\u003e**\u003c/p\u003e\n\n\u003cp\u003ebut the user haven\u0026#39;t registered any security key.\u003c/p\u003e\n\n\u003cp\u003esteps to reproduce:\u003cbr\u003e\n1.Create a new account.\u003cbr\u003e\n2.login to your account and enable the 2FA authentication.\u003cbr\u003e\n3.dont make any changed to the FIDO U2F Security Key .\u003cbr\u003e\n4.disable the 2FA Authenticator App registration.\u003cbr\u003e\n5.now you will receive mail from legalrobot updating about the 2FA disabled.\u003cbr\u003e\n6.but still you can find the statement \u0026quot; 2-Factor Authentication is still enabled since you registered a security key.\u0026quot;\u003c/p\u003e\n\n\u003cp\u003eThis will create confusion among the users and the trust will break.\u003c/p\u003e\n\n\u003cp\u003eKindly find the attached video poc for better understanding.\u003c/p\u003e\n\n\u003cp\u003eThanks!\u003c/p\u003e\n","bounty_amount":"20.0","formatted_bounty":"$20","weakness":{"id":65,"name":"Business Logic Errors"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":212011,"file_name":"legalrobot_poc.mkv","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/212/011/19d50d6c4e6631689c777f1b26a1f76fb096db42/legalrobot_poc.mkv?response-content-disposition=attachment%3B%20filename%3D%22legalrobot_poc.mkv%22%3B%20filename%2A%3DUTF-8%27%27legalrobot_poc.mkv\u0026response-content-type=video%2Fx-matroska\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQWS7SVX5C%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T051425Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCICTltBX5kZS78yzw3IUUt%2Fa035OzgQ2vLu8U1ZxOKGilAiEAqT8jxmclsgLwaEL5fi7C70iqLwP7J3SWF5ypfn%2Fn%2BdUqtAMIVBABGgwwMTM2MTkyNzQ4NDkiDGRWkSc4Hmgq8mMXKCqRA0Pq%2Bzgh6dptjyRB4GzYO9sir45RVm0RyvFSB8lDBYTBiDIVL0nR3Ah5epkHqGDZZEh0G%2BfKYu%2FWpfgxJl7qllLzKg%2BOA0izVs9KPgQdxk0VWwW%2FPKL2ZT4v%2FSNRvF7rPUbZ7WhGTZqx0%2BinzKM%2BO6lDyXZKNKMzhjRnIFdI7Th01c4ma39imTXQDmxc%2FNzHFK40lrkAbTZoTlcq%2BsnIcIRSB0h4GHasXhR5OHx8rifULR7sVKHDcZMCzSYjrtagaKs9I81LEzlSbEGxIQar2MK%2BZBwmpT57aT%2F1nIOoa%2FlH5nfP4Ihcv4Mqfp19pFx8mlVoMe%2FTEx0pqNuC4lGQXowSDJKBcSjrYM6ouddZWfwY6R4O8X69XqZawGSrmBiXyAVG%2BDj895xbDJhiOXMvqkvSfsEzIfvcaHAzshzNZjFT3yiN4h81wfUF3QuLc6DHCTt1MPDYiUB8I7UCQ8wJxW4pg3xTnHqSwUeqww3YY8RFfsgvfp9PzGJ1s4vReFrzuzYVanpT22oz4w33z29yMPmMMO21qv8FOusBOsYr4rmEPt9wYTc2WNI63vM9u2VUhGNHafH2%2Fh3q6i%2BwJ0u2HLCQd44aqHfWZ%2Bc8hzInEQnRNrZf7owYuE4cHiraWaOsNJjfOEJBZu5nzzun4JSk7801NfOqa1zcgLMWOwyWJCtalb9fGn6qhwTWTBMzsOFHc661yyW%2FaqejCIRf6%2BwNOGhO8kc%2BEhEIq0iydp5k4rlMRKlFJPFlphrQYGeZgYr9TM%2FVgHlN%2Bx4Oxtcg1UwCGXMGiV%2BqXzeMEmO%2FdxKETdJJvF%2BEaJSsF0r1i7s8g61czrgyi9MKMpia%2Fg6ovVFkrvHOejV96g%3D%3D\u0026X-Amz-Signature=ec3ede908a9cbf0fafafece06f3b3ae8ced1057da4c164b7813eb09606949218","file_size":7589423,"type":"video/x-matroska"}],"allow_singular_disclosure_at":"2017-09-14T05:11:49.241Z","allow_singular_disclosure_after":-103852956.35555294,"singular_disclosure_allowed":true,"vote_count":2,"voters":["eveeez","japz"],"structured_scope":{"databaseId":521,"asset_type":"URL","asset_identifier":"app.legalrobot-test.com","max_severity":"none"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1924822,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Huh, I'm aware of that bit of the email. It's from some conditional logic that should look at whether the user actually has a U2F security key. We'll look into it - thanks!","markdown_message":"\u003cp\u003eHuh, I\u0026#39;m aware of that bit of the email. It\u0026#39;s from some conditional logic that should look at whether the user actually has a U2F security key. We\u0026#39;ll look into it - thanks!\u003c/p\u003e\n","automated_response":false,"created_at":"2017-08-13T17:50:15.608Z","updated_at":"2017-08-13T17:50:15.608Z","actor":{"username":"danrubins","cleared":false,"url":"/danrubins","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/021/222/c1d0d51f40e0c570e2153b6801fe54c997c757f0_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"legalrobot","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1929506,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Ah, I see... we were checking for the existence of the u2f key in the user object (`if (services.u2f) ...`), not specifically that U2F was enabled (`if (services.u2f \u0026\u0026 services.u2f.enabled) ...`). This is fixed and should be deployed tonight or tomorrow.","markdown_message":"\u003cp\u003eAh, I see... we were checking for the existence of the u2f key in the user object (\u003ccode\u003eif (services.u2f) ...\u003c/code\u003e), not specifically that U2F was enabled (\u003ccode\u003eif (services.u2f \u0026amp;\u0026amp; services.u2f.enabled) ...\u003c/code\u003e). This is fixed and should be deployed tonight or tomorrow.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-08-15T05:10:31.358Z","updated_at":"2017-08-15T05:10:31.358Z","actor":{"username":"danrubins","cleared":false,"url":"/danrubins","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/021/222/c1d0d51f40e0c570e2153b6801fe54c997c757f0_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"goodhackonly","url":"/goodhackonly"},"genius_execution_id":null,"team_handle":"legalrobot","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1929508,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2017-08-15T05:11:02.966Z","updated_at":"2017-08-15T05:11:02.966Z","additional_data":{"old_title":"False content in the 2FA disabled mails","new_title":"Incorrect email content when disabling 2FA"},"actor":{"username":"danrubins","cleared":false,"url":"/danrubins","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/021/222/c1d0d51f40e0c570e2153b6801fe54c997c757f0_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"legalrobot","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1929509,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2017-08-15T05:11:13.685Z","updated_at":"2017-08-15T05:11:13.685Z","actor":{"url":"/legalrobot","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/601/0f164c3d9618b04b006b859517ff032ec57ab42a_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Legal Robot"}},"bounty_amount":"20.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"legalrobot","collaborator":{"username":"goodhackonly","url":"/goodhackonly"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1929511,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Requesting full disclosure.","markdown_message":"\u003cp\u003eRequesting full disclosure.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-08-15T05:11:49.212Z","updated_at":"2017-08-15T05:11:49.212Z","first_to_agree":true,"actor":{"username":"danrubins","cleared":false,"url":"/danrubins","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/021/222/c1d0d51f40e0c570e2153b6801fe54c997c757f0_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"legalrobot","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1929529,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Sure.\n","markdown_message":"\u003cp\u003eSure.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-08-15T05:18:19.847Z","updated_at":"2017-08-15T05:18:19.847Z","actor":{"username":"goodhackonly","cleared":false,"url":"/goodhackonly","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/111/089/25eda73922232abc37f9e3077a76b9488fae319c_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"legalrobot","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1929530,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-08-15T05:18:37.519Z","updated_at":"2017-08-15T05:18:37.519Z","actor":{"username":"goodhackonly","cleared":false,"url":"/goodhackonly","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/111/089/25eda73922232abc37f9e3077a76b9488fae319c_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"legalrobot","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1929531,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-08-15T05:18:37.577Z","updated_at":"2017-08-15T05:18:37.577Z","actor":{"username":"goodhackonly","cleared":false,"url":"/goodhackonly","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/111/089/25eda73922232abc37f9e3077a76b9488fae319c_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"legalrobot","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}