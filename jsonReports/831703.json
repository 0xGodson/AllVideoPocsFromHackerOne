{"id":831703,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC84MzE3MDM=","url":"https://hackerone.com/reports/831703","title":"XSS from arbitrary attachment upload.","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2020-03-25T23:25:12.612Z","submitted_at":"2020-03-25T23:25:12.612Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"wisp","url":"/wisp","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/192/649/ba6a8f9a0d54ba3286c7ab13ca0b351db8f00c19_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":41772,"url":"https://hackerone.com/qulture_rocks_x3u44","handle":"qulture_rocks_x3u44","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/041/772/40eefc9cc099800ed74a1faf2ae863ae1cccb0dc_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/041/772/40eefc9cc099800ed74a1faf2ae863ae1cccb0dc_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Qulture.Rocks","twitter_handle":"","website":"https://hackerone.qulture.rocks/","about":""}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2020-08-28T04:53:15.235Z","bug_reporter_agreed_on_going_public_at":"2020-07-29T04:53:14.028Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"## Summary:\n\nThe `New Comment` feature in the OKRs page allows a user to upload an arbitrary file. I was able to upload HTML file that contains Javascript code. The Javascript code will execute when victim access visits the attachment.\n\n\n## Steps To Reproduce:\n\n1. Upload an HTML file that contains javascript code.\n2. Visit the attachment to trigger the XSS.\n\n{F760700}\n\n\n## Supporting Material/References:\n\n\nHTML file that contains `\u003cscript type=\"text/javascript\"\u003ealert(document.cookie)\u003c/script\u003e`:\nhttps://hackerone.qulture.rocks/attachments/c82c6403105da5f5f286c937f50cf6a4fbe10f4e/attachments/b9dd91febea0a8090b5e77974f5bdd01a04af08d9fa1534fedaec0121b8b/xss.html\n{F760714}\n\n## Impact\n\nI try to upload PHP/asp file and hope to get RCE, but the file doesn't execute on the server-side. I was able to achieve XSS with the uploaded file.\n\nSuccessful exploitation of cross-site scripting vulnerabilities allows an attacker to run arbitrary script code in the context of the affected user. This can be used to compromise the integrity of content returned by the webserver to take over a user's session, redirect the user to a malicious website or send requests on the behalf of the user(Since the file is hosted at the same subdomain as the application, which help bypass the same-origin policy).","vulnerability_information_html":"\u003ch2 id=\"summary\"\u003eSummary:\u003c/h2\u003e\n\n\u003cp\u003eThe \u003ccode\u003eNew Comment\u003c/code\u003e feature in the OKRs page allows a user to upload an arbitrary file. I was able to upload HTML file that contains Javascript code. The Javascript code will execute when victim access visits the attachment.\u003c/p\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps To Reproduce:\u003c/h2\u003e\n\n\u003col\u003e\n\u003cli\u003eUpload an HTML file that contains javascript code.\u003c/li\u003e\n\u003cli\u003eVisit the attachment to trigger the XSS.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003e\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"Screen_Shot_2020-03-25_at_7.08.02_PM.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/AYK1fozUSd5RWXFoCUAFoGGX?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2020-03-25_at_7.08.02_PM.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2020-03-25_at_7.08.02_PM.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQ3Q6GNRX4%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T065852Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIB%2F4DOSXz4Uk7JQqVyIKOhXYFqWTxcD44Z3HdHcn0dvKAiEA3PYdLzeI5Kv3E9WFbSVqd%2BUBlw0212Xg7H3tNiixN5gqtAMIVxABGgwwMTM2MTkyNzQ4NDkiDIUObNP5fEX8bJXBsSqRA%2BL7Z0plmhSxsMHnrb83ftPuhWkgvNoQbpQ66ErJF8Tab4HbvnqeuplpQgE7hhKtqBYOEsdafEq0r9zNmqA7m92b%2BxDq63GNbNVm2hS%2FrGlDOjkNPC4s9Y9jvsKbOyEaodYyGTaNp7nXzoPtsVsXWu3VzjV5rY1%2FOniQ2%2B1s8ySEdTjZaRHk8P%2FwXbNfsl1hT2TAe2rleD%2BZ%2BVAaUzHyFNU%2F1mQkQNOozyUs%2B0kWyLXo4oDuk2v6G%2B%2B%2BOffGDFiu%2F5vFGTwCcw9LcpG50TBnwx2MYUfVFlGDhzFRqqeFnE8%2BVLdMRhVxgbXYhePjinuq12WCpDVAhCJNj8IR3wEJ1%2FQoonHq3u3s4Fjef1%2Bw%2BXtypskg56dqBrrGLe95zM0RechJC4u4kZN3x7RKFnUe%2BQTgA2fsU4g%2FeYbY51bNGPKZw3ELWdMZpvEwvawS7vQJcERLBBN%2FFBpdyPI7tU9GTieNVwCAMdziMkUN3bUc%2BsG8%2BbAIpsp1R0fqA4Zzh1fBBmHnAwvAA0nggtgLe0MkU7v1MNiFq%2F8FOusBRvYvRZdkMedUg2M4tNHIP5rUiGXbyy3g4wRqI3QxmX%2FtfXzpLdSUg3BMdPDmPj8jrIy0bzAIMzEhANIb5ri2Nz0%2FfFqmnJ3rjk8e005Fnv5uK088J0m7HFCYIe7hgj40pmM5UNmkGs30hxAnycAlyRaDL94ttdw5SqAS%2FW4MMrRVIliym5o9kruL0SoyWZC0kQciksSypgYXswzm%2BAeZve49Cnzr6ikwTN3S7tncfj0WMJznDG890QvBL3O7QjntIQ6Hf9oANAQjphy38wZSi3%2FB45i5bX5Kr2E9NKFLEy5UWui5G%2BmfVfaVyg%3D%3D\u0026amp;X-Amz-Signature=13bf837dc3ecfeefce65faeb310eeaef93cddfda3d023e8d62582c17e9dcf559\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/AYK1fozUSd5RWXFoCUAFoGGX?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2020-03-25_at_7.08.02_PM.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2020-03-25_at_7.08.02_PM.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQ3Q6GNRX4%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T065852Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIB%2F4DOSXz4Uk7JQqVyIKOhXYFqWTxcD44Z3HdHcn0dvKAiEA3PYdLzeI5Kv3E9WFbSVqd%2BUBlw0212Xg7H3tNiixN5gqtAMIVxABGgwwMTM2MTkyNzQ4NDkiDIUObNP5fEX8bJXBsSqRA%2BL7Z0plmhSxsMHnrb83ftPuhWkgvNoQbpQ66ErJF8Tab4HbvnqeuplpQgE7hhKtqBYOEsdafEq0r9zNmqA7m92b%2BxDq63GNbNVm2hS%2FrGlDOjkNPC4s9Y9jvsKbOyEaodYyGTaNp7nXzoPtsVsXWu3VzjV5rY1%2FOniQ2%2B1s8ySEdTjZaRHk8P%2FwXbNfsl1hT2TAe2rleD%2BZ%2BVAaUzHyFNU%2F1mQkQNOozyUs%2B0kWyLXo4oDuk2v6G%2B%2B%2BOffGDFiu%2F5vFGTwCcw9LcpG50TBnwx2MYUfVFlGDhzFRqqeFnE8%2BVLdMRhVxgbXYhePjinuq12WCpDVAhCJNj8IR3wEJ1%2FQoonHq3u3s4Fjef1%2Bw%2BXtypskg56dqBrrGLe95zM0RechJC4u4kZN3x7RKFnUe%2BQTgA2fsU4g%2FeYbY51bNGPKZw3ELWdMZpvEwvawS7vQJcERLBBN%2FFBpdyPI7tU9GTieNVwCAMdziMkUN3bUc%2BsG8%2BbAIpsp1R0fqA4Zzh1fBBmHnAwvAA0nggtgLe0MkU7v1MNiFq%2F8FOusBRvYvRZdkMedUg2M4tNHIP5rUiGXbyy3g4wRqI3QxmX%2FtfXzpLdSUg3BMdPDmPj8jrIy0bzAIMzEhANIb5ri2Nz0%2FfFqmnJ3rjk8e005Fnv5uK088J0m7HFCYIe7hgj40pmM5UNmkGs30hxAnycAlyRaDL94ttdw5SqAS%2FW4MMrRVIliym5o9kruL0SoyWZC0kQciksSypgYXswzm%2BAeZve49Cnzr6ikwTN3S7tncfj0WMJznDG890QvBL3O7QjntIQ6Hf9oANAQjphy38wZSi3%2FB45i5bX5Kr2E9NKFLEy5UWui5G%2BmfVfaVyg%3D%3D\u0026amp;X-Amz-Signature=13bf837dc3ecfeefce65faeb310eeaef93cddfda3d023e8d62582c17e9dcf559\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2 id=\"supporting-material-references\"\u003eSupporting Material/References:\u003c/h2\u003e\n\n\u003cp\u003eHTML file that contains \u003ccode\u003e\u0026lt;script type=\u0026quot;text/javascript\u0026quot;\u0026gt;alert(document.cookie)\u0026lt;/script\u0026gt;\u003c/code\u003e:\u003cbr\u003e\n\u003ca title=\"https://hackerone.qulture.rocks/attachments/c82c6403105da5f5f286c937f50cf6a4fbe10f4e/attachments/b9dd91febea0a8090b5e77974f5bdd01a04af08d9fa1534fedaec0121b8b/xss.html\" href=\"/redirect?url=https%3A%2F%2Fhackerone.qulture.rocks%2Fattachments%2Fc82c6403105da5f5f286c937f50cf6a4fbe10f4e%2Fattachments%2Fb9dd91febea0a8090b5e77974f5bdd01a04af08d9fa1534fedaec0121b8b%2Fxss.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://hackerone.qulture.rocks/attachments/c82c6403105da5f5f286c937f50cf6a4fbe10f4e/attachments/b9dd91febea0a8090b5e77974f5bdd01a04af08d9fa1534fedaec0121b8b/xss.html\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\n\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"Screen_Shot_2020-03-25_at_7.22.57_PM.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/9WJwUJivYkaNmEKEGsMax7vF?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2020-03-25_at_7.22.57_PM.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2020-03-25_at_7.22.57_PM.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQ3Q6GNRX4%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T065852Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIB%2F4DOSXz4Uk7JQqVyIKOhXYFqWTxcD44Z3HdHcn0dvKAiEA3PYdLzeI5Kv3E9WFbSVqd%2BUBlw0212Xg7H3tNiixN5gqtAMIVxABGgwwMTM2MTkyNzQ4NDkiDIUObNP5fEX8bJXBsSqRA%2BL7Z0plmhSxsMHnrb83ftPuhWkgvNoQbpQ66ErJF8Tab4HbvnqeuplpQgE7hhKtqBYOEsdafEq0r9zNmqA7m92b%2BxDq63GNbNVm2hS%2FrGlDOjkNPC4s9Y9jvsKbOyEaodYyGTaNp7nXzoPtsVsXWu3VzjV5rY1%2FOniQ2%2B1s8ySEdTjZaRHk8P%2FwXbNfsl1hT2TAe2rleD%2BZ%2BVAaUzHyFNU%2F1mQkQNOozyUs%2B0kWyLXo4oDuk2v6G%2B%2B%2BOffGDFiu%2F5vFGTwCcw9LcpG50TBnwx2MYUfVFlGDhzFRqqeFnE8%2BVLdMRhVxgbXYhePjinuq12WCpDVAhCJNj8IR3wEJ1%2FQoonHq3u3s4Fjef1%2Bw%2BXtypskg56dqBrrGLe95zM0RechJC4u4kZN3x7RKFnUe%2BQTgA2fsU4g%2FeYbY51bNGPKZw3ELWdMZpvEwvawS7vQJcERLBBN%2FFBpdyPI7tU9GTieNVwCAMdziMkUN3bUc%2BsG8%2BbAIpsp1R0fqA4Zzh1fBBmHnAwvAA0nggtgLe0MkU7v1MNiFq%2F8FOusBRvYvRZdkMedUg2M4tNHIP5rUiGXbyy3g4wRqI3QxmX%2FtfXzpLdSUg3BMdPDmPj8jrIy0bzAIMzEhANIb5ri2Nz0%2FfFqmnJ3rjk8e005Fnv5uK088J0m7HFCYIe7hgj40pmM5UNmkGs30hxAnycAlyRaDL94ttdw5SqAS%2FW4MMrRVIliym5o9kruL0SoyWZC0kQciksSypgYXswzm%2BAeZve49Cnzr6ikwTN3S7tncfj0WMJznDG890QvBL3O7QjntIQ6Hf9oANAQjphy38wZSi3%2FB45i5bX5Kr2E9NKFLEy5UWui5G%2BmfVfaVyg%3D%3D\u0026amp;X-Amz-Signature=bae6054d1edc91885c8797b11d3e62cedb80f98a791d14355573705366367077\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/9WJwUJivYkaNmEKEGsMax7vF?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2020-03-25_at_7.22.57_PM.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2020-03-25_at_7.22.57_PM.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQ3Q6GNRX4%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T065852Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIB%2F4DOSXz4Uk7JQqVyIKOhXYFqWTxcD44Z3HdHcn0dvKAiEA3PYdLzeI5Kv3E9WFbSVqd%2BUBlw0212Xg7H3tNiixN5gqtAMIVxABGgwwMTM2MTkyNzQ4NDkiDIUObNP5fEX8bJXBsSqRA%2BL7Z0plmhSxsMHnrb83ftPuhWkgvNoQbpQ66ErJF8Tab4HbvnqeuplpQgE7hhKtqBYOEsdafEq0r9zNmqA7m92b%2BxDq63GNbNVm2hS%2FrGlDOjkNPC4s9Y9jvsKbOyEaodYyGTaNp7nXzoPtsVsXWu3VzjV5rY1%2FOniQ2%2B1s8ySEdTjZaRHk8P%2FwXbNfsl1hT2TAe2rleD%2BZ%2BVAaUzHyFNU%2F1mQkQNOozyUs%2B0kWyLXo4oDuk2v6G%2B%2B%2BOffGDFiu%2F5vFGTwCcw9LcpG50TBnwx2MYUfVFlGDhzFRqqeFnE8%2BVLdMRhVxgbXYhePjinuq12WCpDVAhCJNj8IR3wEJ1%2FQoonHq3u3s4Fjef1%2Bw%2BXtypskg56dqBrrGLe95zM0RechJC4u4kZN3x7RKFnUe%2BQTgA2fsU4g%2FeYbY51bNGPKZw3ELWdMZpvEwvawS7vQJcERLBBN%2FFBpdyPI7tU9GTieNVwCAMdziMkUN3bUc%2BsG8%2BbAIpsp1R0fqA4Zzh1fBBmHnAwvAA0nggtgLe0MkU7v1MNiFq%2F8FOusBRvYvRZdkMedUg2M4tNHIP5rUiGXbyy3g4wRqI3QxmX%2FtfXzpLdSUg3BMdPDmPj8jrIy0bzAIMzEhANIb5ri2Nz0%2FfFqmnJ3rjk8e005Fnv5uK088J0m7HFCYIe7hgj40pmM5UNmkGs30hxAnycAlyRaDL94ttdw5SqAS%2FW4MMrRVIliym5o9kruL0SoyWZC0kQciksSypgYXswzm%2BAeZve49Cnzr6ikwTN3S7tncfj0WMJznDG890QvBL3O7QjntIQ6Hf9oANAQjphy38wZSi3%2FB45i5bX5Kr2E9NKFLEy5UWui5G%2BmfVfaVyg%3D%3D\u0026amp;X-Amz-Signature=bae6054d1edc91885c8797b11d3e62cedb80f98a791d14355573705366367077\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eI try to upload PHP/asp file and hope to get RCE, but the file doesn\u0026#39;t execute on the server-side. I was able to achieve XSS with the uploaded file.\u003c/p\u003e\n\n\u003cp\u003eSuccessful exploitation of cross-site scripting vulnerabilities allows an attacker to run arbitrary script code in the context of the affected user. This can be used to compromise the integrity of content returned by the webserver to take over a user\u0026#39;s session, redirect the user to a malicious website or send requests on the behalf of the user(Since the file is hosted at the same subdomain as the application, which help bypass the same-origin policy).\u003c/p\u003e\n","weakness":{"id":62,"name":"Cross-site Scripting (XSS) - Stored"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":760700,"file_name":"Screen_Shot_2020-03-25_at_7.08.02_PM.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/AYK1fozUSd5RWXFoCUAFoGGX?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2020-03-25_at_7.08.02_PM.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2020-03-25_at_7.08.02_PM.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ3Q6GNRX4%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T065852Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIB%2F4DOSXz4Uk7JQqVyIKOhXYFqWTxcD44Z3HdHcn0dvKAiEA3PYdLzeI5Kv3E9WFbSVqd%2BUBlw0212Xg7H3tNiixN5gqtAMIVxABGgwwMTM2MTkyNzQ4NDkiDIUObNP5fEX8bJXBsSqRA%2BL7Z0plmhSxsMHnrb83ftPuhWkgvNoQbpQ66ErJF8Tab4HbvnqeuplpQgE7hhKtqBYOEsdafEq0r9zNmqA7m92b%2BxDq63GNbNVm2hS%2FrGlDOjkNPC4s9Y9jvsKbOyEaodYyGTaNp7nXzoPtsVsXWu3VzjV5rY1%2FOniQ2%2B1s8ySEdTjZaRHk8P%2FwXbNfsl1hT2TAe2rleD%2BZ%2BVAaUzHyFNU%2F1mQkQNOozyUs%2B0kWyLXo4oDuk2v6G%2B%2B%2BOffGDFiu%2F5vFGTwCcw9LcpG50TBnwx2MYUfVFlGDhzFRqqeFnE8%2BVLdMRhVxgbXYhePjinuq12WCpDVAhCJNj8IR3wEJ1%2FQoonHq3u3s4Fjef1%2Bw%2BXtypskg56dqBrrGLe95zM0RechJC4u4kZN3x7RKFnUe%2BQTgA2fsU4g%2FeYbY51bNGPKZw3ELWdMZpvEwvawS7vQJcERLBBN%2FFBpdyPI7tU9GTieNVwCAMdziMkUN3bUc%2BsG8%2BbAIpsp1R0fqA4Zzh1fBBmHnAwvAA0nggtgLe0MkU7v1MNiFq%2F8FOusBRvYvRZdkMedUg2M4tNHIP5rUiGXbyy3g4wRqI3QxmX%2FtfXzpLdSUg3BMdPDmPj8jrIy0bzAIMzEhANIb5ri2Nz0%2FfFqmnJ3rjk8e005Fnv5uK088J0m7HFCYIe7hgj40pmM5UNmkGs30hxAnycAlyRaDL94ttdw5SqAS%2FW4MMrRVIliym5o9kruL0SoyWZC0kQciksSypgYXswzm%2BAeZve49Cnzr6ikwTN3S7tncfj0WMJznDG890QvBL3O7QjntIQ6Hf9oANAQjphy38wZSi3%2FB45i5bX5Kr2E9NKFLEy5UWui5G%2BmfVfaVyg%3D%3D\u0026X-Amz-Signature=13bf837dc3ecfeefce65faeb310eeaef93cddfda3d023e8d62582c17e9dcf559","file_size":403291,"type":"image/png"},{"id":760714,"file_name":"Screen_Shot_2020-03-25_at_7.22.57_PM.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/9WJwUJivYkaNmEKEGsMax7vF?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2020-03-25_at_7.22.57_PM.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2020-03-25_at_7.22.57_PM.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ3Q6GNRX4%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T065852Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIB%2F4DOSXz4Uk7JQqVyIKOhXYFqWTxcD44Z3HdHcn0dvKAiEA3PYdLzeI5Kv3E9WFbSVqd%2BUBlw0212Xg7H3tNiixN5gqtAMIVxABGgwwMTM2MTkyNzQ4NDkiDIUObNP5fEX8bJXBsSqRA%2BL7Z0plmhSxsMHnrb83ftPuhWkgvNoQbpQ66ErJF8Tab4HbvnqeuplpQgE7hhKtqBYOEsdafEq0r9zNmqA7m92b%2BxDq63GNbNVm2hS%2FrGlDOjkNPC4s9Y9jvsKbOyEaodYyGTaNp7nXzoPtsVsXWu3VzjV5rY1%2FOniQ2%2B1s8ySEdTjZaRHk8P%2FwXbNfsl1hT2TAe2rleD%2BZ%2BVAaUzHyFNU%2F1mQkQNOozyUs%2B0kWyLXo4oDuk2v6G%2B%2B%2BOffGDFiu%2F5vFGTwCcw9LcpG50TBnwx2MYUfVFlGDhzFRqqeFnE8%2BVLdMRhVxgbXYhePjinuq12WCpDVAhCJNj8IR3wEJ1%2FQoonHq3u3s4Fjef1%2Bw%2BXtypskg56dqBrrGLe95zM0RechJC4u4kZN3x7RKFnUe%2BQTgA2fsU4g%2FeYbY51bNGPKZw3ELWdMZpvEwvawS7vQJcERLBBN%2FFBpdyPI7tU9GTieNVwCAMdziMkUN3bUc%2BsG8%2BbAIpsp1R0fqA4Zzh1fBBmHnAwvAA0nggtgLe0MkU7v1MNiFq%2F8FOusBRvYvRZdkMedUg2M4tNHIP5rUiGXbyy3g4wRqI3QxmX%2FtfXzpLdSUg3BMdPDmPj8jrIy0bzAIMzEhANIb5ri2Nz0%2FfFqmnJ3rjk8e005Fnv5uK088J0m7HFCYIe7hgj40pmM5UNmkGs30hxAnycAlyRaDL94ttdw5SqAS%2FW4MMrRVIliym5o9kruL0SoyWZC0kQciksSypgYXswzm%2BAeZve49Cnzr6ikwTN3S7tncfj0WMJznDG890QvBL3O7QjntIQ6Hf9oANAQjphy38wZSi3%2FB45i5bX5Kr2E9NKFLEy5UWui5G%2BmfVfaVyg%3D%3D\u0026X-Amz-Signature=bae6054d1edc91885c8797b11d3e62cedb80f98a791d14355573705366367077","file_size":102476,"type":"image/png"}],"allow_singular_disclosure_at":"2020-08-28T04:53:14.079Z","allow_singular_disclosure_after":-10634738.87469216,"singular_disclosure_allowed":true,"vote_count":74,"voters":["sgt_","ltidi","sourc7","wisp","th4nu_0x0","prophet","youngsheldon","mygf","holyfield","zimmer75","and 64 more..."],"severity":{"rating":"high","author_type":"User"},"structured_scope":{"databaseId":33184,"asset_type":"URL","asset_identifier":"https://hackerone.qulture.rocks/","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":7448535,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hi @wisp\n\nThank you for your report!\nI'll talk to the team to find the best solution here, but I was thinking about restricting file types for ones more simple like pdf/docx\n\nWhat do you think?","markdown_message":"\u003cp\u003eHi \u003ca href=\"/wisp\"\u003e@wisp\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eThank you for your report!\u003cbr\u003e\nI\u0026#39;ll talk to the team to find the best solution here, but I was thinking about restricting file types for ones more simple like pdf/docx\u003c/p\u003e\n\n\u003cp\u003eWhat do you think?\u003c/p\u003e\n","automated_response":false,"created_at":"2020-03-26T14:00:26.863Z","updated_at":"2020-03-26T14:00:26.863Z","actor":{"username":"manuelpuyol","cleared":false,"url":"/manuelpuyol","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/VfzFcvm4ErT8x7ssyNePBtZv/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"qulture_rocks_x3u44","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7449343,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @manuelpuyol \n\nThanks for the response.\n\nSome of my thoughts here:\n1. The simplest solution just like you mentioned, restricts the file type. But it might hurt the user experience, people might want to share all different kind of file.\n2. Generate a file download URL, such as https://example.com/download?file=xss.html to prevent the file render in the client browser or on the server-side.\n3. Use a third-party file management system to handle the file. Like the profile-images are handled by `cloudinary`. \n\nHope this helps.\n\nThanks!","markdown_message":"\u003cp\u003eHey \u003ca href=\"/manuelpuyol\"\u003e@manuelpuyol\u003c/a\u003e \u003c/p\u003e\n\n\u003cp\u003eThanks for the response.\u003c/p\u003e\n\n\u003cp\u003eSome of my thoughts here:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eThe simplest solution just like you mentioned, restricts the file type. But it might hurt the user experience, people might want to share all different kind of file.\u003c/li\u003e\n\u003cli\u003eGenerate a file download URL, such as \u003ca title=\"https://example.com/download?file=xss.html\" href=\"/redirect?url=https%3A%2F%2Fexample.com%2Fdownload%3Ffile%3Dxss.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://example.com/download?file=xss.html\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e to prevent the file render in the client browser or on the server-side.\u003c/li\u003e\n\u003cli\u003eUse a third-party file management system to handle the file. Like the profile-images are handled by \u003ccode\u003ecloudinary\u003c/code\u003e. \u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eHope this helps.\u003c/p\u003e\n\n\u003cp\u003eThanks!\u003c/p\u003e\n","automated_response":false,"created_at":"2020-03-26T15:20:36.037Z","updated_at":"2020-03-26T15:20:36.037Z","actor":{"username":"wisp","cleared":false,"url":"/wisp","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/192/649/ba6a8f9a0d54ba3286c7ab13ca0b351db8f00c19_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"qulture_rocks_x3u44","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7450133,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @wisp, thank you for the ideas, I didn't really had 2 in mind!\n\nI'm issuing a fix right now (waiting for a merge), which\n\n1. Restrict possible file extensions to the ones we want users to upload, instead of allowing everything\n2. Uses the [download attribute](https://www.w3schools.com/tags/att_a_download.asp) to download the file instead of opening in another tab\n\nNote that number 2 does not work in IE11 (a browser we have to support), so it wouldn't really change much, that's why number 1 was also implemented to protect those users too.\n\nAbout number 3, we do use S3 to manage our files, the problem was in the configuration of our download tag\n\nIf you have any other comments, please feel free to send them here!\nIf you think this fix is enough, when the PR is merged I'll close this issue as Resolver!\n\nThanks again for your report","markdown_message":"\u003cp\u003eHey \u003ca href=\"/wisp\"\u003e@wisp\u003c/a\u003e, thank you for the ideas, I didn\u0026#39;t really had 2 in mind!\u003c/p\u003e\n\n\u003cp\u003eI\u0026#39;m issuing a fix right now (waiting for a merge), which\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eRestrict possible file extensions to the ones we want users to upload, instead of allowing everything\u003c/li\u003e\n\u003cli\u003eUses the \u003ca href=\"/redirect?url=https%3A%2F%2Fwww.w3schools.com%2Ftags%2Fatt_a_download.asp\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003edownload attribute\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e to download the file instead of opening in another tab\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eNote that number 2 does not work in IE11 (a browser we have to support), so it wouldn\u0026#39;t really change much, that\u0026#39;s why number 1 was also implemented to protect those users too.\u003c/p\u003e\n\n\u003cp\u003eAbout number 3, we do use S3 to manage our files, the problem was in the configuration of our download tag\u003c/p\u003e\n\n\u003cp\u003eIf you have any other comments, please feel free to send them here!\u003cbr\u003e\nIf you think this fix is enough, when the PR is merged I\u0026#39;ll close this issue as Resolver!\u003c/p\u003e\n\n\u003cp\u003eThanks again for your report\u003c/p\u003e\n","automated_response":false,"created_at":"2020-03-26T16:38:10.938Z","updated_at":"2020-03-26T16:38:10.938Z","actor":{"username":"manuelpuyol","cleared":false,"url":"/manuelpuyol","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/VfzFcvm4ErT8x7ssyNePBtZv/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"qulture_rocks_x3u44","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7450337,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @manuelpuyol,\n\nI am not sure if the `download attribute` would work for the HTML extension. But combine with file extension restriction, it should be fine. \n\nPlease use a whitelist instead of a blacklist.\n\nCopy-paste code below to https://www.w3schools.com/tags/tryit.asp?filename=tryhtml5_a_download, click the image and the alert(1) will pop.\n\n```\n\u003c!DOCTYPE html\u003e\n\u003chtml\u003e\n\u003cbody\u003e\n\n\u003ch1\u003eThe a download attribute\u003c/h1\u003e\n\n\u003cp\u003eClick on the image to download it:\u003cp\u003e\n\u003ca href=\"https://www.wispwisp.com/xss.html\" download\u003e\n  \u003cimg src=\"/images/myw3schoolsimage.jpg\" alt=\"W3Schools\" width=\"104\" height=\"142\"\u003e\n\u003c/a\u003e\n\n\u003cp\u003e\u003cb\u003eNote:\u003c/b\u003e The download attribute is not supported in IE or Edge (prior version 18), or in Safari (prior version 10.1).\u003c/p\u003e\n\n\u003c/body\u003e\n\u003c/html\u003e\n```\n\n\n","markdown_message":"\u003cp\u003eHey \u003ca href=\"/manuelpuyol\"\u003e@manuelpuyol\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eI am not sure if the \u003ccode\u003edownload attribute\u003c/code\u003e would work for the HTML extension. But combine with file extension restriction, it should be fine. \u003c/p\u003e\n\n\u003cp\u003ePlease use a whitelist instead of a blacklist.\u003c/p\u003e\n\n\u003cp\u003eCopy-paste code below to \u003ca title=\"https://www.w3schools.com/tags/tryit.asp?filename=tryhtml5_a_download\" href=\"/redirect?url=https%3A%2F%2Fwww.w3schools.com%2Ftags%2Ftryit.asp%3Ffilename%3Dtryhtml5_a_download\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.w3schools.com/tags/tryit.asp?filename=tryhtml5_a_download\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e, click the image and the alert(1) will pop.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight html\"\u003e\u003ccode\u003e\u003cspan class=\"cp\"\u003e\u0026lt;!DOCTYPE html\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;html\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;body\u0026gt;\u003c/span\u003e\n\n\u003cspan class=\"nt\"\u003e\u0026lt;h1\u0026gt;\u003c/span\u003eThe a download attribute\u003cspan class=\"nt\"\u003e\u0026lt;/h1\u0026gt;\u003c/span\u003e\n\n\u003cspan class=\"nt\"\u003e\u0026lt;p\u0026gt;\u003c/span\u003eClick on the image to download it:\u003cspan class=\"nt\"\u003e\u0026lt;p\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;a\u003c/span\u003e \u003cspan class=\"na\"\u003ehref=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;https://www.wispwisp.com/xss.html\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003edownload\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"nt\"\u003e\u0026lt;img\u003c/span\u003e \u003cspan class=\"na\"\u003esrc=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;/images/myw3schoolsimage.jpg\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003ealt=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;W3Schools\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003ewidth=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;104\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003eheight=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;142\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/a\u0026gt;\u003c/span\u003e\n\n\u003cspan class=\"nt\"\u003e\u0026lt;p\u0026gt;\u0026lt;b\u0026gt;\u003c/span\u003eNote:\u003cspan class=\"nt\"\u003e\u0026lt;/b\u0026gt;\u003c/span\u003e The download attribute is not supported in IE or Edge (prior version 18), or in Safari (prior version 10.1).\u003cspan class=\"nt\"\u003e\u0026lt;/p\u0026gt;\u003c/span\u003e\n\n\u003cspan class=\"nt\"\u003e\u0026lt;/body\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/html\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","automated_response":false,"created_at":"2020-03-26T17:03:53.370Z","updated_at":"2020-03-26T17:03:53.370Z","actor":{"username":"wisp","cleared":false,"url":"/wisp","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/192/649/ba6a8f9a0d54ba3286c7ab13ca0b351db8f00c19_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"qulture_rocks_x3u44","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7450376,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"we did use a whitelist and HTML is not on it, so this case should be fine","markdown_message":"\u003cp\u003ewe did use a whitelist and HTML is not on it, so this case should be fine\u003c/p\u003e\n","automated_response":false,"created_at":"2020-03-26T17:08:00.580Z","updated_at":"2020-03-26T17:08:00.580Z","actor":{"username":"manuelpuyol","cleared":false,"url":"/manuelpuyol","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/VfzFcvm4ErT8x7ssyNePBtZv/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"qulture_rocks_x3u44","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7450437,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Sounds good, thanks.","markdown_message":"\u003cp\u003eSounds good, thanks.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-03-26T17:12:09.030Z","updated_at":"2020-03-26T17:12:09.030Z","actor":{"username":"wisp","cleared":false,"url":"/wisp","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/192/649/ba6a8f9a0d54ba3286c7ab13ca0b351db8f00c19_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"qulture_rocks_x3u44","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7460116,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hey @wisp \n\nSince the fix has been merged, I'm closing this report.\n\nAgain, thank you!","markdown_message":"\u003cp\u003eHey \u003ca href=\"/wisp\"\u003e@wisp\u003c/a\u003e \u003c/p\u003e\n\n\u003cp\u003eSince the fix has been merged, I\u0026#39;m closing this report.\u003c/p\u003e\n\n\u003cp\u003eAgain, thank you!\u003c/p\u003e\n","automated_response":false,"created_at":"2020-03-27T15:27:23.288Z","updated_at":"2020-03-27T15:27:23.288Z","actor":{"username":"manuelpuyol","cleared":false,"url":"/manuelpuyol","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/VfzFcvm4ErT8x7ssyNePBtZv/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"wisp","url":"/wisp"},"genius_execution_id":null,"team_handle":"qulture_rocks_x3u44","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8788069,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Can we disclose this?","markdown_message":"\u003cp\u003eCan we disclose this?\u003c/p\u003e\n","automated_response":false,"created_at":"2020-07-29T04:53:14.046Z","updated_at":"2020-07-29T04:53:14.046Z","first_to_agree":true,"actor":{"username":"wisp","cleared":false,"url":"/wisp","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/192/649/ba6a8f9a0d54ba3286c7ab13ca0b351db8f00c19_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"qulture_rocks_x3u44","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9062198,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-08-28T04:53:15.274Z","updated_at":"2020-08-28T04:53:15.274Z","actor":{"url":"/qulture_rocks_x3u44","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/041/772/40eefc9cc099800ed74a1faf2ae863ae1cccb0dc_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Qulture.Rocks"}},"genius_execution_id":null,"team_handle":"qulture_rocks_x3u44","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}