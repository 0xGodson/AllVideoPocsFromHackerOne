{"id":415258,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC80MTUyNTg=","url":"https://hackerone.com/reports/415258","title":"RCE: DnDing shortcut files to chrome://brave allows loading HTML files in Muon's context","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2018-09-27T11:45:41.134Z","submitted_at":"2018-09-27T11:45:41.134Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"metnew","url":"/metnew","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":15688,"url":"https://hackerone.com/brave","handle":"brave","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/015/688/2aad5641af643ee4f4402896e4747293f6e9c5ca_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/688/2aad5641af643ee4f4402896e4747293f6e9c5ca_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Brave Software","twitter_handle":"brave","website":"https://brave.com","about":""}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2018-10-22T20:12:43.978Z","bug_reporter_agreed_on_going_public_at":"2018-10-05T10:59:04.326Z","team_member_agreed_on_going_public_at":"2018-10-22T20:12:43.839Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"## Summary:\n\n\u003e \\#395737 has shown that Brave supports `chrome://brave/\u003clocal_file\u003e` URLs.\n\u003e The Brave team introduced a patch which blocks navigation to `chrome://brave` and removed `chrome.remote.require` to prevent command execution on the machine.\n\n### Navigation to `chrome://brave` via shortcut files\n\n\u003e ~~From my understanding:~~\n\n1. Brave allows DnDing files\n2. DnD of shortcut files is handled on Chromium-level (shortcut files : e.g., `.webloc` on macOS or `.desktop` on Linux) \n3. DnDing a shortcut =\u003e navigation to URL the file points to.\n\nThis approach allows navigating to `chrome://brave/` origin.\n\n#### Attack requirements\n\n- The victim has to dnd a shortcut file to a tab\n- Attacker needs **MITM** OR **local reflected XSS** OR an attacker-supplied **HTML file which absolute path** is known.\n\n\u003e MITM is the easiest way so far.\n\n### Local files reading\n\nYeah, reading local files from `chrome://brave` is possible.\nThe same PoC as in #390362, but the origin is `chrome://brave`:\n\n``` html\n\u003chead\u003e\n    \u003c!-- Local files reading --\u003e\n    \u003cscript\u003e\n        function show() {\n            var file = link.import.querySelector('body')\n            alert(file.innerHTML)\n        }\n    \u003c/script\u003e\n    \u003clink id=\"link\" onload=\"show()\" rel=\"import\" as=\"document\" href=\"chrome://brave/etc/passwd\"\u003e\n\u003c/head\u003e\n```\n\n### `ipcRender` and `ipcMain`\n\nHTML file loaded in `chrome://brave/` context has access to private APIs, like `ipcRenderer` and `ipcMain`:\n\n``` js\nlet ipcMain = chrome.remote.getBuiltin('ipcMain')\nlet ipcRenderer = chrome.ipcRenderer\n```\n\nSending arbitrary IPC commands -\u003e full control over the browser.\n**RCE through arbitrary IPC commands:** #188086 (includes PoC)\n\nImpact: UXSS, URL spoofing, changing browser settings, etc.\n\n### `chrome.remote.getBuiltin(module)`\n\nSending arbitrary IPC commands is a serious problem, but the impact isn't limited to it.\n\n`chrome.remote.getBuiltin(module)` returns `electron[module]`.\n``` js\n// Alias to remote.require('electron').xxx.\nbinding.getBuiltin = function (module) {\n  return metaToValue(ipcRenderer.sendSync('ELECTRON_BROWSER_GET_BUILTIN', module))\n}\n```\n\nIt's possible to leverage this func to obtain some \"hidden\" modules like `autoUpdater`, `Tray`, `protocol` and other.\n\n#### Running attacker's executables on machine (download `.terminal` via IPC + \u003clack-of-quarantine\u003e + `chrome.shell.openExternal`)\n\nIPC allows doing many damaging things and possibly running shell commands too.\n\nBut there is an alternative way for an RCE:\n1. IPC downloads a `.terminal` file from the web\n2. #374106 - `.terminal` files could execute shell commands without `-x` permission\n3. `chrome.remote.shell.openExternal` opens downloaded `.terminal` file\n4. Commands from `.terminal` get executed\n\n\u003e No PoC provided, since the impact is already apparent, but could make it if required\n\n#### Persistence\n\nI'm sure, it's clear for the Brave team that it allows an attacker to persist on the device via changing browser settings.\nHowever, I want to highlight that `chrome.remote.getBuiltin(module)` allows accessing `protocol` module, which allows:\n\n```js\nregisterBufferProtocol: (...)\nregisterHttpProtocol: (...)\nregisterNavigatorHandler: (...)\nregisterServiceWorkerSchemes: ƒ ()\nregisterStandardSchemes: (...)\nregisterStringProtocol: ƒ ()\n```\n\n### MITM in Brave\n\n- `chrome://brave` is always vulnerable to MITM even when HTTPSE is active\n- `file://` is vulnerable to MITM, when HTTPSE is inactive\n\n\u003e Not sure whether HTTPSE is turned on by default.\n\u003e As far as I know, HTTPS Everywhere isn't enabled by default.\n\n## Products affected: \n\nBrave: 0.24.0 \nV8: 6.9.427.23 \nrev: f657f15bf7e0e0c50a2b854c6b05edb59bfc556c \nMuon: 8.1.6 \nOS Release: 17.7.0 \nUpdate Channel: Release \nOS Architecture: x64 \nOS Platform: macOS \nNode.js: 7.9.0 \nBrave Sync: v1.4.2 \nlibchromiumcontent: 69.0.3497.100\n\n## Steps To Reproduce:\n\n### PoC for shortcut navigation\n\n1. Open any page in Brave\n2. DnD `etc-passwd.webloc` file to Brave\n3. Brave opens `chrome://brave/etc/passwd` showing `/etc/passwd` file in `chrome://brave` origin's context\n\n### Exploit (macOS)\n\n-1. Make sure to stop `httpd` on macOS\n0. Insert next line into your `/etc/hosts`: `127.0.0.1 maps.googleapis.com`\n1. `sudo node server.js` - starts MITM server\n2. Open any page in Brave\n3. DnD `exploit.webloc` file\n4. Opened page shows an alert with `/etc/passwd` contents + working `\u003cwebview\u003e` tag  + starts `Calculator.app`\n\n## Supporting Material/References:\n\nScreencast attached.\n\n## Impact\n\nA remote attacker with a MITM access (or specific conditions like reflected XSS on `file:///` origin) could send arbitrary IPC commands(trigger RCE) when a user drag-n-drops \ncrafted shortcut file into Brave.","vulnerability_information_html":"\u003ch2 id=\"summary\"\u003eSummary:\u003c/h2\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003e#395737 has shown that Brave supports \u003ccode\u003echrome://brave/\u0026lt;local_file\u0026gt;\u003c/code\u003e URLs.\u003cbr\u003e\nThe Brave team introduced a patch which blocks navigation to \u003ccode\u003echrome://brave\u003c/code\u003e and removed \u003ccode\u003echrome.remote.require\u003c/code\u003e to prevent command execution on the machine.\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003ch3 id=\"navigation-to-chrome-brave-via-shortcut-files\"\u003eNavigation to \u003ccode\u003echrome://brave\u003c/code\u003e via shortcut files\u003c/h3\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003e\u003cdel\u003eFrom my understanding:\u003c/del\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003col\u003e\n\u003cli\u003eBrave allows DnDing files\u003c/li\u003e\n\u003cli\u003eDnD of shortcut files is handled on Chromium-level (shortcut files : e.g., \u003ccode\u003e.webloc\u003c/code\u003e on macOS or \u003ccode\u003e.desktop\u003c/code\u003e on Linux) \u003c/li\u003e\n\u003cli\u003eDnDing a shortcut =\u0026gt; navigation to URL the file points to.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eThis approach allows navigating to \u003ccode\u003echrome://brave/\u003c/code\u003e origin.\u003c/p\u003e\n\n\u003ch4 id=\"attack-requirements\"\u003eAttack requirements\u003c/h4\u003e\n\n\u003cul\u003e\n\u003cli\u003eThe victim has to dnd a shortcut file to a tab\u003c/li\u003e\n\u003cli\u003eAttacker needs \u003cstrong\u003eMITM\u003c/strong\u003e OR \u003cstrong\u003elocal reflected XSS\u003c/strong\u003e OR an attacker-supplied \u003cstrong\u003eHTML file which absolute path\u003c/strong\u003e is known.\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eMITM is the easiest way so far.\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003ch3 id=\"local-files-reading\"\u003eLocal files reading\u003c/h3\u003e\n\n\u003cp\u003eYeah, reading local files from \u003ccode\u003echrome://brave\u003c/code\u003e is possible.\u003cbr\u003e\nThe same PoC as in \u003ca href=\"/reports/390362\"\u003e#390362\u003c/a\u003e, but the origin is \u003ccode\u003echrome://brave\u003c/code\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight html\"\u003e\u003ccode\u003e\u003cspan class=\"nt\"\u003e\u0026lt;head\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c\"\u003e\u0026lt;!-- Local files reading --\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"nt\"\u003e\u0026lt;script\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"kd\"\u003efunction\u003c/span\u003e \u003cspan class=\"nx\"\u003eshow\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003efile\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003elink\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"k\"\u003eimport\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003equerySelector\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003ebody\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"nx\"\u003ealert\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003efile\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003einnerHTML\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"nt\"\u003e\u0026lt;/script\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"nt\"\u003e\u0026lt;link\u003c/span\u003e \u003cspan class=\"na\"\u003eid=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;link\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003eonload=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;show()\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003erel=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;import\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003eas=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;document\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003ehref=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;chrome://brave/etc/passwd\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/head\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch3 id=\"ipcrender-and-ipcmain\"\u003e\n\u003ccode\u003eipcRender\u003c/code\u003e and \u003ccode\u003eipcMain\u003c/code\u003e\n\u003c/h3\u003e\n\n\u003cp\u003eHTML file loaded in \u003ccode\u003echrome://brave/\u003c/code\u003e context has access to private APIs, like \u003ccode\u003eipcRenderer\u003c/code\u003e and \u003ccode\u003eipcMain\u003c/code\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight javascript\"\u003e\u003ccode\u003e\u003cspan class=\"kd\"\u003elet\u003c/span\u003e \u003cspan class=\"nx\"\u003eipcMain\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003echrome\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eremote\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003egetBuiltin\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003eipcMain\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"kd\"\u003elet\u003c/span\u003e \u003cspan class=\"nx\"\u003eipcRenderer\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003echrome\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eipcRenderer\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eSending arbitrary IPC commands -\u0026gt; full control over the browser.\u003cbr\u003e\n\u003cstrong\u003eRCE through arbitrary IPC commands:\u003c/strong\u003e \u003ca href=\"/reports/188086\"\u003e#188086\u003c/a\u003e (includes PoC)\u003c/p\u003e\n\n\u003cp\u003eImpact: UXSS, URL spoofing, changing browser settings, etc.\u003c/p\u003e\n\n\u003ch3 id=\"chrome-remote-getbuiltin-module\"\u003e\u003ccode\u003echrome.remote.getBuiltin(module)\u003c/code\u003e\u003c/h3\u003e\n\n\u003cp\u003eSending arbitrary IPC commands is a serious problem, but the impact isn\u0026#39;t limited to it.\u003c/p\u003e\n\n\u003cp\u003e\u003ccode\u003echrome.remote.getBuiltin(module)\u003c/code\u003e returns \u003ccode\u003eelectron[module]\u003c/code\u003e.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight javascript\"\u003e\u003ccode\u003e\u003cspan class=\"c1\"\u003e// Alias to remote.require(\u0026#39;electron\u0026#39;).xxx.\u003c/span\u003e\n\u003cspan class=\"nx\"\u003ebinding\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003egetBuiltin\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"kd\"\u003efunction\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003emodule\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nx\"\u003emetaToValue\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eipcRenderer\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003esendSync\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003eELECTRON_BROWSER_GET_BUILTIN\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003emodule\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eIt\u0026#39;s possible to leverage this func to obtain some \u0026quot;hidden\u0026quot; modules like \u003ccode\u003eautoUpdater\u003c/code\u003e, \u003ccode\u003eTray\u003c/code\u003e, \u003ccode\u003eprotocol\u003c/code\u003e and other.\u003c/p\u003e\n\n\u003ch4 id=\"running-attacker-s-executables-on-machine-download-terminal-via-ipc-lack-of-quarantine-chrome-shell-openexternal\"\u003eRunning attacker\u0026#39;s executables on machine (download \u003ccode\u003e.terminal\u003c/code\u003e via IPC + \u0026lt;lack-of-quarantine\u0026gt; + \u003ccode\u003echrome.shell.openExternal\u003c/code\u003e)\u003c/h4\u003e\n\n\u003cp\u003eIPC allows doing many damaging things and possibly running shell commands too.\u003c/p\u003e\n\n\u003cp\u003eBut there is an alternative way for an RCE:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eIPC downloads a \u003ccode\u003e.terminal\u003c/code\u003e file from the web\u003c/li\u003e\n\u003cli\u003e#374106 - \u003ccode\u003e.terminal\u003c/code\u003e files could execute shell commands without \u003ccode\u003e-x\u003c/code\u003e permission\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003echrome.remote.shell.openExternal\u003c/code\u003e opens downloaded \u003ccode\u003e.terminal\u003c/code\u003e file\u003c/li\u003e\n\u003cli\u003eCommands from \u003ccode\u003e.terminal\u003c/code\u003e get executed\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eNo PoC provided, since the impact is already apparent, but could make it if required\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003ch4 id=\"persistence\"\u003ePersistence\u003c/h4\u003e\n\n\u003cp\u003eI\u0026#39;m sure, it\u0026#39;s clear for the Brave team that it allows an attacker to persist on the device via changing browser settings.\u003cbr\u003e\nHowever, I want to highlight that \u003ccode\u003echrome.remote.getBuiltin(module)\u003c/code\u003e allows accessing \u003ccode\u003eprotocol\u003c/code\u003e module, which allows:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight javascript\"\u003e\u003ccode\u003e\u003cspan class=\"nx\"\u003eregisterBufferProtocol\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e(...)\u003c/span\u003e\n\u003cspan class=\"nx\"\u003eregisterHttpProtocol\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e(...)\u003c/span\u003e\n\u003cspan class=\"nx\"\u003eregisterNavigatorHandler\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e(...)\u003c/span\u003e\n\u003cspan class=\"nx\"\u003eregisterServiceWorkerSchemes\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"err\"\u003eƒ\u003c/span\u003e \u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003cspan class=\"nx\"\u003eregisterStandardSchemes\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e(...)\u003c/span\u003e\n\u003cspan class=\"nx\"\u003eregisterStringProtocol\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"err\"\u003eƒ\u003c/span\u003e \u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch3 id=\"mitm-in-brave\"\u003eMITM in Brave\u003c/h3\u003e\n\n\u003cul\u003e\n\u003cli\u003e\n\u003ccode\u003echrome://brave\u003c/code\u003e is always vulnerable to MITM even when HTTPSE is active\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003efile://\u003c/code\u003e is vulnerable to MITM, when HTTPSE is inactive\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eNot sure whether HTTPSE is turned on by default.\u003cbr\u003e\nAs far as I know, HTTPS Everywhere isn\u0026#39;t enabled by default.\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003ch2 id=\"products-affected\"\u003eProducts affected:\u003c/h2\u003e\n\n\u003cp\u003eBrave: 0.24.0 \u003cbr\u003e\nV8: 6.9.427.23 \u003cbr\u003e\nrev: f657f15bf7e0e0c50a2b854c6b05edb59bfc556c \u003cbr\u003e\nMuon: 8.1.6 \u003cbr\u003e\nOS Release: 17.7.0 \u003cbr\u003e\nUpdate Channel: Release \u003cbr\u003e\nOS Architecture: x64 \u003cbr\u003e\nOS Platform: macOS \u003cbr\u003e\nNode.js: 7.9.0 \u003cbr\u003e\nBrave Sync: v1.4.2 \u003cbr\u003e\nlibchromiumcontent: 69.0.3497.100\u003c/p\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps To Reproduce:\u003c/h2\u003e\n\n\u003ch3 id=\"poc-for-shortcut-navigation\"\u003ePoC for shortcut navigation\u003c/h3\u003e\n\n\u003col\u003e\n\u003cli\u003eOpen any page in Brave\u003c/li\u003e\n\u003cli\u003eDnD \u003ccode\u003eetc-passwd.webloc\u003c/code\u003e file to Brave\u003c/li\u003e\n\u003cli\u003eBrave opens \u003ccode\u003echrome://brave/etc/passwd\u003c/code\u003e showing \u003ccode\u003e/etc/passwd\u003c/code\u003e file in \u003ccode\u003echrome://brave\u003c/code\u003e origin\u0026#39;s context\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003ch3 id=\"exploit-macos\"\u003eExploit (macOS)\u003c/h3\u003e\n\n\u003cp\u003e-1. Make sure to stop \u003ccode\u003ehttpd\u003c/code\u003e on macOS\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eInsert next line into your \u003ccode\u003e/etc/hosts\u003c/code\u003e: \u003ccode\u003e127.0.0.1 maps.googleapis.com\u003c/code\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003esudo node server.js\u003c/code\u003e - starts MITM server\u003c/li\u003e\n\u003cli\u003eOpen any page in Brave\u003c/li\u003e\n\u003cli\u003eDnD \u003ccode\u003eexploit.webloc\u003c/code\u003e file\u003c/li\u003e\n\u003cli\u003eOpened page shows an alert with \u003ccode\u003e/etc/passwd\u003c/code\u003e contents + working \u003ccode\u003e\u0026lt;webview\u0026gt;\u003c/code\u003e tag  + starts \u003ccode\u003eCalculator.app\u003c/code\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003ch2 id=\"supporting-material-references\"\u003eSupporting Material/References:\u003c/h2\u003e\n\n\u003cp\u003eScreencast attached.\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eA remote attacker with a MITM access (or specific conditions like reflected XSS on \u003ccode\u003efile:///\u003c/code\u003e origin) could send arbitrary IPC commands(trigger RCE) when a user drag-n-drops \u003cbr\u003e\ncrafted shortcut file into Brave.\u003c/p\u003e\n","bounty_amount":"300.0","formatted_bounty":"$300","original_report_id":null,"original_report_url":null,"attachments":[{"id":351834,"file_name":"chrome-brave.webloc","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/351/834/804c313a6327d0e076013f3ca18dcd90fd1eaa6d/chrome-brave.webloc?response-content-disposition=attachment%3B%20filename%3D%22chrome-brave.webloc%22%3B%20filename%2A%3DUTF-8%27%27chrome-brave.webloc\u0026response-content-type=application%2Foctet-stream\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ3VAHLH6Z%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T055422Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCD4BvSsKgWcuX7%2Fh3b1LWkKs9s4yRHAxqyVwXJYWsOAwIhANvLMyKSbceDyM1TNnWf11IvuT7a61DuFVJhD%2BT%2Fb9IrKrQDCFcQARoMMDEzNjE5Mjc0ODQ5Igxmi6woSxw%2B6wnwBEMqkQPI1uJcvWS%2B7FQadeW43PrlhsnF4xiGOroakbutVFcvcHOdYKgLxjIJI5m7XwadzbZWnWfHV0%2B62Zb%2BWCUOjMWiTVIXVX7AwYN1lfeKcXEYUp0h0oyXmZ8r9%2Bj%2FMZUagb%2BGKS%2B8zxvRdQjMX1tdjoDe9OxP6o1mlqEZpx8AKw7LDp1Hz2ezBoeya6X2GupABl%2FOhOfLY3VwJj7aPTg85UEwxOdZDtc%2FqzwALQiQUZo0A1RP3Y8nbzGb8CydaoFTXkp8rbJlMiimc%2BP%2BkZhbzJrdAs2rl68CFeUO2KSps4veGXWDFFoEAu1EvHwhAyOhkUlWXmX73VMyIVDvCkiHkuulKA8DiBfGp90UyI0AqLxJxXh%2FgCjGVxceHzAhM03UULwYdje89A1ziU5p%2BKL3KWD4xZiWFhlIiy3U92ksRt8S3l2NanthhEGEvTgf6wIclSsc9f4UbYnjYnAAiXkBg6iZTwORuQ0lVt30ma%2B%2BklzemkOgRIzghR66jzWcsjfvliY27ODm9Z12Vrj3LNetmm3XRTDEg6v%2FBTrqAb0W67QCovsIpNAiT4CujLyYV%2FjYmZ4VKcAok0lQwqZsNMCoze3egJJr5KwJfEhstOKt8adGE2Rfh5M%2BaAuxUHx9CHzHYR0HmUar1TnotcADpaizJlkcQmrsTfX3xtHVR8i9rhilHwmpYSeCQBjKHP%2BS656Uyq6ksGCrQWI4ZK%2F8QgDLIm%2FkIF6FlqRmaPtAeqfdwNxXQoCBcVLYgai%2FvmYu0CSd0Q1ngm%2FQMLqJqwYCLLmqTZrGYBRc5a553mtVqPYXlzc8Pgvjp59x%2Fjbix5wBt%2BoNg6EeSWNYAv4D0k4TzkJ4Aj8N%2BdAfag%3D%3D\u0026X-Amz-Signature=09eb07dc12368c435a92ec34da251c1f554fcd6343143a9f7b6732a7e2f0eaba","file_size":390,"type":"application/xml"},{"id":351835,"file_name":"etc-passwd.webloc","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/351/835/9363a6afd7a63a6928003e370f6943736a8cbfd9/etc-passwd.webloc?response-content-disposition=attachment%3B%20filename%3D%22etc-passwd.webloc%22%3B%20filename%2A%3DUTF-8%27%27etc-passwd.webloc\u0026response-content-type=application%2Foctet-stream\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ3VAHLH6Z%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T055422Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCD4BvSsKgWcuX7%2Fh3b1LWkKs9s4yRHAxqyVwXJYWsOAwIhANvLMyKSbceDyM1TNnWf11IvuT7a61DuFVJhD%2BT%2Fb9IrKrQDCFcQARoMMDEzNjE5Mjc0ODQ5Igxmi6woSxw%2B6wnwBEMqkQPI1uJcvWS%2B7FQadeW43PrlhsnF4xiGOroakbutVFcvcHOdYKgLxjIJI5m7XwadzbZWnWfHV0%2B62Zb%2BWCUOjMWiTVIXVX7AwYN1lfeKcXEYUp0h0oyXmZ8r9%2Bj%2FMZUagb%2BGKS%2B8zxvRdQjMX1tdjoDe9OxP6o1mlqEZpx8AKw7LDp1Hz2ezBoeya6X2GupABl%2FOhOfLY3VwJj7aPTg85UEwxOdZDtc%2FqzwALQiQUZo0A1RP3Y8nbzGb8CydaoFTXkp8rbJlMiimc%2BP%2BkZhbzJrdAs2rl68CFeUO2KSps4veGXWDFFoEAu1EvHwhAyOhkUlWXmX73VMyIVDvCkiHkuulKA8DiBfGp90UyI0AqLxJxXh%2FgCjGVxceHzAhM03UULwYdje89A1ziU5p%2BKL3KWD4xZiWFhlIiy3U92ksRt8S3l2NanthhEGEvTgf6wIclSsc9f4UbYnjYnAAiXkBg6iZTwORuQ0lVt30ma%2B%2BklzemkOgRIzghR66jzWcsjfvliY27ODm9Z12Vrj3LNetmm3XRTDEg6v%2FBTrqAb0W67QCovsIpNAiT4CujLyYV%2FjYmZ4VKcAok0lQwqZsNMCoze3egJJr5KwJfEhstOKt8adGE2Rfh5M%2BaAuxUHx9CHzHYR0HmUar1TnotcADpaizJlkcQmrsTfX3xtHVR8i9rhilHwmpYSeCQBjKHP%2BS656Uyq6ksGCrQWI4ZK%2F8QgDLIm%2FkIF6FlqRmaPtAeqfdwNxXQoCBcVLYgai%2FvmYu0CSd0Q1ngm%2FQMLqJqwYCLLmqTZrGYBRc5a553mtVqPYXlzc8Pgvjp59x%2Fjbix5wBt%2BoNg6EeSWNYAv4D0k4TzkJ4Aj8N%2BdAfag%3D%3D\u0026X-Amz-Signature=770ed3dfe15aaf5f870834abf15db7403704809e95fc0f02fb91580d1025e0f2","file_size":252,"type":"application/xml"},{"id":351836,"file_name":"server.js","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/351/836/8b471a1623caac3d53896a77829d410d28812d28/server.js?response-content-disposition=attachment%3B%20filename%3D%22server.js%22%3B%20filename%2A%3DUTF-8%27%27server.js\u0026response-content-type=text%2Fplain\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ3VAHLH6Z%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T055422Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCD4BvSsKgWcuX7%2Fh3b1LWkKs9s4yRHAxqyVwXJYWsOAwIhANvLMyKSbceDyM1TNnWf11IvuT7a61DuFVJhD%2BT%2Fb9IrKrQDCFcQARoMMDEzNjE5Mjc0ODQ5Igxmi6woSxw%2B6wnwBEMqkQPI1uJcvWS%2B7FQadeW43PrlhsnF4xiGOroakbutVFcvcHOdYKgLxjIJI5m7XwadzbZWnWfHV0%2B62Zb%2BWCUOjMWiTVIXVX7AwYN1lfeKcXEYUp0h0oyXmZ8r9%2Bj%2FMZUagb%2BGKS%2B8zxvRdQjMX1tdjoDe9OxP6o1mlqEZpx8AKw7LDp1Hz2ezBoeya6X2GupABl%2FOhOfLY3VwJj7aPTg85UEwxOdZDtc%2FqzwALQiQUZo0A1RP3Y8nbzGb8CydaoFTXkp8rbJlMiimc%2BP%2BkZhbzJrdAs2rl68CFeUO2KSps4veGXWDFFoEAu1EvHwhAyOhkUlWXmX73VMyIVDvCkiHkuulKA8DiBfGp90UyI0AqLxJxXh%2FgCjGVxceHzAhM03UULwYdje89A1ziU5p%2BKL3KWD4xZiWFhlIiy3U92ksRt8S3l2NanthhEGEvTgf6wIclSsc9f4UbYnjYnAAiXkBg6iZTwORuQ0lVt30ma%2B%2BklzemkOgRIzghR66jzWcsjfvliY27ODm9Z12Vrj3LNetmm3XRTDEg6v%2FBTrqAb0W67QCovsIpNAiT4CujLyYV%2FjYmZ4VKcAok0lQwqZsNMCoze3egJJr5KwJfEhstOKt8adGE2Rfh5M%2BaAuxUHx9CHzHYR0HmUar1TnotcADpaizJlkcQmrsTfX3xtHVR8i9rhilHwmpYSeCQBjKHP%2BS656Uyq6ksGCrQWI4ZK%2F8QgDLIm%2FkIF6FlqRmaPtAeqfdwNxXQoCBcVLYgai%2FvmYu0CSd0Q1ngm%2FQMLqJqwYCLLmqTZrGYBRc5a553mtVqPYXlzc8Pgvjp59x%2Fjbix5wBt%2BoNg6EeSWNYAv4D0k4TzkJ4Aj8N%2BdAfag%3D%3D\u0026X-Amz-Signature=d978bfd540faf059affd925e4d637f600c842478439bae05d909cfc563a05060","file_size":1131,"type":"text/plain"},{"id":351837,"file_name":"brave-dnd-shortcut-chrome-brave-origin.mp4","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/351/837/48296aa0279a3bd3af265ebb0e66f8beaf17b388/brave-dnd-shortcut-chrome-brave-origin.mp4?response-content-disposition=attachment%3B%20filename%3D%22brave-dnd-shortcut-chrome-brave-origin.mp4%22%3B%20filename%2A%3DUTF-8%27%27brave-dnd-shortcut-chrome-brave-origin.mp4\u0026response-content-type=video%2Fmp4\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ3VAHLH6Z%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T055422Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCD4BvSsKgWcuX7%2Fh3b1LWkKs9s4yRHAxqyVwXJYWsOAwIhANvLMyKSbceDyM1TNnWf11IvuT7a61DuFVJhD%2BT%2Fb9IrKrQDCFcQARoMMDEzNjE5Mjc0ODQ5Igxmi6woSxw%2B6wnwBEMqkQPI1uJcvWS%2B7FQadeW43PrlhsnF4xiGOroakbutVFcvcHOdYKgLxjIJI5m7XwadzbZWnWfHV0%2B62Zb%2BWCUOjMWiTVIXVX7AwYN1lfeKcXEYUp0h0oyXmZ8r9%2Bj%2FMZUagb%2BGKS%2B8zxvRdQjMX1tdjoDe9OxP6o1mlqEZpx8AKw7LDp1Hz2ezBoeya6X2GupABl%2FOhOfLY3VwJj7aPTg85UEwxOdZDtc%2FqzwALQiQUZo0A1RP3Y8nbzGb8CydaoFTXkp8rbJlMiimc%2BP%2BkZhbzJrdAs2rl68CFeUO2KSps4veGXWDFFoEAu1EvHwhAyOhkUlWXmX73VMyIVDvCkiHkuulKA8DiBfGp90UyI0AqLxJxXh%2FgCjGVxceHzAhM03UULwYdje89A1ziU5p%2BKL3KWD4xZiWFhlIiy3U92ksRt8S3l2NanthhEGEvTgf6wIclSsc9f4UbYnjYnAAiXkBg6iZTwORuQ0lVt30ma%2B%2BklzemkOgRIzghR66jzWcsjfvliY27ODm9Z12Vrj3LNetmm3XRTDEg6v%2FBTrqAb0W67QCovsIpNAiT4CujLyYV%2FjYmZ4VKcAok0lQwqZsNMCoze3egJJr5KwJfEhstOKt8adGE2Rfh5M%2BaAuxUHx9CHzHYR0HmUar1TnotcADpaizJlkcQmrsTfX3xtHVR8i9rhilHwmpYSeCQBjKHP%2BS656Uyq6ksGCrQWI4ZK%2F8QgDLIm%2FkIF6FlqRmaPtAeqfdwNxXQoCBcVLYgai%2FvmYu0CSd0Q1ngm%2FQMLqJqwYCLLmqTZrGYBRc5a553mtVqPYXlzc8Pgvjp59x%2Fjbix5wBt%2BoNg6EeSWNYAv4D0k4TzkJ4Aj8N%2BdAfag%3D%3D\u0026X-Amz-Signature=118fad9a51566bb75188dfbf3ef1afb76d1a493b5657971fac91dc5e047ccdcc","file_size":1706610,"type":"video/mp4"}],"allow_singular_disclosure_at":null,"vote_count":16,"voters":["kapytein","spam404","sameerphad72","metnew","w2w","mygf","tungpun","eveeez","an0nym0us","kunal94","and 6 more..."],"severity":{"rating":"high","score":8.3,"author_type":"User","metrics":{"attack_vector":"network","attack_complexity":"high","privileges_required":"none","user_interaction":"required","scope":"changed","confidentiality":"high","integrity":"high","availability":"none"}},"structured_scope":{"databaseId":7941,"asset_type":"SOURCE_CODE","asset_identifier":"https://github.com/brave/muon","max_severity":"none"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":3397382,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"## DnDing links from other apps works too!\n\nThis vector is much more dangerous for sure.\nNo shortcut files required.\n\n1. Send `chrome://brave/etc/passwd` link via `Mail.app`\n2. Dnd this link to Brave\n3. `chrome://brave/etc/passwd`!","markdown_message":"\u003ch2 id=\"dnding-links-from-other-apps-works-too\"\u003eDnDing links from other apps works too!\u003c/h2\u003e\n\n\u003cp\u003eThis vector is much more dangerous for sure.\u003cbr\u003e\nNo shortcut files required.\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eSend \u003ccode\u003echrome://brave/etc/passwd\u003c/code\u003e link via \u003ccode\u003eMail.app\u003c/code\u003e\n\u003c/li\u003e\n\u003cli\u003eDnd this link to Brave\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003echrome://brave/etc/passwd\u003c/code\u003e!\u003c/li\u003e\n\u003c/ol\u003e\n","automated_response":false,"created_at":"2018-09-27T15:23:45.609Z","updated_at":"2018-09-27T15:23:45.609Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":351927,"filename":"chrome-dnd-link-from-another-app.mp4","type":"video/mp4","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/351/927/59e0b5875ef0946bc57c731d914ec66554494d07/chrome-dnd-link-from-another-app.mp4?response-content-disposition=attachment%3B%20filename%3D%22chrome-dnd-link-from-another-app.mp4%22%3B%20filename%2A%3DUTF-8%27%27chrome-dnd-link-from-another-app.mp4\u0026response-content-type=video%2Fmp4\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ3VAHLH6Z%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T055422Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCD4BvSsKgWcuX7%2Fh3b1LWkKs9s4yRHAxqyVwXJYWsOAwIhANvLMyKSbceDyM1TNnWf11IvuT7a61DuFVJhD%2BT%2Fb9IrKrQDCFcQARoMMDEzNjE5Mjc0ODQ5Igxmi6woSxw%2B6wnwBEMqkQPI1uJcvWS%2B7FQadeW43PrlhsnF4xiGOroakbutVFcvcHOdYKgLxjIJI5m7XwadzbZWnWfHV0%2B62Zb%2BWCUOjMWiTVIXVX7AwYN1lfeKcXEYUp0h0oyXmZ8r9%2Bj%2FMZUagb%2BGKS%2B8zxvRdQjMX1tdjoDe9OxP6o1mlqEZpx8AKw7LDp1Hz2ezBoeya6X2GupABl%2FOhOfLY3VwJj7aPTg85UEwxOdZDtc%2FqzwALQiQUZo0A1RP3Y8nbzGb8CydaoFTXkp8rbJlMiimc%2BP%2BkZhbzJrdAs2rl68CFeUO2KSps4veGXWDFFoEAu1EvHwhAyOhkUlWXmX73VMyIVDvCkiHkuulKA8DiBfGp90UyI0AqLxJxXh%2FgCjGVxceHzAhM03UULwYdje89A1ziU5p%2BKL3KWD4xZiWFhlIiy3U92ksRt8S3l2NanthhEGEvTgf6wIclSsc9f4UbYnjYnAAiXkBg6iZTwORuQ0lVt30ma%2B%2BklzemkOgRIzghR66jzWcsjfvliY27ODm9Z12Vrj3LNetmm3XRTDEg6v%2FBTrqAb0W67QCovsIpNAiT4CujLyYV%2FjYmZ4VKcAok0lQwqZsNMCoze3egJJr5KwJfEhstOKt8adGE2Rfh5M%2BaAuxUHx9CHzHYR0HmUar1TnotcADpaizJlkcQmrsTfX3xtHVR8i9rhilHwmpYSeCQBjKHP%2BS656Uyq6ksGCrQWI4ZK%2F8QgDLIm%2FkIF6FlqRmaPtAeqfdwNxXQoCBcVLYgai%2FvmYu0CSd0Q1ngm%2FQMLqJqwYCLLmqTZrGYBRc5a553mtVqPYXlzc8Pgvjp59x%2Fjbix5wBt%2BoNg6EeSWNYAv4D0k4TzkJ4Aj8N%2BdAfag%3D%3D\u0026X-Amz-Signature=518e37da37c17a9385f5947121be548a12e17c6d86d1e72b1ddfa10f6e1d3372"}],"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3398376,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"triaged to https://github.com/brave/browser-laptop/issues/15237","markdown_message":"\u003cp\u003etriaged to \u003ca title=\"https://github.com/brave/browser-laptop/issues/15237\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fbrave%2Fbrowser-laptop%2Fissues%2F15237\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/brave/browser-laptop/issues/15237\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2018-09-27T18:37:42.314Z","updated_at":"2018-09-27T18:37:42.314Z","actor":{"username":"diracdeltas","cleared":false,"url":"/diracdeltas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/115/616/4e2016543ea3e299dcadd088be7d0225de3419e0_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3399263,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I don't know what's behind #415178, however, I had reported this issue 3 days ago on Twitter, before #395737 was disclosed (in case of a duplicate)","markdown_message":"\u003cp\u003eI don\u0026#39;t know what\u0026#39;s behind \u003ca href=\"/reports/415178\"\u003e#415178\u003c/a\u003e, however, I had reported this issue 3 days ago on Twitter, before \u003ca href=\"/reports/395737\"\u003e#395737\u003c/a\u003e was disclosed (in case of a duplicate)\u003c/p\u003e\n","automated_response":false,"created_at":"2018-09-27T21:50:20.193Z","updated_at":"2018-09-27T21:50:53.829Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3402923,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@metnew the other issues is `'chrome://brave' can be navigated to using the middle mouse click (or normal click with CTRL held) IFF coming from a bookmark.` and then later the reporter realized that it can also be navigated via DnD. we will award for both but the fix is probably the same.","markdown_message":"\u003cp\u003e\u003ca href=\"/metnew\"\u003e@metnew\u003c/a\u003e the other issues is \u003ccode\u003e\u0026#39;chrome://brave\u0026#39; can be navigated to using the middle mouse click (or normal click with CTRL held) IFF coming from a bookmark.\u003c/code\u003e and then later the reporter realized that it can also be navigated via DnD. we will award for both but the fix is probably the same.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-09-28T18:15:32.923Z","updated_at":"2018-09-28T18:15:32.923Z","actor":{"username":"diracdeltas","cleared":false,"url":"/diracdeltas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/115/616/4e2016543ea3e299dcadd088be7d0225de3419e0_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3429422,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"i couldn't repro the STR using the .webloc files on macOS. brave opened 2 error pages + the contents of the webloc file, not /etc/passwd.","markdown_message":"\u003cp\u003ei couldn\u0026#39;t repro the STR using the .webloc files on macOS. brave opened 2 error pages + the contents of the webloc file, not /etc/passwd.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-10-03T18:26:28.130Z","updated_at":"2018-10-03T18:26:28.130Z","actor":{"username":"diracdeltas","cleared":false,"url":"/diracdeltas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/115/616/4e2016543ea3e299dcadd088be7d0225de3419e0_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3429427,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Did you use DnD?\n~~What does STR mean?~~","markdown_message":"\u003cp\u003eDid you use DnD?\u003cbr\u003e\n\u003cdel\u003eWhat does STR mean?\u003c/del\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2018-10-03T18:28:57.684Z","updated_at":"2018-10-03T18:34:12.748Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3429456,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@metnew yes i did drag and drop\n\ncan you check out this PR and see if it fixes it for you? https://github.com/brave/browser-laptop/pull/15261","markdown_message":"\u003cp\u003e\u003ca href=\"/metnew\"\u003e@metnew\u003c/a\u003e yes i did drag and drop\u003c/p\u003e\n\n\u003cp\u003ecan you check out this PR and see if it fixes it for you? \u003ca title=\"https://github.com/brave/browser-laptop/pull/15261\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fbrave%2Fbrowser-laptop%2Fpull%2F15261\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/brave/browser-laptop/pull/15261\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2018-10-03T18:34:51.190Z","updated_at":"2018-10-03T18:34:51.190Z","actor":{"username":"diracdeltas","cleared":false,"url":"/diracdeltas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/115/616/4e2016543ea3e299dcadd088be7d0225de3419e0_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3429463,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Ooh, I removed sources a few days ago :(\nOk, I'll check","markdown_message":"\u003cp\u003eOoh, I removed sources a few days ago :(\u003cbr\u003e\nOk, I\u0026#39;ll check\u003c/p\u003e\n","automated_response":false,"created_at":"2018-10-03T18:36:45.663Z","updated_at":"2018-10-03T18:38:33.959Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3430806,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@diracdeltas \n1. Cloned `master` =\u003e Navigation to `chrome://brave` via DnD works for me.\n2. I discovered why DnD works as file viewer for you =\u003e `.webloc` file is probably corrupted. e.g. a space char in \"URL\" key exists\n3. Switched to the branch with fix =\u003e navigation to `chrome://brave` doesn't work\n\nHowever, I have a suggestion for you: `details.url.startsWith('chrome://brave')`. \nMaybe it'd better switching to `indexOf` or similar? \nI saw some cases where a null byte at the beginning of the string allowed to bypass such checks. (UXSS in Webkit in 2013 via `%01javascript:` URI)\nI guess, it's more robust and navigation to `%00chrome://brave`(and similar) will be considered as invalid.\n\n~~`details.url` might be already sanitized before this check, I don't know~~","markdown_message":"\u003cp\u003e\u003ca href=\"/diracdeltas\"\u003e@diracdeltas\u003c/a\u003e \u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eCloned \u003ccode\u003emaster\u003c/code\u003e =\u0026gt; Navigation to \u003ccode\u003echrome://brave\u003c/code\u003e via DnD works for me.\u003c/li\u003e\n\u003cli\u003eI discovered why DnD works as file viewer for you =\u0026gt; \u003ccode\u003e.webloc\u003c/code\u003e file is probably corrupted. e.g. a space char in \u0026quot;URL\u0026quot; key exists\u003c/li\u003e\n\u003cli\u003eSwitched to the branch with fix =\u0026gt; navigation to \u003ccode\u003echrome://brave\u003c/code\u003e doesn\u0026#39;t work\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eHowever, I have a suggestion for you: \u003ccode\u003edetails.url.startsWith(\u0026#39;chrome://brave\u0026#39;)\u003c/code\u003e. \u003cbr\u003e\nMaybe it\u0026#39;d better switching to \u003ccode\u003eindexOf\u003c/code\u003e or similar? \u003cbr\u003e\nI saw some cases where a null byte at the beginning of the string allowed to bypass such checks. (UXSS in Webkit in 2013 via \u003ccode\u003e%01javascript:\u003c/code\u003e URI)\u003cbr\u003e\nI guess, it\u0026#39;s more robust and navigation to \u003ccode\u003e%00chrome://brave\u003c/code\u003e(and similar) will be considered as invalid.\u003c/p\u003e\n\n\u003cp\u003e\u003cdel\u003e\u003ccode\u003edetails.url\u003c/code\u003e might be already sanitized before this check, I don\u0026#39;t know\u003c/del\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2018-10-03T21:31:16.534Z","updated_at":"2018-10-03T21:36:22.052Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3431552,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"\u003e Attached `webloc` files are well formatted, maybe it happens because of your custom settings","markdown_message":"\u003cblockquote\u003e\n\u003cp\u003eAttached \u003ccode\u003ewebloc\u003c/code\u003e files are well formatted, maybe it happens because of your custom settings\u003c/p\u003e\n\u003c/blockquote\u003e\n","automated_response":false,"created_at":"2018-10-03T22:21:45.881Z","updated_at":"2018-10-03T22:21:45.881Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3431715,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"chromium does some kind of normalization on the URL (for instance it is always lowercase) but no harm in changing it to be more strict","markdown_message":"\u003cp\u003echromium does some kind of normalization on the URL (for instance it is always lowercase) but no harm in changing it to be more strict\u003c/p\u003e\n","automated_response":false,"created_at":"2018-10-03T23:57:51.075Z","updated_at":"2018-10-03T23:57:51.075Z","actor":{"username":"diracdeltas","cleared":false,"url":"/diracdeltas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/115/616/4e2016543ea3e299dcadd088be7d0225de3419e0_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3431781,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"going to award 300 each to this and https://hackerone.com/reports/415178 since they are basically the same issue and both have some high attack requirements (like needing MITM and convincing user to DnD a shortcut file)","markdown_message":"\u003cp\u003egoing to award 300 each to this and \u003ca title=\"https://hackerone.com/reports/415178\" href=\"https://hackerone.com/reports/415178\"\u003ehttps://hackerone.com/reports/415178\u003c/a\u003e since they are basically the same issue and both have some high attack requirements (like needing MITM and convincing user to DnD a shortcut file)\u003c/p\u003e\n","automated_response":false,"created_at":"2018-10-04T00:21:12.042Z","updated_at":"2018-10-04T00:21:12.042Z","actor":{"url":"/brave","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/688/2aad5641af643ee4f4402896e4747293f6e9c5ca_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Brave Software"}},"bounty_amount":"300.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"brave","collaborator":{"username":"metnew","url":"/metnew"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3431802,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Great, thanks @brave!","markdown_message":"\u003cp\u003eGreat, thanks \u003ca href=\"/brave\"\u003e@brave\u003c/a\u003e!\u003c/p\u003e\n","automated_response":false,"created_at":"2018-10-04T00:39:16.627Z","updated_at":"2018-10-04T00:39:16.627Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3437315,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"closing since https://github.com/brave/browser-laptop/pull/15261/ was merged","markdown_message":"\u003cp\u003eclosing since \u003ca title=\"https://github.com/brave/browser-laptop/pull/15261/\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fbrave%2Fbrowser-laptop%2Fpull%2F15261%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/brave/browser-laptop/pull/15261/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e was merged\u003c/p\u003e\n","automated_response":false,"created_at":"2018-10-05T05:27:47.624Z","updated_at":"2018-10-05T05:27:47.624Z","actor":{"username":"diracdeltas","cleared":false,"url":"/diracdeltas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/115/616/4e2016543ea3e299dcadd088be7d0225de3419e0_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"metnew","url":"/metnew"},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3438372,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"May we disclose it once the fix will be deployed? @diracdeltas ","markdown_message":"\u003cp\u003eMay we disclose it once the fix will be deployed? \u003ca href=\"/diracdeltas\"\u003e@diracdeltas\u003c/a\u003e \u003c/p\u003e\n","automated_response":false,"created_at":"2018-10-05T10:59:04.344Z","updated_at":"2018-10-05T10:59:04.344Z","first_to_agree":true,"actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3506171,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @diracdeltas, maybe let's disclose this bug? 2 weeks passed","markdown_message":"\u003cp\u003eHi \u003ca href=\"/diracdeltas\"\u003e@diracdeltas\u003c/a\u003e, maybe let\u0026#39;s disclose this bug? 2 weeks passed\u003c/p\u003e\n","automated_response":false,"created_at":"2018-10-20T00:19:26.552Z","updated_at":"2018-10-20T00:19:26.552Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3516176,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"We normally count two weeks from the date that the release has been available for download. I think that today marks that two-week mark for 0.25.2, so public it is.","markdown_message":"\u003cp\u003eWe normally count two weeks from the date that the release has been available for download. I think that today marks that two-week mark for 0.25.2, so public it is.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-10-22T20:12:37.502Z","updated_at":"2018-10-22T20:12:37.502Z","actor":{"username":"toml","cleared":false,"url":"/toml","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/229/717/56ea9edd04176aa3f29b215291bbc0b656699f67_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3516177,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-10-22T20:12:43.863Z","updated_at":"2018-10-22T20:12:43.863Z","actor":{"username":"toml","cleared":false,"url":"/toml","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/229/717/56ea9edd04176aa3f29b215291bbc0b656699f67_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3516178,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-10-22T20:12:43.999Z","updated_at":"2018-10-22T20:12:43.999Z","actor":{"username":"toml","cleared":false,"url":"/toml","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/229/717/56ea9edd04176aa3f29b215291bbc0b656699f67_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}