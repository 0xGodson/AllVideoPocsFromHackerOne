{"id":682344,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC82ODIzNDQ=","url":"https://hackerone.com/reports/682344","title":"Parameter tampering : Price Manipulation of Products","state":"Closed","substate":"duplicate","readable_substate":"Duplicate","created_at":"2019-08-26T19:17:18.147Z","submitted_at":"2019-08-26T19:17:18.147Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"ashketchum","url":"/ashketchum","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/HhqEvNTgFpUigyZa7YmFXjRm/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":55,"url":"https://hackerone.com/wordpress","handle":"wordpress","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/055/f114d1d31f904e3b903cd99a6cf566bb531f8401_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/055/f114d1d31f904e3b903cd99a6cf566bb531f8401_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"WordPress","twitter_handle":"wordpress","website":"https://wordpress.org/","about":"Beautiful sites of any kind."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2019-08-29T15:39:07.475Z","bug_reporter_agreed_on_going_public_at":"2019-08-27T00:48:43.899Z","team_member_agreed_on_going_public_at":"2019-08-29T15:39:07.407Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hello Security Team,\nI have found that you can buy any products in less amount or even we can say as free by changing the price of the product!!\n\nPOC : \n1) go to https://mercantile.wordpress.org/\n2) choose any product and add to cart\n3) Now go to cart add your billing details \n4) Intercept request with burpsuite and click on Proceed to Paypal\n5) You will get the following request\n\nREQUEST :\n\nGET /cgi-bin/webscr?cmd=_cart\u0026business=payments%40hellomerch.com\u0026no_note=1\u0026currency_code=USD\u0026charset=utf-8\u0026rm=2\u0026upload=1\u0026return=https%3A%2F%2Fmercantile.wordpress.org%2Fcheckout%2Forder-received%2F10446%2F%3Fkey%3Dwc_order_5d642e2e80f33%26utm_nooverride%3D1\u0026cancel_return=https%3A%2F%2Fmercantile.wordpress.org%2Fcart%2F%3Fcancel_order%3Dtrue%26order%3Dwc_order_5d642e2e80f33%26order_id%3D10446%26redirect%26_wpnonce%3Def9aba5f0f\u0026page_style=\u0026image_url=\u0026paymentaction=sale\u0026bn=WooThemes_Cart\u0026invoice=WP-10446\u0026custom=%7B%22order_id%22%3A10446%2C%22order_key%22%3A%22wc_order_5d642e2e80f33%22%7D\u0026notify_url=https%3A%2F%2Fmercantile.wordpress.org%2Fwc-api%2FWC_Gateway_Paypal%2F\u0026first_name=ASHISH\u0026last_name=DHONE\u0026address1=I2IT+BOYS+HOSTEL+HINJAWADI+OPPOSITE+SYMBIOSIS+COLLEGE\u0026address2=xss\u0026city=PUNE\u0026state=Maharashtra\u0026zip=411057\u0026country=IN\u0026email=ha5ckdangerous5%40gmail.com\u0026night_phone_b=7385711194\u0026no_shipping=1\u0026tax_cart=0.00\u0026shipping_1=\u003c\u003cVULNERABLE PARAMETER\u003e\u003e\u0026item_name_1=WordCamp+US+2018+T-Shirt+-+Women%27s+SM\u0026quantity_1=1\u0026amount_1=\u003c\u003cVULNERABLE PARAMETER\u003e\u003e\u0026item_number_1=WP-WORDCAMPUS2018NAVY-WSM-05-106-B HTTP/1.1\nHost: www.paypal.com\nConnection: close\nUpgrade-Insecure-Requests: 1\nUser-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/73.0.3683.103 Safari/537.36\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3\nReferer: https://mercantile.wordpress.org/checkout/\nAccept-Encoding: gzip, deflate\nAccept-Language: en-GB,en-US;q=0.9,en;q=0.8,hi;q=0.7\n\n\nNow here in this request we have two VULNERABLE PARAMETER as :\n1) shipping_1\n2) amount_1\n\nNow you change amount to this parameter and forward the request .. you will be able to order the product for less price or even Free using Paypal !!\n\nI have attached POC Video, Please take a look!!\n\nThank You!!\nAshish Dhone\n\n## Impact\n\nThe attacker can reduce the price of the order and make a financial loss!!","vulnerability_information_html":"\u003cp\u003eHello Security Team,\u003cbr\u003e\nI have found that you can buy any products in less amount or even we can say as free by changing the price of the product!!\u003c/p\u003e\n\n\u003cp\u003ePOC : \u003cbr\u003e\n1) go to \u003ca title=\"https://mercantile.wordpress.org/\" href=\"/redirect?url=https%3A%2F%2Fmercantile.wordpress.org%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://mercantile.wordpress.org/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\n2) choose any product and add to cart\u003cbr\u003e\n3) Now go to cart add your billing details \u003cbr\u003e\n4) Intercept request with burpsuite and click on Proceed to Paypal\u003cbr\u003e\n5) You will get the following request\u003c/p\u003e\n\n\u003cp\u003eREQUEST :\u003c/p\u003e\n\n\u003cp\u003eGET /cgi-bin/webscr?cmd=_cart\u0026amp;business=payments%40hellomerch.com\u0026amp;no_note=1\u0026amp;currency_code=USD\u0026amp;charset=utf-8\u0026amp;rm=2\u0026amp;upload=1\u0026amp;return=https%3A%2F%2Fmercantile.wordpress.org%2Fcheckout%2Forder-received%2F10446%2F%3Fkey%3Dwc_order_5d642e2e80f33%26utm_nooverride%3D1\u0026amp;cancel_return=https%3A%2F%2Fmercantile.wordpress.org%2Fcart%2F%3Fcancel_order%3Dtrue%26order%3Dwc_order_5d642e2e80f33%26order_id%3D10446%26redirect%26_wpnonce%3Def9aba5f0f\u0026amp;page_style=\u0026amp;image_url=\u0026amp;paymentaction=sale\u0026amp;bn=WooThemes_Cart\u0026amp;invoice=WP-10446\u0026amp;custom=%7B%22order_id%22%3A10446%2C%22order_key%22%3A%22wc_order_5d642e2e80f33%22%7D\u0026amp;notify_url=https%3A%2F%2Fmercantile.wordpress.org%2Fwc-api%2FWC_Gateway_Paypal%2F\u0026amp;first_name=ASHISH\u0026amp;last_name=DHONE\u0026amp;address1=I2IT+BOYS+HOSTEL+HINJAWADI+OPPOSITE+SYMBIOSIS+COLLEGE\u0026amp;address2=xss\u0026amp;city=PUNE\u0026amp;state=Maharashtra\u0026amp;zip=411057\u0026amp;country=IN\u0026amp;email=ha5ckdangerous5%40gmail.com\u0026amp;night_phone_b=7385711194\u0026amp;no_shipping=1\u0026amp;tax_cart=0.00\u0026amp;shipping_1=\u0026lt;\u0026lt;VULNERABLE PARAMETER\u0026gt;\u0026gt;\u0026amp;item_name_1=WordCamp+US+2018+T-Shirt+-+Women%27s+SM\u0026amp;quantity_1=1\u0026amp;amount_1=\u0026lt;\u0026lt;VULNERABLE PARAMETER\u0026gt;\u0026gt;\u0026amp;item_number_1=WP-WORDCAMPUS2018NAVY-WSM-05-106-B HTTP/1.1\u003cbr\u003e\nHost: \u003ca href=\"/redirect?url=http%3A%2F%2Fwww.paypal.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ewww.paypal.com\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nConnection: close\u003cbr\u003e\nUpgrade-Insecure-Requests: 1\u003cbr\u003e\nUser-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/73.0.3683.103 Safari/537.36\u003cbr\u003e\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,\u003cem\u003e/\u003c/em\u003e;q=0.8,application/signed-exchange;v=b3\u003cbr\u003e\nReferer: \u003ca title=\"https://mercantile.wordpress.org/checkout/\" href=\"/redirect?url=https%3A%2F%2Fmercantile.wordpress.org%2Fcheckout%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://mercantile.wordpress.org/checkout/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nAccept-Encoding: gzip, deflate\u003cbr\u003e\nAccept-Language: en-GB,en-US;q=0.9,en;q=0.8,hi;q=0.7\u003c/p\u003e\n\n\u003cp\u003eNow here in this request we have two VULNERABLE PARAMETER as :\u003cbr\u003e\n1) shipping_1\u003cbr\u003e\n2) amount_1\u003c/p\u003e\n\n\u003cp\u003eNow you change amount to this parameter and forward the request .. you will be able to order the product for less price or even Free using Paypal !!\u003c/p\u003e\n\n\u003cp\u003eI have attached POC Video, Please take a look!!\u003c/p\u003e\n\n\u003cp\u003eThank You!!\u003cbr\u003e\nAshish Dhone\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eThe attacker can reduce the price of the order and make a financial loss!!\u003c/p\u003e\n","weakness":{"id":65,"name":"Business Logic Errors"},"original_report_id":271585,"original_report_url":"https://hackerone.com/reports/271585","attachments":[{"id":567164,"file_name":"POC.mkv","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/oSKeXbWyeCJtEYrhSLksNnEp?response-content-disposition=attachment%3B%20filename%3D%22POC.mkv%22%3B%20filename%2A%3DUTF-8%27%27POC.mkv\u0026response-content-type=video%2Fx-matroska\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ6NMQGJ6E%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T063729Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCJPJ3IXoQNPAbQsg0bSSDfaJAZgsDgYrylclk1ric%2BkwIgDMmyHsdGD2jlH3d3dln%2FDB9m9n5i6VO9V2BpF6r0awgqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDCkjwEt6QlasbvM7ZiqRA8ipmJh0c%2Fct0msibE3n%2BnRShysnYAR7o%2FZb%2FNOpmlF41MYM4vnJx%2BKnhTDzjqB75T669Dmp%2FumbZJRIrhxgKJdSS92b6LQmv9XRjqyLPfQsEclw5qtwUJW48f0o0jPTkAA4Oc%2BOTznto%2FOC5dkeM5uzkchKTgv5sWyez3jHbO7YDmRMySDgSE0WkHBXhPZQyAnXHSKzrXWN4GxrsWDdDySlVvWJsjrqXJKYAL2xPI5%2FjSILjkUZ9kuALSA0BMOHlFfmOR9rXay9ZlJsKpIxq9W0g1cPU3rH2nhREBGoWjmO0zL5UzdA7mwH0emOB4l8od6kgtXvLqzikrqRZmjMafaJ4rwl7m%2F7kPi1mAWR01Xv4I7g6KRnBZoinRfFyi2aIRNmob0mp4O8dYWiI1UFCKekGmxdeEXsT%2B%2FfnOI6%2FAtmxCqBeZUB9WYcY7kMDIvIEvzHxMtG1QwLQB%2BkEanZgNJjUMVu%2BvkfnJq5ZFHRe1C33%2Bq7yApHokLx%2FpLKVFcbwIWj3IdU3SreS0T7b9NvUTUDMJrwqv8FOusBw2IadTH8jjyfIyLkG4%2BNkdrwzFLtfIjsHPdVpCkbbFU1ZYFUCT0auJmrX%2FxO31nzBV099ZiTIwmiaOXiEjREOeewBAYJIv2hxCC3PImV9Eo0xANYmEhG2QXnopWMla2LfC9A6LxCjHun0xukJwsfGjUNY%2BDMADaaUMtUItG63%2FF90r5a633HiieX5u6juKS9PEtljaKdlyfR86kZEzrXCfQmIoLh2OFdNeX0ArfbPO0PDWdVEi5auyGRhX3N1wchgL501NrEkDSpnVLS%2BEE5kKFufTTZUhelsnV4VtqdHW410LhjtT2ub2vVDA%3D%3D\u0026X-Amz-Signature=d77379e8a656d88ddcfcd64d86012ce58f5fc9f779ef8db55c29e4c3cdc9cb66","file_size":8292935,"type":"video/x-matroska"}],"allow_singular_disclosure_at":null,"vote_count":2,"voters":["sameerphad72","danerh"],"structured_scope":{"databaseId":2758,"asset_type":"URL","asset_identifier":"mercantile.wordpress.org","max_severity":"medium"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":5669772,"is_internal":false,"editable":false,"type":"Activities::BugDuplicate","message":"Hi Ashish, this is a known behavior of WooCommerce, but it doesn't actually allow you to change the price; it only appears that way. IPN validation occurs after the order is placed, and will mark the order as invalid.","markdown_message":"\u003cp\u003eHi Ashish, this is a known behavior of WooCommerce, but it doesn\u0026#39;t actually allow you to change the price; it only appears that way. IPN validation occurs after the order is placed, and will mark the order as invalid.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-08-26T22:13:45.185Z","updated_at":"2019-08-26T22:13:45.185Z","original_report_id":271585,"actor":{"username":"iandunn","cleared":false,"url":"/iandunn","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/974/01bc1d097002b7eff8eddba98990e094553b1eac_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5670540,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-08-27T00:48:43.929Z","updated_at":"2019-08-27T00:48:43.929Z","first_to_agree":true,"actor":{"username":"ashketchum","cleared":false,"url":"/ashketchum","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/HhqEvNTgFpUigyZa7YmFXjRm/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5692064,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-08-29T15:39:07.441Z","updated_at":"2019-08-29T15:39:07.441Z","actor":{"username":"iandunn","cleared":false,"url":"/iandunn","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/974/01bc1d097002b7eff8eddba98990e094553b1eac_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5692065,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-08-29T15:39:07.494Z","updated_at":"2019-08-29T15:39:07.494Z","actor":{"username":"iandunn","cleared":false,"url":"/iandunn","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/974/01bc1d097002b7eff8eddba98990e094553b1eac_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}