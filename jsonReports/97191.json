{"id":97191,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC85NzE5MQ==","url":"https://hackerone.com/reports/97191","title":"Send AJAX request to external domain","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2015-11-02T01:07:39.782Z","submitted_at":"2015-11-02T01:07:39.782Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"r0x33d","url":"/r0x33d","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/002/902/49521318cac76887748b2da080b2b59b4cc0bd57_original.php/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13,"url":"https://hackerone.com/security","handle":"security","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"HackerOne","twitter_handle":"Hacker0x01","website":"https://hackerone.com","about":"Vulnerability disclosure should be safe, transparent, and rewarding."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2015-11-14T14:47:09.895Z","bug_reporter_agreed_on_going_public_at":"2015-11-14T14:47:09.494Z","team_member_agreed_on_going_public_at":"2015-11-14T02:15:17.784Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hello!\n\nI would like to report about ability to send AJAX request from `hackerone.com` to external domain.\n\nHere is PoC for the last version of Internet Explorer: https://hackerone.com/bugs?subject=%2Fbigbob.lv%2F1337.php%3Fdata%3D\n\nIf You visit it, You can see `Hello! This is custom text from external domain` text which is from JSON here https://bigbob.lv/1337.php\n\nYou can check console and see there 3 AJAX requests sent from `hackerone.com` to `bigbob.lv`.\n\nIt is possible because there is no filtration of `/` slash in JavaScript when it handles `subject` GET param. So, it allows to send AJAX requests to external domain because of `//`.\n\nThis PoC will work in old versions of popular browsers which don't support CSP (http://caniuse.com/#feat=contentsecuritypolicy).\n\nI will try to achieve XSS.\n\nThanks!","vulnerability_information_html":"\u003cp\u003eHello!\u003c/p\u003e\n\n\u003cp\u003eI would like to report about ability to send AJAX request from \u003ccode\u003ehackerone.com\u003c/code\u003e to external domain.\u003c/p\u003e\n\n\u003cp\u003eHere is PoC for the last version of Internet Explorer: \u003ca title=\"https://hackerone.com/bugs?subject=%2Fbigbob.lv%2F1337.php%3Fdata%3D\" href=\"https://hackerone.com/bugs?subject=%2Fbigbob.lv%2F1337.php%3Fdata%3D\"\u003ehttps://hackerone.com/bugs?subject=%2Fbigbob.lv%2F1337.php%3Fdata%3D\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eIf You visit it, You can see \u003ccode\u003eHello! This is custom text from external domain\u003c/code\u003e text which is from JSON here \u003ca title=\"https://bigbob.lv/1337.php\" href=\"/redirect?url=https%3A%2F%2Fbigbob.lv%2F1337.php\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://bigbob.lv/1337.php\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eYou can check console and see there 3 AJAX requests sent from \u003ccode\u003ehackerone.com\u003c/code\u003e to \u003ccode\u003ebigbob.lv\u003c/code\u003e.\u003c/p\u003e\n\n\u003cp\u003eIt is possible because there is no filtration of \u003ccode\u003e/\u003c/code\u003e slash in JavaScript when it handles \u003ccode\u003esubject\u003c/code\u003e GET param. So, it allows to send AJAX requests to external domain because of \u003ccode\u003e//\u003c/code\u003e.\u003c/p\u003e\n\n\u003cp\u003eThis PoC will work in old versions of popular browsers which don\u0026#39;t support CSP (\u003ca title=\"http://caniuse.com/#feat=contentsecuritypolicy\" href=\"/redirect?url=http%3A%2F%2Fcaniuse.com%2F%23feat%3Dcontentsecuritypolicy\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://caniuse.com/#feat=contentsecuritypolicy\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e).\u003c/p\u003e\n\n\u003cp\u003eI will try to achieve XSS.\u003c/p\u003e\n\n\u003cp\u003eThanks!\u003c/p\u003e\n","bounty_amount":"2500.0","formatted_bounty":"$2,500","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2015-12-14T02:15:18.168Z","allow_singular_disclosure_after":-159166872.4768181,"singular_disclosure_allowed":true,"vote_count":4,"voters":["spam404","vraj","fantam1","dyabla"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":640756,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"1. We have a strongly enforced CSP policy, which means that we don't allow visits from browsers that don't have support for CSP.\n2. I booted up a Windows VM with Internet Explorer 11, but could not reproduce your issue. Are you sure that you don't have some browser extension enabled that does the fetching?\n\nPlease provide specific version numbers and steps to reproduce.","markdown_message":"\u003col\u003e\n\u003cli\u003eWe have a strongly enforced CSP policy, which means that we don\u0026#39;t allow visits from browsers that don\u0026#39;t have support for CSP.\u003c/li\u003e\n\u003cli\u003eI booted up a Windows VM with Internet Explorer 11, but could not reproduce your issue. Are you sure that you don\u0026#39;t have some browser extension enabled that does the fetching?\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003ePlease provide specific version numbers and steps to reproduce.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-11-02T08:59:23.643Z","updated_at":"2015-11-02T08:59:23.643Z","actor":{"username":"rso","cleared":false,"url":"/rso","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/031/bad304b45f09b089c121de18c65d91d226f0aeea_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":640934,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"@rso\n\n1) Yes, You have nice `Content-Security-Policy` header but Internet Explorer uses experimental `X-Content-Security-Policy` header according to Wikipedia info (https://en.wikipedia.org/wiki/Content_Security_Policy#Status)\n\nOther proofs: \nhttp://www.sitepoint.com/improving-web-security-with-the-content-security-policy/#browser-support\nhttp://www.w3.org/TR/2012/WD-CSP11-20121213/.\n\nAlso `Feature request` for `Content-Security-Policy` header on `connect.microsoft.com` still has `Active` status (not `Closed`) here https://connect.microsoft.com/IE/feedback/details/793746/ie11-feature-request-support-for-the-content-security-policy-header\n\n2) I have tested it in Internet Explorer 11.0.9600.17126, Windows 7\n\nHere is video PoC: https://www.dropbox.com/s/5rh7cv97gy3hece/h1_2.avi?dl=0","markdown_message":"\u003cp\u003e\u003ca href=\"/rso\"\u003e@rso\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e1) Yes, You have nice \u003ccode\u003eContent-Security-Policy\u003c/code\u003e header but Internet Explorer uses experimental \u003ccode\u003eX-Content-Security-Policy\u003c/code\u003e header according to Wikipedia info (\u003ca title=\"https://en.wikipedia.org/wiki/Content_Security_Policy#Status\" href=\"/redirect?url=https%3A%2F%2Fen.wikipedia.org%2Fwiki%2FContent_Security_Policy%23Status\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://en.wikipedia.org/wiki/Content_Security_Policy#Status\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e)\u003c/p\u003e\n\n\u003cp\u003eOther proofs: \u003cbr\u003e\n\u003ca title=\"http://www.sitepoint.com/improving-web-security-with-the-content-security-policy/#browser-support\" href=\"/redirect?url=http%3A%2F%2Fwww.sitepoint.com%2Fimproving-web-security-with-the-content-security-policy%2F%23browser-support\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://www.sitepoint.com/improving-web-security-with-the-content-security-policy/#browser-support\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\n\u003ca title=\"http://www.w3.org/TR/2012/WD-CSP11-20121213/\" href=\"/redirect?url=http%3A%2F%2Fwww.w3.org%2FTR%2F2012%2FWD-CSP11-20121213%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://www.w3.org/TR/2012/WD-CSP11-20121213/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e.\u003c/p\u003e\n\n\u003cp\u003eAlso \u003ccode\u003eFeature request\u003c/code\u003e for \u003ccode\u003eContent-Security-Policy\u003c/code\u003e header on \u003ccode\u003econnect.microsoft.com\u003c/code\u003e still has \u003ccode\u003eActive\u003c/code\u003e status (not \u003ccode\u003eClosed\u003c/code\u003e) here \u003ca title=\"https://connect.microsoft.com/IE/feedback/details/793746/ie11-feature-request-support-for-the-content-security-policy-header\" href=\"/redirect?url=https%3A%2F%2Fconnect.microsoft.com%2FIE%2Ffeedback%2Fdetails%2F793746%2Fie11-feature-request-support-for-the-content-security-policy-header\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://connect.microsoft.com/IE/feedback/details/793746/ie11-feature-request-support-for-the-content-security-policy-header\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e2) I have tested it in Internet Explorer 11.0.9600.17126, Windows 7\u003c/p\u003e\n\n\u003cp\u003eHere is video PoC: \u003ca title=\"https://www.dropbox.com/s/5rh7cv97gy3hece/h1_2.avi?dl=0\" href=\"/redirect?url=https%3A%2F%2Fwww.dropbox.com%2Fs%2F5rh7cv97gy3hece%2Fh1_2.avi%3Fdl%3D0\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.dropbox.com/s/5rh7cv97gy3hece/h1_2.avi?dl=0\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2015-11-02T13:38:03.808Z","updated_at":"2015-11-02T13:38:03.808Z","actor":{"username":"r0x33d","cleared":true,"url":"/r0x33d","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/902/49521318cac76887748b2da080b2b59b4cc0bd57_original.php/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":640955,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@rso Can You, please, check Your console (F12) in IE11 for errors when You visit PoC?","markdown_message":"\u003cp\u003e\u003ca href=\"/rso\"\u003e@rso\u003c/a\u003e Can You, please, check Your console (F12) in IE11 for errors when You visit PoC?\u003c/p\u003e\n","automated_response":false,"created_at":"2015-11-02T13:59:14.315Z","updated_at":"2015-11-02T13:59:14.315Z","actor":{"username":"r0x33d","cleared":true,"url":"/r0x33d","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/902/49521318cac76887748b2da080b2b59b4cc0bd57_original.php/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":642031,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Speaking about XSS, I still look. Now I have only XSS with user interaction. If You visit https://hackerone.com/bugs?subject=%2Fbigbob.lv%2F1338.php%3Fdata%3D - You can see there some message about policy asking to click green button. Then, there is some error which asks to go to `Settings` page and `Settings` page URL is `javascript:alert(document.domain);`. If I get invitation-only program JSON file, maybe I would be lucky to find XSS without user interaction.\n\nBy the way, have You been able to reproduce the first PoC in Internet Explorer?","markdown_message":"\u003cp\u003eSpeaking about XSS, I still look. Now I have only XSS with user interaction. If You visit \u003ca title=\"https://hackerone.com/bugs?subject=%2Fbigbob.lv%2F1338.php%3Fdata%3D\" href=\"https://hackerone.com/bugs?subject=%2Fbigbob.lv%2F1338.php%3Fdata%3D\"\u003ehttps://hackerone.com/bugs?subject=%2Fbigbob.lv%2F1338.php%3Fdata%3D\u003c/a\u003e - You can see there some message about policy asking to click green button. Then, there is some error which asks to go to \u003ccode\u003eSettings\u003c/code\u003e page and \u003ccode\u003eSettings\u003c/code\u003e page URL is \u003ccode\u003ejavascript:alert(document.domain);\u003c/code\u003e. If I get invitation-only program JSON file, maybe I would be lucky to find XSS without user interaction.\u003c/p\u003e\n\n\u003cp\u003eBy the way, have You been able to reproduce the first PoC in Internet Explorer?\u003c/p\u003e\n","automated_response":false,"created_at":"2015-11-03T01:07:21.338Z","updated_at":"2015-11-03T01:09:25.059Z","actor":{"username":"r0x33d","cleared":true,"url":"/r0x33d","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/902/49521318cac76887748b2da080b2b59b4cc0bd57_original.php/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":59961,"filename":"h1_xss.jpg","type":"image/jpeg","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/059/961/333456821fb15668cc1deb345fa2c773499827ed/h1_xss.jpg?response-content-disposition=attachment%3B%20filename%3D%22h1_xss.jpg%22%3B%20filename%2A%3DUTF-8%27%27h1_xss.jpg\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ3UNE4J5L%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T071630Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCz7kjO3QyFP7jGDkA5krNaLE6O2p1tR4x0TQtjMemDwQIhALc5Qo7beEygqpMNylJrOurNEmXX%2FUaJ7i3JOGstSxsEKrQDCFcQARoMMDEzNjE5Mjc0ODQ5IgxX2Y8wmCeqyUWE5MQqkQO1SEq9Kl%2BewQlhrlfUoVvv9N1OLaMkWrWIlv8SukYusm40FYD0qUCOJT%2BzitdeP3Kr9dqa%2BJmxV7c3%2BjXo4WulUP6OrfhUn0Rcu3T1VRcH6Qpx%2FGLAa4zE5IBGMdsXZEcR335EaBEylCpdLxObdeJZ8wmT%2FiMsJqVnexQRWK0gOcg8%2BaAe0Z4MQhfL%2FVbk8%2Botr0dFlI%2FaPx8jXCrTw%2FTlRp0P9OtpSvUQA1RBVrS5L3ZNrC33bQ4md%2B9KmXmIycB047RJuvaypZW9qepGhczrUMsYabbxifZ%2FJ17yJLs39h1ENkrjIFD7f9gA%2F9u%2BsTKrtFMmGu8%2FrThH1%2FAJX2J2V%2FiXJ%2Fj2flmFEXmyNg7XqFuZ2VEFhEknqlw0sjyH5ibXryf8lYs%2FL9ye%2FbGye3G8MgjG1rQQkaNLm9nZxru2uR4y5NwW33D%2F%2F27wPuxj5YAD30GEm3l3%2BfNuoV8Y%2Fa6KBiEG2ZFNI%2Fu9t%2F7aALxmsSX49Fkt%2Fvbd%2B2ORICgPABnOO5GRZQldPJ3fh%2FPtVXm3oDDyjav%2FBTrqAWjMucnwKi73c9CZ4eV75rJ5%2B4PnghCALwGiHX4zE11a5NOtuIpj8v3a2y9AJMGR0JyOdjGEipkC8KkLqeEMFaYnCk4oCce5NwJVnhh%2F8yBh%2BJDy7WhfYG2qUirylB1Ud3rl1KSDWno%2BbVYDQgs2rcyOKmLb%2FH1USBmJPVZi3%2FK%2F%2FJ6%2BATEV10VMohl2iHY7GlXPewFvZ2tG%2FogGkzwNQUb%2BD2o7r0beeLXek5XslTtgqNCoDP9xL1i88F02X5Buj81GAIlEB1qQFUoRMd2N%2Fu0SnL64HSNiPSzstRRJidfEI6C%2F%2FcDv%2BmWfcA%3D%3D\u0026X-Amz-Signature=561be7a2434f64878a55621f458b54d4fe71c33d66c67221710b73fdda6713fb"}],"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":642094,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hey @killr0x33d,\n\nThanks for the kickass report! It took a while to replicate this because it took a little extra magic to get working in development (and we couldn't test your links because they linked to your sandboxed program), but I believe I understand it now and we'll start patching. Here are the components of your exploit as I understand them:\n\n1) We weren't using the `X-Content-Security-Policy` header, which we need to be using for IE 10/11. We just added that header which should fix the vulnerability, so if you could verify for us that you now get CSP violation errors instead of being able to load the content, that would be fantastic.\n2) There's something weird about the way we handle an escaped leading slash in a team name, so when you use a team name like `%2Fbigbob.lv%2F1337.php%3Fdata%3D`, we end up requesting data from `http://bigbob.lv/1337.php?data=/reporters` instead of `http://hackerone.com/%2Fbigbob.lv%2F1337.php%3Fdata%3D/reporters`.\n3) I don't fully understand yet how you produced the alert in the screenshot attached to your most recent comment. Having examined the data you're injecting from `http://bigbob.lv/` (from `/`, `/reporters` and `/team_members`), there doesn't appear to be any code that would alter the contents of the demo banner or inject an alert with that content. Could you clarify where that content is being injected from? I'll be super impressed if there's another entirely distinct component to this exploit.\n\nAs I mentioned above the first issue should be fixed now so we should be safe, and I'm opening a task for the second issue. Please let me know if I missed a component of the third\n\nThanks again for the report, we'll keep you posted as our solution progresses.\n\n \n \n-Evan","markdown_message":"\u003cp\u003eHey \u003ca href=\"/killr0x33d\"\u003e@killr0x33d\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThanks for the kickass report! It took a while to replicate this because it took a little extra magic to get working in development (and we couldn\u0026#39;t test your links because they linked to your sandboxed program), but I believe I understand it now and we\u0026#39;ll start patching. Here are the components of your exploit as I understand them:\u003c/p\u003e\n\n\u003cp\u003e1) We weren\u0026#39;t using the \u003ccode\u003eX-Content-Security-Policy\u003c/code\u003e header, which we need to be using for IE 10/11. We just added that header which should fix the vulnerability, so if you could verify for us that you now get CSP violation errors instead of being able to load the content, that would be fantastic.\u003cbr\u003e\n2) There\u0026#39;s something weird about the way we handle an escaped leading slash in a team name, so when you use a team name like \u003ccode\u003e%2Fbigbob.lv%2F1337.php%3Fdata%3D\u003c/code\u003e, we end up requesting data from \u003ccode\u003ehttp://bigbob.lv/1337.php?data=/reporters\u003c/code\u003e instead of \u003ccode\u003ehttp://hackerone.com/%2Fbigbob.lv%2F1337.php%3Fdata%3D/reporters\u003c/code\u003e.\u003cbr\u003e\n3) I don\u0026#39;t fully understand yet how you produced the alert in the screenshot attached to your most recent comment. Having examined the data you\u0026#39;re injecting from \u003ccode\u003ehttp://bigbob.lv/\u003c/code\u003e (from \u003ccode\u003e/\u003c/code\u003e, \u003ccode\u003e/reporters\u003c/code\u003e and \u003ccode\u003e/team_members\u003c/code\u003e), there doesn\u0026#39;t appear to be any code that would alter the contents of the demo banner or inject an alert with that content. Could you clarify where that content is being injected from? I\u0026#39;ll be super impressed if there\u0026#39;s another entirely distinct component to this exploit.\u003c/p\u003e\n\n\u003cp\u003eAs I mentioned above the first issue should be fixed now so we should be safe, and I\u0026#39;m opening a task for the second issue. Please let me know if I missed a component of the third\u003c/p\u003e\n\n\u003cp\u003eThanks again for the report, we\u0026#39;ll keep you posted as our solution progresses.\u003c/p\u003e\n\n\u003cp\u003e-Evan\u003c/p\u003e\n","automated_response":false,"created_at":"2015-11-03T03:12:10.799Z","updated_at":"2015-11-03T03:12:10.799Z","actor":{"username":"ebrynne","cleared":false,"url":"/ebrynne","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/191/f333df32e9b61845f5c823b77d968fa6d246d336_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":642344,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @ebrynne,\n\nThanks for triaging!\n\n1) Hmm... I'm still able to connect to `https://bigbob.lv` in AJAX from `https://hackerone.com`. Maybe IE doesn't support `connect-src` attribute in CSP header? Or it is some IE bug for me. I see `X-Content-Security-Policy` header in response which is identical with `Content-Security-Policy` header and should work fine.\n\n2) It doesn't matter what team name You have. If You put `/google.com` into `subject` GET param: https://hackerone.com/bugs?subject=/google.com - You will see requests to `https://google.com`.  \n\nIt happens because of JS code `return \"/\" + this.bugs_filter_state.get(\"subject\") + \"/team_members\"` in https://hackerone.com/assets/frontend-d35701f7.js for `/team_members` request (the same for other requests). When You put `/` slash in start of `subject` GET param, this JS line returns string which starts with `//`. Then script makes AJAX request to this returned string but `//` means external URL for browsers. So, there is no need for attacker's victim to create custom team which name starts with `%2F`, just go to `/bugs` page with attacker's custom `subject` GET parameter value.\n\n3) Yes, there doesn't appear any code with alert because it appears only when You click `Leave demo` button. Your JavaScript code creates modal box using JSON data received before from `https://bigbob.lv`. \n\nI attach this `1338.php` file from `https://bigbob.lv`. It handles all these 3 requests differently. \n\nIf You check `ELSE` block in `1338.php` (it happens when `$data` is empty, request `https://bigbob.lv/1338.php?data=`), You can see that JSON `settings_link` has value `javascript:alert(document.domain);`. Your JavaScript code uses this `settings_link` in order to create modal box shown on `h1_settings.jpg`. It sets `Settings` URL `href` attribute to `settings_link` value.\n\nIf You click `Settings` in modal box shown on `h1_settings.jpg`, You will get alert executed. You can see also that this is `Sandboxed` program and think that it won't work for `Public` program but it will because all this data depends on JSON returned from these 3 requests which can be formed to be sent to external domain. For example, `state` value in returned JSON determines current program status and all handling of rendered page happens in Your JavaScript code, not on Your server-side. You can change `has_avatar?` value to `false` and You will see one more error when You click `Leave demo` button. You can change `has_policy?` to `true` and error shown on `h1_settings.jpg` will disappear there because all is based on returned JSON.\n\nBy the way, if You go to `Dashboard` in menu after visiting PoC, it will request statistics and all team data from external domain, because `subject` saves in session.","markdown_message":"\u003cp\u003eHey \u003ca href=\"/ebrynne\"\u003e@ebrynne\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThanks for triaging!\u003c/p\u003e\n\n\u003cp\u003e1) Hmm... I\u0026#39;m still able to connect to \u003ccode\u003ehttps://bigbob.lv\u003c/code\u003e in AJAX from \u003ccode\u003ehttps://hackerone.com\u003c/code\u003e. Maybe IE doesn\u0026#39;t support \u003ccode\u003econnect-src\u003c/code\u003e attribute in CSP header? Or it is some IE bug for me. I see \u003ccode\u003eX-Content-Security-Policy\u003c/code\u003e header in response which is identical with \u003ccode\u003eContent-Security-Policy\u003c/code\u003e header and should work fine.\u003c/p\u003e\n\n\u003cp\u003e2) It doesn\u0026#39;t matter what team name You have. If You put \u003ccode\u003e/google.com\u003c/code\u003e into \u003ccode\u003esubject\u003c/code\u003e GET param: \u003ca title=\"https://hackerone.com/bugs?subject=/google.com\" href=\"https://hackerone.com/bugs?subject=/google.com\"\u003ehttps://hackerone.com/bugs?subject=/google.com\u003c/a\u003e - You will see requests to \u003ccode\u003ehttps://google.com\u003c/code\u003e.  \u003c/p\u003e\n\n\u003cp\u003eIt happens because of JS code \u003ccode\u003ereturn \u0026quot;/\u0026quot; + this.bugs_filter_state.get(\u0026quot;subject\u0026quot;) + \u0026quot;/team_members\u0026quot;\u003c/code\u003e in \u003ca title=\"https://hackerone.com/assets/frontend-d35701f7.js\" href=\"https://hackerone.com/assets/frontend-d35701f7.js\"\u003ehttps://hackerone.com/assets/frontend-d35701f7.js\u003c/a\u003e for \u003ccode\u003e/team_members\u003c/code\u003e request (the same for other requests). When You put \u003ccode\u003e/\u003c/code\u003e slash in start of \u003ccode\u003esubject\u003c/code\u003e GET param, this JS line returns string which starts with \u003ccode\u003e//\u003c/code\u003e. Then script makes AJAX request to this returned string but \u003ccode\u003e//\u003c/code\u003e means external URL for browsers. So, there is no need for attacker\u0026#39;s victim to create custom team which name starts with \u003ccode\u003e%2F\u003c/code\u003e, just go to \u003ccode\u003e/bugs\u003c/code\u003e page with attacker\u0026#39;s custom \u003ccode\u003esubject\u003c/code\u003e GET parameter value.\u003c/p\u003e\n\n\u003cp\u003e3) Yes, there doesn\u0026#39;t appear any code with alert because it appears only when You click \u003ccode\u003eLeave demo\u003c/code\u003e button. Your JavaScript code creates modal box using JSON data received before from \u003ccode\u003ehttps://bigbob.lv\u003c/code\u003e. \u003c/p\u003e\n\n\u003cp\u003eI attach this \u003ccode\u003e1338.php\u003c/code\u003e file from \u003ccode\u003ehttps://bigbob.lv\u003c/code\u003e. It handles all these 3 requests differently. \u003c/p\u003e\n\n\u003cp\u003eIf You check \u003ccode\u003eELSE\u003c/code\u003e block in \u003ccode\u003e1338.php\u003c/code\u003e (it happens when \u003ccode\u003e$data\u003c/code\u003e is empty, request \u003ccode\u003ehttps://bigbob.lv/1338.php?data=\u003c/code\u003e), You can see that JSON \u003ccode\u003esettings_link\u003c/code\u003e has value \u003ccode\u003ejavascript:alert(document.domain);\u003c/code\u003e. Your JavaScript code uses this \u003ccode\u003esettings_link\u003c/code\u003e in order to create modal box shown on \u003ccode\u003eh1_settings.jpg\u003c/code\u003e. It sets \u003ccode\u003eSettings\u003c/code\u003e URL \u003ccode\u003ehref\u003c/code\u003e attribute to \u003ccode\u003esettings_link\u003c/code\u003e value.\u003c/p\u003e\n\n\u003cp\u003eIf You click \u003ccode\u003eSettings\u003c/code\u003e in modal box shown on \u003ccode\u003eh1_settings.jpg\u003c/code\u003e, You will get alert executed. You can see also that this is \u003ccode\u003eSandboxed\u003c/code\u003e program and think that it won\u0026#39;t work for \u003ccode\u003ePublic\u003c/code\u003e program but it will because all this data depends on JSON returned from these 3 requests which can be formed to be sent to external domain. For example, \u003ccode\u003estate\u003c/code\u003e value in returned JSON determines current program status and all handling of rendered page happens in Your JavaScript code, not on Your server-side. You can change \u003ccode\u003ehas_avatar?\u003c/code\u003e value to \u003ccode\u003efalse\u003c/code\u003e and You will see one more error when You click \u003ccode\u003eLeave demo\u003c/code\u003e button. You can change \u003ccode\u003ehas_policy?\u003c/code\u003e to \u003ccode\u003etrue\u003c/code\u003e and error shown on \u003ccode\u003eh1_settings.jpg\u003c/code\u003e will disappear there because all is based on returned JSON.\u003c/p\u003e\n\n\u003cp\u003eBy the way, if You go to \u003ccode\u003eDashboard\u003c/code\u003e in menu after visiting PoC, it will request statistics and all team data from external domain, because \u003ccode\u003esubject\u003c/code\u003e saves in session.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-11-03T09:06:37.026Z","updated_at":"2015-11-03T09:10:41.849Z","actor":{"username":"r0x33d","cleared":true,"url":"/r0x33d","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/902/49521318cac76887748b2da080b2b59b4cc0bd57_original.php/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":59990,"filename":"h1_js.jpg","type":"image/jpeg","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/059/990/b54ad0780836360e0c0c475081c466efee7a16ee/h1_js.jpg?response-content-disposition=attachment%3B%20filename%3D%22h1_js.jpg%22%3B%20filename%2A%3DUTF-8%27%27h1_js.jpg\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ3UNE4J5L%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T071630Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCz7kjO3QyFP7jGDkA5krNaLE6O2p1tR4x0TQtjMemDwQIhALc5Qo7beEygqpMNylJrOurNEmXX%2FUaJ7i3JOGstSxsEKrQDCFcQARoMMDEzNjE5Mjc0ODQ5IgxX2Y8wmCeqyUWE5MQqkQO1SEq9Kl%2BewQlhrlfUoVvv9N1OLaMkWrWIlv8SukYusm40FYD0qUCOJT%2BzitdeP3Kr9dqa%2BJmxV7c3%2BjXo4WulUP6OrfhUn0Rcu3T1VRcH6Qpx%2FGLAa4zE5IBGMdsXZEcR335EaBEylCpdLxObdeJZ8wmT%2FiMsJqVnexQRWK0gOcg8%2BaAe0Z4MQhfL%2FVbk8%2Botr0dFlI%2FaPx8jXCrTw%2FTlRp0P9OtpSvUQA1RBVrS5L3ZNrC33bQ4md%2B9KmXmIycB047RJuvaypZW9qepGhczrUMsYabbxifZ%2FJ17yJLs39h1ENkrjIFD7f9gA%2F9u%2BsTKrtFMmGu8%2FrThH1%2FAJX2J2V%2FiXJ%2Fj2flmFEXmyNg7XqFuZ2VEFhEknqlw0sjyH5ibXryf8lYs%2FL9ye%2FbGye3G8MgjG1rQQkaNLm9nZxru2uR4y5NwW33D%2F%2F27wPuxj5YAD30GEm3l3%2BfNuoV8Y%2Fa6KBiEG2ZFNI%2Fu9t%2F7aALxmsSX49Fkt%2Fvbd%2B2ORICgPABnOO5GRZQldPJ3fh%2FPtVXm3oDDyjav%2FBTrqAWjMucnwKi73c9CZ4eV75rJ5%2B4PnghCALwGiHX4zE11a5NOtuIpj8v3a2y9AJMGR0JyOdjGEipkC8KkLqeEMFaYnCk4oCce5NwJVnhh%2F8yBh%2BJDy7WhfYG2qUirylB1Ud3rl1KSDWno%2BbVYDQgs2rcyOKmLb%2FH1USBmJPVZi3%2FK%2F%2FJ6%2BATEV10VMohl2iHY7GlXPewFvZ2tG%2FogGkzwNQUb%2BD2o7r0beeLXek5XslTtgqNCoDP9xL1i88F02X5Buj81GAIlEB1qQFUoRMd2N%2Fu0SnL64HSNiPSzstRRJidfEI6C%2F%2FcDv%2BmWfcA%3D%3D\u0026X-Amz-Signature=8dc5aca280f73120300bd87c6eee44cd633415571f5369d2290dcbc5db021683"},{"id":59991,"filename":"1338.php","type":"text/x-php","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/059/991/9e63a8da61d3bba01dad57534675425ded161da7/1338.php?response-content-disposition=attachment%3B%20filename%3D%221338.php%22%3B%20filename%2A%3DUTF-8%27%271338.php\u0026response-content-type=text%2Fx-php\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ3UNE4J5L%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T071630Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCz7kjO3QyFP7jGDkA5krNaLE6O2p1tR4x0TQtjMemDwQIhALc5Qo7beEygqpMNylJrOurNEmXX%2FUaJ7i3JOGstSxsEKrQDCFcQARoMMDEzNjE5Mjc0ODQ5IgxX2Y8wmCeqyUWE5MQqkQO1SEq9Kl%2BewQlhrlfUoVvv9N1OLaMkWrWIlv8SukYusm40FYD0qUCOJT%2BzitdeP3Kr9dqa%2BJmxV7c3%2BjXo4WulUP6OrfhUn0Rcu3T1VRcH6Qpx%2FGLAa4zE5IBGMdsXZEcR335EaBEylCpdLxObdeJZ8wmT%2FiMsJqVnexQRWK0gOcg8%2BaAe0Z4MQhfL%2FVbk8%2Botr0dFlI%2FaPx8jXCrTw%2FTlRp0P9OtpSvUQA1RBVrS5L3ZNrC33bQ4md%2B9KmXmIycB047RJuvaypZW9qepGhczrUMsYabbxifZ%2FJ17yJLs39h1ENkrjIFD7f9gA%2F9u%2BsTKrtFMmGu8%2FrThH1%2FAJX2J2V%2FiXJ%2Fj2flmFEXmyNg7XqFuZ2VEFhEknqlw0sjyH5ibXryf8lYs%2FL9ye%2FbGye3G8MgjG1rQQkaNLm9nZxru2uR4y5NwW33D%2F%2F27wPuxj5YAD30GEm3l3%2BfNuoV8Y%2Fa6KBiEG2ZFNI%2Fu9t%2F7aALxmsSX49Fkt%2Fvbd%2B2ORICgPABnOO5GRZQldPJ3fh%2FPtVXm3oDDyjav%2FBTrqAWjMucnwKi73c9CZ4eV75rJ5%2B4PnghCALwGiHX4zE11a5NOtuIpj8v3a2y9AJMGR0JyOdjGEipkC8KkLqeEMFaYnCk4oCce5NwJVnhh%2F8yBh%2BJDy7WhfYG2qUirylB1Ud3rl1KSDWno%2BbVYDQgs2rcyOKmLb%2FH1USBmJPVZi3%2FK%2F%2FJ6%2BATEV10VMohl2iHY7GlXPewFvZ2tG%2FogGkzwNQUb%2BD2o7r0beeLXek5XslTtgqNCoDP9xL1i88F02X5Buj81GAIlEB1qQFUoRMd2N%2Fu0SnL64HSNiPSzstRRJidfEI6C%2F%2FcDv%2BmWfcA%3D%3D\u0026X-Amz-Signature=ef7fa72fe2339f8aaa1383cb11197f9248f59fb889d30f401485afa961f91627"},{"id":59992,"filename":"h1_settings.jpg","type":"image/jpeg","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/059/992/e6e0e8518c6ace2e318d9f24887d2692fcc100e8/h1_settings.jpg?response-content-disposition=attachment%3B%20filename%3D%22h1_settings.jpg%22%3B%20filename%2A%3DUTF-8%27%27h1_settings.jpg\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ3UNE4J5L%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T071630Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCz7kjO3QyFP7jGDkA5krNaLE6O2p1tR4x0TQtjMemDwQIhALc5Qo7beEygqpMNylJrOurNEmXX%2FUaJ7i3JOGstSxsEKrQDCFcQARoMMDEzNjE5Mjc0ODQ5IgxX2Y8wmCeqyUWE5MQqkQO1SEq9Kl%2BewQlhrlfUoVvv9N1OLaMkWrWIlv8SukYusm40FYD0qUCOJT%2BzitdeP3Kr9dqa%2BJmxV7c3%2BjXo4WulUP6OrfhUn0Rcu3T1VRcH6Qpx%2FGLAa4zE5IBGMdsXZEcR335EaBEylCpdLxObdeJZ8wmT%2FiMsJqVnexQRWK0gOcg8%2BaAe0Z4MQhfL%2FVbk8%2Botr0dFlI%2FaPx8jXCrTw%2FTlRp0P9OtpSvUQA1RBVrS5L3ZNrC33bQ4md%2B9KmXmIycB047RJuvaypZW9qepGhczrUMsYabbxifZ%2FJ17yJLs39h1ENkrjIFD7f9gA%2F9u%2BsTKrtFMmGu8%2FrThH1%2FAJX2J2V%2FiXJ%2Fj2flmFEXmyNg7XqFuZ2VEFhEknqlw0sjyH5ibXryf8lYs%2FL9ye%2FbGye3G8MgjG1rQQkaNLm9nZxru2uR4y5NwW33D%2F%2F27wPuxj5YAD30GEm3l3%2BfNuoV8Y%2Fa6KBiEG2ZFNI%2Fu9t%2F7aALxmsSX49Fkt%2Fvbd%2B2ORICgPABnOO5GRZQldPJ3fh%2FPtVXm3oDDyjav%2FBTrqAWjMucnwKi73c9CZ4eV75rJ5%2B4PnghCALwGiHX4zE11a5NOtuIpj8v3a2y9AJMGR0JyOdjGEipkC8KkLqeEMFaYnCk4oCce5NwJVnhh%2F8yBh%2BJDy7WhfYG2qUirylB1Ud3rl1KSDWno%2BbVYDQgs2rcyOKmLb%2FH1USBmJPVZi3%2FK%2F%2FJ6%2BATEV10VMohl2iHY7GlXPewFvZ2tG%2FogGkzwNQUb%2BD2o7r0beeLXek5XslTtgqNCoDP9xL1i88F02X5Buj81GAIlEB1qQFUoRMd2N%2Fu0SnL64HSNiPSzstRRJidfEI6C%2F%2FcDv%2BmWfcA%3D%3D\u0026X-Amz-Signature=46f7d5cbb46b2f5db1a3d8000452609cffb1c339142c565ad149ab6fc83cfaab"}],"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":642364,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Note that the known issues section of http://caniuse.com/#feat=contentsecuritypolicy states \"Partial support in Internet Explorer 10-11 refers to the browser only supporting the 'sandbox' directive by using the X-Content-Security-Policy header.\"\n\nIn fact, https://dev.windows.com/en-us/microsoft-edge/platform/status/contentsecuritypolicy states that CSP is not supported by IE at all (and only supported by Microsoft Edge).\n\nSo, seems that the X-CSP header isn't actually useful at all. As such, we'll likely remove it unless there is really some significant reason to keep it.","markdown_message":"\u003cp\u003eNote that the known issues section of \u003ca title=\"http://caniuse.com/#feat=contentsecuritypolicy\" href=\"/redirect?url=http%3A%2F%2Fcaniuse.com%2F%23feat%3Dcontentsecuritypolicy\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://caniuse.com/#feat=contentsecuritypolicy\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e states \u0026quot;Partial support in Internet Explorer 10-11 refers to the browser only supporting the \u0026#39;sandbox\u0026#39; directive by using the X-Content-Security-Policy header.\u0026quot;\u003c/p\u003e\n\n\u003cp\u003eIn fact, \u003ca title=\"https://dev.windows.com/en-us/microsoft-edge/platform/status/contentsecuritypolicy\" href=\"/redirect?url=https%3A%2F%2Fdev.windows.com%2Fen-us%2Fmicrosoft-edge%2Fplatform%2Fstatus%2Fcontentsecuritypolicy\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://dev.windows.com/en-us/microsoft-edge/platform/status/contentsecuritypolicy\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e states that CSP is not supported by IE at all (and only supported by Microsoft Edge).\u003c/p\u003e\n\n\u003cp\u003eSo, seems that the X-CSP header isn\u0026#39;t actually useful at all. As such, we\u0026#39;ll likely remove it unless there is really some significant reason to keep it.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-11-03T09:29:38.527Z","updated_at":"2015-11-03T09:29:38.527Z","actor":{"username":"reed","cleared":false,"url":"/reed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":643561,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @killr0x33d \n\nThanks for your patience, we've rolled out a more comprehensive fix that's a little more aggressive. Would you be able to confirm for me again that it's fixed?\n\nThanks!\n\n\nEvan","markdown_message":"\u003cp\u003eHey \u003ca href=\"/killr0x33d\"\u003e@killr0x33d\u003c/a\u003e \u003c/p\u003e\n\n\u003cp\u003eThanks for your patience, we\u0026#39;ve rolled out a more comprehensive fix that\u0026#39;s a little more aggressive. Would you be able to confirm for me again that it\u0026#39;s fixed?\u003c/p\u003e\n\n\u003cp\u003eThanks!\u003c/p\u003e\n\n\u003cp\u003eEvan\u003c/p\u003e\n","automated_response":false,"created_at":"2015-11-03T22:16:43.137Z","updated_at":"2015-11-03T22:16:43.137Z","actor":{"username":"ebrynne","cleared":false,"url":"/ebrynne","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/191/f333df32e9b61845f5c823b77d968fa6d246d336_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":644758,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @ebrynne \n\nYes, it is fixed now!","markdown_message":"\u003cp\u003eHey \u003ca href=\"/ebrynne\"\u003e@ebrynne\u003c/a\u003e \u003c/p\u003e\n\n\u003cp\u003eYes, it is fixed now!\u003c/p\u003e\n","automated_response":false,"created_at":"2015-11-04T08:11:29.859Z","updated_at":"2015-11-04T08:11:29.859Z","actor":{"username":"r0x33d","cleared":true,"url":"/r0x33d","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/902/49521318cac76887748b2da080b2b59b4cc0bd57_original.php/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":644834,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thank you for your patience, and thanks again for reporting this vulnerability. Please be patient while we decide on a reward for your efforts.","markdown_message":"\u003cp\u003eThank you for your patience, and thanks again for reporting this vulnerability. Please be patient while we decide on a reward for your efforts.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-11-04T09:39:59.468Z","updated_at":"2015-11-04T09:39:59.468Z","actor":{"username":"rso","cleared":false,"url":"/rso","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/031/bad304b45f09b089c121de18c65d91d226f0aeea_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"r0x33d","url":"/r0x33d"},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":657489,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thank you again for your submission. We appreciate the excellent report, and we look forward to future reports from you.","markdown_message":"\u003cp\u003eThank you again for your submission. We appreciate the excellent report, and we look forward to future reports from you.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-11-14T02:08:59.998Z","updated_at":"2015-11-14T02:08:59.998Z","actor":{"url":"/security","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"HackerOne"}},"bounty_amount":"2500.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"security","collaborator":{"username":"r0x33d","url":"/r0x33d"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":657497,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-11-14T02:15:17.815Z","updated_at":"2015-11-14T02:15:17.815Z","first_to_agree":true,"actor":{"username":"reed","cleared":false,"url":"/reed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":657869,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Wow! Thanks a lot for the bounty! By the way, the first condition in summary isn't necessary to be met because it depends from JSON which was outputed from external domain. If `status` param's value in JSON was `sandbox` then any user would see that notification where text is from JSON `name` attribute value. Also, user wasn't supposed to be team member.","markdown_message":"\u003cp\u003eWow! Thanks a lot for the bounty! By the way, the first condition in summary isn\u0026#39;t necessary to be met because it depends from JSON which was outputed from external domain. If \u003ccode\u003estatus\u003c/code\u003e param\u0026#39;s value in JSON was \u003ccode\u003esandbox\u003c/code\u003e then any user would see that notification where text is from JSON \u003ccode\u003ename\u003c/code\u003e attribute value. Also, user wasn\u0026#39;t supposed to be team member.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-11-14T14:44:39.480Z","updated_at":"2015-11-14T14:46:55.420Z","actor":{"username":"r0x33d","cleared":true,"url":"/r0x33d","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/902/49521318cac76887748b2da080b2b59b4cc0bd57_original.php/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":657870,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-11-14T14:47:09.527Z","updated_at":"2015-11-14T14:47:09.527Z","actor":{"username":"r0x33d","cleared":true,"url":"/r0x33d","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/902/49521318cac76887748b2da080b2b59b4cc0bd57_original.php/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":657871,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-11-14T14:47:09.925Z","updated_at":"2015-11-14T14:47:09.925Z","actor":{"username":"r0x33d","cleared":true,"url":"/r0x33d","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/902/49521318cac76887748b2da080b2b59b4cc0bd57_original.php/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":1017,"category":"team","content":"If the following conditions are met…\n\n* You are an admin of a demo team\n* And you click a malicious link provided by an attacker\n* And you are social engineered into interacting with the displayed dialog\n* And you are using a browser that doesn't support `Content Security Policy` (such as Internet Explorer)\n\n… then a same-origin policy violation could occur.","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eIf the following conditions are met…\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eYou are an admin of a demo team\u003c/li\u003e\n\u003cli\u003eAnd you click a malicious link provided by an attacker\u003c/li\u003e\n\u003cli\u003eAnd you are social engineered into interacting with the displayed dialog\u003c/li\u003e\n\u003cli\u003eAnd you are using a browser that doesn\u0026#39;t support \u003ccode\u003eContent Security Policy\u003c/code\u003e (such as Internet Explorer)\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003e… then a same-origin policy violation could occur.\u003c/p\u003e\n"},{"category":"researcher","can_view?":true,"can_create?":false}]}