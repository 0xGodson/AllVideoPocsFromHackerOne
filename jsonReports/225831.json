{"id":225831,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMjU4MzE=","url":"https://hackerone.com/reports/225831","title":"Extract Billing admin email address using random team id","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2017-05-03T13:41:31.790Z","submitted_at":"2017-05-03T13:41:31.790Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"csanuragjain","url":"/csanuragjain","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/058/139/bbabf05f3cf79c652d18dd0fbfe79e515798b03e_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":554,"url":"https://hackerone.com/dashlane","handle":"dashlane","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/aigzdzSVnRXpu3pVPuYu9JUB/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/aigzdzSVnRXpu3pVPuYu9JUB/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Dashlane","twitter_handle":"dashlane","website":"https://www.dashlane.com/","about":"Dashlane is the best password manager and secure digital wallet on the planet! Try our app for free at https://www.dashlane.com"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2017-07-23T10:29:47.965Z","bug_reporter_agreed_on_going_public_at":"2017-06-23T10:29:31.208Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Any user can extract and enumerate email address of dashlane members.\n\n**Steps to reproduce**\n\n1) Login to console.dashlane.com (Register using https://www.dashlane.com/business/try)\n2) Click on Manage Users while intercepting request in Burp\n3) Look for a request to https://ws1.dashlane.com/1/teamPlans/getTeamLastUpdateTs \n4) Note down the body param values for login and uki\n5) Send the request from Step3 to Burp Repeater\n6) Change the request uri to https://ws1.dashlane.com/1/teamPlans/members in repeater. Also change body param to below:\n\nlimit=0\u0026login=\u003clogin from Step4\u003e\u0026orderBy=login\u0026teamId=\u003cTeam for which you want billing admin email\u003e\u0026uki=\u003cuki from Step4\u003e\n\n7) Forward the request\n8) Notice the response. The value of billingAdmins contains the billing address of the team given in Step6\n9) Repeat Step6 with different team id to extract all admin emails\n\n**Mitigation**\nDo not include email information for unauthorized team id.","vulnerability_information_html":"\u003cp\u003eAny user can extract and enumerate email address of dashlane members.\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eSteps to reproduce\u003c/strong\u003e\u003c/p\u003e\n\n\u003cp\u003e1) Login to console.dashlane.com (Register using \u003ca title=\"https://www.dashlane.com/business/try\" href=\"/redirect?url=https%3A%2F%2Fwww.dashlane.com%2Fbusiness%2Ftry\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.dashlane.com/business/try\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e)\u003cbr\u003e\n2) Click on Manage Users while intercepting request in Burp\u003cbr\u003e\n3) Look for a request to \u003ca title=\"https://ws1.dashlane.com/1/teamPlans/getTeamLastUpdateTs\" href=\"/redirect?url=https%3A%2F%2Fws1.dashlane.com%2F1%2FteamPlans%2FgetTeamLastUpdateTs\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://ws1.dashlane.com/1/teamPlans/getTeamLastUpdateTs\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e \u003cbr\u003e\n4) Note down the body param values for login and uki\u003cbr\u003e\n5) Send the request from Step3 to Burp Repeater\u003cbr\u003e\n6) Change the request uri to \u003ca title=\"https://ws1.dashlane.com/1/teamPlans/members\" href=\"/redirect?url=https%3A%2F%2Fws1.dashlane.com%2F1%2FteamPlans%2Fmembers\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://ws1.dashlane.com/1/teamPlans/members\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e in repeater. Also change body param to below:\u003c/p\u003e\n\n\u003cp\u003elimit=0\u0026amp;login=\u0026lt;login from Step4\u0026gt;\u0026amp;orderBy=login\u0026amp;teamId=\u0026lt;Team for which you want billing admin email\u0026gt;\u0026amp;uki=\u0026lt;uki from Step4\u0026gt;\u003c/p\u003e\n\n\u003cp\u003e7) Forward the request\u003cbr\u003e\n8) Notice the response. The value of billingAdmins contains the billing address of the team given in Step6\u003cbr\u003e\n9) Repeat Step6 with different team id to extract all admin emails\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eMitigation\u003c/strong\u003e\u003cbr\u003e\nDo not include email information for unauthorized team id.\u003c/p\u003e\n","bounty_amount":"300.0","formatted_bounty":"$300","weakness":{"id":65,"name":"Business Logic Errors"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":181574,"file_name":"mailaddress.PNG","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/181/574/fbb48b9191820fc601ed18eb12bcf630b3853f33/mailaddress.PNG?response-content-disposition=attachment%3B%20filename%3D%22mailaddress.PNG%22%3B%20filename%2A%3DUTF-8%27%27mailaddress.PNG\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSFCZ3AEE%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T050241Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJFMEMCIHWigdtf4V6jrDm66WbPrvAwAjkDkGwq6jJxHgkhTBQkAh8Pm59QJ1DW90Nm%2BqUZrqPeSIGh%2B3OcvgtVLmg10uTMKrQDCFQQARoMMDEzNjE5Mjc0ODQ5IgwfS9%2FiGaxXJhRExaMqkQM%2FioQKCRd2GEb49HBlLXjeVg1H%2FoNlCjm1k0hMZ2xM%2B0x4lmIPMnshxiw4gyq5WOKYTVNGzovcoxlJKVWJ0J8ot8jIAdBOEwL1e8YBnNwskpBMy96aUxeRhk0v3RC6PmoKg5jI4Qx3q41XFLoVNJzGZBMLXknGm%2FL%2F3r3TBQO0a%2Bho9Lw4jX%2FmwWvHj8d64twZuZ4naqUS%2FC5%2FMe%2BCb7di7nj2LrLyNCU3mwVZhuZqaKYU7%2BmpmzDXhPe6vg3i0Ag1ETmf%2B4HHFKIzD1arTf4NVMuk53Qk2BUuVm8UMmZQPvicVaLBXLt7ccHpSlZil%2FS4s09xyNkmhqsb4joFjYvki4ZCYJgj6f2HgZ9j5I5jB%2BkNBEx91sV072LTXsJZGus5vwgFqmgq6%2FLSGoCBv5WZ1%2FGuoZfgjyzvsmoBX8uKpu1MK2cCSfK2OOw%2BdQcJ893qtedMSb3E%2FljNUxJf3ge6DsNwKlGjDwu7tV2CwK5eoC8nnGnfgTFitfIQRa0%2BQ7r2Yiwaq1V%2FfpNlnllKKKKFFDD1uar%2FBTrtAcWSVbs%2BpUxv20hwqIlkNrNvMi6wkgf%2BLXOkTSYmrhZJiEvr012n0TMdj9Lpp5lSBvt%2BFmQOWfNxpY3OJBDwcWAiZ%2F2ed9lHQZ21qGQ3nsQfbuRvBliy0SDSXu3rFk%2F2YIvbptRB1WpaAx7N%2FhS0S%2Bs17TOirrod7lqA3UzbN3XBtY1r%2BegR7%2FcG%2BpTuKL1SZFmW4odML8bsKnPb2rSlOtAfW6UI5KEpZRuNPIpftSdXrAErjdLnGLehSWx7Q2Iysd3y2wS8%2BnA6TfU%2Fr7xOl0wvkOaOhwXKDLm%2BA5oHA3Mxg%2F%2FTNCq8BPNgEALt%2FQ%3D%3D\u0026X-Amz-Signature=113d13af6ad4f331749fc49deb812de3fd1bf218d1fd1e791792711d1419a22c","file_size":66510,"type":"image/png"}],"allow_singular_disclosure_at":"2017-07-23T10:29:31.257Z","allow_singular_disclosure_after":-108412390.27865274,"singular_disclosure_allowed":true,"vote_count":7,"voters":["gamliel","eveeez","japz","spetr0x","walidhossain","sanf","wzulfikar"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1651471,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Indeed. This not the expected behavior. We'll fix it soon.\nThanks a lot for your report.\n","markdown_message":"\u003cp\u003eIndeed. This not the expected behavior. We\u0026#39;ll fix it soon.\u003cbr\u003e\nThanks a lot for your report.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-05-03T14:24:52.891Z","updated_at":"2017-05-03T14:24:52.891Z","actor":{"username":"cyril_l","cleared":false,"url":"/cyril_l","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"dashlane","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1653319,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2017-05-04T09:41:44.767Z","updated_at":"2017-05-04T09:41:44.767Z","actor":{"url":"/dashlane","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/aigzdzSVnRXpu3pVPuYu9JUB/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Dashlane"}},"bounty_amount":"300.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"dashlane","collaborator":{"username":"csanuragjain","url":"/csanuragjain"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1653323,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"It's fixed. \nThanks a lot for this quality report.\n\nCyril","markdown_message":"\u003cp\u003eIt\u0026#39;s fixed. \u003cbr\u003e\nThanks a lot for this quality report.\u003c/p\u003e\n\n\u003cp\u003eCyril\u003c/p\u003e\n","automated_response":false,"created_at":"2017-05-04T09:43:11.377Z","updated_at":"2017-05-04T09:43:11.377Z","actor":{"username":"cyril_l","cleared":false,"url":"/cyril_l","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"csanuragjain","url":"/csanuragjain"},"genius_execution_id":null,"team_handle":"dashlane","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1653715,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thankyou :)","markdown_message":"\u003cp\u003eThankyou :)\u003c/p\u003e\n","automated_response":false,"created_at":"2017-05-04T13:29:51.472Z","updated_at":"2017-05-04T13:29:51.472Z","actor":{"username":"csanuragjain","cleared":true,"url":"/csanuragjain","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/058/139/bbabf05f3cf79c652d18dd0fbfe79e515798b03e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"dashlane","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1776263,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-06-23T10:29:31.232Z","updated_at":"2017-06-23T10:29:31.232Z","first_to_agree":true,"actor":{"username":"csanuragjain","cleared":true,"url":"/csanuragjain","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/058/139/bbabf05f3cf79c652d18dd0fbfe79e515798b03e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"dashlane","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1776382,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"███.\n█████████\n\nRegards,\nCyril\n","markdown_message":"\u003cp\u003e███.\u003cbr\u003e\n█████████\u003c/p\u003e\n\n\u003cp\u003eRegards,\u003cbr\u003e\nCyril\u003c/p\u003e\n","automated_response":false,"created_at":"2017-06-23T11:54:01.500Z","updated_at":"2017-07-23T11:13:50.872Z","actor":{"username":"cyril_l","cleared":false,"url":"/cyril_l","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"dashlane","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1776645,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"This bug was reported when program was public :)\nBut yes if you prefer to not disclose, then also I respect your decision :)","markdown_message":"\u003cp\u003eThis bug was reported when program was public :)\u003cbr\u003e\nBut yes if you prefer to not disclose, then also I respect your decision :)\u003c/p\u003e\n","automated_response":false,"created_at":"2017-06-23T14:11:13.875Z","updated_at":"2017-06-23T14:11:13.875Z","actor":{"username":"csanuragjain","cleared":true,"url":"/csanuragjain","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/058/139/bbabf05f3cf79c652d18dd0fbfe79e515798b03e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"dashlane","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1852459,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello, \n████\n\nRegards\nCyril\n","markdown_message":"\u003cp\u003eHello, \u003cbr\u003e\n████\u003c/p\u003e\n\n\u003cp\u003eRegards\u003cbr\u003e\nCyril\u003c/p\u003e\n","automated_response":false,"created_at":"2017-07-20T09:25:38.340Z","updated_at":"2017-07-23T11:14:24.178Z","actor":{"username":"cyril_l","cleared":false,"url":"/cyril_l","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"dashlane","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1860613,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-07-23T10:29:47.983Z","updated_at":"2017-07-23T10:29:47.983Z","actor":{"url":"/dashlane","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/aigzdzSVnRXpu3pVPuYu9JUB/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Dashlane"}},"genius_execution_id":null,"team_handle":"dashlane","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}