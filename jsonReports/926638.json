{"id":926638,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC85MjY2Mzg=","url":"https://hackerone.com/reports/926638","title":"curl overwrites local file with -J option if file non-readable, but file writable.","state":"Closed","substate":"informative","severity_rating":"medium","readable_substate":"Informative","created_at":"2020-07-18T00:52:32.779Z","submitted_at":"2020-07-18T00:52:32.779Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"brumbrum","url":"/brumbrum","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":35663,"url":"https://hackerone.com/curl","handle":"curl","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/035/663/2faf4c279d437d64bfda6d23d62ce1833813a4d9_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/035/663/2faf4c279d437d64bfda6d23d62ce1833813a4d9_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"curl","twitter_handle":"","website":"https://curl.se","about":"cURL is a computer software project providing a library and command-line tool for transferring data using various protocols."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2020-08-01T16:46:35.501Z","bug_reporter_agreed_on_going_public_at":"2020-08-01T16:46:35.458Z","team_member_agreed_on_going_public_at":"2020-08-01T15:50:15.817Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"## Summary:\n\nWhen using -J -O options on curl command line tool and a server responding with a header that is using Content-Disposition to provide a filename, existing local file will be overwritten if the file is non-readable by the current user, but file is writable by the current user.\n\nCurl contains protection to prevent the overwrite, but protection code is using the file's readability permission to check for its existence.  So protection will be bypassed in this case, as it is only writable by the user.\n\nIssue was discovered after review of CVE-2020-8177 description. I was curious how the Content-Disposition feature and prevention of file overwrite worked.  While reviewing the code around that feature noted that the existence of the file is checked via being able to read the file.  So what happens if the file is not readable, but writable!?!\n\nWhy would a system have a file that is writable only, for sensitive information that must be collected by a particular user, but must not be viewable by that user.  Certain logs or audit trails or privacy related files or security related files, might have such restrictions.\n\nAdditionally, and in an extreme example, code as written is susceptible to Race Condition as the file existence check and file write are done with two distinct fopen() calls in the tool_create_output_file() in tool_cb_wrt.c file.  Data lose possible if parallel write operations performed on the same file via two curl processes, or even some other process (malicious or not) acting/interfering on the same file.\n\n\n## Steps To Reproduce:\n1. Create a new file (e.g. echo \"TEST\" \u003edata.txt)\n2. Check content of file to see that file contains \"TEST\".\n3. Change permissions of new file to remove read permission (e.g. chmod 222 data.txt)\n4. Download file from remote server that will have Content-Disposition with filename \"data.txt\"\n5. Check that file data.txt is still only writable! Permissions have not changed.\n6. Change permissions to add the read permission back (so we can see the content)\n7. View the content of data.txt file, it will be overwritten with server response.\n\n## Supporting Material/References:\n\n1. Log of reproduction attached. See curl_reproduction.log attached.\n2. Source for a simple Golang HTTP server with Content-Disposition header also attached.  See httpserver.go file attached.\n\n\n## Mitigation:\n\nOne way to fix the issue robustly (check for file existence and create file in one operation) would be to use the open() to create the file while using safe options (such as O_CREAT | O_WRONLY | O_EXCL), as is shown in one of the solutions in this stackoverflow posting (see posting by \"Dan Lenski\", for example):\n\nhttps://stackoverflow.com/questions/230062/whats-the-best-way-to-check-if-a-file-exists-in-c\n\n## Impact\n\n- An existing local file could be overwritten, either maliciously or accidentally by curl\n- A malicious server would need to send Content-Disposition with filename provided at the same time, as the victim would have to use the -J -O option on the curl command line side, with a file that is non-readable, but writable.","vulnerability_information_html":"\u003ch2 id=\"summary\"\u003eSummary:\u003c/h2\u003e\n\n\u003cp\u003eWhen using -J -O options on curl command line tool and a server responding with a header that is using Content-Disposition to provide a filename, existing local file will be overwritten if the file is non-readable by the current user, but file is writable by the current user.\u003c/p\u003e\n\n\u003cp\u003eCurl contains protection to prevent the overwrite, but protection code is using the file\u0026#39;s readability permission to check for its existence.  So protection will be bypassed in this case, as it is only writable by the user.\u003c/p\u003e\n\n\u003cp\u003eIssue was discovered after review of CVE-2020-8177 description. I was curious how the Content-Disposition feature and prevention of file overwrite worked.  While reviewing the code around that feature noted that the existence of the file is checked via being able to read the file.  So what happens if the file is not readable, but writable!?!\u003c/p\u003e\n\n\u003cp\u003eWhy would a system have a file that is writable only, for sensitive information that must be collected by a particular user, but must not be viewable by that user.  Certain logs or audit trails or privacy related files or security related files, might have such restrictions.\u003c/p\u003e\n\n\u003cp\u003eAdditionally, and in an extreme example, code as written is susceptible to Race Condition as the file existence check and file write are done with two distinct fopen() calls in the tool_create_output_file() in tool_cb_wrt.c file.  Data lose possible if parallel write operations performed on the same file via two curl processes, or even some other process (malicious or not) acting/interfering on the same file.\u003c/p\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps To Reproduce:\u003c/h2\u003e\n\n\u003col\u003e\n\u003cli\u003eCreate a new file (e.g. echo \u0026quot;TEST\u0026quot; \u0026gt;data.txt)\u003c/li\u003e\n\u003cli\u003eCheck content of file to see that file contains \u0026quot;TEST\u0026quot;.\u003c/li\u003e\n\u003cli\u003eChange permissions of new file to remove read permission (e.g. chmod 222 data.txt)\u003c/li\u003e\n\u003cli\u003eDownload file from remote server that will have Content-Disposition with filename \u0026quot;data.txt\u0026quot;\u003c/li\u003e\n\u003cli\u003eCheck that file data.txt is still only writable! Permissions have not changed.\u003c/li\u003e\n\u003cli\u003eChange permissions to add the read permission back (so we can see the content)\u003c/li\u003e\n\u003cli\u003eView the content of data.txt file, it will be overwritten with server response.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003ch2 id=\"supporting-material-references\"\u003eSupporting Material/References:\u003c/h2\u003e\n\n\u003col\u003e\n\u003cli\u003eLog of reproduction attached. See curl_reproduction.log attached.\u003c/li\u003e\n\u003cli\u003eSource for a simple Golang HTTP server with Content-Disposition header also attached.  See httpserver.go file attached.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003ch2 id=\"mitigation\"\u003eMitigation:\u003c/h2\u003e\n\n\u003cp\u003eOne way to fix the issue robustly (check for file existence and create file in one operation) would be to use the open() to create the file while using safe options (such as O_CREAT | O_WRONLY | O_EXCL), as is shown in one of the solutions in this stackoverflow posting (see posting by \u0026quot;Dan Lenski\u0026quot;, for example):\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"https://stackoverflow.com/questions/230062/whats-the-best-way-to-check-if-a-file-exists-in-c\" href=\"/redirect?url=https%3A%2F%2Fstackoverflow.com%2Fquestions%2F230062%2Fwhats-the-best-way-to-check-if-a-file-exists-in-c\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://stackoverflow.com/questions/230062/whats-the-best-way-to-check-if-a-file-exists-in-c\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cul\u003e\n\u003cli\u003eAn existing local file could be overwritten, either maliciously or accidentally by curl\u003c/li\u003e\n\u003cli\u003eA malicious server would need to send Content-Disposition with filename provided at the same time, as the victim would have to use the -J -O option on the curl command line side, with a file that is non-readable, but writable.\u003c/li\u003e\n\u003c/ul\u003e\n","weakness":{"id":135,"name":"Improper Handling of Insufficient Permissions or Privileges"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":911701,"file_name":"curl_reproduction.log","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/5H6WsCHn6hGaPYnpgxpEkNNX?response-content-disposition=attachment%3B%20filename%3D%22curl_reproduction.log%22%3B%20filename%2A%3DUTF-8%27%27curl_reproduction.log\u0026response-content-type=text%2Fx-log\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQWUZQJ45V%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T071207Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIGx%2BIUT7BwvgKFRF%2FM2q4UxRB6Xuz453wfpVuGy9AO4LAiEA321QrCacxavrlJY0PoJQadyBcwnLa4%2B40wf5mhY2y1cqtAMIVxABGgwwMTM2MTkyNzQ4NDkiDPvv6XizBwfbImptqSqRA5e2LaAoyIQ8CwztoX0QBAon9EyU5hcKWW7M87r%2BH6ta1kFKal0IOe0GqWgIQTfVrNQIAYYWeNWIAyEOKS5vyXMSyNEN6p0DPLv74tw04SmndG8V5zwiFJCBjoG56jaXP5Y7oEBqyTcqO%2FlqzWd98T2OnRF3%2B0lSQVd51cmqnjNMdcFaNgWYmFuA%2FCVQvz9ElGUIjOcH5a6VZ3HnVxiKQw5ANC%2BfyWR78GB3ReUQqSKHKPcFRii4RKE7SdfkQBlRRnjBGvOveHmUoI6XopqPosxJaBvCjmC6t1OorWN4ohU9CiRV6UFtoQ4jyvAlZG0yQF3zHW4NlU1zOoSsH0YU1cWEpQIkuVZ%2FRZ%2BY%2FM%2BOXr%2BOeTaSHLH5H5yqZNLFEStZhfx3gwXFI2TYxnMUHmvPbnvnIEJ9WOys0FzCvRls%2Fp0hFtJcXMIyQAqc0WHyjjaRxwM%2FAl72J5maAaRcYeXI4xgQYGjao3i2y3eDvBg2hSi2DXWmZUnMhd53u6wfyIfCzKLKgJTM630ec8%2BGCAu0r%2FL5MM2Pq%2F8FOusBdLHJDdGmQTYC9Ej0fNaIxV5wYb8ByhUKiutiv%2FqgstE1ft6A6M6nDxaliZEqjMKcOTnEaz2VqagbADyA7kMjT8mpA98fME%2BWYwpzFYy%2Bllj%2F%2FaLcME%2FvDR9tn3jF8zJtPugh3uDiKpGvLurFUe3Sl24ZFTLMWgj7V0tQQHNC%2FOypp%2F6fgwLn4iNGNfurOGv%2BtW%2FSTVsmD6xFpfEpNO8DZrXWyube5Y8d69QKldJrmJOkEbDcT2y05eDupgkO1UB9qqOv46KLqIJ5SQ5J%2BQO7Qx8HZk4Sjb41MM7fUnJqCm6JXwYfNYtCGOr0eA%3D%3D\u0026X-Amz-Signature=2b732e7748cd3b8ec00b077a5ee030d431c41468039236cc04bf0308cc678182","file_size":1048,"type":"text/x-log"},{"id":911703,"file_name":"httpserver.go","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/RuJ9nSJ8xz6N9a61mRzwY87G?response-content-disposition=attachment%3B%20filename%3D%22httpserver.go%22%3B%20filename%2A%3DUTF-8%27%27httpserver.go\u0026response-content-type=text%2Fx-go\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQWUZQJ45V%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T071207Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIGx%2BIUT7BwvgKFRF%2FM2q4UxRB6Xuz453wfpVuGy9AO4LAiEA321QrCacxavrlJY0PoJQadyBcwnLa4%2B40wf5mhY2y1cqtAMIVxABGgwwMTM2MTkyNzQ4NDkiDPvv6XizBwfbImptqSqRA5e2LaAoyIQ8CwztoX0QBAon9EyU5hcKWW7M87r%2BH6ta1kFKal0IOe0GqWgIQTfVrNQIAYYWeNWIAyEOKS5vyXMSyNEN6p0DPLv74tw04SmndG8V5zwiFJCBjoG56jaXP5Y7oEBqyTcqO%2FlqzWd98T2OnRF3%2B0lSQVd51cmqnjNMdcFaNgWYmFuA%2FCVQvz9ElGUIjOcH5a6VZ3HnVxiKQw5ANC%2BfyWR78GB3ReUQqSKHKPcFRii4RKE7SdfkQBlRRnjBGvOveHmUoI6XopqPosxJaBvCjmC6t1OorWN4ohU9CiRV6UFtoQ4jyvAlZG0yQF3zHW4NlU1zOoSsH0YU1cWEpQIkuVZ%2FRZ%2BY%2FM%2BOXr%2BOeTaSHLH5H5yqZNLFEStZhfx3gwXFI2TYxnMUHmvPbnvnIEJ9WOys0FzCvRls%2Fp0hFtJcXMIyQAqc0WHyjjaRxwM%2FAl72J5maAaRcYeXI4xgQYGjao3i2y3eDvBg2hSi2DXWmZUnMhd53u6wfyIfCzKLKgJTM630ec8%2BGCAu0r%2FL5MM2Pq%2F8FOusBdLHJDdGmQTYC9Ej0fNaIxV5wYb8ByhUKiutiv%2FqgstE1ft6A6M6nDxaliZEqjMKcOTnEaz2VqagbADyA7kMjT8mpA98fME%2BWYwpzFYy%2Bllj%2F%2FaLcME%2FvDR9tn3jF8zJtPugh3uDiKpGvLurFUe3Sl24ZFTLMWgj7V0tQQHNC%2FOypp%2F6fgwLn4iNGNfurOGv%2BtW%2FSTVsmD6xFpfEpNO8DZrXWyube5Y8d69QKldJrmJOkEbDcT2y05eDupgkO1UB9qqOv46KLqIJ5SQ5J%2BQO7Qx8HZk4Sjb41MM7fUnJqCm6JXwYfNYtCGOr0eA%3D%3D\u0026X-Amz-Signature=512d713b825efefc9fca80c97ad400648ae4df5ce1d6d21010fd68548197d7d6","file_size":338,"type":"text/x-go"}],"allow_singular_disclosure_at":null,"vote_count":2,"voters":["mrtspitup5860gotyou","v13rsba"],"severity":{"rating":"medium","author_type":"User"},"structured_scope":{"databaseId":18844,"asset_type":"SOURCE_CODE","asset_identifier":"https://github.com/curl/curl","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":8638140,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"As far as I know I can confirm that my report clearly explains how to Reproduce the issue and shows the Impact.  As for the \"In Scope\", the code of curl is in scope, feature is not experimental from what I gather and similar area is involved with CVE-2020-8177.  I have the latest git content from July 16, 2020, and built from source.","markdown_message":"\u003cp\u003eAs far as I know I can confirm that my report clearly explains how to Reproduce the issue and shows the Impact.  As for the \u0026quot;In Scope\u0026quot;, the code of curl is in scope, feature is not experimental from what I gather and similar area is involved with CVE-2020-8177.  I have the latest git content from July 16, 2020, and built from source.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-07-18T00:58:20.292Z","updated_at":"2020-07-18T00:58:20.292Z","actor":{"username":"brumbrum","cleared":false,"url":"/brumbrum","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8643569,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you, we will investigate and assess this report.","markdown_message":"\u003cp\u003eThank you, we will investigate and assess this report.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-07-19T07:22:10.036Z","updated_at":"2020-07-19T07:22:10.036Z","actor":{"username":"bagder","cleared":false,"url":"/bagder","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/459/380/963f64725677dda4f5113219588e7d0c1ab9abaa_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8646244,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Can you think of any real world case where anyone uses user-writable but user-unreadable files for which this attack would work? To me it smells of a theoretical flaw that probably has no real world effect.","markdown_message":"\u003cp\u003eCan you think of any real world case where anyone uses user-writable but user-unreadable files for which this attack would work? To me it smells of a theoretical flaw that probably has no real world effect.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-07-19T15:51:10.346Z","updated_at":"2020-07-19T15:51:10.346Z","actor":{"username":"bagder","cleared":false,"url":"/bagder","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/459/380/963f64725677dda4f5113219588e7d0c1ab9abaa_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8647262,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Quoted below is the rational that I put in the original report.\n\n\"Why would a system have a file that is writable only, for sensitive information that must be collected by a particular user, but must not be viewable by that user. Certain logs or audit trails or privacy related files or security related files, might have such restrictions.\"\n\nI could add to the list: 'system backups', 'database backups', 'transaction logs', any file with PII and any other file that must be restricted to a very small number of highly privileged users.\n\n\n-------------------------------------\n\nDoing a very quick check on my Ubuntu 20.04 system, I can see many files in /sys and /proc that are write only.   Don't know if these are particularly vulnerable to anything, I just have them as an example of 'files' with this interesting write-only file permission set.\n\nfind / ! -readable -writable -exec ls -lL {} \\; 2\u003e/dev/null\n--w------- 1 bobo bobo 0 Jul 19 15:03 /sys/fs/fuse/connections/52/abort\n--w------- 1 bobo bobo 0 Jul 19 15:03 /sys/fs/fuse/connections/51/abort\n--w--w--w- 1 root root 0 Jul 19 15:53 /sys/fs/cgroup/memory/user.slice/cgroup.event_control\n--w--w--w- 1 root root 0 Jul 19 15:53 /sys/fs/cgroup/memory/user.slice/user-1000.slice/user@1000.service/cgroup.event_control\n--w--w--w- 1 root root 0 Jul 19 15:53 /sys/fs/cgroup/memory/user.slice/user-1000.slice/session-2.scope/cgroup.event_control\n--w--w--w- 1 root root 0 Jul 19 15:53 /sys/fs/cgroup/memory/user.slice/user-1000.slice/cgroup.event_control\n--w--w--w- 1 root root 0 Jul 19 15:53 /sys/fs/cgroup/memory/cgroup.event_control\n.\n.\n.\n--w--w--w- 1 root root 0 Jul 19 15:53 /sys/fs/cgroup/memory/system.slice/systemd-timesyncd.service/cgroup.event_control\n--w--w--w- 1 root root 0 Jul 19 15:53 /sys/fs/cgroup/memory/system.slice/system-getty.slice/cgroup.event_control\n--w--w--w- 1 root root 0 Jul 19 15:53 /sys/fs/cgroup/memory/system.slice/avahi-daemon.service/cgroup.event_control\n--w--w--w- 1 root root 0 Jul 19 15:53 /sys/fs/cgroup/memory/system.slice/systemd-logind.service/cgroup.event_control\n--w--w---- 1 bobo bobo 10 Jul 17 15:53 /home/bobo/programs/curl/git/name.txt\n--w------- 1 bobo bobo 0 Jul 19 15:53 /proc/1392/task/1392/clear_refs\n--w------- 1 bobo bobo 0 Jul 19 15:53 /proc/1392/clear_refs\n--w------- 1 bobo bobo 0 Jul 19 15:53 /proc/1403/task/1403/clear_refs\n--w------- 1 bobo bobo 0 Jul 19 15:53 /proc/1403/task/1626/clear_refs\n.\n.\n.\n\n\n-------------------------------------\n\nUse case one...\n\nOwner (e.g. root) has full access to the file(s)/directory in question.  Users belonging to the file(s)/directory group might have only write permission.  User(s) part of this write-only group could be tasked to do various file fetching from different end points.  A group with least privilege.  These files could be sensitive, and you don't want the group members to be able to see the content or any other users content, but they must be able to put the files in the same directory.  To be really least privilege you would not even give these group members read access to the download directory (rwx-wx---), so they can't even check the filenames that already exist there.\n\nBefore performing curl to download, umask would be set to create write-only files.  umask 447 or something like that.\n\nActions involving deleting, renaming, moving, copying, backing up the file(s) will be done with a different process running with more privileges (e.g. root).\n\nIf somehow the system is hacked, and a user in this particular write-only group is the one that is hacked.  Using least privilege that user could not see what has been previously collected.  They might be able to see future downloaded data that the user is responsible to fetch if they hang around long enough to set that up, but any old data is safe. They still will not be able to see other user's data.\n\nThe file names are generated on the server, but there is a small chance that there might be some non-unique name that could overwrite an existing file. It is more important to not overwrite an existing file, versus successful download of the new server provided file.\n\n\n-------------------------------------\n\nAs second use case...\n\nA malicious server attempting to overwrite a file that might have this particular type of permission (as in previous use case), a fact discovered through some other means or just blindly attempted without the knowledge.\n\n\n-------------------------------------\n\nAnd as a final use case...\n\nAn accidental overwrite of an important file.  Curl documentation specifically states that if the file 'exists' it will not be overwritten.\n\n\n-------------------------------------\n\nSome discussion on the net about this special write-only case.\n\nParticularly interesting is the mention of the \"dropbox-like\" discussion.  Which sounds like a variation on my use case one.\n\nhttps://unix.stackexchange.com/questions/22577/write-access-without-read-access\nhttps://unix.stackexchange.com/questions/256058/what-are-the-use-cases-for-write-only-and-write-execute-files\nhttps://stackoverflow.com/questions/35398783/when-would-you-use-a-write-only-file\n\n\n","markdown_message":"\u003cp\u003eQuoted below is the rational that I put in the original report.\u003c/p\u003e\n\n\u003cp\u003e\u0026quot;Why would a system have a file that is writable only, for sensitive information that must be collected by a particular user, but must not be viewable by that user. Certain logs or audit trails or privacy related files or security related files, might have such restrictions.\u0026quot;\u003c/p\u003e\n\n\u003cp\u003eI could add to the list: \u0026#39;system backups\u0026#39;, \u0026#39;database backups\u0026#39;, \u0026#39;transaction logs\u0026#39;, any file with PII and any other file that must be restricted to a very small number of highly privileged users.\u003c/p\u003e\n\n\u003chr\u003e\n\n\u003cp\u003eDoing a very quick check on my Ubuntu 20.04 system, I can see many files in /sys and /proc that are write only.   Don\u0026#39;t know if these are particularly vulnerable to anything, I just have them as an example of \u0026#39;files\u0026#39; with this interesting write-only file permission set.\u003c/p\u003e\n\n\u003cp\u003efind / ! -readable -writable -exec ls -lL {} \\; 2\u0026gt;/dev/null\u003cbr\u003e\n--w------- 1 bobo bobo 0 Jul 19 15:03 /sys/fs/fuse/connections/52/abort\u003cbr\u003e\n--w------- 1 bobo bobo 0 Jul 19 15:03 /sys/fs/fuse/connections/51/abort\u003cbr\u003e\n--w--w--w- 1 root root 0 Jul 19 15:53 /sys/fs/cgroup/memory/user.slice/cgroup.event_control\u003cbr\u003e\n--w--w--w- 1 root root 0 Jul 19 15:53 /sys/fs/cgroup/memory/user.slice/user-1000.slice/\u003ca title=\"user@1000.service\" href=\"mailto:user@1000.service\" rel=\"nofollow noopener noreferrer\"\u003euser@1000.service\u003c/a\u003e/cgroup.event_control\u003cbr\u003e\n--w--w--w- 1 root root 0 Jul 19 15:53 /sys/fs/cgroup/memory/user.slice/user-1000.slice/session-2.scope/cgroup.event_control\u003cbr\u003e\n--w--w--w- 1 root root 0 Jul 19 15:53 /sys/fs/cgroup/memory/user.slice/user-1000.slice/cgroup.event_control\u003cbr\u003e\n--w--w--w- 1 root root 0 Jul 19 15:53 /sys/fs/cgroup/memory/cgroup.event_control\u003cbr\u003e\n.\u003cbr\u003e\n.\u003cbr\u003e\n.\u003cbr\u003e\n--w--w--w- 1 root root 0 Jul 19 15:53 /sys/fs/cgroup/memory/system.slice/systemd-timesyncd.service/cgroup.event_control\u003cbr\u003e\n--w--w--w- 1 root root 0 Jul 19 15:53 /sys/fs/cgroup/memory/system.slice/system-getty.slice/cgroup.event_control\u003cbr\u003e\n--w--w--w- 1 root root 0 Jul 19 15:53 /sys/fs/cgroup/memory/system.slice/avahi-daemon.service/cgroup.event_control\u003cbr\u003e\n--w--w--w- 1 root root 0 Jul 19 15:53 /sys/fs/cgroup/memory/system.slice/systemd-logind.service/cgroup.event_control\u003cbr\u003e\n--w--w---- 1 bobo bobo 10 Jul 17 15:53 /home/bobo/programs/curl/git/name.txt\u003cbr\u003e\n--w------- 1 bobo bobo 0 Jul 19 15:53 /proc/1392/task/1392/clear_refs\u003cbr\u003e\n--w------- 1 bobo bobo 0 Jul 19 15:53 /proc/1392/clear_refs\u003cbr\u003e\n--w------- 1 bobo bobo 0 Jul 19 15:53 /proc/1403/task/1403/clear_refs\u003cbr\u003e\n--w------- 1 bobo bobo 0 Jul 19 15:53 /proc/1403/task/1626/clear_refs\u003cbr\u003e\n.\u003cbr\u003e\n.\u003cbr\u003e\n.\u003c/p\u003e\n\n\u003chr\u003e\n\n\u003cp\u003eUse case one...\u003c/p\u003e\n\n\u003cp\u003eOwner (e.g. root) has full access to the file(s)/directory in question.  Users belonging to the file(s)/directory group might have only write permission.  User(s) part of this write-only group could be tasked to do various file fetching from different end points.  A group with least privilege.  These files could be sensitive, and you don\u0026#39;t want the group members to be able to see the content or any other users content, but they must be able to put the files in the same directory.  To be really least privilege you would not even give these group members read access to the download directory (rwx-wx---), so they can\u0026#39;t even check the filenames that already exist there.\u003c/p\u003e\n\n\u003cp\u003eBefore performing curl to download, umask would be set to create write-only files.  umask 447 or something like that.\u003c/p\u003e\n\n\u003cp\u003eActions involving deleting, renaming, moving, copying, backing up the file(s) will be done with a different process running with more privileges (e.g. root).\u003c/p\u003e\n\n\u003cp\u003eIf somehow the system is hacked, and a user in this particular write-only group is the one that is hacked.  Using least privilege that user could not see what has been previously collected.  They might be able to see future downloaded data that the user is responsible to fetch if they hang around long enough to set that up, but any old data is safe. They still will not be able to see other user\u0026#39;s data.\u003c/p\u003e\n\n\u003cp\u003eThe file names are generated on the server, but there is a small chance that there might be some non-unique name that could overwrite an existing file. It is more important to not overwrite an existing file, versus successful download of the new server provided file.\u003c/p\u003e\n\n\u003chr\u003e\n\n\u003cp\u003eAs second use case...\u003c/p\u003e\n\n\u003cp\u003eA malicious server attempting to overwrite a file that might have this particular type of permission (as in previous use case), a fact discovered through some other means or just blindly attempted without the knowledge.\u003c/p\u003e\n\n\u003chr\u003e\n\n\u003cp\u003eAnd as a final use case...\u003c/p\u003e\n\n\u003cp\u003eAn accidental overwrite of an important file.  Curl documentation specifically states that if the file \u0026#39;exists\u0026#39; it will not be overwritten.\u003c/p\u003e\n\n\u003chr\u003e\n\n\u003cp\u003eSome discussion on the net about this special write-only case.\u003c/p\u003e\n\n\u003cp\u003eParticularly interesting is the mention of the \u0026quot;dropbox-like\u0026quot; discussion.  Which sounds like a variation on my use case one.\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"https://unix.stackexchange.com/questions/22577/write-access-without-read-access\" href=\"/redirect?url=https%3A%2F%2Funix.stackexchange.com%2Fquestions%2F22577%2Fwrite-access-without-read-access\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://unix.stackexchange.com/questions/22577/write-access-without-read-access\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\n\u003ca title=\"https://unix.stackexchange.com/questions/256058/what-are-the-use-cases-for-write-only-and-write-execute-files\" href=\"/redirect?url=https%3A%2F%2Funix.stackexchange.com%2Fquestions%2F256058%2Fwhat-are-the-use-cases-for-write-only-and-write-execute-files\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://unix.stackexchange.com/questions/256058/what-are-the-use-cases-for-write-only-and-write-execute-files\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\n\u003ca title=\"https://stackoverflow.com/questions/35398783/when-would-you-use-a-write-only-file\" href=\"/redirect?url=https%3A%2F%2Fstackoverflow.com%2Fquestions%2F35398783%2Fwhen-would-you-use-a-write-only-file\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://stackoverflow.com/questions/35398783/when-would-you-use-a-write-only-file\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2020-07-19T21:26:09.438Z","updated_at":"2020-07-19T21:26:09.438Z","actor":{"username":"brumbrum","cleared":false,"url":"/brumbrum","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8647277,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"\nAs far as correcting the situation.  It is rather simple.   Excellent solutions are already covered by SEI CERT C Coding Standard\n\nFIO03-C. Do not make assumptions about fopen() and file creation\n\nhttps://wiki.sei.cmu.edu/confluence/pages/viewpage.action?pageId=87152382\n\nFIO45-C. Avoid TOCTOU race conditions while accessing files\n\nhttps://wiki.sei.cmu.edu/confluence/display/c/FIO45-C.+Avoid+TOCTOU+race+conditions+while+accessing+files\n\n\n\nThese two SEI CERT Rules and Recommendations both mention that 'Coverity' scan should catch these types of errors. It would be good to check if they caught this issue on the affected lines 49-66 in src/tool_cb_wrt.c file.\n\nhttps://scan.coverity.com/projects/curl\n\n\n\n\n","markdown_message":"\u003cp\u003eAs far as correcting the situation.  It is rather simple.   Excellent solutions are already covered by SEI CERT C Coding Standard\u003c/p\u003e\n\n\u003cp\u003eFIO03-C. Do not make assumptions about fopen() and file creation\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"https://wiki.sei.cmu.edu/confluence/pages/viewpage.action?pageId=87152382\" href=\"/redirect?url=https%3A%2F%2Fwiki.sei.cmu.edu%2Fconfluence%2Fpages%2Fviewpage.action%3FpageId%3D87152382\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://wiki.sei.cmu.edu/confluence/pages/viewpage.action?pageId=87152382\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eFIO45-C. Avoid TOCTOU race conditions while accessing files\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"https://wiki.sei.cmu.edu/confluence/display/c/FIO45-C.+Avoid+TOCTOU+race+conditions+while+accessing+files\" href=\"/redirect?url=https%3A%2F%2Fwiki.sei.cmu.edu%2Fconfluence%2Fdisplay%2Fc%2FFIO45-C.%2BAvoid%2BTOCTOU%2Brace%2Bconditions%2Bwhile%2Baccessing%2Bfiles\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://wiki.sei.cmu.edu/confluence/display/c/FIO45-C.+Avoid+TOCTOU+race+conditions+while+accessing+files\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eThese two SEI CERT Rules and Recommendations both mention that \u0026#39;Coverity\u0026#39; scan should catch these types of errors. It would be good to check if they caught this issue on the affected lines 49-66 in src/tool_cb_wrt.c file.\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"https://scan.coverity.com/projects/curl\" href=\"/redirect?url=https%3A%2F%2Fscan.coverity.com%2Fprojects%2Fcurl\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://scan.coverity.com/projects/curl\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2020-07-19T21:32:46.519Z","updated_at":"2020-07-19T21:32:46.519Z","actor":{"username":"brumbrum","cleared":false,"url":"/brumbrum","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8648011,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"\nI looked for more discussions about this write-only case and found additional discussions and users wanting this type of functionality.  Don't know if these examples all apply to the specific curl usage we are discussing, but it shows that it is not a completely theoretical question.\n\nhttps://stackoverflow.com/questions/23500084/samba-write-only-share-from-windows\nhttps://stackoverflow.com/questions/34696198/write-to-a-file-without-read-permission\nhttps://stackoverflow.com/questions/17746945/unix-file-permissions-does-write-imply-read/\nhttps://stackoverflow.com/questions/38973612/how-to-set-a-file-to-write-only-or-read-only-in-msys-or-cygwin\nhttps://stackoverflow.com/questions/15076645/amazon-s3-write-only-access\n\n\nhttps://unix.stackexchange.com/questions/149184/folder-with-only-write-permission-is-useless-right\nhttps://unix.stackexchange.com/questions/552505/nano-able-to-read-on-write-only-access-file\nhttps://webapps.stackexchange.com/questions/8591/web-write-only-drop-box\nhttps://unix.stackexchange.com/questions/453541/create-samba-share-with-only-write-and-no-read-permissions\nhttps://unix.stackexchange.com/questions/92683/making-a-fat-disk-write-only-or-hidden\n\n","markdown_message":"\u003cp\u003eI looked for more discussions about this write-only case and found additional discussions and users wanting this type of functionality.  Don\u0026#39;t know if these examples all apply to the specific curl usage we are discussing, but it shows that it is not a completely theoretical question.\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"https://stackoverflow.com/questions/23500084/samba-write-only-share-from-windows\" href=\"/redirect?url=https%3A%2F%2Fstackoverflow.com%2Fquestions%2F23500084%2Fsamba-write-only-share-from-windows\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://stackoverflow.com/questions/23500084/samba-write-only-share-from-windows\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\n\u003ca title=\"https://stackoverflow.com/questions/34696198/write-to-a-file-without-read-permission\" href=\"/redirect?url=https%3A%2F%2Fstackoverflow.com%2Fquestions%2F34696198%2Fwrite-to-a-file-without-read-permission\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://stackoverflow.com/questions/34696198/write-to-a-file-without-read-permission\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\n\u003ca title=\"https://stackoverflow.com/questions/17746945/unix-file-permissions-does-write-imply-read/\" href=\"/redirect?url=https%3A%2F%2Fstackoverflow.com%2Fquestions%2F17746945%2Funix-file-permissions-does-write-imply-read%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://stackoverflow.com/questions/17746945/unix-file-permissions-does-write-imply-read/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\n\u003ca title=\"https://stackoverflow.com/questions/38973612/how-to-set-a-file-to-write-only-or-read-only-in-msys-or-cygwin\" href=\"/redirect?url=https%3A%2F%2Fstackoverflow.com%2Fquestions%2F38973612%2Fhow-to-set-a-file-to-write-only-or-read-only-in-msys-or-cygwin\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://stackoverflow.com/questions/38973612/how-to-set-a-file-to-write-only-or-read-only-in-msys-or-cygwin\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\n\u003ca title=\"https://stackoverflow.com/questions/15076645/amazon-s3-write-only-access\" href=\"/redirect?url=https%3A%2F%2Fstackoverflow.com%2Fquestions%2F15076645%2Famazon-s3-write-only-access\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://stackoverflow.com/questions/15076645/amazon-s3-write-only-access\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"https://unix.stackexchange.com/questions/149184/folder-with-only-write-permission-is-useless-right\" href=\"/redirect?url=https%3A%2F%2Funix.stackexchange.com%2Fquestions%2F149184%2Ffolder-with-only-write-permission-is-useless-right\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://unix.stackexchange.com/questions/149184/folder-with-only-write-permission-is-useless-right\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\n\u003ca title=\"https://unix.stackexchange.com/questions/552505/nano-able-to-read-on-write-only-access-file\" href=\"/redirect?url=https%3A%2F%2Funix.stackexchange.com%2Fquestions%2F552505%2Fnano-able-to-read-on-write-only-access-file\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://unix.stackexchange.com/questions/552505/nano-able-to-read-on-write-only-access-file\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\n\u003ca title=\"https://webapps.stackexchange.com/questions/8591/web-write-only-drop-box\" href=\"/redirect?url=https%3A%2F%2Fwebapps.stackexchange.com%2Fquestions%2F8591%2Fweb-write-only-drop-box\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://webapps.stackexchange.com/questions/8591/web-write-only-drop-box\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\n\u003ca title=\"https://unix.stackexchange.com/questions/453541/create-samba-share-with-only-write-and-no-read-permissions\" href=\"/redirect?url=https%3A%2F%2Funix.stackexchange.com%2Fquestions%2F453541%2Fcreate-samba-share-with-only-write-and-no-read-permissions\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://unix.stackexchange.com/questions/453541/create-samba-share-with-only-write-and-no-read-permissions\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\n\u003ca title=\"https://unix.stackexchange.com/questions/92683/making-a-fat-disk-write-only-or-hidden\" href=\"/redirect?url=https%3A%2F%2Funix.stackexchange.com%2Fquestions%2F92683%2Fmaking-a-fat-disk-write-only-or-hidden\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://unix.stackexchange.com/questions/92683/making-a-fat-disk-write-only-or-hidden\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2020-07-20T04:28:50.119Z","updated_at":"2020-07-20T04:29:30.819Z","actor":{"username":"brumbrum","cleared":false,"url":"/brumbrum","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8649324,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I'll then just note that it is very very rare that files are *intentionally* set to be writable but not readable.\n\nThe existing check in curl will never be perfect and perhaps we should work on making the language in the documentation explain that better to make sure user don't try to rely on it to be perfect.  The TOCTOU for example is perhaps a good example of that. If there's a race of which program that creates the given file, TOCTOU is not the problem. The problem is then that a user would use a file but have no idea of which program/system that created it - which seems like a terrible thing much worse than TOCTOU...","markdown_message":"\u003cp\u003eI\u0026#39;ll then just note that it is very very rare that files are \u003cem\u003eintentionally\u003c/em\u003e set to be writable but not readable.\u003c/p\u003e\n\n\u003cp\u003eThe existing check in curl will never be perfect and perhaps we should work on making the language in the documentation explain that better to make sure user don\u0026#39;t try to rely on it to be perfect.  The TOCTOU for example is perhaps a good example of that. If there\u0026#39;s a race of which program that creates the given file, TOCTOU is not the problem. The problem is then that a user would use a file but have no idea of which program/system that created it - which seems like a terrible thing much worse than TOCTOU...\u003c/p\u003e\n","automated_response":false,"created_at":"2020-07-20T08:31:27.171Z","updated_at":"2020-07-20T08:31:27.171Z","actor":{"username":"bagder","cleared":false,"url":"/bagder","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/459/380/963f64725677dda4f5113219588e7d0c1ab9abaa_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8654315,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"\nAs write-only permission file being very very rare, you are most likely correct.  On the other hand, someone using this type of file permission is doing something special (e.g. anonymous dropbox) or handling some important data/function (e.g. whistle blower site) or sensitive data (e.g. security logs, billing files, audit files, backups). Maybe not the most common cases of curl usage, but their existence might be kept quiet due to the sensitive nature.\n\nThe solution developers have decided to use curl to implement their project and trusting their data to the software quality.  They may be using the software for years and may have already suffered this data loss without even being aware as there is no obvious failure except that a file gets overwritten quietly. If they haven't implement any thorough audits/tests, double checking curls work, then they are living in bliss, until someone eventually realizes the data loss after some expensive investigation and then depending on the data type it might be discovered that millions/billions of dollars/euros/etc... of billing data was lost over time, or some data loss results in fines (or worse) as it is considers mishandling of data in some government/industry regulation that requires strict data retention.\n\nhttps://en.wikipedia.org/wiki/Data_retention\n\n\nI would like to add that the TOCTOU issue is for what is being considered the more common case of readable files.  As the write-only files are already invisible to the existing code.  Two parallel curl process in a race condition, each connecting to a different end point, and downloading a file with exactly the same name, both would return success, but only one of the file would be stored.  One file will be lost.  What should have happen is that one file would be stored and the other should fail, leading to being reattempted using some other name (e.g. the server has a way to be told by the client to provide a different name); or at the very least the curl failure being logged to get someone to investigate what is going on.\n\n\nBoth these issues, need one fix. Why not make the code more robust and check for file existence in a more generic way (already clearly documented by SEI CERT)?  It does not appear to be too difficult (e.g. using \"x\" in fopen() mode if C11 support required, or open() with secure options+fdopen() ), and maybe might solve some other issue(s) I haven't thought of.\n\n\nDocumenting this situation and closing the case is an easy solution.  Not very secure, but convenient.\n","markdown_message":"\u003cp\u003eAs write-only permission file being very very rare, you are most likely correct.  On the other hand, someone using this type of file permission is doing something special (e.g. anonymous dropbox) or handling some important data/function (e.g. whistle blower site) or sensitive data (e.g. security logs, billing files, audit files, backups). Maybe not the most common cases of curl usage, but their existence might be kept quiet due to the sensitive nature.\u003c/p\u003e\n\n\u003cp\u003eThe solution developers have decided to use curl to implement their project and trusting their data to the software quality.  They may be using the software for years and may have already suffered this data loss without even being aware as there is no obvious failure except that a file gets overwritten quietly. If they haven\u0026#39;t implement any thorough audits/tests, double checking curls work, then they are living in bliss, until someone eventually realizes the data loss after some expensive investigation and then depending on the data type it might be discovered that millions/billions of dollars/euros/etc... of billing data was lost over time, or some data loss results in fines (or worse) as it is considers mishandling of data in some government/industry regulation that requires strict data retention.\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"https://en.wikipedia.org/wiki/Data_retention\" href=\"/redirect?url=https%3A%2F%2Fen.wikipedia.org%2Fwiki%2FData_retention\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://en.wikipedia.org/wiki/Data_retention\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eI would like to add that the TOCTOU issue is for what is being considered the more common case of readable files.  As the write-only files are already invisible to the existing code.  Two parallel curl process in a race condition, each connecting to a different end point, and downloading a file with exactly the same name, both would return success, but only one of the file would be stored.  One file will be lost.  What should have happen is that one file would be stored and the other should fail, leading to being reattempted using some other name (e.g. the server has a way to be told by the client to provide a different name); or at the very least the curl failure being logged to get someone to investigate what is going on.\u003c/p\u003e\n\n\u003cp\u003eBoth these issues, need one fix. Why not make the code more robust and check for file existence in a more generic way (already clearly documented by SEI CERT)?  It does not appear to be too difficult (e.g. using \u0026quot;x\u0026quot; in fopen() mode if C11 support required, or open() with secure options+fdopen() ), and maybe might solve some other issue(s) I haven\u0026#39;t thought of.\u003c/p\u003e\n\n\u003cp\u003eDocumenting this situation and closing the case is an easy solution.  Not very secure, but convenient.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-07-20T15:13:58.605Z","updated_at":"2020-07-20T15:13:58.605Z","actor":{"username":"brumbrum","cleared":false,"url":"/brumbrum","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8657138,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Some of the comments focus on the poorly implemented server that I describe, maybe sending out duplicate file names. I agree a robust server should generate a really unique filename. Then again, maybe we don't control the server and we are stuck with the way it already works, from time to time having some duplicate file name or some other poor naming structure. If a duplicate name occurs for readable files, the curl client will clearly fail, and some action can be taken, but if this happens for write-only it would cause data loss as curl would just quietly overwrite.\n\nA solution could involve retrieval of log files from multiple hosts and the various servers on the hosts may not be aware they are duplicating file names in their responses.  Yes maybe the client side should be more robust and dedicate different directories for each host, but if they are not aware of the curl fault so may mistakenly throw everything into the same directory and letting the curl failure tell then about the duplicate name, which will not be triggered for a write-only solution.\n\n-----------------------\n\nOur server could be malicious or hacked; and the controlling party is aware of this particular vulnerability of write-only files in the curl client and crafts the filename to overwrite files that it knows or guesses might be present in the client and known to be write-only, in order to delete some previously downloaded data it wants to destroy.\n\nOr the malicious server could ALWAYS send the SAME filename in the Content-Disposition, where it knows the client has these write-only type files, resulting in only one file being stored, causing many/several files overwriting each other.  They might also do this in a selective manner to not be too obvious.   Maybe only causing overwrite of certain files they don't want to be saved.\n\nBoth above hacks could also be easy to MITM if using HTTP (without the TLS) as the packet data manipulation might only involve setting the filename in the header, and leaving the data alone.  Manipulating the data might be noticed as it could be encrypted/signed, but the headers are in clear text and unsigned.\n\n-----------------------\n\nIf a malicious server responds with the same file name to curl client side with a similar local readable file, then obviously this will cause failure and be noticed.  If somehow the TOCTOU race condition could be reliably triggered in the client (e.g. the client system is performing a heavy number of 'curl' calls) they might even be able to cause loss of readable files.  Probably difficult, but possible.\n\n","markdown_message":"\u003cp\u003eSome of the comments focus on the poorly implemented server that I describe, maybe sending out duplicate file names. I agree a robust server should generate a really unique filename. Then again, maybe we don\u0026#39;t control the server and we are stuck with the way it already works, from time to time having some duplicate file name or some other poor naming structure. If a duplicate name occurs for readable files, the curl client will clearly fail, and some action can be taken, but if this happens for write-only it would cause data loss as curl would just quietly overwrite.\u003c/p\u003e\n\n\u003cp\u003eA solution could involve retrieval of log files from multiple hosts and the various servers on the hosts may not be aware they are duplicating file names in their responses.  Yes maybe the client side should be more robust and dedicate different directories for each host, but if they are not aware of the curl fault so may mistakenly throw everything into the same directory and letting the curl failure tell then about the duplicate name, which will not be triggered for a write-only solution.\u003c/p\u003e\n\n\u003chr\u003e\n\n\u003cp\u003eOur server could be malicious or hacked; and the controlling party is aware of this particular vulnerability of write-only files in the curl client and crafts the filename to overwrite files that it knows or guesses might be present in the client and known to be write-only, in order to delete some previously downloaded data it wants to destroy.\u003c/p\u003e\n\n\u003cp\u003eOr the malicious server could ALWAYS send the SAME filename in the Content-Disposition, where it knows the client has these write-only type files, resulting in only one file being stored, causing many/several files overwriting each other.  They might also do this in a selective manner to not be too obvious.   Maybe only causing overwrite of certain files they don\u0026#39;t want to be saved.\u003c/p\u003e\n\n\u003cp\u003eBoth above hacks could also be easy to MITM if using HTTP (without the TLS) as the packet data manipulation might only involve setting the filename in the header, and leaving the data alone.  Manipulating the data might be noticed as it could be encrypted/signed, but the headers are in clear text and unsigned.\u003c/p\u003e\n\n\u003chr\u003e\n\n\u003cp\u003eIf a malicious server responds with the same file name to curl client side with a similar local readable file, then obviously this will cause failure and be noticed.  If somehow the TOCTOU race condition could be reliably triggered in the client (e.g. the client system is performing a heavy number of \u0026#39;curl\u0026#39; calls) they might even be able to cause loss of readable files.  Probably difficult, but possible.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-07-20T19:14:01.120Z","updated_at":"2020-07-20T19:14:01.120Z","actor":{"username":"brumbrum","cleared":false,"url":"/brumbrum","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8659459,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I just saw your recent wolfssl youtube video where you discuss Curl testing and security. Very informative. Thanks for making it.\n\nI like the mention of C90 as being your reference C standard that you follow. Was wondering if that or some other standard (e.g. POSIX) is what causes you to pause at implementing any solution.  I know the SEI CERT is suggesting various solutions to solve the problem, are they useful or not going to work as being incompatible with the \"Curl code style\" or is some platform you are supporting the bottleneck? I'm sure a solution of some kind is possible, just is the desire to fix it there.\n\nAfter all my numerous posts (sorry for that), do you still consider this report of low impact, and highly unlikely to occur in the billions of deployed clients?  Is this why you just want to document it?\n\nDo you need anything else from me?\n\nHow do you want to move forward on this report?\n\n","markdown_message":"\u003cp\u003eI just saw your recent wolfssl youtube video where you discuss Curl testing and security. Very informative. Thanks for making it.\u003c/p\u003e\n\n\u003cp\u003eI like the mention of C90 as being your reference C standard that you follow. Was wondering if that or some other standard (e.g. POSIX) is what causes you to pause at implementing any solution.  I know the SEI CERT is suggesting various solutions to solve the problem, are they useful or not going to work as being incompatible with the \u0026quot;Curl code style\u0026quot; or is some platform you are supporting the bottleneck? I\u0026#39;m sure a solution of some kind is possible, just is the desire to fix it there.\u003c/p\u003e\n\n\u003cp\u003eAfter all my numerous posts (sorry for that), do you still consider this report of low impact, and highly unlikely to occur in the billions of deployed clients?  Is this why you just want to document it?\u003c/p\u003e\n\n\u003cp\u003eDo you need anything else from me?\u003c/p\u003e\n\n\u003cp\u003eHow do you want to move forward on this report?\u003c/p\u003e\n","automated_response":false,"created_at":"2020-07-21T02:01:55.094Z","updated_at":"2020-07-21T02:01:55.094Z","actor":{"username":"brumbrum","cleared":false,"url":"/brumbrum","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8661767,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I don't \"pause at implementing a solution\" at all. This discussion is about the **security angle** of the bug you've reported. I don't think anyone of us has yet said a word about how this should or shouldn't be fixed. Also, I'm personally on vacation now so I'm not in a hurry to reach a conclusion, I'm only concerned about getting it done right.\n\nThe discussion I'm focusing on here is if this is a **security issue** or a plain **bug**.\n\nWhy I'm currently leaning towards plain \"bug\": If someone would implement system with a file that is user-accessible but write-only (not readable) by a user), then it seems very strange and terribly weak to rely on different tools to not ever write to that file in the wrong way. You wouldn't implement any secure system that way.\n\n(I've never even heard of \"SEI CERT\" so I can't comment on that.)\n\n(and regarding billions of clients, this bug is limited to the command line tool which is not typically used by the billions of libcurl users)","markdown_message":"\u003cp\u003eI don\u0026#39;t \u0026quot;pause at implementing a solution\u0026quot; at all. This discussion is about the \u003cstrong\u003esecurity angle\u003c/strong\u003e of the bug you\u0026#39;ve reported. I don\u0026#39;t think anyone of us has yet said a word about how this should or shouldn\u0026#39;t be fixed. Also, I\u0026#39;m personally on vacation now so I\u0026#39;m not in a hurry to reach a conclusion, I\u0026#39;m only concerned about getting it done right.\u003c/p\u003e\n\n\u003cp\u003eThe discussion I\u0026#39;m focusing on here is if this is a \u003cstrong\u003esecurity issue\u003c/strong\u003e or a plain \u003cstrong\u003ebug\u003c/strong\u003e.\u003c/p\u003e\n\n\u003cp\u003eWhy I\u0026#39;m currently leaning towards plain \u0026quot;bug\u0026quot;: If someone would implement system with a file that is user-accessible but write-only (not readable) by a user), then it seems very strange and terribly weak to rely on different tools to not ever write to that file in the wrong way. You wouldn\u0026#39;t implement any secure system that way.\u003c/p\u003e\n\n\u003cp\u003e(I\u0026#39;ve never even heard of \u0026quot;SEI CERT\u0026quot; so I can\u0026#39;t comment on that.)\u003c/p\u003e\n\n\u003cp\u003e(and regarding billions of clients, this bug is limited to the command line tool which is not typically used by the billions of libcurl users)\u003c/p\u003e\n","automated_response":false,"created_at":"2020-07-21T09:13:37.629Z","updated_at":"2020-07-21T09:13:37.629Z","actor":{"username":"bagder","cleared":false,"url":"/bagder","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/459/380/963f64725677dda4f5113219588e7d0c1ab9abaa_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8661815,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Having read through, and pondered over, the evidence posted I too lean towards classifying this as bug. I don't consider this a security vulnerability.","markdown_message":"\u003cp\u003eHaving read through, and pondered over, the evidence posted I too lean towards classifying this as bug. I don\u0026#39;t consider this a security vulnerability.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-07-21T09:22:18.325Z","updated_at":"2020-07-21T09:22:18.325Z","actor":{"username":"dgustafsson","cleared":false,"url":"/dgustafsson","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8662929,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you for the feedback. Take all the time you want to handle this issue. Have a great vacation.\n\nP.S. Is there any part of the code that you suggest I should review that could be a source of important security bugs?","markdown_message":"\u003cp\u003eThank you for the feedback. Take all the time you want to handle this issue. Have a great vacation.\u003c/p\u003e\n\n\u003cp\u003eP.S. Is there any part of the code that you suggest I should review that could be a source of important security bugs?\u003c/p\u003e\n","automated_response":false,"created_at":"2020-07-21T11:51:07.336Z","updated_at":"2020-07-21T11:51:07.336Z","actor":{"username":"brumbrum","cleared":false,"url":"/brumbrum","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8663087,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"\u003e P.S. Is there any part of the code that you suggest I should review that could be a source of important security bugs?\n\nThat is an impossible question to answer, since if we knew of any such parts we'd have reviewed already.","markdown_message":"\u003cblockquote\u003e\n\u003cp\u003eP.S. Is there any part of the code that you suggest I should review that could be a source of important security bugs?\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eThat is an impossible question to answer, since if we knew of any such parts we\u0026#39;d have reviewed already.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-07-21T12:17:06.774Z","updated_at":"2020-07-21T12:17:06.774Z","actor":{"username":"dgustafsson","cleared":false,"url":"/dgustafsson","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8663336,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"All right. Thank you!","markdown_message":"\u003cp\u003eAll right. Thank you!\u003c/p\u003e\n","automated_response":false,"created_at":"2020-07-21T12:50:25.150Z","updated_at":"2020-07-21T12:50:25.150Z","actor":{"username":"brumbrum","cleared":false,"url":"/brumbrum","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8763544,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"Thanks a lot @brumbrum !\n\nThis problem is now dealt with as a PR here: https://github.com/curl/curl/pull/5731","markdown_message":"\u003cp\u003eThanks a lot \u003ca href=\"/brumbrum\"\u003e@brumbrum\u003c/a\u003e !\u003c/p\u003e\n\n\u003cp\u003eThis problem is now dealt with as a PR here: \u003ca title=\"https://github.com/curl/curl/pull/5731\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fcurl%2Fcurl%2Fpull%2F5731\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/curl/curl/pull/5731\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2020-07-27T10:49:19.615Z","updated_at":"2020-07-27T10:49:19.615Z","actor":{"username":"bagder","cleared":false,"url":"/bagder","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/459/380/963f64725677dda4f5113219588e7d0c1ab9abaa_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8764079,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Glad to have contributed to curl's quality.\n","markdown_message":"\u003cp\u003eGlad to have contributed to curl\u0026#39;s quality.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-07-27T11:51:13.337Z","updated_at":"2020-07-27T11:51:13.337Z","actor":{"username":"brumbrum","cleared":false,"url":"/brumbrum","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8764260,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"A few updates from my side:\n\nI was easily able to reproduce the race condition on readable files.  If you are interested in my findings I can post them.\n\nI am exploring the potential for using this issue as part of a social engineering attack.  Seems that it could be possible to do in some very specific situations.  Would any results be useful to you?\n","markdown_message":"\u003cp\u003eA few updates from my side:\u003c/p\u003e\n\n\u003cp\u003eI was easily able to reproduce the race condition on readable files.  If you are interested in my findings I can post them.\u003c/p\u003e\n\n\u003cp\u003eI am exploring the potential for using this issue as part of a social engineering attack.  Seems that it could be possible to do in some very specific situations.  Would any results be useful to you?\u003c/p\u003e\n","automated_response":false,"created_at":"2020-07-27T12:08:29.784Z","updated_at":"2020-07-27T12:08:29.784Z","actor":{"username":"brumbrum","cleared":false,"url":"/brumbrum","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8765868,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I am easily able to reproduce the previously discussed Content-Disposition race condition issue under Ubuntu 20.04, where this race condition could overwrite the content of any readable file.  I am also able to get the content of the two downloads with same filename, combined into one file.\n\nAttaching the bash script to reproduce, see create_race.sh.txt\nAttaching the golong httpserver, see racecond_httpserver.go.txt\n\nStart two copies of the http server, with different ports (default 8000 and 8001).  Note: These servers will provide \"files\" with 10000 lines with a unique strings reflected (either \"Alice\" or \"Bob\" in our case), in order to detect which of the two downloads was successful or if the data intermixed into one file.\n\n./racecond_httpserver\n./racecond_httpserver 127.0.0.1:8001\n\n\nSample log of create_race.sh script:\n\nobo@bobo-VirtualBox:~/programs/curl/race_cond1$ ./create_race.sh \ncurl worked correctly 10 time(s)\n0 0 Race Condition occurred - both Alice (1927) and Bob (8521) data found\ncurl worked correctly 20 time(s)\n0 0 Race Condition occurred - both Alice (526) and Bob (10000) data found\ncurl worked correctly 3 time(s)\n0 0 Race Condition occurred - only Alice (10000) data found\ncurl worked correctly 4 time(s)\n0 0 Race Condition occurred - both Alice (6131) and Bob (4083) data found\ncurl worked correctly 6 time(s)\n0 0 Race Condition occurred - both Alice (526) and Bob (10000) data found\ncurl worked correctly 26 time(s)\n0 0 Race Condition occurred - both Alice (8275) and Bob (1821) data found","markdown_message":"\u003cp\u003eI am easily able to reproduce the previously discussed Content-Disposition race condition issue under Ubuntu 20.04, where this race condition could overwrite the content of any readable file.  I am also able to get the content of the two downloads with same filename, combined into one file.\u003c/p\u003e\n\n\u003cp\u003eAttaching the bash script to reproduce, see create_race.sh.txt\u003cbr\u003e\nAttaching the golong httpserver, see racecond_httpserver.go.txt\u003c/p\u003e\n\n\u003cp\u003eStart two copies of the http server, with different ports (default 8000 and 8001).  Note: These servers will provide \u0026quot;files\u0026quot; with 10000 lines with a unique strings reflected (either \u0026quot;Alice\u0026quot; or \u0026quot;Bob\u0026quot; in our case), in order to detect which of the two downloads was successful or if the data intermixed into one file.\u003c/p\u003e\n\n\u003cp\u003e./racecond_httpserver\u003cbr\u003e\n./racecond_httpserver 127.0.0.1:8001\u003c/p\u003e\n\n\u003cp\u003eSample log of create_race.sh script:\u003c/p\u003e\n\n\u003cp\u003eobo@bobo-VirtualBox:~/programs/curl/race_cond1$ ./create_race.sh \u003cbr\u003e\ncurl worked correctly 10 time(s)\u003cbr\u003e\n0 0 Race Condition occurred - both Alice (1927) and Bob (8521) data found\u003cbr\u003e\ncurl worked correctly 20 time(s)\u003cbr\u003e\n0 0 Race Condition occurred - both Alice (526) and Bob (10000) data found\u003cbr\u003e\ncurl worked correctly 3 time(s)\u003cbr\u003e\n0 0 Race Condition occurred - only Alice (10000) data found\u003cbr\u003e\ncurl worked correctly 4 time(s)\u003cbr\u003e\n0 0 Race Condition occurred - both Alice (6131) and Bob (4083) data found\u003cbr\u003e\ncurl worked correctly 6 time(s)\u003cbr\u003e\n0 0 Race Condition occurred - both Alice (526) and Bob (10000) data found\u003cbr\u003e\ncurl worked correctly 26 time(s)\u003cbr\u003e\n0 0 Race Condition occurred - both Alice (8275) and Bob (1821) data found\u003c/p\u003e\n","automated_response":false,"created_at":"2020-07-27T12:59:08.667Z","updated_at":"2020-07-27T12:59:08.667Z","actor":{"username":"brumbrum","cleared":false,"url":"/brumbrum","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"attachments":[{"id":925232,"filename":"create_race.sh.txt","type":"text/plain","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/AxWvSkVADenC6ZGwUV7uzNNz?response-content-disposition=attachment%3B%20filename%3D%22create_race.sh.txt%22%3B%20filename%2A%3DUTF-8%27%27create_race.sh.txt\u0026response-content-type=text%2Fplain\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQWUZQJ45V%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T071208Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIGx%2BIUT7BwvgKFRF%2FM2q4UxRB6Xuz453wfpVuGy9AO4LAiEA321QrCacxavrlJY0PoJQadyBcwnLa4%2B40wf5mhY2y1cqtAMIVxABGgwwMTM2MTkyNzQ4NDkiDPvv6XizBwfbImptqSqRA5e2LaAoyIQ8CwztoX0QBAon9EyU5hcKWW7M87r%2BH6ta1kFKal0IOe0GqWgIQTfVrNQIAYYWeNWIAyEOKS5vyXMSyNEN6p0DPLv74tw04SmndG8V5zwiFJCBjoG56jaXP5Y7oEBqyTcqO%2FlqzWd98T2OnRF3%2B0lSQVd51cmqnjNMdcFaNgWYmFuA%2FCVQvz9ElGUIjOcH5a6VZ3HnVxiKQw5ANC%2BfyWR78GB3ReUQqSKHKPcFRii4RKE7SdfkQBlRRnjBGvOveHmUoI6XopqPosxJaBvCjmC6t1OorWN4ohU9CiRV6UFtoQ4jyvAlZG0yQF3zHW4NlU1zOoSsH0YU1cWEpQIkuVZ%2FRZ%2BY%2FM%2BOXr%2BOeTaSHLH5H5yqZNLFEStZhfx3gwXFI2TYxnMUHmvPbnvnIEJ9WOys0FzCvRls%2Fp0hFtJcXMIyQAqc0WHyjjaRxwM%2FAl72J5maAaRcYeXI4xgQYGjao3i2y3eDvBg2hSi2DXWmZUnMhd53u6wfyIfCzKLKgJTM630ec8%2BGCAu0r%2FL5MM2Pq%2F8FOusBdLHJDdGmQTYC9Ej0fNaIxV5wYb8ByhUKiutiv%2FqgstE1ft6A6M6nDxaliZEqjMKcOTnEaz2VqagbADyA7kMjT8mpA98fME%2BWYwpzFYy%2Bllj%2F%2FaLcME%2FvDR9tn3jF8zJtPugh3uDiKpGvLurFUe3Sl24ZFTLMWgj7V0tQQHNC%2FOypp%2F6fgwLn4iNGNfurOGv%2BtW%2FSTVsmD6xFpfEpNO8DZrXWyube5Y8d69QKldJrmJOkEbDcT2y05eDupgkO1UB9qqOv46KLqIJ5SQ5J%2BQO7Qx8HZk4Sjb41MM7fUnJqCm6JXwYfNYtCGOr0eA%3D%3D\u0026X-Amz-Signature=72a34f76f47dfe452cd3e2c435838d7443a378bcbb06cb3ea21b450a83ebc60c"}],"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8765885,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Forgot the attachment for the http server.","markdown_message":"\u003cp\u003eForgot the attachment for the http server.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-07-27T12:59:52.689Z","updated_at":"2020-07-27T12:59:52.689Z","actor":{"username":"brumbrum","cleared":false,"url":"/brumbrum","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"attachments":[{"id":925234,"filename":"racecond_httpserver.go.txt","type":"text/plain","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/ejDNBqZccYmnUb1u1MRNPj5P?response-content-disposition=attachment%3B%20filename%3D%22racecond_httpserver.go.txt%22%3B%20filename%2A%3DUTF-8%27%27racecond_httpserver.go.txt\u0026response-content-type=text%2Fplain\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQWUZQJ45V%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T071208Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIGx%2BIUT7BwvgKFRF%2FM2q4UxRB6Xuz453wfpVuGy9AO4LAiEA321QrCacxavrlJY0PoJQadyBcwnLa4%2B40wf5mhY2y1cqtAMIVxABGgwwMTM2MTkyNzQ4NDkiDPvv6XizBwfbImptqSqRA5e2LaAoyIQ8CwztoX0QBAon9EyU5hcKWW7M87r%2BH6ta1kFKal0IOe0GqWgIQTfVrNQIAYYWeNWIAyEOKS5vyXMSyNEN6p0DPLv74tw04SmndG8V5zwiFJCBjoG56jaXP5Y7oEBqyTcqO%2FlqzWd98T2OnRF3%2B0lSQVd51cmqnjNMdcFaNgWYmFuA%2FCVQvz9ElGUIjOcH5a6VZ3HnVxiKQw5ANC%2BfyWR78GB3ReUQqSKHKPcFRii4RKE7SdfkQBlRRnjBGvOveHmUoI6XopqPosxJaBvCjmC6t1OorWN4ohU9CiRV6UFtoQ4jyvAlZG0yQF3zHW4NlU1zOoSsH0YU1cWEpQIkuVZ%2FRZ%2BY%2FM%2BOXr%2BOeTaSHLH5H5yqZNLFEStZhfx3gwXFI2TYxnMUHmvPbnvnIEJ9WOys0FzCvRls%2Fp0hFtJcXMIyQAqc0WHyjjaRxwM%2FAl72J5maAaRcYeXI4xgQYGjao3i2y3eDvBg2hSi2DXWmZUnMhd53u6wfyIfCzKLKgJTM630ec8%2BGCAu0r%2FL5MM2Pq%2F8FOusBdLHJDdGmQTYC9Ej0fNaIxV5wYb8ByhUKiutiv%2FqgstE1ft6A6M6nDxaliZEqjMKcOTnEaz2VqagbADyA7kMjT8mpA98fME%2BWYwpzFYy%2Bllj%2F%2FaLcME%2FvDR9tn3jF8zJtPugh3uDiKpGvLurFUe3Sl24ZFTLMWgj7V0tQQHNC%2FOypp%2F6fgwLn4iNGNfurOGv%2BtW%2FSTVsmD6xFpfEpNO8DZrXWyube5Y8d69QKldJrmJOkEbDcT2y05eDupgkO1UB9qqOv46KLqIJ5SQ5J%2BQO7Qx8HZk4Sjb41MM7fUnJqCm6JXwYfNYtCGOr0eA%3D%3D\u0026X-Amz-Signature=3d5b02c1ea2a472ebf99ebbdb854f29b84c2992e7d50f15382307d5138db6c09"}],"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8766462,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Providing you with my social engineering attack example.  Maybe you will consider the likelyhood of success low, but I guess that would depend on the skills of the hacker, the victim's susceptibility to be tricked, and the other specifics related the situation.\n\nAttaching it as a PDF.","markdown_message":"\u003cp\u003eProviding you with my social engineering attack example.  Maybe you will consider the likelyhood of success low, but I guess that would depend on the skills of the hacker, the victim\u0026#39;s susceptibility to be tricked, and the other specifics related the situation.\u003c/p\u003e\n\n\u003cp\u003eAttaching it as a PDF.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-07-27T13:43:48.453Z","updated_at":"2020-07-27T13:43:48.453Z","actor":{"username":"brumbrum","cleared":false,"url":"/brumbrum","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"attachments":[{"id":925336,"filename":"curl_overwrite_social_engineering.pdf","type":"application/pdf","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/zmdM7gGFos1RkhGXkL4zpFdK?response-content-disposition=attachment%3B%20filename%3D%22curl_overwrite_social_engineering.pdf%22%3B%20filename%2A%3DUTF-8%27%27curl_overwrite_social_engineering.pdf\u0026response-content-type=application%2Fpdf\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQWUZQJ45V%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T071208Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIGx%2BIUT7BwvgKFRF%2FM2q4UxRB6Xuz453wfpVuGy9AO4LAiEA321QrCacxavrlJY0PoJQadyBcwnLa4%2B40wf5mhY2y1cqtAMIVxABGgwwMTM2MTkyNzQ4NDkiDPvv6XizBwfbImptqSqRA5e2LaAoyIQ8CwztoX0QBAon9EyU5hcKWW7M87r%2BH6ta1kFKal0IOe0GqWgIQTfVrNQIAYYWeNWIAyEOKS5vyXMSyNEN6p0DPLv74tw04SmndG8V5zwiFJCBjoG56jaXP5Y7oEBqyTcqO%2FlqzWd98T2OnRF3%2B0lSQVd51cmqnjNMdcFaNgWYmFuA%2FCVQvz9ElGUIjOcH5a6VZ3HnVxiKQw5ANC%2BfyWR78GB3ReUQqSKHKPcFRii4RKE7SdfkQBlRRnjBGvOveHmUoI6XopqPosxJaBvCjmC6t1OorWN4ohU9CiRV6UFtoQ4jyvAlZG0yQF3zHW4NlU1zOoSsH0YU1cWEpQIkuVZ%2FRZ%2BY%2FM%2BOXr%2BOeTaSHLH5H5yqZNLFEStZhfx3gwXFI2TYxnMUHmvPbnvnIEJ9WOys0FzCvRls%2Fp0hFtJcXMIyQAqc0WHyjjaRxwM%2FAl72J5maAaRcYeXI4xgQYGjao3i2y3eDvBg2hSi2DXWmZUnMhd53u6wfyIfCzKLKgJTM630ec8%2BGCAu0r%2FL5MM2Pq%2F8FOusBdLHJDdGmQTYC9Ej0fNaIxV5wYb8ByhUKiutiv%2FqgstE1ft6A6M6nDxaliZEqjMKcOTnEaz2VqagbADyA7kMjT8mpA98fME%2BWYwpzFYy%2Bllj%2F%2FaLcME%2FvDR9tn3jF8zJtPugh3uDiKpGvLurFUe3Sl24ZFTLMWgj7V0tQQHNC%2FOypp%2F6fgwLn4iNGNfurOGv%2BtW%2FSTVsmD6xFpfEpNO8DZrXWyube5Y8d69QKldJrmJOkEbDcT2y05eDupgkO1UB9qqOv46KLqIJ5SQ5J%2BQO7Qx8HZk4Sjb41MM7fUnJqCm6JXwYfNYtCGOr0eA%3D%3D\u0026X-Amz-Signature=2eab62769a24cd8f99a1e1d10b6acae2a688da95c52d2ca70c336ccf82550c66"}],"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8766533,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I did test some of the more popular and common browsers in Ubuntu 20.04 and they handle this write-only file situation well, automatically using a different file name if Content-Disposition filename is already taken.\n\nNaming the files like this\n\n-rw-rw-r-- 1 bobo bobo 359964 Jul 26 23:16 'data(1).txt'\n-rw-rw-r-- 1 bobo bobo 359964 Jul 26 23:16 'data(2).txt'\n-rw-rw-r-- 1 bobo bobo 359964 Jul 26 23:16 'data(3).txt'\n-rw-rw-r-- 1 bobo bobo 359964 Jul 26 23:17 'data(4).txt'\n--w--w---- 1 bobo bobo 359964 Jul 25 20:16  data.txt\n\nor\n\n-rw-rw-r-- 1 bobo bobo 359964 Jul 26 23:19 'data (1).txt'\n-rw-rw-r-- 1 bobo bobo 359964 Jul 26 23:21 'data (2).txt'\n-rw-rw-r-- 1 bobo bobo 359964 Jul 26 23:21 'data (3).txt'\n-rw-rw-r-- 1 bobo bobo 359964 Jul 26 23:21 'data (4).txt'\n--w--w---- 1 bobo bobo 359964 Jul 25 20:16  data.txt\n\n","markdown_message":"\u003cp\u003eI did test some of the more popular and common browsers in Ubuntu 20.04 and they handle this write-only file situation well, automatically using a different file name if Content-Disposition filename is already taken.\u003c/p\u003e\n\n\u003cp\u003eNaming the files like this\u003c/p\u003e\n\n\u003cp\u003e-rw-rw-r-- 1 bobo bobo 359964 Jul 26 23:16 \u0026#39;data(1).txt\u0026#39;\u003cbr\u003e\n-rw-rw-r-- 1 bobo bobo 359964 Jul 26 23:16 \u0026#39;data(2).txt\u0026#39;\u003cbr\u003e\n-rw-rw-r-- 1 bobo bobo 359964 Jul 26 23:16 \u0026#39;data(3).txt\u0026#39;\u003cbr\u003e\n-rw-rw-r-- 1 bobo bobo 359964 Jul 26 23:17 \u0026#39;data(4).txt\u0026#39;\u003cbr\u003e\n--w--w---- 1 bobo bobo 359964 Jul 25 20:16  data.txt\u003c/p\u003e\n\n\u003cp\u003eor\u003c/p\u003e\n\n\u003cp\u003e-rw-rw-r-- 1 bobo bobo 359964 Jul 26 23:19 \u0026#39;data (1).txt\u0026#39;\u003cbr\u003e\n-rw-rw-r-- 1 bobo bobo 359964 Jul 26 23:21 \u0026#39;data (2).txt\u0026#39;\u003cbr\u003e\n-rw-rw-r-- 1 bobo bobo 359964 Jul 26 23:21 \u0026#39;data (3).txt\u0026#39;\u003cbr\u003e\n-rw-rw-r-- 1 bobo bobo 359964 Jul 26 23:21 \u0026#39;data (4).txt\u0026#39;\u003cbr\u003e\n--w--w---- 1 bobo bobo 359964 Jul 25 20:16  data.txt\u003c/p\u003e\n","automated_response":false,"created_at":"2020-07-27T13:48:12.839Z","updated_at":"2020-07-27T13:48:12.839Z","actor":{"username":"brumbrum","cleared":false,"url":"/brumbrum","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8766740,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"The described social engineering attack is very convoluted. If an attacker can trick their victim to run various commands that they don't understand in order to prepare for the attack, then the victim is already had. You don't need any curl exploit then! It would be much easier to just trick them to download a script with a crafty name and run that.\n\n\u003e common browsers handle this\n\nWe already agreed this is a bug, right?","markdown_message":"\u003cp\u003eThe described social engineering attack is very convoluted. If an attacker can trick their victim to run various commands that they don\u0026#39;t understand in order to prepare for the attack, then the victim is already had. You don\u0026#39;t need any curl exploit then! It would be much easier to just trick them to download a script with a crafty name and run that.\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003ecommon browsers handle this\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eWe already agreed this is a bug, right?\u003c/p\u003e\n","automated_response":false,"created_at":"2020-07-27T14:07:32.057Z","updated_at":"2020-07-27T14:07:32.057Z","actor":{"username":"bagder","cleared":false,"url":"/bagder","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/459/380/963f64725677dda4f5113219588e7d0c1ab9abaa_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8767186,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I agree it is not the best social engineering attack example out there, was what I could come up with. I'm sorry to have wasted your time with it.\n\nAbout the \"common browsers handle this\" part, I just wanted to report that the browsers I checked handle the write-only situation correctly and also the fact that they create the files with alternate names, so to not fail the download.  Maybe you want to consider doing that with curl too.","markdown_message":"\u003cp\u003eI agree it is not the best social engineering attack example out there, was what I could come up with. I\u0026#39;m sorry to have wasted your time with it.\u003c/p\u003e\n\n\u003cp\u003eAbout the \u0026quot;common browsers handle this\u0026quot; part, I just wanted to report that the browsers I checked handle the write-only situation correctly and also the fact that they create the files with alternate names, so to not fail the download.  Maybe you want to consider doing that with curl too.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-07-27T14:34:20.791Z","updated_at":"2020-07-27T14:34:20.791Z","actor":{"username":"brumbrum","cleared":false,"url":"/brumbrum","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8767243,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey, it's not a waste of time. I really appreciate these discussions and turning every stone to see what comes out. I truly do.\n\nBut yes sure, maybe curl should try an alternative name rather than failing the download. If someone would bring that feature I would be fine with it. We have hundreds of todo items and known bugs in the list to grab, there's no shortage of those... I personally will probably not work on that particular thing in the short term.","markdown_message":"\u003cp\u003eHey, it\u0026#39;s not a waste of time. I really appreciate these discussions and turning every stone to see what comes out. I truly do.\u003c/p\u003e\n\n\u003cp\u003eBut yes sure, maybe curl should try an alternative name rather than failing the download. If someone would bring that feature I would be fine with it. We have hundreds of todo items and known bugs in the list to grab, there\u0026#39;s no shortage of those... I personally will probably not work on that particular thing in the short term.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-07-27T14:39:11.881Z","updated_at":"2020-07-27T14:39:11.881Z","actor":{"username":"bagder","cleared":false,"url":"/bagder","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/459/380/963f64725677dda4f5113219588e7d0c1ab9abaa_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8769447,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"All right.  That is all I have for now.  I will park this issue in the back of my mind and if something really special happens to surface I will get back into contact.\n\nThanks for your feedback and supporting words.","markdown_message":"\u003cp\u003eAll right.  That is all I have for now.  I will park this issue in the back of my mind and if something really special happens to surface I will get back into contact.\u003c/p\u003e\n\n\u003cp\u003eThanks for your feedback and supporting words.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-07-27T16:58:03.392Z","updated_at":"2020-07-27T16:58:03.392Z","actor":{"username":"brumbrum","cleared":false,"url":"/brumbrum","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8773054,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"FYI, found the following in curl TODO file, maybe should add the -J option to the list\n\n18.3 prevent file overwriting\n\n Add an option that prevents curl from overwriting existing local files. When\n used, and there already is an existing file with the target file name\n (either -O or -o), a number should be appended (and increased if already\n existing). So that index.html becomes first index.html.1 and then\n index.html.2 etc.\n\n","markdown_message":"\u003cp\u003eFYI, found the following in curl TODO file, maybe should add the -J option to the list\u003c/p\u003e\n\n\u003cp\u003e18.3 prevent file overwriting\u003c/p\u003e\n\n\u003cp\u003eAdd an option that prevents curl from overwriting existing local files. When\u003cbr\u003e\n used, and there already is an existing file with the target file name\u003cbr\u003e\n (either -O or -o), a number should be appended (and increased if already\u003cbr\u003e\n existing). So that index.html becomes first index.html.1 and then\u003cbr\u003e\n index.html.2 etc.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-07-27T23:51:36.925Z","updated_at":"2020-07-27T23:51:36.925Z","actor":{"username":"brumbrum","cleared":false,"url":"/brumbrum","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8773064,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Of course -J already prevents file overwrite, just the part about appending number to the end of the filename would apply.","markdown_message":"\u003cp\u003eOf course -J already prevents file overwrite, just the part about appending number to the end of the filename would apply.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-07-27T23:54:40.740Z","updated_at":"2020-07-27T23:54:40.740Z","actor":{"username":"brumbrum","cleared":false,"url":"/brumbrum","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8786317,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I reviewed the source code from the fix commit you provided and it looks good.\n\nI built the same code and retested the issues.  All looks good.  No races.  No overwritten files.\n","markdown_message":"\u003cp\u003eI reviewed the source code from the fix commit you provided and it looks good.\u003c/p\u003e\n\n\u003cp\u003eI built the same code and retested the issues.  All looks good.  No races.  No overwritten files.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-07-28T21:40:04.287Z","updated_at":"2020-07-28T21:40:04.287Z","actor":{"username":"brumbrum","cleared":false,"url":"/brumbrum","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8786338,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"\u003e TODO file, maybe should add the -J option to the list\n\nSure perhaps, but its just a list with ideas someone could work on. It never includes all the details. Adding -J there won't make it happen sooner and will not help anyone much.\n\n\u003e it looks good\n\nThanks, I've just merged that PR into master now!","markdown_message":"\u003cblockquote\u003e\n\u003cp\u003eTODO file, maybe should add the -J option to the list\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eSure perhaps, but its just a list with ideas someone could work on. It never includes all the details. Adding -J there won\u0026#39;t make it happen sooner and will not help anyone much.\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eit looks good\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eThanks, I\u0026#39;ve just merged that PR into master now!\u003c/p\u003e\n","automated_response":false,"created_at":"2020-07-28T21:44:29.995Z","updated_at":"2020-07-28T21:44:29.995Z","actor":{"username":"bagder","cleared":false,"url":"/bagder","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/459/380/963f64725677dda4f5113219588e7d0c1ab9abaa_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8806267,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I'm considering writing a CodeQL query to detect such an issue. \n\nhttps://securitylab.github.com/tools/codeql\n\nIn curl's case you determined that it wasn't something exploitable, but maybe for other projects it might be.\n\nJust wanted to confirm with you that Coverity or any other one of the several static analysis tools used in your CI or any dynamic code analysis was or was not reporting a related issue with the faulty code?\n\nIf it is already detected somehow, then it is probably is not really useful to add a CodeQL query.\n\nHopefully you already have the information on hand?  I don't want you to do any additional work for me.\n\nThank you in advance for your help!\n","markdown_message":"\u003cp\u003eI\u0026#39;m considering writing a CodeQL query to detect such an issue. \u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"https://securitylab.github.com/tools/codeql\" href=\"/redirect?url=https%3A%2F%2Fsecuritylab.github.com%2Ftools%2Fcodeql\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://securitylab.github.com/tools/codeql\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eIn curl\u0026#39;s case you determined that it wasn\u0026#39;t something exploitable, but maybe for other projects it might be.\u003c/p\u003e\n\n\u003cp\u003eJust wanted to confirm with you that Coverity or any other one of the several static analysis tools used in your CI or any dynamic code analysis was or was not reporting a related issue with the faulty code?\u003c/p\u003e\n\n\u003cp\u003eIf it is already detected somehow, then it is probably is not really useful to add a CodeQL query.\u003c/p\u003e\n\n\u003cp\u003eHopefully you already have the information on hand?  I don\u0026#39;t want you to do any additional work for me.\u003c/p\u003e\n\n\u003cp\u003eThank you in advance for your help!\u003c/p\u003e\n","automated_response":false,"created_at":"2020-07-30T14:40:46.576Z","updated_at":"2020-07-30T14:40:46.576Z","actor":{"username":"brumbrum","cleared":false,"url":"/brumbrum","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8819989,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"This issue is handled and closed, please don't use this for communications about other things.\n\nNo, I don't think any of the static code analyzers we use report issues like this.","markdown_message":"\u003cp\u003eThis issue is handled and closed, please don\u0026#39;t use this for communications about other things.\u003c/p\u003e\n\n\u003cp\u003eNo, I don\u0026#39;t think any of the static code analyzers we use report issues like this.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-07-31T22:56:47.226Z","updated_at":"2020-07-31T22:56:47.226Z","actor":{"username":"bagder","cleared":false,"url":"/bagder","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/459/380/963f64725677dda4f5113219588e7d0c1ab9abaa_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8824247,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Really sorry about the spinoff question.   This was my first ever report on hackerone, so I don't know all the etiquette yet. \n\nIs it too early to ask for full disclosure of this report, especially as it is not considered a security matter.  Will hopefully help others avoid the same type of reports.  Thanks.","markdown_message":"\u003cp\u003eReally sorry about the spinoff question.   This was my first ever report on hackerone, so I don\u0026#39;t know all the etiquette yet. \u003c/p\u003e\n\n\u003cp\u003eIs it too early to ask for full disclosure of this report, especially as it is not considered a security matter.  Will hopefully help others avoid the same type of reports.  Thanks.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-08-01T15:04:42.261Z","updated_at":"2020-08-01T15:04:42.261Z","actor":{"username":"brumbrum","cleared":false,"url":"/brumbrum","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8824488,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Let's disclose!","markdown_message":"\u003cp\u003eLet\u0026#39;s disclose!\u003c/p\u003e\n","automated_response":false,"created_at":"2020-08-01T15:50:15.835Z","updated_at":"2020-08-01T15:50:15.835Z","first_to_agree":true,"actor":{"username":"bagder","cleared":false,"url":"/bagder","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/459/380/963f64725677dda4f5113219588e7d0c1ab9abaa_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8824687,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Sure let's disclose!  Thanks.","markdown_message":"\u003cp\u003eSure let\u0026#39;s disclose!  Thanks.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-08-01T16:46:35.477Z","updated_at":"2020-08-01T16:46:35.477Z","actor":{"username":"brumbrum","cleared":false,"url":"/brumbrum","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8824688,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-08-01T16:46:35.524Z","updated_at":"2020-08-01T16:46:35.524Z","actor":{"username":"brumbrum","cleared":false,"url":"/brumbrum","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"curl","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}