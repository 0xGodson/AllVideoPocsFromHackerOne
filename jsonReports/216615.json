{"id":216615,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMTY2MTU=","url":"https://hackerone.com/reports/216615","title":"Crash in ary_concat() ","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2017-03-28T06:59:01.773Z","submitted_at":"2017-03-28T06:59:01.773Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"mg36","url":"/mg36","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":15668,"url":"https://hackerone.com/shopify-scripts","handle":"shopify-scripts","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/015/668/ebbe467de8ef2fc936053593e1289e30f04c3b06_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/668/ebbe467de8ef2fc936053593e1289e30f04c3b06_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"paused","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"shopify-scripts","twitter_handle":"","website":"","about":""}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-05-13T21:29:14.531Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2017-04-13T21:29:12.665Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"The code above raises a segmentation fault both in mruby and mruby-engine\n```\nN *case\nwhen nil\n-\u003e()do end\ndef e()end\nend#\n````\r\n\nASAN report :\n```\nline 1:3: '*' interpreted as argument prefix\nASAN:SIGSEGV\n=================================================================\n==111090==ERROR: AddressSanitizer: SEGV on unknown address 0x0000000c (pc 0x08449c8e sp 0xfffd4e20 bp 0x0000000c T0)\n    #0 0x8449c8d in ary_concat /root/fuzzing/mruby/src/array.c:260\n    #1 0x8449c8d in mrb_ary_concat /root/fuzzing/mruby/src/array.c:279\n    #2 0x850bfe1 in mrb_vm_exec /root/fuzzing/mruby/src/vm.c:2288\n    #3 0x852f901 in mrb_vm_run /root/fuzzing/mruby/src/vm.c:823\n    #4 0x852f901 in mrb_top_run /root/fuzzing/mruby/src/vm.c:2614\n    #5 0x82e3a4b in mrb_load_exec /root/fuzzing/mruby/mrbgems/mruby-compiler/core/parse.y:5760\n    #6 0x82e6b9b in mrb_load_nstring_cxt /root/fuzzing/mruby/mrbgems/mruby-compiler/core/parse.y:5782\n    #7 0x82e6b9b in mrb_load_string_cxt /root/fuzzing/mruby/mrbgems/mruby-compiler/core/parse.y:5794\n    #8 0x82e6dc4 in mrb_load_string /root/fuzzing/mruby/mrbgems/mruby-compiler/core/parse.y:5800\n    #9 0x80d22e8 in main /root/fuzzing/mruby/bin/fuzz.c:13\n    #10 0xf74e5636 in __libc_start_main (/lib/i386-linux-gnu/libc.so.6+0x18636)\n    #11 0x80d1fc4 in _start (/home/simo/test/news/xx/bin/zz+0x80d1fc4)\n```\n\nSandbox crash report :\n```\nhome/simo/mruby-engine-normal/bin/sandbox:20: [BUG] Segmentation fault at 0x00000000000018\nruby 2.3.1p112 (2016-04-26) [x86_64-linux-gnu]\n\n-- Control frame information -----------------------------------------------\nc:0003 p:---- s:0010 e:000009 CFUNC  :sandbox_eval\nc:0002 p:0201 s:0005 E:0009d8 EVAL   /home/simo/mruby-engine-normal/bin/sandbox:20 [FINISH]\nc:0001 p:0000 s:0002 E:002180 (none) [FINISH]\n\n-- Ruby level backtrace information ----------------------------------------\n/home/simo/mruby-engine-normal/bin/sandbox:20:in `\u003cmain\u003e'\n/home/simo/mruby-engine-normal/bin/sandbox:20:in `sandbox_eval'\n\n-- Machine register context ------------------------------------------------\n RIP: 0x00007f2932c2aa7e RBP: 0x00007f29317b8a00 RSP: 0x00007f29317aaac0\n RAX: 0x1fffffffffffffff RBX: 0x00007f29317ac4e0 RCX: 0x0000000000000003\n RDX: 0x00007f29317b40d0 RDI: 0x00007f29317ac4e0 RSI: 0x0000000000000000\n  R8: 0x0000000000000010  R9: 0x0000000000000000 R10: 0x000000000000001f\n R11: 0x00007f29317bb520 R12: 0x0000000000000000 R13: 0x00007f29317ac4e0\n R14: 0x00007f29317ac4e0 R15: 0x0000000001810038 EFL: 0x0000000000010206\n```\n\nThanks","vulnerability_information_html":"\u003cp\u003eThe code above raises a segmentation fault both in mruby and mruby-engine\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eN *case\nwhen nil\n-\u0026gt;()do end\ndef e()end\nend#\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eASAN report :\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eline 1:3: \u0026#39;*\u0026#39; interpreted as argument prefix\nASAN:SIGSEGV\n=================================================================\n==111090==ERROR: AddressSanitizer: SEGV on unknown address 0x0000000c (pc 0x08449c8e sp 0xfffd4e20 bp 0x0000000c T0)\n    #0 0x8449c8d in ary_concat /root/fuzzing/mruby/src/array.c:260\n    #1 0x8449c8d in mrb_ary_concat /root/fuzzing/mruby/src/array.c:279\n    #2 0x850bfe1 in mrb_vm_exec /root/fuzzing/mruby/src/vm.c:2288\n    #3 0x852f901 in mrb_vm_run /root/fuzzing/mruby/src/vm.c:823\n    #4 0x852f901 in mrb_top_run /root/fuzzing/mruby/src/vm.c:2614\n    #5 0x82e3a4b in mrb_load_exec /root/fuzzing/mruby/mrbgems/mruby-compiler/core/parse.y:5760\n    #6 0x82e6b9b in mrb_load_nstring_cxt /root/fuzzing/mruby/mrbgems/mruby-compiler/core/parse.y:5782\n    #7 0x82e6b9b in mrb_load_string_cxt /root/fuzzing/mruby/mrbgems/mruby-compiler/core/parse.y:5794\n    #8 0x82e6dc4 in mrb_load_string /root/fuzzing/mruby/mrbgems/mruby-compiler/core/parse.y:5800\n    #9 0x80d22e8 in main /root/fuzzing/mruby/bin/fuzz.c:13\n    #10 0xf74e5636 in __libc_start_main (/lib/i386-linux-gnu/libc.so.6+0x18636)\n    #11 0x80d1fc4 in _start (/home/simo/test/news/xx/bin/zz+0x80d1fc4)\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eSandbox crash report :\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ehome/simo/mruby-engine-normal/bin/sandbox:20: [BUG] Segmentation fault at 0x00000000000018\nruby 2.3.1p112 (2016-04-26) [x86_64-linux-gnu]\n\n-- Control frame information -----------------------------------------------\nc:0003 p:---- s:0010 e:000009 CFUNC  :sandbox_eval\nc:0002 p:0201 s:0005 E:0009d8 EVAL   /home/simo/mruby-engine-normal/bin/sandbox:20 [FINISH]\nc:0001 p:0000 s:0002 E:002180 (none) [FINISH]\n\n-- Ruby level backtrace information ----------------------------------------\n/home/simo/mruby-engine-normal/bin/sandbox:20:in `\u0026lt;main\u0026gt;\u0026#39;\n/home/simo/mruby-engine-normal/bin/sandbox:20:in `sandbox_eval\u0026#39;\n\n-- Machine register context ------------------------------------------------\n RIP: 0x00007f2932c2aa7e RBP: 0x00007f29317b8a00 RSP: 0x00007f29317aaac0\n RAX: 0x1fffffffffffffff RBX: 0x00007f29317ac4e0 RCX: 0x0000000000000003\n RDX: 0x00007f29317b40d0 RDI: 0x00007f29317ac4e0 RSI: 0x0000000000000000\n  R8: 0x0000000000000010  R9: 0x0000000000000000 R10: 0x000000000000001f\n R11: 0x00007f29317bb520 R12: 0x0000000000000000 R13: 0x00007f29317ac4e0\n R14: 0x00007f29317ac4e0 R15: 0x0000000001810038 EFL: 0x0000000000010206\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThanks\u003c/p\u003e\n","bounty_amount":"800.0","formatted_bounty":"$800","original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2017-05-13T21:29:12.695Z","allow_singular_disclosure_after":-114506970.51028058,"singular_disclosure_allowed":true,"vote_count":3,"voters":["eveeez","spetr0x","pkhadka"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1567195,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you for reporting this bug! This is an automated response to let you know that we've received your issue, and we'll process it as soon as possible.\n\nDue to the large volume of reports we have received, it may take us up to two weeks to respond. Thank you for your patience!","markdown_message":"\u003cp\u003eThank you for reporting this bug! This is an automated response to let you know that we\u0026#39;ve received your issue, and we\u0026#39;ll process it as soon as possible.\u003c/p\u003e\n\n\u003cp\u003eDue to the large volume of reports we have received, it may take us up to two weeks to respond. Thank you for your patience!\u003c/p\u003e\n","automated_response":true,"created_at":"2017-03-28T06:59:01.980Z","updated_at":"2017-03-28T06:59:01.980Z","actor":{"url":"/shopify-scripts","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/668/ebbe467de8ef2fc936053593e1289e30f04c3b06_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"shopify-scripts"}},"genius_execution_id":null,"team_handle":"shopify-scripts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1567908,"is_internal":false,"editable":false,"type":"Activities::BugDuplicate","message":"Thank you for your report. This input produces the same crash as https://github.com/mruby/mruby/issues/3532 and so I suspect that the root cause is the same. I'm closing this as a duplicate for now, and will double check it once the root cause is determined.","markdown_message":"\u003cp\u003eThank you for your report. This input produces the same crash as \u003ca title=\"https://github.com/mruby/mruby/issues/3532\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fmruby%2Fmruby%2Fissues%2F3532\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/mruby/mruby/issues/3532\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e and so I suspect that the root cause is the same. I\u0026#39;m closing this as a duplicate for now, and will double check it once the root cause is determined.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-03-28T14:28:54.608Z","updated_at":"2017-03-28T14:28:54.608Z","original_report_id":214171,"actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify-scripts","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1580602,"is_internal":false,"editable":false,"type":"Activities::BugReopened","message":"@mg36 This was not addressed by the fix for https://github.com/mruby/mruby/issues/3532 so I'm going to re-open this and investigate.","markdown_message":"\u003cp\u003e\u003ca href=\"/mg36\"\u003e@mg36\u003c/a\u003e This was not addressed by the fix for \u003ca title=\"https://github.com/mruby/mruby/issues/3532\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fmruby%2Fmruby%2Fissues%2F3532\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/mruby/mruby/issues/3532\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e so I\u0026#39;m going to re-open this and investigate.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-04-03T15:03:31.594Z","updated_at":"2017-04-03T15:03:31.594Z","actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify-scripts","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1581751,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thank you for your patience. We've opened an issue upstream: https://github.com/mruby/mruby/issues/3580","markdown_message":"\u003cp\u003eThank you for your patience. We\u0026#39;ve opened an issue upstream: \u003ca title=\"https://github.com/mruby/mruby/issues/3580\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fmruby%2Fmruby%2Fissues%2F3580\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/mruby/mruby/issues/3580\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2017-04-03T21:18:33.265Z","updated_at":"2017-04-03T21:18:33.265Z","actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify-scripts","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1581753,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you, and pleasure to work with you ","markdown_message":"\u003cp\u003eThank you, and pleasure to work with you \u003c/p\u003e\n","automated_response":false,"created_at":"2017-04-03T21:20:30.767Z","updated_at":"2017-04-03T21:20:30.767Z","actor":{"username":"mg36","cleared":false,"url":"/mg36","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify-scripts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1603191,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks again for your report. This issue was addressed upstream in https://github.com/mruby/mruby/commit/fff4a4ed34b2692227b0f9d5773872b8410fd08d.\n\nOur next round of bounty decisions will take place in approximately one week, so we'll be in touch with you again soon.","markdown_message":"\u003cp\u003eThanks again for your report. This issue was addressed upstream in \u003ca title=\"https://github.com/mruby/mruby/commit/fff4a4ed34b2692227b0f9d5773872b8410fd08d\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fmruby%2Fmruby%2Fcommit%2Ffff4a4ed34b2692227b0f9d5773872b8410fd08d\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/mruby/mruby/commit/fff4a4ed34b2692227b0f9d5773872b8410fd08d\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e.\u003c/p\u003e\n\n\u003cp\u003eOur next round of bounty decisions will take place in approximately one week, so we\u0026#39;ll be in touch with you again soon.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-04-10T18:47:52.193Z","updated_at":"2017-04-10T18:47:52.193Z","actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"mg36","url":"/mg36"},"genius_execution_id":null,"team_handle":"shopify-scripts","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1606053,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks for helping improve the security of Shopify and the MRuby project!","markdown_message":"\u003cp\u003eThanks for helping improve the security of Shopify and the MRuby project!\u003c/p\u003e\n","automated_response":false,"created_at":"2017-04-11T22:35:20.003Z","updated_at":"2017-04-11T22:35:20.003Z","actor":{"url":"/shopify-scripts","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/668/ebbe467de8ef2fc936053593e1289e30f04c3b06_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"shopify-scripts"}},"bounty_amount":"800.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"shopify-scripts","collaborator":{"username":"mg36","url":"/mg36"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1610618,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-04-13T21:29:12.678Z","updated_at":"2017-04-13T21:29:12.678Z","first_to_agree":true,"actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify-scripts","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1672272,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-05-13T21:29:14.546Z","updated_at":"2017-05-13T21:29:14.546Z","actor":{"url":"/shopify-scripts","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/668/ebbe467de8ef2fc936053593e1289e30f04c3b06_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"shopify-scripts"}},"genius_execution_id":null,"team_handle":"shopify-scripts","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}