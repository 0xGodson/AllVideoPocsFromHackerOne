{"id":355773,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zNTU3NzM=","url":"https://hackerone.com/reports/355773","title":"XSS on support.wordcamp.org in ajax-quote.php","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2018-05-21T23:10:18.324Z","submitted_at":"2018-05-21T23:10:18.324Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"mopman","url":"/mopman","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/012/220/8dcf3a0b05d59213207f4e2544f53991202f9f2a_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":55,"url":"https://hackerone.com/wordpress","handle":"wordpress","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/055/f114d1d31f904e3b903cd99a6cf566bb531f8401_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/055/f114d1d31f904e3b903cd99a6cf566bb531f8401_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"WordPress","twitter_handle":"wordpress","website":"https://wordpress.org/","about":"Beautiful sites of any kind."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2018-07-23T15:06:06.875Z","bug_reporter_agreed_on_going_public_at":"2018-07-23T15:06:06.459Z","team_member_agreed_on_going_public_at":"2018-07-23T14:50:40.647Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi,\nThere is an XSS vulnerability in ajax-quote.php on http://support.wordcamp.org. It can be demonstrated with the attached POC - this needs to be run in Firefox to execute, as it's super basic and XSS Auditor will catch it (but with multiple parameters, even with one of them filtered, it's likely that one could be crafted that would work in Chrome, too).\n\nI would quite like to check out that SupportPress application in more detail, but it's quite hard to install :( Seems to not work out of the box for me - so for now, just an XSS.\n\n## Impact\n\nAn attacker who could trick an authenticated user into visiting their webpage/link could perform any action on behalf of that user. Cookie theft seems unlikely as, from a brief scan of the code (I can't login) I think it uses httponly on the important cookies.","vulnerability_information_html":"\u003cp\u003eHi,\u003cbr\u003e\nThere is an XSS vulnerability in ajax-quote.php on \u003ca title=\"http://support.wordcamp.org\" href=\"/redirect?url=http%3A%2F%2Fsupport.wordcamp.org\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://support.wordcamp.org\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e. It can be demonstrated with the attached POC - this needs to be run in Firefox to execute, as it\u0026#39;s super basic and XSS Auditor will catch it (but with multiple parameters, even with one of them filtered, it\u0026#39;s likely that one could be crafted that would work in Chrome, too).\u003c/p\u003e\n\n\u003cp\u003eI would quite like to check out that SupportPress application in more detail, but it\u0026#39;s quite hard to install :( Seems to not work out of the box for me - so for now, just an XSS.\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eAn attacker who could trick an authenticated user into visiting their webpage/link could perform any action on behalf of that user. Cookie theft seems unlikely as, from a brief scan of the code (I can\u0026#39;t login) I think it uses httponly on the important cookies.\u003c/p\u003e\n","bounty_amount":"225.0","formatted_bounty":"$225","weakness":{"id":61,"name":"Cross-site Scripting (XSS) - Reflected"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":300207,"file_name":"testpost.html","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/300/207/f390daf28ce1774c2b56fccf00b808192c584ad2/testpost.html?response-content-disposition=attachment%3B%20filename%3D%22testpost.html%22%3B%20filename%2A%3DUTF-8%27%27testpost.html\u0026response-content-type=application%2Foctet-stream\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQUYGCYHJT%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T054153Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJj%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIAGSCCKi0CRpYJMt3KX5x%2BNM9j2K4mM4glLH6mZ%2B8ExKAiEAlsZG1%2FfIYq0ODDSxwLnZfWyc08bfINN86QAI3Hqr4MgqtAMIURABGgwwMTM2MTkyNzQ4NDkiDG9txF7r12Yekik2WSqRA6NC8vsgwir7JTQr5zVnxH1x6efNaMXQv0rW73VsI4xDf6Ldo8AdQq%2B7eYd4BvolwrfpyHLOFrZnF4wc7R9rEQKh%2FswFKL9GQ6Lp2ujYTvyC5dhdjS4Sq%2F%2BYvPk3joZ%2BEwcDqk%2B5AvxLFqoiv3Y3ts7f9HYBqcl%2Fu20T7ZA6XxU9V7asrN5LT6SJz4xOu7iZzuPeZs4%2BFaw8tgu5A3W6CYmUUmbBs9q%2FQ%2FCO3t50tS7Dm5k%2BKM04Ar1VaXlWDuLdZKMC%2FS80%2FwDwH66vWVAjLib7jCkgBWXGEa9VryBHJJUl3qrXQrTIED1gUKeOoKk3fYvvyyIMJs3ja%2BbbO56fim%2BodEtN1FBU6g%2BuddJ4Qz5521XYpzwatC5mjJs6D50zWyfJnn9Xf%2FrDe3EacAX3oOhEBj%2Fu9S%2B46jeCaMjfEHwW8T%2FFnFpu%2FZf3e1NchqIFhOkEcnGH%2FqNmQtJ54g5I6x8j4N2c70CE7tuCZI1qjgi%2BfUfSwopFGky44IARFjLnTewCnMtMfFUa7haJa9C%2BcuqvMJDfqf8FOusB7%2BAWx%2FH2B4H9I7hLf9GkPQtz9yMVcytbF7umUu9c2W6aIn%2FKCYsmcfqyPQD%2Fe6EdfKQiWwtKrHes32q91jeUCiYfrRJFByq7uDxHGN0MingOOUWy72n3fdpooUwYjRfpac06PpxBSGvwEeiL%2BJlq9wl2E%2FMxojMrovyONCSYEoBpeEbNgMNFb9rpTiIW%2BX8OzRH6ra3L9dgd9y8nuqoCkIGYzNActVtKbpERxbtmkIoGAgtSCCLLfHT65g2k6G9afrZJZC86IhNmvJrDSG%2BKELC3%2BeAfU64DhUDssT9Dd%2Bm2pU0nRk1s8PUjuQ%3D%3D\u0026X-Amz-Signature=abf14763aaf4a4c6cd1983a1e25497759a3c28ab1d03fddba00a2a51d19bfe1f","file_size":308,"type":"text/html"}],"allow_singular_disclosure_at":"2018-08-22T14:50:40.846Z","allow_singular_disclosure_after":-74271072.31079896,"singular_disclosure_allowed":true,"vote_count":8,"voters":["ahiezer","mygf","michan","eveeez","exception","sameull","cryptographer","nightwatch"],"structured_scope":{"databaseId":2756,"asset_type":"URL","asset_identifier":"*.wordcamp.org","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":2817273,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for the report @mopman . I've passed this onto the meta team to take a look.","markdown_message":"\u003cp\u003eThanks for the report \u003ca href=\"/mopman\"\u003e@mopman\u003c/a\u003e . I\u0026#39;ve passed this onto the meta team to take a look.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-05-30T10:41:23.226Z","updated_at":"2018-05-30T10:41:23.226Z","actor":{"username":"johnbillion","cleared":false,"url":"/johnbillion","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/083/8a397390a09844d8b0657ea57e4203abd852bb2e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2824790,"is_internal":false,"editable":false,"type":"Activities::ExternalUserJoined","message":"","markdown_message":"","automated_response":false,"created_at":"2018-05-31T18:33:51.102Z","updated_at":"2018-05-31T18:33:51.102Z","actor":{"username":"coreymckrill","cleared":false,"url":"/coreymckrill","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/164/812/014feb7625d11d5f4b47e9a7dc38c16a8adce364_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2826969,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks @mopman. I've made a temporary change on support.wordcamp.org (not committed to the repo yet) that filters the `email` input. See the attached diff.","markdown_message":"\u003cp\u003eThanks \u003ca href=\"/mopman\"\u003e@mopman\u003c/a\u003e. I\u0026#39;ve made a temporary change on support.wordcamp.org (not committed to the repo yet) that filters the \u003ccode\u003eemail\u003c/code\u003e input. See the attached diff.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-05-31T23:00:17.288Z","updated_at":"2018-05-31T23:00:17.288Z","actor":{"username":"coreymckrill","cleared":false,"url":"/coreymckrill","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/164/812/014feb7625d11d5f4b47e9a7dc38c16a8adce364_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"attachments":[{"id":303844,"filename":"ajax-quote.php.diff","type":"text/x-diff","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/303/844/dc194378cdf4f44392905ef6a2dc06d604ec36cc/ajax-quote.php.diff?response-content-disposition=attachment%3B%20filename%3D%22ajax-quote.php.diff%22%3B%20filename%2A%3DUTF-8%27%27ajax-quote.php.diff\u0026response-content-type=text%2Fx-diff\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQUYGCYHJT%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T054153Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJj%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIAGSCCKi0CRpYJMt3KX5x%2BNM9j2K4mM4glLH6mZ%2B8ExKAiEAlsZG1%2FfIYq0ODDSxwLnZfWyc08bfINN86QAI3Hqr4MgqtAMIURABGgwwMTM2MTkyNzQ4NDkiDG9txF7r12Yekik2WSqRA6NC8vsgwir7JTQr5zVnxH1x6efNaMXQv0rW73VsI4xDf6Ldo8AdQq%2B7eYd4BvolwrfpyHLOFrZnF4wc7R9rEQKh%2FswFKL9GQ6Lp2ujYTvyC5dhdjS4Sq%2F%2BYvPk3joZ%2BEwcDqk%2B5AvxLFqoiv3Y3ts7f9HYBqcl%2Fu20T7ZA6XxU9V7asrN5LT6SJz4xOu7iZzuPeZs4%2BFaw8tgu5A3W6CYmUUmbBs9q%2FQ%2FCO3t50tS7Dm5k%2BKM04Ar1VaXlWDuLdZKMC%2FS80%2FwDwH66vWVAjLib7jCkgBWXGEa9VryBHJJUl3qrXQrTIED1gUKeOoKk3fYvvyyIMJs3ja%2BbbO56fim%2BodEtN1FBU6g%2BuddJ4Qz5521XYpzwatC5mjJs6D50zWyfJnn9Xf%2FrDe3EacAX3oOhEBj%2Fu9S%2B46jeCaMjfEHwW8T%2FFnFpu%2FZf3e1NchqIFhOkEcnGH%2FqNmQtJ54g5I6x8j4N2c70CE7tuCZI1qjgi%2BfUfSwopFGky44IARFjLnTewCnMtMfFUa7haJa9C%2BcuqvMJDfqf8FOusB7%2BAWx%2FH2B4H9I7hLf9GkPQtz9yMVcytbF7umUu9c2W6aIn%2FKCYsmcfqyPQD%2Fe6EdfKQiWwtKrHes32q91jeUCiYfrRJFByq7uDxHGN0MingOOUWy72n3fdpooUwYjRfpac06PpxBSGvwEeiL%2BJlq9wl2E%2FMxojMrovyONCSYEoBpeEbNgMNFb9rpTiIW%2BX8OzRH6ra3L9dgd9y8nuqoCkIGYzNActVtKbpERxbtmkIoGAgtSCCLLfHT65g2k6G9afrZJZC86IhNmvJrDSG%2BKELC3%2BeAfU64DhUDssT9Dd%2Bm2pU0nRk1s8PUjuQ%3D%3D\u0026X-Amz-Signature=3dc8b7536c7b79ee84f0b35d086d8e8a536c879ad04d9876192e1723b9583926"}],"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2829929,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2018-06-01T16:01:57.182Z","updated_at":"2018-06-01T16:01:57.182Z","actor":{"username":"aaroncampbell","cleared":false,"url":"/aaroncampbell","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/020/821/f7e6872e5cd77bbdfb5edb77e7b9b2c91bb6c0c7_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2854602,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Update: patch committed: https://supportpress.trac.wordpress.org/changeset/451/\n\nThanks again, @mopman. Let us know if you find any other issues with SupportPress.","markdown_message":"\u003cp\u003eUpdate: patch committed: \u003ca title=\"https://supportpress.trac.wordpress.org/changeset/451/\" href=\"/redirect?url=https%3A%2F%2Fsupportpress.trac.wordpress.org%2Fchangeset%2F451%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://supportpress.trac.wordpress.org/changeset/451/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eThanks again, \u003ca href=\"/mopman\"\u003e@mopman\u003c/a\u003e. Let us know if you find any other issues with SupportPress.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-06-07T16:41:42.080Z","updated_at":"2018-06-07T16:41:42.080Z","actor":{"username":"coreymckrill","cleared":false,"url":"/coreymckrill","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/164/812/014feb7625d11d5f4b47e9a7dc38c16a8adce364_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2859281,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2018-06-08T17:38:17.134Z","updated_at":"2018-06-08T17:38:17.134Z","actor":{"username":"aaroncampbell","cleared":false,"url":"/aaroncampbell","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/020/821/f7e6872e5cd77bbdfb5edb77e7b9b2c91bb6c0c7_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"mopman","url":"/mopman"},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3084436,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2018-07-23T14:49:36.043Z","updated_at":"2018-07-23T14:49:36.043Z","actor":{"url":"/wordpress","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/055/f114d1d31f904e3b903cd99a6cf566bb531f8401_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"WordPress"}},"bounty_amount":"225.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"wordpress","collaborator":{"username":"mopman","url":"/mopman"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3084438,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Hey @mopman,\n\nThanks for the report here. I somehow missed getting this pushed into the bounty suggestion/confirmation/payout process, which is why it kind of just lagged there. I apologize for that.\n\nI'm also requesting public disclosure since we generally disclose everything once it's fixed.\n\nThanks,\nAaron","markdown_message":"\u003cp\u003eHey \u003ca href=\"/mopman\"\u003e@mopman\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThanks for the report here. I somehow missed getting this pushed into the bounty suggestion/confirmation/payout process, which is why it kind of just lagged there. I apologize for that.\u003c/p\u003e\n\n\u003cp\u003eI\u0026#39;m also requesting public disclosure since we generally disclose everything once it\u0026#39;s fixed.\u003c/p\u003e\n\n\u003cp\u003eThanks,\u003cbr\u003e\nAaron\u003c/p\u003e\n","automated_response":false,"created_at":"2018-07-23T14:50:40.702Z","updated_at":"2018-07-23T14:50:40.702Z","first_to_agree":true,"actor":{"username":"aaroncampbell","cleared":false,"url":"/aaroncampbell","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/020/821/f7e6872e5cd77bbdfb5edb77e7b9b2c91bb6c0c7_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3084505,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Sounds good to me, and thanks for the bounty!","markdown_message":"\u003cp\u003eSounds good to me, and thanks for the bounty!\u003c/p\u003e\n","automated_response":false,"created_at":"2018-07-23T15:06:06.713Z","updated_at":"2018-07-23T15:06:06.713Z","actor":{"username":"mopman","cleared":false,"url":"/mopman","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/012/220/8dcf3a0b05d59213207f4e2544f53991202f9f2a_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3084506,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-07-23T15:06:06.920Z","updated_at":"2018-07-23T15:06:06.920Z","actor":{"username":"mopman","cleared":false,"url":"/mopman","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/012/220/8dcf3a0b05d59213207f4e2544f53991202f9f2a_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}