{"id":233440,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMzM0NDA=","url":"https://hackerone.com/reports/233440","title":"heap-buffer-overflow (READ of size 61) in Perl_re_intuit_start()","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2017-05-31T00:07:39.287Z","submitted_at":"2017-05-31T00:07:39.287Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"geeknik","url":"/geeknik","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/7xfGZCKCxUuGLYGfuUZM3XyY/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":30,"url":"https://hackerone.com/ibb-perl","handle":"ibb-perl","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/030/06e86a090af9d395cec5535eea83b90c72274566_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/030/06e86a090af9d395cec5535eea83b90c72274566_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Perl (IBB)","twitter_handle":"","website":"http://www.perl.org","about":""}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-06-05T18:54:27.251Z","bug_reporter_agreed_on_going_public_at":"2017-06-05T18:49:24.196Z","team_member_agreed_on_going_public_at":"2017-06-05T18:54:27.192Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"[Reported to the Perl security mailing list on 25 August 2016](https://rt.perl.org/Ticket/Display.html?id=129085).\n\n```\n==17057==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x60800000b978 at pc 0x0000004a9201 bp 0x7ffe97551890 sp 0x7ffe97551048\nREAD of size 61 at 0x60800000b978 thread T0\n    #0 0x4a9200 in __interceptor_memcmp (/root/perl/perl+0x4a9200)\n    #1 0xb46135 in Perl_re_intuit_start /root/perl/regexec.c:809:37\n    #2 0xb3a3e5 in Perl_regexec_flags /root/perl/regexec.c:2988:6\n    #3 0x8be7f9 in Perl_pp_match /root/perl/pp_hot.c:1836:10\n    #4 0x7f1dd3 in Perl_runops_debug /root/perl/dump.c:2234:23\n    #5 0x5a1234 in S_run_body /root/perl/perl.c:2525:2\n    #6 0x5a1234 in perl_run /root/perl/perl.c:2448\n    #7 0x4de85d in main /root/perl/perlmain.c:123:9\n    #8 0x7f8899228b44 in __libc_start_main /build/glibc-uPj9cH/glibc-2.19/csu/libc-start.c:287\n    #9 0x4de4cc in _start (/root/perl/perl+0x4de4cc)\n\n0x60800000b978 is located 0 bytes to the right of 88-byte region [0x60800000b920,0x60800000b978)\nallocated by thread T0 here:\n    #0 0x4c113e in realloc (/root/perl/perl+0x4c113e)\n    #1 0x7f6306 in Perl_safesysrealloc /root/perl/util.c:274:18\n\nSUMMARY: AddressSanitizer: heap-buffer-overflow ??:0 __interceptor_memcmp\n```\n\n##What is happening?##\n```\nWhen a match is anchored against the start of a string, the regexp can be compiled to include a fixed string match against a fixed offset in the string. In some cases, where the matched against string included UTF-8 before the fixed offset, this could result in attempting a memcmp() which overlaps the end of the string and potentially past the end of the allocated memory.\n```\n\n##Arguments for:##\nOn [29 August 2016](https://rt.perl.org/Ticket/Attachment/1420527/768174/), Tony says `It *might* be possible to use this as a hard to trigger denial of service attack, eg. if the memcmp() went past the end of a page into unmapped memory.`\n\nOn the same day in [another comment](https://rt.perl.org/Ticket/Attachment/1420627/768230/), Tony says `An attacker that can control the regexp *might* be able to use that to examine the contents of memory beyond the terminating NUL, which would be critical if that previously held a password or anything else sensitive.`\n\n##Arguments Against:##\nOn [6 September 2016](https://rt.perl.org/Ticket/Attachment/1422020/769144/), Dave says `I don't think this is a security issue any more, and I think your patch should be applied.`\n\n##Fix##\nPatch was released on 30 October 2016 and it was released today, 30 May 2017, with Perl 5.26.0. (Worth noting that 52 of the bug fixes in Perl 5.26.0 were from my reports).","vulnerability_information_html":"\u003cp\u003e\u003ca href=\"/redirect?url=https%3A%2F%2Frt.perl.org%2FTicket%2FDisplay.html%3Fid%3D129085\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eReported to the Perl security mailing list on 25 August 2016\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e==17057==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x60800000b978 at pc 0x0000004a9201 bp 0x7ffe97551890 sp 0x7ffe97551048\nREAD of size 61 at 0x60800000b978 thread T0\n    #0 0x4a9200 in __interceptor_memcmp (/root/perl/perl+0x4a9200)\n    #1 0xb46135 in Perl_re_intuit_start /root/perl/regexec.c:809:37\n    #2 0xb3a3e5 in Perl_regexec_flags /root/perl/regexec.c:2988:6\n    #3 0x8be7f9 in Perl_pp_match /root/perl/pp_hot.c:1836:10\n    #4 0x7f1dd3 in Perl_runops_debug /root/perl/dump.c:2234:23\n    #5 0x5a1234 in S_run_body /root/perl/perl.c:2525:2\n    #6 0x5a1234 in perl_run /root/perl/perl.c:2448\n    #7 0x4de85d in main /root/perl/perlmain.c:123:9\n    #8 0x7f8899228b44 in __libc_start_main /build/glibc-uPj9cH/glibc-2.19/csu/libc-start.c:287\n    #9 0x4de4cc in _start (/root/perl/perl+0x4de4cc)\n\n0x60800000b978 is located 0 bytes to the right of 88-byte region [0x60800000b920,0x60800000b978)\nallocated by thread T0 here:\n    #0 0x4c113e in realloc (/root/perl/perl+0x4c113e)\n    #1 0x7f6306 in Perl_safesysrealloc /root/perl/util.c:274:18\n\nSUMMARY: AddressSanitizer: heap-buffer-overflow ??:0 __interceptor_memcmp\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2 id=\"what-is-happening\"\u003eWhat is happening?\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eWhen a match is anchored against the start of a string, the regexp can be compiled to include a fixed string match against a fixed offset in the string. In some cases, where the matched against string included UTF-8 before the fixed offset, this could result in attempting a memcmp() which overlaps the end of the string and potentially past the end of the allocated memory.\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2 id=\"arguments-for\"\u003eArguments for:\u003c/h2\u003e\n\n\u003cp\u003eOn \u003ca href=\"/redirect?url=https%3A%2F%2Frt.perl.org%2FTicket%2FAttachment%2F1420527%2F768174%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003e29 August 2016\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e, Tony says \u003ccode\u003eIt *might* be possible to use this as a hard to trigger denial of service attack, eg. if the memcmp() went past the end of a page into unmapped memory.\u003c/code\u003e\u003c/p\u003e\n\n\u003cp\u003eOn the same day in \u003ca href=\"/redirect?url=https%3A%2F%2Frt.perl.org%2FTicket%2FAttachment%2F1420627%2F768230%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eanother comment\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e, Tony says \u003ccode\u003eAn attacker that can control the regexp *might* be able to use that to examine the contents of memory beyond the terminating NUL, which would be critical if that previously held a password or anything else sensitive.\u003c/code\u003e\u003c/p\u003e\n\n\u003ch2 id=\"arguments-against\"\u003eArguments Against:\u003c/h2\u003e\n\n\u003cp\u003eOn \u003ca href=\"/redirect?url=https%3A%2F%2Frt.perl.org%2FTicket%2FAttachment%2F1422020%2F769144%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003e6 September 2016\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e, Dave says \u003ccode\u003eI don\u0026#39;t think this is a security issue any more, and I think your patch should be applied.\u003c/code\u003e\u003c/p\u003e\n\n\u003ch2 id=\"fix\"\u003eFix\u003c/h2\u003e\n\n\u003cp\u003ePatch was released on 30 October 2016 and it was released today, 30 May 2017, with Perl 5.26.0. (Worth noting that 52 of the bug fixes in Perl 5.26.0 were from my reports).\u003c/p\u003e\n","bounty_amount":"500.0","formatted_bounty":"$500","weakness":{"id":5,"name":"Heap Overflow"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2017-07-05T18:49:24.232Z","allow_singular_disclosure_after":-109937813.83848563,"singular_disclosure_allowed":true,"vote_count":6,"voters":["eveeez","geeknik","m7mdharoun","zerotoone","spetr0x","mrr3boot"],"severity":{"rating":"low","author_type":"Team"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1731721,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2017-06-05T18:22:25.259Z","updated_at":"2017-06-05T18:22:25.259Z","additional_data":{"old_severity":"Medium","new_severity":"Low","old_severity_id":46049,"new_severity_id":48435},"actor":{"username":"arice","cleared":false,"url":"/arice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/83152cb2d070f3f6a63c1b61bae47257722b5ad2_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"ibb-perl","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1731722,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2017-06-05T18:22:32.786Z","updated_at":"2017-06-05T18:22:32.786Z","actor":{"url":"/ibb-perl","ibb":true,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/030/06e86a090af9d395cec5535eea83b90c72274566_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Perl (IBB)"}},"bounty_amount":"500.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"ibb-perl","collaborator":{"username":"geeknik","url":"/geeknik"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1731723,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2017-06-05T18:22:39.835Z","updated_at":"2017-06-05T18:22:39.835Z","actor":{"username":"arice","cleared":false,"url":"/arice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/83152cb2d070f3f6a63c1b61bae47257722b5ad2_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"reporter":{"username":"geeknik","url":"/geeknik"},"genius_execution_id":null,"team_handle":"ibb-perl","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1731864,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-06-05T18:49:24.211Z","updated_at":"2017-06-05T18:49:24.211Z","first_to_agree":true,"actor":{"username":"geeknik","cleared":true,"url":"/geeknik","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/7xfGZCKCxUuGLYGfuUZM3XyY/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ibb-perl","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1731879,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-06-05T18:54:27.214Z","updated_at":"2017-06-05T18:54:27.214Z","actor":{"username":"arice","cleared":false,"url":"/arice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/83152cb2d070f3f6a63c1b61bae47257722b5ad2_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"ibb-perl","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1731880,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-06-05T18:54:27.269Z","updated_at":"2017-06-05T18:54:27.269Z","actor":{"username":"arice","cleared":false,"url":"/arice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/83152cb2d070f3f6a63c1b61bae47257722b5ad2_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"ibb-perl","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}