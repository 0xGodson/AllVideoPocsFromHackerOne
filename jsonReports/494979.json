{"id":494979,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC80OTQ5Nzk=","url":"https://hackerone.com/reports/494979","title":"Insufficient sanitizing can lead to arbitrary commands execution","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2019-02-13T01:31:54.418Z","submitted_at":"2019-02-13T01:31:54.418Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"mrnbayoh","url":"/mrnbayoh","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/189/059/1c4c4bf47adafcca63b8256be5721d27653948a2_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":36721,"url":"https://hackerone.com/notepad-plus-plus","handle":"notepad-plus-plus","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/036/721/b8be93879279f14a49e5051a1a2794575fb1f3f8_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/036/721/b8be93879279f14a49e5051a1a2794575fb1f3f8_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Notepad++","twitter_handle":"notepad_plus","website":"https://notepad-plus-plus.org","about":""}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2019-06-06T00:46:57.283Z","bug_reporter_agreed_on_going_public_at":"2019-05-07T00:46:56.048Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"##Information:\n\n**Summary:**\nNotepad++ is vulnerable to a command injection attack.\n\n**Debug Info:**\nNotepad++ v7.6.3 (32-bit)\nBuild time : Jan 27 2019 - 17:20:30\nPath : C:\\Program Files (x86)\\Notepad++\\notepad++.exe\nAdmin mode : ON\nLocal Conf mode : OFF\nOS : Windows 10 (64-bit)\nPlugins : none\n\n**Description:** \n\nLet's look at this command execution for example in `NppCommand.cpp`:\n```\ncase IDM_FILE_OPEN_CMD:\n\t\t{\n\t\t\tCommand cmd(TEXT(\"cmd /K cd /d \\\"$(CURRENT_DIRECTORY)\\\"\"));\n\t\t\tcmd.run(_pPublicInterface-\u003egetHSelf());\n\t\t}\nbreak;\n```\n\n`\\\"` have been introduced with commit [0f93670](https://github.com/notepad-plus-plus/notepad-plus-plus/commit/0f936707a2457eb4611d7d42a68a3e066614f8e4#diff-48044e0078aaf1c5ab452bd9c8f0bcf3) to prevent RCE. \nHowever it is still possible to inject arbitrary commands using environment variables. For example trying to open a folder named `%TEST%` will result in the expansion of the environment variable, if it contains a `\"` then its possible to inject arbitrary commands after that `\"` in the directory name.\n\n## Steps To Reproduce:\n\n  1. Create a new environment variable (or a temporary one), let's name it `TEST` and set its value: `\"`\n  2. Create a new folder named `%TEST%  \u0026\u0026 mkdir boom` and create a text file in it, let's name that file `test.txt`\n  3. Open `test.txt` with Notepad++ and click on `File-\u003eOpen Containing Folder-\u003ecmd`\n  4. The command in the folder name gets executed and the `boom` folder is created\n\n## Fix:\n\nEscape `%`characters before executing the command: `%` -\u003e `^%`.\n\n## Impact\n\nA successful attack can lead to arbitrary commands execution.","vulnerability_information_html":"\u003ch2 id=\"information\"\u003eInformation:\u003c/h2\u003e\n\n\u003cp\u003e\u003cstrong\u003eSummary:\u003c/strong\u003e\u003cbr\u003e\nNotepad++ is vulnerable to a command injection attack.\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eDebug Info:\u003c/strong\u003e\u003cbr\u003e\nNotepad++ v7.6.3 (32-bit)\u003cbr\u003e\nBuild time : Jan 27 2019 - 17:20:30\u003cbr\u003e\nPath : C:\\Program Files (x86)\\Notepad++\\notepad++.exe\u003cbr\u003e\nAdmin mode : ON\u003cbr\u003e\nLocal Conf mode : OFF\u003cbr\u003e\nOS : Windows 10 (64-bit)\u003cbr\u003e\nPlugins : none\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eDescription:\u003c/strong\u003e \u003c/p\u003e\n\n\u003cp\u003eLet\u0026#39;s look at this command execution for example in \u003ccode\u003eNppCommand.cpp\u003c/code\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ecase IDM_FILE_OPEN_CMD:\n        {\n            Command cmd(TEXT(\u0026quot;cmd /K cd /d \\\u0026quot;$(CURRENT_DIRECTORY)\\\u0026quot;\u0026quot;));\n            cmd.run(_pPublicInterface-\u0026gt;getHSelf());\n        }\nbreak;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e\u003ccode\u003e\\\u0026quot;\u003c/code\u003e have been introduced with commit \u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fnotepad-plus-plus%2Fnotepad-plus-plus%2Fcommit%2F0f936707a2457eb4611d7d42a68a3e066614f8e4%23diff-48044e0078aaf1c5ab452bd9c8f0bcf3\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003e0f93670\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e to prevent RCE. \u003cbr\u003e\nHowever it is still possible to inject arbitrary commands using environment variables. For example trying to open a folder named \u003ccode\u003e%TEST%\u003c/code\u003e will result in the expansion of the environment variable, if it contains a \u003ccode\u003e\u0026quot;\u003c/code\u003e then its possible to inject arbitrary commands after that \u003ccode\u003e\u0026quot;\u003c/code\u003e in the directory name.\u003c/p\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps To Reproduce:\u003c/h2\u003e\n\n\u003col\u003e\n\u003cli\u003eCreate a new environment variable (or a temporary one), let\u0026#39;s name it \u003ccode\u003eTEST\u003c/code\u003e and set its value: \u003ccode\u003e\u0026quot;\u003c/code\u003e\n\u003c/li\u003e\n\u003cli\u003eCreate a new folder named \u003ccode\u003e%TEST%  \u0026amp;\u0026amp; mkdir boom\u003c/code\u003e and create a text file in it, let\u0026#39;s name that file \u003ccode\u003etest.txt\u003c/code\u003e\n\u003c/li\u003e\n\u003cli\u003eOpen \u003ccode\u003etest.txt\u003c/code\u003e with Notepad++ and click on \u003ccode\u003eFile-\u0026gt;Open Containing Folder-\u0026gt;cmd\u003c/code\u003e\n\u003c/li\u003e\n\u003cli\u003eThe command in the folder name gets executed and the \u003ccode\u003eboom\u003c/code\u003e folder is created\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003ch2 id=\"fix\"\u003eFix:\u003c/h2\u003e\n\n\u003cp\u003eEscape \u003ccode\u003e%\u003c/code\u003echaracters before executing the command: \u003ccode\u003e%\u003c/code\u003e -\u0026gt; \u003ccode\u003e^%\u003c/code\u003e.\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eA successful attack can lead to arbitrary commands execution.\u003c/p\u003e\n","bounty_amount":"1363.7","formatted_bounty":"$1,363.70","weakness":{"id":58,"name":"Command Injection - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2019-06-06T00:46:56.108Z","allow_singular_disclosure_after":-49440051.37562017,"singular_disclosure_allowed":true,"vote_count":49,"voters":["is-","w31rd0","base_64","insiderphd","qtros","an0nym0us","cr4xerbik4sh","codeanddecode","divyanshu29","tems","and 39 more..."],"severity":{"rating":"medium","author_type":"Team"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":4148700,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @underfl0wed, thanks for your submission. Your report is being reviewed and you'll hear back as soon as there's more to share.  ","markdown_message":"\u003cp\u003eHi \u003ca href=\"/underfl0wed\"\u003e@underfl0wed\u003c/a\u003e, thanks for your submission. Your report is being reviewed and you\u0026#39;ll hear back as soon as there\u0026#39;s more to share.  \u003c/p\u003e\n","automated_response":false,"created_at":"2019-02-14T11:21:35.692Z","updated_at":"2019-02-14T11:21:35.692Z","actor":{"username":"nasr0x01","cleared":false,"url":"/nasr0x01","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/386/674/ec2e2c825a554851c42c122ffd61aa8f18b08174_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"notepad-plus-plus","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4148701,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2019-02-14T11:21:46.918Z","updated_at":"2019-02-14T11:21:46.918Z","additional_data":{"old_severity":"High","new_severity":"Medium","old_severity_id":296327,"new_severity_id":297248},"actor":{"username":"nasr0x01","cleared":false,"url":"/nasr0x01","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/386/674/ec2e2c825a554851c42c122ffd61aa8f18b08174_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"notepad-plus-plus","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4148702,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hello @underfl0wed,\n\nThank you for your submission! I was able to validate your report, and have submitted it to the appropriate remediation team for review. They will let us know the final ruling on this report, and when/if a fix will be implemented. Please note that the status and severity are subject to change.\n\nRegards,\n@nasr0x01 ","markdown_message":"\u003cp\u003eHello \u003ca href=\"/underfl0wed\"\u003e@underfl0wed\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThank you for your submission! I was able to validate your report, and have submitted it to the appropriate remediation team for review. They will let us know the final ruling on this report, and when/if a fix will be implemented. Please note that the status and severity are subject to change.\u003c/p\u003e\n\n\u003cp\u003eRegards,\u003cbr\u003e\n\u003ca href=\"/nasr0x01\"\u003e@nasr0x01\u003c/a\u003e \u003c/p\u003e\n","automated_response":false,"created_at":"2019-02-14T11:21:56.604Z","updated_at":"2019-02-14T11:21:56.604Z","actor":{"username":"nasr0x01","cleared":false,"url":"/nasr0x01","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/386/674/ec2e2c825a554851c42c122ffd61aa8f18b08174_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"notepad-plus-plus","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4152525,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"## Additional information\nNote that the executed commands can be entirely stored in the environment variable (not just a double quote like in my example), since a path containing suspicious strings might alert the user, it's totally possible to hide the whole chain. It still needs an environment variable as a backdoor though.","markdown_message":"\u003ch2 id=\"additional-information\"\u003eAdditional information\u003c/h2\u003e\n\n\u003cp\u003eNote that the executed commands can be entirely stored in the environment variable (not just a double quote like in my example), since a path containing suspicious strings might alert the user, it\u0026#39;s totally possible to hide the whole chain. It still needs an environment variable as a backdoor though.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-02-14T23:53:52.943Z","updated_at":"2019-02-14T23:55:15.614Z","actor":{"username":"mrnbayoh","cleared":false,"url":"/mrnbayoh","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/189/059/1c4c4bf47adafcca63b8256be5721d27653948a2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"notepad-plus-plus","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4161426,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello @underfl0wed\n\nYour input is much appreciated, however, I am waiting for Notepad's reply on that and will get back to you as soon as possible.\n\nRegards,\n@nasr0x01","markdown_message":"\u003cp\u003eHello \u003ca href=\"/underfl0wed\"\u003e@underfl0wed\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eYour input is much appreciated, however, I am waiting for Notepad\u0026#39;s reply on that and will get back to you as soon as possible.\u003c/p\u003e\n\n\u003cp\u003eRegards,\u003cbr\u003e\n\u003ca href=\"/nasr0x01\"\u003e@nasr0x01\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2019-02-16T14:27:34.480Z","updated_at":"2019-02-16T14:27:34.480Z","actor":{"username":"nasr0x01","cleared":false,"url":"/nasr0x01","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/386/674/ec2e2c825a554851c42c122ffd61aa8f18b08174_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"notepad-plus-plus","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4249418,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello @nasr0x01,\nThe fix I suggested actually does not work, sorry about that.\n\nBest regards.","markdown_message":"\u003cp\u003eHello \u003ca href=\"/nasr0x01\"\u003e@nasr0x01\u003c/a\u003e,\u003cbr\u003e\nThe fix I suggested actually does not work, sorry about that.\u003c/p\u003e\n\n\u003cp\u003eBest regards.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-03-04T01:53:29.139Z","updated_at":"2019-03-04T01:53:29.139Z","actor":{"username":"mrnbayoh","cleared":false,"url":"/mrnbayoh","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/189/059/1c4c4bf47adafcca63b8256be5721d27653948a2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"notepad-plus-plus","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4270254,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello @underfl0wed,\n\nNo worries, I am still waiting for Notepad's approval and will get back to you as soon as I hear back.\n\nYour patience is much appreciated.\n\nRegards,\n@nasr0x01","markdown_message":"\u003cp\u003eHello \u003ca href=\"/underfl0wed\"\u003e@underfl0wed\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eNo worries, I am still waiting for Notepad\u0026#39;s approval and will get back to you as soon as I hear back.\u003c/p\u003e\n\n\u003cp\u003eYour patience is much appreciated.\u003c/p\u003e\n\n\u003cp\u003eRegards,\u003cbr\u003e\n\u003ca href=\"/nasr0x01\"\u003e@nasr0x01\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2019-03-06T19:10:53.178Z","updated_at":"2019-03-06T19:10:53.178Z","actor":{"username":"nasr0x01","cleared":false,"url":"/nasr0x01","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/386/674/ec2e2c825a554851c42c122ffd61aa8f18b08174_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"notepad-plus-plus","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4271046,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello @nasr0x01,\n\nHere is a suggestion to fix the bug.\nThe Windows API provides a more detailed version of `ShellExecute` named [`ShellExecuteEx`](https://docs.microsoft.com/en-us/windows/desktop/api/Shellapi/nf-shellapi-shellexecuteexa). Since the goal is to open the cmd with a special working directory you can set it in the associated [SHELLEXECUTEINFOA](https://docs.microsoft.com/en-us/windows/desktop/api/shellapi/ns-shellapi-_shellexecuteinfoa) structure (see the `lpDirectory` attribute). To prevent any environment variable from being expanded just do not use the `SEE_MASK_DOENVSUBST` mask.\n\nBest regards.","markdown_message":"\u003cp\u003eHello \u003ca href=\"/nasr0x01\"\u003e@nasr0x01\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eHere is a suggestion to fix the bug.\u003cbr\u003e\nThe Windows API provides a more detailed version of \u003ccode\u003eShellExecute\u003c/code\u003e named \u003ca href=\"/redirect?url=https%3A%2F%2Fdocs.microsoft.com%2Fen-us%2Fwindows%2Fdesktop%2Fapi%2FShellapi%2Fnf-shellapi-shellexecuteexa\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003e\u003ccode\u003eShellExecuteEx\u003c/code\u003e\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e. Since the goal is to open the cmd with a special working directory you can set it in the associated \u003ca href=\"/redirect?url=https%3A%2F%2Fdocs.microsoft.com%2Fen-us%2Fwindows%2Fdesktop%2Fapi%2Fshellapi%2Fns-shellapi-_shellexecuteinfoa\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eSHELLEXECUTEINFOA\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e structure (see the \u003ccode\u003elpDirectory\u003c/code\u003e attribute). To prevent any environment variable from being expanded just do not use the \u003ccode\u003eSEE_MASK_DOENVSUBST\u003c/code\u003e mask.\u003c/p\u003e\n\n\u003cp\u003eBest regards.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-03-06T21:23:34.137Z","updated_at":"2019-03-06T21:24:03.581Z","actor":{"username":"mrnbayoh","cleared":false,"url":"/mrnbayoh","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/189/059/1c4c4bf47adafcca63b8256be5721d27653948a2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"notepad-plus-plus","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4271425,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello @underfl0wed,\n\nThanks for the follow-up, however, in order to get the bonus you will have to provide an actual diff patch file so that the team can take a look and apply it to the next commit.\n\nRegards,\n@nasr0x01","markdown_message":"\u003cp\u003eHello \u003ca href=\"/underfl0wed\"\u003e@underfl0wed\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThanks for the follow-up, however, in order to get the bonus you will have to provide an actual diff patch file so that the team can take a look and apply it to the next commit.\u003c/p\u003e\n\n\u003cp\u003eRegards,\u003cbr\u003e\n\u003ca href=\"/nasr0x01\"\u003e@nasr0x01\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2019-03-06T23:00:21.239Z","updated_at":"2019-03-06T23:00:21.239Z","actor":{"username":"nasr0x01","cleared":false,"url":"/nasr0x01","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/386/674/ec2e2c825a554851c42c122ffd61aa8f18b08174_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"notepad-plus-plus","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4271857,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello @nasr0x01,\n\nHere is my patch file to fix this vulnerability. The `Command::run` function now takes a working directory as a parameter to avoid using `cd` which expands environment variables.\n\nBest regards.","markdown_message":"\u003cp\u003eHello \u003ca href=\"/nasr0x01\"\u003e@nasr0x01\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eHere is my patch file to fix this vulnerability. The \u003ccode\u003eCommand::run\u003c/code\u003e function now takes a working directory as a parameter to avoid using \u003ccode\u003ecd\u003c/code\u003e which expands environment variables.\u003c/p\u003e\n\n\u003cp\u003eBest regards.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-03-07T01:27:14.164Z","updated_at":"2019-03-07T01:27:52.772Z","actor":{"username":"mrnbayoh","cleared":false,"url":"/mrnbayoh","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/189/059/1c4c4bf47adafcca63b8256be5721d27653948a2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"attachments":[{"id":436672,"filename":"cmd_patch.patch","type":"text/x-diff","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/436/672/6f71f82adc7076747759b6d241784fdbb4843f75/cmd_patch.patch?response-content-disposition=attachment%3B%20filename%3D%22cmd_patch.patch%22%3B%20filename%2A%3DUTF-8%27%27cmd_patch.patch\u0026response-content-type=text%2Fx-diff\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ3VAHLH6Z%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T060747Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCD4BvSsKgWcuX7%2Fh3b1LWkKs9s4yRHAxqyVwXJYWsOAwIhANvLMyKSbceDyM1TNnWf11IvuT7a61DuFVJhD%2BT%2Fb9IrKrQDCFcQARoMMDEzNjE5Mjc0ODQ5Igxmi6woSxw%2B6wnwBEMqkQPI1uJcvWS%2B7FQadeW43PrlhsnF4xiGOroakbutVFcvcHOdYKgLxjIJI5m7XwadzbZWnWfHV0%2B62Zb%2BWCUOjMWiTVIXVX7AwYN1lfeKcXEYUp0h0oyXmZ8r9%2Bj%2FMZUagb%2BGKS%2B8zxvRdQjMX1tdjoDe9OxP6o1mlqEZpx8AKw7LDp1Hz2ezBoeya6X2GupABl%2FOhOfLY3VwJj7aPTg85UEwxOdZDtc%2FqzwALQiQUZo0A1RP3Y8nbzGb8CydaoFTXkp8rbJlMiimc%2BP%2BkZhbzJrdAs2rl68CFeUO2KSps4veGXWDFFoEAu1EvHwhAyOhkUlWXmX73VMyIVDvCkiHkuulKA8DiBfGp90UyI0AqLxJxXh%2FgCjGVxceHzAhM03UULwYdje89A1ziU5p%2BKL3KWD4xZiWFhlIiy3U92ksRt8S3l2NanthhEGEvTgf6wIclSsc9f4UbYnjYnAAiXkBg6iZTwORuQ0lVt30ma%2B%2BklzemkOgRIzghR66jzWcsjfvliY27ODm9Z12Vrj3LNetmm3XRTDEg6v%2FBTrqAb0W67QCovsIpNAiT4CujLyYV%2FjYmZ4VKcAok0lQwqZsNMCoze3egJJr5KwJfEhstOKt8adGE2Rfh5M%2BaAuxUHx9CHzHYR0HmUar1TnotcADpaizJlkcQmrsTfX3xtHVR8i9rhilHwmpYSeCQBjKHP%2BS656Uyq6ksGCrQWI4ZK%2F8QgDLIm%2FkIF6FlqRmaPtAeqfdwNxXQoCBcVLYgai%2FvmYu0CSd0Q1ngm%2FQMLqJqwYCLLmqTZrGYBRc5a553mtVqPYXlzc8Pgvjp59x%2Fjbix5wBt%2BoNg6EeSWNYAv4D0k4TzkJ4Aj8N%2BdAfag%3D%3D\u0026X-Amz-Signature=215e120e797d09d3ad2fe914636f7203775a8633d4d02e333b7936a638bfcb6d"}],"genius_execution_id":null,"team_handle":"notepad-plus-plus","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4272015,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello @underfl0wed,\n\nThanks for the follow-up, I have already forwarded this report to the Notepad team and they will also take a look at the patch and I will get back to you as soon as there's an update.\n\nYour patience is much appreciated.\n\nRegards,\n@nasr0x01","markdown_message":"\u003cp\u003eHello \u003ca href=\"/underfl0wed\"\u003e@underfl0wed\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThanks for the follow-up, I have already forwarded this report to the Notepad team and they will also take a look at the patch and I will get back to you as soon as there\u0026#39;s an update.\u003c/p\u003e\n\n\u003cp\u003eYour patience is much appreciated.\u003c/p\u003e\n\n\u003cp\u003eRegards,\u003cbr\u003e\n\u003ca href=\"/nasr0x01\"\u003e@nasr0x01\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2019-03-07T02:21:50.354Z","updated_at":"2019-03-07T02:21:50.354Z","actor":{"username":"nasr0x01","cleared":false,"url":"/nasr0x01","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/386/674/ec2e2c825a554851c42c122ffd61aa8f18b08174_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"notepad-plus-plus","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4294851,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@underfl0wed \u0026 @nasr0x01 \nit would be nice to provide accurate instruction, I reproduce it anyway.","markdown_message":"\u003cp\u003e\u003ca href=\"/underfl0wed\"\u003e@underfl0wed\u003c/a\u003e \u0026amp; \u003ca href=\"/nasr0x01\"\u003e@nasr0x01\u003c/a\u003e \u003cbr\u003e\nit would be nice to provide accurate instruction, I reproduce it anyway.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-03-10T15:40:52.329Z","updated_at":"2019-03-10T15:40:52.329Z","actor":{"username":"ohnod","cleared":false,"url":"/ohnod","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/453/925/2e910e69ba119e16a1acd2db23eed0a1fdd27a71_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"notepad-plus-plus","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4295250,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello @ohnod,\n\nThe patch I provided should fix the issue, do you have any issue with it ?\nJust use `git apply cmd_patch.patch` to apply the patch.\nSince the main issue was that `cd` was expanding environment variables even with double-quoted strings and since the only reason `cd` was used was to open the `cmd` with a specific working directory, I just added an optional `cwd` parameter to the `Command::run` function which is then passed to `ShellExecute` as the \"current working directory\" parameter. Then I replaced all the commands involving `cd`.","markdown_message":"\u003cp\u003eHello \u003ca href=\"/ohnod\"\u003e@ohnod\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThe patch I provided should fix the issue, do you have any issue with it ?\u003cbr\u003e\nJust use \u003ccode\u003egit apply cmd_patch.patch\u003c/code\u003e to apply the patch.\u003cbr\u003e\nSince the main issue was that \u003ccode\u003ecd\u003c/code\u003e was expanding environment variables even with double-quoted strings and since the only reason \u003ccode\u003ecd\u003c/code\u003e was used was to open the \u003ccode\u003ecmd\u003c/code\u003e with a specific working directory, I just added an optional \u003ccode\u003ecwd\u003c/code\u003e parameter to the \u003ccode\u003eCommand::run\u003c/code\u003e function which is then passed to \u003ccode\u003eShellExecute\u003c/code\u003e as the \u0026quot;current working directory\u0026quot; parameter. Then I replaced all the commands involving \u003ccode\u003ecd\u003c/code\u003e.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-03-10T18:01:10.055Z","updated_at":"2019-03-10T18:01:10.055Z","actor":{"username":"mrnbayoh","cleared":false,"url":"/mrnbayoh","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/189/059/1c4c4bf47adafcca63b8256be5721d27653948a2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"notepad-plus-plus","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4295700,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@underfl0wed \nThe solution you provided doesn't work to me.\nHere's the modification for this issue with your suggestion:\n```\nHINSTANCE Command::run(HWND hWnd)\n{\n\tconst int argsIntermediateLen = MAX_PATH*2;\n\tconst int args2ExecLen = CURRENTWORD_MAXLENGTH+MAX_PATH*2;\n\n\tTCHAR cmdPure[MAX_PATH];\n\tTCHAR cmdIntermediate[MAX_PATH];\n\tTCHAR cmd2Exec[MAX_PATH];\n\tTCHAR args[MAX_PATH];\n\tTCHAR argsIntermediate[argsIntermediateLen];\n\tTCHAR args2Exec[args2ExecLen];\n\n\textractArgs(cmdPure, args, _cmdLine.c_str());\n\tint nbTchar = ::ExpandEnvironmentStrings(cmdPure, cmdIntermediate, MAX_PATH);\n\tif (!nbTchar)\n\t\twcscpy_s(cmdIntermediate, cmdPure);\n\telse if (nbTchar \u003e= MAX_PATH)\n\t\tcmdIntermediate[MAX_PATH-1] = '\\0';\n\n\tnbTchar = ::ExpandEnvironmentStrings(args, argsIntermediate, argsIntermediateLen);\n\tif (!nbTchar)\n\t\twcscpy_s(argsIntermediate, args);\n\telse if (nbTchar \u003e= argsIntermediateLen)\n\t\targsIntermediate[argsIntermediateLen-1] = '\\0';\n\n\texpandNppEnvironmentStrs(cmdIntermediate, cmd2Exec, MAX_PATH, hWnd);\n\texpandNppEnvironmentStrs(argsIntermediate, args2Exec, args2ExecLen, hWnd);\n\n\t//HINSTANCE res = ::ShellExecute(hWnd, TEXT(\"open\"), cmd2Exec, args2Exec, TEXT(\".\"), SW_SHOW);\n\n\tSHELLEXECUTEINFO ShExecInfo = { 0 };\n\tShExecInfo.cbSize = sizeof(SHELLEXECUTEINFO);\n\tShExecInfo.fMask = 0;\n\tShExecInfo.hwnd = hWnd;\n\tShExecInfo.lpVerb = TEXT(\"open\");\n\tShExecInfo.lpFile = cmd2Exec;\n\tShExecInfo.lpParameters = args2Exec;\n\tShExecInfo.lpDirectory = TEXT(\".\");\n\tShExecInfo.nShow = SW_SHOW;\n\tShExecInfo.hInstApp = NULL;\n\n\tBOOL isOK = ::ShellExecuteEx(\u0026ShExecInfo);\n\n\t/*\n\t// As per MSDN (https://msdn.microsoft.com/en-us/library/windows/desktop/bb762153(v=vs.85).aspx)\n\t// If the function succeeds, it returns a value greater than 32.\n\t// If the function fails, it returns an error value that indicates the cause of the failure.\n\tint retResult = static_cast\u003cint\u003e(reinterpret_cast\u003cINT_PTR\u003e(res));\n\tif (retResult \u003c= 32)\n\t*/\n\tif (!isOK)\n\t{\n\t\tgeneric_string errorMsg;\n\t\terrorMsg += GetLastErrorAsString();\n\t\terrorMsg += TEXT(\"An attempt was made to execute the below command.\");\n\t\terrorMsg += TEXT(\"\\n----------------------------------------------------------\");\n\t\terrorMsg += TEXT(\"\\nCommand: \");\n\t\terrorMsg += cmd2Exec;\n\t\terrorMsg += TEXT(\"\\nArguments: \");\n\t\terrorMsg += args2Exec;\n\t\terrorMsg += TEXT(\"\\n----------------------------------------------------------\");\n\t\t::MessageBox(hWnd, errorMsg.c_str(), TEXT(\"ShellExecute - ERROR\"), MB_ICONINFORMATION | MB_APPLMODAL);\n\t\treturn nullptr;\n\t}\n\treturn static_cast\u003cHINSTANCE\u003e(ShExecInfo.hProcess);\n}\n```\nAfter compiling the above modification, I run notepad++.exe in a cmd:\n```\nC:\\sources\\notepad-plus-plus\\PowerEditor\\visual.net\\Unicode Debug\u003eecho %TEST%\n\"\nC:\\sources\\notepad-plus-plus\\PowerEditor\\visual.net\\Unicode Debug\u003enotepad++.exe\nC:\\sources\\notepad-plus-plus\\PowerEditor\\visual.net\\Unicode Debug\u003e\n```\nThe result of running the command \u003eOpen Containing Folder-\u003ecmd on `C:\\tmp\\%TEST% \u0026\u0026 mkdir boom\\test.txt` is:\n```\nA subdirectory or file boom already exists.\nC:\\tmp\u003e\n```\n\nAny other suggestion?","markdown_message":"\u003cp\u003e\u003ca href=\"/underfl0wed\"\u003e@underfl0wed\u003c/a\u003e \u003cbr\u003e\nThe solution you provided doesn\u0026#39;t work to me.\u003cbr\u003e\nHere\u0026#39;s the modification for this issue with your suggestion:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eHINSTANCE Command::run(HWND hWnd)\n{\n    const int argsIntermediateLen = MAX_PATH*2;\n    const int args2ExecLen = CURRENTWORD_MAXLENGTH+MAX_PATH*2;\n\n    TCHAR cmdPure[MAX_PATH];\n    TCHAR cmdIntermediate[MAX_PATH];\n    TCHAR cmd2Exec[MAX_PATH];\n    TCHAR args[MAX_PATH];\n    TCHAR argsIntermediate[argsIntermediateLen];\n    TCHAR args2Exec[args2ExecLen];\n\n    extractArgs(cmdPure, args, _cmdLine.c_str());\n    int nbTchar = ::ExpandEnvironmentStrings(cmdPure, cmdIntermediate, MAX_PATH);\n    if (!nbTchar)\n        wcscpy_s(cmdIntermediate, cmdPure);\n    else if (nbTchar \u0026gt;= MAX_PATH)\n        cmdIntermediate[MAX_PATH-1] = \u0026#39;\\0\u0026#39;;\n\n    nbTchar = ::ExpandEnvironmentStrings(args, argsIntermediate, argsIntermediateLen);\n    if (!nbTchar)\n        wcscpy_s(argsIntermediate, args);\n    else if (nbTchar \u0026gt;= argsIntermediateLen)\n        argsIntermediate[argsIntermediateLen-1] = \u0026#39;\\0\u0026#39;;\n\n    expandNppEnvironmentStrs(cmdIntermediate, cmd2Exec, MAX_PATH, hWnd);\n    expandNppEnvironmentStrs(argsIntermediate, args2Exec, args2ExecLen, hWnd);\n\n    //HINSTANCE res = ::ShellExecute(hWnd, TEXT(\u0026quot;open\u0026quot;), cmd2Exec, args2Exec, TEXT(\u0026quot;.\u0026quot;), SW_SHOW);\n\n    SHELLEXECUTEINFO ShExecInfo = { 0 };\n    ShExecInfo.cbSize = sizeof(SHELLEXECUTEINFO);\n    ShExecInfo.fMask = 0;\n    ShExecInfo.hwnd = hWnd;\n    ShExecInfo.lpVerb = TEXT(\u0026quot;open\u0026quot;);\n    ShExecInfo.lpFile = cmd2Exec;\n    ShExecInfo.lpParameters = args2Exec;\n    ShExecInfo.lpDirectory = TEXT(\u0026quot;.\u0026quot;);\n    ShExecInfo.nShow = SW_SHOW;\n    ShExecInfo.hInstApp = NULL;\n\n    BOOL isOK = ::ShellExecuteEx(\u0026amp;ShExecInfo);\n\n    /*\n    // As per MSDN (https://msdn.microsoft.com/en-us/library/windows/desktop/bb762153(v=vs.85).aspx)\n    // If the function succeeds, it returns a value greater than 32.\n    // If the function fails, it returns an error value that indicates the cause of the failure.\n    int retResult = static_cast\u0026lt;int\u0026gt;(reinterpret_cast\u0026lt;INT_PTR\u0026gt;(res));\n    if (retResult \u0026lt;= 32)\n    */\n    if (!isOK)\n    {\n        generic_string errorMsg;\n        errorMsg += GetLastErrorAsString();\n        errorMsg += TEXT(\u0026quot;An attempt was made to execute the below command.\u0026quot;);\n        errorMsg += TEXT(\u0026quot;\\n----------------------------------------------------------\u0026quot;);\n        errorMsg += TEXT(\u0026quot;\\nCommand: \u0026quot;);\n        errorMsg += cmd2Exec;\n        errorMsg += TEXT(\u0026quot;\\nArguments: \u0026quot;);\n        errorMsg += args2Exec;\n        errorMsg += TEXT(\u0026quot;\\n----------------------------------------------------------\u0026quot;);\n        ::MessageBox(hWnd, errorMsg.c_str(), TEXT(\u0026quot;ShellExecute - ERROR\u0026quot;), MB_ICONINFORMATION | MB_APPLMODAL);\n        return nullptr;\n    }\n    return static_cast\u0026lt;HINSTANCE\u0026gt;(ShExecInfo.hProcess);\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eAfter compiling the above modification, I run notepad++.exe in a cmd:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eC:\\sources\\notepad-plus-plus\\PowerEditor\\visual.net\\Unicode Debug\u0026gt;echo %TEST%\n\u0026quot;\nC:\\sources\\notepad-plus-plus\\PowerEditor\\visual.net\\Unicode Debug\u0026gt;notepad++.exe\nC:\\sources\\notepad-plus-plus\\PowerEditor\\visual.net\\Unicode Debug\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThe result of running the command \u0026gt;Open Containing Folder-\u0026gt;cmd on \u003ccode\u003eC:\\tmp\\%TEST% \u0026amp;\u0026amp; mkdir boom\\test.txt\u003c/code\u003e is:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eA subdirectory or file boom already exists.\nC:\\tmp\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eAny other suggestion?\u003c/p\u003e\n","automated_response":false,"created_at":"2019-03-10T20:59:59.468Z","updated_at":"2019-03-10T20:59:59.468Z","actor":{"username":"ohnod","cleared":false,"url":"/ohnod","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/453/925/2e910e69ba119e16a1acd2db23eed0a1fdd27a71_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"notepad-plus-plus","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4295720,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello @ohnod,\n\nForget about this suggestion (your fix does not work because you're still using `cd` to set the working directory, you should use the `lpDirectory` parameter), did you try the patch I uploaded ? \n\nBest regards.","markdown_message":"\u003cp\u003eHello \u003ca href=\"/ohnod\"\u003e@ohnod\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eForget about this suggestion (your fix does not work because you\u0026#39;re still using \u003ccode\u003ecd\u003c/code\u003e to set the working directory, you should use the \u003ccode\u003elpDirectory\u003c/code\u003e parameter), did you try the patch I uploaded ? \u003c/p\u003e\n\n\u003cp\u003eBest regards.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-03-10T21:09:35.498Z","updated_at":"2019-03-10T21:23:57.470Z","actor":{"username":"mrnbayoh","cleared":false,"url":"/mrnbayoh","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/189/059/1c4c4bf47adafcca63b8256be5721d27653948a2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"notepad-plus-plus","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4295858,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@underfl0wed Work like a charm! Thank you.\n","markdown_message":"\u003cp\u003e\u003ca href=\"/underfl0wed\"\u003e@underfl0wed\u003c/a\u003e Work like a charm! Thank you.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-03-10T22:33:57.650Z","updated_at":"2019-03-10T22:33:57.650Z","actor":{"username":"ohnod","cleared":false,"url":"/ohnod","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/453/925/2e910e69ba119e16a1acd2db23eed0a1fdd27a71_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"notepad-plus-plus","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4296181,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello @ohnod,\n\nYou're welcome! \nBy the way, you might also want to implement an optional boolean parameter to know whether you should expand environment variables or not (with `ExpandEnvironmentStrings`). For example, if you select the string `%PATH%` in the editor and click `Edit-\u003eOn Selection-\u003eSearch on Internet`, it will search the content of your `PATH` variable and not the actual string, but this is another less significant issue.\n\nBest regards.","markdown_message":"\u003cp\u003eHello \u003ca href=\"/ohnod\"\u003e@ohnod\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eYou\u0026#39;re welcome! \u003cbr\u003e\nBy the way, you might also want to implement an optional boolean parameter to know whether you should expand environment variables or not (with \u003ccode\u003eExpandEnvironmentStrings\u003c/code\u003e). For example, if you select the string \u003ccode\u003e%PATH%\u003c/code\u003e in the editor and click \u003ccode\u003eEdit-\u0026gt;On Selection-\u0026gt;Search on Internet\u003c/code\u003e, it will search the content of your \u003ccode\u003ePATH\u003c/code\u003e variable and not the actual string, but this is another less significant issue.\u003c/p\u003e\n\n\u003cp\u003eBest regards.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-03-11T01:25:15.950Z","updated_at":"2019-03-11T01:25:45.413Z","actor":{"username":"mrnbayoh","cleared":false,"url":"/mrnbayoh","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/189/059/1c4c4bf47adafcca63b8256be5721d27653948a2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"notepad-plus-plus","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4306723,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hello @underfl0wed,\n\nThank you for your submission! I was able to validate your report, and have submitted it to the appropriate remediation team for review. They will let us know the final ruling on this report, and when/if a fix will be implemented. Please note that the status and severity are subject to change.\n\nRegards,\n@nasr0x01 ","markdown_message":"\u003cp\u003eHello \u003ca href=\"/underfl0wed\"\u003e@underfl0wed\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThank you for your submission! I was able to validate your report, and have submitted it to the appropriate remediation team for review. They will let us know the final ruling on this report, and when/if a fix will be implemented. Please note that the status and severity are subject to change.\u003c/p\u003e\n\n\u003cp\u003eRegards,\u003cbr\u003e\n\u003ca href=\"/nasr0x01\"\u003e@nasr0x01\u003c/a\u003e \u003c/p\u003e\n","automated_response":false,"created_at":"2019-03-12T10:37:40.543Z","updated_at":"2019-03-12T10:37:40.543Z","actor":{"username":"nasr0x01","cleared":false,"url":"/nasr0x01","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/386/674/ec2e2c825a554851c42c122ffd61aa8f18b08174_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"notepad-plus-plus","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4306728,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello @underfl0wed,\n\nThank you for your report. This has been validated by the Notpad++ team and will now be sent to the European Commission for final approval to pay out a bounty. We appreciate your patience and will update you as soon as we hear back but there may be some delay.\n\nRegards,\n@nasr0x01","markdown_message":"\u003cp\u003eHello \u003ca href=\"/underfl0wed\"\u003e@underfl0wed\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThank you for your report. This has been validated by the Notpad++ team and will now be sent to the European Commission for final approval to pay out a bounty. We appreciate your patience and will update you as soon as we hear back but there may be some delay.\u003c/p\u003e\n\n\u003cp\u003eRegards,\u003cbr\u003e\n\u003ca href=\"/nasr0x01\"\u003e@nasr0x01\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2019-03-12T10:38:34.714Z","updated_at":"2019-03-12T10:38:34.714Z","actor":{"username":"nasr0x01","cleared":false,"url":"/nasr0x01","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/386/674/ec2e2c825a554851c42c122ffd61aa8f18b08174_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"notepad-plus-plus","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4369145,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Hello @underfl0wed,\n\nThank you for this report. The team have confirmed your vulnerability as a Medium severity impact.\n\nThe H1 platform doesn’t allow €URO payments, hence the funky $1363.70 amount.\n\nThe USD$ conversion for today is 1 United States Dollar equals 0.88 Euro.\n\nThanks for your help and participating in this program.\n\nKind Regards\nHackerOne\n","markdown_message":"\u003cp\u003eHello \u003ca href=\"/underfl0wed\"\u003e@underfl0wed\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThank you for this report. The team have confirmed your vulnerability as a Medium severity impact.\u003c/p\u003e\n\n\u003cp\u003eThe H1 platform doesn’t allow €URO payments, hence the funky $1363.70 amount.\u003c/p\u003e\n\n\u003cp\u003eThe USD$ conversion for today is 1 United States Dollar equals 0.88 Euro.\u003c/p\u003e\n\n\u003cp\u003eThanks for your help and participating in this program.\u003c/p\u003e\n\n\u003cp\u003eKind Regards\u003cbr\u003e\nHackerOne\u003c/p\u003e\n","automated_response":false,"created_at":"2019-03-21T19:57:43.009Z","updated_at":"2019-03-21T19:57:43.009Z","actor":{"url":"/notepad-plus-plus","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/036/721/b8be93879279f14a49e5051a1a2794575fb1f3f8_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Notepad++"}},"bounty_amount":"1363.7","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"notepad-plus-plus","collaborator":{"username":"mrnbayoh","url":"/mrnbayoh"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4407246,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello @nasr0x01,\nSince the provided patch has been applied and the issue has been fixed, I guess it's fine to close this report.\n\nBest regards.","markdown_message":"\u003cp\u003eHello \u003ca href=\"/nasr0x01\"\u003e@nasr0x01\u003c/a\u003e,\u003cbr\u003e\nSince the provided patch has been applied and the issue has been fixed, I guess it\u0026#39;s fine to close this report.\u003c/p\u003e\n\n\u003cp\u003eBest regards.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-03-28T00:17:52.521Z","updated_at":"2019-03-28T00:17:52.521Z","actor":{"username":"mrnbayoh","cleared":false,"url":"/mrnbayoh","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/189/059/1c4c4bf47adafcca63b8256be5721d27653948a2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"notepad-plus-plus","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4409264,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hi @underfl0wed, \n\nThanks for submitting this report. We have determined that this report is now resolved. If you’re still able to reproduce this issue, please let us know and we will investigate further. \n\nThanks! ","markdown_message":"\u003cp\u003eHi \u003ca href=\"/underfl0wed\"\u003e@underfl0wed\u003c/a\u003e, \u003c/p\u003e\n\n\u003cp\u003eThanks for submitting this report. We have determined that this report is now resolved. If you’re still able to reproduce this issue, please let us know and we will investigate further. \u003c/p\u003e\n\n\u003cp\u003eThanks! \u003c/p\u003e\n","automated_response":false,"created_at":"2019-03-28T09:41:42.480Z","updated_at":"2019-03-28T09:41:42.480Z","actor":{"username":"nasr0x01","cleared":false,"url":"/nasr0x01","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/386/674/ec2e2c825a554851c42c122ffd61aa8f18b08174_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"mrnbayoh","url":"/mrnbayoh"},"genius_execution_id":null,"team_handle":"notepad-plus-plus","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4761947,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-05-07T00:46:56.077Z","updated_at":"2019-05-07T00:46:56.077Z","first_to_agree":true,"actor":{"username":"mrnbayoh","cleared":false,"url":"/mrnbayoh","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/189/059/1c4c4bf47adafcca63b8256be5721d27653948a2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"notepad-plus-plus","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5011333,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-06-06T00:46:57.309Z","updated_at":"2019-06-06T00:46:57.309Z","actor":{"url":"/notepad-plus-plus","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/036/721/b8be93879279f14a49e5051a1a2794575fb1f3f8_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Notepad++"}},"genius_execution_id":null,"team_handle":"notepad-plus-plus","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}