{"id":504782,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC81MDQ3ODI=","url":"https://hackerone.com/reports/504782","title":"CSRF at adding new role (user-management.service.newrelic.com)","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2019-03-04T14:11:56.232Z","submitted_at":"2019-03-04T14:11:56.232Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"skavans","url":"/skavans","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/014/089/00a08f6b566bcdfe82b2f0be62bdde605a030823_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":17011,"url":"https://hackerone.com/newrelic","handle":"newrelic","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/017/011/eba06abb23bd6c9c7d719ddafb9fa83bd2d66aaa_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/011/eba06abb23bd6c9c7d719ddafb9fa83bd2d66aaa_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"New Relic","twitter_handle":"newrelic","website":"https://newrelic.com","about":"New Relic's Coordinated Disclosure Program"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2020-08-13T11:04:24.205Z","bug_reporter_agreed_on_going_public_at":"2020-08-11T09:33:45.734Z","team_member_agreed_on_going_public_at":"2020-08-13T11:04:24.101Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hey New Relic security team,\n\nI have discovered a CSRF-vulnerability allowing attacker to create new custom role on behalf of victim.\nThe role creation endpoint does not implement correct CSRF-protection so it can be bypassed.\nThe exploited works fine at least at latest Firefox browser.\n\n**Steps to reproduce**\n\n1. Sign into New Relic app as admin.\n2. Open an attached html file {F435288} in the same browser and wait iframe to be fully loaded.\n3. Navigate to roles page (`https://account.newrelic.com/accounts/\u003caccount_id\u003e/roles`) and make sure there is a new custom role \"CSRF_ROLE\".\n{F435275}\n\n**Mitigation**\nThis endpoint implements some CSRF-protection: it checks the referer and origin headers, but these checks can be bypassed using the form (doesn't send Origin header) and data: URI (form inside data: URI doesn't send Referer header). That's why it is better to use standard CSRF-protection technique with CSRF-tokens.\n\n## Impact\n\nAttacker can create custom role inside New Relic app.","vulnerability_information_html":"\u003cp\u003eHey New Relic security team,\u003c/p\u003e\n\n\u003cp\u003eI have discovered a CSRF-vulnerability allowing attacker to create new custom role on behalf of victim.\u003cbr\u003e\nThe role creation endpoint does not implement correct CSRF-protection so it can be bypassed.\u003cbr\u003e\nThe exploited works fine at least at latest Firefox browser.\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eSteps to reproduce\u003c/strong\u003e\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eSign into New Relic app as admin.\u003c/li\u003e\n\u003cli\u003eOpen an attached html file \u003ca class=\"markdown-attachment-link markdown-attachment-reference\" data-attachment-filename=\"untitled.html\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/435/288/4276a0ed68c8bd76924e70a1ebb2f321d00d3292/untitled.html?response-content-disposition=attachment%3B%20filename%3D%22untitled.html%22%3B%20filename%2A%3DUTF-8%27%27untitled.html\u0026amp;response-content-type=application%2Foctet-stream\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQVBWWKZ4H%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T061034Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCmEbZvVQ%2FI1GHRJjrhZK2Y6zh4lCWK725%2FwOpNu%2BnZkAIhAIZlqGHog%2B4PZMdnvhSU5APZbycPDz1wpNXbi5uE94ueKrQDCFUQARoMMDEzNjE5Mjc0ODQ5IgxU5AAHhqo1cPAzbTcqkQOGB5pEHXl6QCBCTSHUmyd%2FF8M3rpTqzp%2BOigrWU%2BrXYHZYm%2BGDawsiXhnqeD9o8Qw0b%2Fr0efVbRmhj5baoPrxgSiY%2B9zsreR3qClZZKnS0%2Brs8OqiMGd3clBbyfOxw2fa2vgQglV4dLF6EXSiGfxOms8eWdw%2F8mPtc81dMxDIlxTs50KUnd6aUjgG5BJs2k%2FL0rOKXYBS%2FdVqIQdN8JcCKMvqDv0u7pvSGEecQXa7pGdf07ufO02E64eU0OnaTeNyoq7WlZzT%2FGyvHjVtIvbXdPW15pwZm2Q4u8%2FW7ksSv4%2BxsESWLLCop0OeGUhtIppCDQlaMPC9JTj0HYKbMEGmZagmLfgHX4DKRg75%2FLNQViGcE%2FRCCaMxd6wrsv0dlz4dekjWvp4mXzLFkuKBM6c%2F%2BAemkmkgOJKnp%2FJUV1zJTe%2BO14GyIigsvxJqvrnKvkmsUrYwar1bX%2Be7UkqGzVbMAlsbRDNIOok7bVRXerhpXnbqFQsLWlqe%2BNfa4gSSfmgu4iIjCRRMdTWsvy2NQHfTsGjDAzar%2FBTrqAcniMm3eG7%2BxDZb9XVqMyQiSNyiuBD8pwO78bO8T3Uu8vSI3S05C6UCutmNkOnjR9D2NZaOgbFO4YujbW%2FY0mhhdjSppvg%2Bzdgu0AfZOou0DDwqm4vwEc0ekiNYUD6KHvD5tZwOaalihV5dSfbzoDyvfsJI6x7RYpBZmwPcshKw3Csz0uZew1JqrbUJVmc9v6q0aXols8bxyDKKPfp6siyzKhHELgTS3XGskds%2BWx5FaWemc%2Bo8QqyIuoOtWjmUwF39ydFOfg%2FyeKdwBxELGLKCSN8MyV6ov7IBrib4UiM%2F6l36ymDoHIX8ohg%3D%3D\u0026amp;X-Amz-Signature=b412c63f7eb09b02520d34af1674ed8c0aac8247202541229c20e38e5b919bb7\" data-attachment-type=\"text/html\"\u003euntitled.html (F435288)\u003c/a\u003e in the same browser and wait iframe to be fully loaded.\u003c/li\u003e\n\u003cli\u003eNavigate to roles page (\u003ccode\u003ehttps://account.newrelic.com/accounts/\u0026lt;account_id\u0026gt;/roles\u003c/code\u003e) and make sure there is a new custom role \u0026quot;CSRF_ROLE\u0026quot;.\n\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"______________2019-03-04___17.04.55.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/435/275/184041e916929701a4fd6fefc2b5ea164f61e731/______________2019-03-04___17.04.55.png?response-content-disposition=attachment%3B%20filename%3D%22______________2019-03-04___17.04.55.png%22%3B%20filename%2A%3DUTF-8%27%27______________2019-03-04___17.04.55.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQVBWWKZ4H%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T061034Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCmEbZvVQ%2FI1GHRJjrhZK2Y6zh4lCWK725%2FwOpNu%2BnZkAIhAIZlqGHog%2B4PZMdnvhSU5APZbycPDz1wpNXbi5uE94ueKrQDCFUQARoMMDEzNjE5Mjc0ODQ5IgxU5AAHhqo1cPAzbTcqkQOGB5pEHXl6QCBCTSHUmyd%2FF8M3rpTqzp%2BOigrWU%2BrXYHZYm%2BGDawsiXhnqeD9o8Qw0b%2Fr0efVbRmhj5baoPrxgSiY%2B9zsreR3qClZZKnS0%2Brs8OqiMGd3clBbyfOxw2fa2vgQglV4dLF6EXSiGfxOms8eWdw%2F8mPtc81dMxDIlxTs50KUnd6aUjgG5BJs2k%2FL0rOKXYBS%2FdVqIQdN8JcCKMvqDv0u7pvSGEecQXa7pGdf07ufO02E64eU0OnaTeNyoq7WlZzT%2FGyvHjVtIvbXdPW15pwZm2Q4u8%2FW7ksSv4%2BxsESWLLCop0OeGUhtIppCDQlaMPC9JTj0HYKbMEGmZagmLfgHX4DKRg75%2FLNQViGcE%2FRCCaMxd6wrsv0dlz4dekjWvp4mXzLFkuKBM6c%2F%2BAemkmkgOJKnp%2FJUV1zJTe%2BO14GyIigsvxJqvrnKvkmsUrYwar1bX%2Be7UkqGzVbMAlsbRDNIOok7bVRXerhpXnbqFQsLWlqe%2BNfa4gSSfmgu4iIjCRRMdTWsvy2NQHfTsGjDAzar%2FBTrqAcniMm3eG7%2BxDZb9XVqMyQiSNyiuBD8pwO78bO8T3Uu8vSI3S05C6UCutmNkOnjR9D2NZaOgbFO4YujbW%2FY0mhhdjSppvg%2Bzdgu0AfZOou0DDwqm4vwEc0ekiNYUD6KHvD5tZwOaalihV5dSfbzoDyvfsJI6x7RYpBZmwPcshKw3Csz0uZew1JqrbUJVmc9v6q0aXols8bxyDKKPfp6siyzKhHELgTS3XGskds%2BWx5FaWemc%2Bo8QqyIuoOtWjmUwF39ydFOfg%2FyeKdwBxELGLKCSN8MyV6ov7IBrib4UiM%2F6l36ymDoHIX8ohg%3D%3D\u0026amp;X-Amz-Signature=5fae434ec87a1590b80d3195ae34f9ce5431328daba6cfb2fbecec8635ca8d3f\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/435/275/184041e916929701a4fd6fefc2b5ea164f61e731/______________2019-03-04___17.04.55.png?response-content-disposition=attachment%3B%20filename%3D%22______________2019-03-04___17.04.55.png%22%3B%20filename%2A%3DUTF-8%27%27______________2019-03-04___17.04.55.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQVBWWKZ4H%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T061034Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCmEbZvVQ%2FI1GHRJjrhZK2Y6zh4lCWK725%2FwOpNu%2BnZkAIhAIZlqGHog%2B4PZMdnvhSU5APZbycPDz1wpNXbi5uE94ueKrQDCFUQARoMMDEzNjE5Mjc0ODQ5IgxU5AAHhqo1cPAzbTcqkQOGB5pEHXl6QCBCTSHUmyd%2FF8M3rpTqzp%2BOigrWU%2BrXYHZYm%2BGDawsiXhnqeD9o8Qw0b%2Fr0efVbRmhj5baoPrxgSiY%2B9zsreR3qClZZKnS0%2Brs8OqiMGd3clBbyfOxw2fa2vgQglV4dLF6EXSiGfxOms8eWdw%2F8mPtc81dMxDIlxTs50KUnd6aUjgG5BJs2k%2FL0rOKXYBS%2FdVqIQdN8JcCKMvqDv0u7pvSGEecQXa7pGdf07ufO02E64eU0OnaTeNyoq7WlZzT%2FGyvHjVtIvbXdPW15pwZm2Q4u8%2FW7ksSv4%2BxsESWLLCop0OeGUhtIppCDQlaMPC9JTj0HYKbMEGmZagmLfgHX4DKRg75%2FLNQViGcE%2FRCCaMxd6wrsv0dlz4dekjWvp4mXzLFkuKBM6c%2F%2BAemkmkgOJKnp%2FJUV1zJTe%2BO14GyIigsvxJqvrnKvkmsUrYwar1bX%2Be7UkqGzVbMAlsbRDNIOok7bVRXerhpXnbqFQsLWlqe%2BNfa4gSSfmgu4iIjCRRMdTWsvy2NQHfTsGjDAzar%2FBTrqAcniMm3eG7%2BxDZb9XVqMyQiSNyiuBD8pwO78bO8T3Uu8vSI3S05C6UCutmNkOnjR9D2NZaOgbFO4YujbW%2FY0mhhdjSppvg%2Bzdgu0AfZOou0DDwqm4vwEc0ekiNYUD6KHvD5tZwOaalihV5dSfbzoDyvfsJI6x7RYpBZmwPcshKw3Csz0uZew1JqrbUJVmc9v6q0aXols8bxyDKKPfp6siyzKhHELgTS3XGskds%2BWx5FaWemc%2Bo8QqyIuoOtWjmUwF39ydFOfg%2FyeKdwBxELGLKCSN8MyV6ov7IBrib4UiM%2F6l36ymDoHIX8ohg%3D%3D\u0026amp;X-Amz-Signature=5fae434ec87a1590b80d3195ae34f9ce5431328daba6cfb2fbecec8635ca8d3f\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003e\u003cstrong\u003eMitigation\u003c/strong\u003e\u003cbr\u003e\nThis endpoint implements some CSRF-protection: it checks the referer and origin headers, but these checks can be bypassed using the form (doesn\u0026#39;t send Origin header) and data: URI (form inside data: URI doesn\u0026#39;t send Referer header). That\u0026#39;s why it is better to use standard CSRF-protection technique with CSRF-tokens.\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eAttacker can create custom role inside New Relic app.\u003c/p\u003e\n","bounty_amount":"1500.0","formatted_bounty":"$1,500","weakness":{"id":45,"name":"Cross-Site Request Forgery (CSRF)"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":435275,"file_name":"______________2019-03-04___17.04.55.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/435/275/184041e916929701a4fd6fefc2b5ea164f61e731/______________2019-03-04___17.04.55.png?response-content-disposition=attachment%3B%20filename%3D%22______________2019-03-04___17.04.55.png%22%3B%20filename%2A%3DUTF-8%27%27______________2019-03-04___17.04.55.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQVBWWKZ4H%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T061034Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCmEbZvVQ%2FI1GHRJjrhZK2Y6zh4lCWK725%2FwOpNu%2BnZkAIhAIZlqGHog%2B4PZMdnvhSU5APZbycPDz1wpNXbi5uE94ueKrQDCFUQARoMMDEzNjE5Mjc0ODQ5IgxU5AAHhqo1cPAzbTcqkQOGB5pEHXl6QCBCTSHUmyd%2FF8M3rpTqzp%2BOigrWU%2BrXYHZYm%2BGDawsiXhnqeD9o8Qw0b%2Fr0efVbRmhj5baoPrxgSiY%2B9zsreR3qClZZKnS0%2Brs8OqiMGd3clBbyfOxw2fa2vgQglV4dLF6EXSiGfxOms8eWdw%2F8mPtc81dMxDIlxTs50KUnd6aUjgG5BJs2k%2FL0rOKXYBS%2FdVqIQdN8JcCKMvqDv0u7pvSGEecQXa7pGdf07ufO02E64eU0OnaTeNyoq7WlZzT%2FGyvHjVtIvbXdPW15pwZm2Q4u8%2FW7ksSv4%2BxsESWLLCop0OeGUhtIppCDQlaMPC9JTj0HYKbMEGmZagmLfgHX4DKRg75%2FLNQViGcE%2FRCCaMxd6wrsv0dlz4dekjWvp4mXzLFkuKBM6c%2F%2BAemkmkgOJKnp%2FJUV1zJTe%2BO14GyIigsvxJqvrnKvkmsUrYwar1bX%2Be7UkqGzVbMAlsbRDNIOok7bVRXerhpXnbqFQsLWlqe%2BNfa4gSSfmgu4iIjCRRMdTWsvy2NQHfTsGjDAzar%2FBTrqAcniMm3eG7%2BxDZb9XVqMyQiSNyiuBD8pwO78bO8T3Uu8vSI3S05C6UCutmNkOnjR9D2NZaOgbFO4YujbW%2FY0mhhdjSppvg%2Bzdgu0AfZOou0DDwqm4vwEc0ekiNYUD6KHvD5tZwOaalihV5dSfbzoDyvfsJI6x7RYpBZmwPcshKw3Csz0uZew1JqrbUJVmc9v6q0aXols8bxyDKKPfp6siyzKhHELgTS3XGskds%2BWx5FaWemc%2Bo8QqyIuoOtWjmUwF39ydFOfg%2FyeKdwBxELGLKCSN8MyV6ov7IBrib4UiM%2F6l36ymDoHIX8ohg%3D%3D\u0026X-Amz-Signature=5fae434ec87a1590b80d3195ae34f9ce5431328daba6cfb2fbecec8635ca8d3f","file_size":291305,"type":"image/png"},{"id":435288,"file_name":"untitled.html","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/435/288/4276a0ed68c8bd76924e70a1ebb2f321d00d3292/untitled.html?response-content-disposition=attachment%3B%20filename%3D%22untitled.html%22%3B%20filename%2A%3DUTF-8%27%27untitled.html\u0026response-content-type=application%2Foctet-stream\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQVBWWKZ4H%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T061034Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCmEbZvVQ%2FI1GHRJjrhZK2Y6zh4lCWK725%2FwOpNu%2BnZkAIhAIZlqGHog%2B4PZMdnvhSU5APZbycPDz1wpNXbi5uE94ueKrQDCFUQARoMMDEzNjE5Mjc0ODQ5IgxU5AAHhqo1cPAzbTcqkQOGB5pEHXl6QCBCTSHUmyd%2FF8M3rpTqzp%2BOigrWU%2BrXYHZYm%2BGDawsiXhnqeD9o8Qw0b%2Fr0efVbRmhj5baoPrxgSiY%2B9zsreR3qClZZKnS0%2Brs8OqiMGd3clBbyfOxw2fa2vgQglV4dLF6EXSiGfxOms8eWdw%2F8mPtc81dMxDIlxTs50KUnd6aUjgG5BJs2k%2FL0rOKXYBS%2FdVqIQdN8JcCKMvqDv0u7pvSGEecQXa7pGdf07ufO02E64eU0OnaTeNyoq7WlZzT%2FGyvHjVtIvbXdPW15pwZm2Q4u8%2FW7ksSv4%2BxsESWLLCop0OeGUhtIppCDQlaMPC9JTj0HYKbMEGmZagmLfgHX4DKRg75%2FLNQViGcE%2FRCCaMxd6wrsv0dlz4dekjWvp4mXzLFkuKBM6c%2F%2BAemkmkgOJKnp%2FJUV1zJTe%2BO14GyIigsvxJqvrnKvkmsUrYwar1bX%2Be7UkqGzVbMAlsbRDNIOok7bVRXerhpXnbqFQsLWlqe%2BNfa4gSSfmgu4iIjCRRMdTWsvy2NQHfTsGjDAzar%2FBTrqAcniMm3eG7%2BxDZb9XVqMyQiSNyiuBD8pwO78bO8T3Uu8vSI3S05C6UCutmNkOnjR9D2NZaOgbFO4YujbW%2FY0mhhdjSppvg%2Bzdgu0AfZOou0DDwqm4vwEc0ekiNYUD6KHvD5tZwOaalihV5dSfbzoDyvfsJI6x7RYpBZmwPcshKw3Csz0uZew1JqrbUJVmc9v6q0aXols8bxyDKKPfp6siyzKhHELgTS3XGskds%2BWx5FaWemc%2Bo8QqyIuoOtWjmUwF39ydFOfg%2FyeKdwBxELGLKCSN8MyV6ov7IBrib4UiM%2F6l36ymDoHIX8ohg%3D%3D\u0026X-Amz-Signature=b412c63f7eb09b02520d34af1674ed8c0aac8247202541229c20e38e5b919bb7","file_size":546,"type":"text/html"}],"allow_singular_disclosure_at":"2020-09-10T09:33:45.791Z","allow_singular_disclosure_after":-9491808.515231963,"singular_disclosure_allowed":true,"vote_count":5,"voters":["wi11","cryptographer","dimwip","obsecure","majidhussien"],"severity":{"rating":"medium","score":5.0,"author_type":"User","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"none","user_interaction":"required","scope":"unchanged","confidentiality":"none","integrity":"low","availability":"none"}},"structured_scope":{"databaseId":4405,"asset_type":"URL","asset_identifier":"*.newrelic.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":4252829,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"The original request has Content-Type \"application/json\" and it is somewhat can be used as CSRF-protection too but the server also processes \"application/x-www-form-urlencoded\" requests fine (the request params are like `role[name]=CSRF_ROLE` in this case) and this is one more bypass I have used.","markdown_message":"\u003cp\u003eThe original request has Content-Type \u0026quot;application/json\u0026quot; and it is somewhat can be used as CSRF-protection too but the server also processes \u0026quot;application/x-www-form-urlencoded\u0026quot; requests fine (the request params are like \u003ccode\u003erole[name]=CSRF_ROLE\u003c/code\u003e in this case) and this is one more bypass I have used.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-03-04T14:17:41.639Z","updated_at":"2019-03-04T14:17:41.639Z","actor":{"username":"skavans","cleared":true,"url":"/skavans","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/089/00a08f6b566bcdfe82b2f0be62bdde605a030823_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4252950,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Before opening attached HTML-file please replace account_id inside it (form action field) to your own.","markdown_message":"\u003cp\u003eBefore opening attached HTML-file please replace account_id inside it (form action field) to your own.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-03-04T14:40:23.061Z","updated_at":"2019-03-04T14:40:23.061Z","actor":{"username":"skavans","cleared":true,"url":"/skavans","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/089/00a08f6b566bcdfe82b2f0be62bdde605a030823_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4254851,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"Hi @skavans,\n\nThank you for your report! We've received similar reports in the past, but it's our feeling that if exploitation requires a user to download, execute, and interact with a file, then it's kind of game over for that user (why not replace that file with a keylogger, for example?).\n\nWe've adopted a CORS-based approach to CSRF protection, as opposed to a token-based approach, as it allows us to bake in CSRF protections for all applications at the service mesh tier, even those that communicate cross-domain (and cross-language/platform) without having to rebuild CSRF token logic each time. To us, these benefits would seem to outweigh the very low likelihood of a local file being used to forge an authenticated web request.\n\nWe appreciate you taking the time to write this up, and are definitely willing to revisit this topic if you can think of ways that this is more likely to be exploited! I also see that you have another report filed with us, and will take a look at that later today.\n\nCheers,\nAlex","markdown_message":"\u003cp\u003eHi \u003ca href=\"/skavans\"\u003e@skavans\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThank you for your report! We\u0026#39;ve received similar reports in the past, but it\u0026#39;s our feeling that if exploitation requires a user to download, execute, and interact with a file, then it\u0026#39;s kind of game over for that user (why not replace that file with a keylogger, for example?).\u003c/p\u003e\n\n\u003cp\u003eWe\u0026#39;ve adopted a CORS-based approach to CSRF protection, as opposed to a token-based approach, as it allows us to bake in CSRF protections for all applications at the service mesh tier, even those that communicate cross-domain (and cross-language/platform) without having to rebuild CSRF token logic each time. To us, these benefits would seem to outweigh the very low likelihood of a local file being used to forge an authenticated web request.\u003c/p\u003e\n\n\u003cp\u003eWe appreciate you taking the time to write this up, and are definitely willing to revisit this topic if you can think of ways that this is more likely to be exploited! I also see that you have another report filed with us, and will take a look at that later today.\u003c/p\u003e\n\n\u003cp\u003eCheers,\u003cbr\u003e\nAlex\u003c/p\u003e\n","automated_response":false,"created_at":"2019-03-04T18:40:10.068Z","updated_at":"2019-03-04T18:40:10.068Z","actor":{"username":"ahamlin","cleared":false,"url":"/ahamlin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/071/b10c1e5872fac616ba0f3b67bb1e6e06ba70fe6c_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4255103,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @ahamlin,\n\nI am sorry for the unclear reproduce steps, it is my imperfection.\nVictim does not need to download something, this HTML-payload can be placed at any webserver, so it is only needed to visit malicious page to fire CSRF payload.\n\nPlease follow this correct reproduction steps:\n1. Sign into New Relic app as admin using Firefox\n2. Navigate to malicious page (https://xn--1xa.su/pocs/newrelic.php?acc=2260599) at the same browser. Please replace `acc` parameter with your account ID. I do not know the account ID you own, but attacker can know or can send multiple requests to many account_ids simultaneously.\n3. Navigate to roles page (https://account.newrelic.com/accounts/\u003caccount_id\u003e/roles) and make sure there is a new custom role \"CSRF_ROLE\".","markdown_message":"\u003cp\u003eHi \u003ca href=\"/ahamlin\"\u003e@ahamlin\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eI am sorry for the unclear reproduce steps, it is my imperfection.\u003cbr\u003e\nVictim does not need to download something, this HTML-payload can be placed at any webserver, so it is only needed to visit malicious page to fire CSRF payload.\u003c/p\u003e\n\n\u003cp\u003ePlease follow this correct reproduction steps:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eSign into New Relic app as admin using Firefox\u003c/li\u003e\n\u003cli\u003eNavigate to malicious page (\u003ca title=\"https://xn--1xa.su/pocs/newrelic.php?acc=2260599\" href=\"/redirect?url=https%3A%2F%2Fxn--1xa.su%2Fpocs%2Fnewrelic.php%3Facc%3D2260599\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://xn--1xa.su/pocs/newrelic.php?acc=2260599\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e) at the same browser. Please replace \u003ccode\u003eacc\u003c/code\u003e parameter with your account ID. I do not know the account ID you own, but attacker can know or can send multiple requests to many account_ids simultaneously.\u003c/li\u003e\n\u003cli\u003eNavigate to roles page (\u003ca title=\"https://account.newrelic.com/accounts/\" href=\"/redirect?url=https%3A%2F%2Faccount.newrelic.com%2Faccounts%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://account.newrelic.com/accounts/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u0026lt;account_id\u0026gt;/roles) and make sure there is a new custom role \u0026quot;CSRF_ROLE\u0026quot;.\u003c/li\u003e\n\u003c/ol\u003e\n","automated_response":false,"created_at":"2019-03-04T19:13:38.065Z","updated_at":"2019-03-04T19:13:38.065Z","actor":{"username":"skavans","cleared":true,"url":"/skavans","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/089/00a08f6b566bcdfe82b2f0be62bdde605a030823_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4255136,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"If it is inconvenient for you to use CSRF-tokens, you can fix this using some of the following mitigation steps:\n1. Accept only application/json requests (now application/x-www-form-urlencoded is accepted and processed by server). application/json request can not be forged at modern browsers.\n2. Do not accept requests with blank Referer header (I have used data: URI in my POC to send no referer). It is impossible to forge referer but attacker can send blank one.","markdown_message":"\u003cp\u003eIf it is inconvenient for you to use CSRF-tokens, you can fix this using some of the following mitigation steps:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eAccept only application/json requests (now application/x-www-form-urlencoded is accepted and processed by server). application/json request can not be forged at modern browsers.\u003c/li\u003e\n\u003cli\u003eDo not accept requests with blank Referer header (I have used data: URI in my POC to send no referer). It is impossible to forge referer but attacker can send blank one.\u003c/li\u003e\n\u003c/ol\u003e\n","automated_response":false,"created_at":"2019-03-04T19:17:11.194Z","updated_at":"2019-03-04T19:19:43.143Z","actor":{"username":"skavans","cleared":true,"url":"/skavans","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/089/00a08f6b566bcdfe82b2f0be62bdde605a030823_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4255462,"is_internal":false,"editable":false,"type":"Activities::BugReopened","message":"","markdown_message":"","automated_response":false,"created_at":"2019-03-04T20:06:01.361Z","updated_at":"2019-03-04T20:06:01.361Z","actor":{"username":"ahamlin","cleared":false,"url":"/ahamlin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/071/b10c1e5872fac616ba0f3b67bb1e6e06ba70fe6c_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4256861,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for the additional context! I will take a second, closer look at this report tomorrow.","markdown_message":"\u003cp\u003eThanks for the additional context! I will take a second, closer look at this report tomorrow.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-03-05T01:10:00.482Z","updated_at":"2019-03-05T01:10:00.482Z","actor":{"username":"ahamlin","cleared":false,"url":"/ahamlin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/071/b10c1e5872fac616ba0f3b67bb1e6e06ba70fe6c_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4264225,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hey @skavans,\n\nI was able to reproduce this—by hosting the .html file you provided and navigating to it, my browser sent a POST request, complete with my authentication cookie, to New Relic, without setting either the `Origin` or `Referer` headers.\n\nI'm working with the engineering team to investigate how we want to fix this. We're going to start by building monitoring to determine how many of our services send requests without either the `Origin` or `Referer` headers being set, and whether we intentionally send any POST requests using the non-preflight content types (`application/x-www-form-urlencoded`, `multipart/form-data`, or `text/plain`).\n\nWe'll keep you updated as we remediate this issue. Thanks for your help in keeping New Relic secure!","markdown_message":"\u003cp\u003eHey \u003ca href=\"/skavans\"\u003e@skavans\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eI was able to reproduce this—by hosting the .html file you provided and navigating to it, my browser sent a POST request, complete with my authentication cookie, to New Relic, without setting either the \u003ccode\u003eOrigin\u003c/code\u003e or \u003ccode\u003eReferer\u003c/code\u003e headers.\u003c/p\u003e\n\n\u003cp\u003eI\u0026#39;m working with the engineering team to investigate how we want to fix this. We\u0026#39;re going to start by building monitoring to determine how many of our services send requests without either the \u003ccode\u003eOrigin\u003c/code\u003e or \u003ccode\u003eReferer\u003c/code\u003e headers being set, and whether we intentionally send any POST requests using the non-preflight content types (\u003ccode\u003eapplication/x-www-form-urlencoded\u003c/code\u003e, \u003ccode\u003emultipart/form-data\u003c/code\u003e, or \u003ccode\u003etext/plain\u003c/code\u003e).\u003c/p\u003e\n\n\u003cp\u003eWe\u0026#39;ll keep you updated as we remediate this issue. Thanks for your help in keeping New Relic secure!\u003c/p\u003e\n","automated_response":false,"created_at":"2019-03-06T00:36:28.050Z","updated_at":"2019-03-06T00:36:28.050Z","actor":{"username":"ahamlin","cleared":false,"url":"/ahamlin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/071/b10c1e5872fac616ba0f3b67bb1e6e06ba70fe6c_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":436149,"filename":"Screen_Shot_2019-03-05_at_3.12.15_PM.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/436/149/7c44100e085da390ff808f37cbbcb40443d3f041/Screen_Shot_2019-03-05_at_3.12.15_PM.png?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2019-03-05_at_3.12.15_PM.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2019-03-05_at_3.12.15_PM.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQVBWWKZ4H%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T061034Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCmEbZvVQ%2FI1GHRJjrhZK2Y6zh4lCWK725%2FwOpNu%2BnZkAIhAIZlqGHog%2B4PZMdnvhSU5APZbycPDz1wpNXbi5uE94ueKrQDCFUQARoMMDEzNjE5Mjc0ODQ5IgxU5AAHhqo1cPAzbTcqkQOGB5pEHXl6QCBCTSHUmyd%2FF8M3rpTqzp%2BOigrWU%2BrXYHZYm%2BGDawsiXhnqeD9o8Qw0b%2Fr0efVbRmhj5baoPrxgSiY%2B9zsreR3qClZZKnS0%2Brs8OqiMGd3clBbyfOxw2fa2vgQglV4dLF6EXSiGfxOms8eWdw%2F8mPtc81dMxDIlxTs50KUnd6aUjgG5BJs2k%2FL0rOKXYBS%2FdVqIQdN8JcCKMvqDv0u7pvSGEecQXa7pGdf07ufO02E64eU0OnaTeNyoq7WlZzT%2FGyvHjVtIvbXdPW15pwZm2Q4u8%2FW7ksSv4%2BxsESWLLCop0OeGUhtIppCDQlaMPC9JTj0HYKbMEGmZagmLfgHX4DKRg75%2FLNQViGcE%2FRCCaMxd6wrsv0dlz4dekjWvp4mXzLFkuKBM6c%2F%2BAemkmkgOJKnp%2FJUV1zJTe%2BO14GyIigsvxJqvrnKvkmsUrYwar1bX%2Be7UkqGzVbMAlsbRDNIOok7bVRXerhpXnbqFQsLWlqe%2BNfa4gSSfmgu4iIjCRRMdTWsvy2NQHfTsGjDAzar%2FBTrqAcniMm3eG7%2BxDZb9XVqMyQiSNyiuBD8pwO78bO8T3Uu8vSI3S05C6UCutmNkOnjR9D2NZaOgbFO4YujbW%2FY0mhhdjSppvg%2Bzdgu0AfZOou0DDwqm4vwEc0ekiNYUD6KHvD5tZwOaalihV5dSfbzoDyvfsJI6x7RYpBZmwPcshKw3Csz0uZew1JqrbUJVmc9v6q0aXols8bxyDKKPfp6siyzKhHELgTS3XGskds%2BWx5FaWemc%2Bo8QqyIuoOtWjmUwF39ydFOfg%2FyeKdwBxELGLKCSN8MyV6ov7IBrib4UiM%2F6l36ymDoHIX8ohg%3D%3D\u0026X-Amz-Signature=57eb3127afc3a47f647c10fc464bf94d9a628532614771c62c4ad12dff118c4e"}],"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4264227,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"{F436175}","markdown_message":"\u003cp\u003e\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"_14.gif\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/436/175/88293cd19b2d1ba28271b66fcf7be2a1e544a81d/_14.gif?response-content-disposition=attachment%3B%20filename%3D%22_14.gif%22%3B%20filename%2A%3DUTF-8%27%27_14.gif\u0026amp;response-content-type=image%2Fgif\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQVBWWKZ4H%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T061034Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCmEbZvVQ%2FI1GHRJjrhZK2Y6zh4lCWK725%2FwOpNu%2BnZkAIhAIZlqGHog%2B4PZMdnvhSU5APZbycPDz1wpNXbi5uE94ueKrQDCFUQARoMMDEzNjE5Mjc0ODQ5IgxU5AAHhqo1cPAzbTcqkQOGB5pEHXl6QCBCTSHUmyd%2FF8M3rpTqzp%2BOigrWU%2BrXYHZYm%2BGDawsiXhnqeD9o8Qw0b%2Fr0efVbRmhj5baoPrxgSiY%2B9zsreR3qClZZKnS0%2Brs8OqiMGd3clBbyfOxw2fa2vgQglV4dLF6EXSiGfxOms8eWdw%2F8mPtc81dMxDIlxTs50KUnd6aUjgG5BJs2k%2FL0rOKXYBS%2FdVqIQdN8JcCKMvqDv0u7pvSGEecQXa7pGdf07ufO02E64eU0OnaTeNyoq7WlZzT%2FGyvHjVtIvbXdPW15pwZm2Q4u8%2FW7ksSv4%2BxsESWLLCop0OeGUhtIppCDQlaMPC9JTj0HYKbMEGmZagmLfgHX4DKRg75%2FLNQViGcE%2FRCCaMxd6wrsv0dlz4dekjWvp4mXzLFkuKBM6c%2F%2BAemkmkgOJKnp%2FJUV1zJTe%2BO14GyIigsvxJqvrnKvkmsUrYwar1bX%2Be7UkqGzVbMAlsbRDNIOok7bVRXerhpXnbqFQsLWlqe%2BNfa4gSSfmgu4iIjCRRMdTWsvy2NQHfTsGjDAzar%2FBTrqAcniMm3eG7%2BxDZb9XVqMyQiSNyiuBD8pwO78bO8T3Uu8vSI3S05C6UCutmNkOnjR9D2NZaOgbFO4YujbW%2FY0mhhdjSppvg%2Bzdgu0AfZOou0DDwqm4vwEc0ekiNYUD6KHvD5tZwOaalihV5dSfbzoDyvfsJI6x7RYpBZmwPcshKw3Csz0uZew1JqrbUJVmc9v6q0aXols8bxyDKKPfp6siyzKhHELgTS3XGskds%2BWx5FaWemc%2Bo8QqyIuoOtWjmUwF39ydFOfg%2FyeKdwBxELGLKCSN8MyV6ov7IBrib4UiM%2F6l36ymDoHIX8ohg%3D%3D\u0026amp;X-Amz-Signature=6bf237cd14a4e4a576f7ec9a13e05075fb87d3c2c19a15c872ad00287657c463\" data-attachment-type=\"image/gif\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/436/175/88293cd19b2d1ba28271b66fcf7be2a1e544a81d/_14.gif?response-content-disposition=attachment%3B%20filename%3D%22_14.gif%22%3B%20filename%2A%3DUTF-8%27%27_14.gif\u0026amp;response-content-type=image%2Fgif\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQVBWWKZ4H%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T061034Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCmEbZvVQ%2FI1GHRJjrhZK2Y6zh4lCWK725%2FwOpNu%2BnZkAIhAIZlqGHog%2B4PZMdnvhSU5APZbycPDz1wpNXbi5uE94ueKrQDCFUQARoMMDEzNjE5Mjc0ODQ5IgxU5AAHhqo1cPAzbTcqkQOGB5pEHXl6QCBCTSHUmyd%2FF8M3rpTqzp%2BOigrWU%2BrXYHZYm%2BGDawsiXhnqeD9o8Qw0b%2Fr0efVbRmhj5baoPrxgSiY%2B9zsreR3qClZZKnS0%2Brs8OqiMGd3clBbyfOxw2fa2vgQglV4dLF6EXSiGfxOms8eWdw%2F8mPtc81dMxDIlxTs50KUnd6aUjgG5BJs2k%2FL0rOKXYBS%2FdVqIQdN8JcCKMvqDv0u7pvSGEecQXa7pGdf07ufO02E64eU0OnaTeNyoq7WlZzT%2FGyvHjVtIvbXdPW15pwZm2Q4u8%2FW7ksSv4%2BxsESWLLCop0OeGUhtIppCDQlaMPC9JTj0HYKbMEGmZagmLfgHX4DKRg75%2FLNQViGcE%2FRCCaMxd6wrsv0dlz4dekjWvp4mXzLFkuKBM6c%2F%2BAemkmkgOJKnp%2FJUV1zJTe%2BO14GyIigsvxJqvrnKvkmsUrYwar1bX%2Be7UkqGzVbMAlsbRDNIOok7bVRXerhpXnbqFQsLWlqe%2BNfa4gSSfmgu4iIjCRRMdTWsvy2NQHfTsGjDAzar%2FBTrqAcniMm3eG7%2BxDZb9XVqMyQiSNyiuBD8pwO78bO8T3Uu8vSI3S05C6UCutmNkOnjR9D2NZaOgbFO4YujbW%2FY0mhhdjSppvg%2Bzdgu0AfZOou0DDwqm4vwEc0ekiNYUD6KHvD5tZwOaalihV5dSfbzoDyvfsJI6x7RYpBZmwPcshKw3Csz0uZew1JqrbUJVmc9v6q0aXols8bxyDKKPfp6siyzKhHELgTS3XGskds%2BWx5FaWemc%2Bo8QqyIuoOtWjmUwF39ydFOfg%2FyeKdwBxELGLKCSN8MyV6ov7IBrib4UiM%2F6l36ymDoHIX8ohg%3D%3D\u0026amp;X-Amz-Signature=6bf237cd14a4e4a576f7ec9a13e05075fb87d3c2c19a15c872ad00287657c463\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2019-03-06T00:37:15.493Z","updated_at":"2019-03-06T00:37:15.493Z","actor":{"url":"/newrelic","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/011/eba06abb23bd6c9c7d719ddafb9fa83bd2d66aaa_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"New Relic"}},"bounty_amount":"1500.0","bounty_currency":"usd","bonus_amount":"0.0","attachments":[{"id":436175,"filename":"_14.gif","type":"image/gif","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/436/175/88293cd19b2d1ba28271b66fcf7be2a1e544a81d/_14.gif?response-content-disposition=attachment%3B%20filename%3D%22_14.gif%22%3B%20filename%2A%3DUTF-8%27%27_14.gif\u0026response-content-type=image%2Fgif\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQVBWWKZ4H%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T061034Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCmEbZvVQ%2FI1GHRJjrhZK2Y6zh4lCWK725%2FwOpNu%2BnZkAIhAIZlqGHog%2B4PZMdnvhSU5APZbycPDz1wpNXbi5uE94ueKrQDCFUQARoMMDEzNjE5Mjc0ODQ5IgxU5AAHhqo1cPAzbTcqkQOGB5pEHXl6QCBCTSHUmyd%2FF8M3rpTqzp%2BOigrWU%2BrXYHZYm%2BGDawsiXhnqeD9o8Qw0b%2Fr0efVbRmhj5baoPrxgSiY%2B9zsreR3qClZZKnS0%2Brs8OqiMGd3clBbyfOxw2fa2vgQglV4dLF6EXSiGfxOms8eWdw%2F8mPtc81dMxDIlxTs50KUnd6aUjgG5BJs2k%2FL0rOKXYBS%2FdVqIQdN8JcCKMvqDv0u7pvSGEecQXa7pGdf07ufO02E64eU0OnaTeNyoq7WlZzT%2FGyvHjVtIvbXdPW15pwZm2Q4u8%2FW7ksSv4%2BxsESWLLCop0OeGUhtIppCDQlaMPC9JTj0HYKbMEGmZagmLfgHX4DKRg75%2FLNQViGcE%2FRCCaMxd6wrsv0dlz4dekjWvp4mXzLFkuKBM6c%2F%2BAemkmkgOJKnp%2FJUV1zJTe%2BO14GyIigsvxJqvrnKvkmsUrYwar1bX%2Be7UkqGzVbMAlsbRDNIOok7bVRXerhpXnbqFQsLWlqe%2BNfa4gSSfmgu4iIjCRRMdTWsvy2NQHfTsGjDAzar%2FBTrqAcniMm3eG7%2BxDZb9XVqMyQiSNyiuBD8pwO78bO8T3Uu8vSI3S05C6UCutmNkOnjR9D2NZaOgbFO4YujbW%2FY0mhhdjSppvg%2Bzdgu0AfZOou0DDwqm4vwEc0ekiNYUD6KHvD5tZwOaalihV5dSfbzoDyvfsJI6x7RYpBZmwPcshKw3Csz0uZew1JqrbUJVmc9v6q0aXols8bxyDKKPfp6siyzKhHELgTS3XGskds%2BWx5FaWemc%2Bo8QqyIuoOtWjmUwF39ydFOfg%2FyeKdwBxELGLKCSN8MyV6ov7IBrib4UiM%2F6l36ymDoHIX8ohg%3D%3D\u0026X-Amz-Signature=6bf237cd14a4e4a576f7ec9a13e05075fb87d3c2c19a15c872ad00287657c463"}],"genius_execution_id":null,"team_handle":"newrelic","collaborator":{"username":"skavans","url":"/skavans"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4264431,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@ahamlin great thanks!","markdown_message":"\u003cp\u003e\u003ca href=\"/ahamlin\"\u003e@ahamlin\u003c/a\u003e great thanks!\u003c/p\u003e\n","automated_response":false,"created_at":"2019-03-06T01:20:44.128Z","updated_at":"2019-03-06T01:20:44.128Z","actor":{"username":"skavans","cleared":true,"url":"/skavans","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/089/00a08f6b566bcdfe82b2f0be62bdde605a030823_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4265280,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@ahamlin,\n\nPlease also note that some of the endpoints receiving `application/json` requests can also receive `application/x-www-form-urlencoded` ones. That's the thing I have used in my PoC. \n\nThe original content-type was `application/json` with payload like `{\"role\": {\"name\": \"test\"}}` but when I sent the `application/x-www-form-urlencoded` request with body like `role[name]=test`, it was processed successfully. Please do not forget to monitor this cases too.","markdown_message":"\u003cp\u003e\u003ca href=\"/ahamlin\"\u003e@ahamlin\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003ePlease also note that some of the endpoints receiving \u003ccode\u003eapplication/json\u003c/code\u003e requests can also receive \u003ccode\u003eapplication/x-www-form-urlencoded\u003c/code\u003e ones. That\u0026#39;s the thing I have used in my PoC. \u003c/p\u003e\n\n\u003cp\u003eThe original content-type was \u003ccode\u003eapplication/json\u003c/code\u003e with payload like \u003ccode\u003e{\u0026quot;role\u0026quot;: {\u0026quot;name\u0026quot;: \u0026quot;test\u0026quot;}}\u003c/code\u003e but when I sent the \u003ccode\u003eapplication/x-www-form-urlencoded\u003c/code\u003e request with body like \u003ccode\u003erole[name]=test\u003c/code\u003e, it was processed successfully. Please do not forget to monitor this cases too.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-03-06T07:30:19.930Z","updated_at":"2019-03-06T07:30:19.930Z","actor":{"username":"skavans","cleared":true,"url":"/skavans","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/089/00a08f6b566bcdfe82b2f0be62bdde605a030823_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5923585,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hey @skavans ,\n\nThis one was a doozy to fix, but I think we should be good now.","markdown_message":"\u003cp\u003eHey \u003ca href=\"/skavans\"\u003e@skavans\u003c/a\u003e ,\u003c/p\u003e\n\n\u003cp\u003eThis one was a doozy to fix, but I think we should be good now.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-09-30T16:29:28.192Z","updated_at":"2019-09-30T16:29:28.192Z","actor":{"username":"dday","cleared":false,"url":"/dday","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/290/656/1ef18673ce65d82a0c72315185fac6be67c06f0a_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"skavans","url":"/skavans"},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8902550,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-08-11T09:33:45.762Z","updated_at":"2020-08-11T09:33:45.762Z","first_to_agree":true,"actor":{"username":"skavans","cleared":true,"url":"/skavans","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/089/00a08f6b566bcdfe82b2f0be62bdde605a030823_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8923196,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Can we disclose this?","markdown_message":"\u003cp\u003eCan we disclose this?\u003c/p\u003e\n","automated_response":false,"created_at":"2020-08-13T08:31:06.216Z","updated_at":"2020-08-13T08:31:06.216Z","actor":{"username":"skavans","cleared":true,"url":"/skavans","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/089/00a08f6b566bcdfe82b2f0be62bdde605a030823_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8924810,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-08-13T11:04:24.126Z","updated_at":"2020-08-13T11:04:24.126Z","actor":{"username":"dmcmahon","cleared":false,"url":"/dmcmahon","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8924811,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-08-13T11:04:24.240Z","updated_at":"2020-08-13T11:04:24.240Z","actor":{"username":"dmcmahon","cleared":false,"url":"/dmcmahon","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}