{"id":4795,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC80Nzk1","url":"https://hackerone.com/reports/4795","title":"Bypass auth.email-domains","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2014-03-25T20:57:05.737Z","submitted_at":"2014-03-25T20:57:05.737Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"introvertmac","url":"/introvertmac","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/048/0b97b6254aa72da142a344876db2860c86051ce2_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":60,"url":"https://hackerone.com/concrete5","handle":"concrete5","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/060/c549a89ab4a3550cb9bfdeba1bee6d77e2019c7e_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/060/c549a89ab4a3550cb9bfdeba1bee6d77e2019c7e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"concrete5","twitter_handle":"concrete5","website":"https://www.concrete5.org","about":"A simple and powerful content management system."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2014-04-30T18:16:12.824Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2014-03-31T18:16:15.583Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Email addresses are stored as VARCHAR(64). the length is verified on client side only , using a proxy(temper data) attacker can add  longer length email which can be further abused .Exploiting this is rather straightforward: get an email address of 128 characters long . Now register with your 128 character email address with @allowed-domain.com appended to it. The @allowed-domain.com part will be truncated because MySQL can’t store it, and you will receive a verification email on your 128 character email address.\r\n\r\nThis is especially easy if you’re using a Gmail address: if you own attacker@gmail.com, you’ll also receive any mails sent to attacker+aaaaaaaaaaa…aaa@gmail.com.\r\n\r\nsnap attached : a POC for a truncated email address\r\n\r\n","vulnerability_information_html":"\u003cp\u003eEmail addresses are stored as VARCHAR(64). the length is verified on client side only , using a proxy(temper data) attacker can add  longer length email which can be further abused .Exploiting this is rather straightforward: get an email address of 128 characters long . Now register with your 128 character email address with \u003ca href=\"/allowed-domain\"\u003e@allowed-domain\u003c/a\u003e.com appended to it. The \u003ca href=\"/allowed-domain\"\u003e@allowed-domain\u003c/a\u003e.com part will be truncated because MySQL can’t store it, and you will receive a verification email on your 128 character email address.\u003c/p\u003e\n\n\u003cp\u003eThis is especially easy if you’re using a Gmail address: if you own \u003ca title=\"attacker@gmail.com\" href=\"mailto:attacker@gmail.com\" rel=\"nofollow noopener noreferrer\"\u003eattacker@gmail.com\u003c/a\u003e, you’ll also receive any mails sent to attacker+aaaaaaaaaaa…\u003ca title=\"aaa@gmail.com\" href=\"mailto:aaa@gmail.com\" rel=\"nofollow noopener noreferrer\"\u003eaaa@gmail.com\u003c/a\u003e.\u003c/p\u003e\n\n\u003cp\u003esnap attached : a POC for a truncated email address\u003c/p\u003e\n","weakness":{"id":27,"name":"Improper Authentication - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":4860,"file_name":"test.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/004/860/f6c710b9f43931efcf149499ed05089aba9e559b/test.png?response-content-disposition=attachment%3B%20filename%3D%22test.png%22%3B%20filename%2A%3DUTF-8%27%27test.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQRVDVIAIN%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T060450Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCIE32Mqh2tZr%2BOU5TpCkMAcCIP7cUR4Cmx6knF0aE1pAIhANosl%2BxHV6Q%2F51LP%2Fec3HeAsrkcv3Oonagtggk2l2fcHKrQDCFYQARoMMDEzNjE5Mjc0ODQ5IgyvivkNb%2F%2FihtanvJsqkQOxVl0vet745bZV8lQI5KYtwTWpcIFAsML7JxymD3vn9i8QCWhlYeT2MW%2B9baTQMb%2BdveMhrdwbKcBh3ip%2ByweQnVl9ueQzetzoXpB5k2WZrDCF3m0PA%2BCv6ox3XmJRewIkURiq4Ztl%2BHyUPdAtuOYZDYkHGUB8OqZgDmy0YoWLDqNPzGZK7dX7v62QUuo2TiCO%2BWHnWiVN2sIAHkLQ1c0cRYR2hre0%2FHfkXdHak9EM%2FJlTAH%2BQnt3DZGo6v788Hni0I1X%2F70QyGnfzTEgA8%2Fvb6vKESyULs14SrfKtlo9En1u2T1%2B79JNxVdhJNX%2BfERg06V3dMkcO%2BhECVPAWHzRrJ3bTOIIfgttUE3yW5ViJmecveb28ezf1szEuiXvW%2BZQUdTtFctgvSq22L57hu2QitzJ%2F7EFXuPPyfSKn70goiFML2nsYjayzP2jOzI85Wf0PZwwCg%2BTr7Ldre4VPxLs2y%2BAhqKPahi9iLDrk5IVFZPWBWrmRjgRlhjIP7aYZzYQEoqoD%2F3susXDMHlsiMv8yoDDN6ar%2FBTrqAdSZzhKXhWU9aDM9pF9urQto0LgyoOSxshu8McAhBrfa%2FReNxxcISybiMxPssa8oRShR7XUSBWuVRE7CnX5MQKY6UeaUB8HDokdym3sz7IA0tuq64XmfywVqSVqOZTRnXaNG%2BObO1m4FlOQ%2FC4n%2Fbe50N8rAEPnkWd81lyuaeMezjo4O%2BlEpCZ%2ByBXnfl88Bjx8KUaMIVJ5VHQ8J6PBiG%2FjOWow2rty2SDO%2BTqlQJxjPwbenYT7WUyEPOBmi%2FZgSy9qD6EP%2B5GMYGk0q2R6LmuTGm6QPTGNHaZ%2BHqK3PMyvOo0eC1hMcq6KJ8g%3D%3D\u0026X-Amz-Signature=f1bb6f6a31ace07c42f1476d28afaf7da7c28edc8d20926cb0d2f88f16d4c118","file_size":205718,"type":"image/png"}],"allow_singular_disclosure_at":"2014-04-30T18:16:09.105Z","allow_singular_disclosure_after":-210340121.0690001,"singular_disclosure_allowed":true,"vote_count":9,"voters":["sw33tlie","sameerphad72","chita","mygf","rudra_2000","medwed","spetr0x","b73772bded7541989b54f6a","loydk"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":19738,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Can you explain how this could be used maliciously?","markdown_message":"\u003cp\u003eCan you explain how this could be used maliciously?\u003c/p\u003e\n","automated_response":false,"created_at":"2014-03-25T21:06:56.012Z","updated_at":"2014-03-25T21:06:56.012Z","actor":{"username":"korvin","cleared":false,"url":"/korvin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/yi9xvfnDmjKpKA1reqNSwGct/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"concrete5","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":19740,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Actually this is same as https://hackerone.com/reports/2224 , I can bypass the client side lenth validation by using a proxy .. so the whole situation is actually same","markdown_message":"\u003cp\u003eActually this is same as \u003ca title=\"https://hackerone.com/reports/2224\" href=\"https://hackerone.com/reports/2224\"\u003ehttps://hackerone.com/reports/2224\u003c/a\u003e , I can bypass the client side lenth validation by using a proxy .. so the whole situation is actually same\u003c/p\u003e\n","automated_response":false,"created_at":"2014-03-25T21:10:29.100Z","updated_at":"2014-03-25T21:10:29.100Z","actor":{"username":"introvertmac","cleared":false,"url":"/introvertmac","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/048/0b97b6254aa72da142a344876db2860c86051ce2_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"concrete5","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":19742,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Awesome, we'll look into the best way to resolve this and let you know when it's fixed!\n\nhttps://secure.phabricator.com/D8308 explains this issue pretty thoroughly. ","markdown_message":"\u003cp\u003eAwesome, we\u0026#39;ll look into the best way to resolve this and let you know when it\u0026#39;s fixed!\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"https://secure.phabricator.com/D8308\" href=\"/redirect?url=https%3A%2F%2Fsecure.phabricator.com%2FD8308\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://secure.phabricator.com/D8308\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e explains this issue pretty thoroughly. \u003c/p\u003e\n","automated_response":false,"created_at":"2014-03-25T21:27:20.999Z","updated_at":"2014-03-25T21:27:20.999Z","actor":{"username":"korvin","cleared":false,"url":"/korvin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/yi9xvfnDmjKpKA1reqNSwGct/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"concrete5","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":19744,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Great , and sorry for being nerd . my contribution to the issue is just to bypass client side validation using tamper data ","markdown_message":"\u003cp\u003eGreat , and sorry for being nerd . my contribution to the issue is just to bypass client side validation using tamper data \u003c/p\u003e\n","automated_response":false,"created_at":"2014-03-25T21:29:17.613Z","updated_at":"2014-03-25T21:29:17.613Z","actor":{"username":"introvertmac","cleared":false,"url":"/introvertmac","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/048/0b97b6254aa72da142a344876db2860c86051ce2_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"concrete5","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":21814,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"We've gotten a fix into the upstream.\n\nIn order to hotfix a site, apply the db.xml change found in [this pull request](https://github.com/concrete5/concrete5/commit/58e45abd0fb98a5be4926c4893576fd9cd760bbe?w=1), and run the site db xml upgrade.\n\nBest wishes,\nKorvin","markdown_message":"\u003cp\u003eWe\u0026#39;ve gotten a fix into the upstream.\u003c/p\u003e\n\n\u003cp\u003eIn order to hotfix a site, apply the db.xml change found in \u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fconcrete5%2Fconcrete5%2Fcommit%2F58e45abd0fb98a5be4926c4893576fd9cd760bbe%3Fw%3D1\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ethis pull request\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e, and run the site db xml upgrade.\u003c/p\u003e\n\n\u003cp\u003eBest wishes,\u003cbr\u003e\nKorvin\u003c/p\u003e\n","automated_response":false,"created_at":"2014-03-31T18:16:09.270Z","updated_at":"2014-03-31T18:16:09.270Z","actor":{"username":"korvin","cleared":false,"url":"/korvin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/yi9xvfnDmjKpKA1reqNSwGct/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"introvertmac","url":"/introvertmac"},"genius_execution_id":null,"team_handle":"concrete5","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":21815,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Email security@concrete5.org with your address for some swag!","markdown_message":"\u003cp\u003eEmail \u003ca title=\"security@concrete5.org\" href=\"mailto:security@concrete5.org\" rel=\"nofollow noopener noreferrer\"\u003esecurity@concrete5.org\u003c/a\u003e with your address for some swag!\u003c/p\u003e\n","automated_response":false,"created_at":"2014-03-31T18:16:15.597Z","updated_at":"2014-03-31T18:16:55.898Z","actor":{"username":"korvin","cleared":false,"url":"/korvin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/yi9xvfnDmjKpKA1reqNSwGct/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"concrete5","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":21821,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Great :)  done with address , can you confirm ?","markdown_message":"\u003cp\u003eGreat :)  done with address , can you confirm ?\u003c/p\u003e\n","automated_response":false,"created_at":"2014-03-31T18:22:55.510Z","updated_at":"2014-03-31T18:22:55.510Z","actor":{"username":"introvertmac","cleared":false,"url":"/introvertmac","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/048/0b97b6254aa72da142a344876db2860c86051ce2_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"concrete5","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":21822,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Yep, we got it! We'll send you an email when it goes out.","markdown_message":"\u003cp\u003eYep, we got it! We\u0026#39;ll send you an email when it goes out.\u003c/p\u003e\n","automated_response":false,"created_at":"2014-03-31T18:24:16.720Z","updated_at":"2014-03-31T18:24:16.720Z","actor":{"username":"korvin","cleared":false,"url":"/korvin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/yi9xvfnDmjKpKA1reqNSwGct/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"concrete5","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":21823,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks :)","markdown_message":"\u003cp\u003eThanks :)\u003c/p\u003e\n","automated_response":false,"created_at":"2014-03-31T18:26:06.030Z","updated_at":"2014-03-31T18:26:06.030Z","actor":{"username":"introvertmac","cleared":false,"url":"/introvertmac","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/048/0b97b6254aa72da142a344876db2860c86051ce2_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"concrete5","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":42391,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2014-04-30T18:16:12.837Z","updated_at":"2014-04-30T18:16:12.837Z","actor":{"url":"/concrete5","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/060/c549a89ab4a3550cb9bfdeba1bee6d77e2019c7e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"concrete5"}},"genius_execution_id":null,"team_handle":"concrete5","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":42478,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Can you please make it private .","markdown_message":"\u003cp\u003eCan you please make it private .\u003c/p\u003e\n","automated_response":false,"created_at":"2014-04-30T20:42:36.949Z","updated_at":"2014-04-30T20:42:36.949Z","actor":{"username":"introvertmac","cleared":false,"url":"/introvertmac","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/048/0b97b6254aa72da142a344876db2860c86051ce2_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"concrete5","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":43046,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I don't have the ability to make things private after they have been disclosed.","markdown_message":"\u003cp\u003eI don\u0026#39;t have the ability to make things private after they have been disclosed.\u003c/p\u003e\n","automated_response":false,"created_at":"2014-05-01T21:24:45.522Z","updated_at":"2014-05-01T21:24:45.522Z","actor":{"username":"korvin","cleared":false,"url":"/korvin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/yi9xvfnDmjKpKA1reqNSwGct/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"concrete5","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}