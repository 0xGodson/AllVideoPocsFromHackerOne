{"id":279070,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yNzkwNzA=","url":"https://hackerone.com/reports/279070","title":"Chat exposed using cookie","state":"Closed","substate":"not-applicable","severity_rating":"none","readable_substate":"N/A","created_at":"2017-10-18T10:19:29.098Z","submitted_at":"2017-10-18T10:19:29.098Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"sahore","url":"/sahore","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1601,"url":"https://hackerone.com/legalrobot","handle":"legalrobot","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/601/0f164c3d9618b04b006b859517ff032ec57ab42a_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/601/0f164c3d9618b04b006b859517ff032ec57ab42a_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"paused","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Legal Robot","twitter_handle":"LegalRobot","website":"https://www.legalrobot.com","about":"Automated legal document review using artificial intelligence"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2017-10-19T22:18:21.348Z","bug_reporter_agreed_on_going_public_at":"2017-10-19T22:18:21.227Z","team_member_agreed_on_going_public_at":"2017-10-18T22:15:42.095Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"###Hello\n**Broken authentication and session management:** Attacker can use cookies of an authenticated user to reads and write the chat on the behalf of user and miss guide the legalrobot team.\n\n**Steps to reproduce:**\n * Sign-in https://app.legalrobot.com/sign-in\n * Check the cookies of domain [legaltobot.com]\n * Cookie responsible for this attack is in attachment [cook.JPG] \n  - name: intercom-session-nmyyq5i5\n * Copy the information of above cookie\n * Signed-out from the account and reuse the cookie by using and cookie editor.\n * As you use the cookie the signing screen will look like attachment [screenshot.JPG]\n\n**Scope:**\nWhile exploiting this cookie I have found that after **Logged out** from legalrobot account this cookie can be used means the session for this cookie is still alive and doesn't destroy by the server.\n","vulnerability_information_html":"\u003ch3 id=\"hello\"\u003eHello\u003c/h3\u003e\n\n\u003cp\u003e\u003cstrong\u003eBroken authentication and session management:\u003c/strong\u003e Attacker can use cookies of an authenticated user to reads and write the chat on the behalf of user and miss guide the legalrobot team.\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eSteps to reproduce:\u003c/strong\u003e\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eSign-in \u003ca title=\"https://app.legalrobot.com/sign-in\" href=\"/redirect?url=https%3A%2F%2Fapp.legalrobot.com%2Fsign-in\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://app.legalrobot.com/sign-in\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003eCheck the cookies of domain [legaltobot.com]\u003c/li\u003e\n\u003cli\u003eCookie responsible for this attack is in attachment [cook.JPG] \n\n\u003cul\u003e\n\u003cli\u003ename: intercom-session-nmyyq5i5\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eCopy the information of above cookie\u003c/li\u003e\n\u003cli\u003eSigned-out from the account and reuse the cookie by using and cookie editor.\u003c/li\u003e\n\u003cli\u003eAs you use the cookie the signing screen will look like attachment [screenshot.JPG]\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003e\u003cstrong\u003eScope:\u003c/strong\u003e\u003cbr\u003e\nWhile exploiting this cookie I have found that after \u003cstrong\u003eLogged out\u003c/strong\u003e from legalrobot account this cookie can be used means the session for this cookie is still alive and doesn\u0026#39;t destroy by the server.\u003c/p\u003e\n","weakness":{"id":97,"name":"Reliance on Cookies without Validation and Integrity Checking in a Security Decision"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":230362,"file_name":"cook.JPG","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/230/362/3bfd1f297dbf600fcafe8868a44adee230064200/cook.JPG?response-content-disposition=attachment%3B%20filename%3D%22cook.JPG%22%3B%20filename%2A%3DUTF-8%27%27cook.JPG\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ4BCTVX7H%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T052150Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQD9KoIrMtYjsPMNAoz3fkIjMCGzGeE4AC6fZNsgc%2FNK1QIhANJsfJivva8u7YF1XCVwz2O44bXLlD4DSJhj7xaMke6RKrQDCFYQARoMMDEzNjE5Mjc0ODQ5IgzmYD94JaVjjIU2krEqkQPkOp7o1Y%2F3O46uPVkJpWKluhPjw6yqgkTOXGekCyVjJWTTKaV%2Fg4VslprjcyOrHq6Kvjx6FFrvI%2F0oeazfhhuVbsGzIX%2FDNyDl86o7E8p7xdE9njyFrZSTuG%2BcoCSQTNZm6K7xytZ808%2FmbOq1EsQaswjTfJE49knSO3dd6P9o4TMruMzu8iALfM0IqlU4CgtICPjNu1SwD5gIiOjS3JXo97WJ%2FeXaWM7uiiaZIfnwM1%2FJh%2B%2Bf4y2CVgdWsivBsUOOKr5Ffs4r9dvRgpxa%2BT%2FmspuhFLSjdwidy384ywNVej%2Fu5TtU0RmHvya7IsEPuuyEVKZ9GXWYeHJPMuJLhkj%2F9NgnnqTSYay6UqseBG9goY2oONYS%2Fy7uIy6pIkzSjH260rcLKe0FPxGZ3OZNA097jOWSnOIGGcV1YZW18F%2FQaHb3tqnILMft5hGAudbC%2F2kJRmQyb4mArK%2Bic9Gh50TdBT%2BX29t3Wo5dLJweBsKIOOdeF41%2BqY1abZEgoOIbiscyoLBMO4ChJxBEiM%2By%2Bjg8FjC%2B6ar%2FBTrqAdRlQf357Lw7olVqK9BuDw0RNDzAgG1%2BRjmEy94ivfSQKRkYnOaGVWNx1MekakiogYuOKzbAujbete9Cin2JFJP4a22qFOVAg7tsJ%2FeJITiLIkogRaku8DmGovq%2B04Yxq2jfRp5la%2FeG3Fqca5Jc2WM%2BO7QxCdRE21wSAgKnCwsy8vQV1X0gGJjUOV6UsIimNdWCtKUego7nGl1OprelVr%2FiPIFvPy%2BhWrWWJF9nHO59wa4OZtoRJ5df5%2ByoAAAuIWDBKZfHRv45K8z7hZFmm4sjyreHKi0tXU9Fadu828o5w%2B3CHi4r%2BAT0Pg%3D%3D\u0026X-Amz-Signature=1e948e5322ed42634696556fb9c65c9bf839748fb2c19d8571a154a9678c1dbf","file_size":34405,"type":"image/jpeg"},{"id":230363,"file_name":"screenshot.JPG","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/230/363/2cb9980bbf3cd1d0dded0e5a45294a6dc892f963/screenshot.JPG?response-content-disposition=attachment%3B%20filename%3D%22screenshot.JPG%22%3B%20filename%2A%3DUTF-8%27%27screenshot.JPG\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ4BCTVX7H%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T052150Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQD9KoIrMtYjsPMNAoz3fkIjMCGzGeE4AC6fZNsgc%2FNK1QIhANJsfJivva8u7YF1XCVwz2O44bXLlD4DSJhj7xaMke6RKrQDCFYQARoMMDEzNjE5Mjc0ODQ5IgzmYD94JaVjjIU2krEqkQPkOp7o1Y%2F3O46uPVkJpWKluhPjw6yqgkTOXGekCyVjJWTTKaV%2Fg4VslprjcyOrHq6Kvjx6FFrvI%2F0oeazfhhuVbsGzIX%2FDNyDl86o7E8p7xdE9njyFrZSTuG%2BcoCSQTNZm6K7xytZ808%2FmbOq1EsQaswjTfJE49knSO3dd6P9o4TMruMzu8iALfM0IqlU4CgtICPjNu1SwD5gIiOjS3JXo97WJ%2FeXaWM7uiiaZIfnwM1%2FJh%2B%2Bf4y2CVgdWsivBsUOOKr5Ffs4r9dvRgpxa%2BT%2FmspuhFLSjdwidy384ywNVej%2Fu5TtU0RmHvya7IsEPuuyEVKZ9GXWYeHJPMuJLhkj%2F9NgnnqTSYay6UqseBG9goY2oONYS%2Fy7uIy6pIkzSjH260rcLKe0FPxGZ3OZNA097jOWSnOIGGcV1YZW18F%2FQaHb3tqnILMft5hGAudbC%2F2kJRmQyb4mArK%2Bic9Gh50TdBT%2BX29t3Wo5dLJweBsKIOOdeF41%2BqY1abZEgoOIbiscyoLBMO4ChJxBEiM%2By%2Bjg8FjC%2B6ar%2FBTrqAdRlQf357Lw7olVqK9BuDw0RNDzAgG1%2BRjmEy94ivfSQKRkYnOaGVWNx1MekakiogYuOKzbAujbete9Cin2JFJP4a22qFOVAg7tsJ%2FeJITiLIkogRaku8DmGovq%2B04Yxq2jfRp5la%2FeG3Fqca5Jc2WM%2BO7QxCdRE21wSAgKnCwsy8vQV1X0gGJjUOV6UsIimNdWCtKUego7nGl1OprelVr%2FiPIFvPy%2BhWrWWJF9nHO59wa4OZtoRJ5df5%2ByoAAAuIWDBKZfHRv45K8z7hZFmm4sjyreHKi0tXU9Fadu828o5w%2B3CHi4r%2BAT0Pg%3D%3D\u0026X-Amz-Signature=f471e9f20a50d2573e0e0a86fadd2732b6cd9a5d37331e00918aa6107643f496","file_size":220100,"type":"image/jpeg"}],"allow_singular_disclosure_at":null,"vote_count":0,"voters":[],"severity":{"rating":"none","author_type":"Team"},"structured_scope":{"databaseId":519,"asset_type":"URL","asset_identifier":"app.legalrobot.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":2082070,"is_internal":false,"editable":false,"type":"Activities::BugNotApplicable","message":"Closing as Not Applicable since Intercom is specifically listed as out of scope in our program policy. Also, this would require self-exploit, which also makes it ineligible.","markdown_message":"\u003cp\u003eClosing as Not Applicable since Intercom is specifically listed as out of scope in our program policy. Also, this would require self-exploit, which also makes it ineligible.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-10-18T22:15:16.081Z","updated_at":"2017-10-18T22:16:11.130Z","actor":{"username":"danrubins","cleared":false,"url":"/danrubins","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/021/222/c1d0d51f40e0c570e2153b6801fe54c997c757f0_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"legalrobot","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2082071,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Requesting full disclosure in the interest of transparency.","markdown_message":"\u003cp\u003eRequesting full disclosure in the interest of transparency.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-10-18T22:15:42.113Z","updated_at":"2017-10-18T22:15:42.113Z","first_to_agree":true,"actor":{"username":"danrubins","cleared":false,"url":"/danrubins","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/021/222/c1d0d51f40e0c570e2153b6801fe54c997c757f0_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"legalrobot","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2086443,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"**Sorry for your inconvenience**\nRequest for public disclosure.","markdown_message":"\u003cp\u003e\u003cstrong\u003eSorry for your inconvenience\u003c/strong\u003e\u003cbr\u003e\nRequest for public disclosure.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-10-19T22:18:21.281Z","updated_at":"2017-10-19T22:18:21.281Z","actor":{"username":"sahore","cleared":false,"url":"/sahore","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"legalrobot","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2086444,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-10-19T22:18:21.387Z","updated_at":"2017-10-19T22:18:21.387Z","actor":{"username":"sahore","cleared":false,"url":"/sahore","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"legalrobot","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2107279,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2017-10-27T01:50:49.960Z","updated_at":"2017-10-27T01:50:49.960Z","additional_data":{"old_title":"Chat exposed using cookie [Conversations with Legal Robot]","new_title":"Chat exposed using cookie"},"actor":{"username":"danrubins","cleared":false,"url":"/danrubins","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/021/222/c1d0d51f40e0c570e2153b6801fe54c997c757f0_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"legalrobot","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2107283,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2017-10-27T01:51:42.452Z","updated_at":"2017-10-27T01:51:42.452Z","additional_data":{"old_severity":"Medium","new_severity":"None","old_severity_id":84953,"new_severity_id":88946},"actor":{"username":"danrubins","cleared":false,"url":"/danrubins","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/021/222/c1d0d51f40e0c570e2153b6801fe54c997c757f0_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"legalrobot","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":5626,"category":"team","content":"Closed as Not Applicable since Intercom is specifically listed as out of scope in our program policy.","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eClosed as Not Applicable since Intercom is specifically listed as out of scope in our program policy.\u003c/p\u003e\n"},{"category":"researcher","can_view?":true,"can_create?":false}]}