{"id":137502,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMzc1MDI=","url":"https://hackerone.com/reports/137502","title":"All Vimeo Private videos disclosure via Authorization Bypass","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-05-10T14:50:25.496Z","submitted_at":"2016-05-10T14:50:25.496Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"opnsec","url":"/opnsec","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/002/871/17ffe7f89623315912b4a69a6441247262583484_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":56,"url":"https://hackerone.com/vimeo","handle":"vimeo","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/056/c3188aa0fc4a95fd486b5ee1f4b2d0b90da111d3_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/056/c3188aa0fc4a95fd486b5ee1f4b2d0b90da111d3_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Vimeo","twitter_handle":"vimeo","website":"https://vimeo.com","about":"Make life worth watching"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2016-07-29T12:03:07.183Z","bug_reporter_agreed_on_going_public_at":"2016-06-29T12:03:00.547Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hello,\n\nThere is a vulnerability in `https://vimeo.com/[VIDEO_ID]?action=share` that makes all Vimeo private videos available to anybody.\n\nPOC link :\nhttp://opnsec.com/vimeo/vl/videoLeak.php?video=[VIDEO_ID]\n\nPOC requirements :\n- No need to be logged in Vimeo\n- Because of sensitivity of this, I put a password on the POC :\nusername : vimeo\npassword : aS3cr3tP4$$wrD7854123\n\nPOC instructions :\n1. Open the POC link replacing `[VIDEO_ID]` by any Vimeo private video id (I believe all type of private videos are vulnerable)\n2. Enter the username and password as per requirements \n3. If the Vimeo video id is correct, no matter the status of the video, the video should start playing.\n\n---------\n\nTechnical description :\n\n`https://vimeo.com/[VIDEO_ID]?action=share` is an Ajax link used to ask Vimeo for the \"Share\" code to embed the video\nBecause it is Ajax, the server is only replying if the `Header X-Requested-With is set to XMLHttpRequest`.\n\nIf the Attacker send this request with a [VIDEO_ID] of a private video that he don't have access to, the server reply with an error message. However, this message contains the link to the `config` file of the private video including a `token parameter s=[SECRET]` which will grant the attacker access to the config file.\nThe config file contains all the info about the video including the actual video file links, video title, owner vimeo account, ... which means that the attacker has complete access to the video.\n\nExample of config file with `token parameter s=[SECRET] `\n```\nhttps://player.vimeo.com/video/165266592/config?autoplay=0\u0026byline=0\u0026bypass_privacy=1\u0026context=Vimeo%5CController%5CClipController.main\u0026default_to_hd=1\u0026portrait=0\u0026title=0\u0026s=bb016a22af815053eb54XXXXXXX019d8_1462989197\n```\n------\nVulnerability Mitigation \n\nTo resolve this issue, the `https://vimeo.com/[VIDEO_ID]?action=share` server should not include the token parameter `s=[SECRET]` of the config file in the error response of `https://vimeo.com/[VIDEO_ID]?action=share`if the user doesn't have right to access the video.\nThere is a good chance this vulnerability is present in other links, especially other Ajax links.\n\nIn addition, if that is possible, the `https://player.vimeo.com/video/[VIDEO_ID]/config` config file server should also check that the user has valid right to access the video even if he has a correct `s=[SECRET]` token\n\n-------------\n\nHere is the source code of `http://opnsec.com/vimeo/vl/videoLeak.php`\n\nIf you need more info or if the POC doesn't work feel free to contact me.\n\nRegards,\n\nEnguerran Gillier\n\u0026#x2588;\u0026#x2588;\u0026#x2588;\u0026#x2588;\u0026#x2588;\u0026#x2588;\u0026#x2588;\u0026#x2588;\u0026#x2588;\u0026#x2588;\u0026#x2588;\u0026#x2588;\u0026#x2588;\u0026#x2588;\u0026#x2588;\u0026#x2588;\u0026#x2588;\u0026#x2588;\n\u0026#x2588;\u0026#x2588;\u0026#x2588;\u0026#x2588;\u0026#x2588;\u0026#x2588;\u0026#x2588;\u0026#x2588;\u0026#x2588;\u0026#x2588;\u0026#x2588;\u0026#x2588;\u0026#x2588;\u0026#x2588;\u0026#x2588;\u0026#x2588;\u0026#x2588;\u0026#x2588;\u0026#x2588;\u0026#x2588;\u0026#x2588;\u0026#x2588;","vulnerability_information_html":"\u003cp\u003eHello,\u003c/p\u003e\n\n\u003cp\u003eThere is a vulnerability in \u003ccode\u003ehttps://vimeo.com/[VIDEO_ID]?action=share\u003c/code\u003e that makes all Vimeo private videos available to anybody.\u003c/p\u003e\n\n\u003cp\u003ePOC link :\u003cbr\u003e\n\u003ca title=\"http://opnsec.com/vimeo/vl/videoLeak.php?video=%5BVIDEO_ID%5D\" href=\"/redirect?url=http%3A%2F%2Fopnsec.com%2Fvimeo%2Fvl%2FvideoLeak.php%3Fvideo%3D%255BVIDEO_ID%255D\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://opnsec.com/vimeo/vl/videoLeak.php?video=%5BVIDEO_ID%5D\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003ePOC requirements :\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eNo need to be logged in Vimeo\u003c/li\u003e\n\u003cli\u003eBecause of sensitivity of this, I put a password on the POC :\nusername : vimeo\npassword : aS3cr3tP4$$wrD7854123\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003ePOC instructions :\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eOpen the POC link replacing \u003ccode\u003e[VIDEO_ID]\u003c/code\u003e by any Vimeo private video id (I believe all type of private videos are vulnerable)\u003c/li\u003e\n\u003cli\u003eEnter the username and password as per requirements \u003c/li\u003e\n\u003cli\u003eIf the Vimeo video id is correct, no matter the status of the video, the video should start playing.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003chr\u003e\n\n\u003cp\u003eTechnical description :\u003c/p\u003e\n\n\u003cp\u003e\u003ccode\u003ehttps://vimeo.com/[VIDEO_ID]?action=share\u003c/code\u003e is an Ajax link used to ask Vimeo for the \u0026quot;Share\u0026quot; code to embed the video\u003cbr\u003e\nBecause it is Ajax, the server is only replying if the \u003ccode\u003eHeader X-Requested-With is set to XMLHttpRequest\u003c/code\u003e.\u003c/p\u003e\n\n\u003cp\u003eIf the Attacker send this request with a [VIDEO_ID] of a private video that he don\u0026#39;t have access to, the server reply with an error message. However, this message contains the link to the \u003ccode\u003econfig\u003c/code\u003e file of the private video including a \u003ccode\u003etoken parameter s=[SECRET]\u003c/code\u003e which will grant the attacker access to the config file.\u003cbr\u003e\nThe config file contains all the info about the video including the actual video file links, video title, owner vimeo account, ... which means that the attacker has complete access to the video.\u003c/p\u003e\n\n\u003cp\u003eExample of config file with \u003ccode\u003etoken parameter s=[SECRET]\u003c/code\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ehttps://player.vimeo.com/video/165266592/config?autoplay=0\u0026amp;byline=0\u0026amp;bypass_privacy=1\u0026amp;context=Vimeo%5CController%5CClipController.main\u0026amp;default_to_hd=1\u0026amp;portrait=0\u0026amp;title=0\u0026amp;s=bb016a22af815053eb54XXXXXXX019d8_1462989197\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003chr\u003e\n\n\u003cp\u003eVulnerability Mitigation \u003c/p\u003e\n\n\u003cp\u003eTo resolve this issue, the \u003ccode\u003ehttps://vimeo.com/[VIDEO_ID]?action=share\u003c/code\u003e server should not include the token parameter \u003ccode\u003es=[SECRET]\u003c/code\u003e of the config file in the error response of \u003ccode\u003ehttps://vimeo.com/[VIDEO_ID]?action=share\u003c/code\u003eif the user doesn\u0026#39;t have right to access the video.\u003cbr\u003e\nThere is a good chance this vulnerability is present in other links, especially other Ajax links.\u003c/p\u003e\n\n\u003cp\u003eIn addition, if that is possible, the \u003ccode\u003ehttps://player.vimeo.com/video/[VIDEO_ID]/config\u003c/code\u003e config file server should also check that the user has valid right to access the video even if he has a correct \u003ccode\u003es=[SECRET]\u003c/code\u003e token\u003c/p\u003e\n\n\u003chr\u003e\n\n\u003cp\u003eHere is the source code of \u003ccode\u003ehttp://opnsec.com/vimeo/vl/videoLeak.php\u003c/code\u003e\u003c/p\u003e\n\n\u003cp\u003eIf you need more info or if the POC doesn\u0026#39;t work feel free to contact me.\u003c/p\u003e\n\n\u003cp\u003eRegards,\u003c/p\u003e\n\n\u003cp\u003eEnguerran Gillier\u003cbr\u003e\n██████████████████\u003cbr\u003e\n██████████████████████\u003c/p\u003e\n","bounty_amount":"600.0","formatted_bounty":"$600","weakness":{"id":18,"name":"Information Disclosure"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":92502,"file_name":"videoLeak.php","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/092/502/bce33e94210d6674e694a1cd07227941eabb5dc8/videoLeak.php?response-content-disposition=attachment%3B%20filename%3D%22videoLeak.php%22%3B%20filename%2A%3DUTF-8%27%27videoLeak.php\u0026response-content-type=text%2Fx-php\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ25CUMV77%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T042656Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJj%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIAzPBxfjhI%2FOiR%2B1g7qgHtu%2BTSWR72ZbKmRPdv61x9tZAiEA7d5guv7RrcybHHoMbJ5xcSYkf5cIncRQif%2BDwrhUxL4qtAMIURABGgwwMTM2MTkyNzQ4NDkiDLU8cXGXokn2dJzgWyqRA5t82BwvWjjXR1flrxPY1G8nb%2BmyZbhMX7bIDSshUvXOZWrYMuqnjFp50lwKRioT0tqSyswhE%2FmxcGN2dZffgFfm45Y15zW32QivQspJz2zpwJxFycBtjnRvl%2FMGegWgMTliaPfGzxGYLkpzI0cHFjLk%2BKaC50Jxtx51oChC%2BCytCTVfzOq2Ax%2BcOQ92r8%2FEVvUqeZR%2BTPUidVPdANT%2FJyfcDkVZSZzQz9EjBhPlfadpw5dBs4QJ%2BDdADV0MdhKltTlk%2FyXYCPqWqRloAtWd1nGtuRb2iTe6dG%2FjlvEdGxsyq3XSWVpxob44SfkNT25WtiGoWTrQta7tHUBAIeejr1qo89oGEttSf7d8Lku1wWROst97KwhMf%2B%2Bj34q6jzK8i1Hw8XE5vydIGbQfSR452%2FCUDzasjIErk2%2F0Ktvsz%2Bx3csi5j3IwrXlZf4YgORAmKN1LdQQkzS%2BV1sgEfBg4MiQjSsKotzm%2FUgXxu10BwEW2Dhb8oNMpsZ1FjdjbCQGOQD7Feifp2fVzXkXhF1DMwndWMOrpqf8FOusBKlCtIwN5UHYU%2F5Q2IWJVa2twlUdU6iZvdqJG%2FbyL1HncSkMTTf174kVtrd08ZtfhfQ%2B%2FGZMeT3%2BWmMgtiSxiN8zlfLWyyOmRNNNrcZLeamXU8gijNm5O%2FRQyUqS40M%2B09rACFWxFC6eSAj2%2BBOBxHA6bEgtgV3Z6D4uLX3zxwXXu%2BF%2BhhCTXgcbobecE2HXiCLYk05uES7bSCIeUoggVUmunssom%2Bu8yCYvg2qvqpHVNwChBmtVZLiGt79EkgpsqfgvK113rJiRtjBkxEHINtbd%2FcmRPwl2VUc1W%2BEpCc%2FxxQcCayPndzJKPSw%3D%3D\u0026X-Amz-Signature=c2f5a21ed3da6ff6ce2571b2bcd6c8c2f09c842af42b1065a37c946a61d8eec6","file_size":2955,"type":"text/x-php"}],"allow_singular_disclosure_at":"2016-07-29T12:03:00.787Z","allow_singular_disclosure_after":-139422235.2475143,"singular_disclosure_allowed":true,"vote_count":29,"voters":["sourc7","hunter","spam404","opnsec","zombiehelp54","lucky_sen","bugdiscloseguys","kieran","jutsuce","r3y","and 19 more..."],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":948986,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks! This should be resolved.","markdown_message":"\u003cp\u003eThanks! This should be resolved.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-05-10T16:05:17.375Z","updated_at":"2016-05-10T16:05:17.375Z","actor":{"username":"jayyspence7","cleared":false,"url":"/jayyspence7","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vimeo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":949016,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Yes, it is fixed for me.","markdown_message":"\u003cp\u003eYes, it is fixed for me.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-05-10T16:24:52.998Z","updated_at":"2016-05-10T16:24:52.998Z","actor":{"username":"opnsec","cleared":false,"url":"/opnsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/871/17ffe7f89623315912b4a69a6441247262583484_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vimeo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":949053,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2016-05-10T16:44:25.028Z","updated_at":"2016-05-10T16:44:25.028Z","actor":{"username":"jayyspence7","cleared":false,"url":"/jayyspence7","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"opnsec","url":"/opnsec"},"genius_execution_id":null,"team_handle":"vimeo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":949055,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks for helping make Vimeo more secure :)","markdown_message":"\u003cp\u003eThanks for helping make Vimeo more secure :)\u003c/p\u003e\n","automated_response":false,"created_at":"2016-05-10T16:45:19.047Z","updated_at":"2016-05-10T16:45:19.047Z","actor":{"url":"/vimeo","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/056/c3188aa0fc4a95fd486b5ee1f4b2d0b90da111d3_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Vimeo"}},"bounty_amount":"600.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"vimeo","collaborator":{"username":"opnsec","url":"/opnsec"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1045039,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Thanks ! Could we publicly disclose this?","markdown_message":"\u003cp\u003eThanks ! Could we publicly disclose this?\u003c/p\u003e\n","automated_response":false,"created_at":"2016-06-29T12:03:00.658Z","updated_at":"2016-06-29T12:03:00.658Z","first_to_agree":true,"actor":{"username":"opnsec","cleared":false,"url":"/opnsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/871/17ffe7f89623315912b4a69a6441247262583484_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vimeo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1094986,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-07-29T12:03:07.300Z","updated_at":"2016-07-29T12:03:07.300Z","actor":{"url":"/vimeo","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/056/c3188aa0fc4a95fd486b5ee1f4b2d0b90da111d3_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Vimeo"}},"genius_execution_id":null,"team_handle":"vimeo","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}