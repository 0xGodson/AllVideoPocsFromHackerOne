{"id":98559,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC85ODU1OQ==","url":"https://hackerone.com/reports/98559","title":"RCE in ci.owncloud.com / ci.owncloud.org","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2015-11-08T08:25:14.881Z","submitted_at":"2015-11-08T08:25:14.881Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"tomdev","url":"/tomdev","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/036/d216c51a25ae9f40651b5859490048ece35ef88f_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":3059,"url":"https://hackerone.com/owncloud","handle":"owncloud","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/003/059/d31dc64427bbbf2e428a0b0b97bce59b98d2ba0d_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/059/d31dc64427bbbf2e428a0b0b97bce59b98d2ba0d_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"ownCloud","twitter_handle":"ownCloud","website":"https://www.owncloud.com","about":"ownCloud GmbH is the company behind the ownCloud Project - the most downloaded open source project for data and file sync, share and view."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2015-11-09T17:37:12.240Z","bug_reporter_agreed_on_going_public_at":"2015-11-09T17:37:12.141Z","team_member_agreed_on_going_public_at":"2015-11-09T06:42:58.721Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi,\n\nI know you are more interested in vulnerabilities found in ownCloud Server, but I do would like to inform you on a RCE that can be executed on ci.owncloud.[com/org]. \n\n**Vulnerability**\nThere is a 0day vulnerability in Jenkins that can be exploited in certain circumstances. The Jenkins instance on ci.owncloud.[com/org] is vulnerabile for this attack since it is configured to run on a public IP address and is not firewalled.\n\nThe vulnerability exists in the common library used by Java to (de)serialize data. Jenkins will deserialize and execute configuration data sent to a specific port it is listening on. More information on the vulnerability can be found in this [article](http://foxglovesecurity.com/2015/11/06/what-do-weblogic-websphere-jboss-jenkins-opennms-and-your-application-have-in-common-this-vulnerability/).\n\nIt was easy to find the Jenkins instance because its name is easy guessable (only later on I found out its also being linked to from your GitHub page).\n\n**POC**\nI used a payload to confirm the RCE which tells me ci.jenkins.org is running `Debian 7`. You can use this information as confirmation on the RCE.\n\nI was also able to read the `/etc/passwd` file, but I'd rather not send the data it contains in this report.\n\n**Mitigation**\n- Shut down ci.owncloud.com for the time being\n- Run ci.owncloud.com on a VPN instead of on a world-accessible public IP address\n- Firewall the Jenkins instance\n\nRegards, @tomdev","vulnerability_information_html":"\u003cp\u003eHi,\u003c/p\u003e\n\n\u003cp\u003eI know you are more interested in vulnerabilities found in ownCloud Server, but I do would like to inform you on a RCE that can be executed on ci.owncloud.[com/org]. \u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eVulnerability\u003c/strong\u003e\u003cbr\u003e\nThere is a 0day vulnerability in Jenkins that can be exploited in certain circumstances. The Jenkins instance on ci.owncloud.[com/org] is vulnerabile for this attack since it is configured to run on a public IP address and is not firewalled.\u003c/p\u003e\n\n\u003cp\u003eThe vulnerability exists in the common library used by Java to (de)serialize data. Jenkins will deserialize and execute configuration data sent to a specific port it is listening on. More information on the vulnerability can be found in this \u003ca href=\"/redirect?url=http%3A%2F%2Ffoxglovesecurity.com%2F2015%2F11%2F06%2Fwhat-do-weblogic-websphere-jboss-jenkins-opennms-and-your-application-have-in-common-this-vulnerability%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003earticle\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e.\u003c/p\u003e\n\n\u003cp\u003eIt was easy to find the Jenkins instance because its name is easy guessable (only later on I found out its also being linked to from your GitHub page).\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003ePOC\u003c/strong\u003e\u003cbr\u003e\nI used a payload to confirm the RCE which tells me ci.jenkins.org is running \u003ccode\u003eDebian 7\u003c/code\u003e. You can use this information as confirmation on the RCE.\u003c/p\u003e\n\n\u003cp\u003eI was also able to read the \u003ccode\u003e/etc/passwd\u003c/code\u003e file, but I\u0026#39;d rather not send the data it contains in this report.\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eMitigation\u003c/strong\u003e\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eShut down ci.owncloud.com for the time being\u003c/li\u003e\n\u003cli\u003eRun ci.owncloud.com on a VPN instead of on a world-accessible public IP address\u003c/li\u003e\n\u003cli\u003eFirewall the Jenkins instance\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eRegards, \u003ca href=\"/tomdev\"\u003e@tomdev\u003c/a\u003e\u003c/p\u003e\n","weakness":{"id":70,"name":"Code Injection"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2015-12-09T06:42:58.803Z","allow_singular_disclosure_after":-159582913.26112735,"singular_disclosure_allowed":true,"vote_count":7,"voters":["mashoud1122","lordjerry0x01","an0nym0us","whitesector","japz","visi0n","sudo-phantom"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":649857,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks a lot for reporting this potential issue back to us. We take security very seriously and would appreciate if you would not share any information about this bug until we have determined a potential patch.\r\n \r\nOur security team will take a look at this issue as soon as possible. We will reply to your report within 72 hours, usually much faster.","markdown_message":"\u003cp\u003eThanks a lot for reporting this potential issue back to us. We take security very seriously and would appreciate if you would not share any information about this bug until we have determined a potential patch.\u003c/p\u003e\n\n\u003cp\u003eOur security team will take a look at this issue as soon as possible. We will reply to your report within 72 hours, usually much faster.\u003c/p\u003e\n","automated_response":true,"created_at":"2015-11-08T08:25:15.096Z","updated_at":"2015-11-08T08:25:15.096Z","actor":{"url":"/owncloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/059/d31dc64427bbbf2e428a0b0b97bce59b98d2ba0d_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"ownCloud"}},"genius_execution_id":null,"team_handle":"owncloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":649946,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thanks a lot @tomdev for your report. I have forwarded this information to our sysadmin team and linked also to the [mitigation advices from Jenkins CI](https://jenkins-ci.org/content/mitigating-unauthenticated-remote-code-execution-0-day-jenkins-cli).\n\nHowever, please note that \"ci.owncloud.org\" (ci.owncloud.com is just another CNAME for the same server) is not handling sensitive tasks such as packaging. The only use-case for this server is to execute our unit and integration tests cases. Any sensitive task is performed on a firewalled server within our internal network.\n\nConsidering that, a limited remote code execution on this system (or more correct: it's slaves) can technically already be achieved by a person sending a Pull Request to our ownCloud organization.  This is however something which we're trying to address long-term.\n\nNevertheless we consider this a valid issue and will get this addressed as soon as possible. Thanks again and nice catch!","markdown_message":"\u003cp\u003eThanks a lot \u003ca href=\"/tomdev\"\u003e@tomdev\u003c/a\u003e for your report. I have forwarded this information to our sysadmin team and linked also to the \u003ca href=\"/redirect?url=https%3A%2F%2Fjenkins-ci.org%2Fcontent%2Fmitigating-unauthenticated-remote-code-execution-0-day-jenkins-cli\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003emitigation advices from Jenkins CI\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e.\u003c/p\u003e\n\n\u003cp\u003eHowever, please note that \u0026quot;ci.owncloud.org\u0026quot; (ci.owncloud.com is just another CNAME for the same server) is not handling sensitive tasks such as packaging. The only use-case for this server is to execute our unit and integration tests cases. Any sensitive task is performed on a firewalled server within our internal network.\u003c/p\u003e\n\n\u003cp\u003eConsidering that, a limited remote code execution on this system (or more correct: it\u0026#39;s slaves) can technically already be achieved by a person sending a Pull Request to our ownCloud organization.  This is however something which we\u0026#39;re trying to address long-term.\u003c/p\u003e\n\n\u003cp\u003eNevertheless we consider this a valid issue and will get this addressed as soon as possible. Thanks again and nice catch!\u003c/p\u003e\n","automated_response":false,"created_at":"2015-11-08T10:36:01.979Z","updated_at":"2015-11-08T10:44:48.245Z","actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"owncloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":649979,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"We have applied the mitigation pointed out in https://github.com/jenkinsci-cert/SECURITY-218 to our ci.owncloud.org server. The endpoint in question should thus not accessible anymore.\n\n@tomdev Would you be so kind and could verify on your end as well? Thanks a lot!","markdown_message":"\u003cp\u003eWe have applied the mitigation pointed out in \u003ca title=\"https://github.com/jenkinsci-cert/SECURITY-218\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fjenkinsci-cert%2FSECURITY-218\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/jenkinsci-cert/SECURITY-218\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e to our ci.owncloud.org server. The endpoint in question should thus not accessible anymore.\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"/tomdev\"\u003e@tomdev\u003c/a\u003e Would you be so kind and could verify on your end as well? Thanks a lot!\u003c/p\u003e\n","automated_response":false,"created_at":"2015-11-08T11:33:16.237Z","updated_at":"2015-11-08T11:33:16.237Z","actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"tomdev","url":"/tomdev"},"genius_execution_id":null,"team_handle":"owncloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":649989,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"While we sincerely appreciate the report and are thankful for your high quality submission issues within our non-critical infrastructure is unfortunately currently not eligible for monetary rewards.\n\nHowever, if you're ever around an ownCloud conference just let us kindly know in advance :-)","markdown_message":"\u003cp\u003eWhile we sincerely appreciate the report and are thankful for your high quality submission issues within our non-critical infrastructure is unfortunately currently not eligible for monetary rewards.\u003c/p\u003e\n\n\u003cp\u003eHowever, if you\u0026#39;re ever around an ownCloud conference just let us kindly know in advance :-)\u003c/p\u003e\n","automated_response":false,"created_at":"2015-11-08T11:44:44.351Z","updated_at":"2015-11-08T11:44:44.351Z","actor":{"url":"/owncloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/059/d31dc64427bbbf2e428a0b0b97bce59b98d2ba0d_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"ownCloud"}},"genius_execution_id":null,"team_handle":"owncloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":650208,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @lukasreschke, thanks for the quick replies and mitigation. \n\nI tried to POC again and can confirm I'm not able to perform the RCE anymore.\n\nI hope this 0day didn't have too much of an impact on your weekend :) \n\nRegards, @tomdev ","markdown_message":"\u003cp\u003eHey \u003ca href=\"/lukasreschke\"\u003e@lukasreschke\u003c/a\u003e, thanks for the quick replies and mitigation. \u003c/p\u003e\n\n\u003cp\u003eI tried to POC again and can confirm I\u0026#39;m not able to perform the RCE anymore.\u003c/p\u003e\n\n\u003cp\u003eI hope this 0day didn\u0026#39;t have too much of an impact on your weekend :) \u003c/p\u003e\n\n\u003cp\u003eRegards, \u003ca href=\"/tomdev\"\u003e@tomdev\u003c/a\u003e \u003c/p\u003e\n","automated_response":false,"created_at":"2015-11-08T20:04:48.336Z","updated_at":"2015-11-08T20:04:48.336Z","actor":{"username":"tomdev","cleared":false,"url":"/tomdev","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/036/d216c51a25ae9f40651b5859490048ece35ef88f_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"owncloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":650490,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Awesome. Thanks.\n\nWe'd like to publicly disclose this to encourage further high quality submissions and also use this as an example of a well done report. Any objections?","markdown_message":"\u003cp\u003eAwesome. Thanks.\u003c/p\u003e\n\n\u003cp\u003eWe\u0026#39;d like to publicly disclose this to encourage further high quality submissions and also use this as an example of a well done report. Any objections?\u003c/p\u003e\n","automated_response":false,"created_at":"2015-11-09T06:42:58.747Z","updated_at":"2015-11-09T06:42:58.747Z","first_to_agree":true,"actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"owncloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":651310,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"I'd be happy to disclose!","markdown_message":"\u003cp\u003eI\u0026#39;d be happy to disclose!\u003c/p\u003e\n","automated_response":false,"created_at":"2015-11-09T17:37:12.166Z","updated_at":"2015-11-09T17:37:12.166Z","actor":{"username":"tomdev","cleared":false,"url":"/tomdev","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/036/d216c51a25ae9f40651b5859490048ece35ef88f_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"owncloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":651311,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-11-09T17:37:12.269Z","updated_at":"2015-11-09T17:37:12.269Z","actor":{"username":"tomdev","cleared":false,"url":"/tomdev","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/036/d216c51a25ae9f40651b5859490048ece35ef88f_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"owncloud","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}