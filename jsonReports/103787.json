{"id":103787,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMDM3ODc=","url":"https://hackerone.com/reports/103787","title":"CSRF possible when SOP Bypass/UXSS is available ","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2015-12-06T12:56:10.665Z","submitted_at":"2015-12-06T12:56:10.665Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"avlidienbrunn","url":"/avlidienbrunn","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/948/699d45bda29817e724a5a2399862812a14dba902_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13,"url":"https://hackerone.com/security","handle":"security","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"HackerOne","twitter_handle":"Hacker0x01","website":"https://hackerone.com","about":"Vulnerability disclosure should be safe, transparent, and rewarding."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2015-12-30T15:23:41.230Z","bug_reporter_agreed_on_going_public_at":"2015-12-30T15:23:40.751Z","team_member_agreed_on_going_public_at":"2015-12-25T19:09:45.368Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"**Description**\nIf an attacker could extract content from https://hackerone.com, they could perform CSRF attacks due to the fact that:\n1. Some pages prints the token in the HTML response (edit user form at https://hackerone.com/settings/profile/edit)\n2. Tokens aren't bound per action\n3. PATCH/DELETE can be sent via _method\n\nAttacker being allowed to read content but not execute JS could happen if:\n1. SOP Bypass in plugin (http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-3115)\n2. SOP Bypass in application design (https://miki.it/blog/2014/7/8/abusing-jsonp-with-rosetta-flash/)\n3. UXSS (https://blog.innerht.ml/ie-uxss/)\n\nCurrently, some mitigations are in place. _method isn't allowed in GET and the Origin header is checked. This isn't enough since FireFox and IE doesn't send Origin header when submitting forms.\n\n**Attack scenario**\nThe most recent (to my knowledge) SOP bypass was the re-implementation of the IE UXSS bug (https://blog.innerht.ml/ie-uxss/). This was working November 28th 2015. However, the bug required framing at least one resource, and HackerOne sends X-Frame-Options on all resources. Sadly, HackerOne uses CloudFlare so the URL https://hackerone.com/cdn-cgi/trace could be used (doesn't send X-Frame-Options).\n\nSo to sum up:\n1. Logged in user visits attackers page in IE (vulnerable to UXSS)\n2. UXSS runs script on framed \"https://hackerone.com/cdn-cgi/trace\" to extract CSRF token on https://hackerone.com/settings/profile/edit (via AJAX)\n3. User is attacked with the extracted CSRF token\n\n**Fix**\nThis could be mitigated by storing the token in JavaScript and adding the token to the form after the page is loaded.","vulnerability_information_html":"\u003cp\u003e\u003cstrong\u003eDescription\u003c/strong\u003e\u003cbr\u003e\nIf an attacker could extract content from \u003ca title=\"https://hackerone.com\" href=\"https://hackerone.com\"\u003ehttps://hackerone.com\u003c/a\u003e, they could perform CSRF attacks due to the fact that:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eSome pages prints the token in the HTML response (edit user form at \u003ca title=\"https://hackerone.com/settings/profile/edit\" href=\"https://hackerone.com/settings/profile/edit\"\u003ehttps://hackerone.com/settings/profile/edit\u003c/a\u003e)\u003c/li\u003e\n\u003cli\u003eTokens aren\u0026#39;t bound per action\u003c/li\u003e\n\u003cli\u003ePATCH/DELETE can be sent via _method\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eAttacker being allowed to read content but not execute JS could happen if:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eSOP Bypass in plugin (\u003ca title=\"http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-3115\" href=\"/redirect?url=http%3A%2F%2Fwww.cve.mitre.org%2Fcgi-bin%2Fcvename.cgi%3Fname%3DCVE-2015-3115\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://www.cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-3115\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e)\u003c/li\u003e\n\u003cli\u003eSOP Bypass in application design (\u003ca title=\"https://miki.it/blog/2014/7/8/abusing-jsonp-with-rosetta-flash/\" href=\"/redirect?url=https%3A%2F%2Fmiki.it%2Fblog%2F2014%2F7%2F8%2Fabusing-jsonp-with-rosetta-flash%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://miki.it/blog/2014/7/8/abusing-jsonp-with-rosetta-flash/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e)\u003c/li\u003e\n\u003cli\u003eUXSS (\u003ca title=\"https://blog.innerht.ml/ie-uxss/\" href=\"/redirect?url=https%3A%2F%2Fblog.innerht.ml%2Fie-uxss%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://blog.innerht.ml/ie-uxss/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e)\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eCurrently, some mitigations are in place. _method isn\u0026#39;t allowed in GET and the Origin header is checked. This isn\u0026#39;t enough since FireFox and IE doesn\u0026#39;t send Origin header when submitting forms.\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eAttack scenario\u003c/strong\u003e\u003cbr\u003e\nThe most recent (to my knowledge) SOP bypass was the re-implementation of the IE UXSS bug (\u003ca title=\"https://blog.innerht.ml/ie-uxss/\" href=\"/redirect?url=https%3A%2F%2Fblog.innerht.ml%2Fie-uxss%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://blog.innerht.ml/ie-uxss/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e). This was working November 28th 2015. However, the bug required framing at least one resource, and HackerOne sends X-Frame-Options on all resources. Sadly, HackerOne uses CloudFlare so the URL \u003ca title=\"https://hackerone.com/cdn-cgi/trace\" href=\"https://hackerone.com/cdn-cgi/trace\"\u003ehttps://hackerone.com/cdn-cgi/trace\u003c/a\u003e could be used (doesn\u0026#39;t send X-Frame-Options).\u003c/p\u003e\n\n\u003cp\u003eSo to sum up:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eLogged in user visits attackers page in IE (vulnerable to UXSS)\u003c/li\u003e\n\u003cli\u003eUXSS runs script on framed \u0026quot;\u003ca title=\"https://hackerone.com/cdn-cgi/trace\" href=\"https://hackerone.com/cdn-cgi/trace\"\u003ehttps://hackerone.com/cdn-cgi/trace\u003c/a\u003e\u0026quot; to extract CSRF token on \u003ca title=\"https://hackerone.com/settings/profile/edit\" href=\"https://hackerone.com/settings/profile/edit\"\u003ehttps://hackerone.com/settings/profile/edit\u003c/a\u003e (via AJAX)\u003c/li\u003e\n\u003cli\u003eUser is attacked with the extracted CSRF token\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003e\u003cstrong\u003eFix\u003c/strong\u003e\u003cbr\u003e\nThis could be mitigated by storing the token in JavaScript and adding the token to the form after the page is loaded.\u003c/p\u003e\n","bounty_amount":"2500.0","formatted_bounty":"$2,500","weakness":{"id":45,"name":"Cross-Site Request Forgery (CSRF)"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":64654,"file_name":"example.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/064/654/f1e83a7c511c8be1cdb155adc93b52736676ef97/example.png?response-content-disposition=attachment%3B%20filename%3D%22example.png%22%3B%20filename%2A%3DUTF-8%27%27example.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ4IZIDGEJ%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T041304Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHgvhPRXI%2B7x6zNGnfFbWtzZacTUlKPt3VwSApQji3YyAiEA2Y%2FuJ72LgjXuchHTkycORzGcHp9y6ZUl%2BeyKz%2FFfjlAqtAMIVBABGgwwMTM2MTkyNzQ4NDkiDHblJHa0bCSVtoiX8yqRA7Ct%2F1l8ihdf2xXnJNUaJGv7nq%2F1b1xXdqHLpOjb5bN22Ac%2BQjHl%2Bna1KjqQx0Qu8Fcs0WQUm6dGPZbHLiP%2FRkIHh6FlY41MtajX39mvBrMgWCmioQD4vc7NSsiqHLG4GmvgnIM0wWXfwwv%2Fmq%2BjRWJQacOyz7e9kYXzI%2BQkViUKmcuV48xoXGswHYXnPSqKC6IqSk0Rgc6j2xAmne60g5PNHQf%2BehWLSoXupow19n2vF%2BE4dhw1ZLX%2B9fBct02t5%2B41MEA5z30yhC52UxDX9%2BedHi3rXpTTyV%2FX%2BWfdeGSGSqmwrTAcipCpz01NR%2Fkk3srD5BLQB%2B6BdeDlwwcltfcgYdKO39yRPNyZePA9ihdN%2B4YHA7%2FY9ufCPbEevGDvtv3mVStbES31aUOxSmGNj%2B8fMMJqFBAtD4Qx54l8UFyMf%2BQ8PPbA0OLpU9rjip1L0zxevK6IGISP%2FPlDldWsNQvfi1Xn6QvRkmL1ANNGXqycx5MDUJExPyV801VOQ68%2FfbB87Cmdd8xIJWUNtmpsIgDtMO2wqv8FOusBRxy8OOzTGCKFydY5xn2aZtaPj3obazs55j%2BS5FoY%2BdkqAuB4pbyPDlTBBI%2Fe4ZIYYBH9t51VaQaRwrhKPTTntuBcC2b5uuKcGXYq9rnIAgbUHulNqSoxgZep0wAjzrLEFeECcDfqDCjG1QyXJkGQyq3UjLElJNKzeGgK4y5hW9emXis3wfoUPLixiL7W8M52b0Q9HQrT0RxnkkNSLj7aPyOAVCPImHNwjJ%2FI2KIbB5iD4e9PbxcHFvjKgkNUQh2pESECovpzx%2BAz7wsT%2FUMRieGT%2BFtMt1o90%2BewPxe95i025ZqzwWI1aVcXtA%3D%3D\u0026X-Amz-Signature=6ee2ed7304067295e3b9df960383ce902f2207c4421d3fad46be8c7298fbae75","file_size":136447,"type":"image/png"}],"allow_singular_disclosure_at":"2016-01-24T19:09:45.902Z","allow_singular_disclosure_after":-155552598.79199946,"singular_disclosure_allowed":true,"vote_count":10,"voters":["michiel","powerjacobb1","an0nym0us","ak1t4","osama-hamad","silv3rpoision","666reda","spetr0x","dyabla","safisec"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":711134,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hi @avlidienbrunn,\n\nThanks for your report, we will look into this.\n\nBest regards,\nJens","markdown_message":"\u003cp\u003eHi \u003ca href=\"/avlidienbrunn\"\u003e@avlidienbrunn\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThanks for your report, we will look into this.\u003c/p\u003e\n\n\u003cp\u003eBest regards,\u003cbr\u003e\nJens\u003c/p\u003e\n","automated_response":false,"created_at":"2015-12-07T10:12:03.676Z","updated_at":"2015-12-07T10:12:03.676Z","actor":{"username":"jens","cleared":false,"url":"/jens","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/053/9c23f98571002dd0db70919126ae92746a6af99a_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":712876,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I have reported this (missing X-Frame-Options on /cdn-cgi resources) to CloudFlare (as #104122).","markdown_message":"\u003cp\u003eI have reported this (missing X-Frame-Options on /cdn-cgi resources) to CloudFlare (as \u003ca href=\"/reports/104122\"\u003e#104122\u003c/a\u003e).\u003c/p\u003e\n","automated_response":false,"created_at":"2015-12-08T15:44:10.004Z","updated_at":"2015-12-08T15:44:10.004Z","actor":{"username":"avlidienbrunn","cleared":true,"url":"/avlidienbrunn","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/948/699d45bda29817e724a5a2399862812a14dba902_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":712877,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"A fix has been deployed. Can you verify it? Thanks!","markdown_message":"\u003cp\u003eA fix has been deployed. Can you verify it? Thanks!\u003c/p\u003e\n","automated_response":false,"created_at":"2015-12-08T15:44:12.033Z","updated_at":"2015-12-08T15:44:12.033Z","actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":712885,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Looks fixed!","markdown_message":"\u003cp\u003eLooks fixed!\u003c/p\u003e\n","automated_response":false,"created_at":"2015-12-08T15:54:02.694Z","updated_at":"2015-12-08T15:54:02.694Z","actor":{"username":"avlidienbrunn","cleared":true,"url":"/avlidienbrunn","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/948/699d45bda29817e724a5a2399862812a14dba902_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":712913,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks! We'll get back to you soon about the bounty.","markdown_message":"\u003cp\u003eThanks! We\u0026#39;ll get back to you soon about the bounty.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-12-08T16:35:37.894Z","updated_at":"2015-12-08T16:35:37.894Z","actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"reporter":{"username":"avlidienbrunn","url":"/avlidienbrunn"},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":712919,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Can I have a hoodie instead?","markdown_message":"\u003cp\u003eCan I have a hoodie instead?\u003c/p\u003e\n","automated_response":false,"created_at":"2015-12-08T16:37:54.171Z","updated_at":"2015-12-08T16:37:54.171Z","actor":{"username":"avlidienbrunn","cleared":true,"url":"/avlidienbrunn","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/948/699d45bda29817e724a5a2399862812a14dba902_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":712928,"is_internal":false,"editable":false,"type":"Activities::SwagAwarded","message":"Sure, we'll get you one!","markdown_message":"\u003cp\u003eSure, we\u0026#39;ll get you one!\u003c/p\u003e\n","automated_response":false,"created_at":"2015-12-08T16:40:34.954Z","updated_at":"2015-12-08T16:40:34.954Z","actor":{"url":"/security","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"HackerOne"}},"reporter":{"username":"avlidienbrunn","url":"/avlidienbrunn"},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":712932,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Awesome, thanks!","markdown_message":"\u003cp\u003eAwesome, thanks!\u003c/p\u003e\n","automated_response":false,"created_at":"2015-12-08T16:42:09.726Z","updated_at":"2015-12-08T16:42:09.726Z","actor":{"username":"avlidienbrunn","cleared":true,"url":"/avlidienbrunn","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/948/699d45bda29817e724a5a2399862812a14dba902_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":729020,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Besides the swag, we would like to award a bounty as well for this great find. Even though this is really a CloudFlare and/or IE issue, you could still use this technique to get a valid CSRF token, which could be used to add a malicious team member or external user in order to access reports. We welcome great reports like this one that we can use as defense-in-depth for protecting our platform for all our users (including those who use IE).\n\nWe continue to work with CloudFlare to get the /cdn-cgi/ issue resolved on their end, and we hope that IE will fix the UXSS issue as well.","markdown_message":"\u003cp\u003eBesides the swag, we would like to award a bounty as well for this great find. Even though this is really a CloudFlare and/or IE issue, you could still use this technique to get a valid CSRF token, which could be used to add a malicious team member or external user in order to access reports. We welcome great reports like this one that we can use as defense-in-depth for protecting our platform for all our users (including those who use IE).\u003c/p\u003e\n\n\u003cp\u003eWe continue to work with CloudFlare to get the /cdn-cgi/ issue resolved on their end, and we hope that IE will fix the UXSS issue as well.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-12-22T04:46:29.205Z","updated_at":"2015-12-22T04:46:29.205Z","actor":{"url":"/security","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"HackerOne"}},"bounty_amount":"2500.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"security","collaborator":{"username":"avlidienbrunn","url":"/avlidienbrunn"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":732360,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"CloudFlare has pushed a change that adds the `X-Frame-Options: SAMEORIGIN` header to all their `/cdn-cgi/` endpoints. Can you confirm that now prevents your IE UXSS issue from working?","markdown_message":"\u003cp\u003eCloudFlare has pushed a change that adds the \u003ccode\u003eX-Frame-Options: SAMEORIGIN\u003c/code\u003e header to all their \u003ccode\u003e/cdn-cgi/\u003c/code\u003e endpoints. Can you confirm that now prevents your IE UXSS issue from working?\u003c/p\u003e\n","automated_response":false,"created_at":"2015-12-25T08:54:23.692Z","updated_at":"2015-12-25T08:54:23.692Z","actor":{"username":"reed","cleared":false,"url":"/reed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":732396,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Yep, it's fixed (the UXSS too since a while back, but since it's been \"revived\" a few times who knows when it will work again :)). Thanks for the bounty!","markdown_message":"\u003cp\u003eYep, it\u0026#39;s fixed (the UXSS too since a while back, but since it\u0026#39;s been \u0026quot;revived\u0026quot; a few times who knows when it will work again :)). Thanks for the bounty!\u003c/p\u003e\n","automated_response":false,"created_at":"2015-12-25T11:06:13.513Z","updated_at":"2015-12-25T11:06:13.513Z","actor":{"username":"avlidienbrunn","cleared":true,"url":"/avlidienbrunn","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/948/699d45bda29817e724a5a2399862812a14dba902_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":732578,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-12-25T19:09:45.411Z","updated_at":"2015-12-25T19:09:45.411Z","first_to_agree":true,"actor":{"username":"reed","cleared":false,"url":"/reed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":734569,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@avlidienbrunn, can you agree to disclosure? :)","markdown_message":"\u003cp\u003e\u003ca href=\"/avlidienbrunn\"\u003e@avlidienbrunn\u003c/a\u003e, can you agree to disclosure? :)\u003c/p\u003e\n","automated_response":false,"created_at":"2015-12-28T21:19:32.777Z","updated_at":"2015-12-28T21:19:32.777Z","actor":{"username":"reed","cleared":false,"url":"/reed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":736331,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Done!","markdown_message":"\u003cp\u003eDone!\u003c/p\u003e\n","automated_response":false,"created_at":"2015-12-30T15:23:36.177Z","updated_at":"2015-12-30T15:23:36.177Z","actor":{"username":"avlidienbrunn","cleared":true,"url":"/avlidienbrunn","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/948/699d45bda29817e724a5a2399862812a14dba902_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":736332,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-12-30T15:23:40.787Z","updated_at":"2015-12-30T15:23:40.787Z","actor":{"username":"avlidienbrunn","cleared":true,"url":"/avlidienbrunn","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/948/699d45bda29817e724a5a2399862812a14dba902_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":736333,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-12-30T15:23:41.277Z","updated_at":"2015-12-30T15:23:41.277Z","actor":{"username":"avlidienbrunn","cleared":true,"url":"/avlidienbrunn","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/948/699d45bda29817e724a5a2399862812a14dba902_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":736805,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Also, https://github.com/rails/rails/pull/22275 would be a great help here by making CSRF tokens unique per form. I hope that the @rails team will review and accept the PR.","markdown_message":"\u003cp\u003eAlso, \u003ca title=\"https://github.com/rails/rails/pull/22275\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Frails%2Frails%2Fpull%2F22275\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/rails/rails/pull/22275\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e would be a great help here by making CSRF tokens unique per form. I hope that the @rails team will review and accept the PR.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-12-30T22:46:17.818Z","updated_at":"2015-12-30T22:46:17.818Z","actor":{"username":"reed","cleared":false,"url":"/reed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":766851,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@reed et.al. may I also suggest that you add the \"referrer\" directive to CSP? Without it, form-action directive can be bypassed in Firefox (if there's any forms containing tokens). Not sure how related that is to this report, but I don't think it's big enough to issue another report.","markdown_message":"\u003cp\u003e\u003ca href=\"/reed\"\u003e@reed\u003c/a\u003e et.al. may I also suggest that you add the \u0026quot;referrer\u0026quot; directive to CSP? Without it, form-action directive can be bypassed in Firefox (if there\u0026#39;s any forms containing tokens). Not sure how related that is to this report, but I don\u0026#39;t think it\u0026#39;s big enough to issue another report.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-01-21T15:57:23.644Z","updated_at":"2016-01-21T15:58:41.525Z","actor":{"username":"avlidienbrunn","cleared":true,"url":"/avlidienbrunn","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/948/699d45bda29817e724a5a2399862812a14dba902_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}