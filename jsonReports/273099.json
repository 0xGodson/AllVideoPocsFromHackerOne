{"id":273099,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yNzMwOTk=","url":"https://hackerone.com/reports/273099","title":"User with removed manage shops permissions is still able to make changes to a shop ","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2017-09-29T19:42:07.546Z","submitted_at":"2017-09-29T19:42:07.546Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"flashdisk","url":"/flashdisk","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/106/828/9bcaed498ba440dc30bf6847373261ab145aa7b8_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1382,"url":"https://hackerone.com/shopify","handle":"shopify","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Shopify","twitter_handle":"","website":"https://www.shopify.com","about":"Shopify is a multi-channel commerce platform that helps people sell online, in-store, and everywhere in between."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2020-06-12T14:11:14.562Z","bug_reporter_agreed_on_going_public_at":"2020-06-12T14:11:14.503Z","team_member_agreed_on_going_public_at":"2018-04-03T18:10:27.576Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"#Description \nit has been noticed that when a partner account user with `` manage shops `` permissions installs app in the one of the managed shops he can still be able to make changes to the shop through that app although his `` manage shops `` permissions were revoked on partners.shopify.com.\n\n#POC\n\n1. create partners account on partners.shopify.com and add staff member with `` manage shops `` permissions.\n\n2. create development store and login to the store with the created staff account with `` manage shops `` permissions.\n\n3. install order printer app and access that app and press on ``manage templates`` button and create template.\n\n4. after creating the template press on ``delete`` for the created template and intercept the request with burp, don;t send it.\n\n5. go to https://partners.shopify.com/664398/memberships and remove `` manage shops `` permissions for the staff account.\n\n6. send the request from step 4 and you will notice that the template was deleted although the user doesn't have `` manage shops `` permissions.\n\n#NOTE \nI also tested this **Bulk Discounts** app and it gave me permissions to create new discount code for each order although I was missing the `` manage shops `` permissions.\n\n#IMPACT\na partner staff member can make drastic changes to a store after revoking his permissions.\n\nthanks. ","vulnerability_information_html":"\u003ch1 id=\"description\"\u003eDescription\u003c/h1\u003e\n\n\u003cp\u003eit has been noticed that when a partner account user with \u003ccode\u003emanage shops\u003c/code\u003e permissions installs app in the one of the managed shops he can still be able to make changes to the shop through that app although his \u003ccode\u003emanage shops\u003c/code\u003e permissions were revoked on partners.shopify.com.\u003c/p\u003e\n\n\u003ch1 id=\"poc\"\u003ePOC\u003c/h1\u003e\n\n\u003col\u003e\n\u003cli\u003e\u003cp\u003ecreate partners account on partners.shopify.com and add staff member with \u003ccode\u003emanage shops\u003c/code\u003e permissions.\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003ecreate development store and login to the store with the created staff account with \u003ccode\u003emanage shops\u003c/code\u003e permissions.\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003einstall order printer app and access that app and press on \u003ccode\u003emanage templates\u003c/code\u003e button and create template.\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eafter creating the template press on \u003ccode\u003edelete\u003c/code\u003e for the created template and intercept the request with burp, don;t send it.\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003ego to \u003ca title=\"https://partners.shopify.com/664398/memberships\" href=\"/redirect?url=https%3A%2F%2Fpartners.shopify.com%2F664398%2Fmemberships\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://partners.shopify.com/664398/memberships\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e and remove \u003ccode\u003emanage shops\u003c/code\u003e permissions for the staff account.\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003esend the request from step 4 and you will notice that the template was deleted although the user doesn\u0026#39;t have \u003ccode\u003emanage shops\u003c/code\u003e permissions.\u003c/p\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003ch1 id=\"note\"\u003eNOTE\u003c/h1\u003e\n\n\u003cp\u003eI also tested this \u003cstrong\u003eBulk Discounts\u003c/strong\u003e app and it gave me permissions to create new discount code for each order although I was missing the \u003ccode\u003emanage shops\u003c/code\u003e permissions.\u003c/p\u003e\n\n\u003ch1 id=\"impact\"\u003eIMPACT\u003c/h1\u003e\n\n\u003cp\u003ea partner staff member can make drastic changes to a store after revoking his permissions.\u003c/p\u003e\n\n\u003cp\u003ethanks. \u003c/p\u003e\n","bounty_amount":"1000.0","formatted_bounty":"$1,000","weakness":{"id":26,"name":"Improper Access Control - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":136,"voters":["sultancad","sourc7","a_d_a_m","brahim_boufakri01","prophet","mygf","tungpun","mhamed_kchikech","eveeez","r3y","and 126 more..."],"severity":{"rating":"medium","author_type":"User"},"structured_scope":{"databaseId":422,"asset_type":"URL","asset_identifier":"partners.shopify.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":2033726,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you for reporting this bug! This is an automated response to let you know that we've received your issue, and we'll process it as soon as possible.\n\nOur team is busy triaging and fixing HackerOne reports, and it may take us up to 1 week (or more) to triage any given issue. Don't worry, we'll get to yours!\n\nWhile you are waiting, you can read over our list of non applicable issues listed on our program page: https://hackerone.com/shopify. Make sure your issue isn't listed!","markdown_message":"\u003cp\u003eThank you for reporting this bug! This is an automated response to let you know that we\u0026#39;ve received your issue, and we\u0026#39;ll process it as soon as possible.\u003c/p\u003e\n\n\u003cp\u003eOur team is busy triaging and fixing HackerOne reports, and it may take us up to 1 week (or more) to triage any given issue. Don\u0026#39;t worry, we\u0026#39;ll get to yours!\u003c/p\u003e\n\n\u003cp\u003eWhile you are waiting, you can read over our list of non applicable issues listed on our program page: \u003ca title=\"https://hackerone.com/shopify\" href=\"https://hackerone.com/shopify\"\u003ehttps://hackerone.com/shopify\u003c/a\u003e. Make sure your issue isn\u0026#39;t listed!\u003c/p\u003e\n","automated_response":true,"created_at":"2017-09-29T19:42:08.480Z","updated_at":"2017-09-29T19:42:08.480Z","actor":{"url":"/shopify","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Shopify"}},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2033831,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I have noticed also that after deleting the staff member in partners.shopify.com all app sessions that were  generated are still active and can do change to the store although the user has been deleted and doesn't have access to anything.","markdown_message":"\u003cp\u003eI have noticed also that after deleting the staff member in partners.shopify.com all app sessions that were  generated are still active and can do change to the store although the user has been deleted and doesn\u0026#39;t have access to anything.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-09-29T20:16:28.049Z","updated_at":"2017-09-29T20:16:28.049Z","actor":{"username":"flashdisk","cleared":false,"url":"/flashdisk","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/106/828/9bcaed498ba440dc30bf6847373261ab145aa7b8_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2035229,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@shopify  I still have valid sessions for all the apps i installed and they do still can make changes.","markdown_message":"\u003cp\u003e\u003ca href=\"/shopify\"\u003e@shopify\u003c/a\u003e  I still have valid sessions for all the apps i installed and they do still can make changes.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-09-30T07:20:05.160Z","updated_at":"2017-09-30T07:20:05.160Z","actor":{"username":"flashdisk","cleared":false,"url":"/flashdisk","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/106/828/9bcaed498ba440dc30bf6847373261ab145aa7b8_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2039157,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thank you for your report. Our engineering team is investigating. We will let you know when we have an update.","markdown_message":"\u003cp\u003eThank you for your report. Our engineering team is investigating. We will let you know when we have an update.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-10-02T20:50:30.297Z","updated_at":"2017-10-02T20:50:30.297Z","actor":{"username":"iv-rodriguez","cleared":false,"url":"/iv-rodriguez","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/122/715/28b56e3c5fa52c310c754558b341beb5ec0b2ab1_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2044324,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thank you again for your report! We have recently deployed a fix for this issue.\n\nOur next round of bounty decisions will take place next week, so we will be in touch with you again soon.","markdown_message":"\u003cp\u003eThank you again for your report! We have recently deployed a fix for this issue.\u003c/p\u003e\n\n\u003cp\u003eOur next round of bounty decisions will take place next week, so we will be in touch with you again soon.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-10-04T21:17:04.081Z","updated_at":"2017-10-04T21:17:04.081Z","actor":{"username":"iv-rodriguez","cleared":false,"url":"/iv-rodriguez","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/122/715/28b56e3c5fa52c310c754558b341beb5ec0b2ab1_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"flashdisk","url":"/flashdisk"},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2055713,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@iv-rodriguez  happy to help :)","markdown_message":"\u003cp\u003e\u003ca href=\"/iv-rodriguez\"\u003e@iv-rodriguez\u003c/a\u003e  happy to help :)\u003c/p\u003e\n","automated_response":false,"created_at":"2017-10-10T06:52:08.783Z","updated_at":"2017-10-10T06:52:08.783Z","actor":{"username":"flashdisk","cleared":false,"url":"/flashdisk","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/106/828/9bcaed498ba440dc30bf6847373261ab145aa7b8_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2064581,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thank you again for your report @flashdisk, we've now fixed the issue by ensuring partners are logged out of shops when their access is removed from an organization. As for the other part of your report, Shopify does not have the ability to log users out of apps, but this is an issue we were already aware of, so we've only considered the other part of the report for this bounty.","markdown_message":"\u003cp\u003eThank you again for your report \u003ca href=\"/flashdisk\"\u003e@flashdisk\u003c/a\u003e, we\u0026#39;ve now fixed the issue by ensuring partners are logged out of shops when their access is removed from an organization. As for the other part of your report, Shopify does not have the ability to log users out of apps, but this is an issue we were already aware of, so we\u0026#39;ve only considered the other part of the report for this bounty.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-10-13T17:54:50.525Z","updated_at":"2017-10-13T17:54:50.525Z","actor":{"url":"/shopify","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Shopify"}},"bounty_amount":"1000.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"shopify","collaborator":{"username":"flashdisk","url":"/flashdisk"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2064600,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@shopify  thanks a lot for the bounty :)","markdown_message":"\u003cp\u003e\u003ca href=\"/shopify\"\u003e@shopify\u003c/a\u003e  thanks a lot for the bounty :)\u003c/p\u003e\n","automated_response":false,"created_at":"2017-10-13T18:00:26.788Z","updated_at":"2017-10-13T18:00:26.788Z","actor":{"username":"flashdisk","cleared":false,"url":"/flashdisk","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/106/828/9bcaed498ba440dc30bf6847373261ab145aa7b8_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2560017,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-04-03T18:10:27.615Z","updated_at":"2018-04-03T18:10:27.615Z","first_to_agree":true,"actor":{"username":"shopify-peteryaworski","cleared":false,"url":"/shopify-peteryaworski","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/175/526/7ba4844078e290c91c4c46a345b4f9e7666f3ed4_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8273334,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-06-12T14:11:14.527Z","updated_at":"2020-06-12T14:11:14.527Z","actor":{"username":"flashdisk","cleared":false,"url":"/flashdisk","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/106/828/9bcaed498ba440dc30bf6847373261ab145aa7b8_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8273335,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-06-12T14:11:14.589Z","updated_at":"2020-06-12T14:11:14.589Z","actor":{"username":"flashdisk","cleared":false,"url":"/flashdisk","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/106/828/9bcaed498ba440dc30bf6847373261ab145aa7b8_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":5557,"category":"team","content":"@flashdisk reported that revoking access from a staff member in the partner dashboard did not log them out of the admin areas of shops they had logged into.\n\nHe also reported that, as a further implication, the partner would still have access to embedded apps they might have logged into. This is expected and something we were already aware of, as Shopify has no way to let apps know of a user logging out at this time. Sessions managed by apps are separate from admin sessions by design.","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003e\u003ca href=\"/flashdisk\"\u003e@flashdisk\u003c/a\u003e reported that revoking access from a staff member in the partner dashboard did not log them out of the admin areas of shops they had logged into.\u003c/p\u003e\n\n\u003cp\u003eHe also reported that, as a further implication, the partner would still have access to embedded apps they might have logged into. This is expected and something we were already aware of, as Shopify has no way to let apps know of a user logging out at this time. Sessions managed by apps are separate from admin sessions by design.\u003c/p\u003e\n"},{"category":"researcher","can_view?":true,"can_create?":false}]}