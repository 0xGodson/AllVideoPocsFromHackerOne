{"id":499,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC80OTk=","url":"https://hackerone.com/reports/499","title":"Ruby: Heap Overflow in Floating Point Parsing","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2013-11-22T00:00:00.000Z","submitted_at":"2013-11-22T00:00:00.000Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"charliesome","url":"/charliesome","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/738/78470971e95623d272226b011823c8590ffe6cf3_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":7724,"url":"https://hackerone.com/ruby","handle":"ruby","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/007/724/bb067434deef370d6a0b16c2cbbc030b57c75e92_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/007/724/bb067434deef370d6a0b16c2cbbc030b57c75e92_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Ruby","twitter_handle":"","website":"https://www.ruby-lang.org","about":"A Programmer's Best Friend"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":["CVE-2013-4164"],"singular_disclosure_disabled":false,"disclosed_at":"2013-11-22T00:00:00.000Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2013-11-22T00:00:00.000Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Any time a string is converted to a floating point value, a specially crafted string can cause a heap overflow. This can lead to a denial of service attack via segmentation faults and possibly arbitrary code execution. Any program that converts input of unknown origin to floating point values (especially common when accepting JSON) are vulnerable.\n\nVulnerable code looks something like this:\n\n`untrusted_data.to_f`\n\nBut any code that produces floating point values from external data is vulnerable, such as this:\n\n`JSON.parse untrusted_data`\n\nNote that this bug is similar to CVE-2009-0689.\n\nAll users running an affected release should upgrade to the FIXED versions of Ruby.\n\n#Affected versions\n- All Ruby 1.8 versions\n- All Ruby 1.9 versions prior to Ruby 1.9.3 patchlevel 484\n- All Ruby 2.0 versions prior to Ruby 2.0.0 patchlevel 353\n- All Ruby 2.1 versions prior to Ruby 2.1.0 preview2\n- prior to trunk revision 43780\n\n#Solutions\nAll users are recommended to upgrade to Ruby 1.9.3 patchlevel 484, Ruby 2.0.0 patchlevel 353 or Ruby 2.1.0 preview2.\n\nPlease note that Ruby 1.8 series or any earlier releases are already obsoleted. There is no plan to release new FIXED versions for them. Users of such versions are advised to upgrade as soon as possible as we cannot guarantee the continued availability of security fixes for unsupported releases.\n","vulnerability_information_html":"\u003cp\u003eAny time a string is converted to a floating point value, a specially crafted string can cause a heap overflow. This can lead to a denial of service attack via segmentation faults and possibly arbitrary code execution. Any program that converts input of unknown origin to floating point values (especially common when accepting JSON) are vulnerable.\u003c/p\u003e\n\n\u003cp\u003eVulnerable code looks something like this:\u003c/p\u003e\n\n\u003cp\u003e\u003ccode\u003euntrusted_data.to_f\u003c/code\u003e\u003c/p\u003e\n\n\u003cp\u003eBut any code that produces floating point values from external data is vulnerable, such as this:\u003c/p\u003e\n\n\u003cp\u003e\u003ccode\u003eJSON.parse untrusted_data\u003c/code\u003e\u003c/p\u003e\n\n\u003cp\u003eNote that this bug is similar to CVE-2009-0689.\u003c/p\u003e\n\n\u003cp\u003eAll users running an affected release should upgrade to the FIXED versions of Ruby.\u003c/p\u003e\n\n\u003ch1 id=\"affected-versions\"\u003eAffected versions\u003c/h1\u003e\n\n\u003cul\u003e\n\u003cli\u003eAll Ruby 1.8 versions\u003c/li\u003e\n\u003cli\u003eAll Ruby 1.9 versions prior to Ruby 1.9.3 patchlevel 484\u003c/li\u003e\n\u003cli\u003eAll Ruby 2.0 versions prior to Ruby 2.0.0 patchlevel 353\u003c/li\u003e\n\u003cli\u003eAll Ruby 2.1 versions prior to Ruby 2.1.0 preview2\u003c/li\u003e\n\u003cli\u003eprior to trunk revision 43780\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch1 id=\"solutions\"\u003eSolutions\u003c/h1\u003e\n\n\u003cp\u003eAll users are recommended to upgrade to Ruby 1.9.3 patchlevel 484, Ruby 2.0.0 patchlevel 353 or Ruby 2.1.0 preview2.\u003c/p\u003e\n\n\u003cp\u003ePlease note that Ruby 1.8 series or any earlier releases are already obsoleted. There is no plan to release new FIXED versions for them. Users of such versions are advised to upgrade as soon as possible as we cannot guarantee the continued availability of security fixes for unsupported releases.\u003c/p\u003e\n","bounty_amount":"1500.0","formatted_bounty":"$1,500","original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2013-11-22T00:00:00.000Z","allow_singular_disclosure_after":-224143753.25944263,"singular_disclosure_allowed":true,"vote_count":11,"voters":["sw33tlie","syssec_kaist","eveeez","an0nym0us","japz","cryptographer","elakrimi","tranbaobien","thada46","horlardemejiopeyemisodeeq33322","and 1 more..."],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":3039,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":null,"markdown_message":"","automated_response":false,"created_at":"2013-11-22T00:00:00.000Z","updated_at":"2013-11-22T00:00:00.000Z","actor":{"url":"/ruby","ibb":true,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/007/724/bb067434deef370d6a0b16c2cbbc030b57c75e92_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Ruby"}},"reporter":{"username":"charliesome","url":"/charliesome"},"genius_execution_id":null,"team_handle":"ruby","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3040,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":null,"markdown_message":"","automated_response":false,"created_at":"2013-12-04T08:00:03.464Z","updated_at":"2013-12-04T08:00:03.464Z","actor":{"url":"/ruby","ibb":true,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/007/724/bb067434deef370d6a0b16c2cbbc030b57c75e92_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Ruby"}},"bounty_amount":"1500.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"ruby","collaborator":{"username":"charliesome","url":"/charliesome"},"actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}