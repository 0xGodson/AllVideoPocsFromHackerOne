{"id":375329,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zNzUzMjk=","url":"https://hackerone.com/reports/375329","title":"Local files reading using `link[rel=\"import\"]`","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2018-07-02T12:25:56.922Z","submitted_at":"2018-07-02T12:25:56.922Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"metnew","url":"/metnew","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":15688,"url":"https://hackerone.com/brave","handle":"brave","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/015/688/2aad5641af643ee4f4402896e4747293f6e9c5ca_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/688/2aad5641af643ee4f4402896e4747293f6e9c5ca_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Brave Software","twitter_handle":"brave","website":"https://brave.com","about":""}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2018-09-29T00:16:24.191Z","bug_reporter_agreed_on_going_public_at":"2018-09-21T20:12:07.628Z","team_member_agreed_on_going_public_at":"2018-09-29T00:16:24.130Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"## Summary:\n\nHTML file could import another file using `\u003clink rel=\"import\"\u003e`.  Brave returns `Access-Control-Allow-Origin: *` response header for local HTML files. That leads to local files reading.\n\n\u003e This vulnerability makes #369218 critical.\n\n## Products affected: \n\nBrave: 0.23.19 \nV8: 6.7.288.46 \nrev: 178c3fbc045a0cbdbe098db08307503cce952081 \nMuon: 7.1.3 \nOS Release: 17.6.0 \nUpdate Channel: Release \nOS Architecture: x64 \nOS Platform: macOS \nNode.js: 7.9.0 \nBrave Sync: v1.4.2 \nlibchromiumcontent: 67.0.3396.87\n\n## Steps To Reproduce:\n\nPoC:\n``` html\n\u003chead\u003e\n    \u003cscript\u003e\n        function show() {\n            var file = link.import.querySelector('body')\n            alert(file.innerHTML)\n        }\n    \u003c/script\u003e\n    \u003clink id=\"link\" href=\"file:///etc/passwd\" rel=\"import\" as=\"document\" onload=\"show()\" /\u003e\n\u003c/head\u003e\n```\n\n## Supporting Material/References:\n\nScreencast + PoC attached.\n\n## Impact\n\nLocal files reading is forbidden in any browser.\nAlso, note that this vulnerability makes  #369218 critical.\n\n\u003e Probably all platforms(macOS/Win/Linux) are affected.","vulnerability_information_html":"\u003ch2 id=\"summary\"\u003eSummary:\u003c/h2\u003e\n\n\u003cp\u003eHTML file could import another file using \u003ccode\u003e\u0026lt;link rel=\u0026quot;import\u0026quot;\u0026gt;\u003c/code\u003e.  Brave returns \u003ccode\u003eAccess-Control-Allow-Origin: *\u003c/code\u003e response header for local HTML files. That leads to local files reading.\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eThis vulnerability makes \u003ca href=\"/reports/369218\"\u003e#369218\u003c/a\u003e critical.\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003ch2 id=\"products-affected\"\u003eProducts affected:\u003c/h2\u003e\n\n\u003cp\u003eBrave: 0.23.19 \u003cbr\u003e\nV8: 6.7.288.46 \u003cbr\u003e\nrev: 178c3fbc045a0cbdbe098db08307503cce952081 \u003cbr\u003e\nMuon: 7.1.3 \u003cbr\u003e\nOS Release: 17.6.0 \u003cbr\u003e\nUpdate Channel: Release \u003cbr\u003e\nOS Architecture: x64 \u003cbr\u003e\nOS Platform: macOS \u003cbr\u003e\nNode.js: 7.9.0 \u003cbr\u003e\nBrave Sync: v1.4.2 \u003cbr\u003e\nlibchromiumcontent: 67.0.3396.87\u003c/p\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps To Reproduce:\u003c/h2\u003e\n\n\u003cp\u003ePoC:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight html\"\u003e\u003ccode\u003e\u003cspan class=\"nt\"\u003e\u0026lt;head\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"nt\"\u003e\u0026lt;script\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"kd\"\u003efunction\u003c/span\u003e \u003cspan class=\"nx\"\u003eshow\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003efile\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003elink\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"k\"\u003eimport\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003equerySelector\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003ebody\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"nx\"\u003ealert\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003efile\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003einnerHTML\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"nt\"\u003e\u0026lt;/script\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"nt\"\u003e\u0026lt;link\u003c/span\u003e \u003cspan class=\"na\"\u003eid=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;link\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003ehref=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;file:///etc/passwd\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003erel=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;import\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003eas=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;document\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003eonload=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;show()\u0026quot;\u003c/span\u003e \u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/head\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2 id=\"supporting-material-references\"\u003eSupporting Material/References:\u003c/h2\u003e\n\n\u003cp\u003eScreencast + PoC attached.\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eLocal files reading is forbidden in any browser.\u003cbr\u003e\nAlso, note that this vulnerability makes  \u003ca href=\"/reports/369218\"\u003e#369218\u003c/a\u003e critical.\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eProbably all platforms(macOS/Win/Linux) are affected.\u003c/p\u003e\n\u003c/blockquote\u003e\n","bounty_amount":"400.0","formatted_bounty":"$400","original_report_id":null,"original_report_url":null,"attachments":[{"id":314554,"file_name":"brave-read-local-files.mp4","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/314/554/03cb98cfd91fd4d5264ec29231f3aa72695dfacd/brave-read-local-files.mp4?response-content-disposition=attachment%3B%20filename%3D%22brave-read-local-files.mp4%22%3B%20filename%2A%3DUTF-8%27%27brave-read-local-files.mp4\u0026response-content-type=video%2Fmp4\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ2UMPB2FX%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T054553Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJr%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIEq9neBunEjsdY7f8cNZfYtjkYnfx7sYXIBk82UycrktAiEA5w10R4CJv%2FQIiYTXv1ZP8q%2BbScvvzy7qwcG%2BmPmKCXMqtAMIUxABGgwwMTM2MTkyNzQ4NDkiDKX6CTSGAGf6Bt5yHyqRA9qW1WRQYe7JztYb6rdSeSRyzKgf4LxEu42JMoyPyy0VqqdaIdaW%2F5Oe%2FZcBqKJkPjfrnsLv1E3Cttn6QZ2fsMawdDGLyKyEEvAx6LbD4TYD1QOy0YJIw6j32Nt3V4psvzyU384FsJYLymiqMGAqTzIuUS4QNvTcHn%2BFoOZvS%2F06fP5YWj%2BxpW%2BELDyBb5CFIWqKXYmkW%2BPv4IxFiMVfFF4KM80ZKVGfyJ7nRaRwvjM5YUJYHOlvXjFuPBSC3IYIgEZYlopEqTolZ1OQ2zbi1yDB%2FWl1rx7i7cbCVK6zJwPdLcPRBOa7jlMN0jlHdNPzjyKxdEaNBy7Cyflyw%2FZCl7X1dB7yuSBF8YK2st4h%2FZchseLh%2BjukipjtpVl5nDjO8BSu5evt1V1lFzADomlTKShrSgjmej1gvXmULpbdNuEwc3vMl328MfuwtHHSSvzZo5xxP0U1cq9fhM0Ztcea1ZRpQDZR4DB1jRqdjeMIXNuuwv3G7Uotj1VrvA87zW9Og6gQ9VN7fQSdOpurQFAV2WvRMIuSqv8FOusB%2B%2BEh7xquKUpKrZEfrLl0yLcAZyezk5OlnVLaoE%2BCU7%2F1YWDwq4fJ%2Fzqx58r%2Ffgzx%2FRuGFLAoCPIl7GI47ntqpCuRo5kjknXh3Vhm0Ds%2B9y0Uo9mgVKhl6XjEqADeRJOm5JpIvTZkPibWah%2FFXooiOsIWnpbe3xZbkrh62wdx0iVuonbBNy6Z0vYXXREkzeNyKh%2Fx0i0DwAehfYiLehqkIm1GqvDnaSiQ0dTRzOsrEnXwNhRtDRaBDDLvFXHGy3Xm8ucb70jki0U1otEIUfIG%2Fnfsrs7zhSOcLfi6%2B4aytuy%2FrSFLmVnwIpfIzQ%3D%3D\u0026X-Amz-Signature=bb4b84edac3c760f5b529a4524867e0c4e4d2ea9c1bfe2a06cdd186f097ed409","file_size":311071,"type":"video/mp4"},{"id":314555,"file_name":"exploit.html","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/314/555/2324d6d2248486741d263f7c4dcd7ecf3fcf58e3/exploit.html?response-content-disposition=attachment%3B%20filename%3D%22exploit.html%22%3B%20filename%2A%3DUTF-8%27%27exploit.html\u0026response-content-type=application%2Foctet-stream\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ2UMPB2FX%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T054553Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJr%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIEq9neBunEjsdY7f8cNZfYtjkYnfx7sYXIBk82UycrktAiEA5w10R4CJv%2FQIiYTXv1ZP8q%2BbScvvzy7qwcG%2BmPmKCXMqtAMIUxABGgwwMTM2MTkyNzQ4NDkiDKX6CTSGAGf6Bt5yHyqRA9qW1WRQYe7JztYb6rdSeSRyzKgf4LxEu42JMoyPyy0VqqdaIdaW%2F5Oe%2FZcBqKJkPjfrnsLv1E3Cttn6QZ2fsMawdDGLyKyEEvAx6LbD4TYD1QOy0YJIw6j32Nt3V4psvzyU384FsJYLymiqMGAqTzIuUS4QNvTcHn%2BFoOZvS%2F06fP5YWj%2BxpW%2BELDyBb5CFIWqKXYmkW%2BPv4IxFiMVfFF4KM80ZKVGfyJ7nRaRwvjM5YUJYHOlvXjFuPBSC3IYIgEZYlopEqTolZ1OQ2zbi1yDB%2FWl1rx7i7cbCVK6zJwPdLcPRBOa7jlMN0jlHdNPzjyKxdEaNBy7Cyflyw%2FZCl7X1dB7yuSBF8YK2st4h%2FZchseLh%2BjukipjtpVl5nDjO8BSu5evt1V1lFzADomlTKShrSgjmej1gvXmULpbdNuEwc3vMl328MfuwtHHSSvzZo5xxP0U1cq9fhM0Ztcea1ZRpQDZR4DB1jRqdjeMIXNuuwv3G7Uotj1VrvA87zW9Og6gQ9VN7fQSdOpurQFAV2WvRMIuSqv8FOusB%2B%2BEh7xquKUpKrZEfrLl0yLcAZyezk5OlnVLaoE%2BCU7%2F1YWDwq4fJ%2Fzqx58r%2Ffgzx%2FRuGFLAoCPIl7GI47ntqpCuRo5kjknXh3Vhm0Ds%2B9y0Uo9mgVKhl6XjEqADeRJOm5JpIvTZkPibWah%2FFXooiOsIWnpbe3xZbkrh62wdx0iVuonbBNy6Z0vYXXREkzeNyKh%2Fx0i0DwAehfYiLehqkIm1GqvDnaSiQ0dTRzOsrEnXwNhRtDRaBDDLvFXHGy3Xm8ucb70jki0U1otEIUfIG%2Fnfsrs7zhSOcLfi6%2B4aytuy%2FrSFLmVnwIpfIzQ%3D%3D\u0026X-Amz-Signature=99d8ea63123bdac33ca9a029d14ff293cbe0b80fad79049e245c994cd2c107f8","file_size":260,"type":"text/html"}],"allow_singular_disclosure_at":null,"vote_count":42,"voters":["muon4","sameerphad72","otuken","metnew","ahiezer","mygf","eveeez","kieran","apapedulimu","an0nym0us","and 32 more..."],"severity":{"rating":"high","author_type":"Team"},"structured_scope":{"databaseId":7933,"asset_type":"SOURCE_CODE","asset_identifier":"https://github.com/brave/browser-laptop","max_severity":"none"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":2974825,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Attaching two additional screencasts:\n\n1. #369218 + #369185 + #375329: get OS username using ssh://, download a file, open the file using \"Open in new tab\"\n2. #375259 + #375329  - (more realistic case): download the exploit like it's from a trusted resource + open (user gesture)\n","markdown_message":"\u003cp\u003eAttaching two additional screencasts:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003e#369218 + \u003ca href=\"/reports/369185\"\u003e#369185\u003c/a\u003e + \u003ca href=\"/reports/375329\"\u003e#375329\u003c/a\u003e: get OS username using ssh://, download a file, open the file using \u0026quot;Open in new tab\u0026quot;\u003c/li\u003e\n\u003cli\u003e#375259 + \u003ca href=\"/reports/375329\"\u003e#375329\u003c/a\u003e  - (more realistic case): download the exploit like it\u0026#39;s from a trusted resource + open (user gesture)\u003c/li\u003e\n\u003c/ol\u003e\n","automated_response":false,"created_at":"2018-07-02T14:52:04.158Z","updated_at":"2018-07-02T14:52:04.158Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":314607,"filename":"brave-read-files-twitter-download.mp4","type":"video/mp4","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/314/607/fb10acd46437d85f26cfc2239e7b54facbcf5087/brave-read-files-twitter-download.mp4?response-content-disposition=attachment%3B%20filename%3D%22brave-read-files-twitter-download.mp4%22%3B%20filename%2A%3DUTF-8%27%27brave-read-files-twitter-download.mp4\u0026response-content-type=video%2Fmp4\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ2UMPB2FX%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T054553Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJr%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIEq9neBunEjsdY7f8cNZfYtjkYnfx7sYXIBk82UycrktAiEA5w10R4CJv%2FQIiYTXv1ZP8q%2BbScvvzy7qwcG%2BmPmKCXMqtAMIUxABGgwwMTM2MTkyNzQ4NDkiDKX6CTSGAGf6Bt5yHyqRA9qW1WRQYe7JztYb6rdSeSRyzKgf4LxEu42JMoyPyy0VqqdaIdaW%2F5Oe%2FZcBqKJkPjfrnsLv1E3Cttn6QZ2fsMawdDGLyKyEEvAx6LbD4TYD1QOy0YJIw6j32Nt3V4psvzyU384FsJYLymiqMGAqTzIuUS4QNvTcHn%2BFoOZvS%2F06fP5YWj%2BxpW%2BELDyBb5CFIWqKXYmkW%2BPv4IxFiMVfFF4KM80ZKVGfyJ7nRaRwvjM5YUJYHOlvXjFuPBSC3IYIgEZYlopEqTolZ1OQ2zbi1yDB%2FWl1rx7i7cbCVK6zJwPdLcPRBOa7jlMN0jlHdNPzjyKxdEaNBy7Cyflyw%2FZCl7X1dB7yuSBF8YK2st4h%2FZchseLh%2BjukipjtpVl5nDjO8BSu5evt1V1lFzADomlTKShrSgjmej1gvXmULpbdNuEwc3vMl328MfuwtHHSSvzZo5xxP0U1cq9fhM0Ztcea1ZRpQDZR4DB1jRqdjeMIXNuuwv3G7Uotj1VrvA87zW9Og6gQ9VN7fQSdOpurQFAV2WvRMIuSqv8FOusB%2B%2BEh7xquKUpKrZEfrLl0yLcAZyezk5OlnVLaoE%2BCU7%2F1YWDwq4fJ%2Fzqx58r%2Ffgzx%2FRuGFLAoCPIl7GI47ntqpCuRo5kjknXh3Vhm0Ds%2B9y0Uo9mgVKhl6XjEqADeRJOm5JpIvTZkPibWah%2FFXooiOsIWnpbe3xZbkrh62wdx0iVuonbBNy6Z0vYXXREkzeNyKh%2Fx0i0DwAehfYiLehqkIm1GqvDnaSiQ0dTRzOsrEnXwNhRtDRaBDDLvFXHGy3Xm8ucb70jki0U1otEIUfIG%2Fnfsrs7zhSOcLfi6%2B4aytuy%2FrSFLmVnwIpfIzQ%3D%3D\u0026X-Amz-Signature=3a21997eb96ff33a43ae8afdad414f458b5c846c08a9054a315b6267c0151e43"},{"id":314606,"filename":"brave-chain-contextmenu-ssh-user.mp4","type":"video/mp4","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/314/606/6bc3c6c3b3fc5f33ff795f5aa79bce63d9e5f424/brave-chain-contextmenu-ssh-user.mp4?response-content-disposition=attachment%3B%20filename%3D%22brave-chain-contextmenu-ssh-user.mp4%22%3B%20filename%2A%3DUTF-8%27%27brave-chain-contextmenu-ssh-user.mp4\u0026response-content-type=video%2Fmp4\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ2UMPB2FX%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T054553Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJr%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIEq9neBunEjsdY7f8cNZfYtjkYnfx7sYXIBk82UycrktAiEA5w10R4CJv%2FQIiYTXv1ZP8q%2BbScvvzy7qwcG%2BmPmKCXMqtAMIUxABGgwwMTM2MTkyNzQ4NDkiDKX6CTSGAGf6Bt5yHyqRA9qW1WRQYe7JztYb6rdSeSRyzKgf4LxEu42JMoyPyy0VqqdaIdaW%2F5Oe%2FZcBqKJkPjfrnsLv1E3Cttn6QZ2fsMawdDGLyKyEEvAx6LbD4TYD1QOy0YJIw6j32Nt3V4psvzyU384FsJYLymiqMGAqTzIuUS4QNvTcHn%2BFoOZvS%2F06fP5YWj%2BxpW%2BELDyBb5CFIWqKXYmkW%2BPv4IxFiMVfFF4KM80ZKVGfyJ7nRaRwvjM5YUJYHOlvXjFuPBSC3IYIgEZYlopEqTolZ1OQ2zbi1yDB%2FWl1rx7i7cbCVK6zJwPdLcPRBOa7jlMN0jlHdNPzjyKxdEaNBy7Cyflyw%2FZCl7X1dB7yuSBF8YK2st4h%2FZchseLh%2BjukipjtpVl5nDjO8BSu5evt1V1lFzADomlTKShrSgjmej1gvXmULpbdNuEwc3vMl328MfuwtHHSSvzZo5xxP0U1cq9fhM0Ztcea1ZRpQDZR4DB1jRqdjeMIXNuuwv3G7Uotj1VrvA87zW9Og6gQ9VN7fQSdOpurQFAV2WvRMIuSqv8FOusB%2B%2BEh7xquKUpKrZEfrLl0yLcAZyezk5OlnVLaoE%2BCU7%2F1YWDwq4fJ%2Fzqx58r%2Ffgzx%2FRuGFLAoCPIl7GI47ntqpCuRo5kjknXh3Vhm0Ds%2B9y0Uo9mgVKhl6XjEqADeRJOm5JpIvTZkPibWah%2FFXooiOsIWnpbe3xZbkrh62wdx0iVuonbBNy6Z0vYXXREkzeNyKh%2Fx0i0DwAehfYiLehqkIm1GqvDnaSiQ0dTRzOsrEnXwNhRtDRaBDDLvFXHGy3Xm8ucb70jki0U1otEIUfIG%2Fnfsrs7zhSOcLfi6%2B4aytuy%2FrSFLmVnwIpfIzQ%3D%3D\u0026X-Amz-Signature=e1f6625cda7fcc805af66a74bf2e7e45c851359268427232f5f6f66d95f2d5c0"}],"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2974891,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"It worth to note that it's possible to read binary files, this is much more dangerous than reading only html, because an attacker could obtain directory structure, media, cookie/settings data from Brave.app, etc.","markdown_message":"\u003cp\u003eIt worth to note that it\u0026#39;s possible to read binary files, this is much more dangerous than reading only html, because an attacker could obtain directory structure, media, cookie/settings data from Brave.app, etc.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-07-02T15:15:18.083Z","updated_at":"2018-07-02T15:15:18.083Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2974892,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"It worth to note that it's possible to read binary files, this is much more dangerous than reading only html, because an attacker could obtain directory structure, media, cookie/settings data from Brave.app, etc.","markdown_message":"\u003cp\u003eIt worth to note that it\u0026#39;s possible to read binary files, this is much more dangerous than reading only html, because an attacker could obtain directory structure, media, cookie/settings data from Brave.app, etc.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-07-02T15:15:21.955Z","updated_at":"2018-07-02T15:15:21.955Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2974901,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Proof that it's possible to read binary files:\n`application/octet-stream` -\u003e could read\n\n\u003e Also, it's not required for an attacker to know username to find Brave.app, because it's possible to read `.DS_Store` files.","markdown_message":"\u003cp\u003eProof that it\u0026#39;s possible to read binary files:\u003cbr\u003e\n\u003ccode\u003eapplication/octet-stream\u003c/code\u003e -\u0026gt; could read\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eAlso, it\u0026#39;s not required for an attacker to know username to find Brave.app, because it\u0026#39;s possible to read \u003ccode\u003e.DS_Store\u003c/code\u003e files.\u003c/p\u003e\n\u003c/blockquote\u003e\n","automated_response":false,"created_at":"2018-07-02T15:20:43.164Z","updated_at":"2018-07-02T15:21:57.471Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":314618,"filename":"______________2018-07-02___18.18.02.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/314/618/011126d1e2b43f84c778974a0e9cf3b3ac466c3f/______________2018-07-02___18.18.02.png?response-content-disposition=attachment%3B%20filename%3D%22______________2018-07-02___18.18.02.png%22%3B%20filename%2A%3DUTF-8%27%27______________2018-07-02___18.18.02.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ2UMPB2FX%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T054553Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJr%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIEq9neBunEjsdY7f8cNZfYtjkYnfx7sYXIBk82UycrktAiEA5w10R4CJv%2FQIiYTXv1ZP8q%2BbScvvzy7qwcG%2BmPmKCXMqtAMIUxABGgwwMTM2MTkyNzQ4NDkiDKX6CTSGAGf6Bt5yHyqRA9qW1WRQYe7JztYb6rdSeSRyzKgf4LxEu42JMoyPyy0VqqdaIdaW%2F5Oe%2FZcBqKJkPjfrnsLv1E3Cttn6QZ2fsMawdDGLyKyEEvAx6LbD4TYD1QOy0YJIw6j32Nt3V4psvzyU384FsJYLymiqMGAqTzIuUS4QNvTcHn%2BFoOZvS%2F06fP5YWj%2BxpW%2BELDyBb5CFIWqKXYmkW%2BPv4IxFiMVfFF4KM80ZKVGfyJ7nRaRwvjM5YUJYHOlvXjFuPBSC3IYIgEZYlopEqTolZ1OQ2zbi1yDB%2FWl1rx7i7cbCVK6zJwPdLcPRBOa7jlMN0jlHdNPzjyKxdEaNBy7Cyflyw%2FZCl7X1dB7yuSBF8YK2st4h%2FZchseLh%2BjukipjtpVl5nDjO8BSu5evt1V1lFzADomlTKShrSgjmej1gvXmULpbdNuEwc3vMl328MfuwtHHSSvzZo5xxP0U1cq9fhM0Ztcea1ZRpQDZR4DB1jRqdjeMIXNuuwv3G7Uotj1VrvA87zW9Og6gQ9VN7fQSdOpurQFAV2WvRMIuSqv8FOusB%2B%2BEh7xquKUpKrZEfrLl0yLcAZyezk5OlnVLaoE%2BCU7%2F1YWDwq4fJ%2Fzqx58r%2Ffgzx%2FRuGFLAoCPIl7GI47ntqpCuRo5kjknXh3Vhm0Ds%2B9y0Uo9mgVKhl6XjEqADeRJOm5JpIvTZkPibWah%2FFXooiOsIWnpbe3xZbkrh62wdx0iVuonbBNy6Z0vYXXREkzeNyKh%2Fx0i0DwAehfYiLehqkIm1GqvDnaSiQ0dTRzOsrEnXwNhRtDRaBDDLvFXHGy3Xm8ucb70jki0U1otEIUfIG%2Fnfsrs7zhSOcLfi6%2B4aytuy%2FrSFLmVnwIpfIzQ%3D%3D\u0026X-Amz-Signature=156af64d209e25dc74aaf03a658ae2b6a0bbfa45af048e76cd3ec144f096497a"}],"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2977361,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Note that this vulnerability is much more severe than #175979, because #175979 relies on `\u003ciframe /\u003e`. \nBrave initiates downloading if iframe points to a binary file. That means it's impossible to read binary files using this technique.\n\nHowever, in the case of `link[rel=import]`, it's possible to read files with any mimeType.\n\u003e Tested this on `.zip`,`.jar`, leveldb files.","markdown_message":"\u003cp\u003eNote that this vulnerability is much more severe than \u003ca href=\"/reports/175979\"\u003e#175979\u003c/a\u003e, because \u003ca href=\"/reports/175979\"\u003e#175979\u003c/a\u003e relies on \u003ccode\u003e\u0026lt;iframe /\u0026gt;\u003c/code\u003e. \u003cbr\u003e\nBrave initiates downloading if iframe points to a binary file. That means it\u0026#39;s impossible to read binary files using this technique.\u003c/p\u003e\n\n\u003cp\u003eHowever, in the case of \u003ccode\u003elink[rel=import]\u003c/code\u003e, it\u0026#39;s possible to read files with any mimeType.\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eTested this on \u003ccode\u003e.zip\u003c/code\u003e,\u003ccode\u003e.jar\u003c/code\u003e, leveldb files.\u003c/p\u003e\n\u003c/blockquote\u003e\n","automated_response":false,"created_at":"2018-07-03T01:34:20.736Z","updated_at":"2018-07-03T01:35:16.473Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2979271,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"\u003e `deleted`","markdown_message":"\u003cblockquote\u003e\n\u003cp\u003e\u003ccode\u003edeleted\u003c/code\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n","automated_response":false,"created_at":"2018-07-03T08:50:35.444Z","updated_at":"2018-07-03T08:54:11.856Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2979316,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"\u003e From my understanding this happens because of `/atom/browser/net/url_request_string_job.h` in Muon ","markdown_message":"\u003cblockquote\u003e\n\u003cp\u003eFrom my understanding this happens because of \u003ccode\u003e/atom/browser/net/url_request_string_job.h\u003c/code\u003e in Muon \u003c/p\u003e\n\u003c/blockquote\u003e\n","automated_response":false,"created_at":"2018-07-03T09:12:12.884Z","updated_at":"2018-07-03T09:12:12.884Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2980431,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"\u003e ~~[more correct](https://github.com/brave/muon/blob/master/atom/browser/net/asar/url_request_asar_job.cc#L243)~~","markdown_message":"\u003cblockquote\u003e\n\u003cp\u003e\u003cdel\u003e\u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fbrave%2Fmuon%2Fblob%2Fmaster%2Fatom%2Fbrowser%2Fnet%2Fasar%2Furl_request_asar_job.cc%23L243\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003emore correct\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/del\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n","automated_response":false,"created_at":"2018-07-03T12:31:53.596Z","updated_at":"2018-07-03T12:31:53.596Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2980626,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi,\n\nThank you for your submission. We have received your report.\n\nBest regards,\n@thefrog\n\nSecurity Analyst\n**HackerOne**","markdown_message":"\u003cp\u003eHi,\u003c/p\u003e\n\n\u003cp\u003eThank you for your submission. We have received your report.\u003c/p\u003e\n\n\u003cp\u003eBest regards,\u003cbr\u003e\n\u003ca href=\"/thefrog\"\u003e@thefrog\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eSecurity Analyst\u003cbr\u003e\n\u003cstrong\u003eHackerOne\u003c/strong\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2018-07-03T13:24:29.672Z","updated_at":"2018-07-03T13:24:29.672Z","actor":{"username":"thefrog","cleared":false,"url":"/thefrog","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/246/015/2eead02646771af4df7aa20c21edb7d5dc99d3da_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2980778,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hi,\n\nThank you for your submission. I was able to validate your report, and have submitted it to the appropriate team for a thorough evaluation. The report will be reviewed to assess the full impact, after which a final ruling will be made. Please note that the status and severity of this report are subject to change.\n\nBest regards,\n@thefrog\n\nSecurity Analyst\n**HackerOne**\n","markdown_message":"\u003cp\u003eHi,\u003c/p\u003e\n\n\u003cp\u003eThank you for your submission. I was able to validate your report, and have submitted it to the appropriate team for a thorough evaluation. The report will be reviewed to assess the full impact, after which a final ruling will be made. Please note that the status and severity of this report are subject to change.\u003c/p\u003e\n\n\u003cp\u003eBest regards,\u003cbr\u003e\n\u003ca href=\"/thefrog\"\u003e@thefrog\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eSecurity Analyst\u003cbr\u003e\n\u003cstrong\u003eHackerOne\u003c/strong\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2018-07-03T14:05:18.637Z","updated_at":"2018-07-03T14:05:18.637Z","actor":{"username":"thefrog","cleared":false,"url":"/thefrog","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/246/015/2eead02646771af4df7aa20c21edb7d5dc99d3da_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2983106,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @metnew, what version of Brave are you testing on? I tried your POC in the latest version (0.23.19) and couldn't repro it. Trying to load a file on disk fails with console error \"Not allowed to load local resource:\" as expected.","markdown_message":"\u003cp\u003eHi \u003ca href=\"/metnew\"\u003e@metnew\u003c/a\u003e, what version of Brave are you testing on? I tried your POC in the latest version (0.23.19) and couldn\u0026#39;t repro it. Trying to load a file on disk fails with console error \u0026quot;Not allowed to load local resource:\u0026quot; as expected.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-07-03T20:24:58.289Z","updated_at":"2018-07-03T20:24:58.289Z","actor":{"username":"diracdeltas","cleared":false,"url":"/diracdeltas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/115/616/4e2016543ea3e299dcadd088be7d0225de3419e0_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2983115,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Forgot to mention - i tested this loading the POC HTML from a localhost server instead of from the `file:///` origin to simulate loading a remote site. Does the POC only work when loaded from file:///?","markdown_message":"\u003cp\u003eForgot to mention - i tested this loading the POC HTML from a localhost server instead of from the \u003ccode\u003efile:///\u003c/code\u003e origin to simulate loading a remote site. Does the POC only work when loaded from file:///?\u003c/p\u003e\n","automated_response":false,"created_at":"2018-07-03T20:26:38.471Z","updated_at":"2018-07-03T20:26:38.471Z","actor":{"username":"diracdeltas","cleared":false,"url":"/diracdeltas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/115/616/4e2016543ea3e299dcadd088be7d0225de3419e0_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2983165,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2018-07-03T20:35:02.440Z","updated_at":"2018-07-03T20:35:02.440Z","additional_data":{"old_severity":"Critical","new_severity":"High","old_severity_id":176975,"new_severity_id":177987},"actor":{"username":"diracdeltas","cleared":false,"url":"/diracdeltas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/115/616/4e2016543ea3e299dcadd088be7d0225de3419e0_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2983545,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"sorry i see you included in the original issue what version of Brave you tested on. since this only seems to affect local files, i downgraded the severity to high.","markdown_message":"\u003cp\u003esorry i see you included in the original issue what version of Brave you tested on. since this only seems to affect local files, i downgraded the severity to high.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-07-03T21:07:53.567Z","updated_at":"2018-07-03T21:07:53.567Z","actor":{"username":"diracdeltas","cleared":false,"url":"/diracdeltas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/115/616/4e2016543ea3e299dcadd088be7d0225de3419e0_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2984449,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"H @diracdeltas, thanks for the quick response.\nYeah, this only affects files on local disk. \nWorks on all platforms.\n","markdown_message":"\u003cp\u003eH \u003ca href=\"/diracdeltas\"\u003e@diracdeltas\u003c/a\u003e, thanks for the quick response.\u003cbr\u003e\nYeah, this only affects files on local disk. \u003cbr\u003e\nWorks on all platforms.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-07-04T02:01:42.587Z","updated_at":"2018-07-04T02:01:42.587Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3003641,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thank you for the report. We are tracking this issue in https://github.com/brave/browser-laptop/issues/14642.","markdown_message":"\u003cp\u003eThank you for the report. We are tracking this issue in \u003ca title=\"https://github.com/brave/browser-laptop/issues/14642\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fbrave%2Fbrowser-laptop%2Fissues%2F14642\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/brave/browser-laptop/issues/14642\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-07-06T22:47:47.420Z","updated_at":"2018-07-06T22:47:47.420Z","actor":{"url":"/brave","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/688/2aad5641af643ee4f4402896e4747293f6e9c5ca_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Brave Software"}},"bounty_amount":"150.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"brave","collaborator":{"username":"metnew","url":"/metnew"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3012015,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I **disagree with the bounty**. I think it should be higher. \n\nTop arguments:\n\n### Impact != reward\nImpact of the vulnerability couldn't be compared with the reward. The vulnerability allows stealing any(!) local data. Stolen ssh keys/cookies/passwords/DBs couldn't be compared with fingerprinting or other misc attacks.  \n\n### Chained vulnerabilities\nAs I understand, this bug was considered distinctly from the URL spoofing bugs/ the bug with download modal. However, I highlighted that this vulnerability is much more severe because of #369086/ #343721/ #375259 (which were marked as duplicate, but that's another story). \n\nI think that evaluating this vulnerability distinctly from the other bugs is unfair because chained vulnerabilities (presented in the same version + reported by the same researcher) have a higher impact. E.g., a synergy of URL spoofing and local files reading is much more dangerous than each of these vulnerabilities by itself.\n\n## Report + explanation\nI pointed to the vulnerability in the code + explained the root cause (on Github).\n\n---------------------------\n\nI think these arguments are enough for the @brave team to reconsider the bounty.","markdown_message":"\u003cp\u003eI \u003cstrong\u003edisagree with the bounty\u003c/strong\u003e. I think it should be higher. \u003c/p\u003e\n\n\u003cp\u003eTop arguments:\u003c/p\u003e\n\n\u003ch3 id=\"impact-reward\"\u003eImpact != reward\u003c/h3\u003e\n\n\u003cp\u003eImpact of the vulnerability couldn\u0026#39;t be compared with the reward. The vulnerability allows stealing any(!) local data. Stolen ssh keys/cookies/passwords/DBs couldn\u0026#39;t be compared with fingerprinting or other misc attacks.  \u003c/p\u003e\n\n\u003ch3 id=\"chained-vulnerabilities\"\u003eChained vulnerabilities\u003c/h3\u003e\n\n\u003cp\u003eAs I understand, this bug was considered distinctly from the URL spoofing bugs/ the bug with download modal. However, I highlighted that this vulnerability is much more severe because of \u003ca href=\"/reports/369086\"\u003e#369086\u003c/a\u003e/ \u003ca href=\"/reports/343721\"\u003e#343721\u003c/a\u003e/ \u003ca href=\"/reports/375259\"\u003e#375259\u003c/a\u003e (which were marked as duplicate, but that\u0026#39;s another story). \u003c/p\u003e\n\n\u003cp\u003eI think that evaluating this vulnerability distinctly from the other bugs is unfair because chained vulnerabilities (presented in the same version + reported by the same researcher) have a higher impact. E.g., a synergy of URL spoofing and local files reading is much more dangerous than each of these vulnerabilities by itself.\u003c/p\u003e\n\n\u003ch2 id=\"report-explanation\"\u003eReport + explanation\u003c/h2\u003e\n\n\u003cp\u003eI pointed to the vulnerability in the code + explained the root cause (on Github).\u003c/p\u003e\n\n\u003chr\u003e\n\n\u003cp\u003eI think these arguments are enough for the \u003ca href=\"/brave\"\u003e@brave\u003c/a\u003e team to reconsider the bounty.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-07-08T00:33:09.661Z","updated_at":"2018-07-08T00:33:09.661Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3021082,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@toml","markdown_message":"\u003cp\u003e\u003ca href=\"/toml\"\u003e@toml\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2018-07-09T22:29:04.820Z","updated_at":"2018-07-09T22:29:04.820Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3027280,"is_internal":false,"editable":false,"type":"Activities::HackerRequestedMediation","message":"I disagree with the bounty. I think it should be higher.\n\nTop arguments:\n\n### Impact != reward\nImpact of the vulnerability couldn't be compared with the reward. The vulnerability allows stealing any(!) local data. Stolen ssh keys/cookies/passwords/DBs couldn't be compared with fingerprinting or other misc attacks.\n\n### Chained vulnerabilities\nAs I understand, this bug was considered distinctly from the URL spoofing bugs/ the bug with download modal. However, I highlighted that this vulnerability is much more severe because of #369086/ #343721/ #375259 (which were marked as duplicate, but that's another story).\n\nI think that evaluating this vulnerability distinctly from the other bugs is unfair because chained vulnerabilities (presented in the same version + reported by the same researcher) have a higher impact. E.g., a synergy of URL spoofing and local files reading is much more dangerous than each of these vulnerabilities by itself.\n\n### Report + explanation\nI pointed to the vulnerability in the code (the link in comments) + explained it on Github.\n\n","markdown_message":"\u003cp\u003eI disagree with the bounty. I think it should be higher.\u003c/p\u003e\n\n\u003cp\u003eTop arguments:\u003c/p\u003e\n\n\u003ch3 id=\"impact-reward\"\u003eImpact != reward\u003c/h3\u003e\n\n\u003cp\u003eImpact of the vulnerability couldn\u0026#39;t be compared with the reward. The vulnerability allows stealing any(!) local data. Stolen ssh keys/cookies/passwords/DBs couldn\u0026#39;t be compared with fingerprinting or other misc attacks.\u003c/p\u003e\n\n\u003ch3 id=\"chained-vulnerabilities\"\u003eChained vulnerabilities\u003c/h3\u003e\n\n\u003cp\u003eAs I understand, this bug was considered distinctly from the URL spoofing bugs/ the bug with download modal. However, I highlighted that this vulnerability is much more severe because of \u003ca href=\"/reports/369086\"\u003e#369086\u003c/a\u003e/ \u003ca href=\"/reports/343721\"\u003e#343721\u003c/a\u003e/ \u003ca href=\"/reports/375259\"\u003e#375259\u003c/a\u003e (which were marked as duplicate, but that\u0026#39;s another story).\u003c/p\u003e\n\n\u003cp\u003eI think that evaluating this vulnerability distinctly from the other bugs is unfair because chained vulnerabilities (presented in the same version + reported by the same researcher) have a higher impact. E.g., a synergy of URL spoofing and local files reading is much more dangerous than each of these vulnerabilities by itself.\u003c/p\u003e\n\n\u003ch3 id=\"report-explanation\"\u003eReport + explanation\u003c/h3\u003e\n\n\u003cp\u003eI pointed to the vulnerability in the code (the link in comments) + explained it on Github.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-07-11T00:01:32.935Z","updated_at":"2018-07-11T00:01:32.935Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3032270,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2018-07-11T20:58:10.301Z","updated_at":"2018-07-11T20:58:10.301Z","actor":{"url":"/brave","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/688/2aad5641af643ee4f4402896e4747293f6e9c5ca_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Brave Software"}},"bounty_amount":"0.0","bounty_currency":"usd","bonus_amount":"100.0","genius_execution_id":null,"team_handle":"brave","collaborator":{"username":"metnew","url":"/metnew"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3058899,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"closing since https://github.com/brave/muon/pull/628 was merged","markdown_message":"\u003cp\u003eclosing since \u003ca title=\"https://github.com/brave/muon/pull/628\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fbrave%2Fmuon%2Fpull%2F628\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/brave/muon/pull/628\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e was merged\u003c/p\u003e\n","automated_response":false,"created_at":"2018-07-17T20:33:33.126Z","updated_at":"2018-07-17T20:33:33.126Z","actor":{"username":"diracdeltas","cleared":false,"url":"/diracdeltas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/115/616/4e2016543ea3e299dcadd088be7d0225de3419e0_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"metnew","url":"/metnew"},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3059487,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-07-17T22:13:59.851Z","updated_at":"2018-07-17T22:13:59.851Z","first_to_agree":true,"actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3138237,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"\u003e I agree with a bounty and resolution","markdown_message":"\u003cblockquote\u003e\n\u003cp\u003eI agree with a bounty and resolution\u003c/p\u003e\n\u003c/blockquote\u003e\n","automated_response":false,"created_at":"2018-08-03T18:51:18.423Z","updated_at":"2018-08-03T18:51:18.423Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3139119,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@diracdeltas @brave\nIt'd better cancel disclosure because of #390362  and #390013","markdown_message":"\u003cp\u003e\u003ca href=\"/diracdeltas\"\u003e@diracdeltas\u003c/a\u003e \u003ca href=\"/brave\"\u003e@brave\u003c/a\u003e\u003cbr\u003e\nIt\u0026#39;d better cancel disclosure because of \u003ca href=\"/reports/390362\"\u003e#390362\u003c/a\u003e  and \u003ca href=\"/reports/390013\"\u003e#390013\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2018-08-03T23:21:03.165Z","updated_at":"2018-08-03T23:21:03.165Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3139466,"is_internal":false,"editable":false,"type":"Activities::BugReopened","message":"","markdown_message":"","automated_response":false,"created_at":"2018-08-04T02:56:03.662Z","updated_at":"2018-08-04T02:56:03.662Z","actor":{"username":"taraffic","cleared":false,"url":"/taraffic","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/Lb1DPdXu9tHW9HrSbScjwNkc/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3139467,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2018-08-04T02:56:15.465Z","updated_at":"2018-08-04T02:56:15.465Z","actor":{"username":"taraffic","cleared":false,"url":"/taraffic","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/Lb1DPdXu9tHW9HrSbScjwNkc/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"reporter":{"username":"metnew","url":"/metnew"},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3370755,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@diracdeltas Unpatched at that time #369218 (opening `file:///` URLs from the web using \"open in new tab\") allowed to significantly increase severity of this bug.","markdown_message":"\u003cp\u003e\u003ca href=\"/diracdeltas\"\u003e@diracdeltas\u003c/a\u003e Unpatched at that time \u003ca href=\"/reports/369218\"\u003e#369218\u003c/a\u003e (opening \u003ccode\u003efile:///\u003c/code\u003e URLs from the web using \u0026quot;open in new tab\u0026quot;) allowed to significantly increase severity of this bug.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-09-21T20:10:55.366Z","updated_at":"2018-09-21T20:10:55.366Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3370757,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-09-21T20:12:07.681Z","updated_at":"2018-09-21T20:12:07.681Z","first_to_agree":true,"actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3370803,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hah, noticed a funny thing:\nIn the original report, I wrote: _\"This vulnerability makes #369218 critical.\"_\n\nAnd that's actually become true)","markdown_message":"\u003cp\u003eHah, noticed a funny thing:\u003cbr\u003e\nIn the original report, I wrote: \u003cu\u003e\u0026quot;This vulnerability makes \u003ca href=\"/reports/369218\"\u003e#369218\u003c/a\u003e critical.\u0026quot;\u003c/u\u003e\u003c/p\u003e\n\n\u003cp\u003eAnd that\u0026#39;s actually become true)\u003c/p\u003e\n","automated_response":false,"created_at":"2018-09-21T20:26:11.139Z","updated_at":"2018-09-21T20:26:11.139Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3402965,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Considering MITM attacks, the attack scenario becomes:\n\n1. MITM attacker waits for user's computer to download a file over HTTP\n2. They inject the attack file\n3. They wait for the user to open the file\n4. They read other local files\n\nI would still call this 'high' instead of critical because it requires some user interaction (download a file over HTTP and then also open the file). But agree with awarding more.","markdown_message":"\u003cp\u003eConsidering MITM attacks, the attack scenario becomes:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eMITM attacker waits for user\u0026#39;s computer to download a file over HTTP\u003c/li\u003e\n\u003cli\u003eThey inject the attack file\u003c/li\u003e\n\u003cli\u003eThey wait for the user to open the file\u003c/li\u003e\n\u003cli\u003eThey read other local files\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eI would still call this \u0026#39;high\u0026#39; instead of critical because it requires some user interaction (download a file over HTTP and then also open the file). But agree with awarding more.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-09-28T18:28:09.740Z","updated_at":"2018-09-28T18:28:09.740Z","actor":{"username":"diracdeltas","cleared":false,"url":"/diracdeltas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/115/616/4e2016543ea3e299dcadd088be7d0225de3419e0_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3402969,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2018-09-28T18:28:48.205Z","updated_at":"2018-09-28T18:28:48.205Z","actor":{"url":"/brave","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/688/2aad5641af643ee4f4402896e4747293f6e9c5ca_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Brave Software"}},"bounty_amount":"150.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"brave","collaborator":{"username":"metnew","url":"/metnew"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3404611,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks, @diracdeltas, but I want to highlight the next topics:\n\n### Attack Scenario via #369218\n\n\u003e Attack scenario via downloading is quite interesting but requires specific conditions.\n\nDon't know why you don't consider the attack scenario which leverages #369218.\nThat's a really awesome opportunity for attacker.\n\n1. Victim opens `file:///\u003cRESOURCE_WITH_HTTP_SCRIPT\u003e` (that macOS default system HTML file)\n2. MITM script requested by `file:///\u003cRESOURCE_WITH_HTTP_SCRIPT\u003e`\n3. Read any file on disk :(\n\nI guess that's a valid bug chaining.\n\n\u003e There is no additional downloading in the chain or similar (like I wrongly proposed before).\n\u003e Additional scenario modifications are possible, but that's out of scope.\n\n1. HTTPSE may protect in some cases. I don't know whether it's active by default.\n2. As you said, HTTPSE doesn't always upgrade the connection.\n\n### Distinguishing vulns in different OS\n\nI've already written [about it here](https://hackerone.com/reports/369218#activity-3391093).\n\nI understand that `http://` script in default system files isn't connected to Brave. However, that doesn't change anything. \n\nIn my opinion, that's a problem of Brave that certain OS tricks allow escalating Brave bugs into more severe scenarios :(\n\nAlso, that's macOS, not some rarely used Linux distro with 1% of Brave's users.\n\n\u003e still `http://` on Mojave\n\n### Inconsistent rewards \n\nThat's really awesome that Brave decided to reconsider rewards to benefit researchers.\nBut I think the rewards are pretty inconsistent.  From my point of view, this bug is more severe than it was estimated comparing to other updated bugs.\n\n*Also, could we disclose this report and #390362 since this bug is fixed now?*","markdown_message":"\u003cp\u003eThanks, \u003ca href=\"/diracdeltas\"\u003e@diracdeltas\u003c/a\u003e, but I want to highlight the next topics:\u003c/p\u003e\n\n\u003ch3 id=\"attack-scenario-via-369218\"\u003eAttack Scenario via \u003ca href=\"/reports/369218\"\u003e#369218\u003c/a\u003e\n\u003c/h3\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eAttack scenario via downloading is quite interesting but requires specific conditions.\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eDon\u0026#39;t know why you don\u0026#39;t consider the attack scenario which leverages \u003ca href=\"/reports/369218\"\u003e#369218\u003c/a\u003e.\u003cbr\u003e\nThat\u0026#39;s a really awesome opportunity for attacker.\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eVictim opens \u003ccode\u003efile:///\u0026lt;RESOURCE_WITH_HTTP_SCRIPT\u0026gt;\u003c/code\u003e (that macOS default system HTML file)\u003c/li\u003e\n\u003cli\u003eMITM script requested by \u003ccode\u003efile:///\u0026lt;RESOURCE_WITH_HTTP_SCRIPT\u0026gt;\u003c/code\u003e\n\u003c/li\u003e\n\u003cli\u003eRead any file on disk :(\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eI guess that\u0026#39;s a valid bug chaining.\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eThere is no additional downloading in the chain or similar (like I wrongly proposed before).\u003cbr\u003e\nAdditional scenario modifications are possible, but that\u0026#39;s out of scope.\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003col\u003e\n\u003cli\u003eHTTPSE may protect in some cases. I don\u0026#39;t know whether it\u0026#39;s active by default.\u003c/li\u003e\n\u003cli\u003eAs you said, HTTPSE doesn\u0026#39;t always upgrade the connection.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003ch3 id=\"distinguishing-vulns-in-different-os\"\u003eDistinguishing vulns in different OS\u003c/h3\u003e\n\n\u003cp\u003eI\u0026#39;ve already written \u003ca href=\"https://hackerone.com/reports/369218#activity-3391093\"\u003eabout it here\u003c/a\u003e.\u003c/p\u003e\n\n\u003cp\u003eI understand that \u003ccode\u003ehttp://\u003c/code\u003e script in default system files isn\u0026#39;t connected to Brave. However, that doesn\u0026#39;t change anything. \u003c/p\u003e\n\n\u003cp\u003eIn my opinion, that\u0026#39;s a problem of Brave that certain OS tricks allow escalating Brave bugs into more severe scenarios :(\u003c/p\u003e\n\n\u003cp\u003eAlso, that\u0026#39;s macOS, not some rarely used Linux distro with 1% of Brave\u0026#39;s users.\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003estill \u003ccode\u003ehttp://\u003c/code\u003e on Mojave\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003ch3 id=\"inconsistent-rewards\"\u003eInconsistent rewards\u003c/h3\u003e\n\n\u003cp\u003eThat\u0026#39;s really awesome that Brave decided to reconsider rewards to benefit researchers.\u003cbr\u003e\nBut I think the rewards are pretty inconsistent.  From my point of view, this bug is more severe than it was estimated comparing to other updated bugs.\u003c/p\u003e\n\n\u003cp\u003e\u003cem\u003eAlso, could we disclose this report and \u003ca href=\"/reports/390362\"\u003e#390362\u003c/a\u003e since this bug is fixed now?\u003c/em\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2018-09-28T23:24:12.375Z","updated_at":"2018-09-28T23:24:12.375Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3404761,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"We do our best to award consistent bounties and that's why we have a bounty schedule on our program page. But we're humans making judgment calls about every report that comes in. And if we provide an unusually-high award for one particular report, that doesn't mean that we're changing our practices and awarding higher awards for every similar report. If we make a mistake and give a particular report an overly-generous award, we're not going to try to take back that money. We'll just keep trying to make consistent award in future. That means you might see some unusually-high awards in our history, because when we accidentally don't award enough, we try to make it right by increasing the bounty. But when we award too much we just move on.\n\nWhen talking about whether an award is fair for *this* report, the only relevant question is where it sits in our bounty schedule — not the awards we've made in the past. For this report, it's clear. This is definitely a real problem that puts Brave users at risk. But we're not going to ship a hotfix for it — a fix will go out in a scheduled release. Our schedule says that the limit for something which goes out in a regularly-scheduled release is $250. The award for this is now $400 which makes this award unusually-generous. ","markdown_message":"\u003cp\u003eWe do our best to award consistent bounties and that\u0026#39;s why we have a bounty schedule on our program page. But we\u0026#39;re humans making judgment calls about every report that comes in. And if we provide an unusually-high award for one particular report, that doesn\u0026#39;t mean that we\u0026#39;re changing our practices and awarding higher awards for every similar report. If we make a mistake and give a particular report an overly-generous award, we\u0026#39;re not going to try to take back that money. We\u0026#39;ll just keep trying to make consistent award in future. That means you might see some unusually-high awards in our history, because when we accidentally don\u0026#39;t award enough, we try to make it right by increasing the bounty. But when we award too much we just move on.\u003c/p\u003e\n\n\u003cp\u003eWhen talking about whether an award is fair for \u003cem\u003ethis\u003c/em\u003e report, the only relevant question is where it sits in our bounty schedule — not the awards we\u0026#39;ve made in the past. For this report, it\u0026#39;s clear. This is definitely a real problem that puts Brave users at risk. But we\u0026#39;re not going to ship a hotfix for it — a fix will go out in a scheduled release. Our schedule says that the limit for something which goes out in a regularly-scheduled release is $250. The award for this is now $400 which makes this award unusually-generous. \u003c/p\u003e\n","automated_response":false,"created_at":"2018-09-29T00:16:01.531Z","updated_at":"2018-09-29T00:16:01.531Z","actor":{"username":"toml","cleared":false,"url":"/toml","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/229/717/56ea9edd04176aa3f29b215291bbc0b656699f67_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3404763,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-09-29T00:16:24.150Z","updated_at":"2018-09-29T00:16:24.150Z","actor":{"username":"toml","cleared":false,"url":"/toml","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/229/717/56ea9edd04176aa3f29b215291bbc0b656699f67_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3404764,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-09-29T00:16:24.209Z","updated_at":"2018-09-29T00:16:24.209Z","actor":{"username":"toml","cleared":false,"url":"/toml","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/229/717/56ea9edd04176aa3f29b215291bbc0b656699f67_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3404773,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Ah, I see, thanks for the explanation, @toml!\n\nI thought the severity might be underestimated because the Brave team considered only MITM +downloading case (comment above), so I decided to add some notes to avoid any kind of miscommunication.","markdown_message":"\u003cp\u003eAh, I see, thanks for the explanation, \u003ca href=\"/toml\"\u003e@toml\u003c/a\u003e!\u003c/p\u003e\n\n\u003cp\u003eI thought the severity might be underestimated because the Brave team considered only MITM +downloading case (comment above), so I decided to add some notes to avoid any kind of miscommunication.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-09-29T00:22:33.986Z","updated_at":"2018-09-29T00:22:33.986Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}