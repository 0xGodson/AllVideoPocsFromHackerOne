{"id":642886,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC82NDI4ODY=","url":"https://hackerone.com/reports/642886","title":"Reauthentication for changing password bypass","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2019-07-14T11:55:54.888Z","submitted_at":"2019-07-14T11:55:54.888Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"viber","url":"/viber","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":28411,"url":"https://hackerone.com/liberapay","handle":"liberapay","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/028/411/c0a012abdcef38b417e29616505b1a3b4ed87b81_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/028/411/c0a012abdcef38b417e29616505b1a3b4ed87b81_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Liberapay","twitter_handle":"liberapay","website":"https://liberapay.com","about":"An open source platform designed to facilitate recurrent donations."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2020-12-23T10:16:00.179Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2020-11-23T10:15:55.330Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hello There\nSo Libra Pay has this security system because of which if a malicious user tries to change the password of a logged in account, whether by session hijack or anything else he will be asked to re-enter the password before he can change it. \nBut this loop hole I found in the system using which he/she can change it without even knowing the old password. How? \nHere is the reproduction steps:\n\nStep 1. Go to accounts settings. \nStep 2. Add an email address to the email which we have access to(Remember adding an email doesn't require you to re-enter password but changing password does) \nStep 3. Confirm the email address. \nStep 4. Make it primary email. (Even this doesn't require you to re-enter password)\nStep 5. Now we can change the password by reseting it through the new ema\n\nI have checked for this in several other platforms as well but most of them were smart enough to ask me for entering password before I could change or add email address. May be you can implement the same.\n\nThank you.\nBaibhav Anand Jha.\nSecurity Researcher.\n\n## Impact\n\nA malicious user will be able to change the password without knowing the old password.","vulnerability_information_html":"\u003cp\u003eHello There\u003cbr\u003e\nSo Libra Pay has this security system because of which if a malicious user tries to change the password of a logged in account, whether by session hijack or anything else he will be asked to re-enter the password before he can change it. \u003cbr\u003e\nBut this loop hole I found in the system using which he/she can change it without even knowing the old password. How? \u003cbr\u003e\nHere is the reproduction steps:\u003c/p\u003e\n\n\u003cp\u003eStep 1. Go to accounts settings. \u003cbr\u003e\nStep 2. Add an email address to the email which we have access to(Remember adding an email doesn\u0026#39;t require you to re-enter password but changing password does) \u003cbr\u003e\nStep 3. Confirm the email address. \u003cbr\u003e\nStep 4. Make it primary email. (Even this doesn\u0026#39;t require you to re-enter password)\u003cbr\u003e\nStep 5. Now we can change the password by reseting it through the new ema\u003c/p\u003e\n\n\u003cp\u003eI have checked for this in several other platforms as well but most of them were smart enough to ask me for entering password before I could change or add email address. May be you can implement the same.\u003c/p\u003e\n\n\u003cp\u003eThank you.\u003cbr\u003e\nBaibhav Anand Jha.\u003cbr\u003e\nSecurity Researcher.\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eA malicious user will be able to change the password without knowing the old password.\u003c/p\u003e\n","weakness":{"id":27,"name":"Improper Authentication - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2020-12-23T10:15:55.460Z","allow_singular_disclosure_after":-505026.032765739,"singular_disclosure_allowed":true,"vote_count":4,"voters":["h4x0r-dz","iamcoolcat","meispi","codingpy"],"severity":{"rating":"low","author_type":"Team"},"structured_scope":{"databaseId":8926,"asset_type":"URL","asset_identifier":"*.liberapay.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":5319191,"is_internal":false,"editable":false,"type":"Activities::BugNotApplicable","message":"Hey ,\n\nAfter review, there doesn’t seem to be any security risk and/or security impact as a result of the behavior you are describing. If you are able to leverage this into a practical exploitation scenario, we will be happy to reevaluate this report, but at this time, it does not present a significant security risk. \n\nThis would be a best practice and not a security vulnerability and it does not lead to direct exploitation. It also requires the victim account to be compromised somehow.\n\nAs a result, we will be closing this report. Nevertheless, we appreciate your effort and look forward to seeing more reports from you in the future. \n\nKind regards,\n\n","markdown_message":"\u003cp\u003eHey ,\u003c/p\u003e\n\n\u003cp\u003eAfter review, there doesn’t seem to be any security risk and/or security impact as a result of the behavior you are describing. If you are able to leverage this into a practical exploitation scenario, we will be happy to reevaluate this report, but at this time, it does not present a significant security risk. \u003c/p\u003e\n\n\u003cp\u003eThis would be a best practice and not a security vulnerability and it does not lead to direct exploitation. It also requires the victim account to be compromised somehow.\u003c/p\u003e\n\n\u003cp\u003eAs a result, we will be closing this report. Nevertheless, we appreciate your effort and look forward to seeing more reports from you in the future. \u003c/p\u003e\n\n\u003cp\u003eKind regards,\u003c/p\u003e\n","automated_response":false,"created_at":"2019-07-14T21:05:28.968Z","updated_at":"2019-07-14T21:05:28.968Z","actor":{"username":"glassofbeer","cleared":false,"url":"/glassofbeer","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/166/997/bf60ed9bb749786ae3f68f25703bf0528699cda7_original.JPG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"liberapay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5319771,"is_internal":false,"editable":false,"type":"Activities::BugReopened","message":"","markdown_message":"","automated_response":false,"created_at":"2019-07-15T02:12:58.558Z","updated_at":"2019-07-15T02:12:58.558Z","actor":{"username":"viber","cleared":false,"url":"/viber","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"liberapay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5319772,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"No Galassofbeer, you didn't get my point here. \nYou don't close a 2F authentication bypass report because it requires you to have access to account right? Here I just made a security feature useless which I believe is definitely a security issue. I reported a similar issue a while ago in Twitter and it was valid but unfortunately duplicate. So I request you to once discuss about it with your co-workers if it is a valid security issue or not. \n\nThank you.\nBaibhav","markdown_message":"\u003cp\u003eNo Galassofbeer, you didn\u0026#39;t get my point here. \u003cbr\u003e\nYou don\u0026#39;t close a 2F authentication bypass report because it requires you to have access to account right? Here I just made a security feature useless which I believe is definitely a security issue. I reported a similar issue a while ago in Twitter and it was valid but unfortunately duplicate. So I request you to once discuss about it with your co-workers if it is a valid security issue or not. \u003c/p\u003e\n\n\u003cp\u003eThank you.\u003cbr\u003e\nBaibhav\u003c/p\u003e\n","automated_response":false,"created_at":"2019-07-15T02:12:58.639Z","updated_at":"2019-07-15T02:12:58.639Z","actor":{"username":"viber","cleared":false,"url":"/viber","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"liberapay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5319849,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Also it is not a best practice at all according to me. Why do you think are we asked to enter old password before changing password? It is because if a malicious user gets his hands on our account he/she cannot change the password and here I am able yo bypass that security. Here what I mentioned is completely practical attack scenario. \n\nThank you.","markdown_message":"\u003cp\u003eAlso it is not a best practice at all according to me. Why do you think are we asked to enter old password before changing password? It is because if a malicious user gets his hands on our account he/she cannot change the password and here I am able yo bypass that security. Here what I mentioned is completely practical attack scenario. \u003c/p\u003e\n\n\u003cp\u003eThank you.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-07-15T02:58:54.603Z","updated_at":"2019-07-15T02:58:54.603Z","actor":{"username":"viber","cleared":false,"url":"/viber","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"liberapay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5320229,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you for your submission! We have received your report and a security analyst will respond shortly.","markdown_message":"\u003cp\u003eThank you for your submission! We have received your report and a security analyst will respond shortly.\u003c/p\u003e\n","automated_response":true,"created_at":"2019-07-15T06:43:44.139Z","updated_at":"2019-07-15T06:43:44.139Z","actor":{"url":"/liberapay","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/028/411/c0a012abdcef38b417e29616505b1a3b4ed87b81_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Liberapay"}},"genius_execution_id":null,"team_handle":"liberapay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5322603,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2019-07-15T11:54:17.756Z","updated_at":"2019-07-15T11:54:17.756Z","additional_data":{"old_severity":"Medium","new_severity":"Low","old_severity_id":458881,"new_severity_id":459471},"actor":{"username":"changaco","cleared":false,"url":"/changaco","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/057/214/a4a950c93bb68bb76a61cf02b1484a518e8c7a90_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"liberapay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5323008,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"You are correct that the current authentication requirements are incoherent and don't protect users against account hijacking as much as they should. We'll have to fix that, but it's not urgent.","markdown_message":"\u003cp\u003eYou are correct that the current authentication requirements are incoherent and don\u0026#39;t protect users against account hijacking as much as they should. We\u0026#39;ll have to fix that, but it\u0026#39;s not urgent.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-07-15T12:28:46.798Z","updated_at":"2019-07-15T12:28:46.798Z","actor":{"username":"changaco","cleared":false,"url":"/changaco","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/057/214/a4a950c93bb68bb76a61cf02b1484a518e8c7a90_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"liberapay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5467746,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"","markdown_message":"","automated_response":false,"created_at":"2019-07-31T07:32:18.249Z","updated_at":"2019-07-31T07:32:18.249Z","actor":{"url":"/liberapay","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/028/411/c0a012abdcef38b417e29616505b1a3b4ed87b81_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Liberapay"}},"genius_execution_id":null,"team_handle":"liberapay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6388340,"is_internal":false,"editable":false,"type":"Activities::ExternalUserJoined","message":"","markdown_message":"","automated_response":false,"created_at":"2019-11-24T08:21:38.096Z","updated_at":"2019-11-24T08:21:38.096Z","additional_data":{"duplicate_report_id":743353},"actor":{"username":"danishalkatiri","cleared":false,"url":"/danishalkatiri","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"liberapay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6427963,"is_internal":false,"editable":false,"type":"Activities::ExternalUserRemoved","message":"","markdown_message":"","automated_response":false,"created_at":"2019-11-28T13:03:47.054Z","updated_at":"2019-11-28T13:03:47.054Z","actor":{"username":"danishalkatiri","cleared":false,"url":"/danishalkatiri","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"removed_user":{"url":"/danishalkatiri","username":"danishalkatiri"},"genius_execution_id":null,"team_handle":"liberapay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9821227,"is_internal":false,"editable":false,"type":"Activities::ExternalUserJoined","message":"","markdown_message":"","automated_response":false,"created_at":"2020-11-14T07:49:34.324Z","updated_at":"2020-11-14T07:49:34.324Z","additional_data":{"duplicate_report_id":1032426},"actor":{"username":"naresh101","cleared":false,"url":"/naresh101","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"liberapay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9823150,"is_internal":false,"editable":false,"type":"Activities::Comment","message":".\n","markdown_message":"\u003cp\u003e.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-11-14T14:25:09.069Z","updated_at":"2020-11-14T14:29:56.510Z","actor":{"username":"naresh101","cleared":false,"url":"/naresh101","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"liberapay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9823165,"is_internal":false,"editable":false,"type":"Activities::ExternalUserRemoved","message":"","markdown_message":"","automated_response":false,"created_at":"2020-11-14T14:31:15.282Z","updated_at":"2020-11-14T14:31:15.282Z","actor":{"username":"naresh101","cleared":false,"url":"/naresh101","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"removed_user":{"url":"/naresh101","username":"naresh101"},"genius_execution_id":null,"team_handle":"liberapay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9896525,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"This is finally fixed. Sorry it took so long.\n\nAs always the patch is visible on GitHub: [#1920](https://github.com/liberapay/liberapay.com/pull/1920).","markdown_message":"\u003cp\u003eThis is finally fixed. Sorry it took so long.\u003c/p\u003e\n\n\u003cp\u003eAs always the patch is visible on GitHub: \u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fliberapay%2Fliberapay.com%2Fpull%2F1920\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003e#1920\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-11-23T10:15:38.462Z","updated_at":"2020-11-23T10:15:38.462Z","actor":{"username":"changaco","cleared":false,"url":"/changaco","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/057/214/a4a950c93bb68bb76a61cf02b1484a518e8c7a90_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"viber","url":"/viber"},"genius_execution_id":null,"team_handle":"liberapay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9896547,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-11-23T10:15:55.353Z","updated_at":"2020-11-23T10:15:55.353Z","first_to_agree":true,"actor":{"username":"changaco","cleared":false,"url":"/changaco","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/057/214/a4a950c93bb68bb76a61cf02b1484a518e8c7a90_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"liberapay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":10185188,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-12-23T10:16:00.300Z","updated_at":"2020-12-23T10:16:00.300Z","actor":{"url":"/liberapay","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/028/411/c0a012abdcef38b417e29616505b1a3b4ed87b81_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Liberapay"}},"genius_execution_id":null,"team_handle":"liberapay","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}