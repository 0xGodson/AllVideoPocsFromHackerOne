{"id":470547,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC80NzA1NDc=","url":"https://hackerone.com/reports/470547","title":"Unauthorized command execution in Web protection component of Anti-Virus products family [IE]","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2018-12-21T10:28:22.840Z","submitted_at":"2018-12-21T10:28:22.840Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"palant","url":"/palant","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/125/397/69a28ca9d5030b1db03411852407732328b571c3_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":2379,"url":"https://hackerone.com/kaspersky","handle":"kaspersky","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/002/379/d7dc3ce53a84816885872fb423816bfbbbd36390_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/379/d7dc3ce53a84816885872fb423816bfbbbd36390_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Kaspersky","twitter_handle":"kaspersky","website":"http://www.kaspersky.com","about":"Kaspersky is the worldâ€™s largest privately-held vendor of endpoint protection and cybersecurity solutions for business and consumers."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":["CVE-2019-15685"],"singular_disclosure_disabled":false,"disclosed_at":"2019-11-24T08:58:24.472Z","bug_reporter_agreed_on_going_public_at":"2019-10-25T08:58:21.534Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"**Summary**\nWhen Kaspersky add-on is installed in Internet Explorer, arbitrary webpages can take control of the Kaspersky command interface and disable parts of the functionality for example.\n\n**Description**\nUnlike with https://hackerone.com/reports/470544, when the Kaspersky add-on is installed in Internet Explorer, Kaspersky doesn't inject its script directly into the webpage, so the webpage cannot re-execute it. However, this script is still running in the same context as the webpage. While provisions have been made to prevent manipulation of some JavaScript objects such as WebSocket, other objects have not received the same treatment. In particular, a website can intercept `String.indexOf()` calls made by Kaspersky's script and gain access to its namespace this way. As a result, webpages can get full access to Kaspersky's command interface which allows disabling Anti-Banner and Private Browsing functionality for example (either completely or on specific sites), adding URLs to the blocklist and much more. Worse yet: by exposing Kaspersky's internal processing to the web, bugs in this processing code will turn into Remote Code Execution vulnerabilities allowing websites to execute code with the privileges of the SYSTEM user (I haven't explored this possibility further).\n\n**Environment**\n- Scope: Application\n- Product name: Kaspersky Internet Security\n- Product version: 19.0.0.1088\n- OS name and version (incl SP): Windows 10.0.17134\n- Attack type: Command Injection\n- Maximum user privileges needed to reproduce your issue: no privileges\n\n**Steps to reproduce**\n1. Go to Kaspersky settings and make sure that Anti-Banner and Private Browsing features are turned on.\n2. Download the attached `server.py` and `disable_features2.html` to some directory on your computer and run server.py (Python 3 required). This is a very rudimentary HTTPS server running on https://localhost:5000/ with an invalid certificate, you could use some other web server as well.\n3. Edit the file %WINDIR%\\sysnative\\drivers\\etc\\hosts as administrator and add the following line: `127.0.0.1 www.google.example.com`. Normally, you would just use a subdomain of a domain you own and a valid certificate - the host name has to start with \"www.google.\" for Kaspersky's script to be injected there.\n4. Go to https://www.google.example.com:5000/disable_features2.html with Internet Explorer (override warning about invalid certificate).\n5. Check Kaspersky settings and note that Anti-Banner and Private Browsing features are now disabled.\n\n## Impact\n\nWebsites gain full control of Kaspersky's command interface and can disable or manipulate its functionality. They can also attack potential vulnerabilities of the avp.exe process running with elevated privileges.","vulnerability_information_html":"\u003cp\u003e\u003cstrong\u003eSummary\u003c/strong\u003e\u003cbr\u003e\nWhen Kaspersky add-on is installed in Internet Explorer, arbitrary webpages can take control of the Kaspersky command interface and disable parts of the functionality for example.\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eDescription\u003c/strong\u003e\u003cbr\u003e\nUnlike with \u003ca title=\"https://hackerone.com/reports/470544\" href=\"https://hackerone.com/reports/470544\"\u003ehttps://hackerone.com/reports/470544\u003c/a\u003e, when the Kaspersky add-on is installed in Internet Explorer, Kaspersky doesn\u0026#39;t inject its script directly into the webpage, so the webpage cannot re-execute it. However, this script is still running in the same context as the webpage. While provisions have been made to prevent manipulation of some JavaScript objects such as WebSocket, other objects have not received the same treatment. In particular, a website can intercept \u003ccode\u003eString.indexOf()\u003c/code\u003e calls made by Kaspersky\u0026#39;s script and gain access to its namespace this way. As a result, webpages can get full access to Kaspersky\u0026#39;s command interface which allows disabling Anti-Banner and Private Browsing functionality for example (either completely or on specific sites), adding URLs to the blocklist and much more. Worse yet: by exposing Kaspersky\u0026#39;s internal processing to the web, bugs in this processing code will turn into Remote Code Execution vulnerabilities allowing websites to execute code with the privileges of the SYSTEM user (I haven\u0026#39;t explored this possibility further).\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eEnvironment\u003c/strong\u003e\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eScope: Application\u003c/li\u003e\n\u003cli\u003eProduct name: Kaspersky Internet Security\u003c/li\u003e\n\u003cli\u003eProduct version: 19.0.0.1088\u003c/li\u003e\n\u003cli\u003eOS name and version (incl SP): Windows 10.0.17134\u003c/li\u003e\n\u003cli\u003eAttack type: Command Injection\u003c/li\u003e\n\u003cli\u003eMaximum user privileges needed to reproduce your issue: no privileges\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003e\u003cstrong\u003eSteps to reproduce\u003c/strong\u003e\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eGo to Kaspersky settings and make sure that Anti-Banner and Private Browsing features are turned on.\u003c/li\u003e\n\u003cli\u003eDownload the attached \u003ccode\u003eserver.py\u003c/code\u003e and \u003ccode\u003edisable_features2.html\u003c/code\u003e to some directory on your computer and run server.py (Python 3 required). This is a very rudimentary HTTPS server running on \u003ca title=\"https://localhost:5000/\" href=\"/redirect?url=https%3A%2F%2Flocalhost%3A5000%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://localhost:5000/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e with an invalid certificate, you could use some other web server as well.\u003c/li\u003e\n\u003cli\u003eEdit the file %WINDIR%\\sysnative\\drivers\\etc\\hosts as administrator and add the following line: \u003ccode\u003e127.0.0.1 www.google.example.com\u003c/code\u003e. Normally, you would just use a subdomain of a domain you own and a valid certificate - the host name has to start with \u0026quot;\u003ca href=\"/redirect?url=http%3A%2F%2Fwww.google\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ewww.google.\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u0026quot; for Kaspersky\u0026#39;s script to be injected there.\u003c/li\u003e\n\u003cli\u003eGo to \u003ca title=\"https://www.google.example.com:5000/disable_features2.html\" href=\"/redirect?url=https%3A%2F%2Fwww.google.example.com%3A5000%2Fdisable_features2.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.google.example.com:5000/disable_features2.html\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e with Internet Explorer (override warning about invalid certificate).\u003c/li\u003e\n\u003cli\u003eCheck Kaspersky settings and note that Anti-Banner and Private Browsing features are now disabled.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eWebsites gain full control of Kaspersky\u0026#39;s command interface and can disable or manipulate its functionality. They can also attack potential vulnerabilities of the avp.exe process running with elevated privileges.\u003c/p\u003e\n","bounty_amount":"500.0","formatted_bounty":"$500","weakness":{"id":58,"name":"Command Injection - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2019-11-24T08:58:21.604Z","allow_singular_disclosure_after":-34635862.98994588,"singular_disclosure_allowed":true,"vote_count":21,"voters":["dyuen","n1m0","m4v3r1ck-","mashoud1122","sameerphad72","mygf","what_web","exception","t3chn0phil3","cryptographer","and 11 more..."],"severity":{"rating":"medium","author_type":"Team"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":3875899,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"In step 2 above it should say `ssl_server.py` rather than `server.py`.","markdown_message":"\u003cp\u003eIn step 2 above it should say \u003ccode\u003essl_server.py\u003c/code\u003e rather than \u003ccode\u003eserver.py\u003c/code\u003e.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-12-21T11:06:25.442Z","updated_at":"2018-12-21T11:06:25.442Z","actor":{"username":"palant","cleared":false,"url":"/palant","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/125/397/69a28ca9d5030b1db03411852407732328b571c3_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"kaspersky","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3883819,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2018-12-23T12:28:52.457Z","updated_at":"2018-12-23T12:28:52.457Z","actor":{"username":"artem_baranov","cleared":false,"url":"/artem_baranov","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/257/241/2e90c2393e57c257791b2e8deb7c0a43607a1315_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"kaspersky","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3883838,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Yep it works as well. Just a small note that your https server works with usual https port (443), not 5000 as you've mentioned in the URL above.","markdown_message":"\u003cp\u003eYep it works as well. Just a small note that your https server works with usual https port (443), not 5000 as you\u0026#39;ve mentioned in the URL above.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-12-23T12:37:22.707Z","updated_at":"2018-12-23T12:37:22.707Z","actor":{"username":"artem_baranov","cleared":false,"url":"/artem_baranov","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/257/241/2e90c2393e57c257791b2e8deb7c0a43607a1315_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"kaspersky","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3883869,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Sorry about that, you are correct. I normally run the server with `ssl_server.py \u003cip\u003e 5000`, I forgot that the default is running on port 443.","markdown_message":"\u003cp\u003eSorry about that, you are correct. I normally run the server with \u003ccode\u003essl_server.py \u0026lt;ip\u0026gt; 5000\u003c/code\u003e, I forgot that the default is running on port 443.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-12-23T12:51:20.291Z","updated_at":"2018-12-23T12:51:20.291Z","actor":{"username":"palant","cleared":false,"url":"/palant","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/125/397/69a28ca9d5030b1db03411852407732328b571c3_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"kaspersky","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3886664,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"The vulnerability will be fixed and we are planning a specific dates when the fix will be available. You will be rewarded for this report.","markdown_message":"\u003cp\u003eThe vulnerability will be fixed and we are planning a specific dates when the fix will be available. You will be rewarded for this report.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-12-24T14:56:39.822Z","updated_at":"2018-12-24T14:56:39.822Z","actor":{"username":"artem_baranov","cleared":false,"url":"/artem_baranov","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/257/241/2e90c2393e57c257791b2e8deb7c0a43607a1315_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"kaspersky","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3922173,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Dear mr. Palant, \nWe would like to thank you for this report. Your help is appreciated for us.\nYour research and your reports will allow to make our products better.\nWe have decided to award you a bounty for your contribution to kaspersky labs product security.\nThank you.","markdown_message":"\u003cp\u003eDear mr. Palant, \u003cbr\u003e\nWe would like to thank you for this report. Your help is appreciated for us.\u003cbr\u003e\nYour research and your reports will allow to make our products better.\u003cbr\u003e\nWe have decided to award you a bounty for your contribution to kaspersky labs product security.\u003cbr\u003e\nThank you.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-01-03T22:23:21.135Z","updated_at":"2019-01-03T22:23:21.135Z","actor":{"url":"/kaspersky","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/379/d7dc3ce53a84816885872fb423816bfbbbd36390_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Kaspersky"}},"bounty_amount":"500.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"kaspersky","collaborator":{"username":"palant","url":"/palant"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4540642,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2019-04-11T16:03:06.030Z","updated_at":"2019-04-11T16:03:06.030Z","additional_data":{"old_severity":"High","new_severity":"Medium","old_severity_id":270301,"new_severity_id":344438},"actor":{"username":"artem_baranov","cleared":false,"url":"/artem_baranov","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/257/241/2e90c2393e57c257791b2e8deb7c0a43607a1315_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"kaspersky","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5455515,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"KIS 2020 has been released, you can check out the fix. \n\nhttps://www.kaspersky.com/internet-security","markdown_message":"\u003cp\u003eKIS 2020 has been released, you can check out the fix. \u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"https://www.kaspersky.com/internet-security\" href=\"/redirect?url=https%3A%2F%2Fwww.kaspersky.com%2Finternet-security\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.kaspersky.com/internet-security\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2019-07-29T16:58:49.644Z","updated_at":"2019-07-29T16:58:49.644Z","actor":{"username":"artem_baranov","cleared":false,"url":"/artem_baranov","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/257/241/2e90c2393e57c257791b2e8deb7c0a43607a1315_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"palant","url":"/palant"},"genius_execution_id":null,"team_handle":"kaspersky","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5455807,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-07-29T17:52:07.933Z","updated_at":"2019-07-29T17:52:07.933Z","first_to_agree":true,"actor":{"username":"palant","cleared":false,"url":"/palant","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/125/397/69a28ca9d5030b1db03411852407732328b571c3_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"kaspersky","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5502154,"is_internal":false,"editable":false,"type":"Activities::CancelledDisclosureRequest","message":"Hi Wladimir.\n\nWe can't allow you to disclose this report, because users of earlier versions of the product are still vulnerable.","markdown_message":"\u003cp\u003eHi Wladimir.\u003c/p\u003e\n\n\u003cp\u003eWe can\u0026#39;t allow you to disclose this report, because users of earlier versions of the product are still vulnerable.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-08-05T12:16:02.129Z","updated_at":"2019-08-05T12:16:02.129Z","actor":{"username":"artem_baranov","cleared":false,"url":"/artem_baranov","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/257/241/2e90c2393e57c257791b2e8deb7c0a43607a1315_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"kaspersky","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5502251,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"So, what is your idea of an alternative disclosure timeline? \"Never\" definitely isn't going to work for me.\n\nIt was your decision that this issue and similar ones weren't important to fix for users of earlier versions. You cannot claim now that the issue is somehow important and use that justification to prevent disclosure.\n\nBesides, the program brief says:\n\n\u003e Keep details of any discovered vulnerabilities confidential until they are fixed\n\nAs the vulnerabilities are fixed, there is no reason why I shouldn't be writing about them - even if these reports aren't disclosed.","markdown_message":"\u003cp\u003eSo, what is your idea of an alternative disclosure timeline? \u0026quot;Never\u0026quot; definitely isn\u0026#39;t going to work for me.\u003c/p\u003e\n\n\u003cp\u003eIt was your decision that this issue and similar ones weren\u0026#39;t important to fix for users of earlier versions. You cannot claim now that the issue is somehow important and use that justification to prevent disclosure.\u003c/p\u003e\n\n\u003cp\u003eBesides, the program brief says:\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eKeep details of any discovered vulnerabilities confidential until they are fixed\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eAs the vulnerabilities are fixed, there is no reason why I shouldn\u0026#39;t be writing about them - even if these reports aren\u0026#39;t disclosed.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-08-05T12:33:41.480Z","updated_at":"2019-08-05T12:34:31.677Z","actor":{"username":"palant","cleared":false,"url":"/palant","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/125/397/69a28ca9d5030b1db03411852407732328b571c3_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"kaspersky","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5502324,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Yep, \"until they are fixed\", they aren't fixed in earlier product versions and we recommend you don't disclose any information about these vulnerabilities ( #470553, #470544, #470519). If this isn't comfortable to you, we can just re-open these tickets.","markdown_message":"\u003cp\u003eYep, \u0026quot;until they are fixed\u0026quot;, they aren\u0026#39;t fixed in earlier product versions and we recommend you don\u0026#39;t disclose any information about these vulnerabilities ( \u003ca href=\"/reports/470553\"\u003e#470553\u003c/a\u003e, \u003ca href=\"/reports/470544\"\u003e#470544\u003c/a\u003e, \u003ca href=\"/reports/470519\"\u003e#470519\u003c/a\u003e). If this isn\u0026#39;t comfortable to you, we can just re-open these tickets.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-08-05T12:45:21.663Z","updated_at":"2019-08-05T12:46:01.730Z","actor":{"username":"artem_baranov","cleared":false,"url":"/artem_baranov","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/257/241/2e90c2393e57c257791b2e8deb7c0a43607a1315_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"kaspersky","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5502353,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Are you working on a fix for these older versions? Is there a timeline?","markdown_message":"\u003cp\u003eAre you working on a fix for these older versions? Is there a timeline?\u003c/p\u003e\n","automated_response":false,"created_at":"2019-08-05T12:47:23.792Z","updated_at":"2019-08-05T12:47:23.792Z","actor":{"username":"palant","cleared":false,"url":"/palant","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/125/397/69a28ca9d5030b1db03411852407732328b571c3_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"kaspersky","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5504951,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Disclosure for this ticket (along with #470553, #470553, #470544, #470519, #469372) will be allowed after our users got migrated to the newest product release (2020). It will happen around of November this year.","markdown_message":"\u003cp\u003eDisclosure for this ticket (along with \u003ca href=\"/reports/470553\"\u003e#470553\u003c/a\u003e, \u003ca href=\"/reports/470553\"\u003e#470553\u003c/a\u003e, \u003ca href=\"/reports/470544\"\u003e#470544\u003c/a\u003e, \u003ca href=\"/reports/470519\"\u003e#470519\u003c/a\u003e, \u003ca href=\"/reports/469372\"\u003e#469372\u003c/a\u003e) will be allowed after our users got migrated to the newest product release (2020). It will happen around of November this year.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-08-05T16:12:06.411Z","updated_at":"2019-08-05T16:12:06.411Z","actor":{"username":"artem_baranov","cleared":false,"url":"/artem_baranov","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/257/241/2e90c2393e57c257791b2e8deb7c0a43607a1315_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"kaspersky","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5505216,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Our products have auto-update procedure and from our internal statistics we know that most of our users migrate to the newest version of the product in 3-4 months. We care about security of our users and are ready to publish [security advisory] (https://support.kaspersky.com/general/vulnerability.aspx?el=12430#241218) on our website by the date we coordinate with you. We are ready to start preparing security advisory from now.","markdown_message":"\u003cp\u003eOur products have auto-update procedure and from our internal statistics we know that most of our users migrate to the newest version of the product in 3-4 months. We care about security of our users and are ready to publish \u003ca href=\"/redirect?url=https%3A%2F%2Fsupport.kaspersky.com%2Fgeneral%2Fvulnerability.aspx%3Fel%3D12430%23241218\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003esecurity advisory\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e on our website by the date we coordinate with you. We are ready to start preparing security advisory from now.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-08-05T16:58:25.345Z","updated_at":"2019-08-05T16:58:25.345Z","actor":{"username":"artem_baranov","cleared":false,"url":"/artem_baranov","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/257/241/2e90c2393e57c257791b2e8deb7c0a43607a1315_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"kaspersky","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5508959,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Ok, I don't want to be unreasonable even though I consider this timeline rather extreme. Let's go for a compromise: disclose #463695, #461780, #463915 within two weeks (2019-08-19). Given that all of these have been fixed in April, these has been plenty of time for user migration. Also, similarities with any other issues are irrelevant given that these are also resolved already. So I will write about these three issues only.\n\nFor the five remaining issues we can set a disclosure date in November.","markdown_message":"\u003cp\u003eOk, I don\u0026#39;t want to be unreasonable even though I consider this timeline rather extreme. Let\u0026#39;s go for a compromise: disclose \u003ca href=\"/reports/463695\"\u003e#463695\u003c/a\u003e, \u003ca href=\"/reports/461780\"\u003e#461780\u003c/a\u003e, \u003ca href=\"/reports/463915\"\u003e#463915\u003c/a\u003e within two weeks (2019-08-19). Given that all of these have been fixed in April, these has been plenty of time for user migration. Also, similarities with any other issues are irrelevant given that these are also resolved already. So I will write about these three issues only.\u003c/p\u003e\n\n\u003cp\u003eFor the five remaining issues we can set a disclosure date in November.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-08-06T07:27:55.447Z","updated_at":"2019-08-06T07:27:55.447Z","actor":{"username":"palant","cleared":false,"url":"/palant","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/125/397/69a28ca9d5030b1db03411852407732328b571c3_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"kaspersky","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5559027,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Probably this time frame will be extended for mentioned reports up to Thursday next week (22 Aug), because we may need more time to prepare a security advisory and PR related stuff.","markdown_message":"\u003cp\u003eProbably this time frame will be extended for mentioned reports up to Thursday next week (22 Aug), because we may need more time to prepare a security advisory and PR related stuff.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-08-12T20:37:05.380Z","updated_at":"2019-08-12T20:37:05.380Z","actor":{"username":"artem_baranov","cleared":false,"url":"/artem_baranov","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/257/241/2e90c2393e57c257791b2e8deb7c0a43607a1315_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"kaspersky","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5559079,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Sorry, it's a Monday on purpose. I also still need to prepare a blog post, and I have to cover three vulnerabilities (supposedly, you don't care about two of those). I really don't see how something you patched four months ago needs that much preparation time.","markdown_message":"\u003cp\u003eSorry, it\u0026#39;s a Monday on purpose. I also still need to prepare a blog post, and I have to cover three vulnerabilities (supposedly, you don\u0026#39;t care about two of those). I really don\u0026#39;t see how something you patched four months ago needs that much preparation time.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-08-12T20:43:28.701Z","updated_at":"2019-08-12T20:43:28.701Z","actor":{"username":"palant","cleared":false,"url":"/palant","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/125/397/69a28ca9d5030b1db03411852407732328b571c3_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"kaspersky","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5562546,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"We are preparing a security advisory that covers your three mentioned reports we've discussed above. We haven't approved your time frame, because as I wrote above, probably, we may need more time to preparation for your disclosure.","markdown_message":"\u003cp\u003eWe are preparing a security advisory that covers your three mentioned reports we\u0026#39;ve discussed above. We haven\u0026#39;t approved your time frame, because as I wrote above, probably, we may need more time to preparation for your disclosure.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-08-13T09:15:50.668Z","updated_at":"2019-08-13T09:15:50.668Z","actor":{"username":"artem_baranov","cleared":false,"url":"/artem_baranov","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/257/241/2e90c2393e57c257791b2e8deb7c0a43607a1315_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"kaspersky","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5562847,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I know, but I don't think that I need your approval on this.\n\nSide-note: IMHO \"security advisory\" would be something you publish to let users know that they are at risk and need to update. This is something you would publish when fixing security relevant issues, regardless of when or whether the details will be disclosed. The other thing is called \"company PR.\"","markdown_message":"\u003cp\u003eI know, but I don\u0026#39;t think that I need your approval on this.\u003c/p\u003e\n\n\u003cp\u003eSide-note: IMHO \u0026quot;security advisory\u0026quot; would be something you publish to let users know that they are at risk and need to update. This is something you would publish when fixing security relevant issues, regardless of when or whether the details will be disclosed. The other thing is called \u0026quot;company PR.\u0026quot;\u003c/p\u003e\n","automated_response":false,"created_at":"2019-08-13T09:35:17.418Z","updated_at":"2019-08-13T09:35:17.418Z","actor":{"username":"palant","cleared":false,"url":"/palant","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/125/397/69a28ca9d5030b1db03411852407732328b571c3_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"kaspersky","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5563078,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"According to HackerOne' disclosure policy and tickets processing workflow, you can't disclose information about the vulnerabilities until it has been approved from our side.","markdown_message":"\u003cp\u003eAccording to HackerOne\u0026#39; disclosure policy and tickets processing workflow, you can\u0026#39;t disclose information about the vulnerabilities until it has been approved from our side.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-08-13T10:15:50.191Z","updated_at":"2019-08-13T10:15:50.191Z","actor":{"username":"artem_baranov","cleared":false,"url":"/artem_baranov","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/257/241/2e90c2393e57c257791b2e8deb7c0a43607a1315_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"kaspersky","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5563122,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Once again, the program brief says:\n\n\u003e Keep details of any discovered vulnerabilities confidential until they are fixed\n\nAll of them have been fixed back in April (not that the two vulnerabilities matter which weren't recognized as as such). And even the argument \"but users are still updating\" doesn't apply here given how much time elapsed already.","markdown_message":"\u003cp\u003eOnce again, the program brief says:\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eKeep details of any discovered vulnerabilities confidential until they are fixed\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eAll of them have been fixed back in April (not that the two vulnerabilities matter which weren\u0026#39;t recognized as as such). And even the argument \u0026quot;but users are still updating\u0026quot; doesn\u0026#39;t apply here given how much time elapsed already.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-08-13T10:25:04.379Z","updated_at":"2019-08-13T10:25:04.379Z","actor":{"username":"palant","cleared":false,"url":"/palant","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/125/397/69a28ca9d5030b1db03411852407732328b571c3_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"kaspersky","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5563283,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"There is a procedure for requesting disclosure, without our approval disclosure isn't possible. It also can be refused or restricted (so called Partial disclosure) for some reasons.","markdown_message":"\u003cp\u003eThere is a procedure for requesting disclosure, without our approval disclosure isn\u0026#39;t possible. It also can be refused or restricted (so called Partial disclosure) for some reasons.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-08-13T11:03:14.104Z","updated_at":"2019-08-13T11:03:14.104Z","actor":{"username":"artem_baranov","cleared":false,"url":"/artem_baranov","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/257/241/2e90c2393e57c257791b2e8deb7c0a43607a1315_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"kaspersky","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5583459,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Just to make sure there is no misunderstanding: the article is finished and will be published on 2019-08-19.","markdown_message":"\u003cp\u003eJust to make sure there is no misunderstanding: the article is finished and will be published on 2019-08-19.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-08-15T12:00:22.155Z","updated_at":"2019-08-15T12:00:22.155Z","actor":{"username":"palant","cleared":false,"url":"/palant","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/125/397/69a28ca9d5030b1db03411852407732328b571c3_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"kaspersky","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5607101,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"There is no definitive disclosure timeline here, so I'll publish an article on these vulnerabilities on 2019-11-25 along with the three vulnerabilities I just sent to vulnerability@kaspersky.com.","markdown_message":"\u003cp\u003eThere is no definitive disclosure timeline here, so I\u0026#39;ll publish an article on these vulnerabilities on 2019-11-25 along with the three vulnerabilities I just sent to \u003ca title=\"vulnerability@kaspersky.com\" href=\"mailto:vulnerability@kaspersky.com\" rel=\"nofollow noopener noreferrer\"\u003evulnerability@kaspersky.com\u003c/a\u003e.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-08-19T13:21:08.345Z","updated_at":"2019-08-19T13:21:08.345Z","actor":{"username":"palant","cleared":false,"url":"/palant","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/125/397/69a28ca9d5030b1db03411852407732328b571c3_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"kaspersky","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6133355,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Requesting disclosure as I will be publishing an article on this vulnerability on 2019-11-25.","markdown_message":"\u003cp\u003eRequesting disclosure as I will be publishing an article on this vulnerability on 2019-11-25.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-10-25T08:58:21.554Z","updated_at":"2019-10-25T08:58:21.554Z","first_to_agree":true,"actor":{"username":"palant","cleared":false,"url":"/palant","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/125/397/69a28ca9d5030b1db03411852407732328b571c3_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"kaspersky","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6389170,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-11-24T08:58:24.502Z","updated_at":"2019-11-24T08:58:24.502Z","actor":{"url":"/kaspersky","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/379/d7dc3ce53a84816885872fb423816bfbbbd36390_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Kaspersky"}},"genius_execution_id":null,"team_handle":"kaspersky","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6398046,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"https://support.kaspersky.com/general/vulnerability.aspx?el=12430#251119_1","markdown_message":"\u003cp\u003e\u003ca title=\"https://support.kaspersky.com/general/vulnerability.aspx?el=12430#251119_1\" href=\"/redirect?url=https%3A%2F%2Fsupport.kaspersky.com%2Fgeneral%2Fvulnerability.aspx%3Fel%3D12430%23251119_1\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://support.kaspersky.com/general/vulnerability.aspx?el=12430#251119_1\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2019-11-25T12:13:13.519Z","updated_at":"2019-11-25T12:13:13.519Z","actor":{"username":"artem_baranov","cleared":false,"url":"/artem_baranov","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/257/241/2e90c2393e57c257791b2e8deb7c0a43607a1315_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"kaspersky","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6398094,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"https://palant.de/2019/11/25/kaspersky-the-art-of-keeping-your-keys-under-the-door-mat/","markdown_message":"\u003cp\u003e\u003ca title=\"https://palant.de/2019/11/25/kaspersky-the-art-of-keeping-your-keys-under-the-door-mat/\" href=\"/redirect?url=https%3A%2F%2Fpalant.de%2F2019%2F11%2F25%2Fkaspersky-the-art-of-keeping-your-keys-under-the-door-mat%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://palant.de/2019/11/25/kaspersky-the-art-of-keeping-your-keys-under-the-door-mat/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2019-11-25T12:24:06.194Z","updated_at":"2019-11-25T12:24:06.194Z","actor":{"username":"palant","cleared":false,"url":"/palant","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/125/397/69a28ca9d5030b1db03411852407732328b571c3_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"kaspersky","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6398565,"is_internal":false,"editable":false,"type":"Activities::CveIdAdded","message":"","markdown_message":"","automated_response":false,"created_at":"2019-11-25T12:54:38.574Z","updated_at":"2019-11-25T12:54:38.574Z","cve_ids":["CVE-2019-15685"],"actor":{"username":"artem_baranov","cleared":false,"url":"/artem_baranov","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/257/241/2e90c2393e57c257791b2e8deb7c0a43607a1315_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"kaspersky","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6438485,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2019-11-30T17:19:15.748Z","updated_at":"2019-11-30T17:19:15.748Z","additional_data":{"old_title":"[IE browser integration] Websites can hijack Kaspersky's command interface","new_title":"Unauthorized command execution in Web protection component of Anti-Virus products family [IE]"},"actor":{"username":"artem_baranov","cleared":false,"url":"/artem_baranov","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/257/241/2e90c2393e57c257791b2e8deb7c0a43607a1315_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"kaspersky","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}