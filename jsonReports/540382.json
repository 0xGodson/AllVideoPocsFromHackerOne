{"id":540382,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC81NDAzODI=","url":"https://hackerone.com/reports/540382","title":"CSRF allows attacker to manage customer's shopping cart.","state":"Closed","substate":"duplicate","readable_substate":"Duplicate","created_at":"2019-04-16T17:04:51.597Z","submitted_at":"2019-04-16T17:04:51.597Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"flamingo","url":"/flamingo","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/XVJPXmZHA69MoH4vjeECDASz/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":39424,"url":"https://hackerone.com/tomtom","handle":"tomtom","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/039/424/007e488fb83dfcd5086bd2c42897c19cb20a4025_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/039/424/007e488fb83dfcd5086bd2c42897c19cb20a4025_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"TomTom","twitter_handle":"tomtom","website":"https://tomtom.com/","about":"TomTom is shaping the future, leading the way with autonomous driving, smart mobility and smarter cities."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2019-06-13T23:02:13.745Z","bug_reporter_agreed_on_going_public_at":"2019-04-17T08:08:49.414Z","team_member_agreed_on_going_public_at":"2019-06-13T23:02:13.612Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"The following endpoint https://www.tomtom.com:443/en_us/store/basket-add.html had no CSRF checks / tokens .. whatsoever , which allows a malicious user add massive amounts of a any product to a victim's cart or empty the cart.\n\nthe CSRF POC file  included adds 50 items of the giving product the a victim's cart , and the quantity can be changed to any number , or to 0 to empty the cart .\nalso the script can be modified to require no interraction from the victim .\n\n## Impact\n\n- A customer can proceed shopping without noticing that other items has been added to his cart .\n- A customer might lose all his items previously added to cart , which is frustrating.","vulnerability_information_html":"\u003cp\u003eThe following endpoint \u003ca title=\"https://www.tomtom.com/en_us/store/basket-add.html\" href=\"/redirect?url=https%3A%2F%2Fwww.tomtom.com%2Fen_us%2Fstore%2Fbasket-add.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.tomtom.com/en_us/store/basket-add.html\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e had no CSRF checks / tokens .. whatsoever , which allows a malicious user add massive amounts of a any product to a victim\u0026#39;s cart or empty the cart.\u003c/p\u003e\n\n\u003cp\u003ethe CSRF POC file  included adds 50 items of the giving product the a victim\u0026#39;s cart , and the quantity can be changed to any number , or to 0 to empty the cart .\u003cbr\u003e\nalso the script can be modified to require no interraction from the victim .\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cul\u003e\n\u003cli\u003eA customer can proceed shopping without noticing that other items has been added to his cart .\u003c/li\u003e\n\u003cli\u003eA customer might lose all his items previously added to cart , which is frustrating.\u003c/li\u003e\n\u003c/ul\u003e\n","weakness":{"id":45,"name":"Cross-Site Request Forgery (CSRF)"},"original_report_id":540281,"original_report_url":"https://hackerone.com/reports/540281","attachments":[{"id":470161,"file_name":"POC.html","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/470/161/09fdd9449918c163879204c2afd77d5f98eaebad/POC.html?response-content-disposition=attachment%3B%20filename%3D%22POC.html%22%3B%20filename%2A%3DUTF-8%27%27POC.html\u0026response-content-type=application%2Foctet-stream\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQWS7SVX5C%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T061625Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCICTltBX5kZS78yzw3IUUt%2Fa035OzgQ2vLu8U1ZxOKGilAiEAqT8jxmclsgLwaEL5fi7C70iqLwP7J3SWF5ypfn%2Fn%2BdUqtAMIVBABGgwwMTM2MTkyNzQ4NDkiDGRWkSc4Hmgq8mMXKCqRA0Pq%2Bzgh6dptjyRB4GzYO9sir45RVm0RyvFSB8lDBYTBiDIVL0nR3Ah5epkHqGDZZEh0G%2BfKYu%2FWpfgxJl7qllLzKg%2BOA0izVs9KPgQdxk0VWwW%2FPKL2ZT4v%2FSNRvF7rPUbZ7WhGTZqx0%2BinzKM%2BO6lDyXZKNKMzhjRnIFdI7Th01c4ma39imTXQDmxc%2FNzHFK40lrkAbTZoTlcq%2BsnIcIRSB0h4GHasXhR5OHx8rifULR7sVKHDcZMCzSYjrtagaKs9I81LEzlSbEGxIQar2MK%2BZBwmpT57aT%2F1nIOoa%2FlH5nfP4Ihcv4Mqfp19pFx8mlVoMe%2FTEx0pqNuC4lGQXowSDJKBcSjrYM6ouddZWfwY6R4O8X69XqZawGSrmBiXyAVG%2BDj895xbDJhiOXMvqkvSfsEzIfvcaHAzshzNZjFT3yiN4h81wfUF3QuLc6DHCTt1MPDYiUB8I7UCQ8wJxW4pg3xTnHqSwUeqww3YY8RFfsgvfp9PzGJ1s4vReFrzuzYVanpT22oz4w33z29yMPmMMO21qv8FOusBOsYr4rmEPt9wYTc2WNI63vM9u2VUhGNHafH2%2Fh3q6i%2BwJ0u2HLCQd44aqHfWZ%2Bc8hzInEQnRNrZf7owYuE4cHiraWaOsNJjfOEJBZu5nzzun4JSk7801NfOqa1zcgLMWOwyWJCtalb9fGn6qhwTWTBMzsOFHc661yyW%2FaqejCIRf6%2BwNOGhO8kc%2BEhEIq0iydp5k4rlMRKlFJPFlphrQYGeZgYr9TM%2FVgHlN%2Bx4Oxtcg1UwCGXMGiV%2BqXzeMEmO%2FdxKETdJJvF%2BEaJSsF0r1i7s8g61czrgyi9MKMpia%2Fg6ovVFkrvHOejV96g%3D%3D\u0026X-Amz-Signature=cb52058cb08098d6287adf504330d6f1f9a12a69665b5289e259175cef09cbdf","file_size":1832,"type":"text/html"}],"allow_singular_disclosure_at":null,"vote_count":1,"voters":["flamingo"],"structured_scope":{"databaseId":24133,"asset_type":"URL","asset_identifier":"*.tomtom.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":4577123,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @abzi, \n\nThank you for the report! Unfortunately, we need a little more information from you before we can fully validate this report. \nPlease provide a detailed proof of concept that includes the following:\n* How to find the vulnerable functionality\n* Steps to reproduce the issue\n\nProviding this information when submitting new reports will help us to quickly determine the validity of your report. Thank you for your help!\n\nRegards, \n@sodacan","markdown_message":"\u003cp\u003eHi \u003ca href=\"/abzi\"\u003e@abzi\u003c/a\u003e, \u003c/p\u003e\n\n\u003cp\u003eThank you for the report! Unfortunately, we need a little more information from you before we can fully validate this report. \u003cbr\u003e\nPlease provide a detailed proof of concept that includes the following:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eHow to find the vulnerable functionality\u003c/li\u003e\n\u003cli\u003eSteps to reproduce the issue\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eProviding this information when submitting new reports will help us to quickly determine the validity of your report. Thank you for your help!\u003c/p\u003e\n\n\u003cp\u003eRegards, \u003cbr\u003e\n\u003ca href=\"/sodacan\"\u003e@sodacan\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2019-04-16T17:51:29.342Z","updated_at":"2019-04-16T17:51:29.342Z","actor":{"username":"sodacan","cleared":false,"url":"/sodacan","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/397/342/f09b69d30e08f05bbd6f12bf02200844bdf46f11_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"tomtom","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":4577209,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Steps to reproduce :\n- choose any product and click \" Buy Now \" , and while burp intercepter is on , click on \" Add to cart \"\n- go to the intercepted request in burp , and if you are logged in , remove this parameter 'logged_in_user=' intirely .\n- send the request to burp CSRF POC creator ( a burp plugin )\n- add this line to the POC : \u003cinput type=\"text\" name=\"quantity\" value=\"50\"\u003e , and save it as html.\n","markdown_message":"\u003cp\u003eSteps to reproduce :\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003echoose any product and click \u0026quot; Buy Now \u0026quot; , and while burp intercepter is on , click on \u0026quot; Add to cart \u0026quot;\u003c/li\u003e\n\u003cli\u003ego to the intercepted request in burp , and if you are logged in , remove this parameter \u0026#39;logged_in_user=\u0026#39; intirely .\u003c/li\u003e\n\u003cli\u003esend the request to burp CSRF POC creator ( a burp plugin )\u003c/li\u003e\n\u003cli\u003eadd this line to the POC : \u0026lt;input type=\u0026quot;text\u0026quot; name=\u0026quot;quantity\u0026quot; value=\u0026quot;50\u0026quot;\u0026gt; , and save it as html.\u003c/li\u003e\n\u003c/ul\u003e\n","automated_response":false,"created_at":"2019-04-16T18:10:09.544Z","updated_at":"2019-04-16T18:12:31.215Z","actor":{"username":"flamingo","cleared":false,"url":"/flamingo","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/XVJPXmZHA69MoH4vjeECDASz/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"tomtom","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4581151,"is_internal":false,"editable":false,"type":"Activities::BugDuplicate","message":"Hi @abzi,\n\nThanks for the report. Unfortunately this was submitted previously by another tester, but we appreciate your work and look forward to additional reports from you.\n\nGood Luck!\n@lasagna ","markdown_message":"\u003cp\u003eHi \u003ca href=\"/abzi\"\u003e@abzi\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThanks for the report. Unfortunately this was submitted previously by another tester, but we appreciate your work and look forward to additional reports from you.\u003c/p\u003e\n\n\u003cp\u003eGood Luck!\u003cbr\u003e\n\u003ca href=\"/lasagna\"\u003e@lasagna\u003c/a\u003e \u003c/p\u003e\n","automated_response":false,"created_at":"2019-04-17T07:47:03.275Z","updated_at":"2019-04-17T07:47:03.275Z","original_report_id":540281,"actor":{"username":"lasagna","cleared":false,"url":"/lasagna","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/400/990/cfa7194b276688d13e7062cf5b49e5adb1ae2501_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"tomtom","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":4581271,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-04-17T08:08:49.436Z","updated_at":"2019-04-17T08:08:49.436Z","first_to_agree":true,"actor":{"username":"flamingo","cleared":false,"url":"/flamingo","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/XVJPXmZHA69MoH4vjeECDASz/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"tomtom","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5086732,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-06-13T23:02:13.673Z","updated_at":"2019-06-13T23:02:13.673Z","actor":{"username":"mcgivney","cleared":false,"url":"/mcgivney","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"tomtom","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5086733,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-06-13T23:02:13.777Z","updated_at":"2019-06-13T23:02:13.777Z","actor":{"username":"mcgivney","cleared":false,"url":"/mcgivney","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"tomtom","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}