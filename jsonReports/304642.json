{"id":304642,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zMDQ2NDI=","url":"https://hackerone.com/reports/304642","title":"Administrators can add other administrators","state":"Closed","substate":"informative","severity_rating":"none","readable_substate":"Informative","created_at":"2018-01-14T00:09:14.760Z","submitted_at":"2018-01-14T00:09:14.760Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"gamliel","url":"/gamliel","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/097/323/a67a70073a81ab1b70763a8faaba57d5c6fa751b_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":60,"url":"https://hackerone.com/concrete5","handle":"concrete5","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/060/c549a89ab4a3550cb9bfdeba1bee6d77e2019c7e_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/060/c549a89ab4a3550cb9bfdeba1bee6d77e2019c7e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"concrete5","twitter_handle":"concrete5","website":"https://www.concrete5.org","about":"A simple and powerful content management system."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2020-05-11T18:32:29.634Z","bug_reporter_agreed_on_going_public_at":"2018-08-02T05:56:03.903Z","team_member_agreed_on_going_public_at":"2020-05-11T18:32:29.566Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Because I know you like crayons here's a token of my appreciation... **:D** {F253771}\n\nConcrete5 version: **8.3.1**\nRelease date: **12/20/17**\nWhere: **Core CMS**\n\n###Vulnerability: Privilege Escalation **(OTG-AUTHZ-003)**\nPrivilege escalation occurs when a user gets to access more resources than is normally allowed when it should have been protected from the application.\n\n**Vertical escalation:** Occurs when the attacker get access to accounts with high level privileges.\n**Horizontal escalation:** Occurs when the attacker get access to other accounts with same privileges level.\n\nVertical escalation is not possible, let's say that Admin user is safe. With the Admin user created other users and some of them were added to Administrators group. I opened other window browser in private mode and logged as **admin2** user (This user was added to administrators group).\nAs **admin2** user went to `Dashboard -\u003e Members -\u003e Search Users` and clicked on a link corresponding to other user (user **admin3**) with administrator privileges and I'm able to do actions that can lead to takeover other administrator accounts.\n\n## Impact\n\n**High**. A disgruntled user with Administration privileges can change password, email, username, deactivate account or delete other users in the Administrators group. It happens because an user in the Administrators group can create users and add them to his same level group.\n\nRecommendations\n============\nOnly **Admin** must be able to add or make changes to users in the **Administrators** group.\n\nKind regards,\n**Gamliel Hernadez.**","vulnerability_information_html":"\u003cp\u003eBecause I know you like crayons here\u0026#39;s a token of my appreciation... \u003cstrong\u003e:D\u003c/strong\u003e \u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"crayons.jpg\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/253/771/1e17650c169127aca2cd44ee8c014c04aa55347f/crayons.jpg?response-content-disposition=attachment%3B%20filename%3D%22crayons.jpg%22%3B%20filename%2A%3DUTF-8%27%27crayons.jpg\u0026amp;response-content-type=image%2Fjpeg\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQ3MMGRP5H%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T053012Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCICEZ9R%2B2RJ3GrTP6l%2FPAFADJG1t55InVtXNQpLfOPgHaAiEA9vebVe9XdCpFDuGnxxWe2Ve48e%2FtAoig8YYxqZ7es78qtAMIUhABGgwwMTM2MTkyNzQ4NDkiDH6RMqd3Km1HzDzcXiqRAw9Zi9Zyah%2FL7m5qi9w2XsNDr%2F5ZZ%2F5Gny1bCMAgWHuEH9Lmtzfddi67Q3u82zHSnheCFLE%2BUTr6KCbyVouh2s6I1Iw5FpZ4LCl2Jts%2FOYIW3f51kFQhZ3sOfoeJ95jG2hfROCEhzpnA30iPS6xMNw87KO9Qo4x%2FBM37CIhv4A0%2FSU0JbwvczB01wva%2FQJkiH6lH1ZVS3EG6yUh%2Feq8kDGf%2FnGRgLcxw3MK7jT4GG1knwEEDIQOAuumsmWt3QDUH6dFWYx57C2QS76Xr1I1ub7Ob050enItoD3hnXR1F2lhC9JZWyDDS3sRTHvPx0voGVfuM803u8XTKLOZxTNSBY1S8m7RRU55us25%2BTyEe9Q6J6l3ZXKJZ8Jv02FW7RtNRHdPm0L6O0I3vOQbn8GiBG%2FkhDZRW3AOAiJuB4Bhd6Ns7j3YXA9nKlctO1uYmAj%2B6nssjBtl1lKabSm0eGuk7Feh%2B9jG%2BgpNFzxS0iYgysVfwkvplnvmKgReLAD4JvjZ9sdbv66UX5MyW9gDVXf0wfna3MN2Fqv8FOusBFyKfufPYQYGFwO4tvl1lihdDkLnCZcRwmXrB0gYZzbAneLC1UJ9NimBCebx3LEek%2BJ0J1MdqCNRGrLEY92gh38wj7A61ZNLFh9KTVAiyEFWLju0gH5kr3ndnXguXCxD19p54ZTSuYzlTQ9ArEyfvPBo%2F%2BWy25KkCTRlm376pduEzwhG4%2FgpY13ZbeNcDXcGVf2lvpy33oGJqXFcfCgWJYbDCm0M%2FBGBrkOhnizXl7hE2kfO2aQgP2N8b5LucE1O2Tl%2B%2B7ABCWc7Sl7RPhipBfTbyd%2FEfgt9ObkPFxAc0xnS36iwoGt1oKkhotg%3D%3D\u0026amp;X-Amz-Signature=09742b6360679d39233dd65fb709a0740e6b3d7452fdacec33d5871aa61e1d84\" data-attachment-type=\"image/jpeg\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/253/771/1e17650c169127aca2cd44ee8c014c04aa55347f/crayons.jpg?response-content-disposition=attachment%3B%20filename%3D%22crayons.jpg%22%3B%20filename%2A%3DUTF-8%27%27crayons.jpg\u0026amp;response-content-type=image%2Fjpeg\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQ3MMGRP5H%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T053012Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCICEZ9R%2B2RJ3GrTP6l%2FPAFADJG1t55InVtXNQpLfOPgHaAiEA9vebVe9XdCpFDuGnxxWe2Ve48e%2FtAoig8YYxqZ7es78qtAMIUhABGgwwMTM2MTkyNzQ4NDkiDH6RMqd3Km1HzDzcXiqRAw9Zi9Zyah%2FL7m5qi9w2XsNDr%2F5ZZ%2F5Gny1bCMAgWHuEH9Lmtzfddi67Q3u82zHSnheCFLE%2BUTr6KCbyVouh2s6I1Iw5FpZ4LCl2Jts%2FOYIW3f51kFQhZ3sOfoeJ95jG2hfROCEhzpnA30iPS6xMNw87KO9Qo4x%2FBM37CIhv4A0%2FSU0JbwvczB01wva%2FQJkiH6lH1ZVS3EG6yUh%2Feq8kDGf%2FnGRgLcxw3MK7jT4GG1knwEEDIQOAuumsmWt3QDUH6dFWYx57C2QS76Xr1I1ub7Ob050enItoD3hnXR1F2lhC9JZWyDDS3sRTHvPx0voGVfuM803u8XTKLOZxTNSBY1S8m7RRU55us25%2BTyEe9Q6J6l3ZXKJZ8Jv02FW7RtNRHdPm0L6O0I3vOQbn8GiBG%2FkhDZRW3AOAiJuB4Bhd6Ns7j3YXA9nKlctO1uYmAj%2B6nssjBtl1lKabSm0eGuk7Feh%2B9jG%2BgpNFzxS0iYgysVfwkvplnvmKgReLAD4JvjZ9sdbv66UX5MyW9gDVXf0wfna3MN2Fqv8FOusBFyKfufPYQYGFwO4tvl1lihdDkLnCZcRwmXrB0gYZzbAneLC1UJ9NimBCebx3LEek%2BJ0J1MdqCNRGrLEY92gh38wj7A61ZNLFh9KTVAiyEFWLju0gH5kr3ndnXguXCxD19p54ZTSuYzlTQ9ArEyfvPBo%2F%2BWy25KkCTRlm376pduEzwhG4%2FgpY13ZbeNcDXcGVf2lvpy33oGJqXFcfCgWJYbDCm0M%2FBGBrkOhnizXl7hE2kfO2aQgP2N8b5LucE1O2Tl%2B%2B7ABCWc7Sl7RPhipBfTbyd%2FEfgt9ObkPFxAc0xnS36iwoGt1oKkhotg%3D%3D\u0026amp;X-Amz-Signature=09742b6360679d39233dd65fb709a0740e6b3d7452fdacec33d5871aa61e1d84\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eConcrete5 version: \u003cstrong\u003e8.3.1\u003c/strong\u003e\u003cbr\u003e\nRelease date: \u003cstrong\u003e12/20/17\u003c/strong\u003e\u003cbr\u003e\nWhere: \u003cstrong\u003eCore CMS\u003c/strong\u003e\u003c/p\u003e\n\n\u003ch3 id=\"vulnerability-privilege-escalation-otg-authz-003\"\u003eVulnerability: Privilege Escalation \u003cstrong\u003e(OTG-AUTHZ-003)\u003c/strong\u003e\n\u003c/h3\u003e\n\n\u003cp\u003ePrivilege escalation occurs when a user gets to access more resources than is normally allowed when it should have been protected from the application.\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eVertical escalation:\u003c/strong\u003e Occurs when the attacker get access to accounts with high level privileges.\u003cbr\u003e\n\u003cstrong\u003eHorizontal escalation:\u003c/strong\u003e Occurs when the attacker get access to other accounts with same privileges level.\u003c/p\u003e\n\n\u003cp\u003eVertical escalation is not possible, let\u0026#39;s say that Admin user is safe. With the Admin user created other users and some of them were added to Administrators group. I opened other window browser in private mode and logged as \u003cstrong\u003eadmin2\u003c/strong\u003e user (This user was added to administrators group).\u003cbr\u003e\nAs \u003cstrong\u003eadmin2\u003c/strong\u003e user went to \u003ccode\u003eDashboard -\u0026gt; Members -\u0026gt; Search Users\u003c/code\u003e and clicked on a link corresponding to other user (user \u003cstrong\u003eadmin3\u003c/strong\u003e) with administrator privileges and I\u0026#39;m able to do actions that can lead to takeover other administrator accounts.\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003e\u003cstrong\u003eHigh\u003c/strong\u003e. A disgruntled user with Administration privileges can change password, email, username, deactivate account or delete other users in the Administrators group. It happens because an user in the Administrators group can create users and add them to his same level group.\u003c/p\u003e\n\n\u003ch1 id=\"recommendations\"\u003eRecommendations\u003c/h1\u003e\n\n\u003cp\u003eOnly \u003cstrong\u003eAdmin\u003c/strong\u003e must be able to add or make changes to users in the \u003cstrong\u003eAdministrators\u003c/strong\u003e group.\u003c/p\u003e\n\n\u003cp\u003eKind regards,\u003cbr\u003e\n\u003cstrong\u003eGamliel Hernadez.\u003c/strong\u003e\u003c/p\u003e\n","weakness":{"id":75,"name":"Privilege Escalation"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":253771,"file_name":"crayons.jpg","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/253/771/1e17650c169127aca2cd44ee8c014c04aa55347f/crayons.jpg?response-content-disposition=attachment%3B%20filename%3D%22crayons.jpg%22%3B%20filename%2A%3DUTF-8%27%27crayons.jpg\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ3MMGRP5H%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T053012Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCICEZ9R%2B2RJ3GrTP6l%2FPAFADJG1t55InVtXNQpLfOPgHaAiEA9vebVe9XdCpFDuGnxxWe2Ve48e%2FtAoig8YYxqZ7es78qtAMIUhABGgwwMTM2MTkyNzQ4NDkiDH6RMqd3Km1HzDzcXiqRAw9Zi9Zyah%2FL7m5qi9w2XsNDr%2F5ZZ%2F5Gny1bCMAgWHuEH9Lmtzfddi67Q3u82zHSnheCFLE%2BUTr6KCbyVouh2s6I1Iw5FpZ4LCl2Jts%2FOYIW3f51kFQhZ3sOfoeJ95jG2hfROCEhzpnA30iPS6xMNw87KO9Qo4x%2FBM37CIhv4A0%2FSU0JbwvczB01wva%2FQJkiH6lH1ZVS3EG6yUh%2Feq8kDGf%2FnGRgLcxw3MK7jT4GG1knwEEDIQOAuumsmWt3QDUH6dFWYx57C2QS76Xr1I1ub7Ob050enItoD3hnXR1F2lhC9JZWyDDS3sRTHvPx0voGVfuM803u8XTKLOZxTNSBY1S8m7RRU55us25%2BTyEe9Q6J6l3ZXKJZ8Jv02FW7RtNRHdPm0L6O0I3vOQbn8GiBG%2FkhDZRW3AOAiJuB4Bhd6Ns7j3YXA9nKlctO1uYmAj%2B6nssjBtl1lKabSm0eGuk7Feh%2B9jG%2BgpNFzxS0iYgysVfwkvplnvmKgReLAD4JvjZ9sdbv66UX5MyW9gDVXf0wfna3MN2Fqv8FOusBFyKfufPYQYGFwO4tvl1lihdDkLnCZcRwmXrB0gYZzbAneLC1UJ9NimBCebx3LEek%2BJ0J1MdqCNRGrLEY92gh38wj7A61ZNLFh9KTVAiyEFWLju0gH5kr3ndnXguXCxD19p54ZTSuYzlTQ9ArEyfvPBo%2F%2BWy25KkCTRlm376pduEzwhG4%2FgpY13ZbeNcDXcGVf2lvpy33oGJqXFcfCgWJYbDCm0M%2FBGBrkOhnizXl7hE2kfO2aQgP2N8b5LucE1O2Tl%2B%2B7ABCWc7Sl7RPhipBfTbyd%2FEfgt9ObkPFxAc0xnS36iwoGt1oKkhotg%3D%3D\u0026X-Amz-Signature=09742b6360679d39233dd65fb709a0740e6b3d7452fdacec33d5871aa61e1d84","file_size":46183,"type":"image/jpeg"}],"allow_singular_disclosure_at":null,"vote_count":2,"voters":["tech101_bro","daidso"],"severity":{"rating":"none","author_type":"Team"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":3131059,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"The administrators group is meant to give administrative access to everything, including users. The recommended way to deal with this sort of issue is to set up a group that has more restrictive permissions than wide open administrator.\n\nThanks for taking the time to write this up!","markdown_message":"\u003cp\u003eThe administrators group is meant to give administrative access to everything, including users. The recommended way to deal with this sort of issue is to set up a group that has more restrictive permissions than wide open administrator.\u003c/p\u003e\n\n\u003cp\u003eThanks for taking the time to write this up!\u003c/p\u003e\n","automated_response":false,"created_at":"2018-08-02T03:39:21.767Z","updated_at":"2018-08-02T03:39:21.767Z","actor":{"username":"korvin","cleared":false,"url":"/korvin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/yi9xvfnDmjKpKA1reqNSwGct/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"concrete5","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3131196,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"You're welcome to deal with this issue as easy should be to the development team. Thanks for taking the time to check my report.\n\nCould we ... ?","markdown_message":"\u003cp\u003eYou\u0026#39;re welcome to deal with this issue as easy should be to the development team. Thanks for taking the time to check my report.\u003c/p\u003e\n\n\u003cp\u003eCould we ... ?\u003c/p\u003e\n","automated_response":false,"created_at":"2018-08-02T05:56:03.931Z","updated_at":"2018-08-02T05:56:03.931Z","first_to_agree":true,"actor":{"username":"gamliel","cleared":false,"url":"/gamliel","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/097/323/a67a70073a81ab1b70763a8faaba57d5c6fa751b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"concrete5","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7414366,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2020-03-24T19:06:45.275Z","updated_at":"2020-03-24T19:06:45.275Z","additional_data":{"old_severity":"High","new_severity":"None","old_severity_id":107797,"new_severity_id":669487},"actor":{"username":"korvin","cleared":false,"url":"/korvin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/yi9xvfnDmjKpKA1reqNSwGct/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"concrete5","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7966235,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2020-05-11T18:32:19.302Z","updated_at":"2020-05-11T18:32:19.302Z","additional_data":{"old_title":"Horizontal Privilege Escalation leads to Account Takeover","new_title":"Administrators can add other administrators"},"actor":{"username":"korvin","cleared":false,"url":"/korvin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/yi9xvfnDmjKpKA1reqNSwGct/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"concrete5","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7966237,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-05-11T18:32:29.582Z","updated_at":"2020-05-11T18:32:29.582Z","actor":{"username":"korvin","cleared":false,"url":"/korvin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/yi9xvfnDmjKpKA1reqNSwGct/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"concrete5","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7966238,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-05-11T18:32:29.651Z","updated_at":"2020-05-11T18:32:29.651Z","actor":{"username":"korvin","cleared":false,"url":"/korvin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/yi9xvfnDmjKpKA1reqNSwGct/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"concrete5","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}