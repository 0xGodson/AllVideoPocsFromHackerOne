{"id":258084,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yNTgwODQ=","url":"https://hackerone.com/reports/258084","title":"Access to all files of remote user through shared file","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2017-08-08T20:58:53.598Z","submitted_at":"2017-08-08T20:58:53.598Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"xuesheng","url":"/xuesheng","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13291,"url":"https://hackerone.com/nextcloud","handle":"nextcloud","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Nextcloud","twitter_handle":"nextclouders","website":"https://nextcloud.com","about":"Access, share and protect your files, calendars, contacts, communication \u0026 more at home and in your enterprise."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2020-03-01T14:10:12.955Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2020-01-31T14:10:11.795Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"### Steps to reproduce\n1. User A shares a file \"movie.mp4\" with user B.\n2. User B uses webdav to access files (e.g. foldersync or nautilus)\n3. share is shown as regular file (using webdav).\n4. Copy the file and paste it to the same folder (still using webdav).\n5. A new folder will appear with the name \"(1)movie.mp4\". This folder contains all data of user A (which is quite scary). Folder structure looks like: files, files_trashbin, cache, etc. (all user related files).\n6. I was able to reproduce this with different combination of users and shared files.\n\n### Expected behaviour\nOnly the shared file should be copied.\n\n### Actual behaviour\nAll files of remote user are copied.\n\n### Server configuration\n\n**Operating system**: Ubuntu 16.04.3 LTS\n\n**Web server:** apache2 (2.4.18-2ubuntu3)\n\n**Database:** mariadb (10.0.24-7)\n\n**PHP version:** php7 (7.0+35ubuntu6)\n\n**Nextcloud version:** 12.0.1\n\n**Updated from an older Nextcloud/ownCloud or fresh install:** originally owncloud, upgradepath according to the official documentation to nextcloud (owncloud 9 to nextcloud 9 or 10, can't remember).\n\n**Where did you install Nextcloud from:** Nextcloud package was downloaded from official webpage (nextcloud.com)\n\n**Signing status:**\n\u003cdetails\u003e\n\u003csummary\u003eSigning status\u003c/summary\u003e\n\n```\nNo errors have been found.\n```\n\u003c/details\u003e\n\n**List of activated apps:**\n\u003cdetails\u003e\n\u003csummary\u003eApp list\u003c/summary\u003e\n\n```\nEnabled:\n  - activity: 2.5.2\n  - admin_audit: 1.2.0\n  - bookmarks: 0.10.1\n  - bruteforcesettings: 1.0.2\n  - calendar: 1.5.3\n  - comments: 1.2.0\n  - contacts: 1.5.3\n  - dav: 1.3.0\n  - federatedfilesharing: 1.2.0\n  - federation: 1.2.0\n  - files: 1.7.2\n  - files_accesscontrol: 1.2.4\n  - files_automatedtagging: 1.2.2\n  - files_external: 1.3.0\n  - files_pdfviewer: 1.1.1\n  - files_retention: 1.1.2\n  - files_sharing: 1.4.0\n  - files_texteditor: 2.4.1\n  - files_trashbin: 1.2.0\n  - files_versions: 1.5.0\n  - files_videoplayer: 1.1.0\n  - firstrunwizard: 2.1\n  - gallery: 17.0.0\n  - logreader: 2.0.0\n  - lookup_server_connector: 1.0.0\n  - mail: 0.6.4\n  - nextcloud_announcements: 1.1\n  - notifications: 2.0.0\n  - oauth2: 1.0.5\n  - password_policy: 1.2.2\n  - previewgenerator: 1.0.6\n  - provisioning_api: 1.2.0\n  - serverinfo: 1.2.0\n  - sharebymail: 1.2.0\n  - spreed: 2.0.1\n  - survey_client: 1.0.0\n  - systemtags: 1.2.0\n  - theming: 1.3.0\n  - twofactor_backupcodes: 1.1.1\n  - updatenotification: 1.2.0\n  - workflowengine: 1.2.0\nDisabled:\n  - encryption\n  - user_external\n  - user_ldap\n```\n\u003c/details\u003e\n\n**Nextcloud configuration:**\n\u003cdetails\u003e\n\u003csummary\u003eConfig report\u003c/summary\u003e\n\n```\n{\n    \"system\": {\n        \"instanceid\": \"***REMOVED SENSITIVE VALUE***\",\n        \"passwordsalt\": \"***REMOVED SENSITIVE VALUE***\",\n        \"trusted_domains\": [\n            \"***REMOVED SENSITIVE VALUE***\",\n            \"***REMOVED SENSITIVE VALUE***\",\n            \"***REMOVED SENSITIVE VALUE***\"\n        ],\n        \"datadirectory\": \"***REMOVED SENSITIVE VALUE***\",\n        \"dbtype\": \"mysql\",\n        \"version\": \"12.0.1.5\",\n        \"dbname\": \"owncloud\",\n        \"dbhost\": \"localhost\",\n        \"dbtableprefix\": \"oc_\",\n        \"dbuser\": \"***REMOVED SENSITIVE VALUE***\",\n        \"dbpassword\": \"***REMOVED SENSITIVE VALUE***\",\n        \"installed\": true,\n        \"forcessl\": true,\n        \"mail_smtpmode\": \"smtp\",\n        \"mail_smtpsecure\": \"ssl\",\n        \"mail_from_address\": \"***REMOVED SENSITIVE VALUE***\",\n        \"mail_domain\": \"***REMOVED SENSITIVE VALUE***\",\n        \"mail_smtpauthtype\": \"LOGIN\",\n        \"mail_smtpauth\": true,\n        \"mail_smtphost\": \"***REMOVED SENSITIVE VALUE***\",\n        \"mail_smtpport\": \"465\",\n        \"mail_smtpname\": \"***REMOVED SENSITIVE VALUE***\",\n        \"mail_smtppassword\": \"***REMOVED SENSITIVE VALUE***\",\n        \"theme\": \"\",\n        \"maintenance\": false,\n        \"logtimezone\": \"Europe\\/Berlin\",\n        \"loglevel\": 0,\n        \"log_authfailip\": true,\n        \"overwrite.cli.url\": \"\\/owncloud\",\n        \"secret\": \"***REMOVED SENSITIVE VALUE***\",\n        \"forceSSLforSubdomains\": true,\n        \"trashbin_retention_obligation\": \"30, 180\",\n        \"memcache.local\": \"\\\\OC\\\\Memcache\\\\APCu\",\n        \"memcache.locking\": \"\\\\OC\\\\Memcache\\\\Redis\",\n        \"redis\": {\n            \"host\": \"\\/var\\/run\\/redis\\/redis.sock\",\n            \"port\": 0,\n            \"dbindex\": 0,\n            \"password\": \"***REMOVED SENSITIVE VALUE***\",\n            \"timeout\": 1.5\n        },\n        \"htaccess.RewriteBase\": \"\\/owncloud\"\n    }\n}\n```\n\u003c/details\u003e\n\n**Are you using external storage, if yes which one:** not applicable\n\n**Are you using encryption:** no\n\n**Are you using an external user-backend, if yes which one:** no\n\n### Client configuration\n**Browser:** Firefox 54.0\n\n**Operating system:** Ubuntu 16.04.3 LTS\n\n### Logs\n#### Web server error log\n\u003cdetails\u003e\n\u003csummary\u003eWeb server error log\u003c/summary\u003e\n\n```\nNo errors related to issue.\n```\n\u003c/details\u003e\n\n#### Nextcloud log (data/nextcloud.log)\n\u003cdetails\u003e\n\u003csummary\u003eNextcloud log\u003c/summary\u003e\n\n```\nNo errors related to issue.\n```\n\u003c/details\u003e\n\n#### Browser log\n\u003cdetails\u003e\n\u003csummary\u003eBrowser log\u003c/summary\u003e\n\n```\nNot applicable.\n```\n\u003c/details\u003e\n","vulnerability_information_html":"\u003ch3 id=\"steps-to-reproduce\"\u003eSteps to reproduce\u003c/h3\u003e\n\n\u003col\u003e\n\u003cli\u003eUser A shares a file \u0026quot;movie.mp4\u0026quot; with user B.\u003c/li\u003e\n\u003cli\u003eUser B uses webdav to access files (e.g. foldersync or nautilus)\u003c/li\u003e\n\u003cli\u003eshare is shown as regular file (using webdav).\u003c/li\u003e\n\u003cli\u003eCopy the file and paste it to the same folder (still using webdav).\u003c/li\u003e\n\u003cli\u003eA new folder will appear with the name \u0026quot;(1)movie.mp4\u0026quot;. This folder contains all data of user A (which is quite scary). Folder structure looks like: files, files_trashbin, cache, etc. (all user related files).\u003c/li\u003e\n\u003cli\u003eI was able to reproduce this with different combination of users and shared files.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003ch3 id=\"expected-behaviour\"\u003eExpected behaviour\u003c/h3\u003e\n\n\u003cp\u003eOnly the shared file should be copied.\u003c/p\u003e\n\n\u003ch3 id=\"actual-behaviour\"\u003eActual behaviour\u003c/h3\u003e\n\n\u003cp\u003eAll files of remote user are copied.\u003c/p\u003e\n\n\u003ch3 id=\"server-configuration\"\u003eServer configuration\u003c/h3\u003e\n\n\u003cp\u003e\u003cstrong\u003eOperating system\u003c/strong\u003e: Ubuntu 16.04.3 LTS\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eWeb server:\u003c/strong\u003e apache2 (2.4.18-2ubuntu3)\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eDatabase:\u003c/strong\u003e mariadb (10.0.24-7)\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003ePHP version:\u003c/strong\u003e php7 (7.0+35ubuntu6)\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eNextcloud version:\u003c/strong\u003e 12.0.1\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eUpdated from an older Nextcloud/ownCloud or fresh install:\u003c/strong\u003e originally owncloud, upgradepath according to the official documentation to nextcloud (owncloud 9 to nextcloud 9 or 10, can\u0026#39;t remember).\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eWhere did you install Nextcloud from:\u003c/strong\u003e Nextcloud package was downloaded from official webpage (nextcloud.com)\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eSigning status:\u003c/strong\u003e\u003cbr\u003e\n\u0026lt;details\u0026gt;\u003cbr\u003e\n\u0026lt;summary\u0026gt;Signing status\u0026lt;/summary\u0026gt;\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eNo errors have been found.\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e\u0026lt;/details\u0026gt;\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eList of activated apps:\u003c/strong\u003e\u003cbr\u003e\n\u0026lt;details\u0026gt;\u003cbr\u003e\n\u0026lt;summary\u0026gt;App list\u0026lt;/summary\u0026gt;\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eEnabled:\n  - activity: 2.5.2\n  - admin_audit: 1.2.0\n  - bookmarks: 0.10.1\n  - bruteforcesettings: 1.0.2\n  - calendar: 1.5.3\n  - comments: 1.2.0\n  - contacts: 1.5.3\n  - dav: 1.3.0\n  - federatedfilesharing: 1.2.0\n  - federation: 1.2.0\n  - files: 1.7.2\n  - files_accesscontrol: 1.2.4\n  - files_automatedtagging: 1.2.2\n  - files_external: 1.3.0\n  - files_pdfviewer: 1.1.1\n  - files_retention: 1.1.2\n  - files_sharing: 1.4.0\n  - files_texteditor: 2.4.1\n  - files_trashbin: 1.2.0\n  - files_versions: 1.5.0\n  - files_videoplayer: 1.1.0\n  - firstrunwizard: 2.1\n  - gallery: 17.0.0\n  - logreader: 2.0.0\n  - lookup_server_connector: 1.0.0\n  - mail: 0.6.4\n  - nextcloud_announcements: 1.1\n  - notifications: 2.0.0\n  - oauth2: 1.0.5\n  - password_policy: 1.2.2\n  - previewgenerator: 1.0.6\n  - provisioning_api: 1.2.0\n  - serverinfo: 1.2.0\n  - sharebymail: 1.2.0\n  - spreed: 2.0.1\n  - survey_client: 1.0.0\n  - systemtags: 1.2.0\n  - theming: 1.3.0\n  - twofactor_backupcodes: 1.1.1\n  - updatenotification: 1.2.0\n  - workflowengine: 1.2.0\nDisabled:\n  - encryption\n  - user_external\n  - user_ldap\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e\u0026lt;/details\u0026gt;\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eNextcloud configuration:\u003c/strong\u003e\u003cbr\u003e\n\u0026lt;details\u0026gt;\u003cbr\u003e\n\u0026lt;summary\u0026gt;Config report\u0026lt;/summary\u0026gt;\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e{\n    \u0026quot;system\u0026quot;: {\n        \u0026quot;instanceid\u0026quot;: \u0026quot;***REMOVED SENSITIVE VALUE***\u0026quot;,\n        \u0026quot;passwordsalt\u0026quot;: \u0026quot;***REMOVED SENSITIVE VALUE***\u0026quot;,\n        \u0026quot;trusted_domains\u0026quot;: [\n            \u0026quot;***REMOVED SENSITIVE VALUE***\u0026quot;,\n            \u0026quot;***REMOVED SENSITIVE VALUE***\u0026quot;,\n            \u0026quot;***REMOVED SENSITIVE VALUE***\u0026quot;\n        ],\n        \u0026quot;datadirectory\u0026quot;: \u0026quot;***REMOVED SENSITIVE VALUE***\u0026quot;,\n        \u0026quot;dbtype\u0026quot;: \u0026quot;mysql\u0026quot;,\n        \u0026quot;version\u0026quot;: \u0026quot;12.0.1.5\u0026quot;,\n        \u0026quot;dbname\u0026quot;: \u0026quot;owncloud\u0026quot;,\n        \u0026quot;dbhost\u0026quot;: \u0026quot;localhost\u0026quot;,\n        \u0026quot;dbtableprefix\u0026quot;: \u0026quot;oc_\u0026quot;,\n        \u0026quot;dbuser\u0026quot;: \u0026quot;***REMOVED SENSITIVE VALUE***\u0026quot;,\n        \u0026quot;dbpassword\u0026quot;: \u0026quot;***REMOVED SENSITIVE VALUE***\u0026quot;,\n        \u0026quot;installed\u0026quot;: true,\n        \u0026quot;forcessl\u0026quot;: true,\n        \u0026quot;mail_smtpmode\u0026quot;: \u0026quot;smtp\u0026quot;,\n        \u0026quot;mail_smtpsecure\u0026quot;: \u0026quot;ssl\u0026quot;,\n        \u0026quot;mail_from_address\u0026quot;: \u0026quot;***REMOVED SENSITIVE VALUE***\u0026quot;,\n        \u0026quot;mail_domain\u0026quot;: \u0026quot;***REMOVED SENSITIVE VALUE***\u0026quot;,\n        \u0026quot;mail_smtpauthtype\u0026quot;: \u0026quot;LOGIN\u0026quot;,\n        \u0026quot;mail_smtpauth\u0026quot;: true,\n        \u0026quot;mail_smtphost\u0026quot;: \u0026quot;***REMOVED SENSITIVE VALUE***\u0026quot;,\n        \u0026quot;mail_smtpport\u0026quot;: \u0026quot;465\u0026quot;,\n        \u0026quot;mail_smtpname\u0026quot;: \u0026quot;***REMOVED SENSITIVE VALUE***\u0026quot;,\n        \u0026quot;mail_smtppassword\u0026quot;: \u0026quot;***REMOVED SENSITIVE VALUE***\u0026quot;,\n        \u0026quot;theme\u0026quot;: \u0026quot;\u0026quot;,\n        \u0026quot;maintenance\u0026quot;: false,\n        \u0026quot;logtimezone\u0026quot;: \u0026quot;Europe\\/Berlin\u0026quot;,\n        \u0026quot;loglevel\u0026quot;: 0,\n        \u0026quot;log_authfailip\u0026quot;: true,\n        \u0026quot;overwrite.cli.url\u0026quot;: \u0026quot;\\/owncloud\u0026quot;,\n        \u0026quot;secret\u0026quot;: \u0026quot;***REMOVED SENSITIVE VALUE***\u0026quot;,\n        \u0026quot;forceSSLforSubdomains\u0026quot;: true,\n        \u0026quot;trashbin_retention_obligation\u0026quot;: \u0026quot;30, 180\u0026quot;,\n        \u0026quot;memcache.local\u0026quot;: \u0026quot;\\\\OC\\\\Memcache\\\\APCu\u0026quot;,\n        \u0026quot;memcache.locking\u0026quot;: \u0026quot;\\\\OC\\\\Memcache\\\\Redis\u0026quot;,\n        \u0026quot;redis\u0026quot;: {\n            \u0026quot;host\u0026quot;: \u0026quot;\\/var\\/run\\/redis\\/redis.sock\u0026quot;,\n            \u0026quot;port\u0026quot;: 0,\n            \u0026quot;dbindex\u0026quot;: 0,\n            \u0026quot;password\u0026quot;: \u0026quot;***REMOVED SENSITIVE VALUE***\u0026quot;,\n            \u0026quot;timeout\u0026quot;: 1.5\n        },\n        \u0026quot;htaccess.RewriteBase\u0026quot;: \u0026quot;\\/owncloud\u0026quot;\n    }\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e\u0026lt;/details\u0026gt;\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eAre you using external storage, if yes which one:\u003c/strong\u003e not applicable\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eAre you using encryption:\u003c/strong\u003e no\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eAre you using an external user-backend, if yes which one:\u003c/strong\u003e no\u003c/p\u003e\n\n\u003ch3 id=\"client-configuration\"\u003eClient configuration\u003c/h3\u003e\n\n\u003cp\u003e\u003cstrong\u003eBrowser:\u003c/strong\u003e Firefox 54.0\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eOperating system:\u003c/strong\u003e Ubuntu 16.04.3 LTS\u003c/p\u003e\n\n\u003ch3 id=\"logs\"\u003eLogs\u003c/h3\u003e\n\n\u003ch4 id=\"web-server-error-log\"\u003eWeb server error log\u003c/h4\u003e\n\n\u003cp\u003e\u0026lt;details\u0026gt;\u003cbr\u003e\n\u0026lt;summary\u0026gt;Web server error log\u0026lt;/summary\u0026gt;\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eNo errors related to issue.\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e\u0026lt;/details\u0026gt;\u003c/p\u003e\n\n\u003ch4 id=\"nextcloud-log-data-nextcloud-log\"\u003eNextcloud log (data/nextcloud.log)\u003c/h4\u003e\n\n\u003cp\u003e\u0026lt;details\u0026gt;\u003cbr\u003e\n\u0026lt;summary\u0026gt;Nextcloud log\u0026lt;/summary\u0026gt;\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eNo errors related to issue.\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e\u0026lt;/details\u0026gt;\u003c/p\u003e\n\n\u003ch4 id=\"browser-log\"\u003eBrowser log\u003c/h4\u003e\n\n\u003cp\u003e\u0026lt;details\u0026gt;\u003cbr\u003e\n\u0026lt;summary\u0026gt;Browser log\u0026lt;/summary\u0026gt;\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eNot applicable.\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e\u0026lt;/details\u0026gt;\u003c/p\u003e\n","bounty_amount":"750.0","formatted_bounty":"$750","weakness":{"id":18,"name":"Information Disclosure"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2020-03-01T14:10:11.905Z","allow_singular_disclosure_after":-26147021.21610954,"singular_disclosure_allowed":true,"vote_count":146,"voters":["kryword","huwwp","m0chan","secator","a_d_a_m","base_64","johndoe1492","jokerface","andreystepanov","njhackerone","and 136 more..."],"severity":{"rating":"medium","score":6.8,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"low","user_interaction":"required","scope":"changed","confidentiality":"high","integrity":"none","availability":"none"}},"structured_scope":{"databaseId":13,"asset_type":"SOURCE_CODE","asset_identifier":"nextcloud/server","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1914813,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks a lot for reporting this potential issue back to us!\n\nOur security team will take a look at this issue as soon as possible. We will reply to your report within 72 hours, usually much faster. For obvious reasons we'd like to ask you to not disclose this issue to any other party.","markdown_message":"\u003cp\u003eThanks a lot for reporting this potential issue back to us!\u003c/p\u003e\n\n\u003cp\u003eOur security team will take a look at this issue as soon as possible. We will reply to your report within 72 hours, usually much faster. For obvious reasons we\u0026#39;d like to ask you to not disclose this issue to any other party.\u003c/p\u003e\n","automated_response":true,"created_at":"2017-08-08T20:58:53.764Z","updated_at":"2017-08-08T20:58:53.764Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Nextcloud"}},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1914827,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Just to be honest: I first did a report of this issue on github a couple minutes ago. When I realized that this maybe security related, I removed the content at github and created the report here, so that you can check it's severity.\nMy original report was done here: https://github.com/nextcloud/server/issues/6040","markdown_message":"\u003cp\u003eJust to be honest: I first did a report of this issue on github a couple minutes ago. When I realized that this maybe security related, I removed the content at github and created the report here, so that you can check it\u0026#39;s severity.\u003cbr\u003e\nMy original report was done here: \u003ca title=\"https://github.com/nextcloud/server/issues/6040\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fnextcloud%2Fserver%2Fissues%2F6040\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/nextcloud/server/issues/6040\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2017-08-08T21:04:13.501Z","updated_at":"2017-08-08T21:04:13.501Z","actor":{"username":"xuesheng","cleared":false,"url":"/xuesheng","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1915881,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thanks a lot for your report. We're looking into this and will keep you updated. We've reached out to GitHub to remove said issue.","markdown_message":"\u003cp\u003eThanks a lot for your report. We\u0026#39;re looking into this and will keep you updated. We\u0026#39;ve reached out to GitHub to remove said issue.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-08-09T09:22:22.892Z","updated_at":"2017-08-09T09:22:22.892Z","actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1915887,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2017-08-09T09:27:12.619Z","updated_at":"2017-08-09T09:27:12.619Z","additional_data":{"old_severity":"Critical","new_severity":"Medium (6.8)","old_severity_id":66190,"new_severity_id":66281},"actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1915891,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"We consider this technically a high severity issue as per our bounty brief but have added the CVSS calculation which results in 6.8, we'll internally treat this as a high severity issue though.","markdown_message":"\u003cp\u003eWe consider this technically a high severity issue as per our bounty brief but have added the CVSS calculation which results in 6.8, we\u0026#39;ll internally treat this as a high severity issue though.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-08-09T09:29:17.306Z","updated_at":"2017-08-09T09:29:17.306Z","actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1916639,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I did some further testing with a new nextcloud 12.0.1 install (I used the latest vm image from https://www.techandme.se/nextcloud-vm/). Generally the issue could be reproduced by the same steps as mentioned in the original post. I assume that you are also able to reproduce this issue.\n\nWhen creating a federated share (remote share from one nextcloud instance to another), the issue does not exist. Webdav file copy just creates a copy of the shared file instead of leaking all data of the remote user (just as one would expect).\n\nJust for your information.","markdown_message":"\u003cp\u003eI did some further testing with a new nextcloud 12.0.1 install (I used the latest vm image from \u003ca title=\"https://www.techandme.se/nextcloud-vm/\" href=\"/redirect?url=https%3A%2F%2Fwww.techandme.se%2Fnextcloud-vm%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.techandme.se/nextcloud-vm/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e). Generally the issue could be reproduced by the same steps as mentioned in the original post. I assume that you are also able to reproduce this issue.\u003c/p\u003e\n\n\u003cp\u003eWhen creating a federated share (remote share from one nextcloud instance to another), the issue does not exist. Webdav file copy just creates a copy of the shared file instead of leaking all data of the remote user (just as one would expect).\u003c/p\u003e\n\n\u003cp\u003eJust for your information.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-08-09T15:43:37.255Z","updated_at":"2017-08-09T15:43:37.255Z","actor":{"username":"xuesheng","cleared":false,"url":"/xuesheng","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1917238,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"We were able to reproduce the issue. A fix is on the way.","markdown_message":"\u003cp\u003eWe were able to reproduce the issue. A fix is on the way.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-08-09T19:16:18.393Z","updated_at":"2017-08-09T19:16:18.393Z","actor":{"username":"rullzer","cleared":false,"url":"/rullzer","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/086/005/20095c4a0c77c88375f8db5d6ed10f350d98a5a3_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1918465,"is_internal":false,"editable":false,"type":"Activities::ExternalUserJoined","message":"","markdown_message":"","automated_response":false,"created_at":"2017-08-10T05:48:16.407Z","updated_at":"2017-08-10T05:48:16.407Z","additional_data":{"duplicate_report_id":258542},"actor":{"username":"pappad","cleared":false,"url":"/pappad","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1918510,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"We have a first patch for this at https://github.com/nextcloud/server/pull/6052 and we're planning to release this very soon in a 12.0.2.\n\nCan I by any chance ask you to test if applying this patch prevents the further exploitation of newly copied shares? Thanks!","markdown_message":"\u003cp\u003eWe have a first patch for this at \u003ca title=\"https://github.com/nextcloud/server/pull/6052\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fnextcloud%2Fserver%2Fpull%2F6052\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/nextcloud/server/pull/6052\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e and we\u0026#39;re planning to release this very soon in a 12.0.2.\u003c/p\u003e\n\n\u003cp\u003eCan I by any chance ask you to test if applying this patch prevents the further exploitation of newly copied shares? Thanks!\u003c/p\u003e\n","automated_response":false,"created_at":"2017-08-10T06:08:25.864Z","updated_at":"2017-08-10T06:08:25.864Z","actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1918549,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I just applied the mentioned patch and can confirm that the issue described above is fixed! Thanks for your hard work making nextcloud as secure as possible.","markdown_message":"\u003cp\u003eI just applied the mentioned patch and can confirm that the issue described above is fixed! Thanks for your hard work making nextcloud as secure as possible.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-08-10T06:44:38.765Z","updated_at":"2017-08-10T06:44:38.765Z","actor":{"username":"xuesheng","cleared":false,"url":"/xuesheng","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1924510,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"We're aiming to release a patch this week for this bug. An internal testing version can be found at:\n\n- https://download.nextcloud.com/server/prereleases/nextcloud-12.0.2.zip\n- https://download.nextcloud.com/server/prereleases/nextcloud-12.0.2.tar.bz2","markdown_message":"\u003cp\u003eWe\u0026#39;re aiming to release a patch this week for this bug. An internal testing version can be found at:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e\u003ca title=\"https://download.nextcloud.com/server/prereleases/nextcloud-12.0.2.zip\" href=\"/redirect?url=https%3A%2F%2Fdownload.nextcloud.com%2Fserver%2Fprereleases%2Fnextcloud-12.0.2.zip\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://download.nextcloud.com/server/prereleases/nextcloud-12.0.2.zip\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca title=\"https://download.nextcloud.com/server/prereleases/nextcloud-12.0.2.tar.bz2\" href=\"/redirect?url=https%3A%2F%2Fdownload.nextcloud.com%2Fserver%2Fprereleases%2Fnextcloud-12.0.2.tar.bz2\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://download.nextcloud.com/server/prereleases/nextcloud-12.0.2.tar.bz2\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n","automated_response":false,"created_at":"2017-08-13T11:06:23.822Z","updated_at":"2017-08-13T11:06:23.822Z","actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1929734,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@xuesheng Can you verify that this doesn't happen anymore with 12.0.2? Thanks a lot.","markdown_message":"\u003cp\u003e\u003ca href=\"/xuesheng\"\u003e@xuesheng\u003c/a\u003e Can you verify that this doesn\u0026#39;t happen anymore with 12.0.2? Thanks a lot.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-08-15T07:50:32.318Z","updated_at":"2017-08-15T07:50:32.318Z","actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1931178,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I did upgrade to version 12.0.2 and can verify that the issue doesn't happen anymore!","markdown_message":"\u003cp\u003eI did upgrade to version 12.0.2 and can verify that the issue doesn\u0026#39;t happen anymore!\u003c/p\u003e\n","automated_response":false,"created_at":"2017-08-15T18:29:50.036Z","updated_at":"2017-08-15T18:29:50.036Z","actor":{"username":"xuesheng","cleared":false,"url":"/xuesheng","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1931455,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks again for your report and also special thanks for testing the patch for us.\n\nI'll have to check back with the team on the possible reward on this since technically the bug has been reported publicly which is against our program rules and we don't like to set a precedent. Since the report on GitHub was however obviously reported by accident we may be able to bend the rules a bit.\n\nI'll keep you updated. With regard to the security advisory, can you let us know how you want to be credited? The following possibilities are there:\n\n1. Full name (or pseudonym)\n2. Mail address (optional)\n3. Company name (optional)\n4. Website (optional)\n\nPlease note that we release more detailed security advisories only after a grace period has passed to give users a chance to update. We'd appreciate if you would not share any details about this bug until we've released our official security advisory.","markdown_message":"\u003cp\u003eThanks again for your report and also special thanks for testing the patch for us.\u003c/p\u003e\n\n\u003cp\u003eI\u0026#39;ll have to check back with the team on the possible reward on this since technically the bug has been reported publicly which is against our program rules and we don\u0026#39;t like to set a precedent. Since the report on GitHub was however obviously reported by accident we may be able to bend the rules a bit.\u003c/p\u003e\n\n\u003cp\u003eI\u0026#39;ll keep you updated. With regard to the security advisory, can you let us know how you want to be credited? The following possibilities are there:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eFull name (or pseudonym)\u003c/li\u003e\n\u003cli\u003eMail address (optional)\u003c/li\u003e\n\u003cli\u003eCompany name (optional)\u003c/li\u003e\n\u003cli\u003eWebsite (optional)\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003ePlease note that we release more detailed security advisories only after a grace period has passed to give users a chance to update. We\u0026#39;d appreciate if you would not share any details about this bug until we\u0026#39;ve released our official security advisory.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-08-15T20:16:00.374Z","updated_at":"2017-08-15T20:21:01.312Z","actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"xuesheng","url":"/xuesheng"},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1931526,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I'm sorry for accidently posting on github first and hope that this didn't/doesn't cause any inconvenience for you/nextcloud.\nI'd like to be credited with pseudonym only (XueSheng).","markdown_message":"\u003cp\u003eI\u0026#39;m sorry for accidently posting on github first and hope that this didn\u0026#39;t/doesn\u0026#39;t cause any inconvenience for you/nextcloud.\u003cbr\u003e\nI\u0026#39;d like to be credited with pseudonym only (XueSheng).\u003c/p\u003e\n","automated_response":false,"created_at":"2017-08-15T20:41:36.094Z","updated_at":"2017-08-15T20:41:36.094Z","actor":{"username":"xuesheng","cleared":false,"url":"/xuesheng","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1935786,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks again for your report. \n\nWe've lowered the reward a little bit due to the fact that this has been already disclosed before via GitHub and we didn't want to set a precedent here.","markdown_message":"\u003cp\u003eThanks again for your report. \u003c/p\u003e\n\n\u003cp\u003eWe\u0026#39;ve lowered the reward a little bit due to the fact that this has been already disclosed before via GitHub and we didn\u0026#39;t want to set a precedent here.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-08-17T12:14:23.393Z","updated_at":"2017-08-17T12:14:23.393Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Nextcloud"}},"bounty_amount":"750.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"nextcloud","collaborator":{"username":"xuesheng","url":"/xuesheng"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6932772,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Forgot to disclose this","markdown_message":"\u003cp\u003eForgot to disclose this\u003c/p\u003e\n","automated_response":false,"created_at":"2020-01-31T14:10:11.820Z","updated_at":"2020-01-31T14:10:11.820Z","first_to_agree":true,"actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7188563,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-03-01T14:10:12.983Z","updated_at":"2020-03-01T14:10:12.983Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Nextcloud"}},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}