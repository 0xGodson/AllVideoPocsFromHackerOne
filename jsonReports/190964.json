{"id":190964,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xOTA5NjQ=","url":"https://hackerone.com/reports/190964","title":"Content type incorrectly stated","state":"Closed","substate":"informative","severity_rating":"none","readable_substate":"Informative","created_at":"2016-12-13T23:08:13.319Z","submitted_at":"2016-12-13T23:08:13.319Z","is_member_of_team?":false,"reporter":{"disabled":true,"username":"lulliii","url":"/lulliii","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1868,"url":"https://hackerone.com/gratipay","handle":"gratipay","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/868/a75c6649c5b4671b3cf44160af884a7da9fd0b67_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/868/a75c6649c5b4671b3cf44160af884a7da9fd0b67_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"disabled","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Gratipay","twitter_handle":"Gratipay","website":"https://gratipay.com/","about":"Gratitude? Gratipay! The easiest way for your company to pay for open source."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2016-12-27T13:41:07.695Z","bug_reporter_agreed_on_going_public_at":"2016-12-27T13:35:14.730Z","team_member_agreed_on_going_public_at":"2016-12-27T13:41:07.638Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hello,\nIssue detail:\nThe response contains the following Content-type statement:\nContent-Type: image/jpeg\nThe response states that it contains a JPEG image. However, it actually appears to contain unrecognized content.  \nIssue background:\nIf a web response specifies an incorrect content type, then browsers may process the response in unexpected ways. If the specified content type is a renderable text-based format, then the browser will usually attempt to parse and render the response in that format. If the specified type is an image format, then the browser will usually detect the anomaly and will analyze the actual content and attempt to determine its MIME type. Either case can lead to unexpected results, and if the content contains any user-controllable data may lead to cross-site scripting or other client-side vulnerabilities.  In most cases, the presence of an incorrect content type statement does not constitute a security flaw, particularly if the response contains static content. You should review the contents of the response and the context in which it appears to determine whether any vulnerability exists.  \nIssue remediation:\nFor every response containing a message body, the application should include a single Content-type header which correctly and unambiguously states the MIME type of the content in the response body.  \n\nResponse:\nHTTP/1.1 200 OK\nConnection: keep-alive\nServer: gunicorn\nDate: Tue, 13 Dec 2016 22:58:22 GMT\nX-Frame-Options: SAMEORIGIN\nX-Content-Type-Options: nosniff\nX-Gratipay-Version: 2020\nSet-Cookie: csrf_token=gasIdvRVcAs5Fp26DVBn8BJPK7zY1S9r; expires=Tue, 20 Dec 2016 22:58:22 GMT; Path=/; secure\nX-Xss-Protection: 1; mode=block\nContent-Type: image/jpeg\nCache-Control: no-cache\nVia: 1.1 vegur\nContent-Length: 8571","vulnerability_information_html":"\u003cp\u003eHello,\u003cbr\u003e\nIssue detail:\u003cbr\u003e\nThe response contains the following Content-type statement:\u003cbr\u003e\nContent-Type: image/jpeg\u003cbr\u003e\nThe response states that it contains a JPEG image. However, it actually appears to contain unrecognized content.\u003cbr\u003e\u003cbr\u003e\nIssue background:\u003cbr\u003e\nIf a web response specifies an incorrect content type, then browsers may process the response in unexpected ways. If the specified content type is a renderable text-based format, then the browser will usually attempt to parse and render the response in that format. If the specified type is an image format, then the browser will usually detect the anomaly and will analyze the actual content and attempt to determine its MIME type. Either case can lead to unexpected results, and if the content contains any user-controllable data may lead to cross-site scripting or other client-side vulnerabilities.  In most cases, the presence of an incorrect content type statement does not constitute a security flaw, particularly if the response contains static content. You should review the contents of the response and the context in which it appears to determine whether any vulnerability exists.\u003cbr\u003e\u003cbr\u003e\nIssue remediation:\u003cbr\u003e\nFor every response containing a message body, the application should include a single Content-type header which correctly and unambiguously states the MIME type of the content in the response body.  \u003c/p\u003e\n\n\u003cp\u003eResponse:\u003cbr\u003e\nHTTP/1.1 200 OK\u003cbr\u003e\nConnection: keep-alive\u003cbr\u003e\nServer: gunicorn\u003cbr\u003e\nDate: Tue, 13 Dec 2016 22:58:22 GMT\u003cbr\u003e\nX-Frame-Options: SAMEORIGIN\u003cbr\u003e\nX-Content-Type-Options: nosniff\u003cbr\u003e\nX-Gratipay-Version: 2020\u003cbr\u003e\nSet-Cookie: csrf_token=gasIdvRVcAs5Fp26DVBn8BJPK7zY1S9r; expires=Tue, 20 Dec 2016 22:58:22 GMT; Path=/; secure\u003cbr\u003e\nX-Xss-Protection: 1; mode=block\u003cbr\u003e\nContent-Type: image/jpeg\u003cbr\u003e\nCache-Control: no-cache\u003cbr\u003e\nVia: 1.1 vegur\u003cbr\u003e\nContent-Length: 8571\u003c/p\u003e\n","original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":2,"voters":["spetr0x","lulliii"],"severity":{"rating":"none","author_type":"Team"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1367737,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Any updates?\n","markdown_message":"\u003cp\u003eAny updates?\u003c/p\u003e\n","automated_response":false,"created_at":"2016-12-15T20:54:44.910Z","updated_at":"2016-12-15T20:54:44.910Z","actor":{"username":"lulliii","cleared":false,"url":"/lulliii","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1367899,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for this report!  Evaluating... ","markdown_message":"\u003cp\u003eThanks for this report!  Evaluating... \u003c/p\u003e\n","automated_response":false,"created_at":"2016-12-15T21:37:55.713Z","updated_at":"2016-12-15T21:37:55.713Z","actor":{"username":"dmk246","cleared":false,"url":"/dmk246","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1367912,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Take your time :)\n","markdown_message":"\u003cp\u003eTake your time :)\u003c/p\u003e\n","automated_response":false,"created_at":"2016-12-15T21:45:08.364Z","updated_at":"2016-12-15T21:45:08.364Z","actor":{"username":"lulliii","cleared":false,"url":"/lulliii","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1382646,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Any updates on this?","markdown_message":"\u003cp\u003eAny updates on this?\u003c/p\u003e\n","automated_response":false,"created_at":"2016-12-22T21:59:48.537Z","updated_at":"2016-12-22T21:59:48.537Z","actor":{"username":"lulliii","cleared":false,"url":"/lulliii","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1382691,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Sorry @dr-cdqh, due to the holiday here in the US we are short staffed.  Please be advised we are working on your report.  Thanks for your patience! ","markdown_message":"\u003cp\u003eSorry \u003ca href=\"/dr-cdqh\"\u003e@dr-cdqh\u003c/a\u003e, due to the holiday here in the US we are short staffed.  Please be advised we are working on your report.  Thanks for your patience! \u003c/p\u003e\n","automated_response":false,"created_at":"2016-12-22T22:13:56.641Z","updated_at":"2016-12-22T22:13:56.641Z","actor":{"username":"dmk246","cleared":false,"url":"/dmk246","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1382710,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Okay! Happy Holiday.","markdown_message":"\u003cp\u003eOkay! Happy Holiday.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-12-22T22:19:32.947Z","updated_at":"2016-12-22T22:19:32.947Z","actor":{"username":"lulliii","cleared":false,"url":"/lulliii","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1386745,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @dr-cdqh,\n\nWould you mind revealing the requested URL?\n\nBest regards,\nEd","markdown_message":"\u003cp\u003eHi \u003ca href=\"/dr-cdqh\"\u003e@dr-cdqh\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eWould you mind revealing the requested URL?\u003c/p\u003e\n\n\u003cp\u003eBest regards,\u003cbr\u003e\nEd\u003c/p\u003e\n","automated_response":false,"created_at":"2016-12-27T09:58:13.479Z","updated_at":"2016-12-27T09:58:13.479Z","actor":{"username":"edoverflow","cleared":true,"url":"/edoverflow","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/116/374/9a3cf4d62b2f507a0d33808aacbad863ec4455ac_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1386802,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello,\nURL: https://gratipay.com/Gratipay/image","markdown_message":"\u003cp\u003eHello,\u003cbr\u003e\nURL: \u003ca title=\"https://gratipay.com/Gratipay/image\" href=\"/redirect?url=https%3A%2F%2Fgratipay.com%2FGratipay%2Fimage\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://gratipay.com/Gratipay/image\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2016-12-27T11:58:05.686Z","updated_at":"2016-12-27T11:58:05.686Z","actor":{"username":"lulliii","cleared":false,"url":"/lulliii","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1386834,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2016-12-27T12:07:47.792Z","updated_at":"2016-12-27T12:07:47.792Z","additional_data":{"old_severity":"Low","new_severity":"None","old_severity_id":13693,"new_severity_id":16127},"actor":{"username":"edoverflow","cleared":true,"url":"/edoverflow","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/116/374/9a3cf4d62b2f507a0d33808aacbad863ec4455ac_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1386848,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"Hi @dr-cdqh,\n\nAs PortSwigger states, some instances do not pose a security risk. [1] If you find an instance that does not affect Gratipay's security please submit an issue on [GitHub](https://github.com/gratipay/gratipay.com).\n\n\u003e In most cases, the presence of an incorrect content type statement does not constitute a security flaw, particularly if the response contains static content.\n\nBest regards,\nEd\n\n[1] - https://portswigger.net/KnowledgeBase/issues/Details/00800400_Contenttypeincorrectlystated","markdown_message":"\u003cp\u003eHi \u003ca href=\"/dr-cdqh\"\u003e@dr-cdqh\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eAs PortSwigger states, some instances do not pose a security risk. [1] If you find an instance that does not affect Gratipay\u0026#39;s security please submit an issue on \u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fgratipay%2Fgratipay.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eGitHub\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e.\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eIn most cases, the presence of an incorrect content type statement does not constitute a security flaw, particularly if the response contains static content.\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eBest regards,\u003cbr\u003e\nEd\u003c/p\u003e\n\n\u003cp\u003e[1] - \u003ca title=\"https://portswigger.net/KnowledgeBase/issues/Details/00800400_Contenttypeincorrectlystated\" href=\"/redirect?url=https%3A%2F%2Fportswigger.net%2FKnowledgeBase%2Fissues%2FDetails%2F00800400_Contenttypeincorrectlystated\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://portswigger.net/KnowledgeBase/issues/Details/00800400_Contenttypeincorrectlystated\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2016-12-27T12:13:50.986Z","updated_at":"2016-12-27T12:13:50.986Z","actor":{"username":"edoverflow","cleared":true,"url":"/edoverflow","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/116/374/9a3cf4d62b2f507a0d33808aacbad863ec4455ac_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1386953,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-12-27T13:35:14.743Z","updated_at":"2016-12-27T13:35:14.743Z","first_to_agree":true,"actor":{"username":"lulliii","cleared":false,"url":"/lulliii","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1386959,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-12-27T13:41:07.677Z","updated_at":"2016-12-27T13:41:07.677Z","actor":{"username":"edoverflow","cleared":true,"url":"/edoverflow","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/116/374/9a3cf4d62b2f507a0d33808aacbad863ec4455ac_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1386960,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-12-27T13:41:07.722Z","updated_at":"2016-12-27T13:41:07.722Z","actor":{"username":"edoverflow","cleared":true,"url":"/edoverflow","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/116/374/9a3cf4d62b2f507a0d33808aacbad863ec4455ac_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}