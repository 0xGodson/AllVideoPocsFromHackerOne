{"id":369979,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zNjk5Nzk=","url":"https://hackerone.com/reports/369979","title":"Missing X-Content-Type-Options ","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2018-06-22T04:35:51.576Z","submitted_at":"2018-06-22T04:35:51.576Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"pal434","url":"/pal434","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13291,"url":"https://hackerone.com/nextcloud","handle":"nextcloud","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Nextcloud","twitter_handle":"nextclouders","website":"https://nextcloud.com","about":"Access, share and protect your files, calendars, contacts, communication \u0026 more at home and in your enterprise."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2020-03-01T13:59:09.547Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2020-01-31T13:58:59.105Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Nextcloud doesn't have a header settings for X-Content-Type Options which means it is vulnerable to MIME sniffing. The only defined value, \"nosniff\", prevents Internet Explorer and Google Chrome from MIME-sniffing a response away from the declared content-type. This also applies to Google Chrome when downloading extensions. This reduces exposure to drive-by download attacks and sites serving user uploaded content that by clever naming could be treated by MSIE as executable or dynamic HTML files.\n\nPlease have a look at below links\n\nhttps://hackerone.com/reports/6935\nhttps://hackerone.com/reports/77081\nhttps://hackerone.com/reports/9479/\n\nImplement\n\nAdd the X-Content-Type-Options header with a value of \"nosniff\" to inform the browser to trust what the site has sent is the appropriate content-type, and to not attempt \"sniffing\" the real content-type.\n\nX-Content-Type-Options: nosniff\n\n## Impact\n\nMIME type sniffing is a standard functionality in browsers to find an appropriate way to render data where the HTTP headers sent by the server are either inconclusive or missing.\n\nThis allows older versions of Internet Explorer and Chrome to perform MIME-sniffing on the response body, potentially causing the response body to be interpreted and displayed as a content type other than the intended content type.\n\nThe problem arises once a website allows users to upload content which is then published on the web server. If an attacker can carry out XSS (Cross-site Scripting) attack by manipulating the content in a way to be accepted by the web application and rendered as HTML by the browser, it is possible to inject code in e.g. an image file and make the victim execute it by viewing the image.","vulnerability_information_html":"\u003cp\u003eNextcloud doesn\u0026#39;t have a header settings for X-Content-Type Options which means it is vulnerable to MIME sniffing. The only defined value, \u0026quot;nosniff\u0026quot;, prevents Internet Explorer and Google Chrome from MIME-sniffing a response away from the declared content-type. This also applies to Google Chrome when downloading extensions. This reduces exposure to drive-by download attacks and sites serving user uploaded content that by clever naming could be treated by MSIE as executable or dynamic HTML files.\u003c/p\u003e\n\n\u003cp\u003ePlease have a look at below links\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"https://hackerone.com/reports/6935\" href=\"https://hackerone.com/reports/6935\"\u003ehttps://hackerone.com/reports/6935\u003c/a\u003e\u003cbr\u003e\n\u003ca title=\"https://hackerone.com/reports/77081\" href=\"https://hackerone.com/reports/77081\"\u003ehttps://hackerone.com/reports/77081\u003c/a\u003e\u003cbr\u003e\n\u003ca title=\"https://hackerone.com/reports/9479/\" href=\"https://hackerone.com/reports/9479/\"\u003ehttps://hackerone.com/reports/9479/\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eImplement\u003c/p\u003e\n\n\u003cp\u003eAdd the X-Content-Type-Options header with a value of \u0026quot;nosniff\u0026quot; to inform the browser to trust what the site has sent is the appropriate content-type, and to not attempt \u0026quot;sniffing\u0026quot; the real content-type.\u003c/p\u003e\n\n\u003cp\u003eX-Content-Type-Options: nosniff\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eMIME type sniffing is a standard functionality in browsers to find an appropriate way to render data where the HTTP headers sent by the server are either inconclusive or missing.\u003c/p\u003e\n\n\u003cp\u003eThis allows older versions of Internet Explorer and Chrome to perform MIME-sniffing on the response body, potentially causing the response body to be interpreted and displayed as a content type other than the intended content type.\u003c/p\u003e\n\n\u003cp\u003eThe problem arises once a website allows users to upload content which is then published on the web server. If an attacker can carry out XSS (Cross-site Scripting) attack by manipulating the content in a way to be accepted by the web application and rendered as HTML by the browser, it is possible to inject code in e.g. an image file and make the victim execute it by viewing the image.\u003c/p\u003e\n","weakness":{"id":57,"name":"Violation of Secure Design Principles"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2020-03-01T13:58:59.183Z","allow_singular_disclosure_after":-26149566.188586913,"singular_disclosure_allowed":true,"vote_count":3,"voters":["a_d_a_m","whitesector","popescuradhoo"],"structured_scope":{"databaseId":60,"asset_type":"URL","asset_identifier":"https://download.nextcloud.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":2919623,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks a lot for reporting this potential issue back to us!\n\nOur security team will take a look at this issue as soon as possible. We will reply to your report within 72 hours, usually much faster. For obvious reasons we'd like to ask you to not disclose this issue to any other party.","markdown_message":"\u003cp\u003eThanks a lot for reporting this potential issue back to us!\u003c/p\u003e\n\n\u003cp\u003eOur security team will take a look at this issue as soon as possible. We will reply to your report within 72 hours, usually much faster. For obvious reasons we\u0026#39;d like to ask you to not disclose this issue to any other party.\u003c/p\u003e\n","automated_response":true,"created_at":"2018-06-22T04:35:52.574Z","updated_at":"2018-06-22T04:35:52.574Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Nextcloud"}},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2920015,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"But since this is our public download server where only our release packages are ever uploaded, it should not be a problem, right?","markdown_message":"\u003cp\u003eBut since this is our public download server where only our release packages are ever uploaded, it should not be a problem, right?\u003c/p\u003e\n","automated_response":false,"created_at":"2018-06-22T08:18:08.180Z","updated_at":"2018-06-22T08:18:08.180Z","actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2920961,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"They can be a problem sir.\n\nYou need to implement every security header on every domain.I hope you implement it","markdown_message":"\u003cp\u003eThey can be a problem sir.\u003c/p\u003e\n\n\u003cp\u003eYou need to implement every security header on every domain.I hope you implement it\u003c/p\u003e\n","automated_response":false,"created_at":"2018-06-22T08:57:04.883Z","updated_at":"2018-06-22T08:57:04.883Z","actor":{"username":"pal434","cleared":false,"url":"/pal434","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2936180,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"We'll look at adding the proper headers. However I also fail to see how this can be exploited as we only upload our own releases there.","markdown_message":"\u003cp\u003eWe\u0026#39;ll look at adding the proper headers. However I also fail to see how this can be exploited as we only upload our own releases there.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-06-26T12:48:52.112Z","updated_at":"2018-06-26T12:48:52.112Z","actor":{"username":"rullzer","cleared":false,"url":"/rullzer","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/086/005/20095c4a0c77c88375f8db5d6ed10f350d98a5a3_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2936182,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"","markdown_message":"","automated_response":false,"created_at":"2018-06-26T12:49:05.713Z","updated_at":"2018-06-26T12:49:05.713Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Nextcloud"}},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2936466,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@rullzer Can i get swag please?","markdown_message":"\u003cp\u003e\u003ca href=\"/rullzer\"\u003e@rullzer\u003c/a\u003e Can i get swag please?\u003c/p\u003e\n","automated_response":false,"created_at":"2018-06-26T14:25:53.593Z","updated_at":"2018-06-26T14:25:53.593Z","actor":{"username":"pal434","cleared":false,"url":"/pal434","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2942220,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I can't seem to still award swag. Please send me an e-mail at roeland@nextcloud.com and I'll see what I can do\n\nCheers,\n--Roeland","markdown_message":"\u003cp\u003eI can\u0026#39;t seem to still award swag. Please send me an e-mail at \u003ca title=\"roeland@nextcloud.com\" href=\"mailto:roeland@nextcloud.com\" rel=\"nofollow noopener noreferrer\"\u003eroeland@nextcloud.com\u003c/a\u003e and I\u0026#39;ll see what I can do\u003c/p\u003e\n\n\u003cp\u003eCheers,\u003cbr\u003e\n--Roeland\u003c/p\u003e\n","automated_response":false,"created_at":"2018-06-27T20:11:38.673Z","updated_at":"2018-06-27T20:11:38.673Z","actor":{"username":"rullzer","cleared":false,"url":"/rullzer","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/086/005/20095c4a0c77c88375f8db5d6ed10f350d98a5a3_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2942222,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks a lot for your report again. This has been resolved.","markdown_message":"\u003cp\u003eThanks a lot for your report again. This has been resolved.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-06-27T20:12:09.816Z","updated_at":"2018-06-27T20:12:09.816Z","actor":{"username":"rullzer","cleared":false,"url":"/rullzer","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/086/005/20095c4a0c77c88375f8db5d6ed10f350d98a5a3_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"pal434","url":"/pal434"},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6932687,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-01-31T13:58:59.126Z","updated_at":"2020-01-31T13:58:59.126Z","first_to_agree":true,"actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7188533,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-03-01T13:59:09.570Z","updated_at":"2020-03-01T13:59:09.570Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Nextcloud"}},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}