{"id":434116,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC80MzQxMTY=","url":"https://hackerone.com/reports/434116","title":"Exposing voting results on the Slowvote application without actually voting","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2018-11-04T21:59:36.712Z","submitted_at":"2018-11-04T21:59:36.712Z","is_member_of_team?":false,"reporter":{"disabled":true,"username":"mishre","url":"/mishre","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":18,"url":"https://hackerone.com/phabricator","handle":"phabricator","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/018/61446f7e6f0684c8c9f7c36c918b7ecd58183588_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/018/61446f7e6f0684c8c9f7c36c918b7ecd58183588_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Phabricator","twitter_handle":"phabricator","website":"http://phacility.com/phabricator/","about":"Phabricator is a collection of open source web applications that help software companies build better software."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2018-11-05T19:06:59.943Z","bug_reporter_agreed_on_going_public_at":"2018-11-05T19:06:59.889Z","team_member_agreed_on_going_public_at":"2018-11-05T18:25:45.811Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"## Description\nThere is a feature on the Phabricator Slowvote application which allows creating polls and asking questions. The poll creator can choose to only allow people who voted to actually see the poll results. However, it seems that by sending an illegal vote a user can still see the poll's results.\n\n## Steps to reproduce\n1. As user1 creator a poll on the Slowvote application and make it visible for anyone and also check the \"Require a vote to see the responses\" option.\n2. As user2 browse to the poll and see that since you haven't voted you can't see the actual result.\n3. As user2 choose one of the options and vote while intercepting the request.\n4. Change the \"vote%5B%5D\" parameter to contain an illegal vote_id (usually just a big number should be enough).\n5. See that you can now see the poll's results but you didn't actually vote.\n\n## Mitigation\nYou should probably verify that the user is actually voting for a valid option.\n\n## Impact\n\nAn unauthorized user can see poll results without making a vote as required by an admin.","vulnerability_information_html":"\u003ch2 id=\"description\"\u003eDescription\u003c/h2\u003e\n\n\u003cp\u003eThere is a feature on the Phabricator Slowvote application which allows creating polls and asking questions. The poll creator can choose to only allow people who voted to actually see the poll results. However, it seems that by sending an illegal vote a user can still see the poll\u0026#39;s results.\u003c/p\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps to reproduce\u003c/h2\u003e\n\n\u003col\u003e\n\u003cli\u003eAs user1 creator a poll on the Slowvote application and make it visible for anyone and also check the \u0026quot;Require a vote to see the responses\u0026quot; option.\u003c/li\u003e\n\u003cli\u003eAs user2 browse to the poll and see that since you haven\u0026#39;t voted you can\u0026#39;t see the actual result.\u003c/li\u003e\n\u003cli\u003eAs user2 choose one of the options and vote while intercepting the request.\u003c/li\u003e\n\u003cli\u003eChange the \u0026quot;vote%5B%5D\u0026quot; parameter to contain an illegal vote_id (usually just a big number should be enough).\u003c/li\u003e\n\u003cli\u003eSee that you can now see the poll\u0026#39;s results but you didn\u0026#39;t actually vote.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003ch2 id=\"mitigation\"\u003eMitigation\u003c/h2\u003e\n\n\u003cp\u003eYou should probably verify that the user is actually voting for a valid option.\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eAn unauthorized user can see poll results without making a vote as required by an admin.\u003c/p\u003e\n","bounty_amount":"300.0","formatted_bounty":"$300","original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2018-12-05T18:25:45.996Z","allow_singular_disclosure_after":-65187108.1779253,"singular_disclosure_allowed":true,"vote_count":11,"voters":["mygf","asad0x01_","eveeez","xiaoyinl","an0nym0us","sh0a1b","cryptographer","0x08","mvpprincess","sotoayam1212","and 1 more..."],"severity":{"rating":"low","author_type":"User"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":3585247,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Since you can change your vote at any time and there's no record of the vote change this really pushes the boundaries of plausibility as a security issue versus a mundane bug, but I think this is at least vaguely shaped like a security issue so we'll accept it. I'll probably have a chance to get a fix in tomorrow.","markdown_message":"\u003cp\u003eSince you can change your vote at any time and there\u0026#39;s no record of the vote change this really pushes the boundaries of plausibility as a security issue versus a mundane bug, but I think this is at least vaguely shaped like a security issue so we\u0026#39;ll accept it. I\u0026#39;ll probably have a chance to get a fix in tomorrow.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-11-05T00:51:41.791Z","updated_at":"2018-11-05T00:51:41.791Z","actor":{"username":"epriestley","cleared":false,"url":"/epriestley","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/043/3ebca5250ea5abd54b49ccc9d69c636af4585b2e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"phabricator","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3588922,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"This should be fixed by these changes:\n\n\u003chttps://secure.phabricator.com/D19773\u003e\n\u003chttps://secure.phabricator.com/D19774\u003e\n\nThey add validation to prevent users from voting for invalid options.","markdown_message":"\u003cp\u003eThis should be fixed by these changes:\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"https://secure.phabricator.com/D19773\" href=\"/redirect?url=https%3A%2F%2Fsecure.phabricator.com%2FD19773\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://secure.phabricator.com/D19773\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\n\u003ca title=\"https://secure.phabricator.com/D19774\" href=\"/redirect?url=https%3A%2F%2Fsecure.phabricator.com%2FD19774\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://secure.phabricator.com/D19774\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eThey add validation to prevent users from voting for invalid options.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-11-05T18:23:35.936Z","updated_at":"2018-11-05T18:23:35.936Z","actor":{"username":"epriestley","cleared":false,"url":"/epriestley","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/043/3ebca5250ea5abd54b49ccc9d69c636af4585b2e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"phabricator","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3588925,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Presuming this is resolved, but let us know if you catch any issues with the patches.","markdown_message":"\u003cp\u003ePresuming this is resolved, but let us know if you catch any issues with the patches.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-11-05T18:23:54.328Z","updated_at":"2018-11-05T18:23:54.328Z","actor":{"username":"epriestley","cleared":false,"url":"/epriestley","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/043/3ebca5250ea5abd54b49ccc9d69c636af4585b2e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"mishre","url":"/mishre"},"genius_execution_id":null,"team_handle":"phabricator","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3588934,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"I'm awarding this report the minimum project award because the impact is incredibly low and it's really more of a bug report than a security issue.","markdown_message":"\u003cp\u003eI\u0026#39;m awarding this report the minimum project award because the impact is incredibly low and it\u0026#39;s really more of a bug report than a security issue.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-11-05T18:25:25.882Z","updated_at":"2018-11-05T18:25:25.882Z","actor":{"url":"/phabricator","ibb":true,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/018/61446f7e6f0684c8c9f7c36c918b7ecd58183588_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Phabricator"}},"bounty_amount":"300.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"phabricator","collaborator":{"username":"mishre","url":"/mishre"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3588936,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"The patches are public, so this can be disclosed at any time.","markdown_message":"\u003cp\u003eThe patches are public, so this can be disclosed at any time.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-11-05T18:25:45.868Z","updated_at":"2018-11-05T18:25:45.868Z","first_to_agree":true,"actor":{"username":"epriestley","cleared":false,"url":"/epriestley","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/043/3ebca5250ea5abd54b49ccc9d69c636af4585b2e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"phabricator","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3589175,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-11-05T19:06:59.904Z","updated_at":"2018-11-05T19:06:59.904Z","actor":{"username":"mishre","cleared":false,"url":"/mishre","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"phabricator","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3589176,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-11-05T19:06:59.957Z","updated_at":"2018-11-05T19:06:59.957Z","actor":{"username":"mishre","cleared":false,"url":"/mishre","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"phabricator","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}