{"id":740037,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC83NDAwMzc=","url":"https://hackerone.com/reports/740037","title":"Request smuggling on admin-official.line.me could lead to account takeover","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2019-11-18T19:02:20.037Z","submitted_at":"2019-11-18T19:02:20.037Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"shaolin_tw","url":"/shaolin_tw","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13343,"url":"https://hackerone.com/line","handle":"line","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/013/343/67ba6d45bd787db0f9fbfeb13038b8fbd9df40aa_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/343/67ba6d45bd787db0f9fbfeb13038b8fbd9df40aa_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"LINE","twitter_handle":"","website":"https://line.me","about":"LINE Security Bug Bounty Program"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"no-content","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2020-05-19T12:47:09.957Z","bug_reporter_agreed_on_going_public_at":"2020-05-19T12:47:09.855Z","team_member_agreed_on_going_public_at":"2020-04-14T09:37:58.552Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"","vulnerability_information_html":"","bounty_amount":"9000.0","formatted_bounty":"$9,000","weakness":{"id":86,"name":"HTTP Request Smuggling"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":547,"voters":["mehqq","r4d1kal","sturedman","sw33tlie","lpi","hackerontwowheels","m0chan","n1m0","secator","geroriv","and 537 more..."],"severity":{"rating":"high","author_type":"User"},"structured_scope":{"databaseId":16958,"asset_type":"URL","asset_identifier":"*.line.me","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":6342317,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2019-11-19T04:06:39.813Z","updated_at":"2019-11-19T04:06:39.813Z","actor":{"username":"tyage_line","cleared":false,"url":"/tyage_line","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"line","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6345306,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2019-11-19T12:03:41.561Z","updated_at":"2019-11-19T12:03:41.561Z","actor":{"username":"tyage_line","cleared":false,"url":"/tyage_line","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"line","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6345536,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2019-11-19T12:50:44.121Z","updated_at":"2019-11-19T12:50:44.121Z","actor":{"username":"shaolin_tw","cleared":false,"url":"/shaolin_tw","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"line","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6470539,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2019-12-05T04:13:06.508Z","updated_at":"2019-12-05T04:13:06.508Z","actor":{"username":"p_p","cleared":false,"url":"/p_p","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/635/803/f09a40d90bc39c3099bf22e83e21b6ec71bf3f58_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"line","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6472605,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2019-12-05T10:58:26.861Z","updated_at":"2019-12-05T10:58:26.861Z","actor":{"username":"shaolin_tw","cleared":false,"url":"/shaolin_tw","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"line","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6539406,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2019-12-13T08:41:30.522Z","updated_at":"2019-12-13T08:41:30.522Z","actor":{"username":"p_p","cleared":false,"url":"/p_p","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/635/803/f09a40d90bc39c3099bf22e83e21b6ec71bf3f58_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"line","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6575638,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2019-12-18T07:40:17.046Z","updated_at":"2019-12-18T07:40:17.046Z","actor":{"username":"shaolin_tw","cleared":false,"url":"/shaolin_tw","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"line","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6575706,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2019-12-18T07:57:35.980Z","updated_at":"2019-12-18T07:57:35.980Z","actor":{"username":"p_p","cleared":false,"url":"/p_p","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/635/803/f09a40d90bc39c3099bf22e83e21b6ec71bf3f58_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"line","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6714090,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2020-01-08T04:45:21.391Z","updated_at":"2020-01-08T04:45:21.391Z","actor":{"username":"p_p","cleared":false,"url":"/p_p","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/635/803/f09a40d90bc39c3099bf22e83e21b6ec71bf3f58_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"line","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6714305,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2020-01-08T06:30:14.297Z","updated_at":"2020-01-08T06:30:14.297Z","actor":{"username":"shaolin_tw","cleared":false,"url":"/shaolin_tw","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"line","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6775854,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2020-01-15T10:59:17.875Z","updated_at":"2020-01-15T10:59:17.875Z","actor":{"username":"muchfimuchfeelz","cleared":false,"url":"/muchfimuchfeelz","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/605/208/f646f7c53ebc0899a28c99d95a34b623deb054b7_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"line","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6779287,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2020-01-15T17:29:00.009Z","updated_at":"2020-01-15T17:29:00.009Z","actor":{"username":"shaolin_tw","cleared":false,"url":"/shaolin_tw","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"line","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6796521,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2020-01-17T04:37:54.508Z","updated_at":"2020-01-17T04:37:54.508Z","actor":{"username":"p_p","cleared":false,"url":"/p_p","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/635/803/f09a40d90bc39c3099bf22e83e21b6ec71bf3f58_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"line","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6975064,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2020-02-06T03:21:53.418Z","updated_at":"2020-02-06T03:21:53.418Z","actor":{"url":"/line","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/343/67ba6d45bd787db0f9fbfeb13038b8fbd9df40aa_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"LINE"}},"bounty_amount":"9000.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"line","collaborator":{"username":"shaolin_tw","url":"/shaolin_tw"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7001058,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2020-02-09T18:58:17.541Z","updated_at":"2020-02-09T18:58:17.541Z","actor":{"username":"shaolin_tw","cleared":false,"url":"/shaolin_tw","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"line","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7002071,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2020-02-10T03:05:08.580Z","updated_at":"2020-02-10T03:05:08.580Z","actor":{"username":"p_p","cleared":false,"url":"/p_p","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/635/803/f09a40d90bc39c3099bf22e83e21b6ec71bf3f58_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"shaolin_tw","url":"/shaolin_tw"},"genius_execution_id":null,"team_handle":"line","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7004969,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2020-02-10T10:31:08.274Z","updated_at":"2020-02-10T10:31:08.274Z","actor":{"username":"shaolin_tw","cleared":false,"url":"/shaolin_tw","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"line","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7654467,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-04-14T09:37:58.591Z","updated_at":"2020-04-14T09:37:58.591Z","first_to_agree":true,"actor":{"username":"p_p","cleared":false,"url":"/p_p","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/635/803/f09a40d90bc39c3099bf22e83e21b6ec71bf3f58_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"line","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8047711,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-05-19T12:47:09.877Z","updated_at":"2020-05-19T12:47:09.877Z","actor":{"username":"shaolin_tw","cleared":false,"url":"/shaolin_tw","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"line","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8047712,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-05-19T12:47:09.979Z","updated_at":"2020-05-19T12:47:09.979Z","actor":{"username":"shaolin_tw","cleared":false,"url":"/shaolin_tw","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"line","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":21241,"category":"team","content":"The reporter identified a request smuggling issue on admin-official.line.me [(TE.CL-type).](https://portswigger.net/research/http-desync-attacks-request-smuggling-reborn) The reporter clearly illustrated the impact without putting our users at risk or affecting the stability of our service. For this we would like to thank @shaolin_tw!\n\nThis issue was the result of how our load balancers were forwarding requests to the backend services. It had widespread influence and the report allowed us to resolve the issue internally, as well as make the vendor of the load balancers aware of this possible issue when using their product. The contents of the report allowed us to identify and prevent similar issues elsewhere in our infrastructure","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eThe reporter identified a request smuggling issue on admin-official.line.me \u003ca href=\"/redirect?url=https%3A%2F%2Fportswigger.net%2Fresearch%2Fhttp-desync-attacks-request-smuggling-reborn\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003e(TE.CL-type).\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e The reporter clearly illustrated the impact without putting our users at risk or affecting the stability of our service. For this we would like to thank \u003ca href=\"/shaolin_tw\"\u003e@shaolin_tw\u003c/a\u003e!\u003c/p\u003e\n\n\u003cp\u003eThis issue was the result of how our load balancers were forwarding requests to the backend services. It had widespread influence and the report allowed us to resolve the issue internally, as well as make the vendor of the load balancers aware of this possible issue when using their product. The contents of the report allowed us to identify and prevent similar issues elsewhere in our infrastructure\u003c/p\u003e\n"},{"category":"researcher","can_view?":true,"can_create?":false}]}