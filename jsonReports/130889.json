{"id":130889,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMzA4ODk=","url":"https://hackerone.com/reports/130889","title":"Reflected XSS in scores.ubnt.com","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-04-14T19:43:14.557Z","submitted_at":"2016-04-14T19:43:14.557Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"enmach","url":"/enmach","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/063/112/1148fb137d546a55fde7af2f1435b26e36cc1b60_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":800,"url":"https://hackerone.com/ui","handle":"ui","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/800/449ca06f77c3e1dd1979bae1e5f16150334f7479_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/800/449ca06f77c3e1dd1979bae1e5f16150334f7479_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Ubiquiti Inc.","twitter_handle":"ubnt","website":"https://ui.com","about":""}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2016-08-11T12:41:57.736Z","bug_reporter_agreed_on_going_public_at":"2016-07-12T12:41:54.913Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Parameter p in https://scores.ubnt.com/form.html?uid=1\u0026p=airFiber is vulnerable to XSS. If a user logs in at https://account.ubnt.com/login and visits https://scores.ubnt.com/form.html?uid=1\u0026p=airFiber\"\u003e\u003cscript\u003ealert(document.cookie);\u003c/script\u003e, a message box will be presented with his cookie. Attached is a POC (xss-scores-chrome.png). \n\nVulnerable code of https://scores.ubnt.com/form.html is also attached (xss-vuln-code.png), where it is visible that product  (parameter p) is included without proper input validation. \n\nThis vulnerability can be used to steal cookies (session data) from authenticated users  as also for phishing attacks. It can be exploited by  sending a malicious link to users or posting this link to a forum. \n\nAs UBNT implements SSO, this can be very dangerous. \n\nTo mitigate this vulnerability, consider the following:\n\n*output encoding of all special characters\n*input validation of data suplied from users","vulnerability_information_html":"\u003cp\u003eParameter p in \u003ca title=\"https://scores.ubnt.com/form.html?uid=1\u0026amp;p=airFiber\" href=\"/redirect?url=https%3A%2F%2Fscores.ubnt.com%2Fform.html%3Fuid%3D1%26p%3DairFiber\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://scores.ubnt.com/form.html?uid=1\u0026amp;p=airFiber\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e is vulnerable to XSS. If a user logs in at \u003ca title=\"https://account.ubnt.com/login\" href=\"/redirect?url=https%3A%2F%2Faccount.ubnt.com%2Flogin\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://account.ubnt.com/login\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e and visits \u003ca title=\"https://scores.ubnt.com/form.html?uid=1\u0026amp;p=airFiber%22%3E\" href=\"/redirect?url=https%3A%2F%2Fscores.ubnt.com%2Fform.html%3Fuid%3D1%26p%3DairFiber%2522%253E\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://scores.ubnt.com/form.html?uid=1\u0026amp;p=airFiber%22%3E\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u0026lt;script\u0026gt;alert(document.cookie);\u0026lt;/script\u0026gt;, a message box will be presented with his cookie. Attached is a POC (xss-scores-chrome.png). \u003c/p\u003e\n\n\u003cp\u003eVulnerable code of \u003ca title=\"https://scores.ubnt.com/form.html\" href=\"/redirect?url=https%3A%2F%2Fscores.ubnt.com%2Fform.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://scores.ubnt.com/form.html\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e is also attached (xss-vuln-code.png), where it is visible that product  (parameter p) is included without proper input validation. \u003c/p\u003e\n\n\u003cp\u003eThis vulnerability can be used to steal cookies (session data) from authenticated users  as also for phishing attacks. It can be exploited by  sending a malicious link to users or posting this link to a forum. \u003c/p\u003e\n\n\u003cp\u003eAs UBNT implements SSO, this can be very dangerous. \u003c/p\u003e\n\n\u003cp\u003eTo mitigate this vulnerability, consider the following:\u003c/p\u003e\n\n\u003cp\u003e*output encoding of all special characters\u003cbr\u003e\n*input validation of data suplied from users\u003c/p\u003e\n","bounty_amount":"275.0","formatted_bounty":"$275","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":85611,"file_name":"xss-scores-chrome.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/085/611/4fc6bbc600fd3891057b68cb91f014dd6f63edb3/xss-scores-chrome.png?response-content-disposition=attachment%3B%20filename%3D%22xss-scores-chrome.png%22%3B%20filename%2A%3DUTF-8%27%27xss-scores-chrome.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ3MMGRP5H%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T042446Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCICEZ9R%2B2RJ3GrTP6l%2FPAFADJG1t55InVtXNQpLfOPgHaAiEA9vebVe9XdCpFDuGnxxWe2Ve48e%2FtAoig8YYxqZ7es78qtAMIUhABGgwwMTM2MTkyNzQ4NDkiDH6RMqd3Km1HzDzcXiqRAw9Zi9Zyah%2FL7m5qi9w2XsNDr%2F5ZZ%2F5Gny1bCMAgWHuEH9Lmtzfddi67Q3u82zHSnheCFLE%2BUTr6KCbyVouh2s6I1Iw5FpZ4LCl2Jts%2FOYIW3f51kFQhZ3sOfoeJ95jG2hfROCEhzpnA30iPS6xMNw87KO9Qo4x%2FBM37CIhv4A0%2FSU0JbwvczB01wva%2FQJkiH6lH1ZVS3EG6yUh%2Feq8kDGf%2FnGRgLcxw3MK7jT4GG1knwEEDIQOAuumsmWt3QDUH6dFWYx57C2QS76Xr1I1ub7Ob050enItoD3hnXR1F2lhC9JZWyDDS3sRTHvPx0voGVfuM803u8XTKLOZxTNSBY1S8m7RRU55us25%2BTyEe9Q6J6l3ZXKJZ8Jv02FW7RtNRHdPm0L6O0I3vOQbn8GiBG%2FkhDZRW3AOAiJuB4Bhd6Ns7j3YXA9nKlctO1uYmAj%2B6nssjBtl1lKabSm0eGuk7Feh%2B9jG%2BgpNFzxS0iYgysVfwkvplnvmKgReLAD4JvjZ9sdbv66UX5MyW9gDVXf0wfna3MN2Fqv8FOusBFyKfufPYQYGFwO4tvl1lihdDkLnCZcRwmXrB0gYZzbAneLC1UJ9NimBCebx3LEek%2BJ0J1MdqCNRGrLEY92gh38wj7A61ZNLFh9KTVAiyEFWLju0gH5kr3ndnXguXCxD19p54ZTSuYzlTQ9ArEyfvPBo%2F%2BWy25KkCTRlm376pduEzwhG4%2FgpY13ZbeNcDXcGVf2lvpy33oGJqXFcfCgWJYbDCm0M%2FBGBrkOhnizXl7hE2kfO2aQgP2N8b5LucE1O2Tl%2B%2B7ABCWc7Sl7RPhipBfTbyd%2FEfgt9ObkPFxAc0xnS36iwoGt1oKkhotg%3D%3D\u0026X-Amz-Signature=61fd6aa7151bbb2e4eec6ce882685d90401644cfc7a34f68076aeb4820767aee","file_size":90272,"type":"image/png"},{"id":85614,"file_name":"xss-vuln-code.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/085/614/24c4b4249686155ea8d47874c8f67dca454e4477/xss-vuln-code.png?response-content-disposition=attachment%3B%20filename%3D%22xss-vuln-code.png%22%3B%20filename%2A%3DUTF-8%27%27xss-vuln-code.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ3MMGRP5H%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T042446Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCICEZ9R%2B2RJ3GrTP6l%2FPAFADJG1t55InVtXNQpLfOPgHaAiEA9vebVe9XdCpFDuGnxxWe2Ve48e%2FtAoig8YYxqZ7es78qtAMIUhABGgwwMTM2MTkyNzQ4NDkiDH6RMqd3Km1HzDzcXiqRAw9Zi9Zyah%2FL7m5qi9w2XsNDr%2F5ZZ%2F5Gny1bCMAgWHuEH9Lmtzfddi67Q3u82zHSnheCFLE%2BUTr6KCbyVouh2s6I1Iw5FpZ4LCl2Jts%2FOYIW3f51kFQhZ3sOfoeJ95jG2hfROCEhzpnA30iPS6xMNw87KO9Qo4x%2FBM37CIhv4A0%2FSU0JbwvczB01wva%2FQJkiH6lH1ZVS3EG6yUh%2Feq8kDGf%2FnGRgLcxw3MK7jT4GG1knwEEDIQOAuumsmWt3QDUH6dFWYx57C2QS76Xr1I1ub7Ob050enItoD3hnXR1F2lhC9JZWyDDS3sRTHvPx0voGVfuM803u8XTKLOZxTNSBY1S8m7RRU55us25%2BTyEe9Q6J6l3ZXKJZ8Jv02FW7RtNRHdPm0L6O0I3vOQbn8GiBG%2FkhDZRW3AOAiJuB4Bhd6Ns7j3YXA9nKlctO1uYmAj%2B6nssjBtl1lKabSm0eGuk7Feh%2B9jG%2BgpNFzxS0iYgysVfwkvplnvmKgReLAD4JvjZ9sdbv66UX5MyW9gDVXf0wfna3MN2Fqv8FOusBFyKfufPYQYGFwO4tvl1lihdDkLnCZcRwmXrB0gYZzbAneLC1UJ9NimBCebx3LEek%2BJ0J1MdqCNRGrLEY92gh38wj7A61ZNLFh9KTVAiyEFWLju0gH5kr3ndnXguXCxD19p54ZTSuYzlTQ9ArEyfvPBo%2F%2BWy25KkCTRlm376pduEzwhG4%2FgpY13ZbeNcDXcGVf2lvpy33oGJqXFcfCgWJYbDCm0M%2FBGBrkOhnizXl7hE2kfO2aQgP2N8b5LucE1O2Tl%2B%2B7ABCWc7Sl7RPhipBfTbyd%2FEfgt9ObkPFxAc0xnS36iwoGt1oKkhotg%3D%3D\u0026X-Amz-Signature=db3bd48149b0ce9f1e29e389b1dd7c1815728303e8a6700fe2de9a5d92e806f4","file_size":48796,"type":"image/png"}],"allow_singular_disclosure_at":"2016-08-11T12:41:55.109Z","allow_singular_disclosure_after":-138296571.1980309,"singular_disclosure_allowed":true,"vote_count":10,"voters":["hunter","ysx","mbozan","faisalahmed","jens","gopi","dyabla","rishi62","lighth88","kayonariel"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":908196,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2016-04-15T17:23:35.787Z","updated_at":"2016-04-15T17:23:35.787Z","actor":{"username":"ubnt-james","cleared":false,"url":"/ubnt-james","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ui","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":908209,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi there,\n\nThanks for the submission.  I have forwarded to the developers and will let you know when we have an update.  \n\n","markdown_message":"\u003cp\u003eHi there,\u003c/p\u003e\n\n\u003cp\u003eThanks for the submission.  I have forwarded to the developers and will let you know when we have an update.  \u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-15T17:24:45.952Z","updated_at":"2016-04-15T17:24:45.952Z","actor":{"username":"ubnt-james","cleared":false,"url":"/ubnt-james","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ui","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":908663,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi there,\n\nWe believe this should be patched now.  When you have a chance could you confirm?\n\n","markdown_message":"\u003cp\u003eHi there,\u003c/p\u003e\n\n\u003cp\u003eWe believe this should be patched now.  When you have a chance could you confirm?\u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-15T21:04:38.528Z","updated_at":"2016-04-15T21:04:38.528Z","actor":{"username":"ubnt-james","cleared":false,"url":"/ubnt-james","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ui","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":909285,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi, \n\nI am confirming that it has been patched. \n","markdown_message":"\u003cp\u003eHi, \u003c/p\u003e\n\n\u003cp\u003eI am confirming that it has been patched. \u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-16T04:45:14.498Z","updated_at":"2016-04-16T04:45:14.498Z","actor":{"username":"enmach","cleared":false,"url":"/enmach","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/063/112/1148fb137d546a55fde7af2f1435b26e36cc1b60_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ui","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":912637,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2016-04-18T18:13:50.849Z","updated_at":"2016-04-18T18:13:50.849Z","actor":{"url":"/ui","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/800/449ca06f77c3e1dd1979bae1e5f16150334f7479_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Ubiquiti Inc."}},"bounty_amount":"275.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"ui","collaborator":{"username":"enmach","url":"/enmach"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":912640,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hi enmach,\n\nThanks for taking the time to test and confirm!.\n\n","markdown_message":"\u003cp\u003eHi enmach,\u003c/p\u003e\n\n\u003cp\u003eThanks for taking the time to test and confirm!.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-18T18:14:24.086Z","updated_at":"2016-04-18T18:14:24.086Z","actor":{"username":"ubnt-james","cleared":false,"url":"/ubnt-james","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"enmach","url":"/enmach"},"genius_execution_id":null,"team_handle":"ui","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1064940,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-07-12T12:41:55.012Z","updated_at":"2016-07-12T12:41:55.012Z","first_to_agree":true,"actor":{"username":"enmach","cleared":false,"url":"/enmach","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/063/112/1148fb137d546a55fde7af2f1435b26e36cc1b60_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ui","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1119237,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-08-11T12:41:57.861Z","updated_at":"2016-08-11T12:41:57.861Z","actor":{"url":"/ui","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/800/449ca06f77c3e1dd1979bae1e5f16150334f7479_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Ubiquiti Inc."}},"genius_execution_id":null,"team_handle":"ui","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}