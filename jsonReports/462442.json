{"id":462442,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC80NjI0NDI=","url":"https://hackerone.com/reports/462442","title":"Unauthorized access of Monero wallet by an unprivileged process","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2018-12-14T13:45:15.815Z","submitted_at":"2018-12-14T13:45:15.815Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"thanhb","url":"/thanhb","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/021/219/a54415c85154bd79801c8bc3e64ed882554db9a5_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":7731,"url":"https://hackerone.com/monero","handle":"monero","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/007/731/55634f7fcd917725c7a5771cc6e7c9b4d5fe0c22_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/007/731/55634f7fcd917725c7a5771cc6e7c9b4d5fe0c22_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Monero","twitter_handle":"monero","website":"https://getmonero.org","about":" Monero: the secure, private, untraceable cryptocurrency"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2019-04-03T22:38:50.924Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2019-03-04T22:38:45.957Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"## Description:\nAs per our understanding, Monero wallet app provides a separate executable for the user to enable the RPC interface (monero-wallet-rpc). When the user runs the executable, the RPC server will start on a port number that is specified by the user. The RPC server authenticates the client with the HTTP digest access authentication scheme, which is based on a simple challenge-response paradigm. Basically, the client receives a nonce from the server and then replies with a MD5 hash value of the username, the password, the nonce, the HTTP method, and the URI. \n\nAn attacker is a non-privileged user, who can sign in to the victim’s computer with his own credentials or guest account. The attacker first needs to run a process in the background when the victim is using the computer. On Linux and macOS, the attacker only needs to log in, run the process, and leave it running when he logs out. On Windows, user processes are killed at the end of the login session, and thus the attacker needs to do fast user switching to leave his session in the background. The attacker can also remotely run his malicious process if SSH or remote desktop is enabled on the target computer.\n\nWith the malicious process running in the background, it is possible to perform server impersonation on the Monero wallet by hijacking the port number before the victim starts the RPC server. The digest access authentication mechanism does not help here because it only authenticates the client. However, the RPC executable will fail to start if the port that it uses has already been taken. While this allows the victim to detect the attack, it does not free him from risks. For example, an aggressively-caching user may attach the RPC executable to the operating system's startup to launch it automatically after login for convenience. In that case, since the RPC server process does not have a GUI to notify the victim that it has failed, the victim will not notice the failure and thus assume that the RPC server is running. Hence, the attacker's malicious server captures commands from the benign client. An example of such commands is “create_wallet”, which tells the server to create a new wallet account. This allows the attacker to have access to the new account because it is created by the attacker instead of the real wallet application.\n\nThe attack is straightforward, and no privilege escalation is needed. Also, there are many potential attackers who can perform the attack. For example, in enterprise environments that employ centralized access control mechanisms and allow login by multiple users to the same computer, anyone is a potential attacker. Any computer with guest account enabled is similarly vulnerable.\n\n## Releases Affected:\nTested on Monero wallet 0.12.3\n\n## How to fix:\nWe found similar issues on other cryptocurrencies’ wallet applications and are working with them to address the issues. There are various ways to prevent the attack, some of which are as follows:\n- Mandate the use of TLS on the RPC interface.\n- The RPC server accepts only RPC clients that are owned by users belonging to Administrators or a special group.\n\n## Supporting Material/References:\nRecently, we have shown similar critical vulnerabilities in many well-known password managers, hardware tokens, and other security-critical applications at Usenix Security and DefCon: \nhttps://www.usenix.org/conference/usenixsecurity18/presentation/bui\n\n## Impact\n\nAccess to the victim's wallet without knowing authentication credentials.","vulnerability_information_html":"\u003ch2 id=\"description\"\u003eDescription:\u003c/h2\u003e\n\n\u003cp\u003eAs per our understanding, Monero wallet app provides a separate executable for the user to enable the RPC interface (monero-wallet-rpc). When the user runs the executable, the RPC server will start on a port number that is specified by the user. The RPC server authenticates the client with the HTTP digest access authentication scheme, which is based on a simple challenge-response paradigm. Basically, the client receives a nonce from the server and then replies with a MD5 hash value of the username, the password, the nonce, the HTTP method, and the URI. \u003c/p\u003e\n\n\u003cp\u003eAn attacker is a non-privileged user, who can sign in to the victim’s computer with his own credentials or guest account. The attacker first needs to run a process in the background when the victim is using the computer. On Linux and macOS, the attacker only needs to log in, run the process, and leave it running when he logs out. On Windows, user processes are killed at the end of the login session, and thus the attacker needs to do fast user switching to leave his session in the background. The attacker can also remotely run his malicious process if SSH or remote desktop is enabled on the target computer.\u003c/p\u003e\n\n\u003cp\u003eWith the malicious process running in the background, it is possible to perform server impersonation on the Monero wallet by hijacking the port number before the victim starts the RPC server. The digest access authentication mechanism does not help here because it only authenticates the client. However, the RPC executable will fail to start if the port that it uses has already been taken. While this allows the victim to detect the attack, it does not free him from risks. For example, an aggressively-caching user may attach the RPC executable to the operating system\u0026#39;s startup to launch it automatically after login for convenience. In that case, since the RPC server process does not have a GUI to notify the victim that it has failed, the victim will not notice the failure and thus assume that the RPC server is running. Hence, the attacker\u0026#39;s malicious server captures commands from the benign client. An example of such commands is “create_wallet”, which tells the server to create a new wallet account. This allows the attacker to have access to the new account because it is created by the attacker instead of the real wallet application.\u003c/p\u003e\n\n\u003cp\u003eThe attack is straightforward, and no privilege escalation is needed. Also, there are many potential attackers who can perform the attack. For example, in enterprise environments that employ centralized access control mechanisms and allow login by multiple users to the same computer, anyone is a potential attacker. Any computer with guest account enabled is similarly vulnerable.\u003c/p\u003e\n\n\u003ch2 id=\"releases-affected\"\u003eReleases Affected:\u003c/h2\u003e\n\n\u003cp\u003eTested on Monero wallet 0.12.3\u003c/p\u003e\n\n\u003ch2 id=\"how-to-fix\"\u003eHow to fix:\u003c/h2\u003e\n\n\u003cp\u003eWe found similar issues on other cryptocurrencies’ wallet applications and are working with them to address the issues. There are various ways to prevent the attack, some of which are as follows:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eMandate the use of TLS on the RPC interface.\u003c/li\u003e\n\u003cli\u003eThe RPC server accepts only RPC clients that are owned by users belonging to Administrators or a special group.\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch2 id=\"supporting-material-references\"\u003eSupporting Material/References:\u003c/h2\u003e\n\n\u003cp\u003eRecently, we have shown similar critical vulnerabilities in many well-known password managers, hardware tokens, and other security-critical applications at Usenix Security and DefCon: \u003cbr\u003e\n\u003ca title=\"https://www.usenix.org/conference/usenixsecurity18/presentation/bui\" href=\"/redirect?url=https%3A%2F%2Fwww.usenix.org%2Fconference%2Fusenixsecurity18%2Fpresentation%2Fbui\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.usenix.org/conference/usenixsecurity18/presentation/bui\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eAccess to the victim\u0026#39;s wallet without knowing authentication credentials.\u003c/p\u003e\n","weakness":{"id":26,"name":"Improper Access Control - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2019-04-03T22:38:46.011Z","allow_singular_disclosure_after":-54890576.06350549,"singular_disclosure_allowed":true,"vote_count":9,"voters":["mygf","khizer47","cr4xerbik4sh","aslanemre","reddmist","thanhb","far_n_y","0rangeh4t","mysteriousm"],"severity":{"rating":"high","author_type":"User"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":3879798,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Unless I'm missing something, your report is essentially \"the attacker runs a fake server on the right port on the server that's supposed to run monero-wallet-rpc, and just captures the data from clients\", right ? If so, OK, that works, but that's not a monero vuln. If it is, then any server can be said to have that vuln.\nDid I miss a subtlety here ?","markdown_message":"\u003cp\u003eUnless I\u0026#39;m missing something, your report is essentially \u0026quot;the attacker runs a fake server on the right port on the server that\u0026#39;s supposed to run monero-wallet-rpc, and just captures the data from clients\u0026quot;, right ? If so, OK, that works, but that\u0026#39;s not a monero vuln. If it is, then any server can be said to have that vuln.\u003cbr\u003e\nDid I miss a subtlety here ?\u003c/p\u003e\n","automated_response":false,"created_at":"2018-12-21T22:51:05.267Z","updated_at":"2018-12-21T22:51:05.267Z","actor":{"username":"moneromooo","cleared":false,"url":"/moneromooo","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"monero","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3887519,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"","markdown_message":"","automated_response":false,"created_at":"2018-12-24T21:26:34.602Z","updated_at":"2018-12-24T21:26:34.602Z","actor":{"username":"anonimal","cleared":false,"url":"/anonimal","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/040/857/f23cc3be09a21e17bc43975987c10ba2b6427239_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"monero","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3895557,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Not all servers have that vulnerability. Web servers, for example, are usually protected with TLS. While local attacker can run a fake server on the right port on the same machine, here we consider only unprivileged attackers who cannot access the TLS private key if the key is properly protected with OS's access control. \n\nEven local servers, which are supposed to be accessed only by local processes, should not have the mentioned vulnerability because it would allow any user, including guest, to attack other users on the same computer without privilege escalation. This is not desirable for enterprise users or those who has guest account enabled. Because of this, many applications with local client-server architecture, such as password managers, databases and VPN apps, have implemented various  measures to protect their users' data. ","markdown_message":"\u003cp\u003eNot all servers have that vulnerability. Web servers, for example, are usually protected with TLS. While local attacker can run a fake server on the right port on the same machine, here we consider only unprivileged attackers who cannot access the TLS private key if the key is properly protected with OS\u0026#39;s access control. \u003c/p\u003e\n\n\u003cp\u003eEven local servers, which are supposed to be accessed only by local processes, should not have the mentioned vulnerability because it would allow any user, including guest, to attack other users on the same computer without privilege escalation. This is not desirable for enterprise users or those who has guest account enabled. Because of this, many applications with local client-server architecture, such as password managers, databases and VPN apps, have implemented various  measures to protect their users\u0026#39; data. \u003c/p\u003e\n","automated_response":false,"created_at":"2018-12-27T09:48:03.741Z","updated_at":"2018-12-27T09:48:03.741Z","actor":{"username":"thanhb","cleared":false,"url":"/thanhb","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/021/219/a54415c85154bd79801c8bc3e64ed882554db9a5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"monero","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3920085,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"OK, so I didn't miss anything, thanks.\n\nI made a patch to add TLS on connections a while ago, along with whitelisting of peer certs, but it was rejected. See https://github.com/monero-project/monero/pull/4054, and https://github.com/monero-project/monero/pull/4852. Another contributor recently added the ability to listen via a Tor hidden service. See https://github.com/monero-project/monero/pull/4988. This is being improved so that a RPC server will be able to run as a hidden service (currently it's P2P only), which should make this vector moot when used (since the fake server would have to know the secret key used to host the hidden service). \n\nMandating Tor use for RPC servers might prove too much of an obstacle though. Feel free to comment on 4852 about this. I'd be happy to update my SSL patch if objections were reconsidered, as the technical comments were trivial to address.\n","markdown_message":"\u003cp\u003eOK, so I didn\u0026#39;t miss anything, thanks.\u003c/p\u003e\n\n\u003cp\u003eI made a patch to add TLS on connections a while ago, along with whitelisting of peer certs, but it was rejected. See \u003ca title=\"https://github.com/monero-project/monero/pull/4054\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fmonero-project%2Fmonero%2Fpull%2F4054\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/monero-project/monero/pull/4054\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e, and \u003ca title=\"https://github.com/monero-project/monero/pull/4852\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fmonero-project%2Fmonero%2Fpull%2F4852\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/monero-project/monero/pull/4852\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e. Another contributor recently added the ability to listen via a Tor hidden service. See \u003ca title=\"https://github.com/monero-project/monero/pull/4988\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fmonero-project%2Fmonero%2Fpull%2F4988\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/monero-project/monero/pull/4988\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e. This is being improved so that a RPC server will be able to run as a hidden service (currently it\u0026#39;s P2P only), which should make this vector moot when used (since the fake server would have to know the secret key used to host the hidden service). \u003c/p\u003e\n\n\u003cp\u003eMandating Tor use for RPC servers might prove too much of an obstacle though. Feel free to comment on 4852 about this. I\u0026#39;d be happy to update my SSL patch if objections were reconsidered, as the technical comments were trivial to address.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-01-03T14:52:16.123Z","updated_at":"2019-01-03T14:52:16.123Z","actor":{"username":"moneromooo","cleared":false,"url":"/moneromooo","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"monero","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3923212,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"\u003eOK, so I didn't miss anything, thanks.\n\nYes. @thanhb thanks for the report but basically you've described a feature of the network stack in all modern computing. Anything that isn't authenticated is... well... not authenticated.\n\n\u003eWeb servers, for example, are usually protected with TLS.\n\nThis is assuming they aren't using self-signed certificates, of which a malicious local user (or any intermediary) could generate. The use of TLS may also be useless for applications that aren't bound to privileged ports (such as Monero), unless there is a CA mechanism in place (please correct me if I'm wrong).\n\nAs @moneromooo suggested, the most effective solution may be key-derived public destinations as provided by Tor/Kovri/I2P/Sekreta.\n\nIn the interim, how should we proceed? Should we merge the TLS pull request?","markdown_message":"\u003cblockquote\u003e\n\u003cp\u003eOK, so I didn\u0026#39;t miss anything, thanks.\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eYes. \u003ca href=\"/thanhb\"\u003e@thanhb\u003c/a\u003e thanks for the report but basically you\u0026#39;ve described a feature of the network stack in all modern computing. Anything that isn\u0026#39;t authenticated is... well... not authenticated.\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eWeb servers, for example, are usually protected with TLS.\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eThis is assuming they aren\u0026#39;t using self-signed certificates, of which a malicious local user (or any intermediary) could generate. The use of TLS may also be useless for applications that aren\u0026#39;t bound to privileged ports (such as Monero), unless there is a CA mechanism in place (please correct me if I\u0026#39;m wrong).\u003c/p\u003e\n\n\u003cp\u003eAs \u003ca href=\"/moneromooo\"\u003e@moneromooo\u003c/a\u003e suggested, the most effective solution may be key-derived public destinations as provided by Tor/Kovri/I2P/Sekreta.\u003c/p\u003e\n\n\u003cp\u003eIn the interim, how should we proceed? Should we merge the TLS pull request?\u003c/p\u003e\n","automated_response":false,"created_at":"2019-01-04T03:57:41.928Z","updated_at":"2019-01-04T03:57:41.928Z","actor":{"username":"anonimal","cleared":false,"url":"/anonimal","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/040/857/f23cc3be09a21e17bc43975987c10ba2b6427239_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"monero","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3923216,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"","markdown_message":"","automated_response":false,"created_at":"2019-01-04T03:57:56.028Z","updated_at":"2019-01-04T03:57:56.028Z","actor":{"username":"anonimal","cleared":false,"url":"/anonimal","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/040/857/f23cc3be09a21e17bc43975987c10ba2b6427239_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"monero","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3924058,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"You are right. Anything that isn't authenticated is not authenticated, and the main issue I am pointing out here is that RPC clients currently don't authenticate the Monero RPC server. \n\nFrom my point of view, TLS is definitely necessary here, and it must be enforced (not optional). We all know that digest authentication is useless if it is not used with TLS when the user connects to a remote RPC server. And as I described before, even when the RPC interface is used locally only, a malicious local user could still impersonate the server if only digest authentication is used. I am not sure how the RPC server works as a hidden service, but I don't think that solution helps when the server is configured to be accessed only from localhost. \n\nThe use of TLS has nothing to do with port numbers, but you are right about the fact that there must be a CA mechanism. Specifically, the user must know the certificate of the CA that signs the RPC server's certificate. This CA certificate could be self-signed, and the user can simply install it to his system, or simply specify it as a parameter in a configuration file. \n","markdown_message":"\u003cp\u003eYou are right. Anything that isn\u0026#39;t authenticated is not authenticated, and the main issue I am pointing out here is that RPC clients currently don\u0026#39;t authenticate the Monero RPC server. \u003c/p\u003e\n\n\u003cp\u003eFrom my point of view, TLS is definitely necessary here, and it must be enforced (not optional). We all know that digest authentication is useless if it is not used with TLS when the user connects to a remote RPC server. And as I described before, even when the RPC interface is used locally only, a malicious local user could still impersonate the server if only digest authentication is used. I am not sure how the RPC server works as a hidden service, but I don\u0026#39;t think that solution helps when the server is configured to be accessed only from localhost. \u003c/p\u003e\n\n\u003cp\u003eThe use of TLS has nothing to do with port numbers, but you are right about the fact that there must be a CA mechanism. Specifically, the user must know the certificate of the CA that signs the RPC server\u0026#39;s certificate. This CA certificate could be self-signed, and the user can simply install it to his system, or simply specify it as a parameter in a configuration file. \u003c/p\u003e\n","automated_response":false,"created_at":"2019-01-04T09:30:21.304Z","updated_at":"2019-01-04T09:30:21.304Z","actor":{"username":"thanhb","cleared":false,"url":"/thanhb","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/021/219/a54415c85154bd79801c8bc3e64ed882554db9a5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"monero","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3935784,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"For the record, my patch does not need a CA. You specify which certs you allow. If the other side has another cert, it will fail the connection.\n\nAlso, if you run the wallet on the same host as the daemon, and you allow third parties access... you're really asking for trouble :) And if you don't but that host was broken into, chances are that TLS on the wallet/daemon comms won't protect you.\n","markdown_message":"\u003cp\u003eFor the record, my patch does not need a CA. You specify which certs you allow. If the other side has another cert, it will fail the connection.\u003c/p\u003e\n\n\u003cp\u003eAlso, if you run the wallet on the same host as the daemon, and you allow third parties access... you\u0026#39;re really asking for trouble :) And if you don\u0026#39;t but that host was broken into, chances are that TLS on the wallet/daemon comms won\u0026#39;t protect you.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-01-07T15:49:07.888Z","updated_at":"2019-01-07T15:49:07.888Z","actor":{"username":"moneromooo","cleared":false,"url":"/moneromooo","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"monero","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3936530,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"\u003e For the record, my patch does not need a CA. You specify which certs you allow. If the other side has another cert, it will fail the connection.\n\nIt's similar to using self-signed CA. Anyway, I have no comment about how TLS should be configured, as long as it's mandated.\n\n\u003e Also, if you run the wallet on the same host as the daemon, and you allow third parties access... you're really asking for trouble :) And if you don't but that host was broken into, chances are that TLS on the wallet/daemon comms won't protect you.\n\nIf you're talking about malware and the like, then you're right. I agree that TLS doesn't help in such cases. However, there are many cases where having third-party access is unavoidable. For example, in enterprise environments that employ centralized access control mechanisms and allow login by multiple users to the same computer, anyone is a potential attacker. Any computer with guest account enabled is similarly vulnerable.\n\nWe should conclude this thread. All I want here is to report what I see as a security problem. I've  reported similar problems to Bitcoin Core and Parity teams, and they are now in the process of fixing them. It's up to you guys to decide whether it's a problem that should be addressed. \n","markdown_message":"\u003cblockquote\u003e\n\u003cp\u003eFor the record, my patch does not need a CA. You specify which certs you allow. If the other side has another cert, it will fail the connection.\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eIt\u0026#39;s similar to using self-signed CA. Anyway, I have no comment about how TLS should be configured, as long as it\u0026#39;s mandated.\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eAlso, if you run the wallet on the same host as the daemon, and you allow third parties access... you\u0026#39;re really asking for trouble :) And if you don\u0026#39;t but that host was broken into, chances are that TLS on the wallet/daemon comms won\u0026#39;t protect you.\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eIf you\u0026#39;re talking about malware and the like, then you\u0026#39;re right. I agree that TLS doesn\u0026#39;t help in such cases. However, there are many cases where having third-party access is unavoidable. For example, in enterprise environments that employ centralized access control mechanisms and allow login by multiple users to the same computer, anyone is a potential attacker. Any computer with guest account enabled is similarly vulnerable.\u003c/p\u003e\n\n\u003cp\u003eWe should conclude this thread. All I want here is to report what I see as a security problem. I\u0026#39;ve  reported similar problems to Bitcoin Core and Parity teams, and they are now in the process of fixing them. It\u0026#39;s up to you guys to decide whether it\u0026#39;s a problem that should be addressed. \u003c/p\u003e\n","automated_response":false,"created_at":"2019-01-07T17:50:33.510Z","updated_at":"2019-01-07T17:50:33.510Z","actor":{"username":"thanhb","cleared":false,"url":"/thanhb","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/021/219/a54415c85154bd79801c8bc3e64ed882554db9a5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"monero","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3979103,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hackerone is being a bit annoying about this report, says we need to catch up on this. I'll twiddle the state to see if that makes it shut up :)","markdown_message":"\u003cp\u003eHackerone is being a bit annoying about this report, says we need to catch up on this. I\u0026#39;ll twiddle the state to see if that makes it shut up :)\u003c/p\u003e\n","automated_response":false,"created_at":"2019-01-15T13:47:59.884Z","updated_at":"2019-01-15T13:47:59.884Z","actor":{"username":"moneromooo","cleared":false,"url":"/moneromooo","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"monero","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3979121,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Well, I want to get that SSL patch in for other reasons anyway, so we'll see whether opposition recedes. Thanks.","markdown_message":"\u003cp\u003eWell, I want to get that SSL patch in for other reasons anyway, so we\u0026#39;ll see whether opposition recedes. Thanks.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-01-15T13:49:57.305Z","updated_at":"2019-01-15T13:49:57.305Z","actor":{"username":"moneromooo","cleared":false,"url":"/moneromooo","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"monero","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3979158,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"You might want to mark this as Resolved or something like that because it's still \"Open\".","markdown_message":"\u003cp\u003eYou might want to mark this as Resolved or something like that because it\u0026#39;s still \u0026quot;Open\u0026quot;.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-01-15T13:55:43.893Z","updated_at":"2019-01-15T13:55:43.893Z","actor":{"username":"thanhb","cleared":false,"url":"/thanhb","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/021/219/a54415c85154bd79801c8bc3e64ed882554db9a5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"monero","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3995200,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I'm going to wait till I know whether the SSL patch is accepted.","markdown_message":"\u003cp\u003eI\u0026#39;m going to wait till I know whether the SSL patch is accepted.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-01-17T20:30:38.376Z","updated_at":"2019-01-17T20:30:38.376Z","actor":{"username":"moneromooo","cleared":false,"url":"/moneromooo","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"monero","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4128479,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"FYI: due to a threat of one party having \u003e 50% of the network hash rate, we're forking soon with very little changes, and will release a \"full\" version at some yet undetermined time later. The SSL patch will be in that later version, but not in the early fork.\n","markdown_message":"\u003cp\u003eFYI: due to a threat of one party having \u0026gt; 50% of the network hash rate, we\u0026#39;re forking soon with very little changes, and will release a \u0026quot;full\u0026quot; version at some yet undetermined time later. The SSL patch will be in that later version, but not in the early fork.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-02-11T14:23:03.974Z","updated_at":"2019-02-11T14:23:03.974Z","actor":{"username":"moneromooo","cleared":false,"url":"/moneromooo","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"monero","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4256317,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"https://github.com/monero-project/monero/pull/4054 was merged a few hours ago.\n\n@thanhb please paste an XMR address if you would like to receive bounty.","markdown_message":"\u003cp\u003e\u003ca title=\"https://github.com/monero-project/monero/pull/4054\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fmonero-project%2Fmonero%2Fpull%2F4054\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/monero-project/monero/pull/4054\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e was merged a few hours ago.\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"/thanhb\"\u003e@thanhb\u003c/a\u003e please paste an XMR address if you would like to receive bounty.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-03-04T22:37:45.380Z","updated_at":"2019-03-04T22:38:40.555Z","actor":{"username":"anonimal","cleared":false,"url":"/anonimal","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/040/857/f23cc3be09a21e17bc43975987c10ba2b6427239_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"thanhb","url":"/thanhb"},"genius_execution_id":null,"team_handle":"monero","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4256324,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-03-04T22:38:45.974Z","updated_at":"2019-03-04T22:38:45.974Z","first_to_agree":true,"actor":{"username":"anonimal","cleared":false,"url":"/anonimal","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/040/857/f23cc3be09a21e17bc43975987c10ba2b6427239_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"monero","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4258059,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@anonimal Here is my XMR address: 4GdoN7NCTi8a5gZug7PrwZNKjvHFmKeV11L6pNJPgj5QNEHsN6eeX3DaAQFwZ1ufD4LYCZKArktt113W7QjWvQ7CWBuf7rcEjqhB3yE1uz\n\nThanks!","markdown_message":"\u003cp\u003e\u003ca href=\"/anonimal\"\u003e@anonimal\u003c/a\u003e Here is my XMR address: 4GdoN7NCTi8a5gZug7PrwZNKjvHFmKeV11L6pNJPgj5QNEHsN6eeX3DaAQFwZ1ufD4LYCZKArktt113W7QjWvQ7CWBuf7rcEjqhB3yE1uz\u003c/p\u003e\n\n\u003cp\u003eThanks!\u003c/p\u003e\n","automated_response":false,"created_at":"2019-03-05T08:26:47.444Z","updated_at":"2019-03-05T08:26:47.444Z","actor":{"username":"thanhb","cleared":false,"url":"/thanhb","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/021/219/a54415c85154bd79801c8bc3e64ed882554db9a5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"monero","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4300808,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Sent 2 XMR: \u003c71fd52f5cd08e457638ebc6416707c59da9ecd5626f22ff65d7672accd88a0b6\u003e","markdown_message":"\u003cp\u003eSent 2 XMR: \u0026lt;71fd52f5cd08e457638ebc6416707c59da9ecd5626f22ff65d7672accd88a0b6\u0026gt;\u003c/p\u003e\n","automated_response":false,"created_at":"2019-03-11T15:14:49.681Z","updated_at":"2019-03-11T15:14:49.681Z","actor":{"username":"luigi1111w","cleared":false,"url":"/luigi1111w","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"monero","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4305629,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you!","markdown_message":"\u003cp\u003eThank you!\u003c/p\u003e\n","automated_response":false,"created_at":"2019-03-12T08:49:53.201Z","updated_at":"2019-03-12T08:49:53.201Z","actor":{"username":"thanhb","cleared":false,"url":"/thanhb","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/021/219/a54415c85154bd79801c8bc3e64ed882554db9a5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"monero","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4319232,"is_internal":false,"editable":false,"type":"Activities::SwagAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2019-03-13T21:02:00.937Z","updated_at":"2019-03-13T21:02:00.937Z","actor":{"url":"/monero","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/007/731/55634f7fcd917725c7a5771cc6e7c9b4d5fe0c22_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Monero"}},"reporter":{"username":"thanhb","url":"/thanhb"},"genius_execution_id":null,"team_handle":"monero","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4467761,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-04-03T22:38:50.944Z","updated_at":"2019-04-03T22:38:50.944Z","actor":{"url":"/monero","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/007/731/55634f7fcd917725c7a5771cc6e7c9b4d5fe0c22_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Monero"}},"genius_execution_id":null,"team_handle":"monero","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}