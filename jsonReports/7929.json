{"id":7929,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC83OTI5","url":"https://hackerone.com/reports/7929","title":"Arbitrary file uploads to Amazon WS.","state":"Closed","substate":"informative","readable_substate":"Informative","created_at":"2014-04-17T21:13:51.467Z","submitted_at":"2014-04-17T21:13:51.467Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"leander","url":"/leander","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/004/627/31b99e478bdc5b23c3284c58c9612a43a9acc4be_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13,"url":"https://hackerone.com/security","handle":"security","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"HackerOne","twitter_handle":"Hacker0x01","website":"https://hackerone.com","about":"Vulnerability disclosure should be safe, transparent, and rewarding."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2014-04-26T23:13:30.980Z","bug_reporter_agreed_on_going_public_at":"2014-04-26T19:32:16.745Z","team_member_agreed_on_going_public_at":"2014-04-26T23:13:30.815Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi,\r\n\r\nIt seems one is able to upload arbitrary files to Amazon Webservices through the UI.\r\n\r\nThis allows for uploading malware such as [msf-payload-x86.jpg.exe](https://hackerone-attachments.s3.amazonaws.com/production/000/006/741/bf60ba068e72e767b93d3fa35c89a36639dd1f19/msf-payload-x86.jpg.exe?AWSAccessKeyId=AKIAJFXIS7KJADBA4QQA\u0026Expires=1397769394\u0026Signature=aoXXsjuCqUjReIFLzMtXYyMO5us%3D) or whatever.\r\n\r\nBeyond free hosting this could potentially be used to entice teams into downloading stuff they probably don't want.\r\n\r\nActual exploitation would likely depend on obfuscating the filename to look more innocent, general human errors, a certain trust in files being served from `hackerone-attachments.*.amazonaws.com` or separate issues entirely.\r\n\r\nI could imagine this to be working as intended but still believe it would be good to consider restrictions even if the result is to not enforce any.\r\n\r\nI would propose to at least consider displaying a warning similar to the (excellent) one displayed when visiting an external link.\r\n\r\nHTH,\r\n\r\n-leander","vulnerability_information_html":"\u003cp\u003eHi,\u003c/p\u003e\n\n\u003cp\u003eIt seems one is able to upload arbitrary files to Amazon Webservices through the UI.\u003c/p\u003e\n\n\u003cp\u003eThis allows for uploading malware such as \u003ca href=\"/redirect?url=https%3A%2F%2Fhackerone-attachments.s3.amazonaws.com%2Fproduction%2F000%2F006%2F741%2Fbf60ba068e72e767b93d3fa35c89a36639dd1f19%2Fmsf-payload-x86.jpg.exe%3FAWSAccessKeyId%3DAKIAJFXIS7KJADBA4QQA%26Expires%3D1397769394%26Signature%3DaoXXsjuCqUjReIFLzMtXYyMO5us%253D\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003emsf-payload-x86.jpg.exe\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e or whatever.\u003c/p\u003e\n\n\u003cp\u003eBeyond free hosting this could potentially be used to entice teams into downloading stuff they probably don\u0026#39;t want.\u003c/p\u003e\n\n\u003cp\u003eActual exploitation would likely depend on obfuscating the filename to look more innocent, general human errors, a certain trust in files being served from \u003ccode\u003ehackerone-attachments.*.amazonaws.com\u003c/code\u003e or separate issues entirely.\u003c/p\u003e\n\n\u003cp\u003eI could imagine this to be working as intended but still believe it would be good to consider restrictions even if the result is to not enforce any.\u003c/p\u003e\n\n\u003cp\u003eI would propose to at least consider displaying a warning similar to the (excellent) one displayed when visiting an external link.\u003c/p\u003e\n\n\u003cp\u003eHTH,\u003c/p\u003e\n\n\u003cp\u003e-leander\u003c/p\u003e\n","weakness":{"id":57,"name":"Violation of Secure Design Principles"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2014-05-20T13:07:16.164Z","allow_singular_disclosure_after":-208633607.72030926,"singular_disclosure_allowed":true,"vote_count":2,"voters":["powerjacobb1","dyabla"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":32149,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Note that the link provided does trigger such a warning and won't open, but attachments to the bug would not/will.","markdown_message":"\u003cp\u003eNote that the link provided does trigger such a warning and won\u0026#39;t open, but attachments to the bug would not/will.\u003c/p\u003e\n","automated_response":false,"created_at":"2014-04-17T21:23:41.736Z","updated_at":"2014-04-17T21:23:41.736Z","actor":{"username":"leander","cleared":false,"url":"/leander","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/627/31b99e478bdc5b23c3284c58c9612a43a9acc4be_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":6750,"filename":"incognito.exe","type":"application/octet-stream","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/006/750/b8e4617a4a177959a5187ec84816898bf91292e4/incognito.exe?response-content-disposition=attachment%3B%20filename%3D%22incognito.exe%22%3B%20filename%2A%3DUTF-8%27%27incognito.exe\u0026response-content-type=application%2Foctet-stream\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQVHABZQ6K%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T065403Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDLEUqN2OLO3OoArpAduXGS%2FnWvclGJ7L%2FhS7ZlCNuSFwIhAKgaDWYosUsMZYxmwMD0tSfLg1FWhbQHhU86z2hns38zKrQDCFcQARoMMDEzNjE5Mjc0ODQ5IgwVVQvbJjCbXZyRbMQqkQM9XNobju5ij3mHEd1PgXrpuzeU%2BCZaLl8s8%2FXPts8hYLholdRFqlYhDzTmecfnLqTs%2FH8df0Fzv8NVTOhsz9Cu3LtPJmYcyMM6%2BCttQ0%2F5YV36HpOoKx7YBCXq6g1wpqiR5h0NB8nCyNbtahjtqqfKrkQsAJtF0n6vty0Dy5dIMaKZufttk1eoYubwLgfaN4YAthfVEyCI75XoSBcWtozJGhmqio20Kggp%2Ff9ESWUDjkkVQkVc66j8SevucVwBZgdZjxbmMc3p%2B%2FrtliE8Di2Ov48U%2Bmiyzxgy0RsqgwBWQeuC1Vvrs6a5UgzB5X13VoO7Zw2O5pS1EKsi0EwbwxD1t1gkpOGC1X37B6qMMiSraZswcogi35QEMA8XAQhIC2z%2Byugz3gdhCR4lBTeHgZARRoRQvNYoLHEkvjD4clJ4fdfbD%2FRcWQb953U%2BunjxQu2802uN7zsOYAZ%2F1SufQ8paJbIHLgiZu%2FJLfuV6RY9q9hQTpnm6QoNT4fkLlHao602RIKkBGhLK4iU4VXdLBpw5JDCJiav%2FBTrqAW2UJwXizthXBPPIZ57e77V%2B1Jr9Up7MhIMK722MpJQ5S6y2sEj0IRzF6bBvFIGcuc7s5TvUPI3RoSg3%2BoRepHEHQDZpJfcEB%2FPh8Jr6a8ILTQYD91llJENl%2B%2FADn1n%2B0ihsitf2dEU%2F8Jff%2FNN3i9J2juS2OvqLeEbMdBuCToL%2BbYC8hsevJk6YzpVS0q2WxfTPUq4t7RHDwzTYfPmQnso8MCFcSKpUgp39ZmtjV4S1TWj23dyd7WkHgRbrIsNiFZci3GJYaEnzJmzKDIghO7k6z8NutfGp8Ayl%2FCKxt1goZhsy13ssETolsg%3D%3D\u0026X-Amz-Signature=45725190c828ab6d4bbca27f2c08742ef05d63939b41e59e0e093981f10ff0fa"}],"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":33407,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"Hi Leander - this is a report that we've received many times before and we've mostly treated them as a won't fix. \n\nThe arbitrary file upload angle is fully intentional, because it's purpose is providing researchers \u0026 response teams with a secure way of storing proof of concepts, so they don't have to use less predictable file storage services like Dropbox, Google Drive, SkyDrive etc.\n\nWe expect response teams to be super careful with downloading anything, and we intentionally do not serve content inline. We do a forced download and leave it up to the actual user \u0026 their operating system to warn for potential dangerous content or malicious intent. We even hear from some response teams that they exclusively run PoCs in a completely sandboxed VM, physically segregated from the corporate network.\n\nMain reason not to do a redirect interstitial here, is that it breaks the \"Save link as\" option that many browsers offer. This is a shortcut used by many response teams that use our site. We may revisit this decision in the future, for instance by adding some client-side UX that prevent downloading unless you state you understand the risk, but for now we consider this a won't fix.\n\nThanks!","markdown_message":"\u003cp\u003eHi Leander - this is a report that we\u0026#39;ve received many times before and we\u0026#39;ve mostly treated them as a won\u0026#39;t fix. \u003c/p\u003e\n\n\u003cp\u003eThe arbitrary file upload angle is fully intentional, because it\u0026#39;s purpose is providing researchers \u0026amp; response teams with a secure way of storing proof of concepts, so they don\u0026#39;t have to use less predictable file storage services like Dropbox, Google Drive, SkyDrive etc.\u003c/p\u003e\n\n\u003cp\u003eWe expect response teams to be super careful with downloading anything, and we intentionally do not serve content inline. We do a forced download and leave it up to the actual user \u0026amp; their operating system to warn for potential dangerous content or malicious intent. We even hear from some response teams that they exclusively run PoCs in a completely sandboxed VM, physically segregated from the corporate network.\u003c/p\u003e\n\n\u003cp\u003eMain reason not to do a redirect interstitial here, is that it breaks the \u0026quot;Save link as\u0026quot; option that many browsers offer. This is a shortcut used by many response teams that use our site. We may revisit this decision in the future, for instance by adding some client-side UX that prevent downloading unless you state you understand the risk, but for now we consider this a won\u0026#39;t fix.\u003c/p\u003e\n\n\u003cp\u003eThanks!\u003c/p\u003e\n","automated_response":false,"created_at":"2014-04-20T13:07:16.384Z","updated_at":"2014-04-20T13:07:16.384Z","actor":{"username":"michiel","cleared":true,"url":"/michiel","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/007/439427fb81f710e5e16246ede1828613d46bb79e_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":39330,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Interesting that it does seem to be fixed now. \n\nThe page at https://hackerone.com says:\n\n`Exercise caution when opening attachments as they may be accompanied by unintentional consequences`\n\nCheers.","markdown_message":"\u003cp\u003eInteresting that it does seem to be fixed now. \u003c/p\u003e\n\n\u003cp\u003eThe page at \u003ca title=\"https://hackerone.com\" href=\"https://hackerone.com\"\u003ehttps://hackerone.com\u003c/a\u003e says:\u003c/p\u003e\n\n\u003cp\u003e\u003ccode\u003eExercise caution when opening attachments as they may be accompanied by unintentional consequences\u003c/code\u003e\u003c/p\u003e\n\n\u003cp\u003eCheers.\u003c/p\u003e\n","automated_response":false,"created_at":"2014-04-26T19:25:05.591Z","updated_at":"2014-04-26T19:25:05.591Z","actor":{"username":"leander","cleared":false,"url":"/leander","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/627/31b99e478bdc5b23c3284c58c9612a43a9acc4be_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":39334,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Requesting public disclosure to have the rationale documented. Perhaps this will save time in case anyone decides to report the same issue in the future.\n\nRegards,\n\n-leander","markdown_message":"\u003cp\u003eRequesting public disclosure to have the rationale documented. Perhaps this will save time in case anyone decides to report the same issue in the future.\u003c/p\u003e\n\n\u003cp\u003eRegards,\u003c/p\u003e\n\n\u003cp\u003e-leander\u003c/p\u003e\n","automated_response":false,"created_at":"2014-04-26T19:32:16.758Z","updated_at":"2014-04-26T19:32:16.758Z","first_to_agree":true,"actor":{"username":"leander","cleared":false,"url":"/leander","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/627/31b99e478bdc5b23c3284c58c9612a43a9acc4be_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":39398,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2014-04-26T23:13:30.831Z","updated_at":"2014-04-26T23:13:30.831Z","actor":{"username":"arice","cleared":false,"url":"/arice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/83152cb2d070f3f6a63c1b61bae47257722b5ad2_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":39399,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2014-04-26T23:13:30.995Z","updated_at":"2014-04-26T23:13:30.995Z","actor":{"username":"arice","cleared":false,"url":"/arice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/83152cb2d070f3f6a63c1b61bae47257722b5ad2_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}