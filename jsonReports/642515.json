{"id":642515,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC82NDI1MTU=","url":"https://hackerone.com/reports/642515","title":"User can delete data in shared folders he's not autorized to access","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2019-07-13T16:36:49.038Z","submitted_at":"2019-07-13T16:36:49.038Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"jlord87","url":"/jlord87","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13291,"url":"https://hackerone.com/nextcloud","handle":"nextcloud","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Nextcloud","twitter_handle":"nextclouders","website":"https://nextcloud.com","about":"Access, share and protect your files, calendars, contacts, communication \u0026 more at home and in your enterprise."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":["CVE-2020-8153"],"singular_disclosure_disabled":false,"disclosed_at":"2020-04-10T16:13:47.638Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2020-03-11T16:13:42.324Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"###Steps to reproduce\n\n1. create a group folder named TEST and share with \"admin group\" and \"test group\", marking the advanced permission flag\n2. create two folders inside the main share: visible and invisible\n3. inside \"invisible\" folder create a test file (let's say something like \"test.txt\")\n4. set the advanced folder permission to deny everything to \"test group\" for the \"invisible\" folder (deny read, deny write, deny share, deny create, deny delete...)\n5. log in with test user (member of test group). The invisible folder is not shown, you can only see the visible one. That's great.\n6. if you try to create a folder named \"invisible\" you get an error (that's good too) sync the new external share to your pc (in my case win7 with 2.5.2 client). Only the \"visible\" folder is synced.\n7. create a folder named \"temp\" and create inside this new folder a new file (lets say \"test2.txt\"). This folder will be synced online\n8. rename temp to invisible\n9. the folder gets synced online overwriting the originale \"invisible\" folder\n\n###Expected behaviour\n\nThe sync client should keep denying the syncronization of \"invisible\" folder to the unauthorized users\n\n###Actual behaviour\n\nThe folder is synced, the original one and all its content (that should be inaccessible to test user) are overwritten and lost\n\n## Impact\n\nAn \"attacker\" - that could simply be an user with low privileges - can delete sensitive data that were on purpose hidden to its group.","vulnerability_information_html":"\u003ch3 id=\"steps-to-reproduce\"\u003eSteps to reproduce\u003c/h3\u003e\n\n\u003col\u003e\n\u003cli\u003ecreate a group folder named TEST and share with \u0026quot;admin group\u0026quot; and \u0026quot;test group\u0026quot;, marking the advanced permission flag\u003c/li\u003e\n\u003cli\u003ecreate two folders inside the main share: visible and invisible\u003c/li\u003e\n\u003cli\u003einside \u0026quot;invisible\u0026quot; folder create a test file (let\u0026#39;s say something like \u0026quot;test.txt\u0026quot;)\u003c/li\u003e\n\u003cli\u003eset the advanced folder permission to deny everything to \u0026quot;test group\u0026quot; for the \u0026quot;invisible\u0026quot; folder (deny read, deny write, deny share, deny create, deny delete...)\u003c/li\u003e\n\u003cli\u003elog in with test user (member of test group). The invisible folder is not shown, you can only see the visible one. That\u0026#39;s great.\u003c/li\u003e\n\u003cli\u003eif you try to create a folder named \u0026quot;invisible\u0026quot; you get an error (that\u0026#39;s good too) sync the new external share to your pc (in my case win7 with 2.5.2 client). Only the \u0026quot;visible\u0026quot; folder is synced.\u003c/li\u003e\n\u003cli\u003ecreate a folder named \u0026quot;temp\u0026quot; and create inside this new folder a new file (lets say \u0026quot;test2.txt\u0026quot;). This folder will be synced online\u003c/li\u003e\n\u003cli\u003erename temp to invisible\u003c/li\u003e\n\u003cli\u003ethe folder gets synced online overwriting the originale \u0026quot;invisible\u0026quot; folder\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003ch3 id=\"expected-behaviour\"\u003eExpected behaviour\u003c/h3\u003e\n\n\u003cp\u003eThe sync client should keep denying the syncronization of \u0026quot;invisible\u0026quot; folder to the unauthorized users\u003c/p\u003e\n\n\u003ch3 id=\"actual-behaviour\"\u003eActual behaviour\u003c/h3\u003e\n\n\u003cp\u003eThe folder is synced, the original one and all its content (that should be inaccessible to test user) are overwritten and lost\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eAn \u0026quot;attacker\u0026quot; - that could simply be an user with low privileges - can delete sensitive data that were on purpose hidden to its group.\u003c/p\u003e\n","bounty_amount":"250.0","formatted_bounty":"$250","weakness":{"id":26,"name":"Improper Access Control - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2020-04-10T16:13:42.394Z","allow_singular_disclosure_after":-22688353.01946864,"singular_disclosure_allowed":true,"vote_count":164,"voters":["a_d_a_m","mashoud1122","mirhat","th4nu_0x0","slaxxx","jokerface","killinem_sec","mygf","takester","what_web","and 154 more..."],"severity":{"rating":"medium","author_type":"User"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":5315554,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks a lot for reporting this potential issue back to us!\n\nOur security team will take a look at this issue as soon as possible. We will reply to your report within 72 hours, usually much faster. For obvious reasons we'd like to ask you to not disclose this issue to any other party.","markdown_message":"\u003cp\u003eThanks a lot for reporting this potential issue back to us!\u003c/p\u003e\n\n\u003cp\u003eOur security team will take a look at this issue as soon as possible. We will reply to your report within 72 hours, usually much faster. For obvious reasons we\u0026#39;d like to ask you to not disclose this issue to any other party.\u003c/p\u003e\n","automated_response":true,"created_at":"2019-07-13T16:36:49.310Z","updated_at":"2019-07-13T16:36:49.310Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Nextcloud"}},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5321577,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2019-07-15T09:48:38.668Z","updated_at":"2019-07-15T09:48:38.668Z","actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5321645,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@jlord87 https://github.com/nextcloud/groupfolders/pull/519 should fix the issue, can you confirm?","markdown_message":"\u003cp\u003e\u003ca href=\"/jlord87\"\u003e@jlord87\u003c/a\u003e \u003ca title=\"https://github.com/nextcloud/groupfolders/pull/519\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fnextcloud%2Fgroupfolders%2Fpull%2F519\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/nextcloud/groupfolders/pull/519\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e should fix the issue, can you confirm?\u003c/p\u003e\n","automated_response":false,"created_at":"2019-07-15T10:02:09.038Z","updated_at":"2019-07-15T10:02:09.038Z","actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5322036,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I can confirm, the commit e98a80baa44c227e025118e8b1ad36fe7fd6cbd3 solves this bug.\n(the client is still not working well, it does not always give errors when renaming the folder to an existing and hidden one. But data are not synced and not deleting the hidden one.)\n\nGood job, thanks","markdown_message":"\u003cp\u003eI can confirm, the commit e98a80baa44c227e025118e8b1ad36fe7fd6cbd3 solves this bug.\u003cbr\u003e\n(the client is still not working well, it does not always give errors when renaming the folder to an existing and hidden one. But data are not synced and not deleting the hidden one.)\u003c/p\u003e\n\n\u003cp\u003eGood job, thanks\u003c/p\u003e\n","automated_response":false,"created_at":"2019-07-15T10:31:54.818Z","updated_at":"2019-07-15T10:32:30.652Z","actor":{"username":"jlord87","cleared":false,"url":"/jlord87","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7291138,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Sorry forgot to close this.\n\nThanks a lot for your report again. We're working on the advisories at the moment.\n\nPlease let us know how you'd like to be credited in our official advisory. We require the following information:\n\n- Name / Pseudonym\n- Email address (optional)\n- Website (optional)\n- Company (optional)\n","markdown_message":"\u003cp\u003eSorry forgot to close this.\u003c/p\u003e\n\n\u003cp\u003eThanks a lot for your report again. We\u0026#39;re working on the advisories at the moment.\u003c/p\u003e\n\n\u003cp\u003ePlease let us know how you\u0026#39;d like to be credited in our official advisory. We require the following information:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eName / Pseudonym\u003c/li\u003e\n\u003cli\u003eEmail address (optional)\u003c/li\u003e\n\u003cli\u003eWebsite (optional)\u003c/li\u003e\n\u003cli\u003eCompany (optional)\u003c/li\u003e\n\u003c/ul\u003e\n","automated_response":false,"created_at":"2020-03-11T16:13:01.890Z","updated_at":"2020-03-11T16:13:01.890Z","actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"jlord87","url":"/jlord87"},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7291148,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-03-11T16:13:42.337Z","updated_at":"2020-03-11T16:13:42.337Z","first_to_agree":true,"actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7295690,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2020-03-12T07:31:59.586Z","updated_at":"2020-03-12T07:31:59.586Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Nextcloud"}},"bounty_amount":"250.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"nextcloud","collaborator":{"username":"jlord87","url":"/jlord87"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7296409,"is_internal":false,"editable":false,"type":"Activities::ReportVulnerabilityTypesUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2020-03-12T08:40:40.656Z","updated_at":"2020-03-12T08:40:40.656Z","additional_data":{"added_weaknesses":[{"id":26,"name":"Improper Access Control - Generic"}],"removed_weaknesses":[]},"actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7317164,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you @nickvergessen, it's an honor to be credited in the official advisory!\nyou can put this info:\nFrancesco MORO(sinotto)\n\nThank you :)","markdown_message":"\u003cp\u003eThank you \u003ca href=\"/nickvergessen\"\u003e@nickvergessen\u003c/a\u003e, it\u0026#39;s an honor to be credited in the official advisory!\u003cbr\u003e\nyou can put this info:\u003cbr\u003e\nFrancesco MORO(sinotto)\u003c/p\u003e\n\n\u003cp\u003eThank you :)\u003c/p\u003e\n","automated_response":false,"created_at":"2020-03-14T10:09:31.069Z","updated_at":"2020-03-14T10:09:31.069Z","actor":{"username":"jlord87","cleared":false,"url":"/jlord87","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7617926,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-04-10T16:13:47.682Z","updated_at":"2020-04-10T16:13:47.682Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Nextcloud"}},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}