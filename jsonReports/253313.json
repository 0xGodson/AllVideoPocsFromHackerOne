{"id":253313,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yNTMzMTM=","url":"https://hackerone.com/reports/253313","title":"XSS Vulnerability in WooCommerce Product Vendors plugin","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2017-07-25T17:07:43.560Z","submitted_at":"2017-07-25T17:07:43.560Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"ramuelgall","url":"/ramuelgall","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/186/612/d0508196a58f5b8a103a96bd28448f12d4b44848_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":111,"url":"https://hackerone.com/automattic","handle":"automattic","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/111/7f89e1ea233f92916202521a069fdbfe9eced339_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/111/7f89e1ea233f92916202521a069fdbfe9eced339_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Automattic","twitter_handle":"","website":"https://automattic.com","about":"WordPress.com, VaultPress, Akismet, Gravatar, WooCommerce, Polldaddy, Tumblr and more!"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-08-22T13:53:00.171Z","bug_reporter_agreed_on_going_public_at":"2017-08-04T19:08:30.694Z","team_member_agreed_on_going_public_at":"2017-08-22T13:53:00.118Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Version 2.0.27 of the WooCommerce Product Vendors plugin doesn't appear to correctly escape the \"vendor description\" POST parameter and can be manipulated to reflect arbitrary scripting.\nThe good news is that it does appear to do some form of clientside validation before posting, in addition to some serverside validation later, preventing this from becoming a stored attack. This appears to be due to the fact that \"vendor_description\" _POST parameter is echoed without being escaped on line 61 of templates/shortcode-registration-form.php\n\nI've created the following vulnerable URL on my personal site; WordPress and all plugins and themes are up to date, and the site is using the default \"Storefront\" theme.\n http://steelpress.org/index.php/product-vendor-registration-form/\n\nThe unescaped script is visible in the source when you run:\n\ncurl -X POST -d \"vendor_description=\u003cscript\u003ealert(\"xss\")\u003c/script\u003e\" \"https://steelpress.org/index.php/product-vendor-registration-form/?confirm_email=1\u0026email=1\u0026firstname=1\u0026lastname=1\u0026location=1\u0026register=Register\u0026username=1\u0026vendor_description=1\u0026vendor_name=1\"","vulnerability_information_html":"\u003cp\u003eVersion 2.0.27 of the WooCommerce Product Vendors plugin doesn\u0026#39;t appear to correctly escape the \u0026quot;vendor description\u0026quot; POST parameter and can be manipulated to reflect arbitrary scripting.\u003cbr\u003e\nThe good news is that it does appear to do some form of clientside validation before posting, in addition to some serverside validation later, preventing this from becoming a stored attack. This appears to be due to the fact that \u0026quot;vendor_description\u0026quot; _POST parameter is echoed without being escaped on line 61 of templates/shortcode-registration-form.php\u003c/p\u003e\n\n\u003cp\u003eI\u0026#39;ve created the following vulnerable URL on my personal site; WordPress and all plugins and themes are up to date, and the site is using the default \u0026quot;Storefront\u0026quot; theme.\u003cbr\u003e\n \u003ca title=\"http://steelpress.org/index.php/product-vendor-registration-form/\" href=\"/redirect?url=http%3A%2F%2Fsteelpress.org%2Findex.php%2Fproduct-vendor-registration-form%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://steelpress.org/index.php/product-vendor-registration-form/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eThe unescaped script is visible in the source when you run:\u003c/p\u003e\n\n\u003cp\u003ecurl -X POST -d \u0026quot;vendor_description=\u0026lt;script\u0026gt;alert(\u0026quot;xss\u0026quot;)\u0026lt;/script\u0026gt;\u0026quot; \u0026quot;\u003ca title=\"https://steelpress.org/index.php/product-vendor-registration-form/?confirm_email=1\u0026amp;email=1\u0026amp;firstname=1\u0026amp;lastname=1\u0026amp;location=1\u0026amp;register=Register\u0026amp;username=1\u0026amp;vendor_description=1\u0026amp;vendor_name=1\" href=\"/redirect?url=https%3A%2F%2Fsteelpress.org%2Findex.php%2Fproduct-vendor-registration-form%2F%3Fconfirm_email%3D1%26email%3D1%26firstname%3D1%26lastname%3D1%26location%3D1%26register%3DRegister%26username%3D1%26vendor_description%3D1%26vendor_name%3D1\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://steelpress.org/index.php/product-vendor-registration-form/?confirm_email=1\u0026amp;email=1\u0026amp;firstname=1\u0026amp;lastname=1\u0026amp;location=1\u0026amp;register=Register\u0026amp;username=1\u0026amp;vendor_description=1\u0026amp;vendor_name=1\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u0026quot;\u003c/p\u003e\n","bounty_amount":"225.0","formatted_bounty":"$225","weakness":{"id":61,"name":"Cross-site Scripting (XSS) - Reflected"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2017-09-03T19:08:30.752Z","allow_singular_disclosure_after":-104753043.6228087,"singular_disclosure_allowed":true,"vote_count":4,"voters":["eveeez","silv3rpoision","hackworld","jobopal"],"severity":{"rating":"low","author_type":"User"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1867736,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hi. Thanks for the report. We are going to take a look.","markdown_message":"\u003cp\u003eHi. Thanks for the report. We are going to take a look.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-07-26T09:32:14.360Z","updated_at":"2017-07-26T09:32:14.360Z","actor":{"username":"xknown","cleared":false,"url":"/xknown","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1869211,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi, I just read the reporting guidelines and realized I'd left out the \"Exploitability\" and \"Impact\" sections.\nAs far as Exploitability is concerned, the attacker would need to have control of a separate webform, preferably with some sort of JavaScript autosubmit, in order to trick the user into making a POST request, so Exploitability is probably pretty low, it's not the sort of thing you could just use a URL shortener to exploit.\n\nImpact would also likely be low, since the \"worst-case\" scenario would be similar to a reflected XSS attack using a _GET parameter, but would require several extra steps. Let me know if you need me to setup a separate webform for additional proof of concept.","markdown_message":"\u003cp\u003eHi, I just read the reporting guidelines and realized I\u0026#39;d left out the \u0026quot;Exploitability\u0026quot; and \u0026quot;Impact\u0026quot; sections.\u003cbr\u003e\nAs far as Exploitability is concerned, the attacker would need to have control of a separate webform, preferably with some sort of JavaScript autosubmit, in order to trick the user into making a POST request, so Exploitability is probably pretty low, it\u0026#39;s not the sort of thing you could just use a URL shortener to exploit.\u003c/p\u003e\n\n\u003cp\u003eImpact would also likely be low, since the \u0026quot;worst-case\u0026quot; scenario would be similar to a reflected XSS attack using a _GET parameter, but would require several extra steps. Let me know if you need me to setup a separate webform for additional proof of concept.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-07-26T19:16:40.747Z","updated_at":"2017-07-26T19:24:18.514Z","actor":{"username":"ramuelgall","cleared":false,"url":"/ramuelgall","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/186/612/d0508196a58f5b8a103a96bd28448f12d4b44848_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1892993,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hi. This issue was fixed in the WooCommerce Product Vendors 2.0.37 release. Thanks again for the report.","markdown_message":"\u003cp\u003eHi. This issue was fixed in the WooCommerce Product Vendors 2.0.37 release. Thanks again for the report.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-08-04T14:03:01.838Z","updated_at":"2017-08-04T14:03:01.838Z","actor":{"username":"xknown","cleared":false,"url":"/xknown","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"ramuelgall","url":"/ramuelgall"},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1892998,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2017-08-04T14:04:37.179Z","updated_at":"2017-08-04T14:04:37.179Z","actor":{"url":"/automattic","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/111/7f89e1ea233f92916202521a069fdbfe9eced339_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Automattic"}},"bounty_amount":"225.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"automattic","collaborator":{"username":"ramuelgall","url":"/ramuelgall"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1894759,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Hello,\nI actually work at SiteLock, and we'd like to do a press release on this. Could we please coordinate on a responsible disclosure date and plan? I'd also like to donate the bounty to the WordPress foundation if possible.","markdown_message":"\u003cp\u003eHello,\u003cbr\u003e\nI actually work at SiteLock, and we\u0026#39;d like to do a press release on this. Could we please coordinate on a responsible disclosure date and plan? I\u0026#39;d also like to donate the bounty to the WordPress foundation if possible.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-08-04T19:08:30.713Z","updated_at":"2017-08-04T19:08:30.713Z","first_to_agree":true,"actor":{"username":"ramuelgall","cleared":false,"url":"/ramuelgall","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/186/612/d0508196a58f5b8a103a96bd28448f12d4b44848_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1919618,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Also, for the purposes of accurate impact disclosure, are you able to share the subscriber base figures for this plugin?","markdown_message":"\u003cp\u003eAlso, for the purposes of accurate impact disclosure, are you able to share the subscriber base figures for this plugin?\u003c/p\u003e\n","automated_response":false,"created_at":"2017-08-10T16:43:14.295Z","updated_at":"2017-08-10T16:43:14.295Z","actor":{"username":"ramuelgall","cleared":false,"url":"/ramuelgall","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/186/612/d0508196a58f5b8a103a96bd28448f12d4b44848_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1921277,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi. For the donation part, I think you need to contact Hackerone support -- https://support.hackerone.com/hc/en-us/articles/210314263.\n\nAbout the subscriber base, I'm not sure we'll be able to provide such information, but I can ask. Let me know when you plan to do the public disclosure, then I'll also make public this report.","markdown_message":"\u003cp\u003eHi. For the donation part, I think you need to contact Hackerone support -- \u003ca title=\"https://support.hackerone.com/hc/en-us/articles/210314263\" href=\"/redirect?url=https%3A%2F%2Fsupport.hackerone.com%2Fhc%2Fen-us%2Farticles%2F210314263\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://support.hackerone.com/hc/en-us/articles/210314263\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e.\u003c/p\u003e\n\n\u003cp\u003eAbout the subscriber base, I\u0026#39;m not sure we\u0026#39;ll be able to provide such information, but I can ask. Let me know when you plan to do the public disclosure, then I\u0026#39;ll also make public this report.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-08-11T10:12:43.236Z","updated_at":"2017-08-11T10:12:43.236Z","actor":{"username":"xknown","cleared":false,"url":"/xknown","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1922257,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Awesome! We're thinking of doing the disclosure as soon as Wednesday, August 16th, I just have to write up a publicly digestible draft. Thanks for the support link, I've gone through hackerone's support system for the donation.","markdown_message":"\u003cp\u003eAwesome! We\u0026#39;re thinking of doing the disclosure as soon as Wednesday, August 16th, I just have to write up a publicly digestible draft. Thanks for the support link, I\u0026#39;ve gone through hackerone\u0026#39;s support system for the donation.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-08-11T17:47:03.922Z","updated_at":"2017-08-11T17:47:03.922Z","actor":{"username":"ramuelgall","cleared":false,"url":"/ramuelgall","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/186/612/d0508196a58f5b8a103a96bd28448f12d4b44848_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1946196,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Any update on this? I've got the writeup all ready to go.","markdown_message":"\u003cp\u003eAny update on this? I\u0026#39;ve got the writeup all ready to go.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-08-22T13:09:51.221Z","updated_at":"2017-08-22T13:09:51.221Z","actor":{"username":"ramuelgall","cleared":false,"url":"/ramuelgall","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/186/612/d0508196a58f5b8a103a96bd28448f12d4b44848_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1946279,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-08-22T13:53:00.141Z","updated_at":"2017-08-22T13:53:00.141Z","actor":{"username":"xknown","cleared":false,"url":"/xknown","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1946280,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-08-22T13:53:00.192Z","updated_at":"2017-08-22T13:53:00.192Z","actor":{"username":"xknown","cleared":false,"url":"/xknown","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}