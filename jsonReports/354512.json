{"id":354512,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zNTQ1MTI=","url":"https://hackerone.com/reports/354512","title":"X-Content-Type-Options has not been set at app.passit.io","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2018-05-19T22:54:52.534Z","submitted_at":"2018-05-19T22:54:52.534Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"exception","url":"/exception","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/100/852/b1f7d559f94f85152099c4a3426ec92010ceba40_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":27430,"url":"https://hackerone.com/passit","handle":"passit","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/027/430/5766efac33f3818a7fb79bb9bbdc26f6f32e92a0_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/027/430/5766efac33f3818a7fb79bb9bbdc26f6f32e92a0_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Passit","twitter_handle":"passitdotio","website":"https://passit.io","about":"An open source app that uses an established and modern cryptographic library to secure your passwords online so you can access them anywhere."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2018-07-24T18:22:42.845Z","bug_reporter_agreed_on_going_public_at":"2018-07-24T18:22:42.750Z","team_member_agreed_on_going_public_at":"2018-07-15T19:54:13.327Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi\n\nThe Http Header `X-Content-Type-Options` is missing.\n\n## Impact\n\nYour website  `http://app.passit.io/` doesn't have a header settings for `X-Content-Type Options` which means it is vulnerable to MIME sniffing. The only defined value, 'nosniff', prevents Internet Explorer and Google Chrome from MIME-sniffing a response away from the declared content-type. This also applies to Google Chrome when downloading extensions. This reduces exposure to drive-by download attacks and sites serving user uploaded content that by clever naming could be treated by MSIE as executable or dynamic HTML files.\n\n\n#Check\n\n```\ncurl -i -s -k  -X 'GET' \\\n    -H 'User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:53.0) Gecko/20100101 Firefox/53.0' -H 'Upgrade-Insecure-Requests: 1' \\\n    -b '_ga=GA1.2.1245942860.1493681129; intercom-id-kko7omjv=e5c0b8f9-05d6-4402-b8c3-76cd3eac2934' \\\n    'https://app.passit.io/'\n```\n\n#Fix \n\nAdd header `X-Content-Type-Options: nosniff`\n\n#Ref \n- https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Content-Type-Options\n- https://www.owasp.org/index.php/OWASP_Secure_Headers_Project\n\nRegards","vulnerability_information_html":"\u003cp\u003eHi\u003c/p\u003e\n\n\u003cp\u003eThe Http Header \u003ccode\u003eX-Content-Type-Options\u003c/code\u003e is missing.\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eYour website  \u003ccode\u003ehttp://app.passit.io/\u003c/code\u003e doesn\u0026#39;t have a header settings for \u003ccode\u003eX-Content-Type Options\u003c/code\u003e which means it is vulnerable to MIME sniffing. The only defined value, \u0026#39;nosniff\u0026#39;, prevents Internet Explorer and Google Chrome from MIME-sniffing a response away from the declared content-type. This also applies to Google Chrome when downloading extensions. This reduces exposure to drive-by download attacks and sites serving user uploaded content that by clever naming could be treated by MSIE as executable or dynamic HTML files.\u003c/p\u003e\n\n\u003ch1 id=\"check\"\u003eCheck\u003c/h1\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ecurl -i -s -k  -X \u0026#39;GET\u0026#39; \\\n    -H \u0026#39;User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:53.0) Gecko/20100101 Firefox/53.0\u0026#39; -H \u0026#39;Upgrade-Insecure-Requests: 1\u0026#39; \\\n    -b \u0026#39;_ga=GA1.2.1245942860.1493681129; intercom-id-kko7omjv=e5c0b8f9-05d6-4402-b8c3-76cd3eac2934\u0026#39; \\\n    \u0026#39;https://app.passit.io/\u0026#39;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch1 id=\"fix\"\u003eFix\u003c/h1\u003e\n\n\u003cp\u003eAdd header \u003ccode\u003eX-Content-Type-Options: nosniff\u003c/code\u003e\u003c/p\u003e\n\n\u003ch1 id=\"ref\"\u003eRef\u003c/h1\u003e\n\n\u003cul\u003e\n\u003cli\u003e\u003ca title=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Content-Type-Options\" href=\"/redirect?url=https%3A%2F%2Fdeveloper.mozilla.org%2Fen-US%2Fdocs%2FWeb%2FHTTP%2FHeaders%2FX-Content-Type-Options\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Content-Type-Options\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca title=\"https://www.owasp.org/index.php/OWASP_Secure_Headers_Project\" href=\"/redirect?url=https%3A%2F%2Fwww.owasp.org%2Findex.php%2FOWASP_Secure_Headers_Project\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.owasp.org/index.php/OWASP_Secure_Headers_Project\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eRegards\u003c/p\u003e\n","original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2018-08-14T19:54:13.414Z","allow_singular_disclosure_after":-74944050.0545236,"singular_disclosure_allowed":true,"vote_count":9,"voters":["eveeez","apapedulimu","khizer47","cryptographer","scorpion12","anonomous666","huf","elkhedim","milanbhingu"],"severity":{"rating":"low","author_type":"User"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":2768229,"is_internal":false,"editable":false,"type":"Activities::BugNotApplicable","message":"Based on your initial description, there do not appear to be any security implications as a direct result of this behavior.\n\nIf you disagree, please reply with additional information describing your reasoning.\n\nIncluding a working proof-of-concept that shows one of these implications can be incredibly helpful in our assessment of these claims.","markdown_message":"\u003cp\u003eBased on your initial description, there do not appear to be any security implications as a direct result of this behavior.\u003c/p\u003e\n\n\u003cp\u003eIf you disagree, please reply with additional information describing your reasoning.\u003c/p\u003e\n\n\u003cp\u003eIncluding a working proof-of-concept that shows one of these implications can be incredibly helpful in our assessment of these claims.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-05-20T10:39:09.791Z","updated_at":"2018-05-20T10:39:09.791Z","actor":{"username":"chessmast3r","cleared":false,"url":"/chessmast3r","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/220/459/6b3c5fca9df9cde7fe36b55238b13d2cea86ea80_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"passit","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3035048,"is_internal":false,"editable":false,"type":"Activities::BugReopened","message":"","markdown_message":"","automated_response":false,"created_at":"2018-07-12T14:25:08.643Z","updated_at":"2018-07-12T14:25:08.643Z","actor":{"username":"exception","cleared":true,"url":"/exception","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/100/852/b1f7d559f94f85152099c4a3426ec92010ceba40_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"passit","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3035049,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @chessmast3r \n\nThe program was accepting best practices at the time of submitting  this ticket ,here is an example  https://hackerone.com/reports/352734\n\nSo  if you are not going to pass the report to the appropriate team , So kindly close as informative.\n\n","markdown_message":"\u003cp\u003eHi \u003ca href=\"/chessmast3r\"\u003e@chessmast3r\u003c/a\u003e \u003c/p\u003e\n\n\u003cp\u003eThe program was accepting best practices at the time of submitting  this ticket ,here is an example  \u003ca title=\"https://hackerone.com/reports/352734\" href=\"https://hackerone.com/reports/352734\"\u003ehttps://hackerone.com/reports/352734\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eSo  if you are not going to pass the report to the appropriate team , So kindly close as informative.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-07-12T14:25:08.923Z","updated_at":"2018-07-12T14:25:08.923Z","actor":{"username":"exception","cleared":true,"url":"/exception","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/100/852/b1f7d559f94f85152099c4a3426ec92010ceba40_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"passit","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3041241,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Reading https://stackoverflow.com/questions/18337630/what-is-x-content-type-options-nosniff\n\n\"that is for servers hosting untrusted content. For websites that don't display content from user uploads, you don't need to set this. \"\n\nPassit does not allow uploads of content. Only json api endpoints. Is this still relevant? \n\nBest practices are accepted only if they are applicable to Passit.","markdown_message":"\u003cp\u003eReading \u003ca title=\"https://stackoverflow.com/questions/18337630/what-is-x-content-type-options-nosniff\" href=\"/redirect?url=https%3A%2F%2Fstackoverflow.com%2Fquestions%2F18337630%2Fwhat-is-x-content-type-options-nosniff\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://stackoverflow.com/questions/18337630/what-is-x-content-type-options-nosniff\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e\u0026quot;that is for servers hosting untrusted content. For websites that don\u0026#39;t display content from user uploads, you don\u0026#39;t need to set this. \u0026quot;\u003c/p\u003e\n\n\u003cp\u003ePassit does not allow uploads of content. Only json api endpoints. Is this still relevant? \u003c/p\u003e\n\n\u003cp\u003eBest practices are accepted only if they are applicable to Passit.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-07-13T15:20:08.342Z","updated_at":"2018-07-13T15:20:08.342Z","actor":{"username":"david_x4am4","cleared":false,"url":"/david_x4am4","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"passit","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3041340,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Hi @david_x4am4 \n\nThe impact or exploit of mime sniffing does not count on uploading contents , it can be triggered via parameter injection.\n\nFor example if a page takes a message as parameter and displays it back to the user.\n\nhttp://site.com/welcome?message=account+activated\n\nif the value of message is returned in response , with absence of the mentioned header , it can cause IE and chrome XSS .\n\n\nThe parameter reflection in response can be considered  as untrusted content , attacker does not need to upload any contents.\n\nmany json end-points takes user's input , process it and sometimes return it in response , i did not check that for passit.\n\nIf you are sure that all passit end-points does not reflect any user input , feel free to informative this ticket , otherwise it is strongly recommended to add the header since it will not impact any features.\n\n  Regards","markdown_message":"\u003cp\u003eHi \u003ca href=\"/david_x4am4\"\u003e@david_x4am4\u003c/a\u003e \u003c/p\u003e\n\n\u003cp\u003eThe impact or exploit of mime sniffing does not count on uploading contents , it can be triggered via parameter injection.\u003c/p\u003e\n\n\u003cp\u003eFor example if a page takes a message as parameter and displays it back to the user.\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"http://site.com/welcome?message=account+activated\" href=\"/redirect?url=http%3A%2F%2Fsite.com%2Fwelcome%3Fmessage%3Daccount%2Bactivated\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://site.com/welcome?message=account+activated\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eif the value of message is returned in response , with absence of the mentioned header , it can cause IE and chrome XSS .\u003c/p\u003e\n\n\u003cp\u003eThe parameter reflection in response can be considered  as untrusted content , attacker does not need to upload any contents.\u003c/p\u003e\n\n\u003cp\u003emany json end-points takes user\u0026#39;s input , process it and sometimes return it in response , i did not check that for passit.\u003c/p\u003e\n\n\u003cp\u003eIf you are sure that all passit end-points does not reflect any user input , feel free to informative this ticket , otherwise it is strongly recommended to add the header since it will not impact any features.\u003c/p\u003e\n\n\u003cp\u003eRegards\u003c/p\u003e\n","automated_response":false,"created_at":"2018-07-13T15:46:38.777Z","updated_at":"2018-07-13T15:46:38.777Z","actor":{"username":"exception","cleared":true,"url":"/exception","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/100/852/b1f7d559f94f85152099c4a3426ec92010ceba40_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"passit","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3045572,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Ok I'll add it - seems no harm. Mozilla recommends it in their observatory project. Will enable on staging.passit.io initially to make sure it doesn't cause any harm.","markdown_message":"\u003cp\u003eOk I\u0026#39;ll add it - seems no harm. Mozilla recommends it in their observatory project. Will enable on staging.passit.io initially to make sure it doesn\u0026#39;t cause any harm.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-07-14T19:29:59.917Z","updated_at":"2018-07-14T19:29:59.917Z","actor":{"username":"david_x4am4","cleared":false,"url":"/david_x4am4","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"passit","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3048619,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"I'm happy with it on staging - it will go out in 1.9 to app.passit.io. Feel free to verify on staging.passit.io","markdown_message":"\u003cp\u003eI\u0026#39;m happy with it on staging - it will go out in 1.9 to app.passit.io. Feel free to verify on staging.passit.io\u003c/p\u003e\n","automated_response":false,"created_at":"2018-07-15T19:54:01.814Z","updated_at":"2018-07-15T19:54:01.814Z","actor":{"username":"david_x4am4","cleared":false,"url":"/david_x4am4","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"exception","url":"/exception"},"genius_execution_id":null,"team_handle":"passit","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3048620,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-07-15T19:54:13.351Z","updated_at":"2018-07-15T19:54:13.351Z","first_to_agree":true,"actor":{"username":"david_x4am4","cleared":false,"url":"/david_x4am4","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"passit","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3062625,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Verified at  `staging.passit.io`.\n\n","markdown_message":"\u003cp\u003eVerified at  \u003ccode\u003estaging.passit.io\u003c/code\u003e.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-07-18T15:35:08.105Z","updated_at":"2018-07-18T15:35:08.105Z","actor":{"username":"exception","cleared":true,"url":"/exception","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/100/852/b1f7d559f94f85152099c4a3426ec92010ceba40_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"passit","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3093181,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-07-24T18:22:42.777Z","updated_at":"2018-07-24T18:22:42.777Z","actor":{"username":"exception","cleared":true,"url":"/exception","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/100/852/b1f7d559f94f85152099c4a3426ec92010ceba40_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"passit","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3093182,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-07-24T18:22:42.870Z","updated_at":"2018-07-24T18:22:42.870Z","actor":{"username":"exception","cleared":true,"url":"/exception","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/100/852/b1f7d559f94f85152099c4a3426ec92010ceba40_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"passit","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}