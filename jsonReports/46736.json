{"id":46736,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC80NjczNg==","url":"https://hackerone.com/reports/46736","title":"CSRF token leakage","state":"Closed","substate":"informative","readable_substate":"Informative","created_at":"2015-02-05T13:08:28.993Z","submitted_at":"2015-02-05T13:08:28.993Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"yassineaboukir","url":"/yassineaboukir","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/451/37c5ce2c2387acc330c1a4327e295bdc1ca6d334_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":563,"url":"https://hackerone.com/enter","handle":"enter","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/563/c57c2cff9d127ea563dabf763e1d340bada8dcb2_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/563/c57c2cff9d127ea563dabf763e1d340bada8dcb2_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"disabled","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Enter","twitter_handle":"enterhq","website":"https://wallet.enter.financial","about":"Keeps people out of collections while getting businesses paid."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2015-03-23T23:01:24.291Z","bug_reporter_agreed_on_going_public_at":"2015-02-21T23:01:14.309Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi,\r\nI have noticed that when the account verification fails here : https://wallet.robocoin.com/verify/ due to an error, the CSRF token is being leaked via GET method like : https://wallet.robocoin.com/verify/id?_csrf=b8ede20d-0c0b-4e16-9d05-6ad2ed8b72c4\r\nSo the authenticity token is being stored in the web browser history and can be retrieved by a malicious attacker in order to mount a successful CSRF attack against the victim. Besides, that the token can be reused multiple times and do not get expired on first use.\r\nBest regards.","vulnerability_information_html":"\u003cp\u003eHi,\u003cbr\u003e\nI have noticed that when the account verification fails here : \u003ca title=\"https://wallet.robocoin.com/verify/\" href=\"/redirect?url=https%3A%2F%2Fwallet.robocoin.com%2Fverify%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://wallet.robocoin.com/verify/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e due to an error, the CSRF token is being leaked via GET method like : \u003ca title=\"https://wallet.robocoin.com/verify/id?_csrf=b8ede20d-0c0b-4e16-9d05-6ad2ed8b72c4\" href=\"/redirect?url=https%3A%2F%2Fwallet.robocoin.com%2Fverify%2Fid%3F_csrf%3Db8ede20d-0c0b-4e16-9d05-6ad2ed8b72c4\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://wallet.robocoin.com/verify/id?_csrf=b8ede20d-0c0b-4e16-9d05-6ad2ed8b72c4\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nSo the authenticity token is being stored in the web browser history and can be retrieved by a malicious attacker in order to mount a successful CSRF attack against the victim. Besides, that the token can be reused multiple times and do not get expired on first use.\u003cbr\u003e\nBest regards.\u003c/p\u003e\n","weakness":{"id":45,"name":"Cross-Site Request Forgery (CSRF)"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2015-03-23T23:01:14.480Z","allow_singular_disclosure_after":-182070054.3219949,"singular_disclosure_allowed":true,"vote_count":5,"voters":["powerjacobb1","eveeez","its_afolic","spetr0x","snappyjack"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":329631,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Any updates here ?","markdown_message":"\u003cp\u003eAny updates here ?\u003c/p\u003e\n","automated_response":false,"created_at":"2015-02-10T23:51:28.376Z","updated_at":"2015-02-10T23:51:28.376Z","actor":{"username":"yassineaboukir","cleared":true,"url":"/yassineaboukir","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/451/37c5ce2c2387acc330c1a4327e295bdc1ca6d334_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"enter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":329674,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for the report. We're still investigating. ","markdown_message":"\u003cp\u003eThanks for the report. We\u0026#39;re still investigating. \u003c/p\u003e\n","automated_response":false,"created_at":"2015-02-11T00:20:33.804Z","updated_at":"2015-02-11T00:20:33.804Z","actor":{"username":"darin","cleared":false,"url":"/darin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/507/76e31bc0fcd1932a06b10f4e7382091a2a45f64a_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"enter","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":331935,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Are you going to triag this report ?","markdown_message":"\u003cp\u003eAre you going to triag this report ?\u003c/p\u003e\n","automated_response":false,"created_at":"2015-02-13T22:16:12.840Z","updated_at":"2015-02-13T22:16:12.840Z","actor":{"username":"yassineaboukir","cleared":true,"url":"/yassineaboukir","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/451/37c5ce2c2387acc330c1a4327e295bdc1ca6d334_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"enter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":331955,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2015-02-13T22:39:20.564Z","updated_at":"2015-02-13T22:39:20.564Z","actor":{"username":"darin","cleared":false,"url":"/darin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/507/76e31bc0fcd1932a06b10f4e7382091a2a45f64a_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"enter","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":336865,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"We've decided that the fix is too complex at this time and the security implications don't warrant mitigation. ","markdown_message":"\u003cp\u003eWe\u0026#39;ve decided that the fix is too complex at this time and the security implications don\u0026#39;t warrant mitigation. \u003c/p\u003e\n","automated_response":false,"created_at":"2015-02-21T22:53:42.806Z","updated_at":"2015-02-21T22:53:42.806Z","actor":{"username":"darin","cleared":false,"url":"/darin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/507/76e31bc0fcd1932a06b10f4e7382091a2a45f64a_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"enter","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":336888,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Haha nice joke :D May I disclose ?","markdown_message":"\u003cp\u003eHaha nice joke :D May I disclose ?\u003c/p\u003e\n","automated_response":false,"created_at":"2015-02-21T23:01:14.343Z","updated_at":"2015-02-21T23:01:14.343Z","first_to_agree":true,"actor":{"username":"yassineaboukir","cleared":true,"url":"/yassineaboukir","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/451/37c5ce2c2387acc330c1a4327e295bdc1ca6d334_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"enter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":336889,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I'm not sure what you think is a joke. But we've decided that the fix is too complex at this time and the security implications don't warrant mitigation. If you disagree, please state your case. ","markdown_message":"\u003cp\u003eI\u0026#39;m not sure what you think is a joke. But we\u0026#39;ve decided that the fix is too complex at this time and the security implications don\u0026#39;t warrant mitigation. If you disagree, please state your case. \u003c/p\u003e\n","automated_response":false,"created_at":"2015-02-21T23:03:33.101Z","updated_at":"2015-02-21T23:03:33.101Z","actor":{"username":"darin","cleared":false,"url":"/darin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/507/76e31bc0fcd1932a06b10f4e7382091a2a45f64a_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"enter","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":336890,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Sorry! it is just that I don't think fixing this issue would pose a huge problem besides that it is a quick win regarding its severity. The attacker can then trick authenticated user to perform CSRF attacks since the CSRF token associated with this user is known. This results in bypassing the existing CSRF protection in the RoboCoin application. ","markdown_message":"\u003cp\u003eSorry! it is just that I don\u0026#39;t think fixing this issue would pose a huge problem besides that it is a quick win regarding its severity. The attacker can then trick authenticated user to perform CSRF attacks since the CSRF token associated with this user is known. This results in bypassing the existing CSRF protection in the RoboCoin application. \u003c/p\u003e\n","automated_response":false,"created_at":"2015-02-21T23:09:36.040Z","updated_at":"2015-02-21T23:09:36.040Z","actor":{"username":"yassineaboukir","cleared":true,"url":"/yassineaboukir","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/451/37c5ce2c2387acc330c1a4327e295bdc1ca6d334_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"enter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":336894,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I guess you will be recieving a lot of reports concerning this issue but it is always up to you to decide to fix or not. \nBest regards.","markdown_message":"\u003cp\u003eI guess you will be recieving a lot of reports concerning this issue but it is always up to you to decide to fix or not. \u003cbr\u003e\nBest regards.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-02-21T23:14:55.065Z","updated_at":"2015-02-21T23:14:55.065Z","actor":{"username":"yassineaboukir","cleared":true,"url":"/yassineaboukir","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/451/37c5ce2c2387acc330c1a4327e295bdc1ca6d334_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"enter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":336895,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"The fix is actually technically complex and involves making other compromises. Given that the only people who could get access to the CSRF token are Google, and that the token expires fairly quickly, the attack surface is fairly small. Complex fix + new compromises + small attack surface = won't fix. \n\nWe truly thank you for the report and this is a valid bug. But we can't justify a fix at this time. Is there any part of the above info that you disagree with?","markdown_message":"\u003cp\u003eThe fix is actually technically complex and involves making other compromises. Given that the only people who could get access to the CSRF token are Google, and that the token expires fairly quickly, the attack surface is fairly small. Complex fix + new compromises + small attack surface = won\u0026#39;t fix. \u003c/p\u003e\n\n\u003cp\u003eWe truly thank you for the report and this is a valid bug. But we can\u0026#39;t justify a fix at this time. Is there any part of the above info that you disagree with?\u003c/p\u003e\n","automated_response":false,"created_at":"2015-02-21T23:15:31.367Z","updated_at":"2015-02-21T23:15:31.367Z","actor":{"username":"darin","cleared":false,"url":"/darin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/507/76e31bc0fcd1932a06b10f4e7382091a2a45f64a_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"enter","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":336896,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you for your clarifications, I have nothing else to add.","markdown_message":"\u003cp\u003eThank you for your clarifications, I have nothing else to add.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-02-21T23:17:59.094Z","updated_at":"2015-02-21T23:17:59.094Z","actor":{"username":"yassineaboukir","cleared":true,"url":"/yassineaboukir","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/451/37c5ce2c2387acc330c1a4327e295bdc1ca6d334_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"enter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":361285,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-03-23T23:01:24.831Z","updated_at":"2015-03-23T23:01:24.831Z","actor":{"url":"/enter","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/563/c57c2cff9d127ea563dabf763e1d340bada8dcb2_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Enter"}},"genius_execution_id":null,"team_handle":"enter","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}