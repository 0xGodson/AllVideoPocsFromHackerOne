{"id":642876,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC82NDI4NzY=","url":"https://hackerone.com/reports/642876","title":"URl redirection ","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2019-07-14T11:16:53.599Z","submitted_at":"2019-07-14T11:16:53.599Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"ziel","url":"/ziel","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/E2ku3vzf6wYxtk3KH2uZNepw/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":22925,"url":"https://hackerone.com/kartpay","handle":"kartpay","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/022/925/d481af80adf6cd2b19449b09c785cb232f74eeba_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/022/925/d481af80adf6cd2b19449b09c785cb232f74eeba_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Kartpay","twitter_handle":"","website":"http://Kartpay.com","about":"Kartpay is an Online Payment Gateway For Indian Region."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2019-08-28T15:31:37.871Z","bug_reporter_agreed_on_going_public_at":"2019-08-20T18:25:12.594Z","team_member_agreed_on_going_public_at":"2019-08-28T15:31:37.817Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"In the following post HTTP request while registering for merchant\n\n\nPOST /register HTTP/1.1\nHost: merchant.kartpay.com\nUser-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:67.0) Gecko/20100101 Firefox/67.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nReferer: https://merchant.kartpay.com/register\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 189\nDNT: 1\nConnection: close\nCookie: XSRF-TOKEN=eyJpdiI6IjFKUXdMQlhcL3Z0Ynh1c1dcL3gyeEpiZz09IiwidmFsdWUiOiIya3U5RUlwM0RuMUI5dGpQT0tWQ1Vwaml2bXgrYTk2aGM3UW03T3ZKM1ZYYnlnV2tOblg4eHhpR3lVM01xVzBjIiwibWFjIjoiYmMxNGNjYTY1N2MyMWIwMmYzYWZjNTczZWE0YTViNGQ0ZGVmNDBmYjkzYWFlNWEyN2Q4NGJhYjlkNDNlY2YzZCJ9; laravel_session=eyJpdiI6InJ2ZzByUm44aWFlUm5jSE1XRDV3clE9PSIsInZhbHVlIjoick1rVnRaNWw1YXVzMWJBWDFTaUJadm1pVTdXUHFrcks2Q0t4cmtqbXZGd3J5bTBuQW1MM2hyUXpodGV3R0M1ZyIsIm1hYyI6IjgxZmI2MDM0NmViNTNjYzQxOTI2MmE4OTIwOGZjZTI3ZjFmMmExNmQ0ZmM5NzZjNDkxZTQyNGFhNjczYTAwN2YifQ%3D%3D; __tawkuuid=e::kartpay.com::wQWbHoNu5pztKvKlrrxFMmm76vfDDCsNlhIe6kmIiM0OGKmL14t07iKcuOcjGIjy::2\nUpgrade-Insecure-Requests: 1\n\nverification_code=\u0026type=merchant\u0026_token=2zCgjrNgztgRCMhm4cDScrbTARxEmwn4z16Fjnpe\u0026first_name=ahcvcv\u0026last_name=jbshchjs\u0026email=jbcjhsbcbsb%40baxjbj.com\u0026country_code=%2B91\u0026contact_no=9090909090\n\n\n\nThe referrer header is vulnerable to open url redirection\n\n\n## Steps To Reproduce:\n[add details for how we can reproduce the issue]\n\n1. make above http request in burp suit\n  2. change the referrer header to any site say bing.com\n3. it gets redirected to bing.com\n\nPoc : attached screenshot\n\n## Impact\n\nAn attacker can construct a URL within the application that causes a redirection to an arbitrary external domain","vulnerability_information_html":"\u003cp\u003eIn the following post HTTP request while registering for merchant\u003c/p\u003e\n\n\u003cp\u003ePOST /register HTTP/1.1\u003cbr\u003e\nHost: merchant.kartpay.com\u003cbr\u003e\nUser-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:67.0) Gecko/20100101 Firefox/67.0\u003cbr\u003e\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,\u003cem\u003e/\u003c/em\u003e;q=0.8\u003cbr\u003e\nAccept-Language: en-US,en;q=0.5\u003cbr\u003e\nAccept-Encoding: gzip, deflate\u003cbr\u003e\nReferer: \u003ca title=\"https://merchant.kartpay.com/register\" href=\"/redirect?url=https%3A%2F%2Fmerchant.kartpay.com%2Fregister\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://merchant.kartpay.com/register\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nContent-Type: application/x-www-form-urlencoded\u003cbr\u003e\nContent-Length: 189\u003cbr\u003e\nDNT: 1\u003cbr\u003e\nConnection: close\u003cbr\u003e\nCookie: XSRF-TOKEN=eyJpdiI6IjFKUXdMQlhcL3Z0Ynh1c1dcL3gyeEpiZz09IiwidmFsdWUiOiIya3U5RUlwM0RuMUI5dGpQT0tWQ1Vwaml2bXgrYTk2aGM3UW03T3ZKM1ZYYnlnV2tOblg4eHhpR3lVM01xVzBjIiwibWFjIjoiYmMxNGNjYTY1N2MyMWIwMmYzYWZjNTczZWE0YTViNGQ0ZGVmNDBmYjkzYWFlNWEyN2Q4NGJhYjlkNDNlY2YzZCJ9; laravel_session=eyJpdiI6InJ2ZzByUm44aWFlUm5jSE1XRDV3clE9PSIsInZhbHVlIjoick1rVnRaNWw1YXVzMWJBWDFTaUJadm1pVTdXUHFrcks2Q0t4cmtqbXZGd3J5bTBuQW1MM2hyUXpodGV3R0M1ZyIsIm1hYyI6IjgxZmI2MDM0NmViNTNjYzQxOTI2MmE4OTIwOGZjZTI3ZjFmMmExNmQ0ZmM5NzZjNDkxZTQyNGFhNjczYTAwN2YifQ%3D%3D; __tawkuuid=e::kartpay.com::wQWbHoNu5pztKvKlrrxFMmm76vfDDCsNlhIe6kmIiM0OGKmL14t07iKcuOcjGIjy::2\u003cbr\u003e\nUpgrade-Insecure-Requests: 1\u003c/p\u003e\n\n\u003cp\u003everification_code=\u0026amp;type=merchant\u0026amp;_token=2zCgjrNgztgRCMhm4cDScrbTARxEmwn4z16Fjnpe\u0026amp;first_name=ahcvcv\u0026amp;last_name=jbshchjs\u0026amp;email=jbcjhsbcbsb%40baxjbj.com\u0026amp;country_code=%2B91\u0026amp;contact_no=9090909090\u003c/p\u003e\n\n\u003cp\u003eThe referrer header is vulnerable to open url redirection\u003c/p\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps To Reproduce:\u003c/h2\u003e\n\n\u003cp\u003e[add details for how we can reproduce the issue]\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003emake above http request in burp suit\n\n\u003col\u003e\n\u003cli\u003echange the referrer header to any site say bing.com\u003c/li\u003e\n\u003c/ol\u003e\n\u003c/li\u003e\n\u003cli\u003eit gets redirected to bing.com\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003ePoc : attached screenshot\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eAn attacker can construct a URL within the application that causes a redirection to an arbitrary external domain\u003c/p\u003e\n","weakness":{"id":53,"name":"Open Redirect"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":528890,"file_name":"kart.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/528/890/a3d4a92c23f1831fc19e121e2b4f1dcd824f3053/kart.png?response-content-disposition=attachment%3B%20filename%3D%22kart.png%22%3B%20filename%2A%3DUTF-8%27%27kart.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ3VAHLH6Z%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T063300Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCD4BvSsKgWcuX7%2Fh3b1LWkKs9s4yRHAxqyVwXJYWsOAwIhANvLMyKSbceDyM1TNnWf11IvuT7a61DuFVJhD%2BT%2Fb9IrKrQDCFcQARoMMDEzNjE5Mjc0ODQ5Igxmi6woSxw%2B6wnwBEMqkQPI1uJcvWS%2B7FQadeW43PrlhsnF4xiGOroakbutVFcvcHOdYKgLxjIJI5m7XwadzbZWnWfHV0%2B62Zb%2BWCUOjMWiTVIXVX7AwYN1lfeKcXEYUp0h0oyXmZ8r9%2Bj%2FMZUagb%2BGKS%2B8zxvRdQjMX1tdjoDe9OxP6o1mlqEZpx8AKw7LDp1Hz2ezBoeya6X2GupABl%2FOhOfLY3VwJj7aPTg85UEwxOdZDtc%2FqzwALQiQUZo0A1RP3Y8nbzGb8CydaoFTXkp8rbJlMiimc%2BP%2BkZhbzJrdAs2rl68CFeUO2KSps4veGXWDFFoEAu1EvHwhAyOhkUlWXmX73VMyIVDvCkiHkuulKA8DiBfGp90UyI0AqLxJxXh%2FgCjGVxceHzAhM03UULwYdje89A1ziU5p%2BKL3KWD4xZiWFhlIiy3U92ksRt8S3l2NanthhEGEvTgf6wIclSsc9f4UbYnjYnAAiXkBg6iZTwORuQ0lVt30ma%2B%2BklzemkOgRIzghR66jzWcsjfvliY27ODm9Z12Vrj3LNetmm3XRTDEg6v%2FBTrqAb0W67QCovsIpNAiT4CujLyYV%2FjYmZ4VKcAok0lQwqZsNMCoze3egJJr5KwJfEhstOKt8adGE2Rfh5M%2BaAuxUHx9CHzHYR0HmUar1TnotcADpaizJlkcQmrsTfX3xtHVR8i9rhilHwmpYSeCQBjKHP%2BS656Uyq6ksGCrQWI4ZK%2F8QgDLIm%2FkIF6FlqRmaPtAeqfdwNxXQoCBcVLYgai%2FvmYu0CSd0Q1ngm%2FQMLqJqwYCLLmqTZrGYBRc5a553mtVqPYXlzc8Pgvjp59x%2Fjbix5wBt%2BoNg6EeSWNYAv4D0k4TzkJ4Aj8N%2BdAfag%3D%3D\u0026X-Amz-Signature=ecd0dc2bc7bec2bc22ba8db56100620d6155090d8078edf7a07310b3ad40419c","file_size":174310,"type":"image/png"}],"allow_singular_disclosure_at":"2019-09-19T18:25:12.663Z","allow_singular_disclosure_after":-40306068.055565506,"singular_disclosure_allowed":true,"vote_count":3,"voters":["nessun00x","z41b1337_","ziel"],"severity":{"rating":"medium","author_type":"User"},"structured_scope":{"databaseId":3965,"asset_type":"URL","asset_identifier":"*.kartpay.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":5327528,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Any response??","markdown_message":"\u003cp\u003eAny response??\u003c/p\u003e\n","automated_response":false,"created_at":"2019-07-16T03:07:24.312Z","updated_at":"2019-07-16T03:07:24.312Z","actor":{"username":"ziel","cleared":false,"url":"/ziel","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/E2ku3vzf6wYxtk3KH2uZNepw/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"kartpay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5350313,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Any initial response? Atleast let me know the status of my report??","markdown_message":"\u003cp\u003eAny initial response? Atleast let me know the status of my report??\u003c/p\u003e\n","automated_response":false,"created_at":"2019-07-17T15:15:37.533Z","updated_at":"2019-07-17T15:15:37.533Z","actor":{"username":"ziel","cleared":false,"url":"/ziel","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/E2ku3vzf6wYxtk3KH2uZNepw/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"kartpay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5355582,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"it seems the bug has been fixed. I now checked. but why there hasn't been any response for the report? ","markdown_message":"\u003cp\u003eit seems the bug has been fixed. I now checked. but why there hasn\u0026#39;t been any response for the report? \u003c/p\u003e\n","automated_response":false,"created_at":"2019-07-18T07:26:02.349Z","updated_at":"2019-07-18T07:26:02.349Z","actor":{"username":"ziel","cleared":false,"url":"/ziel","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/E2ku3vzf6wYxtk3KH2uZNepw/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"kartpay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5375832,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello! @ayushoberoi I checked your Issue and verified with our team. We have not closed any issues yet. Secondly, This issue is valid but already reported by other hackers too. so adding you to the original report. ","markdown_message":"\u003cp\u003eHello! \u003ca href=\"/ayushoberoi\"\u003e@ayushoberoi\u003c/a\u003e I checked your Issue and verified with our team. We have not closed any issues yet. Secondly, This issue is valid but already reported by other hackers too. so adding you to the original report. \u003c/p\u003e\n","automated_response":false,"created_at":"2019-07-20T05:46:23.864Z","updated_at":"2019-07-20T05:46:23.864Z","actor":{"username":"m3th3lesh","cleared":false,"url":"/m3th3lesh","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"kartpay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5375835,"is_internal":false,"editable":false,"type":"Activities::BugDuplicate","message":"","markdown_message":"","automated_response":false,"created_at":"2019-07-20T05:47:02.297Z","updated_at":"2019-07-20T05:47:02.297Z","original_report_id":648721,"actor":{"username":"m3th3lesh","cleared":false,"url":"/m3th3lesh","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"kartpay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5375837,"is_internal":false,"editable":false,"type":"Activities::BugReopened","message":"","markdown_message":"","automated_response":false,"created_at":"2019-07-20T05:47:47.953Z","updated_at":"2019-07-20T05:47:47.953Z","actor":{"username":"m3th3lesh","cleared":false,"url":"/m3th3lesh","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"kartpay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5375839,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2019-07-20T05:47:54.851Z","updated_at":"2019-07-20T05:47:54.851Z","actor":{"username":"m3th3lesh","cleared":false,"url":"/m3th3lesh","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"kartpay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5488786,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2019-08-02T14:18:19.904Z","updated_at":"2019-08-02T14:18:19.904Z","actor":{"username":"m3th3lesh","cleared":false,"url":"/m3th3lesh","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"ziel","url":"/ziel"},"genius_execution_id":null,"team_handle":"kartpay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5488833,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Can  I get swag? I find them cool!!","markdown_message":"\u003cp\u003eCan  I get swag? I find them cool!!\u003c/p\u003e\n","automated_response":false,"created_at":"2019-08-02T14:23:42.657Z","updated_at":"2019-08-02T14:23:42.657Z","actor":{"username":"ziel","cleared":false,"url":"/ziel","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/E2ku3vzf6wYxtk3KH2uZNepw/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"kartpay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5619972,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-08-20T18:25:12.623Z","updated_at":"2019-08-20T18:25:12.623Z","first_to_agree":true,"actor":{"username":"ziel","cleared":false,"url":"/ziel","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/E2ku3vzf6wYxtk3KH2uZNepw/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"kartpay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5684452,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-08-28T15:31:37.836Z","updated_at":"2019-08-28T15:31:37.836Z","actor":{"username":"m3th3lesh","cleared":false,"url":"/m3th3lesh","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"kartpay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5684453,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-08-28T15:31:37.888Z","updated_at":"2019-08-28T15:31:37.888Z","actor":{"username":"m3th3lesh","cleared":false,"url":"/m3th3lesh","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"kartpay","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}