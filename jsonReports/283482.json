{"id":283482,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yODM0ODI=","url":"https://hackerone.com/reports/283482","title":"Login Cross Site Request Forgery ","state":"Closed","substate":"duplicate","readable_substate":"Duplicate","created_at":"2017-10-27T10:36:11.988Z","submitted_at":"2017-10-27T10:36:11.988Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"bluedangerforyou","url":"/bluedangerforyou","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/212/167/d4fe589a65a1733508ddc0a5d29090eeaaf3dbfc_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":21745,"url":"https://hackerone.com/infogram","handle":"infogram","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/021/745/553edf21f45ba8f73faba5d308e0d91fc026fef0_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/021/745/553edf21f45ba8f73faba5d308e0d91fc026fef0_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Infogram","twitter_handle":"infogram","website":"http://infogram.com","about":"Make Infographics and Charts that People Love"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2017-10-27T11:34:22.851Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2017-10-27T11:33:56.583Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Login form is not protected against Cross Site Request Forgery.\nAn attacker can craft html page containing POST information to have victim sign into an attacker's account, where the victim can add information assuming he/she is logged into the correct account, where in reality, the victim is signed into the attacker's account where the changes are visible to the attacker.\n\nThe real issue here, is that when the victim runs the html Proof of Concept, the account is logged in to attacker's without any visible warnings, thus the victim is capable of theft of data and potentially vulnerable to account takeover.\n\nSteps to reproduce\n1. Create victim account\n2. Create attacker account\n3. Run attached Proof of Concept in same browser as victim and press submit (The POF can be modified to look like a fake blog post relating to infogram as someone searching a blog post is likely logged in and using the web application already)\n4. On the victim browser, he/she is logged in as an attacker without any indication unless the page is manually refreshed.\n5. Go to library and add a facebook post, or a chart.\n6. On attacker browser, refresh page and navigate to library. You will see the victims added, or edited projects.\n\n\nMitigation\n\nPlease add a csrf token to login request or make some type prompt that the session has ended when the new login from attacker occurs.\n\nI have attached a video proof of concept with audio of my voice explaining and instructing.\nI have also attached the HTML proof of concept.","vulnerability_information_html":"\u003cp\u003eLogin form is not protected against Cross Site Request Forgery.\u003cbr\u003e\nAn attacker can craft html page containing POST information to have victim sign into an attacker\u0026#39;s account, where the victim can add information assuming he/she is logged into the correct account, where in reality, the victim is signed into the attacker\u0026#39;s account where the changes are visible to the attacker.\u003c/p\u003e\n\n\u003cp\u003eThe real issue here, is that when the victim runs the html Proof of Concept, the account is logged in to attacker\u0026#39;s without any visible warnings, thus the victim is capable of theft of data and potentially vulnerable to account takeover.\u003c/p\u003e\n\n\u003cp\u003eSteps to reproduce\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eCreate victim account\u003c/li\u003e\n\u003cli\u003eCreate attacker account\u003c/li\u003e\n\u003cli\u003eRun attached Proof of Concept in same browser as victim and press submit (The POF can be modified to look like a fake blog post relating to infogram as someone searching a blog post is likely logged in and using the web application already)\u003c/li\u003e\n\u003cli\u003eOn the victim browser, he/she is logged in as an attacker without any indication unless the page is manually refreshed.\u003c/li\u003e\n\u003cli\u003eGo to library and add a facebook post, or a chart.\u003c/li\u003e\n\u003cli\u003eOn attacker browser, refresh page and navigate to library. You will see the victims added, or edited projects.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eMitigation\u003c/p\u003e\n\n\u003cp\u003ePlease add a csrf token to login request or make some type prompt that the session has ended when the new login from attacker occurs.\u003c/p\u003e\n\n\u003cp\u003eI have attached a video proof of concept with audio of my voice explaining and instructing.\u003cbr\u003e\nI have also attached the HTML proof of concept.\u003c/p\u003e\n","weakness":{"id":45,"name":"Cross-Site Request Forgery (CSRF)"},"original_report_id":280366,"original_report_url":"https://hackerone.com/reports/280366","attachments":[{"id":233367,"file_name":"infogramLOGINCSRF.mp4","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/233/367/da38580331ce9396700fa0b5a23916136e804684/infogramLOGINCSRF.mp4?response-content-disposition=attachment%3B%20filename%3D%22infogramLOGINCSRF.mp4%22%3B%20filename%2A%3DUTF-8%27%27infogramLOGINCSRF.mp4\u0026response-content-type=video%2Fmp4\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQRAVCXZTG%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T052314Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCDC1SbghdXLcy9ot06DANg74r5EiCC3XZ9CQGAdi%2BmbgIhALBQDzrYaszHyI6V41WOAEV%2Fa%2FxVgBgdKj18DrlZlW1RKrQDCFYQARoMMDEzNjE5Mjc0ODQ5IgxgXaQ5tEaz15kO93YqkQPMn8lqJM5b%2F2UF4vgQzRZODqw%2FjPEjzpD61mE7LpyVCQKuiixef4EDRyTs5YaVZ%2BSeI6BYbm829Q00SoHZnAn9tGULy0VEKf9Lyq8uAs7eAOStN9gpb9p9GsQ2vxpwHzC%2F%2FjQuXDX8lTd6eIkj3L4VFhPdt4MGf%2FwzTbeirX69pmEGa7VpqUl%2BzQFSRmiyNkLz0iIRuGyUxcUtEFnAa4dcYImN8d5Xmzj3VKwszN5CZZekG0f6wVgiDQt2PU05Sm4mXV8F7Zsd2gCjxy0LByxZo8wVIQRR7XpJjeAXw7Y%2BrcntwG4VG16O2JBB13PV47avtAluDB7xEmxCn7fC%2B0gCkgtqX5FvemeTqZkzDj%2BNAE87%2BEwY1GKygDSgK%2BDrUlCwwYU%2FB1k9vGEpOa46oz6dP6MWDopeRWpW%2Fh2qwIShnMsIk%2BmfjH9n%2FnOGNwWwQp93Hlr6OPw%2F8tYLstkLZrNH3jzkkWMoWcsrv71HzpJiG6RZtm22uXPNaQTbmOYqMX%2BCryjdGcVIctKAsj5EliP0zjCb4Kr%2FBTrqAW3ufL%2FR%2FpkxPRO%2BUhyyvDPzgPmCSraR2g7lBy3KlX6LZ3JukP4SRvLInSvSu0w4T7VQh0EVNyALDb1flUgqzAKwYanyEiiHqHeCF6g4fX5%2Fuz8knjUQsnKmjOQfBtyaMe0qlW%2BHWCfwsR%2Fh2SNKi%2BVT7%2FCT2Ct%2Fia0RQuGDOtTr7KGlRg89Qz6oCZtR4isqOEM5yt6saYHHNTOAelO07weXRwFwKuKqmrZYMA5sa9p7XKqJAwmjMWMyFxAcEDHOluiNcMsa9JfilicFsycW11kxP5ZdIbUgRRdK1IdlTu3Ykx5X3L1RmsfWjw%3D%3D\u0026X-Amz-Signature=cb5a4c51fc752e32f3fdda79b7bd878bc4343fbef0a930f7f8d07a8aca29d2cd","file_size":16815472,"type":"video/mp4"},{"id":233368,"file_name":"infogramLOGINCSRF_POC.html","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/233/368/7306423df21075fa41b6ad351d549a75cb44b09d/infogramLOGINCSRF_POC.html?response-content-disposition=attachment%3B%20filename%3D%22infogramLOGINCSRF_POC.html%22%3B%20filename%2A%3DUTF-8%27%27infogramLOGINCSRF_POC.html\u0026response-content-type=application%2Foctet-stream\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQRAVCXZTG%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T052314Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCDC1SbghdXLcy9ot06DANg74r5EiCC3XZ9CQGAdi%2BmbgIhALBQDzrYaszHyI6V41WOAEV%2Fa%2FxVgBgdKj18DrlZlW1RKrQDCFYQARoMMDEzNjE5Mjc0ODQ5IgxgXaQ5tEaz15kO93YqkQPMn8lqJM5b%2F2UF4vgQzRZODqw%2FjPEjzpD61mE7LpyVCQKuiixef4EDRyTs5YaVZ%2BSeI6BYbm829Q00SoHZnAn9tGULy0VEKf9Lyq8uAs7eAOStN9gpb9p9GsQ2vxpwHzC%2F%2FjQuXDX8lTd6eIkj3L4VFhPdt4MGf%2FwzTbeirX69pmEGa7VpqUl%2BzQFSRmiyNkLz0iIRuGyUxcUtEFnAa4dcYImN8d5Xmzj3VKwszN5CZZekG0f6wVgiDQt2PU05Sm4mXV8F7Zsd2gCjxy0LByxZo8wVIQRR7XpJjeAXw7Y%2BrcntwG4VG16O2JBB13PV47avtAluDB7xEmxCn7fC%2B0gCkgtqX5FvemeTqZkzDj%2BNAE87%2BEwY1GKygDSgK%2BDrUlCwwYU%2FB1k9vGEpOa46oz6dP6MWDopeRWpW%2Fh2qwIShnMsIk%2BmfjH9n%2FnOGNwWwQp93Hlr6OPw%2F8tYLstkLZrNH3jzkkWMoWcsrv71HzpJiG6RZtm22uXPNaQTbmOYqMX%2BCryjdGcVIctKAsj5EliP0zjCb4Kr%2FBTrqAW3ufL%2FR%2FpkxPRO%2BUhyyvDPzgPmCSraR2g7lBy3KlX6LZ3JukP4SRvLInSvSu0w4T7VQh0EVNyALDb1flUgqzAKwYanyEiiHqHeCF6g4fX5%2Fuz8knjUQsnKmjOQfBtyaMe0qlW%2BHWCfwsR%2Fh2SNKi%2BVT7%2FCT2Ct%2Fia0RQuGDOtTr7KGlRg89Qz6oCZtR4isqOEM5yt6saYHHNTOAelO07weXRwFwKuKqmrZYMA5sa9p7XKqJAwmjMWMyFxAcEDHOluiNcMsa9JfilicFsycW11kxP5ZdIbUgRRdK1IdlTu3Ykx5X3L1RmsfWjw%3D%3D\u0026X-Amz-Signature=d9c2669e863258676edb2304cf99e25107897c0b38aafc33fc9fd86ec1ec1f62","file_size":409,"type":"text/html"}],"allow_singular_disclosure_at":null,"vote_count":2,"voters":["geekninja","bluedangerforyou"],"structured_scope":{"databaseId":870,"asset_type":"URL","asset_identifier":"infogram.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":2108000,"is_internal":false,"editable":false,"type":"Activities::BugDuplicate","message":"","markdown_message":"","automated_response":false,"created_at":"2017-10-27T11:16:19.917Z","updated_at":"2017-10-27T11:16:19.917Z","original_report_id":280366,"actor":{"username":"kaspars","cleared":false,"url":"/kaspars","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"infogram","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2108039,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Awesome, may this be disclosed?","markdown_message":"\u003cp\u003eAwesome, may this be disclosed?\u003c/p\u003e\n","automated_response":false,"created_at":"2017-10-27T11:27:32.900Z","updated_at":"2017-10-27T11:27:32.900Z","actor":{"username":"bluedangerforyou","cleared":false,"url":"/bluedangerforyou","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/212/167/d4fe589a65a1733508ddc0a5d29090eeaaf3dbfc_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"infogram","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2108057,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-10-27T11:33:56.615Z","updated_at":"2017-10-27T11:33:56.615Z","first_to_agree":true,"actor":{"username":"kaspars","cleared":false,"url":"/kaspars","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"infogram","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2108060,"is_internal":false,"editable":false,"type":"Activities::ManuallyDisclosed","message":"","markdown_message":"","automated_response":false,"created_at":"2017-10-27T11:34:22.798Z","updated_at":"2017-10-27T11:34:22.798Z","actor":{"username":"kaspars","cleared":false,"url":"/kaspars","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"infogram","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}