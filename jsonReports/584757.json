{"id":584757,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC81ODQ3NTc=","url":"https://hackerone.com/reports/584757","title":"Null Pointer Dereference in phar_create_or_parse_filename","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2019-05-20T01:29:57.192Z","submitted_at":"2019-05-20T01:29:57.192Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"chihuahua","url":"/chihuahua","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/238/742/1d3c1a04a6af55cbe2724f60bb57e5d39d7cb59f_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":29,"url":"https://hackerone.com/ibb-php","handle":"ibb-php","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/029/99087dbbdf52fc3ce3acbf16aa33a5c4f5e2c111_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/029/99087dbbdf52fc3ce3acbf16aa33a5c4f5e2c111_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"paused","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"PHP (IBB)","twitter_handle":"","website":"http://www.php.net","about":""}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2020-10-10T18:47:55.880Z","bug_reporter_agreed_on_going_public_at":"2020-10-10T03:51:36.457Z","team_member_agreed_on_going_public_at":"2020-10-10T18:47:55.781Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"The original report is here https://bugs.php.net/bug.php?id=77396\n\n```\nDescription:\n------------\nPlease use these poc file:\nhttps://drive.google.com/file/d/1bzw-j4FtV7PEf6SW2GYmDVKtMybmbKnl/view?usp=sharing\n\nTest script:\n---------------\nUSE_ZEND_ALLOC=0 ../../php-7.1.25/sapi/cli/php -r '$phar=new PharData(file_get_contents(\"id:000005,sig:06,src:000230,op:havoc,rep:8\"));'\n\n\nActual result:\n--------------\nUSE_ZEND_ALLOC=0 ../../php-7.1.25/sapi/cli/php -r '$phar=new PharData(file_get_contents(\"id:000005,sig:06,src:000230,op:havoc,rep:8\"));'\nASAN:SIGSEGV\n=================================================================\n==78112==ERROR: AddressSanitizer: SEGV on unknown address 0x000000000000 (pc 0x7f0a8ff9a746 bp 0x7ffc3694f6c0 sp 0x7ffc3694ee48 T0)\n    #0 0x7f0a8ff9a745 in strlen (/lib/x86_64-linux-gnu/libc.so.6+0x8b745)\n    #1 0x7f0a90e2c1a5 in __interceptor_strlen (/usr/lib/x86_64-linux-gnu/libasan.so.2+0x701a5)\n    #2 0x105a1fe in phar_create_or_parse_filename /home/hackyzh/Desktop/php-7.1.25/ext/phar/phar.c:1388\n    #3 0x105b94d in phar_open_or_create_filename /home/hackyzh/Desktop/php-7.1.25/ext/phar/phar.c:1328\n    #4 0x1075f65 in zim_Phar___construct /home/hackyzh/Desktop/php-7.1.25/ext/phar/phar_object.c:1195\n    #5 0x1f740b8 in ZEND_DO_FCALL_SPEC_RETVAL_UNUSED_HANDLER /home/hackyzh/Desktop/php-7.1.25/Zend/zend_vm_execute.h:970\n    #6 0x1eb6a66 in execute_ex /home/hackyzh/Desktop/php-7.1.25/Zend/zend_vm_execute.h:429\n    #7 0x1f87f14 in zend_execute /home/hackyzh/Desktop/php-7.1.25/Zend/zend_vm_execute.h:474\n    #8 0x189ed80 in zend_eval_stringl /home/hackyzh/Desktop/php-7.1.25/Zend/zend_execute_API.c:1120\n    #9 0x189f2d0 in zend_eval_stringl_ex /home/hackyzh/Desktop/php-7.1.25/Zend/zend_execute_API.c:1161\n    #10 0x1f94de8 in do_cli /home/hackyzh/Desktop/php-7.1.25/sapi/cli/php_cli.c:1024\n    #11 0x45f880 in main /home/hackyzh/Desktop/php-7.1.25/sapi/cli/php_cli.c:1381\n    #12 0x7f0a8ff2f82f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2082f)\n    #13 0x45feb8 in _start (/home/hackyzh/Desktop/php-7.1.25/sapi/cli/php+0x45feb8)\n\nAddressSanitizer can not provide additional info.\nSUMMARY: AddressSanitizer: SEGV ??:0 strlen\n==78112==ABORTING\n```\n\n## Impact\n\nDenial of service","vulnerability_information_html":"\u003cp\u003eThe original report is here \u003ca title=\"https://bugs.php.net/bug.php?id=77396\" href=\"/redirect?url=https%3A%2F%2Fbugs.php.net%2Fbug.php%3Fid%3D77396\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://bugs.php.net/bug.php?id=77396\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eDescription:\n------------\nPlease use these poc file:\nhttps://drive.google.com/file/d/1bzw-j4FtV7PEf6SW2GYmDVKtMybmbKnl/view?usp=sharing\n\nTest script:\n---------------\nUSE_ZEND_ALLOC=0 ../../php-7.1.25/sapi/cli/php -r \u0026#39;$phar=new PharData(file_get_contents(\u0026quot;id:000005,sig:06,src:000230,op:havoc,rep:8\u0026quot;));\u0026#39;\n\n\nActual result:\n--------------\nUSE_ZEND_ALLOC=0 ../../php-7.1.25/sapi/cli/php -r \u0026#39;$phar=new PharData(file_get_contents(\u0026quot;id:000005,sig:06,src:000230,op:havoc,rep:8\u0026quot;));\u0026#39;\nASAN:SIGSEGV\n=================================================================\n==78112==ERROR: AddressSanitizer: SEGV on unknown address 0x000000000000 (pc 0x7f0a8ff9a746 bp 0x7ffc3694f6c0 sp 0x7ffc3694ee48 T0)\n    #0 0x7f0a8ff9a745 in strlen (/lib/x86_64-linux-gnu/libc.so.6+0x8b745)\n    #1 0x7f0a90e2c1a5 in __interceptor_strlen (/usr/lib/x86_64-linux-gnu/libasan.so.2+0x701a5)\n    #2 0x105a1fe in phar_create_or_parse_filename /home/hackyzh/Desktop/php-7.1.25/ext/phar/phar.c:1388\n    #3 0x105b94d in phar_open_or_create_filename /home/hackyzh/Desktop/php-7.1.25/ext/phar/phar.c:1328\n    #4 0x1075f65 in zim_Phar___construct /home/hackyzh/Desktop/php-7.1.25/ext/phar/phar_object.c:1195\n    #5 0x1f740b8 in ZEND_DO_FCALL_SPEC_RETVAL_UNUSED_HANDLER /home/hackyzh/Desktop/php-7.1.25/Zend/zend_vm_execute.h:970\n    #6 0x1eb6a66 in execute_ex /home/hackyzh/Desktop/php-7.1.25/Zend/zend_vm_execute.h:429\n    #7 0x1f87f14 in zend_execute /home/hackyzh/Desktop/php-7.1.25/Zend/zend_vm_execute.h:474\n    #8 0x189ed80 in zend_eval_stringl /home/hackyzh/Desktop/php-7.1.25/Zend/zend_execute_API.c:1120\n    #9 0x189f2d0 in zend_eval_stringl_ex /home/hackyzh/Desktop/php-7.1.25/Zend/zend_execute_API.c:1161\n    #10 0x1f94de8 in do_cli /home/hackyzh/Desktop/php-7.1.25/sapi/cli/php_cli.c:1024\n    #11 0x45f880 in main /home/hackyzh/Desktop/php-7.1.25/sapi/cli/php_cli.c:1381\n    #12 0x7f0a8ff2f82f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2082f)\n    #13 0x45feb8 in _start (/home/hackyzh/Desktop/php-7.1.25/sapi/cli/php+0x45feb8)\n\nAddressSanitizer can not provide additional info.\nSUMMARY: AddressSanitizer: SEGV ??:0 strlen\n==78112==ABORTING\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eDenial of service\u003c/p\u003e\n","weakness":{"id":51,"name":"NULL Pointer Dereference"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2020-11-09T03:51:36.510Z","allow_singular_disclosure_after":-4329368.070999025,"singular_disclosure_allowed":true,"vote_count":3,"voters":["prophet","alumni","yazaw"],"severity":{"rating":"low","author_type":"User"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":4884844,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @chihuahua,\n\nThank you for your submission. Your report is currently being reviewed and the HackerOne triage team will get back to you once there is additional information to share.\n\nKind regards,\n@antenna ","markdown_message":"\u003cp\u003eHi \u003ca href=\"/chihuahua\"\u003e@chihuahua\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThank you for your submission. Your report is currently being reviewed and the HackerOne triage team will get back to you once there is additional information to share.\u003c/p\u003e\n\n\u003cp\u003eKind regards,\u003cbr\u003e\n\u003ca href=\"/antenna\"\u003e@antenna\u003c/a\u003e \u003c/p\u003e\n","automated_response":false,"created_at":"2019-05-20T17:50:57.498Z","updated_at":"2019-05-20T17:50:57.498Z","actor":{"username":"antenna","cleared":false,"url":"/antenna","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/B1a8q5ga9BZjMczKoqAbnMj5/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"ibb-php","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":4884861,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2019-05-20T17:54:14.228Z","updated_at":"2019-05-20T17:54:14.228Z","actor":{"username":"antenna","cleared":false,"url":"/antenna","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/B1a8q5ga9BZjMczKoqAbnMj5/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"ibb-php","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":4884862,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello @chihuahua,\n\nThank you for your submission! We were able to validate your report, and have submitted it to the appropriate remediation team for review. They will let us know the final ruling on this report, and when/if a fix will be implemented. Please note that the status and severity are subject to change.\n\nRegards,\n@antenna ","markdown_message":"\u003cp\u003eHello \u003ca href=\"/chihuahua\"\u003e@chihuahua\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThank you for your submission! We were able to validate your report, and have submitted it to the appropriate remediation team for review. They will let us know the final ruling on this report, and when/if a fix will be implemented. Please note that the status and severity are subject to change.\u003c/p\u003e\n\n\u003cp\u003eRegards,\u003cbr\u003e\n\u003ca href=\"/antenna\"\u003e@antenna\u003c/a\u003e \u003c/p\u003e\n","automated_response":false,"created_at":"2019-05-20T17:54:22.064Z","updated_at":"2019-05-20T17:54:22.064Z","actor":{"username":"antenna","cleared":false,"url":"/antenna","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/B1a8q5ga9BZjMczKoqAbnMj5/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"ibb-php","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":6088334,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Any response?","markdown_message":"\u003cp\u003eAny response?\u003c/p\u003e\n","automated_response":false,"created_at":"2019-10-21T06:21:43.843Z","updated_at":"2019-10-21T06:21:43.843Z","actor":{"username":"chihuahua","cleared":false,"url":"/chihuahua","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/238/742/1d3c1a04a6af55cbe2724f60bb57e5d39d7cb59f_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"ibb-php","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9477607,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"","markdown_message":"","automated_response":false,"created_at":"2020-10-09T23:35:18.550Z","updated_at":"2020-10-09T23:35:18.550Z","actor":{"url":"/ibb-php","ibb":true,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/029/99087dbbdf52fc3ce3acbf16aa33a5c4f5e2c111_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"PHP (IBB)"}},"genius_execution_id":null,"team_handle":"ibb-php","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9477620,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hi @chihuahua,\n\nOn behalf of the Internet Bug Bounty Panel, thank you for your continued patience on this report. The IBB requires that all in-scope open source projects be mutually engaged with us to ensure there is a good experience for all. Unfortunately, we have not been able to maintain that relationship with the upstream PHP community, and as a result, HackerOne and the IBB Panel have collectively agreed to shut down the program indefinitely.\n\nBased on the severity of \"Low\" as determined on based on the PHP policy and severity assigned on the accompanying CVE, we are not awarding a bounty for this report.\n\nAs an act of good faith, we will close this report as Resolved.\n\nThank you for helping keep the internet safe and secure!\n-The Internet Bug Bounty Panel \n","markdown_message":"\u003cp\u003eHi \u003ca href=\"/chihuahua\"\u003e@chihuahua\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eOn behalf of the Internet Bug Bounty Panel, thank you for your continued patience on this report. The IBB requires that all in-scope open source projects be mutually engaged with us to ensure there is a good experience for all. Unfortunately, we have not been able to maintain that relationship with the upstream PHP community, and as a result, HackerOne and the IBB Panel have collectively agreed to shut down the program indefinitely.\u003c/p\u003e\n\n\u003cp\u003eBased on the severity of \u0026quot;Low\u0026quot; as determined on based on the PHP policy and severity assigned on the accompanying CVE, we are not awarding a bounty for this report.\u003c/p\u003e\n\n\u003cp\u003eAs an act of good faith, we will close this report as Resolved.\u003c/p\u003e\n\n\u003cp\u003eThank you for helping keep the internet safe and secure!\u003cbr\u003e\n-The Internet Bug Bounty Panel \u003c/p\u003e\n","automated_response":false,"created_at":"2020-10-09T23:37:01.430Z","updated_at":"2020-10-09T23:37:01.430Z","actor":{"username":"reed","cleared":false,"url":"/reed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"reporter":{"username":"chihuahua","url":"/chihuahua"},"genius_execution_id":null,"team_handle":"ibb-php","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9478950,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-10-10T03:51:36.478Z","updated_at":"2020-10-10T03:51:36.478Z","first_to_agree":true,"actor":{"username":"chihuahua","cleared":false,"url":"/chihuahua","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/238/742/1d3c1a04a6af55cbe2724f60bb57e5d39d7cb59f_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"ibb-php","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9482443,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-10-10T18:47:55.800Z","updated_at":"2020-10-10T18:47:55.800Z","actor":{"username":"reed","cleared":false,"url":"/reed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"ibb-php","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9482444,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-10-10T18:47:55.900Z","updated_at":"2020-10-10T18:47:55.900Z","actor":{"username":"reed","cleared":false,"url":"/reed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"ibb-php","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}