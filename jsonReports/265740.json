{"id":265740,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yNjU3NDA=","url":"https://hackerone.com/reports/265740","title":"[Cross Domain Referrer Leakage] Password Reset Token Leaking to Third party Sites.","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2017-09-04T07:53:26.427Z","submitted_at":"2017-09-04T07:53:26.427Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"ykw1337","url":"/ykw1337","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":2450,"url":"https://hackerone.com/maximum","handle":"maximum","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/002/450/6cac31c0a6ad854c086c328817a688e4720a3306_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/450/6cac31c0a6ad854c086c328817a688e4720a3306_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Maximum","twitter_handle":"maximum_NL","website":"https://maximum.nl","about":"Maximum is a full-service agency specialised in employer branding and recruitment advertising."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-09-07T15:56:37.356Z","bug_reporter_agreed_on_going_public_at":"2017-09-04T08:45:46.558Z","team_member_agreed_on_going_public_at":"2017-09-07T15:56:37.173Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"\n**Domain and URL:**\nhttps://werkenbijdefensie.nl\n\n**Summary:**:  Password Reset Token Leaking to Third party Sites from the link in the footer\n\n**Description:** Hello,\nI found that the if a user request for a password reset link and open it but don't change the password and click on the Third Parties Sites link in the Footer his Password Reset Token will be leaked by the Server to that third party site and that token can be used by third parties to reset the password and take over the account.\n\n## Steps To Reproduce:\n\n1. Request a password reset token to your email.\n2. When received open the link.\n3. Click the Link to the social media sites like facebook, twitter, youtube and etc.\n4. The Following Request would be sent:\n\n\nGET /werkenbijdefensie HTTP/1.1\nHost: www.facebook.com\nUser-Agent: Mozilla/5.0 (Windows NT 6.1; rv:30.0) Gecko/20100101 Firefox/30.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nReferer: https://werkenbijdefensie.nl/het-vizier/wachtwoord-wijzigen.html?token=\u003csome token\u003e\nCookie: \u003ccookies\u003e\nConnection: keep-alive\n\n\nIf you need any further information please be free to ask me.","vulnerability_information_html":"\u003cp\u003e\u003cstrong\u003eDomain and URL:\u003c/strong\u003e\u003cbr\u003e\n\u003ca title=\"https://werkenbijdefensie.nl\" href=\"/redirect?url=https%3A%2F%2Fwerkenbijdefensie.nl\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://werkenbijdefensie.nl\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eSummary:\u003c/strong\u003e:  Password Reset Token Leaking to Third party Sites from the link in the footer\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eDescription:\u003c/strong\u003e Hello,\u003cbr\u003e\nI found that the if a user request for a password reset link and open it but don\u0026#39;t change the password and click on the Third Parties Sites link in the Footer his Password Reset Token will be leaked by the Server to that third party site and that token can be used by third parties to reset the password and take over the account.\u003c/p\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps To Reproduce:\u003c/h2\u003e\n\n\u003col\u003e\n\u003cli\u003eRequest a password reset token to your email.\u003c/li\u003e\n\u003cli\u003eWhen received open the link.\u003c/li\u003e\n\u003cli\u003eClick the Link to the social media sites like facebook, twitter, youtube and etc.\u003c/li\u003e\n\u003cli\u003eThe Following Request would be sent:\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eGET /werkenbijdefensie HTTP/1.1\u003cbr\u003e\nHost: \u003ca href=\"/redirect?url=http%3A%2F%2Fwww.facebook.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ewww.facebook.com\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nUser-Agent: Mozilla/5.0 (Windows NT 6.1; rv:30.0) Gecko/20100101 Firefox/30.0\u003cbr\u003e\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,\u003cem\u003e/\u003c/em\u003e;q=0.8\u003cbr\u003e\nAccept-Language: en-US,en;q=0.5\u003cbr\u003e\nAccept-Encoding: gzip, deflate\u003cbr\u003e\nReferer: \u003ca title=\"https://werkenbijdefensie.nl/het-vizier/wachtwoord-wijzigen.html?token=\" href=\"/redirect?url=https%3A%2F%2Fwerkenbijdefensie.nl%2Fhet-vizier%2Fwachtwoord-wijzigen.html%3Ftoken%3D\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://werkenbijdefensie.nl/het-vizier/wachtwoord-wijzigen.html?token=\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u0026lt;some token\u0026gt;\u003cbr\u003e\nCookie: \u0026lt;cookies\u0026gt;\u003cbr\u003e\nConnection: keep-alive\u003c/p\u003e\n\n\u003cp\u003eIf you need any further information please be free to ask me.\u003c/p\u003e\n","bounty_amount":"40.0","formatted_bounty":"$40","weakness":{"id":18,"name":"Information Disclosure"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2017-10-04T08:45:46.599Z","allow_singular_disclosure_after":-102112279.89558563,"singular_disclosure_allowed":true,"vote_count":10,"voters":["cuso4","eveeez","r3y","ronygigi","sup3r-b0y","japz","securityteacher","iamnot1337","algen","abi3350a"],"severity":{"rating":"medium","author_type":"User"},"structured_scope":{"databaseId":163,"asset_type":"URL","asset_identifier":"werkenbijdefensie.nl","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1974453,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hey aliashber1,\n\nThanks for your report. I've added a `rel=\"noreferrer\"` attribute to the external links preventing modern browsers to send the referrer header. As big companies like Facebook, Twitter, LinkedIn, Google, etc. aren't really concerned with the massive amount of referrers they receive it was a rather small risk. But this quick fix should do it.\nI'll assign my colleague to assign bounty.\nHang tight!","markdown_message":"\u003cp\u003eHey aliashber1,\u003c/p\u003e\n\n\u003cp\u003eThanks for your report. I\u0026#39;ve added a \u003ccode\u003erel=\u0026quot;noreferrer\u0026quot;\u003c/code\u003e attribute to the external links preventing modern browsers to send the referrer header. As big companies like Facebook, Twitter, LinkedIn, Google, etc. aren\u0026#39;t really concerned with the massive amount of referrers they receive it was a rather small risk. But this quick fix should do it.\u003cbr\u003e\nI\u0026#39;ll assign my colleague to assign bounty.\u003cbr\u003e\nHang tight!\u003c/p\u003e\n","automated_response":false,"created_at":"2017-09-04T08:25:26.570Z","updated_at":"2017-09-04T08:25:26.570Z","actor":{"username":"bamie","cleared":false,"url":"/bamie","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/039/631/8aff5981b7c2a3519ed7170def4f7ad2392d13da_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"ykw1337","url":"/ykw1337"},"genius_execution_id":null,"team_handle":"maximum","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1974458,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @bamie ,\n\nI really appreciate your resolution time which was less than one hour. Really Appreciated.\n\nThanks,\nAli Ashber","markdown_message":"\u003cp\u003eHey \u003ca href=\"/bamie\"\u003e@bamie\u003c/a\u003e ,\u003c/p\u003e\n\n\u003cp\u003eI really appreciate your resolution time which was less than one hour. Really Appreciated.\u003c/p\u003e\n\n\u003cp\u003eThanks,\u003cbr\u003e\nAli Ashber\u003c/p\u003e\n","automated_response":false,"created_at":"2017-09-04T08:27:43.248Z","updated_at":"2017-09-04T08:27:43.248Z","actor":{"username":"ykw1337","cleared":false,"url":"/ykw1337","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"maximum","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1974485,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Disclosure so that others can appreciate your efforts. ","markdown_message":"\u003cp\u003eDisclosure so that others can appreciate your efforts. \u003c/p\u003e\n","automated_response":false,"created_at":"2017-09-04T08:45:46.578Z","updated_at":"2017-09-04T08:45:46.578Z","first_to_agree":true,"actor":{"username":"ykw1337","cleared":false,"url":"/ykw1337","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"maximum","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1975148,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello @bamie,\n\nI just checked that if the issue has been resolved or not but i was still receiving the same request as mentioned in report. Check the Screen Shot for confirmation. Please do some amendments in the Solution you just did before so that any one's account couldn't be in danger.\n\nAli Ashber.\n\n","markdown_message":"\u003cp\u003eHello \u003ca href=\"/bamie\"\u003e@bamie\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eI just checked that if the issue has been resolved or not but i was still receiving the same request as mentioned in report. Check the Screen Shot for confirmation. Please do some amendments in the Solution you just did before so that any one\u0026#39;s account couldn\u0026#39;t be in danger.\u003c/p\u003e\n\n\u003cp\u003eAli Ashber.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-09-04T14:14:50.594Z","updated_at":"2017-09-04T14:14:50.594Z","actor":{"username":"ykw1337","cleared":false,"url":"/ykw1337","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"attachments":[{"id":218285,"filename":"Capture.PNG","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/218/285/768daf765e8ddcbe4a8579a16946a0b48d044ab1/Capture.PNG?response-content-disposition=attachment%3B%20filename%3D%22Capture.PNG%22%3B%20filename%2A%3DUTF-8%27%27Capture.PNG\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSUJSTWNA%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T051706Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQDC4LZo82wc2eCvBFlhjwE027CwJoHB88%2BMK2v03JEf7AIgTsNTuR7XI5zLkpcU%2F192zliPMALv25wXWHyoW56mHW0qtAMIVRABGgwwMTM2MTkyNzQ4NDkiDDQxd6Ep%2FudaJolhjiqRA%2FV9m3Q5qTHiEf%2B0F56QxIa0FX4xcw3kyVQ754zuEWG6%2FFHm5u50c%2FkjIZTK4iokf%2F5bg8%2F9lzPcfaf%2FlyMeeuZQiIR66c8Q0ZynlQYFFg39COCCRcmQH0rk4Py7SioeZK1WX50szdnMCAEBM0%2FYGIJRFlpJYz5%2BF7cuCEDZDVFz70QPaeLM9Aq2Hp0OWlaD%2BlKU2Ya8oXmKGTVLeV6xTf66mRdzvW8I4qKgZpByKnAcip5WWnkttPjUxPiLaEeZ%2BClnUyHZas2bB1iPmPH0rQXcKWbTOq%2BJJm8xX%2FgqtqSgjGTmncJVZJxe0UaRUPXS%2BxPh0KYERT9Te4D5sREOcmaPJ0lojWm5AuNIxK3S30FeTamdldG5jOgcjm7r6e2HjWcB7yfe4%2BCsYd2eVLbbXk95jZRHQohr%2B7Z9YEqq00TUANe07BXm%2FKoAPBMy0bYQHYmVJaGS31XhmN6DRKUn5mwwU6NQ87eIymigu48swQSaSOa0S3Ve15n99tYKCLxw%2FqcLrXK9DmAPRXyB2cTH85tpMJ7Qqv8FOusB0TY7T%2F8PPlS9Pw17cj5sLPnZSdHFb4OJ7xNuArhvZUxC%2FDdQIpfgbN40hDHy3r94ejzq63ULcWroBoxExSJ8F%2BIqLrT2jEE%2BHYV9rJ3uN20mlrWN07M1wfpVQeu7mZyiWu%2BTKEOjyLznji7d3Efn7A1SwzF%2FWi11RcA9%2BGeNTFCiOeyJRV4JWopx6NNi8TVr6hBraJmZeqXIUCIj4yW%2BvdbZ%2F7b%2BDWNq1S8BMna3Htt9r6lmeANRYdDH%2BkiA2F6n7nJrrrNm3hF7NHjHy1GdUin3XffXKseDfHdRNqxNelH1SrChi2zziLtHrQ%3D%3D\u0026X-Amz-Signature=addc9f8fa5bbe12fe809e889733cbb88c0518824914c1a2a32c31e10cdf2bc60"}],"genius_execution_id":null,"team_handle":"maximum","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1975321,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello @bamie ,\n\nI was just finding a fix for this but came to know that the REL attribute of the \u003ca\u003e tag isn't compatible with my version of Firefox and when i checked with the other browser the fix was working fine. Nice job done. Do you have any update about the bounty?\n\nAli Ashber.","markdown_message":"\u003cp\u003eHello \u003ca href=\"/bamie\"\u003e@bamie\u003c/a\u003e ,\u003c/p\u003e\n\n\u003cp\u003eI was just finding a fix for this but came to know that the REL attribute of the \u0026lt;a\u0026gt; tag isn\u0026#39;t compatible with my version of Firefox and when i checked with the other browser the fix was working fine. Nice job done. Do you have any update about the bounty?\u003c/p\u003e\n\n\u003cp\u003eAli Ashber.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-09-04T16:01:29.731Z","updated_at":"2017-09-04T16:01:29.731Z","actor":{"username":"ykw1337","cleared":false,"url":"/ykw1337","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"maximum","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1982929,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Tx @aliashber1 , thanks for your report!","markdown_message":"\u003cp\u003eTx \u003ca href=\"/aliashber1\"\u003e@aliashber1\u003c/a\u003e , thanks for your report!\u003c/p\u003e\n","automated_response":false,"created_at":"2017-09-07T15:16:56.085Z","updated_at":"2017-09-07T15:16:56.085Z","actor":{"url":"/maximum","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/450/6cac31c0a6ad854c086c328817a688e4720a3306_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Maximum"}},"bounty_amount":"40.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"maximum","collaborator":{"username":"ykw1337","url":"/ykw1337"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1983003,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Please Accept The Public disclosure Request.","markdown_message":"\u003cp\u003ePlease Accept The Public disclosure Request.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-09-07T15:42:06.224Z","updated_at":"2017-09-07T15:42:06.224Z","actor":{"username":"ykw1337","cleared":false,"url":"/ykw1337","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"maximum","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1983036,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-09-07T15:56:37.256Z","updated_at":"2017-09-07T15:56:37.256Z","actor":{"username":"bamie","cleared":false,"url":"/bamie","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/039/631/8aff5981b7c2a3519ed7170def4f7ad2392d13da_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"maximum","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1983037,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-09-07T15:56:37.381Z","updated_at":"2017-09-07T15:56:37.381Z","actor":{"username":"bamie","cleared":false,"url":"/bamie","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/039/631/8aff5981b7c2a3519ed7170def4f7ad2392d13da_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"maximum","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}