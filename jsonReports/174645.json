{"id":174645,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNzQ2NDU=","url":"https://hackerone.com/reports/174645","title":"Existence of Folder path by guessing the path through response","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2016-10-08T12:20:18.534Z","submitted_at":"2016-10-08T12:20:18.534Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"ashish_r_padelkar","url":"/ashish_r_padelkar","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/J6bCQpyJWXtj9gjzcvnFfAKN/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13031,"url":"https://hackerone.com/files","handle":"files","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/013/031/84b2c7ce7085dfe55cd17696fb6f6dba499dfa3c_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/031/84b2c7ce7085dfe55cd17696fb6f6dba499dfa3c_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Files.com","twitter_handle":"","website":"https://www.files.com/","about":"Files.com is a unique cloud platform that empowers your data with tools for organization, collaboration, and file logistics."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-05-02T15:15:47.153Z","bug_reporter_agreed_on_going_public_at":"2017-04-02T15:15:36.139Z","team_member_agreed_on_going_public_at":null,"comments_closed?":true,"facebook_team?":false,"team_private?":false,"vulnerability_information":"**Enter the support PIN from your test site:**\n 423088\n**Enter the name of your test site :**\n https://bugbounty5.brickftp.com\n**Enter the subdomain from your test site :**\n https://bugbounty5.brickftp.com\n\n----\n\n**Description**\n\nSuppose there are 2 `Folders` in the site\n\n`Test1`\n`Test2`\n\nbut a member has only `Admin` permission to `Test1` , he cant see the folder `Test2`\n\nHowever, it is possible to know if such `folder/path` (Test2) exist in a site by guessing the names of the folder.\n\n\n**Steps**\n\n1.There are 2 `folders` in a site namely `Test1` and `Test2`\n2. Member has full `Admin` permission to `Test1` and no permission at all to `Test2`. Member wont be able to see the folder `Test2` in his account at all.\n3. Now member selects any file from `Test1` using checkbox and select move option from dropdown. he gets only path to `Test1` folders. \n4. now if i type some random names of the folders in the box and say move, it will throw the error. but if type the valid names of folders which may be in a site, it will say can not write. \n5. this proves that, if you can guess correct name of folder/path, it tells you the existence of the path.\n\n**POC**\nhttps://youtu.be/mzPXVHIDnzs\n\n**Resolution**\nThe response should be same for both requests. folder exist or not, it should throw 404!\n\n\n\n**The date you tested for and found the vulnerability**\n08/10/2016\n\n**The following affirmative statement **\nI HAVE READ AND UNDERSTAND AND AGREE TO THE TERMS OF THE BUG BOUNTY PROGRAM. I AGREE TO THE BRICKFTP TERMS OF SERVICE. I HAVE COMPLIED AND WILL COMPLY WITH THE RULES OF THE PROGRAM AND THE TERMS OF SERVICE. I HAVE NOT DISCLOSED THIS SUBMISSION TO ANYONE. I DISCOVERED IT MYSELF. I WILL NOT DISCLOSE THIS SUBMISSION TO ANYONE. I DO WANT MY NAME PUBLISHED ON YOUR HALL OF FAME IF THIS IS ACCEPTED\n","vulnerability_information_html":"\u003cp\u003e\u003cstrong\u003eEnter the support PIN from your test site:\u003c/strong\u003e\u003cbr\u003e\n 423088\u003cbr\u003e\n\u003cstrong\u003eEnter the name of your test site :\u003c/strong\u003e\u003cbr\u003e\n \u003ca title=\"https://bugbounty5.brickftp.com\" href=\"/redirect?url=https%3A%2F%2Fbugbounty5.brickftp.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://bugbounty5.brickftp.com\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\n\u003cstrong\u003eEnter the subdomain from your test site :\u003c/strong\u003e\u003cbr\u003e\n \u003ca title=\"https://bugbounty5.brickftp.com\" href=\"/redirect?url=https%3A%2F%2Fbugbounty5.brickftp.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://bugbounty5.brickftp.com\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003chr\u003e\n\n\u003cp\u003e\u003cstrong\u003eDescription\u003c/strong\u003e\u003c/p\u003e\n\n\u003cp\u003eSuppose there are 2 \u003ccode\u003eFolders\u003c/code\u003e in the site\u003c/p\u003e\n\n\u003cp\u003e\u003ccode\u003eTest1\u003c/code\u003e\u003cbr\u003e\n\u003ccode\u003eTest2\u003c/code\u003e\u003c/p\u003e\n\n\u003cp\u003ebut a member has only \u003ccode\u003eAdmin\u003c/code\u003e permission to \u003ccode\u003eTest1\u003c/code\u003e , he cant see the folder \u003ccode\u003eTest2\u003c/code\u003e\u003c/p\u003e\n\n\u003cp\u003eHowever, it is possible to know if such \u003ccode\u003efolder/path\u003c/code\u003e (Test2) exist in a site by guessing the names of the folder.\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eSteps\u003c/strong\u003e\u003c/p\u003e\n\n\u003cp\u003e1.There are 2 \u003ccode\u003efolders\u003c/code\u003e in a site namely \u003ccode\u003eTest1\u003c/code\u003e and \u003ccode\u003eTest2\u003c/code\u003e\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eMember has full \u003ccode\u003eAdmin\u003c/code\u003e permission to \u003ccode\u003eTest1\u003c/code\u003e and no permission at all to \u003ccode\u003eTest2\u003c/code\u003e. Member wont be able to see the folder \u003ccode\u003eTest2\u003c/code\u003e in his account at all.\u003c/li\u003e\n\u003cli\u003eNow member selects any file from \u003ccode\u003eTest1\u003c/code\u003e using checkbox and select move option from dropdown. he gets only path to \u003ccode\u003eTest1\u003c/code\u003e folders. \u003c/li\u003e\n\u003cli\u003enow if i type some random names of the folders in the box and say move, it will throw the error. but if type the valid names of folders which may be in a site, it will say can not write. \u003c/li\u003e\n\u003cli\u003ethis proves that, if you can guess correct name of folder/path, it tells you the existence of the path.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003e\u003cstrong\u003ePOC\u003c/strong\u003e\u003cbr\u003e\n\u003ca title=\"https://youtu.be/mzPXVHIDnzs\" href=\"/redirect?url=https%3A%2F%2Fyoutu.be%2FmzPXVHIDnzs\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://youtu.be/mzPXVHIDnzs\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eResolution\u003c/strong\u003e\u003cbr\u003e\nThe response should be same for both requests. folder exist or not, it should throw 404!\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eThe date you tested for and found the vulnerability\u003c/strong\u003e\u003cbr\u003e\n08/10/2016\u003c/p\u003e\n\n\u003cp\u003e*\u003cem\u003eThe following affirmative statement *\u003c/em\u003e\u003cbr\u003e\nI HAVE READ AND UNDERSTAND AND AGREE TO THE TERMS OF THE BUG BOUNTY PROGRAM. I AGREE TO THE BRICKFTP TERMS OF SERVICE. I HAVE COMPLIED AND WILL COMPLY WITH THE RULES OF THE PROGRAM AND THE TERMS OF SERVICE. I HAVE NOT DISCLOSED THIS SUBMISSION TO ANYONE. I DISCOVERED IT MYSELF. I WILL NOT DISCLOSE THIS SUBMISSION TO ANYONE. I DO WANT MY NAME PUBLISHED ON YOUR HALL OF FAME IF THIS IS ACCEPTED\u003c/p\u003e\n","bounty_amount":"250.0","formatted_bounty":"$250","weakness":{"id":18,"name":"Information Disclosure"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2017-05-02T15:15:36.174Z","allow_singular_disclosure_after":-115478804.71848604,"singular_disclosure_allowed":true,"vote_count":10,"voters":["eveeez","vulnh0lic","t-4-y-m","exception","sumit7","spetr0x","vishnuraj","pranavthakur51","mortezayouosefi5005","chrisnkimberly"],"severity":{"rating":"medium","score":6.3,"author_type":"User","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"low","user_interaction":"none","scope":"unchanged","confidentiality":"low","integrity":"low","availability":"low"}},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1238534,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Also, even if you dont have any permission to any folder, the below endpoint works the same way\n\nhttps://bugbounty5.brickftp.com/folders/mass_download?checked%5BTest1%5D=yes\u0026path=\n\n\nHere, **Test1** is the folder name. if you replace with any other name which is not existed, it will redirect  but if its valid, it will show json response with valid path to download. (although you are not able to download actual zip), its enough to know that path/ folder is valid within the site!","markdown_message":"\u003cp\u003eAlso, even if you dont have any permission to any folder, the below endpoint works the same way\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"https://bugbounty5.brickftp.com/folders/mass_download?checked%5BTest1%5D=yes\u0026amp;path=\" href=\"/redirect?url=https%3A%2F%2Fbugbounty5.brickftp.com%2Ffolders%2Fmass_download%3Fchecked%255BTest1%255D%3Dyes%26path%3D\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://bugbounty5.brickftp.com/folders/mass_download?checked%5BTest1%5D=yes\u0026amp;path=\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eHere, \u003cstrong\u003eTest1\u003c/strong\u003e is the folder name. if you replace with any other name which is not existed, it will redirect  but if its valid, it will show json response with valid path to download. (although you are not able to download actual zip), its enough to know that path/ folder is valid within the site!\u003c/p\u003e\n","automated_response":false,"created_at":"2016-10-08T13:15:14.517Z","updated_at":"2016-10-08T13:15:14.517Z","actor":{"username":"ashish_r_padelkar","cleared":true,"url":"/ashish_r_padelkar","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/J6bCQpyJWXtj9gjzcvnFfAKN/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"files","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1242747,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thank you for this report. It is accepted and we will get back to you shortly with more information regarding a fix and the reward.","markdown_message":"\u003cp\u003eThank you for this report. It is accepted and we will get back to you shortly with more information regarding a fix and the reward.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-10-11T19:33:04.818Z","updated_at":"2016-10-11T19:33:04.818Z","actor":{"username":"actionverb_michael","cleared":false,"url":"/actionverb_michael","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"files","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1245341,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi,\n\nWe deployed an emergency fix that may be sufficient, but we are still evaluating if more needs to be done to protect from this information leak.","markdown_message":"\u003cp\u003eHi,\u003c/p\u003e\n\n\u003cp\u003eWe deployed an emergency fix that may be sufficient, but we are still evaluating if more needs to be done to protect from this information leak.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-10-13T06:58:46.011Z","updated_at":"2016-10-13T06:58:46.011Z","actor":{"username":"actionverb_michael","cleared":false,"url":"/actionverb_michael","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"files","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1246242,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"\nBug at\n\nhttps://bugbounty5.brickftp.com/folders/mass_download?checked%5BTest1%5D=yes\u0026path=\n\nis still not fixed i believe . it still shows the response if path is valid. otherwise it redirects!\n","markdown_message":"\u003cp\u003eBug at\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"https://bugbounty5.brickftp.com/folders/mass_download?checked%5BTest1%5D=yes\u0026amp;path=\" href=\"/redirect?url=https%3A%2F%2Fbugbounty5.brickftp.com%2Ffolders%2Fmass_download%3Fchecked%255BTest1%255D%3Dyes%26path%3D\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://bugbounty5.brickftp.com/folders/mass_download?checked%5BTest1%5D=yes\u0026amp;path=\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eis still not fixed i believe . it still shows the response if path is valid. otherwise it redirects!\u003c/p\u003e\n","automated_response":false,"created_at":"2016-10-13T17:28:34.914Z","updated_at":"2016-10-13T17:28:34.914Z","actor":{"username":"ashish_r_padelkar","cleared":true,"url":"/ashish_r_padelkar","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/J6bCQpyJWXtj9gjzcvnFfAKN/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"files","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1249529,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi, this fix is now deployed. Can you please check again?\n\nThank you!","markdown_message":"\u003cp\u003eHi, this fix is now deployed. Can you please check again?\u003c/p\u003e\n\n\u003cp\u003eThank you!\u003c/p\u003e\n","automated_response":false,"created_at":"2016-10-16T07:54:13.296Z","updated_at":"2016-10-16T07:54:13.296Z","actor":{"username":"actionverb_michael","cleared":false,"url":"/actionverb_michael","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"files","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1249605,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Yes its fixed!","markdown_message":"\u003cp\u003eYes its fixed!\u003c/p\u003e\n","automated_response":false,"created_at":"2016-10-16T09:19:47.459Z","updated_at":"2016-10-16T09:19:47.459Z","actor":{"username":"ashish_r_padelkar","cleared":true,"url":"/ashish_r_padelkar","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/J6bCQpyJWXtj9gjzcvnFfAKN/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"files","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1253269,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2016-10-18T13:48:09.682Z","updated_at":"2016-10-18T13:48:09.682Z","actor":{"url":"/files","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/031/84b2c7ce7085dfe55cd17696fb6f6dba499dfa3c_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Files.com"}},"bounty_amount":"250.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"files","collaborator":{"username":"ashish_r_padelkar","url":"/ashish_r_padelkar"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1253270,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2016-10-18T13:48:40.505Z","updated_at":"2016-10-18T13:48:40.505Z","actor":{"username":"actionverb_michael","cleared":false,"url":"/actionverb_michael","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"ashish_r_padelkar","url":"/ashish_r_padelkar"},"genius_execution_id":null,"team_handle":"files","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1253490,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for the bounty. \n\nJust wanted to know if both endpoints are considered while rewarding bounty?","markdown_message":"\u003cp\u003eThanks for the bounty. \u003c/p\u003e\n\n\u003cp\u003eJust wanted to know if both endpoints are considered while rewarding bounty?\u003c/p\u003e\n","automated_response":false,"created_at":"2016-10-18T16:14:26.684Z","updated_at":"2016-10-18T16:14:26.684Z","actor":{"username":"ashish_r_padelkar","cleared":true,"url":"/ashish_r_padelkar","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/J6bCQpyJWXtj9gjzcvnFfAKN/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"files","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1578634,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-04-02T15:15:36.152Z","updated_at":"2017-04-02T15:15:36.152Z","first_to_agree":true,"actor":{"username":"ashish_r_padelkar","cleared":true,"url":"/ashish_r_padelkar","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/J6bCQpyJWXtj9gjzcvnFfAKN/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"files","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1649071,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-05-02T15:15:47.181Z","updated_at":"2017-05-02T15:15:47.181Z","actor":{"url":"/files","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/031/84b2c7ce7085dfe55cd17696fb6f6dba499dfa3c_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Files.com"}},"genius_execution_id":null,"team_handle":"files","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1725563,"is_internal":false,"editable":false,"type":"Activities::CommentsClosed","message":"","markdown_message":"","automated_response":false,"created_at":"2017-06-02T15:57:49.940Z","updated_at":"2017-06-02T15:57:49.940Z","actor":{"url":"/files","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/031/84b2c7ce7085dfe55cd17696fb6f6dba499dfa3c_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Files.com"}},"genius_execution_id":null,"team_handle":"files","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}