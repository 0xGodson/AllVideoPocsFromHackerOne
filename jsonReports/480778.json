{"id":480778,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC80ODA3Nzg=","url":"https://hackerone.com/reports/480778","title":"Heap-buffer-overflow in Perl__byte_dump_string (utf8.c) could lead to memory leak","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2019-01-16T08:31:57.672Z","submitted_at":"2019-01-16T08:31:57.672Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"tmnt53","url":"/tmnt53","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/Md3sdzB9WvuY9YS5U39V4rEz/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":30,"url":"https://hackerone.com/ibb-perl","handle":"ibb-perl","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/030/06e86a090af9d395cec5535eea83b90c72274566_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/030/06e86a090af9d395cec5535eea83b90c72274566_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Perl (IBB)","twitter_handle":"","website":"http://www.perl.org","about":""}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":["CVE-2018-6798"],"singular_disclosure_disabled":false,"disclosed_at":"2019-10-24T20:57:47.575Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2019-09-24T20:57:43.767Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"With crafted regex match, I have found a heap-over-flow in function Perl__byte_dump_string, which would lead to memory leak.\n* Reported to the [Perl security mailing list](https://rt.perl.org/Public/Bug/Display.html?id=132063) on 11 Sep 2017.\n* Confirmed as a security flaw by TonyC on 24 Feb 2018\n* CVE-2018-6797 assigned to this flaw on 7 Feb 2018\n* [Public security advisory](https://github.com/Perl/perl5/blob/blead/pod/perl5262delta.pod) released on 14 April 2018\n```\n=================================================================\n==2895==ERROR: AddressSanitizer: heap-buffer-overflow on address 0xb610081c at pc 0x08a72387 bp 0xbfea6038 sp 0xbfea602c\nWRITE of size 4 at 0xb610081c thread T0\n    #0 0x8a72386 in S_pack_rec /root/karas/perl5-blead/pp_pack.c:2703:17\n    #1 0x8a42706 in Perl_packlist /root/karas/perl5-blead/pp_pack.c:1980:11\n    #2 0x8a73626 in Perl_pp_pack /root/karas/perl5-blead/pp_pack.c:3135:5\n    #3 0x84dc7ac in Perl_runops_debug /root/karas/perl5-blead/dump.c:2465:23\n    #4 0x818858a in S_fold_constants /root/karas/perl5-blead/op.c:4557:2\n    #5 0x8186c5a in Perl_op_convert_list /root/karas/perl5-blead/op.c:4896:12\n    #6 0x8363e7e in Perl_yyparse /root/karas/perl5-blead/perly.y:889:23\n    #7 0x8232350 in S_parse_body /root/karas/perl5-blead/perl.c:2401:9\n    #8 0x82285e3 in perl_parse /root/karas/perl5-blead/perl.c:1719:2\n    #9 0x81494a6 in main /root/karas/perl5-blead/perlmain.c:121:18\n    #10 0xb74d5636 in __libc_start_main /build/glibc-KM3i_a/glibc-2.23/csu/../csu/libc-start.c:291\n    #11 0x8075847 in _start (/root/karas/perl5-blead/perl+0x8075847)\n\n0xb610081c is located 2 bytes to the right of 10-byte region [0xb6100810,0xb610081a)\nallocated by thread T0 here:\n    #0 0x8119b84 in malloc (/root/karas/perl5-blead/perl+0x8119b84)\n    #1 0x84e2987 in Perl_safesysmalloc /root/karas/perl5-blead/util.c:153:21\n\nSUMMARY: AddressSanitizer: heap-buffer-overflow /root/karas/perl5-blead/pp_pack.c:2703:17 in S_pack_rec\nShadow bytes around the buggy address:\n  0x36c200b0: fa fa fd fd fa fa fd fd fa fa fd fd fa fa 00 04\n  0x36c200c0: fa fa fd fd fa fa 00 04 fa fa 00 04 fa fa 00 04\n  0x36c200d0: fa fa 00 04 fa fa 00 04 fa fa 00 04 fa fa 00 04\n  0x36c200e0: fa fa 00 04 fa fa 00 04 fa fa 00 04 fa fa 00 04\n  0x36c200f0: fa fa fd fa fa fa fd fd fa fa 00 02 fa fa 01 fa\n=\u003e0x36c20100: fa fa 00[02]fa fa 00 02 fa fa fd fd fa fa 00 04\n  0x36c20110: fa fa 02 fa fa fa 00 02 fa fa 07 fa fa fa 00 02\n  0x36c20120: fa fa 00 02 fa fa 00 00 fa fa 00 05 fa fa 00 01\n  0x36c20130: fa fa 00 07 fa fa 00 fa fa fa 00 02 fa fa 05 fa\n  0x36c20140: fa fa 00 02 fa fa 06 fa fa fa 00 02 fa fa 05 fa\n  0x36c20150: fa fa 00 05 fa fa 04 fa fa fa 05 fa fa fa 05 fa\nShadow byte legend (one shadow byte represents 8 application bytes):\n  Addressable:           00\n  Partially addressable: 01 02 03 04 05 06 07\n  Heap left redzone:       fa\n  Heap right redzone:      fb\n  Freed heap region:       fd\n  Stack left redzone:      f1\n  Stack mid redzone:       f2\n  Stack right redzone:     f3\n  Stack partial redzone:   f4\n  Stack after return:      f5\n  Stack use after scope:   f8\n  Global redzone:          f9\n  Global init order:       f6\n  Poisoned by user:        f7\n  Container overflow:      fc\n  Array cookie:            ac\n  Intra object redzone:    bb\n  ASan internal:           fe\n  Left alloca redzone:     ca\n  Right alloca redzone:    cb\n==2895==ABORTING\n```\n\n## Impact\n\nDepending on the heap implementation a remote attacker could leak heap information to bypass ASLR.","vulnerability_information_html":"\u003cp\u003eWith crafted regex match, I have found a heap-over-flow in function Perl__byte_dump_string, which would lead to memory leak.\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eReported to the \u003ca href=\"/redirect?url=https%3A%2F%2Frt.perl.org%2FPublic%2FBug%2FDisplay.html%3Fid%3D132063\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ePerl security mailing list\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e on 11 Sep 2017.\u003c/li\u003e\n\u003cli\u003eConfirmed as a security flaw by TonyC on 24 Feb 2018\u003c/li\u003e\n\u003cli\u003eCVE-2018-6797 assigned to this flaw on 7 Feb 2018\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2FPerl%2Fperl5%2Fblob%2Fblead%2Fpod%2Fperl5262delta.pod\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ePublic security advisory\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e released on 14 April 2018\n```\n=================================================================\n\u003cmark\u003e2895\u003c/mark\u003eERROR: AddressSanitizer: heap-buffer-overflow on address 0xb610081c at pc 0x08a72387 bp 0xbfea6038 sp 0xbfea602c\nWRITE of size 4 at 0xb610081c thread T0\n#0 0x8a72386 in S_pack_rec /root/karas/perl5-blead/pp_pack.c:2703:17\n#1 0x8a42706 in Perl_packlist /root/karas/perl5-blead/pp_pack.c:1980:11\n#2 0x8a73626 in Perl_pp_pack /root/karas/perl5-blead/pp_pack.c:3135:5\n#3 0x84dc7ac in Perl_runops_debug /root/karas/perl5-blead/dump.c:2465:23\n#4 0x818858a in S_fold_constants /root/karas/perl5-blead/op.c:4557:2\n#5 0x8186c5a in Perl_op_convert_list /root/karas/perl5-blead/op.c:4896:12\n#6 0x8363e7e in Perl_yyparse /root/karas/perl5-blead/perly.y:889:23\n#7 0x8232350 in S_parse_body /root/karas/perl5-blead/perl.c:2401:9\n#8 0x82285e3 in perl_parse /root/karas/perl5-blead/perl.c:1719:2\n#9 0x81494a6 in main /root/karas/perl5-blead/perlmain.c:121:18\n#10 0xb74d5636 in __libc_start_main /build/glibc-KM3i_a/glibc-2.23/csu/../csu/libc-start.c:291\n#11 0x8075847 in _start (/root/karas/perl5-blead/perl+0x8075847)\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003e0xb610081c is located 2 bytes to the right of 10-byte region [0xb6100810,0xb610081a)\u003cbr\u003e\nallocated by thread T0 here:\u003cbr\u003e\n    #0 0x8119b84 in malloc (/root/karas/perl5-blead/perl+0x8119b84)\u003cbr\u003e\n    #1 0x84e2987 in Perl_safesysmalloc /root/karas/perl5-blead/util.c:153:21\u003c/p\u003e\n\n\u003cp\u003eSUMMARY: AddressSanitizer: heap-buffer-overflow /root/karas/perl5-blead/pp_pack.c:2703:17 in S_pack_rec\u003cbr\u003e\nShadow bytes around the buggy address:\u003cbr\u003e\n  0x36c200b0: fa fa fd fd fa fa fd fd fa fa fd fd fa fa 00 04\u003cbr\u003e\n  0x36c200c0: fa fa fd fd fa fa 00 04 fa fa 00 04 fa fa 00 04\u003cbr\u003e\n  0x36c200d0: fa fa 00 04 fa fa 00 04 fa fa 00 04 fa fa 00 04\u003cbr\u003e\n  0x36c200e0: fa fa 00 04 fa fa 00 04 fa fa 00 04 fa fa 00 04\u003cbr\u003e\n  0x36c200f0: fa fa fd fa fa fa fd fd fa fa 00 02 fa fa 01 fa\u003cbr\u003e\n=\u0026gt;0x36c20100: fa fa 00[02]fa fa 00 02 fa fa fd fd fa fa 00 04\u003cbr\u003e\n  0x36c20110: fa fa 02 fa fa fa 00 02 fa fa 07 fa fa fa 00 02\u003cbr\u003e\n  0x36c20120: fa fa 00 02 fa fa 00 00 fa fa 00 05 fa fa 00 01\u003cbr\u003e\n  0x36c20130: fa fa 00 07 fa fa 00 fa fa fa 00 02 fa fa 05 fa\u003cbr\u003e\n  0x36c20140: fa fa 00 02 fa fa 06 fa fa fa 00 02 fa fa 05 fa\u003cbr\u003e\n  0x36c20150: fa fa 00 05 fa fa 04 fa fa fa 05 fa fa fa 05 fa\u003cbr\u003e\nShadow byte legend (one shadow byte represents 8 application bytes):\u003cbr\u003e\n  Addressable:           00\u003cbr\u003e\n  Partially addressable: 01 02 03 04 05 06 07\u003cbr\u003e\n  Heap left redzone:       fa\u003cbr\u003e\n  Heap right redzone:      fb\u003cbr\u003e\n  Freed heap region:       fd\u003cbr\u003e\n  Stack left redzone:      f1\u003cbr\u003e\n  Stack mid redzone:       f2\u003cbr\u003e\n  Stack right redzone:     f3\u003cbr\u003e\n  Stack partial redzone:   f4\u003cbr\u003e\n  Stack after return:      f5\u003cbr\u003e\n  Stack use after scope:   f8\u003cbr\u003e\n  Global redzone:          f9\u003cbr\u003e\n  Global init order:       f6\u003cbr\u003e\n  Poisoned by user:        f7\u003cbr\u003e\n  Container overflow:      fc\u003cbr\u003e\n  Array cookie:            ac\u003cbr\u003e\n  Intra object redzone:    bb\u003cbr\u003e\n  ASan internal:           fe\u003cbr\u003e\n  Left alloca redzone:     ca\u003cbr\u003e\n  Right alloca redzone:    cb\u003cbr\u003e\n\u003cmark\u003e2895\u003c/mark\u003eABORTING\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e\n## Impact\n\nDepending on the heap implementation a remote attacker could leak heap information to bypass ASLR.\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","bounty_amount":"500.0","formatted_bounty":"$500","weakness":{"id":9,"name":"Buffer Over-read"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2019-10-24T20:57:43.888Z","allow_singular_disclosure_after":-37271230.97458703,"singular_disclosure_allowed":true,"vote_count":4,"voters":["sameerphad72","brodie_codie","cryptographer","sh1n1"],"severity":{"rating":"high","score":7.5,"author_type":"User","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"none","user_interaction":"none","scope":"unchanged","confidentiality":"high","integrity":"none","availability":"none"}},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":4002634,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @tmnt53 - Thanks for the submission. Your report is currently being reviewed and the HackerOne triage team will get back to you once there is additional information to share. Thank you for your patience! ","markdown_message":"\u003cp\u003eHey \u003ca href=\"/tmnt53\"\u003e@tmnt53\u003c/a\u003e - Thanks for the submission. Your report is currently being reviewed and the HackerOne triage team will get back to you once there is additional information to share. Thank you for your patience! \u003c/p\u003e\n","automated_response":false,"created_at":"2019-01-18T21:17:49.438Z","updated_at":"2019-01-18T21:17:49.438Z","actor":{"username":"tuxedo","cleared":false,"url":"/tuxedo","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/9G6pgB95of3ikt3prqQunAfD/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"ibb-perl","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":4454136,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Sorry i made a mistake. The CVE ID should be CVE-2018-6798.\n","markdown_message":"\u003cp\u003eSorry i made a mistake. The CVE ID should be CVE-2018-6798.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-04-03T04:21:06.393Z","updated_at":"2019-04-03T04:21:06.393Z","actor":{"username":"tmnt53","cleared":false,"url":"/tmnt53","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/Md3sdzB9WvuY9YS5U39V4rEz/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"ibb-perl","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4869300,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thank you @tmnt53! I was able to validate your report, and have submitted it to the appropriate remediation team for review. Please note that the status and severity are subject to change. ","markdown_message":"\u003cp\u003eThank you \u003ca href=\"/tmnt53\"\u003e@tmnt53\u003c/a\u003e! I was able to validate your report, and have submitted it to the appropriate remediation team for review. Please note that the status and severity are subject to change. \u003c/p\u003e\n","automated_response":false,"created_at":"2019-05-17T21:24:21.232Z","updated_at":"2019-05-17T21:24:21.232Z","actor":{"username":"tuxedo","cleared":false,"url":"/tuxedo","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/9G6pgB95of3ikt3prqQunAfD/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"ibb-perl","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":4869303,"is_internal":false,"editable":false,"type":"Activities::CveIdAdded","message":"","markdown_message":"","automated_response":false,"created_at":"2019-05-17T21:24:31.922Z","updated_at":"2019-05-17T21:24:31.922Z","cve_ids":["CVE-2018-6798"],"actor":{"username":"tuxedo","cleared":false,"url":"/tuxedo","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/9G6pgB95of3ikt3prqQunAfD/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"ibb-perl","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":5388361,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Have you finished reviewing my report?","markdown_message":"\u003cp\u003eHave you finished reviewing my report?\u003c/p\u003e\n","automated_response":false,"created_at":"2019-07-22T14:42:03.195Z","updated_at":"2019-07-22T14:42:03.195Z","actor":{"username":"tmnt53","cleared":false,"url":"/tmnt53","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/Md3sdzB9WvuY9YS5U39V4rEz/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"ibb-perl","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5492032,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @tmnt53,\n\nYour report is currently in the hands of the program team and will be updated once a decision is made.\nWe appreciate your patience in the meantime.\n\nBest regards,\n@antenna ","markdown_message":"\u003cp\u003eHi \u003ca href=\"/tmnt53\"\u003e@tmnt53\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eYour report is currently in the hands of the program team and will be updated once a decision is made.\u003cbr\u003e\nWe appreciate your patience in the meantime.\u003c/p\u003e\n\n\u003cp\u003eBest regards,\u003cbr\u003e\n\u003ca href=\"/antenna\"\u003e@antenna\u003c/a\u003e \u003c/p\u003e\n","automated_response":false,"created_at":"2019-08-02T21:59:18.629Z","updated_at":"2019-08-02T21:59:18.629Z","actor":{"username":"antenna","cleared":false,"url":"/antenna","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/B1a8q5ga9BZjMczKoqAbnMj5/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"ibb-perl","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":5881475,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2019-09-24T20:57:21.885Z","updated_at":"2019-09-24T20:57:21.885Z","actor":{"url":"/ibb-perl","ibb":true,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/030/06e86a090af9d395cec5535eea83b90c72274566_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Perl (IBB)"}},"bounty_amount":"500.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"ibb-perl","collaborator":{"username":"tmnt53","url":"/tmnt53"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5881477,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks for helping keep the Internet safe!","markdown_message":"\u003cp\u003eThanks for helping keep the Internet safe!\u003c/p\u003e\n","automated_response":false,"created_at":"2019-09-24T20:57:38.113Z","updated_at":"2019-09-24T20:57:38.113Z","actor":{"username":"reed","cleared":false,"url":"/reed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"reporter":{"username":"tmnt53","url":"/tmnt53"},"genius_execution_id":null,"team_handle":"ibb-perl","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5881478,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-09-24T20:57:43.793Z","updated_at":"2019-09-24T20:57:43.793Z","first_to_agree":true,"actor":{"username":"reed","cleared":false,"url":"/reed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"ibb-perl","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6129927,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-10-24T20:57:47.601Z","updated_at":"2019-10-24T20:57:47.601Z","actor":{"url":"/ibb-perl","ibb":true,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/030/06e86a090af9d395cec5535eea83b90c72274566_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Perl (IBB)"}},"genius_execution_id":null,"team_handle":"ibb-perl","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}