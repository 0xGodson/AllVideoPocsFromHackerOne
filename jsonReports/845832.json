{"id":845832,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC84NDU4MzI=","url":"https://hackerone.com/reports/845832","title":"SVG file upload leads to XML injection","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2020-04-10T02:57:12.746Z","submitted_at":"2020-04-10T02:57:12.746Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"tushr","url":"/tushr","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/CwAR2EghZLncT7DQ4NjTigRc/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":43330,"url":"https://hackerone.com/topcoder","handle":"topcoder","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/kS4MdqW4T4tGEgyNs2u8P4zY/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/kS4MdqW4T4tGEgyNs2u8P4zY/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Topcoder","twitter_handle":null,"website":"http://topcoder.com","about":""}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2020-08-14T21:43:55.163Z","bug_reporter_agreed_on_going_public_at":"2020-08-14T21:43:55.091Z","team_member_agreed_on_going_public_at":"2020-07-24T14:00:13.823Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"## Summary:\nUpload Avatar option allows the user to upload image/* . Thus enabling the upload of many file formats including SVG files (MIME type: image/svg+xml) \nSVG files are XML based graphics files in 2D images. Thus, this opens up an attack vector to upload specially crafted malicious SVG files. \nThe attacks that are possible using SVG files are:\n\n1. XSS attack: Stored XSS can be performed by including a \"\u003cscript\u003ealert(1)\u003c/script\u003e\" payload inside the XML code of the SVG file can make the browser execute the javascript when the file is rendered. However, only possible when using an \u003csvg\u003e tag to call the file. In this case, \u003cimg\u003e tag is used thus not exploitable.\n2. XXE attack: Injecting malicious XML code inside the SVG file thus executing once the server parses the SVG. [Follow steps to reproduce for this]\n3. DOS attack: Billion laugh attack is an application-level DOS and can lead to resource exhaustion making the server slow down or crash. I have not tried this but found the below resource about it:\n                            https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/XXE%20Injection#billion-laugh-attack\n\n## Steps to reproduce\n  1. I observed that when uploading a user avatar picture, the first request was sent to \n       https://api.topcoder.com/v3/members/oldsoul/photoUploadUrl\n       with a POST parameter \"contentType\" telling the type of file being uploaded. I changed the value to \"image/svg+xml\".  \n       Now, the response had a preSignedURL variable pointing to the valid S3 object creation URL, and a token variable which gives a random number which is added to the file name which is being uploaded.\n                                     F781757\n  \n  2. Second request is a PUT request to https://api.topcoder.com/v3/members/oldsoul/photo\n       with a token variable which is same as the token variable which we received in the first request. Also a variable \"contentType\" which is used in determining the extension of the file being uploaded. I changed the value to \"image/svg+xml\"\n                                     F781767\n  \n  3. Now, I sent a PUT request to the \"preSignedURL\" that we got from the first request with HTTP header \"Content-Type: image/svg+xml\". The body of this request contains the SVG file data to be uploaded.    F781788\n\n\n----------------------------------------------------XXE SSRF------------------------------------------------\n   1. For Fetching External resources from a remote server, \n   upload SVG with \u003cimage xlink:href=\"http://159.65.151.4:81/svg\" /\u003e to the SVG file [observed connection to my server when listening via netcat on port 81]  =\u003e   F781770\n\n\u003c?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?\u003e\n\u003csvg\n   xmlns:svg=\"http://www.w3.org/2000/svg\"\n   xmlns=\"http://www.w3.org/2000/svg\"\n   xmlns:xlink=\"http://www.w3.org/1999/xlink\"\n   style=\"overflow: hidden; position: relative;\"\n   width=\"300\"\n   height=\"200\"\u003e\n  \u003cimage x=\"10\" y=\"10\" width=\"276\" height=\"110\" xlink:href=\"http://159.65.151.4:81/svg\" stroke-width=\"1\" id=\"image3204\" /\u003e\n  \u003crect x=\"0\" y=\"150\" height=\"10\" width=\"300\" style=\"fill: black\"/\u003e\n\u003c/svg\u003e\n\n(This is the IP of my personal server. You can include a public resource like http://images.google.com/intl/es_ALL/images/logos/images_logo_lg.gif)  =\u003e  F781773\n\n   2. For fetching local files from the server itself (LFI),\n\nI created another user named testing68 and uploaded an avatar picture for it. Added the picture link for testing68 user to the XML payload  =\u003e  F781779\n\n  \u003cimage x=\"10\" y=\"10\" width=\"276\" height=\"110\" xlink:href=\"/member/profile/testing68-1586481096585.png\" stroke-width=\"1\" id=\"image3204\" /\u003e\n\n\n## Supporting Material/References:\nSImilar Reports: \nhttps://hackerone.com/reports/97501\nhttps://hackerone.com/reports/142709\n\nReference material:\nhttps://qy.sg/x-ctf-finals-2016-john-slick-web-25/\nhttps://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/XXE%20Injection#xxe-inside-svg\n\n\nThanks\n\n## Impact\n\nExploiting an XXE attack, allows an attacker to interfere with an application's processing of XML data. It often allows an attacker to view files on the application server filesystem, and to interact with any backend or external systems that the application itself can access.\n\nExploiting the billion laugh DOS attack can mess with the availability of the server and since it is an application level DOS network level filters will not be effective to stop such attack.","vulnerability_information_html":"\u003ch2 id=\"summary\"\u003eSummary:\u003c/h2\u003e\n\n\u003cp\u003eUpload Avatar option allows the user to upload image/* . Thus enabling the upload of many file formats including SVG files (MIME type: image/svg+xml) \u003cbr\u003e\nSVG files are XML based graphics files in 2D images. Thus, this opens up an attack vector to upload specially crafted malicious SVG files. \u003cbr\u003e\nThe attacks that are possible using SVG files are:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eXSS attack: Stored XSS can be performed by including a \u0026quot;\u0026lt;script\u0026gt;alert(1)\u0026lt;/script\u0026gt;\u0026quot; payload inside the XML code of the SVG file can make the browser execute the javascript when the file is rendered. However, only possible when using an \u0026lt;svg\u0026gt; tag to call the file. In this case, \u0026lt;img\u0026gt; tag is used thus not exploitable.\u003c/li\u003e\n\u003cli\u003eXXE attack: Injecting malicious XML code inside the SVG file thus executing once the server parses the SVG. [Follow steps to reproduce for this]\u003c/li\u003e\n\u003cli\u003eDOS attack: Billion laugh attack is an application-level DOS and can lead to resource exhaustion making the server slow down or crash. I have not tried this but found the below resource about it:\n                        \u003ca title=\"https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/XXE%20Injection#billion-laugh-attack\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fswisskyrepo%2FPayloadsAllTheThings%2Ftree%2Fmaster%2FXXE%2520Injection%23billion-laugh-attack\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/XXE%20Injection#billion-laugh-attack\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps to reproduce\u003c/h2\u003e\n\n\u003col\u003e\n\u003cli\u003e\u003cp\u003eI observed that when uploading a user avatar picture, the first request was sent to \u003cbr\u003e\n   \u003ca title=\"https://api.topcoder.com/v3/members/oldsoul/photoUploadUrl\" href=\"/redirect?url=https%3A%2F%2Fapi.topcoder.com%2Fv3%2Fmembers%2Foldsoul%2FphotoUploadUrl\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://api.topcoder.com/v3/members/oldsoul/photoUploadUrl\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\n   with a POST parameter \u0026quot;contentType\u0026quot; telling the type of file being uploaded. I changed the value to \u0026quot;image/svg+xml\u0026quot;.\u003cbr\u003e\u003cbr\u003e\n   Now, the response had a preSignedURL variable pointing to the valid S3 object creation URL, and a token variable which gives a random number which is added to the file name which is being uploaded.\u003cbr\u003e\n                                 \u003ca class=\"markdown-attachment-link markdown-attachment-reference\" data-attachment-filename=\"topcoder11.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/UzPSCoedx22X69iQRpLaf3Ua?response-content-disposition=attachment%3B%20filename%3D%22topcoder11.png%22%3B%20filename%2A%3DUTF-8%27%27topcoder11.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQW2BAZGD3%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T070053Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDf7CC1janFXxWWF6QZ1Z6X6%2F6j0WDhv4gDyzEWu%2BScUAIhAOhgsmE64VangXFyIz5AGmDMLeT8sYG2vBQ4PwiaYS%2FZKrQDCFUQARoMMDEzNjE5Mjc0ODQ5Igy754oCq3nK3vWmRbMqkQM98qKdRlMDTd4bBwR4jJMppOWz7EU3ySwJK1geVZm7GvrSHyp8wAx03nVbAIisdh9q5SCYJs%2FJTXi%2Fsm9znfJcHgIy1DUYcyZol0zQmN4hQAlOUZZ6AJANKMjzew6Gbci4hpgZqkt7kMNinONmzU36EDiWMOc0y0LBIMMe8ckWdal2vM1amkx9g4%2B7jkxStLKe4Ry%2FVeqOEFeDj5B3%2Fim8atXFDPnaA6ZctYC0kADebiu9zFF1dQsSdkzsLG93dLAMR0ARXm0vun9nbqpp5oxDQafvSrdE7oDp0yem%2B391K5yvQ%2FVkTdyMd797ooD1IAYqUdwlX0lVblqv9ErzI2EUbOnFhO5widZFoU8s5JQDxyTzDlNAHHPnQpU8XD7uIRyR%2Bh43I9VvsEn1pERJ2rOM57I1PkAM8vesvdhiNkLY7KsmmB1q5drdmKxzSDeK5uPJY%2F7b6ZdCcYzDgNfX18d6h0A0FHbvXn7qPH9NQWGUsNXamCikRs9AA%2BK%2BzqwxI%2FlZdCdkUBJNbFqefOmuHA6y4DCuw6r%2FBTrqAZ4iBH5JOWBgJ5BPglFYT1gWFkwyMqq8gmMxb5SeS%2FjunuR9x9HhadmGfzTt7avXh7ra%2BbCbT8G5EBTHekw5tLrBpYwkzmLiedzIpJ4pJqrAXmk%2B6qfKdpUFGOfE%2FoOdzhIkM32hFOTOwwCcLwfUCOQXCXHweJlGlDZdV%2FgvnAv5llJv80AS6mRncqu5cTdZ6kwskL6mtLuZx022Hs9iVQEhZVcVFVxWNFIMlrPZufuNWFtnv13RkAoiqYOJgDn3UWRAP9lucn7OMZs0NyqKFy1iLho2FCO%2BegcGHVqDf%2FVxOtLAlnkhjmFRxg%3D%3D\u0026amp;X-Amz-Signature=9d7ad2280e70a24d5b56a6b2a215e1cd8ef443f5da39dc957a98686752768301\" data-attachment-type=\"image/png\"\u003etopcoder11.png (F781757)\u003c/a\u003e\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eSecond request is a PUT request to \u003ca title=\"https://api.topcoder.com/v3/members/oldsoul/photo\" href=\"/redirect?url=https%3A%2F%2Fapi.topcoder.com%2Fv3%2Fmembers%2Foldsoul%2Fphoto\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://api.topcoder.com/v3/members/oldsoul/photo\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\n   with a token variable which is same as the token variable which we received in the first request. Also a variable \u0026quot;contentType\u0026quot; which is used in determining the extension of the file being uploaded. I changed the value to \u0026quot;image/svg+xml\u0026quot;\u003cbr\u003e\n                                 \u003ca class=\"markdown-attachment-link markdown-attachment-reference\" data-attachment-filename=\"topcoder12.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/46BQ6Vp6BTmz4bjFUGkJvA9r?response-content-disposition=attachment%3B%20filename%3D%22topcoder12.png%22%3B%20filename%2A%3DUTF-8%27%27topcoder12.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQW2BAZGD3%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T070053Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDf7CC1janFXxWWF6QZ1Z6X6%2F6j0WDhv4gDyzEWu%2BScUAIhAOhgsmE64VangXFyIz5AGmDMLeT8sYG2vBQ4PwiaYS%2FZKrQDCFUQARoMMDEzNjE5Mjc0ODQ5Igy754oCq3nK3vWmRbMqkQM98qKdRlMDTd4bBwR4jJMppOWz7EU3ySwJK1geVZm7GvrSHyp8wAx03nVbAIisdh9q5SCYJs%2FJTXi%2Fsm9znfJcHgIy1DUYcyZol0zQmN4hQAlOUZZ6AJANKMjzew6Gbci4hpgZqkt7kMNinONmzU36EDiWMOc0y0LBIMMe8ckWdal2vM1amkx9g4%2B7jkxStLKe4Ry%2FVeqOEFeDj5B3%2Fim8atXFDPnaA6ZctYC0kADebiu9zFF1dQsSdkzsLG93dLAMR0ARXm0vun9nbqpp5oxDQafvSrdE7oDp0yem%2B391K5yvQ%2FVkTdyMd797ooD1IAYqUdwlX0lVblqv9ErzI2EUbOnFhO5widZFoU8s5JQDxyTzDlNAHHPnQpU8XD7uIRyR%2Bh43I9VvsEn1pERJ2rOM57I1PkAM8vesvdhiNkLY7KsmmB1q5drdmKxzSDeK5uPJY%2F7b6ZdCcYzDgNfX18d6h0A0FHbvXn7qPH9NQWGUsNXamCikRs9AA%2BK%2BzqwxI%2FlZdCdkUBJNbFqefOmuHA6y4DCuw6r%2FBTrqAZ4iBH5JOWBgJ5BPglFYT1gWFkwyMqq8gmMxb5SeS%2FjunuR9x9HhadmGfzTt7avXh7ra%2BbCbT8G5EBTHekw5tLrBpYwkzmLiedzIpJ4pJqrAXmk%2B6qfKdpUFGOfE%2FoOdzhIkM32hFOTOwwCcLwfUCOQXCXHweJlGlDZdV%2FgvnAv5llJv80AS6mRncqu5cTdZ6kwskL6mtLuZx022Hs9iVQEhZVcVFVxWNFIMlrPZufuNWFtnv13RkAoiqYOJgDn3UWRAP9lucn7OMZs0NyqKFy1iLho2FCO%2BegcGHVqDf%2FVxOtLAlnkhjmFRxg%3D%3D\u0026amp;X-Amz-Signature=94db32f17d5454cf34485287baafa82200c61cd0a9cd98ce2f25e46f2a8a0919\" data-attachment-type=\"image/png\"\u003etopcoder12.png (F781767)\u003c/a\u003e\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eNow, I sent a PUT request to the \u0026quot;preSignedURL\u0026quot; that we got from the first request with HTTP header \u0026quot;Content-Type: image/svg+xml\u0026quot;. The body of this request contains the SVG file data to be uploaded.    \u003ca class=\"markdown-attachment-link markdown-attachment-reference\" data-attachment-filename=\"topcoder14.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/246F43FP9nCH3Yak5Zq3s963?response-content-disposition=attachment%3B%20filename%3D%22topcoder14.png%22%3B%20filename%2A%3DUTF-8%27%27topcoder14.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQW2BAZGD3%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T070053Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDf7CC1janFXxWWF6QZ1Z6X6%2F6j0WDhv4gDyzEWu%2BScUAIhAOhgsmE64VangXFyIz5AGmDMLeT8sYG2vBQ4PwiaYS%2FZKrQDCFUQARoMMDEzNjE5Mjc0ODQ5Igy754oCq3nK3vWmRbMqkQM98qKdRlMDTd4bBwR4jJMppOWz7EU3ySwJK1geVZm7GvrSHyp8wAx03nVbAIisdh9q5SCYJs%2FJTXi%2Fsm9znfJcHgIy1DUYcyZol0zQmN4hQAlOUZZ6AJANKMjzew6Gbci4hpgZqkt7kMNinONmzU36EDiWMOc0y0LBIMMe8ckWdal2vM1amkx9g4%2B7jkxStLKe4Ry%2FVeqOEFeDj5B3%2Fim8atXFDPnaA6ZctYC0kADebiu9zFF1dQsSdkzsLG93dLAMR0ARXm0vun9nbqpp5oxDQafvSrdE7oDp0yem%2B391K5yvQ%2FVkTdyMd797ooD1IAYqUdwlX0lVblqv9ErzI2EUbOnFhO5widZFoU8s5JQDxyTzDlNAHHPnQpU8XD7uIRyR%2Bh43I9VvsEn1pERJ2rOM57I1PkAM8vesvdhiNkLY7KsmmB1q5drdmKxzSDeK5uPJY%2F7b6ZdCcYzDgNfX18d6h0A0FHbvXn7qPH9NQWGUsNXamCikRs9AA%2BK%2BzqwxI%2FlZdCdkUBJNbFqefOmuHA6y4DCuw6r%2FBTrqAZ4iBH5JOWBgJ5BPglFYT1gWFkwyMqq8gmMxb5SeS%2FjunuR9x9HhadmGfzTt7avXh7ra%2BbCbT8G5EBTHekw5tLrBpYwkzmLiedzIpJ4pJqrAXmk%2B6qfKdpUFGOfE%2FoOdzhIkM32hFOTOwwCcLwfUCOQXCXHweJlGlDZdV%2FgvnAv5llJv80AS6mRncqu5cTdZ6kwskL6mtLuZx022Hs9iVQEhZVcVFVxWNFIMlrPZufuNWFtnv13RkAoiqYOJgDn3UWRAP9lucn7OMZs0NyqKFy1iLho2FCO%2BegcGHVqDf%2FVxOtLAlnkhjmFRxg%3D%3D\u0026amp;X-Amz-Signature=648de8ecd14c47fe32d1377a88b605278676c3466f8e3bcc89e6e822224b3626\" data-attachment-type=\"image/png\"\u003etopcoder14.png (F781788)\u003c/a\u003e\u003c/p\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003e----------------------------------------------------XXE SSRF------------------------------------------------\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eFor Fetching External resources from a remote server, \nupload SVG with \u0026lt;image xlink:href=\u0026quot;http://159.65.151.4:81/svg\u0026quot; /\u0026gt; to the SVG file [observed connection to my server when listening via netcat on port 81]  =\u0026gt;   \u003ca class=\"markdown-attachment-link markdown-attachment-reference\" data-attachment-filename=\"topcoder_ssrf.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/LduhYJeR4gqdNQ4CENp2M6Qx?response-content-disposition=attachment%3B%20filename%3D%22topcoder_ssrf.png%22%3B%20filename%2A%3DUTF-8%27%27topcoder_ssrf.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQW2BAZGD3%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T070053Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDf7CC1janFXxWWF6QZ1Z6X6%2F6j0WDhv4gDyzEWu%2BScUAIhAOhgsmE64VangXFyIz5AGmDMLeT8sYG2vBQ4PwiaYS%2FZKrQDCFUQARoMMDEzNjE5Mjc0ODQ5Igy754oCq3nK3vWmRbMqkQM98qKdRlMDTd4bBwR4jJMppOWz7EU3ySwJK1geVZm7GvrSHyp8wAx03nVbAIisdh9q5SCYJs%2FJTXi%2Fsm9znfJcHgIy1DUYcyZol0zQmN4hQAlOUZZ6AJANKMjzew6Gbci4hpgZqkt7kMNinONmzU36EDiWMOc0y0LBIMMe8ckWdal2vM1amkx9g4%2B7jkxStLKe4Ry%2FVeqOEFeDj5B3%2Fim8atXFDPnaA6ZctYC0kADebiu9zFF1dQsSdkzsLG93dLAMR0ARXm0vun9nbqpp5oxDQafvSrdE7oDp0yem%2B391K5yvQ%2FVkTdyMd797ooD1IAYqUdwlX0lVblqv9ErzI2EUbOnFhO5widZFoU8s5JQDxyTzDlNAHHPnQpU8XD7uIRyR%2Bh43I9VvsEn1pERJ2rOM57I1PkAM8vesvdhiNkLY7KsmmB1q5drdmKxzSDeK5uPJY%2F7b6ZdCcYzDgNfX18d6h0A0FHbvXn7qPH9NQWGUsNXamCikRs9AA%2BK%2BzqwxI%2FlZdCdkUBJNbFqefOmuHA6y4DCuw6r%2FBTrqAZ4iBH5JOWBgJ5BPglFYT1gWFkwyMqq8gmMxb5SeS%2FjunuR9x9HhadmGfzTt7avXh7ra%2BbCbT8G5EBTHekw5tLrBpYwkzmLiedzIpJ4pJqrAXmk%2B6qfKdpUFGOfE%2FoOdzhIkM32hFOTOwwCcLwfUCOQXCXHweJlGlDZdV%2FgvnAv5llJv80AS6mRncqu5cTdZ6kwskL6mtLuZx022Hs9iVQEhZVcVFVxWNFIMlrPZufuNWFtnv13RkAoiqYOJgDn3UWRAP9lucn7OMZs0NyqKFy1iLho2FCO%2BegcGHVqDf%2FVxOtLAlnkhjmFRxg%3D%3D\u0026amp;X-Amz-Signature=34da287acea26c574e1bdbd0c494bae12516580f0dd0776eb057f96b51c2a3db\" data-attachment-type=\"image/png\"\u003etopcoder_ssrf.png (F781770)\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003e\u0026lt;?xml version=\u0026quot;1.0\u0026quot; encoding=\u0026quot;UTF-8\u0026quot; standalone=\u0026quot;no\u0026quot;?\u0026gt;\u003cbr\u003e\n\u0026lt;svg\u003cbr\u003e\n   xmlns:svg=\u0026quot;http://www.w3.org/2000/svg\u0026quot;\u003cbr\u003e\n   xmlns=\u0026quot;http://www.w3.org/2000/svg\u0026quot;\u003cbr\u003e\n   xmlns:xlink=\u0026quot;http://www.w3.org/1999/xlink\u0026quot;\u003cbr\u003e\n   style=\u0026quot;overflow: hidden; position: relative;\u0026quot;\u003cbr\u003e\n   width=\u0026quot;300\u0026quot;\u003cbr\u003e\n   height=\u0026quot;200\u0026quot;\u0026gt;\u003cbr\u003e\n  \u0026lt;image x=\u0026quot;10\u0026quot; y=\u0026quot;10\u0026quot; width=\u0026quot;276\u0026quot; height=\u0026quot;110\u0026quot; xlink:href=\u0026quot;http://159.65.151.4:81/svg\u0026quot; stroke-width=\u0026quot;1\u0026quot; id=\u0026quot;image3204\u0026quot; /\u0026gt;\u003cbr\u003e\n  \u0026lt;rect x=\u0026quot;0\u0026quot; y=\u0026quot;150\u0026quot; height=\u0026quot;10\u0026quot; width=\u0026quot;300\u0026quot; style=\u0026quot;fill: black\u0026quot;/\u0026gt;\u003cbr\u003e\n\u0026lt;/svg\u0026gt;\u003c/p\u003e\n\n\u003cp\u003e(This is the IP of my personal server. You can include a public resource like \u003ca title=\"http://images.google.com/intl/es_ALL/images/logos/images_logo_lg.gif\" href=\"/redirect?url=http%3A%2F%2Fimages.google.com%2Fintl%2Fes_ALL%2Fimages%2Flogos%2Fimages_logo_lg.gif\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://images.google.com/intl/es_ALL/images/logos/images_logo_lg.gif\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e)  =\u0026gt;  \u003ca class=\"markdown-attachment-link markdown-attachment-reference\" data-attachment-filename=\"topcoder_ssrf2.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/5Ba2uYsxZujGr3ocmVkGMMpu?response-content-disposition=attachment%3B%20filename%3D%22topcoder_ssrf2.png%22%3B%20filename%2A%3DUTF-8%27%27topcoder_ssrf2.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQW2BAZGD3%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T070053Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDf7CC1janFXxWWF6QZ1Z6X6%2F6j0WDhv4gDyzEWu%2BScUAIhAOhgsmE64VangXFyIz5AGmDMLeT8sYG2vBQ4PwiaYS%2FZKrQDCFUQARoMMDEzNjE5Mjc0ODQ5Igy754oCq3nK3vWmRbMqkQM98qKdRlMDTd4bBwR4jJMppOWz7EU3ySwJK1geVZm7GvrSHyp8wAx03nVbAIisdh9q5SCYJs%2FJTXi%2Fsm9znfJcHgIy1DUYcyZol0zQmN4hQAlOUZZ6AJANKMjzew6Gbci4hpgZqkt7kMNinONmzU36EDiWMOc0y0LBIMMe8ckWdal2vM1amkx9g4%2B7jkxStLKe4Ry%2FVeqOEFeDj5B3%2Fim8atXFDPnaA6ZctYC0kADebiu9zFF1dQsSdkzsLG93dLAMR0ARXm0vun9nbqpp5oxDQafvSrdE7oDp0yem%2B391K5yvQ%2FVkTdyMd797ooD1IAYqUdwlX0lVblqv9ErzI2EUbOnFhO5widZFoU8s5JQDxyTzDlNAHHPnQpU8XD7uIRyR%2Bh43I9VvsEn1pERJ2rOM57I1PkAM8vesvdhiNkLY7KsmmB1q5drdmKxzSDeK5uPJY%2F7b6ZdCcYzDgNfX18d6h0A0FHbvXn7qPH9NQWGUsNXamCikRs9AA%2BK%2BzqwxI%2FlZdCdkUBJNbFqefOmuHA6y4DCuw6r%2FBTrqAZ4iBH5JOWBgJ5BPglFYT1gWFkwyMqq8gmMxb5SeS%2FjunuR9x9HhadmGfzTt7avXh7ra%2BbCbT8G5EBTHekw5tLrBpYwkzmLiedzIpJ4pJqrAXmk%2B6qfKdpUFGOfE%2FoOdzhIkM32hFOTOwwCcLwfUCOQXCXHweJlGlDZdV%2FgvnAv5llJv80AS6mRncqu5cTdZ6kwskL6mtLuZx022Hs9iVQEhZVcVFVxWNFIMlrPZufuNWFtnv13RkAoiqYOJgDn3UWRAP9lucn7OMZs0NyqKFy1iLho2FCO%2BegcGHVqDf%2FVxOtLAlnkhjmFRxg%3D%3D\u0026amp;X-Amz-Signature=c6a16847c521eaa2ae23e8342bdf7685a60ae6a95bdf5b840526b51346c1106f\" data-attachment-type=\"image/png\"\u003etopcoder_ssrf2.png (F781773)\u003c/a\u003e\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eFor fetching local files from the server itself (LFI),\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eI created another user named testing68 and uploaded an avatar picture for it. Added the picture link for testing68 user to the XML payload  =\u0026gt;  \u003ca class=\"markdown-attachment-link markdown-attachment-reference\" data-attachment-filename=\"topcoder13.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/jXLkN5gXsMPtp7wWPsBm9gGK?response-content-disposition=attachment%3B%20filename%3D%22topcoder13.png%22%3B%20filename%2A%3DUTF-8%27%27topcoder13.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQW2BAZGD3%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T070053Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDf7CC1janFXxWWF6QZ1Z6X6%2F6j0WDhv4gDyzEWu%2BScUAIhAOhgsmE64VangXFyIz5AGmDMLeT8sYG2vBQ4PwiaYS%2FZKrQDCFUQARoMMDEzNjE5Mjc0ODQ5Igy754oCq3nK3vWmRbMqkQM98qKdRlMDTd4bBwR4jJMppOWz7EU3ySwJK1geVZm7GvrSHyp8wAx03nVbAIisdh9q5SCYJs%2FJTXi%2Fsm9znfJcHgIy1DUYcyZol0zQmN4hQAlOUZZ6AJANKMjzew6Gbci4hpgZqkt7kMNinONmzU36EDiWMOc0y0LBIMMe8ckWdal2vM1amkx9g4%2B7jkxStLKe4Ry%2FVeqOEFeDj5B3%2Fim8atXFDPnaA6ZctYC0kADebiu9zFF1dQsSdkzsLG93dLAMR0ARXm0vun9nbqpp5oxDQafvSrdE7oDp0yem%2B391K5yvQ%2FVkTdyMd797ooD1IAYqUdwlX0lVblqv9ErzI2EUbOnFhO5widZFoU8s5JQDxyTzDlNAHHPnQpU8XD7uIRyR%2Bh43I9VvsEn1pERJ2rOM57I1PkAM8vesvdhiNkLY7KsmmB1q5drdmKxzSDeK5uPJY%2F7b6ZdCcYzDgNfX18d6h0A0FHbvXn7qPH9NQWGUsNXamCikRs9AA%2BK%2BzqwxI%2FlZdCdkUBJNbFqefOmuHA6y4DCuw6r%2FBTrqAZ4iBH5JOWBgJ5BPglFYT1gWFkwyMqq8gmMxb5SeS%2FjunuR9x9HhadmGfzTt7avXh7ra%2BbCbT8G5EBTHekw5tLrBpYwkzmLiedzIpJ4pJqrAXmk%2B6qfKdpUFGOfE%2FoOdzhIkM32hFOTOwwCcLwfUCOQXCXHweJlGlDZdV%2FgvnAv5llJv80AS6mRncqu5cTdZ6kwskL6mtLuZx022Hs9iVQEhZVcVFVxWNFIMlrPZufuNWFtnv13RkAoiqYOJgDn3UWRAP9lucn7OMZs0NyqKFy1iLho2FCO%2BegcGHVqDf%2FVxOtLAlnkhjmFRxg%3D%3D\u0026amp;X-Amz-Signature=221c13e24e96249966c786ca1be9ba8078951038680a85ec856e9840e61fe729\" data-attachment-type=\"image/png\"\u003etopcoder13.png (F781779)\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e\u0026lt;image x=\u0026quot;10\u0026quot; y=\u0026quot;10\u0026quot; width=\u0026quot;276\u0026quot; height=\u0026quot;110\u0026quot; xlink:href=\u0026quot;/member/profile/testing68-1586481096585.png\u0026quot; stroke-width=\u0026quot;1\u0026quot; id=\u0026quot;image3204\u0026quot; /\u0026gt;\u003c/p\u003e\n\n\u003ch2 id=\"supporting-material-references\"\u003eSupporting Material/References:\u003c/h2\u003e\n\n\u003cp\u003eSImilar Reports: \u003cbr\u003e\n\u003ca title=\"https://hackerone.com/reports/97501\" href=\"https://hackerone.com/reports/97501\"\u003ehttps://hackerone.com/reports/97501\u003c/a\u003e\u003cbr\u003e\n\u003ca title=\"https://hackerone.com/reports/142709\" href=\"https://hackerone.com/reports/142709\"\u003ehttps://hackerone.com/reports/142709\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eReference material:\u003cbr\u003e\n\u003ca title=\"https://qy.sg/x-ctf-finals-2016-john-slick-web-25/\" href=\"/redirect?url=https%3A%2F%2Fqy.sg%2Fx-ctf-finals-2016-john-slick-web-25%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://qy.sg/x-ctf-finals-2016-john-slick-web-25/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\n\u003ca title=\"https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/XXE%20Injection#xxe-inside-svg\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fswisskyrepo%2FPayloadsAllTheThings%2Ftree%2Fmaster%2FXXE%2520Injection%23xxe-inside-svg\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/XXE%20Injection#xxe-inside-svg\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eThanks\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eExploiting an XXE attack, allows an attacker to interfere with an application\u0026#39;s processing of XML data. It often allows an attacker to view files on the application server filesystem, and to interact with any backend or external systems that the application itself can access.\u003c/p\u003e\n\n\u003cp\u003eExploiting the billion laugh DOS attack can mess with the availability of the server and since it is an application level DOS network level filters will not be effective to stop such attack.\u003c/p\u003e\n","weakness":{"id":100,"name":"XML Injection"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":781757,"file_name":"topcoder11.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/UzPSCoedx22X69iQRpLaf3Ua?response-content-disposition=attachment%3B%20filename%3D%22topcoder11.png%22%3B%20filename%2A%3DUTF-8%27%27topcoder11.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQW2BAZGD3%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T070053Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDf7CC1janFXxWWF6QZ1Z6X6%2F6j0WDhv4gDyzEWu%2BScUAIhAOhgsmE64VangXFyIz5AGmDMLeT8sYG2vBQ4PwiaYS%2FZKrQDCFUQARoMMDEzNjE5Mjc0ODQ5Igy754oCq3nK3vWmRbMqkQM98qKdRlMDTd4bBwR4jJMppOWz7EU3ySwJK1geVZm7GvrSHyp8wAx03nVbAIisdh9q5SCYJs%2FJTXi%2Fsm9znfJcHgIy1DUYcyZol0zQmN4hQAlOUZZ6AJANKMjzew6Gbci4hpgZqkt7kMNinONmzU36EDiWMOc0y0LBIMMe8ckWdal2vM1amkx9g4%2B7jkxStLKe4Ry%2FVeqOEFeDj5B3%2Fim8atXFDPnaA6ZctYC0kADebiu9zFF1dQsSdkzsLG93dLAMR0ARXm0vun9nbqpp5oxDQafvSrdE7oDp0yem%2B391K5yvQ%2FVkTdyMd797ooD1IAYqUdwlX0lVblqv9ErzI2EUbOnFhO5widZFoU8s5JQDxyTzDlNAHHPnQpU8XD7uIRyR%2Bh43I9VvsEn1pERJ2rOM57I1PkAM8vesvdhiNkLY7KsmmB1q5drdmKxzSDeK5uPJY%2F7b6ZdCcYzDgNfX18d6h0A0FHbvXn7qPH9NQWGUsNXamCikRs9AA%2BK%2BzqwxI%2FlZdCdkUBJNbFqefOmuHA6y4DCuw6r%2FBTrqAZ4iBH5JOWBgJ5BPglFYT1gWFkwyMqq8gmMxb5SeS%2FjunuR9x9HhadmGfzTt7avXh7ra%2BbCbT8G5EBTHekw5tLrBpYwkzmLiedzIpJ4pJqrAXmk%2B6qfKdpUFGOfE%2FoOdzhIkM32hFOTOwwCcLwfUCOQXCXHweJlGlDZdV%2FgvnAv5llJv80AS6mRncqu5cTdZ6kwskL6mtLuZx022Hs9iVQEhZVcVFVxWNFIMlrPZufuNWFtnv13RkAoiqYOJgDn3UWRAP9lucn7OMZs0NyqKFy1iLho2FCO%2BegcGHVqDf%2FVxOtLAlnkhjmFRxg%3D%3D\u0026X-Amz-Signature=9d7ad2280e70a24d5b56a6b2a215e1cd8ef443f5da39dc957a98686752768301","file_size":177757,"type":"image/png"},{"id":781767,"file_name":"topcoder12.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/46BQ6Vp6BTmz4bjFUGkJvA9r?response-content-disposition=attachment%3B%20filename%3D%22topcoder12.png%22%3B%20filename%2A%3DUTF-8%27%27topcoder12.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQW2BAZGD3%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T070053Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDf7CC1janFXxWWF6QZ1Z6X6%2F6j0WDhv4gDyzEWu%2BScUAIhAOhgsmE64VangXFyIz5AGmDMLeT8sYG2vBQ4PwiaYS%2FZKrQDCFUQARoMMDEzNjE5Mjc0ODQ5Igy754oCq3nK3vWmRbMqkQM98qKdRlMDTd4bBwR4jJMppOWz7EU3ySwJK1geVZm7GvrSHyp8wAx03nVbAIisdh9q5SCYJs%2FJTXi%2Fsm9znfJcHgIy1DUYcyZol0zQmN4hQAlOUZZ6AJANKMjzew6Gbci4hpgZqkt7kMNinONmzU36EDiWMOc0y0LBIMMe8ckWdal2vM1amkx9g4%2B7jkxStLKe4Ry%2FVeqOEFeDj5B3%2Fim8atXFDPnaA6ZctYC0kADebiu9zFF1dQsSdkzsLG93dLAMR0ARXm0vun9nbqpp5oxDQafvSrdE7oDp0yem%2B391K5yvQ%2FVkTdyMd797ooD1IAYqUdwlX0lVblqv9ErzI2EUbOnFhO5widZFoU8s5JQDxyTzDlNAHHPnQpU8XD7uIRyR%2Bh43I9VvsEn1pERJ2rOM57I1PkAM8vesvdhiNkLY7KsmmB1q5drdmKxzSDeK5uPJY%2F7b6ZdCcYzDgNfX18d6h0A0FHbvXn7qPH9NQWGUsNXamCikRs9AA%2BK%2BzqwxI%2FlZdCdkUBJNbFqefOmuHA6y4DCuw6r%2FBTrqAZ4iBH5JOWBgJ5BPglFYT1gWFkwyMqq8gmMxb5SeS%2FjunuR9x9HhadmGfzTt7avXh7ra%2BbCbT8G5EBTHekw5tLrBpYwkzmLiedzIpJ4pJqrAXmk%2B6qfKdpUFGOfE%2FoOdzhIkM32hFOTOwwCcLwfUCOQXCXHweJlGlDZdV%2FgvnAv5llJv80AS6mRncqu5cTdZ6kwskL6mtLuZx022Hs9iVQEhZVcVFVxWNFIMlrPZufuNWFtnv13RkAoiqYOJgDn3UWRAP9lucn7OMZs0NyqKFy1iLho2FCO%2BegcGHVqDf%2FVxOtLAlnkhjmFRxg%3D%3D\u0026X-Amz-Signature=94db32f17d5454cf34485287baafa82200c61cd0a9cd98ce2f25e46f2a8a0919","file_size":90114,"type":"image/png"},{"id":781770,"file_name":"topcoder_ssrf.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/LduhYJeR4gqdNQ4CENp2M6Qx?response-content-disposition=attachment%3B%20filename%3D%22topcoder_ssrf.png%22%3B%20filename%2A%3DUTF-8%27%27topcoder_ssrf.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQW2BAZGD3%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T070053Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDf7CC1janFXxWWF6QZ1Z6X6%2F6j0WDhv4gDyzEWu%2BScUAIhAOhgsmE64VangXFyIz5AGmDMLeT8sYG2vBQ4PwiaYS%2FZKrQDCFUQARoMMDEzNjE5Mjc0ODQ5Igy754oCq3nK3vWmRbMqkQM98qKdRlMDTd4bBwR4jJMppOWz7EU3ySwJK1geVZm7GvrSHyp8wAx03nVbAIisdh9q5SCYJs%2FJTXi%2Fsm9znfJcHgIy1DUYcyZol0zQmN4hQAlOUZZ6AJANKMjzew6Gbci4hpgZqkt7kMNinONmzU36EDiWMOc0y0LBIMMe8ckWdal2vM1amkx9g4%2B7jkxStLKe4Ry%2FVeqOEFeDj5B3%2Fim8atXFDPnaA6ZctYC0kADebiu9zFF1dQsSdkzsLG93dLAMR0ARXm0vun9nbqpp5oxDQafvSrdE7oDp0yem%2B391K5yvQ%2FVkTdyMd797ooD1IAYqUdwlX0lVblqv9ErzI2EUbOnFhO5widZFoU8s5JQDxyTzDlNAHHPnQpU8XD7uIRyR%2Bh43I9VvsEn1pERJ2rOM57I1PkAM8vesvdhiNkLY7KsmmB1q5drdmKxzSDeK5uPJY%2F7b6ZdCcYzDgNfX18d6h0A0FHbvXn7qPH9NQWGUsNXamCikRs9AA%2BK%2BzqwxI%2FlZdCdkUBJNbFqefOmuHA6y4DCuw6r%2FBTrqAZ4iBH5JOWBgJ5BPglFYT1gWFkwyMqq8gmMxb5SeS%2FjunuR9x9HhadmGfzTt7avXh7ra%2BbCbT8G5EBTHekw5tLrBpYwkzmLiedzIpJ4pJqrAXmk%2B6qfKdpUFGOfE%2FoOdzhIkM32hFOTOwwCcLwfUCOQXCXHweJlGlDZdV%2FgvnAv5llJv80AS6mRncqu5cTdZ6kwskL6mtLuZx022Hs9iVQEhZVcVFVxWNFIMlrPZufuNWFtnv13RkAoiqYOJgDn3UWRAP9lucn7OMZs0NyqKFy1iLho2FCO%2BegcGHVqDf%2FVxOtLAlnkhjmFRxg%3D%3D\u0026X-Amz-Signature=34da287acea26c574e1bdbd0c494bae12516580f0dd0776eb057f96b51c2a3db","file_size":109313,"type":"image/png"},{"id":781773,"file_name":"topcoder_ssrf2.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/5Ba2uYsxZujGr3ocmVkGMMpu?response-content-disposition=attachment%3B%20filename%3D%22topcoder_ssrf2.png%22%3B%20filename%2A%3DUTF-8%27%27topcoder_ssrf2.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQW2BAZGD3%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T070053Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDf7CC1janFXxWWF6QZ1Z6X6%2F6j0WDhv4gDyzEWu%2BScUAIhAOhgsmE64VangXFyIz5AGmDMLeT8sYG2vBQ4PwiaYS%2FZKrQDCFUQARoMMDEzNjE5Mjc0ODQ5Igy754oCq3nK3vWmRbMqkQM98qKdRlMDTd4bBwR4jJMppOWz7EU3ySwJK1geVZm7GvrSHyp8wAx03nVbAIisdh9q5SCYJs%2FJTXi%2Fsm9znfJcHgIy1DUYcyZol0zQmN4hQAlOUZZ6AJANKMjzew6Gbci4hpgZqkt7kMNinONmzU36EDiWMOc0y0LBIMMe8ckWdal2vM1amkx9g4%2B7jkxStLKe4Ry%2FVeqOEFeDj5B3%2Fim8atXFDPnaA6ZctYC0kADebiu9zFF1dQsSdkzsLG93dLAMR0ARXm0vun9nbqpp5oxDQafvSrdE7oDp0yem%2B391K5yvQ%2FVkTdyMd797ooD1IAYqUdwlX0lVblqv9ErzI2EUbOnFhO5widZFoU8s5JQDxyTzDlNAHHPnQpU8XD7uIRyR%2Bh43I9VvsEn1pERJ2rOM57I1PkAM8vesvdhiNkLY7KsmmB1q5drdmKxzSDeK5uPJY%2F7b6ZdCcYzDgNfX18d6h0A0FHbvXn7qPH9NQWGUsNXamCikRs9AA%2BK%2BzqwxI%2FlZdCdkUBJNbFqefOmuHA6y4DCuw6r%2FBTrqAZ4iBH5JOWBgJ5BPglFYT1gWFkwyMqq8gmMxb5SeS%2FjunuR9x9HhadmGfzTt7avXh7ra%2BbCbT8G5EBTHekw5tLrBpYwkzmLiedzIpJ4pJqrAXmk%2B6qfKdpUFGOfE%2FoOdzhIkM32hFOTOwwCcLwfUCOQXCXHweJlGlDZdV%2FgvnAv5llJv80AS6mRncqu5cTdZ6kwskL6mtLuZx022Hs9iVQEhZVcVFVxWNFIMlrPZufuNWFtnv13RkAoiqYOJgDn3UWRAP9lucn7OMZs0NyqKFy1iLho2FCO%2BegcGHVqDf%2FVxOtLAlnkhjmFRxg%3D%3D\u0026X-Amz-Signature=c6a16847c521eaa2ae23e8342bdf7685a60ae6a95bdf5b840526b51346c1106f","file_size":35441,"type":"image/png"},{"id":781779,"file_name":"topcoder13.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/jXLkN5gXsMPtp7wWPsBm9gGK?response-content-disposition=attachment%3B%20filename%3D%22topcoder13.png%22%3B%20filename%2A%3DUTF-8%27%27topcoder13.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQW2BAZGD3%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T070053Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDf7CC1janFXxWWF6QZ1Z6X6%2F6j0WDhv4gDyzEWu%2BScUAIhAOhgsmE64VangXFyIz5AGmDMLeT8sYG2vBQ4PwiaYS%2FZKrQDCFUQARoMMDEzNjE5Mjc0ODQ5Igy754oCq3nK3vWmRbMqkQM98qKdRlMDTd4bBwR4jJMppOWz7EU3ySwJK1geVZm7GvrSHyp8wAx03nVbAIisdh9q5SCYJs%2FJTXi%2Fsm9znfJcHgIy1DUYcyZol0zQmN4hQAlOUZZ6AJANKMjzew6Gbci4hpgZqkt7kMNinONmzU36EDiWMOc0y0LBIMMe8ckWdal2vM1amkx9g4%2B7jkxStLKe4Ry%2FVeqOEFeDj5B3%2Fim8atXFDPnaA6ZctYC0kADebiu9zFF1dQsSdkzsLG93dLAMR0ARXm0vun9nbqpp5oxDQafvSrdE7oDp0yem%2B391K5yvQ%2FVkTdyMd797ooD1IAYqUdwlX0lVblqv9ErzI2EUbOnFhO5widZFoU8s5JQDxyTzDlNAHHPnQpU8XD7uIRyR%2Bh43I9VvsEn1pERJ2rOM57I1PkAM8vesvdhiNkLY7KsmmB1q5drdmKxzSDeK5uPJY%2F7b6ZdCcYzDgNfX18d6h0A0FHbvXn7qPH9NQWGUsNXamCikRs9AA%2BK%2BzqwxI%2FlZdCdkUBJNbFqefOmuHA6y4DCuw6r%2FBTrqAZ4iBH5JOWBgJ5BPglFYT1gWFkwyMqq8gmMxb5SeS%2FjunuR9x9HhadmGfzTt7avXh7ra%2BbCbT8G5EBTHekw5tLrBpYwkzmLiedzIpJ4pJqrAXmk%2B6qfKdpUFGOfE%2FoOdzhIkM32hFOTOwwCcLwfUCOQXCXHweJlGlDZdV%2FgvnAv5llJv80AS6mRncqu5cTdZ6kwskL6mtLuZx022Hs9iVQEhZVcVFVxWNFIMlrPZufuNWFtnv13RkAoiqYOJgDn3UWRAP9lucn7OMZs0NyqKFy1iLho2FCO%2BegcGHVqDf%2FVxOtLAlnkhjmFRxg%3D%3D\u0026X-Amz-Signature=221c13e24e96249966c786ca1be9ba8078951038680a85ec856e9840e61fe729","file_size":44824,"type":"image/png"},{"id":781788,"file_name":"topcoder14.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/246F43FP9nCH3Yak5Zq3s963?response-content-disposition=attachment%3B%20filename%3D%22topcoder14.png%22%3B%20filename%2A%3DUTF-8%27%27topcoder14.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQW2BAZGD3%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T070053Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDf7CC1janFXxWWF6QZ1Z6X6%2F6j0WDhv4gDyzEWu%2BScUAIhAOhgsmE64VangXFyIz5AGmDMLeT8sYG2vBQ4PwiaYS%2FZKrQDCFUQARoMMDEzNjE5Mjc0ODQ5Igy754oCq3nK3vWmRbMqkQM98qKdRlMDTd4bBwR4jJMppOWz7EU3ySwJK1geVZm7GvrSHyp8wAx03nVbAIisdh9q5SCYJs%2FJTXi%2Fsm9znfJcHgIy1DUYcyZol0zQmN4hQAlOUZZ6AJANKMjzew6Gbci4hpgZqkt7kMNinONmzU36EDiWMOc0y0LBIMMe8ckWdal2vM1amkx9g4%2B7jkxStLKe4Ry%2FVeqOEFeDj5B3%2Fim8atXFDPnaA6ZctYC0kADebiu9zFF1dQsSdkzsLG93dLAMR0ARXm0vun9nbqpp5oxDQafvSrdE7oDp0yem%2B391K5yvQ%2FVkTdyMd797ooD1IAYqUdwlX0lVblqv9ErzI2EUbOnFhO5widZFoU8s5JQDxyTzDlNAHHPnQpU8XD7uIRyR%2Bh43I9VvsEn1pERJ2rOM57I1PkAM8vesvdhiNkLY7KsmmB1q5drdmKxzSDeK5uPJY%2F7b6ZdCcYzDgNfX18d6h0A0FHbvXn7qPH9NQWGUsNXamCikRs9AA%2BK%2BzqwxI%2FlZdCdkUBJNbFqefOmuHA6y4DCuw6r%2FBTrqAZ4iBH5JOWBgJ5BPglFYT1gWFkwyMqq8gmMxb5SeS%2FjunuR9x9HhadmGfzTt7avXh7ra%2BbCbT8G5EBTHekw5tLrBpYwkzmLiedzIpJ4pJqrAXmk%2B6qfKdpUFGOfE%2FoOdzhIkM32hFOTOwwCcLwfUCOQXCXHweJlGlDZdV%2FgvnAv5llJv80AS6mRncqu5cTdZ6kwskL6mtLuZx022Hs9iVQEhZVcVFVxWNFIMlrPZufuNWFtnv13RkAoiqYOJgDn3UWRAP9lucn7OMZs0NyqKFy1iLho2FCO%2BegcGHVqDf%2FVxOtLAlnkhjmFRxg%3D%3D\u0026X-Amz-Signature=648de8ecd14c47fe32d1377a88b605278676c3466f8e3bcc89e6e822224b3626","file_size":191121,"type":"image/png"}],"allow_singular_disclosure_at":null,"vote_count":9,"voters":["mygf","sheerwood","sa1tama0","sn0wb4ll","mr0bart","lucifer_o","0xz3ro","tushr","blu3f1r3"],"severity":{"rating":"low","author_type":"Team"},"structured_scope":{"databaseId":37518,"asset_type":"URL","asset_identifier":"api.topcoder.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":7617819,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @tushr,\n\nThank you for your submission. Your report is currently being reviewed and the HackerOne triage team will get back to you once there is additional information to share.\n\nKind regards,\n@retina","markdown_message":"\u003cp\u003eHi \u003ca href=\"/tushr\"\u003e@tushr\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThank you for your submission. Your report is currently being reviewed and the HackerOne triage team will get back to you once there is additional information to share.\u003c/p\u003e\n\n\u003cp\u003eKind regards,\u003cbr\u003e\n\u003ca href=\"/retina\"\u003e@retina\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2020-04-10T16:00:49.029Z","updated_at":"2020-04-10T16:00:49.029Z","actor":{"username":"retina","cleared":false,"url":"/retina","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/DcHq8J1tkrQ2MjySxMGseBW6/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"topcoder","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":7617840,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @tushr,\nWe have a very similar submission that will probably end up mitigating this submission as well when fixed.\n\nHowever, let me discuss this internally with the team and get back to you.\n\nWorth noting the following:\n- You are unable to retrieve sensitive internal files. According to your PoC, you can only retrieve data from the bucket, and the bucket only contains images.\n- This is not a full fledged XXE, and being able to send requests externally doesn't have much of an impact.\n\nI'll provide you an update as soon as i hear back from the team.\n\nRegards,\n@retina","markdown_message":"\u003cp\u003eHi \u003ca href=\"/tushr\"\u003e@tushr\u003c/a\u003e,\u003cbr\u003e\nWe have a very similar submission that will probably end up mitigating this submission as well when fixed.\u003c/p\u003e\n\n\u003cp\u003eHowever, let me discuss this internally with the team and get back to you.\u003c/p\u003e\n\n\u003cp\u003eWorth noting the following:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eYou are unable to retrieve sensitive internal files. According to your PoC, you can only retrieve data from the bucket, and the bucket only contains images.\u003c/li\u003e\n\u003cli\u003eThis is not a full fledged XXE, and being able to send requests externally doesn\u0026#39;t have much of an impact.\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eI\u0026#39;ll provide you an update as soon as i hear back from the team.\u003c/p\u003e\n\n\u003cp\u003eRegards,\u003cbr\u003e\n\u003ca href=\"/retina\"\u003e@retina\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2020-04-10T16:03:58.566Z","updated_at":"2020-04-10T16:03:58.566Z","actor":{"username":"retina","cleared":false,"url":"/retina","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/DcHq8J1tkrQ2MjySxMGseBW6/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"topcoder","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":7617865,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2020-04-10T16:06:44.319Z","updated_at":"2020-04-10T16:06:44.319Z","additional_data":{"old_severity":"High","new_severity":"Low","old_severity_id":687466,"new_severity_id":688344},"actor":{"username":"retina","cleared":false,"url":"/retina","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/DcHq8J1tkrQ2MjySxMGseBW6/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"topcoder","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":7625781,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @retina ,\nThanks for the reply.\n\nI agree, currently this only has an impact to retrieve local files on the bucket because that's where my SVG file is getting stored. But nonetheless, it is a full-blown LFI. If sometime in the future the company decides to store sensitive info on the bucket, or decided to move the images to some other server, then sensitive info can be fetched.\n\nAlso, I would like to point that I was also able to do an XSS   =\u003e   F783608\nImbedding a \u003cscript\u003ealert(1)\u003c/script\u003e inside the SVG makes it a stored XSS and will execute on any client who opens the image. \n\nI think being able to embed any code inside the SVG file makes it like a time-bomb waiting to explode. Happy to help if anything else is needed.\n","markdown_message":"\u003cp\u003eHi \u003ca href=\"/retina\"\u003e@retina\u003c/a\u003e ,\u003cbr\u003e\nThanks for the reply.\u003c/p\u003e\n\n\u003cp\u003eI agree, currently this only has an impact to retrieve local files on the bucket because that\u0026#39;s where my SVG file is getting stored. But nonetheless, it is a full-blown LFI. If sometime in the future the company decides to store sensitive info on the bucket, or decided to move the images to some other server, then sensitive info can be fetched.\u003c/p\u003e\n\n\u003cp\u003eAlso, I would like to point that I was also able to do an XSS   =\u0026gt;   \u003ca class=\"markdown-attachment-link markdown-attachment-reference\" data-attachment-filename=\"topcoder_storedxss.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/YLwJ8YWRPJxinwP7kV8tb6mg?response-content-disposition=attachment%3B%20filename%3D%22topcoder_storedxss.png%22%3B%20filename%2A%3DUTF-8%27%27topcoder_storedxss.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQW2BAZGD3%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T070053Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDf7CC1janFXxWWF6QZ1Z6X6%2F6j0WDhv4gDyzEWu%2BScUAIhAOhgsmE64VangXFyIz5AGmDMLeT8sYG2vBQ4PwiaYS%2FZKrQDCFUQARoMMDEzNjE5Mjc0ODQ5Igy754oCq3nK3vWmRbMqkQM98qKdRlMDTd4bBwR4jJMppOWz7EU3ySwJK1geVZm7GvrSHyp8wAx03nVbAIisdh9q5SCYJs%2FJTXi%2Fsm9znfJcHgIy1DUYcyZol0zQmN4hQAlOUZZ6AJANKMjzew6Gbci4hpgZqkt7kMNinONmzU36EDiWMOc0y0LBIMMe8ckWdal2vM1amkx9g4%2B7jkxStLKe4Ry%2FVeqOEFeDj5B3%2Fim8atXFDPnaA6ZctYC0kADebiu9zFF1dQsSdkzsLG93dLAMR0ARXm0vun9nbqpp5oxDQafvSrdE7oDp0yem%2B391K5yvQ%2FVkTdyMd797ooD1IAYqUdwlX0lVblqv9ErzI2EUbOnFhO5widZFoU8s5JQDxyTzDlNAHHPnQpU8XD7uIRyR%2Bh43I9VvsEn1pERJ2rOM57I1PkAM8vesvdhiNkLY7KsmmB1q5drdmKxzSDeK5uPJY%2F7b6ZdCcYzDgNfX18d6h0A0FHbvXn7qPH9NQWGUsNXamCikRs9AA%2BK%2BzqwxI%2FlZdCdkUBJNbFqefOmuHA6y4DCuw6r%2FBTrqAZ4iBH5JOWBgJ5BPglFYT1gWFkwyMqq8gmMxb5SeS%2FjunuR9x9HhadmGfzTt7avXh7ra%2BbCbT8G5EBTHekw5tLrBpYwkzmLiedzIpJ4pJqrAXmk%2B6qfKdpUFGOfE%2FoOdzhIkM32hFOTOwwCcLwfUCOQXCXHweJlGlDZdV%2FgvnAv5llJv80AS6mRncqu5cTdZ6kwskL6mtLuZx022Hs9iVQEhZVcVFVxWNFIMlrPZufuNWFtnv13RkAoiqYOJgDn3UWRAP9lucn7OMZs0NyqKFy1iLho2FCO%2BegcGHVqDf%2FVxOtLAlnkhjmFRxg%3D%3D\u0026amp;X-Amz-Signature=5a270b93cdb1ad95954e7246905845c0c0a31c4e6113dcbc4abd2790a5de4bb2\" data-attachment-type=\"image/png\"\u003etopcoder_storedxss.png (F783608)\u003c/a\u003e\u003cbr\u003e\nImbedding a \u0026lt;script\u0026gt;alert(1)\u0026lt;/script\u0026gt; inside the SVG makes it a stored XSS and will execute on any client who opens the image. \u003c/p\u003e\n\n\u003cp\u003eI think being able to embed any code inside the SVG file makes it like a time-bomb waiting to explode. Happy to help if anything else is needed.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-04-11T05:49:08.165Z","updated_at":"2020-04-11T05:49:08.165Z","actor":{"username":"tushr","cleared":false,"url":"/tushr","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/CwAR2EghZLncT7DQ4NjTigRc/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"attachments":[{"id":783608,"filename":"topcoder_storedxss.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/YLwJ8YWRPJxinwP7kV8tb6mg?response-content-disposition=attachment%3B%20filename%3D%22topcoder_storedxss.png%22%3B%20filename%2A%3DUTF-8%27%27topcoder_storedxss.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQW2BAZGD3%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T070053Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDf7CC1janFXxWWF6QZ1Z6X6%2F6j0WDhv4gDyzEWu%2BScUAIhAOhgsmE64VangXFyIz5AGmDMLeT8sYG2vBQ4PwiaYS%2FZKrQDCFUQARoMMDEzNjE5Mjc0ODQ5Igy754oCq3nK3vWmRbMqkQM98qKdRlMDTd4bBwR4jJMppOWz7EU3ySwJK1geVZm7GvrSHyp8wAx03nVbAIisdh9q5SCYJs%2FJTXi%2Fsm9znfJcHgIy1DUYcyZol0zQmN4hQAlOUZZ6AJANKMjzew6Gbci4hpgZqkt7kMNinONmzU36EDiWMOc0y0LBIMMe8ckWdal2vM1amkx9g4%2B7jkxStLKe4Ry%2FVeqOEFeDj5B3%2Fim8atXFDPnaA6ZctYC0kADebiu9zFF1dQsSdkzsLG93dLAMR0ARXm0vun9nbqpp5oxDQafvSrdE7oDp0yem%2B391K5yvQ%2FVkTdyMd797ooD1IAYqUdwlX0lVblqv9ErzI2EUbOnFhO5widZFoU8s5JQDxyTzDlNAHHPnQpU8XD7uIRyR%2Bh43I9VvsEn1pERJ2rOM57I1PkAM8vesvdhiNkLY7KsmmB1q5drdmKxzSDeK5uPJY%2F7b6ZdCcYzDgNfX18d6h0A0FHbvXn7qPH9NQWGUsNXamCikRs9AA%2BK%2BzqwxI%2FlZdCdkUBJNbFqefOmuHA6y4DCuw6r%2FBTrqAZ4iBH5JOWBgJ5BPglFYT1gWFkwyMqq8gmMxb5SeS%2FjunuR9x9HhadmGfzTt7avXh7ra%2BbCbT8G5EBTHekw5tLrBpYwkzmLiedzIpJ4pJqrAXmk%2B6qfKdpUFGOfE%2FoOdzhIkM32hFOTOwwCcLwfUCOQXCXHweJlGlDZdV%2FgvnAv5llJv80AS6mRncqu5cTdZ6kwskL6mtLuZx022Hs9iVQEhZVcVFVxWNFIMlrPZufuNWFtnv13RkAoiqYOJgDn3UWRAP9lucn7OMZs0NyqKFy1iLho2FCO%2BegcGHVqDf%2FVxOtLAlnkhjmFRxg%3D%3D\u0026X-Amz-Signature=5a270b93cdb1ad95954e7246905845c0c0a31c4e6113dcbc4abd2790a5de4bb2"}],"genius_execution_id":null,"team_handle":"topcoder","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7626051,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Also, I would like to mention an article on OPSWAT. They say that image files can be embedded with malicious code which can run directly on the client browser once opened. Now checks for this can be implemented at the Upload Avatar button, but since my SVG file can load image files from external sources these checks can be bypassed easily.\n\nTo quote from the article:\n\"The following image formats can carry Stegosploit: BMP, GIF, JPG, and PNG. (SVG files can also be used as vehicles for malware.)\"\n       https://www.opswat.com/blog/hacking-pictures-stegosploit-and-how-stop-it\n\nNow I have not yet got the time to try these attack vectors, i.e, to create a malicious image file but one can imagine that if a client is given full reign over what data can be fetched remotely it opens up a large area of attacks. \n\nI think this should answer your query that sending requests to remote assets does not have any impact.","markdown_message":"\u003cp\u003eAlso, I would like to mention an article on OPSWAT. They say that image files can be embedded with malicious code which can run directly on the client browser once opened. Now checks for this can be implemented at the Upload Avatar button, but since my SVG file can load image files from external sources these checks can be bypassed easily.\u003c/p\u003e\n\n\u003cp\u003eTo quote from the article:\u003cbr\u003e\n\u0026quot;The following image formats can carry Stegosploit: BMP, GIF, JPG, and PNG. (SVG files can also be used as vehicles for malware.)\u0026quot;\u003cbr\u003e\n       \u003ca title=\"https://www.opswat.com/blog/hacking-pictures-stegosploit-and-how-stop-it\" href=\"/redirect?url=https%3A%2F%2Fwww.opswat.com%2Fblog%2Fhacking-pictures-stegosploit-and-how-stop-it\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.opswat.com/blog/hacking-pictures-stegosploit-and-how-stop-it\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eNow I have not yet got the time to try these attack vectors, i.e, to create a malicious image file but one can imagine that if a client is given full reign over what data can be fetched remotely it opens up a large area of attacks. \u003c/p\u003e\n\n\u003cp\u003eI think this should answer your query that sending requests to remote assets does not have any impact.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-04-11T06:49:57.842Z","updated_at":"2020-04-11T06:49:57.842Z","actor":{"username":"tushr","cleared":false,"url":"/tushr","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/CwAR2EghZLncT7DQ4NjTigRc/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"topcoder","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7647741,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi, what is the status of this? I can see that /settings/profile page has been taken down. Please acknowledge, I was able to do exploit LFI, RFI and stored XSS. ","markdown_message":"\u003cp\u003eHi, what is the status of this? I can see that /settings/profile page has been taken down. Please acknowledge, I was able to do exploit LFI, RFI and stored XSS. \u003c/p\u003e\n","automated_response":false,"created_at":"2020-04-13T19:57:02.885Z","updated_at":"2020-04-13T19:57:02.885Z","actor":{"username":"tushr","cleared":false,"url":"/tushr","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/CwAR2EghZLncT7DQ4NjTigRc/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"topcoder","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7654103,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hi @tushr,\nWe received a previous similar submission which allowed for XSS to be achieved by uploading the .svg file, so the root cause is the same.\nPreventing an upload of SVG files would mitigate the issues described in this report.\n\nHowever, the team let us know internally that they appreciate the effort and details put into this report, so they instructed us to close this submission as Resolved so that you get the reputation points.\n\nHave a nice day :)\nRegards,\n@retina","markdown_message":"\u003cp\u003eHi \u003ca href=\"/tushr\"\u003e@tushr\u003c/a\u003e,\u003cbr\u003e\nWe received a previous similar submission which allowed for XSS to be achieved by uploading the .svg file, so the root cause is the same.\u003cbr\u003e\nPreventing an upload of SVG files would mitigate the issues described in this report.\u003c/p\u003e\n\n\u003cp\u003eHowever, the team let us know internally that they appreciate the effort and details put into this report, so they instructed us to close this submission as Resolved so that you get the reputation points.\u003c/p\u003e\n\n\u003cp\u003eHave a nice day :)\u003cbr\u003e\nRegards,\u003cbr\u003e\n\u003ca href=\"/retina\"\u003e@retina\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2020-04-14T09:20:14.231Z","updated_at":"2020-04-14T09:20:14.231Z","actor":{"username":"retina","cleared":false,"url":"/retina","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/DcHq8J1tkrQ2MjySxMGseBW6/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":null},"reporter":{"username":"tushr","url":"/tushr"},"genius_execution_id":null,"team_handle":"topcoder","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":7656809,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks a lot @retina ","markdown_message":"\u003cp\u003eThanks a lot \u003ca href=\"/retina\"\u003e@retina\u003c/a\u003e \u003c/p\u003e\n","automated_response":false,"created_at":"2020-04-14T12:22:34.804Z","updated_at":"2020-04-14T12:22:34.804Z","actor":{"username":"tushr","cleared":false,"url":"/tushr","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/CwAR2EghZLncT7DQ4NjTigRc/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"topcoder","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8656596,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi... Can we disclose this?","markdown_message":"\u003cp\u003eHi... Can we disclose this?\u003c/p\u003e\n","automated_response":false,"created_at":"2020-07-20T18:08:42.454Z","updated_at":"2020-07-20T18:08:42.454Z","actor":{"username":"tushr","cleared":false,"url":"/tushr","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/CwAR2EghZLncT7DQ4NjTigRc/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"topcoder","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8742746,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-07-24T14:00:13.849Z","updated_at":"2020-07-24T14:00:13.849Z","first_to_agree":true,"actor":{"username":"jwheeler","cleared":false,"url":"/jwheeler","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/GwjmYrZ8TN3LsZ63NQnwopL7/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"topcoder","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8942604,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-08-14T21:43:55.114Z","updated_at":"2020-08-14T21:43:55.114Z","actor":{"username":"tushr","cleared":false,"url":"/tushr","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/CwAR2EghZLncT7DQ4NjTigRc/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"topcoder","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8942605,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-08-14T21:43:55.198Z","updated_at":"2020-08-14T21:43:55.198Z","actor":{"username":"tushr","cleared":false,"url":"/tushr","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/CwAR2EghZLncT7DQ4NjTigRc/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"topcoder","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}