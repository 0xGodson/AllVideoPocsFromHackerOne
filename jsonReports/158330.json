{"id":158330,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNTgzMzA=","url":"https://hackerone.com/reports/158330","title":"Ability to access all user authentication tokens, leads to RCE","state":"Closed","substate":"resolved","severity_rating":"critical","readable_substate":"Resolved","created_at":"2016-08-11T01:21:05.379Z","submitted_at":"2016-08-11T01:21:05.379Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"jobert","url":"/jobert","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":264,"url":"https://hackerone.com/gitlab","handle":"gitlab","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/264/8dd359f496ba6c5b97c5126dc86924a00fd7ef26_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/264/8dd359f496ba6c5b97c5126dc86924a00fd7ef26_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"GitLab","twitter_handle":"gitlab","website":"https://about.gitlab.com","about":"A single application for the entire software development lifecycle."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2016-11-03T22:28:43.639Z","bug_reporter_agreed_on_going_public_at":"2016-11-03T22:28:43.590Z","team_member_agreed_on_going_public_at":"2016-11-03T00:40:07.793Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"# Vulnerability details\nThe project export feature serializes the user objects of team members and stores it in the `project.json` file. This object contains the `authentication_token` for every user, meaning that an attacker can simply go ahead and create a project on GitLab.com, add one of the admins of GitLab.com, create an export, and obtain the authentication token for that user.\n\n# Proof of concept\nFollow these steps to reproduce the issue:\n\n - create a test account on a GitLab instance and create a temporary repository\n - invite an admin of the GitLab instance as a team member to the repository\n - go to the repository settings and create an export\n - wait a few minutes until you received the export email\n - now go to http://gitlab-instance/account/repo/download_export\n - unzip the downloaded file and examine `projects.json` - the `project_members` will contain the user object that contains the `authentication_token`\n\nHere's the first few bytes of `rspeicher` (sorry Robert) his authentication token on GitLab.com: `ZyhqJr4XJZ...`. Someone could get access to GitLab's admin panel by extracting the token of an admin and go to https://gitlab.com/admin/users?authentication_token=\u003ctoken\u003e. From what I've seen on my own GitLab instance, this leads to RCE and gives me access to all code in private repositories. Let me know if you need more information!","vulnerability_information_html":"\u003ch1 id=\"vulnerability-details\"\u003eVulnerability details\u003c/h1\u003e\n\n\u003cp\u003eThe project export feature serializes the user objects of team members and stores it in the \u003ccode\u003eproject.json\u003c/code\u003e file. This object contains the \u003ccode\u003eauthentication_token\u003c/code\u003e for every user, meaning that an attacker can simply go ahead and create a project on GitLab.com, add one of the admins of GitLab.com, create an export, and obtain the authentication token for that user.\u003c/p\u003e\n\n\u003ch1 id=\"proof-of-concept\"\u003eProof of concept\u003c/h1\u003e\n\n\u003cp\u003eFollow these steps to reproduce the issue:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003ecreate a test account on a GitLab instance and create a temporary repository\u003c/li\u003e\n\u003cli\u003einvite an admin of the GitLab instance as a team member to the repository\u003c/li\u003e\n\u003cli\u003ego to the repository settings and create an export\u003c/li\u003e\n\u003cli\u003ewait a few minutes until you received the export email\u003c/li\u003e\n\u003cli\u003enow go to \u003ca title=\"http://gitlab-instance/account/repo/download_export\" href=\"/redirect?url=http%3A%2F%2Fgitlab-instance%2Faccount%2Frepo%2Fdownload_export\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://gitlab-instance/account/repo/download_export\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003eunzip the downloaded file and examine \u003ccode\u003eprojects.json\u003c/code\u003e - the \u003ccode\u003eproject_members\u003c/code\u003e will contain the user object that contains the \u003ccode\u003eauthentication_token\u003c/code\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eHere\u0026#39;s the first few bytes of \u003ccode\u003erspeicher\u003c/code\u003e (sorry Robert) his authentication token on GitLab.com: \u003ccode\u003eZyhqJr4XJZ...\u003c/code\u003e. Someone could get access to GitLab\u0026#39;s admin panel by extracting the token of an admin and go to \u003ca title=\"https://gitlab.com/admin/users?authentication_token=\" href=\"/redirect?url=https%3A%2F%2Fgitlab.com%2Fadmin%2Fusers%3Fauthentication_token%3D\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://gitlab.com/admin/users?authentication_token=\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u0026lt;token\u0026gt;. From what I\u0026#39;ve seen on my own GitLab instance, this leads to RCE and gives me access to all code in private repositories. Let me know if you need more information!\u003c/p\u003e\n","weakness":{"id":75,"name":"Privilege Escalation"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2016-12-03T00:40:07.831Z","allow_singular_disclosure_after":-128490951.16300851,"singular_disclosure_allowed":true,"vote_count":56,"voters":["sameoldstory","lukasreschke","jensec","derision","notnaffy","michiel","suv","troubleshooter","yaworsk","zombiehelp54","and 46 more..."],"severity":{"rating":"critical","score":9.9,"author_type":"User","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"low","user_interaction":"none","scope":"changed","confidentiality":"high","integrity":"high","availability":"high"}},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1118427,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"The link in the report should be `https://gitlab.com/gitlab-org/gitlab-ce/issues?private_token=\u003ctoken\u003e`. Also, because the entire user object is serialized, the hashed password, OTP secrets, hashed backup codes, hashed confirmation tokens are all leaked into the response as well. I demonstrated the exploitability of the attack with the authentication token, because that one is stored without any form of hashing or encryption in the database.","markdown_message":"\u003cp\u003eThe link in the report should be \u003ccode\u003ehttps://gitlab.com/gitlab-org/gitlab-ce/issues?private_token=\u0026lt;token\u0026gt;\u003c/code\u003e. Also, because the entire user object is serialized, the hashed password, OTP secrets, hashed backup codes, hashed confirmation tokens are all leaked into the response as well. I demonstrated the exploitability of the attack with the authentication token, because that one is stored without any form of hashing or encryption in the database.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-11T01:31:05.012Z","updated_at":"2016-08-11T01:32:52.828Z","actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1118531,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thanks @jobert, we're looking into it.","markdown_message":"\u003cp\u003eThanks \u003ca href=\"/jobert\"\u003e@jobert\u003c/a\u003e, we\u0026#39;re looking into it.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-11T03:33:16.024Z","updated_at":"2016-08-11T03:33:16.024Z","actor":{"username":"rspeicher","cleared":false,"url":"/rspeicher","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/070/800/771703800f32dcb0c5413919f04f19305041dd58_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1118533,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"There seem to be a lot more issues with this feature. When importing, the repository gets restored based on the value of the `project.json` file. Besides the `project_members` array, which is deleted before the import is processed, its pretty trivial to link to other objects that belong to other repositories. Simply assign an array of IDs to, for example, `hooks` and run the import. This will \"claim\" the object IDs and give you access to them after the import is completed.\n\nAnother issue here is that the upload restore script actually copies files on disk. This means that if someone untars the export, adds an uploads directory, symlinks /etc/passwd in that directory, tars and uploads it, the attacker gets access to the contents of /etc/passwd (it can be accessed by making an export again after that). \n\nI thought about a fix for this problem, and albeit signing the contents of the file could be a solution, that's probably not what you want here. These export files are likely being used across multiple GitLab instances, making signing not an option (someone could just sign the file again, since the key pairs would be publicly available). To be fair, it seems that the direction that was taken with this export / import strategy warrants a revert of the feature, given the amount of (potential) issues that this introduces, but hey - who am I :)\n\nThanks, @rspeicher! Let me know if you need anything.","markdown_message":"\u003cp\u003eThere seem to be a lot more issues with this feature. When importing, the repository gets restored based on the value of the \u003ccode\u003eproject.json\u003c/code\u003e file. Besides the \u003ccode\u003eproject_members\u003c/code\u003e array, which is deleted before the import is processed, its pretty trivial to link to other objects that belong to other repositories. Simply assign an array of IDs to, for example, \u003ccode\u003ehooks\u003c/code\u003e and run the import. This will \u0026quot;claim\u0026quot; the object IDs and give you access to them after the import is completed.\u003c/p\u003e\n\n\u003cp\u003eAnother issue here is that the upload restore script actually copies files on disk. This means that if someone untars the export, adds an uploads directory, symlinks /etc/passwd in that directory, tars and uploads it, the attacker gets access to the contents of /etc/passwd (it can be accessed by making an export again after that). \u003c/p\u003e\n\n\u003cp\u003eI thought about a fix for this problem, and albeit signing the contents of the file could be a solution, that\u0026#39;s probably not what you want here. These export files are likely being used across multiple GitLab instances, making signing not an option (someone could just sign the file again, since the key pairs would be publicly available). To be fair, it seems that the direction that was taken with this export / import strategy warrants a revert of the feature, given the amount of (potential) issues that this introduces, but hey - who am I :)\u003c/p\u003e\n\n\u003cp\u003eThanks, \u003ca href=\"/rspeicher\"\u003e@rspeicher\u003c/a\u003e! Let me know if you need anything.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-11T03:34:48.020Z","updated_at":"2016-08-11T03:34:48.020Z","actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1118567,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"We've disabled importing projects from GitLab exports on GitLab.com to mitigate part of this issue. We're looking into disabling the export routes temporarily until we can apply a proper fix.","markdown_message":"\u003cp\u003eWe\u0026#39;ve disabled importing projects from GitLab exports on GitLab.com to mitigate part of this issue. We\u0026#39;re looking into disabling the export routes temporarily until we can apply a proper fix.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-11T04:02:01.574Z","updated_at":"2016-08-11T04:02:01.574Z","actor":{"username":"rspeicher","cleared":false,"url":"/rspeicher","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/070/800/771703800f32dcb0c5413919f04f19305041dd58_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1128027,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@jobert We've got a fix ready for the original information disclosure you reported and will have patches out in the next day or two.\n\nWe're continuing internal discussions about the security of the feature as a whole. James, who developed the feature, wasn't able to get a proof of concept working for the `/etc/passwd` example:\n\n\u003e I don't think this would work -  we are using `copy_entry` with `dereference_root` default's false  - http://apidock.com/ruby/FileUtils/copy_entry\n\u003e\n\u003e Also see my test - but definitely correct me if I'm wrong!\n\n```bash\n\u003e echo 'secret' \u003e /tmp/passwd\n\u003e chmod 777 /tmp/passwd #extra vulnerability that is needed.\n\u003e stat /tmp/passwd\n16777220 28528016 -rwxrwxrwx 1 James wheel 0 7 \"Aug 12 09:39:16 2016\" \"Aug 12 09:39:12 2016\" \"Aug 12 09:39:12 2016\" \"Aug 12 09:31:50 2016\" 4096 8 0 /tmp/passwd\n# Now, download an export file\n\u003e ls -t ~/Downloads/ | head -1\n2016-08-12_09-34-826_gitlab-org_gitlab-test_export.tar.gz\n\u003e tar -xzf ~/Downloads/2016-08-12_09-34-826_gitlab-org_gitlab-test_export.tar.gz -C /tmp/export\n\u003e cd /tmp/export/uploads\n# Create the symlink to /tmp/passwd\n\u003e ln -s /tmp/passwd ./passwd\n\u003e cd ../..\n\u003e tar -czf export.tar.gz -C ./export .\n\u003e tar -ztvf export.tar.gz\ndrwxr-xr-x James/wheel       0 2016-08-12 09:34 ./\n-rw-r--r-- James/wheel  318472 2016-08-12 09:34 ./project.bundle\n-rw-r--r-- James/wheel  144235 2016-08-12 09:34 ./project.json\n-rw-r--r-- James/wheel     346 2016-08-12 09:34 ./project.wiki.bundle\ndrwxr-xr-x James/wheel       0 2016-08-12 09:38 ./uploads/\ndrwxr-xr-x James/wheel       0 2016-08-12 09:34 ./uploads/8d5d0e7b3981edb77dc751d41e527302/\n-rw-r--r-- James/wheel     346 2016-08-12 09:34 ./uploads/8d5d0e7b3981edb77dc751d41e527302/project.wiki.bundle\ndrwxr-xr-x James/wheel       0 2016-08-12 09:34 ./uploads/8f32485f7e896b15c62886951b13744f/\n-rw-r--r-- James/wheel  340523 2016-08-12 09:34 ./uploads/8f32485f7e896b15c62886951b13744f/test_project_export.tar.gz\nlrwxr-xr-x James/wheel       0 2016-08-12 09:38 ./uploads/passwd -\u003e /tmp/passwd\n-rw-r--r-- James/wheel       5 2016-08-12 09:34 ./VERSION\n# Now, upload that export.tar.gz and export the new imported project\n\u003e ls -t ~/Downloads/ | head -1\n2016-08-12_09-45-747_root_test-uploads_export.tar.gz\n\u003e tar -tzvf ~/Downloads/2016-08-12_09-45-747_root_test-uploads_export.tar.gz\ndrwxr-xr-x James/staff       0 2016-08-12 09:45 ./\n-rw-r--r-- James/staff  317859 2016-08-12 09:45 ./project.bundle\n-rw-r--r-- James/staff  148058 2016-08-12 09:45 ./project.json\n-rw-r--r-- James/staff     346 2016-08-12 09:45 ./project.wiki.bundle\ndrwxr-xr-x James/staff       0 2016-08-12 09:45 ./uploads/\ndrwxr-xr-x James/staff       0 2016-08-12 09:45 ./uploads/8d5d0e7b3981edb77dc751d41e527302/\n-rw-r--r-- James/staff     346 2016-08-12 09:45 ./uploads/8d5d0e7b3981edb77dc751d41e527302/project.wiki.bundle\ndrwxr-xr-x James/staff       0 2016-08-12 09:45 ./uploads/8f32485f7e896b15c62886951b13744f/\n-rw-r--r-- James/staff  340523 2016-08-12 09:45 ./uploads/8f32485f7e896b15c62886951b13744f/test_project_export.tar.gz\nlrwxr-xr-x James/staff       0 2016-08-12 09:45 ./uploads/passwd -\u003e /tmp/passwd\n-rw-r--r-- James/staff       5 2016-08-12 09:45 ./VERSION\n```\n\n\u003e So it's a symlink and filesize is indeed 0: `0 2016-08-12 09:45 ./uploads/passwd -\u003e /tmp/passwd`\n","markdown_message":"\u003cp\u003e\u003ca href=\"/jobert\"\u003e@jobert\u003c/a\u003e We\u0026#39;ve got a fix ready for the original information disclosure you reported and will have patches out in the next day or two.\u003c/p\u003e\n\n\u003cp\u003eWe\u0026#39;re continuing internal discussions about the security of the feature as a whole. James, who developed the feature, wasn\u0026#39;t able to get a proof of concept working for the \u003ccode\u003e/etc/passwd\u003c/code\u003e example:\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eI don\u0026#39;t think this would work -  we are using \u003ccode\u003ecopy_entry\u003c/code\u003e with \u003ccode\u003edereference_root\u003c/code\u003e default\u0026#39;s false  - \u003ca title=\"http://apidock.com/ruby/FileUtils/copy_entry\" href=\"/redirect?url=http%3A%2F%2Fapidock.com%2Fruby%2FFileUtils%2Fcopy_entry\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://apidock.com/ruby/FileUtils/copy_entry\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eAlso see my test - but definitely correct me if I\u0026#39;m wrong!\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight shell\"\u003e\u003ccode\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"nb\"\u003eecho\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;secret\u0026#39;\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e /tmp/passwd\n\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"nb\"\u003echmod \u003c/span\u003e777 /tmp/passwd \u003cspan class=\"c\"\u003e#extra vulnerability that is needed.\u003c/span\u003e\n\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"nb\"\u003estat\u003c/span\u003e /tmp/passwd\n16777220 28528016 \u003cspan class=\"nt\"\u003e-rwxrwxrwx\u003c/span\u003e 1 James wheel 0 7 \u003cspan class=\"s2\"\u003e\u0026quot;Aug 12 09:39:16 2016\u0026quot;\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026quot;Aug 12 09:39:12 2016\u0026quot;\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026quot;Aug 12 09:39:12 2016\u0026quot;\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026quot;Aug 12 09:31:50 2016\u0026quot;\u003c/span\u003e 4096 8 0 /tmp/passwd\n\u003cspan class=\"c\"\u003e# Now, download an export file\u003c/span\u003e\n\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"nb\"\u003els\u003c/span\u003e \u003cspan class=\"nt\"\u003e-t\u003c/span\u003e ~/Downloads/ | \u003cspan class=\"nb\"\u003ehead\u003c/span\u003e \u003cspan class=\"nt\"\u003e-1\u003c/span\u003e\n2016-08-12_09-34-826_gitlab-org_gitlab-test_export.tar.gz\n\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"nb\"\u003etar\u003c/span\u003e \u003cspan class=\"nt\"\u003e-xzf\u003c/span\u003e ~/Downloads/2016-08-12_09-34-826_gitlab-org_gitlab-test_export.tar.gz \u003cspan class=\"nt\"\u003e-C\u003c/span\u003e /tmp/export\n\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"nb\"\u003ecd\u003c/span\u003e /tmp/export/uploads\n\u003cspan class=\"c\"\u003e# Create the symlink to /tmp/passwd\u003c/span\u003e\n\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"nb\"\u003eln\u003c/span\u003e \u003cspan class=\"nt\"\u003e-s\u003c/span\u003e /tmp/passwd ./passwd\n\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"nb\"\u003ecd\u003c/span\u003e ../..\n\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"nb\"\u003etar\u003c/span\u003e \u003cspan class=\"nt\"\u003e-czf\u003c/span\u003e export.tar.gz \u003cspan class=\"nt\"\u003e-C\u003c/span\u003e ./export \u003cspan class=\"nb\"\u003e.\u003c/span\u003e\n\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"nb\"\u003etar\u003c/span\u003e \u003cspan class=\"nt\"\u003e-ztvf\u003c/span\u003e export.tar.gz\ndrwxr-xr-x James/wheel       0 2016-08-12 09:34 ./\n\u003cspan class=\"nt\"\u003e-rw-r--r--\u003c/span\u003e James/wheel  318472 2016-08-12 09:34 ./project.bundle\n\u003cspan class=\"nt\"\u003e-rw-r--r--\u003c/span\u003e James/wheel  144235 2016-08-12 09:34 ./project.json\n\u003cspan class=\"nt\"\u003e-rw-r--r--\u003c/span\u003e James/wheel     346 2016-08-12 09:34 ./project.wiki.bundle\ndrwxr-xr-x James/wheel       0 2016-08-12 09:38 ./uploads/\ndrwxr-xr-x James/wheel       0 2016-08-12 09:34 ./uploads/8d5d0e7b3981edb77dc751d41e527302/\n\u003cspan class=\"nt\"\u003e-rw-r--r--\u003c/span\u003e James/wheel     346 2016-08-12 09:34 ./uploads/8d5d0e7b3981edb77dc751d41e527302/project.wiki.bundle\ndrwxr-xr-x James/wheel       0 2016-08-12 09:34 ./uploads/8f32485f7e896b15c62886951b13744f/\n\u003cspan class=\"nt\"\u003e-rw-r--r--\u003c/span\u003e James/wheel  340523 2016-08-12 09:34 ./uploads/8f32485f7e896b15c62886951b13744f/test_project_export.tar.gz\nlrwxr-xr-x James/wheel       0 2016-08-12 09:38 ./uploads/passwd -\u0026gt; /tmp/passwd\n\u003cspan class=\"nt\"\u003e-rw-r--r--\u003c/span\u003e James/wheel       5 2016-08-12 09:34 ./VERSION\n\u003cspan class=\"c\"\u003e# Now, upload that export.tar.gz and export the new imported project\u003c/span\u003e\n\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"nb\"\u003els\u003c/span\u003e \u003cspan class=\"nt\"\u003e-t\u003c/span\u003e ~/Downloads/ | \u003cspan class=\"nb\"\u003ehead\u003c/span\u003e \u003cspan class=\"nt\"\u003e-1\u003c/span\u003e\n2016-08-12_09-45-747_root_test-uploads_export.tar.gz\n\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"nb\"\u003etar\u003c/span\u003e \u003cspan class=\"nt\"\u003e-tzvf\u003c/span\u003e ~/Downloads/2016-08-12_09-45-747_root_test-uploads_export.tar.gz\ndrwxr-xr-x James/staff       0 2016-08-12 09:45 ./\n\u003cspan class=\"nt\"\u003e-rw-r--r--\u003c/span\u003e James/staff  317859 2016-08-12 09:45 ./project.bundle\n\u003cspan class=\"nt\"\u003e-rw-r--r--\u003c/span\u003e James/staff  148058 2016-08-12 09:45 ./project.json\n\u003cspan class=\"nt\"\u003e-rw-r--r--\u003c/span\u003e James/staff     346 2016-08-12 09:45 ./project.wiki.bundle\ndrwxr-xr-x James/staff       0 2016-08-12 09:45 ./uploads/\ndrwxr-xr-x James/staff       0 2016-08-12 09:45 ./uploads/8d5d0e7b3981edb77dc751d41e527302/\n\u003cspan class=\"nt\"\u003e-rw-r--r--\u003c/span\u003e James/staff     346 2016-08-12 09:45 ./uploads/8d5d0e7b3981edb77dc751d41e527302/project.wiki.bundle\ndrwxr-xr-x James/staff       0 2016-08-12 09:45 ./uploads/8f32485f7e896b15c62886951b13744f/\n\u003cspan class=\"nt\"\u003e-rw-r--r--\u003c/span\u003e James/staff  340523 2016-08-12 09:45 ./uploads/8f32485f7e896b15c62886951b13744f/test_project_export.tar.gz\nlrwxr-xr-x James/staff       0 2016-08-12 09:45 ./uploads/passwd -\u0026gt; /tmp/passwd\n\u003cspan class=\"nt\"\u003e-rw-r--r--\u003c/span\u003e James/staff       5 2016-08-12 09:45 ./VERSION\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp\u003eSo it\u0026#39;s a symlink and filesize is indeed 0: \u003ccode\u003e0 2016-08-12 09:45 ./uploads/passwd -\u0026gt; /tmp/passwd\u003c/code\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n","automated_response":false,"created_at":"2016-08-15T21:15:16.656Z","updated_at":"2016-08-15T21:15:16.656Z","actor":{"username":"rspeicher","cleared":false,"url":"/rspeicher","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/070/800/771703800f32dcb0c5413919f04f19305041dd58_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1171095,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @rspeicher, I haven't had time yet to dive into it (I have to set up a GitLab instance of an older version). What's the current state of the feature? Is there anything specific you want me to look at? Happy to provide some comments in a discussion that you might be having.","markdown_message":"\u003cp\u003eHi \u003ca href=\"/rspeicher\"\u003e@rspeicher\u003c/a\u003e, I haven\u0026#39;t had time yet to dive into it (I have to set up a GitLab instance of an older version). What\u0026#39;s the current state of the feature? Is there anything specific you want me to look at? Happy to provide some comments in a discussion that you might be having.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-09-03T07:04:39.715Z","updated_at":"2016-09-03T07:04:39.715Z","actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1268094,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @rspeicher, I looked at the import tonight and filed another report for the vulnerbility: #178152. The vulnerability turned out not to be in the `uploads` directory, but the `VERSION` and `project.json` files. The initially reported vulnerability seems to be fixed and can be closed. I'll request disclosure once #178152 is fixed. Thanks and let me know if you need anything.","markdown_message":"\u003cp\u003eHi \u003ca href=\"/rspeicher\"\u003e@rspeicher\u003c/a\u003e, I looked at the import tonight and filed another report for the vulnerbility: \u003ca href=\"/reports/178152\"\u003e#178152\u003c/a\u003e. The vulnerability turned out not to be in the \u003ccode\u003euploads\u003c/code\u003e directory, but the \u003ccode\u003eVERSION\u003c/code\u003e and \u003ccode\u003eproject.json\u003c/code\u003e files. The initially reported vulnerability seems to be fixed and can be closed. I\u0026#39;ll request disclosure once \u003ca href=\"/reports/178152\"\u003e#178152\u003c/a\u003e is fixed. Thanks and let me know if you need anything.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-10-26T05:52:54.242Z","updated_at":"2016-10-26T05:52:54.242Z","actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1268095,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2016-10-26T05:53:30.491Z","updated_at":"2016-10-26T05:53:30.491Z","additional_data":{"old_severity":null,"new_severity":"Critical (9.9)","old_severity_id":null,"new_severity_id":4265},"actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1268512,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"@jobert Excellent. Well, not really, but... yeah. Thanks! ♥️","markdown_message":"\u003cp\u003e\u003ca href=\"/jobert\"\u003e@jobert\u003c/a\u003e Excellent. Well, not really, but... yeah. Thanks! ♥️\u003c/p\u003e\n","automated_response":false,"created_at":"2016-10-26T12:16:16.809Z","updated_at":"2016-10-26T12:16:16.809Z","actor":{"username":"rspeicher","cleared":false,"url":"/rspeicher","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/070/800/771703800f32dcb0c5413919f04f19305041dd58_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"jobert","url":"/jobert"},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1281496,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Our patch and security announcement have gone live!\n\nhttps://about.gitlab.com/2016/11/02/cve-2016-9086-patches/\n\nThanks so much, Jobert.","markdown_message":"\u003cp\u003eOur patch and security announcement have gone live!\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"https://about.gitlab.com/2016/11/02/cve-2016-9086-patches/\" href=\"/redirect?url=https%3A%2F%2Fabout.gitlab.com%2F2016%2F11%2F02%2Fcve-2016-9086-patches%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://about.gitlab.com/2016/11/02/cve-2016-9086-patches/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eThanks so much, Jobert.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-11-03T00:40:07.806Z","updated_at":"2016-11-03T00:40:07.806Z","first_to_agree":true,"actor":{"username":"briann","cleared":false,"url":"/briann","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1283526,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-11-03T22:28:43.608Z","updated_at":"2016-11-03T22:28:43.608Z","actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1283527,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-11-03T22:28:43.654Z","updated_at":"2016-11-03T22:28:43.654Z","actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}