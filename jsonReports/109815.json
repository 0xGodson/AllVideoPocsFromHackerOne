{"id":109815,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMDk4MTU=","url":"https://hackerone.com/reports/109815","title":"Direct URL access to completed reports","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-01-10T21:39:50.462Z","submitted_at":"2016-01-10T21:39:50.462Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"roshanpty","url":"/roshanpty","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/050/237/ea48df82ad7c243880d400d7a2e0b6585b6f526f_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":104,"url":"https://hackerone.com/coinbase","handle":"coinbase","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/104/b151e01a4adbf5ad9067fc30fb2dfe5d5997fa5c_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/104/b151e01a4adbf5ad9067fc30fb2dfe5d5997fa5c_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Coinbase","twitter_handle":"","website":"https://coinbase.com/security","about":"Creating an open financial system for the world"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2016-03-06T00:57:57.911Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2016-02-05T00:57:37.807Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Access to non-HTML contents such as CSV report is not restricted to authenticated users.\n\nAnyone would be able to access a CSV report by giving the direct URL and downloading it. The URL could be obtained from browser history. The following URL is an example.\n\nhttps://coinbase-tmp.s3.amazonaws.com/f83af6cee5520796d9876723e59225b772abfd89fff6f5d8fee3069f6e4738b07481896312c41d8bf43413a57b5b19a907fb3729f886c336caac8c49d1d302ae/Coinbase-5692a0b23bda9c599f00033e-Transactions-Report-2016-01-10-21%3A31%3A51.csv\n","vulnerability_information_html":"\u003cp\u003eAccess to non-HTML contents such as CSV report is not restricted to authenticated users.\u003c/p\u003e\n\n\u003cp\u003eAnyone would be able to access a CSV report by giving the direct URL and downloading it. The URL could be obtained from browser history. The following URL is an example.\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"https://coinbase-tmp.s3.amazonaws.com/f83af6cee5520796d9876723e59225b772abfd89fff6f5d8fee3069f6e4738b07481896312c41d8bf43413a57b5b19a907fb3729f886c336caac8c49d1d302ae/Coinbase-5692a0b23bda9c599f00033e-Transactions-Report-2016-01-10-21%3A31%3A51.csv\" href=\"/redirect?url=https%3A%2F%2Fcoinbase-tmp.s3.amazonaws.com%2Ff83af6cee5520796d9876723e59225b772abfd89fff6f5d8fee3069f6e4738b07481896312c41d8bf43413a57b5b19a907fb3729f886c336caac8c49d1d302ae%2FCoinbase-5692a0b23bda9c599f00033e-Transactions-Report-2016-01-10-21%253A31%253A51.csv\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://coinbase-tmp.s3.amazonaws.com/f83af6cee5520796d9876723e59225b772abfd89fff6f5d8fee3069f6e4738b07481896312c41d8bf43413a57b5b19a907fb3729f886c336caac8c49d1d302ae/Coinbase-5692a0b23bda9c599f00033e-Transactions-Report-2016-01-10-21%3A31%3A51.csv\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","bounty_amount":"200.0","formatted_bounty":"$200","weakness":{"id":27,"name":"Improper Authentication - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2016-03-06T00:57:38.102Z","allow_singular_disclosure_after":-151989501.68176803,"singular_disclosure_allowed":true,"vote_count":1,"voters":["omarelfarsaoui"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":755744,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thanks for the report, we're going to explore whether we can use signed download links to mitigate this issue.\n","markdown_message":"\u003cp\u003eThanks for the report, we\u0026#39;re going to explore whether we can use signed download links to mitigate this issue.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-01-13T04:39:15.313Z","updated_at":"2016-01-13T04:39:15.313Z","actor":{"username":"coinbase2","cleared":false,"url":"/coinbase2","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":771625,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"We've refactored the reports download mechanism so an authenticated session is required to download a report.\n\nThe fix does not apply retroactively to existing reports. However, reports expire in S3 after 7 days so 7 days from now all reports will require an authenticated session to download.\n\nCan you confirm you're no longer able to reproduce the issue for new reports?","markdown_message":"\u003cp\u003eWe\u0026#39;ve refactored the reports download mechanism so an authenticated session is required to download a report.\u003c/p\u003e\n\n\u003cp\u003eThe fix does not apply retroactively to existing reports. However, reports expire in S3 after 7 days so 7 days from now all reports will require an authenticated session to download.\u003c/p\u003e\n\n\u003cp\u003eCan you confirm you\u0026#39;re no longer able to reproduce the issue for new reports?\u003c/p\u003e\n","automated_response":false,"created_at":"2016-01-25T22:38:13.252Z","updated_at":"2016-01-25T22:38:13.252Z","actor":{"username":"coinbase2","cleared":false,"url":"/coinbase2","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":771922,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello Coinbase team, \n\nLooks like the fix isn't intact. Even newly generated reports can be downloaded without an authentication if the direct URL can be obtained.\n\nTry accessing the following link \nhttps://coinbase-tmp.s3.amazonaws.com/de6154fb5ccca18a6fab5ffae41cfc6fcafffd125a667dec678396418fb82262b5c165cf49ca5c37a07baa9df1bc6fad82562def0d6817c5c83bfeb628674e55/Coinbase-5692a0b23bda9c599f00033e-Transactions-Report-2016-01-26-04%3A28%3A00.csv?X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=AKIAJ2QUFAAIC5QIWRYA%2F20160126%2Fus-east-1%2Fs3%2Faws4_request\u0026X-Amz-Date=20160126T042803Z\u0026X-Amz-Expires=300\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=fdce38a12a35ae9a8f262f4980332dce0006756364f38753acd96828a68ae6e6\n\nI think the issue is happening because the source for the report file isn't the same as coinbase.com.\n\nAs an alternative you may try to include a dynamic token in the download URL, which is generated each time the download button is clicked and is valid only one time or for a short period of time.","markdown_message":"\u003cp\u003eHello Coinbase team, \u003c/p\u003e\n\n\u003cp\u003eLooks like the fix isn\u0026#39;t intact. Even newly generated reports can be downloaded without an authentication if the direct URL can be obtained.\u003c/p\u003e\n\n\u003cp\u003eTry accessing the following link \u003cbr\u003e\n\u003ca title=\"https://coinbase-tmp.s3.amazonaws.com/de6154fb5ccca18a6fab5ffae41cfc6fcafffd125a667dec678396418fb82262b5c165cf49ca5c37a07baa9df1bc6fad82562def0d6817c5c83bfeb628674e55/Coinbase-5692a0b23bda9c599f00033e-Transactions-Report-2016-01-26-04%3A28%3A00.csv?X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=AKIAJ2QUFAAIC5QIWRYA%2F20160126%2Fus-east-1%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20160126T042803Z\u0026amp;X-Amz-Expires=300\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Signature=fdce38a12a35ae9a8f262f4980332dce0006756364f38753acd96828a68ae6e6\" href=\"/redirect?url=https%3A%2F%2Fcoinbase-tmp.s3.amazonaws.com%2Fde6154fb5ccca18a6fab5ffae41cfc6fcafffd125a667dec678396418fb82262b5c165cf49ca5c37a07baa9df1bc6fad82562def0d6817c5c83bfeb628674e55%2FCoinbase-5692a0b23bda9c599f00033e-Transactions-Report-2016-01-26-04%253A28%253A00.csv%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Credential%3DAKIAJ2QUFAAIC5QIWRYA%252F20160126%252Fus-east-1%252Fs3%252Faws4_request%26X-Amz-Date%3D20160126T042803Z%26X-Amz-Expires%3D300%26X-Amz-SignedHeaders%3Dhost%26X-Amz-Signature%3Dfdce38a12a35ae9a8f262f4980332dce0006756364f38753acd96828a68ae6e6\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://coinbase-tmp.s3.amazonaws.com/de6154fb5ccca18a6fab5ffae41cfc6fcafffd125a667dec678396418fb82262b5c165cf49ca5c37a07baa9df1bc6fad82562def0d6817c5c83bfeb628674e55/Coinbase-5692a0b23bda9c599f00033e-Transactions-Report-2016-01-26-04%3A28%3A00.csv?X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=AKIAJ2QUFAAIC5QIWRYA%2F20160126%2Fus-east-1%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20160126T042803Z\u0026amp;X-Amz-Expires=300\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Signature=fdce38a12a35ae9a8f262f4980332dce0006756364f38753acd96828a68ae6e6\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eI think the issue is happening because the source for the report file isn\u0026#39;t the same as coinbase.com.\u003c/p\u003e\n\n\u003cp\u003eAs an alternative you may try to include a dynamic token in the download URL, which is generated each time the download button is clicked and is valid only one time or for a short period of time.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-01-26T04:34:04.135Z","updated_at":"2016-01-26T04:34:04.135Z","actor":{"username":"roshanpty","cleared":false,"url":"/roshanpty","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/050/237/ea48df82ad7c243880d400d7a2e0b6585b6f526f_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":772914,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"That link includes a signed timestamp. It's only valid for 5 minutes (see screenshot for what happens when I try to use it).\n\nI could lower it to one minute, but I think the issue is already essentially fixed at this point.","markdown_message":"\u003cp\u003eThat link includes a signed timestamp. It\u0026#39;s only valid for 5 minutes (see screenshot for what happens when I try to use it).\u003c/p\u003e\n\n\u003cp\u003eI could lower it to one minute, but I think the issue is already essentially fixed at this point.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-01-26T19:02:07.205Z","updated_at":"2016-01-26T19:02:07.205Z","actor":{"username":"coinbase2","cleared":false,"url":"/coinbase2","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":70963,"filename":"Screen_Shot_2016-01-26_at_2.00.07_PM.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/070/963/dfb13464b3f2e86512cc34e87405167bf695cc3a/Screen_Shot_2016-01-26_at_2.00.07_PM.png?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2016-01-26_at_2.00.07_PM.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2016-01-26_at_2.00.07_PM.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ2CQCXB7P%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T041559Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJj%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCKfc9uxh22FGIBSKNqNzEdwAGilNzlyCJlRQkk6L7ywwIgTF9zV46T%2F8NjN%2BIYnxBP9uKa%2FXVMex8eb6F8QfoW3wEqtAMIURABGgwwMTM2MTkyNzQ4NDkiDJ5ZNSNolCYK8UaqCyqRAzNhE%2Fm3zPdEHRm5WUEnZo0COkaeE9dAwJeLRl1TZ11d43Lhd%2FMikAINQoGyi4r4ILldIaNgVmSsjmb0fcorizPel9Yzwr4cFLsZOlxR5w1wIcH9%2B%2FXSVM%2FPyc6y3YiLMP%2BnfwLJ7AL67U%2BsYNgwrwRQCUMORslIWy4Bee0CRE37pQRcD%2BpnBGoZEqEgw%2FHEeFzSipLRBmOXQXxK8U%2FyZbCwKI3Y7jZdrKPqHfhEodvEeD0Wwknnt5JRb8OwCuT7%2BjnXPx7Ftl6fh7ZHEZSimVCNgNXHtQ7MayTMvGyEcE%2FGEdWIy%2BvUTFD59Sbk%2B4fSP5XGoClsVLqX8UQRsOAbpYFv8pGdRWsta2NjZfh4swj28Z1ENJENNBr0wiLwpBy4s4wlkmS86icFZ53iBsI3EOJmZJ5DZ5redWS7l%2BgYoOpzpgENRZcaEYNEAzZuOnjhHMp0RSoAnDuPybSiBCQrW8JftW%2Buq0QzjkbBqzj7nPJ0%2FbXQQzRl4pJZycpxagVMpzjAmvRed9%2BHfODrR1Wa1B9bMPDlqf8FOusBVFGMNirRKMu5AkI7qGagYnYSG4HpDqpKcH5QuM0jUoRkB5r%2BZWkCPAsBHe6t6p0Cfzk0IF3j5b1WbHsN2UHZ8rtF%2BtQ%2F7OawY4eFB8qp9BuOlUA1okg7%2BXvgui2gDL6mFoU2mzqz8v%2BmiFTIaBj8QjYyPX%2Ft4bj%2FyE7%2BzfsRuoeKoPtREJbjscDMF4yK366F0eCTIiw1cnRHt2i638RsSrY3MoN%2BD241aZxfV0getVCLrP4EjZE1CMOAzzhsZEa%2B%2BPrZg0WXd5TN40IoVxY7vjGdJo5rtxp6xBPK%2FbNPk5gPBu93zpBV2vOdiQ%3D%3D\u0026X-Amz-Signature=42197d4858eb080277579d36c8f2569c271f78341be5f1c23d2b96e6cac3ef0c"}],"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":773090,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Yeah I missed that. Looks like the issue is fixed. \u003cthumbs up\u003e","markdown_message":"\u003cp\u003eYeah I missed that. Looks like the issue is fixed. \u0026lt;thumbs up\u0026gt;\u003c/p\u003e\n","automated_response":false,"created_at":"2016-01-26T20:37:54.176Z","updated_at":"2016-01-26T20:37:54.176Z","actor":{"username":"roshanpty","cleared":false,"url":"/roshanpty","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/050/237/ea48df82ad7c243880d400d7a2e0b6585b6f526f_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":774498,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2016-01-27T21:59:41.012Z","updated_at":"2016-01-27T21:59:41.012Z","actor":{"username":"coinbase2","cleared":false,"url":"/coinbase2","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"roshanpty","url":"/roshanpty"},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":774499,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2016-01-27T21:59:57.144Z","updated_at":"2016-01-27T21:59:57.144Z","actor":{"url":"/coinbase","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/104/b151e01a4adbf5ad9067fc30fb2dfe5d5997fa5c_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Coinbase"}},"bounty_amount":"200.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"coinbase","collaborator":{"username":"roshanpty","url":"/roshanpty"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":785695,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-02-05T00:57:37.833Z","updated_at":"2016-02-05T00:57:37.833Z","first_to_agree":true,"actor":{"username":"coinbase2","cleared":false,"url":"/coinbase2","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":825877,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-03-06T00:57:57.941Z","updated_at":"2016-03-06T00:57:57.941Z","actor":{"url":"/coinbase","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/104/b151e01a4adbf5ad9067fc30fb2dfe5d5997fa5c_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Coinbase"}},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":963537,"is_internal":false,"editable":false,"type":"Activities::ExternalUserJoined","message":"","markdown_message":"","automated_response":false,"created_at":"2016-05-18T18:14:18.866Z","updated_at":"2016-05-18T18:14:18.866Z","additional_data":{"duplicate_report_id":139593},"actor":{"username":"lccunha","cleared":false,"url":"/lccunha","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/009/562/b025a5d8b6828835c53bff4cd51b40afe563e00b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":966559,"is_internal":false,"editable":false,"type":"Activities::ExternalUserRemoved","message":"","markdown_message":"","automated_response":false,"created_at":"2016-05-20T15:52:24.835Z","updated_at":"2016-05-20T15:52:24.835Z","actor":{"username":"lccunha","cleared":false,"url":"/lccunha","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/009/562/b025a5d8b6828835c53bff4cd51b40afe563e00b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"removed_user":{"url":"/lccunha","username":"lccunha"},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}