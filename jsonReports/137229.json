{"id":137229,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMzcyMjk=","url":"https://hackerone.com/reports/137229","title":"Dropbox apps Server side request forgery","state":"Closed","substate":"informative","readable_substate":"Informative","created_at":"2016-05-09T07:16:54.381Z","submitted_at":"2016-05-09T07:16:54.381Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"ehsahil","url":"/ehsahil","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/251/64b37a8aad1337d112a542f717364eeddc58cbf8_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":461,"url":"https://hackerone.com/dropbox","handle":"dropbox","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/461/76f193964f418c594dd74ae1326cf4d9223f481b_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/461/76f193964f418c594dd74ae1326cf4d9223f481b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Dropbox","twitter_handle":"","website":"https://www.dropbox.com","about":"Your stuff, anywhere"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2016-05-09T15:47:01.072Z","bug_reporter_agreed_on_going_public_at":"2016-05-09T08:01:51.970Z","team_member_agreed_on_going_public_at":"2016-05-09T15:47:01.009Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi, \n\n**SSRF** is a vulnerability that appears when an attacker has the ability to create requests from the vulnerable server.\n\nUsually, Server Side Request Forgery (SSRF) attacks target internal systems behind the firewall that are normally inaccessible from the outside world (but using SSRF it’s possible to access these systems). With SSRF it’s also possible to access services from the same server that is listening on the loopback interface.\n\nUsing Server Side Request Forgery attacks it’s possible to:\n\n1. Scan and attack systems from the internal network that are not normally accessible\n2. Enumerate and attack services that are running on these hosts\n3. Exploit host-based authentication services\n\nSteps to reproduce: \n\n1. Goto https://www.dropbox.com/developers/apps\n\n2. Create an App. \n\n3. Enter Webhooks URLs and analyse response: \n\n i. http://scanme.nmap.org:80 =\u003e it gives an output (PORT 80 is Open)\n\n ii. http://scanme.nmap.org:1337 =\u003e No output (Port 1337 is closed)\n\n iii. http://nmap.org:22 output gives banner information (SSSH-2.0-OpenSSH_6.6.1\\r\\n)\n\n\nUsing above scenario attacker can do port scanning from dropbox servers. \n\n Please see attached images for Proof of concept. \n\n Thanks \n **@gone**\n","vulnerability_information_html":"\u003cp\u003eHi, \u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eSSRF\u003c/strong\u003e is a vulnerability that appears when an attacker has the ability to create requests from the vulnerable server.\u003c/p\u003e\n\n\u003cp\u003eUsually, Server Side Request Forgery (SSRF) attacks target internal systems behind the firewall that are normally inaccessible from the outside world (but using SSRF it’s possible to access these systems). With SSRF it’s also possible to access services from the same server that is listening on the loopback interface.\u003c/p\u003e\n\n\u003cp\u003eUsing Server Side Request Forgery attacks it’s possible to:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eScan and attack systems from the internal network that are not normally accessible\u003c/li\u003e\n\u003cli\u003eEnumerate and attack services that are running on these hosts\u003c/li\u003e\n\u003cli\u003eExploit host-based authentication services\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eSteps to reproduce: \u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003e\u003cp\u003eGoto \u003ca title=\"https://www.dropbox.com/developers/apps\" href=\"/redirect?url=https%3A%2F%2Fwww.dropbox.com%2Fdevelopers%2Fapps\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.dropbox.com/developers/apps\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eCreate an App. \u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eEnter Webhooks URLs and analyse response: \u003c/p\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003ei. \u003ca title=\"http://scanme.nmap.org\" href=\"/redirect?url=http%3A%2F%2Fscanme.nmap.org\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://scanme.nmap.org\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e =\u0026gt; it gives an output (PORT 80 is Open)\u003c/p\u003e\n\n\u003cp\u003eii. \u003ca title=\"http://scanme.nmap.org:1337\" href=\"/redirect?url=http%3A%2F%2Fscanme.nmap.org%3A1337\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://scanme.nmap.org:1337\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e =\u0026gt; No output (Port 1337 is closed)\u003c/p\u003e\n\n\u003cp\u003eiii. \u003ca title=\"http://nmap.org:22\" href=\"/redirect?url=http%3A%2F%2Fnmap.org%3A22\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://nmap.org:22\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e output gives banner information (SSSH-2.0-OpenSSH_6.6.1\\r\\n)\u003c/p\u003e\n\n\u003cp\u003eUsing above scenario attacker can do port scanning from dropbox servers. \u003c/p\u003e\n\n\u003cp\u003ePlease see attached images for Proof of concept. \u003c/p\u003e\n\n\u003cp\u003eThanks \u003cbr\u003e\n \u003cstrong\u003e@gone\u003c/strong\u003e\u003c/p\u003e\n","weakness":{"id":27,"name":"Improper Authentication - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":92253,"file_name":"Open_Port.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/092/253/984a21ae5cdd8a8d39b470df5f15c20a6b3587e2/Open_Port.png?response-content-disposition=attachment%3B%20filename%3D%22Open_Port.png%22%3B%20filename%2A%3DUTF-8%27%27Open_Port.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQYENXQUKC%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T042648Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHXwr%2Bz%2B7j54GXjIZDeFjE7V4KhtcLVpveDKyRp%2FgHMpAiEA%2FzBLaI4tlPUnNvgzY0X8n68OkDDLSfCBmjTZSd2A%2BM8qtAMIVRABGgwwMTM2MTkyNzQ4NDkiDOLyu53NKIhzdiDnLyqRA1YiznmwUquOZL6cfEwHlrCEbfV1uip5mxrCKpzmpc9DKyYejzEqNMg8%2Fo1XQZiQbQ9Mn8QGMjtqUBvpzsRmfLsdw4KO6Yix26%2Foq9H6jcEfUIX3EyFaY0ofGk42HT5lnakJ%2FUAtv5lyqirA3laDcoq6u60WpxBZh0jLi92Ajs9kGkzDbgWJPXMK2%2FlVglZWa%2BjQNhDftrEqJh4ZV%2FIwfbcJ6s89eju9B4Xkun1IUiVjrUtA5LTMlkDAEwqtGdl3pucepUSB2hZBvbqUfgiT65T%2BpLDNg0LFqEXPPPqqyrYG3%2BqTXIZxR1FfbdXOQjx1UoPwboCHOwSOpOKGaPs6TEM2o6Sg2U%2BGvuy3dMdtNBCfH4SIfBdeUa84eWUftCR4OwBiC0F1Cl6iPIZXa92zkJSAVTz9swPvr%2BghYLYGIjX%2F8jqVGlADsLB1sl%2BqlNRFkwYrvTDOWwnYmDuvQmmhpAQ6Mg%2Fp05v07WKHRsbG%2BAUzVJ3M02i0HIdWCGKjqKXgGZi%2FLBrHUEV9bzaVWmpeFEE3MObUqv8FOusBMEus3670kEKa62xVKQkID%2Fav5Xylzf384wPv9i4fBKmwghqKR67wSDPkErUtnTlN6wJNos0uBd5jibop6zjPh%2BDMaeI%2Bt4z0CbNpMS83WKn2xS%2FvSK0QFyg217PkDWCKklNPmbumtDteHdU2qRRX%2BQwVoTBmoRFgs97OyKXEz2rc7ZIcHuDnAibsNVPNZEuX9m%2B04KKBBkwdIr0sY3zEiVHvTVxPYBSsKfBPuZwzi6W3T3aq%2BF9l860FnFBaV964%2BlbASqZkuTd4cEZ8C2GJad6RyY164GfHgpKnmQ6aYbLhiDTz0xF3adlmhg%3D%3D\u0026X-Amz-Signature=203389d3f803dc10e9df9ee70b53cb19d3192e2522a9e90c15a57e13b9fef92a","file_size":79296,"type":"image/png"},{"id":92254,"file_name":"Closed_Port.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/092/254/a37904ed97435a45e7bbf73d21eeb19ff0fcdfde/Closed_Port.png?response-content-disposition=attachment%3B%20filename%3D%22Closed_Port.png%22%3B%20filename%2A%3DUTF-8%27%27Closed_Port.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQYENXQUKC%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T042648Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHXwr%2Bz%2B7j54GXjIZDeFjE7V4KhtcLVpveDKyRp%2FgHMpAiEA%2FzBLaI4tlPUnNvgzY0X8n68OkDDLSfCBmjTZSd2A%2BM8qtAMIVRABGgwwMTM2MTkyNzQ4NDkiDOLyu53NKIhzdiDnLyqRA1YiznmwUquOZL6cfEwHlrCEbfV1uip5mxrCKpzmpc9DKyYejzEqNMg8%2Fo1XQZiQbQ9Mn8QGMjtqUBvpzsRmfLsdw4KO6Yix26%2Foq9H6jcEfUIX3EyFaY0ofGk42HT5lnakJ%2FUAtv5lyqirA3laDcoq6u60WpxBZh0jLi92Ajs9kGkzDbgWJPXMK2%2FlVglZWa%2BjQNhDftrEqJh4ZV%2FIwfbcJ6s89eju9B4Xkun1IUiVjrUtA5LTMlkDAEwqtGdl3pucepUSB2hZBvbqUfgiT65T%2BpLDNg0LFqEXPPPqqyrYG3%2BqTXIZxR1FfbdXOQjx1UoPwboCHOwSOpOKGaPs6TEM2o6Sg2U%2BGvuy3dMdtNBCfH4SIfBdeUa84eWUftCR4OwBiC0F1Cl6iPIZXa92zkJSAVTz9swPvr%2BghYLYGIjX%2F8jqVGlADsLB1sl%2BqlNRFkwYrvTDOWwnYmDuvQmmhpAQ6Mg%2Fp05v07WKHRsbG%2BAUzVJ3M02i0HIdWCGKjqKXgGZi%2FLBrHUEV9bzaVWmpeFEE3MObUqv8FOusBMEus3670kEKa62xVKQkID%2Fav5Xylzf384wPv9i4fBKmwghqKR67wSDPkErUtnTlN6wJNos0uBd5jibop6zjPh%2BDMaeI%2Bt4z0CbNpMS83WKn2xS%2FvSK0QFyg217PkDWCKklNPmbumtDteHdU2qRRX%2BQwVoTBmoRFgs97OyKXEz2rc7ZIcHuDnAibsNVPNZEuX9m%2B04KKBBkwdIr0sY3zEiVHvTVxPYBSsKfBPuZwzi6W3T3aq%2BF9l860FnFBaV964%2BlbASqZkuTd4cEZ8C2GJad6RyY164GfHgpKnmQ6aYbLhiDTz0xF3adlmhg%3D%3D\u0026X-Amz-Signature=34b3d3bad7483d657441b728af503b6c14520640ebb67adfdbbb5df90051ffcd","file_size":44267,"type":"image/png"},{"id":92255,"file_name":"Open_port_with_banner.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/092/255/ab805fb0a3a23fc2e6d700c1ffaf03544f17e373/Open_port_with_banner.png?response-content-disposition=attachment%3B%20filename%3D%22Open_port_with_banner.png%22%3B%20filename%2A%3DUTF-8%27%27Open_port_with_banner.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQYENXQUKC%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T042648Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHXwr%2Bz%2B7j54GXjIZDeFjE7V4KhtcLVpveDKyRp%2FgHMpAiEA%2FzBLaI4tlPUnNvgzY0X8n68OkDDLSfCBmjTZSd2A%2BM8qtAMIVRABGgwwMTM2MTkyNzQ4NDkiDOLyu53NKIhzdiDnLyqRA1YiznmwUquOZL6cfEwHlrCEbfV1uip5mxrCKpzmpc9DKyYejzEqNMg8%2Fo1XQZiQbQ9Mn8QGMjtqUBvpzsRmfLsdw4KO6Yix26%2Foq9H6jcEfUIX3EyFaY0ofGk42HT5lnakJ%2FUAtv5lyqirA3laDcoq6u60WpxBZh0jLi92Ajs9kGkzDbgWJPXMK2%2FlVglZWa%2BjQNhDftrEqJh4ZV%2FIwfbcJ6s89eju9B4Xkun1IUiVjrUtA5LTMlkDAEwqtGdl3pucepUSB2hZBvbqUfgiT65T%2BpLDNg0LFqEXPPPqqyrYG3%2BqTXIZxR1FfbdXOQjx1UoPwboCHOwSOpOKGaPs6TEM2o6Sg2U%2BGvuy3dMdtNBCfH4SIfBdeUa84eWUftCR4OwBiC0F1Cl6iPIZXa92zkJSAVTz9swPvr%2BghYLYGIjX%2F8jqVGlADsLB1sl%2BqlNRFkwYrvTDOWwnYmDuvQmmhpAQ6Mg%2Fp05v07WKHRsbG%2BAUzVJ3M02i0HIdWCGKjqKXgGZi%2FLBrHUEV9bzaVWmpeFEE3MObUqv8FOusBMEus3670kEKa62xVKQkID%2Fav5Xylzf384wPv9i4fBKmwghqKR67wSDPkErUtnTlN6wJNos0uBd5jibop6zjPh%2BDMaeI%2Bt4z0CbNpMS83WKn2xS%2FvSK0QFyg217PkDWCKklNPmbumtDteHdU2qRRX%2BQwVoTBmoRFgs97OyKXEz2rc7ZIcHuDnAibsNVPNZEuX9m%2B04KKBBkwdIr0sY3zEiVHvTVxPYBSsKfBPuZwzi6W3T3aq%2BF9l860FnFBaV964%2BlbASqZkuTd4cEZ8C2GJad6RyY164GfHgpKnmQ6aYbLhiDTz0xF3adlmhg%3D%3D\u0026X-Amz-Signature=9b679222e14b3dea7db380acf7eff208939b5d59e289a581b559b837d2be7834","file_size":72581,"type":"image/png"}],"allow_singular_disclosure_at":"2016-06-08T08:01:52.045Z","allow_singular_disclosure_after":-143843096.0159879,"singular_disclosure_allowed":true,"vote_count":5,"voters":["eveeez","lordjerry0x01","ehsahil","spetr0x","dyabla"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":946513,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"Thanks! We are aware of this and this is needed functionality. We are willing to accept the risk here","markdown_message":"\u003cp\u003eThanks! We are aware of this and this is needed functionality. We are willing to accept the risk here\u003c/p\u003e\n","automated_response":false,"created_at":"2016-05-09T07:23:11.936Z","updated_at":"2016-05-09T07:23:11.936Z","actor":{"username":"devd","cleared":false,"url":"/devd","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/012/376/241e11c4ddebe1e81cd547edaae1532bbed268aa_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"dropbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":946555,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Hi @devd, \n\nOhh alright, lets disclose this one. \n\nThanks \n@gone","markdown_message":"\u003cp\u003eHi \u003ca href=\"/devd\"\u003e@devd\u003c/a\u003e, \u003c/p\u003e\n\n\u003cp\u003eOhh alright, lets disclose this one. \u003c/p\u003e\n\n\u003cp\u003eThanks \u003cbr\u003e\n\u003ca href=\"/gone\"\u003e@gone\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2016-05-09T08:01:51.994Z","updated_at":"2016-05-09T08:01:51.994Z","first_to_agree":true,"actor":{"username":"ehsahil","cleared":true,"url":"/ehsahil","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/251/64b37a8aad1337d112a542f717364eeddc58cbf8_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"dropbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":947191,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-05-09T15:47:01.029Z","updated_at":"2016-05-09T15:47:01.029Z","actor":{"username":"devd","cleared":false,"url":"/devd","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/012/376/241e11c4ddebe1e81cd547edaae1532bbed268aa_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"dropbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":947192,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-05-09T15:47:01.098Z","updated_at":"2016-05-09T15:47:01.098Z","actor":{"username":"devd","cleared":false,"url":"/devd","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/012/376/241e11c4ddebe1e81cd547edaae1532bbed268aa_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"dropbox","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}