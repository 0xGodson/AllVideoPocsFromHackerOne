{"id":35363,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zNTM2Mw==","url":"https://hackerone.com/reports/35363","title":"[static.qiwi.com] XSS proxy.html","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2014-11-13T09:54:09.968Z","submitted_at":"2014-11-13T09:54:09.968Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"smiegles","url":"/smiegles","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/045/1828acf6bd0443abccd1796fb54be386d874708c_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":215,"url":"https://hackerone.com/qiwi","handle":"qiwi","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/215/f578bbb9421365fab2e51aa7482bea82006d7c0c_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/215/f578bbb9421365fab2e51aa7482bea82006d7c0c_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"QIWI","twitter_handle":"QiwiRussia","website":"https://qiwi.com","about":"The QIWI brand is a family brand that consolidates several directions: kiosks, wallet, bank and even terminals of goods delivery."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2014-12-27T12:37:20.525Z","bug_reporter_agreed_on_going_public_at":"2014-11-27T12:37:08.631Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi,\r\n\r\nhttps://static.qiwi.com/respond/proxy.html contains a Cross-site scripting. \r\n\r\n```\r\n      query = getQueryString();\r\n        css = query[\"css\"];\r\n        domain = query[\"url\"];\r\n\r\n        if (css \u0026\u0026 domain) {\r\n            ajax(css, function (response) {\r\n                window.name = response;\r\n                window.location.href = domain; // this line here is vulnerable to Cross-site scripting.\r\n            });\r\n        }\r\n```\r\nAs you can see, it looks if two get varables are available (css and url) if they both are it requests the css parameter through ajax and then redirects the user to the ?url variable which is vulnerable for Cross-site scripting.\r\n\r\nPOC: https://static.qiwi.com/respond/proxy.html?css=http://olivierbeg.nl/xss/xss.php\u0026url=javascript:alert(1)\r\n\r\nBest regards,\r\n\r\nOlivier Beg","vulnerability_information_html":"\u003cp\u003eHi,\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"https://static.qiwi.com/respond/proxy.html\" href=\"/redirect?url=https%3A%2F%2Fstatic.qiwi.com%2Frespond%2Fproxy.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://static.qiwi.com/respond/proxy.html\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e contains a Cross-site scripting. \u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e      query = getQueryString();\n        css = query[\u0026quot;css\u0026quot;];\n        domain = query[\u0026quot;url\u0026quot;];\n\n        if (css \u0026amp;\u0026amp; domain) {\n            ajax(css, function (response) {\n                window.name = response;\n                window.location.href = domain; // this line here is vulnerable to Cross-site scripting.\n            });\n        }\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eAs you can see, it looks if two get varables are available (css and url) if they both are it requests the css parameter through ajax and then redirects the user to the ?url variable which is vulnerable for Cross-site scripting.\u003c/p\u003e\n\n\u003cp\u003ePOC: \u003ca title=\"https://static.qiwi.com/respond/proxy.html?css=http://olivierbeg.nl/xss/xss.php\u0026amp;url=javascript:alert(1)\" href=\"/redirect?url=https%3A%2F%2Fstatic.qiwi.com%2Frespond%2Fproxy.html%3Fcss%3Dhttp%3A%2F%2Folivierbeg.nl%2Fxss%2Fxss.php%26url%3Djavascript%3Aalert%281%29\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://static.qiwi.com/respond/proxy.html?css=http://olivierbeg.nl/xss/xss.php\u0026amp;url=javascript:alert(1)\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eBest regards,\u003c/p\u003e\n\n\u003cp\u003eOlivier Beg\u003c/p\u003e\n","bounty_amount":"200.0","formatted_bounty":"$200","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2014-12-27T12:37:08.765Z","allow_singular_disclosure_after":-189536668.70137835,"singular_disclosure_allowed":true,"vote_count":1,"voters":["margotrobbie"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":161802,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Sorry, can't reproduce impact. Please, provide additional information.\nAutomated vulnerability scanners commonly have low priority issues and/or false positives. Before submitting the results from a scanner, please take a moment to confirm that the reported issues are actually valid and exploitable. Please reply if you have a working proof-of-concept or reason to believe that this issue is exploitable.\n","markdown_message":"\u003cp\u003eSorry, can\u0026#39;t reproduce impact. Please, provide additional information.\u003cbr\u003e\nAutomated vulnerability scanners commonly have low priority issues and/or false positives. Before submitting the results from a scanner, please take a moment to confirm that the reported issues are actually valid and exploitable. Please reply if you have a working proof-of-concept or reason to believe that this issue is exploitable.\u003c/p\u003e\n","automated_response":false,"created_at":"2014-11-17T10:31:38.065Z","updated_at":"2014-11-17T10:31:38.065Z","actor":{"username":"isox","cleared":false,"url":"/isox","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/006/507/53ee156fd5b0b3b9a7bbc254dad1b482e30537ff_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"qiwi","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":161803,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Hello,\n\nYou can reproduce this issue, just visit https://static.qiwi.com/respond/proxy.html?css=http://olivierbeg.nl/xss/xss.php\u0026url=javascript:alert(1) It's not that hard. You will see the alert popping up.\n\nBy the way. I don't use vulnerability scanners and this reply feels a bit like an insult.\n\nBest regards,\n\nOlivier Beg","markdown_message":"\u003cp\u003eHello,\u003c/p\u003e\n\n\u003cp\u003eYou can reproduce this issue, just visit \u003ca title=\"https://static.qiwi.com/respond/proxy.html?css=http://olivierbeg.nl/xss/xss.php\u0026amp;url=javascript:alert(1)\" href=\"/redirect?url=https%3A%2F%2Fstatic.qiwi.com%2Frespond%2Fproxy.html%3Fcss%3Dhttp%3A%2F%2Folivierbeg.nl%2Fxss%2Fxss.php%26url%3Djavascript%3Aalert%281%29\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://static.qiwi.com/respond/proxy.html?css=http://olivierbeg.nl/xss/xss.php\u0026amp;url=javascript:alert(1)\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e It\u0026#39;s not that hard. You will see the alert popping up.\u003c/p\u003e\n\n\u003cp\u003eBy the way. I don\u0026#39;t use vulnerability scanners and this reply feels a bit like an insult.\u003c/p\u003e\n\n\u003cp\u003eBest regards,\u003c/p\u003e\n\n\u003cp\u003eOlivier Beg\u003c/p\u003e\n","automated_response":false,"created_at":"2014-11-17T10:37:16.295Z","updated_at":"2014-11-17T10:37:16.295Z","actor":{"username":"smiegles","cleared":true,"url":"/smiegles","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/045/1828acf6bd0443abccd1796fb54be386d874708c_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"qiwi","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":161805,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hello, again!\nThanks, reproduced in Safari browser.\n","markdown_message":"\u003cp\u003eHello, again!\u003cbr\u003e\nThanks, reproduced in Safari browser.\u003c/p\u003e\n","automated_response":false,"created_at":"2014-11-17T10:46:40.667Z","updated_at":"2014-11-17T10:46:40.667Z","actor":{"username":"isox","cleared":false,"url":"/isox","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/006/507/53ee156fd5b0b3b9a7bbc254dad1b482e30537ff_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"qiwi","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":161806,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"By the way, it does not reproduce in latest Chrome \u0026 Firefox.","markdown_message":"\u003cp\u003eBy the way, it does not reproduce in latest Chrome \u0026amp; Firefox.\u003c/p\u003e\n","automated_response":false,"created_at":"2014-11-17T10:47:38.758Z","updated_at":"2014-11-17T10:47:38.758Z","actor":{"username":"isox","cleared":false,"url":"/isox","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/006/507/53ee156fd5b0b3b9a7bbc254dad1b482e30537ff_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"qiwi","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":161807,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi,\n\nIt does here..\n\nBest regards,\n\nOlivier Beg","markdown_message":"\u003cp\u003eHi,\u003c/p\u003e\n\n\u003cp\u003eIt does here..\u003c/p\u003e\n\n\u003cp\u003eBest regards,\u003c/p\u003e\n\n\u003cp\u003eOlivier Beg\u003c/p\u003e\n","automated_response":false,"created_at":"2014-11-17T10:48:48.789Z","updated_at":"2014-11-17T10:48:48.789Z","actor":{"username":"smiegles","cleared":true,"url":"/smiegles","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/045/1828acf6bd0443abccd1796fb54be386d874708c_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":20883,"filename":"does_here.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/020/883/4d3df8b8a97fff524fdbdf54221c29d57eea0f79/does_here.png?response-content-disposition=attachment%3B%20filename%3D%22does_here.png%22%3B%20filename%2A%3DUTF-8%27%27does_here.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQTGH7D7G4%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T054137Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIF3bZwIuJVbBath9RBAagycfg6N290U9MaBDwIhhNMqjAiEA5QJFTUjUu%2BelINQ8mBSRMtPAJunx%2FkQdIQYoGvxoAn0qtAMIVRABGgwwMTM2MTkyNzQ4NDkiDKWCtAdrSoxlUzEo5CqRA2KbCK2gb0cQjXvMxG7rxH%2BqkR2WSbvaIs%2FZazFNKw1eZW2WrZTy5Q04uSJp6R8rbsBzRSLIFhyP9QTQMq5P15qLdwXnZbOxNVoADzWwgfUfGt%2BOwI%2BEjM3ovXNd1aGU0Ee1TBGk3LBN3uQ8ppV7Xii57PrmCtM4dm9usXbAaaa8f8QiQFPH1YTkHf%2FPe1cgMlFNJFqSrmu3ZMinUb9pxpphywkYT29wP%2Fak4Sy9A3St63iqnDzi8wrdG9%2FGdB7M03pSeaVTcH99G5j%2FqMpFpJxYN8TNlglA1OWgt7QlVOqnq65zCp4szGmwzF1FrjkS%2Bp3wB27lGxlw0v79ozRdwRBFBFvrSgSeToK8vpEBIlnO4uogSsVneM6zoYfyQw3%2F6HqcPg9mVWJmJS4QLMpQTMd%2FMeYn%2F%2Ffl2Vt%2Bb0X2rNtQPeWMGpzHpq6XAiCjZ%2F33fJuN%2B3j9Lmo023GSXKu%2B%2FkZTBp3waVREDqE%2BNeB30X8ZT5%2BW0bqtpGbJe8ig5jtSZzprCWg9v84Utvz3uaa%2Bcjz7MJPPqv8FOusBEHCYkRstnRk5lzIXoX3CRWjAJcL61b1gmhmecG%2Fow23IgJkGaQ5%2B%2FkCWvGrt4rLn9BlUKR84X6ifbCLPwMQevITvtVqg1wdT%2FzOjUyHnqnZVOyLFoqLXk9MNjw1VTb%2FmSNp%2Bd5NsBD5KiAAd50U1%2F1jl5yoSrl0DpEi6Yzv0bFigmUQPNRZeTImBJ2V75RxXBbDSoevWuBT70W%2F8%2BsoyTMqti7McilmsidA1BnI1f8HDTyMQGIoexlo%2BO7e5AiNtCUboKL2ZiertWXe5cEVF9mAVgHpVtz7pIIElyyZjsKslJzP%2B5WRhYUkMYg%3D%3D\u0026X-Amz-Signature=33dddda148670483f97355a93932c883a3812febd6624ed7d18d2cfe4abbfb75"}],"genius_execution_id":null,"team_handle":"qiwi","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":161810,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Anyway, thanks :) Sorry for template response :)","markdown_message":"\u003cp\u003eAnyway, thanks :) Sorry for template response :)\u003c/p\u003e\n","automated_response":false,"created_at":"2014-11-17T10:53:05.943Z","updated_at":"2014-11-17T10:53:05.943Z","actor":{"username":"isox","cleared":false,"url":"/isox","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/006/507/53ee156fd5b0b3b9a7bbc254dad1b482e30537ff_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"qiwi","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":161814,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Can happen, thanks for respondig so fast :-)","markdown_message":"\u003cp\u003eCan happen, thanks for respondig so fast :-)\u003c/p\u003e\n","automated_response":false,"created_at":"2014-11-17T10:56:44.759Z","updated_at":"2014-11-17T10:56:44.759Z","actor":{"username":"smiegles","cleared":true,"url":"/smiegles","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/045/1828acf6bd0443abccd1796fb54be386d874708c_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"qiwi","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":161892,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2014-11-17T12:51:17.091Z","updated_at":"2014-11-17T12:51:17.091Z","additional_data":{"old_title":"https://static.qiwi.com proxy Cross-site scripting","new_title":"[static.qiwi.com] XSS proxy.html"},"actor":{"username":"isox","cleared":false,"url":"/isox","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/006/507/53ee156fd5b0b3b9a7bbc254dad1b482e30537ff_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"qiwi","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":168857,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2014-11-27T12:33:47.273Z","updated_at":"2014-11-27T12:33:47.273Z","actor":{"username":"isox","cleared":false,"url":"/isox","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/006/507/53ee156fd5b0b3b9a7bbc254dad1b482e30537ff_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"smiegles","url":"/smiegles"},"genius_execution_id":null,"team_handle":"qiwi","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":168858,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2014-11-27T12:33:54.778Z","updated_at":"2014-11-27T12:33:54.778Z","actor":{"url":"/qiwi","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/215/f578bbb9421365fab2e51aa7482bea82006d7c0c_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"QIWI"}},"bounty_amount":"200.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"qiwi","collaborator":{"username":"smiegles","url":"/smiegles"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":168860,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Awesome, thanks!","markdown_message":"\u003cp\u003eAwesome, thanks!\u003c/p\u003e\n","automated_response":false,"created_at":"2014-11-27T12:37:08.644Z","updated_at":"2014-11-27T12:37:08.644Z","first_to_agree":true,"actor":{"username":"smiegles","cleared":true,"url":"/smiegles","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/045/1828acf6bd0443abccd1796fb54be386d874708c_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"qiwi","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":188234,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2014-12-27T12:37:20.563Z","updated_at":"2014-12-27T12:37:20.563Z","actor":{"url":"/qiwi","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/215/f578bbb9421365fab2e51aa7482bea82006d7c0c_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"QIWI"}},"genius_execution_id":null,"team_handle":"qiwi","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}