{"id":226756,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMjY3NTY=","url":"https://hackerone.com/reports/226756","title":"local file disclosure via FFmpeg hls processing","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2017-05-07T17:41:17.701Z","submitted_at":"2017-05-07T17:41:17.701Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"neex","url":"/neex","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/014/987/69159fe64cb5f951b5b761f0d55ea5e8630a22a4_original.gif/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1254,"url":"https://hackerone.com/vkcom","handle":"vkcom","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/254/4d3964b90290d02f3b41d23a1452c08ca77eec3e_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/254/4d3964b90290d02f3b41d23a1452c08ca77eec3e_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"VK.com","twitter_handle":"vkontakte","website":"https://vk.com","about":"VK is the largest European social network with more than a 100 million active users."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"no-content","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-06-24T01:35:53.031Z","bug_reporter_agreed_on_going_public_at":"2017-05-25T01:35:38.753Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"","vulnerability_information_html":"","bounty_amount":"1000.0","formatted_bounty":"$1,000","weakness":{"id":18,"name":"Information Disclosure"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2017-06-24T01:35:38.808Z","allow_singular_disclosure_after":-110950054.51234521,"singular_disclosure_allowed":true,"vote_count":73,"voters":["rodney","irek","jensec","cdl","secator","hunter","inhibitor181","bl4de","ramsexy","bogdantcaciuc","and 63 more..."],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1659893,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2017-05-08T09:57:31.654Z","updated_at":"2017-05-08T09:57:31.654Z","actor":{"username":"exe","cleared":false,"url":"/exe","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/058/768/cb3119e614f25ed716db2258fd649c2cd62b29b1_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vkcom","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1659970,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2017-05-08T10:36:55.238Z","updated_at":"2017-05-08T10:36:55.238Z","actor":{"username":"exe","cleared":false,"url":"/exe","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/058/768/cb3119e614f25ed716db2258fd649c2cd62b29b1_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"neex","url":"/neex"},"genius_execution_id":null,"team_handle":"vkcom","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1660073,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2017-05-08T11:46:40.404Z","updated_at":"2017-05-08T11:47:18.934Z","actor":{"username":"neex","cleared":false,"url":"/neex","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/987/69159fe64cb5f951b5b761f0d55ea5e8630a22a4_original.gif/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vkcom","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1662672,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2017-05-09T09:38:42.539Z","updated_at":"2017-05-09T09:38:42.539Z","actor":{"username":"exe","cleared":false,"url":"/exe","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/058/768/cb3119e614f25ed716db2258fd649c2cd62b29b1_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vkcom","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1663079,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2017-05-09T13:08:42.980Z","updated_at":"2017-05-09T13:08:42.980Z","actor":{"username":"neex","cleared":false,"url":"/neex","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/987/69159fe64cb5f951b5b761f0d55ea5e8630a22a4_original.gif/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vkcom","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1678273,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2017-05-16T19:48:03.045Z","updated_at":"2017-05-16T19:51:53.851Z","actor":{"username":"neex","cleared":false,"url":"/neex","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/987/69159fe64cb5f951b5b761f0d55ea5e8630a22a4_original.gif/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vkcom","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1689647,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2017-05-21T10:00:49.109Z","updated_at":"2017-05-21T10:00:49.109Z","actor":{"username":"exe","cleared":false,"url":"/exe","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/058/768/cb3119e614f25ed716db2258fd649c2cd62b29b1_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vkcom","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1689648,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2017-05-21T10:01:07.755Z","updated_at":"2017-05-21T10:01:07.755Z","actor":{"url":"/vkcom","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/254/4d3964b90290d02f3b41d23a1452c08ca77eec3e_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"VK.com"}},"bounty_amount":"1000.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"vkcom","collaborator":{"username":"neex","url":"/neex"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1699592,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-05-25T01:35:38.771Z","updated_at":"2017-05-25T01:35:38.771Z","first_to_agree":true,"actor":{"username":"neex","cleared":false,"url":"/neex","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/987/69159fe64cb5f951b5b761f0d55ea5e8630a22a4_original.gif/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vkcom","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1778153,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-06-24T01:35:53.058Z","updated_at":"2017-06-24T01:35:53.058Z","actor":{"url":"/vkcom","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/254/4d3964b90290d02f3b41d23a1452c08ca77eec3e_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"VK.com"}},"genius_execution_id":null,"team_handle":"vkcom","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":4568,"category":"team","content":"Vulnerability in FFmpeg. ","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eVulnerability in FFmpeg. \u003c/p\u003e\n"},{"id":4569,"category":"researcher","content":"FFmpeg is video encoding software that is used by VK for preview generation and video conversion. FFmpeg is known to process HLS playlists that may contain references to external files. I was able to fire this feature using GAB2 subtitle chunks inside an AVI file. After that, I was able to retrieve conversion nodes' local files via XBIN codec, resulting in nice hackerish videos with file contents.\n\nThis issue was disclosed among others at Phdays conference 2017,  the slides are available at https://docs.google.com/presentation/d/1yqWy_aE3dQNXAhW8kxMxRqtP7qMHaIfMzUDpEqFneos/edit, the screenshot of this particular issue (that is, the screenshot of the video showing `/etc/passwd` from a VK server)  is near the end of the presentation.","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eFFmpeg is video encoding software that is used by VK for preview generation and video conversion. FFmpeg is known to process HLS playlists that may contain references to external files. I was able to fire this feature using GAB2 subtitle chunks inside an AVI file. After that, I was able to retrieve conversion nodes\u0026#39; local files via XBIN codec, resulting in nice hackerish videos with file contents.\u003c/p\u003e\n\n\u003cp\u003eThis issue was disclosed among others at Phdays conference 2017,  the slides are available at \u003ca title=\"https://docs.google.com/presentation/d/1yqWy_aE3dQNXAhW8kxMxRqtP7qMHaIfMzUDpEqFneos/edit\" href=\"/redirect?url=https%3A%2F%2Fdocs.google.com%2Fpresentation%2Fd%2F1yqWy_aE3dQNXAhW8kxMxRqtP7qMHaIfMzUDpEqFneos%2Fedit\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://docs.google.com/presentation/d/1yqWy_aE3dQNXAhW8kxMxRqtP7qMHaIfMzUDpEqFneos/edit\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e, the screenshot of this particular issue (that is, the screenshot of the video showing \u003ccode\u003e/etc/passwd\u003c/code\u003e from a VK server)  is near the end of the presentation.\u003c/p\u003e\n"}]}