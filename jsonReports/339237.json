{"id":339237,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zMzkyMzc=","url":"https://hackerone.com/reports/339237","title":"[web.icq.com] Stored XSS in link when sending message","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2018-04-16T19:48:10.099Z","submitted_at":"2018-04-16T19:48:10.099Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"flamezzz","url":"/flamezzz","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":65,"url":"https://hackerone.com/mailru","handle":"mailru","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/065/1ec04a6b87b02422d913b5c53d5247de91d64718_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/065/1ec04a6b87b02422d913b5c53d5247de91d64718_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Mail.ru","twitter_handle":"mailru","website":"https://corp.mail.ru","about":"Building the Internet since 1998"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2018-10-01T10:13:13.089Z","bug_reporter_agreed_on_going_public_at":"2018-10-01T10:13:13.001Z","team_member_agreed_on_going_public_at":"2018-10-01T09:58:50.756Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Domain, site, application\n--\nhttps://web.icq.com/\n\n\nTesting environment\n--\nChrome\n\nSteps to reproduce\n--\n1) Enter a chat\n2) Send the following message:\n\n``https://www.google.com/\"onmouseover=\"javascript:prompt()\"``\n\n3) Hover the link\n\nActual results\n--\n\nXSS prompt shows.\n\nExpected results, security impact description and recommendations\n--\n\n\nThe **\"** character should be sanitized.\n\nPoC, exploit code, screenshots, video, references, additional resources\n--\n\n## Impact\n\nIf a victim opens a message and hovers this link, the attacker can perform actions on behalf of the victim (modify account info etc).\n\nThe hacker selected the **Cross-site Scripting (XSS) - Stored** weakness. This vulnerability type requires contextual information from the hacker. They provided the following answers:\n\n**URL**\nhttps://web.icq.com/\n\n**Verified**\nYes\n\n","vulnerability_information_html":"\u003ch2 id=\"domain-site-application\"\u003eDomain, site, application\u003c/h2\u003e\n\n\u003cp\u003e\u003ca title=\"https://web.icq.com/\" href=\"/redirect?url=https%3A%2F%2Fweb.icq.com%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://web.icq.com/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2 id=\"testing-environment\"\u003eTesting environment\u003c/h2\u003e\n\n\u003cp\u003eChrome\u003c/p\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps to reproduce\u003c/h2\u003e\n\n\u003cp\u003e1) Enter a chat\u003cbr\u003e\n2) Send the following message:\u003c/p\u003e\n\n\u003cp\u003e\u003ccode\u003ehttps://www.google.com/\u0026quot;onmouseover=\u0026quot;javascript:prompt()\u0026quot;\u003c/code\u003e\u003c/p\u003e\n\n\u003cp\u003e3) Hover the link\u003c/p\u003e\n\n\u003ch2 id=\"actual-results\"\u003eActual results\u003c/h2\u003e\n\n\u003cp\u003eXSS prompt shows.\u003c/p\u003e\n\n\u003ch2 id=\"expected-results-security-impact-description-and-recommendations\"\u003eExpected results, security impact description and recommendations\u003c/h2\u003e\n\n\u003cp\u003eThe \u003cstrong\u003e\u0026quot;\u003c/strong\u003e character should be sanitized.\u003c/p\u003e\n\n\u003ch2 id=\"poc-exploit-code-screenshots-video-references-additional-resources\"\u003ePoC, exploit code, screenshots, video, references, additional resources\u003c/h2\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eIf a victim opens a message and hovers this link, the attacker can perform actions on behalf of the victim (modify account info etc).\u003c/p\u003e\n\n\u003cp\u003eThe hacker selected the \u003cstrong\u003eCross-site Scripting (XSS) - Stored\u003c/strong\u003e weakness. This vulnerability type requires contextual information from the hacker. They provided the following answers:\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eURL\u003c/strong\u003e\u003cbr\u003e\n\u003ca title=\"https://web.icq.com/\" href=\"/redirect?url=https%3A%2F%2Fweb.icq.com%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://web.icq.com/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eVerified\u003c/strong\u003e\u003cbr\u003e\nYes\u003c/p\u003e\n","bounty_amount":"250.0","formatted_bounty":"$250","weakness":{"id":62,"name":"Cross-site Scripting (XSS) - Stored"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2018-10-31T09:58:50.881Z","allow_singular_disclosure_after":-68240386.97741301,"singular_disclosure_allowed":true,"vote_count":11,"voters":["flashdisk","mygf","eveeez","japz","cryptographer","spid3rs_","danish8418","jatacheers","andi95","lilbradley","and 1 more..."],"severity":{"rating":"high","author_type":"Team"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":2620966,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Hi,\nis it self-XSS or you can use it against different account?","markdown_message":"\u003cp\u003eHi,\u003cbr\u003e\nis it self-XSS or you can use it against different account?\u003c/p\u003e\n","automated_response":false,"created_at":"2018-04-16T21:11:02.097Z","updated_at":"2018-04-16T21:11:02.097Z","actor":{"username":"3apa3a","cleared":false,"url":"/3apa3a","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/836/57b93fd96b524d0ed13eef717ecd070ad8468f86_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2621037,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Hi @3apa3a\n\nI've tested this using 2 accounts, it's stored and triggers on another account","markdown_message":"\u003cp\u003eHi \u003ca href=\"/3apa3a\"\u003e@3apa3a\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eI\u0026#39;ve tested this using 2 accounts, it\u0026#39;s stored and triggers on another account\u003c/p\u003e\n","automated_response":false,"created_at":"2018-04-16T21:45:16.857Z","updated_at":"2018-04-16T21:45:16.857Z","actor":{"username":"flamezzz","cleared":true,"url":"/flamezzz","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2621970,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2018-04-17T07:11:59.324Z","updated_at":"2018-04-17T07:11:59.324Z","actor":{"username":"tah0aec4","cleared":false,"url":"/tah0aec4","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2621997,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2018-04-17T07:23:47.392Z","updated_at":"2018-04-17T07:23:47.392Z","additional_data":{"old_severity":null,"new_severity":"High","old_severity_id":null,"new_severity_id":141665},"actor":{"username":"tah0aec4","cleared":false,"url":"/tah0aec4","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2621998,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"We are currently reviewing your submission and will be back in touch soon.","markdown_message":"\u003cp\u003eWe are currently reviewing your submission and will be back in touch soon.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-04-17T07:24:22.214Z","updated_at":"2018-04-17T07:24:22.214Z","actor":{"username":"tah0aec4","cleared":false,"url":"/tah0aec4","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2629322,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Hello,\n\nbug bounty reward is transferred to your account. You can set payment options and request payout via\nhttps://hackerone.com/settings/bounties\n\nThanks again,\nwaiting for new bug reports from you.\n\nP.S. we are still working to resolve this problem\n","markdown_message":"\u003cp\u003eHello,\u003c/p\u003e\n\n\u003cp\u003ebug bounty reward is transferred to your account. You can set payment options and request payout via\u003cbr\u003e\n\u003ca title=\"https://hackerone.com/settings/bounties\" href=\"https://hackerone.com/settings/bounties\"\u003ehttps://hackerone.com/settings/bounties\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eThanks again,\u003cbr\u003e\nwaiting for new bug reports from you.\u003c/p\u003e\n\n\u003cp\u003eP.S. we are still working to resolve this problem\u003c/p\u003e\n","automated_response":false,"created_at":"2018-04-18T16:09:43.504Z","updated_at":"2018-04-18T16:09:43.504Z","actor":{"url":"/mailru","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/065/1ec04a6b87b02422d913b5c53d5247de91d64718_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Mail.ru"}},"bounty_amount":"250.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"mailru","collaborator":{"username":"flamezzz","url":"/flamezzz"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2672365,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hi,\nthis bug was fixed, please confirm if the patch is OK.","markdown_message":"\u003cp\u003eHi,\u003cbr\u003e\nthis bug was fixed, please confirm if the patch is OK.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-04-27T12:36:45.667Z","updated_at":"2018-04-27T12:36:45.667Z","actor":{"username":"kpebetka","cleared":false,"url":"/kpebetka","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/152/f71d69995e3032fd2225ed83dd75c81e8158a865_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"flamezzz","url":"/flamezzz"},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2672398,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @kpebetka\nThanks for the bounty. I can confirm this is fixed.","markdown_message":"\u003cp\u003eHi \u003ca href=\"/kpebetka\"\u003e@kpebetka\u003c/a\u003e\u003cbr\u003e\nThanks for the bounty. I can confirm this is fixed.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-04-27T12:49:38.914Z","updated_at":"2018-04-27T12:49:38.914Z","actor":{"username":"flamezzz","cleared":true,"url":"/flamezzz","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3412322,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-10-01T09:58:50.799Z","updated_at":"2018-10-01T09:58:50.799Z","first_to_agree":true,"actor":{"username":"tah0aec4","cleared":false,"url":"/tah0aec4","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3412419,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-10-01T10:13:13.047Z","updated_at":"2018-10-01T10:13:13.047Z","actor":{"username":"flamezzz","cleared":true,"url":"/flamezzz","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3412420,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-10-01T10:13:13.115Z","updated_at":"2018-10-01T10:13:13.115Z","actor":{"username":"flamezzz","cleared":true,"url":"/flamezzz","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6803163,"is_internal":false,"editable":false,"type":"Activities::ReassignedToTeam","message":"","markdown_message":"","automated_response":false,"created_at":"2020-01-17T19:51:26.791Z","updated_at":"2020-01-17T19:51:26.791Z","additional_data":{"old_team":"ICQ","new_team":"Mail.ru"},"actor":{"username":"kpebetka","cleared":false,"url":"/kpebetka","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/152/f71d69995e3032fd2225ed83dd75c81e8158a865_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":10898,"category":"team","content":"XSS existed in formatting links in chats functionality. Fixed via additing encoding.\n","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eXSS existed in formatting links in chats functionality. Fixed via additing encoding.\u003c/p\u003e\n"},{"category":"researcher","can_view?":true,"can_create?":false}]}