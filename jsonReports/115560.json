{"id":115560,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMTU1NjA=","url":"https://hackerone.com/reports/115560","title":"Two XSS vulns in widget parameters (all_collections.php and o2.php)","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-02-09T16:17:29.588Z","submitted_at":"2016-02-09T16:17:29.588Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"pr0tagon1st","url":"/pr0tagon1st","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/033/123/9e3397fc4128a6ea0579adedf2a30f47f54ad11a_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":2943,"url":"https://hackerone.com/zomato","handle":"zomato","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/002/943/71b47f9aa21166f0989dfb97112ca10c66a9d0b2_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/943/71b47f9aa21166f0989dfb97112ca10c66a9d0b2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Zomato","twitter_handle":"Zomato","website":"https://www.zomato.com","about":"The fastest way to search for great places to eat at and order from around you. Serving 24 countries worldwide."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2016-08-02T03:50:50.352Z","bug_reporter_agreed_on_going_public_at":"2016-08-01T10:27:52.222Z","team_member_agreed_on_going_public_at":"2016-08-02T03:50:49.994Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"I have found two additional possibilities of XSS attacks via the widget API endpoints: `https://www.zomato.com/widgets/all_collections.php` and `https://www.zomato.com/widgets/o2.php`\n\n`https://www.zomato.com/widgets/all_collections.php` has a vulnerable `city_id` parameter that does not filter html or javascript:\n\nhttps://www.zomato.com/widgets/all_collections.php?city_id=%22%3E%3Cimg%20src=http://goo.gl/JPx2sV%3E%3Cscript%3Ealert%28document.domain%29;%3C/script%3E%3Ca%20href=\u0026language_id=alert%281%29\u0026theme=red\u0026csrf_token=bcac41f373322e378a299618228ad23b\n\nThe `https://www.zomato.com/widgets/o2.php` endpoint has a vulnerable `language_id` parameter, which does not filter html or js:\n\nhttps://www.zomato.com/widgets/o2.php?theme=redar\u0026sort=popularityo\u0026csrf_token=bcac41f373322e378a299618228ad23b\u0026language_id=%22}%27%29;alert%28document.domain%29;console.log%28%27\n\nThese URLs can be placed in \u003ciframe\u003e elements in an attacker-controlled website and any Zomato users visiting that site are open to executing arbitrary javascript in the zomato.com origin, which opens them to CSRF attacks and others. \n\nI have tested the other parameters and have found them to be sanitized.\n\nThese two parameters should be sanitized. \n\nCheers!","vulnerability_information_html":"\u003cp\u003eI have found two additional possibilities of XSS attacks via the widget API endpoints: \u003ccode\u003ehttps://www.zomato.com/widgets/all_collections.php\u003c/code\u003e and \u003ccode\u003ehttps://www.zomato.com/widgets/o2.php\u003c/code\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003ccode\u003ehttps://www.zomato.com/widgets/all_collections.php\u003c/code\u003e has a vulnerable \u003ccode\u003ecity_id\u003c/code\u003e parameter that does not filter html or javascript:\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"https://www.zomato.com/widgets/all_collections.php?city_id=%22%3E%3Cimg%20src=http://goo.gl/JPx2sV%3E%3Cscript%3Ealert%28document.domain%29%3B%3C/script%3E%3Ca%20href=\u0026amp;language_id=alert%281%29\u0026amp;theme=red\u0026amp;csrf_token=bcac41f373322e378a299618228ad23b\" href=\"/redirect?url=https%3A%2F%2Fwww.zomato.com%2Fwidgets%2Fall_collections.php%3Fcity_id%3D%2522%253E%253Cimg%2520src%3Dhttp%3A%2F%2Fgoo.gl%2FJPx2sV%253E%253Cscript%253Ealert%2528document.domain%2529%253B%253C%2Fscript%253E%253Ca%2520href%3D%26language_id%3Dalert%25281%2529%26theme%3Dred%26csrf_token%3Dbcac41f373322e378a299618228ad23b\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.zomato.com/widgets/all_collections.php?city_id=%22%3E%3Cimg%20src=http://goo.gl/JPx2sV%3E%3Cscript%3Ealert%28document.domain%29%3B%3C/script%3E%3Ca%20href=\u0026amp;language_id=alert%281%29\u0026amp;theme=red\u0026amp;csrf_token=bcac41f373322e378a299618228ad23b\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eThe \u003ccode\u003ehttps://www.zomato.com/widgets/o2.php\u003c/code\u003e endpoint has a vulnerable \u003ccode\u003elanguage_id\u003c/code\u003e parameter, which does not filter html or js:\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"https://www.zomato.com/widgets/o2.php?theme=redar\u0026amp;sort=popularityo\u0026amp;csrf_token=bcac41f373322e378a299618228ad23b\u0026amp;language_id=%22%7D%27%29%3Balert%28document.domain%29%3Bconsole.log%28%27\" href=\"/redirect?url=https%3A%2F%2Fwww.zomato.com%2Fwidgets%2Fo2.php%3Ftheme%3Dredar%26sort%3Dpopularityo%26csrf_token%3Dbcac41f373322e378a299618228ad23b%26language_id%3D%2522%257D%2527%2529%253Balert%2528document.domain%2529%253Bconsole.log%2528%2527\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.zomato.com/widgets/o2.php?theme=redar\u0026amp;sort=popularityo\u0026amp;csrf_token=bcac41f373322e378a299618228ad23b\u0026amp;language_id=%22%7D%27%29%3Balert%28document.domain%29%3Bconsole.log%28%27\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eThese URLs can be placed in \u0026lt;iframe\u0026gt; elements in an attacker-controlled website and any Zomato users visiting that site are open to executing arbitrary javascript in the zomato.com origin, which opens them to CSRF attacks and others. \u003c/p\u003e\n\n\u003cp\u003eI have tested the other parameters and have found them to be sanitized.\u003c/p\u003e\n\n\u003cp\u003eThese two parameters should be sanitized. \u003c/p\u003e\n\n\u003cp\u003eCheers!\u003c/p\u003e\n","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":72775,"file_name":"zomato_poc2.jpg","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/072/775/46062aba80ed556fa57a23214c8239233a4c8b6a/zomato_poc2.jpg?response-content-disposition=attachment%3B%20filename%3D%22zomato_poc2.jpg%22%3B%20filename%2A%3DUTF-8%27%27zomato_poc2.jpg\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQY55CA6OQ%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T041812Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIEcehEzJ6wx5cJVBI4ifSuKdHpXuLtuSHmh8SQmXgyhZAiEAmRgGrwChBEkjjlBm%2FjlBtMcBhRzrhQNXyXI9xj%2BctvcqtAMIUhABGgwwMTM2MTkyNzQ4NDkiDAcHHyX1klaXROO7PiqRAwolqCQb1T1qFrFJAaWyztYE1JDBuzLZ4RwAyeKpcLUT4tyRqOd0dd8i4Q%2Bdjr6CKjIwT4czi1qgG1Zc64xBVWsgift2qy2JjNaoHLTUAc2KLDUNHA0TNoe8bX0oc8a%2FwT8uTFJC95SwDTvxHJ1p0gXKjQzsPS8Pmchr%2B084C8EjUen3Ep0CWQzdO%2FqpzpNi57wg8K7fKdB1QGnYNWoZdB5Oy5EISNv9tG0KxDsBpen93okG220BUzCnopM029Epvj2JEWxnATinRfem%2FweYutcyMAcCkbrgBQ8K8e1gHB5A%2B0u28Q%2FVcP31FhOWgULsAluXkn3GslCMytJCmgqijruu4ZYTEnan%2FWKY5YIAA7lqa3BGrYfkahBrQoqEjUUVdIMtzaJamU8Ar78sCeOuD1pmEl%2BL11bJnsiKfDWlGrVeGbAfhGOY8kc%2Fl0wOCOrTXSudIuxOce8DyfTk8hDaOyvB1s7B5C1EjmMCLhImkKwIX2OwfxK%2BL3R40TJMB8Cpgj1PZYAX4%2FoTvwQ2NE7lqB1NMJ2Eqv8FOusBa2sano2o9LnQ3Zz62xDTky5R5ZhcEoLoUN10wDcNGN%2Bl7jbC3Je6yQISTTUZUnFVUaCZviUohA31W7wKMqcULZ8gdS95RnBq56Jnr5mGBpMl01uOWWwq9VYekx0eqwrKG0fnJZt8nzuga5YXIEEdK00GhGaiOPPln2qn0JVgHc7HAmAbONUCYQPXTsMwDpIiMtxst0E4pt9%2BY%2Bmr5CmKeOg9Cr%2F3ZLSrZYQfcVbd%2BLr3n2r8jmT9zA0weoyT0PAWCkOVSyWi1l2NnOIuIVvfIX4Z6FKNLRAS%2BMDRVCl0b%2Bmn7Qq3MoosKsUkOQ%3D%3D\u0026X-Amz-Signature=f61a6ee8c7ea78fb727d46014dfe12d42207f77d097809fc84bb13ecb4dff37a","file_size":151489,"type":"image/jpeg"}],"allow_singular_disclosure_at":"2016-08-31T10:27:52.408Z","allow_singular_disclosure_after":-136576220.11432084,"singular_disclosure_allowed":true,"vote_count":1,"voters":["dyabla"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":818987,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi, any news on this vulnerability? I checked - it's still there alright. Thanks!","markdown_message":"\u003cp\u003eHi, any news on this vulnerability? I checked - it\u0026#39;s still there alright. Thanks!\u003c/p\u003e\n","automated_response":false,"created_at":"2016-03-01T16:02:50.828Z","updated_at":"2016-03-01T16:02:50.828Z","actor":{"username":"pr0tagon1st","cleared":false,"url":"/pr0tagon1st","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/033/123/9e3397fc4128a6ea0579adedf2a30f47f54ad11a_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":826581,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2016-03-07T09:19:24.853Z","updated_at":"2016-03-07T09:19:24.853Z","actor":{"username":"chicken-tikka","cleared":false,"url":"/chicken-tikka","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/059/568/cdbb30fd8932f00a06868a737ab5bdc5c57e5f00_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":986798,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks for keeping @Zomato safe.","markdown_message":"\u003cp\u003eThanks for keeping \u003ca href=\"/zomato\"\u003e@Zomato\u003c/a\u003e safe.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-05-27T08:45:18.600Z","updated_at":"2016-05-27T08:45:18.600Z","actor":{"username":"chicken-tikka","cleared":false,"url":"/chicken-tikka","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/059/568/cdbb30fd8932f00a06868a737ab5bdc5c57e5f00_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"pr0tagon1st","url":"/pr0tagon1st"},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1099336,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Hey, could we disclose this now? :)","markdown_message":"\u003cp\u003eHey, could we disclose this now? :)\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-01T10:27:52.335Z","updated_at":"2016-08-01T10:27:52.335Z","first_to_agree":true,"actor":{"username":"pr0tagon1st","cleared":false,"url":"/pr0tagon1st","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/033/123/9e3397fc4128a6ea0579adedf2a30f47f54ad11a_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1101403,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-08-02T03:50:50.197Z","updated_at":"2016-08-02T03:50:50.197Z","actor":{"username":"chicken-tikka","cleared":false,"url":"/chicken-tikka","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/059/568/cdbb30fd8932f00a06868a737ab5bdc5c57e5f00_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1101404,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-08-02T03:50:50.430Z","updated_at":"2016-08-02T03:50:50.430Z","actor":{"username":"chicken-tikka","cleared":false,"url":"/chicken-tikka","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/059/568/cdbb30fd8932f00a06868a737ab5bdc5c57e5f00_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5206808,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"","markdown_message":"","automated_response":false,"created_at":"2019-06-27T14:51:25.378Z","updated_at":"2019-06-27T14:51:25.378Z","actor":{"url":"/zomato","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/943/71b47f9aa21166f0989dfb97112ca10c66a9d0b2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Zomato"}},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}