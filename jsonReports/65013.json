{"id":65013,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC82NTAxMw==","url":"https://hackerone.com/reports/65013","title":"HTML Injection на e.mail.ru","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2015-05-31T09:54:35.153Z","submitted_at":"2015-05-31T09:54:35.153Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"c37hun","url":"/c37hun","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/011/347/e6bd589b7afd4ca2472522c0882b95a39d77d1db_original.JPG/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":65,"url":"https://hackerone.com/mailru","handle":"mailru","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/065/1ec04a6b87b02422d913b5c53d5247de91d64718_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/065/1ec04a6b87b02422d913b5c53d5247de91d64718_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Mail.ru","twitter_handle":"mailru","website":"https://corp.mail.ru","about":"Building the Internet since 1998"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2016-07-20T16:11:51.422Z","bug_reporter_agreed_on_going_public_at":"2016-07-11T16:04:13.166Z","team_member_agreed_on_going_public_at":"2016-07-20T16:11:51.302Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Здравствуйте,\r\nЯ обнаружил HTML инъекцию на e.mail.ru с помощью текстовых файлов формата .txt\r\n\r\nProof of concept:\r\n\u003eСоздаем HTML файл с правильными тегами, то есть html head body... должны присутствовать. Иначе файл не будет воспроизведен как HTML\r\nМеняем конец файла на .txt\r\nДалее сжимаем этот файл при помощи RAR и прикрепляем к письму.\r\n\r\nПри онлайн воспроизведении файла со стороны отправителя и получателя текстовый файл воспроизводится как HTML\r\n\r\nПосле просмотра видео, вам будет все ясно.\r\n\r\nС уважением,\r\nДжейхун Джафаров (c37hun)\r\nСпециалист по кибербезопасности\r\nc37hun@mail.ru","vulnerability_information_html":"\u003cp\u003eЗдравствуйте,\u003cbr\u003e\nЯ обнаружил HTML инъекцию на e.mail.ru с помощью текстовых файлов формата .txt\u003c/p\u003e\n\n\u003cp\u003eProof of concept:\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eСоздаем HTML файл с правильными тегами, то есть html head body... должны присутствовать. Иначе файл не будет воспроизведен как HTML\u003cbr\u003e\nМеняем конец файла на .txt\u003cbr\u003e\nДалее сжимаем этот файл при помощи RAR и прикрепляем к письму.\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eПри онлайн воспроизведении файла со стороны отправителя и получателя текстовый файл воспроизводится как HTML\u003c/p\u003e\n\n\u003cp\u003eПосле просмотра видео, вам будет все ясно.\u003c/p\u003e\n\n\u003cp\u003eС уважением,\u003cbr\u003e\nДжейхун Джафаров (c37hun)\u003cbr\u003e\nСпециалист по кибербезопасности\u003cbr\u003e\n\u003ca title=\"c37hun@mail.ru\" href=\"mailto:c37hun@mail.ru\" rel=\"nofollow noopener noreferrer\"\u003ec37hun@mail.ru\u003c/a\u003e\u003c/p\u003e\n","bounty_amount":"250.0","formatted_bounty":"$250","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":39342,"file_name":"HTML_Inj.rar","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/039/342/c9d57b53f325abf8c8e5d5129daf3d783a8519c8/HTML_Inj.rar?response-content-disposition=attachment%3B%20filename%3D%22HTML_Inj.rar%22%3B%20filename%2A%3DUTF-8%27%27HTML_Inj.rar\u0026response-content-type=application%2Fx-rar\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQRF2F3DNN%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T063348Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCq%2BvKnwl6LFdj00DiqFKaUHM8vK%2Fo1tPHwYahCeGa93QIgIGXi89nBgDj4GiNdSy8pbzTFSts%2FsTmVKSM%2B7%2BKO9T4qtAMIVxABGgwwMTM2MTkyNzQ4NDkiDC9ugoHsMNk43keJ8SqRA8JrBBYsK5T0HiaJ%2F4T50sG1Ri6J%2BT91kOgNavpYRolFX7jpLcV0V81FUABPzsjSnAxRmYBypjIaPqZGQ8oq%2F9n27wPLgj8hUTl8O3SfU1GWCMHbROvW%2BF2K77xGt0sJKNZYVxNdbqrYwCp5MFfMpJjwvv%2BhMkb%2BfRRyL7GEsu82VMU41lKH3RgrBDJApguUYlLANZ1Ej8ImBTuQa0PTHDqpwoWpjaPcrnIHZqTdHOI5Wm1eCoy5eaHGFikwjjvjuMJ%2F1a5ex%2FCIOhGcwoqCBDet1aBO%2BZq78RzS1QY34XnoChAp%2BaikZB20FcxjUwn%2BkvJECosM%2B4F4PQHepofUS3ejTLZPjeYi9qQNjzq%2Fm%2Fv%2FV4Vqc3IwmTFe06OdDxIgpZyAcTQoSU8vA7sbEDpB%2F3XQDS%2BUqZejbvdrbfU8WGZYnfYRHIKZtByJaRcPB8vqFX9lX0oeLxz0IEswNXH%2FFNMPBsLv79pLu3OV6Lzfbgb36AT8ui2UZLwoOGRrSo71Tb%2FsYvBelBr2drk9Yi%2Fa%2FnGwML2Fq%2F8FOusBbN3FmFgpQ8hwRzpol0ZxBWjfkVayY1CeW8JmiNjsl1ndCgMmcPk10W64GF1qbk7fF0uPQopY1SymUfLnKrk2DYd5OUiFjtVktJLGKZ7wkgrDfWYDpQHSQRJQyMvnd2nX1QfEA0AlGzRulOvM2iwTIk241T4DuFrDCiCqYL8Mv%2FPeDbSAy7t6gkKpJ8C2PUVCIivsXSH1HvLfNTen1g5wD0tpM%2FnXwZxdxfuh8W3doYRnkWcmf8W%2F2IdcL3V8Ca3%2FV7qrIFxbsZIzSmpnSBl18cNkli7atg7%2FBcRNrqYiFsXMe5OsMSXyZkZK%2BQ%3D%3D\u0026X-Amz-Signature=5ddf38f6f752f2a12eefe976d532aeb8a855b6c78ea382df1f687999e0a2aeeb","file_size":923,"type":"application/x-rar"},{"id":39343,"file_name":"HTML_inj_e.mail.ru.swf","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/039/343/4a68a5f684013df91eba25555af645a26a86d094/HTML_inj_e.mail.ru.swf?response-content-disposition=attachment%3B%20filename%3D%22HTML_inj_e.mail.ru.swf%22%3B%20filename%2A%3DUTF-8%27%27HTML_inj_e.mail.ru.swf\u0026response-content-type=application%2Foctet-stream\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQRF2F3DNN%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T063348Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCq%2BvKnwl6LFdj00DiqFKaUHM8vK%2Fo1tPHwYahCeGa93QIgIGXi89nBgDj4GiNdSy8pbzTFSts%2FsTmVKSM%2B7%2BKO9T4qtAMIVxABGgwwMTM2MTkyNzQ4NDkiDC9ugoHsMNk43keJ8SqRA8JrBBYsK5T0HiaJ%2F4T50sG1Ri6J%2BT91kOgNavpYRolFX7jpLcV0V81FUABPzsjSnAxRmYBypjIaPqZGQ8oq%2F9n27wPLgj8hUTl8O3SfU1GWCMHbROvW%2BF2K77xGt0sJKNZYVxNdbqrYwCp5MFfMpJjwvv%2BhMkb%2BfRRyL7GEsu82VMU41lKH3RgrBDJApguUYlLANZ1Ej8ImBTuQa0PTHDqpwoWpjaPcrnIHZqTdHOI5Wm1eCoy5eaHGFikwjjvjuMJ%2F1a5ex%2FCIOhGcwoqCBDet1aBO%2BZq78RzS1QY34XnoChAp%2BaikZB20FcxjUwn%2BkvJECosM%2B4F4PQHepofUS3ejTLZPjeYi9qQNjzq%2Fm%2Fv%2FV4Vqc3IwmTFe06OdDxIgpZyAcTQoSU8vA7sbEDpB%2F3XQDS%2BUqZejbvdrbfU8WGZYnfYRHIKZtByJaRcPB8vqFX9lX0oeLxz0IEswNXH%2FFNMPBsLv79pLu3OV6Lzfbgb36AT8ui2UZLwoOGRrSo71Tb%2FsYvBelBr2drk9Yi%2Fa%2FnGwML2Fq%2F8FOusBbN3FmFgpQ8hwRzpol0ZxBWjfkVayY1CeW8JmiNjsl1ndCgMmcPk10W64GF1qbk7fF0uPQopY1SymUfLnKrk2DYd5OUiFjtVktJLGKZ7wkgrDfWYDpQHSQRJQyMvnd2nX1QfEA0AlGzRulOvM2iwTIk241T4DuFrDCiCqYL8Mv%2FPeDbSAy7t6gkKpJ8C2PUVCIivsXSH1HvLfNTen1g5wD0tpM%2FnXwZxdxfuh8W3doYRnkWcmf8W%2F2IdcL3V8Ca3%2FV7qrIFxbsZIzSmpnSBl18cNkli7atg7%2FBcRNrqYiFsXMe5OsMSXyZkZK%2BQ%3D%3D\u0026X-Amz-Signature=f185ac53de7ef0e5b9eb3614fe9cf51bc5fbf7e036997d59aedb7c4b56934921","file_size":1787528,"type":"application/x-shockwave-flash"}],"allow_singular_disclosure_at":"2016-08-10T16:04:13.383Z","allow_singular_disclosure_after":-138378574.87272602,"singular_disclosure_allowed":true,"vote_count":4,"voters":["c37hun","secdoor","dyabla","yuresd"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":434547,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Спасибо за ваш репорт.  Мы ценим ваше желание сделать наши сервисы ещё безопаснее.\n\nПрисланная вами информация передана аналитикам и проверяется, мы обязательно свяжемся с вами в ближайшее время.","markdown_message":"\u003cp\u003eСпасибо за ваш репорт.  Мы ценим ваше желание сделать наши сервисы ещё безопаснее.\u003c/p\u003e\n\n\u003cp\u003eПрисланная вами информация передана аналитикам и проверяется, мы обязательно свяжемся с вами в ближайшее время.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-05-31T21:33:17.768Z","updated_at":"2015-05-31T21:33:17.768Z","actor":{"username":"3apa3a","cleared":false,"url":"/3apa3a","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/836/57b93fd96b524d0ed13eef717ecd070ad8468f86_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":439546,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Привет, вознаграждение за найденную уязвимость начислено на твой аккаунт. На странице https://hackerone.com/settings/bounties можно выбрать желаемый метод выплаты. \n\nСпасибо и ждем от тебя новых багрепортов!\n\nP.S. работа по устранению уязвимости пока продолжается.\nВознаграждение меньше, чем за XSS, т.к. выполнение кода происходит на домене zipview.attachmail.ru. Если сможешь выполнить эту XSS на e.mail.ru - пиши","markdown_message":"\u003cp\u003eПривет, вознаграждение за найденную уязвимость начислено на твой аккаунт. На странице \u003ca title=\"https://hackerone.com/settings/bounties\" href=\"https://hackerone.com/settings/bounties\"\u003ehttps://hackerone.com/settings/bounties\u003c/a\u003e можно выбрать желаемый метод выплаты. \u003c/p\u003e\n\n\u003cp\u003eСпасибо и ждем от тебя новых багрепортов!\u003c/p\u003e\n\n\u003cp\u003eP.S. работа по устранению уязвимости пока продолжается.\u003cbr\u003e\nВознаграждение меньше, чем за XSS, т.к. выполнение кода происходит на домене zipview.attachmail.ru. Если сможешь выполнить эту XSS на e.mail.ru - пиши\u003c/p\u003e\n","automated_response":false,"created_at":"2015-06-03T14:14:49.848Z","updated_at":"2015-06-03T14:14:49.848Z","actor":{"url":"/mailru","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/065/1ec04a6b87b02422d913b5c53d5247de91d64718_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Mail.ru"}},"bounty_amount":"250.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"mailru","collaborator":{"username":"c37hun","url":"/c37hun"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":587397,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2015-09-14T13:16:55.612Z","updated_at":"2015-09-14T13:16:55.612Z","actor":{"username":"kpebetka","cleared":false,"url":"/kpebetka","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/152/f71d69995e3032fd2225ed83dd75c81e8158a865_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"c37hun","url":"/c37hun"},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":587398,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Привет, бага закрыта.\nПожалуйста, подтвердите, что проблема больше не воспроизводится. ","markdown_message":"\u003cp\u003eПривет, бага закрыта.\u003cbr\u003e\nПожалуйста, подтвердите, что проблема больше не воспроизводится. \u003c/p\u003e\n","automated_response":false,"created_at":"2015-09-14T13:17:20.637Z","updated_at":"2015-09-14T13:17:20.637Z","actor":{"username":"kpebetka","cleared":false,"url":"/kpebetka","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/152/f71d69995e3032fd2225ed83dd75c81e8158a865_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1063185,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-07-11T16:04:13.286Z","updated_at":"2016-07-11T16:04:13.286Z","first_to_agree":true,"actor":{"username":"c37hun","cleared":false,"url":"/c37hun","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/011/347/e6bd589b7afd4ca2472522c0882b95a39d77d1db_original.JPG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1078293,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-07-20T16:11:51.360Z","updated_at":"2016-07-20T16:11:51.360Z","actor":{"username":"3apa3a","cleared":false,"url":"/3apa3a","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/836/57b93fd96b524d0ed13eef717ecd070ad8468f86_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1078294,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-07-20T16:11:51.509Z","updated_at":"2016-07-20T16:11:51.509Z","actor":{"username":"3apa3a","cleared":false,"url":"/3apa3a","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/836/57b93fd96b524d0ed13eef717ecd070ad8468f86_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":2200,"category":"team","content":"XSS on sanbox domain zipview.attachmail.ru via archived text attachment","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eXSS on sanbox domain zipview.attachmail.ru via archived text attachment\u003c/p\u003e\n"},{"id":2248,"category":"researcher","content":"Great find! All advise to watch the video.","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eGreat find! All advise to watch the video.\u003c/p\u003e\n"}]}