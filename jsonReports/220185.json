{"id":220185,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMjAxODU=","url":"https://hackerone.com/reports/220185","title":"Password reset Token not expiring ","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2017-04-11T11:51:16.888Z","submitted_at":"2017-04-11T11:51:16.888Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"peeper35","url":"/peeper35","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/148/249/7753f3fb4ff304f4b274fdccbbd8b2edc3405f0c_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":14478,"url":"https://hackerone.com/skyliner","handle":"skyliner","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/014/478/78fb2f32316c5a8f646834d698d830549d1d234c_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/478/78fb2f32316c5a8f646834d698d830549d1d234c_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"disabled","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Skyliner","twitter_handle":"skylinerhq","website":"","about":"This program is no longer being run."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-04-11T18:04:47.153Z","bug_reporter_agreed_on_going_public_at":"2017-04-11T18:04:47.118Z","team_member_agreed_on_going_public_at":"2017-04-11T18:04:13.303Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hello Team,\n\nHere in this scenario, I've found that the there's a kind of server side side invalidation of Password Reset tokens. Like if I've requested for password reset token (token1) and I don't use it,  after I will make another request for password reset token (token2). This time I'll use the token2 means the link that I requested for the second time, so the first token (token1) should explicitly expire by the server. But here I can use the token1 also after password change by token2, this is unusual behavior of web application.\n\nExploit Scenario:\n If victim's email account is still logged into his/her Office Computers or any public Internet Cafe. Then any external attacker can use the unused token to reset victims token.\n\nProof of Concept:  \n1. Go to https://www.skyliner.io/forgot-password and ask for password reset link.\n2. Don't use the link keep it in Email inbox.\n3. After some time repeat the step 1.\n4. This time use the password reset link which was asked in step 3. means the 2nd link.\n5. After changing the password, use the password reset link that was captured in step 1.\n6. You'll see the password reset link is not expired even after password change.\n\nI've also explained you the Exploit Scenario, now its all upto you.\n\nRegards,\nSahil Tembhare\n","vulnerability_information_html":"\u003cp\u003eHello Team,\u003c/p\u003e\n\n\u003cp\u003eHere in this scenario, I\u0026#39;ve found that the there\u0026#39;s a kind of server side side invalidation of Password Reset tokens. Like if I\u0026#39;ve requested for password reset token (token1) and I don\u0026#39;t use it,  after I will make another request for password reset token (token2). This time I\u0026#39;ll use the token2 means the link that I requested for the second time, so the first token (token1) should explicitly expire by the server. But here I can use the token1 also after password change by token2, this is unusual behavior of web application.\u003c/p\u003e\n\n\u003cp\u003eExploit Scenario:\u003cbr\u003e\n If victim\u0026#39;s email account is still logged into his/her Office Computers or any public Internet Cafe. Then any external attacker can use the unused token to reset victims token.\u003c/p\u003e\n\n\u003cp\u003eProof of Concept:  \u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eGo to \u003ca title=\"https://www.skyliner.io/forgot-password\" href=\"/redirect?url=https%3A%2F%2Fwww.skyliner.io%2Fforgot-password\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.skyliner.io/forgot-password\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e and ask for password reset link.\u003c/li\u003e\n\u003cli\u003eDon\u0026#39;t use the link keep it in Email inbox.\u003c/li\u003e\n\u003cli\u003eAfter some time repeat the step 1.\u003c/li\u003e\n\u003cli\u003eThis time use the password reset link which was asked in step 3. means the 2nd link.\u003c/li\u003e\n\u003cli\u003eAfter changing the password, use the password reset link that was captured in step 1.\u003c/li\u003e\n\u003cli\u003eYou\u0026#39;ll see the password reset link is not expired even after password change.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eI\u0026#39;ve also explained you the Exploit Scenario, now its all upto you.\u003c/p\u003e\n\n\u003cp\u003eRegards,\u003cbr\u003e\nSahil Tembhare\u003c/p\u003e\n","weakness":{"id":52,"name":"Deserialization of Untrusted Data"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2017-05-11T18:04:13.333Z","allow_singular_disclosure_after":-114692142.46338437,"singular_disclosure_allowed":true,"vote_count":8,"voters":["eveeez","peeper35","whitesector","silv3rpoision","japz","spetr0x","clarckowen_","therbisha"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1604752,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hi Sahil,\n\nThanks for your report! That's a really good point, and one we'd overlooked. We'll get right on resolving that.","markdown_message":"\u003cp\u003eHi Sahil,\u003c/p\u003e\n\n\u003cp\u003eThanks for your report! That\u0026#39;s a really good point, and one we\u0026#39;d overlooked. We\u0026#39;ll get right on resolving that.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-04-11T13:51:43.561Z","updated_at":"2017-04-11T13:51:43.561Z","actor":{"username":"coda","cleared":false,"url":"/coda","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/097/551/446b1d51929de8179c7967099a522d41605889b7_original.JPG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"skyliner","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":1605127,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey there, Thanks for the Quick and Kind Response.","markdown_message":"\u003cp\u003eHey there, Thanks for the Quick and Kind Response.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-04-11T16:39:23.488Z","updated_at":"2017-04-11T16:39:23.488Z","actor":{"username":"peeper35","cleared":false,"url":"/peeper35","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/148/249/7753f3fb4ff304f4b274fdccbbd8b2edc3405f0c_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"skyliner","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1605367,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Ok, we've pushed out a change to resolve this. We invalidate all outstanding password reset codes on both issuing a new code and when you change your password. Thanks for your help in making our product more secure!","markdown_message":"\u003cp\u003eOk, we\u0026#39;ve pushed out a change to resolve this. We invalidate all outstanding password reset codes on both issuing a new code and when you change your password. Thanks for your help in making our product more secure!\u003c/p\u003e\n","automated_response":false,"created_at":"2017-04-11T17:56:22.452Z","updated_at":"2017-04-11T17:56:22.452Z","actor":{"username":"coda","cleared":false,"url":"/coda","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/097/551/446b1d51929de8179c7967099a522d41605889b7_original.JPG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"peeper35","url":"/peeper35"},"genius_execution_id":null,"team_handle":"skyliner","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":1605388,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Happy to Help.\n\nThanks,\nSahil Tembhare","markdown_message":"\u003cp\u003eHappy to Help.\u003c/p\u003e\n\n\u003cp\u003eThanks,\u003cbr\u003e\nSahil Tembhare\u003c/p\u003e\n","automated_response":false,"created_at":"2017-04-11T18:01:37.340Z","updated_at":"2017-04-11T18:03:15.965Z","actor":{"username":"peeper35","cleared":false,"url":"/peeper35","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/148/249/7753f3fb4ff304f4b274fdccbbd8b2edc3405f0c_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"skyliner","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1605396,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-04-11T18:04:13.318Z","updated_at":"2017-04-11T18:04:13.318Z","first_to_agree":true,"actor":{"username":"coda","cleared":false,"url":"/coda","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/097/551/446b1d51929de8179c7967099a522d41605889b7_original.JPG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"skyliner","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":1605398,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-04-11T18:04:47.133Z","updated_at":"2017-04-11T18:04:47.133Z","actor":{"username":"peeper35","cleared":false,"url":"/peeper35","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/148/249/7753f3fb4ff304f4b274fdccbbd8b2edc3405f0c_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"skyliner","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1605399,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-04-11T18:04:47.168Z","updated_at":"2017-04-11T18:04:47.168Z","actor":{"username":"peeper35","cleared":false,"url":"/peeper35","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/148/249/7753f3fb4ff304f4b274fdccbbd8b2edc3405f0c_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"skyliner","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}