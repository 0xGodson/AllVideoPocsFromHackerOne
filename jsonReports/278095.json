{"id":278095,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yNzgwOTU=","url":"https://hackerone.com/reports/278095","title":"Invalid Host detection at https://hackerone.com/redirect","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2017-10-17T04:35:07.837Z","submitted_at":"2017-10-17T04:35:07.837Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"shailesh4594","url":"/shailesh4594","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/019/402/1cea049691b46de2c16ca91611b7673ef323e3f9_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13,"url":"https://hackerone.com/security","handle":"security","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"HackerOne","twitter_handle":"Hacker0x01","website":"https://hackerone.com","about":"Vulnerability disclosure should be safe, transparent, and rewarding."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-12-03T19:19:50.707Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2017-11-03T19:19:41.014Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hello,99\n\n**Summary:** Host detection at https://hackerone.com/redirect is invalid and insecure.\n\n**Description :** On redirection page, host is detected and highlighted to prevent phishing attacks. But that protection is weak and can be bypassed. So an attacker can redirect victim on another host instead of highlighted host. Also, it possible to redirect victim on a IDN homograph website.\n\nHost filtration can be bypassed using whitespace characters like `%0D`,`%0A`,`%00`,`%09` etc.\n\n### Steps To Reproduce\n\n1. Use this markdown code `[Go to yelp.com](https://yelp.com%0A.evil.com%5C@x)` in a comment \n2. Click on `Go to yelp.com` link.\n3. External link warning page will be shown \n4. `yelp.com` will be highlighted as targeted Host.\n5. Click on Proceed button.\n6. You will be redirected on https://yelp.com.evi.com (a subdomain of evil.com)\n7. Done\n\n####Using IDN homograph : \n\n1. Try `[Yelp.com](https://yelp.com%0A.уelp.com%5C@x)`\n2. Click on `Yelp.com` \n3. `yelp.com` will be highlighted\n4. You will be redirected on https://yelp.com.xn--elp-cfd.com/@x after clicking on **Proceed** button\n5. Done\n\nThanks,\nShailesh","vulnerability_information_html":"\u003cp\u003eHello,99\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eSummary:\u003c/strong\u003e Host detection at \u003ca title=\"https://hackerone.com/redirect\" href=\"https://hackerone.com/redirect\"\u003ehttps://hackerone.com/redirect\u003c/a\u003e is invalid and insecure.\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eDescription :\u003c/strong\u003e On redirection page, host is detected and highlighted to prevent phishing attacks. But that protection is weak and can be bypassed. So an attacker can redirect victim on another host instead of highlighted host. Also, it possible to redirect victim on a IDN homograph website.\u003c/p\u003e\n\n\u003cp\u003eHost filtration can be bypassed using whitespace characters like \u003ccode\u003e%0D\u003c/code\u003e,\u003ccode\u003e%0A\u003c/code\u003e,\u003ccode\u003e%00\u003c/code\u003e,\u003ccode\u003e%09\u003c/code\u003e etc.\u003c/p\u003e\n\n\u003ch3 id=\"steps-to-reproduce\"\u003eSteps To Reproduce\u003c/h3\u003e\n\n\u003col\u003e\n\u003cli\u003eUse this markdown code \u003ccode\u003e[Go to yelp.com](https://yelp.com%0A.evil.com%5C@x)\u003c/code\u003e in a comment \u003c/li\u003e\n\u003cli\u003eClick on \u003ccode\u003eGo to yelp.com\u003c/code\u003e link.\u003c/li\u003e\n\u003cli\u003eExternal link warning page will be shown \u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003eyelp.com\u003c/code\u003e will be highlighted as targeted Host.\u003c/li\u003e\n\u003cli\u003eClick on Proceed button.\u003c/li\u003e\n\u003cli\u003eYou will be redirected on \u003ca title=\"https://yelp.com.evi.com\" href=\"/redirect?url=https%3A%2F%2Fyelp.com.evi.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://yelp.com.evi.com\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e (a subdomain of evil.com)\u003c/li\u003e\n\u003cli\u003eDone\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003ch4 id=\"using-idn-homograph\"\u003eUsing IDN homograph :\u003c/h4\u003e\n\n\u003col\u003e\n\u003cli\u003eTry \u003ccode\u003e[Yelp.com](https://yelp.com%0A.уelp.com%5C@x)\u003c/code\u003e\n\u003c/li\u003e\n\u003cli\u003eClick on \u003ccode\u003eYelp.com\u003c/code\u003e \u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003eyelp.com\u003c/code\u003e will be highlighted\u003c/li\u003e\n\u003cli\u003eYou will be redirected on \u003ca title=\"https://yelp.com.xn--elp-cfd.com/@x\" href=\"/redirect?url=https%3A%2F%2Fyelp.com.xn--elp-cfd.com%2F%40x\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://yelp.com.xn--elp-cfd.com/@x\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e after clicking on \u003cstrong\u003eProceed\u003c/strong\u003e button\u003c/li\u003e\n\u003cli\u003eDone\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eThanks,\u003cbr\u003e\nShailesh\u003c/p\u003e\n","bounty_amount":"500.0","formatted_bounty":"$500","weakness":{"id":57,"name":"Violation of Secure Design Principles"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2017-12-03T19:19:41.181Z","allow_singular_disclosure_after":-96890520.24117649,"singular_disclosure_allowed":true,"vote_count":56,"voters":["jokebookservice1","jensec","kapytein","hunter","tk0","bogdantcaciuc","spam404","sameerphad72","flashdisk","fa1rlight","and 46 more..."],"severity":{"rating":"low","author_type":"Team"},"structured_scope":{"databaseId":3,"asset_type":"URL","asset_identifier":"https://hackerone.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":2072841,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for reporting @shailesh4594, we're looking into this and will get back to you shortly.\n\nKind regards,\n@coffeecup ","markdown_message":"\u003cp\u003eThanks for reporting \u003ca href=\"/shailesh4594\"\u003e@shailesh4594\u003c/a\u003e, we\u0026#39;re looking into this and will get back to you shortly.\u003c/p\u003e\n\n\u003cp\u003eKind regards,\u003cbr\u003e\n\u003ca href=\"/coffeecup\"\u003e@coffeecup\u003c/a\u003e \u003c/p\u003e\n","automated_response":false,"created_at":"2017-10-17T15:57:32.421Z","updated_at":"2017-10-17T15:57:32.421Z","actor":{"username":"coffeecup","cleared":false,"url":"/coffeecup","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/163/756/b715ab701f6ba35c13cf00277bf23f9ab1a5e1cb_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2072862,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2017-10-17T16:00:12.995Z","updated_at":"2017-10-17T16:00:12.995Z","additional_data":{"old_severity":null,"new_severity":"Low","old_severity_id":null,"new_severity_id":84156},"actor":{"username":"coffeecup","cleared":false,"url":"/coffeecup","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/163/756/b715ab701f6ba35c13cf00277bf23f9ab1a5e1cb_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2072872,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hi @shailesh4594 - We are looking into this now and will make a determination if this warrants a fix. Thanks for thinking of HackerOne security. ","markdown_message":"\u003cp\u003eHi \u003ca href=\"/shailesh4594\"\u003e@shailesh4594\u003c/a\u003e - We are looking into this now and will make a determination if this warrants a fix. Thanks for thinking of HackerOne security. \u003c/p\u003e\n","automated_response":false,"created_at":"2017-10-17T16:02:23.757Z","updated_at":"2017-10-17T16:02:23.757Z","actor":{"username":"coffeecup","cleared":false,"url":"/coffeecup","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/163/756/b715ab701f6ba35c13cf00277bf23f9ab1a5e1cb_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2108143,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @shailesh4594 - I was able to reproduce this a few days ago, but now the URL redirects me to yelp.com - are you still able to reproduce? Thanks! ","markdown_message":"\u003cp\u003eHi \u003ca href=\"/shailesh4594\"\u003e@shailesh4594\u003c/a\u003e - I was able to reproduce this a few days ago, but now the URL redirects me to yelp.com - are you still able to reproduce? Thanks! \u003c/p\u003e\n","automated_response":false,"created_at":"2017-10-27T12:08:53.274Z","updated_at":"2017-10-27T12:08:53.274Z","actor":{"username":"coffeecup","cleared":false,"url":"/coffeecup","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/163/756/b715ab701f6ba35c13cf00277bf23f9ab1a5e1cb_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2108159,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @coffeecup,\n\nNo, now it's not reproducible. Host is detected correctly. ","markdown_message":"\u003cp\u003eHi \u003ca href=\"/coffeecup\"\u003e@coffeecup\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eNo, now it\u0026#39;s not reproducible. Host is detected correctly. \u003c/p\u003e\n","automated_response":false,"created_at":"2017-10-27T12:17:12.677Z","updated_at":"2017-10-27T12:17:12.677Z","actor":{"username":"shailesh4594","cleared":true,"url":"/shailesh4594","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/402/1cea049691b46de2c16ca91611b7673ef323e3f9_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2132880,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks for your repot @shailesh4594 - We appreciate you bringing this to our attention and have decided to award $500 for this report. We look forward to more reports from you in the future. Thanks for hacking on HackerOne! ","markdown_message":"\u003cp\u003eThanks for your repot \u003ca href=\"/shailesh4594\"\u003e@shailesh4594\u003c/a\u003e - We appreciate you bringing this to our attention and have decided to award $500 for this report. We look forward to more reports from you in the future. Thanks for hacking on HackerOne! \u003c/p\u003e\n","automated_response":false,"created_at":"2017-11-03T19:19:11.223Z","updated_at":"2017-11-03T19:19:11.223Z","actor":{"url":"/security","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"HackerOne"}},"bounty_amount":"500.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"security","collaborator":{"username":"shailesh4594","url":"/shailesh4594"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2132881,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2017-11-03T19:19:21.548Z","updated_at":"2017-11-03T19:19:21.548Z","actor":{"username":"coffeecup","cleared":false,"url":"/coffeecup","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/163/756/b715ab701f6ba35c13cf00277bf23f9ab1a5e1cb_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"shailesh4594","url":"/shailesh4594"},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2132882,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-11-03T19:19:41.079Z","updated_at":"2017-11-03T19:19:41.079Z","first_to_agree":true,"actor":{"username":"coffeecup","cleared":false,"url":"/coffeecup","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/163/756/b715ab701f6ba35c13cf00277bf23f9ab1a5e1cb_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2197172,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-12-03T19:19:50.735Z","updated_at":"2017-12-03T19:19:50.735Z","actor":{"url":"/security","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"HackerOne"}},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}