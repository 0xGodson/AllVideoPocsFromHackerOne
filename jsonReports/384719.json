{"id":384719,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zODQ3MTk=","url":"https://hackerone.com/reports/384719","title":"linkinfo - openbasedir bypass on Windows PHP","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2018-07-20T18:31:03.649Z","submitted_at":"2018-07-20T18:31:03.649Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"fms","url":"/fms","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":29,"url":"https://hackerone.com/ibb-php","handle":"ibb-php","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/029/99087dbbdf52fc3ce3acbf16aa33a5c4f5e2c111_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/029/99087dbbdf52fc3ce3acbf16aa33a5c4f5e2c111_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"paused","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"PHP (IBB)","twitter_handle":"","website":"http://www.php.net","about":""}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2018-10-15T15:29:51.313Z","bug_reporter_agreed_on_going_public_at":"2018-10-15T15:29:51.244Z","team_member_agreed_on_going_public_at":"2018-10-01T23:06:35.937Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Upstream bug - windows linkinfo lacks openbasedir check\n===\nhttps://bugs.php.net/bug.php?id=76459 \n\nSummary\n==\nDescription:\n------------\nlinkinfo function on windows doesn't implement openbasedir check, it can be seen by reviewing the source code. This could be abused to find files on paths outside of the allowed directories.\n\n\nWindows: https://github.com/php/php-src/blob/master/ext/standard/link_win32.c#L88\nUnix: https://github.com/php/php-src/blob/master/ext/standard/link.c#L85\n\nTest script:\n---------------\n\u003c?php\n\n$var1=\"c:\\\\jump\";\nprint \"checking $var1 ...\".PHP_EOL;\nprint @linkinfo($var1).PHP_EOL;\n$var1=\"c:\\\\jump\\\\folder\\\\file1.txt\";\nprint \"checking $var1 ...\".PHP_EOL;\nprint @linkinfo($var1).PHP_EOL;\n$var1=\"c:\\\\jump\\\\blabla\";\nprint \"checking $var1 ...\".PHP_EOL;\nprint @linkinfo($var1).PHP_EOL;\n\nExpected result:\n----------------\nWarning: linkinfo(): open_basedir restriction in effect\n\nPatch\n==\nhttp://git.php.net/?p=php-src.git;a=commit;h=289cb0f77c28b80a779170711f5e4e92cdd4fbdb\n\nFixed for PHP 5.6.37, PHP 7.0.31, PHP 7.1.20, PHP 7.2.8\n==\nhttp://php.net/ChangeLog-5.php#5.6.37\n\n## Impact\n\nBypass openbasedir restriction set by hosting provider on a shared environment\n http://php.net/manual/en/ini.core.php#ini.open-basedir","vulnerability_information_html":"\u003ch1 id=\"upstream-bug-windows-linkinfo-lacks-openbasedir-check\"\u003eUpstream bug - windows linkinfo lacks openbasedir check\u003c/h1\u003e\n\n\u003cp\u003e\u003ca title=\"https://bugs.php.net/bug.php?id=76459\" href=\"/redirect?url=https%3A%2F%2Fbugs.php.net%2Fbug.php%3Fid%3D76459\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://bugs.php.net/bug.php?id=76459\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e \u003c/p\u003e\n\n\u003ch1 id=\"summary\"\u003eSummary\u003c/h1\u003e\n\n\u003ch2 id=\"description\"\u003eDescription:\u003c/h2\u003e\n\n\u003cp\u003elinkinfo function on windows doesn\u0026#39;t implement openbasedir check, it can be seen by reviewing the source code. This could be abused to find files on paths outside of the allowed directories.\u003c/p\u003e\n\n\u003cp\u003eWindows: \u003ca title=\"https://github.com/php/php-src/blob/master/ext/standard/link_win32.c#L88\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fphp%2Fphp-src%2Fblob%2Fmaster%2Fext%2Fstandard%2Flink_win32.c%23L88\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/php/php-src/blob/master/ext/standard/link_win32.c#L88\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nUnix: \u003ca title=\"https://github.com/php/php-src/blob/master/ext/standard/link.c#L85\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fphp%2Fphp-src%2Fblob%2Fmaster%2Fext%2Fstandard%2Flink.c%23L85\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/php/php-src/blob/master/ext/standard/link.c#L85\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2 id=\"test-script\"\u003eTest script:\u003c/h2\u003e\n\n\u003cp\u003e\u0026lt;?php\u003c/p\u003e\n\n\u003cp\u003e$var1=\u0026quot;c:\\jump\u0026quot;;\u003cbr\u003e\nprint \u0026quot;checking $var1 ...\u0026quot;.PHP_EOL;\u003cbr\u003e\nprint \u003ca href=\"/linkinfo\"\u003e@linkinfo\u003c/a\u003e($var1).PHP_EOL;\u003cbr\u003e\n$var1=\u0026quot;c:\\jump\\folder\\file1.txt\u0026quot;;\u003cbr\u003e\nprint \u0026quot;checking $var1 ...\u0026quot;.PHP_EOL;\u003cbr\u003e\nprint \u003ca href=\"/linkinfo\"\u003e@linkinfo\u003c/a\u003e($var1).PHP_EOL;\u003cbr\u003e\n$var1=\u0026quot;c:\\jump\\blabla\u0026quot;;\u003cbr\u003e\nprint \u0026quot;checking $var1 ...\u0026quot;.PHP_EOL;\u003cbr\u003e\nprint \u003ca href=\"/linkinfo\"\u003e@linkinfo\u003c/a\u003e($var1).PHP_EOL;\u003c/p\u003e\n\n\u003ch2 id=\"expected-result\"\u003eExpected result:\u003c/h2\u003e\n\n\u003cp\u003eWarning: linkinfo(): open_basedir restriction in effect\u003c/p\u003e\n\n\u003ch1 id=\"patch\"\u003ePatch\u003c/h1\u003e\n\n\u003cp\u003e\u003ca title=\"http://git.php.net/?p=php-src.git%3Ba=commit%3Bh=289cb0f77c28b80a779170711f5e4e92cdd4fbdb\" href=\"/redirect?url=http%3A%2F%2Fgit.php.net%2F%3Fp%3Dphp-src.git%253Ba%3Dcommit%253Bh%3D289cb0f77c28b80a779170711f5e4e92cdd4fbdb\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://git.php.net/?p=php-src.git%3Ba=commit%3Bh=289cb0f77c28b80a779170711f5e4e92cdd4fbdb\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch1 id=\"fixed-for-php-5-6-37-php-7-0-31-php-7-1-20-php-7-2-8\"\u003eFixed for PHP 5.6.37, PHP 7.0.31, PHP 7.1.20, PHP 7.2.8\u003c/h1\u003e\n\n\u003cp\u003e\u003ca title=\"http://php.net/ChangeLog-5.php#5.6.37\" href=\"/redirect?url=http%3A%2F%2Fphp.net%2FChangeLog-5.php%235.6.37\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://php.net/ChangeLog-5.php#5.6.37\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eBypass openbasedir restriction set by hosting provider on a shared environment\u003cbr\u003e\n \u003ca title=\"http://php.net/manual/en/ini.core.php#ini.open-basedir\" href=\"/redirect?url=http%3A%2F%2Fphp.net%2Fmanual%2Fen%2Fini.core.php%23ini.open-basedir\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://php.net/manual/en/ini.core.php#ini.open-basedir\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","bounty_amount":"500.0","formatted_bounty":"$500","weakness":{"id":26,"name":"Improper Access Control - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2018-10-31T23:06:35.997Z","allow_singular_disclosure_after":-68193664.2148192,"singular_disclosure_allowed":true,"vote_count":6,"voters":["sp1d3rs","bl4de","mygf","geeknik","khizer47","cryptographer"],"severity":{"rating":"medium","author_type":"Team"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":3131314,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"A CVE ID hasn't been assigned for this yet... Can you request one from the PHP team or from MITRE directly? We need one as part of our validation process.","markdown_message":"\u003cp\u003eA CVE ID hasn\u0026#39;t been assigned for this yet... Can you request one from the PHP team or from MITRE directly? We need one as part of our validation process.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-08-02T07:07:35.299Z","updated_at":"2018-08-02T07:07:35.299Z","actor":{"username":"reed","cleared":false,"url":"/reed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"ibb-php","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3167399,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"CVE-2018-15132 was assigned by MITRE.\n\nhttps://nvd.nist.gov/vuln/detail/CVE-2018-15132","markdown_message":"\u003cp\u003eCVE-2018-15132 was assigned by MITRE.\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"https://nvd.nist.gov/vuln/detail/CVE-2018-15132\" href=\"/redirect?url=https%3A%2F%2Fnvd.nist.gov%2Fvuln%2Fdetail%2FCVE-2018-15132\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://nvd.nist.gov/vuln/detail/CVE-2018-15132\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2018-08-09T12:46:37.755Z","updated_at":"2018-08-09T12:46:37.755Z","actor":{"username":"fms","cleared":false,"url":"/fms","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ibb-php","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3417105,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks for helping keep the Internet safe!","markdown_message":"\u003cp\u003eThanks for helping keep the Internet safe!\u003c/p\u003e\n","automated_response":false,"created_at":"2018-10-01T23:06:04.430Z","updated_at":"2018-10-01T23:06:04.430Z","actor":{"url":"/ibb-php","ibb":true,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/029/99087dbbdf52fc3ce3acbf16aa33a5c4f5e2c111_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"PHP (IBB)"}},"bounty_amount":"500.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"ibb-php","collaborator":{"username":"fms","url":"/fms"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3417107,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2018-10-01T23:06:18.219Z","updated_at":"2018-10-01T23:06:18.219Z","additional_data":{"old_severity":null,"new_severity":"Medium","old_severity_id":null,"new_severity_id":217916},"actor":{"username":"bonjarber","cleared":false,"url":"/bonjarber","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/cs3GAVsndJ7brWzkPmgMJDg5/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"ibb-php","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3417109,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2018-10-01T23:06:23.615Z","updated_at":"2018-10-01T23:06:23.615Z","actor":{"username":"bonjarber","cleared":false,"url":"/bonjarber","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/cs3GAVsndJ7brWzkPmgMJDg5/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"fms","url":"/fms"},"genius_execution_id":null,"team_handle":"ibb-php","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3417112,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-10-01T23:06:35.958Z","updated_at":"2018-10-01T23:06:35.958Z","first_to_agree":true,"actor":{"username":"bonjarber","cleared":false,"url":"/bonjarber","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/cs3GAVsndJ7brWzkPmgMJDg5/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"ibb-php","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3482276,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-10-15T15:29:51.273Z","updated_at":"2018-10-15T15:29:51.273Z","actor":{"username":"fms","cleared":false,"url":"/fms","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ibb-php","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3482277,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-10-15T15:29:51.331Z","updated_at":"2018-10-15T15:29:51.331Z","actor":{"username":"fms","cleared":false,"url":"/fms","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ibb-php","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}