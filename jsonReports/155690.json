{"id":155690,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNTU2OTA=","url":"https://hackerone.com/reports/155690","title":"Arbitrary File Upload in Logo \u0026 Log in image Theming setting.","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-07-31T21:57:59.882Z","submitted_at":"2016-07-31T21:57:59.882Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"bastianwelfrid","url":"/bastianwelfrid","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/002/235/b6171433f697da5922c6e93c1869d51876271c1b_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13291,"url":"https://hackerone.com/nextcloud","handle":"nextcloud","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Nextcloud","twitter_handle":"nextclouders","website":"https://nextcloud.com","about":"Access, share and protect your files, calendars, contacts, communication \u0026 more at home and in your enterprise."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2016-10-05T12:34:55.184Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2016-09-05T12:34:52.104Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi team\n\nFirst I think this vulnerability doesn't fall at your bug bounty program but this is a bad design that should fix right now cause if an attacker get admin access he still can upload a malicious file in client server side.\n\nI saw that Logo \u0026 Log in image allow to upload other files type example *.html and it'll execute in client server.\nOther case,I created an html code and saved it as image file,server still executed it as html file.\nThe Logo \u0026 Log in image will upload it into ../data/themedinstancelogo \u0026 ../data/themedbackgroundlogo\n\nGood news,I tried to upload an php file but server executed that file as text.\n\nPoC:\nUpload an html file through logo upload and Log in image and you will see that file will execute.\n\nhttp://example.com/nextcloud/data/themedinstancelogo\nhttp://example.com/nextcloud/data/themedbackgroundlogo\n\nRegards,\n","vulnerability_information_html":"\u003cp\u003eHi team\u003c/p\u003e\n\n\u003cp\u003eFirst I think this vulnerability doesn\u0026#39;t fall at your bug bounty program but this is a bad design that should fix right now cause if an attacker get admin access he still can upload a malicious file in client server side.\u003c/p\u003e\n\n\u003cp\u003eI saw that Logo \u0026amp; Log in image allow to upload other files type example *.html and it\u0026#39;ll execute in client server.\u003cbr\u003e\nOther case,I created an html code and saved it as image file,server still executed it as html file.\u003cbr\u003e\nThe Logo \u0026amp; Log in image will upload it into ../data/themedinstancelogo \u0026amp; ../data/themedbackgroundlogo\u003c/p\u003e\n\n\u003cp\u003eGood news,I tried to upload an php file but server executed that file as text.\u003c/p\u003e\n\n\u003cp\u003ePoC:\u003cbr\u003e\nUpload an html file through logo upload and Log in image and you will see that file will execute.\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"http://example.com/nextcloud/data/themedinstancelogo\" href=\"/redirect?url=http%3A%2F%2Fexample.com%2Fnextcloud%2Fdata%2Fthemedinstancelogo\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://example.com/nextcloud/data/themedinstancelogo\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\n\u003ca title=\"http://example.com/nextcloud/data/themedbackgroundlogo\" href=\"/redirect?url=http%3A%2F%2Fexample.com%2Fnextcloud%2Fdata%2Fthemedbackgroundlogo\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://example.com/nextcloud/data/themedbackgroundlogo\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eRegards,\u003c/p\u003e\n","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":108769,"file_name":"nc.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/108/769/a8cef138a50e2abba75f9bae8fcc1f85ecd525dc/nc.png?response-content-disposition=attachment%3B%20filename%3D%22nc.png%22%3B%20filename%2A%3DUTF-8%27%27nc.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ6J7UOFHP%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T043506Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDamJ7YR2N3cIBOa8zjuSmUd9OCX8zCykCDx%2B6kH2J%2BlQIhAPFk51DuoGb47ygm%2F46VUWXIRiNzzPuAJCxpuNY6C9r8KrQDCFIQARoMMDEzNjE5Mjc0ODQ5IgwfJ9Wm2OgZB0TD5wEqkQMAyHxawucw3AMqEaVZmpdf%2FWoK6P8gu%2FCj%2FoC7vu86houcl7d5S1aesU3sbrOzgm6RSEhwz%2FFS3jL7D6T4JI4Ce1ND%2FrgO0lyXrQzDIcV61dzQW3FvNLr0ZImyyUdtac%2BXOj%2B4Yuxg3B%2Fw8%2FASrjXwhjBS66Kymk3L6dUfBdgwlGyaWjSrEj7pUe4QmHItRfpiYrIugF6V0YbiwTzCRnupZGkhFUvdnKltp%2B4hMIJ8ZpZXjRaPMFGYbJODmmGmpbXrkLNmtpD9ssAfsLLmMNbkAbfGTVhz1jb8jNtS70QChWZUcaVF%2BUJ%2BnjyviI%2BzOI3PvJo6%2BFF7nuwLNAutvngzDIQqSSVMoO%2F3MB45%2Bi7mOnnapSDDsV974XkQgCuM7vsb5p2hLCxzrxps5NEHGajQr5tkHe3qivszLUiVfsV43w8FYD%2BBONxEK7W9P8Fz8NZ67SyH7GG2ksQHMqmv0OcEaprPoRqnV3X2FUQMilKfrm8Mwo6y2b3BolwJdahB%2FiN%2B4DEDiSex%2FihlgZtj7Y4SxDDk%2FKn%2FBTrqAf559VpL8gNLdFBoVG3N%2FZOK1jnsPcfoIUSZtPAKUZCx%2FfYM8b4F5pg%2FUgEn1Lv%2B2LBdmNBasw6RmzajA5OSfdAMndyjJN9XxpB%2BQCxuWhR%2B4l3UYvcHCs0ptmeXrxe03i6oCQg6cNND1wBmViOKSrRB7ycvKEbOUFZtkHoRDVaID3Z%2BuOzyOMaLFXSvzsVsAcCFgFhIk5QJcY%2B1scZVna72pH8jnKw%2FwC1cIv1j%2FAmz0zBabFT7deSC5tUMl0pZQVYKiEGsgryYN9fSfaoMv2wR80e4kst1hVdlJHDktel9plUkLBliVB9%2BDQ%3D%3D\u0026X-Amz-Signature=82c19ddbd1c4cf6efa65925a6714f60caa458e7ca8724daea020c215dbe6b09a","file_size":32109,"type":"image/png"}],"allow_singular_disclosure_at":"2016-10-05T12:34:52.171Z","allow_singular_disclosure_after":-133545614.441132,"singular_disclosure_allowed":true,"vote_count":2,"voters":["apapedulimu","dyabla"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1098687,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks a lot for reporting this potential issue back to us!\n\nOur security team will take a look at this issue as soon as possible. We will reply to your report within 72 hours, usually much faster. For obvious reasons we'd like to ask you to not disclose this issue to any other party.","markdown_message":"\u003cp\u003eThanks a lot for reporting this potential issue back to us!\u003c/p\u003e\n\n\u003cp\u003eOur security team will take a look at this issue as soon as possible. We will reply to your report within 72 hours, usually much faster. For obvious reasons we\u0026#39;d like to ask you to not disclose this issue to any other party.\u003c/p\u003e\n","automated_response":true,"created_at":"2016-07-31T21:58:00.147Z","updated_at":"2016-07-31T21:58:00.147Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Nextcloud"}},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1099055,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thanks a lot for your report. Much appreciated!\n\nAt the moment we consider this accepted behaviour since an administrator can anyways achieve remote code execution using other vectors as described on https://nextcloud.com/security/threat-model/. Also we require the ability to upload SVG files for the logo which anyways could contain Javascript. (parsing the SVG file server-side seems error-prone)\n\nI've filed an ticket and will discuss internally on how to proceed here. \n\nWe'd like to encourage to keep hacking. We're looking forward to your next report!","markdown_message":"\u003cp\u003eThanks a lot for your report. Much appreciated!\u003c/p\u003e\n\n\u003cp\u003eAt the moment we consider this accepted behaviour since an administrator can anyways achieve remote code execution using other vectors as described on \u003ca title=\"https://nextcloud.com/security/threat-model/\" href=\"/redirect?url=https%3A%2F%2Fnextcloud.com%2Fsecurity%2Fthreat-model%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://nextcloud.com/security/threat-model/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e. Also we require the ability to upload SVG files for the logo which anyways could contain Javascript. (parsing the SVG file server-side seems error-prone)\u003c/p\u003e\n\n\u003cp\u003eI\u0026#39;ve filed an ticket and will discuss internally on how to proceed here. \u003c/p\u003e\n\n\u003cp\u003eWe\u0026#39;d like to encourage to keep hacking. We\u0026#39;re looking forward to your next report!\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-01T07:31:23.903Z","updated_at":"2016-08-01T07:31:23.903Z","actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1099056,"is_internal":false,"editable":false,"type":"Activities::SwagAwarded","message":"While we can't award a monetary award for this since no privilege escalation is possible we'd be be happy to provide some swag as a token of appreciation.","markdown_message":"\u003cp\u003eWhile we can\u0026#39;t award a monetary award for this since no privilege escalation is possible we\u0026#39;d be be happy to provide some swag as a token of appreciation.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-01T07:32:44.805Z","updated_at":"2016-08-01T07:32:44.805Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Nextcloud"}},"reporter":{"username":"bastianwelfrid","url":"/bastianwelfrid"},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1127445,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you for your response and your appreciation","markdown_message":"\u003cp\u003eThank you for your response and your appreciation\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-15T17:38:43.491Z","updated_at":"2016-08-15T17:38:43.491Z","actor":{"username":"bastianwelfrid","cleared":false,"url":"/bastianwelfrid","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/235/b6171433f697da5922c6e93c1869d51876271c1b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1174094,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"While we consider this an accepted risk, researching this has shown some significant performance optimizations. So we're considering this a successful case. https://github.com/nextcloud/server/pull/1103 shows the new loading logic for the background image.\n\nWith regard for the logo, no new logic has been added as SVG files may as well be a valid logo. We don't think it's a good idea to try to sanitize that one, when our threat model anyways points out that risk.\n\nThanks a lot for reporting this back to us!","markdown_message":"\u003cp\u003eWhile we consider this an accepted risk, researching this has shown some significant performance optimizations. So we\u0026#39;re considering this a successful case. \u003ca title=\"https://github.com/nextcloud/server/pull/1103\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fnextcloud%2Fserver%2Fpull%2F1103\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/nextcloud/server/pull/1103\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e shows the new loading logic for the background image.\u003c/p\u003e\n\n\u003cp\u003eWith regard for the logo, no new logic has been added as SVG files may as well be a valid logo. We don\u0026#39;t think it\u0026#39;s a good idea to try to sanitize that one, when our threat model anyways points out that risk.\u003c/p\u003e\n\n\u003cp\u003eThanks a lot for reporting this back to us!\u003c/p\u003e\n","automated_response":false,"created_at":"2016-09-05T12:34:40.467Z","updated_at":"2016-09-05T12:34:46.483Z","actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"bastianwelfrid","url":"/bastianwelfrid"},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1174095,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"","markdown_message":"","automated_response":false,"created_at":"2016-09-05T12:34:49.119Z","updated_at":"2016-09-05T12:34:49.119Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Nextcloud"}},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1174096,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-09-05T12:34:52.131Z","updated_at":"2016-09-05T12:34:52.131Z","first_to_agree":true,"actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1233132,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-10-05T12:34:55.199Z","updated_at":"2016-10-05T12:34:55.199Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Nextcloud"}},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}