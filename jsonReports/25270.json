{"id":25270,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yNTI3MA==","url":"https://hackerone.com/reports/25270","title":"User can request for password reset link without giving his website, eventhough he have it","state":"Closed","substate":"informative","readable_substate":"Informative","created_at":"2014-08-19T16:48:09.719Z","submitted_at":"2014-08-19T16:48:09.719Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"born2hack","url":"/born2hack","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":41,"url":"https://hackerone.com/cloudflare","handle":"cloudflare","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/041/a819f0d518a4854df667be26210167805f38a6a4_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/041/a819f0d518a4854df667be26210167805f38a6a4_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Cloudflare Vulnerability Disclosure","twitter_handle":"cloudflare","website":"https://www.cloudflare.com/disclosure","about":""}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2014-09-19T18:02:28.400Z","bug_reporter_agreed_on_going_public_at":"2014-08-20T18:02:25.146Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi,\r\nI found that , when a user ask for password reset  at https://www.cloudflare.com/login\r\nHe need to give his email address as well as one of the sites if he have .\r\nBut your site is sending  password reset link to the user who have added  websites to his account , but not entering any one of the name while requesting for password reset.\r\nIam able to password reset eventhough , i have added a website to my account.\r\nI found this so, i reported.\r\nSorry, if this an intentional design  from your side .\r\nThanks and regards\r\nHaji","vulnerability_information_html":"\u003cp\u003eHi,\u003cbr\u003e\nI found that , when a user ask for password reset  at \u003ca title=\"https://www.cloudflare.com/login\" href=\"/redirect?url=https%3A%2F%2Fwww.cloudflare.com%2Flogin\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.cloudflare.com/login\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nHe need to give his email address as well as one of the sites if he have .\u003cbr\u003e\nBut your site is sending  password reset link to the user who have added  websites to his account , but not entering any one of the name while requesting for password reset.\u003cbr\u003e\nIam able to password reset eventhough , i have added a website to my account.\u003cbr\u003e\nI found this so, i reported.\u003cbr\u003e\nSorry, if this an intentional design  from your side .\u003cbr\u003e\nThanks and regards\u003cbr\u003e\nHaji\u003c/p\u003e\n","weakness":{"id":57,"name":"Violation of Secure Design Principles"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2014-09-19T18:02:25.365Z","allow_singular_disclosure_after":-198069000.18115416,"singular_disclosure_allowed":true,"vote_count":2,"voters":["mygf","0x08"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":112653,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Hi,\n\nThanks for your report.\n\nCan you please provide exact steps to duplicate this? I am not able to duplicate what you're reporting at this time.\n\nThanks!","markdown_message":"\u003cp\u003eHi,\u003c/p\u003e\n\n\u003cp\u003eThanks for your report.\u003c/p\u003e\n\n\u003cp\u003eCan you please provide exact steps to duplicate this? I am not able to duplicate what you\u0026#39;re reporting at this time.\u003c/p\u003e\n\n\u003cp\u003eThanks!\u003c/p\u003e\n","automated_response":false,"created_at":"2014-08-20T16:32:26.065Z","updated_at":"2014-08-20T16:32:26.065Z","actor":{"username":"justin","cleared":false,"url":"/justin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/714/460ff848ebf95933694f8e6c967854da33ee949e_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"cloudflare","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":112689,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Hi,\nFirst see this  https://www.cloudflare.com/forgot-password\nHere your site has given this information. \n(To reset your password, enter your email address and one website that you have signed up. If you haven't signed any websites up yet, leave the field blank. We'll send you an email with instructions of what to do next.)\nFrom this it is clear that to ask for password reset link user has to enter \na) Email address ,  b) One of the website (if present in the account).\nConsider two situations now\nCase 1 :\nUser has not added any website to his account.\nHere he can just ask for password reset link by entering only email address. No need for website.\n\nCase 2 :\nUser has added one or more website to his account.\nThe bug exists in this case. As user has added a website to his account , then definately he should enter both\n a) email address , b) Website name   \nfor requesting password reset.\nBut here i observed that eventhough user has added any website to his account ,  He can just leave (one of websites) field , for requesting password reset link.\n\nNow you can see that  there is no difference between both the cases for asking password reset .\nAs a result security flaw exist in this particular place.\n\nMy point here is to draw your attention towards  \"Case 2 \".\nIf a user has added any website to his account , then definately he should enter both the fields to ask for password reset, other wise there will be no security in this particular field.\n\nFix:\nMake both the fields [  a) email address  ,   b) Website name ]  mandatory for password reset once a user has added one or more of the websites to his account\n\nIf any further information required , please let me know.\nThanks and regards\nHaji\n \n","markdown_message":"\u003cp\u003eHi,\u003cbr\u003e\nFirst see this  \u003ca title=\"https://www.cloudflare.com/forgot-password\" href=\"/redirect?url=https%3A%2F%2Fwww.cloudflare.com%2Fforgot-password\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.cloudflare.com/forgot-password\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nHere your site has given this information. \u003cbr\u003e\n(To reset your password, enter your email address and one website that you have signed up. If you haven\u0026#39;t signed any websites up yet, leave the field blank. We\u0026#39;ll send you an email with instructions of what to do next.)\u003cbr\u003e\nFrom this it is clear that to ask for password reset link user has to enter \u003cbr\u003e\na) Email address ,  b) One of the website (if present in the account).\u003cbr\u003e\nConsider two situations now\u003cbr\u003e\nCase 1 :\u003cbr\u003e\nUser has not added any website to his account.\u003cbr\u003e\nHere he can just ask for password reset link by entering only email address. No need for website.\u003c/p\u003e\n\n\u003cp\u003eCase 2 :\u003cbr\u003e\nUser has added one or more website to his account.\u003cbr\u003e\nThe bug exists in this case. As user has added a website to his account , then definately he should enter both\u003cbr\u003e\n a) email address , b) Website name\u003cbr\u003e\u003cbr\u003e\nfor requesting password reset.\u003cbr\u003e\nBut here i observed that eventhough user has added any website to his account ,  He can just leave (one of websites) field , for requesting password reset link.\u003c/p\u003e\n\n\u003cp\u003eNow you can see that  there is no difference between both the cases for asking password reset .\u003cbr\u003e\nAs a result security flaw exist in this particular place.\u003c/p\u003e\n\n\u003cp\u003eMy point here is to draw your attention towards  \u0026quot;Case 2 \u0026quot;.\u003cbr\u003e\nIf a user has added any website to his account , then definately he should enter both the fields to ask for password reset, other wise there will be no security in this particular field.\u003c/p\u003e\n\n\u003cp\u003eFix:\u003cbr\u003e\nMake both the fields [  a) email address  ,   b) Website name ]  mandatory for password reset once a user has added one or more of the websites to his account\u003c/p\u003e\n\n\u003cp\u003eIf any further information required , please let me know.\u003cbr\u003e\nThanks and regards\u003cbr\u003e\nHaji\u003c/p\u003e\n","automated_response":false,"created_at":"2014-08-20T16:51:55.607Z","updated_at":"2014-08-20T16:51:55.607Z","actor":{"username":"born2hack","cleared":false,"url":"/born2hack","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"cloudflare","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":112711,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Hi,\n\nI don't quite follow the issue with case 2 -- where a user has a domain in their account already.  It's not possible to do a forgot password reset WITHOUT entering a domain if you already have a domain in your account. I've confirmed this is indeed the case.  So I'm not following what you're indicating is the specific issue, that field already is required in case 2 if the use already has a domain in their account.\n\nThanks.","markdown_message":"\u003cp\u003eHi,\u003c/p\u003e\n\n\u003cp\u003eI don\u0026#39;t quite follow the issue with case 2 -- where a user has a domain in their account already.  It\u0026#39;s not possible to do a forgot password reset WITHOUT entering a domain if you already have a domain in your account. I\u0026#39;ve confirmed this is indeed the case.  So I\u0026#39;m not following what you\u0026#39;re indicating is the specific issue, that field already is required in case 2 if the use already has a domain in their account.\u003c/p\u003e\n\n\u003cp\u003eThanks.\u003c/p\u003e\n","automated_response":false,"created_at":"2014-08-20T17:07:20.358Z","updated_at":"2014-08-20T17:07:20.358Z","actor":{"username":"justin","cleared":false,"url":"/justin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/714/460ff848ebf95933694f8e6c967854da33ee949e_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"cloudflare","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":112740,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Steps to reproduce:\n1) Login to https://www.cloudfare.com/login\nand add a website like this  http://prntscr.com/4ept15  in your account.\n2) Logout and go to  https://www.cloudflare.com/forgot-password  .\n3) Enter only email address like this  http://prntscr.com/4eptwi   and the request will be processed like this http://prntscr.com/4epued and you will get reset link at the email address.\nThis part is completed.\n4) And  password reset link asked by entering both the fields as well like this\n http://prntscr.com/4epvvi\nis  working fine. But the bug exists as illustrated in above 3 steps.\nSo, by not entering any website name , user can still ask for password reset , eventhough he have website added in his account.\n\nRegards\nHaji\n","markdown_message":"\u003cp\u003eSteps to reproduce:\u003cbr\u003e\n1) Login to \u003ca title=\"https://www.cloudfare.com/login\" href=\"/redirect?url=https%3A%2F%2Fwww.cloudfare.com%2Flogin\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.cloudfare.com/login\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nand add a website like this  \u003ca title=\"http://prntscr.com/4ept15\" href=\"/redirect?url=http%3A%2F%2Fprntscr.com%2F4ept15\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://prntscr.com/4ept15\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e  in your account.\u003cbr\u003e\n2) Logout and go to  \u003ca title=\"https://www.cloudflare.com/forgot-password\" href=\"/redirect?url=https%3A%2F%2Fwww.cloudflare.com%2Fforgot-password\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.cloudflare.com/forgot-password\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e  .\u003cbr\u003e\n3) Enter only email address like this  \u003ca title=\"http://prntscr.com/4eptwi\" href=\"/redirect?url=http%3A%2F%2Fprntscr.com%2F4eptwi\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://prntscr.com/4eptwi\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e   and the request will be processed like this \u003ca title=\"http://prntscr.com/4epued\" href=\"/redirect?url=http%3A%2F%2Fprntscr.com%2F4epued\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://prntscr.com/4epued\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e and you will get reset link at the email address.\u003cbr\u003e\nThis part is completed.\u003cbr\u003e\n4) And  password reset link asked by entering both the fields as well like this\u003cbr\u003e\n \u003ca title=\"http://prntscr.com/4epvvi\" href=\"/redirect?url=http%3A%2F%2Fprntscr.com%2F4epvvi\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://prntscr.com/4epvvi\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nis  working fine. But the bug exists as illustrated in above 3 steps.\u003cbr\u003e\nSo, by not entering any website name , user can still ask for password reset , eventhough he have website added in his account.\u003c/p\u003e\n\n\u003cp\u003eRegards\u003cbr\u003e\nHaji\u003c/p\u003e\n","automated_response":false,"created_at":"2014-08-20T17:24:29.390Z","updated_at":"2014-08-20T17:24:29.390Z","actor":{"username":"born2hack","cleared":false,"url":"/born2hack","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"cloudflare","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":112760,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"Hi,\n\nThe domain in the account is not actually active on CloudFlare yet -- which is why it's not required during the password reset step of the forgot password form.\n\nOnly validated/active domains apply when using the forgot password form.  We would not consider this to be a vulnerability as it's a design choice we've made. ","markdown_message":"\u003cp\u003eHi,\u003c/p\u003e\n\n\u003cp\u003eThe domain in the account is not actually active on CloudFlare yet -- which is why it\u0026#39;s not required during the password reset step of the forgot password form.\u003c/p\u003e\n\n\u003cp\u003eOnly validated/active domains apply when using the forgot password form.  We would not consider this to be a vulnerability as it\u0026#39;s a design choice we\u0026#39;ve made. \u003c/p\u003e\n","automated_response":false,"created_at":"2014-08-20T17:33:57.354Z","updated_at":"2014-08-20T17:33:57.354Z","actor":{"username":"justin","cleared":false,"url":"/justin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/714/460ff848ebf95933694f8e6c967854da33ee949e_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"cloudflare","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":112792,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Then when i enter my domain name (Which you are saying as not validated)  as well as email address\niam getting reset link.\nHow??\nWhat about that?\n","markdown_message":"\u003cp\u003eThen when i enter my domain name (Which you are saying as not validated)  as well as email address\u003cbr\u003e\niam getting reset link.\u003cbr\u003e\nHow??\u003cbr\u003e\nWhat about that?\u003c/p\u003e\n","automated_response":false,"created_at":"2014-08-20T17:46:23.436Z","updated_at":"2014-08-20T17:46:23.436Z","actor":{"username":"born2hack","cleared":false,"url":"/born2hack","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"cloudflare","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":112835,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi,\n\nThe form is acting as we intend it to at this time. The unverified domain is not required yet since it is not fully activated in the account. At that point it's considered optional. If you supply it then it will be accepted, but since the domain is not verified yet it's not a required value.","markdown_message":"\u003cp\u003eHi,\u003c/p\u003e\n\n\u003cp\u003eThe form is acting as we intend it to at this time. The unverified domain is not required yet since it is not fully activated in the account. At that point it\u0026#39;s considered optional. If you supply it then it will be accepted, but since the domain is not verified yet it\u0026#39;s not a required value.\u003c/p\u003e\n","automated_response":false,"created_at":"2014-08-20T17:57:40.419Z","updated_at":"2014-08-20T17:57:40.419Z","actor":{"username":"justin","cleared":false,"url":"/justin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/714/460ff848ebf95933694f8e6c967854da33ee949e_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"cloudflare","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":112845,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2014-08-20T18:02:25.162Z","updated_at":"2014-08-20T18:02:25.162Z","actor":{"username":"born2hack","cleared":false,"url":"/born2hack","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"cloudflare","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":129842,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2014-09-19T18:02:28.412Z","updated_at":"2014-09-19T18:02:28.412Z","actor":{"url":"/cloudflare","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/041/a819f0d518a4854df667be26210167805f38a6a4_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Cloudflare Vulnerability Disclosure"}},"genius_execution_id":null,"team_handle":"cloudflare","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}