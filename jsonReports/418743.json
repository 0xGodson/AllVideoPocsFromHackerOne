{"id":418743,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC80MTg3NDM=","url":"https://hackerone.com/reports/418743","title":"Email Spoofing Possible on djangoproject.com Email Domain","state":"Closed","substate":"not-applicable","severity_rating":"medium","readable_substate":"N/A","created_at":"2018-10-03T22:19:36.475Z","submitted_at":"2018-10-03T22:19:36.475Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"greenwolf","url":"/greenwolf","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/367/843/95ce1166f2f3d48a4133dc0210c03ccc15f385a2_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":23,"url":"https://hackerone.com/django","handle":"django","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/023/b457fd4bd71786ab14973cc3d53f9faf4d6c38ea_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/023/b457fd4bd71786ab14973cc3d53f9faf4d6c38ea_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Django","twitter_handle":null,"website":"","about":""}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2018-10-05T12:56:49.573Z","bug_reporter_agreed_on_going_public_at":"2018-10-05T08:21:44.372Z","team_member_agreed_on_going_public_at":"2018-10-05T12:56:49.531Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"**Summary:** Due to lacking a SPF and DMARC record it is possible to spoof emails from djangoproject.com. This could potentially be used to trick employees, customers or clients via phishing emails.  \n\n**Description:** Mail servers rely on both SPF and DMARC to properly deal with email spoofing. SPF shows what servers are allowed to send emails for the current domain. However when a mail does not originate from one of the listed IP's or domains it does not automatically get rejected. What happens to the spoofed email relies of the DMARC policy of the domain. If there is no DMARC policy or the DMARC policy contains 'p=none;' then no action is taken and the email is accepted, even though SPF has failed. In this case there is neither a SPF or a DMARC record.\n\n## Steps To Reproduce:\n\n  1.  You can verify the missing SPF and DMARC policy with the following commands on Linux or OSX:\ngit clone https://github.com/BishopFox/spoofcheck\ncd spoofcheck; python spoofcheck.py djangoproject.com\nVerify the lines: \n[+] djangoproject.com has no SPF record!\n[*] No DMARC record found. Looking for organizational record\n[+] No organizational DMARC record\n  2. You can test if spoofing is legitimate by sending a spoofed email using Send Grid. I have attached a small bash script which can do this for you, but you will need to provide a SendGrid username (SGUSER) and password (SGPASS) to use it. Also make sure to update the recipient email address (SGTO).\n\n\n## Supporting Material/References:\n\n  * I have attached an image of a spoofed email from vimeo.com to my outlook account called 'Vimeo-Spoofed-Email.png'. \n  * I have attached the output of spoofcheck showing the misconfigured DMARC record called 'misconfigured-dns.txt'. \n  * I have attached a small sendgrid script for you to test the spoofing called 'spooftest.sh'.\n\n## Impact\n\nBy exploiting this issue, attackers can spoof emails from your domain, which could be used to target your customers or employees with phishing emails. \n\nAs 90% of security breaches and compromises start with Phishing emails, allowing your domain to be spoofed removes an additional layer of protection for your customers, as they will see a legitimate from address at the top of a non legitimate email. This means an attacker doesn't have to rely on techniques such as character replacement which users have been trained to spot. E.g goggle.com or microsift.com\n\nTo fix the issue, a DMARC record containing 'p=reject;' should be added, which will cause spoofed emails to be rejected by the recipients mailbox.","vulnerability_information_html":"\u003cp\u003e\u003cstrong\u003eSummary:\u003c/strong\u003e Due to lacking a SPF and DMARC record it is possible to spoof emails from djangoproject.com. This could potentially be used to trick employees, customers or clients via phishing emails.  \u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eDescription:\u003c/strong\u003e Mail servers rely on both SPF and DMARC to properly deal with email spoofing. SPF shows what servers are allowed to send emails for the current domain. However when a mail does not originate from one of the listed IP\u0026#39;s or domains it does not automatically get rejected. What happens to the spoofed email relies of the DMARC policy of the domain. If there is no DMARC policy or the DMARC policy contains \u0026#39;p=none;\u0026#39; then no action is taken and the email is accepted, even though SPF has failed. In this case there is neither a SPF or a DMARC record.\u003c/p\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps To Reproduce:\u003c/h2\u003e\n\n\u003col\u003e\n\u003cli\u003e You can verify the missing SPF and DMARC policy with the following commands on Linux or OSX:\ngit clone \u003ca title=\"https://github.com/BishopFox/spoofcheck\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2FBishopFox%2Fspoofcheck\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/BishopFox/spoofcheck\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\ncd spoofcheck; python spoofcheck.py djangoproject.com\nVerify the lines: \n[+] djangoproject.com has no SPF record!\n[*] No DMARC record found. Looking for organizational record\n[+] No organizational DMARC record\u003c/li\u003e\n\u003cli\u003eYou can test if spoofing is legitimate by sending a spoofed email using Send Grid. I have attached a small bash script which can do this for you, but you will need to provide a SendGrid username (SGUSER) and password (SGPASS) to use it. Also make sure to update the recipient email address (SGTO).\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003ch2 id=\"supporting-material-references\"\u003eSupporting Material/References:\u003c/h2\u003e\n\n\u003cul\u003e\n\u003cli\u003eI have attached an image of a spoofed email from vimeo.com to my outlook account called \u0026#39;Vimeo-Spoofed-Email.png\u0026#39;. \u003c/li\u003e\n\u003cli\u003eI have attached the output of spoofcheck showing the misconfigured DMARC record called \u0026#39;misconfigured-dns.txt\u0026#39;. \u003c/li\u003e\n\u003cli\u003eI have attached a small sendgrid script for you to test the spoofing called \u0026#39;spooftest.sh\u0026#39;.\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eBy exploiting this issue, attackers can spoof emails from your domain, which could be used to target your customers or employees with phishing emails. \u003c/p\u003e\n\n\u003cp\u003eAs 90% of security breaches and compromises start with Phishing emails, allowing your domain to be spoofed removes an additional layer of protection for your customers, as they will see a legitimate from address at the top of a non legitimate email. This means an attacker doesn\u0026#39;t have to rely on techniques such as character replacement which users have been trained to spot. E.g goggle.com or microsift.com\u003c/p\u003e\n\n\u003cp\u003eTo fix the issue, a DMARC record containing \u0026#39;p=reject;\u0026#39; should be added, which will cause spoofed emails to be rejected by the recipients mailbox.\u003c/p\u003e\n","weakness":{"id":65,"name":"Business Logic Errors"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":355105,"file_name":"spooftest.sh","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/355/105/79be1f3afc10d8f63efb5e07f2f25cd3aebbf6dd/spooftest.sh?response-content-disposition=attachment%3B%20filename%3D%22spooftest.sh%22%3B%20filename%2A%3DUTF-8%27%27spooftest.sh\u0026response-content-type=text%2Fx-shellscript\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ4BCTVX7H%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T055510Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQD9KoIrMtYjsPMNAoz3fkIjMCGzGeE4AC6fZNsgc%2FNK1QIhANJsfJivva8u7YF1XCVwz2O44bXLlD4DSJhj7xaMke6RKrQDCFYQARoMMDEzNjE5Mjc0ODQ5IgzmYD94JaVjjIU2krEqkQPkOp7o1Y%2F3O46uPVkJpWKluhPjw6yqgkTOXGekCyVjJWTTKaV%2Fg4VslprjcyOrHq6Kvjx6FFrvI%2F0oeazfhhuVbsGzIX%2FDNyDl86o7E8p7xdE9njyFrZSTuG%2BcoCSQTNZm6K7xytZ808%2FmbOq1EsQaswjTfJE49knSO3dd6P9o4TMruMzu8iALfM0IqlU4CgtICPjNu1SwD5gIiOjS3JXo97WJ%2FeXaWM7uiiaZIfnwM1%2FJh%2B%2Bf4y2CVgdWsivBsUOOKr5Ffs4r9dvRgpxa%2BT%2FmspuhFLSjdwidy384ywNVej%2Fu5TtU0RmHvya7IsEPuuyEVKZ9GXWYeHJPMuJLhkj%2F9NgnnqTSYay6UqseBG9goY2oONYS%2Fy7uIy6pIkzSjH260rcLKe0FPxGZ3OZNA097jOWSnOIGGcV1YZW18F%2FQaHb3tqnILMft5hGAudbC%2F2kJRmQyb4mArK%2Bic9Gh50TdBT%2BX29t3Wo5dLJweBsKIOOdeF41%2BqY1abZEgoOIbiscyoLBMO4ChJxBEiM%2By%2Bjg8FjC%2B6ar%2FBTrqAdRlQf357Lw7olVqK9BuDw0RNDzAgG1%2BRjmEy94ivfSQKRkYnOaGVWNx1MekakiogYuOKzbAujbete9Cin2JFJP4a22qFOVAg7tsJ%2FeJITiLIkogRaku8DmGovq%2B04Yxq2jfRp5la%2FeG3Fqca5Jc2WM%2BO7QxCdRE21wSAgKnCwsy8vQV1X0gGJjUOV6UsIimNdWCtKUego7nGl1OprelVr%2FiPIFvPy%2BhWrWWJF9nHO59wa4OZtoRJ5df5%2ByoAAAuIWDBKZfHRv45K8z7hZFmm4sjyreHKi0tXU9Fadu828o5w%2B3CHi4r%2BAT0Pg%3D%3D\u0026X-Amz-Signature=06ce0c56421317210d44f8c61d0d8df631f5f92e1718cf708ef4b249e45973c7","file_size":595,"type":"text/x-shellscript"},{"id":355106,"file_name":"Spoofed-Email.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/355/106/559d9109d112edd6c63f327084206de6bea7402b/Spoofed-Email.png?response-content-disposition=attachment%3B%20filename%3D%22Spoofed-Email.png%22%3B%20filename%2A%3DUTF-8%27%27Spoofed-Email.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ4BCTVX7H%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T055510Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQD9KoIrMtYjsPMNAoz3fkIjMCGzGeE4AC6fZNsgc%2FNK1QIhANJsfJivva8u7YF1XCVwz2O44bXLlD4DSJhj7xaMke6RKrQDCFYQARoMMDEzNjE5Mjc0ODQ5IgzmYD94JaVjjIU2krEqkQPkOp7o1Y%2F3O46uPVkJpWKluhPjw6yqgkTOXGekCyVjJWTTKaV%2Fg4VslprjcyOrHq6Kvjx6FFrvI%2F0oeazfhhuVbsGzIX%2FDNyDl86o7E8p7xdE9njyFrZSTuG%2BcoCSQTNZm6K7xytZ808%2FmbOq1EsQaswjTfJE49knSO3dd6P9o4TMruMzu8iALfM0IqlU4CgtICPjNu1SwD5gIiOjS3JXo97WJ%2FeXaWM7uiiaZIfnwM1%2FJh%2B%2Bf4y2CVgdWsivBsUOOKr5Ffs4r9dvRgpxa%2BT%2FmspuhFLSjdwidy384ywNVej%2Fu5TtU0RmHvya7IsEPuuyEVKZ9GXWYeHJPMuJLhkj%2F9NgnnqTSYay6UqseBG9goY2oONYS%2Fy7uIy6pIkzSjH260rcLKe0FPxGZ3OZNA097jOWSnOIGGcV1YZW18F%2FQaHb3tqnILMft5hGAudbC%2F2kJRmQyb4mArK%2Bic9Gh50TdBT%2BX29t3Wo5dLJweBsKIOOdeF41%2BqY1abZEgoOIbiscyoLBMO4ChJxBEiM%2By%2Bjg8FjC%2B6ar%2FBTrqAdRlQf357Lw7olVqK9BuDw0RNDzAgG1%2BRjmEy94ivfSQKRkYnOaGVWNx1MekakiogYuOKzbAujbete9Cin2JFJP4a22qFOVAg7tsJ%2FeJITiLIkogRaku8DmGovq%2B04Yxq2jfRp5la%2FeG3Fqca5Jc2WM%2BO7QxCdRE21wSAgKnCwsy8vQV1X0gGJjUOV6UsIimNdWCtKUego7nGl1OprelVr%2FiPIFvPy%2BhWrWWJF9nHO59wa4OZtoRJ5df5%2ByoAAAuIWDBKZfHRv45K8z7hZFmm4sjyreHKi0tXU9Fadu828o5w%2B3CHi4r%2BAT0Pg%3D%3D\u0026X-Amz-Signature=7e40c4b9a523c79439b274fc19d3b7a47fb6e94492e9236624be6c12c13d52ee","file_size":201340,"type":"image/png"}],"allow_singular_disclosure_at":null,"vote_count":6,"voters":["sameerphad72","eveeez","greenwolf","noobiekid","onerealdem","bhagathhacker"],"severity":{"rating":"medium","author_type":"User"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":3431598,"is_internal":false,"editable":false,"type":"Activities::BugNotApplicable","message":"","markdown_message":"","automated_response":false,"created_at":"2018-10-03T22:32:56.154Z","updated_at":"2018-10-03T22:32:56.154Z","actor":{"username":"timgraham","cleared":false,"url":"/timgraham","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"django","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3437735,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Good Morning, if you believe this is not a risk and will be not be address the emailing spoofing for your domain, please could you publicly disclose the report. ","markdown_message":"\u003cp\u003eGood Morning, if you believe this is not a risk and will be not be address the emailing spoofing for your domain, please could you publicly disclose the report. \u003c/p\u003e\n","automated_response":false,"created_at":"2018-10-05T08:21:44.393Z","updated_at":"2018-10-05T08:21:44.393Z","first_to_agree":true,"actor":{"username":"greenwolf","cleared":false,"url":"/greenwolf","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/367/843/95ce1166f2f3d48a4133dc0210c03ccc15f385a2_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"django","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3439415,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-10-05T12:56:49.552Z","updated_at":"2018-10-05T12:56:49.552Z","actor":{"username":"timgraham","cleared":false,"url":"/timgraham","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"django","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3439416,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-10-05T12:56:49.587Z","updated_at":"2018-10-05T12:56:49.587Z","actor":{"username":"timgraham","cleared":false,"url":"/timgraham","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"django","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}