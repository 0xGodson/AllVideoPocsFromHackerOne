{"id":220864,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMjA4NjQ=","url":"https://hackerone.com/reports/220864","title":"Unauthorized access to attachments details of Private Calendar appointments  (Access control issue)","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2017-04-13T21:02:04.006Z","submitted_at":"2017-04-13T21:02:04.006Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"indoappsec","url":"/indoappsec","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/QUAjqUf576QNBhxg691WB8YG/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":8906,"url":"https://hackerone.com/open-xchange","handle":"open-xchange","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/JtYLEsu5yRZxGitSmAjeAFtK/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/JtYLEsu5yRZxGitSmAjeAFtK/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Open-Xchange","twitter_handle":"openxchange","website":"https://www.open-xchange.com/","about":"Messaging, collaboration and office productivity software for service providers"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2017-08-17T20:45:15.801Z","bug_reporter_agreed_on_going_public_at":"2017-07-18T20:45:09.174Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi Team,\n\nDescription : In calendar folder there is a permission settings where user can be assigned as read only user of it's own objects . User with this permission shouldn't be able to  view private appointments and it's attachments  . There is request of getting attachment details from server which is vulnerable to IDOR attack . Which discloses attachment details of private document of appointment in calendar. \n\nPermission : Member should have read only permission of it's own objects.\n\nVulnerable HTTP request : \n\nGET /appsuite/api/attachment?action=all\u0026module=1\u0026attached=[attachment_ID ]\u0026folder=[folder_ID]\u0026columns=1%2C800%2C801%2C802%2C803%2C804%2C805\u0026session=[session_token] HTTP/1.1\nHost: sandbox.open-xchange.com\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.11; rv:52.0) Gecko/20100101 Firefox/52.0\nAccept: application/json, text/javascript, */*; q=0.01\nAccept-Language: en-US,en;q=0.5\nContent-Type: application/x-www-form-urlencoded\nX-Requested-With: XMLHttpRequest\nReferer: https://sandbox.open-xchange.com/appsuite/\nCookie: [Cookie_Values]\nConnection: close\n\nThis request can be captured when you select appointment on calendar.\n\nLet me know if you need any other help from my side.\n\nBest Regards !\nVijay kumar","vulnerability_information_html":"\u003cp\u003eHi Team,\u003c/p\u003e\n\n\u003cp\u003eDescription : In calendar folder there is a permission settings where user can be assigned as read only user of it\u0026#39;s own objects . User with this permission shouldn\u0026#39;t be able to  view private appointments and it\u0026#39;s attachments  . There is request of getting attachment details from server which is vulnerable to IDOR attack . Which discloses attachment details of private document of appointment in calendar. \u003c/p\u003e\n\n\u003cp\u003ePermission : Member should have read only permission of it\u0026#39;s own objects.\u003c/p\u003e\n\n\u003cp\u003eVulnerable HTTP request : \u003c/p\u003e\n\n\u003cp\u003eGET /appsuite/api/attachment?action=all\u0026amp;module=1\u0026amp;attached=[attachment_ID ]\u0026amp;folder=[folder_ID]\u0026amp;columns=1%2C800%2C801%2C802%2C803%2C804%2C805\u0026amp;session=[session_token] HTTP/1.1\u003cbr\u003e\nHost: sandbox.open-xchange.com\u003cbr\u003e\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.11; rv:52.0) Gecko/20100101 Firefox/52.0\u003cbr\u003e\nAccept: application/json, text/javascript, \u003cem\u003e/\u003c/em\u003e; q=0.01\u003cbr\u003e\nAccept-Language: en-US,en;q=0.5\u003cbr\u003e\nContent-Type: application/x-www-form-urlencoded\u003cbr\u003e\nX-Requested-With: XMLHttpRequest\u003cbr\u003e\nReferer: \u003ca title=\"https://sandbox.open-xchange.com/appsuite/\" href=\"/redirect?url=https%3A%2F%2Fsandbox.open-xchange.com%2Fappsuite%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://sandbox.open-xchange.com/appsuite/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nCookie: [Cookie_Values]\u003cbr\u003e\nConnection: close\u003c/p\u003e\n\n\u003cp\u003eThis request can be captured when you select appointment on calendar.\u003c/p\u003e\n\n\u003cp\u003eLet me know if you need any other help from my side.\u003c/p\u003e\n\n\u003cp\u003eBest Regards !\u003cbr\u003e\nVijay kumar\u003c/p\u003e\n","bounty_amount":"200.0","formatted_bounty":"$200","weakness":{"id":26,"name":"Improper Access Control - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2017-08-17T20:45:09.220Z","allow_singular_disclosure_after":-106215294.45977236,"singular_disclosure_allowed":true,"vote_count":3,"voters":["eveeez","indoappsec","spetr0x"],"severity":{"rating":"high","author_type":"User"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1620204,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for the report, we're evaluating the issue.","markdown_message":"\u003cp\u003eThanks for the report, we\u0026#39;re evaluating the issue.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-04-19T06:42:13.281Z","updated_at":"2017-04-19T06:42:13.281Z","actor":{"username":"mheiland","cleared":false,"url":"/mheiland","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/425JKsXEnCYsDU1VA48SXXZV/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1620560,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thanks for reporting this vulnerability to us. We take your feedback very serious and started the process of resolving and delivering a solution to our users. Please note that we will take care about public disclosure of the vulnerability and give our users a chance to update to a fixed version before. Therefor, please handle this finding with discretion until we publicly disclosed it.\n\nWe'll discuss the matter of bounty for this finding soon and will update you shortly. Would you like to be included in our advisories \"researcher credits\"?","markdown_message":"\u003cp\u003eThanks for reporting this vulnerability to us. We take your feedback very serious and started the process of resolving and delivering a solution to our users. Please note that we will take care about public disclosure of the vulnerability and give our users a chance to update to a fixed version before. Therefor, please handle this finding with discretion until we publicly disclosed it.\u003c/p\u003e\n\n\u003cp\u003eWe\u0026#39;ll discuss the matter of bounty for this finding soon and will update you shortly. Would you like to be included in our advisories \u0026quot;researcher credits\u0026quot;?\u003c/p\u003e\n","automated_response":false,"created_at":"2017-04-19T10:14:57.801Z","updated_at":"2017-04-19T10:14:57.801Z","actor":{"username":"mheiland","cleared":false,"url":"/mheiland","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/425JKsXEnCYsDU1VA48SXXZV/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1642625,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Closing as resolved since all necessary information got provided. We'll release a patch for this soon.","markdown_message":"\u003cp\u003eClosing as resolved since all necessary information got provided. We\u0026#39;ll release a patch for this soon.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-04-28T14:11:05.049Z","updated_at":"2017-04-28T14:11:05.049Z","actor":{"username":"mheiland","cleared":false,"url":"/mheiland","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/425JKsXEnCYsDU1VA48SXXZV/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"indoappsec","url":"/indoappsec"},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1642626,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2017-04-28T14:11:16.057Z","updated_at":"2017-04-28T14:11:16.057Z","actor":{"url":"/open-xchange","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/JtYLEsu5yRZxGitSmAjeAFtK/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Open-Xchange"}},"bounty_amount":"200.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"open-xchange","collaborator":{"username":"indoappsec","url":"/indoappsec"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1847979,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Can we disclose this please !!","markdown_message":"\u003cp\u003eCan we disclose this please !!\u003c/p\u003e\n","automated_response":false,"created_at":"2017-07-18T20:45:09.194Z","updated_at":"2017-07-18T20:45:09.194Z","first_to_agree":true,"actor":{"username":"indoappsec","cleared":true,"url":"/indoappsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/QUAjqUf576QNBhxg691WB8YG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1937466,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-08-17T20:45:15.821Z","updated_at":"2017-08-17T20:45:15.821Z","actor":{"url":"/open-xchange","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/JtYLEsu5yRZxGitSmAjeAFtK/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Open-Xchange"}},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}