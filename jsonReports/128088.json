{"id":128088,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMjgwODg=","url":"https://hackerone.com/reports/128088","title":"AWS S3 bucket writeable for authenticated aws users","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-04-04T02:56:49.136Z","submitted_at":"2016-04-04T02:56:49.136Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"yaworsk","url":"/yaworsk","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/046/435/8321e52445321287eea5b5b3f4c9f6ea69e92bb5_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13,"url":"https://hackerone.com/security","handle":"security","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"HackerOne","twitter_handle":"Hacker0x01","website":"https://hackerone.com","about":"Vulnerability disclosure should be safe, transparent, and rewarding."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2016-04-05T13:06:28.383Z","bug_reporter_agreed_on_going_public_at":"2016-04-05T13:06:14.064Z","team_member_agreed_on_going_public_at":"2016-04-04T17:18:32.583Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi All,\nI know that hackerone-attachments is used for file uploads on reports and so I did a quick scan for similar buckets and found \u0026#x2588;\u0026#x2588;\u0026#x2588;\u0026#x2588;\u0026#x2588;\u0026#x2588;\u0026#x2588;\u0026#x2588;\u0026#x2588;\u0026#x2588;\u0026#x2588;\u0026#x2588;\u0026#x2588;\u0026#x2588;\u0026#x2588;\u0026#x2588;. While I can't confirm if you own it or not, it appears that it is publicly writable using the aws cli.\n\nWhen I tried to write to hackerone-attachments, I get:\n\"move failed: ./test.txt to s3://hackerone-attachements/test.txt A client error (AccessDenied) occurred when calling the PutObject operation: Access Denied.\n\nHowever, when I write to \u0026#x2588;\u0026#x2588;\u0026#x2588;\u0026#x2588;\u0026#x2588;\u0026#x2588;\u0026#x2588;\u0026#x2588;\u0026#x2588;\u0026#x2588;\u0026#x2588;\u0026#x2588;\u0026#x2588;\u0026#x2588;\u0026#x2588;\u0026#x2588;, I get:\nmove: ./test.txt to s3://\u0026#x2588;\u0026#x2588;\u0026#x2588;\u0026#x2588;\u0026#x2588;\u0026#x2588;\u0026#x2588;\u0026#x2588;\u0026#x2588;\u0026#x2588;\u0026#x2588;\u0026#x2588;\u0026#x2588;\u0026#x2588;\u0026#x2588;\u0026#x2588;/test.txt\n\nHopefully the bucket is yours and this isn't a waste of time. If you do own it, a good thing is the bucket is not publicly readable and the file appears private by default after being written. However, assuming you own it, the security issue would be someone writing something malicious and someone on your team unknowingly opening it.\n\nPete","vulnerability_information_html":"\u003cp\u003eHi All,\u003cbr\u003e\nI know that hackerone-attachments is used for file uploads on reports and so I did a quick scan for similar buckets and found ████████████████. While I can\u0026#39;t confirm if you own it or not, it appears that it is publicly writable using the aws cli.\u003c/p\u003e\n\n\u003cp\u003eWhen I tried to write to hackerone-attachments, I get:\u003cbr\u003e\n\u0026quot;move failed: ./test.txt to s3://hackerone-attachements/test.txt A client error (AccessDenied) occurred when calling the PutObject operation: Access Denied.\u003c/p\u003e\n\n\u003cp\u003eHowever, when I write to ████████████████, I get:\u003cbr\u003e\nmove: ./test.txt to s3://████████████████/test.txt\u003c/p\u003e\n\n\u003cp\u003eHopefully the bucket is yours and this isn\u0026#39;t a waste of time. If you do own it, a good thing is the bucket is not publicly readable and the file appears private by default after being written. However, assuming you own it, the security issue would be someone writing something malicious and someone on your team unknowingly opening it.\u003c/p\u003e\n\n\u003cp\u003ePete\u003c/p\u003e\n","bounty_amount":"2500.0","formatted_bounty":"$2,500","weakness":{"id":27,"name":"Improper Authentication - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2016-05-04T17:18:40.398Z","allow_singular_disclosure_after":-146833508.08665302,"singular_disclosure_allowed":true,"vote_count":30,"voters":["michiel","adn","spam404","dhakal_ananda","logicmap","xsam","dhakal_bibek","xiaoyinl","myst404","japz","and 20 more..."],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":886679,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Sorry, also (assuming you own the bucket), I can remove files, or at least the one I created, test.txt.","markdown_message":"\u003cp\u003eSorry, also (assuming you own the bucket), I can remove files, or at least the one I created, test.txt.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-04T03:09:37.450Z","updated_at":"2016-04-04T03:09:37.450Z","actor":{"username":"yaworsk","cleared":true,"url":"/yaworsk","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/046/435/8321e52445321287eea5b5b3f4c9f6ea69e92bb5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":886730,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Good catch. This is one of our many S3 buckets, but I indeed can view your `test.txt` upload.","markdown_message":"\u003cp\u003eGood catch. This is one of our many S3 buckets, but I indeed can view your \u003ccode\u003etest.txt\u003c/code\u003e upload.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-04T05:08:04.599Z","updated_at":"2016-04-04T05:08:04.599Z","actor":{"username":"reed","cleared":false,"url":"/reed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":886796,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"We fixed the ACLs on this particular bucket and also found some additional ACL problems on some other buckets, which we corrected as part of this audit. Can you confirm that the issue is resolved?","markdown_message":"\u003cp\u003eWe fixed the ACLs on this particular bucket and also found some additional ACL problems on some other buckets, which we corrected as part of this audit. Can you confirm that the issue is resolved?\u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-04T05:55:33.500Z","updated_at":"2016-04-04T05:55:33.500Z","actor":{"username":"reed","cleared":false,"url":"/reed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"reporter":{"username":"yaworsk","url":"/yaworsk"},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":887107,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @reed, yup, looks good. Can't move or remove files from the bucket (also tried to sync and some others but they didn't work initially anyways). Glad I reported, wasn't 100% sure if I should given I couldn't confirm the ownership.","markdown_message":"\u003cp\u003eHi \u003ca href=\"/reed\"\u003e@reed\u003c/a\u003e, yup, looks good. Can\u0026#39;t move or remove files from the bucket (also tried to sync and some others but they didn\u0026#39;t work initially anyways). Glad I reported, wasn\u0026#39;t 100% sure if I should given I couldn\u0026#39;t confirm the ownership.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-04T10:13:58.212Z","updated_at":"2016-04-04T10:13:58.212Z","actor":{"username":"yaworsk","cleared":true,"url":"/yaworsk","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/046/435/8321e52445321287eea5b5b3f4c9f6ea69e92bb5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":887858,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Cool, glad to hear. Also, if there's ever a question about ownership of something, you can e-mail us first to confirm.","markdown_message":"\u003cp\u003eCool, glad to hear. Also, if there\u0026#39;s ever a question about ownership of something, you can e-mail us first to confirm.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-04T17:02:23.068Z","updated_at":"2016-04-04T17:02:23.068Z","actor":{"username":"reed","cleared":false,"url":"/reed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":887860,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks again for the great report, @yaworsk.\n\nIt's always great to see researchers thinking outside the normal web app confines and considering other parts of technical infrastructure that could affect a company. While you weren't able to read any contents from that bucket (and even if you would, everything is encrypted using AES-256), an attacker could theoretically post a file into that bucket that may at some point be accessed by a HackerOne staff member, thinking it's been uploaded by another staff member or some automated system.\n\nThis issue also led us to audit some of our additional S3 buckets (we have quite a few), and we found some similar issues among several of them. As such, we are increasing the bounty to take those additional mitigations into account, even though they weren't discovered by you.\n\nLook forward to seeing what you find next! Happy hacking. :-)","markdown_message":"\u003cp\u003eThanks again for the great report, \u003ca href=\"/yaworsk\"\u003e@yaworsk\u003c/a\u003e.\u003c/p\u003e\n\n\u003cp\u003eIt\u0026#39;s always great to see researchers thinking outside the normal web app confines and considering other parts of technical infrastructure that could affect a company. While you weren\u0026#39;t able to read any contents from that bucket (and even if you would, everything is encrypted using AES-256), an attacker could theoretically post a file into that bucket that may at some point be accessed by a HackerOne staff member, thinking it\u0026#39;s been uploaded by another staff member or some automated system.\u003c/p\u003e\n\n\u003cp\u003eThis issue also led us to audit some of our additional S3 buckets (we have quite a few), and we found some similar issues among several of them. As such, we are increasing the bounty to take those additional mitigations into account, even though they weren\u0026#39;t discovered by you.\u003c/p\u003e\n\n\u003cp\u003eLook forward to seeing what you find next! Happy hacking. :-)\u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-04T17:02:37.213Z","updated_at":"2016-04-04T17:02:37.213Z","actor":{"url":"/security","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"HackerOne"}},"bounty_amount":"2500.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"security","collaborator":{"username":"yaworsk","url":"/yaworsk"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":887874,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2016-04-04T17:05:25.483Z","updated_at":"2016-04-04T17:17:44.821Z","additional_data":{"old_title":"AWS ████████████████ writeable for authenticated aws users","new_title":"AWS S3 bucket writeable for authenticated aws users"},"actor":{"username":"reed","cleared":false,"url":"/reed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":887887,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Awesome, thanks for the bounty and considering the additional buckets / potential of this!! Was kicking myself for not searching for those once I found the \u0026#x2588;\u0026#x2588;\u0026#x2588;\u0026#x2588;\u0026#x2588;\u0026#x2588;\u0026#x2588;\u0026#x2588;\u0026#x2588;\u0026#x2588;\u0026#x2588;\u0026#x2588; bucket and read reed's comments.\n\nAnd thanks @reed - that's great to know and helpful.","markdown_message":"\u003cp\u003eAwesome, thanks for the bounty and considering the additional buckets / potential of this!! Was kicking myself for not searching for those once I found the ████████████ bucket and read reed\u0026#39;s comments.\u003c/p\u003e\n\n\u003cp\u003eAnd thanks \u003ca href=\"/reed\"\u003e@reed\u003c/a\u003e - that\u0026#39;s great to know and helpful.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-04T17:09:11.374Z","updated_at":"2016-04-04T17:12:29.273Z","actor":{"username":"yaworsk","cleared":true,"url":"/yaworsk","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/046/435/8321e52445321287eea5b5b3f4c9f6ea69e92bb5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":887910,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-04-04T17:18:39.952Z","updated_at":"2016-04-04T17:18:39.952Z","first_to_agree":true,"actor":{"username":"reed","cleared":false,"url":"/reed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":889726,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Disclose away :)","markdown_message":"\u003cp\u003eDisclose away :)\u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-05T13:06:27.801Z","updated_at":"2016-04-05T13:06:27.801Z","actor":{"username":"yaworsk","cleared":true,"url":"/yaworsk","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/046/435/8321e52445321287eea5b5b3f4c9f6ea69e92bb5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":889727,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-04-05T13:06:28.412Z","updated_at":"2016-04-05T13:06:28.412Z","actor":{"username":"yaworsk","cleared":true,"url":"/yaworsk","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/046/435/8321e52445321287eea5b5b3f4c9f6ea69e92bb5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":1615,"category":"team","content":"An ACL misconfiguration issue existed on one of our S3 buckets. This misconfiguration allowed any authenticated AWS user to write to this bucket (no read access was permitted). An attacker could theoretically post a file into that bucket that may at some point be accessed by a HackerOne staff member, thinking it's been uploaded by another staff member or some automated system. We improved the ACLs for that S3 bucket to prevent such a concern.\n\nThis issue also led us to audit some of our additional S3 buckets, resulting in changes for some of those buckets as well.","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eAn ACL misconfiguration issue existed on one of our S3 buckets. This misconfiguration allowed any authenticated AWS user to write to this bucket (no read access was permitted). An attacker could theoretically post a file into that bucket that may at some point be accessed by a HackerOne staff member, thinking it\u0026#39;s been uploaded by another staff member or some automated system. We improved the ACLs for that S3 bucket to prevent such a concern.\u003c/p\u003e\n\n\u003cp\u003eThis issue also led us to audit some of our additional S3 buckets, resulting in changes for some of those buckets as well.\u003c/p\u003e\n"},{"id":1645,"category":"researcher","content":"For those interested, I've recorded a video tutorial on how I accomplished this: https://www.youtube.com/watch?v=_x5VKuFjvrk","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eFor those interested, I\u0026#39;ve recorded a video tutorial on how I accomplished this: \u003ca title=\"https://www.youtube.com/watch?v=_x5VKuFjvrk\" href=\"/redirect?url=https%3A%2F%2Fwww.youtube.com%2Fwatch%3Fv%3D_x5VKuFjvrk\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.youtube.com/watch?v=_x5VKuFjvrk\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n"}]}