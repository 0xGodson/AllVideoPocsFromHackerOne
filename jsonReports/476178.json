{"id":476178,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC80NzYxNzg=","url":"https://hackerone.com/reports/476178","title":"Negative size parameter in mb_split","state":"Closed","substate":"resolved","severity_rating":"critical","readable_substate":"Resolved","created_at":"2019-01-07T20:25:48.915Z","submitted_at":"2019-01-07T20:25:48.915Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"haquaman","url":"/haquaman","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/017/646/07cbfc394d4d3432eb95cf9735f225ea803090bb_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":29,"url":"https://hackerone.com/ibb-php","handle":"ibb-php","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/029/99087dbbdf52fc3ce3acbf16aa33a5c4f5e2c111_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/029/99087dbbdf52fc3ce3acbf16aa33a5c4f5e2c111_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"paused","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"PHP (IBB)","twitter_handle":"","website":"http://www.php.net","about":""}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":["CVE-2019-9025"],"singular_disclosure_disabled":false,"disclosed_at":"2020-11-09T01:48:52.585Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2020-10-10T01:48:50.942Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"https://bugs.php.net/bug.php?id=77367\n\nmb_split doesn't correctly detect the length when the $string has an unfinished multibyte character at the end of the string. This causes a crash due to a negative parameter to add_next_index_stringl, which calls zend_string_init and memcpy.\n\nCould reproduce on master.\n\n## Impact\n\nThis could be used to cause memory corruption/leakage.","vulnerability_information_html":"\u003cp\u003e\u003ca title=\"https://bugs.php.net/bug.php?id=77367\" href=\"/redirect?url=https%3A%2F%2Fbugs.php.net%2Fbug.php%3Fid%3D77367\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://bugs.php.net/bug.php?id=77367\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003emb_split doesn\u0026#39;t correctly detect the length when the $string has an unfinished multibyte character at the end of the string. This causes a crash due to a negative parameter to add_next_index_stringl, which calls zend_string_init and memcpy.\u003c/p\u003e\n\n\u003cp\u003eCould reproduce on master.\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eThis could be used to cause memory corruption/leakage.\u003c/p\u003e\n","bounty_amount":"1500.0","formatted_bounty":"$1,500","weakness":{"id":7,"name":"Buffer Underflow"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2020-11-09T01:48:51.046Z","allow_singular_disclosure_after":-4335314.910515273,"singular_disclosure_allowed":true,"vote_count":1,"voters":["thedarkvisitor"],"severity":{"rating":"critical","score":9.8,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"none","user_interaction":"none","scope":"unchanged","confidentiality":"high","integrity":"high","availability":"high"}},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":4002603,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @haquaman - Thanks for the submission. Your report is currently being reviewed and the HackerOne triage team will get back to you once there is additional information to share. Thank you for your patience! ","markdown_message":"\u003cp\u003eHey \u003ca href=\"/haquaman\"\u003e@haquaman\u003c/a\u003e - Thanks for the submission. Your report is currently being reviewed and the HackerOne triage team will get back to you once there is additional information to share. Thank you for your patience! \u003c/p\u003e\n","automated_response":false,"created_at":"2019-01-18T21:12:44.417Z","updated_at":"2019-01-18T21:12:44.417Z","actor":{"username":"tuxedo","cleared":false,"url":"/tuxedo","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/9G6pgB95of3ikt3prqQunAfD/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"ibb-php","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":4869206,"is_internal":false,"editable":false,"type":"Activities::CveIdAdded","message":"","markdown_message":"","automated_response":false,"created_at":"2019-05-17T21:04:49.924Z","updated_at":"2019-05-17T21:04:49.924Z","cve_ids":["CVE-2019-9025"],"actor":{"username":"tuxedo","cleared":false,"url":"/tuxedo","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/9G6pgB95of3ikt3prqQunAfD/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"ibb-php","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":4869207,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2019-05-17T21:05:20.491Z","updated_at":"2019-05-17T21:05:20.491Z","additional_data":{"old_severity":null,"new_severity":"Critical (9.8)","old_severity_id":null,"new_severity_id":394981},"actor":{"username":"tuxedo","cleared":false,"url":"/tuxedo","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/9G6pgB95of3ikt3prqQunAfD/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"ibb-php","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":4869208,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thank you @haquaman! I was able to validate your report, and have submitted it to the appropriate remediation team for review. Please note that the status and severity are subject to change. ","markdown_message":"\u003cp\u003eThank you \u003ca href=\"/haquaman\"\u003e@haquaman\u003c/a\u003e! I was able to validate your report, and have submitted it to the appropriate remediation team for review. Please note that the status and severity are subject to change. \u003c/p\u003e\n","automated_response":false,"created_at":"2019-05-17T21:05:22.723Z","updated_at":"2019-05-17T21:05:22.723Z","actor":{"username":"tuxedo","cleared":false,"url":"/tuxedo","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/9G6pgB95of3ikt3prqQunAfD/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"ibb-php","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":6695123,"is_internal":false,"editable":false,"type":"Activities::HackerRequestedMediation","message":"Hi,\n\nI requested mediation on #476168 after 8 months of submission of that, #476179, and also this report (#476178). The response I got from the mediation team was that I would get a response within 7 days (request #270031, from Chris at Sep 11, 17:51 PDT), and if not I should let the team know.\n\nI did not receive a response, and emailed back on Sept 24. I did not receive a response from that either. I emailed again, and made another comment on #476168 regarding the lack of response from the IBB team, and the mediation team.\n\nI note that now been an entire year since these issues were reported, and the issues were resolved upstream shortly after. It has been 8 months since all the reports were triaged, which was also the last I have heard from the IBB team despite asking for updates every few months.\n\nI also requested mediation a month ago on #476179, but am yet to hear anything back from the mediation team, or anything from them about the lack of response after 7 days back in September.\n\nI'm OK with a program that takes a long time to reach resolution, but I'm not OK with the complete lack of transparency and openness. I've requested multiple times an update from the IBB team, but have not had a response from them for 6 months. It would be great if the IBB team or hackerone can set some expectations and outline these to researchers.\n\nAlso, I would be interested in why the mediation team gave an expectation of an update of 7 days, then never responded when that timeframe expired. What is the point of mediation if the mediators can't actually mediate or communicate with researchers?\n\nCan I please get an update on why this has taken so long, and when I can expect these 3 reports to get resolved?\n\nCheers,\n\nHugh","markdown_message":"\u003cp\u003eHi,\u003c/p\u003e\n\n\u003cp\u003eI requested mediation on \u003ca href=\"/reports/476168\"\u003e#476168\u003c/a\u003e after 8 months of submission of that, \u003ca href=\"/reports/476179\"\u003e#476179\u003c/a\u003e, and also this report (#476178). The response I got from the mediation team was that I would get a response within 7 days (request \u003ca href=\"/reports/270031\"\u003e#270031\u003c/a\u003e, from Chris at Sep 11, 17:51 PDT), and if not I should let the team know.\u003c/p\u003e\n\n\u003cp\u003eI did not receive a response, and emailed back on Sept 24. I did not receive a response from that either. I emailed again, and made another comment on \u003ca href=\"/reports/476168\"\u003e#476168\u003c/a\u003e regarding the lack of response from the IBB team, and the mediation team.\u003c/p\u003e\n\n\u003cp\u003eI note that now been an entire year since these issues were reported, and the issues were resolved upstream shortly after. It has been 8 months since all the reports were triaged, which was also the last I have heard from the IBB team despite asking for updates every few months.\u003c/p\u003e\n\n\u003cp\u003eI also requested mediation a month ago on \u003ca href=\"/reports/476179\"\u003e#476179\u003c/a\u003e, but am yet to hear anything back from the mediation team, or anything from them about the lack of response after 7 days back in September.\u003c/p\u003e\n\n\u003cp\u003eI\u0026#39;m OK with a program that takes a long time to reach resolution, but I\u0026#39;m not OK with the complete lack of transparency and openness. I\u0026#39;ve requested multiple times an update from the IBB team, but have not had a response from them for 6 months. It would be great if the IBB team or hackerone can set some expectations and outline these to researchers.\u003c/p\u003e\n\n\u003cp\u003eAlso, I would be interested in why the mediation team gave an expectation of an update of 7 days, then never responded when that timeframe expired. What is the point of mediation if the mediators can\u0026#39;t actually mediate or communicate with researchers?\u003c/p\u003e\n\n\u003cp\u003eCan I please get an update on why this has taken so long, and when I can expect these 3 reports to get resolved?\u003c/p\u003e\n\n\u003cp\u003eCheers,\u003c/p\u003e\n\n\u003cp\u003eHugh\u003c/p\u003e\n","automated_response":false,"created_at":"2020-01-06T00:54:15.890Z","updated_at":"2020-01-06T00:54:15.890Z","actor":{"username":"haquaman","cleared":false,"url":"/haquaman","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/646/07cbfc394d4d3432eb95cf9735f225ea803090bb_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ibb-php","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9478389,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2020-10-09T23:58:33.044Z","updated_at":"2020-10-09T23:58:33.044Z","actor":{"url":"/ibb-php","ibb":true,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/029/99087dbbdf52fc3ce3acbf16aa33a5c4f5e2c111_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"PHP (IBB)"}},"bounty_amount":"1500.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"ibb-php","collaborator":{"username":"haquaman","url":"/haquaman"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9478390,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hello @haquaman,\n\nOn behalf of the Internet Bug Bounty Panel, thank you for your continued patience on this report. The IBB requires that all in-scope open source projects be mutually engaged with us to ensure there is a good experience for all. Unfortunately, we have not been able to maintain that relationship with the upstream PHP community, and as a result, HackerOne and the IBB Panel have collectively agreed to shut down the program indefinitely.\n\nIn an effort to reward researchers for their hard work and patience thus far, the IBB panel has elected to pay bounties to all valid reports without PHP’s input. Bounty amounts are decided on based on the PHP policy and severity assigned on the accompanying CVE. \n\nAs an act of good faith, we will also close this report as Resolved.\n\nThank you for helping keep the internet safe and secure!\n-The Internet Bug Bounty Panel \n","markdown_message":"\u003cp\u003eHello \u003ca href=\"/haquaman\"\u003e@haquaman\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eOn behalf of the Internet Bug Bounty Panel, thank you for your continued patience on this report. The IBB requires that all in-scope open source projects be mutually engaged with us to ensure there is a good experience for all. Unfortunately, we have not been able to maintain that relationship with the upstream PHP community, and as a result, HackerOne and the IBB Panel have collectively agreed to shut down the program indefinitely.\u003c/p\u003e\n\n\u003cp\u003eIn an effort to reward researchers for their hard work and patience thus far, the IBB panel has elected to pay bounties to all valid reports without PHP’s input. Bounty amounts are decided on based on the PHP policy and severity assigned on the accompanying CVE. \u003c/p\u003e\n\n\u003cp\u003eAs an act of good faith, we will also close this report as Resolved.\u003c/p\u003e\n\n\u003cp\u003eThank you for helping keep the internet safe and secure!\u003cbr\u003e\n-The Internet Bug Bounty Panel \u003c/p\u003e\n","automated_response":false,"created_at":"2020-10-09T23:58:48.435Z","updated_at":"2020-10-09T23:58:48.435Z","actor":{"username":"reed","cleared":false,"url":"/reed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"reporter":{"username":"haquaman","url":"/haquaman"},"genius_execution_id":null,"team_handle":"ibb-php","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9478701,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-10-10T01:48:50.963Z","updated_at":"2020-10-10T01:48:50.963Z","first_to_agree":true,"actor":{"username":"reed","cleared":false,"url":"/reed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"ibb-php","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9762806,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-11-09T01:48:54.520Z","updated_at":"2020-11-09T01:48:54.520Z","actor":{"url":"/ibb-php","ibb":true,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/029/99087dbbdf52fc3ce3acbf16aa33a5c4f5e2c111_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"PHP (IBB)"}},"genius_execution_id":null,"team_handle":"ibb-php","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}