{"id":96890,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC85Njg5MA==","url":"https://hackerone.com/reports/96890","title":"A 'Full access' administrator is able to see the shop owners user details","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2015-10-30T23:05:30.461Z","submitted_at":"2015-10-30T23:05:30.461Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"brakhane","url":"/brakhane","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/040/726/4b47d99eec4ee906a402afb934855158d1e6d929_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1382,"url":"https://hackerone.com/shopify","handle":"shopify","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Shopify","twitter_handle":"","website":"https://www.shopify.com","about":"Shopify is a multi-channel commerce platform that helps people sell online, in-store, and everywhere in between."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2015-11-10T23:17:24.278Z","bug_reporter_agreed_on_going_public_at":"2015-11-10T23:17:24.107Z","team_member_agreed_on_going_public_at":"2015-11-10T22:21:49.500Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Description\n====\n\nA 'Full access' administrator is usually forbidden to see the shop owners user profile. But the endpoint `shop.myshopify.com/admin/users.json` does disclose the shop owners profile. As the user listing includes all fields of users this does leak the user details of the shop owner.\n\nA direct query to `shop.myshopify.com/admin/users/{USERID}.json` does however honer the fact that this shouldn't be allowed by returning `{ \"error\": \"Forbidden from viewing user\" }`.\n\nMitigation\n====\nFilter out the shop owner from the user listing provided by the `/admin/users.json` endpoint for 'Full access' administrators.\n","vulnerability_information_html":"\u003ch1 id=\"description\"\u003eDescription\u003c/h1\u003e\n\n\u003cp\u003eA \u0026#39;Full access\u0026#39; administrator is usually forbidden to see the shop owners user profile. But the endpoint \u003ccode\u003eshop.myshopify.com/admin/users.json\u003c/code\u003e does disclose the shop owners profile. As the user listing includes all fields of users this does leak the user details of the shop owner.\u003c/p\u003e\n\n\u003cp\u003eA direct query to \u003ccode\u003eshop.myshopify.com/admin/users/{USERID}.json\u003c/code\u003e does however honer the fact that this shouldn\u0026#39;t be allowed by returning \u003ccode\u003e{ \u0026quot;error\u0026quot;: \u0026quot;Forbidden from viewing user\u0026quot; }\u003c/code\u003e.\u003c/p\u003e\n\n\u003ch1 id=\"mitigation\"\u003eMitigation\u003c/h1\u003e\n\n\u003cp\u003eFilter out the shop owner from the user listing provided by the \u003ccode\u003e/admin/users.json\u003c/code\u003e endpoint for \u0026#39;Full access\u0026#39; administrators.\u003c/p\u003e\n","bounty_amount":"500.0","formatted_bounty":"$500","weakness":{"id":75,"name":"Privilege Escalation"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2015-12-10T22:21:49.657Z","allow_singular_disclosure_after":-159440064.811929,"singular_disclosure_allowed":true,"vote_count":1,"voters":["spetr0x"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":639322,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you for reporting this bug! This is an automated response to let you know that we've received your issue, and we'll process it as soon as possible.\r\n\r\nOur team is busy triaging and fixing HackerOne reports, and it may take us up to 1 week (or more) to triage any given issue. Don't worry, we'll get to yours!\r\n\r\nWhile you are waiting, you can read over our list of non applicable issues listed on our program page: https://hackerone.com/shopify. Make sure your issue isn't listed!","markdown_message":"\u003cp\u003eThank you for reporting this bug! This is an automated response to let you know that we\u0026#39;ve received your issue, and we\u0026#39;ll process it as soon as possible.\u003c/p\u003e\n\n\u003cp\u003eOur team is busy triaging and fixing HackerOne reports, and it may take us up to 1 week (or more) to triage any given issue. Don\u0026#39;t worry, we\u0026#39;ll get to yours!\u003c/p\u003e\n\n\u003cp\u003eWhile you are waiting, you can read over our list of non applicable issues listed on our program page: \u003ca title=\"https://hackerone.com/shopify\" href=\"https://hackerone.com/shopify\"\u003ehttps://hackerone.com/shopify\u003c/a\u003e. Make sure your issue isn\u0026#39;t listed!\u003c/p\u003e\n","automated_response":true,"created_at":"2015-10-30T23:05:31.382Z","updated_at":"2015-10-30T23:05:31.382Z","actor":{"url":"/shopify","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Shopify"}},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":651374,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thanks for reporting this, I agree that the last browsing sessions for the admin should not be displayed.","markdown_message":"\u003cp\u003eThanks for reporting this, I agree that the last browsing sessions for the admin should not be displayed.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-11-09T18:16:23.025Z","updated_at":"2015-11-09T18:16:23.025Z","actor":{"username":"francoischagnon","cleared":false,"url":"/francoischagnon","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/168/5d577fe97283a5483331257b629b6287ed4d287b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":652932,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hi @brakhane,\n\nI deployed a fix today that removes information about the user's last browsing session from the json data, which is the information we didn't want to show to all users. We've intentionally left the first name, last name and some other information in the json data.","markdown_message":"\u003cp\u003eHi \u003ca href=\"/brakhane\"\u003e@brakhane\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eI deployed a fix today that removes information about the user\u0026#39;s last browsing session from the json data, which is the information we didn\u0026#39;t want to show to all users. We\u0026#39;ve intentionally left the first name, last name and some other information in the json data.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-11-10T18:41:39.978Z","updated_at":"2015-11-10T18:41:39.978Z","actor":{"username":"francoischagnon","cleared":false,"url":"/francoischagnon","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/168/5d577fe97283a5483331257b629b6287ed4d287b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"brakhane","url":"/brakhane"},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":653205,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks for helping improve the security of Shopify. This issue has been resolved.","markdown_message":"\u003cp\u003eThanks for helping improve the security of Shopify. This issue has been resolved.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-11-10T22:21:41.638Z","updated_at":"2015-11-10T22:21:41.638Z","actor":{"url":"/shopify","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Shopify"}},"bounty_amount":"500.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"shopify","collaborator":{"username":"brakhane","url":"/brakhane"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":653206,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-11-10T22:21:49.527Z","updated_at":"2015-11-10T22:21:49.527Z","first_to_agree":true,"actor":{"username":"andrewdunbar","cleared":false,"url":"/andrewdunbar","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/164/5b0e89675ed6dbb9df87223e9f8f58e2125bb56b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":653290,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-11-10T23:17:24.135Z","updated_at":"2015-11-10T23:17:24.135Z","actor":{"username":"brakhane","cleared":false,"url":"/brakhane","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/040/726/4b47d99eec4ee906a402afb934855158d1e6d929_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":653291,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-11-10T23:17:24.308Z","updated_at":"2015-11-10T23:17:24.308Z","actor":{"username":"brakhane","cleared":false,"url":"/brakhane","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/040/726/4b47d99eec4ee906a402afb934855158d1e6d929_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":1005,"category":"team","content":"The IP address last seen for each store user was returned through Shopify's API. We removed the IP address information from the json response returned by the API.","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eThe IP address last seen for each store user was returned through Shopify\u0026#39;s API. We removed the IP address information from the json response returned by the API.\u003c/p\u003e\n"},{"category":"researcher","can_view?":true,"can_create?":false}]}