{"id":732431,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC83MzI0MzE=","url":"https://hackerone.com/reports/732431","title":"Improper integrity protection of server-side encryption keys","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2019-11-08T14:19:09.158Z","submitted_at":"2019-11-08T14:19:09.158Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"yahe","url":"/yahe","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/FHoMM5nd5Mw7BuoUY5D7NTdF/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13291,"url":"https://hackerone.com/nextcloud","handle":"nextcloud","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Nextcloud","twitter_handle":"nextclouders","website":"https://nextcloud.com","about":"Access, share and protect your files, calendars, contacts, communication \u0026 more at home and in your enterprise."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":["CVE-2020-8259"],"singular_disclosure_disabled":false,"disclosed_at":"2020-11-13T14:39:41.163Z","bug_reporter_agreed_on_going_public_at":"2020-11-06T16:20:55.661Z","team_member_agreed_on_going_public_at":"2020-11-13T14:39:41.069Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"The public keys used for the server-side encryption are not integrity-protected. These can easily replaced by anyone who has access to the data-at-rest data (even when the per-user-keys are enabled, as described in https://nextcloud.com/security/threat-model/). This holds true for all key types - from the master key, the per-user-keys as well as for the (optional) recovery key.\n\nAttack scenarios may look like this:\n* A recovery key is set by the admin and users enabled the recovery feature (or it was mandatorily set by adding the corresponding configuration to the `oc_preferences` table for all users). As it is unlikely that the recovery key is used very often, a person that has access to the data directory (even if at rest) is able to replace the public recovery key with a newly generated one. Each newly added file and each modified file will also be encrypted for the newly generated recovery key.\n* A per-user-key encryption scheme is introduced and organizational shared folders are set up. To better handle access management all organizational shared folders are owned by the admin that also handles access management requests. As it is unlikely that the admin account will be used to access the individual files, a person that has access to the data directory (even if at rest) is able to replace the public key of the admin account with a newly generated one. Each newly added file and each modified file that is put into any of the organizational shared folders will also be encrypted for the newly generated admin account key.\n\nThe mentioned attack scenarios may also be executed by an external storage provider if the folder that is used as the data directory is stored at this external storage provider. Administrative access to the actual Nextcloud server is **not** necessary to mount this attack.\n\n## Impact\n\nAfter mounting the attack the person would be able to read and modify all newly created files as well as files that have been modified since the attack was launched.\n\n**Preventing** this attack could look as follows:\n* The fingerprints of public and private key files that have been generated by the application could be stored in the database.\n* Whenever public or private key files are read from disk the fingerprint of that file is checked against the value stored in the database.\n\nAn alternative approach for **preventing** this attack could look as follows:\n* For each public and private key file that has been generated by the application a MAC could be calculated.\n* The key for the MAC could be derived from the instance id, the instance secret and the relative file name of the corresponding key file.\n* The MAC could be stored directly in the corresponding key file.\n* Whenever a public or private key file is read from disk the MAC of that file could be calculated and compared with the MAC stored in the file.","vulnerability_information_html":"\u003cp\u003eThe public keys used for the server-side encryption are not integrity-protected. These can easily replaced by anyone who has access to the data-at-rest data (even when the per-user-keys are enabled, as described in \u003ca title=\"https://nextcloud.com/security/threat-model/\" href=\"/redirect?url=https%3A%2F%2Fnextcloud.com%2Fsecurity%2Fthreat-model%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://nextcloud.com/security/threat-model/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e). This holds true for all key types - from the master key, the per-user-keys as well as for the (optional) recovery key.\u003c/p\u003e\n\n\u003cp\u003eAttack scenarios may look like this:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eA recovery key is set by the admin and users enabled the recovery feature (or it was mandatorily set by adding the corresponding configuration to the \u003ccode\u003eoc_preferences\u003c/code\u003e table for all users). As it is unlikely that the recovery key is used very often, a person that has access to the data directory (even if at rest) is able to replace the public recovery key with a newly generated one. Each newly added file and each modified file will also be encrypted for the newly generated recovery key.\u003c/li\u003e\n\u003cli\u003eA per-user-key encryption scheme is introduced and organizational shared folders are set up. To better handle access management all organizational shared folders are owned by the admin that also handles access management requests. As it is unlikely that the admin account will be used to access the individual files, a person that has access to the data directory (even if at rest) is able to replace the public key of the admin account with a newly generated one. Each newly added file and each modified file that is put into any of the organizational shared folders will also be encrypted for the newly generated admin account key.\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eThe mentioned attack scenarios may also be executed by an external storage provider if the folder that is used as the data directory is stored at this external storage provider. Administrative access to the actual Nextcloud server is \u003cstrong\u003enot\u003c/strong\u003e necessary to mount this attack.\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eAfter mounting the attack the person would be able to read and modify all newly created files as well as files that have been modified since the attack was launched.\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003ePreventing\u003c/strong\u003e this attack could look as follows:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eThe fingerprints of public and private key files that have been generated by the application could be stored in the database.\u003c/li\u003e\n\u003cli\u003eWhenever public or private key files are read from disk the fingerprint of that file is checked against the value stored in the database.\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eAn alternative approach for \u003cstrong\u003epreventing\u003c/strong\u003e this attack could look as follows:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eFor each public and private key file that has been generated by the application a MAC could be calculated.\u003c/li\u003e\n\u003cli\u003eThe key for the MAC could be derived from the instance id, the instance secret and the relative file name of the corresponding key file.\u003c/li\u003e\n\u003cli\u003eThe MAC could be stored directly in the corresponding key file.\u003c/li\u003e\n\u003cli\u003eWhenever a public or private key file is read from disk the MAC of that file could be calculated and compared with the MAC stored in the file.\u003c/li\u003e\n\u003c/ul\u003e\n","weakness":{"id":87,"name":"Insufficiently Protected Credentials"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":629444,"file_name":"nextcloud_poc2.mp4","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/PjFBrEUnQkTfJKLf7Bk9GTHH?response-content-disposition=attachment%3B%20filename%3D%22nextcloud_poc2.mp4%22%3B%20filename%2A%3DUTF-8%27%27nextcloud_poc2.mp4\u0026response-content-type=video%2Fmp4\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQVI7RRVDA%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T064328Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIBHEDTSDqGCEjCA9tudGP24dm%2BoWjhn4lvjW9Xdc726YAiBAirG3R3v5iCJWiH96kr3xjgtokc99MedveJtrAC4YPCq0AwhWEAEaDDAxMzYxOTI3NDg0OSIMwzXTJ902cIF5s5YBKpED%2BFkmFklYgSPET%2FOjZR761EJeyNuollWMzL6Eqk6fqlOryiQVTtybXJCV%2BiXs4IKZlZhdEUgfEs%2FPAvZuGC8ev7K5oLyJ5QqWwuAl7vab30rE%2Fc%2B6gA7DaaQR7brCfssJN3parouSEln0TFi%2Bl2%2Fg04wp1RCS7aIs4VD3adDyb35qEbpuQ8cAYPCIvI7AkKNaVq%2BKTzAMk3O4%2FJlAqQIXdBSTWxtRmWJxWRq9BCvLGNHYWxUqU5LgJuqWxRkm6nUVp%2BfeYyy0xqpTqdHXt%2BFFP%2BZc%2BJ8Gvv6F4e8%2B7BU9sbfDeQE29%2FbuO0f%2FsPEwM9HdRQFytGHqL%2FkQk%2BpNhsgAok7yxwEi9NustpeRTz5rN3XCfxnTv1EQZDTyf2CMkXPxai9miYEyCqEzm95o%2FWji0UokRhJ7nAAvjnFcZZBhzzAlKgj60zmHVd7RAF9FBoKhJw1L8CzEtzHi8Ub%2Fl%2Ff40q%2BnIJGRvCcsv6s8fwns3Q9x9rNOcNC4%2FvQ2W2tcsXBe898Y2j9dQMjAC8oLXDalQ5kwqemq%2FwU67AHfGUTl%2FYDPxs5VQbVM6YbbQPWpACjCZdWNB1X%2BYlCAg6WTSF6hwm9XlUMal0jLt5Ae9Mby3zeF0kXzzliRlv1djJGT18ZKDRpIb6U%2FYP%2FCOvPcZ%2FUXcp7ogmd1yEm6TQJTAPNpn7lyoOOF9531N%2F%2FztCXqmws2n5HlFZs8iPlP3GWFKjEZRsy5DhmrXa8MUEuD9fcCiZMJW80Aq9nKkHrYB8us1vZYBWwuInvS4cRXLQtFsCvvxSgZ3Pc%2FyIg1f4JiqUaR0lsXYqCV2IcbArgLW3ublxMmtJ5ZRv7klB3LmjKFMu9la06KhhLPzw%3D%3D\u0026X-Amz-Signature=65e7f47346e0e033fd783a6afa73a22515b75aa54e40b97a477d8a1274aabfd7","file_size":7948534,"type":"video/mp4"}],"allow_singular_disclosure_at":"2020-12-06T16:20:55.817Z","allow_singular_disclosure_after":-1952552.490139462,"singular_disclosure_allowed":true,"vote_count":2,"voters":["helphen","mrbeast123"],"severity":{"rating":"high","score":7.4,"author_type":"User","metrics":{"attack_vector":"local","attack_complexity":"low","privileges_required":"high","user_interaction":"required","scope":"changed","confidentiality":"high","integrity":"high","availability":"none"}},"structured_scope":{"databaseId":13,"asset_type":"SOURCE_CODE","asset_identifier":"nextcloud/server","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":6254879,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks a lot for reporting this potential issue back to us!\n\nOur security team will take a look at this issue as soon as possible. We will reply to your report within 72 hours, usually much faster. For obvious reasons we'd like to ask you to not disclose this issue to any other party.","markdown_message":"\u003cp\u003eThanks a lot for reporting this potential issue back to us!\u003c/p\u003e\n\n\u003cp\u003eOur security team will take a look at this issue as soon as possible. We will reply to your report within 72 hours, usually much faster. For obvious reasons we\u0026#39;d like to ask you to not disclose this issue to any other party.\u003c/p\u003e\n","automated_response":true,"created_at":"2019-11-08T14:19:09.476Z","updated_at":"2019-11-08T14:19:09.476Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Nextcloud"}},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6278213,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"\u003e Administrative access to the actual Nextcloud server is not necessary to mount this attack.\n\nFirst of all, having access to the file system where Nextcloud runs is actually \"having administrative access\", as you can simply add a user which is part of the admin group.\n\n\u003e The mentioned attack scenarios may also be executed by an external storage provider if the folder that is used as the data directory is stored at this external storage provider.\n\nOur idea for this problem is to allow to change the location of the key storage.\nCheck https://docs.nextcloud.com/server/17/admin_manual/configuration_files/encryption_configuration.html#occ-encryption-commands\n\u003e ```\n\u003e occ encryption:show-key-storage-root\n\u003e Current key storage root:  default storage location (data/)\n\u003e ```\n\u003e Move keys to a different folder, either locally or on a different server. The folder must already exist, be owned by root and your HTTP group, and be restricted to root and your HTTP group. Further the folder needs to be located somewhere in your Nextcloud data folder, either physically, or as a mount. This example is for Ubuntu Linux. Note that the new folder is relative to your occ directory:\n\n\u003e ```\n\u003e cd /your/nextcloud/data\n\u003e mkdir keys\n\u003e chown -R root:www-data keys\n\u003e chmod -R 0770 keys\n\u003e occ encryption:change-key-storage-root keys\n\u003e Start to move keys:\n\u003e    4 [============================]\n\u003e Key storage root successfully changed to keys\n\u003e ```\n\n\nSo in case of an external storage being used, you would simply not put the encryption keys on the external storage, but leave them on your save Nextcloud server.\n\nI will have a closer look at the user-key scenario again.\n","markdown_message":"\u003cblockquote\u003e\n\u003cp\u003eAdministrative access to the actual Nextcloud server is not necessary to mount this attack.\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eFirst of all, having access to the file system where Nextcloud runs is actually \u0026quot;having administrative access\u0026quot;, as you can simply add a user which is part of the admin group.\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eThe mentioned attack scenarios may also be executed by an external storage provider if the folder that is used as the data directory is stored at this external storage provider.\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eOur idea for this problem is to allow to change the location of the key storage.\u003cbr\u003e\nCheck \u003ca title=\"https://docs.nextcloud.com/server/17/admin_manual/configuration_files/encryption_configuration.html#occ-encryption-commands\" href=\"/redirect?url=https%3A%2F%2Fdocs.nextcloud.com%2Fserver%2F17%2Fadmin_manual%2Fconfiguration_files%2Fencryption_configuration.html%23occ-encryption-commands\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://docs.nextcloud.com/server/17/admin_manual/configuration_files/encryption_configuration.html#occ-encryption-commands\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eocc encryption:show-key-storage-root\nCurrent key storage root:  default storage location (data/)\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eMove keys to a different folder, either locally or on a different server. The folder must already exist, be owned by root and your HTTP group, and be restricted to root and your HTTP group. Further the folder needs to be located somewhere in your Nextcloud data folder, either physically, or as a mount. This example is for Ubuntu Linux. Note that the new folder is relative to your occ directory:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ecd /your/nextcloud/data\nmkdir keys\nchown -R root:www-data keys\nchmod -R 0770 keys\nocc encryption:change-key-storage-root keys\nStart to move keys:\n   4 [============================]\nKey storage root successfully changed to keys\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eSo in case of an external storage being used, you would simply not put the encryption keys on the external storage, but leave them on your save Nextcloud server.\u003c/p\u003e\n\n\u003cp\u003eI will have a closer look at the user-key scenario again.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-11-11T15:14:34.204Z","updated_at":"2019-11-11T15:14:34.204Z","actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6319768,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi, I know had time to look at this again. Your documentation says:\n\n\u003e Further the folder needs to be located somewhere in your Nextcloud data folder, either physically, or as a mount.\n\nSo your idea for this problem wouldn't work in cases where the whole data directory is stored at an external party as - according to the documentation - the keys have to reside in the data directory.","markdown_message":"\u003cp\u003eHi, I know had time to look at this again. Your documentation says:\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eFurther the folder needs to be located somewhere in your Nextcloud data folder, either physically, or as a mount.\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eSo your idea for this problem wouldn\u0026#39;t work in cases where the whole data directory is stored at an external party as - according to the documentation - the keys have to reside in the data directory.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-11-15T20:25:09.218Z","updated_at":"2019-11-15T20:25:09.218Z","actor":{"username":"yahe","cleared":false,"url":"/yahe","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/FHoMM5nd5Mw7BuoUY5D7NTdF/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6402924,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I like the idea of storing the fingerprints in the database and comparing them.\nI'll see what I can do. But it might take a while as the 18 wrap up is consuming a lot of time.","markdown_message":"\u003cp\u003eI like the idea of storing the fingerprints in the database and comparing them.\u003cbr\u003e\nI\u0026#39;ll see what I can do. But it might take a while as the 18 wrap up is consuming a lot of time.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-11-25T19:45:12.472Z","updated_at":"2019-11-25T19:45:12.472Z","actor":{"username":"rullzer","cleared":false,"url":"/rullzer","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/086/005/20095c4a0c77c88375f8db5d6ed10f350d98a5a3_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6402925,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2019-11-25T19:45:19.385Z","updated_at":"2019-11-25T19:45:19.385Z","actor":{"username":"rullzer","cleared":false,"url":"/rullzer","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/086/005/20095c4a0c77c88375f8db5d6ed10f350d98a5a3_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6829013,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi, I guess that now that Nextcloud 18 has been published there will be the time to look into the issues of the server-side encryption? My plan is to to submit a talk about the Nextcloud server-side encryption to the upcoming [Gulaschprogrammiernacht](https://entropia.de/GPN20) (May 21st to May 24th). This should be enough time to fix the issues.","markdown_message":"\u003cp\u003eHi, I guess that now that Nextcloud 18 has been published there will be the time to look into the issues of the server-side encryption? My plan is to to submit a talk about the Nextcloud server-side encryption to the upcoming \u003ca href=\"/redirect?url=https%3A%2F%2Fentropia.de%2FGPN20\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eGulaschprogrammiernacht\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e (May 21st to May 24th). This should be enough time to fix the issues.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-01-21T16:36:54.668Z","updated_at":"2020-01-21T16:36:54.668Z","actor":{"username":"yahe","cleared":false,"url":"/yahe","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/FHoMM5nd5Mw7BuoUY5D7NTdF/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8122990,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello, this issue hasn't seen any update for 4 months. We approached the end of May without a fix. Do you still intend to work on this problem?","markdown_message":"\u003cp\u003eHello, this issue hasn\u0026#39;t seen any update for 4 months. We approached the end of May without a fix. Do you still intend to work on this problem?\u003c/p\u003e\n","automated_response":false,"created_at":"2020-05-27T19:41:52.407Z","updated_at":"2020-05-27T19:41:52.407Z","actor":{"username":"yahe","cleared":false,"url":"/yahe","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/FHoMM5nd5Mw7BuoUY5D7NTdF/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8145186,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi,\n\nYes this is still on our list but right now we don't have a good way to solve it.\n\nCheers,\n--Roeland","markdown_message":"\u003cp\u003eHi,\u003c/p\u003e\n\n\u003cp\u003eYes this is still on our list but right now we don\u0026#39;t have a good way to solve it.\u003c/p\u003e\n\n\u003cp\u003eCheers,\u003cbr\u003e\n--Roeland\u003c/p\u003e\n","automated_response":false,"created_at":"2020-05-29T13:34:49.656Z","updated_at":"2020-05-29T13:34:49.656Z","actor":{"username":"rullzer","cleared":false,"url":"/rullzer","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/086/005/20095c4a0c77c88375f8db5d6ed10f350d98a5a3_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8901172,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi,\n\nSo I'm back form my holiday and am continuing on https://github.com/nextcloud/server/pull/21529\n\nSince keys can be moved for files etc. Linking the data in the database is tricky. However in this new approach the keys are encrypted with the system secret. And hence the attacker can't modify them.\n\nWould you have the possibility to check out that PR?\n\nCheers,\n--Roeland","markdown_message":"\u003cp\u003eHi,\u003c/p\u003e\n\n\u003cp\u003eSo I\u0026#39;m back form my holiday and am continuing on \u003ca title=\"https://github.com/nextcloud/server/pull/21529\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fnextcloud%2Fserver%2Fpull%2F21529\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/nextcloud/server/pull/21529\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eSince keys can be moved for files etc. Linking the data in the database is tricky. However in this new approach the keys are encrypted with the system secret. And hence the attacker can\u0026#39;t modify them.\u003c/p\u003e\n\n\u003cp\u003eWould you have the possibility to check out that PR?\u003c/p\u003e\n\n\u003cp\u003eCheers,\u003cbr\u003e\n--Roeland\u003c/p\u003e\n","automated_response":false,"created_at":"2020-08-11T07:49:48.701Z","updated_at":"2020-08-11T07:49:48.701Z","actor":{"username":"rullzer","cleared":false,"url":"/rullzer","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/086/005/20095c4a0c77c88375f8db5d6ed10f350d98a5a3_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8903396,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I think that the solution goes in the right direction, but I see a certain flow: If I understand it correctly, it is still possible to replace the public key of one user with the public key of another user. So the given solution improves on the currently existing problem but does not completely fix it.\n\nUnfortunately, you currently have no possibility to have integrity-protected metadata for public key files. If you switched the process around to: `encrypt(json_encode($data))` you could have integrity-protected metadata. Then, a possibility to fix this problem completely would be to not only introduce the `$data[\"key\"]` value but also a `$data[\"user\"]` value containing the name of the associated user. This could be checked on usage to make sure that the key actually belongs to the correct user. Thanks to the EtM encryption taking place at the end, the key as well as the metadata would be integrity-protected.","markdown_message":"\u003cp\u003eI think that the solution goes in the right direction, but I see a certain flow: If I understand it correctly, it is still possible to replace the public key of one user with the public key of another user. So the given solution improves on the currently existing problem but does not completely fix it.\u003c/p\u003e\n\n\u003cp\u003eUnfortunately, you currently have no possibility to have integrity-protected metadata for public key files. If you switched the process around to: \u003ccode\u003eencrypt(json_encode($data))\u003c/code\u003e you could have integrity-protected metadata. Then, a possibility to fix this problem completely would be to not only introduce the \u003ccode\u003e$data[\u0026quot;key\u0026quot;]\u003c/code\u003e value but also a \u003ccode\u003e$data[\u0026quot;user\u0026quot;]\u003c/code\u003e value containing the name of the associated user. This could be checked on usage to make sure that the key actually belongs to the correct user. Thanks to the EtM encryption taking place at the end, the key as well as the metadata would be integrity-protected.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-08-11T10:32:54.033Z","updated_at":"2020-08-11T10:32:54.033Z","actor":{"username":"yahe","cleared":false,"url":"/yahe","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/FHoMM5nd5Mw7BuoUY5D7NTdF/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8908306,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi,\n\nThanks for the quick analysis.\nRight turning it around would indeed make more sense. Let me do that.\n\nI need to think about your comment. I think you are right and we can indeed store the user key with the uid.\nIn any case with this in place the attack scopes limits significantly in the sense that the attacker now must have an account on the system and access to the external storage. However lets fix it properly now that we are touching the code in any case.\n\nI need a break now since it is way to hot here. I'll get back to you tomorrow.\n\nCheers,\n--Roeland\n","markdown_message":"\u003cp\u003eHi,\u003c/p\u003e\n\n\u003cp\u003eThanks for the quick analysis.\u003cbr\u003e\nRight turning it around would indeed make more sense. Let me do that.\u003c/p\u003e\n\n\u003cp\u003eI need to think about your comment. I think you are right and we can indeed store the user key with the uid.\u003cbr\u003e\nIn any case with this in place the attack scopes limits significantly in the sense that the attacker now must have an account on the system and access to the external storage. However lets fix it properly now that we are touching the code in any case.\u003c/p\u003e\n\n\u003cp\u003eI need a break now since it is way to hot here. I\u0026#39;ll get back to you tomorrow.\u003c/p\u003e\n\n\u003cp\u003eCheers,\u003cbr\u003e\n--Roeland\u003c/p\u003e\n","automated_response":false,"created_at":"2020-08-11T17:02:46.432Z","updated_at":"2020-08-11T17:02:46.432Z","actor":{"username":"rullzer","cleared":false,"url":"/rullzer","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/086/005/20095c4a0c77c88375f8db5d6ed10f350d98a5a3_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8914908,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi,\n\nI updated the PR. Now it also stores the UID in the userkeys  (and null in the systemkeys). This is then all encrypted.\nIt needs some cleanup but I think this now goes in the right direction.\n\nCheers,\n--Roeland","markdown_message":"\u003cp\u003eHi,\u003c/p\u003e\n\n\u003cp\u003eI updated the PR. Now it also stores the UID in the userkeys  (and null in the systemkeys). This is then all encrypted.\u003cbr\u003e\nIt needs some cleanup but I think this now goes in the right direction.\u003c/p\u003e\n\n\u003cp\u003eCheers,\u003cbr\u003e\n--Roeland\u003c/p\u003e\n","automated_response":false,"created_at":"2020-08-12T11:12:58.744Z","updated_at":"2020-08-12T11:12:58.744Z","actor":{"username":"rullzer","cleared":false,"url":"/rullzer","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/086/005/20095c4a0c77c88375f8db5d6ed10f350d98a5a3_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8915645,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi, I had a short look at the current version in the PR. IMHO this is coming together quite nicely.\n\nI am, however, a bit confused with the additional encodings going on. Of course, you may have certain reasons to double- and tripple-encode data, but I just wanted to mention what I see. I stumbled over this kind of (in my opinion) unnecessary file increases before with the 35% size-increase of the encrypted content files.:\n\n* Currently, the public keys stored by the SSE are PEM-encoded (which is basically Base64-Encoding between text separators with line breaks). That's the formatting you retrieve [here](https://github.com/nextcloud/server/blob/aa387242e110555e6ff6058985b40a040f9c1540/lib/private/Encryption/Keys/Storage.php#L275) and write [here](https://github.com/nextcloud/server/blob/aa387242e110555e6ff6058985b40a040f9c1540/lib/private/Encryption/Keys/Storage.php#L340). Instead of Base64-encoding the whole data again, you could just replace the line breaks with a placeholder like `'\\n'`, but that's more of a taste.\n* What I don't understand is why you Base64-encode the encrypted content again before storing it in a file [here](https://github.com/nextcloud/server/blob/aa387242e110555e6ff6058985b40a040f9c1540/lib/private/Encryption/Keys/Storage.php#L343) only to Base64-decode it [here](https://github.com/nextcloud/server/blob/aa387242e110555e6ff6058985b40a040f9c1540/lib/private/Encryption/Keys/Storage.php#L299) when you read the file back in. I really don't see the benefit of this additional Base64-encoding. `file_get_contents()` and `file_put_contents()` are perfectly able to handle binary data without precautionary encoding.\n\nBut, as I said, this is more of an observation rather than a security issue.","markdown_message":"\u003cp\u003eHi, I had a short look at the current version in the PR. IMHO this is coming together quite nicely.\u003c/p\u003e\n\n\u003cp\u003eI am, however, a bit confused with the additional encodings going on. Of course, you may have certain reasons to double- and tripple-encode data, but I just wanted to mention what I see. I stumbled over this kind of (in my opinion) unnecessary file increases before with the 35% size-increase of the encrypted content files.:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eCurrently, the public keys stored by the SSE are PEM-encoded (which is basically Base64-Encoding between text separators with line breaks). That\u0026#39;s the formatting you retrieve \u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fnextcloud%2Fserver%2Fblob%2Faa387242e110555e6ff6058985b40a040f9c1540%2Flib%2Fprivate%2FEncryption%2FKeys%2FStorage.php%23L275\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehere\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e and write \u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fnextcloud%2Fserver%2Fblob%2Faa387242e110555e6ff6058985b40a040f9c1540%2Flib%2Fprivate%2FEncryption%2FKeys%2FStorage.php%23L340\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehere\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e. Instead of Base64-encoding the whole data again, you could just replace the line breaks with a placeholder like \u003ccode\u003e\u0026#39;\\n\u0026#39;\u003c/code\u003e, but that\u0026#39;s more of a taste.\u003c/li\u003e\n\u003cli\u003eWhat I don\u0026#39;t understand is why you Base64-encode the encrypted content again before storing it in a file \u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fnextcloud%2Fserver%2Fblob%2Faa387242e110555e6ff6058985b40a040f9c1540%2Flib%2Fprivate%2FEncryption%2FKeys%2FStorage.php%23L343\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehere\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e only to Base64-decode it \u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fnextcloud%2Fserver%2Fblob%2Faa387242e110555e6ff6058985b40a040f9c1540%2Flib%2Fprivate%2FEncryption%2FKeys%2FStorage.php%23L299\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehere\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e when you read the file back in. I really don\u0026#39;t see the benefit of this additional Base64-encoding. \u003ccode\u003efile_get_contents()\u003c/code\u003e and \u003ccode\u003efile_put_contents()\u003c/code\u003e are perfectly able to handle binary data without precautionary encoding.\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eBut, as I said, this is more of an observation rather than a security issue.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-08-12T12:15:52.570Z","updated_at":"2020-08-12T12:15:52.570Z","actor":{"username":"yahe","cleared":false,"url":"/yahe","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/FHoMM5nd5Mw7BuoUY5D7NTdF/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8915664,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi,\n\nNo you are of course right. It is a left over I think from the first step where I encrypted only the key field (so that the json encode would not puke).\n\nThis can go indeed.\nI'll tackle that in a bit.\n\nCheers,\n--Roeland","markdown_message":"\u003cp\u003eHi,\u003c/p\u003e\n\n\u003cp\u003eNo you are of course right. It is a left over I think from the first step where I encrypted only the key field (so that the json encode would not puke).\u003c/p\u003e\n\n\u003cp\u003eThis can go indeed.\u003cbr\u003e\nI\u0026#39;ll tackle that in a bit.\u003c/p\u003e\n\n\u003cp\u003eCheers,\u003cbr\u003e\n--Roeland\u003c/p\u003e\n","automated_response":false,"created_at":"2020-08-12T12:18:31.746Z","updated_at":"2020-08-12T12:18:31.746Z","actor":{"username":"rullzer","cleared":false,"url":"/rullzer","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/086/005/20095c4a0c77c88375f8db5d6ed10f350d98a5a3_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8924632,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi,\n\nOk we went over the code here again and some cleanup was done.\nNow we are in the process of doing lot of tests but all seems good. I'm positive this can land in thenext release.\n\nCheers,\n--Roeland","markdown_message":"\u003cp\u003eHi,\u003c/p\u003e\n\n\u003cp\u003eOk we went over the code here again and some cleanup was done.\u003cbr\u003e\nNow we are in the process of doing lot of tests but all seems good. I\u0026#39;m positive this can land in thenext release.\u003c/p\u003e\n\n\u003cp\u003eCheers,\u003cbr\u003e\n--Roeland\u003c/p\u003e\n","automated_response":false,"created_at":"2020-08-13T10:47:40.193Z","updated_at":"2020-08-13T10:47:40.193Z","actor":{"username":"rullzer","cleared":false,"url":"/rullzer","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/086/005/20095c4a0c77c88375f8db5d6ed10f350d98a5a3_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8924764,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Awesome to hear that. :)","markdown_message":"\u003cp\u003eAwesome to hear that. :)\u003c/p\u003e\n","automated_response":false,"created_at":"2020-08-13T10:59:49.947Z","updated_at":"2020-08-13T10:59:49.947Z","actor":{"username":"yahe","cleared":false,"url":"/yahe","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/FHoMM5nd5Mw7BuoUY5D7NTdF/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9021073,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi,\n\nOk this got merged into 20.\nIt is already in the beta1.\n\nCheers,\n--Roeland","markdown_message":"\u003cp\u003eHi,\u003c/p\u003e\n\n\u003cp\u003eOk this got merged into 20.\u003cbr\u003e\nIt is already in the beta1.\u003c/p\u003e\n\n\u003cp\u003eCheers,\u003cbr\u003e\n--Roeland\u003c/p\u003e\n","automated_response":false,"created_at":"2020-08-24T10:46:33.930Z","updated_at":"2020-08-24T10:46:33.930Z","actor":{"username":"rullzer","cleared":false,"url":"/rullzer","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/086/005/20095c4a0c77c88375f8db5d6ed10f350d98a5a3_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9423161,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi, I've seen that you have announced Nextcloud 20 that contains the fix for this issue. Will there be a [security advisory](https://nextcloud.com/security/advisories/) for this issue?","markdown_message":"\u003cp\u003eHi, I\u0026#39;ve seen that you have announced Nextcloud 20 that contains the fix for this issue. Will there be a \u003ca href=\"/redirect?url=https%3A%2F%2Fnextcloud.com%2Fsecurity%2Fadvisories%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003esecurity advisory\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e for this issue?\u003c/p\u003e\n","automated_response":false,"created_at":"2020-10-05T16:18:55.135Z","updated_at":"2020-10-05T16:18:55.135Z","actor":{"username":"yahe","cleared":false,"url":"/yahe","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/FHoMM5nd5Mw7BuoUY5D7NTdF/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9429784,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks a lot for your report again. This has been resolved in our latest maintenance releases and we're working on the advisories at the moment.\n\nPlease let us know how you'd like to be credited in our official advisory. We require the following information:\n\n- Name / Pseudonym\n- Email address (optional)\n- Website (optional)\n- Company (optional)\n","markdown_message":"\u003cp\u003eThanks a lot for your report again. This has been resolved in our latest maintenance releases and we\u0026#39;re working on the advisories at the moment.\u003c/p\u003e\n\n\u003cp\u003ePlease let us know how you\u0026#39;d like to be credited in our official advisory. We require the following information:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eName / Pseudonym\u003c/li\u003e\n\u003cli\u003eEmail address (optional)\u003c/li\u003e\n\u003cli\u003eWebsite (optional)\u003c/li\u003e\n\u003cli\u003eCompany (optional)\u003c/li\u003e\n\u003c/ul\u003e\n","automated_response":false,"created_at":"2020-10-06T08:05:03.428Z","updated_at":"2020-10-06T08:05:03.428Z","actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"yahe","url":"/yahe"},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9429820,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Disclosure planned for 1st November\n\nhttps://nextcloud.com/security/advisory/?id=NC-SA-2020-041\nhttps://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-8159\n","markdown_message":"\u003cp\u003eDisclosure planned for 1st November\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"https://nextcloud.com/security/advisory/?id=NC-SA-2020-041\" href=\"/redirect?url=https%3A%2F%2Fnextcloud.com%2Fsecurity%2Fadvisory%2F%3Fid%3DNC-SA-2020-041\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://nextcloud.com/security/advisory/?id=NC-SA-2020-041\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\n\u003ca title=\"https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-8159\" href=\"/redirect?url=https%3A%2F%2Fcve.mitre.org%2Fcgi-bin%2Fcvename.cgi%3Fname%3DCVE-2020-8159\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-8159\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2020-10-06T08:09:39.931Z","updated_at":"2020-10-06T08:09:39.931Z","actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9429821,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@yahe do you still not want bounties?","markdown_message":"\u003cp\u003e\u003ca href=\"/yahe\"\u003e@yahe\u003c/a\u003e do you still not want bounties?\u003c/p\u003e\n","automated_response":false,"created_at":"2020-10-06T08:09:58.738Z","updated_at":"2020-10-06T08:09:58.738Z","actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9431774,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"As said, merch would be welcome. :)","markdown_message":"\u003cp\u003eAs said, merch would be welcome. :)\u003c/p\u003e\n","automated_response":false,"created_at":"2020-10-06T10:09:49.417Z","updated_at":"2020-10-06T10:09:49.417Z","actor":{"username":"yahe","cleared":false,"url":"/yahe","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/FHoMM5nd5Mw7BuoUY5D7NTdF/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9431872,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Concerning the crediting in the advisory:\n\nName: Kevin \"Kenny\" Niehage\nE-Mail: kenny@syseleven.de\nWebsite: https://www.syseleven.de/\nCompany: SysEleven GmbH","markdown_message":"\u003cp\u003eConcerning the crediting in the advisory:\u003c/p\u003e\n\n\u003cp\u003eName: Kevin \u0026quot;Kenny\u0026quot; Niehage\u003cbr\u003e\nE-Mail: \u003ca title=\"kenny@syseleven.de\" href=\"mailto:kenny@syseleven.de\" rel=\"nofollow noopener noreferrer\"\u003ekenny@syseleven.de\u003c/a\u003e\u003cbr\u003e\nWebsite: \u003ca title=\"https://www.syseleven.de/\" href=\"/redirect?url=https%3A%2F%2Fwww.syseleven.de%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.syseleven.de/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nCompany: SysEleven GmbH\u003c/p\u003e\n","automated_response":false,"created_at":"2020-10-06T10:21:32.714Z","updated_at":"2020-10-06T10:21:32.714Z","actor":{"username":"yahe","cleared":false,"url":"/yahe","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/FHoMM5nd5Mw7BuoUY5D7NTdF/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9442067,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"[CVE-2020-8159](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-8159) is already taken. Maybe that's just a typo.","markdown_message":"\u003cp\u003e\u003ca href=\"/redirect?url=https%3A%2F%2Fcve.mitre.org%2Fcgi-bin%2Fcvename.cgi%3Fname%3DCVE-2020-8159\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eCVE-2020-8159\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e is already taken. Maybe that\u0026#39;s just a typo.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-10-07T06:57:03.182Z","updated_at":"2020-10-07T06:57:03.182Z","actor":{"username":"yahe","cleared":false,"url":"/yahe","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/FHoMM5nd5Mw7BuoUY5D7NTdF/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9443497,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Right, it's https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-8259\n","markdown_message":"\u003cp\u003eRight, it\u0026#39;s \u003ca title=\"https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-8259\" href=\"/redirect?url=https%3A%2F%2Fcve.mitre.org%2Fcgi-bin%2Fcvename.cgi%3Fname%3DCVE-2020-8259\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-8259\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2020-10-07T08:50:54.403Z","updated_at":"2020-10-07T08:50:54.403Z","actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9730350,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Good morning. Do you already know when the CVE and NC-SA will be published?","markdown_message":"\u003cp\u003eGood morning. Do you already know when the CVE and NC-SA will be published?\u003c/p\u003e\n","automated_response":false,"created_at":"2020-11-05T08:07:23.210Z","updated_at":"2020-11-05T08:07:23.210Z","actor":{"username":"yahe","cleared":false,"url":"/yahe","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/FHoMM5nd5Mw7BuoUY5D7NTdF/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9749069,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-11-06T16:20:55.781Z","updated_at":"2020-11-06T16:20:55.781Z","first_to_agree":true,"actor":{"username":"yahe","cleared":false,"url":"/yahe","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/FHoMM5nd5Mw7BuoUY5D7NTdF/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9814689,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"SA published, CVE should autopublish when this is disclosed.","markdown_message":"\u003cp\u003eSA published, CVE should autopublish when this is disclosed.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-11-13T14:39:41.088Z","updated_at":"2020-11-13T14:39:41.088Z","actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9814690,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-11-13T14:39:41.239Z","updated_at":"2020-11-13T14:39:41.239Z","actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}