{"id":514577,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC81MTQ1Nzc=","url":"https://hackerone.com/reports/514577","title":"Failure to Invalid Session after Password Change","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2019-03-24T17:48:05.458Z","submitted_at":"2019-03-24T17:48:05.458Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"d3tonator","url":"/d3tonator","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/p3aFEDoVCzEZ9ucFQkQDvPoE/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":21045,"url":"https://hackerone.com/omise","handle":"omise","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/021/045/124b85928203caaec29c4eb44ef525ca0ddd0fe8_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/021/045/124b85928203caaec29c4eb44ef525ca0ddd0fe8_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Omise","twitter_handle":"omise","website":"https://www.omise.co","about":"Next generation of payment Platform"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2019-12-08T17:43:41.548Z","bug_reporter_agreed_on_going_public_at":"2019-11-08T17:43:40.528Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"While conducting my researching I discovered that the application Failure to invalidate session after password.  In this scenario changing the password doesn't destroys the other sessions which are logged in with old passwords.\n\nSteps to Reproduce:\n----------------------\n\u003eVideo PoC attached\n\n###Step By Step:\n-\u003eLogin with the same account in Chrome and Firefox Simultaneously\n-\u003eChange the pass in Chrome Browser\n-\u003eGo to firefox and Update any information, information will be update *If attacker login with firefox and user know his password stolen so even user change their password, his account remain insecure and attacker have full access of victim account.\n\n###Mitigation\nWhen some change in user password, each and every active sessions that belongs to that particular account must be destroyed!\nI would like to recommend you to add a process that asks users whether user want to close all open sessions or not right after changing password.\n\nSo there is two way, either you let users to choose if they want to keep active sessions or just destroy every active sessions when an users change his/her password!\n\nPlease fix this Vulnerability and let me know. Looking forward to hear from you.\n\nBest Regards\n\n## Impact\n\nIf attacker have user password and logged in different places, As other sessions is not destroyed, attacker will be still logged in your account even after changing password, cause his session is still active.. Malicious actor can complete access your account till that session expires! So, your account remains insecure even after the changing of password","vulnerability_information_html":"\u003cp\u003eWhile conducting my researching I discovered that the application Failure to invalidate session after password.  In this scenario changing the password doesn\u0026#39;t destroys the other sessions which are logged in with old passwords.\u003c/p\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps to Reproduce:\u003c/h2\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eVideo PoC attached\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003ch3 id=\"step-by-step\"\u003eStep By Step:\u003c/h3\u003e\n\n\u003cp\u003e-\u0026gt;Login with the same account in Chrome and Firefox Simultaneously\u003cbr\u003e\n-\u0026gt;Change the pass in Chrome Browser\u003cbr\u003e\n-\u0026gt;Go to firefox and Update any information, information will be update *If attacker login with firefox and user know his password stolen so even user change their password, his account remain insecure and attacker have full access of victim account.\u003c/p\u003e\n\n\u003ch3 id=\"mitigation\"\u003eMitigation\u003c/h3\u003e\n\n\u003cp\u003eWhen some change in user password, each and every active sessions that belongs to that particular account must be destroyed!\u003cbr\u003e\nI would like to recommend you to add a process that asks users whether user want to close all open sessions or not right after changing password.\u003c/p\u003e\n\n\u003cp\u003eSo there is two way, either you let users to choose if they want to keep active sessions or just destroy every active sessions when an users change his/her password!\u003c/p\u003e\n\n\u003cp\u003ePlease fix this Vulnerability and let me know. Looking forward to hear from you.\u003c/p\u003e\n\n\u003cp\u003eBest Regards\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eIf attacker have user password and logged in different places, As other sessions is not destroyed, attacker will be still logged in your account even after changing password, cause his session is still active.. Malicious actor can complete access your account till that session expires! So, your account remains insecure even after the changing of password\u003c/p\u003e\n","weakness":{"id":90,"name":"Insufficient Session Expiration"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":451197,"file_name":"Omise_Session_Not_Expire_.mp4","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/451/197/9303e72eaeeabe8ed8ad1a0e5fd3c4855753ced8/Omise_Session_Not_Expire_.mp4?response-content-disposition=attachment%3B%20filename%3D%22Omise_Session_Not_Expire_.mp4%22%3B%20filename%2A%3DUTF-8%27%27Omise_Session_Not_Expire_.mp4\u0026response-content-type=video%2Fmp4\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQRF2F3DNN%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T061330Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCq%2BvKnwl6LFdj00DiqFKaUHM8vK%2Fo1tPHwYahCeGa93QIgIGXi89nBgDj4GiNdSy8pbzTFSts%2FsTmVKSM%2B7%2BKO9T4qtAMIVxABGgwwMTM2MTkyNzQ4NDkiDC9ugoHsMNk43keJ8SqRA8JrBBYsK5T0HiaJ%2F4T50sG1Ri6J%2BT91kOgNavpYRolFX7jpLcV0V81FUABPzsjSnAxRmYBypjIaPqZGQ8oq%2F9n27wPLgj8hUTl8O3SfU1GWCMHbROvW%2BF2K77xGt0sJKNZYVxNdbqrYwCp5MFfMpJjwvv%2BhMkb%2BfRRyL7GEsu82VMU41lKH3RgrBDJApguUYlLANZ1Ej8ImBTuQa0PTHDqpwoWpjaPcrnIHZqTdHOI5Wm1eCoy5eaHGFikwjjvjuMJ%2F1a5ex%2FCIOhGcwoqCBDet1aBO%2BZq78RzS1QY34XnoChAp%2BaikZB20FcxjUwn%2BkvJECosM%2B4F4PQHepofUS3ejTLZPjeYi9qQNjzq%2Fm%2Fv%2FV4Vqc3IwmTFe06OdDxIgpZyAcTQoSU8vA7sbEDpB%2F3XQDS%2BUqZejbvdrbfU8WGZYnfYRHIKZtByJaRcPB8vqFX9lX0oeLxz0IEswNXH%2FFNMPBsLv79pLu3OV6Lzfbgb36AT8ui2UZLwoOGRrSo71Tb%2FsYvBelBr2drk9Yi%2Fa%2FnGwML2Fq%2F8FOusBbN3FmFgpQ8hwRzpol0ZxBWjfkVayY1CeW8JmiNjsl1ndCgMmcPk10W64GF1qbk7fF0uPQopY1SymUfLnKrk2DYd5OUiFjtVktJLGKZ7wkgrDfWYDpQHSQRJQyMvnd2nX1QfEA0AlGzRulOvM2iwTIk241T4DuFrDCiCqYL8Mv%2FPeDbSAy7t6gkKpJ8C2PUVCIivsXSH1HvLfNTen1g5wD0tpM%2FnXwZxdxfuh8W3doYRnkWcmf8W%2F2IdcL3V8Ca3%2FV7qrIFxbsZIzSmpnSBl18cNkli7atg7%2FBcRNrqYiFsXMe5OsMSXyZkZK%2BQ%3D%3D\u0026X-Amz-Signature=c71e973f69bce8f4b696d05446b2e69d00fb6cada3a56610275c12b04a778dda","file_size":1981166,"type":"video/mp4"}],"allow_singular_disclosure_at":"2019-12-08T17:43:40.568Z","allow_singular_disclosure_after":-33395389.836576167,"singular_disclosure_allowed":true,"vote_count":12,"voters":["sameerphad72","udit_thakkur","darkerhack","logintest","cryptographer","ticzox","armansameer","c1ph3r984","daval0","amenodominem","and 2 more..."],"severity":{"rating":"medium","author_type":"User"},"structured_scope":{"databaseId":21896,"asset_type":"URL","asset_identifier":"www.omise.co","max_severity":"high"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":4382264,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thank you for the research, \nThis has been up for discussion before. We have session management page where the user can as you say choose at any time to revoke one or all sessions, not only when they change password but if in any case they feel they need to revoke some of their logged in sessions.  We also have session timeout so they are not logged in forever. \n\nWe think this is enough to mitigate this risk, and the user have full control over what session is alive and when. \n\nWe give you points anyways since report was in a good way, and had a lot of info. We can understand the point of view that you want this to be automatic action dependent on especially password change, but the generic session management we think are better, and allows for many user cases for the user to protect against different types of risks. \n\nbest regards\nOmise Security \n","markdown_message":"\u003cp\u003eThank you for the research, \u003cbr\u003e\nThis has been up for discussion before. We have session management page where the user can as you say choose at any time to revoke one or all sessions, not only when they change password but if in any case they feel they need to revoke some of their logged in sessions.  We also have session timeout so they are not logged in forever. \u003c/p\u003e\n\n\u003cp\u003eWe think this is enough to mitigate this risk, and the user have full control over what session is alive and when. \u003c/p\u003e\n\n\u003cp\u003eWe give you points anyways since report was in a good way, and had a lot of info. We can understand the point of view that you want this to be automatic action dependent on especially password change, but the generic session management we think are better, and allows for many user cases for the user to protect against different types of risks. \u003c/p\u003e\n\n\u003cp\u003ebest regards\u003cbr\u003e\nOmise Security \u003c/p\u003e\n","automated_response":false,"created_at":"2019-03-25T01:47:55.541Z","updated_at":"2019-03-25T01:47:55.541Z","actor":{"username":"hardymansen","cleared":false,"url":"/hardymansen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/268/510/a5be384b5218b68c9ed291e2649c3a659f9baeb5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"d3tonator","url":"/d3tonator"},"genius_execution_id":null,"team_handle":"omise","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4382265,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"","markdown_message":"","automated_response":false,"created_at":"2019-03-25T01:48:35.168Z","updated_at":"2019-03-25T01:48:35.168Z","actor":{"url":"/omise","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/021/045/124b85928203caaec29c4eb44ef525ca0ddd0fe8_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Omise"}},"genius_execution_id":null,"team_handle":"omise","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6256674,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-11-08T17:43:40.543Z","updated_at":"2019-11-08T17:43:40.543Z","first_to_agree":true,"actor":{"username":"d3tonator","cleared":false,"url":"/d3tonator","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/p3aFEDoVCzEZ9ucFQkQDvPoE/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"omise","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6497451,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-12-08T17:43:41.569Z","updated_at":"2019-12-08T17:43:41.569Z","actor":{"url":"/omise","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/021/045/124b85928203caaec29c4eb44ef525ca0ddd0fe8_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Omise"}},"genius_execution_id":null,"team_handle":"omise","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}