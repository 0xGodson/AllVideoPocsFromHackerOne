{"id":997070,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC85OTcwNzA=","url":"https://hackerone.com/reports/997070","title":"No rate limiting for confirmation email lead to huge Mass mailings","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2020-10-03T12:05:01.024Z","submitted_at":"2020-10-03T12:05:01.128Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"kittytrace","url":"/kittytrace","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/r5CLUGUkS1MWkpD3ZR3nwbYx/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13291,"url":"https://hackerone.com/nextcloud","handle":"nextcloud","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Nextcloud","twitter_handle":"nextclouders","website":"https://nextcloud.com","about":"Access, share and protect your files, calendars, contacts, communication \u0026 more at home and in your enterprise."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2020-11-04T10:45:00.563Z","bug_reporter_agreed_on_going_public_at":"2020-10-05T10:44:50.638Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"**Issue Description**\nNo rate limit means their is no mechanism to protect against the requests you made in a short frame of time. If the repetition doesn't give any error after 50, 100, 1000 repetitions then their will be no rate limit set. vulnerable has registred in [#297359](https://hackerone.com/reports/297359) [#774050](https://hackerone.com/reports/774050) [#922470](https://hackerone.com/reports/922470)\n\n**URL Effected**\nhttps://efss.qloud.my/index.php/apps/registration/\n\n###Step-by-step Reproduction Instructions\n  * Go to url https://efss.qloud.my/index.php/apps/registration/\n  * Add the victim emails, and repreat to burp-suite\n  * Sent request to burp-intruder, and clear all payloads ``ยง``\n  * In the payloads set a ``null-payloads`` and run intruder\n  * **Boom** 1Million request sent to victim-email\n\n**Request**\n```\nPOST /index.php/apps/registration/ HTTP/1.1\nHost: efss.qloud.my\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 142\nOrigin: null\nConnection: close\nUpgrade-Insecure-Requests: 1\n\nemail=victimattack%40gmail.com\u0026requesttoken=Cdt30n8l%2FBhsd0fTp4wDDyvOvA26umsBZgymNLTrJWI%3D%3AZL8W4SURzVcIIAm06cNxOlm5jUrP1QloEW3RWO2SQQA%3D\n```\n**Responsive Vulnerability**\n```\nHTTP/1.1 200 OK\nDate: Sat, 03 Oct 2020 11:58:21 GMT\nServer: Apache/2.4.29 (Ubuntu)\nStrict-Transport-Security: max-age=15552000; includeSubDomains; preload\nReferrer-Policy: no-referrer\nX-Content-Type-Options: nosniff\nX-Download-Options: noopen\nX-Frame-Options: SAMEORIGIN\nX-Permitted-Cross-Domain-Policies: none\nX-Robots-Tag: none\nX-XSS-Protection: 1; mode=block\nExpires: Thu, 19 Nov 1981 08:52:00 GMT\nCache-Control: no-cache, no-store, must-revalidate\nPragma: no-cache\nVary: Accept-Encoding\nContent-Length: 13400\nConnection: close\nContent-Type: text/html; charset=UTF-8\n```\n**Proof On Concept**\nF1012847\nF1012846\n\n## Impact\n\nthe attacker can send a request to the victim's email using a cloud server","vulnerability_information_html":"\u003cp\u003e\u003cstrong\u003eIssue Description\u003c/strong\u003e\u003cbr\u003e\nNo rate limit means their is no mechanism to protect against the requests you made in a short frame of time. If the repetition doesn\u0026#39;t give any error after 50, 100, 1000 repetitions then their will be no rate limit set. vulnerable has registred in \u003ca href=\"https://hackerone.com/reports/297359\"\u003e#297359\u003c/a\u003e \u003ca href=\"https://hackerone.com/reports/774050\"\u003e#774050\u003c/a\u003e \u003ca href=\"https://hackerone.com/reports/922470\"\u003e#922470\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eURL Effected\u003c/strong\u003e\u003cbr\u003e\n\u003ca title=\"https://efss.qloud.my/index.php/apps/registration/\" href=\"/redirect?url=https%3A%2F%2Fefss.qloud.my%2Findex.php%2Fapps%2Fregistration%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://efss.qloud.my/index.php/apps/registration/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch3 id=\"step-by-step-reproduction-instructions\"\u003eStep-by-step Reproduction Instructions\u003c/h3\u003e\n\n\u003cul\u003e\n\u003cli\u003eGo to url \u003ca title=\"https://efss.qloud.my/index.php/apps/registration/\" href=\"/redirect?url=https%3A%2F%2Fefss.qloud.my%2Findex.php%2Fapps%2Fregistration%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://efss.qloud.my/index.php/apps/registration/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003eAdd the victim emails, and repreat to burp-suite\u003c/li\u003e\n\u003cli\u003eSent request to burp-intruder, and clear all payloads \u003ccode\u003eยง\u003c/code\u003e\n\u003c/li\u003e\n\u003cli\u003eIn the payloads set a \u003ccode\u003enull-payloads\u003c/code\u003e and run intruder\u003c/li\u003e\n\u003cli\u003e\n\u003cstrong\u003eBoom\u003c/strong\u003e 1Million request sent to victim-email\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003e\u003cstrong\u003eRequest\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ePOST /index.php/apps/registration/ HTTP/1.1\nHost: efss.qloud.my\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 142\nOrigin: null\nConnection: close\nUpgrade-Insecure-Requests: 1\n\nemail=victimattack%40gmail.com\u0026amp;requesttoken=Cdt30n8l%2FBhsd0fTp4wDDyvOvA26umsBZgymNLTrJWI%3D%3AZL8W4SURzVcIIAm06cNxOlm5jUrP1QloEW3RWO2SQQA%3D\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e\u003cstrong\u003eResponsive Vulnerability\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eHTTP/1.1 200 OK\nDate: Sat, 03 Oct 2020 11:58:21 GMT\nServer: Apache/2.4.29 (Ubuntu)\nStrict-Transport-Security: max-age=15552000; includeSubDomains; preload\nReferrer-Policy: no-referrer\nX-Content-Type-Options: nosniff\nX-Download-Options: noopen\nX-Frame-Options: SAMEORIGIN\nX-Permitted-Cross-Domain-Policies: none\nX-Robots-Tag: none\nX-XSS-Protection: 1; mode=block\nExpires: Thu, 19 Nov 1981 08:52:00 GMT\nCache-Control: no-cache, no-store, must-revalidate\nPragma: no-cache\nVary: Accept-Encoding\nContent-Length: 13400\nConnection: close\nContent-Type: text/html; charset=UTF-8\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e\u003cstrong\u003eProof On Concept\u003c/strong\u003e\u003cbr\u003e\nF1012847\u003cbr\u003e\nF1012846\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003ethe attacker can send a request to the victim\u0026#39;s email using a cloud server\u003c/p\u003e\n","weakness":{"id":65,"name":"Business Logic Errors"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2020-11-04T10:44:50.671Z","allow_singular_disclosure_after":-4739660.196322961,"singular_disclosure_allowed":true,"vote_count":74,"voters":["ltidi","mr_vrush","duckoverflow","1337ibrahim","realtess","yusuf_furkan","bxr-eg","kittytrace","m0ti0nl3ss_","padenjakkittt","and 64 more..."],"severity":{"rating":"medium","author_type":"User"},"structured_scope":{"databaseId":56,"asset_type":"URL","asset_identifier":"https://nextcloud.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":9418619,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"An update has been released with https://github.com/nextcloud/registration/pull/246\n\nHowever please note that the server at  https://efss.qloud.my/ is not under our control, so not sure when it will be fixed there.","markdown_message":"\u003cp\u003eAn update has been released with \u003ca title=\"https://github.com/nextcloud/registration/pull/246\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fnextcloud%2Fregistration%2Fpull%2F246\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/nextcloud/registration/pull/246\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eHowever please note that the server at  \u003ca title=\"https://efss.qloud.my/\" href=\"/redirect?url=https%3A%2F%2Fefss.qloud.my%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://efss.qloud.my/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e is not under our control, so not sure when it will be fixed there.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-10-05T10:38:54.852Z","updated_at":"2020-10-05T10:38:54.852Z","actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9418627,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks a lot for your report again. This has been resolved in our latest maintenance releases.","markdown_message":"\u003cp\u003eThanks a lot for your report again. This has been resolved in our latest maintenance releases.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-10-05T10:39:43.118Z","updated_at":"2020-10-05T10:39:43.118Z","actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"kittytrace","url":"/kittytrace"},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9418634,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"The given app (registration) is not eligible for bounties.","markdown_message":"\u003cp\u003eThe given app (registration) is not eligible for bounties.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-10-05T10:40:11.587Z","updated_at":"2020-10-05T10:40:11.587Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Nextcloud"}},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9418961,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"**Hello Security Team @nextcloud @nickvergessen**\nThank's your response and updates, can we disclosed now.\n\n**Kind Regards\n@0x4_aulia**","markdown_message":"\u003cp\u003e\u003cstrong\u003eHello Security Team \u003ca href=\"/nextcloud\"\u003e@nextcloud\u003c/a\u003e \u003ca href=\"/nickvergessen\"\u003e@nickvergessen\u003c/a\u003e\u003c/strong\u003e\u003cbr\u003e\nThank\u0026#39;s your response and updates, can we disclosed now.\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eKind Regards\u003cbr\u003e\n\u003ca href=\"/0x4_aulia\"\u003e@0x4_aulia\u003c/a\u003e\u003c/strong\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2020-10-05T10:44:32.212Z","updated_at":"2020-10-05T10:47:53.080Z","actor":{"username":"kittytrace","cleared":false,"url":"/kittytrace","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/r5CLUGUkS1MWkpD3ZR3nwbYx/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9418965,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-10-05T10:44:50.656Z","updated_at":"2020-10-05T10:44:50.656Z","first_to_agree":true,"actor":{"username":"kittytrace","cleared":false,"url":"/kittytrace","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/r5CLUGUkS1MWkpD3ZR3nwbYx/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9722736,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-11-04T10:45:00.906Z","updated_at":"2020-11-04T10:45:00.906Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Nextcloud"}},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}