{"id":149268,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNDkyNjg=","url":"https://hackerone.com/reports/149268","title":"Arbitrary file upload when setting an avatar","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-07-05T05:06:43.444Z","submitted_at":"2016-07-05T05:06:43.444Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"strukt","url":"/strukt","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/038/303/42cd71a4698d80f88ab65e3117fd9fc401a57048_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":265,"url":"https://hackerone.com/expressionengine","handle":"expressionengine","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/265/25251ba4ab1d0b0304a6c3d197fba5c833c6003e_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/265/25251ba4ab1d0b0304a6c3d197fba5c833c6003e_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"ExpressionEngine","twitter_handle":"eecms","website":"https://expressionengine.com/","about":"ExpressionEngine is a robust and flexible open-source Content Management System."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2018-04-04T16:36:49.246Z","bug_reporter_agreed_on_going_public_at":"2018-04-04T16:12:59.861Z","team_member_agreed_on_going_public_at":"2018-04-04T16:36:49.167Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hello,\n\nWhen an administrator attempts to set an avatar from an external link, the parser just takes the source of whatever link they point it to and creates a file with the same extension and content in the uploads folder.\n\n##Steps to reproduce:\n\n1- Visit http://[HOST]/admin.php?/cp/members/profile/settings and scroll to the \"Change avatar\" section.\n2- Choose \"Link to avatar\" and set it's value to `http://strukt.tk/test.svg`\n3- After redirection, if you have a proxy, a request will be made to something like `http://[HOST]/images/avatars/test_1.svg` on your localhost. Try opening that in your browser and you should see an alert box over there.\n4- You can try that with `https://ellislab.com/asset/file/ee_server_wizard.zip`, it will create a .zip file over there.\n\nThat being said, an attacker can use other file types and may be able to run arbitrary commands on the OS.\n\nRegards","vulnerability_information_html":"\u003cp\u003eHello,\u003c/p\u003e\n\n\u003cp\u003eWhen an administrator attempts to set an avatar from an external link, the parser just takes the source of whatever link they point it to and creates a file with the same extension and content in the uploads folder.\u003c/p\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps to reproduce:\u003c/h2\u003e\n\n\u003cp\u003e1- Visit http://[HOST]/admin.php?/cp/members/profile/settings and scroll to the \u0026quot;Change avatar\u0026quot; section.\u003cbr\u003e\n2- Choose \u0026quot;Link to avatar\u0026quot; and set it\u0026#39;s value to \u003ccode\u003ehttp://strukt.tk/test.svg\u003c/code\u003e\u003cbr\u003e\n3- After redirection, if you have a proxy, a request will be made to something like \u003ccode\u003ehttp://[HOST]/images/avatars/test_1.svg\u003c/code\u003e on your localhost. Try opening that in your browser and you should see an alert box over there.\u003cbr\u003e\n4- You can try that with \u003ccode\u003ehttps://ellislab.com/asset/file/ee_server_wizard.zip\u003c/code\u003e, it will create a .zip file over there.\u003c/p\u003e\n\n\u003cp\u003eThat being said, an attacker can use other file types and may be able to run arbitrary commands on the OS.\u003c/p\u003e\n\n\u003cp\u003eRegards\u003c/p\u003e\n","weakness":{"id":70,"name":"Code Injection"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":6,"voters":["sp1d3rs","eveeez","apapedulimu","grampae","japz","tum_2527"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1061094,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Crikey, you're right. I'm going to bring this one up with the team to decide a best course of action, whether it be adding extra validation to this process or removing the feature entirely. Will report back!","markdown_message":"\u003cp\u003eCrikey, you\u0026#39;re right. I\u0026#39;m going to bring this one up with the team to decide a best course of action, whether it be adding extra validation to this process or removing the feature entirely. Will report back!\u003c/p\u003e\n","automated_response":false,"created_at":"2016-07-09T18:58:30.813Z","updated_at":"2016-07-09T18:58:30.813Z","actor":{"username":"kevincupp","cleared":false,"url":"/kevincupp","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"expressionengine","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1063644,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Ok we've decided this feature likely isn't worth trying to lock down so we're simply going to remove it. Thanks for pointing this out!","markdown_message":"\u003cp\u003eOk we\u0026#39;ve decided this feature likely isn\u0026#39;t worth trying to lock down so we\u0026#39;re simply going to remove it. Thanks for pointing this out!\u003c/p\u003e\n","automated_response":false,"created_at":"2016-07-11T19:01:54.025Z","updated_at":"2016-07-11T19:01:54.025Z","actor":{"username":"kevincupp","cleared":false,"url":"/kevincupp","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"strukt","url":"/strukt"},"genius_execution_id":null,"team_handle":"expressionengine","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2565054,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-04-04T16:12:59.900Z","updated_at":"2018-04-04T16:12:59.900Z","first_to_agree":true,"actor":{"username":"strukt","cleared":true,"url":"/strukt","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/303/42cd71a4698d80f88ab65e3117fd9fc401a57048_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"expressionengine","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2565113,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-04-04T16:36:49.193Z","updated_at":"2018-04-04T16:36:49.193Z","actor":{"username":"kevincupp","cleared":false,"url":"/kevincupp","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"expressionengine","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2565114,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-04-04T16:36:49.267Z","updated_at":"2018-04-04T16:36:49.267Z","actor":{"username":"kevincupp","cleared":false,"url":"/kevincupp","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"expressionengine","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}