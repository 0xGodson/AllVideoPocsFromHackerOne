{"id":171497,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNzE0OTc=","url":"https://hackerone.com/reports/171497","title":"Content spoofing in lookup.nextcloud.com","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2016-09-23T16:56:06.861Z","submitted_at":"2016-09-23T16:56:06.861Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"csanuragjain","url":"/csanuragjain","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/058/139/bbabf05f3cf79c652d18dd0fbfe79e515798b03e_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13291,"url":"https://hackerone.com/nextcloud","handle":"nextcloud","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Nextcloud","twitter_handle":"nextclouders","website":"https://nextcloud.com","about":"Access, share and protect your files, calendars, contacts, communication \u0026 more at home and in your enterprise."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2016-10-10T14:56:44.467Z","bug_reporter_agreed_on_going_public_at":"2016-10-10T14:56:44.429Z","team_member_agreed_on_going_public_at":"2016-10-10T14:52:48.286Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"**Scenerio**\nAn attacker can include any arbitrary text using specially crafted nextcloud url.\nThis is done using character /%0d%0a.\n\n**Steps**\n1) Attacker distributed the below url by means of spamming or through his website\nhttps://lookup.nextcloud.com/%0d%0ahas%20moved%20to%20www.evil.com.Please%20visit%20evil.com%20Present%20resource\n2) Victim see below text \nThe requested URL / has moved to www.evil.com.Please visit evil.com Present resource was not found on this server.\n3) Since the text came from official site so user believes and gets into attacker trap\n\n**Resolution**\nCrafted text should not be responded back in the response HTML","vulnerability_information_html":"\u003cp\u003e\u003cstrong\u003eScenerio\u003c/strong\u003e\u003cbr\u003e\nAn attacker can include any arbitrary text using specially crafted nextcloud url.\u003cbr\u003e\nThis is done using character /%0d%0a.\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eSteps\u003c/strong\u003e\u003cbr\u003e\n1) Attacker distributed the below url by means of spamming or through his website\u003cbr\u003e\n\u003ca title=\"https://lookup.nextcloud.com/%0d%0ahas%20moved%20to%20www.evil.com.Please%20visit%20evil.com%20Present%20resource\" href=\"/redirect?url=https%3A%2F%2Flookup.nextcloud.com%2F%250d%250ahas%2520moved%2520to%2520www.evil.com.Please%2520visit%2520evil.com%2520Present%2520resource\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://lookup.nextcloud.com/%0d%0ahas%20moved%20to%20www.evil.com.Please%20visit%20evil.com%20Present%20resource\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\n2) Victim see below text \u003cbr\u003e\nThe requested URL / has moved to \u003ca href=\"/redirect?url=http%3A%2F%2Fwww.evil.com.please\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ewww.evil.com.Please\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e visit evil.com Present resource was not found on this server.\u003cbr\u003e\n3) Since the text came from official site so user believes and gets into attacker trap\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eResolution\u003c/strong\u003e\u003cbr\u003e\nCrafted text should not be responded back in the response HTML\u003c/p\u003e\n","weakness":{"id":57,"name":"Violation of Secure Design Principles"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":122485,"file_name":"lookup.PNG","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/122/485/33b94ce3920b18a0e746a837d0d6afcdeecd2f64/lookup.PNG?response-content-disposition=attachment%3B%20filename%3D%22lookup.PNG%22%3B%20filename%2A%3DUTF-8%27%27lookup.PNG\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSUJSTWNA%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T044100Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQDC4LZo82wc2eCvBFlhjwE027CwJoHB88%2BMK2v03JEf7AIgTsNTuR7XI5zLkpcU%2F192zliPMALv25wXWHyoW56mHW0qtAMIVRABGgwwMTM2MTkyNzQ4NDkiDDQxd6Ep%2FudaJolhjiqRA%2FV9m3Q5qTHiEf%2B0F56QxIa0FX4xcw3kyVQ754zuEWG6%2FFHm5u50c%2FkjIZTK4iokf%2F5bg8%2F9lzPcfaf%2FlyMeeuZQiIR66c8Q0ZynlQYFFg39COCCRcmQH0rk4Py7SioeZK1WX50szdnMCAEBM0%2FYGIJRFlpJYz5%2BF7cuCEDZDVFz70QPaeLM9Aq2Hp0OWlaD%2BlKU2Ya8oXmKGTVLeV6xTf66mRdzvW8I4qKgZpByKnAcip5WWnkttPjUxPiLaEeZ%2BClnUyHZas2bB1iPmPH0rQXcKWbTOq%2BJJm8xX%2FgqtqSgjGTmncJVZJxe0UaRUPXS%2BxPh0KYERT9Te4D5sREOcmaPJ0lojWm5AuNIxK3S30FeTamdldG5jOgcjm7r6e2HjWcB7yfe4%2BCsYd2eVLbbXk95jZRHQohr%2B7Z9YEqq00TUANe07BXm%2FKoAPBMy0bYQHYmVJaGS31XhmN6DRKUn5mwwU6NQ87eIymigu48swQSaSOa0S3Ve15n99tYKCLxw%2FqcLrXK9DmAPRXyB2cTH85tpMJ7Qqv8FOusB0TY7T%2F8PPlS9Pw17cj5sLPnZSdHFb4OJ7xNuArhvZUxC%2FDdQIpfgbN40hDHy3r94ejzq63ULcWroBoxExSJ8F%2BIqLrT2jEE%2BHYV9rJ3uN20mlrWN07M1wfpVQeu7mZyiWu%2BTKEOjyLznji7d3Efn7A1SwzF%2FWi11RcA9%2BGeNTFCiOeyJRV4JWopx6NNi8TVr6hBraJmZeqXIUCIj4yW%2BvdbZ%2F7b%2BDWNq1S8BMna3Htt9r6lmeANRYdDH%2BkiA2F6n7nJrrrNm3hF7NHjHy1GdUin3XffXKseDfHdRNqxNelH1SrChi2zziLtHrQ%3D%3D\u0026X-Amz-Signature=9804eb6b4ccda21ac6cc2f753e97d92d78b089bae657488efbf2b9d77cba310c","file_size":20900,"type":"image/png"}],"allow_singular_disclosure_at":"2016-11-09T14:52:48.324Z","allow_singular_disclosure_after":-130513691.81984857,"singular_disclosure_allowed":true,"vote_count":11,"voters":["michiel","flashdisk","madrobot","kiraak-boy","japz","spetr0x","martijn","prospere","dyabla","userrimal","and 1 more..."],"severity":{"rating":"low","score":3.1,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"high","privileges_required":"none","user_interaction":"required","scope":"unchanged","confidentiality":"none","integrity":"low","availability":"none"}},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1212937,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks a lot for reporting this potential issue back to us!\n\nOur security team will take a look at this issue as soon as possible. We will reply to your report within 72 hours, usually much faster. For obvious reasons we'd like to ask you to not disclose this issue to any other party.","markdown_message":"\u003cp\u003eThanks a lot for reporting this potential issue back to us!\u003c/p\u003e\n\n\u003cp\u003eOur security team will take a look at this issue as soon as possible. We will reply to your report within 72 hours, usually much faster. For obvious reasons we\u0026#39;d like to ask you to not disclose this issue to any other party.\u003c/p\u003e\n","automated_response":true,"created_at":"2016-09-23T16:56:07.106Z","updated_at":"2016-09-23T16:56:07.106Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Nextcloud"}},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1215012,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2016-09-25T17:08:34.513Z","updated_at":"2016-09-25T17:08:34.513Z","actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1240220,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2016-10-10T14:51:29.779Z","updated_at":"2016-10-10T14:51:29.779Z","additional_data":{"old_severity":null,"new_severity":"Low (3.1)","old_severity_id":null,"new_severity_id":1296},"actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1240223,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks a lot for your report again. This has been resolved now.","markdown_message":"\u003cp\u003eThanks a lot for your report again. This has been resolved now.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-10-10T14:51:53.113Z","updated_at":"2016-10-10T14:51:53.113Z","actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"csanuragjain","url":"/csanuragjain"},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1240224,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"As per our policy we don't award monetary rewards for issues in our infrastructure at the moment.","markdown_message":"\u003cp\u003eAs per our policy we don\u0026#39;t award monetary rewards for issues in our infrastructure at the moment.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-10-10T14:52:15.379Z","updated_at":"2016-10-10T14:52:15.379Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Nextcloud"}},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1240226,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-10-10T14:52:48.304Z","updated_at":"2016-10-10T14:52:48.304Z","first_to_agree":true,"actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1240234,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-10-10T14:56:44.447Z","updated_at":"2016-10-10T14:56:44.447Z","actor":{"username":"csanuragjain","cleared":true,"url":"/csanuragjain","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/058/139/bbabf05f3cf79c652d18dd0fbfe79e515798b03e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1240235,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-10-10T14:56:44.484Z","updated_at":"2016-10-10T14:56:44.484Z","actor":{"username":"csanuragjain","cleared":true,"url":"/csanuragjain","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/058/139/bbabf05f3cf79c652d18dd0fbfe79e515798b03e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}