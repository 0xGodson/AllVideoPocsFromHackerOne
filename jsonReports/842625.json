{"id":842625,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC84NDI2MjU=","url":"https://hackerone.com/reports/842625","title":"account takeover on 3.0.1 version","state":"Closed","substate":"resolved","severity_rating":"critical","readable_substate":"Resolved","created_at":"2020-04-07T15:36:39.138Z","submitted_at":"2020-04-07T15:36:39.138Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"elfiman","url":"/elfiman","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":19858,"url":"https://hackerone.com/rocket_chat","handle":"rocket_chat","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/019/858/ada6c92a338715afad123af214dd6e22fd8dc6ff_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/858/ada6c92a338715afad123af214dd6e22fd8dc6ff_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Rocket.Chat","twitter_handle":"RocketChat","website":"https://rocket.chat","about":"Rocket.Chat is a company built on open source values and a love for efficiency. The company is driven by our amazing community of contributors."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2020-06-14T15:22:44.184Z","bug_reporter_agreed_on_going_public_at":"2020-05-15T15:22:42.131Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"I find user reset password hash info and other security info on \"/api/v1/[users.info](http://users.info)\"  \nnote : I login on rocketchat with ldap account (my role : user)  \nnote: in request \"[https://target/api/v1/users.info?username=[x]](https://target/api/v1/users.info?username=%5Bx%5D)\" you should change usrname to userId\n\n1- please login with user ldap account (role user)  \n2- send a request to\u0026nbsp;[https://target/api/v1/users.list](https://target/api/v1/users.list)\u0026nbsp;and copy \\_id value  \n3- send a request to\u0026nbsp;[https://target/api/v1/users.info?userId=[userId]](https://target/api/v1/users.info?userId=%5BuserId%5D)\u0026nbsp;and copy email value (in response you can see important security information )  \n4- logout and click \"forget your password\" link on\u0026nbsp;[https://target/home](https://target/home)\u0026nbsp;and send an email to above email address that you copied  \n4- login with Your account and send a request to\u0026nbsp;[https://target/api/v1/users.list](https://target/api/v1/users.list)\u0026nbsp;and search the same email in response and copy \\_id value  \n5- send a request to\u0026nbsp;[https://target/api/v1/users.info?userId=[userId]](https://target/api/v1/users.info?userId=%5BuserId%5D)\u0026nbsp;and copy reset hash value  \n6- logout your account and send a request to\u0026nbsp;[https://target/reset-password/[reset\\_hash]](https://target/reset-password/%5Breset_hash%5D)  \n7- set new password  \n8- login and enjoy\n\n## Impact\n\naccount takeover","vulnerability_information_html":"\u003cp\u003eI find user reset password hash info and other security info on \u0026quot;/api/v1/\u003ca href=\"/redirect?url=http%3A%2F%2Fusers.info\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eusers.info\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u0026quot;\u003cbr\u003e\u003cbr\u003e\nnote : I login on rocketchat with ldap account (my role : user)\u003cbr\u003e\u003cbr\u003e\nnote: in request \u0026quot;\u003ca href=\"/redirect?url=https%3A%2F%2Ftarget%2Fapi%2Fv1%2Fusers.info%3Fusername%3D%255Bx%255D\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://target/api/v1/users.info?username=[x]\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u0026quot; you should change usrname to userId\u003c/p\u003e\n\n\u003cp\u003e1- please login with user ldap account (role user)\u003cbr\u003e\u003cbr\u003e\n2- send a request to \u003ca href=\"/redirect?url=https%3A%2F%2Ftarget%2Fapi%2Fv1%2Fusers.list\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://target/api/v1/users.list\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e and copy _id value\u003cbr\u003e\u003cbr\u003e\n3- send a request to \u003ca href=\"/redirect?url=https%3A%2F%2Ftarget%2Fapi%2Fv1%2Fusers.info%3FuserId%3D%255BuserId%255D\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://target/api/v1/users.info?userId=[userId]\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e and copy email value (in response you can see important security information )\u003cbr\u003e\u003cbr\u003e\n4- logout and click \u0026quot;forget your password\u0026quot; link on \u003ca href=\"/redirect?url=https%3A%2F%2Ftarget%2Fhome\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://target/home\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e and send an email to above email address that you copied\u003cbr\u003e\u003cbr\u003e\n4- login with Your account and send a request to \u003ca href=\"/redirect?url=https%3A%2F%2Ftarget%2Fapi%2Fv1%2Fusers.list\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://target/api/v1/users.list\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e and search the same email in response and copy _id value\u003cbr\u003e\u003cbr\u003e\n5- send a request to \u003ca href=\"/redirect?url=https%3A%2F%2Ftarget%2Fapi%2Fv1%2Fusers.info%3FuserId%3D%255BuserId%255D\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://target/api/v1/users.info?userId=[userId]\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e and copy reset hash value\u003cbr\u003e\u003cbr\u003e\n6- logout your account and send a request to \u003ca href=\"/redirect?url=https%3A%2F%2Ftarget%2Freset-password%2F%255Breset_hash%255D\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://target/reset-password/[reset_hash]\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\u003cbr\u003e\n7- set new password\u003cbr\u003e\u003cbr\u003e\n8- login and enjoy\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eaccount takeover\u003c/p\u003e\n","weakness":{"id":55,"name":"Insecure Direct Object Reference (IDOR)"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2020-06-14T15:22:42.204Z","allow_singular_disclosure_after":-17077070.237221543,"singular_disclosure_allowed":true,"vote_count":56,"voters":["abudman","kegn","mik317","brahim_boufakri01","mygf","gamliel","realtess","sodium_","exception","darkshadow1733","and 46 more..."],"severity":{"rating":"critical","score":9.9,"author_type":"User","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"low","user_interaction":"none","scope":"changed","confidentiality":"high","integrity":"high","availability":"high"}},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":7586850,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"thanks for reporting. \n\nfix is currently in work","markdown_message":"\u003cp\u003ethanks for reporting. \u003c/p\u003e\n\n\u003cp\u003efix is currently in work\u003c/p\u003e\n","automated_response":false,"created_at":"2020-04-08T18:35:02.384Z","updated_at":"2020-04-08T18:35:02.384Z","actor":{"username":"markus-rocketchat","cleared":false,"url":"/markus-rocketchat","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"rocket_chat","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7742400,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hi @elfiman \n\nWe have a fix for this coming: https://github.com/RocketChat/Rocket.Chat/pull/17238\nThis will prevent pulling sensitive info via the API even with elevated permissions.\n\n\nBest\nMarkus","markdown_message":"\u003cp\u003eHi \u003ca href=\"/elfiman\"\u003e@elfiman\u003c/a\u003e \u003c/p\u003e\n\n\u003cp\u003eWe have a fix for this coming: \u003ca title=\"https://github.com/RocketChat/Rocket.Chat/pull/17238\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2FRocketChat%2FRocket.Chat%2Fpull%2F17238\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/RocketChat/Rocket.Chat/pull/17238\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nThis will prevent pulling sensitive info via the API even with elevated permissions.\u003c/p\u003e\n\n\u003cp\u003eBest\u003cbr\u003e\nMarkus\u003c/p\u003e\n","automated_response":false,"created_at":"2020-04-21T16:06:36.796Z","updated_at":"2020-04-21T16:07:34.449Z","actor":{"username":"markus-rocketchat","cleared":false,"url":"/markus-rocketchat","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"elfiman","url":"/elfiman"},"genius_execution_id":null,"team_handle":"rocket_chat","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7743899,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"hi @markus-rocketchat \nYou made me happy\nWould you let me publish this bug in Hacker One?\n\nbest\nSamira\n","markdown_message":"\u003cp\u003ehi \u003ca href=\"/markus-rocketchat\"\u003e@markus-rocketchat\u003c/a\u003e \u003cbr\u003e\nYou made me happy\u003cbr\u003e\nWould you let me publish this bug in Hacker One?\u003c/p\u003e\n\n\u003cp\u003ebest\u003cbr\u003e\nSamira\u003c/p\u003e\n","automated_response":false,"created_at":"2020-04-21T18:49:26.540Z","updated_at":"2020-04-21T18:49:26.540Z","actor":{"username":"elfiman","cleared":false,"url":"/elfiman","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"rocket_chat","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7756060,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"hi @markus-rocketchat\nYou made me happy\nWould you let me publish this bug in Hacker One?\n\nbest\nSamira","markdown_message":"\u003cp\u003ehi \u003ca href=\"/markus-rocketchat\"\u003e@markus-rocketchat\u003c/a\u003e\u003cbr\u003e\nYou made me happy\u003cbr\u003e\nWould you let me publish this bug in Hacker One?\u003c/p\u003e\n\n\u003cp\u003ebest\u003cbr\u003e\nSamira\u003c/p\u003e\n","automated_response":false,"created_at":"2020-04-22T15:10:09.248Z","updated_at":"2020-04-22T15:10:09.248Z","first_to_agree":true,"actor":{"username":"elfiman","cleared":false,"url":"/elfiman","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"rocket_chat","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7978366,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @elfiman \n\nwould you be okay to delay the disclosure for a bit of time? Our admins are often not so quick to update and it would be great to give them a bit more time to patch.\n\nYou could just click \"cancel disclosure\" and then click request to disclose again, so we get the counter started again. OK with you?\n\nThank you for understanding.\n\nBest\nMarkus","markdown_message":"\u003cp\u003eHi \u003ca href=\"/elfiman\"\u003e@elfiman\u003c/a\u003e \u003c/p\u003e\n\n\u003cp\u003ewould you be okay to delay the disclosure for a bit of time? Our admins are often not so quick to update and it would be great to give them a bit more time to patch.\u003c/p\u003e\n\n\u003cp\u003eYou could just click \u0026quot;cancel disclosure\u0026quot; and then click request to disclose again, so we get the counter started again. OK with you?\u003c/p\u003e\n\n\u003cp\u003eThank you for understanding.\u003c/p\u003e\n\n\u003cp\u003eBest\u003cbr\u003e\nMarkus\u003c/p\u003e\n","automated_response":false,"created_at":"2020-05-12T16:30:46.640Z","updated_at":"2020-05-12T16:30:46.640Z","actor":{"username":"markus-rocketchat","cleared":false,"url":"/markus-rocketchat","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"rocket_chat","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8012214,"is_internal":false,"editable":false,"type":"Activities::CancelledDisclosureRequest","message":"hi @markus-rocketchat \n\nyes, sure :)\n\n","markdown_message":"\u003cp\u003ehi \u003ca href=\"/markus-rocketchat\"\u003e@markus-rocketchat\u003c/a\u003e \u003c/p\u003e\n\n\u003cp\u003eyes, sure :)\u003c/p\u003e\n","automated_response":false,"created_at":"2020-05-15T15:21:47.048Z","updated_at":"2020-05-15T15:21:47.048Z","actor":{"username":"elfiman","cleared":false,"url":"/elfiman","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"rocket_chat","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8012218,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"hi @markus-rocketchat\n\nWould you let me publish this bug?\n\nbest\nSamira","markdown_message":"\u003cp\u003ehi \u003ca href=\"/markus-rocketchat\"\u003e@markus-rocketchat\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eWould you let me publish this bug?\u003c/p\u003e\n\n\u003cp\u003ebest\u003cbr\u003e\nSamira\u003c/p\u003e\n","automated_response":false,"created_at":"2020-05-15T15:22:42.149Z","updated_at":"2020-05-15T15:22:42.149Z","first_to_agree":true,"actor":{"username":"elfiman","cleared":false,"url":"/elfiman","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"rocket_chat","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8083540,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @markus-rocketchat\n\nHow can I register a cve for this bug? \nCan you help me?\nIs Hacker One itself a way out?\n\nBest\nSamira\n","markdown_message":"\u003cp\u003eHi \u003ca href=\"/markus-rocketchat\"\u003e@markus-rocketchat\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eHow can I register a cve for this bug? \u003cbr\u003e\nCan you help me?\u003cbr\u003e\nIs Hacker One itself a way out?\u003c/p\u003e\n\n\u003cp\u003eBest\u003cbr\u003e\nSamira\u003c/p\u003e\n","automated_response":false,"created_at":"2020-05-22T21:39:03.021Z","updated_at":"2020-05-22T21:39:03.021Z","actor":{"username":"elfiman","cleared":false,"url":"/elfiman","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"rocket_chat","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8287567,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-06-14T15:22:44.218Z","updated_at":"2020-06-14T15:22:44.218Z","actor":{"url":"/rocket_chat","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/858/ada6c92a338715afad123af214dd6e22fd8dc6ff_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Rocket.Chat"}},"genius_execution_id":null,"team_handle":"rocket_chat","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}