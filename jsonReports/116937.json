{"id":116937,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMTY5Mzc=","url":"https://hackerone.com/reports/116937","title":"Chat History CSV Export Excel Injection Vulnerability","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-02-17T13:08:36.497Z","submitted_at":"2016-02-17T13:08:36.497Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"pr0tagon1st","url":"/pr0tagon1st","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/033/123/9e3397fc4128a6ea0579adedf2a30f47f54ad11a_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":205,"url":"https://hackerone.com/zendesk","handle":"zendesk","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/205/1f7838d9b4201d122e0a7fbacc8ff3e90f57fa0c_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/205/1f7838d9b4201d122e0a7fbacc8ff3e90f57fa0c_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Zendesk","twitter_handle":"","website":"https://www.zendesk.com","about":"Zendesk is a leading cloud-based customer service software solution. Over 100,000 customer accounts use Zendesk to increase customer satisfaction."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2016-04-04T21:48:49.497Z","bug_reporter_agreed_on_going_public_at":"2016-03-30T16:07:09.910Z","team_member_agreed_on_going_public_at":"2016-04-04T21:48:48.341Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"I have found a vulnerability in the Chat History export function. If an attacker submits a special name (containing a system command) when chatting with an agent and that agent later exports the history of that chat to CSV, the resulting CSV may execute commands when opened. I have tested this using MS Excel 2013 on Windows 7.\n\nProof of Concept:\n1. Open the dashboard as an agent and go to \"Visitor List\".\n2. Select \"Simulate Visitor\". (This vulnerability works in a real scenario as well, simulating a visitor is just the easiest way to reproduce it).\n3. As the simulated visitor, edit your name to \"-2+3+cmd|' /C calc'!G2\" (without the double quotes).\n4. End the chat.\n5. Navigate to the \"History\" section, select the recent chat, click the \"actions\" button, select \"export chat details\", and input a viable email address.\n6. Open the email and unpack the zip file. \n7. Open the CSV in Excel.\n8. A warning will show up warning the user to disable execution _unless_ he trusts the source of the file. The user may likely leave execution enable due to trusting the source (zopim). Click \"enable\".\n9. A second warning will appear that states a similar message as the previous one (\"only open if you trust the source...\"). Click \"yes\"\n10. The malicious code is executed - in this case it will just open the \"calc\" application. (Screenshot attached).\n\nThreat Level Estimation\nOn one hand, this vulnerability can be pretty serious as it allows an attacker to execute arbitrary code as the current user. This can easily be used to download and install malware, establishing a firm foothold or to execute a pretty complex phishing attack (opening a browser, changing user settings, etc.) However, the severity of this attack is mitigated by the two warnings that I mentioned in the Proof of Concept. The warnings may be enough to dissuade the user from allowing Excel to execute the malicious code, although the both messages stress trusting the source and users have no reason to distrust zopim.com.\n\nRecommendation\nThe \"=\" is already escaped properly, this escaping should be extended to the \"-\" and \"+\" characters as well.\n\nLet me know if I can help further.\n\nThanks!\n","vulnerability_information_html":"\u003cp\u003eI have found a vulnerability in the Chat History export function. If an attacker submits a special name (containing a system command) when chatting with an agent and that agent later exports the history of that chat to CSV, the resulting CSV may execute commands when opened. I have tested this using MS Excel 2013 on Windows 7.\u003c/p\u003e\n\n\u003cp\u003eProof of Concept:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eOpen the dashboard as an agent and go to \u0026quot;Visitor List\u0026quot;.\u003c/li\u003e\n\u003cli\u003eSelect \u0026quot;Simulate Visitor\u0026quot;. (This vulnerability works in a real scenario as well, simulating a visitor is just the easiest way to reproduce it).\u003c/li\u003e\n\u003cli\u003eAs the simulated visitor, edit your name to \u0026quot;-2+3+cmd|\u0026#39; /C calc\u0026#39;!G2\u0026quot; (without the double quotes).\u003c/li\u003e\n\u003cli\u003eEnd the chat.\u003c/li\u003e\n\u003cli\u003eNavigate to the \u0026quot;History\u0026quot; section, select the recent chat, click the \u0026quot;actions\u0026quot; button, select \u0026quot;export chat details\u0026quot;, and input a viable email address.\u003c/li\u003e\n\u003cli\u003eOpen the email and unpack the zip file. \u003c/li\u003e\n\u003cli\u003eOpen the CSV in Excel.\u003c/li\u003e\n\u003cli\u003eA warning will show up warning the user to disable execution \u003cu\u003eunless\u003c/u\u003e he trusts the source of the file. The user may likely leave execution enable due to trusting the source (zopim). Click \u0026quot;enable\u0026quot;.\u003c/li\u003e\n\u003cli\u003eA second warning will appear that states a similar message as the previous one (\u0026quot;only open if you trust the source...\u0026quot;). Click \u0026quot;yes\u0026quot;\u003c/li\u003e\n\u003cli\u003eThe malicious code is executed - in this case it will just open the \u0026quot;calc\u0026quot; application. (Screenshot attached).\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eThreat Level Estimation\u003cbr\u003e\nOn one hand, this vulnerability can be pretty serious as it allows an attacker to execute arbitrary code as the current user. This can easily be used to download and install malware, establishing a firm foothold or to execute a pretty complex phishing attack (opening a browser, changing user settings, etc.) However, the severity of this attack is mitigated by the two warnings that I mentioned in the Proof of Concept. The warnings may be enough to dissuade the user from allowing Excel to execute the malicious code, although the both messages stress trusting the source and users have no reason to distrust zopim.com.\u003c/p\u003e\n\n\u003cp\u003eRecommendation\u003cbr\u003e\nThe \u0026quot;=\u0026quot; is already escaped properly, this escaping should be extended to the \u0026quot;-\u0026quot; and \u0026quot;+\u0026quot; characters as well.\u003c/p\u003e\n\n\u003cp\u003eLet me know if I can help further.\u003c/p\u003e\n\n\u003cp\u003eThanks!\u003c/p\u003e\n","bounty_amount":"100.0","formatted_bounty":"$100","weakness":{"id":58,"name":"Command Injection - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":73846,"file_name":"zopim_poc.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/073/846/9a1f7b574511e1e221794caf482dd2bac2198ca6/zopim_poc.png?response-content-disposition=attachment%3B%20filename%3D%22zopim_poc.png%22%3B%20filename%2A%3DUTF-8%27%27zopim_poc.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQYENXQUKC%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T041850Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHXwr%2Bz%2B7j54GXjIZDeFjE7V4KhtcLVpveDKyRp%2FgHMpAiEA%2FzBLaI4tlPUnNvgzY0X8n68OkDDLSfCBmjTZSd2A%2BM8qtAMIVRABGgwwMTM2MTkyNzQ4NDkiDOLyu53NKIhzdiDnLyqRA1YiznmwUquOZL6cfEwHlrCEbfV1uip5mxrCKpzmpc9DKyYejzEqNMg8%2Fo1XQZiQbQ9Mn8QGMjtqUBvpzsRmfLsdw4KO6Yix26%2Foq9H6jcEfUIX3EyFaY0ofGk42HT5lnakJ%2FUAtv5lyqirA3laDcoq6u60WpxBZh0jLi92Ajs9kGkzDbgWJPXMK2%2FlVglZWa%2BjQNhDftrEqJh4ZV%2FIwfbcJ6s89eju9B4Xkun1IUiVjrUtA5LTMlkDAEwqtGdl3pucepUSB2hZBvbqUfgiT65T%2BpLDNg0LFqEXPPPqqyrYG3%2BqTXIZxR1FfbdXOQjx1UoPwboCHOwSOpOKGaPs6TEM2o6Sg2U%2BGvuy3dMdtNBCfH4SIfBdeUa84eWUftCR4OwBiC0F1Cl6iPIZXa92zkJSAVTz9swPvr%2BghYLYGIjX%2F8jqVGlADsLB1sl%2BqlNRFkwYrvTDOWwnYmDuvQmmhpAQ6Mg%2Fp05v07WKHRsbG%2BAUzVJ3M02i0HIdWCGKjqKXgGZi%2FLBrHUEV9bzaVWmpeFEE3MObUqv8FOusBMEus3670kEKa62xVKQkID%2Fav5Xylzf384wPv9i4fBKmwghqKR67wSDPkErUtnTlN6wJNos0uBd5jibop6zjPh%2BDMaeI%2Bt4z0CbNpMS83WKn2xS%2FvSK0QFyg217PkDWCKklNPmbumtDteHdU2qRRX%2BQwVoTBmoRFgs97OyKXEz2rc7ZIcHuDnAibsNVPNZEuX9m%2B04KKBBkwdIr0sY3zEiVHvTVxPYBSsKfBPuZwzi6W3T3aq%2BF9l860FnFBaV964%2BlbASqZkuTd4cEZ8C2GJad6RyY164GfHgpKnmQ6aYbLhiDTz0xF3adlmhg%3D%3D\u0026X-Amz-Signature=70385afe043a1f4fb0312adff53ecdc5274b61861059ae89891b8df0ddb689d9","file_size":38753,"type":"image/png"}],"allow_singular_disclosure_at":"2016-04-29T16:07:10.208Z","allow_singular_disclosure_after":-147269500.37026793,"singular_disclosure_allowed":true,"vote_count":1,"voters":["dyabla"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":803120,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello @pr0tagon1st,\n\nThank you for reporting this issue. The Zendesk Security Team will begin investigating the details of your report immediately. If the issue is verified as a security vulnerability, we will contact you with a timeline for remediation and the amount awarded for the submitted issue.\n\nRegards,\n[Zendesk Security](https://www.zendesk.com/product/features/zendesk-security/)","markdown_message":"\u003cp\u003eHello \u003ca href=\"/pr0tagon1st\"\u003e@pr0tagon1st\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThank you for reporting this issue. The Zendesk Security Team will begin investigating the details of your report immediately. If the issue is verified as a security vulnerability, we will contact you with a timeline for remediation and the amount awarded for the submitted issue.\u003c/p\u003e\n\n\u003cp\u003eRegards,\u003cbr\u003e\n\u003ca href=\"/redirect?url=https%3A%2F%2Fwww.zendesk.com%2Fproduct%2Ffeatures%2Fzendesk-security%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eZendesk Security\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2016-02-18T18:12:11.148Z","updated_at":"2016-02-18T18:12:11.148Z","actor":{"username":"noops43","cleared":false,"url":"/noops43","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"zendesk","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":805153,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Hello @pr0tagon1st,\n\nCongratulations! Your submitted vulnerability has been validated and is in process for remediation. \n\nAlso, you will be awarded $50 and publicly thanked for the responsible disclosure on our Hall of Fame. \n\nRegards,\n[Zendesk Security](https://www.zendesk.com/product/features/zendesk-security/)","markdown_message":"\u003cp\u003eHello \u003ca href=\"/pr0tagon1st\"\u003e@pr0tagon1st\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eCongratulations! Your submitted vulnerability has been validated and is in process for remediation. \u003c/p\u003e\n\n\u003cp\u003eAlso, you will be awarded $50 and publicly thanked for the responsible disclosure on our Hall of Fame. \u003c/p\u003e\n\n\u003cp\u003eRegards,\u003cbr\u003e\n\u003ca href=\"/redirect?url=https%3A%2F%2Fwww.zendesk.com%2Fproduct%2Ffeatures%2Fzendesk-security%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eZendesk Security\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2016-02-19T21:28:54.083Z","updated_at":"2016-02-19T21:28:54.083Z","actor":{"url":"/zendesk","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/205/1f7838d9b4201d122e0a7fbacc8ff3e90f57fa0c_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Zendesk"}},"bounty_amount":"50.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"zendesk","collaborator":{"username":"pr0tagon1st","url":"/pr0tagon1st"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":805154,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2016-02-19T21:29:03.140Z","updated_at":"2016-02-19T21:29:03.140Z","actor":{"username":"noops43","cleared":false,"url":"/noops43","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"zendesk","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":805160,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Hi @pr0tagon1st,\n\nI made an error in the bounty. The award is $100. I'm rewarding you an additional $50 to correct my error. \n\nI apologies for the inconvenience.\n\nRegards,\n[Zendesk Security](https://www.zendesk.com/product/features/zendesk-security/)","markdown_message":"\u003cp\u003eHi \u003ca href=\"/pr0tagon1st\"\u003e@pr0tagon1st\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eI made an error in the bounty. The award is $100. I\u0026#39;m rewarding you an additional $50 to correct my error. \u003c/p\u003e\n\n\u003cp\u003eI apologies for the inconvenience.\u003c/p\u003e\n\n\u003cp\u003eRegards,\u003cbr\u003e\n\u003ca href=\"/redirect?url=https%3A%2F%2Fwww.zendesk.com%2Fproduct%2Ffeatures%2Fzendesk-security%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eZendesk Security\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2016-02-19T21:35:27.119Z","updated_at":"2016-02-19T21:35:27.119Z","actor":{"url":"/zendesk","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/205/1f7838d9b4201d122e0a7fbacc8ff3e90f57fa0c_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Zendesk"}},"bounty_amount":"50.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"zendesk","collaborator":{"username":"pr0tagon1st","url":"/pr0tagon1st"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":877102,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hello @pr0tagon1st,\n\nYour submitted issue has been remediated. Thank you for participating in the [Zopim Bug Bounty program](https://hackerone.com/zopim). Please feel free to reach out if you have any questions or concerns.\n\nRegards,\n[Zendesk Security](https://www.zendesk.com/product/features/zendesk-security/)","markdown_message":"\u003cp\u003eHello \u003ca href=\"/pr0tagon1st\"\u003e@pr0tagon1st\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eYour submitted issue has been remediated. Thank you for participating in the \u003ca href=\"https://hackerone.com/zopim\"\u003eZopim Bug Bounty program\u003c/a\u003e. Please feel free to reach out if you have any questions or concerns.\u003c/p\u003e\n\n\u003cp\u003eRegards,\u003cbr\u003e\n\u003ca href=\"/redirect?url=https%3A%2F%2Fwww.zendesk.com%2Fproduct%2Ffeatures%2Fzendesk-security%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eZendesk Security\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2016-03-29T22:06:29.393Z","updated_at":"2016-03-29T22:06:29.393Z","actor":{"username":"noops43","cleared":false,"url":"/noops43","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"pr0tagon1st","url":"/pr0tagon1st"},"genius_execution_id":null,"team_handle":"zendesk","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":878230,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Awesome! Are you ok with public disclosure?","markdown_message":"\u003cp\u003eAwesome! Are you ok with public disclosure?\u003c/p\u003e\n","automated_response":false,"created_at":"2016-03-30T16:07:09.941Z","updated_at":"2016-03-30T16:07:09.941Z","first_to_agree":true,"actor":{"username":"pr0tagon1st","cleared":false,"url":"/pr0tagon1st","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/033/123/9e3397fc4128a6ea0579adedf2a30f47f54ad11a_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"zendesk","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":888586,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-04-04T21:48:49.277Z","updated_at":"2016-04-04T21:48:49.277Z","actor":{"username":"noops43","cleared":false,"url":"/noops43","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"zendesk","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":888587,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-04-04T21:48:49.519Z","updated_at":"2016-04-04T21:48:49.519Z","actor":{"username":"noops43","cleared":false,"url":"/noops43","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"zendesk","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}