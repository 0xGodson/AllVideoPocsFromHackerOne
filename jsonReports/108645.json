{"id":108645,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMDg2NDU=","url":"https://hackerone.com/reports/108645","title":"Harden resend throttling","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2016-01-06T01:39:03.525Z","submitted_at":"2016-01-06T01:39:03.525Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"whit537","url":"/whit537","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/034/094/b38b9225fd8592d05d5e6939116e8f30d7c98af5_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1868,"url":"https://hackerone.com/gratipay","handle":"gratipay","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/868/a75c6649c5b4671b3cf44160af884a7da9fd0b67_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/868/a75c6649c5b4671b3cf44160af884a7da9fd0b67_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"disabled","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Gratipay","twitter_handle":"Gratipay","website":"https://gratipay.com/","about":"Gratitude? Gratipay! The easiest way for your company to pay for open source."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-04-16T17:42:44.511Z","bug_reporter_agreed_on_going_public_at":"2017-03-17T17:42:44.044Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Over in #87531, we're about to roll out a protection against using our \"resend email verification\" feature to mail-bomb a third party. However, chad+foo@zetaweb.com and chad+bar@zetaweb.com are not unlikely to fold down to the same address. In order to close that loophole, I suppose we'd need to either implement email address parsing—but what folding rules are we going to observer?—or throttle based on the authenticated user and not the `to` field, as @rohitpaulk suggested over on #87531 for other reasons.","vulnerability_information_html":"\u003cp\u003eOver in \u003ca href=\"/reports/87531\"\u003e#87531\u003c/a\u003e, we\u0026#39;re about to roll out a protection against using our \u0026quot;resend email verification\u0026quot; feature to mail-bomb a third party. However, \u003ca title=\"chad+foo@zetaweb.com\" href=\"mailto:chad+foo@zetaweb.com\" rel=\"nofollow noopener noreferrer\"\u003echad+foo@zetaweb.com\u003c/a\u003e and \u003ca title=\"chad+bar@zetaweb.com\" href=\"mailto:chad+bar@zetaweb.com\" rel=\"nofollow noopener noreferrer\"\u003echad+bar@zetaweb.com\u003c/a\u003e are not unlikely to fold down to the same address. In order to close that loophole, I suppose we\u0026#39;d need to either implement email address parsing—but what folding rules are we going to observer?—or throttle based on the authenticated user and not the \u003ccode\u003eto\u003c/code\u003e field, as \u003ca href=\"/rohitpaulk\"\u003e@rohitpaulk\u003c/a\u003e suggested over on \u003ca href=\"/reports/87531\"\u003e#87531\u003c/a\u003e for other reasons.\u003c/p\u003e\n","weakness":{"id":57,"name":"Violation of Secure Design Principles"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2017-04-16T17:42:44.098Z","allow_singular_disclosure_after":-116850752.16777,"singular_disclosure_allowed":true,"vote_count":5,"voters":["eveeez","japz","sumit7","koviri_jagdish","spetr0x"],"severity":{"rating":"medium","author_type":"Team"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":743533,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"s/observer/observe","markdown_message":"\u003cp\u003es/observer/observe\u003c/p\u003e\n","automated_response":false,"created_at":"2016-01-06T01:42:22.339Z","updated_at":"2016-01-06T01:42:22.339Z","actor":{"username":"whit537","cleared":false,"url":"/whit537","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/034/094/b38b9225fd8592d05d5e6939116e8f30d7c98af5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":743570,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2016-01-06T02:26:30.057Z","updated_at":"2016-01-06T02:26:30.057Z","actor":{"username":"whit537","cleared":false,"url":"/whit537","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/034/094/b38b9225fd8592d05d5e6939116e8f30d7c98af5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":746155,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2016-01-07T15:27:02.928Z","updated_at":"2016-01-07T15:27:02.928Z","additional_data":{"old_title":"resend throttling is naive about email address folding","new_title":"resend throttling is easily worked around"},"actor":{"username":"whit537","cleared":false,"url":"/whit537","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/034/094/b38b9225fd8592d05d5e6939116e8f30d7c98af5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":746156,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Changaco [points out](https://github.com/liberapay/liberapay.com/issues/61) that you can also delete and re-add an email address to work around the naive throttling on #87531.","markdown_message":"\u003cp\u003eChangaco \u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fliberapay%2Fliberapay.com%2Fissues%2F61\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003epoints out\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e that you can also delete and re-add an email address to work around the naive throttling on \u003ca href=\"/reports/87531\"\u003e#87531\u003c/a\u003e.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-01-07T15:27:49.432Z","updated_at":"2016-01-07T15:27:49.432Z","actor":{"username":"whit537","cleared":false,"url":"/whit537","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/034/094/b38b9225fd8592d05d5e6939116e8f30d7c98af5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":762260,"is_internal":false,"editable":false,"type":"Activities::ExternalUserJoined","message":"","markdown_message":"","automated_response":false,"created_at":"2016-01-18T15:21:31.155Z","updated_at":"2016-01-18T15:21:31.155Z","additional_data":{"duplicate_report_id":111322},"actor":{"username":"aaron_costello","cleared":true,"url":"/aaron_costello","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/89cpgLpC5JjJB9H6NtWYW3wJ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":880710,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Duplicate received over email ([ref](https://gratipay.freshdesk.com/helpdesk/tickets/4539)).","markdown_message":"\u003cp\u003eDuplicate received over email (\u003ca href=\"/redirect?url=https%3A%2F%2Fgratipay.freshdesk.com%2Fhelpdesk%2Ftickets%2F4539\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eref\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e).\u003c/p\u003e\n","automated_response":false,"created_at":"2016-03-31T20:33:55.298Z","updated_at":"2016-03-31T20:33:55.298Z","actor":{"username":"whit537","cleared":false,"url":"/whit537","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/034/094/b38b9225fd8592d05d5e6939116e8f30d7c98af5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":883385,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2016-04-01T17:44:50.376Z","updated_at":"2016-04-01T17:44:50.376Z","additional_data":{"old_title":"resend throttling is easily worked around","new_title":"harden resend throttling"},"actor":{"username":"whit537","cleared":false,"url":"/whit537","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/034/094/b38b9225fd8592d05d5e6939116e8f30d7c98af5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":893183,"is_internal":false,"editable":false,"type":"Activities::ExternalUserJoined","message":"","markdown_message":"","automated_response":false,"created_at":"2016-04-07T03:56:30.169Z","updated_at":"2016-04-07T03:56:30.169Z","additional_data":{"duplicate_report_id":128856},"actor":{"username":"hharry","cleared":false,"url":"/hharry","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":893713,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I would keep the existing throttling based on emails as a first defense, and have a second throttle based on the authenticated user (user id ?) with a very small value such as 5 emails per X time or something, so a user could still add a few emails to his account (which is valid) before hitting the cap.\n\nFinally an IP based throttle could be also useful in general, if a web server throttling is not an option look at Django-Rest-Framework throttling classes, they implement a very easy and useful throttler based on the cache framework, not the best option but even with an in memory cache (that has the drawback of not being able to share data through processes) would mean a significant improvement. I think you can easily copy paste their throttling code and adapt it to your request/response cycle easily.","markdown_message":"\u003cp\u003eI would keep the existing throttling based on emails as a first defense, and have a second throttle based on the authenticated user (user id ?) with a very small value such as 5 emails per X time or something, so a user could still add a few emails to his account (which is valid) before hitting the cap.\u003c/p\u003e\n\n\u003cp\u003eFinally an IP based throttle could be also useful in general, if a web server throttling is not an option look at Django-Rest-Framework throttling classes, they implement a very easy and useful throttler based on the cache framework, not the best option but even with an in memory cache (that has the drawback of not being able to share data through processes) would mean a significant improvement. I think you can easily copy paste their throttling code and adapt it to your request/response cycle easily.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-07T11:25:51.712Z","updated_at":"2016-04-07T11:25:51.712Z","actor":{"username":"hharry","cleared":false,"url":"/hharry","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1014997,"is_internal":false,"editable":false,"type":"Activities::ExternalUserJoined","message":"","markdown_message":"","automated_response":false,"created_at":"2016-06-15T13:45:22.933Z","updated_at":"2016-06-15T13:45:22.933Z","additional_data":{"duplicate_report_id":144722},"actor":{"username":"generak002","cleared":false,"url":"/generak002","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1166533,"is_internal":false,"editable":false,"type":"Activities::ExternalUserJoined","message":"","markdown_message":"","automated_response":false,"created_at":"2016-08-31T23:38:35.330Z","updated_at":"2016-08-31T23:38:35.330Z","additional_data":{"duplicate_report_id":163269},"actor":{"username":"rohitdua","cleared":false,"url":"/rohitdua","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1340135,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2016-12-04T19:22:32.947Z","updated_at":"2016-12-04T19:22:32.947Z","additional_data":{"old_severity":null,"new_severity":"Medium","old_severity_id":null,"new_severity_id":11554},"actor":{"username":"dmk246","cleared":false,"url":"/dmk246","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1352028,"is_internal":false,"editable":false,"type":"Activities::ExternalUserJoined","message":"","markdown_message":"","automated_response":false,"created_at":"2016-12-08T21:45:16.024Z","updated_at":"2016-12-08T21:45:16.024Z","additional_data":{"duplicate_report_id":174109},"actor":{"username":"vishnuraj","cleared":false,"url":"/vishnuraj","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ei1xv2Xwf2biXz8KAD52GWEb/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1362698,"is_internal":false,"editable":false,"type":"Activities::ExternalUserJoined","message":"","markdown_message":"","automated_response":false,"created_at":"2016-12-13T21:30:01.233Z","updated_at":"2016-12-13T21:30:01.233Z","additional_data":{"duplicate_report_id":190829},"actor":{"username":"amalneraj","cleared":false,"url":"/amalneraj","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/102/729/887f8b5b486ecec4d4e0a1c7be28c978bdd0a4cb_original.gif/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1500447,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"[PR started](https://github.com/gratipay/gratipay.com/pull/4349).","markdown_message":"\u003cp\u003e\u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fgratipay%2Fgratipay.com%2Fpull%2F4349\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ePR started\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-02-22T22:48:41.349Z","updated_at":"2017-02-22T22:48:41.349Z","actor":{"username":"whit537","cleared":false,"url":"/whit537","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/034/094/b38b9225fd8592d05d5e6939116e8f30d7c98af5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1548224,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"💃","markdown_message":"\u003cp\u003e💃\u003c/p\u003e\n","automated_response":false,"created_at":"2017-03-17T17:42:35.182Z","updated_at":"2017-03-17T17:42:35.182Z","actor":{"username":"whit537","cleared":false,"url":"/whit537","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/034/094/b38b9225fd8592d05d5e6939116e8f30d7c98af5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"whit537","url":"/whit537"},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1548225,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-03-17T17:42:44.075Z","updated_at":"2017-03-17T17:42:44.075Z","first_to_agree":true,"actor":{"username":"whit537","cleared":false,"url":"/whit537","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/034/094/b38b9225fd8592d05d5e6939116e8f30d7c98af5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1548229,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2017-03-17T17:44:44.394Z","updated_at":"2017-03-17T17:44:44.394Z","additional_data":{"old_title":"harden resend throttling","new_title":"Harden resend throttling"},"actor":{"username":"whit537","cleared":false,"url":"/whit537","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/034/094/b38b9225fd8592d05d5e6939116e8f30d7c98af5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1614083,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-04-16T17:42:44.527Z","updated_at":"2017-04-16T17:42:44.527Z","actor":{"url":"/gratipay","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/868/a75c6649c5b4671b3cf44160af884a7da9fd0b67_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Gratipay"}},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2036454,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"","markdown_message":"","automated_response":false,"created_at":"2017-10-01T12:43:30.911Z","updated_at":"2017-10-01T12:43:30.911Z","actor":{"url":"/gratipay","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/868/a75c6649c5b4671b3cf44160af884a7da9fd0b67_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Gratipay"}},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}