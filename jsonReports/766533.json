{"id":766533,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC83NjY1MzM=","url":"https://hackerone.com/reports/766533","title":"CSRF - Modify Project Settings","state":"Closed","substate":"resolved","severity_rating":"critical","readable_substate":"Resolved","created_at":"2019-12-31T17:09:04.883Z","submitted_at":"2019-12-31T17:09:04.883Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"ahmd_halabi","url":"/ahmd_halabi","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/ETQtQBq1LaFUHsfp7tDyHV2W/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":42368,"url":"https://hackerone.com/stripo","handle":"stripo","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/042/368/5b1017d17427be6c8e05cbc95da27646bf45e925_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/042/368/5b1017d17427be6c8e05cbc95da27646bf45e925_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Stripo Inc","twitter_handle":"","website":"https://stripo.email","about":"Stripo is a lightweight and intuitive email template editor that lets users build professional looking and highly responsive email templates."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2020-02-03T13:32:36.816Z","bug_reporter_agreed_on_going_public_at":"2020-01-31T11:48:27.722Z","team_member_agreed_on_going_public_at":"2020-02-03T13:32:36.711Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"**Target Url/Endpoint**\nhttps://my.stripo.email/cabinet/stripeapi/v1/projects/{Project_Id}\n\n**Note**\nAttacker just need to know victim project Id.\n\n## Summary:\nThis CSRF Vulnerability leads to change user's project settings including General Information, Contacts, Social Networks and Other Options.\n\n## Steps To Reproduce:\nThis POC is a simple example on exploiting this bug. Attacker can exploit it with more advanced techniques and can really lead to critical issues.\n1. Navigate to Project Settings -\u003e Modify any data and intercept the request, send it to repeater, and do the following.\n2. Take the HTML code format from burp suite -\u003e Engagement Tools -\u003e Generate CSRF POC.\n3. Put the piece of code in an html file, then open it.\n4. Now hit on the button and intercept its request.\n5. Change POST to PATCH.\n6. Copy the patch data from the old intercepted request from repeater and paste it to the current intercepted request and modify the data (email for example).\n7. Modify the request header of Content-Type: `Content-Type: application/json;charset=UTF-8`\n8. Forward the request and CSRF exploited successfully and the modified data changed successfully  :)\n\n## Supporting Material/References:\nPlease See this video where I recorded the above PoC in details\n██████\n\n## Impact\n\nThis attack can be exploited in advanced way to modify all project settings and manipulate its data. Smart attacker can gain a big advantage from this bug. Hope you fix it asap.\n\n**Regards**","vulnerability_information_html":"\u003cp\u003e\u003cstrong\u003eTarget Url/Endpoint\u003c/strong\u003e\u003cbr\u003e\n\u003ca title=\"https://my.stripo.email/cabinet/stripeapi/v1/projects/%7BProject_Id%7D\" href=\"/redirect?url=https%3A%2F%2Fmy.stripo.email%2Fcabinet%2Fstripeapi%2Fv1%2Fprojects%2F%257BProject_Id%257D\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://my.stripo.email/cabinet/stripeapi/v1/projects/%7BProject_Id%7D\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eNote\u003c/strong\u003e\u003cbr\u003e\nAttacker just need to know victim project Id.\u003c/p\u003e\n\n\u003ch2 id=\"summary\"\u003eSummary:\u003c/h2\u003e\n\n\u003cp\u003eThis CSRF Vulnerability leads to change user\u0026#39;s project settings including General Information, Contacts, Social Networks and Other Options.\u003c/p\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps To Reproduce:\u003c/h2\u003e\n\n\u003cp\u003eThis POC is a simple example on exploiting this bug. Attacker can exploit it with more advanced techniques and can really lead to critical issues.\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eNavigate to Project Settings -\u0026gt; Modify any data and intercept the request, send it to repeater, and do the following.\u003c/li\u003e\n\u003cli\u003eTake the HTML code format from burp suite -\u0026gt; Engagement Tools -\u0026gt; Generate CSRF POC.\u003c/li\u003e\n\u003cli\u003ePut the piece of code in an html file, then open it.\u003c/li\u003e\n\u003cli\u003eNow hit on the button and intercept its request.\u003c/li\u003e\n\u003cli\u003eChange POST to PATCH.\u003c/li\u003e\n\u003cli\u003eCopy the patch data from the old intercepted request from repeater and paste it to the current intercepted request and modify the data (email for example).\u003c/li\u003e\n\u003cli\u003eModify the request header of Content-Type: \u003ccode\u003eContent-Type: application/json;charset=UTF-8\u003c/code\u003e\n\u003c/li\u003e\n\u003cli\u003eForward the request and CSRF exploited successfully and the modified data changed successfully  :)\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003ch2 id=\"supporting-material-references\"\u003eSupporting Material/References:\u003c/h2\u003e\n\n\u003cp\u003ePlease See this video where I recorded the above PoC in details\u003cbr\u003e\n██████\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eThis attack can be exploited in advanced way to modify all project settings and manipulate its data. Smart attacker can gain a big advantage from this bug. Hope you fix it asap.\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eRegards\u003c/strong\u003e\u003c/p\u003e\n","weakness":{"id":45,"name":"Cross-Site Request Forgery (CSRF)"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":10,"voters":["realtess","what_web","updatelap","zimmer75","silv3rpoision","bb00x","cryptographer","b9372d4605459ca97219795","iftek","dastan_9408"],"severity":{"rating":"critical","author_type":"User"},"structured_scope":{"databaseId":38702,"asset_type":"URL","asset_identifier":"my.stripo.email","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":6673784,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thank you for the report \n\nI have created tasks for the developers to fix this asap. Will come to you here in case of any questions from the team. Have a great day ahead!","markdown_message":"\u003cp\u003eThank you for the report \u003c/p\u003e\n\n\u003cp\u003eI have created tasks for the developers to fix this asap. Will come to you here in case of any questions from the team. Have a great day ahead!\u003c/p\u003e\n","automated_response":false,"created_at":"2020-01-02T14:43:21.458Z","updated_at":"2020-01-02T14:43:21.458Z","actor":{"username":"dkulaksyz","cleared":false,"url":"/dkulaksyz","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/S3TPxR7pmh7Mxu2XaqmxrKpz/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"stripo","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6926439,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2020-01-31T07:46:06.860Z","updated_at":"2020-01-31T07:46:06.860Z","actor":{"username":"artem_nefedov","cleared":false,"url":"/artem_nefedov","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"ahmd_halabi","url":"/ahmd_halabi"},"genius_execution_id":null,"team_handle":"stripo","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6931630,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-01-31T11:48:27.752Z","updated_at":"2020-01-31T11:48:27.752Z","first_to_agree":true,"actor":{"username":"ahmd_halabi","cleared":false,"url":"/ahmd_halabi","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ETQtQBq1LaFUHsfp7tDyHV2W/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"stripo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6950300,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-02-03T13:32:36.736Z","updated_at":"2020-02-03T13:32:36.736Z","actor":{"username":"artem_nefedov","cleared":false,"url":"/artem_nefedov","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"stripo","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6950301,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-02-03T13:32:36.838Z","updated_at":"2020-02-03T13:32:36.838Z","actor":{"username":"artem_nefedov","cleared":false,"url":"/artem_nefedov","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"stripo","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6950413,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you for disclosing it.","markdown_message":"\u003cp\u003eThank you for disclosing it.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-02-03T13:49:20.596Z","updated_at":"2020-02-03T13:49:20.596Z","actor":{"username":"ahmd_halabi","cleared":false,"url":"/ahmd_halabi","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ETQtQBq1LaFUHsfp7tDyHV2W/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"stripo","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}