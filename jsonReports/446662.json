{"id":446662,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC80NDY2NjI=","url":"https://hackerone.com/reports/446662","title":"Node.js HTTP/2 Large Settings Frame DoS","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2018-11-18T12:19:36.854Z","submitted_at":"2018-11-18T12:19:36.854Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"galgo","url":"/galgo","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":22984,"url":"https://hackerone.com/nodejs","handle":"nodejs","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/022/984/e600648ace4a8553247bce967d461a030aa81d49_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/022/984/e600648ace4a8553247bce967d461a030aa81d49_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Node.js","twitter_handle":"nodejs","website":"https://nodejs.org","about":"The Node.js JavaScript Runtime"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2020-07-02T19:55:27.225Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2020-06-02T19:55:19.963Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi,\n \nI would like to report a vulnerability in the http2 module of Node.js. \n \nIn section 10.5 of the HTTP/2 RFC an attack is described where an attacker is sending large SETTINGS frames that includes many settings inside it. \nWe tested this scenario by opening many connections to the server and sending a SETTINGS frame with payload size of 14400 bytes and we were able to overload one CPU core with 100% usage with a single machine. \nAnother important thing to mention is that node doesn’t close the connection to the server after some time so the attacker is able to continue sending those large SETTINGS frames.\n\nThis was tested against Node version 8.11.3\nYou can the code that was used to start the http2 server and also the script that we used for attacking it attached.\n\n## Impact\n\nDenial of Service","vulnerability_information_html":"\u003cp\u003eHi,\u003c/p\u003e\n\n\u003cp\u003eI would like to report a vulnerability in the http2 module of Node.js. \u003c/p\u003e\n\n\u003cp\u003eIn section 10.5 of the HTTP/2 RFC an attack is described where an attacker is sending large SETTINGS frames that includes many settings inside it. \u003cbr\u003e\nWe tested this scenario by opening many connections to the server and sending a SETTINGS frame with payload size of 14400 bytes and we were able to overload one CPU core with 100% usage with a single machine. \u003cbr\u003e\nAnother important thing to mention is that node doesn’t close the connection to the server after some time so the attacker is able to continue sending those large SETTINGS frames.\u003c/p\u003e\n\n\u003cp\u003eThis was tested against Node version 8.11.3\u003cbr\u003e\nYou can the code that was used to start the http2 server and also the script that we used for attacking it attached.\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eDenial of Service\u003c/p\u003e\n","weakness":{"id":48,"name":"Denial of Service"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":377296,"file_name":"Settings_Frame_DoS.zip","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/377/296/d11a5d3595166bcafd9b4b633cbe42c221ff269f/Settings_Frame_DoS.zip?response-content-disposition=attachment%3B%20filename%3D%22Settings_Frame_DoS.zip%22%3B%20filename%2A%3DUTF-8%27%27Settings_Frame_DoS.zip\u0026response-content-type=application%2Fzip\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQWPKTSU4A%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T055917Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCICR3Wbqr3QmaXXF3DerXHfL2hl5mL6uGPxa9bL7HxbeqAiEAqWiWv4fNm1cBuTJbNOPDhjMWyvgVYBMfeqSvL3C%2Br5kqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDLWeuL88FcgTd%2BHDFiqRA7sDjduiUr7yrR1bP0fy3jpTtTXARM3Gr8rkIOStwiuzOpvS67rApjBlyTcg901MzVj81BMqg2D%2FoYR3%2FSoNuwT33h6KUwD255ES%2FPaggNJ05ASpUwzUlVyePLw4P7in3wPJpZgw9N8dZGDgg6RxPAgdRMTCMAdlbL23s9IEA0HQY%2FGrR4AsNah2Xjle%2Beki0NqkG2PIPu3eRj3%2BQqZznd3OfS%2F2sVbcGOtcKdRNfVO%2Bms3UlWm2aPpwFiBKtt5yY1oKJr%2BgD%2BF%2FSQXzNSV67TxIzKIjNEaMGEHoDWRX0O4KOc6rsER7d7YcxMm3LHCy5VXT6QRFyFg%2FG4p8jairmeusKiaAs0jSa4nN2Zw3%2BCVW97Ila6RUU7muvv0d6W%2FYI6MJm443s6INDwS%2F0HX%2Bw8e4TOsebeohnSpFhM2ci9Q8tz6Q72ZmyHoSODXtdcyWxmKZOiWjWtpBmasfdIsQkZzxOUEp9TeB9Eaq72Q8%2BcHbJ%2Fn4cBcE%2FhCkABtaY7%2BW80JUqsSXPlI8vt2z0j%2B7EAZZMJT4qv8FOusB53xj88px4LwwmmUwc4%2B73P1hcJQ5adArgpVyBc%2Fvo2mvPbSXp8aV8B1%2BrfMDWuQn5Unmirx7fguBekXWHMyBRZ5m12xEhEj3mDnu3koQSeJRnoNQdEu1tOplrrLMENBFS6mTQ%2BUUBq1sggQqNoyyQNPVrpOTENkW7e%2FKnl%2FHjjMD5ktvCe3RQAaSXnShU%2FFfKQH%2FQlegKj92VkKfFBzGzGJ0gmEIyc6Fl56gBo43TML6rbL9j9QyU%2FpQpXJOVD4OV4s4%2BALvzzN5PLj4E9A%2Bwmv%2FwIgM8BdxFsm0wGfnWsssx3X6cDoUNw7ldQ%3D%3D\u0026X-Amz-Signature=2178a7e9080255f7997696b70a8004aee1698249453f275201b0124c3ae49fe7","file_size":1385,"type":"application/zip"}],"allow_singular_disclosure_at":"2020-07-02T19:55:20.056Z","allow_singular_disclosure_after":-15501837.414737456,"singular_disclosure_allowed":true,"vote_count":2,"voters":["aswin66","beforedayone"],"severity":{"rating":"low","author_type":"User"},"structured_scope":{"databaseId":666,"asset_type":"SOURCE_CODE","asset_identifier":"https://github.com/nodejs/node","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":3677566,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thanks for reporting this, I've forwarded it to the team. I can confirm the 100% CPU spike happens with the provided script on both Node 8 and 10, however the server remains accessible / it recovers gracefully after the load is removed. How is that different from a normal load testing approach? What do you think should be the mitigation/fix strategy?","markdown_message":"\u003cp\u003eThanks for reporting this, I\u0026#39;ve forwarded it to the team. I can confirm the 100% CPU spike happens with the provided script on both Node 8 and 10, however the server remains accessible / it recovers gracefully after the load is removed. How is that different from a normal load testing approach? What do you think should be the mitigation/fix strategy?\u003c/p\u003e\n","automated_response":false,"created_at":"2018-11-19T09:26:40.322Z","updated_at":"2018-11-19T09:26:40.322Z","actor":{"username":"mcollina","cleared":false,"url":"/mcollina","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/230/980/61a26e6fa4ec002fca494b3b7b43aa251eef3453_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3720038,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"As per our bounty policy this report is not eligible. Please let us know if you disagree with the assessment\n\n\"Only critical vulnerabilities that demonstrate complete compromise of the system's integrity or confidentiality are eligible for a bounty - typically Arbitrary Code Execution or equivalent impact. While we encourage you to submit all potential issues, lower severity issues are not in scope at this time.\"","markdown_message":"\u003cp\u003eAs per our bounty policy this report is not eligible. Please let us know if you disagree with the assessment\u003c/p\u003e\n\n\u003cp\u003e\u0026quot;Only critical vulnerabilities that demonstrate complete compromise of the system\u0026#39;s integrity or confidentiality are eligible for a bounty - typically Arbitrary Code Execution or equivalent impact. While we encourage you to submit all potential issues, lower severity issues are not in scope at this time.\u0026quot;\u003c/p\u003e\n","automated_response":false,"created_at":"2018-11-28T02:38:58.565Z","updated_at":"2018-11-28T02:38:58.565Z","actor":{"url":"/nodejs","ibb":true,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/022/984/e600648ace4a8553247bce967d461a030aa81d49_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Node.js"}},"genius_execution_id":null,"team_handle":"nodejs","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7091855,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2020-02-19T15:54:24.947Z","updated_at":"2020-02-19T15:54:24.947Z","additional_data":{"old_title":"Node.js HTTP/2 DoS","new_title":"Node.js HTTP/2 Large Settings Frame DoS"},"actor":{"username":"octetcloud","cleared":false,"url":"/octetcloud","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/210/672/27b2c0c2193cfb366f7889374e7ce71077431f74_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7689687,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Working on this now. There's a partial mitigation we can apply in core to at least shut the session down faster when an overly large settings frame is received, but the definition of \"overly large\" is going to be somewhat arbitrary because HTTP/2 does not place a limit on it and there are must-ignore semantics for unknown settings values.","markdown_message":"\u003cp\u003eWorking on this now. There\u0026#39;s a partial mitigation we can apply in core to at least shut the session down faster when an overly large settings frame is received, but the definition of \u0026quot;overly large\u0026quot; is going to be somewhat arbitrary because HTTP/2 does not place a limit on it and there are must-ignore semantics for unknown settings values.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-04-16T20:47:50.300Z","updated_at":"2020-04-16T20:47:50.300Z","actor":{"username":"jasnell","cleared":false,"url":"/jasnell","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/211/162/109187a55a3f81113d4b61b965ec72cbaa4970e3_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8005435,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Can someone suggest the text to use for the CVE description? It must match this very specific format: `PROBLEM TYPE` in `PRODUCT/VERSION` causes `IMPACT` when `ATTACK`","markdown_message":"\u003cp\u003eCan someone suggest the text to use for the CVE description? It must match this very specific format: \u003ccode\u003ePROBLEM TYPE\u003c/code\u003e in \u003ccode\u003ePRODUCT/VERSION\u003c/code\u003e causes \u003ccode\u003eIMPACT\u003c/code\u003e when \u003ccode\u003eATTACK\u003c/code\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2020-05-15T00:31:08.126Z","updated_at":"2020-05-15T00:31:08.126Z","actor":{"username":"octetcloud","cleared":false,"url":"/octetcloud","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/210/672/27b2c0c2193cfb366f7889374e7ce71077431f74_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8005476,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"What is suggested CVSS rating for this?","markdown_message":"\u003cp\u003eWhat is suggested CVSS rating for this?\u003c/p\u003e\n","automated_response":false,"created_at":"2020-05-15T00:47:07.848Z","updated_at":"2020-05-15T00:47:07.848Z","actor":{"username":"octetcloud","cleared":false,"url":"/octetcloud","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/210/672/27b2c0c2193cfb366f7889374e7ce71077431f74_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8041611,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"nghttp2 is getting the CVE. I'll update here when it's assigned.","markdown_message":"\u003cp\u003enghttp2 is getting the CVE. I\u0026#39;ll update here when it\u0026#39;s assigned.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-05-18T21:15:06.100Z","updated_at":"2020-05-18T21:15:06.100Z","actor":{"username":"jasnell","cleared":false,"url":"/jasnell","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/211/162/109187a55a3f81113d4b61b965ec72cbaa4970e3_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8182760,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"https://nodejs.org/en/blog/vulnerability/june-2020-security-releases/","markdown_message":"\u003cp\u003e\u003ca title=\"https://nodejs.org/en/blog/vulnerability/june-2020-security-releases/\" href=\"/redirect?url=https%3A%2F%2Fnodejs.org%2Fen%2Fblog%2Fvulnerability%2Fjune-2020-security-releases%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://nodejs.org/en/blog/vulnerability/june-2020-security-releases/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2020-06-02T19:55:08.864Z","updated_at":"2020-06-02T19:55:08.864Z","actor":{"username":"octetcloud","cleared":false,"url":"/octetcloud","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/210/672/27b2c0c2193cfb366f7889374e7ce71077431f74_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"galgo","url":"/galgo"},"genius_execution_id":null,"team_handle":"nodejs","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8182761,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-06-02T19:55:19.984Z","updated_at":"2020-06-02T19:55:19.984Z","first_to_agree":true,"actor":{"username":"octetcloud","cleared":false,"url":"/octetcloud","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/210/672/27b2c0c2193cfb366f7889374e7ce71077431f74_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8484617,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-07-02T19:55:27.299Z","updated_at":"2020-07-02T19:55:27.299Z","actor":{"url":"/nodejs","ibb":true,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/022/984/e600648ace4a8553247bce967d461a030aa81d49_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Node.js"}},"genius_execution_id":null,"team_handle":"nodejs","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}