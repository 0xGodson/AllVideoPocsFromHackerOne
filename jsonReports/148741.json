{"id":148741,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNDg3NDE=","url":"https://hackerone.com/reports/148741","title":"Stored Cross-Site-Scripting in CMS Airship's  authors profiles","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-07-01T18:39:17.554Z","submitted_at":"2016-07-01T18:39:17.554Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"lukasreschke","url":"/lukasreschke","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":8539,"url":"https://hackerone.com/paragonie","handle":"paragonie","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/008/539/72f76fed45e5220b47ba2f679371ebf9ccb19c70_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/539/72f76fed45e5220b47ba2f679371ebf9ccb19c70_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Paragon Initiative Enterprises","twitter_handle":"ParagonIE","website":"https://github.com/paragonie","about":"Cryptography and Application Security Consultants - We Produce Various Open Source Libraries"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2016-07-01T18:59:30.269Z","bug_reporter_agreed_on_going_public_at":"2016-07-01T18:59:30.205Z","team_member_agreed_on_going_public_at":"2016-07-01T18:55:47.638Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"I'm just checking out CMS Airship and some of the security features look pretty nice. Awesome job on that!\n\nAfter clicking around a bit I stumbled however upon a stored XSS vulnerability in the Bridge.  As per `/bridge/help` I use 1.1.0 version (installed via Docker), as I couldn't find any reference with regard to this in the 1.1.1 changelog from https://github.com/paragonie/airship/commit/29dc60a1b0178222c3c984915f2eda6322ca3453 I believe that it probably is affected as well.\n\nTo reproduce this:\n\n1. Install CMS Airship\n2. Make sure to use the default settings (or at least do not uncheck \"Enable registration\")\n3. Take another browser tab and go to http://localhost:8081/bridge/board to register a new account\n4. Login with that account at http://localhost:8081/bridge/login\n5. Go to http://localhost:8080/bridge/author/new\n6. Create a new author with the name \"\u003cscript\u003ealert(1)\u003c/script\u003e\"\n7. Send the author edit link to another user, such as the captain user (e.g. http://localhost:8080/bridge/author/edit/3)\n8. Open it as captain\n\nThen you see the XSS executed, or well, if your browser supports CSP a decent CSP warning in your browser console :-)\n\n{F102848}\n\nThe HTML in question is:\n\n```\n    \u003cdiv id=\"bridge_main\"\u003e    \u003ch2\u003eEdit Author \"\u003cscript\u003ealert(1)\u003c/script\u003e\" Details\u003c/h2\u003e\n\u003cform method=\"post\"\u003e\u003cinput type=\"hidden\" name=\"_CSRF_TOKEN\" value=\"ijYiRqBM1DKBw9Kevvn4zjEw:frKdBMZxXK3VUgI0ZEuQHdHerw9NnVwTx8a62QiJhiY3\" /\u003e\n    \u003cdiv class=\"table full-width table-pad-1\"\u003e\n        \u003cdiv class=\"table-row\"\u003e\n            \u003cdiv class=\"table-cell table-label\"\u003e\n                \u003clabel for=\"author_name\"\u003eAuthor Name:\u003c/label\u003e\n            \u003c/div\u003e\n            \u003cdiv class=\"table-cell\"\u003e\n                \u003cinput class=\"full-width\" id=\"author_name\" name=\"name\" placeholder=\"e.g.\u0026#x20;Information\u0026#x20;Technology\u0026#x20;Department\" value=\"\u0026lt;script\u0026gt;alert\u0026#x28;1\u0026#x29;\u0026lt;\u0026#x2F;script\u0026gt;\" type=\"text\" /\u003e\n            \u003c/div\u003e\n        \u003c/div\u003e\n```\n\nSince I don't have libsodium and PECL installed locally on my dev machine I couldn't include a tested patch for this. Sorry :-)","vulnerability_information_html":"\u003cp\u003eI\u0026#39;m just checking out CMS Airship and some of the security features look pretty nice. Awesome job on that!\u003c/p\u003e\n\n\u003cp\u003eAfter clicking around a bit I stumbled however upon a stored XSS vulnerability in the Bridge.  As per \u003ccode\u003e/bridge/help\u003c/code\u003e I use 1.1.0 version (installed via Docker), as I couldn\u0026#39;t find any reference with regard to this in the 1.1.1 changelog from \u003ca title=\"https://github.com/paragonie/airship/commit/29dc60a1b0178222c3c984915f2eda6322ca3453\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fparagonie%2Fairship%2Fcommit%2F29dc60a1b0178222c3c984915f2eda6322ca3453\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/paragonie/airship/commit/29dc60a1b0178222c3c984915f2eda6322ca3453\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e I believe that it probably is affected as well.\u003c/p\u003e\n\n\u003cp\u003eTo reproduce this:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eInstall CMS Airship\u003c/li\u003e\n\u003cli\u003eMake sure to use the default settings (or at least do not uncheck \u0026quot;Enable registration\u0026quot;)\u003c/li\u003e\n\u003cli\u003eTake another browser tab and go to \u003ca title=\"http://localhost:8081/bridge/board\" href=\"/redirect?url=http%3A%2F%2Flocalhost%3A8081%2Fbridge%2Fboard\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://localhost:8081/bridge/board\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e to register a new account\u003c/li\u003e\n\u003cli\u003eLogin with that account at \u003ca title=\"http://localhost:8081/bridge/login\" href=\"/redirect?url=http%3A%2F%2Flocalhost%3A8081%2Fbridge%2Flogin\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://localhost:8081/bridge/login\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003eGo to \u003ca title=\"http://localhost:8080/bridge/author/new\" href=\"/redirect?url=http%3A%2F%2Flocalhost%3A8080%2Fbridge%2Fauthor%2Fnew\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://localhost:8080/bridge/author/new\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003eCreate a new author with the name \u0026quot;\u0026lt;script\u0026gt;alert(1)\u0026lt;/script\u0026gt;\u0026quot;\u003c/li\u003e\n\u003cli\u003eSend the author edit link to another user, such as the captain user (e.g. \u003ca title=\"http://localhost:8080/bridge/author/edit/3\" href=\"/redirect?url=http%3A%2F%2Flocalhost%3A8080%2Fbridge%2Fauthor%2Fedit%2F3\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://localhost:8080/bridge/author/edit/3\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e)\u003c/li\u003e\n\u003cli\u003eOpen it as captain\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eThen you see the XSS executed, or well, if your browser supports CSP a decent CSP warning in your browser console :-)\u003c/p\u003e\n\n\u003cp\u003e\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"2016-07-01_20-37-23.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/102/848/4bd8a3edb1386791985f901f3e111b0b2fa35792/2016-07-01_20-37-23.png?response-content-disposition=attachment%3B%20filename%3D%222016-07-01_20-37-23.png%22%3B%20filename%2A%3DUTF-8%27%272016-07-01_20-37-23.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQ4IZIDGEJ%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T043155Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHgvhPRXI%2B7x6zNGnfFbWtzZacTUlKPt3VwSApQji3YyAiEA2Y%2FuJ72LgjXuchHTkycORzGcHp9y6ZUl%2BeyKz%2FFfjlAqtAMIVBABGgwwMTM2MTkyNzQ4NDkiDHblJHa0bCSVtoiX8yqRA7Ct%2F1l8ihdf2xXnJNUaJGv7nq%2F1b1xXdqHLpOjb5bN22Ac%2BQjHl%2Bna1KjqQx0Qu8Fcs0WQUm6dGPZbHLiP%2FRkIHh6FlY41MtajX39mvBrMgWCmioQD4vc7NSsiqHLG4GmvgnIM0wWXfwwv%2Fmq%2BjRWJQacOyz7e9kYXzI%2BQkViUKmcuV48xoXGswHYXnPSqKC6IqSk0Rgc6j2xAmne60g5PNHQf%2BehWLSoXupow19n2vF%2BE4dhw1ZLX%2B9fBct02t5%2B41MEA5z30yhC52UxDX9%2BedHi3rXpTTyV%2FX%2BWfdeGSGSqmwrTAcipCpz01NR%2Fkk3srD5BLQB%2B6BdeDlwwcltfcgYdKO39yRPNyZePA9ihdN%2B4YHA7%2FY9ufCPbEevGDvtv3mVStbES31aUOxSmGNj%2B8fMMJqFBAtD4Qx54l8UFyMf%2BQ8PPbA0OLpU9rjip1L0zxevK6IGISP%2FPlDldWsNQvfi1Xn6QvRkmL1ANNGXqycx5MDUJExPyV801VOQ68%2FfbB87Cmdd8xIJWUNtmpsIgDtMO2wqv8FOusBRxy8OOzTGCKFydY5xn2aZtaPj3obazs55j%2BS5FoY%2BdkqAuB4pbyPDlTBBI%2Fe4ZIYYBH9t51VaQaRwrhKPTTntuBcC2b5uuKcGXYq9rnIAgbUHulNqSoxgZep0wAjzrLEFeECcDfqDCjG1QyXJkGQyq3UjLElJNKzeGgK4y5hW9emXis3wfoUPLixiL7W8M52b0Q9HQrT0RxnkkNSLj7aPyOAVCPImHNwjJ%2FI2KIbB5iD4e9PbxcHFvjKgkNUQh2pESECovpzx%2BAz7wsT%2FUMRieGT%2BFtMt1o90%2BewPxe95i025ZqzwWI1aVcXtA%3D%3D\u0026amp;X-Amz-Signature=4e73b05b2f861fa452ec69bd18bdb78007e179aeaa29f28aff0ece00e9bde049\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/102/848/4bd8a3edb1386791985f901f3e111b0b2fa35792/2016-07-01_20-37-23.png?response-content-disposition=attachment%3B%20filename%3D%222016-07-01_20-37-23.png%22%3B%20filename%2A%3DUTF-8%27%272016-07-01_20-37-23.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQ4IZIDGEJ%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T043155Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHgvhPRXI%2B7x6zNGnfFbWtzZacTUlKPt3VwSApQji3YyAiEA2Y%2FuJ72LgjXuchHTkycORzGcHp9y6ZUl%2BeyKz%2FFfjlAqtAMIVBABGgwwMTM2MTkyNzQ4NDkiDHblJHa0bCSVtoiX8yqRA7Ct%2F1l8ihdf2xXnJNUaJGv7nq%2F1b1xXdqHLpOjb5bN22Ac%2BQjHl%2Bna1KjqQx0Qu8Fcs0WQUm6dGPZbHLiP%2FRkIHh6FlY41MtajX39mvBrMgWCmioQD4vc7NSsiqHLG4GmvgnIM0wWXfwwv%2Fmq%2BjRWJQacOyz7e9kYXzI%2BQkViUKmcuV48xoXGswHYXnPSqKC6IqSk0Rgc6j2xAmne60g5PNHQf%2BehWLSoXupow19n2vF%2BE4dhw1ZLX%2B9fBct02t5%2B41MEA5z30yhC52UxDX9%2BedHi3rXpTTyV%2FX%2BWfdeGSGSqmwrTAcipCpz01NR%2Fkk3srD5BLQB%2B6BdeDlwwcltfcgYdKO39yRPNyZePA9ihdN%2B4YHA7%2FY9ufCPbEevGDvtv3mVStbES31aUOxSmGNj%2B8fMMJqFBAtD4Qx54l8UFyMf%2BQ8PPbA0OLpU9rjip1L0zxevK6IGISP%2FPlDldWsNQvfi1Xn6QvRkmL1ANNGXqycx5MDUJExPyV801VOQ68%2FfbB87Cmdd8xIJWUNtmpsIgDtMO2wqv8FOusBRxy8OOzTGCKFydY5xn2aZtaPj3obazs55j%2BS5FoY%2BdkqAuB4pbyPDlTBBI%2Fe4ZIYYBH9t51VaQaRwrhKPTTntuBcC2b5uuKcGXYq9rnIAgbUHulNqSoxgZep0wAjzrLEFeECcDfqDCjG1QyXJkGQyq3UjLElJNKzeGgK4y5hW9emXis3wfoUPLixiL7W8M52b0Q9HQrT0RxnkkNSLj7aPyOAVCPImHNwjJ%2FI2KIbB5iD4e9PbxcHFvjKgkNUQh2pESECovpzx%2BAz7wsT%2FUMRieGT%2BFtMt1o90%2BewPxe95i025ZqzwWI1aVcXtA%3D%3D\u0026amp;X-Amz-Signature=4e73b05b2f861fa452ec69bd18bdb78007e179aeaa29f28aff0ece00e9bde049\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eThe HTML in question is:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e    \u0026lt;div id=\u0026quot;bridge_main\u0026quot;\u0026gt;    \u0026lt;h2\u0026gt;Edit Author \u0026quot;\u0026lt;script\u0026gt;alert(1)\u0026lt;/script\u0026gt;\u0026quot; Details\u0026lt;/h2\u0026gt;\n\u0026lt;form method=\u0026quot;post\u0026quot;\u0026gt;\u0026lt;input type=\u0026quot;hidden\u0026quot; name=\u0026quot;_CSRF_TOKEN\u0026quot; value=\u0026quot;ijYiRqBM1DKBw9Kevvn4zjEw:frKdBMZxXK3VUgI0ZEuQHdHerw9NnVwTx8a62QiJhiY3\u0026quot; /\u0026gt;\n    \u0026lt;div class=\u0026quot;table full-width table-pad-1\u0026quot;\u0026gt;\n        \u0026lt;div class=\u0026quot;table-row\u0026quot;\u0026gt;\n            \u0026lt;div class=\u0026quot;table-cell table-label\u0026quot;\u0026gt;\n                \u0026lt;label for=\u0026quot;author_name\u0026quot;\u0026gt;Author Name:\u0026lt;/label\u0026gt;\n            \u0026lt;/div\u0026gt;\n            \u0026lt;div class=\u0026quot;table-cell\u0026quot;\u0026gt;\n                \u0026lt;input class=\u0026quot;full-width\u0026quot; id=\u0026quot;author_name\u0026quot; name=\u0026quot;name\u0026quot; placeholder=\u0026quot;e.g.\u0026amp;#x20;Information\u0026amp;#x20;Technology\u0026amp;#x20;Department\u0026quot; value=\u0026quot;\u0026amp;lt;script\u0026amp;gt;alert\u0026amp;#x28;1\u0026amp;#x29;\u0026amp;lt;\u0026amp;#x2F;script\u0026amp;gt;\u0026quot; type=\u0026quot;text\u0026quot; /\u0026gt;\n            \u0026lt;/div\u0026gt;\n        \u0026lt;/div\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eSince I don\u0026#39;t have libsodium and PECL installed locally on my dev machine I couldn\u0026#39;t include a tested patch for this. Sorry :-)\u003c/p\u003e\n","bounty_amount":"50.0","formatted_bounty":"$50","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":102848,"file_name":"2016-07-01_20-37-23.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/102/848/4bd8a3edb1386791985f901f3e111b0b2fa35792/2016-07-01_20-37-23.png?response-content-disposition=attachment%3B%20filename%3D%222016-07-01_20-37-23.png%22%3B%20filename%2A%3DUTF-8%27%272016-07-01_20-37-23.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ4IZIDGEJ%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T043155Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHgvhPRXI%2B7x6zNGnfFbWtzZacTUlKPt3VwSApQji3YyAiEA2Y%2FuJ72LgjXuchHTkycORzGcHp9y6ZUl%2BeyKz%2FFfjlAqtAMIVBABGgwwMTM2MTkyNzQ4NDkiDHblJHa0bCSVtoiX8yqRA7Ct%2F1l8ihdf2xXnJNUaJGv7nq%2F1b1xXdqHLpOjb5bN22Ac%2BQjHl%2Bna1KjqQx0Qu8Fcs0WQUm6dGPZbHLiP%2FRkIHh6FlY41MtajX39mvBrMgWCmioQD4vc7NSsiqHLG4GmvgnIM0wWXfwwv%2Fmq%2BjRWJQacOyz7e9kYXzI%2BQkViUKmcuV48xoXGswHYXnPSqKC6IqSk0Rgc6j2xAmne60g5PNHQf%2BehWLSoXupow19n2vF%2BE4dhw1ZLX%2B9fBct02t5%2B41MEA5z30yhC52UxDX9%2BedHi3rXpTTyV%2FX%2BWfdeGSGSqmwrTAcipCpz01NR%2Fkk3srD5BLQB%2B6BdeDlwwcltfcgYdKO39yRPNyZePA9ihdN%2B4YHA7%2FY9ufCPbEevGDvtv3mVStbES31aUOxSmGNj%2B8fMMJqFBAtD4Qx54l8UFyMf%2BQ8PPbA0OLpU9rjip1L0zxevK6IGISP%2FPlDldWsNQvfi1Xn6QvRkmL1ANNGXqycx5MDUJExPyV801VOQ68%2FfbB87Cmdd8xIJWUNtmpsIgDtMO2wqv8FOusBRxy8OOzTGCKFydY5xn2aZtaPj3obazs55j%2BS5FoY%2BdkqAuB4pbyPDlTBBI%2Fe4ZIYYBH9t51VaQaRwrhKPTTntuBcC2b5uuKcGXYq9rnIAgbUHulNqSoxgZep0wAjzrLEFeECcDfqDCjG1QyXJkGQyq3UjLElJNKzeGgK4y5hW9emXis3wfoUPLixiL7W8M52b0Q9HQrT0RxnkkNSLj7aPyOAVCPImHNwjJ%2FI2KIbB5iD4e9PbxcHFvjKgkNUQh2pESECovpzx%2BAz7wsT%2FUMRieGT%2BFtMt1o90%2BewPxe95i025ZqzwWI1aVcXtA%3D%3D\u0026X-Amz-Signature=4e73b05b2f861fa452ec69bd18bdb78007e179aeaa29f28aff0ece00e9bde049","file_size":380220,"type":"image/png"}],"allow_singular_disclosure_at":"2016-07-31T18:55:47.718Z","allow_singular_disclosure_after":-139224967.68778315,"singular_disclosure_allowed":true,"vote_count":23,"voters":["lukasreschke","jobert","michiel","akkilion","supernatural","ibram","paresh_parmar","jens","avicoder_","sumit7","and 13 more..."],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1049748,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Wow, nevermind. Not only did I find the problem, I found out *why*: `sprintf()` wasn't applying Twig's auto-escape rules.\n\nhttps://github.com/paragonie/airship/commit/6718a8ca27a78643f274c24bb1fc126facb3db10\n\nThis should fix it.\n","markdown_message":"\u003cp\u003eWow, nevermind. Not only did I find the problem, I found out \u003cem\u003ewhy\u003c/em\u003e: \u003ccode\u003esprintf()\u003c/code\u003e wasn\u0026#39;t applying Twig\u0026#39;s auto-escape rules.\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"https://github.com/paragonie/airship/commit/6718a8ca27a78643f274c24bb1fc126facb3db10\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fparagonie%2Fairship%2Fcommit%2F6718a8ca27a78643f274c24bb1fc126facb3db10\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/paragonie/airship/commit/6718a8ca27a78643f274c24bb1fc126facb3db10\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eThis should fix it.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-07-01T18:55:28.762Z","updated_at":"2016-07-01T18:55:28.762Z","actor":{"url":"/paragonie","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/539/72f76fed45e5220b47ba2f679371ebf9ccb19c70_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Paragon Initiative Enterprises"}},"bounty_amount":"50.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"paragonie","collaborator":{"username":"lukasreschke","url":"/lukasreschke"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1049750,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2016-07-01T18:55:41.284Z","updated_at":"2016-07-01T18:55:41.284Z","actor":{"username":"paragonie-scott","cleared":false,"url":"/paragonie-scott","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/051/441/089de22b2f1b80a1e57a2792318dede5cbad81db_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"lukasreschke","url":"/lukasreschke"},"genius_execution_id":null,"team_handle":"paragonie","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1049751,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-07-01T18:55:47.669Z","updated_at":"2016-07-01T18:55:47.669Z","first_to_agree":true,"actor":{"username":"paragonie-scott","cleared":false,"url":"/paragonie-scott","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/051/441/089de22b2f1b80a1e57a2792318dede5cbad81db_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"paragonie","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1049767,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-07-01T18:59:30.228Z","updated_at":"2016-07-01T18:59:30.228Z","actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"paragonie","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1049768,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-07-01T18:59:30.296Z","updated_at":"2016-07-01T18:59:30.296Z","actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"paragonie","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1049777,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Let's get the bounty donated somewhere :-)\n\nI did file a support request to HackerOne to get this bounty donated to Doctors without Borders.","markdown_message":"\u003cp\u003eLet\u0026#39;s get the bounty donated somewhere :-)\u003c/p\u003e\n\n\u003cp\u003eI did file a support request to HackerOne to get this bounty donated to Doctors without Borders.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-07-01T19:02:52.304Z","updated_at":"2016-07-01T19:02:52.304Z","actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"paragonie","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1049837,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks again for reporting this.\n\nLesson learned:\n\n1. If you rely on autoescaping, make *sure* it's being applied everywhere. Where it's not applied, escape manually.\n2. Be more skeptical of patterns intended to promote i18n.\n3. Turn off `Content-Security-Policy` headers when testing locally so it's easier to catch these failures..","markdown_message":"\u003cp\u003eThanks again for reporting this.\u003c/p\u003e\n\n\u003cp\u003eLesson learned:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eIf you rely on autoescaping, make \u003cem\u003esure\u003c/em\u003e it\u0026#39;s being applied everywhere. Where it\u0026#39;s not applied, escape manually.\u003c/li\u003e\n\u003cli\u003eBe more skeptical of patterns intended to promote i18n.\u003c/li\u003e\n\u003cli\u003eTurn off \u003ccode\u003eContent-Security-Policy\u003c/code\u003e headers when testing locally so it\u0026#39;s easier to catch these failures..\u003c/li\u003e\n\u003c/ol\u003e\n","automated_response":false,"created_at":"2016-07-01T19:44:42.319Z","updated_at":"2016-07-01T19:44:42.319Z","actor":{"username":"paragonie-scott","cleared":false,"url":"/paragonie-scott","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/051/441/089de22b2f1b80a1e57a2792318dede5cbad81db_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"paragonie","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":2155,"category":"team","content":"For an in-depth analysis, check out the **[post-mortem posted on CSPR.NG](https://cspr.ng/blog/2016/07/cms-airship-1-1-2-stored-xss-post-mortem)**.\n\nLessons learned:\n\n1. If you rely on auto-escaping, make *sure* it's being applied everywhere. Where it's not applied, escape manually.\n2. Be more skeptical of patterns intended to promote i18n.\n3. Turn off `Content-Security-Policy` headers when testing locally so it's easier to catch these failures.\n","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eFor an in-depth analysis, check out the \u003cstrong\u003e\u003ca href=\"/redirect?url=https%3A%2F%2Fcspr.ng%2Fblog%2F2016%2F07%2Fcms-airship-1-1-2-stored-xss-post-mortem\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003epost-mortem posted on CSPR.NG\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/strong\u003e.\u003c/p\u003e\n\n\u003cp\u003eLessons learned:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eIf you rely on auto-escaping, make \u003cem\u003esure\u003c/em\u003e it\u0026#39;s being applied everywhere. Where it\u0026#39;s not applied, escape manually.\u003c/li\u003e\n\u003cli\u003eBe more skeptical of patterns intended to promote i18n.\u003c/li\u003e\n\u003cli\u003eTurn off \u003ccode\u003eContent-Security-Policy\u003c/code\u003e headers when testing locally so it\u0026#39;s easier to catch these failures.\u003c/li\u003e\n\u003c/ol\u003e\n"},{"category":"researcher","can_view?":true,"can_create?":false}]}