{"id":209520,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMDk1MjA=","url":"https://hackerone.com/reports/209520","title":"http://www.nextcloud.com/wp-includes/js/swfupload/swfupload.swf allows open redirect / site defacement","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2017-02-28T07:12:50.139Z","submitted_at":"2017-02-28T07:12:50.139Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"todayisnew","url":"/todayisnew","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/vyC75Ahqgs71NFmwarUBLqSD/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13291,"url":"https://hackerone.com/nextcloud","handle":"nextcloud","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Nextcloud","twitter_handle":"nextclouders","website":"https://nextcloud.com","about":"Access, share and protect your files, calendars, contacts, communication \u0026 more at home and in your enterprise."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2020-03-07T21:55:51.808Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2020-02-06T21:55:48.683Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"\nGood day, I truly hope it treats you well on your side of the screen :)\n\nI have found that your website uses the flash file: swfupload.swf to allow your users to upload files.\n\nThe tl;dr version of this bug report is it allows an open redirect to any site a non kind person may want to exploit or website defacement with the option to put any image on your site to share with others.  If not greatly in scope I understand, just wanted to help you be more secure :)\n\nThe link in question is:\n\nhttp://www.nextcloud.com/wp-includes/js/swfupload/swfupload.swf?debugEn%xabled=true\u0026buttonImag%xeURL=https://████████/PugOfConcept/pugOfConcept.swf\n\nFriendly url shorted version:\n\nhttps://tinyurl.com/zduxnhz\n\nI've already created a fancy animated gif of the exploit in action so you can click, watch, and hopefully see a cute POC surprise on video end.\n\nhttps://www.dropbox.com/s/0343g6qgjdz1y1r/nextcloud.com_swf_upload_open_redirect_2_27_2017.gif?dl=0\n\nDefacement Link\n\nhttp://www.nextcloud.com/wp-includes/js/swfupload/swfupload.swf?debug%%Enabled=true\u0026buttonTe%%xt=\u0026buttonImag%%eURL=http://██████████/PugOfConcept/nopuppies.jpg\n\n\nFull report details:\n\na) Why Open Redirects can be harmful for your users and your company:\n   https://www.owasp.org/index.php/Top_10_2010-A10-Unvalidated_Redirects_and_Forwards\n\nb) The source of the most recent version of swfupload.swf is here:\n   https://github.com/WordPress/secure-swfupload\n\nThe bad news is the newest version is vulnerable to the exploit (I will be reporting it to wordpress to fix hopefully)\n\nThey strongly suggest updating to a newer move secure version:\nhttp://www.plupload.com/\n\n\nc) How the exploit works:\n\nWhen you visit a swf, query string parameters (what appears after the ?) can be passed along in the request:\n\nhttp://myawesomewebsite.com/wp-includes/js/swfupload/swfupload.swf?   \u003cdebugEn%xabled=true?\u0026buttonImag%xeURL=https://█████/PugOfConcept/pugOfConcept.swf\u003e\n\t\nFlash reads in these variables via a special variable: root.loaderInfo.parameters\n\nThe intended solution is that they tried to filter out if query string parameters were passed along in the request by checking for them and if the were passed to delete them.\n   \n\tfor(key in params)\n\t{\n\t\t\tif(query.hasOwnProperty(Utils.trim(key)))\n\t\t{\n\t\t\tdelete params[key];\n\t\t}\n\t}\n\n\nThe trick is that Flash will filter and non valid url encoded variables from a string, so %00-%FF are valid ascii encoded strings, a = %61 b = %62 etc\nI tricked the system with the variable passed \"?debugEnabled=true\" normally would be filtered, but with debugEn%xabled=true, the %x is a non valid hex string :)  Since Hex counts from 0-F There is no valid %x.\n\nMay you be well on your side of the screen :)\n\n-Eric\n\nAlso vulnerable:\n\n","vulnerability_information_html":"\u003cp\u003eGood day, I truly hope it treats you well on your side of the screen :)\u003c/p\u003e\n\n\u003cp\u003eI have found that your website uses the flash file: swfupload.swf to allow your users to upload files.\u003c/p\u003e\n\n\u003cp\u003eThe tl;dr version of this bug report is it allows an open redirect to any site a non kind person may want to exploit or website defacement with the option to put any image on your site to share with others.  If not greatly in scope I understand, just wanted to help you be more secure :)\u003c/p\u003e\n\n\u003cp\u003eThe link in question is:\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"http://www.nextcloud.com/wp-includes/js/swfupload/swfupload.swf?debugEn%xabled=true\u0026amp;buttonImag%xeURL=https://%E2%96%88%E2%96%88%E2%96%88%E2%96%88%E2%96%88%E2%96%88%E2%96%88%E2%96%88/PugOfConcept/pugOfConcept.swf\" href=\"/redirect?url=http%3A%2F%2Fwww.nextcloud.com%2Fwp-includes%2Fjs%2Fswfupload%2Fswfupload.swf%3FdebugEn%25xabled%3Dtrue%26buttonImag%25xeURL%3Dhttps%3A%2F%2F%25E2%2596%2588%25E2%2596%2588%25E2%2596%2588%25E2%2596%2588%25E2%2596%2588%25E2%2596%2588%25E2%2596%2588%25E2%2596%2588%2FPugOfConcept%2FpugOfConcept.swf\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://www.nextcloud.com/wp-includes/js/swfupload/swfupload.swf?debugEn%xabled=true\u0026amp;buttonImag%xeURL=https://%E2%96%88%E2%96%88%E2%96%88%E2%96%88%E2%96%88%E2%96%88%E2%96%88%E2%96%88/PugOfConcept/pugOfConcept.swf\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eFriendly url shorted version:\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"https://tinyurl.com/zduxnhz\" href=\"/redirect?url=https%3A%2F%2Ftinyurl.com%2Fzduxnhz\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://tinyurl.com/zduxnhz\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eI\u0026#39;ve already created a fancy animated gif of the exploit in action so you can click, watch, and hopefully see a cute POC surprise on video end.\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"https://www.dropbox.com/s/0343g6qgjdz1y1r/nextcloud.com_swf_upload_open_redirect_2_27_2017.gif?dl=0\" href=\"/redirect?url=https%3A%2F%2Fwww.dropbox.com%2Fs%2F0343g6qgjdz1y1r%2Fnextcloud.com_swf_upload_open_redirect_2_27_2017.gif%3Fdl%3D0\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.dropbox.com/s/0343g6qgjdz1y1r/nextcloud.com_swf_upload_open_redirect_2_27_2017.gif?dl=0\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eDefacement Link\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"http://www.nextcloud.com/wp-includes/js/swfupload/swfupload.swf?debug%%Enabled=true\u0026amp;buttonTe%%xt=\u0026amp;buttonImag%%eURL=http://%E2%96%88%E2%96%88%E2%96%88%E2%96%88%E2%96%88%E2%96%88%E2%96%88%E2%96%88%E2%96%88%E2%96%88/PugOfConcept/nopuppies.jpg\" href=\"/redirect?url=http%3A%2F%2Fwww.nextcloud.com%2Fwp-includes%2Fjs%2Fswfupload%2Fswfupload.swf%3Fdebug%25%25Enabled%3Dtrue%26buttonTe%25%25xt%3D%26buttonImag%25%25eURL%3Dhttp%3A%2F%2F%25E2%2596%2588%25E2%2596%2588%25E2%2596%2588%25E2%2596%2588%25E2%2596%2588%25E2%2596%2588%25E2%2596%2588%25E2%2596%2588%25E2%2596%2588%25E2%2596%2588%2FPugOfConcept%2Fnopuppies.jpg\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://www.nextcloud.com/wp-includes/js/swfupload/swfupload.swf?debug%%Enabled=true\u0026amp;buttonTe%%xt=\u0026amp;buttonImag%%eURL=http://%E2%96%88%E2%96%88%E2%96%88%E2%96%88%E2%96%88%E2%96%88%E2%96%88%E2%96%88%E2%96%88%E2%96%88/PugOfConcept/nopuppies.jpg\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eFull report details:\u003c/p\u003e\n\n\u003cp\u003ea) Why Open Redirects can be harmful for your users and your company:\u003cbr\u003e\n   \u003ca title=\"https://www.owasp.org/index.php/Top_10_2010-A10-Unvalidated_Redirects_and_Forwards\" href=\"/redirect?url=https%3A%2F%2Fwww.owasp.org%2Findex.php%2FTop_10_2010-A10-Unvalidated_Redirects_and_Forwards\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.owasp.org/index.php/Top_10_2010-A10-Unvalidated_Redirects_and_Forwards\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eb) The source of the most recent version of swfupload.swf is here:\u003cbr\u003e\n   \u003ca title=\"https://github.com/WordPress/secure-swfupload\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2FWordPress%2Fsecure-swfupload\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/WordPress/secure-swfupload\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eThe bad news is the newest version is vulnerable to the exploit (I will be reporting it to wordpress to fix hopefully)\u003c/p\u003e\n\n\u003cp\u003eThey strongly suggest updating to a newer move secure version:\u003cbr\u003e\n\u003ca title=\"http://www.plupload.com/\" href=\"/redirect?url=http%3A%2F%2Fwww.plupload.com%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://www.plupload.com/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003ec) How the exploit works:\u003c/p\u003e\n\n\u003cp\u003eWhen you visit a swf, query string parameters (what appears after the ?) can be passed along in the request:\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"http://myawesomewebsite.com/wp-includes/js/swfupload/swfupload.swf\" href=\"/redirect?url=http%3A%2F%2Fmyawesomewebsite.com%2Fwp-includes%2Fjs%2Fswfupload%2Fswfupload.swf\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://myawesomewebsite.com/wp-includes/js/swfupload/swfupload.swf\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e?   \u0026lt;debugEn%xabled=true?\u0026amp;buttonImag%xeURL=https://█████/PugOfConcept/pugOfConcept.swf\u0026gt;\u003c/p\u003e\n\n\u003cp\u003eFlash reads in these variables via a special variable: root.loaderInfo.parameters\u003c/p\u003e\n\n\u003cp\u003eThe intended solution is that they tried to filter out if query string parameters were passed along in the request by checking for them and if the were passed to delete them.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003efor(key in params)\n{\n        if(query.hasOwnProperty(Utils.trim(key)))\n    {\n        delete params[key];\n    }\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThe trick is that Flash will filter and non valid url encoded variables from a string, so %00-%FF are valid ascii encoded strings, a = %61 b = %62 etc\u003cbr\u003e\nI tricked the system with the variable passed \u0026quot;?debugEnabled=true\u0026quot; normally would be filtered, but with debugEn%xabled=true, the %x is a non valid hex string :)  Since Hex counts from 0-F There is no valid %x.\u003c/p\u003e\n\n\u003cp\u003eMay you be well on your side of the screen :)\u003c/p\u003e\n\n\u003cp\u003e-Eric\u003c/p\u003e\n\n\u003cp\u003eAlso vulnerable:\u003c/p\u003e\n","weakness":{"id":53,"name":"Open Redirect"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2020-03-07T21:55:48.765Z","allow_singular_disclosure_after":-25599627.415368225,"singular_disclosure_allowed":true,"vote_count":32,"voters":["huwwp","lukasreschke","a_d_a_m","notnaffy","prophet","powerjacobb1","vishnugadupudi","softwareguy","realtess","nessun00x","and 22 more..."],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1510319,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks a lot for reporting this potential issue back to us!\n\nOur security team will take a look at this issue as soon as possible. We will reply to your report within 72 hours, usually much faster. For obvious reasons we'd like to ask you to not disclose this issue to any other party.","markdown_message":"\u003cp\u003eThanks a lot for reporting this potential issue back to us!\u003c/p\u003e\n\n\u003cp\u003eOur security team will take a look at this issue as soon as possible. We will reply to your report within 72 hours, usually much faster. For obvious reasons we\u0026#39;d like to ask you to not disclose this issue to any other party.\u003c/p\u003e\n","automated_response":true,"created_at":"2017-02-28T07:12:50.240Z","updated_at":"2017-02-28T07:12:50.240Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Nextcloud"}},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1510640,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"As far as I can tell we do use the swfupload.swf as shipped by Wordpress 4.7.2. So this should already include the new version shipped by Wordpress which should be https://github.com/WordPress/secure-swfupload\n\nI don't have Flash installed myself so verifying this may take some time.","markdown_message":"\u003cp\u003eAs far as I can tell we do use the swfupload.swf as shipped by Wordpress 4.7.2. So this should already include the new version shipped by Wordpress which should be \u003ca title=\"https://github.com/WordPress/secure-swfupload\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2FWordPress%2Fsecure-swfupload\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/WordPress/secure-swfupload\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eI don\u0026#39;t have Flash installed myself so verifying this may take some time.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-02-28T10:15:36.605Z","updated_at":"2017-02-28T10:15:36.605Z","actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1514134,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I wrote a quick patch to fix the issue:\nTo prevent the open redirect at least :)\n\nSWFUpload line 424 \n\nOriginal Code:\nthis.SetButtonImageURL(String(params.buttonImageURL));\n\nReplacement for tweaking how needed:\n\n try\n         {\n\n\t\t\tvar buttonImageString:String = String(params.buttonImageURL);\n\t\t\tvar regExTest:RegExp = /\\.swf/;\n\t\t\tvar DoesItMatch:Boolean = regExTest.test(buttonImageString);\n\n\t\t\ttrace(DoesItMatch);\n\n\t\t\tif (DoesItMatch)\n\t\t\t{\n\t\t\t\tbuttonImageString = \"\";\n\t\t\t}\n\n\n            this.SetButtonImageURL(buttonImageString);\n\n            \n         }\n\n\nPatched Binary:\n\nhttp://████████/PugOfConcept/swfupload(patched).swf\n\nPOC1 \n\nPuppies jpg loads happily:\nhttp://██████/PugOfConcept/swfupload(patched).swf?debugEn%xabled=true\u0026buttonImag%xeURL=http://███████/PugOfConcept/nopuppies.jpg\n\nEvil swf files can no longer be run:\nhttp://███████/PugOfConcept/swfupload(patched).swf?debugEn%xabled=true\u0026buttonImag%xeURL=https://████████/PugOfConcept/pugOfConcept.swf","markdown_message":"\u003cp\u003eI wrote a quick patch to fix the issue:\u003cbr\u003e\nTo prevent the open redirect at least :)\u003c/p\u003e\n\n\u003cp\u003eSWFUpload line 424 \u003c/p\u003e\n\n\u003cp\u003eOriginal Code:\u003cbr\u003e\nthis.SetButtonImageURL(String(params.buttonImageURL));\u003c/p\u003e\n\n\u003cp\u003eReplacement for tweaking how needed:\u003c/p\u003e\n\n\u003cp\u003etry\u003cbr\u003e\n         {\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e        var buttonImageString:String = String(params.buttonImageURL);\n        var regExTest:RegExp = /\\.swf/;\n        var DoesItMatch:Boolean = regExTest.test(buttonImageString);\n\n        trace(DoesItMatch);\n\n        if (DoesItMatch)\n        {\n            buttonImageString = \u0026quot;\u0026quot;;\n        }\n\n\n        this.SetButtonImageURL(buttonImageString);\n\n\n     }\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003ePatched Binary:\u003c/p\u003e\n\n\u003cp\u003ehttp://████████/PugOfConcept/swfupload(patched).swf\u003c/p\u003e\n\n\u003cp\u003ePOC1 \u003c/p\u003e\n\n\u003cp\u003ePuppies jpg loads happily:\u003cbr\u003e\nhttp://██████/PugOfConcept/swfupload(patched).swf?debugEn%xabled=true\u0026amp;buttonImag%xeURL=http://███████/PugOfConcept/nopuppies.jpg\u003c/p\u003e\n\n\u003cp\u003eEvil swf files can no longer be run:\u003cbr\u003e\nhttp://███████/PugOfConcept/swfupload(patched).swf?debugEn%xabled=true\u0026amp;buttonImag%xeURL=https://████████/PugOfConcept/pugOfConcept.swf\u003c/p\u003e\n","automated_response":false,"created_at":"2017-03-01T19:56:17.238Z","updated_at":"2020-02-06T12:55:58.613Z","actor":{"username":"todayisnew","cleared":true,"url":"/todayisnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/vyC75Ahqgs71NFmwarUBLqSD/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1566222,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello,\n\nI have wrote replacement versions of swfupload.swf and moxieplayer.swf until Wordpress releases fixes for the issues.\n\nDownload from:\nhttp://█████/PugOfConcept/moxieplayer(patched).swf\nhttp://███/PugOfConcept/swfupload(patched).swf\n\nTo verify I have not snuck anything sneaky into the code :)  Of if you're curious how the code works, this decompiler will let you view the source code changes that I have made :)\n\nhttps://www.free-decompiler.com/flash/\n\nA) Replacement for swfupload.swf\n\nSWFUpload line 424\n\nOriginal Code:\nthis.SetButtonImageURL(String(params.buttonImageURL));\n\nRewrote More secure code:\n\ntry\n{\n\n        var buttonImageString:String = String(params.buttonImageURL);\n        var regExTest:RegExp = /\\.swf/;\n        var DoesItMatch:Boolean = regExTest.test(buttonImageString);\n\n        trace(DoesItMatch);\n\n        if (DoesItMatch)\n        {\n            buttonImageString = \"\";\n        }\n\n\n        this.SetButtonImageURL(buttonImageString);\n\n\n     }\n\n\nPOC1\n\nOriginal code allows open redirect:\nhttp://██████████/PugOfConcept/swfupload.swf?debugEn%xabled=true\u0026buttonImag%xeURL=https://██████/PugOfConcept/pugOfConcept.swf\n\nEvil swf files can no longer be run:\nhttp://█████████/PugOfConcept/swfupload(patched).swf?debugEn%xabled=true\u0026buttonImag%xeURL=https://████████/PugOfConcept/pugOfConcept.swf\n\n\n\nB) Replacement for moxieplayer.swf\n\n\n\nOriginal Code:\n\n private function preloadPoster() : void\n      {\n         if(!this.params.hasOwnProperty(\"poster\"))\n         {\n            return;\n         }\n         var loader:Loader = new Loader();\n         loader.contentLoaderInfo.addEventListener(Event.COMPLETE,function(param1:Event):void\n         {\n            param1.target.removeEventListener(Event.COMPLETE,arguments.callee);\n            poster = param1.target.loader.content;\n            showPoster();\n         });\n         loader.load(new URLRequest(this.params[\"poster\"]));\n      }\n\n\n\n\n\nRewrote More secure code:\n\n\n private function preloadPoster() : void\n      {\n\n\n\t\ttry\n\t\t{\n\n\t\t\tvar posterImageString:String = String(this.params[\"poster\"]);\n\t\t\tvar regExTest:RegExp = /\\.swf/;\n\t\t\tvar DoesItMatch:Boolean = regExTest.test(posterImageString);\n\n\t\t\ttrace(DoesItMatch);\n\n\t\t\tif (DoesItMatch)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\n\t\t}\n\t\tcatch(ex)\n\t\t{\n\t\t\t\t   return;\n\t\t}\n\n\n\n         if(!this.params.hasOwnProperty(\"poster\"))\n         {\n            return;\n         }\n         var loader:Loader = new Loader();\n         loader.contentLoaderInfo.addEventListener(Event.COMPLETE,function(param1:Event):void\n         {\n            param1.target.removeEventListener(Event.COMPLETE,arguments.callee);\n            poster = param1.target.loader.content;\n            showPoster();\n         });\n\n\n\n\n\n         loader.load(new URLRequest(this.params[\"poster\"]));\n      }\n\n\nMoxie player replacement POC1\n\nOpen redirect fires happily:\nhttp://████████/PugOfConcept/moxieplayer.swf?pos%%ter=https://█████/PugOfConcept/pugOfConcept.swf\n\nEvil swf Open redirect no longer runs:\nhttp://███████/PugOfConcept/moxieplayer(patched).swf?pos%%ter=https://████████/PugOfConcept/pugOfConcept.swf\n\n\n\n\n\n","markdown_message":"\u003cp\u003eHello,\u003c/p\u003e\n\n\u003cp\u003eI have wrote replacement versions of swfupload.swf and moxieplayer.swf until Wordpress releases fixes for the issues.\u003c/p\u003e\n\n\u003cp\u003eDownload from:\u003cbr\u003e\nhttp://█████/PugOfConcept/moxieplayer(patched).swf\u003cbr\u003e\nhttp://███/PugOfConcept/swfupload(patched).swf\u003c/p\u003e\n\n\u003cp\u003eTo verify I have not snuck anything sneaky into the code :)  Of if you\u0026#39;re curious how the code works, this decompiler will let you view the source code changes that I have made :)\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"https://www.free-decompiler.com/flash/\" href=\"/redirect?url=https%3A%2F%2Fwww.free-decompiler.com%2Fflash%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.free-decompiler.com/flash/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eA) Replacement for swfupload.swf\u003c/p\u003e\n\n\u003cp\u003eSWFUpload line 424\u003c/p\u003e\n\n\u003cp\u003eOriginal Code:\u003cbr\u003e\nthis.SetButtonImageURL(String(params.buttonImageURL));\u003c/p\u003e\n\n\u003cp\u003eRewrote More secure code:\u003c/p\u003e\n\n\u003cp\u003etry\u003cbr\u003e\n{\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e    var buttonImageString:String = String(params.buttonImageURL);\n    var regExTest:RegExp = /\\.swf/;\n    var DoesItMatch:Boolean = regExTest.test(buttonImageString);\n\n    trace(DoesItMatch);\n\n    if (DoesItMatch)\n    {\n        buttonImageString = \u0026quot;\u0026quot;;\n    }\n\n\n    this.SetButtonImageURL(buttonImageString);\n\n\n }\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003ePOC1\u003c/p\u003e\n\n\u003cp\u003eOriginal code allows open redirect:\u003cbr\u003e\nhttp://██████████/PugOfConcept/swfupload.swf?debugEn%xabled=true\u0026amp;buttonImag%xeURL=https://██████/PugOfConcept/pugOfConcept.swf\u003c/p\u003e\n\n\u003cp\u003eEvil swf files can no longer be run:\u003cbr\u003e\nhttp://█████████/PugOfConcept/swfupload(patched).swf?debugEn%xabled=true\u0026amp;buttonImag%xeURL=https://████████/PugOfConcept/pugOfConcept.swf\u003c/p\u003e\n\n\u003cp\u003eB) Replacement for moxieplayer.swf\u003c/p\u003e\n\n\u003cp\u003eOriginal Code:\u003c/p\u003e\n\n\u003cp\u003eprivate function preloadPoster() : void\u003cbr\u003e\n      {\u003cbr\u003e\n         if(!this.params.hasOwnProperty(\u0026quot;poster\u0026quot;))\u003cbr\u003e\n         {\u003cbr\u003e\n            return;\u003cbr\u003e\n         }\u003cbr\u003e\n         var loader:Loader = new Loader();\u003cbr\u003e\n         loader.contentLoaderInfo.addEventListener(Event.COMPLETE,function(param1:Event):void\u003cbr\u003e\n         {\u003cbr\u003e\n            param1.target.removeEventListener(Event.COMPLETE,arguments.callee);\u003cbr\u003e\n            poster = param1.target.loader.content;\u003cbr\u003e\n            showPoster();\u003cbr\u003e\n         });\u003cbr\u003e\n         loader.load(new URLRequest(this.params[\u0026quot;poster\u0026quot;]));\u003cbr\u003e\n      }\u003c/p\u003e\n\n\u003cp\u003eRewrote More secure code:\u003c/p\u003e\n\n\u003cp\u003eprivate function preloadPoster() : void\u003cbr\u003e\n      {\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e    try\n    {\n\n        var posterImageString:String = String(this.params[\u0026quot;poster\u0026quot;]);\n        var regExTest:RegExp = /\\.swf/;\n        var DoesItMatch:Boolean = regExTest.test(posterImageString);\n\n        trace(DoesItMatch);\n\n        if (DoesItMatch)\n        {\n            return;\n        }\n\n\n    }\n    catch(ex)\n    {\n               return;\n    }\n\n\n\n     if(!this.params.hasOwnProperty(\u0026quot;poster\u0026quot;))\n     {\n        return;\n     }\n     var loader:Loader = new Loader();\n     loader.contentLoaderInfo.addEventListener(Event.COMPLETE,function(param1:Event):void\n     {\n        param1.target.removeEventListener(Event.COMPLETE,arguments.callee);\n        poster = param1.target.loader.content;\n        showPoster();\n     });\n\n\n\n\n\n     loader.load(new URLRequest(this.params[\u0026quot;poster\u0026quot;]));\n  }\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eMoxie player replacement POC1\u003c/p\u003e\n\n\u003cp\u003eOpen redirect fires happily:\u003cbr\u003e\nhttp://████████/PugOfConcept/moxieplayer.swf?pos%%ter=https://█████/PugOfConcept/pugOfConcept.swf\u003c/p\u003e\n\n\u003cp\u003eEvil swf Open redirect no longer runs:\u003cbr\u003e\nhttp://███████/PugOfConcept/moxieplayer(patched).swf?pos%%ter=https://████████/PugOfConcept/pugOfConcept.swf\u003c/p\u003e\n","automated_response":false,"created_at":"2017-03-27T19:57:50.791Z","updated_at":"2020-02-06T12:55:58.607Z","actor":{"username":"todayisnew","cleared":true,"url":"/todayisnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/vyC75Ahqgs71NFmwarUBLqSD/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1618565,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks a lot for your report again. After review it seems we can safely block access to said SWF file. We've adjusted the server configuration for this reason to disallow access to any SWF files.","markdown_message":"\u003cp\u003eThanks a lot for your report again. After review it seems we can safely block access to said SWF file. We\u0026#39;ve adjusted the server configuration for this reason to disallow access to any SWF files.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-04-18T15:21:30.445Z","updated_at":"2017-04-18T15:21:30.445Z","actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"todayisnew","url":"/todayisnew"},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1618566,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"","markdown_message":"","automated_response":false,"created_at":"2017-04-18T15:21:34.874Z","updated_at":"2017-04-18T15:21:34.874Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Nextcloud"}},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1619170,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @lukasreschke, great job getting things locked down.\n\nSince wordpress has still not fixed this issue, could we hold off on public disclosure until a patch is at least in place :)\n\nMay you be well on your side of the screen :)\n\n-Eric","markdown_message":"\u003cp\u003eHey \u003ca href=\"/lukasreschke\"\u003e@lukasreschke\u003c/a\u003e, great job getting things locked down.\u003c/p\u003e\n\n\u003cp\u003eSince wordpress has still not fixed this issue, could we hold off on public disclosure until a patch is at least in place :)\u003c/p\u003e\n\n\u003cp\u003eMay you be well on your side of the screen :)\u003c/p\u003e\n\n\u003cp\u003e-Eric\u003c/p\u003e\n","automated_response":false,"created_at":"2017-04-18T18:05:43.775Z","updated_at":"2017-04-18T18:05:43.775Z","actor":{"username":"todayisnew","cleared":true,"url":"/todayisnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/vyC75Ahqgs71NFmwarUBLqSD/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1619576,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"\u003e Since wordpress has still not fixed this issue, could we hold off on public disclosure until a patch is at least in place :)\n\nCancelling a public disclosure request would require to involve the HackerOne support team as this doesn't seem to be possible via the GUI here.\n\nSo, any chance that this is fixed before the 30 day countdown? Otherwise I'll reach out to the HackerOne support team.","markdown_message":"\u003cblockquote\u003e\n\u003cp\u003eSince wordpress has still not fixed this issue, could we hold off on public disclosure until a patch is at least in place :)\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eCancelling a public disclosure request would require to involve the HackerOne support team as this doesn\u0026#39;t seem to be possible via the GUI here.\u003c/p\u003e\n\n\u003cp\u003eSo, any chance that this is fixed before the 30 day countdown? Otherwise I\u0026#39;ll reach out to the HackerOne support team.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-04-18T20:47:04.750Z","updated_at":"2017-04-18T20:47:04.750Z","actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6932779,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Forgot to disclose this","markdown_message":"\u003cp\u003eForgot to disclose this\u003c/p\u003e\n","automated_response":false,"created_at":"2020-01-31T14:11:31.493Z","updated_at":"2020-01-31T14:11:31.493Z","first_to_agree":true,"actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6934164,"is_internal":false,"editable":false,"type":"Activities::CancelledDisclosureRequest","message":"Hello :)\n\nI realize my POC's link back to my personal server, ██████████.  I have had a few DOS attacks against the server and not wanting to share it publicly right now, if we can edit to remove the ████ happy to disclose, I'm not sure how to do that at this point :)","markdown_message":"\u003cp\u003eHello :)\u003c/p\u003e\n\n\u003cp\u003eI realize my POC\u0026#39;s link back to my personal server, ██████████.  I have had a few DOS attacks against the server and not wanting to share it publicly right now, if we can edit to remove the ████ happy to disclose, I\u0026#39;m not sure how to do that at this point :)\u003c/p\u003e\n","automated_response":false,"created_at":"2020-01-31T17:10:18.441Z","updated_at":"2020-02-06T12:55:58.595Z","actor":{"username":"todayisnew","cleared":true,"url":"/todayisnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/vyC75Ahqgs71NFmwarUBLqSD/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6978483,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Done","markdown_message":"\u003cp\u003eDone\u003c/p\u003e\n","automated_response":false,"created_at":"2020-02-06T12:56:09.431Z","updated_at":"2020-02-06T12:56:09.431Z","actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6982297,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-02-06T21:55:48.705Z","updated_at":"2020-02-06T21:55:48.705Z","first_to_agree":true,"actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7253179,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-03-07T21:55:51.833Z","updated_at":"2020-03-07T21:55:51.833Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Nextcloud"}},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}