{"id":506161,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC81MDYxNjE=","url":"https://hackerone.com/reports/506161","title":"Build fetches jars over HTTP","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2019-03-07T16:24:48.110Z","submitted_at":"2019-03-07T16:24:48.110Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"jlleitschuh","url":"/jlleitschuh","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/388/267/887b2ef55debfc7b243bdf563d314329cf750468_original.JPG/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":15252,"url":"https://hackerone.com/portswigger","handle":"portswigger","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/015/252/60e8778f4f1fee57ea2b164a7d2ec1e2d2dd7bc8_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/252/60e8778f4f1fee57ea2b164a7d2ec1e2d2dd7bc8_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"PortSwigger Web Security","twitter_handle":"Burp_Suite","website":"https://portswigger.net","about":"Burp Suite is the leading software for web security testing"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2019-06-10T19:01:06.838Z","bug_reporter_agreed_on_going_public_at":"2019-06-10T18:59:44.744Z","team_member_agreed_on_going_public_at":"2019-06-10T19:01:06.742Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"[CWE-829: Inclusion of Functionality from Untrusted Control Sphere](https://cwe.mitre.org/data/definitions/829.html)\n[CWE-494: Download of Code Without Integrity Check](https://cwe.mitre.org/data/definitions/494.html)\n\nPortSwigger maintains several Open Source Projects under the [PortSwigger GitHub organization](https://github.com/PortSwigger). Some of these projects contain build files that indicate that some of these projects are resolving dependencies over HTTP instead of HTTPS. This allows these artifacts to be potentially MITMed to maliciously compromise them and infect the build artifacts that are produced. Additionally, if any of these JARs or other dependencies were compromised, any developers or production servers using these could continue to be infected past updating to fix this.\n\n**Description:**\n\nThis attack leverages the build infrastructure loading dependencies over HTTP without any other sort of integrity check to allow them to be maliciously compromised.\n\n### This isn't just theoretical\nPOC code has existed since 2014 to maliciously compromise a JAR file inflight.\nSee:\n* https://max.computer/blog/how-to-take-over-the-computer-of-any-java-or-clojure-or-scala-developer/\n* https://github.com/mveytsman/dilettante\n\n### MITM Attacks Increasingly Common\nSee:\n* https://serverfault.com/a/153065\n* https://security.stackexchange.com/a/12050\n* [Comcast continues to inject its own code into websites you visit](https://thenextweb.com/insights/2017/12/11/comcast-continues-to-inject-its-own-code-into-websites-you-visit/#) (over HTTP)\n\n### Source Locations\n\n#### Insecure Download\n\n##### TeamCity Integration\n- https://github.com/PortSwigger/burp-teamcity-integration/blob/4fc37ab14575ab9b54cf27e8ecac0923fa1ed3e0/pom.xml#L11-L22\n\n##### Jenkins Integration\n\n- https://github.com/PortSwigger/burp-jenkins-integration/blob/0151b131807d46ef0b55b172a1f23f988cd27bac/pom.xml#L17-L29\n\n#### Insecure Upload\n\nInsecure upload of artifacts is pretty much always accompanied by credentials. Since these credentials are sent over HTTP, they are transmitted in plaintext and should be considered compromised.\n\n##### Jenkins Integration\n - https://github.com/PortSwigger/burp-jenkins-integration/blob/0151b131807d46ef0b55b172a1f23f988cd27bac/pom.xml#L61-L66\n\n### Fix and Public Disclosure\n\nAt a minimum, all of these code locations where artifacts are downloaded from an untrusted source needs to be fixed. Previous releases should be rebuilt with the fix applied. The checksum of the released artifacts and artifacts built in a trusted environment should be made. If the checksums match, you can be certain that they weren't compromised.\n\nIf the checksums don't match, indicating a compromised artifact, CVE numbers need to be issued for the potentially malicious artifacts.\n\nThe ability to check if checksums match assume that these projects have [reproducible builds](https://en.wikipedia.org/wiki/Reproducible_builds).\n\n## Steps To Reproduce:\n\n  1. Cone the Impacted Project\n  2. Change this line in Dilettante so it is targeting the repository used in the build.\n       https://github.com/mveytsman/dilettante/blob/master/dilettante.py#L143\n  3. Start Dilettante on your local machine.\n  4. Proxy the HTTP traffic for the build through Dilettante\n  5. Execute the Build's tests.\n  6. You should be greeted with the image of a cat.\n\n\n## Other Places to Look\n\nGiven how widely I'm finding this vulnerability externally, I'd advise that the Port Swigger Security team take some time to also analyze their internal infrastructure for similar vulnerabilities.\n\n**This responsible disclosure follows [Google's 90-day vulnerability disclosure policy](https://www.google.com/about/appsecurity/) (I'm not an employee of Google, I just like their policy).**\n\n## Impact\n\nBy insecurely downloading code over an untrusted connection HTTP and executing the untrusted code inside of these JAR files as part of the unit/integration tests before a release opens these artifacts up to being maliciously compromised.\n\nRemote code execution on a production server. Malicious compromise of build artifacts.","vulnerability_information_html":"\u003cp\u003e\u003ca href=\"/redirect?url=https%3A%2F%2Fcwe.mitre.org%2Fdata%2Fdefinitions%2F829.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eCWE-829: Inclusion of Functionality from Untrusted Control Sphere\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"/redirect?url=https%3A%2F%2Fcwe.mitre.org%2Fdata%2Fdefinitions%2F494.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eCWE-494: Download of Code Without Integrity Check\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003ePortSwigger maintains several Open Source Projects under the \u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2FPortSwigger\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ePortSwigger GitHub organization\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e. Some of these projects contain build files that indicate that some of these projects are resolving dependencies over HTTP instead of HTTPS. This allows these artifacts to be potentially MITMed to maliciously compromise them and infect the build artifacts that are produced. Additionally, if any of these JARs or other dependencies were compromised, any developers or production servers using these could continue to be infected past updating to fix this.\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eDescription:\u003c/strong\u003e\u003c/p\u003e\n\n\u003cp\u003eThis attack leverages the build infrastructure loading dependencies over HTTP without any other sort of integrity check to allow them to be maliciously compromised.\u003c/p\u003e\n\n\u003ch3 id=\"this-isn-t-just-theoretical\"\u003eThis isn\u0026#39;t just theoretical\u003c/h3\u003e\n\n\u003cp\u003ePOC code has existed since 2014 to maliciously compromise a JAR file inflight.\u003cbr\u003e\nSee:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e\u003ca title=\"https://max.computer/blog/how-to-take-over-the-computer-of-any-java-or-clojure-or-scala-developer/\" href=\"/redirect?url=https%3A%2F%2Fmax.computer%2Fblog%2Fhow-to-take-over-the-computer-of-any-java-or-clojure-or-scala-developer%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://max.computer/blog/how-to-take-over-the-computer-of-any-java-or-clojure-or-scala-developer/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca title=\"https://github.com/mveytsman/dilettante\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fmveytsman%2Fdilettante\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/mveytsman/dilettante\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch3 id=\"mitm-attacks-increasingly-common\"\u003eMITM Attacks Increasingly Common\u003c/h3\u003e\n\n\u003cp\u003eSee:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e\u003ca title=\"https://serverfault.com/a/153065\" href=\"/redirect?url=https%3A%2F%2Fserverfault.com%2Fa%2F153065\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://serverfault.com/a/153065\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca title=\"https://security.stackexchange.com/a/12050\" href=\"/redirect?url=https%3A%2F%2Fsecurity.stackexchange.com%2Fa%2F12050\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://security.stackexchange.com/a/12050\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"/redirect?url=https%3A%2F%2Fthenextweb.com%2Finsights%2F2017%2F12%2F11%2Fcomcast-continues-to-inject-its-own-code-into-websites-you-visit\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eComcast continues to inject its own code into websites you visit\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e (over HTTP)\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch3 id=\"source-locations\"\u003eSource Locations\u003c/h3\u003e\n\n\u003ch4 id=\"insecure-download\"\u003eInsecure Download\u003c/h4\u003e\n\n\u003ch5 id=\"teamcity-integration\"\u003eTeamCity Integration\u003c/h5\u003e\n\n\u003cul\u003e\n\u003cli\u003e\u003ca title=\"https://github.com/PortSwigger/burp-teamcity-integration/blob/4fc37ab14575ab9b54cf27e8ecac0923fa1ed3e0/pom.xml#L11-L22\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2FPortSwigger%2Fburp-teamcity-integration%2Fblob%2F4fc37ab14575ab9b54cf27e8ecac0923fa1ed3e0%2Fpom.xml%23L11-L22\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/PortSwigger/burp-teamcity-integration/blob/4fc37ab14575ab9b54cf27e8ecac0923fa1ed3e0/pom.xml#L11-L22\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch5 id=\"jenkins-integration\"\u003eJenkins Integration\u003c/h5\u003e\n\n\u003cul\u003e\n\u003cli\u003e\u003ca title=\"https://github.com/PortSwigger/burp-jenkins-integration/blob/0151b131807d46ef0b55b172a1f23f988cd27bac/pom.xml#L17-L29\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2FPortSwigger%2Fburp-jenkins-integration%2Fblob%2F0151b131807d46ef0b55b172a1f23f988cd27bac%2Fpom.xml%23L17-L29\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/PortSwigger/burp-jenkins-integration/blob/0151b131807d46ef0b55b172a1f23f988cd27bac/pom.xml#L17-L29\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch4 id=\"insecure-upload\"\u003eInsecure Upload\u003c/h4\u003e\n\n\u003cp\u003eInsecure upload of artifacts is pretty much always accompanied by credentials. Since these credentials are sent over HTTP, they are transmitted in plaintext and should be considered compromised.\u003c/p\u003e\n\n\u003ch5 id=\"jenkins-integration\"\u003eJenkins Integration\u003c/h5\u003e\n\n\u003cul\u003e\n\u003cli\u003e\u003ca title=\"https://github.com/PortSwigger/burp-jenkins-integration/blob/0151b131807d46ef0b55b172a1f23f988cd27bac/pom.xml#L61-L66\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2FPortSwigger%2Fburp-jenkins-integration%2Fblob%2F0151b131807d46ef0b55b172a1f23f988cd27bac%2Fpom.xml%23L61-L66\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/PortSwigger/burp-jenkins-integration/blob/0151b131807d46ef0b55b172a1f23f988cd27bac/pom.xml#L61-L66\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch3 id=\"fix-and-public-disclosure\"\u003eFix and Public Disclosure\u003c/h3\u003e\n\n\u003cp\u003eAt a minimum, all of these code locations where artifacts are downloaded from an untrusted source needs to be fixed. Previous releases should be rebuilt with the fix applied. The checksum of the released artifacts and artifacts built in a trusted environment should be made. If the checksums match, you can be certain that they weren\u0026#39;t compromised.\u003c/p\u003e\n\n\u003cp\u003eIf the checksums don\u0026#39;t match, indicating a compromised artifact, CVE numbers need to be issued for the potentially malicious artifacts.\u003c/p\u003e\n\n\u003cp\u003eThe ability to check if checksums match assume that these projects have \u003ca href=\"/redirect?url=https%3A%2F%2Fen.wikipedia.org%2Fwiki%2FReproducible_builds\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ereproducible builds\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e.\u003c/p\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps To Reproduce:\u003c/h2\u003e\n\n\u003col\u003e\n\u003cli\u003eCone the Impacted Project\u003c/li\u003e\n\u003cli\u003eChange this line in Dilettante so it is targeting the repository used in the build.\n   \u003ca title=\"https://github.com/mveytsman/dilettante/blob/master/dilettante.py#L143\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fmveytsman%2Fdilettante%2Fblob%2Fmaster%2Fdilettante.py%23L143\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/mveytsman/dilettante/blob/master/dilettante.py#L143\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003eStart Dilettante on your local machine.\u003c/li\u003e\n\u003cli\u003eProxy the HTTP traffic for the build through Dilettante\u003c/li\u003e\n\u003cli\u003eExecute the Build\u0026#39;s tests.\u003c/li\u003e\n\u003cli\u003eYou should be greeted with the image of a cat.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003ch2 id=\"other-places-to-look\"\u003eOther Places to Look\u003c/h2\u003e\n\n\u003cp\u003eGiven how widely I\u0026#39;m finding this vulnerability externally, I\u0026#39;d advise that the Port Swigger Security team take some time to also analyze their internal infrastructure for similar vulnerabilities.\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eThis responsible disclosure follows \u003ca href=\"/redirect?url=https%3A%2F%2Fwww.google.com%2Fabout%2Fappsecurity%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eGoogle\u0026#39;s 90-day vulnerability disclosure policy\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e (I\u0026#39;m not an employee of Google, I just like their policy).\u003c/strong\u003e\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eBy insecurely downloading code over an untrusted connection HTTP and executing the untrusted code inside of these JAR files as part of the unit/integration tests before a release opens these artifacts up to being maliciously compromised.\u003c/p\u003e\n\n\u003cp\u003eRemote code execution on a production server. Malicious compromise of build artifacts.\u003c/p\u003e\n","bounty_amount":"1000.0","formatted_bounty":"$1,000","weakness":{"id":30,"name":"Man-in-the-Middle"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2019-07-10T18:59:44.852Z","allow_singular_disclosure_after":-46437073.425816834,"singular_disclosure_allowed":true,"vote_count":128,"voters":["k0z3r0","ikuamike","karma7","foobar7","str0k1rch","spam404","base_64","mik317","sameerphad72","th4nu_0x0","and 118 more..."],"severity":{"rating":"medium","author_type":"Team"},"structured_scope":{"databaseId":14056,"asset_type":"DOWNLOADABLE_EXECUTABLES","asset_identifier":"Burp Suite Enterprise Edition","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":4276217,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for your report, we'll take a look and update you when we have more information.","markdown_message":"\u003cp\u003eThanks for your report, we\u0026#39;ll take a look and update you when we have more information.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-03-07T16:31:59.799Z","updated_at":"2019-03-07T16:31:59.799Z","actor":{"username":"albinowax","cleared":true,"url":"/albinowax","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/056/414/9d843d496965d8c0e710de3867a41720c1577dc4_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"portswigger","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4276335,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2019-03-07T16:50:33.870Z","updated_at":"2019-03-07T16:50:33.870Z","additional_data":{"old_title":"[PortSwigger Open Source] Releases were \u0026 are built/executed/tested/released in the context of insecure/untrusted code","new_title":"Build fetches jars over HTTP"},"actor":{"username":"albinowax","cleared":true,"url":"/albinowax","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/056/414/9d843d496965d8c0e710de3867a41720c1577dc4_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"portswigger","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4276360,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Nice catch, we'll get this fixed and get back to you.","markdown_message":"\u003cp\u003eNice catch, we\u0026#39;ll get this fixed and get back to you.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-03-07T16:54:34.284Z","updated_at":"2019-03-07T16:54:34.284Z","actor":{"username":"albinowax","cleared":true,"url":"/albinowax","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/056/414/9d843d496965d8c0e710de3867a41720c1577dc4_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"portswigger","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4329243,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Our internal build systems are not vulnerable to this due to other measures but we obviously don't want to expose customers doing their own builds to MITM attacks.\n\nWe've now fixed the Jenkins downloads to use HTTPS. Unfortunately jetbrains' repo uses a self-signed certificate, but we've asked them to fix it.","markdown_message":"\u003cp\u003eOur internal build systems are not vulnerable to this due to other measures but we obviously don\u0026#39;t want to expose customers doing their own builds to MITM attacks.\u003c/p\u003e\n\n\u003cp\u003eWe\u0026#39;ve now fixed the Jenkins downloads to use HTTPS. Unfortunately jetbrains\u0026#39; repo uses a self-signed certificate, but we\u0026#39;ve asked them to fix it.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-03-15T11:01:12.892Z","updated_at":"2019-03-15T11:01:12.892Z","actor":{"username":"albinowax","cleared":true,"url":"/albinowax","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/056/414/9d843d496965d8c0e710de3867a41720c1577dc4_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"portswigger","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4331717,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I've been in contact with Jetbrains about their infrastructure as well for other reasons. I hadn't spotted that http://repository.jetbrains.com was using a self-signed cert. Thanks for reporting that issue to them.","markdown_message":"\u003cp\u003eI\u0026#39;ve been in contact with Jetbrains about their infrastructure as well for other reasons. I hadn\u0026#39;t spotted that \u003ca title=\"http://repository.jetbrains.com\" href=\"/redirect?url=http%3A%2F%2Frepository.jetbrains.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://repository.jetbrains.com\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e was using a self-signed cert. Thanks for reporting that issue to them.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-03-15T16:48:58.810Z","updated_at":"2019-03-15T16:48:58.810Z","actor":{"username":"jlleitschuh","cleared":false,"url":"/jlleitschuh","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/388/267/887b2ef55debfc7b243bdf563d314329cf750468_original.JPG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"portswigger","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4331742,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@albinowax You're still insecurely uploading your release artifacts here for the burp-jenkins-integration:\n\nhttps://github.com/PortSwigger/burp-jenkins-integration/blob/fb208b9323d07708cbe998f52dd6be7ca57410ba/pom.xml#L64\n\nIf there are credentials associated with that upload (usually in a CI server or release engineers `~/.m2/settings.xml` file), those credentials should be considered compromised.","markdown_message":"\u003cp\u003e\u003ca href=\"/albinowax\"\u003e@albinowax\u003c/a\u003e You\u0026#39;re still insecurely uploading your release artifacts here for the burp-jenkins-integration:\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"https://github.com/PortSwigger/burp-jenkins-integration/blob/fb208b9323d07708cbe998f52dd6be7ca57410ba/pom.xml#L64\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2FPortSwigger%2Fburp-jenkins-integration%2Fblob%2Ffb208b9323d07708cbe998f52dd6be7ca57410ba%2Fpom.xml%23L64\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/PortSwigger/burp-jenkins-integration/blob/fb208b9323d07708cbe998f52dd6be7ca57410ba/pom.xml#L64\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eIf there are credentials associated with that upload (usually in a CI server or release engineers \u003ccode\u003e~/.m2/settings.xml\u003c/code\u003e file), those credentials should be considered compromised.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-03-15T16:54:01.642Z","updated_at":"2019-03-15T16:54:01.642Z","actor":{"username":"jlleitschuh","cleared":false,"url":"/jlleitschuh","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/388/267/887b2ef55debfc7b243bdf563d314329cf750468_original.JPG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"portswigger","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4331783,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Yep we're aware, that's why we haven't marked this issue as resolved yet.","markdown_message":"\u003cp\u003eYep we\u0026#39;re aware, that\u0026#39;s why we haven\u0026#39;t marked this issue as resolved yet.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-03-15T16:59:20.832Z","updated_at":"2019-03-15T16:59:20.832Z","actor":{"username":"albinowax","cleared":true,"url":"/albinowax","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/056/414/9d843d496965d8c0e710de3867a41720c1577dc4_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"portswigger","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4365853,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"For the JetBrains URLs we've switched to https://download.jetbrains.com/ which has a valid cert.\n\nThe upload code was unused by the build process so there's no vulnerability there, but we've deleted it for clarity: https://github.com/PortSwigger/burp-jenkins-integration/commit/2a8124795c80f07065536556092ba3781b248c77\n\nThat should mean we're fully fixed now - do you agree?","markdown_message":"\u003cp\u003eFor the JetBrains URLs we\u0026#39;ve switched to \u003ca title=\"https://download.jetbrains.com/\" href=\"/redirect?url=https%3A%2F%2Fdownload.jetbrains.com%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://download.jetbrains.com/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e which has a valid cert.\u003c/p\u003e\n\n\u003cp\u003eThe upload code was unused by the build process so there\u0026#39;s no vulnerability there, but we\u0026#39;ve deleted it for clarity: \u003ca title=\"https://github.com/PortSwigger/burp-jenkins-integration/commit/2a8124795c80f07065536556092ba3781b248c77\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2FPortSwigger%2Fburp-jenkins-integration%2Fcommit%2F2a8124795c80f07065536556092ba3781b248c77\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/PortSwigger/burp-jenkins-integration/commit/2a8124795c80f07065536556092ba3781b248c77\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eThat should mean we\u0026#39;re fully fixed now - do you agree?\u003c/p\u003e\n","automated_response":false,"created_at":"2019-03-21T11:48:04.219Z","updated_at":"2019-03-21T11:48:04.219Z","actor":{"username":"albinowax","cleared":true,"url":"/albinowax","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/056/414/9d843d496965d8c0e710de3867a41720c1577dc4_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"portswigger","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4367426,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @albinowax,\n\nI think that should mean that you are fully fixed. I just took another sweep through your Github repositories and it looks like this has been resolved.\n\nHave released versions of the software been audited to ensure they weren't maliciously compromised at build time?","markdown_message":"\u003cp\u003eHi \u003ca href=\"/albinowax\"\u003e@albinowax\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eI think that should mean that you are fully fixed. I just took another sweep through your Github repositories and it looks like this has been resolved.\u003c/p\u003e\n\n\u003cp\u003eHave released versions of the software been audited to ensure they weren\u0026#39;t maliciously compromised at build time?\u003c/p\u003e\n","automated_response":false,"created_at":"2019-03-21T16:48:43.354Z","updated_at":"2019-03-21T16:48:43.354Z","actor":{"username":"jlleitschuh","cleared":false,"url":"/jlleitschuh","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/388/267/887b2ef55debfc7b243bdf563d314329cf750468_original.JPG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"portswigger","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4384604,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2019-03-25T11:17:54.162Z","updated_at":"2019-03-25T11:17:54.162Z","additional_data":{"old_severity":"High (8.1)","new_severity":"Medium","old_severity_id":308685,"new_severity_id":322042},"actor":{"username":"albinowax","cleared":true,"url":"/albinowax","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/056/414/9d843d496965d8c0e710de3867a41720c1577dc4_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"portswigger","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4384784,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"We use local clean copies of the relevant jars, so this attack wasn't a threat against our own infrastructure or releases. We're classifying this vulnerability as medium impact due to the MITM requirement, and potential targets being limited to the few clients building the code themselves. ","markdown_message":"\u003cp\u003eWe use local clean copies of the relevant jars, so this attack wasn\u0026#39;t a threat against our own infrastructure or releases. We\u0026#39;re classifying this vulnerability as medium impact due to the MITM requirement, and potential targets being limited to the few clients building the code themselves. \u003c/p\u003e\n","automated_response":false,"created_at":"2019-03-25T11:25:40.708Z","updated_at":"2019-03-25T11:25:40.708Z","actor":{"username":"albinowax","cleared":true,"url":"/albinowax","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/056/414/9d843d496965d8c0e710de3867a41720c1577dc4_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"jlleitschuh","url":"/jlleitschuh"},"genius_execution_id":null,"team_handle":"portswigger","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4384859,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"This was a good finding, many thanks for helping us secure our customers.","markdown_message":"\u003cp\u003eThis was a good finding, many thanks for helping us secure our customers.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-03-25T11:29:19.350Z","updated_at":"2019-03-25T11:29:19.350Z","actor":{"url":"/portswigger","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/252/60e8778f4f1fee57ea2b164a7d2ec1e2d2dd7bc8_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"PortSwigger Web Security"}},"bounty_amount":"1000.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"portswigger","collaborator":{"username":"jlleitschuh","url":"/jlleitschuh"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4385589,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@albinowax @portswigger Thank you so much! I'm working on a Medium write up that describes the breadth of this industry wide security vulnerability. I'll send you a link to it here once it's public.\nAgain, thank you so much!","markdown_message":"\u003cp\u003e\u003ca href=\"/albinowax\"\u003e@albinowax\u003c/a\u003e \u003ca href=\"/portswigger\"\u003e@portswigger\u003c/a\u003e Thank you so much! I\u0026#39;m working on a Medium write up that describes the breadth of this industry wide security vulnerability. I\u0026#39;ll send you a link to it here once it\u0026#39;s public.\u003cbr\u003e\nAgain, thank you so much!\u003c/p\u003e\n","automated_response":false,"created_at":"2019-03-25T12:50:28.615Z","updated_at":"2019-03-25T12:50:28.615Z","actor":{"username":"jlleitschuh","cleared":false,"url":"/jlleitschuh","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/388/267/887b2ef55debfc7b243bdf563d314329cf750468_original.JPG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"portswigger","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5026956,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi PortSwigger team!\n\nBelow is a link to a draft of my publication that will be made June 10th, 2019.\nhttps://medium.com/@jonathan.leitschuh/want-to-take-over-the-java-ecosystem-all-you-need-is-a-mitm-1fc329d898fb\n\nThanks,\nJonathan Leitschuh","markdown_message":"\u003cp\u003eHi PortSwigger team!\u003c/p\u003e\n\n\u003cp\u003eBelow is a link to a draft of my publication that will be made June 10th, 2019.\u003cbr\u003e\n\u003ca title=\"https://medium.com/@jonathan.leitschuh/want-to-take-over-the-java-ecosystem-all-you-need-is-a-mitm-1fc329d898fb\" href=\"/redirect?url=https%3A%2F%2Fmedium.com%2F%40jonathan.leitschuh%2Fwant-to-take-over-the-java-ecosystem-all-you-need-is-a-mitm-1fc329d898fb\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://medium.com/@jonathan.leitschuh/want-to-take-over-the-java-ecosystem-all-you-need-is-a-mitm-1fc329d898fb\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eThanks,\u003cbr\u003e\nJonathan Leitschuh\u003c/p\u003e\n","automated_response":false,"created_at":"2019-06-07T16:31:49.299Z","updated_at":"2019-06-07T16:31:49.299Z","actor":{"username":"jlleitschuh","cleared":false,"url":"/jlleitschuh","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/388/267/887b2ef55debfc7b243bdf563d314329cf750468_original.JPG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"portswigger","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5043786,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi PortSwigger team,\n\nThe blog post is now public here. Feel free to share this to your twitter feed/blog.\n\nhttps://medium.com/@jonathan.leitschuh/want-to-take-over-the-java-ecosystem-all-you-need-is-a-mitm-1fc329d898fb?source=friends_link\u0026sk=3c99970c55a899ad9ef41f126efcde0e\n\nThanks again and pleasure working with you!\n\n---- \n\nFormally requesting public disclosure of this HackerOne report.","markdown_message":"\u003cp\u003eHi PortSwigger team,\u003c/p\u003e\n\n\u003cp\u003eThe blog post is now public here. Feel free to share this to your twitter feed/blog.\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"https://medium.com/@jonathan.leitschuh/want-to-take-over-the-java-ecosystem-all-you-need-is-a-mitm-1fc329d898fb?source=friends_link\u0026amp;sk=3c99970c55a899ad9ef41f126efcde0e\" href=\"/redirect?url=https%3A%2F%2Fmedium.com%2F%40jonathan.leitschuh%2Fwant-to-take-over-the-java-ecosystem-all-you-need-is-a-mitm-1fc329d898fb%3Fsource%3Dfriends_link%26sk%3D3c99970c55a899ad9ef41f126efcde0e\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://medium.com/@jonathan.leitschuh/want-to-take-over-the-java-ecosystem-all-you-need-is-a-mitm-1fc329d898fb?source=friends_link\u0026amp;sk=3c99970c55a899ad9ef41f126efcde0e\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eThanks again and pleasure working with you!\u003c/p\u003e\n\n\u003chr\u003e\n\n\u003cp\u003eFormally requesting public disclosure of this HackerOne report.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-06-10T18:43:41.129Z","updated_at":"2019-06-10T18:43:41.129Z","actor":{"username":"jlleitschuh","cleared":false,"url":"/jlleitschuh","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/388/267/887b2ef55debfc7b243bdf563d314329cf750468_original.JPG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"portswigger","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5044196,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"To request disclosure, you'll need to use the 'Request disclosure' option on the drop down.","markdown_message":"\u003cp\u003eTo request disclosure, you\u0026#39;ll need to use the \u0026#39;Request disclosure\u0026#39; option on the drop down.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-06-10T18:58:31.924Z","updated_at":"2019-06-10T18:58:31.924Z","actor":{"username":"albinowax","cleared":true,"url":"/albinowax","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/056/414/9d843d496965d8c0e710de3867a41720c1577dc4_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"portswigger","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5044201,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-06-10T18:59:44.801Z","updated_at":"2019-06-10T18:59:44.801Z","first_to_agree":true,"actor":{"username":"jlleitschuh","cleared":false,"url":"/jlleitschuh","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/388/267/887b2ef55debfc7b243bdf563d314329cf750468_original.JPG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"portswigger","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5044208,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-06-10T19:01:06.778Z","updated_at":"2019-06-10T19:01:06.778Z","actor":{"username":"albinowax","cleared":true,"url":"/albinowax","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/056/414/9d843d496965d8c0e710de3867a41720c1577dc4_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"portswigger","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5044209,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-06-10T19:01:06.864Z","updated_at":"2019-06-10T19:01:06.864Z","actor":{"username":"albinowax","cleared":true,"url":"/albinowax","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/056/414/9d843d496965d8c0e710de3867a41720c1577dc4_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"portswigger","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"id":16582,"category":"researcher","content":"This report was part of a 4 month research project into the general supply chain security of the JVM ecosystem. This vulnerability impacted organizations like the Apache Foundation, Eclipse Foundation, Elastic Search, JetBrains, Jenkins, Oracle, Google, Gradle and many other open source projects including both the Kotlin and Groovy compiler.\n\nThe full blog post about this research can be found here: [Want to take over the Java ecosystem? All you need is a MITM!](https://medium.com/@jonathan.leitschuh/want-to-take-over-the-java-ecosystem-all-you-need-is-a-mitm-1fc329d898fb?source=friends_link\u0026sk=3c99970c55a899ad9ef41f126efcde0e)\n\nIn the case of BurpSuite, this vulnerability impacted the build infrastructure for their TeamCity and Jenkins Integration plugins.","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eThis report was part of a 4 month research project into the general supply chain security of the JVM ecosystem. This vulnerability impacted organizations like the Apache Foundation, Eclipse Foundation, Elastic Search, JetBrains, Jenkins, Oracle, Google, Gradle and many other open source projects including both the Kotlin and Groovy compiler.\u003c/p\u003e\n\n\u003cp\u003eThe full blog post about this research can be found here: \u003ca href=\"/redirect?url=https%3A%2F%2Fmedium.com%2F%40jonathan.leitschuh%2Fwant-to-take-over-the-java-ecosystem-all-you-need-is-a-mitm-1fc329d898fb%3Fsource%3Dfriends_link%26sk%3D3c99970c55a899ad9ef41f126efcde0e\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eWant to take over the Java ecosystem? All you need is a MITM!\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eIn the case of BurpSuite, this vulnerability impacted the build infrastructure for their TeamCity and Jenkins Integration plugins.\u003c/p\u003e\n"}]}