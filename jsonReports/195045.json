{"id":195045,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xOTUwNDU=","url":"https://hackerone.com/reports/195045","title":"Set Cookie Via SVG","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2017-01-01T13:45:05.055Z","submitted_at":"2017-01-01T13:45:05.055Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"proabiral","url":"/proabiral","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/SgUoabqs214KtgPXuTbModLh/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":8906,"url":"https://hackerone.com/open-xchange","handle":"open-xchange","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/JtYLEsu5yRZxGitSmAjeAFtK/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/JtYLEsu5yRZxGitSmAjeAFtK/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Open-Xchange","twitter_handle":"openxchange","website":"https://www.open-xchange.com/","about":"Messaging, collaboration and office productivity software for service providers"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2017-07-03T06:39:11.611Z","bug_reporter_agreed_on_going_public_at":"2017-06-03T06:39:04.112Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Summary:\n========\nAn attacker could set any cookie to the victim via svg file that he uploads as his profile picture.\n\nSteps to reproduce:\n==============\n1. My contact Detail.\n2. Upload the given svg file as profile picture and save.\n3. Logout and Clear all the cookie.\n4. Login with victim's account.\n5. Try searching for attack's email. The cookie will be set when chrome's logo is displayed.\n\nImpact:\n==========\nAttacker can set an cookie s/he want to victim's browser.\n","vulnerability_information_html":"\u003ch1 id=\"summary\"\u003eSummary:\u003c/h1\u003e\n\n\u003cp\u003eAn attacker could set any cookie to the victim via svg file that he uploads as his profile picture.\u003c/p\u003e\n\n\u003ch1 id=\"steps-to-reproduce\"\u003eSteps to reproduce:\u003c/h1\u003e\n\n\u003col\u003e\n\u003cli\u003eMy contact Detail.\u003c/li\u003e\n\u003cli\u003eUpload the given svg file as profile picture and save.\u003c/li\u003e\n\u003cli\u003eLogout and Clear all the cookie.\u003c/li\u003e\n\u003cli\u003eLogin with victim\u0026#39;s account.\u003c/li\u003e\n\u003cli\u003eTry searching for attack\u0026#39;s email. The cookie will be set when chrome\u0026#39;s logo is displayed.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003ch1 id=\"impact\"\u003eImpact:\u003c/h1\u003e\n\n\u003cp\u003eAttacker can set an cookie s/he want to victim\u0026#39;s browser.\u003c/p\u003e\n","bounty_amount":"250.0","formatted_bounty":"$250","weakness":{"id":57,"name":"Violation of Secure Design Principles"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":148473,"file_name":"Google_Chrome_logo_2011.svg","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/148/473/332a4add8bd5948c4a968c292a8de99a5aa5bd43/Google_Chrome_logo_2011.svg?response-content-disposition=attachment%3B%20filename%3D%22Google_Chrome_logo_2011.svg%22%3B%20filename%2A%3DUTF-8%27%27Google_Chrome_logo_2011.svg\u0026response-content-type=application%2Foctet-stream\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQWS7SVX5C%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T045110Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCICTltBX5kZS78yzw3IUUt%2Fa035OzgQ2vLu8U1ZxOKGilAiEAqT8jxmclsgLwaEL5fi7C70iqLwP7J3SWF5ypfn%2Fn%2BdUqtAMIVBABGgwwMTM2MTkyNzQ4NDkiDGRWkSc4Hmgq8mMXKCqRA0Pq%2Bzgh6dptjyRB4GzYO9sir45RVm0RyvFSB8lDBYTBiDIVL0nR3Ah5epkHqGDZZEh0G%2BfKYu%2FWpfgxJl7qllLzKg%2BOA0izVs9KPgQdxk0VWwW%2FPKL2ZT4v%2FSNRvF7rPUbZ7WhGTZqx0%2BinzKM%2BO6lDyXZKNKMzhjRnIFdI7Th01c4ma39imTXQDmxc%2FNzHFK40lrkAbTZoTlcq%2BsnIcIRSB0h4GHasXhR5OHx8rifULR7sVKHDcZMCzSYjrtagaKs9I81LEzlSbEGxIQar2MK%2BZBwmpT57aT%2F1nIOoa%2FlH5nfP4Ihcv4Mqfp19pFx8mlVoMe%2FTEx0pqNuC4lGQXowSDJKBcSjrYM6ouddZWfwY6R4O8X69XqZawGSrmBiXyAVG%2BDj895xbDJhiOXMvqkvSfsEzIfvcaHAzshzNZjFT3yiN4h81wfUF3QuLc6DHCTt1MPDYiUB8I7UCQ8wJxW4pg3xTnHqSwUeqww3YY8RFfsgvfp9PzGJ1s4vReFrzuzYVanpT22oz4w33z29yMPmMMO21qv8FOusBOsYr4rmEPt9wYTc2WNI63vM9u2VUhGNHafH2%2Fh3q6i%2BwJ0u2HLCQd44aqHfWZ%2Bc8hzInEQnRNrZf7owYuE4cHiraWaOsNJjfOEJBZu5nzzun4JSk7801NfOqa1zcgLMWOwyWJCtalb9fGn6qhwTWTBMzsOFHc661yyW%2FaqejCIRf6%2BwNOGhO8kc%2BEhEIq0iydp5k4rlMRKlFJPFlphrQYGeZgYr9TM%2FVgHlN%2Bx4Oxtcg1UwCGXMGiV%2BqXzeMEmO%2FdxKETdJJvF%2BEaJSsF0r1i7s8g61czrgyi9MKMpia%2Fg6ovVFkrvHOejV96g%3D%3D\u0026X-Amz-Signature=d2659b4e1c27edd5cfcf538b32a7a42a99e15477fca3322ad2f60fa91ecc6cbf","file_size":5661,"type":"image/svg+xml"}],"allow_singular_disclosure_at":"2017-07-03T06:39:04.226Z","allow_singular_disclosure_after":-110153526.34176843,"singular_disclosure_allowed":true,"vote_count":28,"voters":["inhibitor181","bogdantcaciuc","proabiral","jon_bottarini","skavans","bugdiscloseguys","ankitsingh","brodie_codie","gamliel","eveeez","and 18 more..."],"severity":{"rating":"medium","author_type":"User"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1393731,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Sorry I forgot to mention that cookie `aappp=bbqqq` will be injected as following code is present in supplied svg file:\n`\n\u003cforeignObject\u003e\n\t\t\t\u003chtml xmlns='http://www.w3.org/1999/xhtml'\u003e\n\t\t\t\u003cmeta http-equiv='Set-Cookie' content='aappp=bbqqq' /\u003e\n\t\t\t\u003c/html\u003e\n\t\t\t\u003c/foreignObject\u003e\n`\nHere, `meta` tag is used to set cookie and anything value of attribute `content` is set as cookie.\nIn my opinion this is a serious issue, as attacker could set any cookie s/he wants. This may lead to attack scenario like Denial of Service via Cookie-bomb.\n[Reference of Hackerone](https://hackerone.com/reports/97292)\n[Reference of Twitter](http://blog.innerht.ml/overflow-trilogy/)\nThe attack can be made more serious by setting meta tag as `\u003cmeta http-equiv=\"set-cookie\" content=\"malaciousCookie=test; expires=Sat, 25-Nov-2023 12:00:00 GMT; domain=.open-xchange.com\"/\u003e`. The user won't be able to use OX unless he manually cleans cookie.\nIf you need more info please feel free to contact me.\nRegards Abiral","markdown_message":"\u003cp\u003eSorry I forgot to mention that cookie \u003ccode\u003eaappp=bbqqq\u003c/code\u003e will be injected as following code is present in supplied svg file:\u003cbr\u003e\n\u003ccode\u003e\u003cbr\u003e\n\u0026lt;foreignObject\u0026gt;\u003cbr\u003e\n            \u0026lt;html xmlns=\u0026#39;http://www.w3.org/1999/xhtml\u0026#39;\u0026gt;\u003cbr\u003e\n            \u0026lt;meta http-equiv=\u0026#39;Set-Cookie\u0026#39; content=\u0026#39;aappp=bbqqq\u0026#39; /\u0026gt;\u003cbr\u003e\n            \u0026lt;/html\u0026gt;\u003cbr\u003e\n            \u0026lt;/foreignObject\u0026gt;\u003cbr\u003e\n\u003c/code\u003e\u003cbr\u003e\nHere, \u003ccode\u003emeta\u003c/code\u003e tag is used to set cookie and anything value of attribute \u003ccode\u003econtent\u003c/code\u003e is set as cookie.\u003cbr\u003e\nIn my opinion this is a serious issue, as attacker could set any cookie s/he wants. This may lead to attack scenario like Denial of Service via Cookie-bomb.\u003cbr\u003e\n\u003ca href=\"https://hackerone.com/reports/97292\"\u003eReference of Hackerone\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"/redirect?url=http%3A%2F%2Fblog.innerht.ml%2Foverflow-trilogy%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eReference of Twitter\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nThe attack can be made more serious by setting meta tag as \u003ccode\u003e\u0026lt;meta http-equiv=\u0026quot;set-cookie\u0026quot; content=\u0026quot;malaciousCookie=test; expires=Sat, 25-Nov-2023 12:00:00 GMT; domain=.open-xchange.com\u0026quot;/\u0026gt;\u003c/code\u003e. The user won\u0026#39;t be able to use OX unless he manually cleans cookie.\u003cbr\u003e\nIf you need more info please feel free to contact me.\u003cbr\u003e\nRegards Abiral\u003c/p\u003e\n","automated_response":false,"created_at":"2017-01-01T18:19:05.000Z","updated_at":"2017-01-01T18:19:05.000Z","actor":{"username":"proabiral","cleared":true,"url":"/proabiral","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/SgUoabqs214KtgPXuTbModLh/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1394329,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thanks for reporting this vulnerability to us. We take your feedback very serious and started the process of resolving and delivering a solution to our users. Please note that we will take care about public disclosure of the vulnerability and give our users a chance to update to a fixed version before. Therefor, please handle this finding with discretion until we publicly disclosed it.\n\nWe'll discuss the matter of bounty for this finding soon and will update you shortly. Would you like to be included in our advisories \"researcher credits\"?","markdown_message":"\u003cp\u003eThanks for reporting this vulnerability to us. We take your feedback very serious and started the process of resolving and delivering a solution to our users. Please note that we will take care about public disclosure of the vulnerability and give our users a chance to update to a fixed version before. Therefor, please handle this finding with discretion until we publicly disclosed it.\u003c/p\u003e\n\n\u003cp\u003eWe\u0026#39;ll discuss the matter of bounty for this finding soon and will update you shortly. Would you like to be included in our advisories \u0026quot;researcher credits\u0026quot;?\u003c/p\u003e\n","automated_response":false,"created_at":"2017-01-02T09:42:54.939Z","updated_at":"2017-01-02T09:42:54.939Z","actor":{"username":"mheiland","cleared":false,"url":"/mheiland","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/425JKsXEnCYsDU1VA48SXXZV/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1394385,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for quick reply :D \nInclude me as `Abiral Shrestha`","markdown_message":"\u003cp\u003eThanks for quick reply :D \u003cbr\u003e\nInclude me as \u003ccode\u003eAbiral Shrestha\u003c/code\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2017-01-02T10:45:49.062Z","updated_at":"2017-01-02T10:45:49.062Z","actor":{"username":"proabiral","cleared":true,"url":"/proabiral","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/SgUoabqs214KtgPXuTbModLh/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1398536,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2017-01-04T13:27:06.002Z","updated_at":"2017-01-04T13:27:06.002Z","actor":{"username":"mheiland","cleared":false,"url":"/mheiland","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/425JKsXEnCYsDU1VA48SXXZV/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"proabiral","url":"/proabiral"},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1398537,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2017-01-04T13:27:12.362Z","updated_at":"2017-01-04T13:27:12.362Z","actor":{"url":"/open-xchange","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/JtYLEsu5yRZxGitSmAjeAFtK/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Open-Xchange"}},"bounty_amount":"250.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"open-xchange","collaborator":{"username":"proabiral","url":"/proabiral"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1398728,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks that was quick :D \n\n","markdown_message":"\u003cp\u003eThanks that was quick :D \u003c/p\u003e\n","automated_response":false,"created_at":"2017-01-04T15:02:56.416Z","updated_at":"2017-01-04T15:02:56.416Z","actor":{"username":"proabiral","cleared":true,"url":"/proabiral","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/SgUoabqs214KtgPXuTbModLh/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1727703,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"This was my first bounty !! Would you mind disclosing it !!","markdown_message":"\u003cp\u003eThis was my first bounty !! Would you mind disclosing it !!\u003c/p\u003e\n","automated_response":false,"created_at":"2017-06-03T06:39:04.154Z","updated_at":"2017-06-03T06:39:04.154Z","first_to_agree":true,"actor":{"username":"proabiral","cleared":true,"url":"/proabiral","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/SgUoabqs214KtgPXuTbModLh/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1798463,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-07-03T06:39:11.634Z","updated_at":"2017-07-03T06:39:11.634Z","actor":{"url":"/open-xchange","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/JtYLEsu5yRZxGitSmAjeAFtK/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Open-Xchange"}},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}