{"id":272839,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yNzI4Mzk=","url":"https://hackerone.com/reports/272839","title":"Weak Session ID Implementation - No Session change on Password change","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2017-09-28T21:50:41.561Z","submitted_at":"2017-09-28T21:50:41.561Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"wdem","url":"/wdem","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/089/343/397e0dcac44942e16361d96b0f6ae89a7602aa92_original.jpeg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":2672,"url":"https://hackerone.com/unikrn","handle":"unikrn","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/002/672/c6c2b32746235b372285a9047457642b7b9bc6a1_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/672/c6c2b32746235b372285a9047457642b7b9bc6a1_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Unikrn","twitter_handle":"unikrnco","website":"https://unikrn.com","about":"Win prizes, bet safely and legally on esports and get the best multi-title coverage for fans and fanatics alike!"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-10-05T16:03:13.684Z","bug_reporter_agreed_on_going_public_at":"2017-10-05T14:42:53.592Z","team_member_agreed_on_going_public_at":"2017-10-05T16:03:13.624Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"**Summary:** [Weak session id implementation]\n\n**Description:** [Unikrn does not change session id after password is changed. Reusing same session ids, after password is changed is highly risky. \nExample scenario: Hacker has successfully brute forced the password of a victim and has access to the account. The victim notices that something's off and chooses to change the password of the account. Hacker has still full access to the account, even after the password is changed, because of the working session id that he got from the server when he logged in to the victim's account.]\n\n\n## Steps To Reproduce:\n\n(Add details for how we can reproduce the issue)\n\n  1. [Intercept requests when logged in to unikrn and retrieve current session id]\n  2. [Change the password of the user]\n  3. [Do the step 1 again and compare the session id]\n\n## Supporting Material/References:\n\nIf necessary, check my Proof of Concept video.\n\nhttps://drive.google.com/file/d/0B28KqsVY5jK6aVdTYzg5RTNMcGM/view\n\n","vulnerability_information_html":"\u003cp\u003e\u003cstrong\u003eSummary:\u003c/strong\u003e [Weak session id implementation]\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eDescription:\u003c/strong\u003e [Unikrn does not change session id after password is changed. Reusing same session ids, after password is changed is highly risky. \u003cbr\u003e\nExample scenario: Hacker has successfully brute forced the password of a victim and has access to the account. The victim notices that something\u0026#39;s off and chooses to change the password of the account. Hacker has still full access to the account, even after the password is changed, because of the working session id that he got from the server when he logged in to the victim\u0026#39;s account.]\u003c/p\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps To Reproduce:\u003c/h2\u003e\n\n\u003cp\u003e(Add details for how we can reproduce the issue)\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003e[Intercept requests when logged in to unikrn and retrieve current session id]\u003c/li\u003e\n\u003cli\u003e[Change the password of the user]\u003c/li\u003e\n\u003cli\u003e[Do the step 1 again and compare the session id]\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003ch2 id=\"supporting-material-references\"\u003eSupporting Material/References:\u003c/h2\u003e\n\n\u003cp\u003eIf necessary, check my Proof of Concept video.\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"https://drive.google.com/file/d/0B28KqsVY5jK6aVdTYzg5RTNMcGM/view\" href=\"/redirect?url=https%3A%2F%2Fdrive.google.com%2Ffile%2Fd%2F0B28KqsVY5jK6aVdTYzg5RTNMcGM%2Fview\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://drive.google.com/file/d/0B28KqsVY5jK6aVdTYzg5RTNMcGM/view\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","bounty_amount":"40.0","formatted_bounty":"$40","weakness":{"id":90,"name":"Insufficient Session Expiration"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2017-11-04T14:42:53.659Z","allow_singular_disclosure_after":-99412613.4163195,"singular_disclosure_allowed":true,"vote_count":13,"voters":["jensec","eveeez","r3y","apapedulimu","inet_freedom","luckydivino","japz","shantidoffy","clarckowen_","loveohackerone","and 3 more..."],"severity":{"rating":"medium","author_type":"User"},"structured_scope":{"databaseId":453,"asset_type":"URL","asset_identifier":"unikrn.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":2031947,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Hmm so does the attacker have the same session_id as the victim? If not the attacker session_id will be invalid within 30 seconds already.","markdown_message":"\u003cp\u003eHmm so does the attacker have the same session_id as the victim? If not the attacker session_id will be invalid within 30 seconds already.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-09-29T07:14:53.843Z","updated_at":"2017-09-29T07:14:53.843Z","actor":{"username":"decrypted","cleared":false,"url":"/decrypted","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/035/819/849ab6e942d0608e17e1c98244b240363a4ad9b7_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"unikrn","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2032260,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Yes, after further testing it turns out that hacker has to successfully steal the session id to be able to use the account after password is changed. Still, this is risky. It's recommended that every session id will be renewed after password is changed, since the point is to keep unauthorized users out. If the attacked is able to steal the session id of the user, the hacker will have full control of the account even if the user changes the password of the account.\n\nThe fix should be an easy one. Just renew also the session id of the user who changes the password.","markdown_message":"\u003cp\u003eYes, after further testing it turns out that hacker has to successfully steal the session id to be able to use the account after password is changed. Still, this is risky. It\u0026#39;s recommended that every session id will be renewed after password is changed, since the point is to keep unauthorized users out. If the attacked is able to steal the session id of the user, the hacker will have full control of the account even if the user changes the password of the account.\u003c/p\u003e\n\n\u003cp\u003eThe fix should be an easy one. Just renew also the session id of the user who changes the password.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-09-29T09:55:40.049Z","updated_at":"2017-09-29T09:55:40.049Z","actor":{"username":"wdem","cleared":false,"url":"/wdem","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/089/343/397e0dcac44942e16361d96b0f6ae89a7602aa92_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"unikrn","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2037482,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi!\n\nSo do you agree with me that this is a problem?\n\nThanks!\nWdeM","markdown_message":"\u003cp\u003eHi!\u003c/p\u003e\n\n\u003cp\u003eSo do you agree with me that this is a problem?\u003c/p\u003e\n\n\u003cp\u003eThanks!\u003cbr\u003e\nWdeM\u003c/p\u003e\n","automated_response":false,"created_at":"2017-10-02T10:50:31.280Z","updated_at":"2017-10-02T10:50:31.280Z","actor":{"username":"wdem","cleared":false,"url":"/wdem","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/089/343/397e0dcac44942e16361d96b0f6ae89a7602aa92_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"unikrn","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2045899,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Better now?","markdown_message":"\u003cp\u003eBetter now?\u003c/p\u003e\n","automated_response":false,"created_at":"2017-10-05T13:06:13.220Z","updated_at":"2017-10-05T13:06:13.220Z","actor":{"username":"decrypted","cleared":false,"url":"/decrypted","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/035/819/849ab6e942d0608e17e1c98244b240363a4ad9b7_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"unikrn","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2045913,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Hi!\n\nMuch better. \nThe issue is no longer relevant with the re-login implemented.\n\nThanks!\nWdeM","markdown_message":"\u003cp\u003eHi!\u003c/p\u003e\n\n\u003cp\u003eMuch better. \u003cbr\u003e\nThe issue is no longer relevant with the re-login implemented.\u003c/p\u003e\n\n\u003cp\u003eThanks!\u003cbr\u003e\nWdeM\u003c/p\u003e\n","automated_response":false,"created_at":"2017-10-05T13:18:28.737Z","updated_at":"2017-10-05T13:18:28.737Z","actor":{"username":"wdem","cleared":false,"url":"/wdem","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/089/343/397e0dcac44942e16361d96b0f6ae89a7602aa92_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"unikrn","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2046255,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"thx","markdown_message":"\u003cp\u003ethx\u003c/p\u003e\n","automated_response":false,"created_at":"2017-10-05T14:37:28.658Z","updated_at":"2017-10-05T14:37:28.658Z","actor":{"username":"decrypted","cleared":false,"url":"/decrypted","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/035/819/849ab6e942d0608e17e1c98244b240363a4ad9b7_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"wdem","url":"/wdem"},"genius_execution_id":null,"team_handle":"unikrn","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2046256,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2017-10-05T14:37:40.640Z","updated_at":"2017-10-05T14:37:40.640Z","actor":{"url":"/unikrn","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/672/c6c2b32746235b372285a9047457642b7b9bc6a1_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Unikrn"}},"bounty_amount":"40.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"unikrn","collaborator":{"username":"wdem","url":"/wdem"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2046275,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-10-05T14:42:53.624Z","updated_at":"2017-10-05T14:42:53.624Z","first_to_agree":true,"actor":{"username":"wdem","cleared":false,"url":"/wdem","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/089/343/397e0dcac44942e16361d96b0f6ae89a7602aa92_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"unikrn","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2047040,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Thx!\nPS: we have an internal ticket for better ux, yet safety first!","markdown_message":"\u003cp\u003eThx!\u003cbr\u003e\nPS: we have an internal ticket for better ux, yet safety first!\u003c/p\u003e\n","automated_response":false,"created_at":"2017-10-05T16:03:13.650Z","updated_at":"2017-10-05T16:03:13.650Z","actor":{"username":"decrypted","cleared":false,"url":"/decrypted","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/035/819/849ab6e942d0608e17e1c98244b240363a4ad9b7_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"unikrn","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2047041,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-10-05T16:03:13.704Z","updated_at":"2017-10-05T16:03:13.704Z","actor":{"username":"decrypted","cleared":false,"url":"/decrypted","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/035/819/849ab6e942d0608e17e1c98244b240363a4ad9b7_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"unikrn","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2047045,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2017-10-05T16:03:51.088Z","updated_at":"2017-10-05T16:03:51.088Z","additional_data":{"old_title":"Weak Session ID Implementation","new_title":"Weak Session ID Implementation - No Session change on Password change"},"actor":{"username":"decrypted","cleared":false,"url":"/decrypted","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/035/819/849ab6e942d0608e17e1c98244b240363a4ad9b7_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"unikrn","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}