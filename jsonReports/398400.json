{"id":398400,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zOTg0MDA=","url":"https://hackerone.com/reports/398400","title":"AWS Credentials leaked: access to production database backups, SSL certs and more","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-10-21T07:33:16.000Z","submitted_at":"2016-10-21T07:33:16.000Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"tomdev","url":"/tomdev","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/036/d216c51a25ae9f40651b5859490048ece35ef88f_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":31807,"url":"https://hackerone.com/redact","handle":"redact","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/031/807/3bf790585f65096b99a75d5fc8e1a8a9ad968da1_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/031/807/3bf790585f65096b99a75d5fc8e1a8a9ad968da1_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"profile":{"name":"██████","twitter_handle":"","website":"","about":"██████ "}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":true,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2018-08-23T08:24:33.750Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":null,"comments_closed?":true,"facebook_team?":false,"team_private?":false,"vulnerability_information":"I found a public accessible Jenkins instance: https://██████jenkins.██████.com\n\nThis instance requires login, however, it is possible to register an account using the signup page:\nhttps://██████jenkins.██████.com/signup\n\n### Arbitrary file reads\n\nFrom there it is possible to use the Jenkins Script Console to read information on the system:\nhttps://██████jenkins.██████.com/script\n\nFor example: /etc/passwd\n\n`\"cat /etc/passwd\".execute().text`\n```\nroot:x:0:0:root:/root:/bin/bash\n[...]\n██████:x:530:530:██████:/home/██████:/bin/bash\n██████:x:558:558:██████:/home/██████:/bin/bash\n[...]\n```\n\n## AWS Credentials\n\nThe jenkins user has AWS credentials set up in its home dir: `/mnt/ephemeral/var/lib/jenkins/.aws/credentials`\n\nWith these credentials it is possible to:\n\n- list all EC2 instances (~480), including hostnames, state, security groups (internal) IP addresses et cetera. See attached `ec2_instances.txt`\n- read all S3 buckets. List of bucket names attached `s3_buckets.txt`\n\n## S3 buckets\n\nThe account has access to 168 S3 buckets. I scanned through these to see if there was anything interesting. The most interesting ones found:\n\n- s3://s3.██████.com/backups/\n- s3://s3.██████.com/backups/ssl/\n- s3://s3.██████.com/backups/██████prodmysql/20161021/\n- s3://atlassian-backups.██████ops.com/\n- s3://backups.██████ops.com/██████svn/\n\n### backups/ssl\n\nThis contains several SSL certificates:\n```\n✓ ls -l ssl/certs/\ntotal 0\n[...]\ndrwxr-xr-x 5 tom staff 170 May 18 02:08 m.██████.com\ndrwxr-xr-x 3 tom staff 102 Jan 13  2015 ██████.██████.com\ndrwxr-xr-x 4 tom staff 136 Feb 23  2015 ██████.██████.com\ndrwxr-xr-x 4 tom staff 136 May  8  2015 secure.██████.com\ndrwxr-xr-x 3 tom staff 102 Jan 13  2015 secure.██████.com\n[...]\ndrwxr-xr-x 4 tom staff 136 May 18 02:10 wildcard.██████.com\ndrwxr-xr-x 3 tom staff 102 May 18 02:12 wildcard.██████.com\n[...]\ndrwxr-xr-x 4 tom staff 136 May 18 02:09 wildcard.██████.com\ndrwxr-xr-x 6 tom staff 204 Jul 21 16:39 www.██████.cn\ndrwxr-xr-x 4 tom staff 136 Oct 21 18:45 www.██████.com\n```\n\n### backups/██████prodmysql/20161021/\n\nLooking at the naming convention and content of this directory I'm pretty confident this is an actual backup of todays production data. The directory contains a ~40GB large bzipped file called: ██████prodmysql.20161021.tar.bz2\n\nI don't want to go further and actually access that data, but based on what data you appear to store in your application this backup could contain:\n\n- email addresses;\n- (hashed) passwords;\n- social security numbers;\n- and/or credit card numbers;\n- and/or bank account numbers;\n- and/or address information.\n\nSince ██████ is using the ██████ API I expect W9 tax form data to be stored here as well. Ref: https://www.██████.com/help/faq\n\nCan you confirm my assumptions on the production database are correct?\n\n### backups/*\n\nSeveral other interesting folders found, but no need digging in to that as I think this report has already proved its point so far.\n\n# Mitigation\n\n- Take the Jenkins instance down!\n- Cycle the AWS access tokens used by the Jenkins user\n\nPlease let me know if there is anything else I can do to help out or if anything is unclear.\n\nRegards,\nTom","vulnerability_information_html":"\u003cp\u003eI found a public accessible Jenkins instance: https://██████jenkins.██████.com\u003c/p\u003e\n\n\u003cp\u003eThis instance requires login, however, it is possible to register an account using the signup page:\u003cbr\u003e\nhttps://██████jenkins.██████.com/signup\u003c/p\u003e\n\n\u003ch3 id=\"arbitrary-file-reads\"\u003eArbitrary file reads\u003c/h3\u003e\n\n\u003cp\u003eFrom there it is possible to use the Jenkins Script Console to read information on the system:\u003cbr\u003e\nhttps://██████jenkins.██████.com/script\u003c/p\u003e\n\n\u003cp\u003eFor example: /etc/passwd\u003c/p\u003e\n\n\u003cp\u003e\u003ccode\u003e\u0026quot;cat /etc/passwd\u0026quot;.execute().text\u003c/code\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eroot:x:0:0:root:/root:/bin/bash\n[...]\n██████:x:530:530:██████:/home/██████:/bin/bash\n██████:x:558:558:██████:/home/██████:/bin/bash\n[...]\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2 id=\"aws-credentials\"\u003eAWS Credentials\u003c/h2\u003e\n\n\u003cp\u003eThe jenkins user has AWS credentials set up in its home dir: \u003ccode\u003e/mnt/ephemeral/var/lib/jenkins/.aws/credentials\u003c/code\u003e\u003c/p\u003e\n\n\u003cp\u003eWith these credentials it is possible to:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003elist all EC2 instances (~480), including hostnames, state, security groups (internal) IP addresses et cetera. See attached \u003ccode\u003eec2_instances.txt\u003c/code\u003e\n\u003c/li\u003e\n\u003cli\u003eread all S3 buckets. List of bucket names attached \u003ccode\u003es3_buckets.txt\u003c/code\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch2 id=\"s3-buckets\"\u003eS3 buckets\u003c/h2\u003e\n\n\u003cp\u003eThe account has access to 168 S3 buckets. I scanned through these to see if there was anything interesting. The most interesting ones found:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003es3://s3.██████.com/backups/\u003c/li\u003e\n\u003cli\u003es3://s3.██████.com/backups/ssl/\u003c/li\u003e\n\u003cli\u003es3://s3.██████.com/backups/██████prodmysql/20161021/\u003c/li\u003e\n\u003cli\u003es3://atlassian-backups.██████ops.com/\u003c/li\u003e\n\u003cli\u003es3://backups.██████ops.com/██████svn/\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch3 id=\"backups-ssl\"\u003ebackups/ssl\u003c/h3\u003e\n\n\u003cp\u003eThis contains several SSL certificates:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e✓ ls -l ssl/certs/\ntotal 0\n[...]\ndrwxr-xr-x 5 tom staff 170 May 18 02:08 m.██████.com\ndrwxr-xr-x 3 tom staff 102 Jan 13  2015 ██████.██████.com\ndrwxr-xr-x 4 tom staff 136 Feb 23  2015 ██████.██████.com\ndrwxr-xr-x 4 tom staff 136 May  8  2015 secure.██████.com\ndrwxr-xr-x 3 tom staff 102 Jan 13  2015 secure.██████.com\n[...]\ndrwxr-xr-x 4 tom staff 136 May 18 02:10 wildcard.██████.com\ndrwxr-xr-x 3 tom staff 102 May 18 02:12 wildcard.██████.com\n[...]\ndrwxr-xr-x 4 tom staff 136 May 18 02:09 wildcard.██████.com\ndrwxr-xr-x 6 tom staff 204 Jul 21 16:39 www.██████.cn\ndrwxr-xr-x 4 tom staff 136 Oct 21 18:45 www.██████.com\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch3 id=\"backups-prodmysql-20161021\"\u003ebackups/██████prodmysql/20161021/\u003c/h3\u003e\n\n\u003cp\u003eLooking at the naming convention and content of this directory I\u0026#39;m pretty confident this is an actual backup of todays production data. The directory contains a ~40GB large bzipped file called: ██████prodmysql.20161021.tar.bz2\u003c/p\u003e\n\n\u003cp\u003eI don\u0026#39;t want to go further and actually access that data, but based on what data you appear to store in your application this backup could contain:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eemail addresses;\u003c/li\u003e\n\u003cli\u003e(hashed) passwords;\u003c/li\u003e\n\u003cli\u003esocial security numbers;\u003c/li\u003e\n\u003cli\u003eand/or credit card numbers;\u003c/li\u003e\n\u003cli\u003eand/or bank account numbers;\u003c/li\u003e\n\u003cli\u003eand/or address information.\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eSince ██████ is using the ██████ API I expect W9 tax form data to be stored here as well. Ref: \u003ca title=\"https://www.xn--4zhaaaaa.com/help/faq\" href=\"/redirect?url=https%3A%2F%2Fwww.xn--4zhaaaaa.com%2Fhelp%2Ffaq\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.xn--4zhaaaaa.com/help/faq\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eCan you confirm my assumptions on the production database are correct?\u003c/p\u003e\n\n\u003ch3 id=\"backups\"\u003ebackups/*\u003c/h3\u003e\n\n\u003cp\u003eSeveral other interesting folders found, but no need digging in to that as I think this report has already proved its point so far.\u003c/p\u003e\n\n\u003ch1 id=\"mitigation\"\u003eMitigation\u003c/h1\u003e\n\n\u003cul\u003e\n\u003cli\u003eTake the Jenkins instance down!\u003c/li\u003e\n\u003cli\u003eCycle the AWS access tokens used by the Jenkins user\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003ePlease let me know if there is anything else I can do to help out or if anything is unclear.\u003c/p\u003e\n\n\u003cp\u003eRegards,\u003cbr\u003e\nTom\u003c/p\u003e\n","original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":64,"voters":["barbie_girl","cdl","michiel","mashoud1122","spam404","mik317","sameerphad72","riramar","kaulse","mygf","and 54 more..."],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":3234248,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2016-11-07T08:33:16.000Z","updated_at":"2016-11-07T08:33:16.000Z","actor":{"username":"tomdev","cleared":false,"url":"/tomdev","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/036/d216c51a25ae9f40651b5859490048ece35ef88f_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"reporter":{"username":"tomdev","url":"/tomdev"},"genius_execution_id":null,"team_handle":"redact","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3234267,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-08-23T08:24:33.869Z","updated_at":"2018-08-23T08:24:33.869Z","actor":{"username":"tomdev","cleared":false,"url":"/tomdev","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/036/d216c51a25ae9f40651b5859490048ece35ef88f_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"redact","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"id":9843,"category":"researcher","content":"I own your AWS credentials that allow access to all of your S3 buckets, including:\n\n- backups of all **production** databases;\n- backups of SSL certificates, including www.██████.com;\n- backups of source code, Confluence, Jira, et cetera.","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eI own your AWS credentials that allow access to all of your S3 buckets, including:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003ebackups of all \u003cstrong\u003eproduction\u003c/strong\u003e databases;\u003c/li\u003e\n\u003cli\u003ebackups of SSL certificates, including \u003ca href=\"/redirect?url=http%3A%2F%2Fwww.xn--4zhaaaaa.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ewww.██████.com\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e;\u003c/li\u003e\n\u003cli\u003ebackups of source code, Confluence, Jira, et cetera.\u003c/li\u003e\n\u003c/ul\u003e\n"}]}