{"id":672499,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC82NzI0OTk=","url":"https://hackerone.com/reports/672499","title":"Stealing the ip addres from users","state":"Closed","substate":"not-applicable","severity_rating":"low","readable_substate":"N/A","created_at":"2019-08-13T15:30:35.696Z","submitted_at":"2019-08-13T15:30:35.696Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"minoto","url":"/minoto","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/c22RJargVF6CtYWtFPnhRueQ/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":17443,"url":"https://hackerone.com/vanilla","handle":"vanilla","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/017/443/2720e6aeb834de4fd40765a5cae34abb78eb66cd_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/443/2720e6aeb834de4fd40765a5cae34abb78eb66cd_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Vanilla","twitter_handle":"vanilla","website":"http://vanillaforums.com","about":"Vanilla is a powerfully simple discussion forum you can easily customize to make as unique as your community."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":true,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2020-07-29T16:13:49.938Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2020-07-29T16:12:40.317Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi team!\n\n#Summary\nPixel that steals your data. \nBy creating an image in https://iplogger.org/ and inserting it in the forum we can steal some data (ip, language, geo location) of the users who see the message.\n\n#Steps to reproduce\n+ Set \"wyswyg\" on\n+ Create an image from https://iplogger.org/ and use the link to capture data\n+ Insert a link (external img) in a forum or private message (https://iplogger.org/2Znmm5)\n+ Enter the forum / message with another browser\n+ Show the \"listfull\" link provided by \"ipblogger.org\" to see the ip captured by the image (https://iplogger.org/listfull/36r492Znmm5)\n+ The data was captured\n\n#Solution\nYou can fix this in different ways, but in my opinion, it would be better if you proxy all objects from third-party resources and create a CSP.\n\n## Impact\n\nA malicious user can capture sensitive information from forum users. In the case of private messages, you can easily detect if the user read or not the message .. simulating the \"read\" of whatsapp.\n\nFind out the geo location with https://iplookup.flagfox.net/\n\nRegards!","vulnerability_information_html":"\u003cp\u003eHi team!\u003c/p\u003e\n\n\u003ch1 id=\"summary\"\u003eSummary\u003c/h1\u003e\n\n\u003cp\u003ePixel that steals your data. \u003cbr\u003e\nBy creating an image in \u003ca title=\"https://iplogger.org/\" href=\"/redirect?url=https%3A%2F%2Fiplogger.org%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://iplogger.org/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e and inserting it in the forum we can steal some data (ip, language, geo location) of the users who see the message.\u003c/p\u003e\n\n\u003ch1 id=\"steps-to-reproduce\"\u003eSteps to reproduce\u003c/h1\u003e\n\n\u003cul\u003e\n\u003cli\u003eSet \u0026quot;wyswyg\u0026quot; on\u003c/li\u003e\n\u003cli\u003eCreate an image from \u003ca title=\"https://iplogger.org/\" href=\"/redirect?url=https%3A%2F%2Fiplogger.org%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://iplogger.org/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e and use the link to capture data\u003c/li\u003e\n\u003cli\u003eInsert a link (external img) in a forum or private message (\u003ca title=\"https://iplogger.org/2Znmm5\" href=\"/redirect?url=https%3A%2F%2Fiplogger.org%2F2Znmm5\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://iplogger.org/2Znmm5\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e)\u003c/li\u003e\n\u003cli\u003eEnter the forum / message with another browser\u003c/li\u003e\n\u003cli\u003eShow the \u0026quot;listfull\u0026quot; link provided by \u0026quot;ipblogger.org\u0026quot; to see the ip captured by the image (\u003ca title=\"https://iplogger.org/listfull/36r492Znmm5\" href=\"/redirect?url=https%3A%2F%2Fiplogger.org%2Flistfull%2F36r492Znmm5\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://iplogger.org/listfull/36r492Znmm5\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e)\u003c/li\u003e\n\u003cli\u003eThe data was captured\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch1 id=\"solution\"\u003eSolution\u003c/h1\u003e\n\n\u003cp\u003eYou can fix this in different ways, but in my opinion, it would be better if you proxy all objects from third-party resources and create a CSP.\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eA malicious user can capture sensitive information from forum users. In the case of private messages, you can easily detect if the user read or not the message .. simulating the \u0026quot;read\u0026quot; of whatsapp.\u003c/p\u003e\n\n\u003cp\u003eFind out the geo location with \u003ca title=\"https://iplookup.flagfox.net/\" href=\"/redirect?url=https%3A%2F%2Fiplookup.flagfox.net%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://iplookup.flagfox.net/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eRegards!\u003c/p\u003e\n","weakness":{"id":18,"name":"Information Disclosure"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":554518,"file_name":"1.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/JRUzfaMKEuMDYW8d9LWdWhEd?response-content-disposition=attachment%3B%20filename%3D%221.png%22%3B%20filename%2A%3DUTF-8%27%271.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ6J7UOFHP%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T063633Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDamJ7YR2N3cIBOa8zjuSmUd9OCX8zCykCDx%2B6kH2J%2BlQIhAPFk51DuoGb47ygm%2F46VUWXIRiNzzPuAJCxpuNY6C9r8KrQDCFIQARoMMDEzNjE5Mjc0ODQ5IgwfJ9Wm2OgZB0TD5wEqkQMAyHxawucw3AMqEaVZmpdf%2FWoK6P8gu%2FCj%2FoC7vu86houcl7d5S1aesU3sbrOzgm6RSEhwz%2FFS3jL7D6T4JI4Ce1ND%2FrgO0lyXrQzDIcV61dzQW3FvNLr0ZImyyUdtac%2BXOj%2B4Yuxg3B%2Fw8%2FASrjXwhjBS66Kymk3L6dUfBdgwlGyaWjSrEj7pUe4QmHItRfpiYrIugF6V0YbiwTzCRnupZGkhFUvdnKltp%2B4hMIJ8ZpZXjRaPMFGYbJODmmGmpbXrkLNmtpD9ssAfsLLmMNbkAbfGTVhz1jb8jNtS70QChWZUcaVF%2BUJ%2BnjyviI%2BzOI3PvJo6%2BFF7nuwLNAutvngzDIQqSSVMoO%2F3MB45%2Bi7mOnnapSDDsV974XkQgCuM7vsb5p2hLCxzrxps5NEHGajQr5tkHe3qivszLUiVfsV43w8FYD%2BBONxEK7W9P8Fz8NZ67SyH7GG2ksQHMqmv0OcEaprPoRqnV3X2FUQMilKfrm8Mwo6y2b3BolwJdahB%2FiN%2B4DEDiSex%2FihlgZtj7Y4SxDDk%2FKn%2FBTrqAf559VpL8gNLdFBoVG3N%2FZOK1jnsPcfoIUSZtPAKUZCx%2FfYM8b4F5pg%2FUgEn1Lv%2B2LBdmNBasw6RmzajA5OSfdAMndyjJN9XxpB%2BQCxuWhR%2B4l3UYvcHCs0ptmeXrxe03i6oCQg6cNND1wBmViOKSrRB7ycvKEbOUFZtkHoRDVaID3Z%2BuOzyOMaLFXSvzsVsAcCFgFhIk5QJcY%2B1scZVna72pH8jnKw%2FwC1cIv1j%2FAmz0zBabFT7deSC5tUMl0pZQVYKiEGsgryYN9fSfaoMv2wR80e4kst1hVdlJHDktel9plUkLBliVB9%2BDQ%3D%3D\u0026X-Amz-Signature=790fbd53b28dcb210a888dc48115053a6c52af30372c2308a09bfc9e610a0f01","file_size":9808,"type":"image/png"}],"allow_singular_disclosure_at":null,"vote_count":0,"voters":[],"severity":{"rating":"low","author_type":"User"},"structured_scope":{"databaseId":14809,"asset_type":"SOURCE_CODE","asset_identifier":"https://github.com/vanilla/vanilla/","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":5566066,"is_internal":false,"editable":false,"type":"Activities::BugNotApplicable","message":"Hi @minoto,\n\nAlthough this behavior might appear to be a security vulnerability, or a finding worth tracking as such, it does not constitute a loss of confidentiality nor disclosure of personal data. \n\nWhenever an image or any other off-site resource is requested and loaded by your browser, a request (from your IP address, with your user-agent, and sometimes a referrer header) will be sent to the server hosting said content. This could be anything, even just a simple link being clicked. For instance, you could achieve the same by including a link in your profile and have people click on it, or post an image on a public forum that does not make use of resource proxying. In short, it is expected behavior, and it is how things are supposed to work.\n\nKind regards,\n@beagle ","markdown_message":"\u003cp\u003eHi \u003ca href=\"/minoto\"\u003e@minoto\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eAlthough this behavior might appear to be a security vulnerability, or a finding worth tracking as such, it does not constitute a loss of confidentiality nor disclosure of personal data. \u003c/p\u003e\n\n\u003cp\u003eWhenever an image or any other off-site resource is requested and loaded by your browser, a request (from your IP address, with your user-agent, and sometimes a referrer header) will be sent to the server hosting said content. This could be anything, even just a simple link being clicked. For instance, you could achieve the same by including a link in your profile and have people click on it, or post an image on a public forum that does not make use of resource proxying. In short, it is expected behavior, and it is how things are supposed to work.\u003c/p\u003e\n\n\u003cp\u003eKind regards,\u003cbr\u003e\n\u003ca href=\"/beagle\"\u003e@beagle\u003c/a\u003e \u003c/p\u003e\n","automated_response":false,"created_at":"2019-08-13T16:09:49.530Z","updated_at":"2019-08-13T16:09:49.530Z","actor":{"username":"beagle","cleared":false,"url":"/beagle","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/458/833/024b7a83a4a54282cbcdf96b9b10a93700cf8743_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"vanilla","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8796573,"is_internal":false,"editable":false,"type":"Activities::ExternalUserJoined","message":"","markdown_message":"","automated_response":false,"created_at":"2020-07-29T16:11:50.535Z","updated_at":"2020-07-29T16:11:50.535Z","additional_data":{"duplicate_report_id":920505},"actor":{"username":"eidox99","cleared":false,"url":"/eidox99","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"vanilla","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8796581,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Disclosing this report so that it can be referenced publicly in the future.","markdown_message":"\u003cp\u003eDisclosing this report so that it can be referenced publicly in the future.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-07-29T16:12:40.347Z","updated_at":"2020-07-29T16:12:40.347Z","first_to_agree":true,"actor":{"username":"charrondev","cleared":false,"url":"/charrondev","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"vanilla","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8796590,"is_internal":false,"editable":false,"type":"Activities::ManuallyDisclosed","message":"","markdown_message":"","automated_response":false,"created_at":"2020-07-29T16:13:49.865Z","updated_at":"2020-07-29T16:13:49.865Z","actor":{"username":"charrondev","cleared":false,"url":"/charrondev","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"vanilla","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}