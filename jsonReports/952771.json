{"id":952771,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC85NTI3NzE=","url":"https://hackerone.com/reports/952771","title":"CVE-2019-11250 remains in effect.","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2020-08-06T17:42:21.805Z","submitted_at":"2020-08-06T17:42:21.852Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"purelyapplied","url":"/purelyapplied","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/RAM8RiZgipG3JD441vRPZDzD/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":39386,"url":"https://hackerone.com/kubernetes","handle":"kubernetes","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/039/386/486f4380e09776d05a912ca9f46be23f72fe8197_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/039/386/486f4380e09776d05a912ca9f46be23f72fe8197_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Kubernetes","twitter_handle":"kubernetesio","website":"https://kubernetes.io/","about":""}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":["CVE-2020-8565"],"singular_disclosure_disabled":false,"disclosed_at":"2020-11-29T21:23:11.134Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2020-10-30T21:23:04.168Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Report Submission Form\n\n## Summary:\n\"CVE-2019-11250: TOB-K8S-001: Bearer tokens are revealed in logs\" remains in effect.  \n\n## Kubernetes Version:\nEffects at least all versions since 1.4.\n- This was determined with some `git` archaeology.  This was determined by following the code snippet from it's current location in `kubernetes/staging/src/k8s.io/client-go/transport/round_trippers.go`\n- The snippet was last meaningfully modified \n- It's current location in The snippet remains relatively unchanged since \n\n## Component Version:\nI'm not sure.\n\n## Steps To Reproduce:\n1. Spin up a cluster with high verbosity: klog.V(9).Enabled()\n1. Watch logs  round_trippers.go `curl -k -v -X\u003c\u003e -H \"Authorization: \u003ctoken\u003e\" \u003c...\u003e`\n\nI was having trouble getting a cluster spun up, so I have not managed a live reproduction.\n\n## Supporting Material/References:\n[Issue \\#81146: Kubernetes 3rd Party Security Audit Findings]\n(https://github.com/kubernetes/kubernetes/issues/81146)\n\n[Issue  \\#81114: CVE-2019-11250: TOB-K8S-001: Bearer tokens are revealed in logs]\n(https://github.com/kubernetes/kubernetes/issues/81114)\n\n[Partial fix for \\#81114: PR \\#81330]\n(https://github.com/kubernetes/kubernetes/pull/81330).\nNote that only `debuggingRoundTripper.RoundTrip` only masks headers in the `if rt.levels[debugRequestHeaders]` block, exposure is also present in the \n`if rt.levels[debugCurlCommand] {klog.Infof(\"%s\", reqInfo.toCurl())}` preceding it.\n\nAt `kubernetes/staging/src/k8s.io/client-go/transport/round_trippers.go:416`:\n```golang\nfunc (rt *debuggingRoundTripper) RoundTrip(req *http.Request) (*http.Response, error) {\n\treqInfo := newRequestInfo(req)\n\n\tif rt.levels[debugJustURL] {\n\t\tklog.Infof(\"%s %s\", reqInfo.RequestVerb, reqInfo.RequestURL)\n\t}\n\tif rt.levels[debugCurlCommand] {\n\t\tklog.Infof(\"%s\", reqInfo.toCurl())\n\t}\n\tif rt.levels[debugRequestHeaders] {\n\t\tklog.Infof(\"Request Headers:\")\n\t\tfor key, values := range reqInfo.RequestHeaders {\n\t\t\tfor _, value := range values {\n\t\t\t\tvalue = maskValue(key, value)\n\t\t\t\tklog.Infof(\"    %s: %s\", key, value)\n\t\t\t}\n\t\t}\n\t}\n\t// \u003cfunction continues\u003e\n}\n```\n\nAt `kubernetes/staging/src/k8s.io/client-go/transport/round_trippers.go:338`:\n```golang\n// toCurl returns a string that can be run as a command in a terminal (minus the body)\nfunc (r *requestInfo) toCurl() string {\n\theaders := \"\"\n\tfor key, values := range r.RequestHeaders {\n\t\tfor _, value := range values {\n\t\t\theaders += fmt.Sprintf(` -H %q`, fmt.Sprintf(\"%s: %s\", key, value))\n\t\t}\n\t}\n\n\treturn fmt.Sprintf(\"curl -k -v -X%s %s '%s'\", r.RequestVerb, headers, r.RequestURL)\n}\n```\n\nCorrection will be a one-line diff to use `maskValue` in this loop as well.\n\n## Impact\n\n\u003e Alice logs into a Kubernetes cluster and is issued a Bearer token. The system logs her\ntoken. Eve, who has access to the logs but not the production Kubernetes cluster, replays\nAliceâ€™s Bearer token, and can masquerade as Alice to the cluster.","vulnerability_information_html":"\u003cp\u003eReport Submission Form\u003c/p\u003e\n\n\u003ch2 id=\"summary\"\u003eSummary:\u003c/h2\u003e\n\n\u003cp\u003e\u0026quot;CVE-2019-11250: TOB-K8S-001: Bearer tokens are revealed in logs\u0026quot; remains in effect.  \u003c/p\u003e\n\n\u003ch2 id=\"kubernetes-version\"\u003eKubernetes Version:\u003c/h2\u003e\n\n\u003cp\u003eEffects at least all versions since 1.4.\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eThis was determined with some \u003ccode\u003egit\u003c/code\u003e archaeology.  This was determined by following the code snippet from it\u0026#39;s current location in \u003ccode\u003ekubernetes/staging/src/k8s.io/client-go/transport/round_trippers.go\u003c/code\u003e\n\u003c/li\u003e\n\u003cli\u003eThe snippet was last meaningfully modified \u003c/li\u003e\n\u003cli\u003eIt\u0026#39;s current location in The snippet remains relatively unchanged since \u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch2 id=\"component-version\"\u003eComponent Version:\u003c/h2\u003e\n\n\u003cp\u003eI\u0026#39;m not sure.\u003c/p\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps To Reproduce:\u003c/h2\u003e\n\n\u003col\u003e\n\u003cli\u003eSpin up a cluster with high verbosity: klog.V(9).Enabled()\u003c/li\u003e\n\u003cli\u003eWatch logs  round_trippers.go \u003ccode\u003ecurl -k -v -X\u0026lt;\u0026gt; -H \u0026quot;Authorization: \u0026lt;token\u0026gt;\u0026quot; \u0026lt;...\u0026gt;\u003c/code\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eI was having trouble getting a cluster spun up, so I have not managed a live reproduction.\u003c/p\u003e\n\n\u003ch2 id=\"supporting-material-references\"\u003eSupporting Material/References:\u003c/h2\u003e\n\n\u003cp\u003e\u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fkubernetes%2Fkubernetes%2Fissues%2F81146\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eIssue #81146: Kubernetes 3rd Party Security Audit Findings\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fkubernetes%2Fkubernetes%2Fissues%2F81114\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eIssue  #81114: CVE-2019-11250: TOB-K8S-001: Bearer tokens are revealed in logs\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fkubernetes%2Fkubernetes%2Fpull%2F81330\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ePartial fix for #81114: PR #81330\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e.\u003cbr\u003e\nNote that only \u003ccode\u003edebuggingRoundTripper.RoundTrip\u003c/code\u003e only masks headers in the \u003ccode\u003eif rt.levels[debugRequestHeaders]\u003c/code\u003e block, exposure is also present in the \u003cbr\u003e\n\u003ccode\u003eif rt.levels[debugCurlCommand] {klog.Infof(\u0026quot;%s\u0026quot;, reqInfo.toCurl())}\u003c/code\u003e preceding it.\u003c/p\u003e\n\n\u003cp\u003eAt \u003ccode\u003ekubernetes/staging/src/k8s.io/client-go/transport/round_trippers.go:416\u003c/code\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight go\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003efunc\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ert\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"n\"\u003edebuggingRoundTripper\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"n\"\u003eRoundTrip\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ereq\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"n\"\u003ehttp\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eRequest\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"n\"\u003ehttp\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eResponse\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003eerror\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"n\"\u003ereqInfo\u003c/span\u003e \u003cspan class=\"o\"\u003e:=\u003c/span\u003e \u003cspan class=\"n\"\u003enewRequestInfo\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ereq\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"n\"\u003ert\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003elevels\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003edebugJustURL\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eklog\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eInfof\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;%s %s\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ereqInfo\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eRequestVerb\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ereqInfo\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eRequestURL\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"n\"\u003ert\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003elevels\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003edebugCurlCommand\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eklog\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eInfof\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;%s\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ereqInfo\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003etoCurl\u003c/span\u003e\u003cspan class=\"p\"\u003e())\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"n\"\u003ert\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003elevels\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003edebugRequestHeaders\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eklog\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eInfof\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;Request Headers:\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"n\"\u003ekey\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003evalues\u003c/span\u003e \u003cspan class=\"o\"\u003e:=\u003c/span\u003e \u003cspan class=\"k\"\u003erange\u003c/span\u003e \u003cspan class=\"n\"\u003ereqInfo\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eRequestHeaders\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"n\"\u003e_\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003evalue\u003c/span\u003e \u003cspan class=\"o\"\u003e:=\u003c/span\u003e \u003cspan class=\"k\"\u003erange\u003c/span\u003e \u003cspan class=\"n\"\u003evalues\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"n\"\u003evalue\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003emaskValue\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ekey\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003evalue\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eklog\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eInfof\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;    %s: %s\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ekey\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003evalue\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"c\"\u003e// \u0026lt;function continues\u0026gt;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eAt \u003ccode\u003ekubernetes/staging/src/k8s.io/client-go/transport/round_trippers.go:338\u003c/code\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight go\"\u003e\u003ccode\u003e\u003cspan class=\"c\"\u003e// toCurl returns a string that can be run as a command in a terminal (minus the body)\u003c/span\u003e\n\u003cspan class=\"k\"\u003efunc\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003er\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"n\"\u003erequestInfo\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"n\"\u003etoCurl\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eheaders\u003c/span\u003e \u003cspan class=\"o\"\u003e:=\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026quot;\u0026quot;\u003c/span\u003e\n    \u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"n\"\u003ekey\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003evalues\u003c/span\u003e \u003cspan class=\"o\"\u003e:=\u003c/span\u003e \u003cspan class=\"k\"\u003erange\u003c/span\u003e \u003cspan class=\"n\"\u003er\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eRequestHeaders\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"n\"\u003e_\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003evalue\u003c/span\u003e \u003cspan class=\"o\"\u003e:=\u003c/span\u003e \u003cspan class=\"k\"\u003erange\u003c/span\u003e \u003cspan class=\"n\"\u003evalues\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eheaders\u003c/span\u003e \u003cspan class=\"o\"\u003e+=\u003c/span\u003e \u003cspan class=\"n\"\u003efmt\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eSprintf\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e` -H %q`\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003efmt\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eSprintf\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;%s: %s\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ekey\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003evalue\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003efmt\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eSprintf\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;curl -k -v -X%s %s \u0026#39;%s\u0026#39;\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003er\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eRequestVerb\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eheaders\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003er\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eRequestURL\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eCorrection will be a one-line diff to use \u003ccode\u003emaskValue\u003c/code\u003e in this loop as well.\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eAlice logs into a Kubernetes cluster and is issued a Bearer token. The system logs her\u003cbr\u003e\ntoken. Eve, who has access to the logs but not the production Kubernetes cluster, replays\u003cbr\u003e\nAliceâ€™s Bearer token, and can masquerade as Alice to the cluster.\u003c/p\u003e\n\u003c/blockquote\u003e\n","bounty_amount":"1000.0","formatted_bounty":"$1,000","weakness":{"id":33,"name":"Cleartext Storage of Sensitive Information"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2020-11-29T21:23:04.259Z","allow_singular_disclosure_after":-2541068.420656915,"singular_disclosure_allowed":true,"vote_count":1,"voters":["khizer47"],"severity":{"rating":"medium","score":4.3,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"low","user_interaction":"none","scope":"unchanged","confidentiality":"low","integrity":"none","availability":"none"}},"structured_scope":{"databaseId":32459,"asset_type":"SOURCE_CODE","asset_identifier":"https://github.com/kubernetes/kubernetes","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":8870912,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @purelyapplied - Thanks for the submission. Your report is currently being reviewed and the HackerOne triage team will get back to you once there is additional information to share.","markdown_message":"\u003cp\u003eHey \u003ca href=\"/purelyapplied\"\u003e@purelyapplied\u003c/a\u003e - Thanks for the submission. Your report is currently being reviewed and the HackerOne triage team will get back to you once there is additional information to share.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-08-07T02:53:08.169Z","updated_at":"2020-08-07T02:53:08.169Z","actor":{"username":"tuxedo","cleared":false,"url":"/tuxedo","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/9G6pgB95of3ikt3prqQunAfD/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"kubernetes","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":8879536,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Hi @purelyapplied - Thanks for the report! Can you please provide more details in your step-by-step instructions?","markdown_message":"\u003cp\u003eHi \u003ca href=\"/purelyapplied\"\u003e@purelyapplied\u003c/a\u003e - Thanks for the report! Can you please provide more details in your step-by-step instructions?\u003c/p\u003e\n","automated_response":false,"created_at":"2020-08-07T21:44:25.831Z","updated_at":"2020-08-07T21:44:25.831Z","actor":{"username":"tuxedo","cleared":false,"url":"/tuxedo","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/9G6pgB95of3ikt3prqQunAfD/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"kubernetes","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":8920922,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"I just wanted to ACK the request for a real reproduction.  I'll hopefully have it tomorrow or Friday.","markdown_message":"\u003cp\u003eI just wanted to ACK the request for a real reproduction.  I\u0026#39;ll hopefully have it tomorrow or Friday.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-08-12T23:56:23.751Z","updated_at":"2020-08-12T23:56:23.751Z","actor":{"username":"purelyapplied","cleared":false,"url":"/purelyapplied","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/RAM8RiZgipG3JD441vRPZDzD/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"kubernetes","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8932219,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Thanks for letting me know @purelyapplied! ","markdown_message":"\u003cp\u003eThanks for letting me know \u003ca href=\"/purelyapplied\"\u003e@purelyapplied\u003c/a\u003e! \u003c/p\u003e\n","automated_response":false,"created_at":"2020-08-13T23:30:57.625Z","updated_at":"2020-08-13T23:30:57.625Z","actor":{"username":"tuxedo","cleared":false,"url":"/tuxedo","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/9G6pgB95of3ikt3prqQunAfD/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"kubernetes","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":8973576,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Reproduction was pretty straight-forward once I reviewed the authentication and testing documentation.\n\n0\\. From a clone of `git@github.com:kubernetes/kubernetes.git`, spin up a local cluster.\n\n```bash\ncd kubernetes\nhack/local-up-cluster.sh\n# You've got a minute or two.  Stretch your legs and refill your water.\n```\n\n1\\. In another tab, use the suggested kubeconfig.  Add a user who authenticates via bearer token.  I have reproduced the `mmosley` example in [the authentication documentation](https://kubernetes.io/docs/reference/access-authn-authz/authentication/#option-1-oidc-authenticator).  The `set-credentials` command may require `sudo` to create the `admin.kubeconfig.lock` file, or permissions to the config directory must be otherwise granted.\n\n```bash\nexport KUBECONFIG=/var/run/kubernetes/admin.kubeconfig\n\nsudo cluster/kubectl.sh config set-credentials mmosley  \\\n        --auth-provider=oidc  \\\n        --auth-provider-arg=idp-issuer-url=https://oidcidp.tremolo.lan:8443/auth/idp/OidcIdP  \\\n        --auth-provider-arg=client-id=kubernetes  \\\n        --auth-provider-arg=client-secret=1db158f6-177d-4d9c-8a8b-d36869918ec5  \\\n        --auth-provider-arg=refresh-token=q1bKLFOyUiosTfawzA93TzZIDzH2TNa2SMm0zEiPKTUwME6BkEo6Sql5yUWVBSWpKUGphaWpxSVAfekBOZbBhaEW+VlFUeVRGcluyVF5JT4+haZmPsluFoFu5XkpXk5BXqHega4GAXlF+ma+vmYpFcHe5eZR+slBFpZKtQA= \\\n        --auth-provider-arg=idp-certificate-authority=/root/ca.pem \\\n        --auth-provider-arg=id-token=eyJraWQiOiJDTj1vaWRjaWRwLnRyZW1vbG8ubGFuLCBPVT1EZW1vLCBPPVRybWVvbG8gU2VjdXJpdHksIEw9QXJsaW5ndG9uLCBTVD1WaXJnaW5pYSwgQz1VUy1DTj1rdWJlLWNhLTEyMDIxNDc5MjEwMzYwNzMyMTUyIiwiYWxnIjoiUlMyNTYifQ.eyJpc3MiOiJodHRwczovL29pZGNpZHAudHJlbW9sby5sYW46ODQ0My9hdXRoL2lkcC9PaWRjSWRQIiwiYXVkIjoia3ViZXJuZXRlcyIsImV4cCI6MTQ4MzU0OTUxMSwianRpIjoiMm96US15TXdFcHV4WDlHZUhQdy1hZyIsImlhdCI6MTQ4MzU0OTQ1MSwibmJmIjoxNDgzNTQ5MzMxLCJzdWIiOiI0YWViMzdiYS1iNjQ1LTQ4ZmQtYWIzMC0xYTAxZWU0MWUyMTgifQ.w6p4J_6qQ1HzTG9nrEOrubxIMb9K5hzcMPxc9IxPx2K4xO9l-oFiUw93daH3m5pluP6K7eOE6txBuRVfEcpJSwlelsOsW8gb8VJcnzMS9EnZpeA0tW_p-mnkFc3VcfyXuhe5R3G7aa5d8uHv70yJ9Y3-UhjiN9EhpMdfPAoEB9fYKKkJRzF7utTTIPGrSaSU6d2pcpfYKaxIwePzEkT4DfcQthoZdy9ucNvvLoi1DIC-UocFD8HLs8LYKEqSxQvOcvnThbObJ9af71EwmuE21fO5KzMW20KtAeget1gnldOosPtz1G5EwvaQ401-RPQzPGMVBld0_zMCAwZttJ4knw\n```\n\n2\\. Execute a `kubectl` command using the token above at verbosity 9 or higher.  Capture STDERR.\n\n```bash\nID=\"eyJhbGciOiJSUzI1NiJ9.eyJpc3MiOiJodHRwczovL21sYi50cmVtb2xvLmxhbjo4MDQzL2F1dGgvaWRwL29pZGMiLCJhdWQiOiJrdWJlcm5ldGVzIiwiZXhwIjoxNDc0NTk2NjY5LCJqdGkiOiI2RDUzNXoxUEpFNjJOR3QxaWVyYm9RIiwiaWF0IjoxNDc0NTk2MzY5LCJuYmYiOjE0NzQ1OTYyNDksInN1YiI6Im13aW5kdSIsInVzZXJfcm9sZSI6WyJ1c2VycyIsIm5ldy1uYW1lc3BhY2Utdmlld2VyIl0sImVtYWlsIjoibXdpbmR1QG5vbW9yZWplZGkuY29tIn0.f2As579n9VNoaKzoF-dOQGmXkFKf1FMyNV0-va_B63jn-_n9LGSCca_6IVMP8pO-Zb4KvRqGyTP0r3HkHxYy5c81AnIh8ijarruczl-TK_yF5akjSTHFZD-0gRzlevBDiH8Q79NAr-ky0P4iIXS8lY9Vnjch5MF74Zx0c3alKJHJUnnpjIACByfF2SCaYzbWFMUNat-K1PaUk5-ujMBG7yYnr95xD-63n8CO8teGUAAEMx6zRjzfhnhbzX-ajwZLGwGUBT4WqjMs70-6a7_8gZmLZb2az1cZynkFRj2BaCkVT3A2RrjeEwZEtGXlMqKJ1_I2ulrOVsYx01_yD35-rw \"\ncluster/kubectl.sh --v=10 --token=${ID} get nodes 2\u003e request_output.txt\n```\n\n3\\. Find the `curl` logged by `round_trippers.go`.  Observe the included bearer token.\n\n```bash\ngrep \"curl \" request_output.txt\n# I0818 23:48:42.048062  651691 round_trippers.go:423] curl -k -v -XGET  -H \"Authorization: Bearer eyJhbGciOiJSUzI1NiJ9.eyJpc3MiOiJodHRwczovL21sYi50cmVtb2xvLmxhbjo4MDQzL2F1dGgvaWRwL29pZGMiLCJhdWQiOiJrdWJlcm5ldGVzIiwiZXhwIjoxNDc0NTk2NjY5LCJqdGkiOiI2RDUzNXoxUEpFNjJOR3QxaWVyYm9RIiwiaWF0IjoxNDc0NTk2MzY5LCJuYmYiOjE0NzQ1OTYyNDksInN1YiI6Im13aW5kdSIsInVzZXJfcm9sZSI6WyJ1c2VycyIsIm5ldy1uYW1lc3BhY2Utdmlld2VyIl0sImVtYWlsIjoibXdpbmR1QG5vbW9yZWplZGkuY29tIn0.f2As579n9VNoaKzoF-dOQGmXkFKf1FMyNV0-va_B63jn-_n9LGSCca_6IVMP8pO-Zb4KvRqGyTP0r3HkHxYy5c81AnIh8ijarruczl-TK_yF5akjSTHFZD-0gRzlevBDiH8Q79NAr-ky0P4iIXS8lY9Vnjch5MF74Zx0c3alKJHJUnnpjIACByfF2SCaYzbWFMUNat-K1PaUk5-ujMBG7yYnr95xD-63n8CO8teGUAAEMx6zRjzfhnhbzX-ajwZLGwGUBT4WqjMs70-6a7_8gZmLZb2az1cZynkFRj2BaCkVT3A2RrjeEwZEtGXlMqKJ1_I2ulrOVsYx01_yD35-rw\" -H \"Accept: application/json;as=Table;v=v1;g=meta.k8s.io,application/json;as=Table;v=v1beta1;g=meta.k8s.io,application/json\" -H \"User-Agent: kubectl/v0.0.0 (linux/amd64) kubernetes/3b5aedc\" 'https://localhost:6443/api/v1/nodes?limit=500'\n```","markdown_message":"\u003cp\u003eReproduction was pretty straight-forward once I reviewed the authentication and testing documentation.\u003c/p\u003e\n\n\u003cp\u003e0. From a clone of \u003ccode\u003egit@github.com:kubernetes/kubernetes.git\u003c/code\u003e, spin up a local cluster.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight shell\"\u003e\u003ccode\u003e\u003cspan class=\"nb\"\u003ecd \u003c/span\u003ekubernetes\nhack/local-up-cluster.sh\n\u003cspan class=\"c\"\u003e# You\u0026#39;ve got a minute or two.  Stretch your legs and refill your water.\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e1. In another tab, use the suggested kubeconfig.  Add a user who authenticates via bearer token.  I have reproduced the \u003ccode\u003emmosley\u003c/code\u003e example in \u003ca href=\"/redirect?url=https%3A%2F%2Fkubernetes.io%2Fdocs%2Freference%2Faccess-authn-authz%2Fauthentication%2F%23option-1-oidc-authenticator\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ethe authentication documentation\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e.  The \u003ccode\u003eset-credentials\u003c/code\u003e command may require \u003ccode\u003esudo\u003c/code\u003e to create the \u003ccode\u003eadmin.kubeconfig.lock\u003c/code\u003e file, or permissions to the config directory must be otherwise granted.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight shell\"\u003e\u003ccode\u003e\u003cspan class=\"nb\"\u003eexport \u003c/span\u003e\u003cspan class=\"nv\"\u003eKUBECONFIG\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e/var/run/kubernetes/admin.kubeconfig\n\n\u003cspan class=\"nb\"\u003esudo \u003c/span\u003ecluster/kubectl.sh config set-credentials mmosley  \u003cspan class=\"se\"\u003e\\\u003c/span\u003e\n        \u003cspan class=\"nt\"\u003e--auth-provider\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003eoidc  \u003cspan class=\"se\"\u003e\\\u003c/span\u003e\n        \u003cspan class=\"nt\"\u003e--auth-provider-arg\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003eidp-issuer-url\u003cspan class=\"o\"\u003e=\u003c/span\u003ehttps://oidcidp.tremolo.lan:8443/auth/idp/OidcIdP  \u003cspan class=\"se\"\u003e\\\u003c/span\u003e\n        \u003cspan class=\"nt\"\u003e--auth-provider-arg\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003eclient-id\u003cspan class=\"o\"\u003e=\u003c/span\u003ekubernetes  \u003cspan class=\"se\"\u003e\\\u003c/span\u003e\n        \u003cspan class=\"nt\"\u003e--auth-provider-arg\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003eclient-secret\u003cspan class=\"o\"\u003e=\u003c/span\u003e1db158f6-177d-4d9c-8a8b-d36869918ec5  \u003cspan class=\"se\"\u003e\\\u003c/span\u003e\n        \u003cspan class=\"nt\"\u003e--auth-provider-arg\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003erefresh-token\u003cspan class=\"o\"\u003e=\u003c/span\u003eq1bKLFOyUiosTfawzA93TzZIDzH2TNa2SMm0zEiPKTUwME6BkEo6Sql5yUWVBSWpKUGphaWpxSVAfekBOZbBhaEW+VlFUeVRGcluyVF5JT4+haZmPsluFoFu5XkpXk5BXqHega4GAXlF+ma+vmYpFcHe5eZR+slBFpZKtQA\u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"se\"\u003e\\\u003c/span\u003e\n        \u003cspan class=\"nt\"\u003e--auth-provider-arg\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003eidp-certificate-authority\u003cspan class=\"o\"\u003e=\u003c/span\u003e/root/ca.pem \u003cspan class=\"se\"\u003e\\\u003c/span\u003e\n        \u003cspan class=\"nt\"\u003e--auth-provider-arg\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003eid-token\u003cspan class=\"o\"\u003e=\u003c/span\u003eeyJraWQiOiJDTj1vaWRjaWRwLnRyZW1vbG8ubGFuLCBPVT1EZW1vLCBPPVRybWVvbG8gU2VjdXJpdHksIEw9QXJsaW5ndG9uLCBTVD1WaXJnaW5pYSwgQz1VUy1DTj1rdWJlLWNhLTEyMDIxNDc5MjEwMzYwNzMyMTUyIiwiYWxnIjoiUlMyNTYifQ.eyJpc3MiOiJodHRwczovL29pZGNpZHAudHJlbW9sby5sYW46ODQ0My9hdXRoL2lkcC9PaWRjSWRQIiwiYXVkIjoia3ViZXJuZXRlcyIsImV4cCI6MTQ4MzU0OTUxMSwianRpIjoiMm96US15TXdFcHV4WDlHZUhQdy1hZyIsImlhdCI6MTQ4MzU0OTQ1MSwibmJmIjoxNDgzNTQ5MzMxLCJzdWIiOiI0YWViMzdiYS1iNjQ1LTQ4ZmQtYWIzMC0xYTAxZWU0MWUyMTgifQ.w6p4J_6qQ1HzTG9nrEOrubxIMb9K5hzcMPxc9IxPx2K4xO9l-oFiUw93daH3m5pluP6K7eOE6txBuRVfEcpJSwlelsOsW8gb8VJcnzMS9EnZpeA0tW_p-mnkFc3VcfyXuhe5R3G7aa5d8uHv70yJ9Y3-UhjiN9EhpMdfPAoEB9fYKKkJRzF7utTTIPGrSaSU6d2pcpfYKaxIwePzEkT4DfcQthoZdy9ucNvvLoi1DIC-UocFD8HLs8LYKEqSxQvOcvnThbObJ9af71EwmuE21fO5KzMW20KtAeget1gnldOosPtz1G5EwvaQ401-RPQzPGMVBld0_zMCAwZttJ4knw\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e2. Execute a \u003ccode\u003ekubectl\u003c/code\u003e command using the token above at verbosity 9 or higher.  Capture STDERR.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight shell\"\u003e\u003ccode\u003e\u003cspan class=\"nv\"\u003eID\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;eyJhbGciOiJSUzI1NiJ9.eyJpc3MiOiJodHRwczovL21sYi50cmVtb2xvLmxhbjo4MDQzL2F1dGgvaWRwL29pZGMiLCJhdWQiOiJrdWJlcm5ldGVzIiwiZXhwIjoxNDc0NTk2NjY5LCJqdGkiOiI2RDUzNXoxUEpFNjJOR3QxaWVyYm9RIiwiaWF0IjoxNDc0NTk2MzY5LCJuYmYiOjE0NzQ1OTYyNDksInN1YiI6Im13aW5kdSIsInVzZXJfcm9sZSI6WyJ1c2VycyIsIm5ldy1uYW1lc3BhY2Utdmlld2VyIl0sImVtYWlsIjoibXdpbmR1QG5vbW9yZWplZGkuY29tIn0.f2As579n9VNoaKzoF-dOQGmXkFKf1FMyNV0-va_B63jn-_n9LGSCca_6IVMP8pO-Zb4KvRqGyTP0r3HkHxYy5c81AnIh8ijarruczl-TK_yF5akjSTHFZD-0gRzlevBDiH8Q79NAr-ky0P4iIXS8lY9Vnjch5MF74Zx0c3alKJHJUnnpjIACByfF2SCaYzbWFMUNat-K1PaUk5-ujMBG7yYnr95xD-63n8CO8teGUAAEMx6zRjzfhnhbzX-ajwZLGwGUBT4WqjMs70-6a7_8gZmLZb2az1cZynkFRj2BaCkVT3A2RrjeEwZEtGXlMqKJ1_I2ulrOVsYx01_yD35-rw \u0026quot;\u003c/span\u003e\ncluster/kubectl.sh \u003cspan class=\"nt\"\u003e--v\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e10 \u003cspan class=\"nt\"\u003e--token\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"k\"\u003e${\u003c/span\u003e\u003cspan class=\"nv\"\u003eID\u003c/span\u003e\u003cspan class=\"k\"\u003e}\u003c/span\u003e get nodes 2\u0026gt; request_output.txt\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e3. Find the \u003ccode\u003ecurl\u003c/code\u003e logged by \u003ccode\u003eround_trippers.go\u003c/code\u003e.  Observe the included bearer token.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight shell\"\u003e\u003ccode\u003e\u003cspan class=\"nb\"\u003egrep\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026quot;curl \u0026quot;\u003c/span\u003e request_output.txt\n\u003cspan class=\"c\"\u003e# I0818 23:48:42.048062  651691 round_trippers.go:423] curl -k -v -XGET  -H \u0026quot;Authorization: Bearer eyJhbGciOiJSUzI1NiJ9.eyJpc3MiOiJodHRwczovL21sYi50cmVtb2xvLmxhbjo4MDQzL2F1dGgvaWRwL29pZGMiLCJhdWQiOiJrdWJlcm5ldGVzIiwiZXhwIjoxNDc0NTk2NjY5LCJqdGkiOiI2RDUzNXoxUEpFNjJOR3QxaWVyYm9RIiwiaWF0IjoxNDc0NTk2MzY5LCJuYmYiOjE0NzQ1OTYyNDksInN1YiI6Im13aW5kdSIsInVzZXJfcm9sZSI6WyJ1c2VycyIsIm5ldy1uYW1lc3BhY2Utdmlld2VyIl0sImVtYWlsIjoibXdpbmR1QG5vbW9yZWplZGkuY29tIn0.f2As579n9VNoaKzoF-dOQGmXkFKf1FMyNV0-va_B63jn-_n9LGSCca_6IVMP8pO-Zb4KvRqGyTP0r3HkHxYy5c81AnIh8ijarruczl-TK_yF5akjSTHFZD-0gRzlevBDiH8Q79NAr-ky0P4iIXS8lY9Vnjch5MF74Zx0c3alKJHJUnnpjIACByfF2SCaYzbWFMUNat-K1PaUk5-ujMBG7yYnr95xD-63n8CO8teGUAAEMx6zRjzfhnhbzX-ajwZLGwGUBT4WqjMs70-6a7_8gZmLZb2az1cZynkFRj2BaCkVT3A2RrjeEwZEtGXlMqKJ1_I2ulrOVsYx01_yD35-rw\u0026quot; -H \u0026quot;Accept: application/json;as=Table;v=v1;g=meta.k8s.io,application/json;as=Table;v=v1beta1;g=meta.k8s.io,application/json\u0026quot; -H \u0026quot;User-Agent: kubectl/v0.0.0 (linux/amd64) kubernetes/3b5aedc\u0026quot; \u0026#39;https://localhost:6443/api/v1/nodes?limit=500\u0026#39;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","automated_response":false,"created_at":"2020-08-18T23:52:14.207Z","updated_at":"2020-08-18T23:53:16.629Z","actor":{"username":"purelyapplied","cleared":false,"url":"/purelyapplied","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/RAM8RiZgipG3JD441vRPZDzD/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"kubernetes","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8994819,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I had also been meaning to ask: should I go ahead and open a PR to correct this issue, or is there a process to observe for fixes for CVEs?","markdown_message":"\u003cp\u003eI had also been meaning to ask: should I go ahead and open a PR to correct this issue, or is there a process to observe for fixes for CVEs?\u003c/p\u003e\n","automated_response":false,"created_at":"2020-08-20T22:05:58.721Z","updated_at":"2020-08-20T22:05:58.721Z","actor":{"username":"purelyapplied","cleared":false,"url":"/purelyapplied","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/RAM8RiZgipG3JD441vRPZDzD/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"kubernetes","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9027333,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Hi @purelyapplied,\n\nThank you for your patience. Unfortunately, I'm not seeing a token in the logs. Are you still able to reproduce this? If possible, can you please provide a video demonstrating how to reproduce this? ","markdown_message":"\u003cp\u003eHi \u003ca href=\"/purelyapplied\"\u003e@purelyapplied\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThank you for your patience. Unfortunately, I\u0026#39;m not seeing a token in the logs. Are you still able to reproduce this? If possible, can you please provide a video demonstrating how to reproduce this? \u003c/p\u003e\n","automated_response":false,"created_at":"2020-08-24T19:49:54.042Z","updated_at":"2020-08-24T19:49:54.042Z","actor":{"username":"tuxedo","cleared":false,"url":"/tuxedo","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/9G6pgB95of3ikt3prqQunAfD/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"kubernetes","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":9165126,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Sorry it's been a crazy couple weeks.\n\nI made a recording with `asciinema`.  Attached are the `.cast` and a `.gif` of that.\n\nOf course, that recording is ultimately just a text file converted into something pretty, so from a security standpoint, that's pretty weak.  I have a video of me executing it, but because it takes so long to spin up a cluster, it's about 9 minutes long and exceeds the 250MB file size limit.\n\nLet me know if you want to connect via video conference of your choice and I could screen-share my way through it live.\n\nAlso, while the above reproduction demonstrates the logging of the token in the `kubectl` round_tripper, I should have demonstrated that they also appear in the `kube-clusterapi.log`s when the log-level is high.  That can be achieved by prepending the log level when you spin up the cluster, i.e., `LOG_LEVEL=10 ./hack/local-up-cluster.sh`.  I'll send you a gif that demonstrates that tomorrow -- the one I just attempted didn't follow `screen` and I'm late for dinner.  :/\n\nThe gif is at 10x speed.  I'm using a commit from yesterday because HEAD doesn't build for me right now.","markdown_message":"\u003cp\u003eSorry it\u0026#39;s been a crazy couple weeks.\u003c/p\u003e\n\n\u003cp\u003eI made a recording with \u003ccode\u003easciinema\u003c/code\u003e.  Attached are the \u003ccode\u003e.cast\u003c/code\u003e and a \u003ccode\u003e.gif\u003c/code\u003e of that.\u003c/p\u003e\n\n\u003cp\u003eOf course, that recording is ultimately just a text file converted into something pretty, so from a security standpoint, that\u0026#39;s pretty weak.  I have a video of me executing it, but because it takes so long to spin up a cluster, it\u0026#39;s about 9 minutes long and exceeds the 250MB file size limit.\u003c/p\u003e\n\n\u003cp\u003eLet me know if you want to connect via video conference of your choice and I could screen-share my way through it live.\u003c/p\u003e\n\n\u003cp\u003eAlso, while the above reproduction demonstrates the logging of the token in the \u003ccode\u003ekubectl\u003c/code\u003e round_tripper, I should have demonstrated that they also appear in the \u003ccode\u003ekube-clusterapi.log\u003c/code\u003es when the log-level is high.  That can be achieved by prepending the log level when you spin up the cluster, i.e., \u003ccode\u003eLOG_LEVEL=10 ./hack/local-up-cluster.sh\u003c/code\u003e.  I\u0026#39;ll send you a gif that demonstrates that tomorrow -- the one I just attempted didn\u0026#39;t follow \u003ccode\u003escreen\u003c/code\u003e and I\u0026#39;m late for dinner.  :/\u003c/p\u003e\n\n\u003cp\u003eThe gif is at 10x speed.  I\u0026#39;m using a commit from yesterday because HEAD doesn\u0026#39;t build for me right now.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-09-09T00:34:25.707Z","updated_at":"2020-09-09T00:34:25.707Z","actor":{"username":"purelyapplied","cleared":false,"url":"/purelyapplied","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/RAM8RiZgipG3JD441vRPZDzD/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"attachments":[{"id":980676,"filename":"reprod-log.gif","type":"image/gif","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/quNjeWfxpezRRLpg4rZDzqiW?response-content-disposition=attachment%3B%20filename%3D%22reprod-log.gif%22%3B%20filename%2A%3DUTF-8%27%27reprod-log.gif\u0026response-content-type=image%2Fgif\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ7KWAVKN2%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T071412Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQD1%2F98g6jqKF1gdjZ5ZeoLWwnKZTa7SodLIyHk4VOcB%2FAIgFI%2BEqMwMQ%2FjD3C0sLxiv4nCy8OqyFoWIlBFI%2B7p340cqtAMIWBABGgwwMTM2MTkyNzQ4NDkiDLOK9Idi7%2FUoNMuAPiqRA4am%2B6RTpiKhn1AwsjrB6XVphwW3DOpYDdxbLb1mT2RMVWnv7voT3st7PIVsZlzggyCnKW3IXFl%2FFthkC8hPlanzQkmqsI8gI9NrFIkXHcsU6zuBZqsO8kJpBRkDZV6sMJHVSi8%2BbCx0ndEqAxWtiQNEX9ZxsGY3oYwlNJuSJRCRTxAEZa%2F71VqYA4l%2FEDtta2G98a%2B7w0m5jApr8Q303FIRKKxa0v1BRrgwOLkTtlrwYHfTvtXbfeFgqn7%2BHoWj7PaL4nijFBwOZy5CamnMUxGIKtp%2BYcDtI6MF7AU96g8HTcws4xmsFvEX1PpFoqJ6pPB25animcHJSKOaWfi13jxruCpA2sEjEa5wYBPiAEjXsNuSMRG13lbKep614wfDsTpEclccjKRS1nvV9SdDrQ9sc3ShrBOma9kxdr7f7NlgtPwXtxsIJFAeGww%2FEf8UO6hWNOWOyrbxMbAnaAqqrnrRbk1jWalvw%2FjtPzY1MyJZOgqN%2FDhCJzNx7WK5g2KXirutlO9xT8Th8Kxo1yn2i5YtMJinq%2F8FOusBforza3WyzCtzDkxPUVgf%2FxQ15NxR1ETwaKHsZvjxMX9aYpJLOFGo%2BMGtzI5L2fk7Kf5VV8NN8613OzcsiaUpShf%2FlTw0vgtzwFLStO18BMV5XTjpPteD7Y5jDvGQOX9eT%2FO7RiQI5pl5HrSk8ro%2FZocyZggI%2Fl8T3c4A1Ck7lnCXaoa2vMcxhQ5BYEAWGLxnxh9xU%2F%2F6s8roQqOd3GXc1FXIo6%2FfoiCNFrI5ijLtwHbhYPva2%2Bzao%2BuwW%2B%2BdoXpmOtSl4DL0dAHzV7zPwTy%2FzZj9GjkQF3WslKg%2BmtzbBXB%2FBa5ccvA7dWjRnw%3D%3D\u0026X-Amz-Signature=5709e16dd288d1c27bddd664c19133ef57d715ccb3db1ae408bd19b2428134b7"}],"genius_execution_id":null,"team_handle":"kubernetes","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9172840,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Attached to this comment is the reprod that demonstrates that many tokens are logged when the cluster apiserver is run at high `LOG_LEVEL`.  Similar to the previous, it has been made with `asciinema` at 10x speed.  Let me know if you'd like either at a slower speed or anything.","markdown_message":"\u003cp\u003eAttached to this comment is the reprod that demonstrates that many tokens are logged when the cluster apiserver is run at high \u003ccode\u003eLOG_LEVEL\u003c/code\u003e.  Similar to the previous, it has been made with \u003ccode\u003easciinema\u003c/code\u003e at 10x speed.  Let me know if you\u0026#39;d like either at a slower speed or anything.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-09-09T17:17:14.287Z","updated_at":"2020-09-09T17:17:14.287Z","actor":{"username":"purelyapplied","cleared":false,"url":"/purelyapplied","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/RAM8RiZgipG3JD441vRPZDzD/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"attachments":[{"id":981614,"filename":"reprod-in-cluster-log.gif","type":"image/gif","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/E7DuWyL6yYdHWwH4FLVy1kMb?response-content-disposition=attachment%3B%20filename%3D%22reprod-in-cluster-log.gif%22%3B%20filename%2A%3DUTF-8%27%27reprod-in-cluster-log.gif\u0026response-content-type=image%2Fgif\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ7KWAVKN2%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T071412Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQD1%2F98g6jqKF1gdjZ5ZeoLWwnKZTa7SodLIyHk4VOcB%2FAIgFI%2BEqMwMQ%2FjD3C0sLxiv4nCy8OqyFoWIlBFI%2B7p340cqtAMIWBABGgwwMTM2MTkyNzQ4NDkiDLOK9Idi7%2FUoNMuAPiqRA4am%2B6RTpiKhn1AwsjrB6XVphwW3DOpYDdxbLb1mT2RMVWnv7voT3st7PIVsZlzggyCnKW3IXFl%2FFthkC8hPlanzQkmqsI8gI9NrFIkXHcsU6zuBZqsO8kJpBRkDZV6sMJHVSi8%2BbCx0ndEqAxWtiQNEX9ZxsGY3oYwlNJuSJRCRTxAEZa%2F71VqYA4l%2FEDtta2G98a%2B7w0m5jApr8Q303FIRKKxa0v1BRrgwOLkTtlrwYHfTvtXbfeFgqn7%2BHoWj7PaL4nijFBwOZy5CamnMUxGIKtp%2BYcDtI6MF7AU96g8HTcws4xmsFvEX1PpFoqJ6pPB25animcHJSKOaWfi13jxruCpA2sEjEa5wYBPiAEjXsNuSMRG13lbKep614wfDsTpEclccjKRS1nvV9SdDrQ9sc3ShrBOma9kxdr7f7NlgtPwXtxsIJFAeGww%2FEf8UO6hWNOWOyrbxMbAnaAqqrnrRbk1jWalvw%2FjtPzY1MyJZOgqN%2FDhCJzNx7WK5g2KXirutlO9xT8Th8Kxo1yn2i5YtMJinq%2F8FOusBforza3WyzCtzDkxPUVgf%2FxQ15NxR1ETwaKHsZvjxMX9aYpJLOFGo%2BMGtzI5L2fk7Kf5VV8NN8613OzcsiaUpShf%2FlTw0vgtzwFLStO18BMV5XTjpPteD7Y5jDvGQOX9eT%2FO7RiQI5pl5HrSk8ro%2FZocyZggI%2Fl8T3c4A1Ck7lnCXaoa2vMcxhQ5BYEAWGLxnxh9xU%2F%2F6s8roQqOd3GXc1FXIo6%2FfoiCNFrI5ijLtwHbhYPva2%2Bzao%2BuwW%2B%2BdoXpmOtSl4DL0dAHzV7zPwTy%2FzZj9GjkQF3WslKg%2BmtzbBXB%2FBa5ccvA7dWjRnw%3D%3D\u0026X-Amz-Signature=8411a08c7d4568bddfd1d560f49b4491158bab05d90219b07919ce401d26f649"}],"genius_execution_id":null,"team_handle":"kubernetes","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9186439,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thank you @purelyapplied! I was able to validate your report, and have submitted it to the appropriate remediation team for review. You will be updated on the status of this report as soon as there is additional information to share. Please note that the status and severity are subject to change.","markdown_message":"\u003cp\u003eThank you \u003ca href=\"/purelyapplied\"\u003e@purelyapplied\u003c/a\u003e! I was able to validate your report, and have submitted it to the appropriate remediation team for review. You will be updated on the status of this report as soon as there is additional information to share. Please note that the status and severity are subject to change.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-09-11T03:37:45.343Z","updated_at":"2020-09-11T03:37:45.343Z","actor":{"username":"tuxedo","cleared":false,"url":"/tuxedo","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/9G6pgB95of3ikt3prqQunAfD/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"kubernetes","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":9196692,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Glad to hear it!\n\nJust to provide some additional context to the remediation team:\n\nThe fix should be straight-forward.  The [previous partial fix](https://github.com/kubernetes/kubernetes/pull/81330) introduced a `maskValue` utility function that was only applied to one of the two header leak sites.  This fix should be just the one-line addition in `round_trippers.go` of \n\n```golang\n// toCurl returns a string that can be run as a command in a terminal (minus the body)\nfunc (r *requestInfo) toCurl() string {\n\theaders := \"\"\n\tfor key, values := range r.RequestHeaders {\n\t\tfor _, value := range values {\n+\t\t\tvalue = maskValue(key, value)\n\t\t\theaders += fmt.Sprintf(` -H %q`, fmt.Sprintf(\"%s: %s\", key, value))\n\t\t}\n\t}\n\n\treturn fmt.Sprintf(\"curl -k -v -X%s %s '%s'\", r.RequestVerb, headers, r.RequestURL)\n}\n```","markdown_message":"\u003cp\u003eGlad to hear it!\u003c/p\u003e\n\n\u003cp\u003eJust to provide some additional context to the remediation team:\u003c/p\u003e\n\n\u003cp\u003eThe fix should be straight-forward.  The \u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fkubernetes%2Fkubernetes%2Fpull%2F81330\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eprevious partial fix\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e introduced a \u003ccode\u003emaskValue\u003c/code\u003e utility function that was only applied to one of the two header leak sites.  This fix should be just the one-line addition in \u003ccode\u003eround_trippers.go\u003c/code\u003e of \u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight go\"\u003e\u003ccode\u003e\u003cspan class=\"c\"\u003e// toCurl returns a string that can be run as a command in a terminal (minus the body)\u003c/span\u003e\n\u003cspan class=\"k\"\u003efunc\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003er\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"n\"\u003erequestInfo\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"n\"\u003etoCurl\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eheaders\u003c/span\u003e \u003cspan class=\"o\"\u003e:=\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026quot;\u0026quot;\u003c/span\u003e\n    \u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"n\"\u003ekey\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003evalues\u003c/span\u003e \u003cspan class=\"o\"\u003e:=\u003c/span\u003e \u003cspan class=\"k\"\u003erange\u003c/span\u003e \u003cspan class=\"n\"\u003er\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eRequestHeaders\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"n\"\u003e_\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003evalue\u003c/span\u003e \u003cspan class=\"o\"\u003e:=\u003c/span\u003e \u003cspan class=\"k\"\u003erange\u003c/span\u003e \u003cspan class=\"n\"\u003evalues\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003cspan class=\"o\"\u003e+\u003c/span\u003e           \u003cspan class=\"n\"\u003evalue\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003emaskValue\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ekey\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003evalue\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eheaders\u003c/span\u003e \u003cspan class=\"o\"\u003e+=\u003c/span\u003e \u003cspan class=\"n\"\u003efmt\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eSprintf\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e` -H %q`\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003efmt\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eSprintf\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;%s: %s\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ekey\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003evalue\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003efmt\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eSprintf\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;curl -k -v -X%s %s \u0026#39;%s\u0026#39;\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003er\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eRequestVerb\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eheaders\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003er\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eRequestURL\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","automated_response":false,"created_at":"2020-09-11T17:53:13.354Z","updated_at":"2020-09-11T17:53:13.354Z","actor":{"username":"purelyapplied","cleared":false,"url":"/purelyapplied","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/RAM8RiZgipG3JD441vRPZDzD/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"kubernetes","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9203996,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2020-09-12T18:45:49.849Z","updated_at":"2020-09-12T18:45:49.849Z","additional_data":{"old_severity":"Medium","new_severity":"Medium (4.3)","old_severity_id":811323,"new_severity_id":844594},"actor":{"username":"tuxedo","cleared":false,"url":"/tuxedo","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/9G6pgB95of3ikt3prqQunAfD/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"kubernetes","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":9389361,"is_internal":false,"editable":false,"type":"Activities::CveIdAdded","message":"","markdown_message":"","automated_response":false,"created_at":"2020-10-01T19:49:30.042Z","updated_at":"2020-10-01T19:49:30.042Z","cve_ids":["CVE-2020-8565"],"actor":{"username":"cji","cleared":false,"url":"/cji","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"kubernetes","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9513524,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Hi Patrick - Thanks for your report! A fix has been submitted and merged but is still pending release and public disclosure. ","markdown_message":"\u003cp\u003eHi Patrick - Thanks for your report! A fix has been submitted and merged but is still pending release and public disclosure. \u003c/p\u003e\n","automated_response":false,"created_at":"2020-10-13T20:57:57.687Z","updated_at":"2020-10-13T20:57:57.687Z","actor":{"url":"/kubernetes","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/039/386/486f4380e09776d05a912ca9f46be23f72fe8197_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Kubernetes"}},"bounty_amount":"1000.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"kubernetes","collaborator":{"username":"purelyapplied","url":"/purelyapplied"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9542870,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @purelyapplied  - the CVE was published and announced in coordination with the Kubernetes releases yesterday. Thanks again for your report! https://groups.google.com/g/kubernetes-security-announce/c/9d0gPe7SCM8/m/MsCBAxE2AgAJ","markdown_message":"\u003cp\u003eHi \u003ca href=\"/purelyapplied\"\u003e@purelyapplied\u003c/a\u003e  - the CVE was published and announced in coordination with the Kubernetes releases yesterday. Thanks again for your report! \u003ca title=\"https://groups.google.com/g/kubernetes-security-announce/c/9d0gPe7SCM8/m/MsCBAxE2AgAJ\" href=\"/redirect?url=https%3A%2F%2Fgroups.google.com%2Fg%2Fkubernetes-security-announce%2Fc%2F9d0gPe7SCM8%2Fm%2FMsCBAxE2AgAJ\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://groups.google.com/g/kubernetes-security-announce/c/9d0gPe7SCM8/m/MsCBAxE2AgAJ\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2020-10-16T14:37:11.348Z","updated_at":"2020-10-16T14:37:11.348Z","actor":{"username":"cji","cleared":false,"url":"/cji","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"kubernetes","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9542872,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2020-10-16T14:37:19.714Z","updated_at":"2020-10-16T14:37:19.714Z","actor":{"username":"cji","cleared":false,"url":"/cji","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"purelyapplied","url":"/purelyapplied"},"genius_execution_id":null,"team_handle":"kubernetes","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9688144,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-10-30T21:23:04.190Z","updated_at":"2020-10-30T21:23:04.190Z","first_to_agree":true,"actor":{"username":"tallclair","cleared":false,"url":"/tallclair","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/418/594/6bbb78252759e1d1c1d67be48b7d7470926730de_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"kubernetes","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9956742,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-11-29T21:23:11.179Z","updated_at":"2020-11-29T21:23:11.179Z","actor":{"url":"/kubernetes","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/039/386/486f4380e09776d05a912ca9f46be23f72fe8197_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Kubernetes"}},"genius_execution_id":null,"team_handle":"kubernetes","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}