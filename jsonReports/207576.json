{"id":207576,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMDc1NzY=","url":"https://hackerone.com/reports/207576","title":"Subdomain takeover on s3.shopify.com","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2017-02-20T00:48:19.644Z","submitted_at":"2017-02-20T00:48:19.644Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"avlidienbrunn","url":"/avlidienbrunn","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/948/699d45bda29817e724a5a2399862812a14dba902_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1382,"url":"https://hackerone.com/shopify","handle":"shopify","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Shopify","twitter_handle":"","website":"https://www.shopify.com","about":"Shopify is a multi-channel commerce platform that helps people sell online, in-store, and everywhere in between."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2017-02-27T23:30:20.507Z","bug_reporter_agreed_on_going_public_at":"2017-02-27T23:30:20.475Z","team_member_agreed_on_going_public_at":"2017-02-27T23:28:33.048Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"**Preword**\nI know that this is not explicitly in scope, but I still felt it was serious enough to justify a report and let you decide the potential impact.\n\n**Description**\nThe subdomain s3.shopify.com was pointed using CNAME to Amazon S3, but no bucket with that name was registered. This meant that anyone could sign up for Amazon S3, claim the bucket as their own and then serve content on s3.shopify.com.\n\nDNS record:\n```\ns3.shopify.com.\t\t3599\tIN\tCNAME\tshopify-assets.s3.amazonaws.com.\nshopify-assets.s3.amazonaws.com. 7518 IN CNAME\ts3-directional-w.amazonaws.com.\ns3-directional-w.amazonaws.com.\t7218 IN\tCNAME\ts3-1-w.amazonaws.com.\ns3-1-w.amazonaws.com.\t4\tIN\tA\t52.216.80.56\n```\n\n\n**Impact**\nThis could be used as stored XSS by uploading a HTML page.\n\nGiven that the attacker could control all the content (even at /), it could also make for a pretty convincing phishing page.\n\nLast, if any of your application relies on s3.shopify.com any of the data sent/fetched there could be controlled by an attacker.\n\n**Mitigation/PoC**\nI have claimed the bucket on my account and disabled use except for the following URL:\nhttp://s3.shopify.com/xss_unguessable3211231232.html\n\nThis means that nobody else can claim the bucket and add content.\n\n**Fix**\nRemove the s3.shopify.com DNS entry. Alternatively, if you wish to use s3.shopify.com with S3, tell me in a comment and I will remove the bucket from my Amazon account.","vulnerability_information_html":"\u003cp\u003e\u003cstrong\u003ePreword\u003c/strong\u003e\u003cbr\u003e\nI know that this is not explicitly in scope, but I still felt it was serious enough to justify a report and let you decide the potential impact.\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eDescription\u003c/strong\u003e\u003cbr\u003e\nThe subdomain s3.shopify.com was pointed using CNAME to Amazon S3, but no bucket with that name was registered. This meant that anyone could sign up for Amazon S3, claim the bucket as their own and then serve content on s3.shopify.com.\u003c/p\u003e\n\n\u003cp\u003eDNS record:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003es3.shopify.com.     3599    IN  CNAME   shopify-assets.s3.amazonaws.com.\nshopify-assets.s3.amazonaws.com. 7518 IN CNAME  s3-directional-w.amazonaws.com.\ns3-directional-w.amazonaws.com. 7218 IN CNAME   s3-1-w.amazonaws.com.\ns3-1-w.amazonaws.com.   4   IN  A   52.216.80.56\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e\u003cstrong\u003eImpact\u003c/strong\u003e\u003cbr\u003e\nThis could be used as stored XSS by uploading a HTML page.\u003c/p\u003e\n\n\u003cp\u003eGiven that the attacker could control all the content (even at /), it could also make for a pretty convincing phishing page.\u003c/p\u003e\n\n\u003cp\u003eLast, if any of your application relies on s3.shopify.com any of the data sent/fetched there could be controlled by an attacker.\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eMitigation/PoC\u003c/strong\u003e\u003cbr\u003e\nI have claimed the bucket on my account and disabled use except for the following URL:\u003cbr\u003e\n\u003ca title=\"http://s3.shopify.com/xss_unguessable3211231232.html\" href=\"/redirect?url=http%3A%2F%2Fs3.shopify.com%2Fxss_unguessable3211231232.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://s3.shopify.com/xss_unguessable3211231232.html\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eThis means that nobody else can claim the bucket and add content.\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eFix\u003c/strong\u003e\u003cbr\u003e\nRemove the s3.shopify.com DNS entry. Alternatively, if you wish to use s3.shopify.com with S3, tell me in a comment and I will remove the bucket from my Amazon account.\u003c/p\u003e\n","bounty_amount":"500.0","formatted_bounty":"$500","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":10,"voters":["avlidienbrunn","bogdantcaciuc","encrypt","powerjacobb1","eveeez","harry_mg","dpgribkov","sumit7","spetr0x","avlidienbrunn_bot"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1496916,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thank you for your report. \n\nIt appears that the subdomain was unused; none of our applications were pointing at it. We have removed the DNS record for s3.shopify.com and the issue is now resolved.\n\nOur next round of bounty decisions will take place within two weeks, so we will be in touch with you again soon.","markdown_message":"\u003cp\u003eThank you for your report. \u003c/p\u003e\n\n\u003cp\u003eIt appears that the subdomain was unused; none of our applications were pointing at it. We have removed the DNS record for s3.shopify.com and the issue is now resolved.\u003c/p\u003e\n\n\u003cp\u003eOur next round of bounty decisions will take place within two weeks, so we will be in touch with you again soon.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-02-21T15:51:00.349Z","updated_at":"2017-02-21T15:51:00.349Z","actor":{"username":"no-longer-with-company","cleared":false,"url":"/no-longer-with-company","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/072/324/c6fb0a069a32f1e9f503089aa18807ad593549e0_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"avlidienbrunn","url":"/avlidienbrunn"},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1509633,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks for helping improve the security of Shopify!","markdown_message":"\u003cp\u003eThanks for helping improve the security of Shopify!\u003c/p\u003e\n","automated_response":false,"created_at":"2017-02-27T23:28:24.920Z","updated_at":"2017-02-27T23:28:24.920Z","actor":{"url":"/shopify","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Shopify"}},"bounty_amount":"500.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"shopify","collaborator":{"username":"avlidienbrunn","url":"/avlidienbrunn"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1509634,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-02-27T23:28:33.063Z","updated_at":"2017-02-27T23:28:33.063Z","first_to_agree":true,"actor":{"username":"andrewdunbar","cleared":false,"url":"/andrewdunbar","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/164/5b0e89675ed6dbb9df87223e9f8f58e2125bb56b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1509643,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-02-27T23:30:20.490Z","updated_at":"2017-02-27T23:30:20.490Z","actor":{"username":"avlidienbrunn","cleared":true,"url":"/avlidienbrunn","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/948/699d45bda29817e724a5a2399862812a14dba902_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1509644,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-02-27T23:30:20.521Z","updated_at":"2017-02-27T23:30:20.521Z","actor":{"username":"avlidienbrunn","cleared":true,"url":"/avlidienbrunn","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/948/699d45bda29817e724a5a2399862812a14dba902_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}