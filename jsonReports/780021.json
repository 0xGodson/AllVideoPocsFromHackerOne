{"id":780021,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC83ODAwMjE=","url":"https://hackerone.com/reports/780021","title":"Korea - LFI via path traversal at https://msr.istarbucks.co.kr:6443/appif/","state":"Closed","substate":"resolved","severity_rating":"critical","readable_substate":"Resolved","created_at":"2020-01-22T03:36:08.468Z","submitted_at":"2020-01-22T03:36:08.468Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"iampuky","url":"/iampuky","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/odkXPVyNuGAdnPZ37XSkBu9J/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1989,"url":"https://hackerone.com/starbucks","handle":"starbucks","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/989/c9aa38cf3b1a91daa085d31e23d23f34cd1874df_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/989/c9aa38cf3b1a91daa085d31e23d23f34cd1874df_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Starbucks","twitter_handle":"Starbucks","website":"http://www.starbucks.com","about":"Inspiring and nurturing the human spirit -- one person, one cup, one neighborhood at a time."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"no-content","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2020-03-10T20:40:09.044Z","bug_reporter_agreed_on_going_public_at":"2020-02-12T16:56:01.906Z","team_member_agreed_on_going_public_at":"2020-03-10T20:40:08.942Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"","vulnerability_information_html":"","bounty_amount":"4000.0","formatted_bounty":"$4,000","weakness":{"id":19,"name":"Path Traversal"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2020-03-13T16:56:01.980Z","allow_singular_disclosure_after":-25106100.981961288,"singular_disclosure_allowed":true,"vote_count":76,"voters":["daehee","a_d_a_m","mashoud1122","bogdantcaciuc","base_64","e4366eolywrgpidfbio","dhbd88","johndoe1492","powerjacobb1","c0rg1","and 66 more..."],"severity":{"rating":"critical","score":9.3,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"none","user_interaction":"none","scope":"unchanged","confidentiality":"high","integrity":"none","availability":"none"}},"structured_scope":{"databaseId":16651,"asset_type":"APPLE_STORE_APP_ID","asset_identifier":"com.starbucks.mystarbucks.kr","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":6834691,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2020-01-22T03:45:25.812Z","updated_at":"2020-01-22T03:45:25.812Z","actor":{"username":"iampuky","cleared":false,"url":"/iampuky","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/odkXPVyNuGAdnPZ37XSkBu9J/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6837350,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2020-01-22T09:11:22.437Z","updated_at":"2020-01-22T09:11:22.437Z","actor":{"username":"iampuky","cleared":false,"url":"/iampuky","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/odkXPVyNuGAdnPZ37XSkBu9J/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6838406,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2020-01-22T10:40:35.461Z","updated_at":"2020-01-22T10:40:35.461Z","additional_data":{},"actor":{"username":"still","cleared":false,"url":"/still","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/390/243/51ce849c0c189ad15dade380626c7b85a3fb9332_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":6838410,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2020-01-22T10:40:58.107Z","updated_at":"2020-01-22T10:40:58.107Z","additional_data":{},"actor":{"username":"still","cleared":false,"url":"/still","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/390/243/51ce849c0c189ad15dade380626c7b85a3fb9332_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":6838423,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2020-01-22T10:42:17.907Z","updated_at":"2020-01-22T10:42:17.907Z","actor":{"username":"still","cleared":false,"url":"/still","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/390/243/51ce849c0c189ad15dade380626c7b85a3fb9332_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":6839128,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2020-01-22T11:34:33.048Z","updated_at":"2020-01-22T11:34:33.048Z","actor":{"username":"agedsumatra","cleared":false,"url":"/agedsumatra","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/yjUg6PZmutR2o3qPxEP2MT1J/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6865887,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2020-01-24T21:51:13.896Z","updated_at":"2020-01-24T21:51:13.896Z","actor":{"username":"iampuky","cleared":false,"url":"/iampuky","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/odkXPVyNuGAdnPZ37XSkBu9J/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6900224,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2020-01-29T15:40:11.376Z","updated_at":"2020-01-29T15:40:11.376Z","actor":{"username":"iampuky","cleared":false,"url":"/iampuky","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/odkXPVyNuGAdnPZ37XSkBu9J/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6901208,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2020-01-29T17:48:38.111Z","updated_at":"2020-01-29T17:48:38.111Z","actor":{"username":"agedsumatra","cleared":false,"url":"/agedsumatra","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/yjUg6PZmutR2o3qPxEP2MT1J/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6954938,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2020-02-03T23:16:21.338Z","updated_at":"2020-02-03T23:16:21.338Z","actor":{"username":"iampuky","cleared":false,"url":"/iampuky","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/odkXPVyNuGAdnPZ37XSkBu9J/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6972645,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2020-02-05T19:09:51.025Z","updated_at":"2020-02-05T19:09:51.025Z","actor":{"username":"iampuky","cleared":false,"url":"/iampuky","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/odkXPVyNuGAdnPZ37XSkBu9J/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6982583,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2020-02-06T22:58:01.411Z","updated_at":"2020-02-06T22:58:01.411Z","actor":{"username":"agedsumatra","cleared":false,"url":"/agedsumatra","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/yjUg6PZmutR2o3qPxEP2MT1J/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7014428,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2020-02-11T04:26:18.848Z","updated_at":"2020-02-11T04:26:18.848Z","actor":{"username":"iampuky","cleared":false,"url":"/iampuky","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/odkXPVyNuGAdnPZ37XSkBu9J/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7033907,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2020-02-12T16:41:55.509Z","updated_at":"2020-02-12T16:41:55.509Z","actor":{"url":"/starbucks","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/989/c9aa38cf3b1a91daa085d31e23d23f34cd1874df_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Starbucks"}},"bounty_amount":"4000.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"starbucks","collaborator":{"username":"iampuky","url":"/iampuky"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7034004,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2020-02-12T16:52:56.839Z","updated_at":"2020-02-12T16:52:56.839Z","actor":{"username":"agedsumatra","cleared":false,"url":"/agedsumatra","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/yjUg6PZmutR2o3qPxEP2MT1J/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"iampuky","url":"/iampuky"},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7034023,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2020-02-12T16:55:34.649Z","updated_at":"2020-02-12T16:55:34.649Z","actor":{"username":"iampuky","cleared":false,"url":"/iampuky","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/odkXPVyNuGAdnPZ37XSkBu9J/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7034026,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-02-12T16:56:01.936Z","updated_at":"2020-02-12T16:56:01.936Z","first_to_agree":true,"actor":{"username":"iampuky","cleared":false,"url":"/iampuky","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/odkXPVyNuGAdnPZ37XSkBu9J/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7283175,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2020-03-10T20:38:38.325Z","updated_at":"2020-03-10T20:38:38.325Z","additional_data":{},"actor":{"username":"agedsumatra","cleared":false,"url":"/agedsumatra","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/yjUg6PZmutR2o3qPxEP2MT1J/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7283193,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-03-10T20:40:08.966Z","updated_at":"2020-03-10T20:40:08.966Z","actor":{"username":"agedsumatra","cleared":false,"url":"/agedsumatra","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/yjUg6PZmutR2o3qPxEP2MT1J/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7283194,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-03-10T20:40:09.127Z","updated_at":"2020-03-10T20:40:09.127Z","actor":{"username":"agedsumatra","cleared":false,"url":"/agedsumatra","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/yjUg6PZmutR2o3qPxEP2MT1J/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":20647,"category":"team","content":"@iampuky — thank you for reporting the original vulnerability and for confirming the resolution.","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003e\u003ca href=\"/iampuky\"\u003e@iampuky\u003c/a\u003e — thank you for reporting the original vulnerability and for confirming the resolution.\u003c/p\u003e\n"},{"id":20651,"category":"researcher","content":"While analyzing the Starbucks Korea mobile application, i noticed that it called an API at https://msr.istarbucks.co.kr:6443/appif/.\nIt was found that the application running under that directory was vulnerable to path traversal, allowing an attacker to read arbitrary files from the server. As a proof-of-concept I was able to retrieve system files, application source code, and logs.\n\nThank you @starbucks @agedsumatra @still for the good work.","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eWhile analyzing the Starbucks Korea mobile application, i noticed that it called an API at \u003ca title=\"https://msr.istarbucks.co.kr:6443/appif/\" href=\"/redirect?url=https%3A%2F%2Fmsr.istarbucks.co.kr%3A6443%2Fappif%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://msr.istarbucks.co.kr:6443/appif/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e.\u003cbr\u003e\nIt was found that the application running under that directory was vulnerable to path traversal, allowing an attacker to read arbitrary files from the server. As a proof-of-concept I was able to retrieve system files, application source code, and logs.\u003c/p\u003e\n\n\u003cp\u003eThank you \u003ca href=\"/starbucks\"\u003e@starbucks\u003c/a\u003e \u003ca href=\"/agedsumatra\"\u003e@agedsumatra\u003c/a\u003e \u003ca href=\"/still\"\u003e@still\u003c/a\u003e for the good work.\u003c/p\u003e\n"}]}