{"id":224362,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMjQzNjI=","url":"https://hackerone.com/reports/224362","title":"Invalidate session after password reset - hosted website","state":"Closed","substate":"duplicate","severity_rating":"low","readable_substate":"Duplicate","created_at":"2017-04-27T14:55:18.215Z","submitted_at":"2017-04-27T14:55:18.215Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"pavanw3b","url":"/pavanw3b","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/038/280/46fd940624527eb674a6bbc0c1affe8448757fed_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":19468,"url":"https://hackerone.com/weblate","handle":"weblate","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/019/468/71eb3827ae9f2a388f27bd4b7eefd20bc3ac813c_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/468/71eb3827ae9f2a388f27bd4b7eefd20bc3ac813c_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Weblate","twitter_handle":"WeblateOrg","website":"https://weblate.org/","about":"Weblate is a libre software web-based continuous localization system"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2017-07-03T18:37:23.815Z","bug_reporter_agreed_on_going_public_at":"2017-07-03T05:57:09.534Z","team_member_agreed_on_going_public_at":"2017-07-03T18:37:23.787Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hey team,\n\nThe Hosted Website doesn't invalidate session after the password is reset. It's one of the OWASP recommendations to terminate the session when a password is changed and force the user to re-login.\n\n### Quote from OWASP:\n`Renew the Session ID After Any Privilege Level Change`\n`The session ID must be renewed or regenerated by the web application after any privilege level change within the associated user session..  Other common scenarios must also be considered, such as password changes`\n**Source:**\nhttps://www.owasp.org/index.php/Session_Management_Cheat_Sheet#Renew_the_Session_ID_After_Any_Privilege_Level_Change\n\n### Steps to reproduce:\n- Logon to https://hosted.weblate.org/accounts/reset/\n- Request for password reset.\n- Click the email link received\n- Change the password and notice session is not reset.\n\n### Suggested Fix:\nWhen the password is reset, force logout the user and redirect to login page with a message.\n\nSome hackerone examples:\nhttps://hackerone.com/reports/15785\nhttps://hackerone.com/reports/15852","vulnerability_information_html":"\u003cp\u003eHey team,\u003c/p\u003e\n\n\u003cp\u003eThe Hosted Website doesn\u0026#39;t invalidate session after the password is reset. It\u0026#39;s one of the OWASP recommendations to terminate the session when a password is changed and force the user to re-login.\u003c/p\u003e\n\n\u003ch3 id=\"quote-from-owasp\"\u003eQuote from OWASP:\u003c/h3\u003e\n\n\u003cp\u003e\u003ccode\u003eRenew the Session ID After Any Privilege Level Change\u003c/code\u003e\u003cbr\u003e\n\u003ccode\u003eThe session ID must be renewed or regenerated by the web application after any privilege level change within the associated user session..  Other common scenarios must also be considered, such as password changes\u003c/code\u003e\u003cbr\u003e\n\u003cstrong\u003eSource:\u003c/strong\u003e\u003cbr\u003e\n\u003ca title=\"https://www.owasp.org/index.php/Session_Management_Cheat_Sheet#Renew_the_Session_ID_After_Any_Privilege_Level_Change\" href=\"/redirect?url=https%3A%2F%2Fwww.owasp.org%2Findex.php%2FSession_Management_Cheat_Sheet%23Renew_the_Session_ID_After_Any_Privilege_Level_Change\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.owasp.org/index.php/Session_Management_Cheat_Sheet#Renew_the_Session_ID_After_Any_Privilege_Level_Change\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch3 id=\"steps-to-reproduce\"\u003eSteps to reproduce:\u003c/h3\u003e\n\n\u003cul\u003e\n\u003cli\u003eLogon to \u003ca title=\"https://hosted.weblate.org/accounts/reset/\" href=\"/redirect?url=https%3A%2F%2Fhosted.weblate.org%2Faccounts%2Freset%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://hosted.weblate.org/accounts/reset/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003eRequest for password reset.\u003c/li\u003e\n\u003cli\u003eClick the email link received\u003c/li\u003e\n\u003cli\u003eChange the password and notice session is not reset.\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch3 id=\"suggested-fix\"\u003eSuggested Fix:\u003c/h3\u003e\n\n\u003cp\u003eWhen the password is reset, force logout the user and redirect to login page with a message.\u003c/p\u003e\n\n\u003cp\u003eSome hackerone examples:\u003cbr\u003e\n\u003ca title=\"https://hackerone.com/reports/15785\" href=\"https://hackerone.com/reports/15785\"\u003ehttps://hackerone.com/reports/15785\u003c/a\u003e\u003cbr\u003e\n\u003ca title=\"https://hackerone.com/reports/15852\" href=\"https://hackerone.com/reports/15852\"\u003ehttps://hackerone.com/reports/15852\u003c/a\u003e\u003c/p\u003e\n","original_report_id":223327,"original_report_url":"https://hackerone.com/reports/223327","attachments":[],"allow_singular_disclosure_at":null,"vote_count":5,"voters":["realtess","ronygigi","mr_r3boot","pavanw3b","cyberoy"],"severity":{"rating":"low","author_type":"User"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1640224,"is_internal":false,"editable":false,"type":"Activities::BugDuplicate","message":"Thanks, it seems that this issue has been already reported.","markdown_message":"\u003cp\u003eThanks, it seems that this issue has been already reported.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-04-27T15:14:35.293Z","updated_at":"2017-04-27T15:14:35.293Z","original_report_id":223327,"actor":{"username":"nijel","cleared":false,"url":"/nijel","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/153/118/21d9e64f7cd44782a2ec35d76eaebf9294308c83_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"weblate","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1798374,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-07-03T05:57:09.555Z","updated_at":"2017-07-03T05:57:09.555Z","first_to_agree":true,"actor":{"username":"pavanw3b","cleared":false,"url":"/pavanw3b","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/280/46fd940624527eb674a6bbc0c1affe8448757fed_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"weblate","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1800067,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-07-03T18:37:23.800Z","updated_at":"2017-07-03T18:37:23.800Z","actor":{"username":"nijel","cleared":false,"url":"/nijel","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/153/118/21d9e64f7cd44782a2ec35d76eaebf9294308c83_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"weblate","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1800068,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-07-03T18:37:23.828Z","updated_at":"2017-07-03T18:37:23.828Z","actor":{"username":"nijel","cleared":false,"url":"/nijel","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/153/118/21d9e64f7cd44782a2ec35d76eaebf9294308c83_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"weblate","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}