{"id":59179,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC81OTE3OQ==","url":"https://hackerone.com/reports/59179","title":"Race condition when redeeming coupon codes","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2015-05-01T06:04:52.353Z","submitted_at":"2015-05-01T06:04:52.353Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"franjkovic","url":"/franjkovic","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/017/194/1e20cd6e4a20863ffe9f6f0601ab3ed347bc852b_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":461,"url":"https://hackerone.com/dropbox","handle":"dropbox","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/461/76f193964f418c594dd74ae1326cf4d9223f481b_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/461/76f193964f418c594dd74ae1326cf4d9223f481b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Dropbox","twitter_handle":"","website":"https://www.dropbox.com","about":"Your stuff, anywhere"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2015-05-11T21:04:17.506Z","bug_reporter_agreed_on_going_public_at":"2015-05-11T20:59:23.322Z","team_member_agreed_on_going_public_at":"2015-05-11T21:04:17.228Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hello,\r\n\r\nthere is a race condition when redeeming coupon codes in https://www.dropbox.com/coupons. Basically, it enables me to reuse one coupon code many times. \r\nHere are the steps to reproduce:\r\n1. Get a coupon code. I bought mine on fiverr.\r\n2. Go to https://www.dropbox.com/coupons and enter your code\r\n3. Click submit; a POST request will be made to /coupons - intercept it\r\n4. Repeat that request many times in short time frame. \r\n5. Hopefully, promo code will be added multiple times to your account.\r\n\r\nI have attached a screenshot of my accounts page with one code redeemed multiple times.\r\n\r\nBest regards,\r\n\r\nJosip","vulnerability_information_html":"\u003cp\u003eHello,\u003c/p\u003e\n\n\u003cp\u003ethere is a race condition when redeeming coupon codes in \u003ca title=\"https://www.dropbox.com/coupons\" href=\"/redirect?url=https%3A%2F%2Fwww.dropbox.com%2Fcoupons\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.dropbox.com/coupons\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e. Basically, it enables me to reuse one coupon code many times. \u003cbr\u003e\nHere are the steps to reproduce:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eGet a coupon code. I bought mine on fiverr.\u003c/li\u003e\n\u003cli\u003eGo to \u003ca title=\"https://www.dropbox.com/coupons\" href=\"/redirect?url=https%3A%2F%2Fwww.dropbox.com%2Fcoupons\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.dropbox.com/coupons\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e and enter your code\u003c/li\u003e\n\u003cli\u003eClick submit; a POST request will be made to /coupons - intercept it\u003c/li\u003e\n\u003cli\u003eRepeat that request many times in short time frame. \u003c/li\u003e\n\u003cli\u003eHopefully, promo code will be added multiple times to your account.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eI have attached a screenshot of my accounts page with one code redeemed multiple times.\u003c/p\u003e\n\n\u003cp\u003eBest regards,\u003c/p\u003e\n\n\u003cp\u003eJosip\u003c/p\u003e\n","bounty_amount":"216.0","formatted_bounty":"$216","original_report_id":null,"original_report_url":null,"attachments":[{"id":36528,"file_name":"dropbox-coupons.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/036/528/edb820d57c23bf1e3791b3f037981468640194c7/dropbox-coupons.png?response-content-disposition=attachment%3B%20filename%3D%22dropbox-coupons.png%22%3B%20filename%2A%3DUTF-8%27%27dropbox-coupons.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ4BCTVX7H%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T062846Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQD9KoIrMtYjsPMNAoz3fkIjMCGzGeE4AC6fZNsgc%2FNK1QIhANJsfJivva8u7YF1XCVwz2O44bXLlD4DSJhj7xaMke6RKrQDCFYQARoMMDEzNjE5Mjc0ODQ5IgzmYD94JaVjjIU2krEqkQPkOp7o1Y%2F3O46uPVkJpWKluhPjw6yqgkTOXGekCyVjJWTTKaV%2Fg4VslprjcyOrHq6Kvjx6FFrvI%2F0oeazfhhuVbsGzIX%2FDNyDl86o7E8p7xdE9njyFrZSTuG%2BcoCSQTNZm6K7xytZ808%2FmbOq1EsQaswjTfJE49knSO3dd6P9o4TMruMzu8iALfM0IqlU4CgtICPjNu1SwD5gIiOjS3JXo97WJ%2FeXaWM7uiiaZIfnwM1%2FJh%2B%2Bf4y2CVgdWsivBsUOOKr5Ffs4r9dvRgpxa%2BT%2FmspuhFLSjdwidy384ywNVej%2Fu5TtU0RmHvya7IsEPuuyEVKZ9GXWYeHJPMuJLhkj%2F9NgnnqTSYay6UqseBG9goY2oONYS%2Fy7uIy6pIkzSjH260rcLKe0FPxGZ3OZNA097jOWSnOIGGcV1YZW18F%2FQaHb3tqnILMft5hGAudbC%2F2kJRmQyb4mArK%2Bic9Gh50TdBT%2BX29t3Wo5dLJweBsKIOOdeF41%2BqY1abZEgoOIbiscyoLBMO4ChJxBEiM%2By%2Bjg8FjC%2B6ar%2FBTrqAdRlQf357Lw7olVqK9BuDw0RNDzAgG1%2BRjmEy94ivfSQKRkYnOaGVWNx1MekakiogYuOKzbAujbete9Cin2JFJP4a22qFOVAg7tsJ%2FeJITiLIkogRaku8DmGovq%2B04Yxq2jfRp5la%2FeG3Fqca5Jc2WM%2BO7QxCdRE21wSAgKnCwsy8vQV1X0gGJjUOV6UsIimNdWCtKUego7nGl1OprelVr%2FiPIFvPy%2BhWrWWJF9nHO59wa4OZtoRJ5df5%2ByoAAAuIWDBKZfHRv45K8z7hZFmm4sjyreHKi0tXU9Fadu828o5w%2B3CHi4r%2BAT0Pg%3D%3D\u0026X-Amz-Signature=95a368afbad02235b903c068960daf312c5bac9faacc3bc7261712b914b5a281","file_size":203082,"type":"image/png"}],"allow_singular_disclosure_at":"2015-06-10T20:59:23.655Z","allow_singular_disclosure_after":-175253362.99340332,"singular_disclosure_allowed":true,"vote_count":4,"voters":["peeper35","sodium_","fantam1","klau5"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":401625,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hi,\n\nThanks for reaching out to us. I will forward your report to our security team. We take security very seriously and, for obvious reasons, would greatly appreciate it if you would allow our team a chance to address your report before you share this information with others.\n\nWe'll update you as soon as we can with our findings and any resolution. In the meantime, please feel free to follow up with me directly if you have any questions or would like to report additional findings.\n\nBest,\nReid","markdown_message":"\u003cp\u003eHi,\u003c/p\u003e\n\n\u003cp\u003eThanks for reaching out to us. I will forward your report to our security team. We take security very seriously and, for obvious reasons, would greatly appreciate it if you would allow our team a chance to address your report before you share this information with others.\u003c/p\u003e\n\n\u003cp\u003eWe\u0026#39;ll update you as soon as we can with our findings and any resolution. In the meantime, please feel free to follow up with me directly if you have any questions or would like to report additional findings.\u003c/p\u003e\n\n\u003cp\u003eBest,\u003cbr\u003e\nReid\u003c/p\u003e\n","automated_response":false,"created_at":"2015-05-04T21:54:21.752Z","updated_at":"2015-05-04T21:54:21.752Z","actor":{"username":"reidski","cleared":false,"url":"/reidski","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"dropbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":402021,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi,\n\nIt seems that the blue \"Space\" available bar does not get updated automatically after you use the code multiple times. You have to get space some other way in order to update it, like connecting Twitter/FB or inviting a friend, and then it shows full amount of all codes.\n\nBest regards,\n\nJosip","markdown_message":"\u003cp\u003eHi,\u003c/p\u003e\n\n\u003cp\u003eIt seems that the blue \u0026quot;Space\u0026quot; available bar does not get updated automatically after you use the code multiple times. You have to get space some other way in order to update it, like connecting Twitter/FB or inviting a friend, and then it shows full amount of all codes.\u003c/p\u003e\n\n\u003cp\u003eBest regards,\u003c/p\u003e\n\n\u003cp\u003eJosip\u003c/p\u003e\n","automated_response":false,"created_at":"2015-05-05T08:33:31.341Z","updated_at":"2015-05-05T08:33:31.341Z","actor":{"username":"franjkovic","cleared":false,"url":"/franjkovic","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/194/1e20cd6e4a20863ffe9f6f0601ab3ed347bc852b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"dropbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":408420,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thank you for your report, our security team has addressed the issue you raised. \n\nAgain, thanks!\nReid","markdown_message":"\u003cp\u003eThank you for your report, our security team has addressed the issue you raised. \u003c/p\u003e\n\n\u003cp\u003eAgain, thanks!\u003cbr\u003e\nReid\u003c/p\u003e\n","automated_response":false,"created_at":"2015-05-11T20:56:41.370Z","updated_at":"2015-05-11T20:56:41.370Z","actor":{"username":"reidski","cleared":false,"url":"/reidski","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"franjkovic","url":"/franjkovic"},"genius_execution_id":null,"team_handle":"dropbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":408422,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2015-05-11T20:56:46.102Z","updated_at":"2015-05-11T20:56:46.102Z","actor":{"url":"/dropbox","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/461/76f193964f418c594dd74ae1326cf4d9223f481b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Dropbox"}},"bounty_amount":"216.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"dropbox","collaborator":{"username":"franjkovic","url":"/franjkovic"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":408430,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Hi,\n\nThank you! Public disclosure?\n\nBest regards,\n\nJosip","markdown_message":"\u003cp\u003eHi,\u003c/p\u003e\n\n\u003cp\u003eThank you! Public disclosure?\u003c/p\u003e\n\n\u003cp\u003eBest regards,\u003c/p\u003e\n\n\u003cp\u003eJosip\u003c/p\u003e\n","automated_response":false,"created_at":"2015-05-11T20:59:23.350Z","updated_at":"2015-05-11T20:59:23.350Z","first_to_agree":true,"actor":{"username":"franjkovic","cleared":false,"url":"/franjkovic","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/194/1e20cd6e4a20863ffe9f6f0601ab3ed347bc852b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"dropbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":408439,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-05-11T21:04:17.255Z","updated_at":"2015-05-11T21:04:17.255Z","actor":{"username":"reidski","cleared":false,"url":"/reidski","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"dropbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":408440,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-05-11T21:04:17.534Z","updated_at":"2015-05-11T21:04:17.534Z","actor":{"username":"reidski","cleared":false,"url":"/reidski","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"dropbox","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}