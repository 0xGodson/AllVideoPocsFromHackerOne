{"id":919112,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC85MTkxMTI=","url":"https://hackerone.com/reports/919112","title":"Authenticity token doesnt expire after single use leading to CSRF","state":"Closed","substate":"informative","readable_substate":"Informative","created_at":"2020-07-08T17:23:06.565Z","submitted_at":"2020-07-08T17:23:06.565Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"d4rk_h4xor","url":"/d4rk_h4xor","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/hgiyPReNEv3WRS9yKSq8aj3C/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":21045,"url":"https://hackerone.com/omise","handle":"omise","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/021/045/124b85928203caaec29c4eb44ef525ca0ddd0fe8_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/021/045/124b85928203caaec29c4eb44ef525ca0ddd0fe8_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Omise","twitter_handle":"omise","website":"https://www.omise.co","about":"Next generation of payment Platform"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2020-08-17T01:36:28.349Z","bug_reporter_agreed_on_going_public_at":"2020-07-09T03:41:30.002Z","team_member_agreed_on_going_public_at":"2020-08-17T01:36:28.284Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"##Summary\nOnce you said that you ruby framework for making the authenticity-token which acts as a CSRF protection. You also send me this as to help me understand https://medium.com/rubyinside/a-deep-dive-into-csrf-protection-in-rails-19fa0a42c0ef . After finding i found that an authenticity-token can be used many times for a particular session leading to CSRF. \n##Steps to produce:\n1) Login and go to https://dashboard.omise.co/test/subscriptions/new\n2) Add an email and capture request and send it to repeater for checking\n3) Again add another email for checking \nFrom here we learnt that on a successfully adding we get https://dashboard.omise.co/test/subscriptions else on a false end we would be redirected to the dashboard!\n{F899996}\nThese are successfully added emails thats y we get redirected to subscriptions\n4) Make a CSRF of one of the adding request via burpsuite csrf maker \n##Request used to make CSRF\n```\nPOST /test/subscriptions HTTP/1.1\nHost: dashboard.omise.co\nUser-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/20100101 Firefox/68.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nReferer: https://dashboard.omise.co/\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 309\nDNT: 1\nConnection: close\nCookie: session=eyJpZCI6InNlc3Npb25fNWtoMWhyZ2pyY3U2c202bXh4MyIsImtleSI6IjhiOTUwZDJhNWRlZWIxYmYzN2MwNTFlMWJiY2VjM2NmIiwiYWNjb3VudCI6ImFjY291bnRfdGVzdF81anZ5NHJwM2M5aHhxcDZjYmUxIiwiZXhwaXJlc19hdCI6IjIwMjAtMDctMDlUMDA6MDY6NDJaIiwiZW1haWwiOiJhYWthc2hhZGhpa2FyaTc4NkBnbWFpbC5jb20ifQ==; session.sig=DQLQM4kaz6XyIQ26G0zwF_xuNPU; locale=en; _omisegateway_session=Y1U0b2kvZ1l5ZkNlczRiN1doZkZWb3dscWlRK0EzcDdUbnVYSnoycHUrbDlzaEdVd1dqUnN5ckNEVTFVZ3BXQWRjdGs4Ukw4ekFDeWRnWnl3SVhDamFVZUtLaUMvYTlWeUEwZTY5dVBacXhtdjRhY0pWZ3pYQ2pVaS9XUkhlUjFjRWhhSzN0eDAyQWtQMnpROGEwd3k3bFZIcXNWTGFJOTlUejZZRnRKV0l0NStCYVNZeEorcWZRMzQvUVNxemJibnpoV09QSk9iZmpGRitzWlFBVUo0YzQwcENlbDFSTkgvaHJMa2xoR3lxYz0tLTk5UDFvWkpIeE12Uk56cUppZHFSN3c9PQ%3D%3D--93951192661dda26d2246d03ede9c3c8ca6cf226\nUpgrade-Insecure-Requests: 1\n\nutf8=%E2%9C%93\u0026authenticity_token=UoPkXa4uMwSgxUG1d3a7l5PodACsA9LBagoeTlLNDZWAx1kzUeVH1%2FbeJdeXMr8Z5NYkgEX%2B1kaFci3i%2F%2BV%2Fqg%3D%3D\u0026email_relay%5Baddress%5D=testaccount1%40gmail.com\u0026email_relay%5Bsupported_event_groups%5D%5B%5D=accounting\u0026email_relay%5Bsupported_event_groups%5D%5B%5D=chargebacks\u0026button=\n```\nSuccessfully added an testaccount\n{F900003}\n5) Edit the email to any email \"let us take attacker email\" and change it to the CSRF's html file .\n{F900002}\n6) Save it and click it !\nFile: ```omise_CSRF.html```\n7) Attacker email is added!\n{F900005} \n##Important\n1) The authenticity-token for a live session is used and many times! Thus making it a bit of problem\n2) The authenticity-token expires after logout so if u try it with an expired token you will get redirected to dashboard. Thus indicating CSRF was not successful.\n3) Please do check the authenticity-token of the request and html file matches.\n\nThis also indicate that CSRF token / authenticity token does not properly gets flushed and it can be re-used in that session multiple times\nRegards,\n@dark_haxor\n\n## Impact\n\nCSRF","vulnerability_information_html":"\u003ch2 id=\"summary\"\u003eSummary\u003c/h2\u003e\n\n\u003cp\u003eOnce you said that you ruby framework for making the authenticity-token which acts as a CSRF protection. You also send me this as to help me understand \u003ca title=\"https://medium.com/rubyinside/a-deep-dive-into-csrf-protection-in-rails-19fa0a42c0ef\" href=\"/redirect?url=https%3A%2F%2Fmedium.com%2Frubyinside%2Fa-deep-dive-into-csrf-protection-in-rails-19fa0a42c0ef\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://medium.com/rubyinside/a-deep-dive-into-csrf-protection-in-rails-19fa0a42c0ef\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e . After finding i found that an authenticity-token can be used many times for a particular session leading to CSRF. \u003c/p\u003e\n\n\u003ch2 id=\"steps-to-produce\"\u003eSteps to produce:\u003c/h2\u003e\n\n\u003cp\u003e1) Login and go to \u003ca title=\"https://dashboard.omise.co/test/subscriptions/new\" href=\"/redirect?url=https%3A%2F%2Fdashboard.omise.co%2Ftest%2Fsubscriptions%2Fnew\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://dashboard.omise.co/test/subscriptions/new\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\n2) Add an email and capture request and send it to repeater for checking\u003cbr\u003e\n3) Again add another email for checking \u003cbr\u003e\nFrom here we learnt that on a successfully adding we get \u003ca title=\"https://dashboard.omise.co/test/subscriptions\" href=\"/redirect?url=https%3A%2F%2Fdashboard.omise.co%2Ftest%2Fsubscriptions\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://dashboard.omise.co/test/subscriptions\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e else on a false end we would be redirected to the dashboard!\u003cbr\u003e\n\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"added2_emails.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/bfR1u5UtLABNZmRrAUREc8S6?response-content-disposition=attachment%3B%20filename%3D%22added2_emails.png%22%3B%20filename%2A%3DUTF-8%27%27added2_emails.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQTYNHLLAI%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T071102Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHZ%2BW3HUv1n%2B6aR51XKyQUoltUs4dpenL8C5Ngq%2FaRRRAiEAmfsKW6s44zslbtLbjio7lyByPFrM4HhkqWc4BlKqI%2FsqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDEk2ujSH9wgIeNJFfSqRA5L87pajd4uBiMOahwiQWY9MCcYfdnrcw1IGaRg5TpxW7DR87N3npEJ347tYQoNG4qvz83ZIfPJaoV16%2BHSbvgHCloy0L2IJebFkXavQ%2FqP76i9C%2Fflz0T%2FAY7BQexVBAB81BDbhmxnE9q9peEXcv7DxPs6yUKcdy540RKUrN7uslxSA7j3G9JiTuJ6qb2%2F4wYsuXqZAjjjsCgg1mXnpWD2MBpvjLmy20fnWfTyEpbZx69BhUOjIiXGUwMwyU3vIR8mTDDVd0lLxGqVwqo7wgDElekHdTEW3qhMPXMlt6DlI6yj8Gdba%2FBl9Vc01EccnsQcPWyVJry%2FS5ynL9DMtJAAAFirbxDGfh3YyQKCitVKKFFQ%2BXcUVp%2FSwwBBOTy19C2elhYtpl6vcpcY0%2FpxhMV%2FLT11lv%2FW2w21ED7vsm1c%2FDgyMyGhcc5jxtzWgSuplAxsWTwQc5B1WrLELk6MdDLXcvxB6lqSlYR3jek%2FEqa3e3t%2FxycmED7JcchnTpltDpgBiVe4qfO%2B85c9LeAT9plTAMKDqqv8FOusBsw37kCqQM4gZ7GwocFGWO%2Bb%2BbNa2dgEi%2Fv9cXsb1AOYUnwz%2B%2FyPyUSoTx0mdn2JtBFbkLI2hWmV1Y9Plg4ywi43mIKFY5BXMieUzgwCaeF0glcm8O%2F5kugCvuf01QuIauHjpwGSFMitZi1h52iDxD6TQNrXkM8ak7hW52tsH0VpvrBIvM3fFeRl4cr81y%2FuM3ueoyxszwreZZnbZK4WIuk8LU9YhohKDj6BRCCLOA1ZWZip14mKPOWPa8WaAzVovmI9BYDR0AxC4M%2FMywNMPj4r12n4DpTYCcHFvsA18GtoCtKML64R8uPhkQw%3D%3D\u0026amp;X-Amz-Signature=a8f19513dcd886b4cfbd81e680028a366d47fa2f7423eab1fa8b1ce0e62112cb\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/bfR1u5UtLABNZmRrAUREc8S6?response-content-disposition=attachment%3B%20filename%3D%22added2_emails.png%22%3B%20filename%2A%3DUTF-8%27%27added2_emails.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQTYNHLLAI%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T071102Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHZ%2BW3HUv1n%2B6aR51XKyQUoltUs4dpenL8C5Ngq%2FaRRRAiEAmfsKW6s44zslbtLbjio7lyByPFrM4HhkqWc4BlKqI%2FsqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDEk2ujSH9wgIeNJFfSqRA5L87pajd4uBiMOahwiQWY9MCcYfdnrcw1IGaRg5TpxW7DR87N3npEJ347tYQoNG4qvz83ZIfPJaoV16%2BHSbvgHCloy0L2IJebFkXavQ%2FqP76i9C%2Fflz0T%2FAY7BQexVBAB81BDbhmxnE9q9peEXcv7DxPs6yUKcdy540RKUrN7uslxSA7j3G9JiTuJ6qb2%2F4wYsuXqZAjjjsCgg1mXnpWD2MBpvjLmy20fnWfTyEpbZx69BhUOjIiXGUwMwyU3vIR8mTDDVd0lLxGqVwqo7wgDElekHdTEW3qhMPXMlt6DlI6yj8Gdba%2FBl9Vc01EccnsQcPWyVJry%2FS5ynL9DMtJAAAFirbxDGfh3YyQKCitVKKFFQ%2BXcUVp%2FSwwBBOTy19C2elhYtpl6vcpcY0%2FpxhMV%2FLT11lv%2FW2w21ED7vsm1c%2FDgyMyGhcc5jxtzWgSuplAxsWTwQc5B1WrLELk6MdDLXcvxB6lqSlYR3jek%2FEqa3e3t%2FxycmED7JcchnTpltDpgBiVe4qfO%2B85c9LeAT9plTAMKDqqv8FOusBsw37kCqQM4gZ7GwocFGWO%2Bb%2BbNa2dgEi%2Fv9cXsb1AOYUnwz%2B%2FyPyUSoTx0mdn2JtBFbkLI2hWmV1Y9Plg4ywi43mIKFY5BXMieUzgwCaeF0glcm8O%2F5kugCvuf01QuIauHjpwGSFMitZi1h52iDxD6TQNrXkM8ak7hW52tsH0VpvrBIvM3fFeRl4cr81y%2FuM3ueoyxszwreZZnbZK4WIuk8LU9YhohKDj6BRCCLOA1ZWZip14mKPOWPa8WaAzVovmI9BYDR0AxC4M%2FMywNMPj4r12n4DpTYCcHFvsA18GtoCtKML64R8uPhkQw%3D%3D\u0026amp;X-Amz-Signature=a8f19513dcd886b4cfbd81e680028a366d47fa2f7423eab1fa8b1ce0e62112cb\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003cbr\u003e\nThese are successfully added emails thats y we get redirected to subscriptions\u003cbr\u003e\n4) Make a CSRF of one of the adding request via burpsuite csrf maker \u003c/p\u003e\n\n\u003ch2 id=\"request-used-to-make-csrf\"\u003eRequest used to make CSRF\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ePOST /test/subscriptions HTTP/1.1\nHost: dashboard.omise.co\nUser-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/20100101 Firefox/68.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nReferer: https://dashboard.omise.co/\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 309\nDNT: 1\nConnection: close\nCookie: session=eyJpZCI6InNlc3Npb25fNWtoMWhyZ2pyY3U2c202bXh4MyIsImtleSI6IjhiOTUwZDJhNWRlZWIxYmYzN2MwNTFlMWJiY2VjM2NmIiwiYWNjb3VudCI6ImFjY291bnRfdGVzdF81anZ5NHJwM2M5aHhxcDZjYmUxIiwiZXhwaXJlc19hdCI6IjIwMjAtMDctMDlUMDA6MDY6NDJaIiwiZW1haWwiOiJhYWthc2hhZGhpa2FyaTc4NkBnbWFpbC5jb20ifQ==; session.sig=DQLQM4kaz6XyIQ26G0zwF_xuNPU; locale=en; _omisegateway_session=Y1U0b2kvZ1l5ZkNlczRiN1doZkZWb3dscWlRK0EzcDdUbnVYSnoycHUrbDlzaEdVd1dqUnN5ckNEVTFVZ3BXQWRjdGs4Ukw4ekFDeWRnWnl3SVhDamFVZUtLaUMvYTlWeUEwZTY5dVBacXhtdjRhY0pWZ3pYQ2pVaS9XUkhlUjFjRWhhSzN0eDAyQWtQMnpROGEwd3k3bFZIcXNWTGFJOTlUejZZRnRKV0l0NStCYVNZeEorcWZRMzQvUVNxemJibnpoV09QSk9iZmpGRitzWlFBVUo0YzQwcENlbDFSTkgvaHJMa2xoR3lxYz0tLTk5UDFvWkpIeE12Uk56cUppZHFSN3c9PQ%3D%3D--93951192661dda26d2246d03ede9c3c8ca6cf226\nUpgrade-Insecure-Requests: 1\n\nutf8=%E2%9C%93\u0026amp;authenticity_token=UoPkXa4uMwSgxUG1d3a7l5PodACsA9LBagoeTlLNDZWAx1kzUeVH1%2FbeJdeXMr8Z5NYkgEX%2B1kaFci3i%2F%2BV%2Fqg%3D%3D\u0026amp;email_relay%5Baddress%5D=testaccount1%40gmail.com\u0026amp;email_relay%5Bsupported_event_groups%5D%5B%5D=accounting\u0026amp;email_relay%5Bsupported_event_groups%5D%5B%5D=chargebacks\u0026amp;button=\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eSuccessfully added an testaccount\u003cbr\u003e\n\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"testacc_added_success.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/sXryM8mPmfR7Wu1goX3jsQHh?response-content-disposition=attachment%3B%20filename%3D%22testacc_added_success.png%22%3B%20filename%2A%3DUTF-8%27%27testacc_added_success.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQTYNHLLAI%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T071102Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHZ%2BW3HUv1n%2B6aR51XKyQUoltUs4dpenL8C5Ngq%2FaRRRAiEAmfsKW6s44zslbtLbjio7lyByPFrM4HhkqWc4BlKqI%2FsqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDEk2ujSH9wgIeNJFfSqRA5L87pajd4uBiMOahwiQWY9MCcYfdnrcw1IGaRg5TpxW7DR87N3npEJ347tYQoNG4qvz83ZIfPJaoV16%2BHSbvgHCloy0L2IJebFkXavQ%2FqP76i9C%2Fflz0T%2FAY7BQexVBAB81BDbhmxnE9q9peEXcv7DxPs6yUKcdy540RKUrN7uslxSA7j3G9JiTuJ6qb2%2F4wYsuXqZAjjjsCgg1mXnpWD2MBpvjLmy20fnWfTyEpbZx69BhUOjIiXGUwMwyU3vIR8mTDDVd0lLxGqVwqo7wgDElekHdTEW3qhMPXMlt6DlI6yj8Gdba%2FBl9Vc01EccnsQcPWyVJry%2FS5ynL9DMtJAAAFirbxDGfh3YyQKCitVKKFFQ%2BXcUVp%2FSwwBBOTy19C2elhYtpl6vcpcY0%2FpxhMV%2FLT11lv%2FW2w21ED7vsm1c%2FDgyMyGhcc5jxtzWgSuplAxsWTwQc5B1WrLELk6MdDLXcvxB6lqSlYR3jek%2FEqa3e3t%2FxycmED7JcchnTpltDpgBiVe4qfO%2B85c9LeAT9plTAMKDqqv8FOusBsw37kCqQM4gZ7GwocFGWO%2Bb%2BbNa2dgEi%2Fv9cXsb1AOYUnwz%2B%2FyPyUSoTx0mdn2JtBFbkLI2hWmV1Y9Plg4ywi43mIKFY5BXMieUzgwCaeF0glcm8O%2F5kugCvuf01QuIauHjpwGSFMitZi1h52iDxD6TQNrXkM8ak7hW52tsH0VpvrBIvM3fFeRl4cr81y%2FuM3ueoyxszwreZZnbZK4WIuk8LU9YhohKDj6BRCCLOA1ZWZip14mKPOWPa8WaAzVovmI9BYDR0AxC4M%2FMywNMPj4r12n4DpTYCcHFvsA18GtoCtKML64R8uPhkQw%3D%3D\u0026amp;X-Amz-Signature=b06dafcec7d4289c4421fe66ee6adbe570d38a185de0e3b9aff7713f3edaf11b\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/sXryM8mPmfR7Wu1goX3jsQHh?response-content-disposition=attachment%3B%20filename%3D%22testacc_added_success.png%22%3B%20filename%2A%3DUTF-8%27%27testacc_added_success.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQTYNHLLAI%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T071102Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHZ%2BW3HUv1n%2B6aR51XKyQUoltUs4dpenL8C5Ngq%2FaRRRAiEAmfsKW6s44zslbtLbjio7lyByPFrM4HhkqWc4BlKqI%2FsqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDEk2ujSH9wgIeNJFfSqRA5L87pajd4uBiMOahwiQWY9MCcYfdnrcw1IGaRg5TpxW7DR87N3npEJ347tYQoNG4qvz83ZIfPJaoV16%2BHSbvgHCloy0L2IJebFkXavQ%2FqP76i9C%2Fflz0T%2FAY7BQexVBAB81BDbhmxnE9q9peEXcv7DxPs6yUKcdy540RKUrN7uslxSA7j3G9JiTuJ6qb2%2F4wYsuXqZAjjjsCgg1mXnpWD2MBpvjLmy20fnWfTyEpbZx69BhUOjIiXGUwMwyU3vIR8mTDDVd0lLxGqVwqo7wgDElekHdTEW3qhMPXMlt6DlI6yj8Gdba%2FBl9Vc01EccnsQcPWyVJry%2FS5ynL9DMtJAAAFirbxDGfh3YyQKCitVKKFFQ%2BXcUVp%2FSwwBBOTy19C2elhYtpl6vcpcY0%2FpxhMV%2FLT11lv%2FW2w21ED7vsm1c%2FDgyMyGhcc5jxtzWgSuplAxsWTwQc5B1WrLELk6MdDLXcvxB6lqSlYR3jek%2FEqa3e3t%2FxycmED7JcchnTpltDpgBiVe4qfO%2B85c9LeAT9plTAMKDqqv8FOusBsw37kCqQM4gZ7GwocFGWO%2Bb%2BbNa2dgEi%2Fv9cXsb1AOYUnwz%2B%2FyPyUSoTx0mdn2JtBFbkLI2hWmV1Y9Plg4ywi43mIKFY5BXMieUzgwCaeF0glcm8O%2F5kugCvuf01QuIauHjpwGSFMitZi1h52iDxD6TQNrXkM8ak7hW52tsH0VpvrBIvM3fFeRl4cr81y%2FuM3ueoyxszwreZZnbZK4WIuk8LU9YhohKDj6BRCCLOA1ZWZip14mKPOWPa8WaAzVovmI9BYDR0AxC4M%2FMywNMPj4r12n4DpTYCcHFvsA18GtoCtKML64R8uPhkQw%3D%3D\u0026amp;X-Amz-Signature=b06dafcec7d4289c4421fe66ee6adbe570d38a185de0e3b9aff7713f3edaf11b\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003cbr\u003e\n5) Edit the email to any email \u0026quot;let us take attacker email\u0026quot; and change it to the CSRF\u0026#39;s html file .\u003cbr\u003e\n\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"CSRF_added_attacker_email.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/cxaYhjrfyP4vbxZ1NmWnun3u?response-content-disposition=attachment%3B%20filename%3D%22CSRF_added_attacker_email.png%22%3B%20filename%2A%3DUTF-8%27%27CSRF_added_attacker_email.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQTYNHLLAI%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T071102Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHZ%2BW3HUv1n%2B6aR51XKyQUoltUs4dpenL8C5Ngq%2FaRRRAiEAmfsKW6s44zslbtLbjio7lyByPFrM4HhkqWc4BlKqI%2FsqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDEk2ujSH9wgIeNJFfSqRA5L87pajd4uBiMOahwiQWY9MCcYfdnrcw1IGaRg5TpxW7DR87N3npEJ347tYQoNG4qvz83ZIfPJaoV16%2BHSbvgHCloy0L2IJebFkXavQ%2FqP76i9C%2Fflz0T%2FAY7BQexVBAB81BDbhmxnE9q9peEXcv7DxPs6yUKcdy540RKUrN7uslxSA7j3G9JiTuJ6qb2%2F4wYsuXqZAjjjsCgg1mXnpWD2MBpvjLmy20fnWfTyEpbZx69BhUOjIiXGUwMwyU3vIR8mTDDVd0lLxGqVwqo7wgDElekHdTEW3qhMPXMlt6DlI6yj8Gdba%2FBl9Vc01EccnsQcPWyVJry%2FS5ynL9DMtJAAAFirbxDGfh3YyQKCitVKKFFQ%2BXcUVp%2FSwwBBOTy19C2elhYtpl6vcpcY0%2FpxhMV%2FLT11lv%2FW2w21ED7vsm1c%2FDgyMyGhcc5jxtzWgSuplAxsWTwQc5B1WrLELk6MdDLXcvxB6lqSlYR3jek%2FEqa3e3t%2FxycmED7JcchnTpltDpgBiVe4qfO%2B85c9LeAT9plTAMKDqqv8FOusBsw37kCqQM4gZ7GwocFGWO%2Bb%2BbNa2dgEi%2Fv9cXsb1AOYUnwz%2B%2FyPyUSoTx0mdn2JtBFbkLI2hWmV1Y9Plg4ywi43mIKFY5BXMieUzgwCaeF0glcm8O%2F5kugCvuf01QuIauHjpwGSFMitZi1h52iDxD6TQNrXkM8ak7hW52tsH0VpvrBIvM3fFeRl4cr81y%2FuM3ueoyxszwreZZnbZK4WIuk8LU9YhohKDj6BRCCLOA1ZWZip14mKPOWPa8WaAzVovmI9BYDR0AxC4M%2FMywNMPj4r12n4DpTYCcHFvsA18GtoCtKML64R8uPhkQw%3D%3D\u0026amp;X-Amz-Signature=e3e77e20af4796ba5ddb92b59219ef56c6a14f9db553b370c40127b5b68b46d1\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/cxaYhjrfyP4vbxZ1NmWnun3u?response-content-disposition=attachment%3B%20filename%3D%22CSRF_added_attacker_email.png%22%3B%20filename%2A%3DUTF-8%27%27CSRF_added_attacker_email.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQTYNHLLAI%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T071102Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHZ%2BW3HUv1n%2B6aR51XKyQUoltUs4dpenL8C5Ngq%2FaRRRAiEAmfsKW6s44zslbtLbjio7lyByPFrM4HhkqWc4BlKqI%2FsqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDEk2ujSH9wgIeNJFfSqRA5L87pajd4uBiMOahwiQWY9MCcYfdnrcw1IGaRg5TpxW7DR87N3npEJ347tYQoNG4qvz83ZIfPJaoV16%2BHSbvgHCloy0L2IJebFkXavQ%2FqP76i9C%2Fflz0T%2FAY7BQexVBAB81BDbhmxnE9q9peEXcv7DxPs6yUKcdy540RKUrN7uslxSA7j3G9JiTuJ6qb2%2F4wYsuXqZAjjjsCgg1mXnpWD2MBpvjLmy20fnWfTyEpbZx69BhUOjIiXGUwMwyU3vIR8mTDDVd0lLxGqVwqo7wgDElekHdTEW3qhMPXMlt6DlI6yj8Gdba%2FBl9Vc01EccnsQcPWyVJry%2FS5ynL9DMtJAAAFirbxDGfh3YyQKCitVKKFFQ%2BXcUVp%2FSwwBBOTy19C2elhYtpl6vcpcY0%2FpxhMV%2FLT11lv%2FW2w21ED7vsm1c%2FDgyMyGhcc5jxtzWgSuplAxsWTwQc5B1WrLELk6MdDLXcvxB6lqSlYR3jek%2FEqa3e3t%2FxycmED7JcchnTpltDpgBiVe4qfO%2B85c9LeAT9plTAMKDqqv8FOusBsw37kCqQM4gZ7GwocFGWO%2Bb%2BbNa2dgEi%2Fv9cXsb1AOYUnwz%2B%2FyPyUSoTx0mdn2JtBFbkLI2hWmV1Y9Plg4ywi43mIKFY5BXMieUzgwCaeF0glcm8O%2F5kugCvuf01QuIauHjpwGSFMitZi1h52iDxD6TQNrXkM8ak7hW52tsH0VpvrBIvM3fFeRl4cr81y%2FuM3ueoyxszwreZZnbZK4WIuk8LU9YhohKDj6BRCCLOA1ZWZip14mKPOWPa8WaAzVovmI9BYDR0AxC4M%2FMywNMPj4r12n4DpTYCcHFvsA18GtoCtKML64R8uPhkQw%3D%3D\u0026amp;X-Amz-Signature=e3e77e20af4796ba5ddb92b59219ef56c6a14f9db553b370c40127b5b68b46d1\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003cbr\u003e\n6) Save it and click it !\u003cbr\u003e\nFile: \u003ccode\u003eomise_CSRF.html\u003c/code\u003e\u003cbr\u003e\n7) Attacker email is added!\u003cbr\u003e\n\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"attacker_accoint_added_successfully.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/CHYrEmN7KUHyEy8H7MzFWqkn?response-content-disposition=attachment%3B%20filename%3D%22attacker_accoint_added_successfully.png%22%3B%20filename%2A%3DUTF-8%27%27attacker_accoint_added_successfully.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQTYNHLLAI%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T071102Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHZ%2BW3HUv1n%2B6aR51XKyQUoltUs4dpenL8C5Ngq%2FaRRRAiEAmfsKW6s44zslbtLbjio7lyByPFrM4HhkqWc4BlKqI%2FsqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDEk2ujSH9wgIeNJFfSqRA5L87pajd4uBiMOahwiQWY9MCcYfdnrcw1IGaRg5TpxW7DR87N3npEJ347tYQoNG4qvz83ZIfPJaoV16%2BHSbvgHCloy0L2IJebFkXavQ%2FqP76i9C%2Fflz0T%2FAY7BQexVBAB81BDbhmxnE9q9peEXcv7DxPs6yUKcdy540RKUrN7uslxSA7j3G9JiTuJ6qb2%2F4wYsuXqZAjjjsCgg1mXnpWD2MBpvjLmy20fnWfTyEpbZx69BhUOjIiXGUwMwyU3vIR8mTDDVd0lLxGqVwqo7wgDElekHdTEW3qhMPXMlt6DlI6yj8Gdba%2FBl9Vc01EccnsQcPWyVJry%2FS5ynL9DMtJAAAFirbxDGfh3YyQKCitVKKFFQ%2BXcUVp%2FSwwBBOTy19C2elhYtpl6vcpcY0%2FpxhMV%2FLT11lv%2FW2w21ED7vsm1c%2FDgyMyGhcc5jxtzWgSuplAxsWTwQc5B1WrLELk6MdDLXcvxB6lqSlYR3jek%2FEqa3e3t%2FxycmED7JcchnTpltDpgBiVe4qfO%2B85c9LeAT9plTAMKDqqv8FOusBsw37kCqQM4gZ7GwocFGWO%2Bb%2BbNa2dgEi%2Fv9cXsb1AOYUnwz%2B%2FyPyUSoTx0mdn2JtBFbkLI2hWmV1Y9Plg4ywi43mIKFY5BXMieUzgwCaeF0glcm8O%2F5kugCvuf01QuIauHjpwGSFMitZi1h52iDxD6TQNrXkM8ak7hW52tsH0VpvrBIvM3fFeRl4cr81y%2FuM3ueoyxszwreZZnbZK4WIuk8LU9YhohKDj6BRCCLOA1ZWZip14mKPOWPa8WaAzVovmI9BYDR0AxC4M%2FMywNMPj4r12n4DpTYCcHFvsA18GtoCtKML64R8uPhkQw%3D%3D\u0026amp;X-Amz-Signature=22edfc90357b1c1cb504ca658beb984a2ad8948b5fc3f5b428f39af95b08f1d4\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/CHYrEmN7KUHyEy8H7MzFWqkn?response-content-disposition=attachment%3B%20filename%3D%22attacker_accoint_added_successfully.png%22%3B%20filename%2A%3DUTF-8%27%27attacker_accoint_added_successfully.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQTYNHLLAI%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T071102Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHZ%2BW3HUv1n%2B6aR51XKyQUoltUs4dpenL8C5Ngq%2FaRRRAiEAmfsKW6s44zslbtLbjio7lyByPFrM4HhkqWc4BlKqI%2FsqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDEk2ujSH9wgIeNJFfSqRA5L87pajd4uBiMOahwiQWY9MCcYfdnrcw1IGaRg5TpxW7DR87N3npEJ347tYQoNG4qvz83ZIfPJaoV16%2BHSbvgHCloy0L2IJebFkXavQ%2FqP76i9C%2Fflz0T%2FAY7BQexVBAB81BDbhmxnE9q9peEXcv7DxPs6yUKcdy540RKUrN7uslxSA7j3G9JiTuJ6qb2%2F4wYsuXqZAjjjsCgg1mXnpWD2MBpvjLmy20fnWfTyEpbZx69BhUOjIiXGUwMwyU3vIR8mTDDVd0lLxGqVwqo7wgDElekHdTEW3qhMPXMlt6DlI6yj8Gdba%2FBl9Vc01EccnsQcPWyVJry%2FS5ynL9DMtJAAAFirbxDGfh3YyQKCitVKKFFQ%2BXcUVp%2FSwwBBOTy19C2elhYtpl6vcpcY0%2FpxhMV%2FLT11lv%2FW2w21ED7vsm1c%2FDgyMyGhcc5jxtzWgSuplAxsWTwQc5B1WrLELk6MdDLXcvxB6lqSlYR3jek%2FEqa3e3t%2FxycmED7JcchnTpltDpgBiVe4qfO%2B85c9LeAT9plTAMKDqqv8FOusBsw37kCqQM4gZ7GwocFGWO%2Bb%2BbNa2dgEi%2Fv9cXsb1AOYUnwz%2B%2FyPyUSoTx0mdn2JtBFbkLI2hWmV1Y9Plg4ywi43mIKFY5BXMieUzgwCaeF0glcm8O%2F5kugCvuf01QuIauHjpwGSFMitZi1h52iDxD6TQNrXkM8ak7hW52tsH0VpvrBIvM3fFeRl4cr81y%2FuM3ueoyxszwreZZnbZK4WIuk8LU9YhohKDj6BRCCLOA1ZWZip14mKPOWPa8WaAzVovmI9BYDR0AxC4M%2FMywNMPj4r12n4DpTYCcHFvsA18GtoCtKML64R8uPhkQw%3D%3D\u0026amp;X-Amz-Signature=22edfc90357b1c1cb504ca658beb984a2ad8948b5fc3f5b428f39af95b08f1d4\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e \u003c/p\u003e\n\n\u003ch2 id=\"important\"\u003eImportant\u003c/h2\u003e\n\n\u003cp\u003e1) The authenticity-token for a live session is used and many times! Thus making it a bit of problem\u003cbr\u003e\n2) The authenticity-token expires after logout so if u try it with an expired token you will get redirected to dashboard. Thus indicating CSRF was not successful.\u003cbr\u003e\n3) Please do check the authenticity-token of the request and html file matches.\u003c/p\u003e\n\n\u003cp\u003eThis also indicate that CSRF token / authenticity token does not properly gets flushed and it can be re-used in that session multiple times\u003cbr\u003e\nRegards,\u003cbr\u003e\n\u003ca href=\"/dark_haxor\"\u003e@dark_haxor\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eCSRF\u003c/p\u003e\n","weakness":{"id":45,"name":"Cross-Site Request Forgery (CSRF)"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":899996,"file_name":"added2_emails.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/bfR1u5UtLABNZmRrAUREc8S6?response-content-disposition=attachment%3B%20filename%3D%22added2_emails.png%22%3B%20filename%2A%3DUTF-8%27%27added2_emails.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQTYNHLLAI%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T071102Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHZ%2BW3HUv1n%2B6aR51XKyQUoltUs4dpenL8C5Ngq%2FaRRRAiEAmfsKW6s44zslbtLbjio7lyByPFrM4HhkqWc4BlKqI%2FsqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDEk2ujSH9wgIeNJFfSqRA5L87pajd4uBiMOahwiQWY9MCcYfdnrcw1IGaRg5TpxW7DR87N3npEJ347tYQoNG4qvz83ZIfPJaoV16%2BHSbvgHCloy0L2IJebFkXavQ%2FqP76i9C%2Fflz0T%2FAY7BQexVBAB81BDbhmxnE9q9peEXcv7DxPs6yUKcdy540RKUrN7uslxSA7j3G9JiTuJ6qb2%2F4wYsuXqZAjjjsCgg1mXnpWD2MBpvjLmy20fnWfTyEpbZx69BhUOjIiXGUwMwyU3vIR8mTDDVd0lLxGqVwqo7wgDElekHdTEW3qhMPXMlt6DlI6yj8Gdba%2FBl9Vc01EccnsQcPWyVJry%2FS5ynL9DMtJAAAFirbxDGfh3YyQKCitVKKFFQ%2BXcUVp%2FSwwBBOTy19C2elhYtpl6vcpcY0%2FpxhMV%2FLT11lv%2FW2w21ED7vsm1c%2FDgyMyGhcc5jxtzWgSuplAxsWTwQc5B1WrLELk6MdDLXcvxB6lqSlYR3jek%2FEqa3e3t%2FxycmED7JcchnTpltDpgBiVe4qfO%2B85c9LeAT9plTAMKDqqv8FOusBsw37kCqQM4gZ7GwocFGWO%2Bb%2BbNa2dgEi%2Fv9cXsb1AOYUnwz%2B%2FyPyUSoTx0mdn2JtBFbkLI2hWmV1Y9Plg4ywi43mIKFY5BXMieUzgwCaeF0glcm8O%2F5kugCvuf01QuIauHjpwGSFMitZi1h52iDxD6TQNrXkM8ak7hW52tsH0VpvrBIvM3fFeRl4cr81y%2FuM3ueoyxszwreZZnbZK4WIuk8LU9YhohKDj6BRCCLOA1ZWZip14mKPOWPa8WaAzVovmI9BYDR0AxC4M%2FMywNMPj4r12n4DpTYCcHFvsA18GtoCtKML64R8uPhkQw%3D%3D\u0026X-Amz-Signature=a8f19513dcd886b4cfbd81e680028a366d47fa2f7423eab1fa8b1ce0e62112cb","file_size":153096,"type":"image/png"},{"id":900002,"file_name":"CSRF_added_attacker_email.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/cxaYhjrfyP4vbxZ1NmWnun3u?response-content-disposition=attachment%3B%20filename%3D%22CSRF_added_attacker_email.png%22%3B%20filename%2A%3DUTF-8%27%27CSRF_added_attacker_email.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQTYNHLLAI%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T071102Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHZ%2BW3HUv1n%2B6aR51XKyQUoltUs4dpenL8C5Ngq%2FaRRRAiEAmfsKW6s44zslbtLbjio7lyByPFrM4HhkqWc4BlKqI%2FsqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDEk2ujSH9wgIeNJFfSqRA5L87pajd4uBiMOahwiQWY9MCcYfdnrcw1IGaRg5TpxW7DR87N3npEJ347tYQoNG4qvz83ZIfPJaoV16%2BHSbvgHCloy0L2IJebFkXavQ%2FqP76i9C%2Fflz0T%2FAY7BQexVBAB81BDbhmxnE9q9peEXcv7DxPs6yUKcdy540RKUrN7uslxSA7j3G9JiTuJ6qb2%2F4wYsuXqZAjjjsCgg1mXnpWD2MBpvjLmy20fnWfTyEpbZx69BhUOjIiXGUwMwyU3vIR8mTDDVd0lLxGqVwqo7wgDElekHdTEW3qhMPXMlt6DlI6yj8Gdba%2FBl9Vc01EccnsQcPWyVJry%2FS5ynL9DMtJAAAFirbxDGfh3YyQKCitVKKFFQ%2BXcUVp%2FSwwBBOTy19C2elhYtpl6vcpcY0%2FpxhMV%2FLT11lv%2FW2w21ED7vsm1c%2FDgyMyGhcc5jxtzWgSuplAxsWTwQc5B1WrLELk6MdDLXcvxB6lqSlYR3jek%2FEqa3e3t%2FxycmED7JcchnTpltDpgBiVe4qfO%2B85c9LeAT9plTAMKDqqv8FOusBsw37kCqQM4gZ7GwocFGWO%2Bb%2BbNa2dgEi%2Fv9cXsb1AOYUnwz%2B%2FyPyUSoTx0mdn2JtBFbkLI2hWmV1Y9Plg4ywi43mIKFY5BXMieUzgwCaeF0glcm8O%2F5kugCvuf01QuIauHjpwGSFMitZi1h52iDxD6TQNrXkM8ak7hW52tsH0VpvrBIvM3fFeRl4cr81y%2FuM3ueoyxszwreZZnbZK4WIuk8LU9YhohKDj6BRCCLOA1ZWZip14mKPOWPa8WaAzVovmI9BYDR0AxC4M%2FMywNMPj4r12n4DpTYCcHFvsA18GtoCtKML64R8uPhkQw%3D%3D\u0026X-Amz-Signature=e3e77e20af4796ba5ddb92b59219ef56c6a14f9db553b370c40127b5b68b46d1","file_size":103696,"type":"image/png"},{"id":900003,"file_name":"testacc_added_success.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/sXryM8mPmfR7Wu1goX3jsQHh?response-content-disposition=attachment%3B%20filename%3D%22testacc_added_success.png%22%3B%20filename%2A%3DUTF-8%27%27testacc_added_success.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQTYNHLLAI%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T071102Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHZ%2BW3HUv1n%2B6aR51XKyQUoltUs4dpenL8C5Ngq%2FaRRRAiEAmfsKW6s44zslbtLbjio7lyByPFrM4HhkqWc4BlKqI%2FsqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDEk2ujSH9wgIeNJFfSqRA5L87pajd4uBiMOahwiQWY9MCcYfdnrcw1IGaRg5TpxW7DR87N3npEJ347tYQoNG4qvz83ZIfPJaoV16%2BHSbvgHCloy0L2IJebFkXavQ%2FqP76i9C%2Fflz0T%2FAY7BQexVBAB81BDbhmxnE9q9peEXcv7DxPs6yUKcdy540RKUrN7uslxSA7j3G9JiTuJ6qb2%2F4wYsuXqZAjjjsCgg1mXnpWD2MBpvjLmy20fnWfTyEpbZx69BhUOjIiXGUwMwyU3vIR8mTDDVd0lLxGqVwqo7wgDElekHdTEW3qhMPXMlt6DlI6yj8Gdba%2FBl9Vc01EccnsQcPWyVJry%2FS5ynL9DMtJAAAFirbxDGfh3YyQKCitVKKFFQ%2BXcUVp%2FSwwBBOTy19C2elhYtpl6vcpcY0%2FpxhMV%2FLT11lv%2FW2w21ED7vsm1c%2FDgyMyGhcc5jxtzWgSuplAxsWTwQc5B1WrLELk6MdDLXcvxB6lqSlYR3jek%2FEqa3e3t%2FxycmED7JcchnTpltDpgBiVe4qfO%2B85c9LeAT9plTAMKDqqv8FOusBsw37kCqQM4gZ7GwocFGWO%2Bb%2BbNa2dgEi%2Fv9cXsb1AOYUnwz%2B%2FyPyUSoTx0mdn2JtBFbkLI2hWmV1Y9Plg4ywi43mIKFY5BXMieUzgwCaeF0glcm8O%2F5kugCvuf01QuIauHjpwGSFMitZi1h52iDxD6TQNrXkM8ak7hW52tsH0VpvrBIvM3fFeRl4cr81y%2FuM3ueoyxszwreZZnbZK4WIuk8LU9YhohKDj6BRCCLOA1ZWZip14mKPOWPa8WaAzVovmI9BYDR0AxC4M%2FMywNMPj4r12n4DpTYCcHFvsA18GtoCtKML64R8uPhkQw%3D%3D\u0026X-Amz-Signature=b06dafcec7d4289c4421fe66ee6adbe570d38a185de0e3b9aff7713f3edaf11b","file_size":137257,"type":"image/png"},{"id":900005,"file_name":"attacker_accoint_added_successfully.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/CHYrEmN7KUHyEy8H7MzFWqkn?response-content-disposition=attachment%3B%20filename%3D%22attacker_accoint_added_successfully.png%22%3B%20filename%2A%3DUTF-8%27%27attacker_accoint_added_successfully.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQTYNHLLAI%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T071102Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHZ%2BW3HUv1n%2B6aR51XKyQUoltUs4dpenL8C5Ngq%2FaRRRAiEAmfsKW6s44zslbtLbjio7lyByPFrM4HhkqWc4BlKqI%2FsqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDEk2ujSH9wgIeNJFfSqRA5L87pajd4uBiMOahwiQWY9MCcYfdnrcw1IGaRg5TpxW7DR87N3npEJ347tYQoNG4qvz83ZIfPJaoV16%2BHSbvgHCloy0L2IJebFkXavQ%2FqP76i9C%2Fflz0T%2FAY7BQexVBAB81BDbhmxnE9q9peEXcv7DxPs6yUKcdy540RKUrN7uslxSA7j3G9JiTuJ6qb2%2F4wYsuXqZAjjjsCgg1mXnpWD2MBpvjLmy20fnWfTyEpbZx69BhUOjIiXGUwMwyU3vIR8mTDDVd0lLxGqVwqo7wgDElekHdTEW3qhMPXMlt6DlI6yj8Gdba%2FBl9Vc01EccnsQcPWyVJry%2FS5ynL9DMtJAAAFirbxDGfh3YyQKCitVKKFFQ%2BXcUVp%2FSwwBBOTy19C2elhYtpl6vcpcY0%2FpxhMV%2FLT11lv%2FW2w21ED7vsm1c%2FDgyMyGhcc5jxtzWgSuplAxsWTwQc5B1WrLELk6MdDLXcvxB6lqSlYR3jek%2FEqa3e3t%2FxycmED7JcchnTpltDpgBiVe4qfO%2B85c9LeAT9plTAMKDqqv8FOusBsw37kCqQM4gZ7GwocFGWO%2Bb%2BbNa2dgEi%2Fv9cXsb1AOYUnwz%2B%2FyPyUSoTx0mdn2JtBFbkLI2hWmV1Y9Plg4ywi43mIKFY5BXMieUzgwCaeF0glcm8O%2F5kugCvuf01QuIauHjpwGSFMitZi1h52iDxD6TQNrXkM8ak7hW52tsH0VpvrBIvM3fFeRl4cr81y%2FuM3ueoyxszwreZZnbZK4WIuk8LU9YhohKDj6BRCCLOA1ZWZip14mKPOWPa8WaAzVovmI9BYDR0AxC4M%2FMywNMPj4r12n4DpTYCcHFvsA18GtoCtKML64R8uPhkQw%3D%3D\u0026X-Amz-Signature=22edfc90357b1c1cb504ca658beb984a2ad8948b5fc3f5b428f39af95b08f1d4","file_size":128344,"type":"image/png"},{"id":900006,"file_name":"omise_CSRF.html","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/7vD6JfzMaCGd25ggHJq8AMc4?response-content-disposition=attachment%3B%20filename%3D%22omise_CSRF.html%22%3B%20filename%2A%3DUTF-8%27%27omise_CSRF.html\u0026response-content-type=application%2Foctet-stream\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQTYNHLLAI%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T071102Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHZ%2BW3HUv1n%2B6aR51XKyQUoltUs4dpenL8C5Ngq%2FaRRRAiEAmfsKW6s44zslbtLbjio7lyByPFrM4HhkqWc4BlKqI%2FsqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDEk2ujSH9wgIeNJFfSqRA5L87pajd4uBiMOahwiQWY9MCcYfdnrcw1IGaRg5TpxW7DR87N3npEJ347tYQoNG4qvz83ZIfPJaoV16%2BHSbvgHCloy0L2IJebFkXavQ%2FqP76i9C%2Fflz0T%2FAY7BQexVBAB81BDbhmxnE9q9peEXcv7DxPs6yUKcdy540RKUrN7uslxSA7j3G9JiTuJ6qb2%2F4wYsuXqZAjjjsCgg1mXnpWD2MBpvjLmy20fnWfTyEpbZx69BhUOjIiXGUwMwyU3vIR8mTDDVd0lLxGqVwqo7wgDElekHdTEW3qhMPXMlt6DlI6yj8Gdba%2FBl9Vc01EccnsQcPWyVJry%2FS5ynL9DMtJAAAFirbxDGfh3YyQKCitVKKFFQ%2BXcUVp%2FSwwBBOTy19C2elhYtpl6vcpcY0%2FpxhMV%2FLT11lv%2FW2w21ED7vsm1c%2FDgyMyGhcc5jxtzWgSuplAxsWTwQc5B1WrLELk6MdDLXcvxB6lqSlYR3jek%2FEqa3e3t%2FxycmED7JcchnTpltDpgBiVe4qfO%2B85c9LeAT9plTAMKDqqv8FOusBsw37kCqQM4gZ7GwocFGWO%2Bb%2BbNa2dgEi%2Fv9cXsb1AOYUnwz%2B%2FyPyUSoTx0mdn2JtBFbkLI2hWmV1Y9Plg4ywi43mIKFY5BXMieUzgwCaeF0glcm8O%2F5kugCvuf01QuIauHjpwGSFMitZi1h52iDxD6TQNrXkM8ak7hW52tsH0VpvrBIvM3fFeRl4cr81y%2FuM3ueoyxszwreZZnbZK4WIuk8LU9YhohKDj6BRCCLOA1ZWZip14mKPOWPa8WaAzVovmI9BYDR0AxC4M%2FMywNMPj4r12n4DpTYCcHFvsA18GtoCtKML64R8uPhkQw%3D%3D\u0026X-Amz-Signature=ebdb5444da262cca867357c24deb3daa797ac5385e4d2cfb7a000dd0941d7ee6","file_size":965,"type":"text/html"}],"allow_singular_disclosure_at":null,"vote_count":2,"voters":["sa1tama0","mr0bart"],"structured_scope":{"databaseId":16435,"asset_type":"URL","asset_identifier":"dashboard.omise.co","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":8544233,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello thank you for the research. \n\nI will check this with team but from first glance this is not really how CSRF protection works. In your demo you copy the CSRF token. What CSRF actually is protection against is arbitary crafted messages from a third party and exploiting Same Origin Policy and the fact that browsers attach cookies by default to a domain it have cookies for. Regardless of who created the payload. \n\nSo with that in mind. Even if it could be argued that it is a degradation of CSRF protection and it should be a new token on each request. The fact is that a session token as long as not leaked, protects against CSRF and does the job it was intended for. The most common case being you as a attacker craft a arbitary action and user in another tab (but same browser process) will click on something. The cookies are send and the action is taken. But since we have another token, unknown to the attacker, this will not work. \n\nFor the above to work, not only is CSRF done but somekind of MITM. And that would break many other things.\nSo that is my first reaction, will check what some other thinking.","markdown_message":"\u003cp\u003eHello thank you for the research. \u003c/p\u003e\n\n\u003cp\u003eI will check this with team but from first glance this is not really how CSRF protection works. In your demo you copy the CSRF token. What CSRF actually is protection against is arbitary crafted messages from a third party and exploiting Same Origin Policy and the fact that browsers attach cookies by default to a domain it have cookies for. Regardless of who created the payload. \u003c/p\u003e\n\n\u003cp\u003eSo with that in mind. Even if it could be argued that it is a degradation of CSRF protection and it should be a new token on each request. The fact is that a session token as long as not leaked, protects against CSRF and does the job it was intended for. The most common case being you as a attacker craft a arbitary action and user in another tab (but same browser process) will click on something. The cookies are send and the action is taken. But since we have another token, unknown to the attacker, this will not work. \u003c/p\u003e\n\n\u003cp\u003eFor the above to work, not only is CSRF done but somekind of MITM. And that would break many other things.\u003cbr\u003e\nSo that is my first reaction, will check what some other thinking.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-07-09T03:13:38.483Z","updated_at":"2020-07-09T03:13:38.483Z","actor":{"username":"hardymansen","cleared":false,"url":"/hardymansen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/268/510/a5be384b5218b68c9ed291e2649c3a659f9baeb5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"omise","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8544285,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @hardymansen,\nFor the above to work one live token is enough if the user does explicit logout i.e. he exits the browser without logout ...and  you are right! Everytime a new authentic-token is generated but not expired unless logout. \nI remember there was a time i had seen a header! Called  X-CSRF-TOKEN in dashboard.omise.co what happened to it ?","markdown_message":"\u003cp\u003eHi \u003ca href=\"/hardymansen\"\u003e@hardymansen\u003c/a\u003e,\u003cbr\u003e\nFor the above to work one live token is enough if the user does explicit logout i.e. he exits the browser without logout ...and  you are right! Everytime a new authentic-token is generated but not expired unless logout. \u003cbr\u003e\nI remember there was a time i had seen a header! Called  X-CSRF-TOKEN in dashboard.omise.co what happened to it ?\u003c/p\u003e\n","automated_response":false,"created_at":"2020-07-09T03:28:40.755Z","updated_at":"2020-07-09T03:31:08.374Z","actor":{"username":"d4rk_h4xor","cleared":false,"url":"/d4rk_h4xor","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/hgiyPReNEv3WRS9yKSq8aj3C/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"omise","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8544307,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I talked with team, and this is basically a design decision to not have a new token each request. It does not add enough of protection and cause many problems example, if a user fills in a form incorrectly, press back in the browser and tries to submit it again. With new tokens each time, that will fail. \nBasing our token on the session, we think gives us the best of both world. A attacker cannot make up CSRF request and any token is always renewed at maximum 24 hours or when the user invalidates the session.\n\nYou can read some more information here: https://security.stackexchange.com/questions/22903/why-refresh-csrf-token-per-form-request/22936#22936","markdown_message":"\u003cp\u003eI talked with team, and this is basically a design decision to not have a new token each request. It does not add enough of protection and cause many problems example, if a user fills in a form incorrectly, press back in the browser and tries to submit it again. With new tokens each time, that will fail. \u003cbr\u003e\nBasing our token on the session, we think gives us the best of both world. A attacker cannot make up CSRF request and any token is always renewed at maximum 24 hours or when the user invalidates the session.\u003c/p\u003e\n\n\u003cp\u003eYou can read some more information here: \u003ca title=\"https://security.stackexchange.com/questions/22903/why-refresh-csrf-token-per-form-request/22936#22936\" href=\"/redirect?url=https%3A%2F%2Fsecurity.stackexchange.com%2Fquestions%2F22903%2Fwhy-refresh-csrf-token-per-form-request%2F22936%2322936\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://security.stackexchange.com/questions/22903/why-refresh-csrf-token-per-form-request/22936#22936\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2020-07-09T03:35:52.788Z","updated_at":"2020-07-09T03:35:52.788Z","actor":{"username":"hardymansen","cleared":false,"url":"/hardymansen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/268/510/a5be384b5218b68c9ed291e2649c3a659f9baeb5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"omise","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8544309,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"Closing this under advice / best practises.","markdown_message":"\u003cp\u003eClosing this under advice / best practises.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-07-09T03:36:38.519Z","updated_at":"2020-07-09T03:36:38.519Z","actor":{"username":"hardymansen","cleared":false,"url":"/hardymansen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/268/510/a5be384b5218b68c9ed291e2649c3a659f9baeb5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"omise","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8544320,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-07-09T03:41:30.039Z","updated_at":"2020-07-09T03:41:30.039Z","first_to_agree":true,"actor":{"username":"d4rk_h4xor","cleared":false,"url":"/d4rk_h4xor","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/hgiyPReNEv3WRS9yKSq8aj3C/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"omise","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8544341,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Can  you please allow to disclose it ? \nPeople will need it before they come storming when they know the X CSRF HEADER is missing.","markdown_message":"\u003cp\u003eCan  you please allow to disclose it ? \u003cbr\u003e\nPeople will need it before they come storming when they know the X CSRF HEADER is missing.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-07-09T03:48:26.199Z","updated_at":"2020-07-09T03:48:26.199Z","actor":{"username":"d4rk_h4xor","cleared":false,"url":"/d4rk_h4xor","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/hgiyPReNEv3WRS9yKSq8aj3C/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"omise","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8644903,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Ok i under stood the whole","markdown_message":"\u003cp\u003eOk i under stood the whole\u003c/p\u003e\n","automated_response":false,"created_at":"2020-07-19T11:49:07.183Z","updated_at":"2020-07-19T11:58:08.832Z","actor":{"username":"d4rk_h4xor","cleared":false,"url":"/d4rk_h4xor","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/hgiyPReNEv3WRS9yKSq8aj3C/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"omise","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8951810,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-08-17T01:36:28.303Z","updated_at":"2020-08-17T01:36:28.303Z","actor":{"username":"hardymansen","cleared":false,"url":"/hardymansen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/268/510/a5be384b5218b68c9ed291e2649c3a659f9baeb5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"omise","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8951811,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-08-17T01:36:28.371Z","updated_at":"2020-08-17T01:36:28.371Z","actor":{"username":"hardymansen","cleared":false,"url":"/hardymansen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/268/510/a5be384b5218b68c9ed291e2649c3a659f9baeb5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"omise","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}