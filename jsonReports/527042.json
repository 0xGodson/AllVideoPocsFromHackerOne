{"id":527042,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC81MjcwNDI=","url":"https://hackerone.com/reports/527042","title":"CVE-2019-0196: mod_http2 with scoreboard Use-After-Free (Read)","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2019-04-04T15:41:41.641Z","submitted_at":"2019-04-04T15:41:41.641Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"cy1337","url":"/cy1337","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/KagzJs5xLrFQDcKUhWnSC7s5/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":26,"url":"https://hackerone.com/ibb-apache","handle":"ibb-apache","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/026/1019d58a547964cedd75cda5809332316a7e381c_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/026/1019d58a547964cedd75cda5809332316a7e381c_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Apache httpd (IBB)","twitter_handle":"","website":"http://apache.org/security","about":""}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":["CVE-2019-0196"],"singular_disclosure_disabled":false,"disclosed_at":"2019-09-10T21:05:51.725Z","bug_reporter_agreed_on_going_public_at":"2019-09-10T21:05:51.660Z","team_member_agreed_on_going_public_at":"2019-09-10T20:25:41.590Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"A crafted HTTP2 request can trigger reference to request data from a memory pool after its destruction. This memory is subsequently used as input to an sprintf type function for constructing a string value. This unsafe memory access ultimately means that the \nr-\u003ethe_request string is poisoned with unintended data. \n\nTo reproduce the problem, I have attached a script that will download/compile Apache httpd and reproduce the behavior with ASAN enabled. The archive also contains a nice ASAN output from the event.\n\n## Impact\n\nThis is an unsafe memory access. It could lead to process crashes, assist in other exploits, or reveal confidential data through unexplored interactions with other httpd modules.","vulnerability_information_html":"\u003cp\u003eA crafted HTTP2 request can trigger reference to request data from a memory pool after its destruction. This memory is subsequently used as input to an sprintf type function for constructing a string value. This unsafe memory access ultimately means that the \u003cbr\u003e\nr-\u0026gt;the_request string is poisoned with unintended data. \u003c/p\u003e\n\n\u003cp\u003eTo reproduce the problem, I have attached a script that will download/compile Apache httpd and reproduce the behavior with ASAN enabled. The archive also contains a nice ASAN output from the event.\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eThis is an unsafe memory access. It could lead to process crashes, assist in other exploits, or reveal confidential data through unexplored interactions with other httpd modules.\u003c/p\u003e\n","bounty_amount":"500.0","formatted_bounty":"$500","weakness":{"id":50,"name":"Use After Free"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":462225,"file_name":"scoreboard-uaf-demo.tgz","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/462/225/e0ef551218225376a39d3b39f1b73ec3af4bf1cc/scoreboard-uaf-demo.tgz?response-content-disposition=attachment%3B%20filename%3D%22scoreboard-uaf-demo.tgz%22%3B%20filename%2A%3DUTF-8%27%27scoreboard-uaf-demo.tgz\u0026response-content-type=application%2Fgzip\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ6J7UOFHP%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T061501Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDamJ7YR2N3cIBOa8zjuSmUd9OCX8zCykCDx%2B6kH2J%2BlQIhAPFk51DuoGb47ygm%2F46VUWXIRiNzzPuAJCxpuNY6C9r8KrQDCFIQARoMMDEzNjE5Mjc0ODQ5IgwfJ9Wm2OgZB0TD5wEqkQMAyHxawucw3AMqEaVZmpdf%2FWoK6P8gu%2FCj%2FoC7vu86houcl7d5S1aesU3sbrOzgm6RSEhwz%2FFS3jL7D6T4JI4Ce1ND%2FrgO0lyXrQzDIcV61dzQW3FvNLr0ZImyyUdtac%2BXOj%2B4Yuxg3B%2Fw8%2FASrjXwhjBS66Kymk3L6dUfBdgwlGyaWjSrEj7pUe4QmHItRfpiYrIugF6V0YbiwTzCRnupZGkhFUvdnKltp%2B4hMIJ8ZpZXjRaPMFGYbJODmmGmpbXrkLNmtpD9ssAfsLLmMNbkAbfGTVhz1jb8jNtS70QChWZUcaVF%2BUJ%2BnjyviI%2BzOI3PvJo6%2BFF7nuwLNAutvngzDIQqSSVMoO%2F3MB45%2Bi7mOnnapSDDsV974XkQgCuM7vsb5p2hLCxzrxps5NEHGajQr5tkHe3qivszLUiVfsV43w8FYD%2BBONxEK7W9P8Fz8NZ67SyH7GG2ksQHMqmv0OcEaprPoRqnV3X2FUQMilKfrm8Mwo6y2b3BolwJdahB%2FiN%2B4DEDiSex%2FihlgZtj7Y4SxDDk%2FKn%2FBTrqAf559VpL8gNLdFBoVG3N%2FZOK1jnsPcfoIUSZtPAKUZCx%2FfYM8b4F5pg%2FUgEn1Lv%2B2LBdmNBasw6RmzajA5OSfdAMndyjJN9XxpB%2BQCxuWhR%2B4l3UYvcHCs0ptmeXrxe03i6oCQg6cNND1wBmViOKSrRB7ycvKEbOUFZtkHoRDVaID3Z%2BuOzyOMaLFXSvzsVsAcCFgFhIk5QJcY%2B1scZVna72pH8jnKw%2FwC1cIv1j%2FAmz0zBabFT7deSC5tUMl0pZQVYKiEGsgryYN9fSfaoMv2wR80e4kst1hVdlJHDktel9plUkLBliVB9%2BDQ%3D%3D\u0026X-Amz-Signature=d053a3033dbd2f1d16ccc79b3dad1932936b0dce04b0f4c63105978caa40e25f","file_size":48487,"type":"application/gzip"}],"allow_singular_disclosure_at":"2019-10-10T20:25:41.683Z","allow_singular_disclosure_after":-38483359.44058759,"singular_disclosure_allowed":true,"vote_count":4,"voters":["mygf","0-1","cryptographer","cyb3rs41n7"],"severity":{"rating":"medium","score":5.3,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"none","user_interaction":"none","scope":"unchanged","confidentiality":"low","integrity":"none","availability":"none"}},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":4505666,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @cy1337 , \n\nThank you for your submission. Your report is currently being reviewed and the HackerOne triage team will get back to you once there is additional information to share.\n\nKind regards,\n@ktistai","markdown_message":"\u003cp\u003eHi \u003ca href=\"/cy1337\"\u003e@cy1337\u003c/a\u003e , \u003c/p\u003e\n\n\u003cp\u003eThank you for your submission. Your report is currently being reviewed and the HackerOne triage team will get back to you once there is additional information to share.\u003c/p\u003e\n\n\u003cp\u003eKind regards,\u003cbr\u003e\n\u003ca href=\"/ktistai\"\u003e@ktistai\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2019-04-08T08:51:10.670Z","updated_at":"2019-04-08T08:51:10.670Z","actor":{"username":"ktistai","cleared":false,"url":"/ktistai","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/322/520/01cd21dce301646646276fd9125cffd448fbffd6_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"ibb-apache","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":4505677,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hello @cy1337 \n\nThank you for your submission! I was able to validate your report, and have submitted it to the appropriate remediation team for review. They will let us know the final ruling on this report, and when/if a fix will be implemented. Please note that the status and severity are subject to change.\n\nRegards,\n@ktistai","markdown_message":"\u003cp\u003eHello \u003ca href=\"/cy1337\"\u003e@cy1337\u003c/a\u003e \u003c/p\u003e\n\n\u003cp\u003eThank you for your submission! I was able to validate your report, and have submitted it to the appropriate remediation team for review. They will let us know the final ruling on this report, and when/if a fix will be implemented. Please note that the status and severity are subject to change.\u003c/p\u003e\n\n\u003cp\u003eRegards,\u003cbr\u003e\n\u003ca href=\"/ktistai\"\u003e@ktistai\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2019-04-08T08:52:36.243Z","updated_at":"2019-04-08T08:52:36.243Z","actor":{"username":"ktistai","cleared":false,"url":"/ktistai","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/322/520/01cd21dce301646646276fd9125cffd448fbffd6_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"ibb-apache","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":4505697,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2019-04-08T08:56:03.685Z","updated_at":"2019-04-08T08:56:03.685Z","additional_data":{"old_severity":null,"new_severity":"Low (3.7)","old_severity_id":null,"new_severity_id":339016},"actor":{"username":"ktistai","cleared":false,"url":"/ktistai","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/322/520/01cd21dce301646646276fd9125cffd448fbffd6_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"ibb-apache","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":4505703,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2019-04-08T08:56:35.326Z","updated_at":"2019-04-08T08:56:35.326Z","additional_data":{"old_severity":"Low (3.7)","new_severity":"Medium (5.3)","old_severity_id":339016,"new_severity_id":339018},"actor":{"username":"ktistai","cleared":false,"url":"/ktistai","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/322/520/01cd21dce301646646276fd9125cffd448fbffd6_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"ibb-apache","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":4954721,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I don't understand what remediation team is referenced on this report. This issue was fixed with the 2.4.39 release of httpd. Can you provide an update on the status of this submission?","markdown_message":"\u003cp\u003eI don\u0026#39;t understand what remediation team is referenced on this report. This issue was fixed with the 2.4.39 release of httpd. Can you provide an update on the status of this submission?\u003c/p\u003e\n","automated_response":false,"created_at":"2019-05-30T14:47:04.059Z","updated_at":"2019-05-30T14:47:04.059Z","actor":{"username":"cy1337","cleared":true,"url":"/cy1337","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/KagzJs5xLrFQDcKUhWnSC7s5/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ibb-apache","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5616923,"is_internal":false,"editable":false,"type":"Activities::HackerRequestedMediation","message":"There has been no response for months. Just wondering what's going on.","markdown_message":"\u003cp\u003eThere has been no response for months. Just wondering what\u0026#39;s going on.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-08-20T13:47:07.514Z","updated_at":"2019-08-20T13:47:07.514Z","actor":{"username":"cy1337","cleared":true,"url":"/cy1337","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/KagzJs5xLrFQDcKUhWnSC7s5/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ibb-apache","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5774435,"is_internal":false,"editable":false,"type":"Activities::CveIdAdded","message":"","markdown_message":"","automated_response":false,"created_at":"2019-09-10T20:24:25.509Z","updated_at":"2019-09-10T20:24:25.509Z","cve_ids":["CVE-2019-0196"],"actor":{"username":"reed","cleared":false,"url":"/reed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"ibb-apache","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5774441,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2019-09-10T20:25:22.205Z","updated_at":"2019-09-10T20:25:22.205Z","actor":{"url":"/ibb-apache","ibb":true,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/026/1019d58a547964cedd75cda5809332316a7e381c_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Apache httpd (IBB)"}},"bounty_amount":"500.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"ibb-apache","collaborator":{"username":"cy1337","url":"/cy1337"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5774442,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks for helping keep the Internet safe!","markdown_message":"\u003cp\u003eThanks for helping keep the Internet safe!\u003c/p\u003e\n","automated_response":false,"created_at":"2019-09-10T20:25:36.964Z","updated_at":"2019-09-10T20:25:36.964Z","actor":{"username":"reed","cleared":false,"url":"/reed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"reporter":{"username":"cy1337","url":"/cy1337"},"genius_execution_id":null,"team_handle":"ibb-apache","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5774443,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-09-10T20:25:41.608Z","updated_at":"2019-09-10T20:25:41.608Z","first_to_agree":true,"actor":{"username":"reed","cleared":false,"url":"/reed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"ibb-apache","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5774610,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-09-10T21:05:51.683Z","updated_at":"2019-09-10T21:05:51.683Z","actor":{"username":"cy1337","cleared":true,"url":"/cy1337","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/KagzJs5xLrFQDcKUhWnSC7s5/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ibb-apache","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5774611,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-09-10T21:05:51.747Z","updated_at":"2019-09-10T21:05:51.747Z","actor":{"username":"cy1337","cleared":true,"url":"/cy1337","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/KagzJs5xLrFQDcKUhWnSC7s5/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ibb-apache","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}