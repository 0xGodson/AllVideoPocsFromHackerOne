{"id":13286,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMzI4Ng==","url":"https://hackerone.com/reports/13286","title":"Host Header Injection - irccloud.com","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2014-05-25T10:41:44.901Z","submitted_at":"2014-05-25T10:41:44.901Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"ethicalhacker","url":"/ethicalhacker","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":140,"url":"https://hackerone.com/irccloud","handle":"irccloud","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/140/c90be8ce0ea099d908ca652a82df9952b782e7c2_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/140/c90be8ce0ea099d908ca652a82df9952b782e7c2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"IRCCloud","twitter_handle":"irccloud","website":"https://www.irccloud.com","about":"Group chat for teams, friends, and communities. IRCCloud is an IRC client with a future. Stay connected, chat from anywhere, and never miss a message."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2014-07-08T10:00:33.687Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2014-05-27T11:14:22.038Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Host Header Injection Attack - irccloud.com\r\n\r\nAn attacker can manipulate the Host header as seen by the web application and cause the application to behave in unexpected ways.\r\n\r\nVery often multiple websites are hosted on the same IP address. This is where the Host Header comes in. This header specifies which website should process the HTTP request. The web server uses the value of this header to dispatch the request to the specified website. Each website hosted on the same IP address is called a virtual host.\r\n\r\nBut what happens if we specify an invalid Host Header? If Apache receives an unrecognized Host Header, it passes it to the first virtual host defined in httpd.conf. Therefore, it's possible to send requests with arbitrary Host Headers to the first virtual host. \r\n\r\nAnother way to pass arbitrary Host headers is to use the X-Forwarded-Host Header. In some configurations this header will rewrite the value of the Host header. Therefore it's possible to make a request like:\r\n\r\n#PoC Request -\r\nGET / HTTP/1.1\r\nHost: google.com\r\nHost: www.irccloud.com\r\nProxy-Connection: keep-alive\r\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\r\nUser-Agent: Mozilla/5.0 (Windows NT 6.0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/31.0.1650.63 Safari/537.36\r\nAccept-Encoding: gzip,deflate,sdch\r\nAccept-Language: en-US,en;q=0.8\r\n\r\n\r\n#PoC Response -\r\nHTTP/1.1 301 Moved Permanently\r\nContent-length: 0\r\nLocation: https://google.com/\r\nConnection: close\r\n\r\n\r\n#PoC Payload -\r\nHost: google.com\r\nHost: anymalicioussite.com\r\n\r\n\r\n#PoC pcap -\r\nEnclosed\r\n\r\n\r\n#PoC Screenshot -\r\nEnclosed \r\n\r\n\r\nPlease verify and fix the same.\r\n","vulnerability_information_html":"\u003cp\u003eHost Header Injection Attack - irccloud.com\u003c/p\u003e\n\n\u003cp\u003eAn attacker can manipulate the Host header as seen by the web application and cause the application to behave in unexpected ways.\u003c/p\u003e\n\n\u003cp\u003eVery often multiple websites are hosted on the same IP address. This is where the Host Header comes in. This header specifies which website should process the HTTP request. The web server uses the value of this header to dispatch the request to the specified website. Each website hosted on the same IP address is called a virtual host.\u003c/p\u003e\n\n\u003cp\u003eBut what happens if we specify an invalid Host Header? If Apache receives an unrecognized Host Header, it passes it to the first virtual host defined in httpd.conf. Therefore, it\u0026#39;s possible to send requests with arbitrary Host Headers to the first virtual host. \u003c/p\u003e\n\n\u003cp\u003eAnother way to pass arbitrary Host headers is to use the X-Forwarded-Host Header. In some configurations this header will rewrite the value of the Host header. Therefore it\u0026#39;s possible to make a request like:\u003c/p\u003e\n\n\u003ch1 id=\"poc-request\"\u003ePoC Request -\u003c/h1\u003e\n\n\u003cp\u003eGET / HTTP/1.1\u003cbr\u003e\nHost: google.com\u003cbr\u003e\nHost: \u003ca href=\"/redirect?url=http%3A%2F%2Fwww.irccloud.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ewww.irccloud.com\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nProxy-Connection: keep-alive\u003cbr\u003e\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,\u003cem\u003e/\u003c/em\u003e;q=0.8\u003cbr\u003e\nUser-Agent: Mozilla/5.0 (Windows NT 6.0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/31.0.1650.63 Safari/537.36\u003cbr\u003e\nAccept-Encoding: gzip,deflate,sdch\u003cbr\u003e\nAccept-Language: en-US,en;q=0.8\u003c/p\u003e\n\n\u003ch1 id=\"poc-response\"\u003ePoC Response -\u003c/h1\u003e\n\n\u003cp\u003eHTTP/1.1 301 Moved Permanently\u003cbr\u003e\nContent-length: 0\u003cbr\u003e\nLocation: \u003ca title=\"https://google.com/\" href=\"/redirect?url=https%3A%2F%2Fgoogle.com%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://google.com/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nConnection: close\u003c/p\u003e\n\n\u003ch1 id=\"poc-payload\"\u003ePoC Payload -\u003c/h1\u003e\n\n\u003cp\u003eHost: google.com\u003cbr\u003e\nHost: anymalicioussite.com\u003c/p\u003e\n\n\u003ch1 id=\"poc-pcap\"\u003ePoC pcap -\u003c/h1\u003e\n\n\u003cp\u003eEnclosed\u003c/p\u003e\n\n\u003ch1 id=\"poc-screenshot\"\u003ePoC Screenshot -\u003c/h1\u003e\n\n\u003cp\u003eEnclosed \u003c/p\u003e\n\n\u003cp\u003ePlease verify and fix the same.\u003c/p\u003e\n","bounty_amount":"100.0","formatted_bounty":"$100","weakness":{"id":57,"name":"Violation of Secure Design Principles"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":9684,"file_name":"irccloud-host-header.jpg","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/009/684/42f62027d69a5b3aa912ba2dd366fd98a92734a1/irccloud-host-header.jpg?response-content-disposition=attachment%3B%20filename%3D%22irccloud-host-header.jpg%22%3B%20filename%2A%3DUTF-8%27%27irccloud-host-header.jpg\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ2QYQVMVU%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T042520Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJj%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQC3%2FsiyUovDMMRPwfmXSSMky3lQNd33wh1MrBmbWJC8HQIhAOSX92QvRr3Mllw0zHuI%2FUP9sF%2FDNWps6wYRKsfiEgbIKrQDCFEQARoMMDEzNjE5Mjc0ODQ5IgyayWzpgkc86ZJmRDMqkQNBHcx9TN8Qq3EOCDOHxZVSoo84ar5w931vjsPd%2BYQ3i%2Bx9eqo2ZtgVN1Jmoq8zs6hsL0mQ%2F20wJFKZixbR7HjPc8i4juMIQlnM8TPeS1SJgwLfpmO12sSyoWk3fn%2BevsZ74MOTjvipPhl7l4ysY7gvLSMb%2F%2FbZmlTb%2BRp9ew5nOoiXNI8oQZMkhOihsn1Q92Wzljmz7rLHf0SWhEVdMvtgNqYyJz%2FGfq5QgT7Ex9q0a8OeRuv2WivmkS0ItLzdLr4AZp8G9M8TS3hFKV7sBxW2jeQmBIgcwsfh6l5Kj2o1EeFByIjeAOeU8CtQvJjf1AYwsXig5iiWG1PDqO74ZMYim9a1AVJfIRMHELC9hgi%2BNRVkqsPBurY%2BhFIchB3A6MS0Fup9FcpwDiSPwMu92UsjrPwWcQSy7wF8W7uVHoWmYKo2Jie7uXX2WbkNvQn%2BVJkd%2ByJui6LuEsoOf46y4OUr9by1ZfOQEMvwaiEcDXAKt7msARgVRUaigRb1ZF8hYom2qPLbi%2BKKBIE%2FJ21mcK79gjDj36n%2FBTrqAbyLw6dOEWEdRc%2BQghV%2BGs0mxf6YcBEQ0xaDSLE5OQXQJX90aqhTYFzi15%2BtXM5rF%2FkTq%2FNonb0szkAGwKve9Fh2LyQ%2F7WBSh9XEjPVQ%2B94j5PqLLrVbqfO7RsbRpSefivNmepJrQv52y49fC1tTXoR893JVWe1bnDoXfPRtykz2CLE1WIUrJm7g0MwlQ4%2FYhjLC7FTb6WIejkEPZ0nJdYi90iaGNGoKuvlj2kpGsqCTPjBW8Vhu9R9qXAbPR%2Bj24hpsPhyGFzBe%2F1%2BqYcze%2B4BoEFO8hgcUAqm5L0zeqYMYIdqkfREAB0cTeQ%3D%3D\u0026X-Amz-Signature=acfce95e3b20364ac70a3376fa64ce85190401bfc76be82748e791ae9692c73f","file_size":51833,"type":"image/jpeg"}],"allow_singular_disclosure_at":"2014-06-26T11:14:03.927Z","allow_singular_disclosure_after":-205434676.39777058,"singular_disclosure_allowed":true,"vote_count":2,"voters":["d3f4u17","cybernewbie"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":58220,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks for the report. This issue is related to our fix for #7357 and should now be resolved.","markdown_message":"\u003cp\u003eThanks for the report. This issue is related to our fix for \u003ca href=\"/reports/7357\"\u003e#7357\u003c/a\u003e and should now be resolved.\u003c/p\u003e\n","automated_response":false,"created_at":"2014-05-27T11:14:03.956Z","updated_at":"2014-05-27T11:14:03.956Z","actor":{"username":"jwheare","cleared":false,"url":"/jwheare","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/778/b500b506bad385a82e5e0da28a0214d263822656_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"ethicalhacker","url":"/ethicalhacker"},"genius_execution_id":null,"team_handle":"irccloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":58221,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2014-05-27T11:14:08.927Z","updated_at":"2014-05-27T11:14:08.927Z","actor":{"url":"/irccloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/140/c90be8ce0ea099d908ca652a82df9952b782e7c2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"IRCCloud"}},"bounty_amount":"100.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"irccloud","collaborator":{"username":"ethicalhacker","url":"/ethicalhacker"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":58222,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2014-05-27T11:14:22.055Z","updated_at":"2014-05-27T11:14:22.055Z","actor":{"username":"jwheare","cleared":false,"url":"/jwheare","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/778/b500b506bad385a82e5e0da28a0214d263822656_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"irccloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":85931,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2014-07-08T10:00:33.698Z","updated_at":"2014-07-08T10:00:33.698Z","actor":{"url":"/irccloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/140/c90be8ce0ea099d908ca652a82df9952b782e7c2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"IRCCloud"}},"genius_execution_id":null,"team_handle":"irccloud","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}