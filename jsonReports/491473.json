{"id":491473,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC80OTE0NzM=","url":"https://hackerone.com/reports/491473","title":"Protected tweets exposure through the URL","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2019-02-05T17:53:21.968Z","submitted_at":"2019-02-05T17:53:21.968Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"terjanq","url":"/terjanq","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/353/987/2ae95a623dfabcdb416ac12e999390c60f4e83a6_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":61,"url":"https://hackerone.com/twitter","handle":"twitter","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/061/85a63a443f017ad8353de4f68ebf52fdd61c345a_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/061/85a63a443f017ad8353de4f68ebf52fdd61c345a_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Twitter","twitter_handle":"twittersecurity","website":"https://twitter.com","about":"Twitter helps you create and share ideas and information instantly, without barriers."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2019-04-19T16:34:21.228Z","bug_reporter_agreed_on_going_public_at":"2019-04-02T17:50:02.259Z","team_member_agreed_on_going_public_at":"2019-04-19T16:34:21.130Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"## Summary\nLeaking sensitive information from protected tweets via a prepared website. This vulnerability could lead to exposure of information such as **credit card numbers**, **bank account numbers**, **phone numbers**, **tokens**, **specific words** or even the **whole phrases** but also the exposure of any additional information such as **mentioned users**, **tweet time frames**, **tweet locations** or  **hashtags**.\n\n## Description\nWhen searching for further **URL exposure** vulnerabilities on Twitter I noticed that a very unsafe URL redirect happens, depending on search results, when a user searches for some tweets. \n\nThe endpoint I found is that:\n\u003e If there are no search results for a query e.g. https://twitter.com/search?q=veryveryunsaferedirect\u0026src=typd the URL changes to https://twitter.com/search?f=tweets\u0026q=secret%20from%3Aterjanq\u0026src=typd and it doesn't when results were found. As can be spotted, the `f=tweets` parameter was added and hence that state can be leaked.\n\nThe detection of the URL change can be achieved in several ways, I will use the technique I already reported to Twitter in https://hackerone.com/reports/491243 and also described in https://terjanq.github.io/Bug-Bounty/Twitter/url-information-disclosure-q67svgtbqarv/index.html.\n\nThanks to *Advanced Search* option the attacker can obtain very detailed information about the victim's tweets when knowing their username even if the tweets are set as private. The full list of available options is as in the image below. \nhttps://i.imgur.com/xJeaixk.png\n\nTo make the *X-Search* attack more effective, the attacker can use logical operators `AND` and `OR` to narrow down the search area. For example, by using phrases like `1001 OR 1002 OR 1003 OR 1004 …` the attacker can use binary-search to extract all four-digit numbers in only few requests. However, I noticed that the limit for the number of words that can be used in the search is limited by 50. Nevertheless, that number is big enough to effectively extract those four-digit numbers -- it would only take around 300 requests to extract all of them and then by combining them in the correct order the whole phrases such as credit card number can be leaked. \n\nIn the Proof of Concept, I have prepared an easy attack abusing this observation for three-digit ones.\n\n## Steps To Reproduce:\n  1. Prepare test twitter accounts and enable the option *Protect your Tweets* in the settings.\n  2. Visit the https://terjanq.github.io/Bug-Bounty/Twitter/protected-tweets-exposure-efvju8i785y1/poc.html and click the button to start the PoC.\n  3. Put phrases you want to find in your tweets and fill the field `from:` with your account's username and submit the form.\n  4. When you are done with the previous step, click on the button `Fetch all 3-digit numbers from tweets` and wait for the timer to stop.\n  5. You should see all the three-digit numbers from your tweets.\n\n*Please note that the exploit can be coded much more efficiently. For example, instead of using one window to make the redirects several can be used to speed it up. Also due to the style it was written in, false-positives can appear when lags occur (it has primitive protection implemented for that case, but it's not perfect)*\n\n## Impact: \nA regular user of Twitter can have **their protected tweets leaked** along with additional information such as **mentioned users**, **tweet time frames**, **tweet locations** etc.\n\n## Supporting Material/References:\nI made a short video demonstrating the PoC in action \nhttps://youtu.be/bSUS4THqssY\n\n*I attached copies of the files required to run the PoC (main file poc.html) but they can also be accessed via https://terjanq.github.io/Bug-Bounty/Twitter/protected-tweets-exposure-efvju8i785y1/*\n\n## Impact\n\nA regular user of Twitter can have **their protected tweets leaked** along with additional information such as **mentioned users**, **tweet time frames**, **tweet locations** etc.","vulnerability_information_html":"\u003ch2 id=\"summary\"\u003eSummary\u003c/h2\u003e\n\n\u003cp\u003eLeaking sensitive information from protected tweets via a prepared website. This vulnerability could lead to exposure of information such as \u003cstrong\u003ecredit card numbers\u003c/strong\u003e, \u003cstrong\u003ebank account numbers\u003c/strong\u003e, \u003cstrong\u003ephone numbers\u003c/strong\u003e, \u003cstrong\u003etokens\u003c/strong\u003e, \u003cstrong\u003especific words\u003c/strong\u003e or even the \u003cstrong\u003ewhole phrases\u003c/strong\u003e but also the exposure of any additional information such as \u003cstrong\u003ementioned users\u003c/strong\u003e, \u003cstrong\u003etweet time frames\u003c/strong\u003e, \u003cstrong\u003etweet locations\u003c/strong\u003e or  \u003cstrong\u003ehashtags\u003c/strong\u003e.\u003c/p\u003e\n\n\u003ch2 id=\"description\"\u003eDescription\u003c/h2\u003e\n\n\u003cp\u003eWhen searching for further \u003cstrong\u003eURL exposure\u003c/strong\u003e vulnerabilities on Twitter I noticed that a very unsafe URL redirect happens, depending on search results, when a user searches for some tweets. \u003c/p\u003e\n\n\u003cp\u003eThe endpoint I found is that:\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eIf there are no search results for a query e.g. \u003ca title=\"https://twitter.com/search?q=veryveryunsaferedirect\u0026amp;src=typd\" href=\"/redirect?url=https%3A%2F%2Ftwitter.com%2Fsearch%3Fq%3Dveryveryunsaferedirect%26src%3Dtypd\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://twitter.com/search?q=veryveryunsaferedirect\u0026amp;src=typd\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e the URL changes to \u003ca title=\"https://twitter.com/search?f=tweets\u0026amp;q=secret%20from%3Aterjanq\u0026amp;src=typd\" href=\"/redirect?url=https%3A%2F%2Ftwitter.com%2Fsearch%3Ff%3Dtweets%26q%3Dsecret%2520from%253Aterjanq%26src%3Dtypd\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://twitter.com/search?f=tweets\u0026amp;q=secret%20from%3Aterjanq\u0026amp;src=typd\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e and it doesn\u0026#39;t when results were found. As can be spotted, the \u003ccode\u003ef=tweets\u003c/code\u003e parameter was added and hence that state can be leaked.\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eThe detection of the URL change can be achieved in several ways, I will use the technique I already reported to Twitter in \u003ca title=\"https://hackerone.com/reports/491243\" href=\"https://hackerone.com/reports/491243\"\u003ehttps://hackerone.com/reports/491243\u003c/a\u003e and also described in \u003ca title=\"https://terjanq.github.io/Bug-Bounty/Twitter/url-information-disclosure-q67svgtbqarv/index.html\" href=\"/redirect?url=https%3A%2F%2Fterjanq.github.io%2FBug-Bounty%2FTwitter%2Furl-information-disclosure-q67svgtbqarv%2Findex.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://terjanq.github.io/Bug-Bounty/Twitter/url-information-disclosure-q67svgtbqarv/index.html\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e.\u003c/p\u003e\n\n\u003cp\u003eThanks to \u003cem\u003eAdvanced Search\u003c/em\u003e option the attacker can obtain very detailed information about the victim\u0026#39;s tweets when knowing their username even if the tweets are set as private. The full list of available options is as in the image below. \u003cbr\u003e\n\u003ca title=\"https://i.imgur.com/xJeaixk.png\" href=\"/redirect?url=https%3A%2F%2Fi.imgur.com%2FxJeaixk.png\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://i.imgur.com/xJeaixk.png\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eTo make the \u003cem\u003eX-Search\u003c/em\u003e attack more effective, the attacker can use logical operators \u003ccode\u003eAND\u003c/code\u003e and \u003ccode\u003eOR\u003c/code\u003e to narrow down the search area. For example, by using phrases like \u003ccode\u003e1001 OR 1002 OR 1003 OR 1004 …\u003c/code\u003e the attacker can use binary-search to extract all four-digit numbers in only few requests. However, I noticed that the limit for the number of words that can be used in the search is limited by 50. Nevertheless, that number is big enough to effectively extract those four-digit numbers -- it would only take around 300 requests to extract all of them and then by combining them in the correct order the whole phrases such as credit card number can be leaked. \u003c/p\u003e\n\n\u003cp\u003eIn the Proof of Concept, I have prepared an easy attack abusing this observation for three-digit ones.\u003c/p\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps To Reproduce:\u003c/h2\u003e\n\n\u003col\u003e\n\u003cli\u003ePrepare test twitter accounts and enable the option \u003cem\u003eProtect your Tweets\u003c/em\u003e in the settings.\u003c/li\u003e\n\u003cli\u003eVisit the \u003ca title=\"https://terjanq.github.io/Bug-Bounty/Twitter/protected-tweets-exposure-efvju8i785y1/poc.html\" href=\"/redirect?url=https%3A%2F%2Fterjanq.github.io%2FBug-Bounty%2FTwitter%2Fprotected-tweets-exposure-efvju8i785y1%2Fpoc.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://terjanq.github.io/Bug-Bounty/Twitter/protected-tweets-exposure-efvju8i785y1/poc.html\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e and click the button to start the PoC.\u003c/li\u003e\n\u003cli\u003ePut phrases you want to find in your tweets and fill the field \u003ccode\u003efrom:\u003c/code\u003e with your account\u0026#39;s username and submit the form.\u003c/li\u003e\n\u003cli\u003eWhen you are done with the previous step, click on the button \u003ccode\u003eFetch all 3-digit numbers from tweets\u003c/code\u003e and wait for the timer to stop.\u003c/li\u003e\n\u003cli\u003eYou should see all the three-digit numbers from your tweets.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003e\u003cem\u003ePlease note that the exploit can be coded much more efficiently. For example, instead of using one window to make the redirects several can be used to speed it up. Also due to the style it was written in, false-positives can appear when lags occur (it has primitive protection implemented for that case, but it\u0026#39;s not perfect)\u003c/em\u003e\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact:\u003c/h2\u003e\n\n\u003cp\u003eA regular user of Twitter can have \u003cstrong\u003etheir protected tweets leaked\u003c/strong\u003e along with additional information such as \u003cstrong\u003ementioned users\u003c/strong\u003e, \u003cstrong\u003etweet time frames\u003c/strong\u003e, \u003cstrong\u003etweet locations\u003c/strong\u003e etc.\u003c/p\u003e\n\n\u003ch2 id=\"supporting-material-references\"\u003eSupporting Material/References:\u003c/h2\u003e\n\n\u003cp\u003eI made a short video demonstrating the PoC in action \u003cbr\u003e\n\u003ca title=\"https://youtu.be/bSUS4THqssY\" href=\"/redirect?url=https%3A%2F%2Fyoutu.be%2FbSUS4THqssY\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://youtu.be/bSUS4THqssY\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003cem\u003eI attached copies of the files required to run the PoC (main file poc.html) but they can also be accessed via \u003ca title=\"https://terjanq.github.io/Bug-Bounty/Twitter/protected-tweets-exposure-efvju8i785y1/\" href=\"/redirect?url=https%3A%2F%2Fterjanq.github.io%2FBug-Bounty%2FTwitter%2Fprotected-tweets-exposure-efvju8i785y1%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://terjanq.github.io/Bug-Bounty/Twitter/protected-tweets-exposure-efvju8i785y1/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/em\u003e\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eA regular user of Twitter can have \u003cstrong\u003etheir protected tweets leaked\u003c/strong\u003e along with additional information such as \u003cstrong\u003ementioned users\u003c/strong\u003e, \u003cstrong\u003etweet time frames\u003c/strong\u003e, \u003cstrong\u003etweet locations\u003c/strong\u003e etc.\u003c/p\u003e\n","bounty_amount":"560.0","formatted_bounty":"$560","weakness":{"id":18,"name":"Information Disclosure"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":418502,"file_name":"poc.html","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/418/502/e8b28f46e3094cc17b9d34d1d1e4cb2b73d121ba/poc.html?response-content-disposition=attachment%3B%20filename%3D%22poc.html%22%3B%20filename%2A%3DUTF-8%27%27poc.html\u0026response-content-type=application%2Foctet-stream\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQR2ZO7R4K%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T060710Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIGl53Fw9OoAeZDdXqNqIaPWdVjolNnalaCHAwbXpszPSAiEAwdHCK3x2n8ED7sSzsn1sTIqS3bguKd2LFUdH90SxxboqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDFnQ3ZZHIU4UMAvXOCqRA3wF0%2FhaPHMfYMs5a29VvIgRVY2eUJjhO2ZyE9nrbvBw99qQYURMnfpjG6qzK9RhUhaxnystL8FSjs1I9wVhv7kK6fGlwNHgR0S%2FwzzOYB4EaUAuHPPjDIaplYQHDQfhD3Jzk627x6y1whtGyRm1%2FbLU%2FMLC%2FEl2Y0VF3B2XYbmjMyMbEo%2F3JA2NhxILkWnIEx9Dc5OuLgUgvtMmXd8zqzlhwWk%2Fkbzt%2FA4PPw5G1805sqkgAV2ZtRMBvyI%2FHqrdrdjVcpE0L%2Fb3v3BTHE1AxOXymRI68r5QkUXAwvQReRh0UHKevdP2OKVlaJqNW4QPWf8V9sf08LOD6%2FIWFP2z6T0Ge7kmECxaLuqLfuqbJATPZaoduqk5WANfTo41R4vwOd0PfkzuCu4ENGZautDQdqCTqc5v4f3nC%2FmEA3lzVbD2GfnKNN5i6QTsolJiL8iHwoY3qRGnqUpWe6styqCssbnT2On6kImCyLv8PqTQIgD5tzKTZ%2Bk7rSp%2FUGyNQ%2Fzf7CwFfbirN8%2BZ0cy8FDVRQPOIMNrtqv8FOusBG5VJhuS959dYt8SgxT1B5qInUKkmqkB9xSwqpRIrJhHLlMpiW9hAt%2BdMLFZZhmn8J5%2BdfXBiq%2FwOuwlyUwREyyNiqFLd5q%2F2oDa1jv2FMMsir1my4yAqcT0R%2BuM9KWMCRIN%2F27CpS4%2BgKGfRpQrYqZnwFoh5vyTAfyKuQbQpvNQ5z0%2F7hQPQ1Fud3gWbMbKSBMyuMEkDvn42ZK0k1WvIYPRa53VXsGPwtTo7PZ2laExqLJsXRcULDGCx08GryRt%2B5IBSaDHktFU1HTGALrwf1yRufEBKHtOimqOWitGuYxfwQnKZ1ht%2BjmX2WQ%3D%3D\u0026X-Amz-Signature=f2d977d59a6ecc524f0b21b5fbe8aa8d41e99b15ab5d00b54ba055d40425a399","file_size":637,"type":"text/html"},{"id":418503,"file_name":"poc.js","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/418/503/bd4a52d26eb0f579978ba608e09cef16f86e15e6/poc.js?response-content-disposition=attachment%3B%20filename%3D%22poc.js%22%3B%20filename%2A%3DUTF-8%27%27poc.js\u0026response-content-type=text%2Fplain\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQR2ZO7R4K%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T060710Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIGl53Fw9OoAeZDdXqNqIaPWdVjolNnalaCHAwbXpszPSAiEAwdHCK3x2n8ED7sSzsn1sTIqS3bguKd2LFUdH90SxxboqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDFnQ3ZZHIU4UMAvXOCqRA3wF0%2FhaPHMfYMs5a29VvIgRVY2eUJjhO2ZyE9nrbvBw99qQYURMnfpjG6qzK9RhUhaxnystL8FSjs1I9wVhv7kK6fGlwNHgR0S%2FwzzOYB4EaUAuHPPjDIaplYQHDQfhD3Jzk627x6y1whtGyRm1%2FbLU%2FMLC%2FEl2Y0VF3B2XYbmjMyMbEo%2F3JA2NhxILkWnIEx9Dc5OuLgUgvtMmXd8zqzlhwWk%2Fkbzt%2FA4PPw5G1805sqkgAV2ZtRMBvyI%2FHqrdrdjVcpE0L%2Fb3v3BTHE1AxOXymRI68r5QkUXAwvQReRh0UHKevdP2OKVlaJqNW4QPWf8V9sf08LOD6%2FIWFP2z6T0Ge7kmECxaLuqLfuqbJATPZaoduqk5WANfTo41R4vwOd0PfkzuCu4ENGZautDQdqCTqc5v4f3nC%2FmEA3lzVbD2GfnKNN5i6QTsolJiL8iHwoY3qRGnqUpWe6styqCssbnT2On6kImCyLv8PqTQIgD5tzKTZ%2Bk7rSp%2FUGyNQ%2Fzf7CwFfbirN8%2BZ0cy8FDVRQPOIMNrtqv8FOusBG5VJhuS959dYt8SgxT1B5qInUKkmqkB9xSwqpRIrJhHLlMpiW9hAt%2BdMLFZZhmn8J5%2BdfXBiq%2FwOuwlyUwREyyNiqFLd5q%2F2oDa1jv2FMMsir1my4yAqcT0R%2BuM9KWMCRIN%2F27CpS4%2BgKGfRpQrYqZnwFoh5vyTAfyKuQbQpvNQ5z0%2F7hQPQ1Fud3gWbMbKSBMyuMEkDvn42ZK0k1WvIYPRa53VXsGPwtTo7PZ2laExqLJsXRcULDGCx08GryRt%2B5IBSaDHktFU1HTGALrwf1yRufEBKHtOimqOWitGuYxfwQnKZ1ht%2BjmX2WQ%3D%3D\u0026X-Amz-Signature=f6f13115e5cd70bfaef7cf8361d2d3b147e2b7e73d8431d73acb0172c9341e39","file_size":3194,"type":"text/plain"},{"id":418504,"file_name":"poc_head.js","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/418/504/a9caeb78d4b4723326ed2373d6028938e524629f/poc_head.js?response-content-disposition=attachment%3B%20filename%3D%22poc_head.js%22%3B%20filename%2A%3DUTF-8%27%27poc_head.js\u0026response-content-type=text%2Fplain\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQR2ZO7R4K%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T060710Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIGl53Fw9OoAeZDdXqNqIaPWdVjolNnalaCHAwbXpszPSAiEAwdHCK3x2n8ED7sSzsn1sTIqS3bguKd2LFUdH90SxxboqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDFnQ3ZZHIU4UMAvXOCqRA3wF0%2FhaPHMfYMs5a29VvIgRVY2eUJjhO2ZyE9nrbvBw99qQYURMnfpjG6qzK9RhUhaxnystL8FSjs1I9wVhv7kK6fGlwNHgR0S%2FwzzOYB4EaUAuHPPjDIaplYQHDQfhD3Jzk627x6y1whtGyRm1%2FbLU%2FMLC%2FEl2Y0VF3B2XYbmjMyMbEo%2F3JA2NhxILkWnIEx9Dc5OuLgUgvtMmXd8zqzlhwWk%2Fkbzt%2FA4PPw5G1805sqkgAV2ZtRMBvyI%2FHqrdrdjVcpE0L%2Fb3v3BTHE1AxOXymRI68r5QkUXAwvQReRh0UHKevdP2OKVlaJqNW4QPWf8V9sf08LOD6%2FIWFP2z6T0Ge7kmECxaLuqLfuqbJATPZaoduqk5WANfTo41R4vwOd0PfkzuCu4ENGZautDQdqCTqc5v4f3nC%2FmEA3lzVbD2GfnKNN5i6QTsolJiL8iHwoY3qRGnqUpWe6styqCssbnT2On6kImCyLv8PqTQIgD5tzKTZ%2Bk7rSp%2FUGyNQ%2Fzf7CwFfbirN8%2BZ0cy8FDVRQPOIMNrtqv8FOusBG5VJhuS959dYt8SgxT1B5qInUKkmqkB9xSwqpRIrJhHLlMpiW9hAt%2BdMLFZZhmn8J5%2BdfXBiq%2FwOuwlyUwREyyNiqFLd5q%2F2oDa1jv2FMMsir1my4yAqcT0R%2BuM9KWMCRIN%2F27CpS4%2BgKGfRpQrYqZnwFoh5vyTAfyKuQbQpvNQ5z0%2F7hQPQ1Fud3gWbMbKSBMyuMEkDvn42ZK0k1WvIYPRa53VXsGPwtTo7PZ2laExqLJsXRcULDGCx08GryRt%2B5IBSaDHktFU1HTGALrwf1yRufEBKHtOimqOWitGuYxfwQnKZ1ht%2BjmX2WQ%3D%3D\u0026X-Amz-Signature=fab2c893855286fb248cb56118aaf16c4e7c6e0c13ca1be0b08c2831807d6070","file_size":3725,"type":"text/plain"},{"id":418505,"file_name":"poc_real.html","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/418/505/992e45159ca1bdcdaed589b90805696362382534/poc_real.html?response-content-disposition=attachment%3B%20filename%3D%22poc_real.html%22%3B%20filename%2A%3DUTF-8%27%27poc_real.html\u0026response-content-type=application%2Foctet-stream\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQR2ZO7R4K%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T060710Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIGl53Fw9OoAeZDdXqNqIaPWdVjolNnalaCHAwbXpszPSAiEAwdHCK3x2n8ED7sSzsn1sTIqS3bguKd2LFUdH90SxxboqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDFnQ3ZZHIU4UMAvXOCqRA3wF0%2FhaPHMfYMs5a29VvIgRVY2eUJjhO2ZyE9nrbvBw99qQYURMnfpjG6qzK9RhUhaxnystL8FSjs1I9wVhv7kK6fGlwNHgR0S%2FwzzOYB4EaUAuHPPjDIaplYQHDQfhD3Jzk627x6y1whtGyRm1%2FbLU%2FMLC%2FEl2Y0VF3B2XYbmjMyMbEo%2F3JA2NhxILkWnIEx9Dc5OuLgUgvtMmXd8zqzlhwWk%2Fkbzt%2FA4PPw5G1805sqkgAV2ZtRMBvyI%2FHqrdrdjVcpE0L%2Fb3v3BTHE1AxOXymRI68r5QkUXAwvQReRh0UHKevdP2OKVlaJqNW4QPWf8V9sf08LOD6%2FIWFP2z6T0Ge7kmECxaLuqLfuqbJATPZaoduqk5WANfTo41R4vwOd0PfkzuCu4ENGZautDQdqCTqc5v4f3nC%2FmEA3lzVbD2GfnKNN5i6QTsolJiL8iHwoY3qRGnqUpWe6styqCssbnT2On6kImCyLv8PqTQIgD5tzKTZ%2Bk7rSp%2FUGyNQ%2Fzf7CwFfbirN8%2BZ0cy8FDVRQPOIMNrtqv8FOusBG5VJhuS959dYt8SgxT1B5qInUKkmqkB9xSwqpRIrJhHLlMpiW9hAt%2BdMLFZZhmn8J5%2BdfXBiq%2FwOuwlyUwREyyNiqFLd5q%2F2oDa1jv2FMMsir1my4yAqcT0R%2BuM9KWMCRIN%2F27CpS4%2BgKGfRpQrYqZnwFoh5vyTAfyKuQbQpvNQ5z0%2F7hQPQ1Fud3gWbMbKSBMyuMEkDvn42ZK0k1WvIYPRa53VXsGPwtTo7PZ2laExqLJsXRcULDGCx08GryRt%2B5IBSaDHktFU1HTGALrwf1yRufEBKHtOimqOWitGuYxfwQnKZ1ht%2BjmX2WQ%3D%3D\u0026X-Amz-Signature=140dab2867513844f6c860d2cdeb23a57739138ad5150bd4dd2f7dee9ec0a91e","file_size":2990,"type":"text/html"}],"allow_singular_disclosure_at":"2019-05-02T17:50:02.333Z","allow_singular_disclosure_after":-52402628.57202763,"singular_disclosure_allowed":true,"vote_count":63,"voters":["kapytein","foobar7","floerer","mik317","sameerphad72","mygf","marianodav","elmahdi","eveeez","an0nym0us","and 53 more..."],"severity":{"rating":"high","author_type":"User"},"structured_scope":{"databaseId":1062,"asset_type":"URL","asset_identifier":"*.twitter.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":4112783,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Thank you for your report @terjanq. \n\nWe were able to reproduce this vulnerability. However, we had some concerns about your attack scenario. Your POC appears to discloses these \"private tweets\" to the private user themselves, rather than a malicious 3rd party. Can you explain how an attacker could access these private Tweets?\n\nThank you for thinking of Twitter security.","markdown_message":"\u003cp\u003eThank you for your report \u003ca href=\"/terjanq\"\u003e@terjanq\u003c/a\u003e. \u003c/p\u003e\n\n\u003cp\u003eWe were able to reproduce this vulnerability. However, we had some concerns about your attack scenario. Your POC appears to discloses these \u0026quot;private tweets\u0026quot; to the private user themselves, rather than a malicious 3rd party. Can you explain how an attacker could access these private Tweets?\u003c/p\u003e\n\n\u003cp\u003eThank you for thinking of Twitter security.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-02-08T00:57:14.978Z","updated_at":"2019-02-08T00:57:14.978Z","actor":{"username":"bugtriage-alex","cleared":false,"url":"/bugtriage-alex","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4112844,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"The attacker knowing the twitter screen name of the victim can send them the malicious link which when accessed can lead to exposure of mentioned information. Also, in combination with my previously reported attack (which for some reason was rejected, https://hackerone.com/reports/491243) the attacker can deanonymize the visitor when having them in the database. For example, such database could contain important people such as politicians, senators - where exposing the protected tweets could be really dangerous. \n\nThe PoC contains the field \"from\" which attacker can choose as he wishes and it doesn't leak the protected tweets for the private user themselves - it was only made this way to demonstrate the possibilities of the attack.","markdown_message":"\u003cp\u003eThe attacker knowing the twitter screen name of the victim can send them the malicious link which when accessed can lead to exposure of mentioned information. Also, in combination with my previously reported attack (which for some reason was rejected, \u003ca title=\"https://hackerone.com/reports/491243\" href=\"https://hackerone.com/reports/491243\"\u003ehttps://hackerone.com/reports/491243\u003c/a\u003e) the attacker can deanonymize the visitor when having them in the database. For example, such database could contain important people such as politicians, senators - where exposing the protected tweets could be really dangerous. \u003c/p\u003e\n\n\u003cp\u003eThe PoC contains the field \u0026quot;from\u0026quot; which attacker can choose as he wishes and it doesn\u0026#39;t leak the protected tweets for the private user themselves - it was only made this way to demonstrate the possibilities of the attack.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-02-08T01:15:12.865Z","updated_at":"2019-02-08T01:19:52.396Z","actor":{"username":"terjanq","cleared":false,"url":"/terjanq","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/353/987/2ae95a623dfabcdb416ac12e999390c60f4e83a6_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4112871,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Also, the attacker can just obtain the twitter screen name of a visitor by providing the third-party application which requires the visitor to authorize with twitter but without asking for permission to access victim's protected tweets (only screen name is the requirement).","markdown_message":"\u003cp\u003eAlso, the attacker can just obtain the twitter screen name of a visitor by providing the third-party application which requires the visitor to authorize with twitter but without asking for permission to access victim\u0026#39;s protected tweets (only screen name is the requirement).\u003c/p\u003e\n","automated_response":false,"created_at":"2019-02-08T01:36:01.863Z","updated_at":"2019-02-08T01:36:01.863Z","actor":{"username":"terjanq","cleared":false,"url":"/terjanq","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/353/987/2ae95a623dfabcdb416ac12e999390c60f4e83a6_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4116535,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"If your misunderstanding of the attack came from that you had to manually input the text in the PoC that the attacker could search for, here comes the attack scenario.\n\nThe state about whether there are search results or not serves as an oracle. The attacker can ask the oracle whether a specific chain of words/numbers exist in tweets or not. Given this information, the attacker can find most of the words used in the tweets by using a huge list of most commonly used words, for example, TOP10k list from Google https://raw.githubusercontent.com/first20hours/google-10000-english/master/google-10000-english-usa.txt. It can be done effectively with the technique I used for fetching all 3-digit numbers by using the binary-search algorithm. Then by combining them in the right order, also using binary-search, the attacker can obtain full phrases. \n\nAnother method is to use advanced heuristics to predict the words in sentences. As for an example, one method was described in this paper https://pdfs.semanticscholar.org/f9c3/3dd288f60dc87fc59ff94e3eeeac5a249dfd.pdf.","markdown_message":"\u003cp\u003eIf your misunderstanding of the attack came from that you had to manually input the text in the PoC that the attacker could search for, here comes the attack scenario.\u003c/p\u003e\n\n\u003cp\u003eThe state about whether there are search results or not serves as an oracle. The attacker can ask the oracle whether a specific chain of words/numbers exist in tweets or not. Given this information, the attacker can find most of the words used in the tweets by using a huge list of most commonly used words, for example, TOP10k list from Google \u003ca title=\"https://raw.githubusercontent.com/first20hours/google-10000-english/master/google-10000-english-usa.txt\" href=\"/redirect?url=https%3A%2F%2Fraw.githubusercontent.com%2Ffirst20hours%2Fgoogle-10000-english%2Fmaster%2Fgoogle-10000-english-usa.txt\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://raw.githubusercontent.com/first20hours/google-10000-english/master/google-10000-english-usa.txt\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e. It can be done effectively with the technique I used for fetching all 3-digit numbers by using the binary-search algorithm. Then by combining them in the right order, also using binary-search, the attacker can obtain full phrases. \u003c/p\u003e\n\n\u003cp\u003eAnother method is to use advanced heuristics to predict the words in sentences. As for an example, one method was described in this paper \u003ca title=\"https://pdfs.semanticscholar.org/f9c3/3dd288f60dc87fc59ff94e3eeeac5a249dfd.pdf\" href=\"/redirect?url=https%3A%2F%2Fpdfs.semanticscholar.org%2Ff9c3%2F3dd288f60dc87fc59ff94e3eeeac5a249dfd.pdf\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://pdfs.semanticscholar.org/f9c3/3dd288f60dc87fc59ff94e3eeeac5a249dfd.pdf\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-02-08T18:47:01.000Z","updated_at":"2019-02-08T18:49:13.908Z","actor":{"username":"terjanq","cleared":false,"url":"/terjanq","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/353/987/2ae95a623dfabcdb416ac12e999390c60f4e83a6_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4117925,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you for your response @terjanq.\n\nWe're evaluating the behavior in your report, and we'll keep you updated when we have additional information.\n\nThank you for thinking of Twitter security.\n","markdown_message":"\u003cp\u003eThank you for your response \u003ca href=\"/terjanq\"\u003e@terjanq\u003c/a\u003e.\u003c/p\u003e\n\n\u003cp\u003eWe\u0026#39;re evaluating the behavior in your report, and we\u0026#39;ll keep you updated when we have additional information.\u003c/p\u003e\n\n\u003cp\u003eThank you for thinking of Twitter security.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-02-08T23:11:23.671Z","updated_at":"2019-02-08T23:11:23.671Z","actor":{"username":"bugtriage-alex","cleared":false,"url":"/bugtriage-alex","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4144398,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thank you for your report. We believe it may be a valid security issue and will investigate it further. It could take some time to find and update the root cause for an issue, so we thank you for your patience.\n\nThank you for helping keep Twitter secure!","markdown_message":"\u003cp\u003eThank you for your report. We believe it may be a valid security issue and will investigate it further. It could take some time to find and update the root cause for an issue, so we thank you for your patience.\u003c/p\u003e\n\n\u003cp\u003eThank you for helping keep Twitter secure!\u003c/p\u003e\n","automated_response":false,"created_at":"2019-02-13T19:07:10.914Z","updated_at":"2019-02-13T19:07:10.914Z","actor":{"username":"andrewsorensen","cleared":false,"url":"/andrewsorensen","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4194097,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks again. As mentioned we’ll keep you updated as we investigate further. As a reminder, please remember to keep the details of this report private until we have fully investigated and addressed the issue.","markdown_message":"\u003cp\u003eThanks again. As mentioned we’ll keep you updated as we investigate further. As a reminder, please remember to keep the details of this report private until we have fully investigated and addressed the issue.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-02-22T18:49:48.295Z","updated_at":"2019-02-22T18:49:48.295Z","actor":{"url":"/twitter","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/061/85a63a443f017ad8353de4f68ebf52fdd61c345a_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Twitter"}},"bounty_amount":"560.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"twitter","collaborator":{"username":"terjanq","url":"/terjanq"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4376572,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"We consider this issue to be fixed now, by removing the redirect. Can you please confirm?\n\nThank you for helping keep Twitter secure!","markdown_message":"\u003cp\u003eWe consider this issue to be fixed now, by removing the redirect. Can you please confirm?\u003c/p\u003e\n\n\u003cp\u003eThank you for helping keep Twitter secure!\u003c/p\u003e\n","automated_response":false,"created_at":"2019-03-23T06:00:40.737Z","updated_at":"2019-03-23T06:00:40.737Z","actor":{"username":"andrewsorensen","cleared":false,"url":"/andrewsorensen","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"terjanq","url":"/terjanq"},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4379118,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I confirm it's fixed. \n\nThanks.","markdown_message":"\u003cp\u003eI confirm it\u0026#39;s fixed. \u003c/p\u003e\n\n\u003cp\u003eThanks.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-03-23T23:37:38.959Z","updated_at":"2019-03-23T23:37:38.959Z","actor":{"username":"terjanq","cleared":false,"url":"/terjanq","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/353/987/2ae95a623dfabcdb416ac12e999390c60f4e83a6_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4449826,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Hi, Would it be possible to disclose the report publicily? That would be a nice addition to my XS-Search research. ","markdown_message":"\u003cp\u003eHi, Would it be possible to disclose the report publicily? That would be a nice addition to my XS-Search research. \u003c/p\u003e\n","automated_response":false,"created_at":"2019-04-02T17:50:02.284Z","updated_at":"2019-04-02T17:50:02.284Z","first_to_agree":true,"actor":{"username":"terjanq","cleared":false,"url":"/terjanq","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/353/987/2ae95a623dfabcdb416ac12e999390c60f4e83a6_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4599131,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-04-19T16:34:21.161Z","updated_at":"2019-04-19T16:34:21.161Z","actor":{"username":"acamacho","cleared":false,"url":"/acamacho","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4599132,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-04-19T16:34:21.253Z","updated_at":"2019-04-19T16:34:21.253Z","actor":{"username":"acamacho","cleared":false,"url":"/acamacho","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}