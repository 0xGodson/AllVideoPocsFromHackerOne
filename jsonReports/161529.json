{"id":161529,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNjE1Mjk=","url":"https://hackerone.com/reports/161529","title":"Site-wide CSRF on eats.uber.com","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2016-08-20T04:44:24.921Z","submitted_at":"2016-08-20T04:44:24.921Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"indoappsec","url":"/indoappsec","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/QUAjqUf576QNBhxg691WB8YG/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":314,"url":"https://hackerone.com/uber","handle":"uber","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/314/24ea21370a71b18eafb5722d5855825ab622b5dd_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/314/24ea21370a71b18eafb5722d5855825ab622b5dd_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Uber","twitter_handle":"","website":"https://www.uber.com","about":""}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"no-content","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2018-12-19T22:39:06.748Z","bug_reporter_agreed_on_going_public_at":"2016-10-04T11:35:02.931Z","team_member_agreed_on_going_public_at":"2018-12-19T22:39:06.695Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"","vulnerability_information_html":"","bounty_amount":"6000.0","formatted_bounty":"$6,000","weakness":{"id":45,"name":"Cross-Site Request Forgery (CSRF)"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":26,"voters":["spam404","sameerphad72","andirrahmani","skavans","vipul_garg","mygf","luchua","iamurstkj","an0nym0us","fantam1","and 16 more..."],"severity":{"rating":"high","author_type":"Team"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1145086,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"","markdown_message":"","automated_response":false,"created_at":"2016-08-22T16:09:56.084Z","updated_at":"2016-08-22T16:09:56.084Z","actor":{"username":"bugtriage-rob","cleared":false,"url":"/bugtriage-rob","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1145239,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2016-08-22T17:19:56.219Z","updated_at":"2016-08-22T17:19:56.219Z","actor":{"username":"lyoung-uber","cleared":false,"url":"/lyoung-uber","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/079/873/b506b7984a2afcd680a9d5e57f66a0c524760b47_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1145242,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2016-08-22T17:20:07.475Z","updated_at":"2016-08-22T17:20:07.475Z","actor":{"username":"lyoung-uber","cleared":false,"url":"/lyoung-uber","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/079/873/b506b7984a2afcd680a9d5e57f66a0c524760b47_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1145401,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2016-08-22T18:06:13.589Z","updated_at":"2016-08-22T18:06:13.589Z","actor":{"username":"indoappsec","cleared":true,"url":"/indoappsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/QUAjqUf576QNBhxg691WB8YG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1146115,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2016-08-22T21:49:26.651Z","updated_at":"2016-08-22T21:49:26.651Z","actor":{"username":"lyoung-uber","cleared":false,"url":"/lyoung-uber","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/079/873/b506b7984a2afcd680a9d5e57f66a0c524760b47_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1167900,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2016-09-01T17:08:21.690Z","updated_at":"2016-09-01T17:08:21.690Z","actor":{"username":"indoappsec","cleared":true,"url":"/indoappsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/QUAjqUf576QNBhxg691WB8YG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1168452,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2016-09-01T20:56:10.848Z","updated_at":"2016-09-01T20:56:10.848Z","actor":{"username":"tno","cleared":false,"url":"/tno","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1180871,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2016-09-07T20:03:08.197Z","updated_at":"2016-09-07T20:03:08.197Z","actor":{"username":"lindsey-uber","cleared":false,"url":"/lindsey-uber","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"indoappsec","url":"/indoappsec"},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1190012,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2016-09-12T23:45:16.004Z","updated_at":"2016-09-12T23:45:16.004Z","actor":{"url":"/uber","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/314/24ea21370a71b18eafb5722d5855825ab622b5dd_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Uber"}},"bounty_amount":"6000.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"uber","collaborator":{"username":"indoappsec","url":"/indoappsec"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1231031,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-10-04T11:35:02.946Z","updated_at":"2016-10-04T11:35:02.946Z","first_to_agree":true,"actor":{"username":"indoappsec","cleared":true,"url":"/indoappsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/QUAjqUf576QNBhxg691WB8YG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1319744,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2016-11-25T20:25:04.336Z","updated_at":"2016-11-25T20:25:04.336Z","actor":{"username":"indoappsec","cleared":true,"url":"/indoappsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/QUAjqUf576QNBhxg691WB8YG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1555236,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2017-03-21T18:05:15.504Z","updated_at":"2017-03-21T18:05:15.504Z","actor":{"username":"indoappsec","cleared":true,"url":"/indoappsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/QUAjqUf576QNBhxg691WB8YG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3868727,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2018-12-19T22:38:33.414Z","updated_at":"2018-12-19T22:38:33.414Z","additional_data":{},"actor":{"username":"joel-uber","cleared":false,"url":"/joel-uber","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3868730,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2018-12-19T22:38:56.921Z","updated_at":"2018-12-19T22:38:56.921Z","additional_data":{},"actor":{"username":"joel-uber","cleared":false,"url":"/joel-uber","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3868732,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-12-19T22:39:06.719Z","updated_at":"2018-12-19T22:39:06.719Z","actor":{"username":"joel-uber","cleared":false,"url":"/joel-uber","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3868733,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-12-19T22:39:06.766Z","updated_at":"2018-12-19T22:39:06.766Z","actor":{"username":"joel-uber","cleared":false,"url":"/joel-uber","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3868734,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2018-12-19T22:39:24.958Z","updated_at":"2018-12-19T22:39:24.958Z","additional_data":{},"actor":{"username":"joel-uber","cleared":false,"url":"/joel-uber","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":12892,"category":"team","content":"There was a lack of CSRF protections on `eats.uber.com` which allowed an attacker to add a credit card to another account. Shortly after reporting, @vijay_kumar1110 noticed other endpoints on the same domain which also lacked CSRF protections and added them to his report. Following further investigation, we found that there was a complete lack of any CSRF protections on `eats.uber.com`, allowing an attacker to make requests on behalf of another user arbitrarily. At the time of reporting, this was thought to be a one-time issue but ended up being something that existed across the rest of the service which increased the severity of this issue.\n\nThanks, @vijay_kumar1110!","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eThere was a lack of CSRF protections on \u003ccode\u003eeats.uber.com\u003c/code\u003e which allowed an attacker to add a credit card to another account. Shortly after reporting, \u003ca href=\"/vijay_kumar1110\"\u003e@vijay_kumar1110\u003c/a\u003e noticed other endpoints on the same domain which also lacked CSRF protections and added them to his report. Following further investigation, we found that there was a complete lack of any CSRF protections on \u003ccode\u003eeats.uber.com\u003c/code\u003e, allowing an attacker to make requests on behalf of another user arbitrarily. At the time of reporting, this was thought to be a one-time issue but ended up being something that existed across the rest of the service which increased the severity of this issue.\u003c/p\u003e\n\n\u003cp\u003eThanks, \u003ca href=\"/vijay_kumar1110\"\u003e@vijay_kumar1110\u003c/a\u003e!\u003c/p\u003e\n"},{"category":"researcher","can_view?":true,"can_create?":false}]}