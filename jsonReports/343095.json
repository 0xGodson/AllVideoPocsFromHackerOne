{"id":343095,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zNDMwOTU=","url":"https://hackerone.com/reports/343095","title":"Session Cookie Without Secure Flag,","state":"Closed","substate":"informative","severity_rating":"none","readable_substate":"Informative","created_at":"2018-04-25T15:54:20.960Z","submitted_at":"2018-04-25T15:54:20.960Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"tangent90ninety","url":"/tangent90ninety","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/214/003/790c458050cf08a08e6fe911006639824ea1edc8_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":24342,"url":"https://hackerone.com/ed","handle":"ed","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/024/342/18764de1df9c5df2781f5975a3c01990e8933dd0_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/024/342/18764de1df9c5df2781f5975a3c01990e8933dd0_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Ed","twitter_handle":"EdOverflow","website":"https://edoverflow.com","about":"This is a vulnerability disclosure program for all of my personal projects and code that I publish."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2018-04-26T13:07:34.627Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2018-04-26T13:07:00.620Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Assigned to:-ED\nAssigned by:- Kirtikumar Anandrao Ramchandani\nAssigned on:- 25/04/2018\nBug overview:- Session Cookie without secure flag.\nCookie Name:-  _gitlab_session\nDescription:-Risk description:\nSince the Secure flag is not set on the cookie, the browser will send it over an unencrypted channel (plain HTTP) if such a request is made. Thus, the risk exists that an attacker will intercept the clear-text communication between the browser and the server and he will steal the cookie of the user. If this is a session cookie, the attacker could gain unauthorized access to the victim's web session. \nRecommendation:I recommend reconfiguring the web server in order to set the flag(s) Secure to all sensitive cookies. \nReference:-https://blog.dareboost.com/en/2016/12/secure-cookies-secure-httponly-flags/.\n\n## Impact\n\nThe secure flag is an option that can be set by the application server when sending a new cookie to the user within an HTTP Response. The purpose of the secure flag is to prevent cookies from being observed by unauthorized parties due to the transmission of a the cookie in clear text.\nTo accomplish this goal, browsers which support the secure flag will only send cookies with the secure flag when the request is going to a HTTPS page. Said in another way, the browser will not send a cookie with the secure flag set over an unencrypted HTTP request.\nBy setting the secure flag, the browser will prevent the transmission of a cookie over an unencrypted channel.","vulnerability_information_html":"\u003cp\u003eAssigned to:-ED\u003cbr\u003e\nAssigned by:- Kirtikumar Anandrao Ramchandani\u003cbr\u003e\nAssigned on:- 25/04/2018\u003cbr\u003e\nBug overview:- Session Cookie without secure flag.\u003cbr\u003e\nCookie Name:-  _gitlab_session\u003cbr\u003e\nDescription:-Risk description:\u003cbr\u003e\nSince the Secure flag is not set on the cookie, the browser will send it over an unencrypted channel (plain HTTP) if such a request is made. Thus, the risk exists that an attacker will intercept the clear-text communication between the browser and the server and he will steal the cookie of the user. If this is a session cookie, the attacker could gain unauthorized access to the victim\u0026#39;s web session. \u003cbr\u003e\nRecommendation:I recommend reconfiguring the web server in order to set the flag(s) Secure to all sensitive cookies. \u003cbr\u003e\nReference:-\u003ca title=\"https://blog.dareboost.com/en/2016/12/secure-cookies-secure-httponly-flags/\" href=\"/redirect?url=https%3A%2F%2Fblog.dareboost.com%2Fen%2F2016%2F12%2Fsecure-cookies-secure-httponly-flags%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://blog.dareboost.com/en/2016/12/secure-cookies-secure-httponly-flags/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e.\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eThe secure flag is an option that can be set by the application server when sending a new cookie to the user within an HTTP Response. The purpose of the secure flag is to prevent cookies from being observed by unauthorized parties due to the transmission of a the cookie in clear text.\u003cbr\u003e\nTo accomplish this goal, browsers which support the secure flag will only send cookies with the secure flag when the request is going to a HTTPS page. Said in another way, the browser will not send a cookie with the secure flag set over an unencrypted HTTP request.\u003cbr\u003e\nBy setting the secure flag, the browser will prevent the transmission of a cookie over an unencrypted channel.\u003c/p\u003e\n","weakness":{"id":18,"name":"Information Disclosure"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":4,"voters":["xiaoyinl","kunal94","khizer47","clarckowen_"],"severity":{"rating":"none","author_type":"Team"},"structured_scope":{"databaseId":8869,"asset_type":"URL","asset_identifier":"https://git.edoverflow.com/","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":2668410,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"Hi @k1rt100f1c1al,\n\nExpoitability of this issue is so low that it does not warrant an immediate fix. In order to actually exploit this issue you would need to find an XSS vulnerability. Please feel free to prove me wrong by hacking me.\n\n\\- Ed","markdown_message":"\u003cp\u003eHi \u003ca href=\"/k1rt100f1c1al\"\u003e@k1rt100f1c1al\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eExpoitability of this issue is so low that it does not warrant an immediate fix. In order to actually exploit this issue you would need to find an XSS vulnerability. Please feel free to prove me wrong by hacking me.\u003c/p\u003e\n\n\u003cp\u003e- Ed\u003c/p\u003e\n","automated_response":false,"created_at":"2018-04-26T13:06:51.729Z","updated_at":"2018-04-26T13:06:51.729Z","actor":{"username":"edoverflow","cleared":true,"url":"/edoverflow","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/116/374/9a3cf4d62b2f507a0d33808aacbad863ec4455ac_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ed","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2668411,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-04-26T13:07:00.652Z","updated_at":"2018-04-26T13:07:00.652Z","first_to_agree":true,"actor":{"username":"edoverflow","cleared":true,"url":"/edoverflow","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/116/374/9a3cf4d62b2f507a0d33808aacbad863ec4455ac_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ed","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2668412,"is_internal":false,"editable":false,"type":"Activities::ManuallyDisclosed","message":"Disclosing this report to prevent others from reporting similar issues in the future.","markdown_message":"\u003cp\u003eDisclosing this report to prevent others from reporting similar issues in the future.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-04-26T13:07:34.568Z","updated_at":"2018-04-26T13:07:34.568Z","actor":{"username":"edoverflow","cleared":true,"url":"/edoverflow","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/116/374/9a3cf4d62b2f507a0d33808aacbad863ec4455ac_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ed","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2668413,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Ok sir ","markdown_message":"\u003cp\u003eOk sir \u003c/p\u003e\n","automated_response":false,"created_at":"2018-04-26T13:08:20.176Z","updated_at":"2018-04-26T13:08:20.176Z","actor":{"username":"tangent90ninety","cleared":false,"url":"/tangent90ninety","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/214/003/790c458050cf08a08e6fe911006639824ea1edc8_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"ed","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2668440,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2018-04-26T13:18:30.109Z","updated_at":"2018-04-26T13:18:30.109Z","additional_data":{"old_severity":"Medium","new_severity":"None","old_severity_id":145297,"new_severity_id":145615},"actor":{"username":"edoverflow","cleared":true,"url":"/edoverflow","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/116/374/9a3cf4d62b2f507a0d33808aacbad863ec4455ac_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ed","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2676211,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Quick correction as someone pointed out to me earlier, this is a MITM type of attack and does not require XSS to exploit. I got this mixed up with HTTPOnly cookies while reviewing the report. Apologies for the confusion, @tangent90ninety, hopefully that did not send you down the wrong path. That all being said, this is still not something that I am personally interested in fixing right now.  I suggest reporting this to GitLab as this might be something that they are willing to fix.\n\n\\- Ed","markdown_message":"\u003cp\u003eQuick correction as someone pointed out to me earlier, this is a MITM type of attack and does not require XSS to exploit. I got this mixed up with HTTPOnly cookies while reviewing the report. Apologies for the confusion, \u003ca href=\"/tangent90ninety\"\u003e@tangent90ninety\u003c/a\u003e, hopefully that did not send you down the wrong path. That all being said, this is still not something that I am personally interested in fixing right now.  I suggest reporting this to GitLab as this might be something that they are willing to fix.\u003c/p\u003e\n\n\u003cp\u003e- Ed\u003c/p\u003e\n","automated_response":false,"created_at":"2018-04-28T14:26:57.951Z","updated_at":"2018-04-28T14:26:57.951Z","actor":{"username":"edoverflow","cleared":true,"url":"/edoverflow","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/116/374/9a3cf4d62b2f507a0d33808aacbad863ec4455ac_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ed","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2679469,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Ok sir!!","markdown_message":"\u003cp\u003eOk sir!!\u003c/p\u003e\n","automated_response":false,"created_at":"2018-04-30T10:58:48.248Z","updated_at":"2018-04-30T10:58:48.248Z","actor":{"username":"tangent90ninety","cleared":false,"url":"/tangent90ninety","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/214/003/790c458050cf08a08e6fe911006639824ea1edc8_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"ed","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2681254,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello sir the gitlab has closed report as N/A and said that it is owned by you so you will fix that issue!! Can you please ask them? ","markdown_message":"\u003cp\u003eHello sir the gitlab has closed report as N/A and said that it is owned by you so you will fix that issue!! Can you please ask them? \u003c/p\u003e\n","automated_response":false,"created_at":"2018-04-30T18:00:53.489Z","updated_at":"2018-04-30T18:00:53.489Z","actor":{"username":"tangent90ninety","cleared":false,"url":"/tangent90ninety","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/214/003/790c458050cf08a08e6fe911006639824ea1edc8_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"ed","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2682283,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @tangent90ninety,\n\nI totally messed up here for three reasons.\n\n1) It turns out this is an issue caused by me. GitLab does not set the secure flag on session cookies by default. You have to go rummaging through configuration files in order to enable the flag (`/opt/gitlab/embedded/service/gitlab-rails/config/environments/production.rb`). I am still dumbfounded by the fact that this is not enabled by default.\n\n```ruby\n# Force all access to the app over SSL, use Strict-Transport-Security, and use secure cookies.\nconfig.force_ssl = true\n```\n\n2) I told you to report it to GitLab without checking their security policy quickly. GitLab explicitly state that they are not interested in these type of reports.\n3) I publicly disclosed this report which means I cannot reopen it. :(\n\nSince I made all these mistakes, I would kindly request that you submit a new report with all the information you provided here and I will give you some points. :)\n\nReally sorry about all of this, @tangent90ninety. This was a good learning experience for me.\n\\- Ed","markdown_message":"\u003cp\u003eHi \u003ca href=\"/tangent90ninety\"\u003e@tangent90ninety\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eI totally messed up here for three reasons.\u003c/p\u003e\n\n\u003cp\u003e1) It turns out this is an issue caused by me. GitLab does not set the secure flag on session cookies by default. You have to go rummaging through configuration files in order to enable the flag (\u003ccode\u003e/opt/gitlab/embedded/service/gitlab-rails/config/environments/production.rb\u003c/code\u003e). I am still dumbfounded by the fact that this is not enabled by default.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight ruby\"\u003e\u003ccode\u003e\u003cspan class=\"c1\"\u003e# Force all access to the app over SSL, use Strict-Transport-Security, and use secure cookies.\u003c/span\u003e\n\u003cspan class=\"n\"\u003econfig\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eforce_ssl\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"kp\"\u003etrue\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e2) I told you to report it to GitLab without checking their security policy quickly. GitLab explicitly state that they are not interested in these type of reports.\u003cbr\u003e\n3) I publicly disclosed this report which means I cannot reopen it. :(\u003c/p\u003e\n\n\u003cp\u003eSince I made all these mistakes, I would kindly request that you submit a new report with all the information you provided here and I will give you some points. :)\u003c/p\u003e\n\n\u003cp\u003eReally sorry about all of this, \u003ca href=\"/tangent90ninety\"\u003e@tangent90ninety\u003c/a\u003e. This was a good learning experience for me.\u003cbr\u003e\n- Ed\u003c/p\u003e\n","automated_response":false,"created_at":"2018-04-30T19:51:50.383Z","updated_at":"2018-04-30T19:51:50.383Z","actor":{"username":"edoverflow","cleared":true,"url":"/edoverflow","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/116/374/9a3cf4d62b2f507a0d33808aacbad863ec4455ac_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ed","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2682288,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you very much sir :) ","markdown_message":"\u003cp\u003eThank you very much sir :) \u003c/p\u003e\n","automated_response":false,"created_at":"2018-04-30T19:54:17.954Z","updated_at":"2018-04-30T19:54:17.954Z","actor":{"username":"tangent90ninety","cleared":false,"url":"/tangent90ninety","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/214/003/790c458050cf08a08e6fe911006639824ea1edc8_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"ed","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2682295,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Sorry sir but my signals are not good due to which I can't make a new submission :/ ","markdown_message":"\u003cp\u003eSorry sir but my signals are not good due to which I can\u0026#39;t make a new submission :/ \u003c/p\u003e\n","automated_response":false,"created_at":"2018-04-30T19:55:39.707Z","updated_at":"2018-04-30T19:55:39.707Z","actor":{"username":"tangent90ninety","cleared":false,"url":"/tangent90ninety","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/214/003/790c458050cf08a08e6fe911006639824ea1edc8_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"ed","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2682302,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"OK, I turned off signal requirements now. You may submit your report. :)","markdown_message":"\u003cp\u003eOK, I turned off signal requirements now. You may submit your report. :)\u003c/p\u003e\n","automated_response":false,"created_at":"2018-04-30T19:57:49.200Z","updated_at":"2018-04-30T19:57:49.200Z","actor":{"username":"edoverflow","cleared":true,"url":"/edoverflow","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/116/374/9a3cf4d62b2f507a0d33808aacbad863ec4455ac_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ed","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2682310,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you for doing so :) ","markdown_message":"\u003cp\u003eThank you for doing so :) \u003c/p\u003e\n","automated_response":false,"created_at":"2018-04-30T20:02:10.452Z","updated_at":"2018-04-30T20:02:10.452Z","actor":{"username":"tangent90ninety","cleared":false,"url":"/tangent90ninety","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/214/003/790c458050cf08a08e6fe911006639824ea1edc8_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"ed","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2682331,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello sir I had completed the submission can you please check?","markdown_message":"\u003cp\u003eHello sir I had completed the submission can you please check?\u003c/p\u003e\n","automated_response":false,"created_at":"2018-04-30T20:08:05.247Z","updated_at":"2018-04-30T20:08:05.247Z","actor":{"username":"tangent90ninety","cleared":false,"url":"/tangent90ninety","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/214/003/790c458050cf08a08e6fe911006639824ea1edc8_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"ed","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}