{"id":226712,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMjY3MTI=","url":"https://hackerone.com/reports/226712","title":"Broken Authentication \u0026 Session Management - Failure to Invalidate Session on all other browsers at Password change","state":"Closed","substate":"not-applicable","severity_rating":"critical","readable_substate":"N/A","created_at":"2017-05-07T12:29:01.783Z","submitted_at":"2017-05-07T12:29:01.783Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"koviri_jagdish","url":"/koviri_jagdish","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/SH36DRShx9Fg6MBsbTc5tsnW/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":8539,"url":"https://hackerone.com/paragonie","handle":"paragonie","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/008/539/72f76fed45e5220b47ba2f679371ebf9ccb19c70_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/539/72f76fed45e5220b47ba2f679371ebf9ccb19c70_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Paragon Initiative Enterprises","twitter_handle":"ParagonIE","website":"https://github.com/paragonie","about":"Cryptography and Application Security Consultants - We Produce Various Open Source Libraries"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2017-05-07T16:44:12.869Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2017-05-07T16:44:07.255Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Broken Authentication \u0026 Session Management - Failure to Invalidate Session on all other browsers at Password change\n==========================================================\nHello Team,\nWhile I was testing your web application \"Paragon Initiative Enterprises\", I came to know that it is vulnerable to \"Broken Authentication and Session Management \u003e Failure to Invalidate Session \u003e On Password Reset\" at https://bridge.cspr.ng/my/account .\n\nDescription : When a user changes his account password, all the sessions on other devices/browsers should expire.\n\nCause : Suppose any user (victim) left his account logged in on any computer/browser (victim could use browser at Cyber Cafe or any shared computer). And after a particular he realized that he left his account logged in, and there is a security provided that when a user changes his account password all other sessions should invalidate or expire, which will expire the session from that shared computer.\n\nBut in your web application, I didn't found any such security that invalidate the session after password. Here if any user left his account logged in, any attacker can misuse the victim's account and there is no option available to the victim to invalidate the session on that shared computer which could lead to some major problems.\n\n\n\u003eSteps to reproduce the bug :\n\u003eStep 1 : Go to Browser A at (say Mozilla Firefox) and login with your credentials at https://bridge.cspr.ng/ and login with your credentials.\n\n\u003eStep 2 : Similarly, Go to Browser B at (say Google Chrome) and login with your same credentials at https://bridge.cspr.ng/ and login with your credentials.\n\n\u003eStep 3 : Suppose Browser A (Mozilla Firefox) is an shared computer's browser, and you left your account logged in at that computer. Go to Browser B (Google Chrome) and change your account\npassword at https://bridge.cspr.ng/my/account.\n\n\u003eStep 4 : When you change your account password at Browser B (Google Chrome), the session at Browser A (Mozilla Firefox) should expire and the account should automatically logged out.\n\n\u003eStep 5 : Go to Browser A (Mozilla Firefox), and visit your https://bridge.cspr.ng/ account page and refresh the page.\n\nYou will notice that even after changing the account password at Browser B (Google Chrome), the session at Browser A (Mozilla Firefox) didn't expired which can cause major problems.\n\nPlease fix the bug and let me know if you need any other information.\n\nRegards\nK. Jagdish\n","vulnerability_information_html":"\u003ch1 id=\"broken-authentication\"\u003eBroken Authentication \u0026amp; Session Management - Failure to Invalidate Session on all other browsers at Password change\u003c/h1\u003e\n\n\u003cp\u003eHello Team,\u003cbr\u003e\nWhile I was testing your web application \u0026quot;Paragon Initiative Enterprises\u0026quot;, I came to know that it is vulnerable to \u0026quot;Broken Authentication and Session Management \u0026gt; Failure to Invalidate Session \u0026gt; On Password Reset\u0026quot; at \u003ca title=\"https://bridge.cspr.ng/my/account\" href=\"/redirect?url=https%3A%2F%2Fbridge.cspr.ng%2Fmy%2Faccount\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://bridge.cspr.ng/my/account\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e .\u003c/p\u003e\n\n\u003cp\u003eDescription : When a user changes his account password, all the sessions on other devices/browsers should expire.\u003c/p\u003e\n\n\u003cp\u003eCause : Suppose any user (victim) left his account logged in on any computer/browser (victim could use browser at Cyber Cafe or any shared computer). And after a particular he realized that he left his account logged in, and there is a security provided that when a user changes his account password all other sessions should invalidate or expire, which will expire the session from that shared computer.\u003c/p\u003e\n\n\u003cp\u003eBut in your web application, I didn\u0026#39;t found any such security that invalidate the session after password. Here if any user left his account logged in, any attacker can misuse the victim\u0026#39;s account and there is no option available to the victim to invalidate the session on that shared computer which could lead to some major problems.\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eSteps to reproduce the bug :\u003cbr\u003e\nStep 1 : Go to Browser A at (say Mozilla Firefox) and login with your credentials at \u003ca title=\"https://bridge.cspr.ng/\" href=\"/redirect?url=https%3A%2F%2Fbridge.cspr.ng%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://bridge.cspr.ng/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e and login with your credentials.\u003c/p\u003e\n\n\u003cp\u003eStep 2 : Similarly, Go to Browser B at (say Google Chrome) and login with your same credentials at \u003ca title=\"https://bridge.cspr.ng/\" href=\"/redirect?url=https%3A%2F%2Fbridge.cspr.ng%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://bridge.cspr.ng/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e and login with your credentials.\u003c/p\u003e\n\n\u003cp\u003eStep 3 : Suppose Browser A (Mozilla Firefox) is an shared computer\u0026#39;s browser, and you left your account logged in at that computer. Go to Browser B (Google Chrome) and change your account\u003cbr\u003e\npassword at \u003ca title=\"https://bridge.cspr.ng/my/account\" href=\"/redirect?url=https%3A%2F%2Fbridge.cspr.ng%2Fmy%2Faccount\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://bridge.cspr.ng/my/account\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e.\u003c/p\u003e\n\n\u003cp\u003eStep 4 : When you change your account password at Browser B (Google Chrome), the session at Browser A (Mozilla Firefox) should expire and the account should automatically logged out.\u003c/p\u003e\n\n\u003cp\u003eStep 5 : Go to Browser A (Mozilla Firefox), and visit your \u003ca title=\"https://bridge.cspr.ng/\" href=\"/redirect?url=https%3A%2F%2Fbridge.cspr.ng%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://bridge.cspr.ng/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e account page and refresh the page.\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eYou will notice that even after changing the account password at Browser B (Google Chrome), the session at Browser A (Mozilla Firefox) didn\u0026#39;t expired which can cause major problems.\u003c/p\u003e\n\n\u003cp\u003ePlease fix the bug and let me know if you need any other information.\u003c/p\u003e\n\n\u003cp\u003eRegards\u003cbr\u003e\nK. Jagdish\u003c/p\u003e\n","weakness":{"id":27,"name":"Improper Authentication - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":3,"voters":["cuso4","koviri_jagdish","spetr0x"],"severity":{"rating":"critical","author_type":"User"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1659128,"is_internal":false,"editable":false,"type":"Activities::BugNotApplicable","message":"\u003e  Here if any user left his account logged in, any attacker can misuse the victim's account and there is no option available to the victim to invalidate the session on that shared computer which could lead to some major problems.\n\n+\n\n\u003e Severity: Critical\n\n...Really?\n\n-----\n\nThis would make a great feature request on Github, to allow people to enable automatic invalidation of all other sessions upon password change, but its absence is not a vulnerability.","markdown_message":"\u003cblockquote\u003e\n\u003cp\u003eHere if any user left his account logged in, any attacker can misuse the victim\u0026#39;s account and there is no option available to the victim to invalidate the session on that shared computer which could lead to some major problems.\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003e+\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eSeverity: Critical\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003e...Really?\u003c/p\u003e\n\n\u003chr\u003e\n\n\u003cp\u003eThis would make a great feature request on Github, to allow people to enable automatic invalidation of all other sessions upon password change, but its absence is not a vulnerability.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-05-07T16:44:01.579Z","updated_at":"2017-05-07T16:44:01.579Z","actor":{"username":"paragonie-scott","cleared":false,"url":"/paragonie-scott","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/051/441/089de22b2f1b80a1e57a2792318dede5cbad81db_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"paragonie","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1659129,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-05-07T16:44:07.277Z","updated_at":"2017-05-07T16:44:07.277Z","first_to_agree":true,"actor":{"username":"paragonie-scott","cleared":false,"url":"/paragonie-scott","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/051/441/089de22b2f1b80a1e57a2792318dede5cbad81db_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"paragonie","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1659130,"is_internal":false,"editable":false,"type":"Activities::ManuallyDisclosed","message":"","markdown_message":"","automated_response":false,"created_at":"2017-05-07T16:44:12.829Z","updated_at":"2017-05-07T16:44:12.829Z","actor":{"username":"paragonie-scott","cleared":false,"url":"/paragonie-scott","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/051/441/089de22b2f1b80a1e57a2792318dede5cbad81db_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"paragonie","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1659154,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"HI @paragonie-scott ,\nI agree that the Severity is Low of this bug.\n\n\u003eBut Why did you closed the report as N/A?\n\u003eSeriously? Is it N/A?\n\nThis is a valid bug and many of the website/companies fix this bug.\n\nYou can see the report https://hackerone.com/reports/17252\nPlease take a look on the bug report again.\n\nRegards\nK. Jagdish","markdown_message":"\u003cp\u003eHI \u003ca href=\"/paragonie-scott\"\u003e@paragonie-scott\u003c/a\u003e ,\u003cbr\u003e\nI agree that the Severity is Low of this bug.\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eBut Why did you closed the report as N/A?\u003cbr\u003e\nSeriously? Is it N/A?\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eThis is a valid bug and many of the website/companies fix this bug.\u003c/p\u003e\n\n\u003cp\u003eYou can see the report \u003ca title=\"https://hackerone.com/reports/17252\" href=\"https://hackerone.com/reports/17252\"\u003ehttps://hackerone.com/reports/17252\u003c/a\u003e\u003cbr\u003e\nPlease take a look on the bug report again.\u003c/p\u003e\n\n\u003cp\u003eRegards\u003cbr\u003e\nK. Jagdish\u003c/p\u003e\n","automated_response":false,"created_at":"2017-05-07T17:01:04.391Z","updated_at":"2017-05-07T17:01:04.391Z","actor":{"username":"koviri_jagdish","cleared":false,"url":"/koviri_jagdish","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/SH36DRShx9Fg6MBsbTc5tsnW/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"paragonie","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1659174,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"1. Not all bugs are vulnerabilities. This comes down to a design decision.\n2. This is the sort of thing that should be [reported on Github](https://github.com/paragonie/airship/).\n3. The feature in question [already exists](https://github.com/paragonie/airship/blob/0692c8619bbee3b934d9773cb31007cf90f6bcf4/src/Engine/Bolt/Security.php#L274-L319) in the code, but not enabled on cspr.ng.\n\nTthe code, by the way, is what's in scope for the bug bounty project, not our infrastructure. Hence, it's not applicable.","markdown_message":"\u003col\u003e\n\u003cli\u003eNot all bugs are vulnerabilities. This comes down to a design decision.\u003c/li\u003e\n\u003cli\u003eThis is the sort of thing that should be \u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fparagonie%2Fairship%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ereported on Github\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e.\u003c/li\u003e\n\u003cli\u003eThe feature in question \u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fparagonie%2Fairship%2Fblob%2F0692c8619bbee3b934d9773cb31007cf90f6bcf4%2Fsrc%2FEngine%2FBolt%2FSecurity.php%23L274-L319\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ealready exists\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e in the code, but not enabled on cspr.ng.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eTthe code, by the way, is what\u0026#39;s in scope for the bug bounty project, not our infrastructure. Hence, it\u0026#39;s not applicable.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-05-07T17:16:43.755Z","updated_at":"2017-05-07T17:16:43.755Z","actor":{"username":"paragonie-scott","cleared":false,"url":"/paragonie-scott","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/051/441/089de22b2f1b80a1e57a2792318dede5cbad81db_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"paragonie","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1659202,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"If you do not accept this bug report, then you could close this report as Informative. As you have not mentioned anywhere in your program details that these type of reports are not accepted or out of scope.\n\nWill you please change the status to informative, because you didn't mentioned anywhere that these type of reports are not accepted or out of scope. And Since this is a valid bug.\n\nPlease change the status to Informative if you don't want to fix this bug.\n\nRegards\nK. Jagdish","markdown_message":"\u003cp\u003eIf you do not accept this bug report, then you could close this report as Informative. As you have not mentioned anywhere in your program details that these type of reports are not accepted or out of scope.\u003c/p\u003e\n\n\u003cp\u003eWill you please change the status to informative, because you didn\u0026#39;t mentioned anywhere that these type of reports are not accepted or out of scope. And Since this is a valid bug.\u003c/p\u003e\n\n\u003cp\u003ePlease change the status to Informative if you don\u0026#39;t want to fix this bug.\u003c/p\u003e\n\n\u003cp\u003eRegards\u003cbr\u003e\nK. Jagdish\u003c/p\u003e\n","automated_response":false,"created_at":"2017-05-07T17:41:08.880Z","updated_at":"2017-05-07T17:41:08.880Z","actor":{"username":"koviri_jagdish","cleared":false,"url":"/koviri_jagdish","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/SH36DRShx9Fg6MBsbTc5tsnW/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"paragonie","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}