{"id":119148,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMTkxNDg=","url":"https://hackerone.com/reports/119148","title":"CSRF - Regenerate all admin api keys","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-02-27T16:45:13.135Z","submitted_at":"2016-02-27T16:45:13.135Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"scorppy","url":"/scorppy","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/368/0d0ac757f48afc823553003803b20ee4222f079c_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":17011,"url":"https://hackerone.com/newrelic","handle":"newrelic","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/017/011/eba06abb23bd6c9c7d719ddafb9fa83bd2d66aaa_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/011/eba06abb23bd6c9c7d719ddafb9fa83bd2d66aaa_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"New Relic","twitter_handle":"newrelic","website":"https://newrelic.com","about":"New Relic's Coordinated Disclosure Program"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2016-08-27T12:27:12.833Z","bug_reporter_agreed_on_going_public_at":"2016-08-27T12:27:12.683Z","team_member_agreed_on_going_public_at":"2016-08-26T23:24:30.278Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi\n\nThe request to regenerate all admin api keys is a GET request without CSRF protection. As such, you can regenerate someone's keys using csrf. While not too big of an issue (the admin can always see the keys and use them) its certainly annoying and can cause business disruption. Additionally, a funny fact is that you have to confirm the regeneration by typing `DELETION IS FOREVER`, but with csrf you can bypass this confirm :P\n\nHere's the poc:\n```\n\u003chtml\u003e\n  \u003c!-- CSRF PoC - generated by Burp Suite Professional --\u003e\n  \u003cbody\u003e\n    \u003cform action=\"https://rpm.newrelic.com/accounts/[USER_ID_HERE]/admin_api_keys/regenerate_all\"\u003e\n      \u003cinput type=\"submit\" value=\"Submit request\" /\u003e\n    \u003c/form\u003e\n  \u003c/body\u003e\n\u003c/html\u003e\n\n```\n\nFirst, go to https://rpm.newrelic.com/accounts/[USER_ID_HERE]/integrations?page=api_keys and create an admin key. Then use the poc to regenerate.","vulnerability_information_html":"\u003cp\u003eHi\u003c/p\u003e\n\n\u003cp\u003eThe request to regenerate all admin api keys is a GET request without CSRF protection. As such, you can regenerate someone\u0026#39;s keys using csrf. While not too big of an issue (the admin can always see the keys and use them) its certainly annoying and can cause business disruption. Additionally, a funny fact is that you have to confirm the regeneration by typing \u003ccode\u003eDELETION IS FOREVER\u003c/code\u003e, but with csrf you can bypass this confirm :P\u003c/p\u003e\n\n\u003cp\u003eHere\u0026#39;s the poc:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight html\"\u003e\u003ccode\u003e\u003cspan class=\"nt\"\u003e\u0026lt;html\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"c\"\u003e\u0026lt;!-- CSRF PoC - generated by Burp Suite Professional --\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"nt\"\u003e\u0026lt;body\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"nt\"\u003e\u0026lt;form\u003c/span\u003e \u003cspan class=\"na\"\u003eaction=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;https://rpm.newrelic.com/accounts/[USER_ID_HERE]/admin_api_keys/regenerate_all\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"nt\"\u003e\u0026lt;input\u003c/span\u003e \u003cspan class=\"na\"\u003etype=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;submit\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003evalue=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;Submit request\u0026quot;\u003c/span\u003e \u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"nt\"\u003e\u0026lt;/form\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"nt\"\u003e\u0026lt;/body\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/html\u0026gt;\u003c/span\u003e\n\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eFirst, go to \u003ca title=\"https://rpm.newrelic.com/accounts/%5BUSER_ID_HERE%5D/integrations?page=api_keys\" href=\"/redirect?url=https%3A%2F%2Frpm.newrelic.com%2Faccounts%2F%255BUSER_ID_HERE%255D%2Fintegrations%3Fpage%3Dapi_keys\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://rpm.newrelic.com/accounts/%5BUSER_ID_HERE%5D/integrations?page=api_keys\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e and create an admin key. Then use the poc to regenerate.\u003c/p\u003e\n","weakness":{"id":45,"name":"Cross-Site Request Forgery (CSRF)"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2016-09-25T23:24:30.325Z","allow_singular_disclosure_after":-134369713.70457834,"singular_disclosure_allowed":true,"vote_count":1,"voters":["dyabla"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":818002,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for your report! This seems like a valid issue and we will file it with the appropriate Engineering team. ","markdown_message":"\u003cp\u003eThanks for your report! This seems like a valid issue and we will file it with the appropriate Engineering team. \u003c/p\u003e\n","automated_response":false,"created_at":"2016-03-01T00:52:28.982Z","updated_at":"2016-03-01T00:52:28.982Z","actor":{"username":"imelven","cleared":false,"url":"/imelven","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/036/153/809e507ea6cd7c5c120920d1d4ce70336974d422_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":818027,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2016-03-01T01:05:46.184Z","updated_at":"2016-03-01T01:05:46.184Z","actor":{"username":"imelven","cleared":false,"url":"/imelven","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/036/153/809e507ea6cd7c5c120920d1d4ce70336974d422_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":898131,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"ping. Any updates here?","markdown_message":"\u003cp\u003eping. Any updates here?\u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-10T11:46:52.571Z","updated_at":"2016-04-10T11:46:52.571Z","actor":{"username":"scorppy","cleared":false,"url":"/scorppy","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/368/0d0ac757f48afc823553003803b20ee4222f079c_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":906202,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi scorppy,\n\nThis issue has been triaged with the responsible Engineering team, and will be addressed in accordance with its priority. We will let you know when the fix has been pushed to production!","markdown_message":"\u003cp\u003eHi scorppy,\u003c/p\u003e\n\n\u003cp\u003eThis issue has been triaged with the responsible Engineering team, and will be addressed in accordance with its priority. We will let you know when the fix has been pushed to production!\u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-14T17:18:07.872Z","updated_at":"2016-04-14T17:18:07.872Z","actor":{"username":"ahamlin","cleared":false,"url":"/ahamlin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/071/b10c1e5872fac616ba0f3b67bb1e6e06ba70fe6c_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":921322,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2016-04-21T20:45:58.127Z","updated_at":"2016-04-21T20:45:58.127Z","actor":{"username":"ahamlin","cleared":false,"url":"/ahamlin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/071/b10c1e5872fac616ba0f3b67bb1e6e06ba70fe6c_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":956708,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"This fix is now live in production. Thank you for your report!","markdown_message":"\u003cp\u003eThis fix is now live in production. Thank you for your report!\u003c/p\u003e\n","automated_response":false,"created_at":"2016-05-13T20:48:03.476Z","updated_at":"2016-05-13T20:48:03.476Z","actor":{"username":"ahamlin","cleared":false,"url":"/ahamlin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/071/b10c1e5872fac616ba0f3b67bb1e6e06ba70fe6c_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"scorppy","url":"/scorppy"},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1157042,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-08-26T23:24:30.305Z","updated_at":"2016-08-26T23:24:30.305Z","first_to_agree":true,"actor":{"username":"imelven","cleared":false,"url":"/imelven","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/036/153/809e507ea6cd7c5c120920d1d4ce70336974d422_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1157531,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-08-27T12:27:12.770Z","updated_at":"2016-08-27T12:27:12.770Z","actor":{"username":"scorppy","cleared":false,"url":"/scorppy","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/368/0d0ac757f48afc823553003803b20ee4222f079c_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1157532,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-08-27T12:27:12.860Z","updated_at":"2016-08-27T12:27:12.860Z","actor":{"username":"scorppy","cleared":false,"url":"/scorppy","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/368/0d0ac757f48afc823553003803b20ee4222f079c_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2694237,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"","markdown_message":"","automated_response":false,"created_at":"2018-05-03T03:30:02.818Z","updated_at":"2018-05-03T03:30:02.818Z","actor":{"url":"/newrelic","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/011/eba06abb23bd6c9c7d719ddafb9fa83bd2d66aaa_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"New Relic"}},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}