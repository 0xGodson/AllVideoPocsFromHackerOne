{"id":292783,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yOTI3ODM=","url":"https://hackerone.com/reports/292783","title":"Oauth flow on the comments widget login can lead to the access code leakage","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2017-11-24T13:49:34.571Z","submitted_at":"2017-11-24T13:49:34.571Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"sp1d3rs","url":"/sp1d3rs","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/079/690/6853ada3e124bdd8616b1be752223b558de38195_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":24342,"url":"https://hackerone.com/ed","handle":"ed","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/024/342/18764de1df9c5df2781f5975a3c01990e8933dd0_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/024/342/18764de1df9c5df2781f5975a3c01990e8933dd0_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Ed","twitter_handle":"EdOverflow","website":"https://edoverflow.com","about":"This is a vulnerability disclosure program for all of my personal projects and code that I publish."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-11-24T13:52:31.378Z","bug_reporter_agreed_on_going_public_at":"2017-11-24T13:52:31.226Z","team_member_agreed_on_going_public_at":"2017-11-24T13:50:55.536Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"##Description\nHello. Here is a keyword: `frog`\nI discovered an little Oauth flow in the comments widget authentication process using redirect_uri manipulations.\nThe widget located on the all blogposts, which have URL\n```\nhttps://edoverflow.com/2017/[post-title]/\n```\nUpon authentication, it appeared that `code` parameter gets stripped from the URL after successful authentication, so there was no visible way to do the leakage thorugh, for example, Referer header upon clicking some external link in the blogpost.\nAt this time, i noticed the only one code leakage to the \n```\nhttps://fonts.googleapis.com/css?family=Inconsolata\n```\nupon `code` verification (since it returned 200 OK) but it appeared not very serious issue for me, and i digged deeper.\nI discovered, that it was possible to manipulate the `redirect_uri` parameter, using the arbitrary directories, since it looked like whole `https://edoverflow.com` URL was whitelisted.\nSo, i tried next URL, to non-existent path /1:\n```\nhttps://github.com/login?client_id=5f45cc999f7812d0b6d2\u0026return_to=%2Flogin%2Foauth%2Fauthorize%3Fclient_id%3D5f45cc999f7812d0b6d2%26redirect_uri%3Dhttps%253A%252F%252Fedoverflow.com%252F1%26scope%3Dpublic_repo\n```\n{F242032}\nand... code was not stripped. So it became clear for me, that the code strips only on pages with a comment widget.\nNext, i tried to find some place, where i can post arbitrary content (like images), with controlled src, to leak the code through Referer. Unfortunately (or fortunately) site used content proxying through GitHub - so my dream about `High` impact had not came true:)\nSo my last hope was at least leak the code to the some external sites, and i came across this link:\n```\nhttps://edoverflow.com/about/\n```\nand\n```\nhttps://edoverflow.com/metadata\n```\nUsing \n```\nhttps://github.com/login?client_id=5f45cc999f7812d0b6d2\u0026return_to=%2Flogin%2Foauth%2Fauthorize%3Fclient_id%3D5f45cc999f7812d0b6d2%26redirect_uri%3Dhttps%253A%252F%252Fedoverflow.com%252Fabout%252f%26scope%3Dpublic_repo\n```\nand same link with `/metadata` path,\ni was able to leak the access code with user interaction to the several sites in the Referer header, like `keybase.io`, `liberapay.com`, `hackerone.com`, `crypto101.io`, `twitter.com`, `youtube.com` and several Press sites like Bloomberg.\n\n##Suggested Fix\nI suggest to restrict the `redirect_uri` only to the blogposts path, to prevent `code` leakage in the other parts of the site, and secure external links from possible Referer leakage, just in case.\n\n## Impact\n\nThe severity was set as low, because attacker can't directly conduct the authentication bypass against victim, in case attacker is not an admin of the one of the external sites=). \nStill, there was some risks, so issue was reported in several minutes after discovery","vulnerability_information_html":"\u003ch2 id=\"description\"\u003eDescription\u003c/h2\u003e\n\n\u003cp\u003eHello. Here is a keyword: \u003ccode\u003efrog\u003c/code\u003e\u003cbr\u003e\nI discovered an little Oauth flow in the comments widget authentication process using redirect_uri manipulations.\u003cbr\u003e\nThe widget located on the all blogposts, which have URL\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ehttps://edoverflow.com/2017/[post-title]/\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eUpon authentication, it appeared that \u003ccode\u003ecode\u003c/code\u003e parameter gets stripped from the URL after successful authentication, so there was no visible way to do the leakage thorugh, for example, Referer header upon clicking some external link in the blogpost.\u003cbr\u003e\nAt this time, i noticed the only one code leakage to the \u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ehttps://fonts.googleapis.com/css?family=Inconsolata\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eupon \u003ccode\u003ecode\u003c/code\u003e verification (since it returned 200 OK) but it appeared not very serious issue for me, and i digged deeper.\u003cbr\u003e\nI discovered, that it was possible to manipulate the \u003ccode\u003eredirect_uri\u003c/code\u003e parameter, using the arbitrary directories, since it looked like whole \u003ccode\u003ehttps://edoverflow.com\u003c/code\u003e URL was whitelisted.\u003cbr\u003e\nSo, i tried next URL, to non-existent path /1:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ehttps://github.com/login?client_id=5f45cc999f7812d0b6d2\u0026amp;return_to=%2Flogin%2Foauth%2Fauthorize%3Fclient_id%3D5f45cc999f7812d0b6d2%26redirect_uri%3Dhttps%253A%252F%252Fedoverflow.com%252F1%26scope%3Dpublic_repo\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"12.JPG\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/242/032/e0f5fe9d4578262f0e050115b93194084bac7aed/12.JPG?response-content-disposition=attachment%3B%20filename%3D%2212.JPG%22%3B%20filename%2A%3DUTF-8%27%2712.JPG\u0026amp;response-content-type=image%2Fjpeg\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQ4IZIDGEJ%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T052552Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHgvhPRXI%2B7x6zNGnfFbWtzZacTUlKPt3VwSApQji3YyAiEA2Y%2FuJ72LgjXuchHTkycORzGcHp9y6ZUl%2BeyKz%2FFfjlAqtAMIVBABGgwwMTM2MTkyNzQ4NDkiDHblJHa0bCSVtoiX8yqRA7Ct%2F1l8ihdf2xXnJNUaJGv7nq%2F1b1xXdqHLpOjb5bN22Ac%2BQjHl%2Bna1KjqQx0Qu8Fcs0WQUm6dGPZbHLiP%2FRkIHh6FlY41MtajX39mvBrMgWCmioQD4vc7NSsiqHLG4GmvgnIM0wWXfwwv%2Fmq%2BjRWJQacOyz7e9kYXzI%2BQkViUKmcuV48xoXGswHYXnPSqKC6IqSk0Rgc6j2xAmne60g5PNHQf%2BehWLSoXupow19n2vF%2BE4dhw1ZLX%2B9fBct02t5%2B41MEA5z30yhC52UxDX9%2BedHi3rXpTTyV%2FX%2BWfdeGSGSqmwrTAcipCpz01NR%2Fkk3srD5BLQB%2B6BdeDlwwcltfcgYdKO39yRPNyZePA9ihdN%2B4YHA7%2FY9ufCPbEevGDvtv3mVStbES31aUOxSmGNj%2B8fMMJqFBAtD4Qx54l8UFyMf%2BQ8PPbA0OLpU9rjip1L0zxevK6IGISP%2FPlDldWsNQvfi1Xn6QvRkmL1ANNGXqycx5MDUJExPyV801VOQ68%2FfbB87Cmdd8xIJWUNtmpsIgDtMO2wqv8FOusBRxy8OOzTGCKFydY5xn2aZtaPj3obazs55j%2BS5FoY%2BdkqAuB4pbyPDlTBBI%2Fe4ZIYYBH9t51VaQaRwrhKPTTntuBcC2b5uuKcGXYq9rnIAgbUHulNqSoxgZep0wAjzrLEFeECcDfqDCjG1QyXJkGQyq3UjLElJNKzeGgK4y5hW9emXis3wfoUPLixiL7W8M52b0Q9HQrT0RxnkkNSLj7aPyOAVCPImHNwjJ%2FI2KIbB5iD4e9PbxcHFvjKgkNUQh2pESECovpzx%2BAz7wsT%2FUMRieGT%2BFtMt1o90%2BewPxe95i025ZqzwWI1aVcXtA%3D%3D\u0026amp;X-Amz-Signature=12daa4e144e41eda0f5f7db709eb936e54864e0619fdbdda9e3c70cc76e3492b\" data-attachment-type=\"image/jpeg\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/242/032/e0f5fe9d4578262f0e050115b93194084bac7aed/12.JPG?response-content-disposition=attachment%3B%20filename%3D%2212.JPG%22%3B%20filename%2A%3DUTF-8%27%2712.JPG\u0026amp;response-content-type=image%2Fjpeg\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQ4IZIDGEJ%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T052552Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHgvhPRXI%2B7x6zNGnfFbWtzZacTUlKPt3VwSApQji3YyAiEA2Y%2FuJ72LgjXuchHTkycORzGcHp9y6ZUl%2BeyKz%2FFfjlAqtAMIVBABGgwwMTM2MTkyNzQ4NDkiDHblJHa0bCSVtoiX8yqRA7Ct%2F1l8ihdf2xXnJNUaJGv7nq%2F1b1xXdqHLpOjb5bN22Ac%2BQjHl%2Bna1KjqQx0Qu8Fcs0WQUm6dGPZbHLiP%2FRkIHh6FlY41MtajX39mvBrMgWCmioQD4vc7NSsiqHLG4GmvgnIM0wWXfwwv%2Fmq%2BjRWJQacOyz7e9kYXzI%2BQkViUKmcuV48xoXGswHYXnPSqKC6IqSk0Rgc6j2xAmne60g5PNHQf%2BehWLSoXupow19n2vF%2BE4dhw1ZLX%2B9fBct02t5%2B41MEA5z30yhC52UxDX9%2BedHi3rXpTTyV%2FX%2BWfdeGSGSqmwrTAcipCpz01NR%2Fkk3srD5BLQB%2B6BdeDlwwcltfcgYdKO39yRPNyZePA9ihdN%2B4YHA7%2FY9ufCPbEevGDvtv3mVStbES31aUOxSmGNj%2B8fMMJqFBAtD4Qx54l8UFyMf%2BQ8PPbA0OLpU9rjip1L0zxevK6IGISP%2FPlDldWsNQvfi1Xn6QvRkmL1ANNGXqycx5MDUJExPyV801VOQ68%2FfbB87Cmdd8xIJWUNtmpsIgDtMO2wqv8FOusBRxy8OOzTGCKFydY5xn2aZtaPj3obazs55j%2BS5FoY%2BdkqAuB4pbyPDlTBBI%2Fe4ZIYYBH9t51VaQaRwrhKPTTntuBcC2b5uuKcGXYq9rnIAgbUHulNqSoxgZep0wAjzrLEFeECcDfqDCjG1QyXJkGQyq3UjLElJNKzeGgK4y5hW9emXis3wfoUPLixiL7W8M52b0Q9HQrT0RxnkkNSLj7aPyOAVCPImHNwjJ%2FI2KIbB5iD4e9PbxcHFvjKgkNUQh2pESECovpzx%2BAz7wsT%2FUMRieGT%2BFtMt1o90%2BewPxe95i025ZqzwWI1aVcXtA%3D%3D\u0026amp;X-Amz-Signature=12daa4e144e41eda0f5f7db709eb936e54864e0619fdbdda9e3c70cc76e3492b\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003cbr\u003e\nand... code was not stripped. So it became clear for me, that the code strips only on pages with a comment widget.\u003cbr\u003e\nNext, i tried to find some place, where i can post arbitrary content (like images), with controlled src, to leak the code through Referer. Unfortunately (or fortunately) site used content proxying through GitHub - so my dream about \u003ccode\u003eHigh\u003c/code\u003e impact had not came true:)\u003cbr\u003e\nSo my last hope was at least leak the code to the some external sites, and i came across this link:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ehttps://edoverflow.com/about/\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eand\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ehttps://edoverflow.com/metadata\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eUsing \u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ehttps://github.com/login?client_id=5f45cc999f7812d0b6d2\u0026amp;return_to=%2Flogin%2Foauth%2Fauthorize%3Fclient_id%3D5f45cc999f7812d0b6d2%26redirect_uri%3Dhttps%253A%252F%252Fedoverflow.com%252Fabout%252f%26scope%3Dpublic_repo\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eand same link with \u003ccode\u003e/metadata\u003c/code\u003e path,\u003cbr\u003e\ni was able to leak the access code with user interaction to the several sites in the Referer header, like \u003ccode\u003ekeybase.io\u003c/code\u003e, \u003ccode\u003eliberapay.com\u003c/code\u003e, \u003ccode\u003ehackerone.com\u003c/code\u003e, \u003ccode\u003ecrypto101.io\u003c/code\u003e, \u003ccode\u003etwitter.com\u003c/code\u003e, \u003ccode\u003eyoutube.com\u003c/code\u003e and several Press sites like Bloomberg.\u003c/p\u003e\n\n\u003ch2 id=\"suggested-fix\"\u003eSuggested Fix\u003c/h2\u003e\n\n\u003cp\u003eI suggest to restrict the \u003ccode\u003eredirect_uri\u003c/code\u003e only to the blogposts path, to prevent \u003ccode\u003ecode\u003c/code\u003e leakage in the other parts of the site, and secure external links from possible Referer leakage, just in case.\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eThe severity was set as low, because attacker can\u0026#39;t directly conduct the authentication bypass against victim, in case attacker is not an admin of the one of the external sites=). \u003cbr\u003e\nStill, there was some risks, so issue was reported in several minutes after discovery\u003c/p\u003e\n","weakness":{"id":27,"name":"Improper Authentication - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":242032,"file_name":"12.JPG","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/242/032/e0f5fe9d4578262f0e050115b93194084bac7aed/12.JPG?response-content-disposition=attachment%3B%20filename%3D%2212.JPG%22%3B%20filename%2A%3DUTF-8%27%2712.JPG\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ4IZIDGEJ%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T052552Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHgvhPRXI%2B7x6zNGnfFbWtzZacTUlKPt3VwSApQji3YyAiEA2Y%2FuJ72LgjXuchHTkycORzGcHp9y6ZUl%2BeyKz%2FFfjlAqtAMIVBABGgwwMTM2MTkyNzQ4NDkiDHblJHa0bCSVtoiX8yqRA7Ct%2F1l8ihdf2xXnJNUaJGv7nq%2F1b1xXdqHLpOjb5bN22Ac%2BQjHl%2Bna1KjqQx0Qu8Fcs0WQUm6dGPZbHLiP%2FRkIHh6FlY41MtajX39mvBrMgWCmioQD4vc7NSsiqHLG4GmvgnIM0wWXfwwv%2Fmq%2BjRWJQacOyz7e9kYXzI%2BQkViUKmcuV48xoXGswHYXnPSqKC6IqSk0Rgc6j2xAmne60g5PNHQf%2BehWLSoXupow19n2vF%2BE4dhw1ZLX%2B9fBct02t5%2B41MEA5z30yhC52UxDX9%2BedHi3rXpTTyV%2FX%2BWfdeGSGSqmwrTAcipCpz01NR%2Fkk3srD5BLQB%2B6BdeDlwwcltfcgYdKO39yRPNyZePA9ihdN%2B4YHA7%2FY9ufCPbEevGDvtv3mVStbES31aUOxSmGNj%2B8fMMJqFBAtD4Qx54l8UFyMf%2BQ8PPbA0OLpU9rjip1L0zxevK6IGISP%2FPlDldWsNQvfi1Xn6QvRkmL1ANNGXqycx5MDUJExPyV801VOQ68%2FfbB87Cmdd8xIJWUNtmpsIgDtMO2wqv8FOusBRxy8OOzTGCKFydY5xn2aZtaPj3obazs55j%2BS5FoY%2BdkqAuB4pbyPDlTBBI%2Fe4ZIYYBH9t51VaQaRwrhKPTTntuBcC2b5uuKcGXYq9rnIAgbUHulNqSoxgZep0wAjzrLEFeECcDfqDCjG1QyXJkGQyq3UjLElJNKzeGgK4y5hW9emXis3wfoUPLixiL7W8M52b0Q9HQrT0RxnkkNSLj7aPyOAVCPImHNwjJ%2FI2KIbB5iD4e9PbxcHFvjKgkNUQh2pESECovpzx%2BAz7wsT%2FUMRieGT%2BFtMt1o90%2BewPxe95i025ZqzwWI1aVcXtA%3D%3D\u0026X-Amz-Signature=12daa4e144e41eda0f5f7db709eb936e54864e0619fdbdda9e3c70cc76e3492b","file_size":41438,"type":"image/jpeg"}],"allow_singular_disclosure_at":"2017-12-24T13:50:55.764Z","allow_singular_disclosure_after":-95096096.75517967,"singular_disclosure_allowed":true,"vote_count":38,"voters":["byq","johnh4x0r","jensec","cdl","kapytein","europa","b6117130df17feef13481e3","bl4de","bogdantcaciuc","teknogeek","and 28 more..."],"severity":{"rating":"low","author_type":"User"},"structured_scope":{"databaseId":3524,"asset_type":"URL","asset_identifier":"https://edoverflow.com/","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":2180514,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hi @sp1d3rs,\n\nThank you very much for reporting this issue. I have patched the issue by adding `rel=\"noreferrer\"` to all links and serving Google fonts locally.\n\n```js\n// File  website/assets/js/main.js, line 39\n$(document).ready(function(){\n\t$(\"a\").attr('rel','noreferrer');\n});\n```\n\n```diff\n- \u003clink href=\"https://fonts.googleapis.com/css?family=Inconsolata\" rel=\"stylesheet\"\u003e\n+ \u003clink href=\"{{ site.baseurl}}/assets/css/inconsolata.css\"\u003e\n```\n\nI could potentially look into narrowing down the scope of the `redirect_uri`, but the current changes should suffice for the moment.\n\nCould you please ensure that this resolves the issue that you reported?","markdown_message":"\u003cp\u003eHi \u003ca href=\"/sp1d3rs\"\u003e@sp1d3rs\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThank you very much for reporting this issue. I have patched the issue by adding \u003ccode\u003erel=\u0026quot;noreferrer\u0026quot;\u003c/code\u003e to all links and serving Google fonts locally.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight javascript\"\u003e\u003ccode\u003e\u003cspan class=\"c1\"\u003e// File  website/assets/js/main.js, line 39\u003c/span\u003e\n\u003cspan class=\"nx\"\u003e$\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nb\"\u003edocument\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nx\"\u003eready\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kd\"\u003efunction\u003c/span\u003e\u003cspan class=\"p\"\u003e(){\u003c/span\u003e\n    \u003cspan class=\"nx\"\u003e$\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003ea\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nx\"\u003eattr\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003erel\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003enoreferrer\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"p\"\u003e});\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight diff\"\u003e\u003ccode\u003e\u003cspan class=\"gd\"\u003e- \u0026lt;link href=\u0026quot;https://fonts.googleapis.com/css?family=Inconsolata\u0026quot; rel=\u0026quot;stylesheet\u0026quot;\u0026gt;\n\u003c/span\u003e\u003cspan class=\"gi\"\u003e+ \u0026lt;link href=\u0026quot;{{ site.baseurl}}/assets/css/inconsolata.css\u0026quot;\u0026gt;\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eI could potentially look into narrowing down the scope of the \u003ccode\u003eredirect_uri\u003c/code\u003e, but the current changes should suffice for the moment.\u003c/p\u003e\n\n\u003cp\u003eCould you please ensure that this resolves the issue that you reported?\u003c/p\u003e\n","automated_response":false,"created_at":"2017-11-24T13:50:00.235Z","updated_at":"2017-11-24T13:50:00.235Z","actor":{"username":"edoverflow","cleared":true,"url":"/edoverflow","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/116/374/9a3cf4d62b2f507a0d33808aacbad863ec4455ac_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"sp1d3rs","url":"/sp1d3rs"},"genius_execution_id":null,"team_handle":"ed","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2180516,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-11-24T13:50:55.591Z","updated_at":"2017-11-24T13:50:55.591Z","first_to_agree":true,"actor":{"username":"edoverflow","cleared":true,"url":"/edoverflow","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/116/374/9a3cf4d62b2f507a0d33808aacbad863ec4455ac_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ed","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2180520,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-11-24T13:52:31.298Z","updated_at":"2017-11-24T13:52:31.298Z","actor":{"username":"sp1d3rs","cleared":true,"url":"/sp1d3rs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/079/690/6853ada3e124bdd8616b1be752223b558de38195_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ed","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2180521,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-11-24T13:52:31.432Z","updated_at":"2017-11-24T13:52:31.432Z","actor":{"username":"sp1d3rs","cleared":true,"url":"/sp1d3rs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/079/690/6853ada3e124bdd8616b1be752223b558de38195_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ed","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2180792,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Looks fixed for me!","markdown_message":"\u003cp\u003eLooks fixed for me!\u003c/p\u003e\n","automated_response":false,"created_at":"2017-11-24T14:24:11.187Z","updated_at":"2017-11-24T14:24:11.187Z","actor":{"username":"sp1d3rs","cleared":true,"url":"/sp1d3rs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/079/690/6853ada3e124bdd8616b1be752223b558de38195_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ed","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":5945,"category":"team","content":"This report broke the record for the fastest time to resolution and then public disclosure. I would like to thank @sp1d3rs again for their fantastic report.","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eThis report broke the record for the fastest time to resolution and then public disclosure. I would like to thank \u003ca href=\"/sp1d3rs\"\u003e@sp1d3rs\u003c/a\u003e again for their fantastic report.\u003c/p\u003e\n"},{"id":5946,"category":"researcher","content":"I discovered an issue, when valid oauth `code` could be leaked to the various external hosts under some circumstances due to insufficient `redirect_uri` validation, and ability to use `Referer` header for code leakage.\nThe issue was caused by the fact, that using `redirect_uri` with an arbitrary path to the some page without comments widget enabled, and containing some insecure external links, we can prevent the `code` exchange (when i wrote 'stripped' in the report, i meant exchange), and leak it to the several external hosts with some user interaction. \n\nThe `code` exchange happened only on the pages with enabled comments widget (so flow should not be exploitable on such pages, since widget script exchanges and strips the `code` - and it become no more valid, so even if we leak such code somehow before it's stripping, it will be useless).\n\nThanks to the Ed for the fastest response in my experience!\n","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eI discovered an issue, when valid oauth \u003ccode\u003ecode\u003c/code\u003e could be leaked to the various external hosts under some circumstances due to insufficient \u003ccode\u003eredirect_uri\u003c/code\u003e validation, and ability to use \u003ccode\u003eReferer\u003c/code\u003e header for code leakage.\u003cbr\u003e\nThe issue was caused by the fact, that using \u003ccode\u003eredirect_uri\u003c/code\u003e with an arbitrary path to the some page without comments widget enabled, and containing some insecure external links, we can prevent the \u003ccode\u003ecode\u003c/code\u003e exchange (when i wrote \u0026#39;stripped\u0026#39; in the report, i meant exchange), and leak it to the several external hosts with some user interaction. \u003c/p\u003e\n\n\u003cp\u003eThe \u003ccode\u003ecode\u003c/code\u003e exchange happened only on the pages with enabled comments widget (so flow should not be exploitable on such pages, since widget script exchanges and strips the \u003ccode\u003ecode\u003c/code\u003e - and it become no more valid, so even if we leak such code somehow before it\u0026#39;s stripping, it will be useless).\u003c/p\u003e\n\n\u003cp\u003eThanks to the Ed for the fastest response in my experience!\u003c/p\u003e\n"}]}