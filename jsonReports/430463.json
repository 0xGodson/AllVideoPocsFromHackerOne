{"id":430463,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC80MzA0NjM=","url":"https://hackerone.com/reports/430463","title":"Keybase client: downloaded executables lack \"com.apple.quarantine\" meta-attribute [macOS]","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2018-10-29T21:04:34.618Z","submitted_at":"2018-10-29T21:04:34.618Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"metnew","url":"/metnew","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":2809,"url":"https://hackerone.com/keybase","handle":"keybase","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/002/809/710eb42880bb34c06cab0d1d5081488ec59aec5e_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/809/710eb42880bb34c06cab0d1d5081488ec59aec5e_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Keybase","twitter_handle":"keybaseio","website":"https://keybase.io","about":""}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2019-09-16T19:58:09.447Z","bug_reporter_agreed_on_going_public_at":"2019-08-20T09:40:27.766Z","team_member_agreed_on_going_public_at":"2019-09-16T19:58:09.376Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"## Summary\n\n1. Missing quarantine attribute for downloaded files allows remote attacker to send executable file that won't be checked by Gatekeeper (codesign bypass). \n\n2. Since sent executable files lack `com.apple.quarantine` meta-attribute, no alert about launching executable file from the web will be shown to user.\n\n3. That means, dblclick on file in Finder.app (or any similar gesture to launch the file) immediately launches the attacker's file.\n\n## PoC\n\n1. Attacker sends `exploit.terminal` to the victim (file is unsigned)\n2. Victim opens `exploit.terminal`\n3. No alert from Gatekeeper about unsigned executable\n4. No alert about running executable file downloaded from the web\n5. Shell commands from `exploit.terminal` execute with user-level privileges.\n\n\u003e NOTE: if victim is sudoer with no pass, attacker can insert `sudo` commands in `*.terminal` file and gain `root` permissions.\n\nScreencast + `exploit.terminal` file sample attached.\n\n\u003e Screencast: `xattr \u003cfile\u003e` shows apple-specific meta-attributes like `com.apple.quarantine`\n\n## Impact\n\nQuarantine + codesigning are basic security mechanisms, which prevents user/device from running untrusted executables.\n\nKeybase allows to send **messages** and share **KBFS** with **any Keybase user** (!), that allows attacker to make a massive spam of `.terminal` files with malicious payload.","vulnerability_information_html":"\u003ch2 id=\"summary\"\u003eSummary\u003c/h2\u003e\n\n\u003col\u003e\n\u003cli\u003e\u003cp\u003eMissing quarantine attribute for downloaded files allows remote attacker to send executable file that won\u0026#39;t be checked by Gatekeeper (codesign bypass). \u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eSince sent executable files lack \u003ccode\u003ecom.apple.quarantine\u003c/code\u003e meta-attribute, no alert about launching executable file from the web will be shown to user.\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eThat means, dblclick on file in Finder.app (or any similar gesture to launch the file) immediately launches the attacker\u0026#39;s file.\u003c/p\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003ch2 id=\"poc\"\u003ePoC\u003c/h2\u003e\n\n\u003col\u003e\n\u003cli\u003eAttacker sends \u003ccode\u003eexploit.terminal\u003c/code\u003e to the victim (file is unsigned)\u003c/li\u003e\n\u003cli\u003eVictim opens \u003ccode\u003eexploit.terminal\u003c/code\u003e\n\u003c/li\u003e\n\u003cli\u003eNo alert from Gatekeeper about unsigned executable\u003c/li\u003e\n\u003cli\u003eNo alert about running executable file downloaded from the web\u003c/li\u003e\n\u003cli\u003eShell commands from \u003ccode\u003eexploit.terminal\u003c/code\u003e execute with user-level privileges.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eNOTE: if victim is sudoer with no pass, attacker can insert \u003ccode\u003esudo\u003c/code\u003e commands in \u003ccode\u003e*.terminal\u003c/code\u003e file and gain \u003ccode\u003eroot\u003c/code\u003e permissions.\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eScreencast + \u003ccode\u003eexploit.terminal\u003c/code\u003e file sample attached.\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eScreencast: \u003ccode\u003exattr \u0026lt;file\u0026gt;\u003c/code\u003e shows apple-specific meta-attributes like \u003ccode\u003ecom.apple.quarantine\u003c/code\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eQuarantine + codesigning are basic security mechanisms, which prevents user/device from running untrusted executables.\u003c/p\u003e\n\n\u003cp\u003eKeybase allows to send \u003cstrong\u003emessages\u003c/strong\u003e and share \u003cstrong\u003eKBFS\u003c/strong\u003e with \u003cstrong\u003eany Keybase user\u003c/strong\u003e (!), that allows attacker to make a massive spam of \u003ccode\u003e.terminal\u003c/code\u003e files with malicious payload.\u003c/p\u003e\n","bounty_amount":"4000.0","formatted_bounty":"$4,000","original_report_id":null,"original_report_url":null,"attachments":[{"id":368059,"file_name":"keybase-terminal-files.mp4","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/368/059/a7fcdf5bdb8a0ebdb1ccfea52cebdcae1cb9d86c/keybase-terminal-files.mp4?response-content-disposition=attachment%3B%20filename%3D%22keybase-terminal-files.mp4%22%3B%20filename%2A%3DUTF-8%27%27keybase-terminal-files.mp4\u0026response-content-type=video%2Fmp4\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQXIKMJWH3%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T055717Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHST0svsvt2laJhuwhvtFHhDNQQ1aKmdn3kMewysqUdFAiEAulql%2B612sAbGAOHB%2F14rmdeeoxU5d8%2BAmcu4RPg%2BHwYqtAMIUhABGgwwMTM2MTkyNzQ4NDkiDCOZXQ8CegoYVtnSUSqRAzpFu%2FKSCAPO9FvY239VSQoXSErgwDzOUTpVgc827sUNqeCED0HHoCoUKyy9kO1lyu0kSFcQXf%2BvW4%2FHwxvZX6%2BphIjx2iPQX6fNNwXKcgYQYxZ8Yx%2BGm7ZXLO%2Bu7Mdu4Fn%2B9TpJQODzePG4VEMMVtb0e6FjQNUF4kQegXC133f3aM6cYX7uAbjyFy7JY7I765EFvdZteqLx2HbWaDGqldcnvslHjs3kmodLKwk9H0Ue0DoWQaLX8Vd2A0w%2FRaO%2FD7%2FQ8PGTn1qam8KaVgzORyAVZ6DxjOPjltRKnxLgyDYBYkhJ4QrBrnmUJPgQMGGWlKZ9SGJYACF0xI0BTQYivNwVfXoTMKUGwE35iziKLaZ5lyBmkqGem%2B%2FfByDZktR%2BpZGSBgSAr1UOE7ov9eb7NhNIuMzcYuOJ1sDR5pR5AlZ4GHJ8eFAlsbYZ1%2B%2F1eXzICdlYRCTp7FQRaLOJji%2BGrr7%2BDGcfEbEP64XGp9sIHjMhhaQcRwVNC6OPA5jdwFCmOnkfeeCoszPtP9ulj%2BvRBs4QMJSFqv8FOusBWzRAvPHoeI1kjG3%2Bj8jYuqVFp2PPU1q0JXR0Ajo08RGvNLJbNpVdip6BBBoiu8PCrCZDZIOwjGA3KcL5o1c4azKc2WVxPog81MB%2FMbDqzX0ad%2FLlmri78RdsSnSIX3Tn18ZdjfTGjol%2FjXedojL6GsI5pB1YlY0EqbQvBnSvbUvPa2Yr7haLR%2FQ%2FG8J8lEfc9mqMV9Imaj1ospS%2BNuCXAlVOb%2F0ya3%2BR4cs2EQotvOugeHotyPJlDfJL6Pqjp0Z9ECJu9QNa4Vn1w2ANPlIUFD2oD6RnsM%2BFR3kpEUChJsMjzZDlljBwhF14Ww%3D%3D\u0026X-Amz-Signature=0ddb5ab9aeba32918333fabfc2c1890bea7ad11b149e112fbcbb872467e20d69","file_size":721317,"type":"video/mp4"},{"id":368060,"file_name":"exploit.terminal","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/368/060/4b98f51810e27c634a54094fa8f3baa6e7512c00/exploit.terminal?response-content-disposition=attachment%3B%20filename%3D%22exploit.terminal%22%3B%20filename%2A%3DUTF-8%27%27exploit.terminal\u0026response-content-type=application%2Foctet-stream\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQXIKMJWH3%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T055717Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHST0svsvt2laJhuwhvtFHhDNQQ1aKmdn3kMewysqUdFAiEAulql%2B612sAbGAOHB%2F14rmdeeoxU5d8%2BAmcu4RPg%2BHwYqtAMIUhABGgwwMTM2MTkyNzQ4NDkiDCOZXQ8CegoYVtnSUSqRAzpFu%2FKSCAPO9FvY239VSQoXSErgwDzOUTpVgc827sUNqeCED0HHoCoUKyy9kO1lyu0kSFcQXf%2BvW4%2FHwxvZX6%2BphIjx2iPQX6fNNwXKcgYQYxZ8Yx%2BGm7ZXLO%2Bu7Mdu4Fn%2B9TpJQODzePG4VEMMVtb0e6FjQNUF4kQegXC133f3aM6cYX7uAbjyFy7JY7I765EFvdZteqLx2HbWaDGqldcnvslHjs3kmodLKwk9H0Ue0DoWQaLX8Vd2A0w%2FRaO%2FD7%2FQ8PGTn1qam8KaVgzORyAVZ6DxjOPjltRKnxLgyDYBYkhJ4QrBrnmUJPgQMGGWlKZ9SGJYACF0xI0BTQYivNwVfXoTMKUGwE35iziKLaZ5lyBmkqGem%2B%2FfByDZktR%2BpZGSBgSAr1UOE7ov9eb7NhNIuMzcYuOJ1sDR5pR5AlZ4GHJ8eFAlsbYZ1%2B%2F1eXzICdlYRCTp7FQRaLOJji%2BGrr7%2BDGcfEbEP64XGp9sIHjMhhaQcRwVNC6OPA5jdwFCmOnkfeeCoszPtP9ulj%2BvRBs4QMJSFqv8FOusBWzRAvPHoeI1kjG3%2Bj8jYuqVFp2PPU1q0JXR0Ajo08RGvNLJbNpVdip6BBBoiu8PCrCZDZIOwjGA3KcL5o1c4azKc2WVxPog81MB%2FMbDqzX0ad%2FLlmri78RdsSnSIX3Tn18ZdjfTGjol%2FjXedojL6GsI5pB1YlY0EqbQvBnSvbUvPa2Yr7haLR%2FQ%2FG8J8lEfc9mqMV9Imaj1ospS%2BNuCXAlVOb%2F0ya3%2BR4cs2EQotvOugeHotyPJlDfJL6Pqjp0Z9ECJu9QNa4Vn1w2ANPlIUFD2oD6RnsM%2BFR3kpEUChJsMjzZDlljBwhF14Ww%3D%3D\u0026X-Amz-Signature=06c030f0be6d52d3756aeada5e43c949f564fe39d49671562b870729ba16d2c9","file_size":462,"type":"application/xml"}],"allow_singular_disclosure_at":null,"vote_count":72,"voters":["mirchr","spam404","sameerphad72","s_p_q_r","ras-it","metnew","caesim","mygf","tungpun","aryan2808","and 62 more..."],"severity":{"rating":"medium","score":4.6,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"low","user_interaction":"required","scope":"unchanged","confidentiality":"low","integrity":"low","availability":"none"}},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":3551884,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2018-10-29T21:16:30.710Z","updated_at":"2018-10-29T21:16:30.710Z","additional_data":{"old_title":"Keybase client: Lack of quarantine for downloaded executables [macOS]","new_title":"Keybase client: downloaded executables lack \"com.apple.quarantine\" meta-attribute [macOS]"},"actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3553192,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Question: which download mechanism did you test for this? KBFS Finder integration, chat downloads or files tab in the app?","markdown_message":"\u003cp\u003eQuestion: which download mechanism did you test for this? KBFS Finder integration, chat downloads or files tab in the app?\u003c/p\u003e\n","automated_response":false,"created_at":"2018-10-30T01:33:49.991Z","updated_at":"2018-10-30T01:33:49.991Z","actor":{"username":"maxtaco","cleared":false,"url":"/maxtaco","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3553199,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"I used chat downloads (screencast). That also means files tab is vulnerable too because it's the same Electron app.\n\u003e For corresponding quarantine header check Chrome's Info.plist\n\nFrom my observations, sending files over KBFS doesn't attach any meta-attributes, so KBFS must be vulnerable too. I'm going to check it now.","markdown_message":"\u003cp\u003eI used chat downloads (screencast). That also means files tab is vulnerable too because it\u0026#39;s the same Electron app.\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eFor corresponding quarantine header check Chrome\u0026#39;s Info.plist\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eFrom my observations, sending files over KBFS doesn\u0026#39;t attach any meta-attributes, so KBFS must be vulnerable too. I\u0026#39;m going to check it now.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-10-30T01:39:37.701Z","updated_at":"2018-10-30T01:40:33.882Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3553206,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I was able to repro KBFS.\n\nKBFS:\n1. Send file to KBFS\n2. launch file from KBFS (/Keybase/(private|public)/\u003cusername\u003e)","markdown_message":"\u003cp\u003eI was able to repro KBFS.\u003c/p\u003e\n\n\u003cp\u003eKBFS:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eSend file to KBFS\u003c/li\u003e\n\u003cli\u003elaunch file from KBFS (/Keybase/(private|public)/\u0026lt;username\u0026gt;)\u003c/li\u003e\n\u003c/ol\u003e\n","automated_response":false,"created_at":"2018-10-30T01:43:58.689Z","updated_at":"2018-10-30T01:43:58.689Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3553207,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Ok, thanks for the update. I need to ask around and see if there's a reason we're not setting the attribute. I'll get back to you by the end of the week.","markdown_message":"\u003cp\u003eOk, thanks for the update. I need to ask around and see if there\u0026#39;s a reason we\u0026#39;re not setting the attribute. I\u0026#39;ll get back to you by the end of the week.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-10-30T01:44:43.175Z","updated_at":"2018-10-30T01:44:43.175Z","actor":{"username":"maxtaco","cleared":false,"url":"/maxtaco","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3553209,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"By point of comparison, do you know what Slack and Dropbox do?","markdown_message":"\u003cp\u003eBy point of comparison, do you know what Slack and Dropbox do?\u003c/p\u003e\n","automated_response":false,"created_at":"2018-10-30T01:47:02.259Z","updated_at":"2018-10-30T01:47:02.259Z","actor":{"username":"maxtaco","cleared":false,"url":"/maxtaco","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3553219,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Slack uses Quarantine - it's easy to check\nDropbox doesn't, I guess because their folders are considered as a \"trusted space\". \n\n\u003e I'm working on reporting this issue to multiple providers: Skype/WhatsApp/Signal/Dropbox, so I hope this report won't make them fix this problem before my report to them :)","markdown_message":"\u003cp\u003eSlack uses Quarantine - it\u0026#39;s easy to check\u003cbr\u003e\nDropbox doesn\u0026#39;t, I guess because their folders are considered as a \u0026quot;trusted space\u0026quot;. \u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eI\u0026#39;m working on reporting this issue to multiple providers: Skype/WhatsApp/Signal/Dropbox, so I hope this report won\u0026#39;t make them fix this problem before my report to them :)\u003c/p\u003e\n\u003c/blockquote\u003e\n","automated_response":false,"created_at":"2018-10-30T01:52:17.911Z","updated_at":"2018-10-30T01:53:32.473Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3553247,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@maxtaco  `.app` also works for KBFS, since it's just a folder.","markdown_message":"\u003cp\u003e\u003ca href=\"/maxtaco\"\u003e@maxtaco\u003c/a\u003e  \u003ccode\u003e.app\u003c/code\u003e also works for KBFS, since it\u0026#39;s just a folder.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-10-30T02:10:46.381Z","updated_at":"2018-10-30T02:10:46.381Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3553550,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"\u003e @maxtaco I've submitted this vulnerability to Dropbox and some other vendors (not all yet)","markdown_message":"\u003cblockquote\u003e\n\u003cp\u003e\u003ca href=\"/maxtaco\"\u003e@maxtaco\u003c/a\u003e I\u0026#39;ve submitted this vulnerability to Dropbox and some other vendors (not all yet)\u003c/p\u003e\n\u003c/blockquote\u003e\n","automated_response":false,"created_at":"2018-10-30T05:20:16.124Z","updated_at":"2018-10-30T05:20:16.124Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3556343,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thank you for your report, we've decided to fix this with medium priority. We'll get changes into master in about 1 to 3 months. Cheers.","markdown_message":"\u003cp\u003eThank you for your report, we\u0026#39;ve decided to fix this with medium priority. We\u0026#39;ll get changes into master in about 1 to 3 months. Cheers.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-10-30T17:27:42.413Z","updated_at":"2018-10-30T17:27:42.413Z","actor":{"username":"maxtaco","cleared":false,"url":"/maxtaco","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3556345,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2018-10-30T17:28:11.208Z","updated_at":"2018-10-30T17:28:11.208Z","additional_data":{"old_severity":"Medium","new_severity":"Medium (4.6)","old_severity_id":230968,"new_severity_id":231480},"actor":{"username":"maxtaco","cleared":false,"url":"/maxtaco","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3556351,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"(BTW, the fixes to chat are already in master).","markdown_message":"\u003cp\u003e(BTW, the fixes to chat are already in master).\u003c/p\u003e\n","automated_response":false,"created_at":"2018-10-30T17:28:53.047Z","updated_at":"2018-10-30T17:28:53.047Z","actor":{"username":"maxtaco","cleared":false,"url":"/maxtaco","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3556421,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Great!\n\n\u003e // NOTE:  I've seen a few cases were quarantine could break auto-update. ","markdown_message":"\u003cp\u003eGreat!\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003e// NOTE:  I\u0026#39;ve seen a few cases were quarantine could break auto-update. \u003c/p\u003e\n\u003c/blockquote\u003e\n","automated_response":false,"created_at":"2018-10-30T17:46:30.837Z","updated_at":"2018-10-30T17:52:47.047Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3556441,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for the warning, we'll keep that in mind.","markdown_message":"\u003cp\u003eThanks for the warning, we\u0026#39;ll keep that in mind.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-10-30T17:52:38.690Z","updated_at":"2018-10-30T17:52:38.690Z","actor":{"username":"maxtaco","cleared":false,"url":"/maxtaco","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3556606,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@maxtaco As I understand, KBFS should respect MOTW (\"mark of the web\") on Windows too. MOTW - is the same defensive mechanism as GateKeeper and Quarantine\n\nI've not checked Windows yet (just started pulling a VM), do I need to report it as a separate vulnerability?","markdown_message":"\u003cp\u003e\u003ca href=\"/maxtaco\"\u003e@maxtaco\u003c/a\u003e As I understand, KBFS should respect MOTW (\u0026quot;mark of the web\u0026quot;) on Windows too. MOTW - is the same defensive mechanism as GateKeeper and Quarantine\u003c/p\u003e\n\n\u003cp\u003eI\u0026#39;ve not checked Windows yet (just started pulling a VM), do I need to report it as a separate vulnerability?\u003c/p\u003e\n","automated_response":false,"created_at":"2018-10-30T18:35:21.366Z","updated_at":"2018-10-30T18:35:21.366Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3556619,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"It was part of our plan internally too to examine Windows, etc. Thanks!","markdown_message":"\u003cp\u003eIt was part of our plan internally too to examine Windows, etc. Thanks!\u003c/p\u003e\n","automated_response":false,"created_at":"2018-10-30T18:39:25.099Z","updated_at":"2018-10-30T18:39:25.099Z","actor":{"username":"maxtaco","cleared":false,"url":"/maxtaco","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3556776,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"In a case MOTW is not set by your FUSE implementation or any Win misbehavior, and you're going to add them in your implementation:\n\n- Chrome's MOTW blacklist is available [here](https://cs.chromium.org/chromium/src/chrome/browser/resources/safe_browsing/download_file_types.asciipb)\n\n- FF has a similar [blacklist](https://searchfox.org/mozilla-central/source/xpcom/io/nsLocalFileWin.cpp#2901), easier to copy-paste, but it's not complete.\n\n- Adobe has a [huge blacklist for paranoids](https://gist.github.com/rxwx/8834cee60e077531c4db2f260ee55e2a)\n\n- (my repo: [dangerous-file-extensions](https://github.com/Metnew/dangerous-file-extensions) Win files are almost the same as in Chromium )\n\nThanks for replying, Keybase is awesome!","markdown_message":"\u003cp\u003eIn a case MOTW is not set by your FUSE implementation or any Win misbehavior, and you\u0026#39;re going to add them in your implementation:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e\u003cp\u003eChrome\u0026#39;s MOTW blacklist is available \u003ca href=\"/redirect?url=https%3A%2F%2Fcs.chromium.org%2Fchromium%2Fsrc%2Fchrome%2Fbrowser%2Fresources%2Fsafe_browsing%2Fdownload_file_types.asciipb\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehere\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eFF has a similar \u003ca href=\"/redirect?url=https%3A%2F%2Fsearchfox.org%2Fmozilla-central%2Fsource%2Fxpcom%2Fio%2FnsLocalFileWin.cpp%232901\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eblacklist\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e, easier to copy-paste, but it\u0026#39;s not complete.\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eAdobe has a \u003ca href=\"/redirect?url=https%3A%2F%2Fgist.github.com%2Frxwx%2F8834cee60e077531c4db2f260ee55e2a\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehuge blacklist for paranoids\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003e(my repo: \u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2FMetnew%2Fdangerous-file-extensions\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003edangerous-file-extensions\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e Win files are almost the same as in Chromium )\u003c/p\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eThanks for replying, Keybase is awesome!\u003c/p\u003e\n","automated_response":false,"created_at":"2018-10-30T19:15:48.760Z","updated_at":"2018-10-30T19:16:06.343Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3577926,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"[KBFS fix](https://github.com/keybase/kbfs/pull/1896)\n\n\u003e I'm not a Windows expert, so MOTW implementation was quite surprising :)","markdown_message":"\u003cp\u003e\u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fkeybase%2Fkbfs%2Fpull%2F1896\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eKBFS fix\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eI\u0026#39;m not a Windows expert, so MOTW implementation was quite surprising :)\u003c/p\u003e\n\u003c/blockquote\u003e\n","automated_response":false,"created_at":"2018-11-02T21:07:47.276Z","updated_at":"2018-11-02T21:11:59.090Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3889642,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @maxtaco!\n\nAny updates on this? Two months passed since the reporting date.\n\nAlso, I'd like to post an article about Quarantine issues in applications and highlight your effort in fixing this bug. Only two companies decided to fix this issue so far;  resolutions on other three reports are still pending.\n\n\u003e Slack appears to be vulnerable too, but only if it the app was downloaded from the official website, not from AppStore","markdown_message":"\u003cp\u003eHi \u003ca href=\"/maxtaco\"\u003e@maxtaco\u003c/a\u003e!\u003c/p\u003e\n\n\u003cp\u003eAny updates on this? Two months passed since the reporting date.\u003c/p\u003e\n\n\u003cp\u003eAlso, I\u0026#39;d like to post an article about Quarantine issues in applications and highlight your effort in fixing this bug. Only two companies decided to fix this issue so far;  resolutions on other three reports are still pending.\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eSlack appears to be vulnerable too, but only if it the app was downloaded from the official website, not from AppStore\u003c/p\u003e\n\u003c/blockquote\u003e\n","automated_response":false,"created_at":"2018-12-25T21:09:50.686Z","updated_at":"2018-12-25T21:09:50.686Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3889645,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Still working on our finder integration. Let me check with the team. Sorry for the delay. Chat downloads have been fixed for a while. ","markdown_message":"\u003cp\u003eStill working on our finder integration. Let me check with the team. Sorry for the delay. Chat downloads have been fixed for a while. \u003c/p\u003e\n","automated_response":false,"created_at":"2018-12-25T21:13:38.124Z","updated_at":"2018-12-25T21:13:38.124Z","actor":{"username":"maxtaco","cleared":false,"url":"/maxtaco","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3932721,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"We're close, all that's left is the Windows Explorer integration, that's been the hardest to get right. Thank you!","markdown_message":"\u003cp\u003eWe\u0026#39;re close, all that\u0026#39;s left is the Windows Explorer integration, that\u0026#39;s been the hardest to get right. Thank you!\u003c/p\u003e\n","automated_response":false,"created_at":"2019-01-07T01:08:01.487Z","updated_at":"2019-01-07T01:08:01.487Z","actor":{"username":"maxtaco","cleared":false,"url":"/maxtaco","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3932900,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for the update, @maxtaco!\n","markdown_message":"\u003cp\u003eThanks for the update, \u003ca href=\"/maxtaco\"\u003e@maxtaco\u003c/a\u003e!\u003c/p\u003e\n","automated_response":false,"created_at":"2019-01-07T03:55:35.777Z","updated_at":"2019-01-07T03:55:35.777Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4027972,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @maxtaco, I found a better attack scenario:\n\n1. Silently share a file with victim  (check `/keybase/private/metnew,max`\n2. Drop an executable in this folder\n3. Send a crafted `.url` file to victim\n4. Victim opens `.url` file -\u003e RCE\n\nThe main trick is that crafted `.url` files may run arbitrary executables by the path on the system.\nFiles located in Keybase have known paths.\n`.url` files aren't blocked by browsers(Chrome/FF/Safari) and could be sent using messengers, mail apps, browsers, file storages, \u003cany_app\u003e.\n \nI've made a private shared folder `metnew,max` with PoC `x.url` and `exploit.terminal`\n\nI know that Keybase almost patched the bug, but I think such attack scenario may increase severity to critical retroactively: that's 1-click RCE.\n\n\u003e Hardcoded paths allow tricking users into running arbitrary executables shared in Keybase even with quarantine. Not sure, need some bypass for that.","markdown_message":"\u003cp\u003eHi \u003ca href=\"/maxtaco\"\u003e@maxtaco\u003c/a\u003e, I found a better attack scenario:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eSilently share a file with victim  (check \u003ccode\u003e/keybase/private/metnew,max\u003c/code\u003e\n\u003c/li\u003e\n\u003cli\u003eDrop an executable in this folder\u003c/li\u003e\n\u003cli\u003eSend a crafted \u003ccode\u003e.url\u003c/code\u003e file to victim\u003c/li\u003e\n\u003cli\u003eVictim opens \u003ccode\u003e.url\u003c/code\u003e file -\u0026gt; RCE\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eThe main trick is that crafted \u003ccode\u003e.url\u003c/code\u003e files may run arbitrary executables by the path on the system.\u003cbr\u003e\nFiles located in Keybase have known paths.\u003cbr\u003e\n\u003ccode\u003e.url\u003c/code\u003e files aren\u0026#39;t blocked by browsers(Chrome/FF/Safari) and could be sent using messengers, mail apps, browsers, file storages, \u0026lt;any_app\u0026gt;.\u003c/p\u003e\n\n\u003cp\u003eI\u0026#39;ve made a private shared folder \u003ccode\u003emetnew,max\u003c/code\u003e with PoC \u003ccode\u003ex.url\u003c/code\u003e and \u003ccode\u003eexploit.terminal\u003c/code\u003e\u003c/p\u003e\n\n\u003cp\u003eI know that Keybase almost patched the bug, but I think such attack scenario may increase severity to critical retroactively: that\u0026#39;s 1-click RCE.\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eHardcoded paths allow tricking users into running arbitrary executables shared in Keybase even with quarantine. Not sure, need some bypass for that.\u003c/p\u003e\n\u003c/blockquote\u003e\n","automated_response":false,"created_at":"2019-01-24T02:01:09.398Z","updated_at":"2019-01-24T02:12:02.142Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4028109,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi, thanks for the follow-up. I'm not sure I fully understand.  The victim of this attack needs to:\n\n1. Download the link as an attachment from chat (or something)\n2. Double click on the downloaded file in the finder (x.url)\n\nHow is this different from sending someone the malware just from the chat? Is there anyway that downloading x.url from the internet also executes it without further action? That's what I don't understand.","markdown_message":"\u003cp\u003eHi, thanks for the follow-up. I\u0026#39;m not sure I fully understand.  The victim of this attack needs to:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eDownload the link as an attachment from chat (or something)\u003c/li\u003e\n\u003cli\u003eDouble click on the downloaded file in the finder (x.url)\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eHow is this different from sending someone the malware just from the chat? Is there anyway that downloading x.url from the internet also executes it without further action? That\u0026#39;s what I don\u0026#39;t understand.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-01-24T02:32:17.187Z","updated_at":"2019-01-24T02:32:17.187Z","actor":{"username":"maxtaco","cleared":false,"url":"/maxtaco","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4028112,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Yeah, `.url` files downloaded from web could launch files on FS.\nAttaching a PoC (h1 renames `.url` to `.txt`)","markdown_message":"\u003cp\u003eYeah, \u003ccode\u003e.url\u003c/code\u003e files downloaded from web could launch files on FS.\u003cbr\u003e\nAttaching a PoC (h1 renames \u003ccode\u003e.url\u003c/code\u003e to \u003ccode\u003e.txt\u003c/code\u003e)\u003c/p\u003e\n","automated_response":false,"created_at":"2019-01-24T02:33:52.525Z","updated_at":"2019-01-24T02:35:40.321Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":411497,"filename":"x.url","type":"text/plain","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/411/497/feff179d5341b0eac994d330031545baf9946d5c/x.url?response-content-disposition=attachment%3B%20filename%3D%22x.url%22%3B%20filename%2A%3DUTF-8%27%27x.url\u0026response-content-type=text%2Fplain\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQXIKMJWH3%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T055718Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHST0svsvt2laJhuwhvtFHhDNQQ1aKmdn3kMewysqUdFAiEAulql%2B612sAbGAOHB%2F14rmdeeoxU5d8%2BAmcu4RPg%2BHwYqtAMIUhABGgwwMTM2MTkyNzQ4NDkiDCOZXQ8CegoYVtnSUSqRAzpFu%2FKSCAPO9FvY239VSQoXSErgwDzOUTpVgc827sUNqeCED0HHoCoUKyy9kO1lyu0kSFcQXf%2BvW4%2FHwxvZX6%2BphIjx2iPQX6fNNwXKcgYQYxZ8Yx%2BGm7ZXLO%2Bu7Mdu4Fn%2B9TpJQODzePG4VEMMVtb0e6FjQNUF4kQegXC133f3aM6cYX7uAbjyFy7JY7I765EFvdZteqLx2HbWaDGqldcnvslHjs3kmodLKwk9H0Ue0DoWQaLX8Vd2A0w%2FRaO%2FD7%2FQ8PGTn1qam8KaVgzORyAVZ6DxjOPjltRKnxLgyDYBYkhJ4QrBrnmUJPgQMGGWlKZ9SGJYACF0xI0BTQYivNwVfXoTMKUGwE35iziKLaZ5lyBmkqGem%2B%2FfByDZktR%2BpZGSBgSAr1UOE7ov9eb7NhNIuMzcYuOJ1sDR5pR5AlZ4GHJ8eFAlsbYZ1%2B%2F1eXzICdlYRCTp7FQRaLOJji%2BGrr7%2BDGcfEbEP64XGp9sIHjMhhaQcRwVNC6OPA5jdwFCmOnkfeeCoszPtP9ulj%2BvRBs4QMJSFqv8FOusBWzRAvPHoeI1kjG3%2Bj8jYuqVFp2PPU1q0JXR0Ajo08RGvNLJbNpVdip6BBBoiu8PCrCZDZIOwjGA3KcL5o1c4azKc2WVxPog81MB%2FMbDqzX0ad%2FLlmri78RdsSnSIX3Tn18ZdjfTGjol%2FjXedojL6GsI5pB1YlY0EqbQvBnSvbUvPa2Yr7haLR%2FQ%2FG8J8lEfc9mqMV9Imaj1ospS%2BNuCXAlVOb%2F0ya3%2BR4cs2EQotvOugeHotyPJlDfJL6Pqjp0Z9ECJu9QNa4Vn1w2ANPlIUFD2oD6RnsM%2BFR3kpEUChJsMjzZDlljBwhF14Ww%3D%3D\u0026X-Amz-Signature=83708b763fb2bc6561b86893461d9e13ee954125fac4cdecc1b5868e47e32026"}],"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4028117,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Sorry, misunderstand your question\nThe key thing here is that the issue isn't connected to Keybase client only.\nThe victim may receive a `.url` file from mail, browser, other messengers","markdown_message":"\u003cp\u003eSorry, misunderstand your question\u003cbr\u003e\nThe key thing here is that the issue isn\u0026#39;t connected to Keybase client only.\u003cbr\u003e\nThe victim may receive a \u003ccode\u003e.url\u003c/code\u003e file from mail, browser, other messengers\u003c/p\u003e\n","automated_response":false,"created_at":"2019-01-24T02:34:44.335Z","updated_at":"2019-01-24T02:35:12.590Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4028118,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"But in either mail or browser, clicking on that x.url file downloads it to Downloads, and then the user needs to double-click on it, no?","markdown_message":"\u003cp\u003eBut in either mail or browser, clicking on that x.url file downloads it to Downloads, and then the user needs to double-click on it, no?\u003c/p\u003e\n","automated_response":false,"created_at":"2019-01-24T02:36:11.393Z","updated_at":"2019-01-24T02:36:11.393Z","actor":{"username":"maxtaco","cleared":false,"url":"/maxtaco","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4028131,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Yes, it anyway requires a click on `.url` file. However:\n1. the victim doesn't explicitly click on an executable file - that's very important.\n2. Browsers/mail clients allow opening files directly: send `.url` over mail -\u003e victim opens in `Mail.app` (no download step) -\u003e arbitrary code gets executed. For browsers, almost same: it's likely the file will be opened from Chrome downloads bar or in FF via \"Open\" button.\n\n\u003e For messengers: open `x.url` from Telegram/Skype UI -\u003e RCE\n\u003e `.url` files are generally treated as internet shortcuts\n\nI hope you get my point, I may record a screencast if required","markdown_message":"\u003cp\u003eYes, it anyway requires a click on \u003ccode\u003e.url\u003c/code\u003e file. However:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003ethe victim doesn\u0026#39;t explicitly click on an executable file - that\u0026#39;s very important.\u003c/li\u003e\n\u003cli\u003eBrowsers/mail clients allow opening files directly: send \u003ccode\u003e.url\u003c/code\u003e over mail -\u0026gt; victim opens in \u003ccode\u003eMail.app\u003c/code\u003e (no download step) -\u0026gt; arbitrary code gets executed. For browsers, almost same: it\u0026#39;s likely the file will be opened from Chrome downloads bar or in FF via \u0026quot;Open\u0026quot; button.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eFor messengers: open \u003ccode\u003ex.url\u003c/code\u003e from Telegram/Skype UI -\u0026gt; RCE\u003cbr\u003e\n\u003ccode\u003e.url\u003c/code\u003e files are generally treated as internet shortcuts\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eI hope you get my point, I may record a screencast if required\u003c/p\u003e\n","automated_response":false,"created_at":"2019-01-24T02:41:22.545Z","updated_at":"2019-01-24T02:56:20.302Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4028154,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Can you show me a PoC that works in my browser? The one you sent requires more clicks than you have described.","markdown_message":"\u003cp\u003eCan you show me a PoC that works in my browser? The one you sent requires more clicks than you have described.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-01-24T02:55:58.756Z","updated_at":"2019-01-24T02:55:58.756Z","actor":{"username":"maxtaco","cleared":false,"url":"/maxtaco","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4028163,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Attaching a screencast","markdown_message":"\u003cp\u003eAttaching a screencast\u003c/p\u003e\n","automated_response":false,"created_at":"2019-01-24T03:02:45.663Z","updated_at":"2019-01-24T03:02:45.663Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":411503,"filename":"keybase-url.mp4","type":"video/mp4","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/411/503/6b638744b86bab12e929c2c4d67860f1ee28bf55/keybase-url.mp4?response-content-disposition=attachment%3B%20filename%3D%22keybase-url.mp4%22%3B%20filename%2A%3DUTF-8%27%27keybase-url.mp4\u0026response-content-type=video%2Fmp4\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQXIKMJWH3%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T055718Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHST0svsvt2laJhuwhvtFHhDNQQ1aKmdn3kMewysqUdFAiEAulql%2B612sAbGAOHB%2F14rmdeeoxU5d8%2BAmcu4RPg%2BHwYqtAMIUhABGgwwMTM2MTkyNzQ4NDkiDCOZXQ8CegoYVtnSUSqRAzpFu%2FKSCAPO9FvY239VSQoXSErgwDzOUTpVgc827sUNqeCED0HHoCoUKyy9kO1lyu0kSFcQXf%2BvW4%2FHwxvZX6%2BphIjx2iPQX6fNNwXKcgYQYxZ8Yx%2BGm7ZXLO%2Bu7Mdu4Fn%2B9TpJQODzePG4VEMMVtb0e6FjQNUF4kQegXC133f3aM6cYX7uAbjyFy7JY7I765EFvdZteqLx2HbWaDGqldcnvslHjs3kmodLKwk9H0Ue0DoWQaLX8Vd2A0w%2FRaO%2FD7%2FQ8PGTn1qam8KaVgzORyAVZ6DxjOPjltRKnxLgyDYBYkhJ4QrBrnmUJPgQMGGWlKZ9SGJYACF0xI0BTQYivNwVfXoTMKUGwE35iziKLaZ5lyBmkqGem%2B%2FfByDZktR%2BpZGSBgSAr1UOE7ov9eb7NhNIuMzcYuOJ1sDR5pR5AlZ4GHJ8eFAlsbYZ1%2B%2F1eXzICdlYRCTp7FQRaLOJji%2BGrr7%2BDGcfEbEP64XGp9sIHjMhhaQcRwVNC6OPA5jdwFCmOnkfeeCoszPtP9ulj%2BvRBs4QMJSFqv8FOusBWzRAvPHoeI1kjG3%2Bj8jYuqVFp2PPU1q0JXR0Ajo08RGvNLJbNpVdip6BBBoiu8PCrCZDZIOwjGA3KcL5o1c4azKc2WVxPog81MB%2FMbDqzX0ad%2FLlmri78RdsSnSIX3Tn18ZdjfTGjol%2FjXedojL6GsI5pB1YlY0EqbQvBnSvbUvPa2Yr7haLR%2FQ%2FG8J8lEfc9mqMV9Imaj1ospS%2BNuCXAlVOb%2F0ya3%2BR4cs2EQotvOugeHotyPJlDfJL6Pqjp0Z9ECJu9QNa4Vn1w2ANPlIUFD2oD6RnsM%2BFR3kpEUChJsMjzZDlljBwhF14Ww%3D%3D\u0026X-Amz-Signature=c4ff6da667b473ca38e31111828f4b9acaffd221efa7df7890032823f8e81caa"}],"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4030535,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I see, so you're saying is that our previous lack of quarantine protection was a way for an attacker to get around the correct quarantine protection of other applications. ","markdown_message":"\u003cp\u003eI see, so you\u0026#39;re saying is that our previous lack of quarantine protection was a way for an attacker to get around the correct quarantine protection of other applications. \u003c/p\u003e\n","automated_response":false,"created_at":"2019-01-24T10:34:38.660Z","updated_at":"2019-01-24T10:35:05.081Z","actor":{"username":"maxtaco","cleared":false,"url":"/maxtaco","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4030580,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"For me it's (sorry for duplicating this):\n\n1. Fixed paths in Keybase =\u003e attacker always knows the path to malicious executable\n2. it's easy to open this malicious executable via \".url\"\n3. `.url` opens anywhere and isn't blocked by other apps -\u003e RCE (something that I demonstrated on the screencast)\n\npretty silent and reliable RCE without strange `.terminal` files and user interaction on macOS.","markdown_message":"\u003cp\u003eFor me it\u0026#39;s (sorry for duplicating this):\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eFixed paths in Keybase =\u0026gt; attacker always knows the path to malicious executable\u003c/li\u003e\n\u003cli\u003eit\u0026#39;s easy to open this malicious executable via \u0026quot;.url\u0026quot;\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003e.url\u003c/code\u003e opens anywhere and isn\u0026#39;t blocked by other apps -\u0026gt; RCE (something that I demonstrated on the screencast)\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003epretty silent and reliable RCE without strange \u003ccode\u003e.terminal\u003c/code\u003e files and user interaction on macOS.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-01-24T10:41:27.857Z","updated_at":"2019-01-24T10:43:27.781Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4030679,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"\u003e Keybase worm (if no quarantine)\n\u003e 1. Share malicious file with every follower and send them `.url` (e.g. via Twitter) pointing to the malicious file \n\u003e 2. If RCE -\u003e return to 1","markdown_message":"\u003cblockquote\u003e\n\u003cp\u003eKeybase worm (if no quarantine)\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eShare malicious file with every follower and send them \u003ccode\u003e.url\u003c/code\u003e (e.g. via Twitter) pointing to the malicious file \u003c/li\u003e\n\u003cli\u003eIf RCE -\u0026gt; return to 1\u003c/li\u003e\n\u003c/ol\u003e\n\u003c/blockquote\u003e\n","automated_response":false,"created_at":"2019-01-24T11:07:04.004Z","updated_at":"2019-01-24T11:07:51.530Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4030774,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I'd agree with you if it took *one* click but in every example you've sent me, it takes *two* --- one to download the \".url\" file, and another to open it.","markdown_message":"\u003cp\u003eI\u0026#39;d agree with you if it took \u003cem\u003eone\u003c/em\u003e click but in every example you\u0026#39;ve sent me, it takes \u003cem\u003etwo\u003c/em\u003e --- one to download the \u0026quot;.url\u0026quot; file, and another to open it.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-01-24T11:36:06.483Z","updated_at":"2019-01-24T11:36:06.483Z","actor":{"username":"maxtaco","cleared":false,"url":"/maxtaco","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4030778,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Still working on the windows patch, it'll hopefully be done shortly. It's been challenging to get it right due to malicious DLLs.","markdown_message":"\u003cp\u003eStill working on the windows patch, it\u0026#39;ll hopefully be done shortly. It\u0026#39;s been challenging to get it right due to malicious DLLs.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-01-24T11:37:10.865Z","updated_at":"2019-01-24T11:37:10.865Z","actor":{"username":"maxtaco","cleared":false,"url":"/maxtaco","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4032469,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"\u003e No need in a click for downloading -\u003e Chrome auto-downloads `.url`  files, FF has \"Open\" menu in download alert (AFAIR). Only 1 click required :)\n\nI received your message on keybase, thanks)\n\n","markdown_message":"\u003cblockquote\u003e\n\u003cp\u003eNo need in a click for downloading -\u0026gt; Chrome auto-downloads \u003ccode\u003e.url\u003c/code\u003e  files, FF has \u0026quot;Open\u0026quot; menu in download alert (AFAIR). Only 1 click required :)\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eI received your message on keybase, thanks)\u003c/p\u003e\n","automated_response":false,"created_at":"2019-01-24T17:58:50.146Z","updated_at":"2019-01-24T17:58:50.146Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4105588,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Ok, I think we're finally ready to mark this closed.  Do you concur, are we all fixed here?  Sorry it took us so long.","markdown_message":"\u003cp\u003eOk, I think we\u0026#39;re finally ready to mark this closed.  Do you concur, are we all fixed here?  Sorry it took us so long.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-02-06T21:06:43.022Z","updated_at":"2019-02-06T21:06:43.022Z","actor":{"username":"maxtaco","cleared":false,"url":"/maxtaco","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4105631,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"macOS version is fixed - tested on a real device.\nWindows has MOTW + I see in PRs you've implemented protection for DLL hijacking - only static analysis of source code and Github.\n\nSeems fixed to me.\n\nCould we not disclose all the report details publicly for a while?\nTelegram is still working on a patch.\n\nI believe we could make a full disclosure in 1-2 weeks.","markdown_message":"\u003cp\u003emacOS version is fixed - tested on a real device.\u003cbr\u003e\nWindows has MOTW + I see in PRs you\u0026#39;ve implemented protection for DLL hijacking - only static analysis of source code and Github.\u003c/p\u003e\n\n\u003cp\u003eSeems fixed to me.\u003c/p\u003e\n\n\u003cp\u003eCould we not disclose all the report details publicly for a while?\u003cbr\u003e\nTelegram is still working on a patch.\u003c/p\u003e\n\n\u003cp\u003eI believe we could make a full disclosure in 1-2 weeks.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-02-06T21:18:31.538Z","updated_at":"2019-02-06T21:18:31.538Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4614862,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Sorry, still waiting for the last fix from [COMPANY]","markdown_message":"\u003cp\u003eSorry, still waiting for the last fix from [COMPANY]\u003c/p\u003e\n","automated_response":false,"created_at":"2019-04-22T14:53:33.735Z","updated_at":"2019-04-22T14:53:33.735Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5092963,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Need just a few weeks, ████ :(","markdown_message":"\u003cp\u003eNeed just a few weeks, ████ :(\u003c/p\u003e\n","automated_response":false,"created_at":"2019-06-14T10:44:35.503Z","updated_at":"2019-08-15T18:01:09.136Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5305642,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"sorry, but I’m still waiting for a patch from them\nThey said the patch is in beta already","markdown_message":"\u003cp\u003esorry, but I’m still waiting for a patch from them\u003cbr\u003e\nThey said the patch is in beta already\u003c/p\u003e\n","automated_response":false,"created_at":"2019-07-12T10:05:35.593Z","updated_at":"2019-07-12T10:05:35.593Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5565503,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @maxtaco,\n\nAll products (that decided to patch themselves) are now safe.\nCan you mask \u003cCOMPANY_NAME\u003e from the message above (Jun 14) via Limited Disclosure functionality?\n\nThank you for not resolving this ticket for a while!","markdown_message":"\u003cp\u003eHey \u003ca href=\"/maxtaco\"\u003e@maxtaco\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eAll products (that decided to patch themselves) are now safe.\u003cbr\u003e\nCan you mask \u0026lt;COMPANY_NAME\u0026gt; from the message above (Jun 14) via Limited Disclosure functionality?\u003c/p\u003e\n\n\u003cp\u003eThank you for not resolving this ticket for a while!\u003c/p\u003e\n","automated_response":false,"created_at":"2019-08-13T14:52:14.191Z","updated_at":"2019-08-13T14:52:14.191Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5584890,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@maxtaco ping","markdown_message":"\u003cp\u003e\u003ca href=\"/maxtaco\"\u003e@maxtaco\u003c/a\u003e ping\u003c/p\u003e\n","automated_response":false,"created_at":"2019-08-15T15:48:29.114Z","updated_at":"2019-08-15T15:48:29.114Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5584930,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Please, no nagging unless it's truly time sensitive.","markdown_message":"\u003cp\u003ePlease, no nagging unless it\u0026#39;s truly time sensitive.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-08-15T15:56:55.998Z","updated_at":"2019-08-15T15:56:55.998Z","actor":{"username":"maxtaco","cleared":false,"url":"/maxtaco","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5585419,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"How do I edit out the company name?  I don't see how to do it.","markdown_message":"\u003cp\u003eHow do I edit out the company name?  I don\u0026#39;t see how to do it.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-08-15T17:20:27.302Z","updated_at":"2019-08-15T17:20:27.302Z","actor":{"username":"maxtaco","cleared":false,"url":"/maxtaco","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5585557,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @maxtaco,\n\nSorry for that`ping.`, I know it's easy to forget about a report/comment, so that's why.\n\nUnder the \"Severity\" or \"Notifications\" tab in the header of the report, you should see a \"Visibility\" menu with \"Redact\" button(blue link)","markdown_message":"\u003cp\u003eHey \u003ca href=\"/maxtaco\"\u003e@maxtaco\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eSorry for that\u003ccode\u003eping.\u003c/code\u003e, I know it\u0026#39;s easy to forget about a report/comment, so that\u0026#39;s why.\u003c/p\u003e\n\n\u003cp\u003eUnder the \u0026quot;Severity\u0026quot; or \u0026quot;Notifications\u0026quot; tab in the header of the report, you should see a \u0026quot;Visibility\u0026quot; menu with \u0026quot;Redact\u0026quot; button(blue link)\u003c/p\u003e\n","automated_response":false,"created_at":"2019-08-15T17:45:24.521Z","updated_at":"2019-08-15T17:45:24.521Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5585652,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2019-08-15T18:01:43.084Z","updated_at":"2019-08-15T18:01:43.084Z","actor":{"username":"maxtaco","cleared":false,"url":"/maxtaco","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"metnew","url":"/metnew"},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5585654,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2019-08-15T18:02:05.246Z","updated_at":"2019-08-15T18:02:05.246Z","actor":{"url":"/keybase","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/809/710eb42880bb34c06cab0d1d5081488ec59aec5e_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Keybase"}},"bounty_amount":"1000.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"keybase","collaborator":{"username":"metnew","url":"/metnew"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5585706,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"But it's a 1click RCE on the machine via a shortcut file 😞\nThe screencast is here - https://hackerone.com/reports/430463#activity-4028163\n\n\u003e May I ask to reconsider the bounty? The report is a bit old, so maybe we're missing something","markdown_message":"\u003cp\u003eBut it\u0026#39;s a 1click RCE on the machine via a shortcut file 😞\u003cbr\u003e\nThe screencast is here - \u003ca title=\"https://hackerone.com/reports/430463#activity-4028163\" href=\"https://hackerone.com/reports/430463#activity-4028163\"\u003ehttps://hackerone.com/reports/430463#activity-4028163\u003c/a\u003e\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eMay I ask to reconsider the bounty? The report is a bit old, so maybe we\u0026#39;re missing something\u003c/p\u003e\n\u003c/blockquote\u003e\n","automated_response":false,"created_at":"2019-08-15T18:08:58.661Z","updated_at":"2019-08-15T18:08:58.661Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5585809,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Sorry, are you saying that the original severity was underrated? But that the issue is now fixed?","markdown_message":"\u003cp\u003eSorry, are you saying that the original severity was underrated? But that the issue is now fixed?\u003c/p\u003e\n","automated_response":false,"created_at":"2019-08-15T18:22:42.717Z","updated_at":"2019-08-15T18:22:42.717Z","actor":{"username":"maxtaco","cleared":false,"url":"/maxtaco","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5585997,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I really don't want to nag about bounty and severity, just want to make sure we're on the same page. \n\nThe original attack scenario really was estimated as \"Medium\", but later I provided an attack scenario which requires only 1 click:\n1. silently sync a file with victim\n2. auto-download a shortcut file through browser\n3. victim should do 1 click on this file in \"Downloads\" bar\n\nI later messaged you on Keybase and showed the PoC, and you said that it makes no sense to change the \"Severity\" but you'll consider my additional research when awarding the bounty.\n\nMy Keybase: @metnew\nMessage is dated 24 Jan 2019","markdown_message":"\u003cp\u003eI really don\u0026#39;t want to nag about bounty and severity, just want to make sure we\u0026#39;re on the same page. \u003c/p\u003e\n\n\u003cp\u003eThe original attack scenario really was estimated as \u0026quot;Medium\u0026quot;, but later I provided an attack scenario which requires only 1 click:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003esilently sync a file with victim\u003c/li\u003e\n\u003cli\u003eauto-download a shortcut file through browser\u003c/li\u003e\n\u003cli\u003evictim should do 1 click on this file in \u0026quot;Downloads\u0026quot; bar\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eI later messaged you on Keybase and showed the PoC, and you said that it makes no sense to change the \u0026quot;Severity\u0026quot; but you\u0026#39;ll consider my additional research when awarding the bounty.\u003c/p\u003e\n\n\u003cp\u003eMy Keybase: \u003ca href=\"/metnew\"\u003e@metnew\u003c/a\u003e\u003cbr\u003e\nMessage is dated 24 Jan 2019\u003c/p\u003e\n","automated_response":false,"created_at":"2019-08-15T18:47:42.701Z","updated_at":"2019-08-15T18:47:42.701Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5586036,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thank you for the reminder, that was a while ago.","markdown_message":"\u003cp\u003eThank you for the reminder, that was a while ago.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-08-15T18:53:30.765Z","updated_at":"2019-08-15T18:53:30.765Z","actor":{"url":"/keybase","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/809/710eb42880bb34c06cab0d1d5081488ec59aec5e_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Keybase"}},"bounty_amount":"3000.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"keybase","collaborator":{"username":"metnew","url":"/metnew"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5586065,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Sure, thanks @keybase!\nIt was an awesome research for me, and I truly appreciate your response to remediation and disclosure!\n\n\u003e I guess I said like ten times that I enjoy your product :)","markdown_message":"\u003cp\u003eSure, thanks \u003ca href=\"/keybase\"\u003e@keybase\u003c/a\u003e!\u003cbr\u003e\nIt was an awesome research for me, and I truly appreciate your response to remediation and disclosure!\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eI guess I said like ten times that I enjoy your product :)\u003c/p\u003e\n\u003c/blockquote\u003e\n","automated_response":false,"created_at":"2019-08-15T18:56:33.781Z","updated_at":"2019-08-15T18:56:33.781Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5586067,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you for your great work here.","markdown_message":"\u003cp\u003eThank you for your great work here.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-08-15T18:57:23.952Z","updated_at":"2019-08-15T18:57:23.952Z","actor":{"username":"maxtaco","cleared":false,"url":"/maxtaco","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5615225,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-08-20T09:40:27.783Z","updated_at":"2019-08-20T09:40:27.783Z","first_to_agree":true,"actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5818353,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @keybase, may we disclose this report?","markdown_message":"\u003cp\u003eHey \u003ca href=\"/keybase\"\u003e@keybase\u003c/a\u003e, may we disclose this report?\u003c/p\u003e\n","automated_response":false,"created_at":"2019-09-16T18:09:49.839Z","updated_at":"2019-09-16T18:12:44.149Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5819085,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-09-16T19:58:09.394Z","updated_at":"2019-09-16T19:58:09.394Z","actor":{"username":"maxtaco","cleared":false,"url":"/maxtaco","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5819086,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-09-16T19:58:09.462Z","updated_at":"2019-09-16T19:58:09.462Z","actor":{"username":"maxtaco","cleared":false,"url":"/maxtaco","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"id":14095,"category":"researcher","content":"Insufficient quarantine handling in Keybase allowed a remote attacker to execute code on a target macOS device via shortcut file pointing to the synced asset. (1 click RCE via file shortcut)\nPaths to synced files is known to attacker: `/keybase/public/attacker,victim/\u003cfile\u003e`\n\nThe vulnerability initially was reported for macOS. However, Keybase team found that Windows version has a similar issue with MOTW additionally leading to DLL hijacking scenarios.\n\nI want to thank the @keybase team for giving a chance to other companies to patch their products by not disclosing this report for a while.","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eInsufficient quarantine handling in Keybase allowed a remote attacker to execute code on a target macOS device via shortcut file pointing to the synced asset. (1 click RCE via file shortcut)\u003cbr\u003e\nPaths to synced files is known to attacker: \u003ccode\u003e/keybase/public/attacker,victim/\u0026lt;file\u0026gt;\u003c/code\u003e\u003c/p\u003e\n\n\u003cp\u003eThe vulnerability initially was reported for macOS. However, Keybase team found that Windows version has a similar issue with MOTW additionally leading to DLL hijacking scenarios.\u003c/p\u003e\n\n\u003cp\u003eI want to thank the \u003ca href=\"/keybase\"\u003e@keybase\u003c/a\u003e team for giving a chance to other companies to patch their products by not disclosing this report for a while.\u003c/p\u003e\n"}]}