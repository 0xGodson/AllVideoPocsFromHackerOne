{"id":1030212,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMDMwMjEy","url":"https://hackerone.com/reports/1030212","title":"XSS PoC for the wacky.buggywebsite.com challenge","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2020-11-09T19:54:12.639Z","submitted_at":"2020-11-09T19:54:12.714Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"vovohelo","url":"/vovohelo","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/gmTMpTyLui8qNxTscuYLm1h7/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":49074,"url":"https://hackerone.com/bugpoc","handle":"bugpoc","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/uu9HGr8oDden1RHaB9Da9GjM/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/uu9HGr8oDden1RHaB9Da9GjM/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"BugPoC","twitter_handle":"bugpoc_official","website":"http://bugpoc.com","about":"A Platform to Build and Share Proof-of-Concepts for Bug Bounty Submissions, PenTest Deliverables, \u0026 Red Team Reports."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2020-11-18T05:23:14.176Z","bug_reporter_agreed_on_going_public_at":"2020-11-14T15:46:20.987Z","team_member_agreed_on_going_public_at":"2020-11-18T05:23:14.095Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"## Summary:\nhttps://wacky.buggywebsite.com/frame.html is vulnerable to DOM-based XSS.\n\n## Steps To Reproduce:\n  1. Navigate to https://oembed.dev.ipwnedyour.net/wacky.buggywebsite.com.xss.html\n  1. Verify the document's origin is displayed in an alert box.\n\n## PoC code details:\n\nThe PoC page at https://oembed.dev.ipwnedyour.net/wacky.buggywebsite.com.xss.html will set the ```window.name``` variable to \"iframe\" before redirecting the user to https://wacky.buggywebsite.com/frame.html.\nThe page https://wacky.buggywebsite.com/frame.html is vulnerable to reflected XSS in the title element. The Reflected XSS can be used to alter the base reference for relative paths by including a base tag in the document's head.\nAltering the base path one can force the page's last script block to set the source of the analytics iframe to an arbitrary remote file. As the iframe will be treated as belonging to the same domain as the parent window, it is possible to read the nonce attribute value from the script blocks in the top window. Knowing the nonce, one can bypass CSP and create their own script blocks and execute arbitrary javascript code.\n\n## Supporting Material/References:\n\n  * BugPoC details:\n\n```yaml\nID:  bp-C9HFiJW1\nPassword: siNgLeCRAb32\nLink: https://bugpoc.com/poc#bp-C9HFiJW1\n```\n\n## Impact\n\nThis is a standard XSS vulnerability. An attacker may force users to perform any activities available through the API or use this for credential harvesting, session hijacking, phishing campaigns, etc.","vulnerability_information_html":"\u003ch2 id=\"summary\"\u003eSummary:\u003c/h2\u003e\n\n\u003cp\u003e\u003ca title=\"https://wacky.buggywebsite.com/frame.html\" href=\"/redirect?url=https%3A%2F%2Fwacky.buggywebsite.com%2Fframe.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://wacky.buggywebsite.com/frame.html\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e is vulnerable to DOM-based XSS.\u003c/p\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps To Reproduce:\u003c/h2\u003e\n\n\u003col\u003e\n\u003cli\u003eNavigate to \u003ca title=\"https://oembed.dev.ipwnedyour.net/wacky.buggywebsite.com.xss.html\" href=\"/redirect?url=https%3A%2F%2Foembed.dev.ipwnedyour.net%2Fwacky.buggywebsite.com.xss.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://oembed.dev.ipwnedyour.net/wacky.buggywebsite.com.xss.html\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003eVerify the document\u0026#39;s origin is displayed in an alert box.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003ch2 id=\"poc-code-details\"\u003ePoC code details:\u003c/h2\u003e\n\n\u003cp\u003eThe PoC page at \u003ca title=\"https://oembed.dev.ipwnedyour.net/wacky.buggywebsite.com.xss.html\" href=\"/redirect?url=https%3A%2F%2Foembed.dev.ipwnedyour.net%2Fwacky.buggywebsite.com.xss.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://oembed.dev.ipwnedyour.net/wacky.buggywebsite.com.xss.html\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e will set the \u003ccode\u003ewindow.name\u003c/code\u003e variable to \u0026quot;iframe\u0026quot; before redirecting the user to \u003ca title=\"https://wacky.buggywebsite.com/frame.html\" href=\"/redirect?url=https%3A%2F%2Fwacky.buggywebsite.com%2Fframe.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://wacky.buggywebsite.com/frame.html\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e.\u003cbr\u003e\nThe page \u003ca title=\"https://wacky.buggywebsite.com/frame.html\" href=\"/redirect?url=https%3A%2F%2Fwacky.buggywebsite.com%2Fframe.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://wacky.buggywebsite.com/frame.html\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e is vulnerable to reflected XSS in the title element. The Reflected XSS can be used to alter the base reference for relative paths by including a base tag in the document\u0026#39;s head.\u003cbr\u003e\nAltering the base path one can force the page\u0026#39;s last script block to set the source of the analytics iframe to an arbitrary remote file. As the iframe will be treated as belonging to the same domain as the parent window, it is possible to read the nonce attribute value from the script blocks in the top window. Knowing the nonce, one can bypass CSP and create their own script blocks and execute arbitrary javascript code.\u003c/p\u003e\n\n\u003ch2 id=\"supporting-material-references\"\u003eSupporting Material/References:\u003c/h2\u003e\n\n\u003cul\u003e\n\u003cli\u003eBugPoC details:\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight yaml\"\u003e\u003ccode\u003e\u003cspan class=\"na\"\u003eID\u003c/span\u003e\u003cspan class=\"pi\"\u003e:\u003c/span\u003e  \u003cspan class=\"s\"\u003ebp-C9HFiJW1\u003c/span\u003e\n\u003cspan class=\"na\"\u003ePassword\u003c/span\u003e\u003cspan class=\"pi\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003esiNgLeCRAb32\u003c/span\u003e\n\u003cspan class=\"na\"\u003eLink\u003c/span\u003e\u003cspan class=\"pi\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003ehttps://bugpoc.com/poc#bp-C9HFiJW1\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eThis is a standard XSS vulnerability. An attacker may force users to perform any activities available through the API or use this for credential harvesting, session hijacking, phishing campaigns, etc.\u003c/p\u003e\n","bounty_amount":"100.0","formatted_bounty":"$100","original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2020-12-14T15:46:21.062Z","allow_singular_disclosure_after":-1254384.20202641,"singular_disclosure_allowed":true,"vote_count":7,"voters":["pyrrhon","kapkan","vovohelo","yusuf_furkan","f_m","ilovechickennoodles","juhertra"],"severity":{"rating":"medium","author_type":"User"},"structured_scope":{"databaseId":51128,"asset_type":"URL","asset_identifier":"*.buggywebsite.com","max_severity":"none"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":9772461,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks for participating in our CTF Challenge! Your solution is correct, however unfortunately the 1st and 2nd place prizes have already been claimed. But do not worry - **your name has been entered into a Raffle to win $100!** 10 random winners will be announced on **November 10th**. Stay tuned- we will re-open and award this submission if you win!\n\nThis challenge also serves as the *first interview* for select Amazon Security Engineering roles! Please fill out [this form](https://forms.gle/qWFGpzMgANEBdDfT9) if you are interested in **skipping the first round of interviews** for select positions.\n\nReminder - the best blog write-up about this challenge will win $300! Submit yours *11/09 10pm EDT - 11/11 10PM EDT* by tagging [@bugpoc_official](https://twitter.com/bugpoc_official) on Twitter.\n\nBTW, in the future, you can use the [Mock Endpoint](https://bugpoc.com/testers/other/mock) to create a server response, then use the [Flexible Redirector](https://bugpoc.com/testers/other/redir) to make it accessible from many URL patterns. No need to host your own infra :)","markdown_message":"\u003cp\u003eThanks for participating in our CTF Challenge! Your solution is correct, however unfortunately the 1st and 2nd place prizes have already been claimed. But do not worry - \u003cstrong\u003eyour name has been entered into a Raffle to win $100!\u003c/strong\u003e 10 random winners will be announced on \u003cstrong\u003eNovember 10th\u003c/strong\u003e. Stay tuned- we will re-open and award this submission if you win!\u003c/p\u003e\n\n\u003cp\u003eThis challenge also serves as the \u003cem\u003efirst interview\u003c/em\u003e for select Amazon Security Engineering roles! Please fill out \u003ca href=\"/redirect?url=https%3A%2F%2Fforms.gle%2FqWFGpzMgANEBdDfT9\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ethis form\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e if you are interested in \u003cstrong\u003eskipping the first round of interviews\u003c/strong\u003e for select positions.\u003c/p\u003e\n\n\u003cp\u003eReminder - the best blog write-up about this challenge will win $300! Submit yours \u003cem\u003e11/09 10pm EDT - 11/11 10PM EDT\u003c/em\u003e by tagging \u003ca href=\"/redirect?url=https%3A%2F%2Ftwitter.com%2Fbugpoc_official\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003e@bugpoc_official\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e on Twitter.\u003c/p\u003e\n\n\u003cp\u003eBTW, in the future, you can use the \u003ca href=\"/redirect?url=https%3A%2F%2Fbugpoc.com%2Ftesters%2Fother%2Fmock\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eMock Endpoint\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e to create a server response, then use the \u003ca href=\"/redirect?url=https%3A%2F%2Fbugpoc.com%2Ftesters%2Fother%2Fredir\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eFlexible Redirector\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e to make it accessible from many URL patterns. No need to host your own infra :)\u003c/p\u003e\n","automated_response":false,"created_at":"2020-11-09T19:57:35.786Z","updated_at":"2020-11-09T19:57:35.786Z","actor":{"username":"bugpoc_ryan","cleared":false,"url":"/bugpoc_ryan","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/XkXLmTi1HngqmWKuv5FDbtEs/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"vovohelo","url":"/vovohelo"},"genius_execution_id":null,"team_handle":"bugpoc","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9772649,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"thanks for the tips @bugpoc_ryan !","markdown_message":"\u003cp\u003ethanks for the tips \u003ca href=\"/bugpoc_ryan\"\u003e@bugpoc_ryan\u003c/a\u003e !\u003c/p\u003e\n","automated_response":false,"created_at":"2020-11-09T20:23:06.975Z","updated_at":"2020-11-09T20:23:06.975Z","actor":{"username":"vovohelo","cleared":false,"url":"/vovohelo","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/gmTMpTyLui8qNxTscuYLm1h7/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"bugpoc","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9784170,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Congratulations! Your solution was chosen in the raffle which means you just won **$100**! Thanks for participating in our program and great job with this challenge!","markdown_message":"\u003cp\u003eCongratulations! Your solution was chosen in the raffle which means you just won \u003cstrong\u003e$100\u003c/strong\u003e! Thanks for participating in our program and great job with this challenge!\u003c/p\u003e\n","automated_response":false,"created_at":"2020-11-10T19:51:17.613Z","updated_at":"2020-11-10T19:51:17.613Z","actor":{"url":"/bugpoc","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/uu9HGr8oDden1RHaB9Da9GjM/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"BugPoC"}},"bounty_amount":"100.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"bugpoc","collaborator":{"username":"vovohelo","url":"/vovohelo"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9823396,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Can we disclose the solution?","markdown_message":"\u003cp\u003eCan we disclose the solution?\u003c/p\u003e\n","automated_response":false,"created_at":"2020-11-14T15:46:21.007Z","updated_at":"2020-11-14T15:46:21.007Z","first_to_agree":true,"actor":{"username":"vovohelo","cleared":false,"url":"/vovohelo","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/gmTMpTyLui8qNxTscuYLm1h7/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"bugpoc","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9851254,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-11-18T05:23:14.115Z","updated_at":"2020-11-18T05:23:14.115Z","actor":{"username":"bugpoc_ryan","cleared":false,"url":"/bugpoc_ryan","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/XkXLmTi1HngqmWKuv5FDbtEs/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"bugpoc","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9851255,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-11-18T05:23:14.195Z","updated_at":"2020-11-18T05:23:14.195Z","actor":{"username":"bugpoc_ryan","cleared":false,"url":"/bugpoc_ryan","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/XkXLmTi1HngqmWKuv5FDbtEs/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"bugpoc","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}