{"id":92472,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC85MjQ3Mg==","url":"https://hackerone.com/reports/92472","title":"Tokens from services like Facebook can be stolen","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2015-10-05T20:27:59.489Z","submitted_at":"2015-10-05T20:27:59.489Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"stefanofinding","url":"/stefanofinding","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/002/171/2558843b6d2b90f4dd826a661bcef3fd1abb2906_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1926,"url":"https://hackerone.com/badoo","handle":"badoo","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/926/2d5179ec8d7d7c36af59a55d318dace33c3aa109_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/926/2d5179ec8d7d7c36af59a55d318dace33c3aa109_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Badoo","twitter_handle":"Badoo","website":"https://badoo.com","about":"Meet new people"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2016-06-03T15:28:12.914Z","bug_reporter_agreed_on_going_public_at":"2016-06-03T13:56:10.162Z","team_member_agreed_on_going_public_at":"2016-06-03T15:28:12.761Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"__Description__\n\nThis file https://mus1.badoo.com/cb.html looks for the parameters _access_token_, _token_ and _code_ in the URL and send the value back to the `window.opener` using `window.opener.postMessage(message, '*');`. Because you specified `*` as the value of the second parameter of `postMessage()`, the browser is not going to check which is the opener and will send the message to any opener with the token.\nThe problem here is that you can receive the message from a site you control and then use this token to even log in Badoo.\n\n__Proof of concept__\n\n1. Download the file _opener.html_ that I attached.\n2. Sign up to Badoo using Facebook.\n3. Using the browser where you are logged in to Facebook, open the file that you downloaded in step 1.\n4. Click on _Click Here_.\n5. Wait a few seconds.\n6. When it's done, in the page will appear your Facebook token for Badoo.\n\nI attached a screen capture too (the size is 1.4MB).\nPlease, let me know if you need more information.","vulnerability_information_html":"\u003cp\u003e\u003cstrong\u003eDescription\u003c/strong\u003e\u003c/p\u003e\n\n\u003cp\u003eThis file \u003ca title=\"https://mus1.badoo.com/cb.html\" href=\"/redirect?url=https%3A%2F%2Fmus1.badoo.com%2Fcb.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://mus1.badoo.com/cb.html\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e looks for the parameters \u003cu\u003eaccess_token\u003c/u\u003e, \u003cu\u003etoken\u003c/u\u003e and \u003cu\u003ecode\u003c/u\u003e in the URL and send the value back to the \u003ccode\u003ewindow.opener\u003c/code\u003e using \u003ccode\u003ewindow.opener.postMessage(message, \u0026#39;*\u0026#39;);\u003c/code\u003e. Because you specified \u003ccode\u003e*\u003c/code\u003e as the value of the second parameter of \u003ccode\u003epostMessage()\u003c/code\u003e, the browser is not going to check which is the opener and will send the message to any opener with the token.\u003cbr\u003e\nThe problem here is that you can receive the message from a site you control and then use this token to even log in Badoo.\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eProof of concept\u003c/strong\u003e\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eDownload the file \u003cu\u003eopener.html\u003c/u\u003e that I attached.\u003c/li\u003e\n\u003cli\u003eSign up to Badoo using Facebook.\u003c/li\u003e\n\u003cli\u003eUsing the browser where you are logged in to Facebook, open the file that you downloaded in step 1.\u003c/li\u003e\n\u003cli\u003eClick on \u003cu\u003eClick Here\u003c/u\u003e.\u003c/li\u003e\n\u003cli\u003eWait a few seconds.\u003c/li\u003e\n\u003cli\u003eWhen it\u0026#39;s done, in the page will appear your Facebook token for Badoo.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eI attached a screen capture too (the size is 1.4MB).\u003cbr\u003e\nPlease, let me know if you need more information.\u003c/p\u003e\n","bounty_amount":"456.0","formatted_bounty":"$456","original_report_id":null,"original_report_url":null,"attachments":[{"id":56340,"file_name":"opener.html","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/056/340/08f0cd7f2fc9593ad4927308f5d2a9e004e1ac39/opener.html?response-content-disposition=attachment%3B%20filename%3D%22opener.html%22%3B%20filename%2A%3DUTF-8%27%27opener.html\u0026response-content-type=application%2Foctet-stream\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQTYNHLLAI%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T071152Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHZ%2BW3HUv1n%2B6aR51XKyQUoltUs4dpenL8C5Ngq%2FaRRRAiEAmfsKW6s44zslbtLbjio7lyByPFrM4HhkqWc4BlKqI%2FsqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDEk2ujSH9wgIeNJFfSqRA5L87pajd4uBiMOahwiQWY9MCcYfdnrcw1IGaRg5TpxW7DR87N3npEJ347tYQoNG4qvz83ZIfPJaoV16%2BHSbvgHCloy0L2IJebFkXavQ%2FqP76i9C%2Fflz0T%2FAY7BQexVBAB81BDbhmxnE9q9peEXcv7DxPs6yUKcdy540RKUrN7uslxSA7j3G9JiTuJ6qb2%2F4wYsuXqZAjjjsCgg1mXnpWD2MBpvjLmy20fnWfTyEpbZx69BhUOjIiXGUwMwyU3vIR8mTDDVd0lLxGqVwqo7wgDElekHdTEW3qhMPXMlt6DlI6yj8Gdba%2FBl9Vc01EccnsQcPWyVJry%2FS5ynL9DMtJAAAFirbxDGfh3YyQKCitVKKFFQ%2BXcUVp%2FSwwBBOTy19C2elhYtpl6vcpcY0%2FpxhMV%2FLT11lv%2FW2w21ED7vsm1c%2FDgyMyGhcc5jxtzWgSuplAxsWTwQc5B1WrLELk6MdDLXcvxB6lqSlYR3jek%2FEqa3e3t%2FxycmED7JcchnTpltDpgBiVe4qfO%2B85c9LeAT9plTAMKDqqv8FOusBsw37kCqQM4gZ7GwocFGWO%2Bb%2BbNa2dgEi%2Fv9cXsb1AOYUnwz%2B%2FyPyUSoTx0mdn2JtBFbkLI2hWmV1Y9Plg4ywi43mIKFY5BXMieUzgwCaeF0glcm8O%2F5kugCvuf01QuIauHjpwGSFMitZi1h52iDxD6TQNrXkM8ak7hW52tsH0VpvrBIvM3fFeRl4cr81y%2FuM3ueoyxszwreZZnbZK4WIuk8LU9YhohKDj6BRCCLOA1ZWZip14mKPOWPa8WaAzVovmI9BYDR0AxC4M%2FMywNMPj4r12n4DpTYCcHFvsA18GtoCtKML64R8uPhkQw%3D%3D\u0026X-Amz-Signature=bd95d0efbaf448a7caadd08ad6e103f7f85d51216e083afc3131cb21b64e750d","file_size":819,"type":"text/html"},{"id":56341,"file_name":"Screen_Capture.mov","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/056/341/519255c64177f451cd68b0b9397b42199a97735a/Screen_Capture.mov?response-content-disposition=attachment%3B%20filename%3D%22Screen_Capture.mov%22%3B%20filename%2A%3DUTF-8%27%27Screen_Capture.mov\u0026response-content-type=video%2Fquicktime\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQTYNHLLAI%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T071152Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHZ%2BW3HUv1n%2B6aR51XKyQUoltUs4dpenL8C5Ngq%2FaRRRAiEAmfsKW6s44zslbtLbjio7lyByPFrM4HhkqWc4BlKqI%2FsqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDEk2ujSH9wgIeNJFfSqRA5L87pajd4uBiMOahwiQWY9MCcYfdnrcw1IGaRg5TpxW7DR87N3npEJ347tYQoNG4qvz83ZIfPJaoV16%2BHSbvgHCloy0L2IJebFkXavQ%2FqP76i9C%2Fflz0T%2FAY7BQexVBAB81BDbhmxnE9q9peEXcv7DxPs6yUKcdy540RKUrN7uslxSA7j3G9JiTuJ6qb2%2F4wYsuXqZAjjjsCgg1mXnpWD2MBpvjLmy20fnWfTyEpbZx69BhUOjIiXGUwMwyU3vIR8mTDDVd0lLxGqVwqo7wgDElekHdTEW3qhMPXMlt6DlI6yj8Gdba%2FBl9Vc01EccnsQcPWyVJry%2FS5ynL9DMtJAAAFirbxDGfh3YyQKCitVKKFFQ%2BXcUVp%2FSwwBBOTy19C2elhYtpl6vcpcY0%2FpxhMV%2FLT11lv%2FW2w21ED7vsm1c%2FDgyMyGhcc5jxtzWgSuplAxsWTwQc5B1WrLELk6MdDLXcvxB6lqSlYR3jek%2FEqa3e3t%2FxycmED7JcchnTpltDpgBiVe4qfO%2B85c9LeAT9plTAMKDqqv8FOusBsw37kCqQM4gZ7GwocFGWO%2Bb%2BbNa2dgEi%2Fv9cXsb1AOYUnwz%2B%2FyPyUSoTx0mdn2JtBFbkLI2hWmV1Y9Plg4ywi43mIKFY5BXMieUzgwCaeF0glcm8O%2F5kugCvuf01QuIauHjpwGSFMitZi1h52iDxD6TQNrXkM8ak7hW52tsH0VpvrBIvM3fFeRl4cr81y%2FuM3ueoyxszwreZZnbZK4WIuk8LU9YhohKDj6BRCCLOA1ZWZip14mKPOWPa8WaAzVovmI9BYDR0AxC4M%2FMywNMPj4r12n4DpTYCcHFvsA18GtoCtKML64R8uPhkQw%3D%3D\u0026X-Amz-Signature=b6a8591bbb8adcf4c4a161b083c87ad90924e92df415627e8002aef692206b8d","file_size":1432373,"type":"video/quicktime"}],"allow_singular_disclosure_at":"2016-07-03T13:56:10.329Z","allow_singular_disclosure_after":-141671742.4345251,"singular_disclosure_allowed":true,"vote_count":5,"voters":["iphoneintosh","kiraak-boy","sumit7","hacklad","dyabla"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":611381,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2015-10-06T16:46:26.647Z","updated_at":"2015-10-06T16:46:26.647Z","actor":{"username":"iyakovlev","cleared":false,"url":"/iyakovlev","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/035/745/0021196ae41e34df146de08f7438520dcebfded9_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"badoo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":611394,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Hi! \nThank you very much for your report. We've decided to assign a 3rd category to this vulnerability, and rewarding you with £300, which is a bit more than $450.","markdown_message":"\u003cp\u003eHi! \u003cbr\u003e\nThank you very much for your report. We\u0026#39;ve decided to assign a 3rd category to this vulnerability, and rewarding you with £300, which is a bit more than $450.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-10-06T16:49:25.394Z","updated_at":"2015-10-06T16:49:25.394Z","actor":{"url":"/badoo","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/926/2d5179ec8d7d7c36af59a55d318dace33c3aa109_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Badoo"}},"bounty_amount":"456.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"badoo","collaborator":{"username":"stefanofinding","url":"/stefanofinding"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":611399,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @iyakovlev,\nthank you for the reward! That was fast!","markdown_message":"\u003cp\u003eHi \u003ca href=\"/iyakovlev\"\u003e@iyakovlev\u003c/a\u003e,\u003cbr\u003e\nthank you for the reward! That was fast!\u003c/p\u003e\n","automated_response":false,"created_at":"2015-10-06T16:51:35.982Z","updated_at":"2015-10-06T16:51:35.982Z","actor":{"username":"stefanofinding","cleared":true,"url":"/stefanofinding","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/171/2558843b6d2b90f4dd826a661bcef3fd1abb2906_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"badoo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":627414,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hi @esevece!\nWe have fixed the issue. \nThank you! ","markdown_message":"\u003cp\u003eHi \u003ca href=\"/esevece\"\u003e@esevece\u003c/a\u003e!\u003cbr\u003e\nWe have fixed the issue. \u003cbr\u003e\nThank you! \u003c/p\u003e\n","automated_response":false,"created_at":"2015-10-21T14:44:42.366Z","updated_at":"2015-10-21T14:44:42.366Z","actor":{"username":"iyakovlev","cleared":false,"url":"/iyakovlev","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/035/745/0021196ae41e34df146de08f7438520dcebfded9_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"stefanofinding","url":"/stefanofinding"},"genius_execution_id":null,"team_handle":"badoo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":630721,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @iyakovlev,\nthat's great! I just checked and it's okay.\nHave a nice weekend!","markdown_message":"\u003cp\u003eHi \u003ca href=\"/iyakovlev\"\u003e@iyakovlev\u003c/a\u003e,\u003cbr\u003e\nthat\u0026#39;s great! I just checked and it\u0026#39;s okay.\u003cbr\u003e\nHave a nice weekend!\u003c/p\u003e\n","automated_response":false,"created_at":"2015-10-24T05:14:54.660Z","updated_at":"2015-10-24T05:14:54.660Z","actor":{"username":"stefanofinding","cleared":true,"url":"/stefanofinding","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/171/2558843b6d2b90f4dd826a661bcef3fd1abb2906_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"badoo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":998201,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"If it's okay for you.","markdown_message":"\u003cp\u003eIf it\u0026#39;s okay for you.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-06-03T13:56:10.212Z","updated_at":"2016-06-03T13:56:10.212Z","first_to_agree":true,"actor":{"username":"stefanofinding","cleared":true,"url":"/stefanofinding","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/171/2558843b6d2b90f4dd826a661bcef3fd1abb2906_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"badoo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":998356,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Sure, no problem. Thanks.","markdown_message":"\u003cp\u003eSure, no problem. Thanks.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-06-03T15:28:12.806Z","updated_at":"2016-06-03T15:28:12.806Z","actor":{"username":"uyga","cleared":false,"url":"/uyga","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/005/780/942fbff2730b14a4cb3450a1c78b108cf3abbe91_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"badoo","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":998357,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-06-03T15:28:12.949Z","updated_at":"2016-06-03T15:28:12.949Z","actor":{"username":"uyga","cleared":false,"url":"/uyga","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/005/780/942fbff2730b14a4cb3450a1c78b108cf3abbe91_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"badoo","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":998365,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you.","markdown_message":"\u003cp\u003eThank you.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-06-03T15:30:07.750Z","updated_at":"2016-06-03T15:30:07.750Z","actor":{"username":"stefanofinding","cleared":true,"url":"/stefanofinding","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/171/2558843b6d2b90f4dd826a661bcef3fd1abb2906_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"badoo","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}