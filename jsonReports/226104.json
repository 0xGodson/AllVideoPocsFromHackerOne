{"id":226104,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMjYxMDQ=","url":"https://hackerone.com/reports/226104","title":"Incomplete fix for #181225 (target=_blank vulnerability)","state":"Closed","substate":"not-applicable","readable_substate":"N/A","created_at":"2017-05-04T14:37:13.342Z","submitted_at":"2017-05-04T14:37:13.342Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"cablej","url":"/cablej","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/042/859/7fdafea90092a305ae2cb6cec7d43461783abf0c_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":8539,"url":"https://hackerone.com/paragonie","handle":"paragonie","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/008/539/72f76fed45e5220b47ba2f679371ebf9ccb19c70_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/539/72f76fed45e5220b47ba2f679371ebf9ccb19c70_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Paragon Initiative Enterprises","twitter_handle":"ParagonIE","website":"https://github.com/paragonie","about":"Cryptography and Application Security Consultants - We Produce Various Open Source Libraries"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2018-04-20T18:07:09.873Z","bug_reporter_agreed_on_going_public_at":"2018-04-20T18:06:40.217Z","team_member_agreed_on_going_public_at":"2018-04-20T18:07:09.820Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi,\n\nI believe the fix for #181225 is incomplete in the rules for Airship wysihtml parser rules.\n\nAt https://github.com/paragonie/airship/blob/58f96aa0e5002b60e74456502d9bfc9483d77b3d/src/public/js/wysihtml5/parser_rules/advanced_and_extended.js, the 'target' parameter for links is allowed to be anything, while there are no forced 'rel' attributes. Additionally, https://github.com/paragonie/airship/blob/58f96aa0e5002b60e74456502d9bfc9483d77b3d/src/public/js/wysihtml5/parser_rules/simple.js sets 'rel' to only 'nofollow'.\n\nThis could be exploited by a user who posts a link with 'target=_blank', who can then change the URL of the opening page. To fix, add 'rel=\"noopener noreferrer\"' to the parser rules.\n\nThanks.","vulnerability_information_html":"\u003cp\u003eHi,\u003c/p\u003e\n\n\u003cp\u003eI believe the fix for \u003ca href=\"/reports/181225\"\u003e#181225\u003c/a\u003e is incomplete in the rules for Airship wysihtml parser rules.\u003c/p\u003e\n\n\u003cp\u003eAt \u003ca title=\"https://github.com/paragonie/airship/blob/58f96aa0e5002b60e74456502d9bfc9483d77b3d/src/public/js/wysihtml5/parser_rules/advanced_and_extended.js\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fparagonie%2Fairship%2Fblob%2F58f96aa0e5002b60e74456502d9bfc9483d77b3d%2Fsrc%2Fpublic%2Fjs%2Fwysihtml5%2Fparser_rules%2Fadvanced_and_extended.js\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/paragonie/airship/blob/58f96aa0e5002b60e74456502d9bfc9483d77b3d/src/public/js/wysihtml5/parser_rules/advanced_and_extended.js\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e, the \u0026#39;target\u0026#39; parameter for links is allowed to be anything, while there are no forced \u0026#39;rel\u0026#39; attributes. Additionally, \u003ca title=\"https://github.com/paragonie/airship/blob/58f96aa0e5002b60e74456502d9bfc9483d77b3d/src/public/js/wysihtml5/parser_rules/simple.js\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fparagonie%2Fairship%2Fblob%2F58f96aa0e5002b60e74456502d9bfc9483d77b3d%2Fsrc%2Fpublic%2Fjs%2Fwysihtml5%2Fparser_rules%2Fsimple.js\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/paragonie/airship/blob/58f96aa0e5002b60e74456502d9bfc9483d77b3d/src/public/js/wysihtml5/parser_rules/simple.js\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e sets \u0026#39;rel\u0026#39; to only \u0026#39;nofollow\u0026#39;.\u003c/p\u003e\n\n\u003cp\u003eThis could be exploited by a user who posts a link with \u0026#39;target=_blank\u0026#39;, who can then change the URL of the opening page. To fix, add \u0026#39;rel=\u0026quot;noopener noreferrer\u0026quot;\u0026#39; to the parser rules.\u003c/p\u003e\n\n\u003cp\u003eThanks.\u003c/p\u003e\n","original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":5,"voters":["jokebookservice1","sp1d3rs","fa1rlight","cuso4","apapedulimu"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1655289,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I'm not sure this is really a vulnerability, considering that someone can edit the HTML manually, remove these tags, and then end up vulnerable to phishing.\n\nThat being said, fixing the default behavior could be beneficial to *preventing* phishing if users use the WYSIWYG editor and aren't extremely careful.\n\nA more robust approach might be to add these tags to all hyperlinks for user-provided content before purifying output. I'll need to research this, though.","markdown_message":"\u003cp\u003eI\u0026#39;m not sure this is really a vulnerability, considering that someone can edit the HTML manually, remove these tags, and then end up vulnerable to phishing.\u003c/p\u003e\n\n\u003cp\u003eThat being said, fixing the default behavior could be beneficial to \u003cem\u003epreventing\u003c/em\u003e phishing if users use the WYSIWYG editor and aren\u0026#39;t extremely careful.\u003c/p\u003e\n\n\u003cp\u003eA more robust approach might be to add these tags to all hyperlinks for user-provided content before purifying output. I\u0026#39;ll need to research this, though.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-05-04T22:01:31.449Z","updated_at":"2017-05-04T22:01:31.449Z","actor":{"username":"paragonie-scott","cleared":false,"url":"/paragonie-scott","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/051/441/089de22b2f1b80a1e57a2792318dede5cbad81db_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"paragonie","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1659131,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Sorry, this has actually been triaged, I'm just not used to the new HackerOne workflow.","markdown_message":"\u003cp\u003eSorry, this has actually been triaged, I\u0026#39;m just not used to the new HackerOne workflow.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-05-07T16:44:58.150Z","updated_at":"2017-05-07T16:44:58.150Z","actor":{"username":"paragonie-scott","cleared":false,"url":"/paragonie-scott","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/051/441/089de22b2f1b80a1e57a2792318dede5cbad81db_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"paragonie","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2648388,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"HackerOne is pestering me to respond to this, but I'm not sure what else there is to say. This opens the door to an interesting defensive security research project moreso than it is a vulnerability in our project. Would you take offense if I closed it as informative and published it (i.e. full disclosure)?","markdown_message":"\u003cp\u003eHackerOne is pestering me to respond to this, but I\u0026#39;m not sure what else there is to say. This opens the door to an interesting defensive security research project moreso than it is a vulnerability in our project. Would you take offense if I closed it as informative and published it (i.e. full disclosure)?\u003c/p\u003e\n","automated_response":false,"created_at":"2018-04-20T17:30:19.555Z","updated_at":"2018-04-20T17:30:19.555Z","actor":{"username":"paragonie-scott","cleared":false,"url":"/paragonie-scott","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/051/441/089de22b2f1b80a1e57a2792318dede5cbad81db_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"paragonie","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2648547,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @paragonie-scott,\n\nI agree that this isn't much of issue. If you change this report from `triaged` to `new`, I can self close this as N/A to not impact my signal. Disclosure then is good by me.\n\nThanks,\nJack","markdown_message":"\u003cp\u003eHi \u003ca href=\"/paragonie-scott\"\u003e@paragonie-scott\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eI agree that this isn\u0026#39;t much of issue. If you change this report from \u003ccode\u003etriaged\u003c/code\u003e to \u003ccode\u003enew\u003c/code\u003e, I can self close this as N/A to not impact my signal. Disclosure then is good by me.\u003c/p\u003e\n\n\u003cp\u003eThanks,\u003cbr\u003e\nJack\u003c/p\u003e\n","automated_response":false,"created_at":"2018-04-20T18:03:05.445Z","updated_at":"2018-04-20T18:03:05.445Z","actor":{"username":"cablej","cleared":true,"url":"/cablej","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/042/859/7fdafea90092a305ae2cb6cec7d43461783abf0c_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"paragonie","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2648559,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"","markdown_message":"","automated_response":false,"created_at":"2018-04-20T18:05:42.512Z","updated_at":"2018-04-20T18:05:42.512Z","actor":{"username":"paragonie-scott","cleared":false,"url":"/paragonie-scott","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/051/441/089de22b2f1b80a1e57a2792318dede5cbad81db_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"paragonie","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2648562,"is_internal":false,"editable":false,"type":"Activities::BugNotApplicable","message":"","markdown_message":"","automated_response":false,"created_at":"2018-04-20T18:06:35.948Z","updated_at":"2018-04-20T18:06:35.948Z","actor":{"username":"cablej","cleared":true,"url":"/cablej","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/042/859/7fdafea90092a305ae2cb6cec7d43461783abf0c_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"paragonie","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2648564,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-04-20T18:06:40.284Z","updated_at":"2018-04-20T18:06:40.284Z","first_to_agree":true,"actor":{"username":"cablej","cleared":true,"url":"/cablej","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/042/859/7fdafea90092a305ae2cb6cec7d43461783abf0c_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"paragonie","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2648565,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-04-20T18:07:09.839Z","updated_at":"2018-04-20T18:07:09.839Z","actor":{"username":"paragonie-scott","cleared":false,"url":"/paragonie-scott","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/051/441/089de22b2f1b80a1e57a2792318dede5cbad81db_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"paragonie","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2648566,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-04-20T18:07:09.892Z","updated_at":"2018-04-20T18:07:09.892Z","actor":{"username":"paragonie-scott","cleared":false,"url":"/paragonie-scott","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/051/441/089de22b2f1b80a1e57a2792318dede5cbad81db_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"paragonie","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}