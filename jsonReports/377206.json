{"id":377206,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zNzcyMDY=","url":"https://hackerone.com/reports/377206","title":"`settingcontent-ms` files lacks \"mark of the web\" =\u003e execute code by dbl click in Downloads toolbar","state":"Closed","substate":"informative","severity_rating":"low","readable_substate":"Informative","created_at":"2018-07-04T19:36:14.482Z","submitted_at":"2018-07-04T19:36:14.482Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"metnew","url":"/metnew","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":15688,"url":"https://hackerone.com/brave","handle":"brave","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/015/688/2aad5641af643ee4f4402896e4747293f6e9c5ca_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/688/2aad5641af643ee4f4402896e4747293f6e9c5ca_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Brave Software","twitter_handle":"brave","website":"https://brave.com","about":""}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2018-10-04T00:52:46.884Z","bug_reporter_agreed_on_going_public_at":"2018-07-23T13:57:11.914Z","team_member_agreed_on_going_public_at":"2018-10-04T00:52:46.618Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"## Summary:\n\n`settingcontent-ms` files allow launching any binary with any params.\nBrave doesn't mark `settingcontent-ms` files with \"mark of the web\", so the file could be executed by double click in \"Downloads\" toolbar. Launched `settingcontent-ms` file could lead to code execution with user-level privileges. \n\n## Products affected: \nBrave: 0.23.19\nMuon: 7.1.3\nOS: 10.0.17134 (the image was downloaded today from the MS virtualbox images page)\nChromium: 67.0.3396\n\n## Steps To Reproduce:\n\n1. Download `twitter.settingcontent-ms` from attachments.\n2. Dbl click on the item in \"Downloads\" toolbar.\n3. Calculator opens (but as I said, it's possible to launch anything).\n\nPoC/Screencast additionally leverages #375259.\n\n## Supporting Material/References:\n\n1. FF patched this somewhere between 60-62 version\n2. This bug still works in Edge. As far as I know, that's 1-day.\n3. Chrome downloads `settingcontent-ms` files only after a confirmation from the user.\n4. This problem is already popular, so you could easily find more info.\n\nPoC + screencast attached.\n[Live PoC:](https://win-settingcontent-ms-uosardvltp.now.sh)  (not sure that it works, it'd be better to test it locally)\n\n## Impact\n\nLaunched `settingcontent-ms` could lead to code execution with user-level privileges. \nMarked as \"high\", because it's a native OS feature, all Win users are affected.","vulnerability_information_html":"\u003ch2 id=\"summary\"\u003eSummary:\u003c/h2\u003e\n\n\u003cp\u003e\u003ccode\u003esettingcontent-ms\u003c/code\u003e files allow launching any binary with any params.\u003cbr\u003e\nBrave doesn\u0026#39;t mark \u003ccode\u003esettingcontent-ms\u003c/code\u003e files with \u0026quot;mark of the web\u0026quot;, so the file could be executed by double click in \u0026quot;Downloads\u0026quot; toolbar. Launched \u003ccode\u003esettingcontent-ms\u003c/code\u003e file could lead to code execution with user-level privileges. \u003c/p\u003e\n\n\u003ch2 id=\"products-affected\"\u003eProducts affected:\u003c/h2\u003e\n\n\u003cp\u003eBrave: 0.23.19\u003cbr\u003e\nMuon: 7.1.3\u003cbr\u003e\nOS: 10.0.17134 (the image was downloaded today from the MS virtualbox images page)\u003cbr\u003e\nChromium: 67.0.3396\u003c/p\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps To Reproduce:\u003c/h2\u003e\n\n\u003col\u003e\n\u003cli\u003eDownload \u003ccode\u003etwitter.settingcontent-ms\u003c/code\u003e from attachments.\u003c/li\u003e\n\u003cli\u003eDbl click on the item in \u0026quot;Downloads\u0026quot; toolbar.\u003c/li\u003e\n\u003cli\u003eCalculator opens (but as I said, it\u0026#39;s possible to launch anything).\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003ePoC/Screencast additionally leverages \u003ca href=\"/reports/375259\"\u003e#375259\u003c/a\u003e.\u003c/p\u003e\n\n\u003ch2 id=\"supporting-material-references\"\u003eSupporting Material/References:\u003c/h2\u003e\n\n\u003col\u003e\n\u003cli\u003eFF patched this somewhere between 60-62 version\u003c/li\u003e\n\u003cli\u003eThis bug still works in Edge. As far as I know, that\u0026#39;s 1-day.\u003c/li\u003e\n\u003cli\u003eChrome downloads \u003ccode\u003esettingcontent-ms\u003c/code\u003e files only after a confirmation from the user.\u003c/li\u003e\n\u003cli\u003eThis problem is already popular, so you could easily find more info.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003ePoC + screencast attached.\u003cbr\u003e\n\u003ca href=\"/redirect?url=https%3A%2F%2Fwin-settingcontent-ms-uosardvltp.now.sh\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eLive PoC:\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e  (not sure that it works, it\u0026#39;d be better to test it locally)\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eLaunched \u003ccode\u003esettingcontent-ms\u003c/code\u003e could lead to code execution with user-level privileges. \u003cbr\u003e\nMarked as \u0026quot;high\u0026quot;, because it\u0026#39;s a native OS feature, all Win users are affected.\u003c/p\u003e\n","original_report_id":null,"original_report_url":null,"attachments":[{"id":315720,"file_name":"exploit.html","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/315/720/2a0478214bca544ce61ccd307b23cc6042fe23d8/exploit.html?response-content-disposition=attachment%3B%20filename%3D%22exploit.html%22%3B%20filename%2A%3DUTF-8%27%27exploit.html\u0026response-content-type=application%2Foctet-stream\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQWS7SVX5C%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T054607Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCICTltBX5kZS78yzw3IUUt%2Fa035OzgQ2vLu8U1ZxOKGilAiEAqT8jxmclsgLwaEL5fi7C70iqLwP7J3SWF5ypfn%2Fn%2BdUqtAMIVBABGgwwMTM2MTkyNzQ4NDkiDGRWkSc4Hmgq8mMXKCqRA0Pq%2Bzgh6dptjyRB4GzYO9sir45RVm0RyvFSB8lDBYTBiDIVL0nR3Ah5epkHqGDZZEh0G%2BfKYu%2FWpfgxJl7qllLzKg%2BOA0izVs9KPgQdxk0VWwW%2FPKL2ZT4v%2FSNRvF7rPUbZ7WhGTZqx0%2BinzKM%2BO6lDyXZKNKMzhjRnIFdI7Th01c4ma39imTXQDmxc%2FNzHFK40lrkAbTZoTlcq%2BsnIcIRSB0h4GHasXhR5OHx8rifULR7sVKHDcZMCzSYjrtagaKs9I81LEzlSbEGxIQar2MK%2BZBwmpT57aT%2F1nIOoa%2FlH5nfP4Ihcv4Mqfp19pFx8mlVoMe%2FTEx0pqNuC4lGQXowSDJKBcSjrYM6ouddZWfwY6R4O8X69XqZawGSrmBiXyAVG%2BDj895xbDJhiOXMvqkvSfsEzIfvcaHAzshzNZjFT3yiN4h81wfUF3QuLc6DHCTt1MPDYiUB8I7UCQ8wJxW4pg3xTnHqSwUeqww3YY8RFfsgvfp9PzGJ1s4vReFrzuzYVanpT22oz4w33z29yMPmMMO21qv8FOusBOsYr4rmEPt9wYTc2WNI63vM9u2VUhGNHafH2%2Fh3q6i%2BwJ0u2HLCQd44aqHfWZ%2Bc8hzInEQnRNrZf7owYuE4cHiraWaOsNJjfOEJBZu5nzzun4JSk7801NfOqa1zcgLMWOwyWJCtalb9fGn6qhwTWTBMzsOFHc661yyW%2FaqejCIRf6%2BwNOGhO8kc%2BEhEIq0iydp5k4rlMRKlFJPFlphrQYGeZgYr9TM%2FVgHlN%2Bx4Oxtcg1UwCGXMGiV%2BqXzeMEmO%2FdxKETdJJvF%2BEaJSsF0r1i7s8g61czrgyi9MKMpia%2Fg6ovVFkrvHOejV96g%3D%3D\u0026X-Amz-Signature=e2deeb1b18da00d17c62704cb3812e28084475a1ee7e0efdb7d4e5cc7e2bac56","file_size":359,"type":"text/html"},{"id":315721,"file_name":"twitter.settingcontent-ms","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/315/721/5a4e57eb152656609c6826bc7a6fbf5e0b923f6b/twitter.settingcontent-ms?response-content-disposition=attachment%3B%20filename%3D%22twitter.settingcontent-ms%22%3B%20filename%2A%3DUTF-8%27%27twitter.settingcontent-ms\u0026response-content-type=application%2Foctet-stream\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQWS7SVX5C%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T054607Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCICTltBX5kZS78yzw3IUUt%2Fa035OzgQ2vLu8U1ZxOKGilAiEAqT8jxmclsgLwaEL5fi7C70iqLwP7J3SWF5ypfn%2Fn%2BdUqtAMIVBABGgwwMTM2MTkyNzQ4NDkiDGRWkSc4Hmgq8mMXKCqRA0Pq%2Bzgh6dptjyRB4GzYO9sir45RVm0RyvFSB8lDBYTBiDIVL0nR3Ah5epkHqGDZZEh0G%2BfKYu%2FWpfgxJl7qllLzKg%2BOA0izVs9KPgQdxk0VWwW%2FPKL2ZT4v%2FSNRvF7rPUbZ7WhGTZqx0%2BinzKM%2BO6lDyXZKNKMzhjRnIFdI7Th01c4ma39imTXQDmxc%2FNzHFK40lrkAbTZoTlcq%2BsnIcIRSB0h4GHasXhR5OHx8rifULR7sVKHDcZMCzSYjrtagaKs9I81LEzlSbEGxIQar2MK%2BZBwmpT57aT%2F1nIOoa%2FlH5nfP4Ihcv4Mqfp19pFx8mlVoMe%2FTEx0pqNuC4lGQXowSDJKBcSjrYM6ouddZWfwY6R4O8X69XqZawGSrmBiXyAVG%2BDj895xbDJhiOXMvqkvSfsEzIfvcaHAzshzNZjFT3yiN4h81wfUF3QuLc6DHCTt1MPDYiUB8I7UCQ8wJxW4pg3xTnHqSwUeqww3YY8RFfsgvfp9PzGJ1s4vReFrzuzYVanpT22oz4w33z29yMPmMMO21qv8FOusBOsYr4rmEPt9wYTc2WNI63vM9u2VUhGNHafH2%2Fh3q6i%2BwJ0u2HLCQd44aqHfWZ%2Bc8hzInEQnRNrZf7owYuE4cHiraWaOsNJjfOEJBZu5nzzun4JSk7801NfOqa1zcgLMWOwyWJCtalb9fGn6qhwTWTBMzsOFHc661yyW%2FaqejCIRf6%2BwNOGhO8kc%2BEhEIq0iydp5k4rlMRKlFJPFlphrQYGeZgYr9TM%2FVgHlN%2Bx4Oxtcg1UwCGXMGiV%2BqXzeMEmO%2FdxKETdJJvF%2BEaJSsF0r1i7s8g61czrgyi9MKMpia%2Fg6ovVFkrvHOejV96g%3D%3D\u0026X-Amz-Signature=3fcd3e5cc972125dad288dd43470f0e2af895cd066f20906743c76f85ba8cf28","file_size":699,"type":"application/xml"},{"id":315725,"file_name":"brave-win-settingcontent-ms.mp4","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/315/725/326f3a34e162aea972aacaf91c049b1de4e97be0/brave-win-settingcontent-ms.mp4?response-content-disposition=attachment%3B%20filename%3D%22brave-win-settingcontent-ms.mp4%22%3B%20filename%2A%3DUTF-8%27%27brave-win-settingcontent-ms.mp4\u0026response-content-type=video%2Fmp4\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQWS7SVX5C%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T054607Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCICTltBX5kZS78yzw3IUUt%2Fa035OzgQ2vLu8U1ZxOKGilAiEAqT8jxmclsgLwaEL5fi7C70iqLwP7J3SWF5ypfn%2Fn%2BdUqtAMIVBABGgwwMTM2MTkyNzQ4NDkiDGRWkSc4Hmgq8mMXKCqRA0Pq%2Bzgh6dptjyRB4GzYO9sir45RVm0RyvFSB8lDBYTBiDIVL0nR3Ah5epkHqGDZZEh0G%2BfKYu%2FWpfgxJl7qllLzKg%2BOA0izVs9KPgQdxk0VWwW%2FPKL2ZT4v%2FSNRvF7rPUbZ7WhGTZqx0%2BinzKM%2BO6lDyXZKNKMzhjRnIFdI7Th01c4ma39imTXQDmxc%2FNzHFK40lrkAbTZoTlcq%2BsnIcIRSB0h4GHasXhR5OHx8rifULR7sVKHDcZMCzSYjrtagaKs9I81LEzlSbEGxIQar2MK%2BZBwmpT57aT%2F1nIOoa%2FlH5nfP4Ihcv4Mqfp19pFx8mlVoMe%2FTEx0pqNuC4lGQXowSDJKBcSjrYM6ouddZWfwY6R4O8X69XqZawGSrmBiXyAVG%2BDj895xbDJhiOXMvqkvSfsEzIfvcaHAzshzNZjFT3yiN4h81wfUF3QuLc6DHCTt1MPDYiUB8I7UCQ8wJxW4pg3xTnHqSwUeqww3YY8RFfsgvfp9PzGJ1s4vReFrzuzYVanpT22oz4w33z29yMPmMMO21qv8FOusBOsYr4rmEPt9wYTc2WNI63vM9u2VUhGNHafH2%2Fh3q6i%2BwJ0u2HLCQd44aqHfWZ%2Bc8hzInEQnRNrZf7owYuE4cHiraWaOsNJjfOEJBZu5nzzun4JSk7801NfOqa1zcgLMWOwyWJCtalb9fGn6qhwTWTBMzsOFHc661yyW%2FaqejCIRf6%2BwNOGhO8kc%2BEhEIq0iydp5k4rlMRKlFJPFlphrQYGeZgYr9TM%2FVgHlN%2Bx4Oxtcg1UwCGXMGiV%2BqXzeMEmO%2FdxKETdJJvF%2BEaJSsF0r1i7s8g61czrgyi9MKMpia%2Fg6ovVFkrvHOejV96g%3D%3D\u0026X-Amz-Signature=1b6fc2e3ef84d9fe702a73a171d16f1ad68c52a3e5ab0609945d52f2740b0a13","file_size":242065,"type":"video/mp4"}],"allow_singular_disclosure_at":null,"vote_count":5,"voters":["sameerphad72","mygf","tungpun","eveeez","0x08"],"severity":{"rating":"low","author_type":"Team"},"structured_scope":{"databaseId":7941,"asset_type":"SOURCE_CODE","asset_identifier":"https://github.com/brave/muon","max_severity":"none"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":2994928,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@metnew could you clarify this part: \"Chrome downloads settingcontent-ms files only after a confirmation from the user.\"\n\nI tested downloading the file (by clicking the twitter link in exploit.html) in Chrome and it didn't show any confirmation unless I had the \"Ask where to save each file\" setting enabled in chrome://settings/. Whereas Brave always showed a confirmation dialog before downloading regardless of whether the same setting was enabled in about:preferences.","markdown_message":"\u003cp\u003e\u003ca href=\"/metnew\"\u003e@metnew\u003c/a\u003e could you clarify this part: \u0026quot;Chrome downloads settingcontent-ms files only after a confirmation from the user.\u0026quot;\u003c/p\u003e\n\n\u003cp\u003eI tested downloading the file (by clicking the twitter link in exploit.html) in Chrome and it didn\u0026#39;t show any confirmation unless I had the \u0026quot;Ask where to save each file\u0026quot; setting enabled in chrome://settings/. Whereas Brave always showed a confirmation dialog before downloading regardless of whether the same setting was enabled in about:preferences.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-07-05T18:33:24.419Z","updated_at":"2018-07-05T18:33:24.419Z","actor":{"username":"diracdeltas","cleared":false,"url":"/diracdeltas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/115/616/4e2016543ea3e299dcadd088be7d0225de3419e0_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2996610,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@diracdeltas Yeah, sure\n\n## FF\n@qab [posted on Twitter](https://twitter.com/Qab/status/1011643615125352449) that he found an RCE in FF: extension with `downloads.open` + `settingcontent-ms` file. [Link to the CVE](https://www.mozilla.org/en-US/security/advisories/mfsa2018-16/#CVE-2018-12368)\n\n## Edge\nThe problem with `settingcontent-ms` is popular, so I assume, MS know about that. \n\u003e If you've got any info whether it's 0day/1day/WAI, it'd be important for me.\n\n## Chrome\n\nAs you know, Chrome has SafeBrowsing service. SafeBrowsing isn't only server-side. Chrome also has client-side service to check downloaded files. Client-side SafeBrowsing checks dangerous file extensions + unpack archives and disk images with popular extensions - `.zip/.rar/.dmg` (to send metadata from files inside the downloaded archive to server-side SafeBrowsing).\n\nClient-side SafeBrowsing detects dangerous files based on [this list](https://cs.chromium.org/chromium/src/chrome/browser/resources/safe_browsing/download_file_types.asciipb?l=2170-2171). Chrome tracks most dangerous/popular file extensions, and any file extension from this list has `danger_level`. A user can't download a file which `danger_level` is `ALLOW_ON_USER_GESTURE` or `DANGEROUS` without confirmation.\n\nHowever, there are some files that are dangerous only for specific OS: like `.shar` for Linux, `.applescript` for Mac, and `settingcontent-ms` for Win.  These files require confirmation depending on user's OS. (check `platform_settings` in the list above)\n\nThe reason, why you don't see any warnings is probably simple. Maybe, you downloaded `.settingcontent-ms` file on macOS ?)\n\n## Brave\n\nI tested all extensions on Brave, and looks like Brave doesn't track also:\n1. `.msi` (not interesting, requires user interaction) \n2. `.jar` on Win (in addition to #374106, because #374106 is about macOS only)\n3.  `.com/.cmd/.bat` - shell scripts, dangerous. Probably, Windows Defender Center will block execution of these files. That also makes `settingcontent-ms` files more dangerous, because they're not blocked by default defender.\n\n-------- \nI'm not an expert in Win internals, but from my experience, applications mark files as executables downloaded from the web based on their lists (that's why I reported this issue). macOS has GateKeeper, that's why I submitted #374106.","markdown_message":"\u003cp\u003e\u003ca href=\"/diracdeltas\"\u003e@diracdeltas\u003c/a\u003e Yeah, sure\u003c/p\u003e\n\n\u003ch2 id=\"ff\"\u003eFF\u003c/h2\u003e\n\n\u003cp\u003e\u003ca href=\"/qab\"\u003e@qab\u003c/a\u003e \u003ca href=\"/redirect?url=https%3A%2F%2Ftwitter.com%2FQab%2Fstatus%2F1011643615125352449\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eposted on Twitter\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e that he found an RCE in FF: extension with \u003ccode\u003edownloads.open\u003c/code\u003e + \u003ccode\u003esettingcontent-ms\u003c/code\u003e file. \u003ca href=\"/redirect?url=https%3A%2F%2Fwww.mozilla.org%2Fen-US%2Fsecurity%2Fadvisories%2Fmfsa2018-16%2F%23CVE-2018-12368\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eLink to the CVE\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2 id=\"edge\"\u003eEdge\u003c/h2\u003e\n\n\u003cp\u003eThe problem with \u003ccode\u003esettingcontent-ms\u003c/code\u003e is popular, so I assume, MS know about that. \u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eIf you\u0026#39;ve got any info whether it\u0026#39;s 0day/1day/WAI, it\u0026#39;d be important for me.\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003ch2 id=\"chrome\"\u003eChrome\u003c/h2\u003e\n\n\u003cp\u003eAs you know, Chrome has SafeBrowsing service. SafeBrowsing isn\u0026#39;t only server-side. Chrome also has client-side service to check downloaded files. Client-side SafeBrowsing checks dangerous file extensions + unpack archives and disk images with popular extensions - \u003ccode\u003e.zip/.rar/.dmg\u003c/code\u003e (to send metadata from files inside the downloaded archive to server-side SafeBrowsing).\u003c/p\u003e\n\n\u003cp\u003eClient-side SafeBrowsing detects dangerous files based on \u003ca href=\"/redirect?url=https%3A%2F%2Fcs.chromium.org%2Fchromium%2Fsrc%2Fchrome%2Fbrowser%2Fresources%2Fsafe_browsing%2Fdownload_file_types.asciipb%3Fl%3D2170-2171\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ethis list\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e. Chrome tracks most dangerous/popular file extensions, and any file extension from this list has \u003ccode\u003edanger_level\u003c/code\u003e. A user can\u0026#39;t download a file which \u003ccode\u003edanger_level\u003c/code\u003e is \u003ccode\u003eALLOW_ON_USER_GESTURE\u003c/code\u003e or \u003ccode\u003eDANGEROUS\u003c/code\u003e without confirmation.\u003c/p\u003e\n\n\u003cp\u003eHowever, there are some files that are dangerous only for specific OS: like \u003ccode\u003e.shar\u003c/code\u003e for Linux, \u003ccode\u003e.applescript\u003c/code\u003e for Mac, and \u003ccode\u003esettingcontent-ms\u003c/code\u003e for Win.  These files require confirmation depending on user\u0026#39;s OS. (check \u003ccode\u003eplatform_settings\u003c/code\u003e in the list above)\u003c/p\u003e\n\n\u003cp\u003eThe reason, why you don\u0026#39;t see any warnings is probably simple. Maybe, you downloaded \u003ccode\u003e.settingcontent-ms\u003c/code\u003e file on macOS ?)\u003c/p\u003e\n\n\u003ch2 id=\"brave\"\u003eBrave\u003c/h2\u003e\n\n\u003cp\u003eI tested all extensions on Brave, and looks like Brave doesn\u0026#39;t track also:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003e\n\u003ccode\u003e.msi\u003c/code\u003e (not interesting, requires user interaction) \u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003e.jar\u003c/code\u003e on Win (in addition to \u003ca href=\"/reports/374106\"\u003e#374106\u003c/a\u003e, because \u003ca href=\"/reports/374106\"\u003e#374106\u003c/a\u003e is about macOS only)\u003c/li\u003e\n\u003cli\u003e \u003ccode\u003e.com/.cmd/.bat\u003c/code\u003e - shell scripts, dangerous. Probably, Windows Defender Center will block execution of these files. That also makes \u003ccode\u003esettingcontent-ms\u003c/code\u003e files more dangerous, because they\u0026#39;re not blocked by default defender.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003chr\u003e\n\n\u003cp\u003eI\u0026#39;m not an expert in Win internals, but from my experience, applications mark files as executables downloaded from the web based on their lists (that\u0026#39;s why I reported this issue). macOS has GateKeeper, that\u0026#39;s why I submitted \u003ca href=\"/reports/374106\"\u003e#374106\u003c/a\u003e.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-07-05T23:20:55.697Z","updated_at":"2018-07-05T23:20:55.697Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2996673,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Also, why I marked this \"High\":\n1. no warning for `settingcontent-ms`\n2. leveraging #375259 makes the attack scenario more dangerous + could be actively used\n3. the attack scenario is reliable and doesn't need too much effort from the attacker\n\n\u003e Anywhere, severity is the subject to discussion in such cases.","markdown_message":"\u003cp\u003eAlso, why I marked this \u0026quot;High\u0026quot;:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eno warning for \u003ccode\u003esettingcontent-ms\u003c/code\u003e\n\u003c/li\u003e\n\u003cli\u003eleveraging \u003ca href=\"/reports/375259\"\u003e#375259\u003c/a\u003e makes the attack scenario more dangerous + could be actively used\u003c/li\u003e\n\u003cli\u003ethe attack scenario is reliable and doesn\u0026#39;t need too much effort from the attacker\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eAnywhere, severity is the subject to discussion in such cases.\u003c/p\u003e\n\u003c/blockquote\u003e\n","automated_response":false,"created_at":"2018-07-05T23:33:45.812Z","updated_at":"2018-07-05T23:33:45.812Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2999080,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@diracdeltas  Also, make sure you're not downloading `.settingcontent-ms` files from a whitelisted for SafeBrowsing host in Chrome. (e.g., if you use `localhost` often, try to download the file from `127.0.0.1` or similar)\n[Good post about `.settingcontent-ms`](https://posts.specterops.io/the-tale-of-settingcontent-ms-files-f1ea253e4d39)\n\n\u003e I could make a screencast if it's still doesn't work for you on Win","markdown_message":"\u003cp\u003e\u003ca href=\"/diracdeltas\"\u003e@diracdeltas\u003c/a\u003e  Also, make sure you\u0026#39;re not downloading \u003ccode\u003e.settingcontent-ms\u003c/code\u003e files from a whitelisted for SafeBrowsing host in Chrome. (e.g., if you use \u003ccode\u003elocalhost\u003c/code\u003e often, try to download the file from \u003ccode\u003e127.0.0.1\u003c/code\u003e or similar)\u003cbr\u003e\n\u003ca href=\"/redirect?url=https%3A%2F%2Fposts.specterops.io%2Fthe-tale-of-settingcontent-ms-files-f1ea253e4d39\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eGood post about \u003ccode\u003e.settingcontent-ms\u003c/code\u003e\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eI could make a screencast if it\u0026#39;s still doesn\u0026#39;t work for you on Win\u003c/p\u003e\n\u003c/blockquote\u003e\n","automated_response":false,"created_at":"2018-07-06T09:42:25.090Z","updated_at":"2018-07-06T09:45:29.369Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3003917,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Change file extension after downloading from attachments (it could be converted to `.xml`). \nFile should have `.settingcontent-ms` extension.","markdown_message":"\u003cp\u003eChange file extension after downloading from attachments (it could be converted to \u003ccode\u003e.xml\u003c/code\u003e). \u003cbr\u003e\nFile should have \u003ccode\u003e.settingcontent-ms\u003c/code\u003e extension.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-07-06T23:43:38.856Z","updated_at":"2018-07-06T23:43:38.856Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3013638,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"`deleted`","markdown_message":"\u003cp\u003e\u003ccode\u003edeleted\u003c/code\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2018-07-08T15:40:38.021Z","updated_at":"2018-07-08T15:46:22.055Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3013664,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"`deleted`","markdown_message":"\u003cp\u003e\u003ccode\u003edeleted\u003c/code\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2018-07-08T15:53:11.190Z","updated_at":"2018-07-08T16:00:26.752Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3013706,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"`deleted`\n","markdown_message":"\u003cp\u003e\u003ccode\u003edeleted\u003c/code\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2018-07-08T16:18:58.504Z","updated_at":"2018-07-08T16:24:07.551Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3032251,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2018-07-11T20:51:24.092Z","updated_at":"2018-07-11T20:51:24.092Z","additional_data":{"old_severity":"High","new_severity":"Low","old_severity_id":178808,"new_severity_id":182159},"actor":{"username":"toml","cleared":false,"url":"/toml","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/229/717/56ea9edd04176aa3f29b215291bbc0b656699f67_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3032389,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"Thanks for this report. The native safe browsing implementation in Brave does not provide warnings for every file type which can run native code. We only seek identify specific files which have previously been determined to be malicious. We're aware of the limitations of this approach, but don't plan to fix it within the current Muon-based Brave codebase.","markdown_message":"\u003cp\u003eThanks for this report. The native safe browsing implementation in Brave does not provide warnings for every file type which can run native code. We only seek identify specific files which have previously been determined to be malicious. We\u0026#39;re aware of the limitations of this approach, but don\u0026#39;t plan to fix it within the current Muon-based Brave codebase.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-07-11T21:45:50.553Z","updated_at":"2018-07-11T21:45:50.553Z","actor":{"username":"toml","cleared":false,"url":"/toml","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/229/717/56ea9edd04176aa3f29b215291bbc0b656699f67_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3084219,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-07-23T13:57:11.959Z","updated_at":"2018-07-23T13:57:11.959Z","first_to_agree":true,"actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3405815,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@toml Could we disclose this since it's \"Informative\"?","markdown_message":"\u003cp\u003e\u003ca href=\"/toml\"\u003e@toml\u003c/a\u003e Could we disclose this since it\u0026#39;s \u0026quot;Informative\u0026quot;?\u003c/p\u003e\n","automated_response":false,"created_at":"2018-09-29T11:29:26.183Z","updated_at":"2018-09-29T11:29:26.183Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3431829,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-10-04T00:52:46.681Z","updated_at":"2018-10-04T00:52:46.681Z","actor":{"username":"diracdeltas","cleared":false,"url":"/diracdeltas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/115/616/4e2016543ea3e299dcadd088be7d0225de3419e0_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3431830,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-10-04T00:52:46.906Z","updated_at":"2018-10-04T00:52:46.906Z","actor":{"username":"diracdeltas","cleared":false,"url":"/diracdeltas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/115/616/4e2016543ea3e299dcadd088be7d0225de3419e0_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}