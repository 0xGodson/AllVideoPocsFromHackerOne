{"id":667613,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC82Njc2MTM=","url":"https://hackerone.com/reports/667613","title":"Username Enumeration","state":"Closed","substate":"informative","severity_rating":"low","readable_substate":"Informative","created_at":"2019-08-05T13:42:42.335Z","submitted_at":"2019-08-05T13:42:42.335Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"ahpaleus","url":"/ahpaleus","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13291,"url":"https://hackerone.com/nextcloud","handle":"nextcloud","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Nextcloud","twitter_handle":"nextclouders","website":"https://nextcloud.com","about":"Access, share and protect your files, calendars, contacts, communication \u0026 more at home and in your enterprise."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2019-11-11T15:27:40.538Z","bug_reporter_agreed_on_going_public_at":"2019-08-06T05:41:57.694Z","team_member_agreed_on_going_public_at":"2019-11-11T15:27:40.477Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi, it is possible to determine the existence of a user account. It reveals username which can open new attack vectors.\n\nVersion: Nextcloud 16.0.3\n\nRequest for *existing* account:\n```\nGET /avatar/admin/80?v=-472 HTTP/1.1\nHost: localhost:8084\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.14; rv:68.0) Gecko/20100101 Firefox/68.0\nAccept: image/webp,*/*\nAccept-Language: pl,en-US;q=0.7,en;q=0.3\nAccept-Encoding: gzip, deflate\nConnection: close\n```\n\nResponse:\n```\nHTTP/1.1 201 Created\nDate: Mon, 05 Aug 2019 12:43:11 GMT\nServer: Apache/2.4.25 (Debian)\nX-Powered-By: PHP/7.3.7\nSet-Cookie: oce1t377r5iz=b19f9e53305ed1b27e1cf8e3a247208c; path=/; HttpOnly\nExpires: Mon, 05 Aug 2019 13:13:11 +0000\nCache-Control: max-age=1800, must-revalidate\nPragma: public\nSet-Cookie: oc_sessionPassphrase=TBaKNScbSUHcFfqtUUSk9opsYsCC5CjhTXspeP35sujzHmmyVisl7GQpQ6Yngg%2FwEUrD3aLUwgxdKqn9sUnwVRXtXwE9QsYom3iCnncIHDpRSOELfutM%2FhobasmvfxpJ; path=/; HttpOnly\nContent-Security-Policy: default-src 'none';base-uri 'none';manifest-src 'self';script-src 'nonce-Q3FHKzg2MytoV0pEZnZ0VVBidUplSW53RG1ISXpIUmQvNW82ZnhBN1Izdz06YmU3d3c4R3d5UlVxVVpNblIvYkFOZWZEUVFyeHFqZ01wZmxSQno5Q0tCQT0=';style-src 'self' 'unsafe-inline';img-src 'self' data: blob:;font-src 'self' data:;connect-src 'self';media-src 'self';frame-ancestors 'self';worker-src 'self' blob:\nX-Frame-Options: SAMEORIGIN\nX-XSS-Protection: 1; mode=block\nX-Content-Type-Options: nosniff\nX-Robots-Tag: none\nX-Download-Options: noopen\nX-Permitted-Cross-Domain-Policies: none\nReferrer-Policy: no-referrer\nSet-Cookie: nc_sameSiteCookielax=true; path=/; httponly;expires=Fri, 31-Dec-2100 23:59:59 GMT; SameSite=lax\nSet-Cookie: nc_sameSiteCookiestrict=true; path=/; httponly;expires=Fri, 31-Dec-2100 23:59:59 GMT; SameSite=strict\nLast-Modified: Mon, 05 Aug 2019 12:42:57 +0000\nETag: \"a684d35e3573baabbab61c6decb7ca27\"\nContent-Disposition: inline; filename=\"avatar.80.png\"\nContent-Length: 1036\nConnection: close\nContent-Type: image/png\n\nPNG\n(...)\n```\n\n\nRequest for *non-existent* account:\n```\nGET /avatar/admin1/80?v=-472 HTTP/1.1\nHost: localhost:8084\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.14; rv:68.0) Gecko/20100101 Firefox/68.0\nAccept: image/webp,*/*\nAccept-Language: pl,en-US;q=0.7,en;q=0.3\nAccept-Encoding: gzip, deflate\nConnection: close\n```\n\nResponse:\n```\nHTTP/1.1 404 Not Found\nDate: Mon, 05 Aug 2019 13:29:45 GMT\nServer: Apache/2.4.25 (Debian)\nX-Powered-By: PHP/7.3.7\nSet-Cookie: oce1t377r5iz=cda3160542ce283068e73ed16542d5ab; path=/; HttpOnly\nExpires: Thu, 19 Nov 1981 08:52:00 GMT\nCache-Control: no-cache, no-store, must-revalidate\nPragma: no-cache\nSet-Cookie: oc_sessionPassphrase=DI98NE8f%2BG9wkqaUyWpumnB8VYIWb%2BD2qFyDIOz0xiBvryxhwcI6IEmHFDLCpdOYbOZWLuHu5tnYzPGi1I6XS8%2FJv2dyJTanfFrWouSlMGZKpex8gy78Hgg7r%2B02ZDHi; path=/; HttpOnly\nContent-Security-Policy: default-src 'none';base-uri 'none';manifest-src 'self';script-src 'nonce-cXJJUWhCc25YRHBXV3ZHTThkMVFVZU5IMVdXd2NVbVM0cE1ucXlWUHpCcz06MFBwSzgxSmhEVnRrYlpubXNLUUVLSUVNNVZmVVAzL2RzdndUM1VFN2kzST0=';style-src 'self' 'unsafe-inline';img-src 'self' data: blob:;font-src 'self' data:;connect-src 'self';media-src 'self';frame-ancestors 'self';worker-src 'self' blob:\nX-Frame-Options: SAMEORIGIN\nX-XSS-Protection: 1; mode=block\nX-Content-Type-Options: nosniff\nX-Robots-Tag: none\nX-Download-Options: noopen\nX-Permitted-Cross-Domain-Policies: none\nReferrer-Policy: no-referrer\nSet-Cookie: nc_sameSiteCookielax=true; path=/; httponly;expires=Fri, 31-Dec-2100 23:59:59 GMT; SameSite=lax\nSet-Cookie: nc_sameSiteCookiestrict=true; path=/; httponly;expires=Fri, 31-Dec-2100 23:59:59 GMT; SameSite=strict\nContent-Length: 0\nConnection: close\nContent-Type: text/html; charset=UTF-8\n```\n\n## Impact\n\nInformation disclosure which opens new attack vectors - helpful for injections/brute-force attacks/social-engineering etc.","vulnerability_information_html":"\u003cp\u003eHi, it is possible to determine the existence of a user account. It reveals username which can open new attack vectors.\u003c/p\u003e\n\n\u003cp\u003eVersion: Nextcloud 16.0.3\u003c/p\u003e\n\n\u003cp\u003eRequest for \u003cem\u003eexisting\u003c/em\u003e account:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eGET /avatar/admin/80?v=-472 HTTP/1.1\nHost: localhost:8084\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.14; rv:68.0) Gecko/20100101 Firefox/68.0\nAccept: image/webp,*/*\nAccept-Language: pl,en-US;q=0.7,en;q=0.3\nAccept-Encoding: gzip, deflate\nConnection: close\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eResponse:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eHTTP/1.1 201 Created\nDate: Mon, 05 Aug 2019 12:43:11 GMT\nServer: Apache/2.4.25 (Debian)\nX-Powered-By: PHP/7.3.7\nSet-Cookie: oce1t377r5iz=b19f9e53305ed1b27e1cf8e3a247208c; path=/; HttpOnly\nExpires: Mon, 05 Aug 2019 13:13:11 +0000\nCache-Control: max-age=1800, must-revalidate\nPragma: public\nSet-Cookie: oc_sessionPassphrase=TBaKNScbSUHcFfqtUUSk9opsYsCC5CjhTXspeP35sujzHmmyVisl7GQpQ6Yngg%2FwEUrD3aLUwgxdKqn9sUnwVRXtXwE9QsYom3iCnncIHDpRSOELfutM%2FhobasmvfxpJ; path=/; HttpOnly\nContent-Security-Policy: default-src \u0026#39;none\u0026#39;;base-uri \u0026#39;none\u0026#39;;manifest-src \u0026#39;self\u0026#39;;script-src \u0026#39;nonce-Q3FHKzg2MytoV0pEZnZ0VVBidUplSW53RG1ISXpIUmQvNW82ZnhBN1Izdz06YmU3d3c4R3d5UlVxVVpNblIvYkFOZWZEUVFyeHFqZ01wZmxSQno5Q0tCQT0=\u0026#39;;style-src \u0026#39;self\u0026#39; \u0026#39;unsafe-inline\u0026#39;;img-src \u0026#39;self\u0026#39; data: blob:;font-src \u0026#39;self\u0026#39; data:;connect-src \u0026#39;self\u0026#39;;media-src \u0026#39;self\u0026#39;;frame-ancestors \u0026#39;self\u0026#39;;worker-src \u0026#39;self\u0026#39; blob:\nX-Frame-Options: SAMEORIGIN\nX-XSS-Protection: 1; mode=block\nX-Content-Type-Options: nosniff\nX-Robots-Tag: none\nX-Download-Options: noopen\nX-Permitted-Cross-Domain-Policies: none\nReferrer-Policy: no-referrer\nSet-Cookie: nc_sameSiteCookielax=true; path=/; httponly;expires=Fri, 31-Dec-2100 23:59:59 GMT; SameSite=lax\nSet-Cookie: nc_sameSiteCookiestrict=true; path=/; httponly;expires=Fri, 31-Dec-2100 23:59:59 GMT; SameSite=strict\nLast-Modified: Mon, 05 Aug 2019 12:42:57 +0000\nETag: \u0026quot;a684d35e3573baabbab61c6decb7ca27\u0026quot;\nContent-Disposition: inline; filename=\u0026quot;avatar.80.png\u0026quot;\nContent-Length: 1036\nConnection: close\nContent-Type: image/png\n\nPNG\n(...)\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eRequest for \u003cem\u003enon-existent\u003c/em\u003e account:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eGET /avatar/admin1/80?v=-472 HTTP/1.1\nHost: localhost:8084\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.14; rv:68.0) Gecko/20100101 Firefox/68.0\nAccept: image/webp,*/*\nAccept-Language: pl,en-US;q=0.7,en;q=0.3\nAccept-Encoding: gzip, deflate\nConnection: close\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eResponse:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eHTTP/1.1 404 Not Found\nDate: Mon, 05 Aug 2019 13:29:45 GMT\nServer: Apache/2.4.25 (Debian)\nX-Powered-By: PHP/7.3.7\nSet-Cookie: oce1t377r5iz=cda3160542ce283068e73ed16542d5ab; path=/; HttpOnly\nExpires: Thu, 19 Nov 1981 08:52:00 GMT\nCache-Control: no-cache, no-store, must-revalidate\nPragma: no-cache\nSet-Cookie: oc_sessionPassphrase=DI98NE8f%2BG9wkqaUyWpumnB8VYIWb%2BD2qFyDIOz0xiBvryxhwcI6IEmHFDLCpdOYbOZWLuHu5tnYzPGi1I6XS8%2FJv2dyJTanfFrWouSlMGZKpex8gy78Hgg7r%2B02ZDHi; path=/; HttpOnly\nContent-Security-Policy: default-src \u0026#39;none\u0026#39;;base-uri \u0026#39;none\u0026#39;;manifest-src \u0026#39;self\u0026#39;;script-src \u0026#39;nonce-cXJJUWhCc25YRHBXV3ZHTThkMVFVZU5IMVdXd2NVbVM0cE1ucXlWUHpCcz06MFBwSzgxSmhEVnRrYlpubXNLUUVLSUVNNVZmVVAzL2RzdndUM1VFN2kzST0=\u0026#39;;style-src \u0026#39;self\u0026#39; \u0026#39;unsafe-inline\u0026#39;;img-src \u0026#39;self\u0026#39; data: blob:;font-src \u0026#39;self\u0026#39; data:;connect-src \u0026#39;self\u0026#39;;media-src \u0026#39;self\u0026#39;;frame-ancestors \u0026#39;self\u0026#39;;worker-src \u0026#39;self\u0026#39; blob:\nX-Frame-Options: SAMEORIGIN\nX-XSS-Protection: 1; mode=block\nX-Content-Type-Options: nosniff\nX-Robots-Tag: none\nX-Download-Options: noopen\nX-Permitted-Cross-Domain-Policies: none\nReferrer-Policy: no-referrer\nSet-Cookie: nc_sameSiteCookielax=true; path=/; httponly;expires=Fri, 31-Dec-2100 23:59:59 GMT; SameSite=lax\nSet-Cookie: nc_sameSiteCookiestrict=true; path=/; httponly;expires=Fri, 31-Dec-2100 23:59:59 GMT; SameSite=strict\nContent-Length: 0\nConnection: close\nContent-Type: text/html; charset=UTF-8\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eInformation disclosure which opens new attack vectors - helpful for injections/brute-force attacks/social-engineering etc.\u003c/p\u003e\n","weakness":{"id":18,"name":"Information Disclosure"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":0,"voters":[],"severity":{"rating":"low","author_type":"User"},"structured_scope":{"databaseId":13,"asset_type":"SOURCE_CODE","asset_identifier":"nextcloud/server","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":5503541,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks a lot for reporting this potential issue back to us!\n\nOur security team will take a look at this issue as soon as possible. We will reply to your report within 72 hours, usually much faster. For obvious reasons we'd like to ask you to not disclose this issue to any other party.","markdown_message":"\u003cp\u003eThanks a lot for reporting this potential issue back to us!\u003c/p\u003e\n\n\u003cp\u003eOur security team will take a look at this issue as soon as possible. We will reply to your report within 72 hours, usually much faster. For obvious reasons we\u0026#39;d like to ask you to not disclose this issue to any other party.\u003c/p\u003e\n","automated_response":true,"created_at":"2019-08-05T13:42:42.776Z","updated_at":"2019-08-05T13:42:42.776Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Nextcloud"}},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5506187,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"Thanks a lot for your report. Much appreciated!\nAs per our threat model at https://nextcloud.com/security/threat-model/ we consider user enumeration acceptable right now.\n\nWe'd like to encourage to keep hacking. We're looking forward to your next report!","markdown_message":"\u003cp\u003eThanks a lot for your report. Much appreciated!\u003cbr\u003e\nAs per our threat model at \u003ca title=\"https://nextcloud.com/security/threat-model/\" href=\"/redirect?url=https%3A%2F%2Fnextcloud.com%2Fsecurity%2Fthreat-model%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://nextcloud.com/security/threat-model/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e we consider user enumeration acceptable right now.\u003c/p\u003e\n\n\u003cp\u003eWe\u0026#39;d like to encourage to keep hacking. We\u0026#39;re looking forward to your next report!\u003c/p\u003e\n","automated_response":false,"created_at":"2019-08-05T19:18:27.071Z","updated_at":"2019-08-05T19:18:27.071Z","actor":{"username":"rullzer","cleared":false,"url":"/rullzer","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/086/005/20095c4a0c77c88375f8db5d6ed10f350d98a5a3_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5506189,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"","markdown_message":"","automated_response":false,"created_at":"2019-08-05T19:18:45.892Z","updated_at":"2019-08-05T19:18:45.892Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Nextcloud"}},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5508649,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-08-06T05:41:57.737Z","updated_at":"2019-08-06T05:41:57.737Z","first_to_agree":true,"actor":{"username":"ahpaleus","cleared":false,"url":"/ahpaleus","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6278307,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-11-11T15:27:40.494Z","updated_at":"2019-11-11T15:27:40.494Z","actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6278308,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-11-11T15:27:40.554Z","updated_at":"2019-11-11T15:27:40.554Z","actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}