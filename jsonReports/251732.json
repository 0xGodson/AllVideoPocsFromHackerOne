{"id":251732,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yNTE3MzI=","url":"https://hackerone.com/reports/251732","title":"uninitilized server memory disclosure via ImageMagick in my.mail.ru and cloud.mail.ru","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2017-07-20T16:29:26.634Z","submitted_at":"2017-07-20T16:29:26.634Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"neex","url":"/neex","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/014/987/69159fe64cb5f951b5b761f0d55ea5e8630a22a4_original.gif/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":65,"url":"https://hackerone.com/mailru","handle":"mailru","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/065/1ec04a6b87b02422d913b5c53d5247de91d64718_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/065/1ec04a6b87b02422d913b5c53d5247de91d64718_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Mail.ru","twitter_handle":"mailru","website":"https://corp.mail.ru","about":"Building the Internet since 1998"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"no-content","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-09-11T11:10:35.500Z","bug_reporter_agreed_on_going_public_at":"2017-09-09T07:48:21.570Z","team_member_agreed_on_going_public_at":"2017-09-11T11:10:35.449Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"","vulnerability_information_html":"","bounty_amount":"750.0","formatted_bounty":"$750","weakness":{"id":18,"name":"Information Disclosure"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2017-10-09T07:48:21.648Z","allow_singular_disclosure_after":-101683433.72306362,"singular_disclosure_allowed":true,"vote_count":22,"voters":["alexbirsan","jensec","secator","hunter","barracud4_","fa1rlight","cuso4","edoverflow","madrobot","mpz","and 12 more..."],"structured_scope":{"databaseId":270,"asset_type":"URL","asset_identifier":"cloud.mail.ru","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1853815,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2017-07-20T16:30:55.835Z","updated_at":"2017-07-20T16:30:55.835Z","additional_data":{},"actor":{"username":"neex","cleared":false,"url":"/neex","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/987/69159fe64cb5f951b5b761f0d55ea5e8630a22a4_original.gif/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1853823,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2017-07-20T16:34:42.012Z","updated_at":"2017-07-20T16:34:42.012Z","actor":{"username":"kpebetka","cleared":false,"url":"/kpebetka","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/152/f71d69995e3032fd2225ed83dd75c81e8158a865_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1868400,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2017-07-26T16:21:31.046Z","updated_at":"2017-07-26T16:21:31.046Z","actor":{"url":"/mailru","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/065/1ec04a6b87b02422d913b5c53d5247de91d64718_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Mail.ru"}},"bounty_amount":"750.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"mailru","collaborator":{"username":"neex","url":"/neex"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1868453,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2017-07-26T16:39:45.982Z","updated_at":"2017-07-26T16:39:45.982Z","actor":{"username":"yngwie","cleared":false,"url":"/yngwie","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/012/185/1b6bf6046f42c100e3793d87a8410bc07178fa8f_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1868528,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2017-07-26T17:20:06.893Z","updated_at":"2017-07-26T17:20:06.893Z","actor":{"username":"yngwie","cleared":false,"url":"/yngwie","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/012/185/1b6bf6046f42c100e3793d87a8410bc07178fa8f_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"neex","url":"/neex"},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1868543,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-07-26T17:25:05.014Z","updated_at":"2017-07-26T17:25:05.014Z","first_to_agree":true,"actor":{"username":"neex","cleared":false,"url":"/neex","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/987/69159fe64cb5f951b5b761f0d55ea5e8630a22a4_original.gif/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1870460,"is_internal":false,"editable":false,"type":"Activities::BugReopened","message":"","markdown_message":"","automated_response":false,"created_at":"2017-07-27T10:29:49.200Z","updated_at":"2017-07-27T10:29:49.200Z","actor":{"username":"valievkarim","cleared":false,"url":"/valievkarim","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/153/860a975b9fdb2c80f4c2f4cfda2388c043d450a0_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1888198,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2017-08-03T11:56:49.998Z","updated_at":"2017-08-03T11:56:49.998Z","actor":{"username":"3apa3a","cleared":false,"url":"/3apa3a","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/836/57b93fd96b524d0ed13eef717ecd070ad8468f86_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1933690,"is_internal":false,"editable":false,"type":"Activities::ChangedScope","message":"","markdown_message":"","automated_response":false,"created_at":"2017-08-16T15:51:31.338Z","updated_at":"2017-08-16T15:51:31.338Z","actor":{"username":"3apa3a","cleared":false,"url":"/3apa3a","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/836/57b93fd96b524d0ed13eef717ecd070ad8468f86_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"old_scope":"None","new_scope":"cloud.mail.ru","genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1984608,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2017-09-08T09:44:37.819Z","updated_at":"2017-09-08T09:44:37.819Z","actor":{"username":"kpebetka","cleared":false,"url":"/kpebetka","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/152/f71d69995e3032fd2225ed83dd75c81e8158a865_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"neex","url":"/neex"},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1986504,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-09-09T07:48:21.605Z","updated_at":"2017-09-09T07:48:21.605Z","first_to_agree":true,"actor":{"username":"neex","cleared":false,"url":"/neex","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/014/987/69159fe64cb5f951b5b761f0d55ea5e8630a22a4_original.gif/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1988649,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-09-11T11:10:35.472Z","updated_at":"2017-09-11T11:10:35.472Z","actor":{"username":"kpebetka","cleared":false,"url":"/kpebetka","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/152/f71d69995e3032fd2225ed83dd75c81e8158a865_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1988650,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-09-11T11:10:35.523Z","updated_at":"2017-09-11T11:10:35.523Z","actor":{"username":"kpebetka","cleared":false,"url":"/kpebetka","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/152/f71d69995e3032fd2225ed83dd75c81e8158a865_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":4893,"category":"team","content":"0-day Image Magic application / library vulnerability led to process's uninitialized memory region disclosure via converted image file. Region's address was not directly controlled by attacker.\n\nVulnerability was reported for 2 projects:\ncloud.mail.ru (is in bug bounty scope, but, as a mitigation factor, no sensitive data were found in a leaked memory region)\nmy.mail.ru (not in a bug bounty scope)\n","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003e0-day Image Magic application / library vulnerability led to process\u0026#39;s uninitialized memory region disclosure via converted image file. Region\u0026#39;s address was not directly controlled by attacker.\u003c/p\u003e\n\n\u003cp\u003eVulnerability was reported for 2 projects:\u003cbr\u003e\ncloud.mail.ru (is in bug bounty scope, but, as a mitigation factor, no sensitive data were found in a leaked memory region)\u003cbr\u003e\nmy.mail.ru (not in a bug bounty scope)\u003c/p\u003e\n"},{"id":5305,"category":"researcher","content":"ImageMagick was executed without sandbox in my.mail.ru and cloud.mail.ru. ImageMagick/GraphicsMagick's gif parser left the palette uninitialized if neither global nor local palette is present. If IM/GM is used as a library loaded into a process that operates on interesting data, this data sometimes can be leaked via the uninitialized palette.\n\nUsing this I was able to retrieve some data that looks like other users' requests, cookies and so on in my.mail.ru (which is outside the bounty scope) and some metadata for cloud.mail.ru.\n\nThe exploit for ImageMagick is available at https://github.com/neex/gifoeb.","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eImageMagick was executed without sandbox in my.mail.ru and cloud.mail.ru. ImageMagick/GraphicsMagick\u0026#39;s gif parser left the palette uninitialized if neither global nor local palette is present. If IM/GM is used as a library loaded into a process that operates on interesting data, this data sometimes can be leaked via the uninitialized palette.\u003c/p\u003e\n\n\u003cp\u003eUsing this I was able to retrieve some data that looks like other users\u0026#39; requests, cookies and so on in my.mail.ru (which is outside the bounty scope) and some metadata for cloud.mail.ru.\u003c/p\u003e\n\n\u003cp\u003eThe exploit for ImageMagick is available at \u003ca title=\"https://github.com/neex/gifoeb\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fneex%2Fgifoeb\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/neex/gifoeb\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e.\u003c/p\u003e\n"}]}