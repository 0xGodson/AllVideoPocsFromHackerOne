{"id":12617,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMjYxNw==","url":"https://hackerone.com/reports/12617","title":"Account hijacking possible through ADB backup feature","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2014-05-20T12:50:12.427Z","submitted_at":"2014-05-20T12:50:12.427Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"trotmaster","url":"/trotmaster","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":130,"url":"https://hackerone.com/faceless","handle":"faceless","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/130/b4849ec47f7f8da7fc65300c595a91e939aead96_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/130/b4849ec47f7f8da7fc65300c595a91e939aead96_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"disabled","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Faceless","twitter_handle":null,"website":"http://www.delight.im/get/faceless","about":"Faceless is where you can talk freely, to your friends and the whole world."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2014-05-21T08:22:49.384Z","bug_reporter_agreed_on_going_public_at":"2014-05-21T08:22:49.246Z","team_member_agreed_on_going_public_at":"2014-05-21T02:57:30.339Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"It was found that if an attacker had access to an unlocked phone, they could take any data from the application's sandbox through ADB's backup feature.\r\n\r\nNormally ADB backup allows applications to be backed up to the cloud. This means that if a user replaces or wipes their phone, they can restore app settings.\r\n\r\nThis feature is on by default and needs to be explicitly disabled in the manifest\r\n\u003capplication allowBackup=\"false\"\r\n\r\nIf enabled (or not explicitly disabled), then the backup feature can also be used over USB (details here: http://nelenkov.blogspot.co.uk/2012/06/unpacking-android-backups.html). This means that the shell user, which can not normally access files in the sandboxes of applications, can read and write to them.\r\n\r\nIn the case of the Faceless Android app, it meant that if an attacker had access to an unlocked android device, then they could recover all the files from Faceless' sandbox to their PC. This includes the im.delight.faceless_preferences.xml file which holds the username and password\r\n\r\nThis could then be restored to another device, allowing for account cloning. ","vulnerability_information_html":"\u003cp\u003eIt was found that if an attacker had access to an unlocked phone, they could take any data from the application\u0026#39;s sandbox through ADB\u0026#39;s backup feature.\u003c/p\u003e\n\n\u003cp\u003eNormally ADB backup allows applications to be backed up to the cloud. This means that if a user replaces or wipes their phone, they can restore app settings.\u003c/p\u003e\n\n\u003cp\u003eThis feature is on by default and needs to be explicitly disabled in the manifest\u003cbr\u003e\n\u0026lt;application allowBackup=\u0026quot;false\u0026quot;\u003c/p\u003e\n\n\u003cp\u003eIf enabled (or not explicitly disabled), then the backup feature can also be used over USB (details here: \u003ca title=\"http://nelenkov.blogspot.co.uk/2012/06/unpacking-android-backups.html\" href=\"/redirect?url=http%3A%2F%2Fnelenkov.blogspot.co.uk%2F2012%2F06%2Funpacking-android-backups.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://nelenkov.blogspot.co.uk/2012/06/unpacking-android-backups.html\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e). This means that the shell user, which can not normally access files in the sandboxes of applications, can read and write to them.\u003c/p\u003e\n\n\u003cp\u003eIn the case of the Faceless Android app, it meant that if an attacker had access to an unlocked android device, then they could recover all the files from Faceless\u0026#39; sandbox to their PC. This includes the im.delight.faceless_preferences.xml file which holds the username and password\u003c/p\u003e\n\n\u003cp\u003eThis could then be restored to another device, allowing for account cloning. \u003c/p\u003e\n","weakness":{"id":18,"name":"Information Disclosure"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2014-06-20T02:56:49.080Z","allow_singular_disclosure_after":-205982766.7981901,"singular_disclosure_allowed":true,"vote_count":0,"voters":[],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":54356,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thanks for submitting this bug report!\n\nWe're investigating this issue now. The information you provided about this vulnerability will be checked and we'll see if the issue is valid and in scope.\n\nWe will update this page with more information as soon as possible. Should we need more information, we'll let you know here as well.","markdown_message":"\u003cp\u003eThanks for submitting this bug report!\u003c/p\u003e\n\n\u003cp\u003eWe\u0026#39;re investigating this issue now. The information you provided about this vulnerability will be checked and we\u0026#39;ll see if the issue is valid and in scope.\u003c/p\u003e\n\n\u003cp\u003eWe will update this page with more information as soon as possible. Should we need more information, we\u0026#39;ll let you know here as well.\u003c/p\u003e\n","automated_response":false,"created_at":"2014-05-20T21:13:05.279Z","updated_at":"2014-05-20T21:13:05.279Z","actor":{"username":"delight-im","cleared":false,"url":"/delight-im","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"faceless","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":54497,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"We have checked this issue and verified it as a valid bug which is in scope.\n\nThe fix for this issue will be shipped with our next update to the app.\n\nThis has been a very good find! Thank you!","markdown_message":"\u003cp\u003eWe have checked this issue and verified it as a valid bug which is in scope.\u003c/p\u003e\n\n\u003cp\u003eThe fix for this issue will be shipped with our next update to the app.\u003c/p\u003e\n\n\u003cp\u003eThis has been a very good find! Thank you!\u003c/p\u003e\n","automated_response":false,"created_at":"2014-05-21T02:56:49.108Z","updated_at":"2014-05-21T02:56:49.108Z","actor":{"username":"delight-im","cleared":false,"url":"/delight-im","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"trotmaster","url":"/trotmaster"},"genius_execution_id":null,"team_handle":"faceless","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":54498,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2014-05-21T02:57:30.355Z","updated_at":"2014-05-21T02:57:30.355Z","first_to_agree":true,"actor":{"username":"delight-im","cleared":false,"url":"/delight-im","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"faceless","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":54577,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for being so quick! Good work guys :-)","markdown_message":"\u003cp\u003eThanks for being so quick! Good work guys :-)\u003c/p\u003e\n","automated_response":false,"created_at":"2014-05-21T08:22:09.529Z","updated_at":"2014-05-21T08:22:09.529Z","actor":{"username":"trotmaster","cleared":false,"url":"/trotmaster","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"faceless","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":54578,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2014-05-21T08:22:49.282Z","updated_at":"2014-05-21T08:22:49.282Z","actor":{"username":"trotmaster","cleared":false,"url":"/trotmaster","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"faceless","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":54579,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2014-05-21T08:22:49.415Z","updated_at":"2014-05-21T08:22:49.415Z","actor":{"username":"trotmaster","cleared":false,"url":"/trotmaster","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"faceless","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}