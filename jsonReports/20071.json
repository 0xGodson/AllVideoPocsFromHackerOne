{"id":20071,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMDA3MQ==","url":"https://hackerone.com/reports/20071","title":"Missing HSTS header in https://public-api.wordpress.com","state":"Closed","substate":"informative","readable_substate":"Informative","created_at":"2014-07-15T03:53:06.223Z","submitted_at":"2014-07-15T03:53:06.223Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"mohaab007","url":"/mohaab007","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/196/6e6b487989347681ee2571abce6ea209f0e2b724_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":111,"url":"https://hackerone.com/automattic","handle":"automattic","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/111/7f89e1ea233f92916202521a069fdbfe9eced339_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/111/7f89e1ea233f92916202521a069fdbfe9eced339_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Automattic","twitter_handle":"","website":"https://automattic.com","about":"WordPress.com, VaultPress, Akismet, Gravatar, WooCommerce, Polldaddy, Tumblr and more!"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2014-08-28T16:02:38.147Z","bug_reporter_agreed_on_going_public_at":"2014-07-29T16:02:29.762Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi,\r\n\r\n\r\nVulnerable Website:\r\n\r\nhttps://public-api.wordpress.com/oauth2/authorize?client_id=930\u0026response_type=code\u0026blog_id=0\u0026state=05f9c401dedcb9b3f33d82e8b335d1128d24d4cbc4a73903374f952acdfd34f6\u0026redirect_uri=https%3A%2F%2Fvaultpress.com%2Flogin%2F%3Faction%3Drequest_access_token\r\n\r\nI tested the website using firefox add-on called:  Strict Transport Security Detector\r\n\r\nhttps://addons.mozilla.org/en-US/firefox/addon/strict-transport-security-d/\r\n\r\n\r\nHSTS addresses the following threats:\r\n\r\nUser bookmarks or manually types http://example.com and is subject to a man-in-the-middle attacker:\r\n\r\n     HSTS automatically redirects HTTP requests to HTTPS for the target domain\r\n\r\nWeb application that is intended to be purely HTTPS inadvertently contains HTTP links or serves content over HTTP:\r\n\r\n     HSTS automatically redirects HTTP requests to HTTPS for the target domain\r\n\r\nA man-in-the-middle attacker attempts to intercept traffic from a victim user using an invalid certificate and hopes the user will accept the bad certificate:\r\n\r\n     HSTS does not allow a user to override the invalid certificate message\r\n\r\nmore :\r\n\r\nHSTS mitigates the following threats.\r\n\r\n1. HTTP request to an HTTPS site\r\n\r\nFor example: \r\n\r\n1. User wants to visit SecureSite.com\r\n2. User types SecureSite.com into the address bar\r\n3. Browser automatically appends \"http://\" making the following request: http://SecureSite.com\r\n4. Server responds with 301 (permanent redirect) to the following location: https://SecureSite.com\r\n5. Browser makes request to above URL\r\n\r\nThe above scenario allows for a man-in-the-middle attack as a result of the unintentional HTTP request to SecureSite.com. An attacker can leverage a tool such as ssltrip to transparently hijack the HTTP request prior to the 301 redirect. HSTS eliminates this attack window as long as the user previously accessed SecureSite.com over HTTPS and obtained the HSTS header.\r\n\r\nEven with HSTS enabled, a user's initial request to SecureSite.com would remain unprotected from attacks. As a result, both Chrome and Mozilla introduced HSTS preload lists. If SecureSite.com is on Chrome's HSTS preload list, a freshly installed Chrome browser will only allow secure connections to that site, even if the user never accessed it before.\r\n2.  Insecure link referencing an HSTS enabled site\r\n\r\nFor example:\r\n1. Forum.com includes a link to http://SecureSite.com\r\n2. HSTS will automatically convert the link to HTTPS for the HSTS-enabled site\r\n3. Invalid Certificate\r\n\r\nThe following would be considered invalid certificates:\r\n- Self-signed and/or untrusted CA signed certificate\r\n- Expired\r\n- Wrong name specified\r\n\r\n\r\n\r\nreferences:\r\n\r\nhttp://blog.nvisium.com/2014/04/is-your-site-hsts-enabled.html\r\n\r\nhttps://www.owasp.org/index.php/HTTP_Strict_Transport_Security#Threats\r\n\r\nhttp://www.chromium.org/sts\r\n\r\nhttps://developer.mozilla.org/en-US/docs/Web/Security/HTTP_strict_transport_security\r\n\r\nhttps://www.owasp.org/index.php/Test_HTTP_Strict_Transport_Security_(OTG-CONFIG-009)","vulnerability_information_html":"\u003cp\u003eHi,\u003c/p\u003e\n\n\u003cp\u003eVulnerable Website:\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"https://public-api.wordpress.com/oauth2/authorize?client_id=930\u0026amp;response_type=code\u0026amp;blog_id=0\u0026amp;state=05f9c401dedcb9b3f33d82e8b335d1128d24d4cbc4a73903374f952acdfd34f6\u0026amp;redirect_uri=https%3A%2F%2Fvaultpress.com%2Flogin%2F%3Faction%3Drequest_access_token\" href=\"/redirect?url=https%3A%2F%2Fpublic-api.wordpress.com%2Foauth2%2Fauthorize%3Fclient_id%3D930%26response_type%3Dcode%26blog_id%3D0%26state%3D05f9c401dedcb9b3f33d82e8b335d1128d24d4cbc4a73903374f952acdfd34f6%26redirect_uri%3Dhttps%253A%252F%252Fvaultpress.com%252Flogin%252F%253Faction%253Drequest_access_token\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://public-api.wordpress.com/oauth2/authorize?client_id=930\u0026amp;response_type=code\u0026amp;blog_id=0\u0026amp;state=05f9c401dedcb9b3f33d82e8b335d1128d24d4cbc4a73903374f952acdfd34f6\u0026amp;redirect_uri=https%3A%2F%2Fvaultpress.com%2Flogin%2F%3Faction%3Drequest_access_token\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eI tested the website using firefox add-on called:  Strict Transport Security Detector\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"https://addons.mozilla.org/en-US/firefox/addon/strict-transport-security-d/\" href=\"/redirect?url=https%3A%2F%2Faddons.mozilla.org%2Fen-US%2Ffirefox%2Faddon%2Fstrict-transport-security-d%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://addons.mozilla.org/en-US/firefox/addon/strict-transport-security-d/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eHSTS addresses the following threats:\u003c/p\u003e\n\n\u003cp\u003eUser bookmarks or manually types \u003ca title=\"http://example.com\" href=\"/redirect?url=http%3A%2F%2Fexample.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://example.com\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e and is subject to a man-in-the-middle attacker:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e HSTS automatically redirects HTTP requests to HTTPS for the target domain\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eWeb application that is intended to be purely HTTPS inadvertently contains HTTP links or serves content over HTTP:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e HSTS automatically redirects HTTP requests to HTTPS for the target domain\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eA man-in-the-middle attacker attempts to intercept traffic from a victim user using an invalid certificate and hopes the user will accept the bad certificate:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e HSTS does not allow a user to override the invalid certificate message\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003emore :\u003c/p\u003e\n\n\u003cp\u003eHSTS mitigates the following threats.\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eHTTP request to an HTTPS site\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eFor example: \u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eUser wants to visit SecureSite.com\u003c/li\u003e\n\u003cli\u003eUser types SecureSite.com into the address bar\u003c/li\u003e\n\u003cli\u003eBrowser automatically appends \u0026quot;http://\u0026quot; making the following request: \u003ca title=\"http://securesite.com\" href=\"/redirect?url=http%3A%2F%2Fsecuresite.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://securesite.com\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003eServer responds with 301 (permanent redirect) to the following location: \u003ca title=\"https://securesite.com\" href=\"/redirect?url=https%3A%2F%2Fsecuresite.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://securesite.com\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003eBrowser makes request to above URL\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eThe above scenario allows for a man-in-the-middle attack as a result of the unintentional HTTP request to SecureSite.com. An attacker can leverage a tool such as ssltrip to transparently hijack the HTTP request prior to the 301 redirect. HSTS eliminates this attack window as long as the user previously accessed SecureSite.com over HTTPS and obtained the HSTS header.\u003c/p\u003e\n\n\u003cp\u003eEven with HSTS enabled, a user\u0026#39;s initial request to SecureSite.com would remain unprotected from attacks. As a result, both Chrome and Mozilla introduced HSTS preload lists. If SecureSite.com is on Chrome\u0026#39;s HSTS preload list, a freshly installed Chrome browser will only allow secure connections to that site, even if the user never accessed it before.\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003e Insecure link referencing an HSTS enabled site\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eFor example:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eForum.com includes a link to \u003ca title=\"http://securesite.com\" href=\"/redirect?url=http%3A%2F%2Fsecuresite.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://securesite.com\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003eHSTS will automatically convert the link to HTTPS for the HSTS-enabled site\u003c/li\u003e\n\u003cli\u003eInvalid Certificate\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eThe following would be considered invalid certificates:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eSelf-signed and/or untrusted CA signed certificate\u003c/li\u003e\n\u003cli\u003eExpired\u003c/li\u003e\n\u003cli\u003eWrong name specified\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003ereferences:\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"http://blog.nvisium.com/2014/04/is-your-site-hsts-enabled.html\" href=\"/redirect?url=http%3A%2F%2Fblog.nvisium.com%2F2014%2F04%2Fis-your-site-hsts-enabled.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://blog.nvisium.com/2014/04/is-your-site-hsts-enabled.html\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"https://www.owasp.org/index.php/HTTP_Strict_Transport_Security#Threats\" href=\"/redirect?url=https%3A%2F%2Fwww.owasp.org%2Findex.php%2FHTTP_Strict_Transport_Security%23Threats\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.owasp.org/index.php/HTTP_Strict_Transport_Security#Threats\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"http://www.chromium.org/sts\" href=\"/redirect?url=http%3A%2F%2Fwww.chromium.org%2Fsts\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://www.chromium.org/sts\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"https://developer.mozilla.org/en-US/docs/Web/Security/HTTP_strict_transport_security\" href=\"/redirect?url=https%3A%2F%2Fdeveloper.mozilla.org%2Fen-US%2Fdocs%2FWeb%2FSecurity%2FHTTP_strict_transport_security\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://developer.mozilla.org/en-US/docs/Web/Security/HTTP_strict_transport_security\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"https://www.owasp.org/index.php/Test_HTTP_Strict_Transport_Security_(OTG-CONFIG-009)\" href=\"/redirect?url=https%3A%2F%2Fwww.owasp.org%2Findex.php%2FTest_HTTP_Strict_Transport_Security_%28OTG-CONFIG-009%29\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.owasp.org/index.php/Test_HTTP_Strict_Transport_Security_(OTG-CONFIG-009)\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","weakness":{"id":32,"name":"Cryptographic Issues - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2014-08-28T16:02:30.436Z","allow_singular_disclosure_after":-199975846.57436523,"singular_disclosure_allowed":true,"vote_count":0,"voters":[],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":97558,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"Hi - \n\nThanks for the report.  While we agree that adding HSTS headers is the best thing to do, it's not widely supported on WordPress.com.  We should be able to resolve this in the future, but for the time being we will not be adding them. ","markdown_message":"\u003cp\u003eHi - \u003c/p\u003e\n\n\u003cp\u003eThanks for the report.  While we agree that adding HSTS headers is the best thing to do, it\u0026#39;s not widely supported on WordPress.com.  We should be able to resolve this in the future, but for the time being we will not be adding them. \u003c/p\u003e\n","automated_response":false,"created_at":"2014-07-29T15:58:08.109Z","updated_at":"2014-07-29T15:58:08.109Z","actor":{"username":"bazza","cleared":false,"url":"/bazza","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/920/2f930cad1bfd0c7db0b313a818033aa6f69dec13_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":97561,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"can we disclose it?\n\nthanks","markdown_message":"\u003cp\u003ecan we disclose it?\u003c/p\u003e\n\n\u003cp\u003ethanks\u003c/p\u003e\n","automated_response":false,"created_at":"2014-07-29T16:02:29.778Z","updated_at":"2014-07-29T16:02:29.778Z","actor":{"username":"mohaab007","cleared":false,"url":"/mohaab007","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/196/6e6b487989347681ee2571abce6ea209f0e2b724_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":116744,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2014-08-28T16:02:38.174Z","updated_at":"2014-08-28T16:02:38.174Z","actor":{"url":"/automattic","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/111/7f89e1ea233f92916202521a069fdbfe9eced339_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Automattic"}},"genius_execution_id":null,"team_handle":"automattic","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}