{"id":456727,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC80NTY3Mjc=","url":"https://hackerone.com/reports/456727","title":"null pointer dereference in imap_mail","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2018-12-06T03:30:36.662Z","submitted_at":"2018-12-06T03:30:36.662Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"shuoz","url":"/shuoz","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/263/557/9e1fcc63943ba1bd577fb65c61307baa5c52db48_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":29,"url":"https://hackerone.com/ibb-php","handle":"ibb-php","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/029/99087dbbdf52fc3ce3acbf16aa33a5c4f5e2c111_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/029/99087dbbdf52fc3ce3acbf16aa33a5c4f5e2c111_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"paused","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"PHP (IBB)","twitter_handle":"","website":"http://www.php.net","about":""}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":["CVE-2018-19935"],"singular_disclosure_disabled":false,"disclosed_at":"2020-11-09T01:45:05.229Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2020-10-10T01:45:04.874Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"in imap_mail if message args is null, in _php_imap_mail no check wheater message  can get, so crash.\n\n```\n     fprintf(sendmail, \"\\n%s\\n\", message);\n\n```\n\n\n\n/usr/local/php/bin/php ./craxxx.php \n\nWarning: imap_mail(): No message string in mail command in /home/fan/github/php-7.2.10/myselffuzz/craxxx.php on line 3\nsh: 1: -t: not found\nSegmentation fault (core dumped)\n\n\n\n\n\n\n\n../sapi/cli/php ./craxxx.php \n\nWarning: imap_mail(): No message string in mail command in /home/fan/github/php-7.2.10/myselffuzz/craxxx.php on line 3\nASAN:SIGSEGV\n=================================================================\n==23766==ERROR: AddressSanitizer: SEGV on unknown address 0x000000000018 (pc 0x7fae925d9cc0 bp 0x7ffcb6b27a10 sp 0x7ffcb6b274a0 T0)\nsh: 1: -t: not found\n    #0 0x7fae925d9cbf in vfprintf (/lib/x86_64-linux-gnu/libc.so.6+0x4ecbf)\n    #1 0x7fae926a1bc8 in __fprintf_chk (/lib/x86_64-linux-gnu/libc.so.6+0x116bc8)\n    #2 0xa5aeb0 in fprintf /usr/include/x86_64-linux-gnu/bits/stdio2.h:97\n    #3 0xa5aeb0 in _php_imap_mail /home/fan/github/php-7.2.10/ext/imap/php_imap.c:4065\n    #4 0xa5b22d in zif_imap_mail /home/fan/github/php-7.2.10/ext/imap/php_imap.c:4112\n    #5 0x17da703 in ZEND_DO_ICALL_SPEC_RETVAL_UNUSED_HANDLER /home/fan/Desktop/php-7.2.10/Zend/zend_vm_execute.h:573\n    #6 0x17da703 in execute_ex /home/fan/Desktop/php-7.2.10/Zend/zend_vm_execute.h:59747\n    #7 0x181b5c3 in zend_execute /home/fan/Desktop/php-7.2.10/Zend/zend_vm_execute.h:63776\n    #8 0x1356ef2 in zend_execute_scripts /home/fan/Desktop/php-7.2.10/Zend/zend.c:1496\n    #9 0x11c0776 in php_execute_script /home/fan/Desktop/php-7.2.10/main/main.c:2590\n    #10 0x1823488 in do_cli /home/fan/Desktop/php-7.2.10/sapi/cli/php_cli.c:1011\n    #11 0x18256f4 in main /home/fan/Desktop/php-7.2.10/sapi/cli/php_cli.c:1404\n    #12 0x7fae925ab82f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2082f)\n    #13 0x440888 in _start (/home/fan/github/php-7.2.10/sapi/cli/php+0x440888)\n\nAddressSanitizer can not provide additional info.\nSUMMARY: AddressSanitizer: SEGV ??:0 vfprintf\n==23766==ABORTING\n\n\n\n\nTest script:\n---------------\n\u003c?php\n\timap_mail('1', 1, NULL);\n\n?\u003e\n\nphp bugs:\nhttps://bugs.php.net/bug.php?id=77020\n\n## Impact\n\nIMAP","vulnerability_information_html":"\u003cp\u003ein imap_mail if message args is null, in _php_imap_mail no check wheater message  can get, so crash.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e     fprintf(sendmail, \u0026quot;\\n%s\\n\u0026quot;, message);\n\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e/usr/local/php/bin/php ./craxxx.php \u003c/p\u003e\n\n\u003cp\u003eWarning: imap_mail(): No message string in mail command in /home/fan/github/php-7.2.10/myselffuzz/craxxx.php on line 3\u003cbr\u003e\nsh: 1: -t: not found\u003cbr\u003e\nSegmentation fault (core dumped)\u003c/p\u003e\n\n\u003cp\u003e../sapi/cli/php ./craxxx.php \u003c/p\u003e\n\n\u003cp\u003eWarning: imap_mail(): No message string in mail command in /home/fan/github/php-7.2.10/myselffuzz/craxxx.php on line 3\u003c/p\u003e\n\n\u003ch1 id=\"asan-sigsegv\"\u003eASAN:SIGSEGV\u003c/h1\u003e\n\n\u003cp\u003e\u003cmark\u003e23766\u003c/mark\u003eERROR: AddressSanitizer: SEGV on unknown address 0x000000000018 (pc 0x7fae925d9cc0 bp 0x7ffcb6b27a10 sp 0x7ffcb6b274a0 T0)\u003cbr\u003e\nsh: 1: -t: not found\u003cbr\u003e\n    #0 0x7fae925d9cbf in vfprintf (/lib/x86_64-linux-gnu/libc.so.6+0x4ecbf)\u003cbr\u003e\n    #1 0x7fae926a1bc8 in __fprintf_chk (/lib/x86_64-linux-gnu/libc.so.6+0x116bc8)\u003cbr\u003e\n    #2 0xa5aeb0 in fprintf /usr/include/x86_64-linux-gnu/bits/stdio2.h:97\u003cbr\u003e\n    #3 0xa5aeb0 in _php_imap_mail /home/fan/github/php-7.2.10/ext/imap/php_imap.c:4065\u003cbr\u003e\n    #4 0xa5b22d in zif_imap_mail /home/fan/github/php-7.2.10/ext/imap/php_imap.c:4112\u003cbr\u003e\n    #5 0x17da703 in ZEND_DO_ICALL_SPEC_RETVAL_UNUSED_HANDLER /home/fan/Desktop/php-7.2.10/Zend/zend_vm_execute.h:573\u003cbr\u003e\n    #6 0x17da703 in execute_ex /home/fan/Desktop/php-7.2.10/Zend/zend_vm_execute.h:59747\u003cbr\u003e\n    #7 0x181b5c3 in zend_execute /home/fan/Desktop/php-7.2.10/Zend/zend_vm_execute.h:63776\u003cbr\u003e\n    #8 0x1356ef2 in zend_execute_scripts /home/fan/Desktop/php-7.2.10/Zend/zend.c:1496\u003cbr\u003e\n    #9 0x11c0776 in php_execute_script /home/fan/Desktop/php-7.2.10/main/main.c:2590\u003cbr\u003e\n    #10 0x1823488 in do_cli /home/fan/Desktop/php-7.2.10/sapi/cli/php_cli.c:1011\u003cbr\u003e\n    #11 0x18256f4 in main /home/fan/Desktop/php-7.2.10/sapi/cli/php_cli.c:1404\u003cbr\u003e\n    #12 0x7fae925ab82f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2082f)\u003cbr\u003e\n    #13 0x440888 in _start (/home/fan/github/php-7.2.10/sapi/cli/php+0x440888)\u003c/p\u003e\n\n\u003cp\u003eAddressSanitizer can not provide additional info.\u003cbr\u003e\nSUMMARY: AddressSanitizer: SEGV ??:0 vfprintf\u003cbr\u003e\n\u003cmark\u003e23766\u003c/mark\u003eABORTING\u003c/p\u003e\n\n\u003ch2 id=\"test-script\"\u003eTest script:\u003c/h2\u003e\n\n\u003cp\u003e\u0026lt;?php\u003cbr\u003e\n    imap_mail(\u0026#39;1\u0026#39;, 1, NULL);\u003c/p\u003e\n\n\u003cp\u003e?\u0026gt;\u003c/p\u003e\n\n\u003cp\u003ephp bugs:\u003cbr\u003e\n\u003ca title=\"https://bugs.php.net/bug.php?id=77020\" href=\"/redirect?url=https%3A%2F%2Fbugs.php.net%2Fbug.php%3Fid%3D77020\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://bugs.php.net/bug.php?id=77020\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eIMAP\u003c/p\u003e\n","bounty_amount":"1500.0","formatted_bounty":"$1,500","weakness":{"id":8,"name":"Out-of-bounds Read"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2020-11-09T01:45:04.984Z","allow_singular_disclosure_after":-4335341.047288724,"singular_disclosure_allowed":true,"vote_count":13,"voters":["rjenningsuk","rahsec","isurusri27","hypernova11","usama121121","jb1994","pokediger2","islemshadow","lothos","skay17_17lion","and 3 more..."],"severity":{"rating":"high","score":7.5,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"none","user_interaction":"none","scope":"unchanged","confidentiality":"none","integrity":"none","availability":"high"}},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":4002630,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @shuoz - Thanks for the submission. Your report is currently being reviewed and the HackerOne triage team will get back to you once there is additional information to share. Thank you for your patience! ","markdown_message":"\u003cp\u003eHey \u003ca href=\"/shuoz\"\u003e@shuoz\u003c/a\u003e - Thanks for the submission. Your report is currently being reviewed and the HackerOne triage team will get back to you once there is additional information to share. Thank you for your patience! \u003c/p\u003e\n","automated_response":false,"created_at":"2019-01-18T21:16:49.479Z","updated_at":"2019-01-18T21:16:49.479Z","actor":{"username":"tuxedo","cleared":false,"url":"/tuxedo","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/9G6pgB95of3ikt3prqQunAfD/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"ibb-php","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":4469885,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"this use cve-2018-19935","markdown_message":"\u003cp\u003ethis use cve-2018-19935\u003c/p\u003e\n","automated_response":false,"created_at":"2019-04-04T02:23:27.886Z","updated_at":"2019-04-04T02:23:27.886Z","actor":{"username":"shuoz","cleared":false,"url":"/shuoz","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/263/557/9e1fcc63943ba1bd577fb65c61307baa5c52db48_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"ibb-php","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4869062,"is_internal":false,"editable":false,"type":"Activities::CveIdAdded","message":"","markdown_message":"","automated_response":false,"created_at":"2019-05-17T20:42:37.753Z","updated_at":"2019-05-17T20:42:37.753Z","cve_ids":["CVE-2018-19935"],"actor":{"username":"tuxedo","cleared":false,"url":"/tuxedo","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/9G6pgB95of3ikt3prqQunAfD/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"ibb-php","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":4869067,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2019-05-17T20:44:59.237Z","updated_at":"2019-05-17T20:44:59.237Z","additional_data":{"old_severity":"Medium","new_severity":"High (7.5)","old_severity_id":256251,"new_severity_id":394970},"actor":{"username":"tuxedo","cleared":false,"url":"/tuxedo","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/9G6pgB95of3ikt3prqQunAfD/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"ibb-php","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":4869069,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thank you @shuoz! I was able to validate your report, and have submitted it to the appropriate remediation team for review. Please note that the status and severity are subject to change. ","markdown_message":"\u003cp\u003eThank you \u003ca href=\"/shuoz\"\u003e@shuoz\u003c/a\u003e! I was able to validate your report, and have submitted it to the appropriate remediation team for review. Please note that the status and severity are subject to change. \u003c/p\u003e\n","automated_response":false,"created_at":"2019-05-17T20:45:04.821Z","updated_at":"2019-05-17T20:45:04.821Z","actor":{"username":"tuxedo","cleared":false,"url":"/tuxedo","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/9G6pgB95of3ikt3prqQunAfD/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"ibb-php","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":5046034,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@tuxedo ok...","markdown_message":"\u003cp\u003e\u003ca href=\"/tuxedo\"\u003e@tuxedo\u003c/a\u003e ok...\u003c/p\u003e\n","automated_response":false,"created_at":"2019-06-11T02:36:54.801Z","updated_at":"2019-06-11T02:36:54.801Z","actor":{"username":"shuoz","cleared":false,"url":"/shuoz","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/263/557/9e1fcc63943ba1bd577fb65c61307baa5c52db48_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"ibb-php","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9206590,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"any response?","markdown_message":"\u003cp\u003eany response?\u003c/p\u003e\n","automated_response":false,"created_at":"2020-09-13T09:49:42.482Z","updated_at":"2020-09-13T09:49:42.482Z","actor":{"username":"shuoz","cleared":false,"url":"/shuoz","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/263/557/9e1fcc63943ba1bd577fb65c61307baa5c52db48_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"ibb-php","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9478556,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2020-10-10T00:54:17.918Z","updated_at":"2020-10-10T00:54:17.918Z","actor":{"url":"/ibb-php","ibb":true,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/029/99087dbbdf52fc3ce3acbf16aa33a5c4f5e2c111_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"PHP (IBB)"}},"bounty_amount":"1500.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"ibb-php","collaborator":{"username":"shuoz","url":"/shuoz"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9478557,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hello @shuoz,\n\nOn behalf of the Internet Bug Bounty Panel, thank you for your continued patience on this report. The IBB requires that all in-scope open source projects be mutually engaged with us to ensure there is a good experience for all. Unfortunately, we have not been able to maintain that relationship with the upstream PHP community, and as a result, HackerOne and the IBB Panel have collectively agreed to shut down the program indefinitely.\n\nIn an effort to reward researchers for their hard work and patience thus far, the IBB panel has elected to pay bounties to all valid reports without PHP’s input. Bounty amounts are decided on based on the PHP policy and severity assigned on the accompanying CVE. \n\nAs an act of good faith, we will also close this report as Resolved.\n\nThank you for helping keep the internet safe and secure!\n-The Internet Bug Bounty Panel \n","markdown_message":"\u003cp\u003eHello \u003ca href=\"/shuoz\"\u003e@shuoz\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eOn behalf of the Internet Bug Bounty Panel, thank you for your continued patience on this report. The IBB requires that all in-scope open source projects be mutually engaged with us to ensure there is a good experience for all. Unfortunately, we have not been able to maintain that relationship with the upstream PHP community, and as a result, HackerOne and the IBB Panel have collectively agreed to shut down the program indefinitely.\u003c/p\u003e\n\n\u003cp\u003eIn an effort to reward researchers for their hard work and patience thus far, the IBB panel has elected to pay bounties to all valid reports without PHP’s input. Bounty amounts are decided on based on the PHP policy and severity assigned on the accompanying CVE. \u003c/p\u003e\n\n\u003cp\u003eAs an act of good faith, we will also close this report as Resolved.\u003c/p\u003e\n\n\u003cp\u003eThank you for helping keep the internet safe and secure!\u003cbr\u003e\n-The Internet Bug Bounty Panel \u003c/p\u003e\n","automated_response":false,"created_at":"2020-10-10T00:54:32.694Z","updated_at":"2020-10-10T00:54:32.694Z","actor":{"username":"reed","cleared":false,"url":"/reed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"reporter":{"username":"shuoz","url":"/shuoz"},"genius_execution_id":null,"team_handle":"ibb-php","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9478669,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-10-10T01:45:04.890Z","updated_at":"2020-10-10T01:45:04.890Z","first_to_agree":true,"actor":{"username":"reed","cleared":false,"url":"/reed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"ibb-php","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9762785,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-11-09T01:45:05.257Z","updated_at":"2020-11-09T01:45:05.257Z","actor":{"url":"/ibb-php","ibb":true,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/029/99087dbbdf52fc3ce3acbf16aa33a5c4f5e2c111_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"PHP (IBB)"}},"genius_execution_id":null,"team_handle":"ibb-php","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}