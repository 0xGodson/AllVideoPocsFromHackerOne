{"id":1033107,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMDMzMTA3","url":"https://hackerone.com/reports/1033107","title":"DNS Max Responses for DOS","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2020-11-12T18:32:25.883Z","submitted_at":"2020-11-12T18:32:25.903Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"zeus1999","url":"/zeus1999","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":22984,"url":"https://hackerone.com/nodejs","handle":"nodejs","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/022/984/e600648ace4a8553247bce967d461a030aa81d49_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/022/984/e600648ace4a8553247bce967d461a030aa81d49_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Node.js","twitter_handle":"nodejs","website":"https://nodejs.org","about":"The Node.js JavaScript Runtime"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":["CVE-2020-8277"],"singular_disclosure_disabled":false,"disclosed_at":"2020-12-16T22:08:53.517Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2020-11-16T22:08:50.421Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"See Github (my issue): https://github.com/nodejs/node/issues/36063\n\n\nWhen i try to fetch the A Dns records of following domain: ticbrasil.com.br I dont get any response.\nI think thats the case because there are over 1300 responses.\n\nVersion: v12.18.4, v14.15.0\nPlatform: 64-bit Windows 10 Pro \u0026 Enterprise\n\nWhat steps will reproduce the bug?\nvar dns = require('dns'); dns.resolve4('ticbrasil.com.br', function (err, addresses, family) { console.log(err); console.log(addresses); console.log(family); });\n\nHow often does it reproduce? Is there a required condition?\nIt happends everytime\n\nWhat is the expected behavior?\nhttps://pastebin.com/Tv53Na89\n\nWhat do you see instead?\nNothing/No output\n\n## Impact\n\nmmomtchev commented 3 hours ago\n@mhdawson someone should contact Mitre or whoever you usually contact, this is a confirmed remote security vulnerability. If an attacker can trigger a DNS resolution for an address chosen by him, then it is exploitable for DoS. It is a very high-risk vulnerability. I don't think a remote access is possible, but this should probably be evaluated by an expert.\n\n@jasnell\n \nMember\njasnell commented 2 hours ago\nWe can look into this further but I have to point out: we have a defined process for properly reporting and investigating potential security vulnerabilities. As soon as this issue was suspected as being a security issue, that process should have been followed with investigation and fixes investigated in the private Node.js repo we use for that purpose, otherwise this ends up risking a zero-day for all Node.js users.","vulnerability_information_html":"\u003cp\u003eSee Github (my issue): \u003ca title=\"https://github.com/nodejs/node/issues/36063\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fnodejs%2Fnode%2Fissues%2F36063\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/nodejs/node/issues/36063\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eWhen i try to fetch the A Dns records of following domain: ticbrasil.com.br I dont get any response.\u003cbr\u003e\nI think thats the case because there are over 1300 responses.\u003c/p\u003e\n\n\u003cp\u003eVersion: v12.18.4, v14.15.0\u003cbr\u003e\nPlatform: 64-bit Windows 10 Pro \u0026amp; Enterprise\u003c/p\u003e\n\n\u003cp\u003eWhat steps will reproduce the bug?\u003cbr\u003e\nvar dns = require(\u0026#39;dns\u0026#39;); dns.resolve4(\u0026#39;ticbrasil.com.br\u0026#39;, function (err, addresses, family) { console.log(err); console.log(addresses); console.log(family); });\u003c/p\u003e\n\n\u003cp\u003eHow often does it reproduce? Is there a required condition?\u003cbr\u003e\nIt happends everytime\u003c/p\u003e\n\n\u003cp\u003eWhat is the expected behavior?\u003cbr\u003e\n\u003ca title=\"https://pastebin.com/Tv53Na89\" href=\"/redirect?url=https%3A%2F%2Fpastebin.com%2FTv53Na89\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://pastebin.com/Tv53Na89\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eWhat do you see instead?\u003cbr\u003e\nNothing/No output\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003emmomtchev commented 3 hours ago\u003cbr\u003e\n\u003ca href=\"/mhdawson\"\u003e@mhdawson\u003c/a\u003e someone should contact Mitre or whoever you usually contact, this is a confirmed remote security vulnerability. If an attacker can trigger a DNS resolution for an address chosen by him, then it is exploitable for DoS. It is a very high-risk vulnerability. I don\u0026#39;t think a remote access is possible, but this should probably be evaluated by an expert.\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"/jasnell\"\u003e@jasnell\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eMember\u003cbr\u003e\njasnell commented 2 hours ago\u003cbr\u003e\nWe can look into this further but I have to point out: we have a defined process for properly reporting and investigating potential security vulnerabilities. As soon as this issue was suspected as being a security issue, that process should have been followed with investigation and fixes investigated in the private Node.js repo we use for that purpose, otherwise this ends up risking a zero-day for all Node.js users.\u003c/p\u003e\n","weakness":{"id":48,"name":"Denial of Service"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2020-12-16T22:08:50.521Z","allow_singular_disclosure_after":-1058640.568310698,"singular_disclosure_allowed":true,"vote_count":1,"voters":["z3rod3x"],"severity":{"rating":"high","author_type":"User"},"structured_scope":{"databaseId":666,"asset_type":"SOURCE_CODE","asset_identifier":"https://github.com/nodejs/node","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":9805960,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":null,"markdown_message":"","automated_response":false,"created_at":"2020-11-12T18:35:41.765Z","updated_at":"2020-11-12T18:35:41.765Z","additional_data":{"old_severity":null,"new_severity":"High","old_severity_id":null,"new_severity_id":904748},"actor":{"username":"zeus1999","cleared":false,"url":"/zeus1999","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9805998,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@zeus1999 do you have some scenarios in mind where an attacker could drigger DNS resolution for an address of their choosing? It would be good to understand how hard/practical this is.\n","markdown_message":"\u003cp\u003e\u003ca href=\"/zeus1999\"\u003e@zeus1999\u003c/a\u003e do you have some scenarios in mind where an attacker could drigger DNS resolution for an address of their choosing? It would be good to understand how hard/practical this is.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-11-12T18:40:50.152Z","updated_at":"2020-11-12T18:40:50.152Z","actor":{"username":"mhdawson","cleared":false,"url":"/mhdawson","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9806021,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"drigger -\u003e trigger ","markdown_message":"\u003cp\u003edrigger -\u0026gt; trigger \u003c/p\u003e\n","automated_response":false,"created_at":"2020-11-12T18:44:36.230Z","updated_at":"2020-11-12T18:44:36.230Z","actor":{"username":"mhdawson","cleared":false,"url":"/mhdawson","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9806308,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I don't really understand how this is a security vulnerability, or how it could be exploited.\n\nRunning the code I get:\n\n```\n\\Error: queryA ENODATA ticbrasil.com.br\n    at QueryReqWrap.onresolve [as oncomplete] (node:dns:203:19) {\n  errno: undefined,\n  code: 'ENODATA',\n  syscall: 'queryA',\n  hostname: 'ticbrasil.com.br'\n}\n```\n\nWhere is the Denial of Service attack?\n\nIt is a bug, I just do not see the exploit.","markdown_message":"\u003cp\u003eI don\u0026#39;t really understand how this is a security vulnerability, or how it could be exploited.\u003c/p\u003e\n\n\u003cp\u003eRunning the code I get:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e\\Error: queryA ENODATA ticbrasil.com.br\n    at QueryReqWrap.onresolve [as oncomplete] (node:dns:203:19) {\n  errno: undefined,\n  code: \u0026#39;ENODATA\u0026#39;,\n  syscall: \u0026#39;queryA\u0026#39;,\n  hostname: \u0026#39;ticbrasil.com.br\u0026#39;\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eWhere is the Denial of Service attack?\u003c/p\u003e\n\n\u003cp\u003eIt is a bug, I just do not see the exploit.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-11-12T18:59:54.567Z","updated_at":"2020-11-12T18:59:54.567Z","actor":{"username":"mcollina","cleared":false,"url":"/mcollina","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/230/980/61a26e6fa4ec002fca494b3b7b43aa251eef3453_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9806714,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I can recreate a crash on Linux with 14.10.0 from the Download site, about 1/4 runs with the test provided.\n\nuser1@user1-VirtualBox:~/testvuln/node-v14.15.0-linux-x64/bin$ ./node ../../test.js\nSegmentation fault (core dumped)","markdown_message":"\u003cp\u003eI can recreate a crash on Linux with 14.10.0 from the Download site, about 1/4 runs with the test provided.\u003c/p\u003e\n\n\u003cp\u003euser1@user1-VirtualBox:~/testvuln/node-v14.15.0-linux-x64/bin$ ./node ../../test.js\u003cbr\u003e\nSegmentation fault (core dumped)\u003c/p\u003e\n","automated_response":false,"created_at":"2020-11-12T20:02:47.680Z","updated_at":"2020-11-12T20:02:47.680Z","actor":{"username":"mhdawson","cleared":false,"url":"/mhdawson","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9806718,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Sorry that should have  been Linux with v14.15.0","markdown_message":"\u003cp\u003eSorry that should have  been Linux with v14.15.0\u003c/p\u003e\n","automated_response":false,"created_at":"2020-11-12T20:03:16.517Z","updated_at":"2020-11-12T20:03:16.517Z","actor":{"username":"mhdawson","cleared":false,"url":"/mhdawson","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9808248,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@zeus1999 as an FYI I moved your issue to a private repo to limit visibility while we line up fixes/release. We an restore one we've got releases out.","markdown_message":"\u003cp\u003e\u003ca href=\"/zeus1999\"\u003e@zeus1999\u003c/a\u003e as an FYI I moved your issue to a private repo to limit visibility while we line up fixes/release. We an restore one we\u0026#39;ve got releases out.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-11-13T01:00:52.005Z","updated_at":"2020-11-13T01:00:52.005Z","actor":{"username":"mhdawson","cleared":false,"url":"/mhdawson","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9834860,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"This was part of the recent security releases: https://nodejs.org/en/blog/vulnerability/november-2020-security-releases/","markdown_message":"\u003cp\u003eThis was part of the recent security releases: \u003ca title=\"https://nodejs.org/en/blog/vulnerability/november-2020-security-releases/\" href=\"/redirect?url=https%3A%2F%2Fnodejs.org%2Fen%2Fblog%2Fvulnerability%2Fnovember-2020-security-releases%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://nodejs.org/en/blog/vulnerability/november-2020-security-releases/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2020-11-16T16:57:00.497Z","updated_at":"2020-11-16T16:57:00.497Z","actor":{"username":"mhdawson","cleared":false,"url":"/mhdawson","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9837741,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2020-11-16T22:05:01.981Z","updated_at":"2020-11-16T22:05:01.981Z","actor":{"username":"mhdawson","cleared":false,"url":"/mhdawson","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9837743,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2020-11-16T22:05:28.103Z","updated_at":"2020-11-16T22:05:28.103Z","actor":{"username":"mhdawson","cleared":false,"url":"/mhdawson","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"zeus1999","url":"/zeus1999"},"genius_execution_id":null,"team_handle":"nodejs","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9837754,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-11-16T22:08:50.447Z","updated_at":"2020-11-16T22:08:50.447Z","first_to_agree":true,"actor":{"username":"mhdawson","cleared":false,"url":"/mhdawson","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":10126500,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-12-16T22:08:53.573Z","updated_at":"2020-12-16T22:08:53.573Z","actor":{"url":"/nodejs","ibb":true,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/022/984/e600648ace4a8553247bce967d461a030aa81d49_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Node.js"}},"genius_execution_id":null,"team_handle":"nodejs","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}