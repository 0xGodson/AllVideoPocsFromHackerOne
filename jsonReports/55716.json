{"id":55716,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC81NTcxNg==","url":"https://hackerone.com/reports/55716","title":"Force 500 Internal Server Error on any shop (for one user)","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2015-04-10T14:57:24.777Z","submitted_at":"2015-04-10T14:57:24.777Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"4lemon","url":"/4lemon","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/002/194/aa0eb7d0d4c0ee7d20ae9b2550953b4eeda26ef9_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1382,"url":"https://hackerone.com/shopify","handle":"shopify","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Shopify","twitter_handle":"","website":"https://www.shopify.com","about":"Shopify is a multi-channel commerce platform that helps people sell online, in-store, and everywhere in between."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2015-06-09T23:43:40.005Z","bug_reporter_agreed_on_going_public_at":"2015-06-09T23:43:39.548Z","team_member_agreed_on_going_public_at":"2015-06-09T21:26:00.206Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"There is very strange behavior. If user open urls like below:\r\n- https://whashp.myshopify.com/?preview_theme_id[]=11288717 \r\n- or https://lmfshp.myshopify.com/?preview_theme_id[]=11290937\r\nHe got redirect to shop (https://whashp.myshopify.com/) and  500 Internal Server Error response, and reload does not help in this issue. Let's look closer. And change https to http:\r\n- http://whashp.myshopify.com/ - works\r\n- or http://lmfshp.myshopify.com/ - works\r\nOk. Let's open payload with http:\r\n- http://whashp.myshopify.com/?preview_theme_id[]=11288717 \r\n- or http://lmfshp.myshopify.com/?preview_theme_id[]=11290937\r\nThe same 500 error on shop frontend. And this affected on any url, for example:\r\nhttp://whashp.myshopify.com/blogs/news\r\nI found two urls that not affected to this issue on shop frontend:\r\nhttps://whashp.myshopify.com/opening_soon\r\nhttps://whashp.myshopify.com/admin\r\nBut open of any of it not remove error from frontend\r\n\r\nThere is way to remove error -  delete _secure_session_id (for https) and _session_id cookies on shop's domain name.\r\n\r\nInteresting restriction is in theme id. Before next test we should remove error and test that frontend works (https://whashp.myshopify.com). If all good:\r\n- let's try to open https://whashp.myshopify.com/?preview_theme_id[]=11290937 - we got \"Can't preview theme\" response. So, to proper attack we need some theme id. How can we get it?\r\n- open source of https://whashp.myshopify.com/ (before shops is not active it can be done only after login, but any active shops have no problem to access front page). So, open source code and findline like this:\r\nShopify.theme = {\"name\":\"launchpad-star\",\"id\":11288717,\"theme_store_id\":null,\"role\":\"main\"};\r\n\"id\":11288717 - is proper id which will work in payload - https://whashp.myshopify.com/?preview_theme_id[]=11288717 \r\n\r\nAs i said in begin - very strange behavior affected only user whom opened malicios url. But:\r\n- attacker can retrieve proper theme id for any active shop from source code\r\n- this url request is not protected for CSRF\r\n\r\nSo, attack vector is:\r\n1. Open source code of victim.myshopify.com (some famous shop) and find theme id\r\n2. Create malicious urls (both for http and https)  https://victim.myshopify.com/?preview_theme_id[]=%ID_FROM_SOURCE_CODE%\r\n3.  Place this urls in place where as many as possible users open it. It may be image in shop layout (for example some xss issue) or just buy cheap iframed traffic and so on.\r\nAs a result any users that opened this urls will have problem with work with victim.myshopify.com shop.","vulnerability_information_html":"\u003cp\u003eThere is very strange behavior. If user open urls like below:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e\n\u003ca title=\"https://whashp.myshopify.com/?preview_theme_id%5B%5D=11288717\" href=\"/redirect?url=https%3A%2F%2Fwhashp.myshopify.com%2F%3Fpreview_theme_id%255B%255D%3D11288717\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://whashp.myshopify.com/?preview_theme_id%5B%5D=11288717\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e \u003c/li\u003e\n\u003cli\u003eor \u003ca title=\"https://lmfshp.myshopify.com/?preview_theme_id%5B%5D=11290937\" href=\"/redirect?url=https%3A%2F%2Flmfshp.myshopify.com%2F%3Fpreview_theme_id%255B%255D%3D11290937\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://lmfshp.myshopify.com/?preview_theme_id%5B%5D=11290937\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\nHe got redirect to shop (\u003ca title=\"https://whashp.myshopify.com/\" href=\"/redirect?url=https%3A%2F%2Fwhashp.myshopify.com%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://whashp.myshopify.com/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e) and  500 Internal Server Error response, and reload does not help in this issue. Let\u0026#39;s look closer. And change https to http:\u003c/li\u003e\n\u003cli\u003e\n\u003ca title=\"http://whashp.myshopify.com/\" href=\"/redirect?url=http%3A%2F%2Fwhashp.myshopify.com%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://whashp.myshopify.com/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e - works\u003c/li\u003e\n\u003cli\u003eor \u003ca title=\"http://lmfshp.myshopify.com/\" href=\"/redirect?url=http%3A%2F%2Flmfshp.myshopify.com%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://lmfshp.myshopify.com/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e - works\nOk. Let\u0026#39;s open payload with http:\u003c/li\u003e\n\u003cli\u003e\n\u003ca title=\"http://whashp.myshopify.com/?preview_theme_id%5B%5D=11288717\" href=\"/redirect?url=http%3A%2F%2Fwhashp.myshopify.com%2F%3Fpreview_theme_id%255B%255D%3D11288717\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://whashp.myshopify.com/?preview_theme_id%5B%5D=11288717\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e \u003c/li\u003e\n\u003cli\u003eor \u003ca title=\"http://lmfshp.myshopify.com/?preview_theme_id%5B%5D=11290937\" href=\"/redirect?url=http%3A%2F%2Flmfshp.myshopify.com%2F%3Fpreview_theme_id%255B%255D%3D11290937\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://lmfshp.myshopify.com/?preview_theme_id%5B%5D=11290937\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\nThe same 500 error on shop frontend. And this affected on any url, for example:\n\u003ca title=\"http://whashp.myshopify.com/blogs/news\" href=\"/redirect?url=http%3A%2F%2Fwhashp.myshopify.com%2Fblogs%2Fnews\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://whashp.myshopify.com/blogs/news\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\nI found two urls that not affected to this issue on shop frontend:\n\u003ca title=\"https://whashp.myshopify.com/opening_soon\" href=\"/redirect?url=https%3A%2F%2Fwhashp.myshopify.com%2Fopening_soon\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://whashp.myshopify.com/opening_soon\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\n\u003ca title=\"https://whashp.myshopify.com/admin\" href=\"/redirect?url=https%3A%2F%2Fwhashp.myshopify.com%2Fadmin\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://whashp.myshopify.com/admin\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\nBut open of any of it not remove error from frontend\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eThere is way to remove error -  delete _secure_session_id (for https) and _session_id cookies on shop\u0026#39;s domain name.\u003c/p\u003e\n\n\u003cp\u003eInteresting restriction is in theme id. Before next test we should remove error and test that frontend works (\u003ca title=\"https://whashp.myshopify.com\" href=\"/redirect?url=https%3A%2F%2Fwhashp.myshopify.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://whashp.myshopify.com\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e). If all good:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003elet\u0026#39;s try to open \u003ca title=\"https://whashp.myshopify.com/?preview_theme_id%5B%5D=11290937\" href=\"/redirect?url=https%3A%2F%2Fwhashp.myshopify.com%2F%3Fpreview_theme_id%255B%255D%3D11290937\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://whashp.myshopify.com/?preview_theme_id%5B%5D=11290937\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e - we got \u0026quot;Can\u0026#39;t preview theme\u0026quot; response. So, to proper attack we need some theme id. How can we get it?\u003c/li\u003e\n\u003cli\u003eopen source of \u003ca title=\"https://whashp.myshopify.com/\" href=\"/redirect?url=https%3A%2F%2Fwhashp.myshopify.com%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://whashp.myshopify.com/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e (before shops is not active it can be done only after login, but any active shops have no problem to access front page). So, open source code and findline like this:\nShopify.theme = {\u0026quot;name\u0026quot;:\u0026quot;launchpad-star\u0026quot;,\u0026quot;id\u0026quot;:11288717,\u0026quot;theme_store_id\u0026quot;:null,\u0026quot;role\u0026quot;:\u0026quot;main\u0026quot;};\n\u0026quot;id\u0026quot;:11288717 - is proper id which will work in payload - \u003ca title=\"https://whashp.myshopify.com/?preview_theme_id%5B%5D=11288717\" href=\"/redirect?url=https%3A%2F%2Fwhashp.myshopify.com%2F%3Fpreview_theme_id%255B%255D%3D11288717\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://whashp.myshopify.com/?preview_theme_id%5B%5D=11288717\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e \u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eAs i said in begin - very strange behavior affected only user whom opened malicios url. But:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eattacker can retrieve proper theme id for any active shop from source code\u003c/li\u003e\n\u003cli\u003ethis url request is not protected for CSRF\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eSo, attack vector is:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eOpen source code of victim.myshopify.com (some famous shop) and find theme id\u003c/li\u003e\n\u003cli\u003eCreate malicious urls (both for http and https)  \u003ca title=\"https://victim.myshopify.com/?preview_theme_id%5B%5D=%ID_FROM_SOURCE_CODE%\" href=\"/redirect?url=https%3A%2F%2Fvictim.myshopify.com%2F%3Fpreview_theme_id%255B%255D%3D%25ID_FROM_SOURCE_CODE%25\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://victim.myshopify.com/?preview_theme_id%5B%5D=%ID_FROM_SOURCE_CODE%\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e Place this urls in place where as many as possible users open it. It may be image in shop layout (for example some xss issue) or just buy cheap iframed traffic and so on.\nAs a result any users that opened this urls will have problem with work with victim.myshopify.com shop.\u003c/li\u003e\n\u003c/ol\u003e\n","bounty_amount":"500.0","formatted_bounty":"$500","weakness":{"id":48,"name":"Denial of Service"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":34235,"file_name":"500_2.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/034/235/42d5c8e886be9801bee15cd2ced955f763feab44/500_2.png?response-content-disposition=attachment%3B%20filename%3D%22500_2.png%22%3B%20filename%2A%3DUTF-8%27%27500_2.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ3UNE4J5L%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T062014Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCz7kjO3QyFP7jGDkA5krNaLE6O2p1tR4x0TQtjMemDwQIhALc5Qo7beEygqpMNylJrOurNEmXX%2FUaJ7i3JOGstSxsEKrQDCFcQARoMMDEzNjE5Mjc0ODQ5IgxX2Y8wmCeqyUWE5MQqkQO1SEq9Kl%2BewQlhrlfUoVvv9N1OLaMkWrWIlv8SukYusm40FYD0qUCOJT%2BzitdeP3Kr9dqa%2BJmxV7c3%2BjXo4WulUP6OrfhUn0Rcu3T1VRcH6Qpx%2FGLAa4zE5IBGMdsXZEcR335EaBEylCpdLxObdeJZ8wmT%2FiMsJqVnexQRWK0gOcg8%2BaAe0Z4MQhfL%2FVbk8%2Botr0dFlI%2FaPx8jXCrTw%2FTlRp0P9OtpSvUQA1RBVrS5L3ZNrC33bQ4md%2B9KmXmIycB047RJuvaypZW9qepGhczrUMsYabbxifZ%2FJ17yJLs39h1ENkrjIFD7f9gA%2F9u%2BsTKrtFMmGu8%2FrThH1%2FAJX2J2V%2FiXJ%2Fj2flmFEXmyNg7XqFuZ2VEFhEknqlw0sjyH5ibXryf8lYs%2FL9ye%2FbGye3G8MgjG1rQQkaNLm9nZxru2uR4y5NwW33D%2F%2F27wPuxj5YAD30GEm3l3%2BfNuoV8Y%2Fa6KBiEG2ZFNI%2Fu9t%2F7aALxmsSX49Fkt%2Fvbd%2B2ORICgPABnOO5GRZQldPJ3fh%2FPtVXm3oDDyjav%2FBTrqAWjMucnwKi73c9CZ4eV75rJ5%2B4PnghCALwGiHX4zE11a5NOtuIpj8v3a2y9AJMGR0JyOdjGEipkC8KkLqeEMFaYnCk4oCce5NwJVnhh%2F8yBh%2BJDy7WhfYG2qUirylB1Ud3rl1KSDWno%2BbVYDQgs2rcyOKmLb%2FH1USBmJPVZi3%2FK%2F%2FJ6%2BATEV10VMohl2iHY7GlXPewFvZ2tG%2FogGkzwNQUb%2BD2o7r0beeLXek5XslTtgqNCoDP9xL1i88F02X5Buj81GAIlEB1qQFUoRMd2N%2Fu0SnL64HSNiPSzstRRJidfEI6C%2F%2FcDv%2BmWfcA%3D%3D\u0026X-Amz-Signature=95a8d6e2a24b0b3581fb3e68ad513d89e754f2ab48033170a4b3c420f0dbf53c","file_size":22913,"type":"image/png"},{"id":34236,"file_name":"500_1.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/034/236/ea4a52a65f3eb0e7d6b3010be2e47f4c3f0e56cc/500_1.png?response-content-disposition=attachment%3B%20filename%3D%22500_1.png%22%3B%20filename%2A%3DUTF-8%27%27500_1.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ3UNE4J5L%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T062014Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCz7kjO3QyFP7jGDkA5krNaLE6O2p1tR4x0TQtjMemDwQIhALc5Qo7beEygqpMNylJrOurNEmXX%2FUaJ7i3JOGstSxsEKrQDCFcQARoMMDEzNjE5Mjc0ODQ5IgxX2Y8wmCeqyUWE5MQqkQO1SEq9Kl%2BewQlhrlfUoVvv9N1OLaMkWrWIlv8SukYusm40FYD0qUCOJT%2BzitdeP3Kr9dqa%2BJmxV7c3%2BjXo4WulUP6OrfhUn0Rcu3T1VRcH6Qpx%2FGLAa4zE5IBGMdsXZEcR335EaBEylCpdLxObdeJZ8wmT%2FiMsJqVnexQRWK0gOcg8%2BaAe0Z4MQhfL%2FVbk8%2Botr0dFlI%2FaPx8jXCrTw%2FTlRp0P9OtpSvUQA1RBVrS5L3ZNrC33bQ4md%2B9KmXmIycB047RJuvaypZW9qepGhczrUMsYabbxifZ%2FJ17yJLs39h1ENkrjIFD7f9gA%2F9u%2BsTKrtFMmGu8%2FrThH1%2FAJX2J2V%2FiXJ%2Fj2flmFEXmyNg7XqFuZ2VEFhEknqlw0sjyH5ibXryf8lYs%2FL9ye%2FbGye3G8MgjG1rQQkaNLm9nZxru2uR4y5NwW33D%2F%2F27wPuxj5YAD30GEm3l3%2BfNuoV8Y%2Fa6KBiEG2ZFNI%2Fu9t%2F7aALxmsSX49Fkt%2Fvbd%2B2ORICgPABnOO5GRZQldPJ3fh%2FPtVXm3oDDyjav%2FBTrqAWjMucnwKi73c9CZ4eV75rJ5%2B4PnghCALwGiHX4zE11a5NOtuIpj8v3a2y9AJMGR0JyOdjGEipkC8KkLqeEMFaYnCk4oCce5NwJVnhh%2F8yBh%2BJDy7WhfYG2qUirylB1Ud3rl1KSDWno%2BbVYDQgs2rcyOKmLb%2FH1USBmJPVZi3%2FK%2F%2FJ6%2BATEV10VMohl2iHY7GlXPewFvZ2tG%2FogGkzwNQUb%2BD2o7r0beeLXek5XslTtgqNCoDP9xL1i88F02X5Buj81GAIlEB1qQFUoRMd2N%2Fu0SnL64HSNiPSzstRRJidfEI6C%2F%2FcDv%2BmWfcA%3D%3D\u0026X-Amz-Signature=d9872668830fd77d2d2a7b320b06722baf6f91c19c00bb7e8b706ef20c5e8e33","file_size":84861,"type":"image/png"},{"id":34237,"file_name":"500_3.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/034/237/6b2138c4ba12cf51679beb6ae3890809e01b6a4f/500_3.png?response-content-disposition=attachment%3B%20filename%3D%22500_3.png%22%3B%20filename%2A%3DUTF-8%27%27500_3.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ3UNE4J5L%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T062014Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCz7kjO3QyFP7jGDkA5krNaLE6O2p1tR4x0TQtjMemDwQIhALc5Qo7beEygqpMNylJrOurNEmXX%2FUaJ7i3JOGstSxsEKrQDCFcQARoMMDEzNjE5Mjc0ODQ5IgxX2Y8wmCeqyUWE5MQqkQO1SEq9Kl%2BewQlhrlfUoVvv9N1OLaMkWrWIlv8SukYusm40FYD0qUCOJT%2BzitdeP3Kr9dqa%2BJmxV7c3%2BjXo4WulUP6OrfhUn0Rcu3T1VRcH6Qpx%2FGLAa4zE5IBGMdsXZEcR335EaBEylCpdLxObdeJZ8wmT%2FiMsJqVnexQRWK0gOcg8%2BaAe0Z4MQhfL%2FVbk8%2Botr0dFlI%2FaPx8jXCrTw%2FTlRp0P9OtpSvUQA1RBVrS5L3ZNrC33bQ4md%2B9KmXmIycB047RJuvaypZW9qepGhczrUMsYabbxifZ%2FJ17yJLs39h1ENkrjIFD7f9gA%2F9u%2BsTKrtFMmGu8%2FrThH1%2FAJX2J2V%2FiXJ%2Fj2flmFEXmyNg7XqFuZ2VEFhEknqlw0sjyH5ibXryf8lYs%2FL9ye%2FbGye3G8MgjG1rQQkaNLm9nZxru2uR4y5NwW33D%2F%2F27wPuxj5YAD30GEm3l3%2BfNuoV8Y%2Fa6KBiEG2ZFNI%2Fu9t%2F7aALxmsSX49Fkt%2Fvbd%2B2ORICgPABnOO5GRZQldPJ3fh%2FPtVXm3oDDyjav%2FBTrqAWjMucnwKi73c9CZ4eV75rJ5%2B4PnghCALwGiHX4zE11a5NOtuIpj8v3a2y9AJMGR0JyOdjGEipkC8KkLqeEMFaYnCk4oCce5NwJVnhh%2F8yBh%2BJDy7WhfYG2qUirylB1Ud3rl1KSDWno%2BbVYDQgs2rcyOKmLb%2FH1USBmJPVZi3%2FK%2F%2FJ6%2BATEV10VMohl2iHY7GlXPewFvZ2tG%2FogGkzwNQUb%2BD2o7r0beeLXek5XslTtgqNCoDP9xL1i88F02X5Buj81GAIlEB1qQFUoRMd2N%2Fu0SnL64HSNiPSzstRRJidfEI6C%2F%2FcDv%2BmWfcA%3D%3D\u0026X-Amz-Signature=9c57922772563d1740e069420ca2f684e0a6698e447d68fe77ec5654cac94ffd","file_size":99373,"type":"image/png"}],"allow_singular_disclosure_at":"2015-07-09T21:26:00.447Z","allow_singular_disclosure_after":-172745654.0324824,"singular_disclosure_allowed":true,"vote_count":5,"voters":["sw33tlie","exception","spetr0x","webtrack","crossv3rify"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":378510,"is_internal":false,"editable":false,"type":"Activities::BugNotApplicable","message":"Your report does not describe a security issue. A 500 error can mean a lot of things, it is not necessarily dangerous.","markdown_message":"\u003cp\u003eYour report does not describe a security issue. A 500 error can mean a lot of things, it is not necessarily dangerous.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-04-12T20:56:26.378Z","updated_at":"2015-04-12T20:56:26.378Z","actor":{"username":"francoischagnon","cleared":false,"url":"/francoischagnon","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/168/5d577fe97283a5483331257b629b6287ed4d287b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":378584,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"On my mind issue not in 500 error as is. But that attacker can easy archive a Denial of Service of any shop that uses shopify. \nExample vector:\n1. Get any shop and find any stored XSS in it (In test purpose open http://whashp.myshopify.com/ and use password freull to unlock it).\n2. Fetch theme id from source code as described (in this case theme id is 11288717).\n3. Make XSS with payload:\n\u003cimg src=\"https://victim.myshopify.com/?preview_theme_id[]=%ID_FROM_SOURCE_CODE%\"/\u003e\n\u003cimg src=\"http://victim.myshopify.com/?preview_theme_id[]=%ID_FROM_SOURCE_CODE%\" /\u003e\n4. Any user that opened this shop (if this xss affected whole site) or some page(s) (if affected not all site) will get a 500 error. And this error will be continued till _session_id and _secure_session_id not expired.\nIn this test open http://whashp.myshopify.com/pages/about-us (payload insert in template - emulate xss on some shop's page) - page opened and payload fired.  And then open any shop's page - you will get a 500 error and as a result a Denial of Service for any user that open this shop.\n\n","markdown_message":"\u003cp\u003eOn my mind issue not in 500 error as is. But that attacker can easy archive a Denial of Service of any shop that uses shopify. \u003cbr\u003e\nExample vector:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eGet any shop and find any stored XSS in it (In test purpose open \u003ca title=\"http://whashp.myshopify.com/\" href=\"/redirect?url=http%3A%2F%2Fwhashp.myshopify.com%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://whashp.myshopify.com/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e and use password freull to unlock it).\u003c/li\u003e\n\u003cli\u003eFetch theme id from source code as described (in this case theme id is 11288717).\u003c/li\u003e\n\u003cli\u003eMake XSS with payload:\n\u0026lt;img src=\u0026quot;https://victim.myshopify.com/?preview_theme_id[]=%ID_FROM_SOURCE_CODE%\u0026quot;/\u0026gt;\n\u0026lt;img src=\u0026quot;http://victim.myshopify.com/?preview_theme_id[]=%ID_FROM_SOURCE_CODE%\u0026quot; /\u0026gt;\u003c/li\u003e\n\u003cli\u003eAny user that opened this shop (if this xss affected whole site) or some page(s) (if affected not all site) will get a 500 error. And this error will be continued till _session_id and _secure_session_id not expired.\nIn this test open \u003ca title=\"http://whashp.myshopify.com/pages/about-us\" href=\"/redirect?url=http%3A%2F%2Fwhashp.myshopify.com%2Fpages%2Fabout-us\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://whashp.myshopify.com/pages/about-us\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e (payload insert in template - emulate xss on some shop\u0026#39;s page) - page opened and payload fired.  And then open any shop\u0026#39;s page - you will get a 500 error and as a result a Denial of Service for any user that open this shop.\u003c/li\u003e\n\u003c/ol\u003e\n","automated_response":false,"created_at":"2015-04-12T23:50:03.656Z","updated_at":"2015-04-12T23:50:03.656Z","actor":{"username":"4lemon","cleared":true,"url":"/4lemon","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/194/aa0eb7d0d4c0ee7d20ae9b2550953b4eeda26ef9_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":34631,"filename":"Screenshot_2015-04-13_02.42.43.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/034/631/f117bf4e03883498fcfeb4c4be230e6c1c89c3ae/Screenshot_2015-04-13_02.42.43.png?response-content-disposition=attachment%3B%20filename%3D%22Screenshot_2015-04-13_02.42.43.png%22%3B%20filename%2A%3DUTF-8%27%27Screenshot_2015-04-13_02.42.43.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ3UNE4J5L%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T062014Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCz7kjO3QyFP7jGDkA5krNaLE6O2p1tR4x0TQtjMemDwQIhALc5Qo7beEygqpMNylJrOurNEmXX%2FUaJ7i3JOGstSxsEKrQDCFcQARoMMDEzNjE5Mjc0ODQ5IgxX2Y8wmCeqyUWE5MQqkQO1SEq9Kl%2BewQlhrlfUoVvv9N1OLaMkWrWIlv8SukYusm40FYD0qUCOJT%2BzitdeP3Kr9dqa%2BJmxV7c3%2BjXo4WulUP6OrfhUn0Rcu3T1VRcH6Qpx%2FGLAa4zE5IBGMdsXZEcR335EaBEylCpdLxObdeJZ8wmT%2FiMsJqVnexQRWK0gOcg8%2BaAe0Z4MQhfL%2FVbk8%2Botr0dFlI%2FaPx8jXCrTw%2FTlRp0P9OtpSvUQA1RBVrS5L3ZNrC33bQ4md%2B9KmXmIycB047RJuvaypZW9qepGhczrUMsYabbxifZ%2FJ17yJLs39h1ENkrjIFD7f9gA%2F9u%2BsTKrtFMmGu8%2FrThH1%2FAJX2J2V%2FiXJ%2Fj2flmFEXmyNg7XqFuZ2VEFhEknqlw0sjyH5ibXryf8lYs%2FL9ye%2FbGye3G8MgjG1rQQkaNLm9nZxru2uR4y5NwW33D%2F%2F27wPuxj5YAD30GEm3l3%2BfNuoV8Y%2Fa6KBiEG2ZFNI%2Fu9t%2F7aALxmsSX49Fkt%2Fvbd%2B2ORICgPABnOO5GRZQldPJ3fh%2FPtVXm3oDDyjav%2FBTrqAWjMucnwKi73c9CZ4eV75rJ5%2B4PnghCALwGiHX4zE11a5NOtuIpj8v3a2y9AJMGR0JyOdjGEipkC8KkLqeEMFaYnCk4oCce5NwJVnhh%2F8yBh%2BJDy7WhfYG2qUirylB1Ud3rl1KSDWno%2BbVYDQgs2rcyOKmLb%2FH1USBmJPVZi3%2FK%2F%2FJ6%2BATEV10VMohl2iHY7GlXPewFvZ2tG%2FogGkzwNQUb%2BD2o7r0beeLXek5XslTtgqNCoDP9xL1i88F02X5Buj81GAIlEB1qQFUoRMd2N%2Fu0SnL64HSNiPSzstRRJidfEI6C%2F%2FcDv%2BmWfcA%3D%3D\u0026X-Amz-Signature=06a9b22464332dd8d5624bcfaec65caceccd221532d8e5e8543524175c89b995"},{"id":34630,"filename":"Screenshot_2015-04-13_02.44.48.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/034/630/3578b4a874d655d4616c0bb7d1652f705ad8f377/Screenshot_2015-04-13_02.44.48.png?response-content-disposition=attachment%3B%20filename%3D%22Screenshot_2015-04-13_02.44.48.png%22%3B%20filename%2A%3DUTF-8%27%27Screenshot_2015-04-13_02.44.48.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ3UNE4J5L%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T062014Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCz7kjO3QyFP7jGDkA5krNaLE6O2p1tR4x0TQtjMemDwQIhALc5Qo7beEygqpMNylJrOurNEmXX%2FUaJ7i3JOGstSxsEKrQDCFcQARoMMDEzNjE5Mjc0ODQ5IgxX2Y8wmCeqyUWE5MQqkQO1SEq9Kl%2BewQlhrlfUoVvv9N1OLaMkWrWIlv8SukYusm40FYD0qUCOJT%2BzitdeP3Kr9dqa%2BJmxV7c3%2BjXo4WulUP6OrfhUn0Rcu3T1VRcH6Qpx%2FGLAa4zE5IBGMdsXZEcR335EaBEylCpdLxObdeJZ8wmT%2FiMsJqVnexQRWK0gOcg8%2BaAe0Z4MQhfL%2FVbk8%2Botr0dFlI%2FaPx8jXCrTw%2FTlRp0P9OtpSvUQA1RBVrS5L3ZNrC33bQ4md%2B9KmXmIycB047RJuvaypZW9qepGhczrUMsYabbxifZ%2FJ17yJLs39h1ENkrjIFD7f9gA%2F9u%2BsTKrtFMmGu8%2FrThH1%2FAJX2J2V%2FiXJ%2Fj2flmFEXmyNg7XqFuZ2VEFhEknqlw0sjyH5ibXryf8lYs%2FL9ye%2FbGye3G8MgjG1rQQkaNLm9nZxru2uR4y5NwW33D%2F%2F27wPuxj5YAD30GEm3l3%2BfNuoV8Y%2Fa6KBiEG2ZFNI%2Fu9t%2F7aALxmsSX49Fkt%2Fvbd%2B2ORICgPABnOO5GRZQldPJ3fh%2FPtVXm3oDDyjav%2FBTrqAWjMucnwKi73c9CZ4eV75rJ5%2B4PnghCALwGiHX4zE11a5NOtuIpj8v3a2y9AJMGR0JyOdjGEipkC8KkLqeEMFaYnCk4oCce5NwJVnhh%2F8yBh%2BJDy7WhfYG2qUirylB1Ud3rl1KSDWno%2BbVYDQgs2rcyOKmLb%2FH1USBmJPVZi3%2FK%2F%2FJ6%2BATEV10VMohl2iHY7GlXPewFvZ2tG%2FogGkzwNQUb%2BD2o7r0beeLXek5XslTtgqNCoDP9xL1i88F02X5Buj81GAIlEB1qQFUoRMd2N%2Fu0SnL64HSNiPSzstRRJidfEI6C%2F%2FcDv%2BmWfcA%3D%3D\u0026X-Amz-Signature=4ef758b677d061b799c8fbb4cf622a1c05c17ee43b1a47546609f8c941dcf5e5"}],"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":378610,"is_internal":false,"editable":false,"type":"Activities::BugReopened","message":"Thanks for the clarifications, I did not understand your original report correctly. I will take a closer look.","markdown_message":"\u003cp\u003eThanks for the clarifications, I did not understand your original report correctly. I will take a closer look.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-04-13T04:19:14.325Z","updated_at":"2015-04-13T04:19:14.325Z","actor":{"username":"francoischagnon","cleared":false,"url":"/francoischagnon","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/168/5d577fe97283a5483331257b629b6287ed4d287b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":383434,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"I opened the issue in our bug tracker and our engineering team will look into it.","markdown_message":"\u003cp\u003eI opened the issue in our bug tracker and our engineering team will look into it.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-04-17T18:23:46.835Z","updated_at":"2015-04-17T18:23:46.835Z","actor":{"username":"francoischagnon","cleared":false,"url":"/francoischagnon","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/168/5d577fe97283a5483331257b629b6287ed4d287b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":392535,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"any update?","markdown_message":"\u003cp\u003eany update?\u003c/p\u003e\n","automated_response":false,"created_at":"2015-04-28T11:06:34.751Z","updated_at":"2015-04-28T11:06:34.751Z","actor":{"username":"4lemon","cleared":true,"url":"/4lemon","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/194/aa0eb7d0d4c0ee7d20ae9b2550953b4eeda26ef9_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":448166,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"This vulnerability has been fixed. Thanks for helping improve the security of Shopify!","markdown_message":"\u003cp\u003eThis vulnerability has been fixed. Thanks for helping improve the security of Shopify!\u003c/p\u003e\n","automated_response":false,"created_at":"2015-06-09T21:25:41.295Z","updated_at":"2015-06-09T21:25:41.295Z","actor":{"url":"/shopify","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Shopify"}},"bounty_amount":"500.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"shopify","collaborator":{"username":"4lemon","url":"/4lemon"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":448167,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2015-06-09T21:25:54.396Z","updated_at":"2015-06-09T21:25:54.396Z","actor":{"username":"andrewdunbar","cleared":false,"url":"/andrewdunbar","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/164/5b0e89675ed6dbb9df87223e9f8f58e2125bb56b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"4lemon","url":"/4lemon"},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":448168,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-06-09T21:26:00.240Z","updated_at":"2015-06-09T21:26:00.240Z","first_to_agree":true,"actor":{"username":"andrewdunbar","cleared":false,"url":"/andrewdunbar","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/164/5b0e89675ed6dbb9df87223e9f8f58e2125bb56b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":448434,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-06-09T23:43:39.614Z","updated_at":"2015-06-09T23:43:39.614Z","actor":{"username":"4lemon","cleared":true,"url":"/4lemon","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/194/aa0eb7d0d4c0ee7d20ae9b2550953b4eeda26ef9_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":448435,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-06-09T23:43:40.052Z","updated_at":"2015-06-09T23:43:40.052Z","actor":{"username":"4lemon","cleared":true,"url":"/4lemon","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/194/aa0eb7d0d4c0ee7d20ae9b2550953b4eeda26ef9_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}