{"id":209398,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMDkzOTg=","url":"https://hackerone.com/reports/209398","title":"HTML Injection in email from http://www.lahitapiola.fi/henkilo/sivut/tonttutesti","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2017-02-27T20:20:25.371Z","submitted_at":"2017-02-27T20:20:25.371Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"billy_blaze","url":"/billy_blaze","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":8416,"url":"https://hackerone.com/localtapiola","handle":"localtapiola","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/008/416/b6fbd7e94497b0ffaee584d2e7096c5d5e2082e2_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/416/b6fbd7e94497b0ffaee584d2e7096c5d5e2082e2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"LocalTapiola","twitter_handle":"","website":"http://www.lahitapiola.fi","about":"LocalTapiola’s products and services cover non-life, life and pension insurance, as well as investment and saving services."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2017-03-13T15:44:47.727Z","bug_reporter_agreed_on_going_public_at":"2017-03-13T15:44:47.681Z","team_member_agreed_on_going_public_at":"2017-03-13T14:43:35.691Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"## Basic report information\n**Summary:** HTML Injection in email from http://www.lahitapiola.fi/henkilo/sivut/tonttutesti\n\n**Description:** Tonttutesti´s kutsu kaverisi feature sends email to friend with a link to Localtapiola´s tonttutesti site. Fields \"Nimesi\" and \"Kaverisi nimi\" seem to be vulnerable.\n\n**Domain:** http://www.lahitapiola.fi/henkilo/sivut/tonttutesti\n\n## Browsers / Apps Verified In:\n\n  *Chrome 56\n\n## Steps To Reproduce:\n\n1. Go to http://www.lahitapiola.fi/henkilo/sivut/tonttutesti\n2. To Nimesi and Kaverisi nimi fields insert \"\u003e\u003ca href=\"https://google.com\"\u003etest\u003c/a\u003e \n3. Fill rest of fields with any date and proper emails addresses \n5. Go to email provided (kaverisi sähköpostiosoite)\n\n## Additional material\n\n  * Received Localtapiolas email in text:\n Hei b\"\u003etest\n Kaverisi a\"\u003etest kutsui sinut käyttämään vertailukonetta: Mikä tonttu olet?\n Kaverisi viesti:\n f\"\u003etest\n Osoite: http://www.lahitapiola.fi/henkilo/sivut/tonttutesti\n\n## Related reports, best practices\n\n  * https://hackerone.com/reports/190867","vulnerability_information_html":"\u003ch2 id=\"basic-report-information\"\u003eBasic report information\u003c/h2\u003e\n\n\u003cp\u003e\u003cstrong\u003eSummary:\u003c/strong\u003e HTML Injection in email from \u003ca title=\"http://www.lahitapiola.fi/henkilo/sivut/tonttutesti\" href=\"/redirect?url=http%3A%2F%2Fwww.lahitapiola.fi%2Fhenkilo%2Fsivut%2Ftonttutesti\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://www.lahitapiola.fi/henkilo/sivut/tonttutesti\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eDescription:\u003c/strong\u003e Tonttutesti´s kutsu kaverisi feature sends email to friend with a link to Localtapiola´s tonttutesti site. Fields \u0026quot;Nimesi\u0026quot; and \u0026quot;Kaverisi nimi\u0026quot; seem to be vulnerable.\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eDomain:\u003c/strong\u003e \u003ca title=\"http://www.lahitapiola.fi/henkilo/sivut/tonttutesti\" href=\"/redirect?url=http%3A%2F%2Fwww.lahitapiola.fi%2Fhenkilo%2Fsivut%2Ftonttutesti\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://www.lahitapiola.fi/henkilo/sivut/tonttutesti\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2 id=\"browsers-apps-verified-in\"\u003eBrowsers / Apps Verified In:\u003c/h2\u003e\n\n\u003cp\u003e*Chrome 56\u003c/p\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps To Reproduce:\u003c/h2\u003e\n\n\u003col\u003e\n\u003cli\u003eGo to \u003ca title=\"http://www.lahitapiola.fi/henkilo/sivut/tonttutesti\" href=\"/redirect?url=http%3A%2F%2Fwww.lahitapiola.fi%2Fhenkilo%2Fsivut%2Ftonttutesti\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://www.lahitapiola.fi/henkilo/sivut/tonttutesti\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003eTo Nimesi and Kaverisi nimi fields insert \u0026quot;\u0026gt;\u0026lt;a href=\u0026quot;https://google.com\u0026quot;\u0026gt;test\u0026lt;/a\u0026gt; \u003c/li\u003e\n\u003cli\u003eFill rest of fields with any date and proper emails addresses \u003c/li\u003e\n\u003cli\u003eGo to email provided (kaverisi sähköpostiosoite)\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003ch2 id=\"additional-material\"\u003eAdditional material\u003c/h2\u003e\n\n\u003cul\u003e\n\u003cli\u003eReceived Localtapiolas email in text:\nHei b\u0026quot;\u0026gt;test\nKaverisi a\u0026quot;\u0026gt;test kutsui sinut käyttämään vertailukonetta: Mikä tonttu olet?\nKaverisi viesti:\nf\u0026quot;\u0026gt;test\nOsoite: \u003ca title=\"http://www.lahitapiola.fi/henkilo/sivut/tonttutesti\" href=\"/redirect?url=http%3A%2F%2Fwww.lahitapiola.fi%2Fhenkilo%2Fsivut%2Ftonttutesti\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://www.lahitapiola.fi/henkilo/sivut/tonttutesti\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch2 id=\"related-reports-best-practices\"\u003eRelated reports, best practices\u003c/h2\u003e\n\n\u003cul\u003e\n\u003cli\u003e\u003ca title=\"https://hackerone.com/reports/190867\" href=\"https://hackerone.com/reports/190867\"\u003ehttps://hackerone.com/reports/190867\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n","bounty_amount":"264.0","formatted_bounty":"$264","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2017-04-12T14:43:35.733Z","allow_singular_disclosure_after":-117209558.03393793,"singular_disclosure_allowed":true,"vote_count":6,"voters":["delimitry","eveeez","t-4-y-m","rbcafe","spetr0x","k3nt0y"],"severity":{"rating":"low","author_type":"Team"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1509249,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks a lot for reporting this potential issue back to us. LocalTapiola takes security very seriously and would appreciate if you would not share any information about this report until we have determined whether this is a bug and what any potential impact (or fix) will be.\n\nOur security team will take a look at this issue as soon as possible. We aim to respond to your report as soon as possible, but due to the complexity of the systems, triaging many times can take a long time. We prioritize issues -  reports containing trivial issues with limited (or no) business impact and badly written reports with insufficient information on how to reproduce the issue receive a lower priority. Please do not request updates for at least 20 days into the process. Once triaged and verified, bounty decisions are made 1-2 times per month.\n\n*Note: if we frequently dismiss your reports, make sure you have read our policy and stay in scope and that you know how to write good reports - https://support.hackerone.com/hc/en-us/articles/211538803-Step-by-Step-How-to-write-a-good-vulnerability-report*","markdown_message":"\u003cp\u003eThanks a lot for reporting this potential issue back to us. LocalTapiola takes security very seriously and would appreciate if you would not share any information about this report until we have determined whether this is a bug and what any potential impact (or fix) will be.\u003c/p\u003e\n\n\u003cp\u003eOur security team will take a look at this issue as soon as possible. We aim to respond to your report as soon as possible, but due to the complexity of the systems, triaging many times can take a long time. We prioritize issues -  reports containing trivial issues with limited (or no) business impact and badly written reports with insufficient information on how to reproduce the issue receive a lower priority. Please do not request updates for at least 20 days into the process. Once triaged and verified, bounty decisions are made 1-2 times per month.\u003c/p\u003e\n\n\u003cp\u003e\u003cem\u003eNote: if we frequently dismiss your reports, make sure you have read our policy and stay in scope and that you know how to write good reports - \u003ca title=\"https://support.hackerone.com/hc/en-us/articles/211538803-Step-by-Step-How-to-write-a-good-vulnerability-report\" href=\"/redirect?url=https%3A%2F%2Fsupport.hackerone.com%2Fhc%2Fen-us%2Farticles%2F211538803-Step-by-Step-How-to-write-a-good-vulnerability-report\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://support.hackerone.com/hc/en-us/articles/211538803-Step-by-Step-How-to-write-a-good-vulnerability-report\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/em\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2017-02-27T20:22:30.768Z","updated_at":"2017-02-27T20:22:30.768Z","actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1509256,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"By the looks of it, this application should have been taken offline a while ago.","markdown_message":"\u003cp\u003eBy the looks of it, this application should have been taken offline a while ago.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-02-27T20:23:08.140Z","updated_at":"2017-02-27T20:23:08.140Z","actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1511208,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Yep. Not so \"Tonttu\" time anymore.","markdown_message":"\u003cp\u003eYep. Not so \u0026quot;Tonttu\u0026quot; time anymore.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-02-28T15:35:30.675Z","updated_at":"2017-02-28T15:35:30.675Z","actor":{"username":"billy_blaze","cleared":false,"url":"/billy_blaze","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1513057,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"The page has been removed. Bounty decisions again in a few weeks. Thanks.","markdown_message":"\u003cp\u003eThe page has been removed. Bounty decisions again in a few weeks. Thanks.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-03-01T10:16:50.082Z","updated_at":"2017-03-01T10:16:50.082Z","actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1513979,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks. Time is endless.\n\nIf you choose Localtapiola customer service or Locatapiola´s  people as a target session leakage could come into question. I believe it is restricted to do so(test against Localtapiola employees) that outcome using this kind of vulnerabilities similar to https://hackerone.com/reports/159498. \n\nYou guys have good knowledge what can be achieved by using vulnerability and most probably you won´t need more info what could be done using #190867, #209394 and #209398 and targeting proper employees or instances. In case you are in doubt of the severity of these findings and need more proof, please notify proper target for me.","markdown_message":"\u003cp\u003eThanks. Time is endless.\u003c/p\u003e\n\n\u003cp\u003eIf you choose Localtapiola customer service or Locatapiola´s  people as a target session leakage could come into question. I believe it is restricted to do so(test against Localtapiola employees) that outcome using this kind of vulnerabilities similar to \u003ca title=\"https://hackerone.com/reports/159498\" href=\"https://hackerone.com/reports/159498\"\u003ehttps://hackerone.com/reports/159498\u003c/a\u003e. \u003c/p\u003e\n\n\u003cp\u003eYou guys have good knowledge what can be achieved by using vulnerability and most probably you won´t need more info what could be done using \u003ca href=\"/reports/190867\"\u003e#190867\u003c/a\u003e, \u003ca href=\"/reports/209394\"\u003e#209394\u003c/a\u003e and \u003ca href=\"/reports/209398\"\u003e#209398\u003c/a\u003e and targeting proper employees or instances. In case you are in doubt of the severity of these findings and need more proof, please notify proper target for me.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-03-01T18:36:08.403Z","updated_at":"2017-03-01T18:36:45.663Z","actor":{"username":"billy_blaze","cleared":false,"url":"/billy_blaze","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1537582,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2017-03-13T14:42:11.860Z","updated_at":"2017-03-13T14:42:11.860Z","actor":{"url":"/localtapiola","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/416/b6fbd7e94497b0ffaee584d2e7096c5d5e2082e2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"LocalTapiola"}},"bounty_amount":"264.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"localtapiola","collaborator":{"username":"billy_blaze","url":"/billy_blaze"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1537585,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Closing as resolved. Thanks for your help.","markdown_message":"\u003cp\u003eClosing as resolved. Thanks for your help.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-03-13T14:43:03.762Z","updated_at":"2017-03-13T14:43:03.762Z","actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"billy_blaze","url":"/billy_blaze"},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1537588,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2017-03-13T14:43:20.541Z","updated_at":"2017-03-13T14:43:20.541Z","additional_data":{"old_severity":"Medium","new_severity":"Low","old_severity_id":28334,"new_severity_id":31023},"actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1537590,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Full disclosure.","markdown_message":"\u003cp\u003eFull disclosure.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-03-13T14:43:35.709Z","updated_at":"2017-03-13T14:43:35.709Z","first_to_agree":true,"actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1537781,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Thanks","markdown_message":"\u003cp\u003eThanks\u003c/p\u003e\n","automated_response":false,"created_at":"2017-03-13T15:44:47.698Z","updated_at":"2017-03-13T15:44:47.698Z","actor":{"username":"billy_blaze","cleared":false,"url":"/billy_blaze","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1537782,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-03-13T15:44:47.742Z","updated_at":"2017-03-13T15:44:47.742Z","actor":{"username":"billy_blaze","cleared":false,"url":"/billy_blaze","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":3510,"category":"team","content":"##Issue\n\nThe reporter found a form which contained an HTML-injection vector. By misusing the form, an attacker could send out legitimate looking emails with a link to a malicious site. The prospect for successful phishing is limited, as the contents of the emails sent out are defined in the application itself, but by playing around with different injections, the possibility of crafting realistic emails was still there.\n\n##Fix\n\nThe form was removed.\n\n##Reasoning\n\nThe issue was not highly critical, but still posed a valid vector for spoofing.\n","can_view?":true,"can_edit?":false,"content_html":"\u003ch2 id=\"issue\"\u003eIssue\u003c/h2\u003e\n\n\u003cp\u003eThe reporter found a form which contained an HTML-injection vector. By misusing the form, an attacker could send out legitimate looking emails with a link to a malicious site. The prospect for successful phishing is limited, as the contents of the emails sent out are defined in the application itself, but by playing around with different injections, the possibility of crafting realistic emails was still there.\u003c/p\u003e\n\n\u003ch2 id=\"fix\"\u003eFix\u003c/h2\u003e\n\n\u003cp\u003eThe form was removed.\u003c/p\u003e\n\n\u003ch2 id=\"reasoning\"\u003eReasoning\u003c/h2\u003e\n\n\u003cp\u003eThe issue was not highly critical, but still posed a valid vector for spoofing.\u003c/p\u003e\n"},{"category":"researcher","can_view?":true,"can_create?":false}]}