{"id":272221,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yNzIyMjE=","url":"https://hackerone.com/reports/272221","title":"Arbitrary local code execution via DLL hijacking from executable installer","state":"Closed","substate":"duplicate","severity_rating":"medium","readable_substate":"Duplicate","created_at":"2017-09-26T20:52:06.482Z","submitted_at":"2017-09-26T20:52:06.482Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"skanthak","url":"/skanthak","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":15688,"url":"https://hackerone.com/brave","handle":"brave","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/015/688/2aad5641af643ee4f4402896e4747293f6e9c5ca_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/688/2aad5641af643ee4f4402896e4747293f6e9c5ca_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Brave Software","twitter_handle":"brave","website":"https://brave.com","about":""}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2018-07-09T21:40:17.213Z","bug_reporter_agreed_on_going_public_at":"2018-06-07T22:41:08.967Z","team_member_agreed_on_going_public_at":"2018-07-09T21:40:17.078Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"\u003e NOTE! Thanks for submitting a report! Please fill all sections below with the pertinent details. Remember, the more detail you provide, the easier it is for us to verify and then potentially issue a bounty.\n\n## Summary:\n\nThe executable installer BraveSetup-ia32.exe is vulnerable to DLL hijacking: it loads (at least) version.dll from its application directory (which is typically the user's \"Downloads\" directory %USERPROFILE%\\Downloads) instead Windows' system directory %SystemRoot%\\System32\n\n## Products affected: \n\nWindows 7 and newer versions, Brave version 0.18.36\n\n## Steps To Reproduce:\n\nPlace the attached version.dll in %USERPROFILE%\\Downloads, download the current BraveSetup-ia32.exe and execute it: version.dll displays message boxes showing its caller.\n\n## Supporting Material/References:\n\nSee https://skanthak.homepage.t-online.de/sentinel.dll\n","vulnerability_information_html":"\u003cblockquote\u003e\n\u003cp\u003eNOTE! Thanks for submitting a report! Please fill all sections below with the pertinent details. Remember, the more detail you provide, the easier it is for us to verify and then potentially issue a bounty.\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003ch2 id=\"summary\"\u003eSummary:\u003c/h2\u003e\n\n\u003cp\u003eThe executable installer BraveSetup-ia32.exe is vulnerable to DLL hijacking: it loads (at least) version.dll from its application directory (which is typically the user\u0026#39;s \u0026quot;Downloads\u0026quot; directory %USERPROFILE%\\Downloads) instead Windows\u0026#39; system directory %SystemRoot%\\System32\u003c/p\u003e\n\n\u003ch2 id=\"products-affected\"\u003eProducts affected:\u003c/h2\u003e\n\n\u003cp\u003eWindows 7 and newer versions, Brave version 0.18.36\u003c/p\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps To Reproduce:\u003c/h2\u003e\n\n\u003cp\u003ePlace the attached version.dll in %USERPROFILE%\\Downloads, download the current BraveSetup-ia32.exe and execute it: version.dll displays message boxes showing its caller.\u003c/p\u003e\n\n\u003ch2 id=\"supporting-material-references\"\u003eSupporting Material/References:\u003c/h2\u003e\n\n\u003cp\u003eSee \u003ca title=\"https://skanthak.homepage.t-online.de/sentinel.dll\" href=\"/redirect?url=https%3A%2F%2Fskanthak.homepage.t-online.de%2Fsentinel.dll\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://skanthak.homepage.t-online.de/sentinel.dll\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","weakness":{"id":57,"name":"Violation of Secure Design Principles"},"original_report_id":224652,"original_report_url":"https://hackerone.com/reports/224652","attachments":[{"id":224268,"file_name":"VERSION.DLL","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/224/268/896ea3e6cb5346f95d83a4c89dd58faa1243c61a/VERSION.DLL?response-content-disposition=attachment%3B%20filename%3D%22VERSION.DLL%22%3B%20filename%2A%3DUTF-8%27%27VERSION.DLL\u0026response-content-type=application%2Fx-dosexec\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSC5UFWXL%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T051927Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJr%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCwK%2B%2BlMufFx2twThN55FpWvSNFMRcTw6DIMXMwu3SRJgIgbfhKiC5W8N8YFQB0Nj1%2Boe6pAlr8Ti%2FvGEEHHH13JNkqtAMIUxABGgwwMTM2MTkyNzQ4NDkiDKRKppBQcflzJsWylyqRAzVMKZ6jWFrSD2Y9kWok2waN0zNoEyuNoms1kUC37gd2cWniMYOCGZa9pHJ%2BTGOcJDE8mr7X3wJV03PeWNx%2FJ3x1t1adSeplF3kKkxVzwMpsJiOYMPMNaXbK6aN%2FVxaTTjwIHJMTw7ej%2BNad1lrBkNYM8xmTFPzJdlIn3krUMQVcm66POZCl3IpgIriUdvRQsdjWZjnf%2FUXejEcDwlys5fmmpAap4FXWkuE4xPD5JITrqd71Zc4guVr49IYqaJ9P8ZOa39l8Cm9yOfvHOdc%2FHHkeb3dhc64lVpxLQxnIzdRkUBVcVDfLrNaCOxpa9K0SDMt9HK%2B6%2F6SozxEKFb7iD2%2BQkM42Rwtm3vBMeKEUDeFG3yO5gW6KJtirosz7Y3m8DdEylt%2F8air6KKuH0wjD%2B9LfO7%2FWKZCn3h7tRVYtr71OXTcV4jMC7Q6El1VpYoy1%2FUyJLt0VlyMhH1u00hOd2Ed613mjv9Lq0b8iTU4W3vlCcM%2FtjGgBfI2lPMbp3cacOsLTQtiqUw%2FMXKZM7aikuuh%2BML6aqv8FOusBAaUZsZRvtcfsxqJAwQO39V21wLoeubOAIV%2BtvLyfXzwltZABeAGkBPYy8xl5ryQb8Y%2BKG%2FfwUfCGsCxtOppNqsZCDg0JzwPVO8CdiGO1QqRKJpkb23agNpWEIAa8FY4BpDjQUZHUIl4jWVfFWH2sizzpICjQxnSI3JQpi2%2B9GAdI3gAmweVyhKgicRGn9QyAfoRtqO3YWntGA8EeCXAhyWW%2BxebF5JNSGoYhvM72O00zG1YKAYz%2F6ymrbrJmLpZ0WbBqG4d2%2BRi9F0TVfiKq0rdWihYUV%2FstwlGLcPIVuYIDnBH4oA5HYk7pFw%3D%3D\u0026X-Amz-Signature=167f7023203872e7853ecd1d314317dcfda8c588a8d6a33db0a75317692e78b0","file_size":28312,"type":"application/x-dosexec"}],"allow_singular_disclosure_at":null,"vote_count":1,"voters":["an0nym0us"],"severity":{"rating":"medium","score":5.6,"author_type":"User","metrics":{"attack_vector":"local","attack_complexity":"low","privileges_required":"low","user_interaction":"required","scope":"unchanged","confidentiality":"high","integrity":"low","availability":"none"}},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":2029781,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Update: the correct URL for the references is https://skanthak.homepage.t-online.de/sentinel.html","markdown_message":"\u003cp\u003eUpdate: the correct URL for the references is \u003ca title=\"https://skanthak.homepage.t-online.de/sentinel.html\" href=\"/redirect?url=https%3A%2F%2Fskanthak.homepage.t-online.de%2Fsentinel.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://skanthak.homepage.t-online.de/sentinel.html\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2017-09-28T12:54:02.389Z","updated_at":"2017-09-28T12:54:02.389Z","actor":{"username":"skanthak","cleared":false,"url":"/skanthak","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2033973,"is_internal":false,"editable":false,"type":"Activities::BugDuplicate","message":"Hi,\n\nThank you for your submission. Unfortunately, we previously received similar report from another researcher. Your effort is nonetheless appreciated and we wish that you'll continue to research and submit any future security issues you find.\n\nRegards.\n","markdown_message":"\u003cp\u003eHi,\u003c/p\u003e\n\n\u003cp\u003eThank you for your submission. Unfortunately, we previously received similar report from another researcher. Your effort is nonetheless appreciated and we wish that you\u0026#39;ll continue to research and submit any future security issues you find.\u003c/p\u003e\n\n\u003cp\u003eRegards.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-09-29T21:20:29.581Z","updated_at":"2017-09-29T21:20:29.581Z","original_report_id":224652,"actor":{"username":"joystick","cleared":false,"url":"/joystick","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/167/228/0840eb314aa099d9369d475d9ef9ba6299e83822_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2856025,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-06-07T22:41:09.007Z","updated_at":"2018-06-07T22:41:09.007Z","first_to_agree":true,"actor":{"username":"skanthak","cleared":false,"url":"/skanthak","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3020667,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-07-09T21:40:17.120Z","updated_at":"2018-07-09T21:40:17.120Z","actor":{"username":"toml","cleared":false,"url":"/toml","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/229/717/56ea9edd04176aa3f29b215291bbc0b656699f67_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3020668,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-07-09T21:40:17.254Z","updated_at":"2018-07-09T21:40:17.254Z","actor":{"username":"toml","cleared":false,"url":"/toml","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/229/717/56ea9edd04176aa3f29b215291bbc0b656699f67_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}