{"id":5688,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC81Njg4","url":"https://hackerone.com/reports/5688","title":"User guessing/enumeration at  https://app.c2fo.com/api/password-reset","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2014-04-02T21:25:51.623Z","submitted_at":"2014-04-02T21:25:51.623Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"internetwache","url":"/internetwache","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/637/e5a294547160a5c885e21dacc358769675c8b0e9_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":75,"url":"https://hackerone.com/c2fo","handle":"c2fo","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/075/9038c81afd77c8dfdc322ba5cef5f512d1ce62b7_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/075/9038c81afd77c8dfdc322ba5cef5f512d1ce62b7_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"disabled","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"C2FO","twitter_handle":null,"website":"https://c2fo.com/","about":"Revolutionizing working capital to make businesses better."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2014-05-19T12:03:17.921Z","bug_reporter_agreed_on_going_public_at":"2014-04-19T15:39:02.574Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi there,\r\n\r\nI noticed a small information leak which allows an attacker to check whether an email address is associated with an account. \r\n\r\n###Steps to reproduce:\r\n\r\n1.  Send a POST-Request to the url https://app.c2fo.com/api/password-reset as the following example shows:\r\n\r\n```\r\nPOST /api/password-reset HTTP/1.1\r\nHost: app.c2fo.com\r\nContent-Type: application/x-www-form-urlencoded\r\nContent-Length: 37\r\n\r\nemailAddress=test%40internetwache.org\r\n```\r\n\r\n2. I registered an account with the email address, thus the server will respond with ```{\"inReset\":true}```, which means that the address is in use.\r\n\r\n3. Now resend the request again, but with an invalid address like \"foobar123@internetwache.org\". The application will tell use the following: ```{\"error\":\"invalid_email_address\"}```. \r\n\r\nThis way I can validate email addresses against your service.\r\n\r\n###Suggested fix: \r\nYou should always return a status message like: \"If your email exists in our database, you'll receive a reset link\". That way an attacker cannot distinguish between the two cases.\r\n\r\nThanks,\r\nSebastian","vulnerability_information_html":"\u003cp\u003eHi there,\u003c/p\u003e\n\n\u003cp\u003eI noticed a small information leak which allows an attacker to check whether an email address is associated with an account. \u003c/p\u003e\n\n\u003ch3 id=\"steps-to-reproduce\"\u003eSteps to reproduce:\u003c/h3\u003e\n\n\u003col\u003e\n\u003cli\u003e Send a POST-Request to the url \u003ca title=\"https://app.c2fo.com/api/password-reset\" href=\"/redirect?url=https%3A%2F%2Fapp.c2fo.com%2Fapi%2Fpassword-reset\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://app.c2fo.com/api/password-reset\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e as the following example shows:\u003c/li\u003e\n\u003c/ol\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ePOST /api/password-reset HTTP/1.1\nHost: app.c2fo.com\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 37\n\nemailAddress=test%40internetwache.org\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003col\u003e\n\u003cli\u003e\u003cp\u003eI registered an account with the email address, thus the server will respond with \u003ccode\u003e{\u0026quot;inReset\u0026quot;:true}\u003c/code\u003e, which means that the address is in use.\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eNow resend the request again, but with an invalid address like \u0026quot;\u003ca title=\"foobar123@internetwache.org\" href=\"mailto:foobar123@internetwache.org\" rel=\"nofollow noopener noreferrer\"\u003efoobar123@internetwache.org\u003c/a\u003e\u0026quot;. The application will tell use the following: \u003ccode\u003e{\u0026quot;error\u0026quot;:\u0026quot;invalid_email_address\u0026quot;}\u003c/code\u003e. \u003c/p\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eThis way I can validate email addresses against your service.\u003c/p\u003e\n\n\u003ch3 id=\"suggested-fix\"\u003eSuggested fix:\u003c/h3\u003e\n\n\u003cp\u003eYou should always return a status message like: \u0026quot;If your email exists in our database, you\u0026#39;ll receive a reset link\u0026quot;. That way an attacker cannot distinguish between the two cases.\u003c/p\u003e\n\n\u003cp\u003eThanks,\u003cbr\u003e\nSebastian\u003c/p\u003e\n","weakness":{"id":18,"name":"Information Disclosure"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2014-05-19T12:03:11.107Z","allow_singular_disclosure_after":-208721919.35327238,"singular_disclosure_allowed":true,"vote_count":1,"voters":["bb00x"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":23207,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2014-04-03T14:34:36.141Z","updated_at":"2014-04-03T14:34:36.141Z","actor":{"username":"prmcdonald","cleared":false,"url":"/prmcdonald","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"c2fo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":23208,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you for submitting this bug. We are already aware of this issue and have fix currently in testing. If you have any further questions, comments, or further information, please don't hesitate to contact us.","markdown_message":"\u003cp\u003eThank you for submitting this bug. We are already aware of this issue and have fix currently in testing. If you have any further questions, comments, or further information, please don\u0026#39;t hesitate to contact us.\u003c/p\u003e\n","automated_response":false,"created_at":"2014-04-03T14:35:46.988Z","updated_at":"2014-04-03T14:35:46.988Z","actor":{"username":"prmcdonald","cleared":false,"url":"/prmcdonald","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"c2fo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":23209,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi,\nalright :)\n\nThanks,\nSebastian","markdown_message":"\u003cp\u003eHi,\u003cbr\u003e\nalright :)\u003c/p\u003e\n\n\u003cp\u003eThanks,\u003cbr\u003e\nSebastian\u003c/p\u003e\n","automated_response":false,"created_at":"2014-04-03T14:38:38.508Z","updated_at":"2014-04-03T14:38:38.508Z","actor":{"username":"internetwache","cleared":false,"url":"/internetwache","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/637/e5a294547160a5c885e21dacc358769675c8b0e9_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"c2fo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":33166,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2014-04-19T12:03:11.224Z","updated_at":"2014-04-19T12:03:11.224Z","actor":{"username":"prmcdonald","cleared":false,"url":"/prmcdonald","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"internetwache","url":"/internetwache"},"genius_execution_id":null,"team_handle":"c2fo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":33206,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2014-04-19T15:39:02.590Z","updated_at":"2014-04-19T15:39:02.590Z","actor":{"username":"internetwache","cleared":false,"url":"/internetwache","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/637/e5a294547160a5c885e21dacc358769675c8b0e9_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"c2fo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":53483,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2014-05-19T12:03:17.934Z","updated_at":"2014-05-19T12:03:17.934Z","actor":{"url":"/c2fo","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/075/9038c81afd77c8dfdc322ba5cef5f512d1ce62b7_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"C2FO"}},"genius_execution_id":null,"team_handle":"c2fo","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}