{"id":232994,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMzI5OTQ=","url":"https://hackerone.com/reports/232994","title":"API Does Not Apply Access Controls to Translations","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2017-05-29T23:17:30.883Z","submitted_at":"2017-05-29T23:17:30.883Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"4cad","url":"/4cad","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/164/214/9c771a1b02e8d394ddd437b845191e13beb0ccc7_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":19468,"url":"https://hackerone.com/weblate","handle":"weblate","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/019/468/71eb3827ae9f2a388f27bd4b7eefd20bc3ac813c_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/468/71eb3827ae9f2a388f27bd4b7eefd20bc3ac813c_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Weblate","twitter_handle":"WeblateOrg","website":"https://weblate.org/","about":"Weblate is a libre software web-based continuous localization system"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-06-02T11:23:24.335Z","bug_reporter_agreed_on_going_public_at":"2017-06-02T11:23:24.229Z","team_member_agreed_on_going_public_at":"2017-06-02T09:51:31.822Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Summary\n=======\n\nThe /api/ does not enforce access control on the translation files, allowing anyone to download full translation files. See the screenshot for an example project being viewed by an anonymous account that is configured to have no permissions.\n\nDescription\n=======\nOn my local setup running Weblate 2.15-dev, I removed all permissions from the Guest group and restarted the server. When I tried to navigate to the test project through the UI the usual way at URL http://192.168.1.129:8000/projects/testproject/, I received an Access Denied message.\n\nHowever I was able to find the project details through the API at http://192.168.1.129:8000/api/components/testproject/testcomponent/translations/ and even download the translations file by clicking on the \"file_url\" link, which in my case is \"http://192.168.1.129:8000/api/translations/testproject/testcomponent/en_CA/file/\".\n\nAssessment\n=======\nI am marking this as Medium because from what I have seen the access controls are not that important to Weblate's mission and it does not seem designed to keep translations secret, although the existence of access controls through the web app suggests that this is something that people wanted enough to implement. If enforcing the read access controls is of any importance, then I would treat this with higher severity.","vulnerability_information_html":"\u003ch1 id=\"summary\"\u003eSummary\u003c/h1\u003e\n\n\u003cp\u003eThe /api/ does not enforce access control on the translation files, allowing anyone to download full translation files. See the screenshot for an example project being viewed by an anonymous account that is configured to have no permissions.\u003c/p\u003e\n\n\u003ch1 id=\"description\"\u003eDescription\u003c/h1\u003e\n\n\u003cp\u003eOn my local setup running Weblate 2.15-dev, I removed all permissions from the Guest group and restarted the server. When I tried to navigate to the test project through the UI the usual way at URL \u003ca title=\"http://192.168.1.129:8000/projects/testproject/\" href=\"/redirect?url=http%3A%2F%2F192.168.1.129%3A8000%2Fprojects%2Ftestproject%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://192.168.1.129:8000/projects/testproject/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e, I received an Access Denied message.\u003c/p\u003e\n\n\u003cp\u003eHowever I was able to find the project details through the API at \u003ca title=\"http://192.168.1.129:8000/api/components/testproject/testcomponent/translations/\" href=\"/redirect?url=http%3A%2F%2F192.168.1.129%3A8000%2Fapi%2Fcomponents%2Ftestproject%2Ftestcomponent%2Ftranslations%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://192.168.1.129:8000/api/components/testproject/testcomponent/translations/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e and even download the translations file by clicking on the \u0026quot;file_url\u0026quot; link, which in my case is \u0026quot;\u003ca title=\"http://192.168.1.129:8000/api/translations/testproject/testcomponent/en_CA/file/\" href=\"/redirect?url=http%3A%2F%2F192.168.1.129%3A8000%2Fapi%2Ftranslations%2Ftestproject%2Ftestcomponent%2Fen_CA%2Ffile%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://192.168.1.129:8000/api/translations/testproject/testcomponent/en_CA/file/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u0026quot;.\u003c/p\u003e\n\n\u003ch1 id=\"assessment\"\u003eAssessment\u003c/h1\u003e\n\n\u003cp\u003eI am marking this as Medium because from what I have seen the access controls are not that important to Weblate\u0026#39;s mission and it does not seem designed to keep translations secret, although the existence of access controls through the web app suggests that this is something that people wanted enough to implement. If enforcing the read access controls is of any importance, then I would treat this with higher severity.\u003c/p\u003e\n","weakness":{"id":26,"name":"Improper Access Control - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":189141,"file_name":"Weblate_API_Access_Control.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/189/141/7ecb2b3dd9b1fff17f5056af84440cb11a26712f/Weblate_API_Access_Control.png?response-content-disposition=attachment%3B%20filename%3D%22Weblate_API_Access_Control.png%22%3B%20filename%2A%3DUTF-8%27%27Weblate_API_Access_Control.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ6J7UOFHP%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T050610Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDamJ7YR2N3cIBOa8zjuSmUd9OCX8zCykCDx%2B6kH2J%2BlQIhAPFk51DuoGb47ygm%2F46VUWXIRiNzzPuAJCxpuNY6C9r8KrQDCFIQARoMMDEzNjE5Mjc0ODQ5IgwfJ9Wm2OgZB0TD5wEqkQMAyHxawucw3AMqEaVZmpdf%2FWoK6P8gu%2FCj%2FoC7vu86houcl7d5S1aesU3sbrOzgm6RSEhwz%2FFS3jL7D6T4JI4Ce1ND%2FrgO0lyXrQzDIcV61dzQW3FvNLr0ZImyyUdtac%2BXOj%2B4Yuxg3B%2Fw8%2FASrjXwhjBS66Kymk3L6dUfBdgwlGyaWjSrEj7pUe4QmHItRfpiYrIugF6V0YbiwTzCRnupZGkhFUvdnKltp%2B4hMIJ8ZpZXjRaPMFGYbJODmmGmpbXrkLNmtpD9ssAfsLLmMNbkAbfGTVhz1jb8jNtS70QChWZUcaVF%2BUJ%2BnjyviI%2BzOI3PvJo6%2BFF7nuwLNAutvngzDIQqSSVMoO%2F3MB45%2Bi7mOnnapSDDsV974XkQgCuM7vsb5p2hLCxzrxps5NEHGajQr5tkHe3qivszLUiVfsV43w8FYD%2BBONxEK7W9P8Fz8NZ67SyH7GG2ksQHMqmv0OcEaprPoRqnV3X2FUQMilKfrm8Mwo6y2b3BolwJdahB%2FiN%2B4DEDiSex%2FihlgZtj7Y4SxDDk%2FKn%2FBTrqAf559VpL8gNLdFBoVG3N%2FZOK1jnsPcfoIUSZtPAKUZCx%2FfYM8b4F5pg%2FUgEn1Lv%2B2LBdmNBasw6RmzajA5OSfdAMndyjJN9XxpB%2BQCxuWhR%2B4l3UYvcHCs0ptmeXrxe03i6oCQg6cNND1wBmViOKSrRB7ycvKEbOUFZtkHoRDVaID3Z%2BuOzyOMaLFXSvzsVsAcCFgFhIk5QJcY%2B1scZVna72pH8jnKw%2FwC1cIv1j%2FAmz0zBabFT7deSC5tUMl0pZQVYKiEGsgryYN9fSfaoMv2wR80e4kst1hVdlJHDktel9plUkLBliVB9%2BDQ%3D%3D\u0026X-Amz-Signature=d016d8d39d8c9d27e1a8b230fef357216b49b41c027b36d5aaff538812e00e05","file_size":241612,"type":"image/png"}],"allow_singular_disclosure_at":"2017-07-02T09:51:31.880Z","allow_singular_disclosure_after":-110229278.316268,"singular_disclosure_allowed":true,"vote_count":3,"voters":["eveeez","m7mdharoun","spetr0x"],"severity":{"rating":"low","score":3.7,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"high","privileges_required":"none","user_interaction":"none","scope":"unchanged","confidentiality":"low","integrity":"none","availability":"none"}},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1716045,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2017-05-31T14:03:26.063Z","updated_at":"2017-05-31T14:03:26.063Z","additional_data":{"old_severity":"Medium","new_severity":"Low (3.7)","old_severity_id":45684,"new_severity_id":46807},"actor":{"username":"nijel","cleared":false,"url":"/nijel","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/153/118/21d9e64f7cd44782a2ec35d76eaebf9294308c83_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"weblate","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1716051,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks for report, it seems you've indeed found a corner case in way how permissions are handled in the API - the removal of access project for guest user is not properly handled there. I've fixed this in https://github.com/WeblateOrg/weblate/commit/81c5cf69cd7a2fdbd10c01660509af7b02a3d0da\n\nI've adjusted the severity as this is really just a corner case which will probably not be used in most setups.\n\nCertainly this is not affecting Hosted Weblate service.","markdown_message":"\u003cp\u003eThanks for report, it seems you\u0026#39;ve indeed found a corner case in way how permissions are handled in the API - the removal of access project for guest user is not properly handled there. I\u0026#39;ve fixed this in \u003ca title=\"https://github.com/WeblateOrg/weblate/commit/81c5cf69cd7a2fdbd10c01660509af7b02a3d0da\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2FWeblateOrg%2Fweblate%2Fcommit%2F81c5cf69cd7a2fdbd10c01660509af7b02a3d0da\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/WeblateOrg/weblate/commit/81c5cf69cd7a2fdbd10c01660509af7b02a3d0da\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eI\u0026#39;ve adjusted the severity as this is really just a corner case which will probably not be used in most setups.\u003c/p\u003e\n\n\u003cp\u003eCertainly this is not affecting Hosted Weblate service.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-05-31T14:04:39.530Z","updated_at":"2017-05-31T14:04:39.530Z","actor":{"username":"nijel","cleared":false,"url":"/nijel","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/153/118/21d9e64f7cd44782a2ec35d76eaebf9294308c83_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"4cad","url":"/4cad"},"genius_execution_id":null,"team_handle":"weblate","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1717387,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Awesome, glad to hear it.","markdown_message":"\u003cp\u003eAwesome, glad to hear it.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-05-31T18:37:55.298Z","updated_at":"2017-05-31T18:37:55.298Z","actor":{"username":"4cad","cleared":true,"url":"/4cad","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/164/214/9c771a1b02e8d394ddd437b845191e13beb0ccc7_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"weblate","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1724452,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-06-02T09:51:31.844Z","updated_at":"2017-06-02T09:51:31.844Z","first_to_agree":true,"actor":{"username":"nijel","cleared":false,"url":"/nijel","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/153/118/21d9e64f7cd44782a2ec35d76eaebf9294308c83_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"weblate","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1724640,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-06-02T11:23:24.273Z","updated_at":"2017-06-02T11:23:24.273Z","actor":{"username":"4cad","cleared":true,"url":"/4cad","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/164/214/9c771a1b02e8d394ddd437b845191e13beb0ccc7_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"weblate","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1724641,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-06-02T11:23:24.362Z","updated_at":"2017-06-02T11:23:24.362Z","actor":{"username":"4cad","cleared":true,"url":"/4cad","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/164/214/9c771a1b02e8d394ddd437b845191e13beb0ccc7_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"weblate","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}