{"id":404898,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC80MDQ4OTg=","url":"https://hackerone.com/reports/404898","title":"XSS in HTML Content Generated by Flash Slideshow Maker (All Versions)","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2017-07-29T02:44:25.000Z","submitted_at":"2017-07-29T02:44:25.000Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"ret2eax","url":"/ret2eax","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/062/748/b4aa020d0ff6e8a7fe3b48fb0b3fd0fb4f08f851_original.jpeg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":32787,"url":"https://hackerone.com/socusoft","handle":"socusoft","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/032/787/910d50ae0233d3e77ec2ae7a2979397c42c325b3_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/032/787/910d50ae0233d3e77ec2ae7a2979397c42c325b3_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"profile":{"name":"Socusoft","twitter_handle":"","website":"http://www.socusoft.com/","about":""}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":true,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2018-09-04T18:29:58.607Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":null,"comments_closed?":true,"facebook_team?":false,"team_private?":false,"vulnerability_information":" The vulnerability identified does not exist within the software application itself, instead, the vulnerability presents itself within the application's exported files which end up hosted on an external web-server. Socusoft's Flash Slideshow Maker application has two configuration themes associated with generating the slideshow content, basic and advanced.\n\n The basic theme will generate a single SWF file containing the content embedded \n within. Whereas, the 'advanced' theme is XML driven. Meaning, in the final output,\n there will be the SWF itself, image files and an XML document containing the\n configuration that controls the SWFs behaviour. This  'advanced' theme \n configuration is the cause of why such a vulnerability exists. \n\n Therefore the themes associated with the advanced configuration are vulnerable,\n whereas the content associated with the themes outlined in the 'basic' \n configuration are not vulnerable. \n\nThis vulnerability exists not because of the SWF but due to the insecurity \n associated with it's XML configuration file, and the fact that the xml_path HTTP \n parameter trusts user supplied input. An attacker can pull the XML configuration \n containing the SWFs behavioural structure. In doing so, the attacker can mimic, \n forge and thus alter the pre-defined behaviour of the SWF by assigning malicious \n arbitrary values within the associated XML configuration parameters. Exploitation \n is  achieved by uploading the evil XML to a web server, where it is now possible \n to remotely call and include the fraudulent XML through the SWF via GET.\n \n An attacker can perform Content Forgery, Unvalidated Redirects, and\n XSS attacks against authenticated and un-authenticated users through the \n dissemination of a compromised URL.\n \n In order for any of the vulnerabilities (besides Content Forgery of course) \n to execute, the victim is required to click on the image within the slides. \n The likelihood of this can be enhanced through the XML configurations title \n variables, and setting the title to be staticly displayed, however this persuasion\n could also be conducted through the Content Forgery where a JPEG or any other \n image file can be displayed containing text to persuade the victim to perform the\n required user interaction.\n \n**Preconditions**\n\n In order to exploit this vulnerability, the attacker must have a correctly configured \n crossdomain policy running on the same server that they are hosting the malicious XML \n file. An example is as seen below:\n\n\t\u003c?xml version=\"1.0\"?\u003e\n\t\u003c!DOCTYPE cross-domain-policy SYSTEM \"http://www.adobe.com/xml/dtds/cross-domain-policy.dtd\"\u003e\n\t\u003ccross-domain-policy\u003e\n\t\u003csite-control permitted-cross-domain-policies=\"all\"/\u003e\n\t\u003callow-access-from domain=\"*\" secure=\"false\"/\u003e\n\t\u003callow-http-request-headers-from domain=\"*\" headers=\"*\" secure=\"false\"/\u003e\n\t\u003c/cross-domain-policy\u003e\n\n\n**Exploitation**\n Vulnerable endpoints can be located through the following Google Dork:\n filetype:swf inurl:?xml_path= \n\n *~ 64,500* potentially vulnerable endpoints match this criteria.\n\n Obtain the SWFs XML configuration, by replacing the .swf extension value with that \n of the called GET .xml value stored in the xml_path HTTP parameter. Once obtained,\n edit the XML configuration to control the SWFs behaviour. Finally host it on a\n web server where it can then be called through setting the xml_path parameter to\n point to the now manipulated XML config; ?xml_path=//domain.com/path/to/evil.xml\n again, to execute XSS and evil redirects, click on the image containing the \n associated payload.   \n\n ","vulnerability_information_html":"\u003cp\u003eThe vulnerability identified does not exist within the software application itself, instead, the vulnerability presents itself within the application\u0026#39;s exported files which end up hosted on an external web-server. Socusoft\u0026#39;s Flash Slideshow Maker application has two configuration themes associated with generating the slideshow content, basic and advanced.\u003c/p\u003e\n\n\u003cp\u003eThe basic theme will generate a single SWF file containing the content embedded \u003cbr\u003e\n within. Whereas, the \u0026#39;advanced\u0026#39; theme is XML driven. Meaning, in the final output,\u003cbr\u003e\n there will be the SWF itself, image files and an XML document containing the\u003cbr\u003e\n configuration that controls the SWFs behaviour. This  \u0026#39;advanced\u0026#39; theme \u003cbr\u003e\n configuration is the cause of why such a vulnerability exists. \u003c/p\u003e\n\n\u003cp\u003eTherefore the themes associated with the advanced configuration are vulnerable,\u003cbr\u003e\n whereas the content associated with the themes outlined in the \u0026#39;basic\u0026#39; \u003cbr\u003e\n configuration are not vulnerable. \u003c/p\u003e\n\n\u003cp\u003eThis vulnerability exists not because of the SWF but due to the insecurity \u003cbr\u003e\n associated with it\u0026#39;s XML configuration file, and the fact that the xml_path HTTP \u003cbr\u003e\n parameter trusts user supplied input. An attacker can pull the XML configuration \u003cbr\u003e\n containing the SWFs behavioural structure. In doing so, the attacker can mimic, \u003cbr\u003e\n forge and thus alter the pre-defined behaviour of the SWF by assigning malicious \u003cbr\u003e\n arbitrary values within the associated XML configuration parameters. Exploitation \u003cbr\u003e\n is  achieved by uploading the evil XML to a web server, where it is now possible \u003cbr\u003e\n to remotely call and include the fraudulent XML through the SWF via GET.\u003c/p\u003e\n\n\u003cp\u003eAn attacker can perform Content Forgery, Unvalidated Redirects, and\u003cbr\u003e\n XSS attacks against authenticated and un-authenticated users through the \u003cbr\u003e\n dissemination of a compromised URL.\u003c/p\u003e\n\n\u003cp\u003eIn order for any of the vulnerabilities (besides Content Forgery of course) \u003cbr\u003e\n to execute, the victim is required to click on the image within the slides. \u003cbr\u003e\n The likelihood of this can be enhanced through the XML configurations title \u003cbr\u003e\n variables, and setting the title to be staticly displayed, however this persuasion\u003cbr\u003e\n could also be conducted through the Content Forgery where a JPEG or any other \u003cbr\u003e\n image file can be displayed containing text to persuade the victim to perform the\u003cbr\u003e\n required user interaction.\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003ePreconditions\u003c/strong\u003e\u003c/p\u003e\n\n\u003cp\u003eIn order to exploit this vulnerability, the attacker must have a correctly configured \u003cbr\u003e\n crossdomain policy running on the same server that they are hosting the malicious XML \u003cbr\u003e\n file. An example is as seen below:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight xml\"\u003e\u003ccode\u003e\u003cspan class=\"cp\"\u003e\u0026lt;?xml version=\u0026quot;1.0\u0026quot;?\u0026gt;\u003c/span\u003e\n\u003cspan class=\"cp\"\u003e\u0026lt;!DOCTYPE cross-domain-policy SYSTEM \u0026quot;http://www.adobe.com/xml/dtds/cross-domain-policy.dtd\u0026quot;\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;cross-domain-policy\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;site-control\u003c/span\u003e \u003cspan class=\"na\"\u003epermitted-cross-domain-policies=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;all\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;allow-access-from\u003c/span\u003e \u003cspan class=\"na\"\u003edomain=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;*\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003esecure=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;false\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;allow-http-request-headers-from\u003c/span\u003e \u003cspan class=\"na\"\u003edomain=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;*\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003eheaders=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;*\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003esecure=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;false\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/cross-domain-policy\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e\u003cstrong\u003eExploitation\u003c/strong\u003e\u003cbr\u003e\n Vulnerable endpoints can be located through the following Google Dork:\u003cbr\u003e\n filetype:swf inurl:?xml_path= \u003c/p\u003e\n\n\u003cp\u003e\u003cem\u003e~ 64,500\u003c/em\u003e potentially vulnerable endpoints match this criteria.\u003c/p\u003e\n\n\u003cp\u003eObtain the SWFs XML configuration, by replacing the .swf extension value with that \u003cbr\u003e\n of the called GET .xml value stored in the xml_path HTTP parameter. Once obtained,\u003cbr\u003e\n edit the XML configuration to control the SWFs behaviour. Finally host it on a\u003cbr\u003e\n web server where it can then be called through setting the xml_path parameter to\u003cbr\u003e\n point to the now manipulated XML config; ?xml_path=//domain.com/path/to/evil.xml\u003cbr\u003e\n again, to execute XSS and evil redirects, click on the image containing the \u003cbr\u003e\n associated payload.   \u003c/p\u003e\n","original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":34,"voters":["filedescriptor","eveeez","what_web","grampae","gkkamath","bb00x","ret2eax","cryptographer","rgomezle","xoonek403","and 24 more..."],"severity":{"rating":"medium","score":5.4,"author_type":"User","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"none","user_interaction":"required","scope":"unchanged","confidentiality":"low","integrity":"low","availability":"none"}},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":3287225,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2018-09-03T02:44:25.000Z","updated_at":"2018-09-03T02:44:25.000Z","actor":{"username":"ret2eax","cleared":false,"url":"/ret2eax","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/062/748/b4aa020d0ff6e8a7fe3b48fb0b3fd0fb4f08f851_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"ret2eax","url":"/ret2eax"},"genius_execution_id":null,"team_handle":"socusoft","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3291781,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-09-04T18:29:58.689Z","updated_at":"2018-09-04T18:29:58.689Z","actor":{"username":"ret2eax","cleared":false,"url":"/ret2eax","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/062/748/b4aa020d0ff6e8a7fe3b48fb0b3fd0fb4f08f851_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"socusoft","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3457935,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2018-10-09T22:39:15.311Z","updated_at":"2018-10-09T22:39:15.311Z","additional_data":{"old_severity":null,"new_severity":"Medium (5.4)","old_severity_id":null,"new_severity_id":222554},"actor":{"username":"ret2eax","cleared":false,"url":"/ret2eax","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/062/748/b4aa020d0ff6e8a7fe3b48fb0b3fd0fb4f08f851_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"socusoft","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"id":10224,"category":"researcher","content":" Socusoft's Flash Slideshow Maker is a Flash Shockwave (SWF) movie maker containing static \n images which are presented in a HTML slideshow format. All versions appear to be vulnerable (http://www.socusoft.com/flash-slideshow-maker.php).","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eSocusoft\u0026#39;s Flash Slideshow Maker is a Flash Shockwave (SWF) movie maker containing static \u003cbr\u003e\n images which are presented in a HTML slideshow format. All versions appear to be vulnerable (\u003ca title=\"http://www.socusoft.com/flash-slideshow-maker.php\" href=\"/redirect?url=http%3A%2F%2Fwww.socusoft.com%2Fflash-slideshow-maker.php\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://www.socusoft.com/flash-slideshow-maker.php\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e).\u003c/p\u003e\n"}]}