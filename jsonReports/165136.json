{"id":165136,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNjUxMzY=","url":"https://hackerone.com/reports/165136","title":"target=\"_blank\" Vulnerability Resulting in Critical Phishing Vector","state":"Closed","substate":"informative","readable_substate":"Informative","created_at":"2016-09-01T22:24:55.984Z","submitted_at":"2016-09-01T22:24:55.984Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"cha5m","url":"/cha5m","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/015/840/b0932455c8769047def8966e465f84b88f92756a_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1366,"url":"https://hackerone.com/mapbox","handle":"mapbox","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/366/d4dfa3c8752e3849cdfb22fea49c17bd37f03850_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/366/d4dfa3c8752e3849cdfb22fea49c17bd37f03850_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Mapbox","twitter_handle":"mapbox","website":"https://www.mapbox.com/security","about":"Mapbox is an open source mapping platform, providing building blocks for developers to integrate location into any mobile or online application."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2016-09-07T19:16:33.058Z","bug_reporter_agreed_on_going_public_at":"2016-09-06T23:22:40.429Z","team_member_agreed_on_going_public_at":"2016-09-07T19:16:32.923Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"**Description**\nI have a script running on my server which gives me full control over a visitor's window object. This allows me to replace the user's legitimate mapbox.com session with my own Mapbox phishing form (not live). As you can see from the proof-of-concept video below, this vulnerability works cross-origin. This is an extremely effective phishing vector and should be remediated ASAP. \n\n**Video PoC:** {F116642}\n\n**Reproduction Steps:**\n1. Navigate to my map at https://www.mapbox.com/editor/?id=chasemiller5.19coghk8#data\n2. Click on my website link in the description (http://chasemiller.me/hax/mapbox_test.html) \n3. This should open the link and change the user's legitimate mapbox.com session to my malicious Mapbox login phishing page (not active) (behavior may vary slightly between browsers).\n\n**Mitigation:**\nThis bug can be easily mitigated by using the 'noopener' link type. This sets the 'window.opener' property to 'null'","vulnerability_information_html":"\u003cp\u003e\u003cstrong\u003eDescription\u003c/strong\u003e\u003cbr\u003e\nI have a script running on my server which gives me full control over a visitor\u0026#39;s window object. This allows me to replace the user\u0026#39;s legitimate mapbox.com session with my own Mapbox phishing form (not live). As you can see from the proof-of-concept video below, this vulnerability works cross-origin. This is an extremely effective phishing vector and should be remediated ASAP. \u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eVideo PoC:\u003c/strong\u003e \u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"PoC_Mapbox.mov\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/116/642/2ddeada55a91d8686da9a470d8d1876dc36cdfef/PoC_Mapbox.mov?response-content-disposition=attachment%3B%20filename%3D%22PoC_Mapbox.mov%22%3B%20filename%2A%3DUTF-8%27%27PoC_Mapbox.mov\u0026amp;response-content-type=video%2Fquicktime\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQ4HB4ZZGG%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T043844Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIFBKbMTaGKwVCK0x7JNAOijlMVw%2BhW%2FIG%2FoSYnjiHiHKAiALX1HXrCEc%2FI%2FnVrq803X%2FALiQpBxAlCHE%2Bh8zwqcfmSq0AwhVEAEaDDAxMzYxOTI3NDg0OSIM1pLsQIVwlUu9%2FWdzKpEDno5dfN3IVf%2B7OsdAYS9SWEsPaEcB2YetTOtoMoT8QkXafStRJxQSEckvansRxadLw3NEtOPJvUCKQ1FSfSh7PFvC6uVfFJETqBnLL3fMQIGcAQZlOES1A7KCuxJT2s%2FayJYm9KXYzydI49kvJbjn3MhPgu4OzSnr601lrMTBegiJpfNO%2B%2FeSktzRhCINpAxF%2F2a4j2lstKLfaje8wR6hRJqdSRWJF9M8hMiccij8fb6xzNCHJahS%2BfaEo7RLAy5%2FPpBxYVi3ogO%2Bi%2F4BRT3eb1Z9RpGG9qNkGuyY7ce3DvMgdTkSjHBcsYXBywd8fd%2BaBZwWJd5uw351hwVm22gEjaBsMXjDBuKYWVQcA%2BrEoUuOGGuH6bDr%2B2WdDMHHXX7MgZgH7ziMbq2HG%2FZKMv1Xym51QlR6qp3%2BP6Xz3oMScAiG6Dqm%2FjDmNx9bwBHdu7tvsWABnhe6esdM9Fno0WZ3lIkHOq4HRIf10Qe%2BDDAUhhVc45YNdWlThBy0I6Le7VinfP6o%2F%2BKPpdhWEDht%2BPKwSuwwvNGq%2FwU67AHczVFtKf2TPLO9ophgOhkJ%2BZe077T3hvPbRZ7D4GzMnizYODRG9nQWzx68CzHlMuom3RU16aBeESIBNhc9NjST%2Bt3Bw%2FkvdjiPIAwfnnl0ATW5KpAuIAujTjCnWWC5x9o79v0x9%2Bnkl%2BlSYo41rg7HDE%2BhHWG7fKOUzGpWpyUJFwUo4XO2BBz%2F9JPwjpoD5vZa6vKnLi1NmWkYRn1R6E4QMqIGHABVzTr2BlnRNMM7IY6DbFqrNpuXMJjVs26ZuTl70H1lwMzeG43ORGVGlYhsYokTZrRPzq8ZdhxoEwkFN0OgfU2QSH1HVj5iow%3D%3D\u0026amp;X-Amz-Signature=78e5c7fcf2b55e2c88f177768db1bde0b62fd67a345316038e711ff6db9ab1a3\" data-attachment-type=\"video/quicktime\"\u003e\u003cvideo controls=\"controls\" src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/116/642/2ddeada55a91d8686da9a470d8d1876dc36cdfef/PoC_Mapbox.mov?response-content-disposition=attachment%3B%20filename%3D%22PoC_Mapbox.mov%22%3B%20filename%2A%3DUTF-8%27%27PoC_Mapbox.mov\u0026amp;response-content-type=video%2Fquicktime\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQ4HB4ZZGG%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T043844Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIFBKbMTaGKwVCK0x7JNAOijlMVw%2BhW%2FIG%2FoSYnjiHiHKAiALX1HXrCEc%2FI%2FnVrq803X%2FALiQpBxAlCHE%2Bh8zwqcfmSq0AwhVEAEaDDAxMzYxOTI3NDg0OSIM1pLsQIVwlUu9%2FWdzKpEDno5dfN3IVf%2B7OsdAYS9SWEsPaEcB2YetTOtoMoT8QkXafStRJxQSEckvansRxadLw3NEtOPJvUCKQ1FSfSh7PFvC6uVfFJETqBnLL3fMQIGcAQZlOES1A7KCuxJT2s%2FayJYm9KXYzydI49kvJbjn3MhPgu4OzSnr601lrMTBegiJpfNO%2B%2FeSktzRhCINpAxF%2F2a4j2lstKLfaje8wR6hRJqdSRWJF9M8hMiccij8fb6xzNCHJahS%2BfaEo7RLAy5%2FPpBxYVi3ogO%2Bi%2F4BRT3eb1Z9RpGG9qNkGuyY7ce3DvMgdTkSjHBcsYXBywd8fd%2BaBZwWJd5uw351hwVm22gEjaBsMXjDBuKYWVQcA%2BrEoUuOGGuH6bDr%2B2WdDMHHXX7MgZgH7ziMbq2HG%2FZKMv1Xym51QlR6qp3%2BP6Xz3oMScAiG6Dqm%2FjDmNx9bwBHdu7tvsWABnhe6esdM9Fno0WZ3lIkHOq4HRIf10Qe%2BDDAUhhVc45YNdWlThBy0I6Le7VinfP6o%2F%2BKPpdhWEDht%2BPKwSuwwvNGq%2FwU67AHczVFtKf2TPLO9ophgOhkJ%2BZe077T3hvPbRZ7D4GzMnizYODRG9nQWzx68CzHlMuom3RU16aBeESIBNhc9NjST%2Bt3Bw%2FkvdjiPIAwfnnl0ATW5KpAuIAujTjCnWWC5x9o79v0x9%2Bnkl%2BlSYo41rg7HDE%2BhHWG7fKOUzGpWpyUJFwUo4XO2BBz%2F9JPwjpoD5vZa6vKnLi1NmWkYRn1R6E4QMqIGHABVzTr2BlnRNMM7IY6DbFqrNpuXMJjVs26ZuTl70H1lwMzeG43ORGVGlYhsYokTZrRPzq8ZdhxoEwkFN0OgfU2QSH1HVj5iow%3D%3D\u0026amp;X-Amz-Signature=78e5c7fcf2b55e2c88f177768db1bde0b62fd67a345316038e711ff6db9ab1a3\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/video\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eReproduction Steps:\u003c/strong\u003e\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eNavigate to my map at \u003ca title=\"https://www.mapbox.com/editor/?id=chasemiller5.19coghk8#data\" href=\"/redirect?url=https%3A%2F%2Fwww.mapbox.com%2Feditor%2F%3Fid%3Dchasemiller5.19coghk8%23data\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.mapbox.com/editor/?id=chasemiller5.19coghk8#data\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003eClick on my website link in the description (\u003ca title=\"http://chasemiller.me/hax/mapbox_test.html\" href=\"/redirect?url=http%3A%2F%2Fchasemiller.me%2Fhax%2Fmapbox_test.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://chasemiller.me/hax/mapbox_test.html\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e) \u003c/li\u003e\n\u003cli\u003eThis should open the link and change the user\u0026#39;s legitimate mapbox.com session to my malicious Mapbox login phishing page (not active) (behavior may vary slightly between browsers).\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003e\u003cstrong\u003eMitigation:\u003c/strong\u003e\u003cbr\u003e\nThis bug can be easily mitigated by using the \u0026#39;noopener\u0026#39; link type. This sets the \u0026#39;window.opener\u0026#39; property to \u0026#39;null\u0026#39;\u003c/p\u003e\n","weakness":{"id":53,"name":"Open Redirect"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":116642,"file_name":"PoC_Mapbox.mov","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/116/642/2ddeada55a91d8686da9a470d8d1876dc36cdfef/PoC_Mapbox.mov?response-content-disposition=attachment%3B%20filename%3D%22PoC_Mapbox.mov%22%3B%20filename%2A%3DUTF-8%27%27PoC_Mapbox.mov\u0026response-content-type=video%2Fquicktime\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ4HB4ZZGG%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T043845Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIFBKbMTaGKwVCK0x7JNAOijlMVw%2BhW%2FIG%2FoSYnjiHiHKAiALX1HXrCEc%2FI%2FnVrq803X%2FALiQpBxAlCHE%2Bh8zwqcfmSq0AwhVEAEaDDAxMzYxOTI3NDg0OSIM1pLsQIVwlUu9%2FWdzKpEDno5dfN3IVf%2B7OsdAYS9SWEsPaEcB2YetTOtoMoT8QkXafStRJxQSEckvansRxadLw3NEtOPJvUCKQ1FSfSh7PFvC6uVfFJETqBnLL3fMQIGcAQZlOES1A7KCuxJT2s%2FayJYm9KXYzydI49kvJbjn3MhPgu4OzSnr601lrMTBegiJpfNO%2B%2FeSktzRhCINpAxF%2F2a4j2lstKLfaje8wR6hRJqdSRWJF9M8hMiccij8fb6xzNCHJahS%2BfaEo7RLAy5%2FPpBxYVi3ogO%2Bi%2F4BRT3eb1Z9RpGG9qNkGuyY7ce3DvMgdTkSjHBcsYXBywd8fd%2BaBZwWJd5uw351hwVm22gEjaBsMXjDBuKYWVQcA%2BrEoUuOGGuH6bDr%2B2WdDMHHXX7MgZgH7ziMbq2HG%2FZKMv1Xym51QlR6qp3%2BP6Xz3oMScAiG6Dqm%2FjDmNx9bwBHdu7tvsWABnhe6esdM9Fno0WZ3lIkHOq4HRIf10Qe%2BDDAUhhVc45YNdWlThBy0I6Le7VinfP6o%2F%2BKPpdhWEDht%2BPKwSuwwvNGq%2FwU67AHczVFtKf2TPLO9ophgOhkJ%2BZe077T3hvPbRZ7D4GzMnizYODRG9nQWzx68CzHlMuom3RU16aBeESIBNhc9NjST%2Bt3Bw%2FkvdjiPIAwfnnl0ATW5KpAuIAujTjCnWWC5x9o79v0x9%2Bnkl%2BlSYo41rg7HDE%2BhHWG7fKOUzGpWpyUJFwUo4XO2BBz%2F9JPwjpoD5vZa6vKnLi1NmWkYRn1R6E4QMqIGHABVzTr2BlnRNMM7IY6DbFqrNpuXMJjVs26ZuTl70H1lwMzeG43ORGVGlYhsYokTZrRPzq8ZdhxoEwkFN0OgfU2QSH1HVj5iow%3D%3D\u0026X-Amz-Signature=6d8a13f98419cc1bc2fca5d5762bca0d151c5532adbe0acad2161cee04d22e03","file_size":6379392,"type":"video/quicktime"}],"allow_singular_disclosure_at":null,"vote_count":4,"voters":["cha5m","muhammad_uwais","prem1807","dyabla"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1170304,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Thank you for your report.\n\nI don't believe I can access your map before its public, using the URL you have provided.  If I navigate to that link, I am asked to login to Mapbox, and when I log in to *my* Mapbox account, (rather than your Mapbox account), I cannot access your map.  Are you able to show a PoC that affects other Mapbox users?\n\nThanks, and good luck with your future bug hunting.","markdown_message":"\u003cp\u003eThank you for your report.\u003c/p\u003e\n\n\u003cp\u003eI don\u0026#39;t believe I can access your map before its public, using the URL you have provided.  If I navigate to that link, I am asked to login to Mapbox, and when I log in to \u003cem\u003emy\u003c/em\u003e Mapbox account, (rather than your Mapbox account), I cannot access your map.  Are you able to show a PoC that affects other Mapbox users?\u003c/p\u003e\n\n\u003cp\u003eThanks, and good luck with your future bug hunting.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-09-02T18:23:42.198Z","updated_at":"2016-09-02T18:23:42.198Z","actor":{"username":"bugtriage-josh","cleared":false,"url":"/bugtriage-josh","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mapbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1170481,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Hi @bugtriage-josh!\n\nThank you for the quick reply. My apologies, I didn't think about you not having access to my account (Duh! If you did, I think that would warrant a big bug bounty in itself.) \n\nOne specific delivery vector that would impact other Mapbox users would be to have the user create a new Mapbox Studio Classic Project by importing the following JSON. \n\n```\n{\"type\":\"FeatureCollection\",\"features\":[{\"type\":\"Feature\",\"properties\":{\"id\":\"marker-iskojtdy0\",\"title\":\"Marker\",\"description\":\"\u003ca href=\\\"http://chasemiller.me/hax/mapbox_test.html\\\"\u003eClick here\u003c/a\u003e\",\"marker-size\":\"medium\",\"marker-color\":\"#1087bf\",\"marker-symbol\":\"\"},\"geometry\":{\"coordinates\":[2.285156,24.206889],\"type\":\"Point\"},\"id\":\"b1b9753756f0d6828142e38471010e0b\"}],\"id\":\"chasemiller5.19coghk8\"}\n```\n\nIn this case, the steps to reproduce are:\n\n1. Log into your Mapbox account and navigate to Mapbox classic \u003e Mapbox editor project \u003e New Mapbox Editor Project\n2. Once in the new project, navigate to Data \u003e Import a JSON file containing the above JSON \u003e Complete Importing\n3. After importing, the single point should appear. Click on this point, and then the \"Here\" link would hijack the user's legitimate Mapbox dashboard tab and redirect the user to my phishing page.\n\nWhile this particular phishing attack vector is elaborate (and may be a bit of a stretch), it could be a legitimate concern.\n\nThanks,\nChase\n","markdown_message":"\u003cp\u003eHi \u003ca href=\"/bugtriage-josh\"\u003e@bugtriage-josh\u003c/a\u003e!\u003c/p\u003e\n\n\u003cp\u003eThank you for the quick reply. My apologies, I didn\u0026#39;t think about you not having access to my account (Duh! If you did, I think that would warrant a big bug bounty in itself.) \u003c/p\u003e\n\n\u003cp\u003eOne specific delivery vector that would impact other Mapbox users would be to have the user create a new Mapbox Studio Classic Project by importing the following JSON. \u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e{\u0026quot;type\u0026quot;:\u0026quot;FeatureCollection\u0026quot;,\u0026quot;features\u0026quot;:[{\u0026quot;type\u0026quot;:\u0026quot;Feature\u0026quot;,\u0026quot;properties\u0026quot;:{\u0026quot;id\u0026quot;:\u0026quot;marker-iskojtdy0\u0026quot;,\u0026quot;title\u0026quot;:\u0026quot;Marker\u0026quot;,\u0026quot;description\u0026quot;:\u0026quot;\u0026lt;a href=\\\u0026quot;http://chasemiller.me/hax/mapbox_test.html\\\u0026quot;\u0026gt;Click here\u0026lt;/a\u0026gt;\u0026quot;,\u0026quot;marker-size\u0026quot;:\u0026quot;medium\u0026quot;,\u0026quot;marker-color\u0026quot;:\u0026quot;#1087bf\u0026quot;,\u0026quot;marker-symbol\u0026quot;:\u0026quot;\u0026quot;},\u0026quot;geometry\u0026quot;:{\u0026quot;coordinates\u0026quot;:[2.285156,24.206889],\u0026quot;type\u0026quot;:\u0026quot;Point\u0026quot;},\u0026quot;id\u0026quot;:\u0026quot;b1b9753756f0d6828142e38471010e0b\u0026quot;}],\u0026quot;id\u0026quot;:\u0026quot;chasemiller5.19coghk8\u0026quot;}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eIn this case, the steps to reproduce are:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eLog into your Mapbox account and navigate to Mapbox classic \u0026gt; Mapbox editor project \u0026gt; New Mapbox Editor Project\u003c/li\u003e\n\u003cli\u003eOnce in the new project, navigate to Data \u0026gt; Import a JSON file containing the above JSON \u0026gt; Complete Importing\u003c/li\u003e\n\u003cli\u003eAfter importing, the single point should appear. Click on this point, and then the \u0026quot;Here\u0026quot; link would hijack the user\u0026#39;s legitimate Mapbox dashboard tab and redirect the user to my phishing page.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eWhile this particular phishing attack vector is elaborate (and may be a bit of a stretch), it could be a legitimate concern.\u003c/p\u003e\n\n\u003cp\u003eThanks,\u003cbr\u003e\nChase\u003c/p\u003e\n","automated_response":false,"created_at":"2016-09-02T19:49:38.771Z","updated_at":"2016-09-02T19:49:38.771Z","actor":{"username":"cha5m","cleared":true,"url":"/cha5m","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/840/b0932455c8769047def8966e465f84b88f92756a_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mapbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1170486,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Attaching the json file to make your life easier if you wanted to test it.","markdown_message":"\u003cp\u003eAttaching the json file to make your life easier if you wanted to test it.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-09-02T19:50:26.313Z","updated_at":"2016-09-02T19:50:26.313Z","actor":{"username":"cha5m","cleared":true,"url":"/cha5m","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/840/b0932455c8769047def8966e465f84b88f92756a_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":116878,"filename":"features.json","type":"text/html","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/116/878/8e0bcc91d0bf32e0f51dc2557e51cc7fac685b7b/features.json?response-content-disposition=attachment%3B%20filename%3D%22features.json%22%3B%20filename%2A%3DUTF-8%27%27features.json\u0026response-content-type=application%2Foctet-stream\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ4HB4ZZGG%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T043845Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIFBKbMTaGKwVCK0x7JNAOijlMVw%2BhW%2FIG%2FoSYnjiHiHKAiALX1HXrCEc%2FI%2FnVrq803X%2FALiQpBxAlCHE%2Bh8zwqcfmSq0AwhVEAEaDDAxMzYxOTI3NDg0OSIM1pLsQIVwlUu9%2FWdzKpEDno5dfN3IVf%2B7OsdAYS9SWEsPaEcB2YetTOtoMoT8QkXafStRJxQSEckvansRxadLw3NEtOPJvUCKQ1FSfSh7PFvC6uVfFJETqBnLL3fMQIGcAQZlOES1A7KCuxJT2s%2FayJYm9KXYzydI49kvJbjn3MhPgu4OzSnr601lrMTBegiJpfNO%2B%2FeSktzRhCINpAxF%2F2a4j2lstKLfaje8wR6hRJqdSRWJF9M8hMiccij8fb6xzNCHJahS%2BfaEo7RLAy5%2FPpBxYVi3ogO%2Bi%2F4BRT3eb1Z9RpGG9qNkGuyY7ce3DvMgdTkSjHBcsYXBywd8fd%2BaBZwWJd5uw351hwVm22gEjaBsMXjDBuKYWVQcA%2BrEoUuOGGuH6bDr%2B2WdDMHHXX7MgZgH7ziMbq2HG%2FZKMv1Xym51QlR6qp3%2BP6Xz3oMScAiG6Dqm%2FjDmNx9bwBHdu7tvsWABnhe6esdM9Fno0WZ3lIkHOq4HRIf10Qe%2BDDAUhhVc45YNdWlThBy0I6Le7VinfP6o%2F%2BKPpdhWEDht%2BPKwSuwwvNGq%2FwU67AHczVFtKf2TPLO9ophgOhkJ%2BZe077T3hvPbRZ7D4GzMnizYODRG9nQWzx68CzHlMuom3RU16aBeESIBNhc9NjST%2Bt3Bw%2FkvdjiPIAwfnnl0ATW5KpAuIAujTjCnWWC5x9o79v0x9%2Bnkl%2BlSYo41rg7HDE%2BhHWG7fKOUzGpWpyUJFwUo4XO2BBz%2F9JPwjpoD5vZa6vKnLi1NmWkYRn1R6E4QMqIGHABVzTr2BlnRNMM7IY6DbFqrNpuXMJjVs26ZuTl70H1lwMzeG43ORGVGlYhsYokTZrRPzq8ZdhxoEwkFN0OgfU2QSH1HVj5iow%3D%3D\u0026X-Amz-Signature=bd69d3e556a435927546df37151f179fd7fb171a5f6ee4eb58789325d99361e0"}],"genius_execution_id":null,"team_handle":"mapbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1178683,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"@n0rb3r7 -- thank you again for the great report!\n\nWe've had this issue reported to us in the past and have been keeping an eye on associated `rel=noopener` threads (e.g. [HTML spec](https://github.com/whatwg/html/pull/290), [Chrome](https://bugs.chromium.org/p/chromium/issues/detail?id=168988), [Firefox](https://bugzilla.mozilla.org/show_bug.cgi?id=1222516)). At this point we've decided to hold off a bit and see how the cross platform debate/patching of this issue progresses prior to moving forward with mitigating it on our end. In addition, [Mapbox classic editor](https://www.mapbox.com/editor) is a legacy product and the level of effort necessary to effectively exploit this vulnerability is relatively high. Given these factors, we don't feel the severity of this issue merits an immediate fix and will be closing this report as informative.\n\nThank you for thinking of Mapbox security and happy bug hunting!","markdown_message":"\u003cp\u003e\u003ca href=\"/n0rb3r7\"\u003e@n0rb3r7\u003c/a\u003e -- thank you again for the great report!\u003c/p\u003e\n\n\u003cp\u003eWe\u0026#39;ve had this issue reported to us in the past and have been keeping an eye on associated \u003ccode\u003erel=noopener\u003c/code\u003e threads (e.g. \u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fwhatwg%2Fhtml%2Fpull%2F290\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eHTML spec\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e, \u003ca href=\"/redirect?url=https%3A%2F%2Fbugs.chromium.org%2Fp%2Fchromium%2Fissues%2Fdetail%3Fid%3D168988\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eChrome\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e, \u003ca href=\"/redirect?url=https%3A%2F%2Fbugzilla.mozilla.org%2Fshow_bug.cgi%3Fid%3D1222516\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eFirefox\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e). At this point we\u0026#39;ve decided to hold off a bit and see how the cross platform debate/patching of this issue progresses prior to moving forward with mitigating it on our end. In addition, \u003ca href=\"/redirect?url=https%3A%2F%2Fwww.mapbox.com%2Feditor\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eMapbox classic editor\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e is a legacy product and the level of effort necessary to effectively exploit this vulnerability is relatively high. Given these factors, we don\u0026#39;t feel the severity of this issue merits an immediate fix and will be closing this report as informative.\u003c/p\u003e\n\n\u003cp\u003eThank you for thinking of Mapbox security and happy bug hunting!\u003c/p\u003e\n","automated_response":false,"created_at":"2016-09-06T22:06:26.022Z","updated_at":"2016-09-06T22:06:26.022Z","actor":{"username":"kmahoney","cleared":false,"url":"/kmahoney","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/096/304/5eef66c80ab6b392801c57ba5195e42e34599bac_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mapbox","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1178818,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Hi @kmahoney!\n\nThank you for the reply! :) I completely understand the decision, as it is a widely debated \"vulnerability\". Some programs have considered it to be a valid vulnerability while others have not. This one in particular was a stretch due to the delivery mechanism.\n\nI am working on a blog post discussing the vulnerability and my findings across several major sites and their responses. As such I am requesting public disclosure.\n\nThanks again!\n@n0rb3r7 ","markdown_message":"\u003cp\u003eHi \u003ca href=\"/kmahoney\"\u003e@kmahoney\u003c/a\u003e!\u003c/p\u003e\n\n\u003cp\u003eThank you for the reply! :) I completely understand the decision, as it is a widely debated \u0026quot;vulnerability\u0026quot;. Some programs have considered it to be a valid vulnerability while others have not. This one in particular was a stretch due to the delivery mechanism.\u003c/p\u003e\n\n\u003cp\u003eI am working on a blog post discussing the vulnerability and my findings across several major sites and their responses. As such I am requesting public disclosure.\u003c/p\u003e\n\n\u003cp\u003eThanks again!\u003cbr\u003e\n\u003ca href=\"/n0rb3r7\"\u003e@n0rb3r7\u003c/a\u003e \u003c/p\u003e\n","automated_response":false,"created_at":"2016-09-06T23:22:40.459Z","updated_at":"2016-09-06T23:22:40.459Z","first_to_agree":true,"actor":{"username":"cha5m","cleared":true,"url":"/cha5m","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/840/b0932455c8769047def8966e465f84b88f92756a_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mapbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1180776,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Absolutely. Mind sending a link to the post my way when it's done? We'd love to read it!","markdown_message":"\u003cp\u003eAbsolutely. Mind sending a link to the post my way when it\u0026#39;s done? We\u0026#39;d love to read it!\u003c/p\u003e\n","automated_response":false,"created_at":"2016-09-07T19:16:32.982Z","updated_at":"2016-09-07T19:16:32.982Z","actor":{"username":"kmahoney","cleared":false,"url":"/kmahoney","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/096/304/5eef66c80ab6b392801c57ba5195e42e34599bac_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mapbox","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1180777,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-09-07T19:16:33.103Z","updated_at":"2016-09-07T19:16:33.103Z","actor":{"username":"kmahoney","cleared":false,"url":"/kmahoney","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/096/304/5eef66c80ab6b392801c57ba5195e42e34599bac_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mapbox","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1180781,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Will do! Thanks again! ","markdown_message":"\u003cp\u003eWill do! Thanks again! \u003c/p\u003e\n","automated_response":false,"created_at":"2016-09-07T19:18:10.647Z","updated_at":"2016-09-07T19:18:10.647Z","actor":{"username":"cha5m","cleared":true,"url":"/cha5m","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/840/b0932455c8769047def8966e465f84b88f92756a_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mapbox","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":2600,"category":"team","content":"On September 1st, 2016, @n0rb3r7 reported a vulnerability in the [Mapbox Classic editor](https://www.mapbox.com/editor/) related to a known `window.opener.location.href` issue with user generated content and cross origin navigation when `target=\"_blank\"` (see [HTML bug report](https://www.w3.org/Bugs/Public/show_bug.cgi?id=28821)). This was addressed via the creation of the `noopener` link attribute (see [whatwg PR](https://github.com/whatwg/html/pull/290)) and browser compatibility efforts are ongoing. As of now it is has [limited support](https://html.spec.whatwg.org/#link-type-noopener), though there are open tickets for adding it to the majority of remaining browsers.\n\nAfter an internal review of the issue- taking into consideration previous reports similar in nature, browser compatibility progress towards making `noopener` the default, the level of effort necessary to attempt this exploit, the bandwith required for patching it, as well as the fact that Mapbox Classic editor is a legacy product- we decided that we would not move forward with an immediate fix at this time.\n\nThis report was well put together and looking into it helped us further our research on this vulnerability type, thank you again @n0rb3r7!","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eOn September 1st, 2016, \u003ca href=\"/n0rb3r7\"\u003e@n0rb3r7\u003c/a\u003e reported a vulnerability in the \u003ca href=\"/redirect?url=https%3A%2F%2Fwww.mapbox.com%2Feditor%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eMapbox Classic editor\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e related to a known \u003ccode\u003ewindow.opener.location.href\u003c/code\u003e issue with user generated content and cross origin navigation when \u003ccode\u003etarget=\u0026quot;_blank\u0026quot;\u003c/code\u003e (see \u003ca href=\"/redirect?url=https%3A%2F%2Fwww.w3.org%2FBugs%2FPublic%2Fshow_bug.cgi%3Fid%3D28821\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eHTML bug report\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e). This was addressed via the creation of the \u003ccode\u003enoopener\u003c/code\u003e link attribute (see \u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fwhatwg%2Fhtml%2Fpull%2F290\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ewhatwg PR\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e) and browser compatibility efforts are ongoing. As of now it is has \u003ca href=\"/redirect?url=https%3A%2F%2Fhtml.spec.whatwg.org%2F%23link-type-noopener\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003elimited support\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e, though there are open tickets for adding it to the majority of remaining browsers.\u003c/p\u003e\n\n\u003cp\u003eAfter an internal review of the issue- taking into consideration previous reports similar in nature, browser compatibility progress towards making \u003ccode\u003enoopener\u003c/code\u003e the default, the level of effort necessary to attempt this exploit, the bandwith required for patching it, as well as the fact that Mapbox Classic editor is a legacy product- we decided that we would not move forward with an immediate fix at this time.\u003c/p\u003e\n\n\u003cp\u003eThis report was well put together and looking into it helped us further our research on this vulnerability type, thank you again \u003ca href=\"/n0rb3r7\"\u003e@n0rb3r7\u003c/a\u003e!\u003c/p\u003e\n"},{"category":"researcher","can_view?":true,"can_create?":false}]}