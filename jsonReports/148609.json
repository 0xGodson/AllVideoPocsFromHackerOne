{"id":148609,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNDg2MDk=","url":"https://hackerone.com/reports/148609","title":"Register multiple users using one invitation (race condition)","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-07-01T06:08:23.751Z","submitted_at":"2016-07-01T06:08:23.751Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"franjkovic","url":"/franjkovic","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/017/194/1e20cd6e4a20863ffe9f6f0601ab3ed347bc852b_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":2809,"url":"https://hackerone.com/keybase","handle":"keybase","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/002/809/710eb42880bb34c06cab0d1d5081488ec59aec5e_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/809/710eb42880bb34c06cab0d1d5081488ec59aec5e_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Keybase","twitter_handle":"keybaseio","website":"https://keybase.io","about":""}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2016-07-11T19:46:48.257Z","bug_reporter_agreed_on_going_public_at":"2016-07-11T19:46:48.110Z","team_member_agreed_on_going_public_at":"2016-07-06T12:52:30.948Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi,\n\nIt is possible to create multiple accounts using a single invitation_id due to a race condition bug in `/_/api/1.0/signup.json`. \nI have successfully created 8 accounts using invitation with id = 37c5a121adf23e90b875500d\nThe account usernames: novijosiptest[1,2,4,5,6,8,9,10] (you can delete them, I will not use them).\n\nSteps:\n1. Generate an invitation and get the link, click on the blue \"I accept - join Keybase!\" button\n2. Input your data - email, username and passwords\n3. When you click Join, a POST request is made to `/_/api/1.0/signup.json`. Quickly repeat this POST request while changing the `email` and `username` to desired values\n4. Hopefully more than one account will be registered\n\nIt is also worth checking if there is a race condition when registering and cancelling an invite at the same time. I will test this out in a couple days.\n\nBest regards,\n\nJosip Franjković","vulnerability_information_html":"\u003cp\u003eHi,\u003c/p\u003e\n\n\u003cp\u003eIt is possible to create multiple accounts using a single invitation_id due to a race condition bug in \u003ccode\u003e/_/api/1.0/signup.json\u003c/code\u003e. \u003cbr\u003e\nI have successfully created 8 accounts using invitation with id = 37c5a121adf23e90b875500d\u003cbr\u003e\nThe account usernames: novijosiptest[1,2,4,5,6,8,9,10] (you can delete them, I will not use them).\u003c/p\u003e\n\n\u003cp\u003eSteps:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eGenerate an invitation and get the link, click on the blue \u0026quot;I accept - join Keybase!\u0026quot; button\u003c/li\u003e\n\u003cli\u003eInput your data - email, username and passwords\u003c/li\u003e\n\u003cli\u003eWhen you click Join, a POST request is made to \u003ccode\u003e/_/api/1.0/signup.json\u003c/code\u003e. Quickly repeat this POST request while changing the \u003ccode\u003eemail\u003c/code\u003e and \u003ccode\u003eusername\u003c/code\u003e to desired values\u003c/li\u003e\n\u003cli\u003eHopefully more than one account will be registered\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eIt is also worth checking if there is a race condition when registering and cancelling an invite at the same time. I will test this out in a couple days.\u003c/p\u003e\n\n\u003cp\u003eBest regards,\u003c/p\u003e\n\n\u003cp\u003eJosip Franjković\u003c/p\u003e\n","bounty_amount":"350.0","formatted_bounty":"$350","original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2016-08-05T12:52:31.570Z","allow_singular_disclosure_after":-138814762.26910606,"singular_disclosure_allowed":true,"vote_count":16,"voters":["wkcaj","spam404","lucky_sen","xsam","dudez","supernatural","peeper35","franjkovic","fantam1","0xsunil","and 6 more..."],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1050360,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi,\n\ntried registering and canceling at the same time, was unsuccessful. I screwed up the script a bit, but couldn't trigger race condition after fixing it. Still worth checking in the source code, as I might have been unlucky. \n\nBest regards,\n\nJosip","markdown_message":"\u003cp\u003eHi,\u003c/p\u003e\n\n\u003cp\u003etried registering and canceling at the same time, was unsuccessful. I screwed up the script a bit, but couldn\u0026#39;t trigger race condition after fixing it. Still worth checking in the source code, as I might have been unlucky. \u003c/p\u003e\n\n\u003cp\u003eBest regards,\u003c/p\u003e\n\n\u003cp\u003eJosip\u003c/p\u003e\n","automated_response":false,"created_at":"2016-07-02T10:15:47.951Z","updated_at":"2016-07-02T10:16:02.753Z","actor":{"username":"franjkovic","cleared":false,"url":"/franjkovic","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/194/1e20cd6e4a20863ffe9f6f0601ab3ed347bc852b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1053691,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @franjkovic - I believe we previously closed an issue with race condition on sending multiple invites, so I doubt there is an issue there.\n\nre: your multiple signup with the same invitation code...can you confirm this race loophole is closed now?  You can keep those extra accounts for testing purposes btw.\n\nthanks!\n","markdown_message":"\u003cp\u003eHi \u003ca href=\"/franjkovic\"\u003e@franjkovic\u003c/a\u003e - I believe we previously closed an issue with race condition on sending multiple invites, so I doubt there is an issue there.\u003c/p\u003e\n\n\u003cp\u003ere: your multiple signup with the same invitation code...can you confirm this race loophole is closed now?  You can keep those extra accounts for testing purposes btw.\u003c/p\u003e\n\n\u003cp\u003ethanks!\u003c/p\u003e\n","automated_response":false,"created_at":"2016-07-05T14:22:29.219Z","updated_at":"2016-07-05T14:22:29.219Z","actor":{"username":"chriscoyne","cleared":false,"url":"/chriscoyne","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1053694,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"(oh, I see, that was you who had posted the invitation send race condition 5 months ago..)\n\nanyway, thanks for this one - any chance you can you confirm it is fixed now?\n\n","markdown_message":"\u003cp\u003e(oh, I see, that was you who had posted the invitation send race condition 5 months ago..)\u003c/p\u003e\n\n\u003cp\u003eanyway, thanks for this one - any chance you can you confirm it is fixed now?\u003c/p\u003e\n","automated_response":false,"created_at":"2016-07-05T14:23:42.333Z","updated_at":"2016-07-05T14:23:42.333Z","actor":{"username":"chriscoyne","cleared":false,"url":"/chriscoyne","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1053699,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi,\n\nconfirming this is fixed, tested two times, both failed. \n\nBest regards,\n\nJosip","markdown_message":"\u003cp\u003eHi,\u003c/p\u003e\n\n\u003cp\u003econfirming this is fixed, tested two times, both failed. \u003c/p\u003e\n\n\u003cp\u003eBest regards,\u003c/p\u003e\n\n\u003cp\u003eJosip\u003c/p\u003e\n","automated_response":false,"created_at":"2016-07-05T14:30:05.535Z","updated_at":"2016-07-05T14:30:05.535Z","actor":{"username":"franjkovic","cleared":false,"url":"/franjkovic","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/194/1e20cd6e4a20863ffe9f6f0601ab3ed347bc852b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1053705,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks!","markdown_message":"\u003cp\u003eThanks!\u003c/p\u003e\n","automated_response":false,"created_at":"2016-07-05T14:34:30.931Z","updated_at":"2016-07-05T14:34:30.931Z","actor":{"url":"/keybase","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/809/710eb42880bb34c06cab0d1d5081488ec59aec5e_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Keybase"}},"bounty_amount":"350.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"keybase","collaborator":{"username":"franjkovic","url":"/franjkovic"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1055276,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi,\n\nCan we close this? I will be requesting public disclosure in a couple weeks, am making a blog post about race conditions and I plan on including both Keybase bugs. \n\nWhat I meant with \"It is also worth checking if there is a race condition when registering and cancelling an invite at the same time\" is:\nsay there are `regsiter` and `cancelInvite` functions.\nregister checks if invite is valid, registers user, sets invite to used\ncancelInvite checks if invite is valid, deletes the invite, does a +1 to user invite count\nThere is a small time window where you can both register and cancel an invite, but chance of this working on Keybase is pretty much impossible :-).\n\nAnyways, thanks for the fast fix and bounty.\n\nBest regards,\n\nJosip","markdown_message":"\u003cp\u003eHi,\u003c/p\u003e\n\n\u003cp\u003eCan we close this? I will be requesting public disclosure in a couple weeks, am making a blog post about race conditions and I plan on including both Keybase bugs. \u003c/p\u003e\n\n\u003cp\u003eWhat I meant with \u0026quot;It is also worth checking if there is a race condition when registering and cancelling an invite at the same time\u0026quot; is:\u003cbr\u003e\nsay there are \u003ccode\u003eregsiter\u003c/code\u003e and \u003ccode\u003ecancelInvite\u003c/code\u003e functions.\u003cbr\u003e\nregister checks if invite is valid, registers user, sets invite to used\u003cbr\u003e\ncancelInvite checks if invite is valid, deletes the invite, does a +1 to user invite count\u003cbr\u003e\nThere is a small time window where you can both register and cancel an invite, but chance of this working on Keybase is pretty much impossible :-).\u003c/p\u003e\n\n\u003cp\u003eAnyways, thanks for the fast fix and bounty.\u003c/p\u003e\n\n\u003cp\u003eBest regards,\u003c/p\u003e\n\n\u003cp\u003eJosip\u003c/p\u003e\n","automated_response":false,"created_at":"2016-07-06T09:46:53.341Z","updated_at":"2016-07-06T09:55:27.760Z","actor":{"username":"franjkovic","cleared":false,"url":"/franjkovic","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/194/1e20cd6e4a20863ffe9f6f0601ab3ed347bc852b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1055537,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2016-07-06T12:52:00.395Z","updated_at":"2016-07-06T12:52:00.395Z","actor":{"username":"chriscoyne","cleared":false,"url":"/chriscoyne","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"franjkovic","url":"/franjkovic"},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1055539,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-07-06T12:52:31.127Z","updated_at":"2016-07-06T12:52:31.127Z","first_to_agree":true,"actor":{"username":"chriscoyne","cleared":false,"url":"/chriscoyne","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1063726,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Blog posted here: https://www.josipfranjkovic.com/blog/race-conditions-on-web","markdown_message":"\u003cp\u003eBlog posted here: \u003ca title=\"https://www.josipfranjkovic.com/blog/race-conditions-on-web\" href=\"/redirect?url=https%3A%2F%2Fwww.josipfranjkovic.com%2Fblog%2Frace-conditions-on-web\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.josipfranjkovic.com/blog/race-conditions-on-web\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2016-07-11T19:46:48.140Z","updated_at":"2016-07-11T19:46:48.140Z","actor":{"username":"franjkovic","cleared":false,"url":"/franjkovic","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/194/1e20cd6e4a20863ffe9f6f0601ab3ed347bc852b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1063727,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-07-11T19:46:48.281Z","updated_at":"2016-07-11T19:46:48.281Z","actor":{"username":"franjkovic","cleared":false,"url":"/franjkovic","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/194/1e20cd6e4a20863ffe9f6f0601ab3ed347bc852b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}