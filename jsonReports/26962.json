{"id":26962,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yNjk2Mg==","url":"https://hackerone.com/reports/26962","title":"open redirect in rfc6749","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2014-09-04T19:15:25.612Z","submitted_at":"2014-09-04T19:15:25.612Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"asanso","url":"/asanso","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/005/452/35bd4e65a2ff558a24074d1029b51749670bbea4_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":20,"url":"https://hackerone.com/internet","handle":"internet","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/e3e1c58882b2645d9108ec102731a354cbf5852e_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/e3e1c58882b2645d9108ec102731a354cbf5852e_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"The Internet","twitter_handle":null,"website":"","about":"Hack all the things."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2015-04-06T17:40:18.093Z","bug_reporter_agreed_on_going_public_at":"2015-04-06T17:40:16.001Z","team_member_agreed_on_going_public_at":"2015-04-06T02:49:27.682Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"OAuth Providers (servers) that strictly follow rfc6749 are vulnerable to open redirect.\r\nLet me explain, reading [0]\r\n\r\nIf the request fails due to a missing, invalid, or mismatching\r\n   redirection URI, or if the client identifier is missing or invalid,\r\n   the authorization server SHOULD inform the resource owner of the\r\n   error and MUST NOT automatically redirect the user-agent to the\r\n   invalid redirection URI.\r\n\r\n   If the resource owner denies the access request or if the request\r\n   fails for reasons other than a missing or invalid redirection URI,\r\n   the authorization server informs the client by adding the following\r\n   parameters to the query component of the redirection URI using the\r\n   \"application/x-www-form-urlencoded\" format, per Appendix B:\r\n\r\nNow let’s assume this.\r\nI am registering a new client to the victim.com provider. \r\nI register redirect uri attacker.com.\r\n\r\nAccording to [0] if I pass e.g. the wrong scope I am redirected back to attacker.com.\r\nNamely I prepare a url that is in this form:\r\n\r\nhttp://victim.com/authorize?response_type=code\u0026client_id=bc88FitX1298KPj2WS259BBMa9_KCfL3\u0026scope=WRONG_SCOPE\u0026redirect_uri=http://attacker.com\r\n\r\nand this is works as an open redirector.\r\nOf course in the positive case if all the parameters are fine this doesn’t apply since the resource owner MUST approve the app via the consent screen (at least once).\r\n\r\nI have notified also this issue to the OAuth mailing list.\r\n\r\nSee also http://www.ietf.org/mail-archive/web/oauth/current/msg13367.html\r\nand http://www.ietf.org/mail-archive/web/oauth/current/maillist.html.\r\nThe consensus seems to be that some of the OAuth family spec should be updated... (currently under discussion)\r\n\r\nA solution would be to return error 400 rather than redirect to the redirect URI or always show the consent screen (at least once until the app is accepted by the user) even in case of wrong parameter rather than redirect...\r\n\r\n[0] https://tools.ietf.org/html/rfc6749#section-4.1.2.1\r\n","vulnerability_information_html":"\u003cp\u003eOAuth Providers (servers) that strictly follow rfc6749 are vulnerable to open redirect.\u003cbr\u003e\nLet me explain, reading [0]\u003c/p\u003e\n\n\u003cp\u003eIf the request fails due to a missing, invalid, or mismatching\u003cbr\u003e\n   redirection URI, or if the client identifier is missing or invalid,\u003cbr\u003e\n   the authorization server SHOULD inform the resource owner of the\u003cbr\u003e\n   error and MUST NOT automatically redirect the user-agent to the\u003cbr\u003e\n   invalid redirection URI.\u003c/p\u003e\n\n\u003cp\u003eIf the resource owner denies the access request or if the request\u003cbr\u003e\n   fails for reasons other than a missing or invalid redirection URI,\u003cbr\u003e\n   the authorization server informs the client by adding the following\u003cbr\u003e\n   parameters to the query component of the redirection URI using the\u003cbr\u003e\n   \u0026quot;application/x-www-form-urlencoded\u0026quot; format, per Appendix B:\u003c/p\u003e\n\n\u003cp\u003eNow let’s assume this.\u003cbr\u003e\nI am registering a new client to the victim.com provider. \u003cbr\u003e\nI register redirect uri attacker.com.\u003c/p\u003e\n\n\u003cp\u003eAccording to [0] if I pass e.g. the wrong scope I am redirected back to attacker.com.\u003cbr\u003e\nNamely I prepare a url that is in this form:\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"http://victim.com/authorize?response_type=code\u0026amp;client_id=bc88FitX1298KPj2WS259BBMa9_KCfL3\u0026amp;scope=WRONG_SCOPE\u0026amp;redirect_uri=http://attacker.com\" href=\"/redirect?url=http%3A%2F%2Fvictim.com%2Fauthorize%3Fresponse_type%3Dcode%26client_id%3Dbc88FitX1298KPj2WS259BBMa9_KCfL3%26scope%3DWRONG_SCOPE%26redirect_uri%3Dhttp%3A%2F%2Fattacker.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://victim.com/authorize?response_type=code\u0026amp;client_id=bc88FitX1298KPj2WS259BBMa9_KCfL3\u0026amp;scope=WRONG_SCOPE\u0026amp;redirect_uri=http://attacker.com\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eand this is works as an open redirector.\u003cbr\u003e\nOf course in the positive case if all the parameters are fine this doesn’t apply since the resource owner MUST approve the app via the consent screen (at least once).\u003c/p\u003e\n\n\u003cp\u003eI have notified also this issue to the OAuth mailing list.\u003c/p\u003e\n\n\u003cp\u003eSee also \u003ca title=\"http://www.ietf.org/mail-archive/web/oauth/current/msg13367.html\" href=\"/redirect?url=http%3A%2F%2Fwww.ietf.org%2Fmail-archive%2Fweb%2Foauth%2Fcurrent%2Fmsg13367.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://www.ietf.org/mail-archive/web/oauth/current/msg13367.html\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nand \u003ca title=\"http://www.ietf.org/mail-archive/web/oauth/current/maillist.html\" href=\"/redirect?url=http%3A%2F%2Fwww.ietf.org%2Fmail-archive%2Fweb%2Foauth%2Fcurrent%2Fmaillist.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://www.ietf.org/mail-archive/web/oauth/current/maillist.html\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e.\u003cbr\u003e\nThe consensus seems to be that some of the OAuth family spec should be updated... (currently under discussion)\u003c/p\u003e\n\n\u003cp\u003eA solution would be to return error 400 rather than redirect to the redirect URI or always show the consent screen (at least once until the app is accepted by the user) even in case of wrong parameter rather than redirect...\u003c/p\u003e\n\n\u003cp\u003e[0] \u003ca title=\"https://tools.ietf.org/html/rfc6749#section-4.1.2.1\" href=\"/redirect?url=https%3A%2F%2Ftools.ietf.org%2Fhtml%2Frfc6749%23section-4.1.2.1\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://tools.ietf.org/html/rfc6749#section-4.1.2.1\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","bounty_amount":"3000.0","formatted_bounty":"$3,000","weakness":{"id":53,"name":"Open Redirect"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2015-05-06T02:49:28.032Z","allow_singular_disclosure_after":-178338552.81917262,"singular_disclosure_allowed":true,"vote_count":2,"voters":["asanso","4mit44"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":123169,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"The last news I got from one of the WG guy is that they will probably need to add an RFC errata to the rfc6749 spec and for the short term add an advisory to http://oauth.net/advisories/ .","markdown_message":"\u003cp\u003eThe last news I got from one of the WG guy is that they will probably need to add an RFC errata to the rfc6749 spec and for the short term add an advisory to \u003ca title=\"http://oauth.net/advisories/\" href=\"/redirect?url=http%3A%2F%2Foauth.net%2Fadvisories%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://oauth.net/advisories/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e .\u003c/p\u003e\n","automated_response":false,"created_at":"2014-09-08T13:01:27.381Z","updated_at":"2014-09-08T13:01:27.381Z","actor":{"username":"asanso","cleared":false,"url":"/asanso","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/005/452/35bd4e65a2ff558a24074d1029b51749670bbea4_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"internet","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":124737,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"update: I have started to notify OAuth providers in order to make them aware of this issue","markdown_message":"\u003cp\u003eupdate: I have started to notify OAuth providers in order to make them aware of this issue\u003c/p\u003e\n","automated_response":false,"created_at":"2014-09-10T07:00:17.454Z","updated_at":"2014-09-10T07:00:17.454Z","actor":{"username":"asanso","cleared":false,"url":"/asanso","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/005/452/35bd4e65a2ff558a24074d1029b51749670bbea4_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"internet","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":134436,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"@asanso - Interesting finding. This is on the edge of what we normally consider eligible under the program. In many contexts, open redirects are relatively benign. Two immediate questions on my mind:\n\n- Has there been any update on a formal modification to the RFC or an advisory from the WG?\n- Have you identified any provider implementations where the impact went beyond an open redirect? (e.g., leaking tokens or other identifiers through the redirect referrer)\n\nThanks,\nAlex","markdown_message":"\u003cp\u003e\u003ca href=\"/asanso\"\u003e@asanso\u003c/a\u003e - Interesting finding. This is on the edge of what we normally consider eligible under the program. In many contexts, open redirects are relatively benign. Two immediate questions on my mind:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eHas there been any update on a formal modification to the RFC or an advisory from the WG?\u003c/li\u003e\n\u003cli\u003eHave you identified any provider implementations where the impact went beyond an open redirect? (e.g., leaking tokens or other identifiers through the redirect referrer)\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eThanks,\u003cbr\u003e\nAlex\u003c/p\u003e\n","automated_response":false,"created_at":"2014-10-01T02:40:29.475Z","updated_at":"2014-10-01T02:40:29.475Z","actor":{"username":"arice","cleared":false,"url":"/arice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/83152cb2d070f3f6a63c1b61bae47257722b5ad2_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"internet","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":134572,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"@arice. Thanks a lot for reviewing it.\nI agree the open redirect are kind of borderline, but at the end of the days isn't [OWASP 10](https://www.owasp.org/index.php/Top_10_2010-A10-Unvalidated_Redirects_and_Forwards) :)?\n\nTrying to answer your questions:\n\n1)  The (relative long) discussion in the [IETF mailing list](http://www.ietf.org/mail-archive/web/oauth/current/msg13367.html) seems to eventually acknowledge the issue. I also been in touch privately with some member of the OAuth working group. This is going to be discussed in the next IETF face to face meeting in November and might end up on producing an errata (I will keep you updated) and an advisory on the OAuth webiste (http://oauth.net/). As a side note the IETF process aren't the quickest one :)\n\n2)  Yes, I have done and got also bounties from big Providers for it (e.g. http://intothesymmetry.blogspot.ie/2014/04/oauth-2-how-i-have-hacked-facebook.html).\nThere is a big difference though. The issues as the one I found above are substantially different.  This is because those kind of attack are based on implementation mistakes (e.g. path traversal on redirect uri patter matching) and many other people in the wild have found many of those vulnerabilities as an outcome of implementation mistakes (should you be interested I can point out many).  \nThe issue I report here is a bit different though. The impact might  be lower (namely \"only\" open redirect rahter than tokens hijacking) but it is a specification issue (IMHO).\nNamely if a providers tries to implement the spec verbatim ends up having an open redirect (unless deviate from the spec). That is why an errata seems to be appropriate.\nJust to be more clear a token hijacking isn't possible here because the \"attack\" targets the  [Error Response](https://tools.ietf.org/html/rfc6749#section-4.1.2.1) section where tokens are not yet produced","markdown_message":"\u003cp\u003e\u003ca href=\"/arice\"\u003e@arice\u003c/a\u003e. Thanks a lot for reviewing it.\u003cbr\u003e\nI agree the open redirect are kind of borderline, but at the end of the days isn\u0026#39;t \u003ca href=\"/redirect?url=https%3A%2F%2Fwww.owasp.org%2Findex.php%2FTop_10_2010-A10-Unvalidated_Redirects_and_Forwards\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eOWASP 10\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e :)?\u003c/p\u003e\n\n\u003cp\u003eTrying to answer your questions:\u003c/p\u003e\n\n\u003cp\u003e1)  The (relative long) discussion in the \u003ca href=\"/redirect?url=http%3A%2F%2Fwww.ietf.org%2Fmail-archive%2Fweb%2Foauth%2Fcurrent%2Fmsg13367.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eIETF mailing list\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e seems to eventually acknowledge the issue. I also been in touch privately with some member of the OAuth working group. This is going to be discussed in the next IETF face to face meeting in November and might end up on producing an errata (I will keep you updated) and an advisory on the OAuth webiste (\u003ca title=\"http://oauth.net/\" href=\"/redirect?url=http%3A%2F%2Foauth.net%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://oauth.net/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e). As a side note the IETF process aren\u0026#39;t the quickest one :)\u003c/p\u003e\n\n\u003cp\u003e2)  Yes, I have done and got also bounties from big Providers for it (e.g. \u003ca title=\"http://intothesymmetry.blogspot.ie/2014/04/oauth-2-how-i-have-hacked-facebook.html\" href=\"/redirect?url=http%3A%2F%2Fintothesymmetry.blogspot.ie%2F2014%2F04%2Foauth-2-how-i-have-hacked-facebook.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://intothesymmetry.blogspot.ie/2014/04/oauth-2-how-i-have-hacked-facebook.html\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e).\u003cbr\u003e\nThere is a big difference though. The issues as the one I found above are substantially different.  This is because those kind of attack are based on implementation mistakes (e.g. path traversal on redirect uri patter matching) and many other people in the wild have found many of those vulnerabilities as an outcome of implementation mistakes (should you be interested I can point out many).\u003cbr\u003e\u003cbr\u003e\nThe issue I report here is a bit different though. The impact might  be lower (namely \u0026quot;only\u0026quot; open redirect rahter than tokens hijacking) but it is a specification issue (IMHO).\u003cbr\u003e\nNamely if a providers tries to implement the spec verbatim ends up having an open redirect (unless deviate from the spec). That is why an errata seems to be appropriate.\u003cbr\u003e\nJust to be more clear a token hijacking isn\u0026#39;t possible here because the \u0026quot;attack\u0026quot; targets the  \u003ca href=\"/redirect?url=https%3A%2F%2Ftools.ietf.org%2Fhtml%2Frfc6749%23section-4.1.2.1\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eError Response\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e section where tokens are not yet produced\u003c/p\u003e\n","automated_response":false,"created_at":"2014-10-01T09:49:56.744Z","updated_at":"2014-10-01T09:49:56.744Z","actor":{"username":"asanso","cleared":false,"url":"/asanso","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/005/452/35bd4e65a2ff558a24074d1029b51749670bbea4_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"internet","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":141112,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"just little update. I just read an article that actually used this kind of open redirect (chained with another issue but still :))\nHere is the link http://andrisatteka.blogspot.ch/2014/09/how-microsoft-is-giving-your-data-to.html","markdown_message":"\u003cp\u003ejust little update. I just read an article that actually used this kind of open redirect (chained with another issue but still :))\u003cbr\u003e\nHere is the link \u003ca title=\"http://andrisatteka.blogspot.ch/2014/09/how-microsoft-is-giving-your-data-to.html\" href=\"/redirect?url=http%3A%2F%2Fandrisatteka.blogspot.ch%2F2014%2F09%2Fhow-microsoft-is-giving-your-data-to.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://andrisatteka.blogspot.ch/2014/09/how-microsoft-is-giving-your-data-to.html\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2014-10-13T10:11:24.020Z","updated_at":"2014-10-13T10:11:45.064Z","actor":{"username":"asanso","cleared":false,"url":"/asanso","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/005/452/35bd4e65a2ff558a24074d1029b51749670bbea4_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"internet","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":160510,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"couple of little updates:\n\n- this very issue has been discussed in the IETF 91 meeting , see bottom part of http://www.ietf.org/proceedings/91/minutes/minutes-91-oauth. The outcome seems  to be that some kind of security write up should cover this point.\n- I have been contacting OAuth providers and some of that changed the implementation to \"violate\" the spec and removed the 302 redirect without user interaction\n\nI will keep you updated","markdown_message":"\u003cp\u003ecouple of little updates:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003ethis very issue has been discussed in the IETF 91 meeting , see bottom part of \u003ca title=\"http://www.ietf.org/proceedings/91/minutes/minutes-91-oauth\" href=\"/redirect?url=http%3A%2F%2Fwww.ietf.org%2Fproceedings%2F91%2Fminutes%2Fminutes-91-oauth\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://www.ietf.org/proceedings/91/minutes/minutes-91-oauth\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e. The outcome seems  to be that some kind of security write up should cover this point.\u003c/li\u003e\n\u003cli\u003eI have been contacting OAuth providers and some of that changed the implementation to \u0026quot;violate\u0026quot; the spec and removed the 302 redirect without user interaction\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eI will keep you updated\u003c/p\u003e\n","automated_response":false,"created_at":"2014-11-14T13:56:22.955Z","updated_at":"2014-11-14T13:56:22.955Z","actor":{"username":"asanso","cleared":false,"url":"/asanso","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/005/452/35bd4e65a2ff558a24074d1029b51749670bbea4_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"internet","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":306964,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"this issue is tracked in the planned work for the OAuth working group in  2015, see https://www.ietf.org/mail-archive/web/oauth/current/msg14047.html\n\nQuoting:\n\nFinally, there is the open redirect Antonio raised in\nhttp://www.ietf.org/mail-archive/web/oauth/current/msg13367.html. The\nattack might be difficult to understand but it is still worthwhile\nto make an attempt to explain it to a wider audience (and also the\nmitigation technique). I believe a draft would be quite suitable for\nthis purpose and I have spoken with Antonio about it already.\n\n@arice WDYT?","markdown_message":"\u003cp\u003ethis issue is tracked in the planned work for the OAuth working group in  2015, see \u003ca title=\"https://www.ietf.org/mail-archive/web/oauth/current/msg14047.html\" href=\"/redirect?url=https%3A%2F%2Fwww.ietf.org%2Fmail-archive%2Fweb%2Foauth%2Fcurrent%2Fmsg14047.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.ietf.org/mail-archive/web/oauth/current/msg14047.html\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eQuoting:\u003c/p\u003e\n\n\u003cp\u003eFinally, there is the open redirect Antonio raised in\u003cbr\u003e\n\u003ca title=\"http://www.ietf.org/mail-archive/web/oauth/current/msg13367.html\" href=\"/redirect?url=http%3A%2F%2Fwww.ietf.org%2Fmail-archive%2Fweb%2Foauth%2Fcurrent%2Fmsg13367.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://www.ietf.org/mail-archive/web/oauth/current/msg13367.html\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e. The\u003cbr\u003e\nattack might be difficult to understand but it is still worthwhile\u003cbr\u003e\nto make an attempt to explain it to a wider audience (and also the\u003cbr\u003e\nmitigation technique). I believe a draft would be quite suitable for\u003cbr\u003e\nthis purpose and I have spoken with Antonio about it already.\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"/arice\"\u003e@arice\u003c/a\u003e WDYT?\u003c/p\u003e\n","automated_response":false,"created_at":"2015-01-09T10:28:04.021Z","updated_at":"2015-01-09T10:28:04.021Z","actor":{"username":"asanso","cleared":false,"url":"/asanso","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/005/452/35bd4e65a2ff558a24074d1029b51749670bbea4_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"internet","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":314830,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"further update.\n\nWe and two of the OAuth working group members drafted the version 00 of an OAuth security addendum in [0]\n\n@arice You have asked \"Have you identified any provider implementations where the impact went beyond an open redirect? (e.g., leaking tokens or other identifiers through the redirect referrer)\"\n\nOnce I have reported the issue on the OAuth mailing list, one of the draft coauthor and OAuth Working Group member (John Bradley) has identified a way to use the open redirect to hijack an access token. This is described in \"Section 2.2.  Security Compromise: The Authorization Server As Open Redirector\"  [1]\n\n@arice any thoughts :) ?\n\n[0] http://tools.ietf.org/html/draft-oauth-sanso-open-redirector-00\n[1] http://tools.ietf.org/html/draft-oauth-sanso-open-redirector-00#page-4","markdown_message":"\u003cp\u003efurther update.\u003c/p\u003e\n\n\u003cp\u003eWe and two of the OAuth working group members drafted the version 00 of an OAuth security addendum in [0]\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"/arice\"\u003e@arice\u003c/a\u003e You have asked \u0026quot;Have you identified any provider implementations where the impact went beyond an open redirect? (e.g., leaking tokens or other identifiers through the redirect referrer)\u0026quot;\u003c/p\u003e\n\n\u003cp\u003eOnce I have reported the issue on the OAuth mailing list, one of the draft coauthor and OAuth Working Group member (John Bradley) has identified a way to use the open redirect to hijack an access token. This is described in \u0026quot;Section 2.2.  Security Compromise: The Authorization Server As Open Redirector\u0026quot;  [1]\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"/arice\"\u003e@arice\u003c/a\u003e any thoughts :) ?\u003c/p\u003e\n\n\u003cp\u003e[0] \u003ca title=\"http://tools.ietf.org/html/draft-oauth-sanso-open-redirector-00\" href=\"/redirect?url=http%3A%2F%2Ftools.ietf.org%2Fhtml%2Fdraft-oauth-sanso-open-redirector-00\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://tools.ietf.org/html/draft-oauth-sanso-open-redirector-00\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\n[1] \u003ca title=\"http://tools.ietf.org/html/draft-oauth-sanso-open-redirector-00#page-4\" href=\"/redirect?url=http%3A%2F%2Ftools.ietf.org%2Fhtml%2Fdraft-oauth-sanso-open-redirector-00%23page-4\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://tools.ietf.org/html/draft-oauth-sanso-open-redirector-00#page-4\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2015-01-21T14:51:21.004Z","updated_at":"2015-01-21T14:51:21.004Z","actor":{"username":"asanso","cleared":false,"url":"/asanso","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/005/452/35bd4e65a2ff558a24074d1029b51749670bbea4_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"internet","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":326834,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"link to the new draft https://tools.ietf.org/id/draft-bradley-oauth-open-redirector-00.txt","markdown_message":"\u003cp\u003elink to the new draft \u003ca title=\"https://tools.ietf.org/id/draft-bradley-oauth-open-redirector-00.txt\" href=\"/redirect?url=https%3A%2F%2Ftools.ietf.org%2Fid%2Fdraft-bradley-oauth-open-redirector-00.txt\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://tools.ietf.org/id/draft-bradley-oauth-open-redirector-00.txt\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2015-02-06T15:59:01.255Z","updated_at":"2015-02-06T15:59:01.255Z","actor":{"username":"asanso","cleared":false,"url":"/asanso","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/005/452/35bd4e65a2ff558a24074d1029b51749670bbea4_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"internet","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":328086,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"This helps a lot. Thanks for taking the extra step of collaborating on an update to the RFC. I'll propose this to the panel for a bounty.","markdown_message":"\u003cp\u003eThis helps a lot. Thanks for taking the extra step of collaborating on an update to the RFC. I\u0026#39;ll propose this to the panel for a bounty.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-02-09T07:08:03.917Z","updated_at":"2015-02-09T07:08:03.917Z","actor":{"username":"arice","cleared":false,"url":"/arice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/83152cb2d070f3f6a63c1b61bae47257722b5ad2_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"internet","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":347122,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@arice out of curiosity, have you got any feedback from the panel :) ?","markdown_message":"\u003cp\u003e\u003ca href=\"/arice\"\u003e@arice\u003c/a\u003e out of curiosity, have you got any feedback from the panel :) ?\u003c/p\u003e\n","automated_response":false,"created_at":"2015-03-05T21:46:50.366Z","updated_at":"2015-03-05T21:46:50.366Z","actor":{"username":"asanso","cleared":false,"url":"/asanso","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/005/452/35bd4e65a2ff558a24074d1029b51749670bbea4_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"internet","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":367580,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"little updates.\n\n* updated draft https://tools.ietf.org/id/draft-bradley-oauth-open-redirector-01.txt\n* Minutes for the last F2F IETF meeting http://www.ietf.org/proceedings/92/minutes/minutes-92-oauth\nQuoting\n\n\"Open Redirectors \nLeaks  information in the fragment and referrer, this applies to all protocols that use redirects \nSome of the mitigations\n              Append fragments to all redirects\n              Internal redirect\n              Append content-security-policy Header\n              Include Referrer meta tag\nSo do we do something specific in OAUTH like put this into the security document\n\nSuggestion to update the OAuth Thread document to include these types of recommendations. No decision made.\"  ","markdown_message":"\u003cp\u003elittle updates.\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eupdated draft \u003ca title=\"https://tools.ietf.org/id/draft-bradley-oauth-open-redirector-01.txt\" href=\"/redirect?url=https%3A%2F%2Ftools.ietf.org%2Fid%2Fdraft-bradley-oauth-open-redirector-01.txt\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://tools.ietf.org/id/draft-bradley-oauth-open-redirector-01.txt\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003eMinutes for the last F2F IETF meeting \u003ca title=\"http://www.ietf.org/proceedings/92/minutes/minutes-92-oauth\" href=\"/redirect?url=http%3A%2F%2Fwww.ietf.org%2Fproceedings%2F92%2Fminutes%2Fminutes-92-oauth\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://www.ietf.org/proceedings/92/minutes/minutes-92-oauth\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\nQuoting\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003e\u0026quot;Open Redirectors \u003cbr\u003e\nLeaks  information in the fragment and referrer, this applies to all protocols that use redirects \u003cbr\u003e\nSome of the mitigations\u003cbr\u003e\n              Append fragments to all redirects\u003cbr\u003e\n              Internal redirect\u003cbr\u003e\n              Append content-security-policy Header\u003cbr\u003e\n              Include Referrer meta tag\u003cbr\u003e\nSo do we do something specific in OAUTH like put this into the security document\u003c/p\u003e\n\n\u003cp\u003eSuggestion to update the OAuth Thread document to include these types of recommendations. No decision made.\u0026quot;  \u003c/p\u003e\n","automated_response":false,"created_at":"2015-04-01T18:34:54.402Z","updated_at":"2015-04-01T18:35:13.882Z","actor":{"username":"asanso","cleared":false,"url":"/asanso","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/005/452/35bd4e65a2ff558a24074d1029b51749670bbea4_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"internet","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":372817,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2015-04-06T02:45:02.050Z","updated_at":"2015-04-06T02:45:02.050Z","actor":{"username":"arice","cleared":false,"url":"/arice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/83152cb2d070f3f6a63c1b61bae47257722b5ad2_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"reporter":{"username":"asanso","url":"/asanso"},"genius_execution_id":null,"team_handle":"internet","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":372818,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Despite being rather widespread, we had a hard time assessing this issue given that the exact implications are not uniform across all providers. Thanks for the patience!","markdown_message":"\u003cp\u003eDespite being rather widespread, we had a hard time assessing this issue given that the exact implications are not uniform across all providers. Thanks for the patience!\u003c/p\u003e\n","automated_response":false,"created_at":"2015-04-06T02:49:22.019Z","updated_at":"2015-04-06T02:49:22.019Z","actor":{"url":"/internet","ibb":true,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/e3e1c58882b2645d9108ec102731a354cbf5852e_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"The Internet"}},"bounty_amount":"3000.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"internet","collaborator":{"username":"asanso","url":"/asanso"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":372819,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-04-06T02:49:27.761Z","updated_at":"2015-04-06T02:49:27.761Z","first_to_agree":true,"actor":{"username":"arice","cleared":false,"url":"/arice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/83152cb2d070f3f6a63c1b61bae47257722b5ad2_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"internet","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":373387,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"@arice Thanks to you guys!!","markdown_message":"\u003cp\u003e\u003ca href=\"/arice\"\u003e@arice\u003c/a\u003e Thanks to you guys!!\u003c/p\u003e\n","automated_response":false,"created_at":"2015-04-06T17:40:16.613Z","updated_at":"2015-04-06T17:40:16.613Z","actor":{"username":"asanso","cleared":false,"url":"/asanso","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/005/452/35bd4e65a2ff558a24074d1029b51749670bbea4_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"internet","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":373388,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-04-06T17:40:18.136Z","updated_at":"2015-04-06T17:40:18.136Z","actor":{"username":"asanso","cleared":false,"url":"/asanso","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/005/452/35bd4e65a2ff558a24074d1029b51749670bbea4_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"internet","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}