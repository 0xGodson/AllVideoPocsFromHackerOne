{"id":144385,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNDQzODU=","url":"https://hackerone.com/reports/144385","title":"SMTP server allows anonymous relay from internal addresses to internal addresses","state":"Closed","substate":"duplicate","readable_substate":"Duplicate","created_at":"2016-06-12T18:04:06.387Z","submitted_at":"2016-06-12T18:04:06.387Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"phenix","url":"/phenix","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/011/209/aa6c949c27f2bc67ba8b28a193eb1a98dc3b640e_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":8539,"url":"https://hackerone.com/paragonie","handle":"paragonie","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/008/539/72f76fed45e5220b47ba2f679371ebf9ccb19c70_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/539/72f76fed45e5220b47ba2f679371ebf9ccb19c70_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Paragon Initiative Enterprises","twitter_handle":"ParagonIE","website":"https://github.com/paragonie","about":"Cryptography and Application Security Consultants - We Produce Various Open Source Libraries"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2017-10-16T05:51:25.288Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2017-10-16T05:51:18.349Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hello,\n\n## Issue descripton\nyour incoming SMTP servers, provided by google , seems to be accepting without authentication mails from addresses `@paragonie.com` and destined for addresses `@paragonie.com`.\n\nThis can greatly ease spear-phishing attacks, as users usually put much trust into emails coming from their own domain name, let alone people they actually know.\nFor instance, an attacker could craft an email impersonating your CEO or your IT dept. and asking to open a malicious link or attachment, then send it to some of your users by leveraging this vulnerabilty.\n\n## Issue reproduction\nusing the sendemail script (http://caspian.dotconf.net/menu/Software/SendEmail/) :\n`sendemail -s alt1.aspmx.l.google.com:25 -o message-file=mail2.txt -t security@paragonie.com -f scott@paragonie.com -u \"security testing of mail relay\" -vvv`\n\nIf you will, I can also reproduce the issue at your request, with any \"from:\" and \"to:\" addresses that you like.\n\n## Trace output\nAs this trace shows, I was able to send an email from scott@paragonie.com to security@paragonie.com, without authentication.\n```\nJun 12 19:08:48 vps289445 sendemail[2081]: INFO =\u003e Sending:     MAIL FROM:\u003cscott@paragonie.com\u003e\nJun 12 19:08:48 vps289445 sendemail[2081]: SUCCESS =\u003e Received:         250 2.1.0 OK s12si11327788lfe.119 - gsmtp\nJun 12 19:08:48 vps289445 sendemail[2081]: INFO =\u003e Sending:     RCPT TO:\u003csecurity@paragonie.com\u003e\nJun 12 19:08:48 vps289445 sendemail[2081]: SUCCESS =\u003e Received:         250 2.1.5 OK s12si11327788lfe.119 - gsmtp\nJun 12 19:08:48 vps289445 sendemail[2081]: INFO =\u003e Sending:     DATA\nJun 12 19:08:48 vps289445 sendemail[2081]: SUCCESS =\u003e Received:         354  Go ahead s12si11327788lfe.119 - gsmtp\nJun 12 19:08:48 vps289445 sendemail[2081]: INFO =\u003e Sending message body\nJun 12 19:08:48 vps289445 sendemail[2081]: Setting content-type: text/plain\nJun 12 19:08:48 vps289445 sendemail[2081]: SUCCESS =\u003e Received:         250 2.0.0 OK 1465751328 s12si11327788lfe.119 - gsmtp\nJun 12 19:08:48 vps289445 sendemail[2081]: Generating a detailed exit message\nJun 12 19:08:48 vps289445 sendemail[2081]: Email was sent successfully!  From: \u003cscott@paragonie.com\u003e To: \u003csecurity@paragonie.com\u003e Subject: [security testing of mail relay] Server: [alt1.aspmx.l.google.com:25]\n```\n\n## Recommendation\nAuthentication shall be requested for incoming emails from internal `@paragonie.com` email addresses, especially when they come from untrusted networks such as Internet.\n\nMore information on how to fix this vulnerability with DMARC records can be found here:\nhttps://support.google.com/mail/answer/2451690\n\nBest regards.\n","vulnerability_information_html":"\u003cp\u003eHello,\u003c/p\u003e\n\n\u003ch2 id=\"issue-descripton\"\u003eIssue descripton\u003c/h2\u003e\n\n\u003cp\u003eyour incoming SMTP servers, provided by google , seems to be accepting without authentication mails from addresses \u003ccode\u003e@paragonie.com\u003c/code\u003e and destined for addresses \u003ccode\u003e@paragonie.com\u003c/code\u003e.\u003c/p\u003e\n\n\u003cp\u003eThis can greatly ease spear-phishing attacks, as users usually put much trust into emails coming from their own domain name, let alone people they actually know.\u003cbr\u003e\nFor instance, an attacker could craft an email impersonating your CEO or your IT dept. and asking to open a malicious link or attachment, then send it to some of your users by leveraging this vulnerabilty.\u003c/p\u003e\n\n\u003ch2 id=\"issue-reproduction\"\u003eIssue reproduction\u003c/h2\u003e\n\n\u003cp\u003eusing the sendemail script (\u003ca title=\"http://caspian.dotconf.net/menu/Software/SendEmail/\" href=\"/redirect?url=http%3A%2F%2Fcaspian.dotconf.net%2Fmenu%2FSoftware%2FSendEmail%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://caspian.dotconf.net/menu/Software/SendEmail/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e) :\u003cbr\u003e\n\u003ccode\u003esendemail -s alt1.aspmx.l.google.com:25 -o message-file=mail2.txt -t security@paragonie.com -f scott@paragonie.com -u \u0026quot;security testing of mail relay\u0026quot; -vvv\u003c/code\u003e\u003c/p\u003e\n\n\u003cp\u003eIf you will, I can also reproduce the issue at your request, with any \u0026quot;from:\u0026quot; and \u0026quot;to:\u0026quot; addresses that you like.\u003c/p\u003e\n\n\u003ch2 id=\"trace-output\"\u003eTrace output\u003c/h2\u003e\n\n\u003cp\u003eAs this trace shows, I was able to send an email from \u003ca title=\"scott@paragonie.com\" href=\"mailto:scott@paragonie.com\" rel=\"nofollow noopener noreferrer\"\u003escott@paragonie.com\u003c/a\u003e to \u003ca title=\"security@paragonie.com\" href=\"mailto:security@paragonie.com\" rel=\"nofollow noopener noreferrer\"\u003esecurity@paragonie.com\u003c/a\u003e, without authentication.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eJun 12 19:08:48 vps289445 sendemail[2081]: INFO =\u0026gt; Sending:     MAIL FROM:\u0026lt;scott@paragonie.com\u0026gt;\nJun 12 19:08:48 vps289445 sendemail[2081]: SUCCESS =\u0026gt; Received:         250 2.1.0 OK s12si11327788lfe.119 - gsmtp\nJun 12 19:08:48 vps289445 sendemail[2081]: INFO =\u0026gt; Sending:     RCPT TO:\u0026lt;security@paragonie.com\u0026gt;\nJun 12 19:08:48 vps289445 sendemail[2081]: SUCCESS =\u0026gt; Received:         250 2.1.5 OK s12si11327788lfe.119 - gsmtp\nJun 12 19:08:48 vps289445 sendemail[2081]: INFO =\u0026gt; Sending:     DATA\nJun 12 19:08:48 vps289445 sendemail[2081]: SUCCESS =\u0026gt; Received:         354  Go ahead s12si11327788lfe.119 - gsmtp\nJun 12 19:08:48 vps289445 sendemail[2081]: INFO =\u0026gt; Sending message body\nJun 12 19:08:48 vps289445 sendemail[2081]: Setting content-type: text/plain\nJun 12 19:08:48 vps289445 sendemail[2081]: SUCCESS =\u0026gt; Received:         250 2.0.0 OK 1465751328 s12si11327788lfe.119 - gsmtp\nJun 12 19:08:48 vps289445 sendemail[2081]: Generating a detailed exit message\nJun 12 19:08:48 vps289445 sendemail[2081]: Email was sent successfully!  From: \u0026lt;scott@paragonie.com\u0026gt; To: \u0026lt;security@paragonie.com\u0026gt; Subject: [security testing of mail relay] Server: [alt1.aspmx.l.google.com:25]\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2 id=\"recommendation\"\u003eRecommendation\u003c/h2\u003e\n\n\u003cp\u003eAuthentication shall be requested for incoming emails from internal \u003ccode\u003e@paragonie.com\u003c/code\u003e email addresses, especially when they come from untrusted networks such as Internet.\u003c/p\u003e\n\n\u003cp\u003eMore information on how to fix this vulnerability with DMARC records can be found here:\u003cbr\u003e\n\u003ca title=\"https://support.google.com/mail/answer/2451690\" href=\"/redirect?url=https%3A%2F%2Fsupport.google.com%2Fmail%2Fanswer%2F2451690\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://support.google.com/mail/answer/2451690\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eBest regards.\u003c/p\u003e\n","weakness":{"id":27,"name":"Improper Authentication - Generic"},"original_report_id":135283,"original_report_url":"https://hackerone.com/reports/135283","attachments":[],"allow_singular_disclosure_at":null,"vote_count":3,"voters":["silv3rpoision","hck3r","326070"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1010174,"is_internal":false,"editable":false,"type":"Activities::BugDuplicate","message":"Thanks, but we're already aware of DMARC/SPF. Our email security is predicated on our use of GPG.","markdown_message":"\u003cp\u003eThanks, but we\u0026#39;re already aware of DMARC/SPF. Our email security is predicated on our use of GPG.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-06-12T18:59:20.960Z","updated_at":"2016-06-12T18:59:20.960Z","original_report_id":135283,"actor":{"username":"paragonie-scott","cleared":false,"url":"/paragonie-scott","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/051/441/089de22b2f1b80a1e57a2792318dede5cbad81db_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"paragonie","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2068144,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-10-16T05:51:18.369Z","updated_at":"2017-10-16T05:51:18.369Z","first_to_agree":true,"actor":{"username":"paragonie-scott","cleared":false,"url":"/paragonie-scott","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/051/441/089de22b2f1b80a1e57a2792318dede5cbad81db_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"paragonie","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2068145,"is_internal":false,"editable":false,"type":"Activities::ManuallyDisclosed","message":"","markdown_message":"","automated_response":false,"created_at":"2017-10-16T05:51:25.263Z","updated_at":"2017-10-16T05:51:25.263Z","actor":{"username":"paragonie-scott","cleared":false,"url":"/paragonie-scott","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/051/441/089de22b2f1b80a1e57a2792318dede5cbad81db_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"paragonie","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}