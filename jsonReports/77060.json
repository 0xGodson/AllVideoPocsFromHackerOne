{"id":77060,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC83NzA2MA==","url":"https://hackerone.com/reports/77060","title":"SMTP protection not used","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2015-07-20T20:08:46.575Z","submitted_at":"2015-07-20T20:08:46.575Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"test-123","url":"/test-123","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/020/220/88db32e19fb9fa8e84a330a1a643d21d5b05e223_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":2809,"url":"https://hackerone.com/keybase","handle":"keybase","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/002/809/710eb42880bb34c06cab0d1d5081488ec59aec5e_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/809/710eb42880bb34c06cab0d1d5081488ec59aec5e_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Keybase","twitter_handle":"keybaseio","website":"https://keybase.io","about":""}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2015-08-28T21:02:16.110Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2015-07-29T21:02:14.690Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi\r\n\r\nI'm checking your website found spf record there.\r\nYou should apply strict SMPT policy to stop spoofed email sending from your domain.\r\n\r\nAn attacker would send a Fake email from support@keybase.io saying that Please change your password, The victim is aware of phishing attacks, But when he sees that the mail originated from support@keybase.io , He has no other way than to believe it. Clicking on the link takes him to a website where certain JavaScript is executed which steals his keybase.io id and password (SESSION COOKIE). The results can be more dangerous.\r\n```\r\n\u003c?php\r\n$to = \"VICTIM@example.com\";\r\n$subject = \"Password Change\";\r\n$txt = \"Change your password by visiting here - [VIRUS LINK HERE]l\";\r\n$headers = \"From: support@keybase.io\";\r\nmail($to,$subject,$txt,$headers);\r\n?\u003e\r\n```\r\n\r\n**Fix :**\r\n\r\nYour SPF record is `v=spf1 mx include:_spf.google.com ~all`\r\n\r\nIt should be `v=spf1 mx include:_spf.google.com -all`\r\nI strongly recommend you to read this article :\r\n\r\nhttps://www.digitalocean.com/community/tutorials/how-to-use-an-spf-record-to-prevent-spoofing-improve-e-mail-reliability\r\n\r\n**The problem :**\r\n\r\nThe article clearly shows difference between softmail and fail you should be using fail as Softmail allows anyone to send spoofed emails from your domains. in your SPF record you should replace `~` with `-` at last before all , `-` is strict which prevents all spoofed emails except if you are sending. Your bug is that you are using `~` , you should use `-`\r\n\r\nBest Regard\r\nAlisa","vulnerability_information_html":"\u003cp\u003eHi\u003c/p\u003e\n\n\u003cp\u003eI\u0026#39;m checking your website found spf record there.\u003cbr\u003e\nYou should apply strict SMPT policy to stop spoofed email sending from your domain.\u003c/p\u003e\n\n\u003cp\u003eAn attacker would send a Fake email from \u003ca title=\"support@keybase.io\" href=\"mailto:support@keybase.io\" rel=\"nofollow noopener noreferrer\"\u003esupport@keybase.io\u003c/a\u003e saying that Please change your password, The victim is aware of phishing attacks, But when he sees that the mail originated from \u003ca title=\"support@keybase.io\" href=\"mailto:support@keybase.io\" rel=\"nofollow noopener noreferrer\"\u003esupport@keybase.io\u003c/a\u003e , He has no other way than to believe it. Clicking on the link takes him to a website where certain JavaScript is executed which steals his keybase.io id and password (SESSION COOKIE). The results can be more dangerous.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight php\"\u003e\u003ccode\u003e\u003cspan class=\"cp\"\u003e\u0026lt;?php\u003c/span\u003e\n\u003cspan class=\"nv\"\u003e$to\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026quot;VICTIM@example.com\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"nv\"\u003e$subject\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026quot;Password Change\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"nv\"\u003e$txt\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026quot;Change your password by visiting here - [VIRUS LINK HERE]l\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"nv\"\u003e$headers\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026quot;From: support@keybase.io\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"nb\"\u003email\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$to\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"nv\"\u003e$subject\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"nv\"\u003e$txt\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"nv\"\u003e$headers\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"cp\"\u003e?\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e\u003cstrong\u003eFix :\u003c/strong\u003e\u003c/p\u003e\n\n\u003cp\u003eYour SPF record is \u003ccode\u003ev=spf1 mx include:_spf.google.com ~all\u003c/code\u003e\u003c/p\u003e\n\n\u003cp\u003eIt should be \u003ccode\u003ev=spf1 mx include:_spf.google.com -all\u003c/code\u003e\u003cbr\u003e\nI strongly recommend you to read this article :\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"https://www.digitalocean.com/community/tutorials/how-to-use-an-spf-record-to-prevent-spoofing-improve-e-mail-reliability\" href=\"/redirect?url=https%3A%2F%2Fwww.digitalocean.com%2Fcommunity%2Ftutorials%2Fhow-to-use-an-spf-record-to-prevent-spoofing-improve-e-mail-reliability\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.digitalocean.com/community/tutorials/how-to-use-an-spf-record-to-prevent-spoofing-improve-e-mail-reliability\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eThe problem :\u003c/strong\u003e\u003c/p\u003e\n\n\u003cp\u003eThe article clearly shows difference between softmail and fail you should be using fail as Softmail allows anyone to send spoofed emails from your domains. in your SPF record you should replace \u003ccode\u003e~\u003c/code\u003e with \u003ccode\u003e-\u003c/code\u003e at last before all , \u003ccode\u003e-\u003c/code\u003e is strict which prevents all spoofed emails except if you are sending. Your bug is that you are using \u003ccode\u003e~\u003c/code\u003e , you should use \u003ccode\u003e-\u003c/code\u003e\u003c/p\u003e\n\n\u003cp\u003eBest Regard\u003cbr\u003e\nAlisa\u003c/p\u003e\n","bounty_amount":"500.0","formatted_bounty":"$500","weakness":{"id":57,"name":"Violation of Secure Design Principles"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2015-08-28T21:02:14.852Z","allow_singular_disclosure_after":-168428830.62665012,"singular_disclosure_allowed":true,"vote_count":3,"voters":["sandh0t","cuso4","cryptographer"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":524463,"is_internal":false,"editable":false,"type":"Activities::BugDuplicate","message":"Thanks for the report! We're already working on this, and I've added you to the first report about SPF so that you can follow it.","markdown_message":"\u003cp\u003eThanks for the report! We\u0026#39;re already working on this, and I\u0026#39;ve added you to the first report about SPF so that you can follow it.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-07-24T19:21:16.233Z","updated_at":"2015-07-24T19:21:16.233Z","original_report_id":77058,"actor":{"username":"sidney","cleared":false,"url":"/sidney","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/089/77c83a721928acd9c5c1ff51243987ce59cf0766_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":524517,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks again! Your report was the clearest and most useful and represented a real issue.","markdown_message":"\u003cp\u003eThanks again! Your report was the clearest and most useful and represented a real issue.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-07-24T19:58:46.517Z","updated_at":"2015-07-24T19:58:46.517Z","actor":{"url":"/keybase","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/809/710eb42880bb34c06cab0d1d5081488ec59aec5e_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Keybase"}},"bounty_amount":"100.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"keybase","collaborator":{"username":"test-123","url":"/test-123"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":524519,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Are you going to close this as resolved.","markdown_message":"\u003cp\u003eAre you going to close this as resolved.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-07-24T20:00:38.469Z","updated_at":"2015-07-24T20:00:38.469Z","actor":{"username":"test-123","cleared":false,"url":"/test-123","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/020/220/88db32e19fb9fa8e84a330a1a643d21d5b05e223_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":524531,"is_internal":false,"editable":false,"type":"Activities::BugReopened","message":"","markdown_message":"","automated_response":false,"created_at":"2015-07-24T20:10:00.713Z","updated_at":"2015-07-24T20:10:00.713Z","actor":{"username":"sidney","cleared":false,"url":"/sidney","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/089/77c83a721928acd9c5c1ff51243987ce59cf0766_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":524534,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2015-07-24T20:10:07.209Z","updated_at":"2015-07-24T20:10:07.209Z","actor":{"username":"sidney","cleared":false,"url":"/sidney","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/089/77c83a721928acd9c5c1ff51243987ce59cf0766_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"test-123","url":"/test-123"},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":527874,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"this is also reported when minimum bounty was 500$.","markdown_message":"\u003cp\u003ethis is also reported when minimum bounty was 500$.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-07-27T22:43:41.757Z","updated_at":"2015-07-27T22:43:41.757Z","actor":{"username":"test-123","cleared":false,"url":"/test-123","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/020/220/88db32e19fb9fa8e84a330a1a643d21d5b05e223_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":527877,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2015-07-27T22:45:00.260Z","updated_at":"2015-07-27T22:45:00.260Z","actor":{"url":"/keybase","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/809/710eb42880bb34c06cab0d1d5081488ec59aec5e_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Keybase"}},"bounty_amount":"400.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"keybase","collaborator":{"username":"test-123","url":"/test-123"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":527879,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanx you are too fast :)","markdown_message":"\u003cp\u003eThanx you are too fast :)\u003c/p\u003e\n","automated_response":false,"created_at":"2015-07-27T22:45:54.938Z","updated_at":"2015-07-27T22:45:54.938Z","actor":{"username":"test-123","cleared":false,"url":"/test-123","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/020/220/88db32e19fb9fa8e84a330a1a643d21d5b05e223_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":530442,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-07-29T21:02:14.719Z","updated_at":"2015-07-29T21:02:14.719Z","first_to_agree":true,"actor":{"username":"sidney","cleared":false,"url":"/sidney","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/089/77c83a721928acd9c5c1ff51243987ce59cf0766_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":567428,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-08-28T21:02:16.337Z","updated_at":"2015-08-28T21:02:16.337Z","actor":{"url":"/keybase","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/809/710eb42880bb34c06cab0d1d5081488ec59aec5e_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Keybase"}},"genius_execution_id":null,"team_handle":"keybase","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}