{"id":203515,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMDM1MTU=","url":"https://hackerone.com/reports/203515","title":"Wordpress 4.7.2 - Two XSS in Media Upload when file too large.","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2017-02-05T01:16:31.298Z","submitted_at":"2017-02-05T01:16:31.298Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"skansing","url":"/skansing","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/039/510/0486a9d2ba97f04a35e587c7483914cb5299c526_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":55,"url":"https://hackerone.com/wordpress","handle":"wordpress","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/055/f114d1d31f904e3b903cd99a6cf566bb531f8401_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/055/f114d1d31f904e3b903cd99a6cf566bb531f8401_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"WordPress","twitter_handle":"wordpress","website":"https://wordpress.org/","about":"Beautiful sites of any kind."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-07-17T23:52:34.026Z","bug_reporter_agreed_on_going_public_at":"2017-06-17T23:52:32.237Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Description\n-------------------\nAn attacker can inject a malicious script in to the filename which a victim tries to upload leading to XSS inside the administrators control panel.\n\nTwo different \"file to large\" cases end up in interpolating the file name and appending it into DOM unsanitized leading to XSS.\n\nI have attached pictures of one of the cases, in the attached case the file was 12.4 MB, in a freshly installed environment. For reproduction note that any file type can be used (.jar whatever) as the vuln happens before the type is validated.\n\nPoC\n-------------------\nCreate a 20MB file called \n\n`Dinosaurs secret life\u003cimg src=x  onerror=alert(1)\u003e.png`\n\nGoto your wordpress site `http://127.0.0.1/wp-admin/media-new.php` and drag`n`drop or use file manager or choose the file via. the \"Select Files\" button.\n\nA error will appear with `... exceeds the maximum upload size for this site.` along with a alert box to display that the payload has been executed.\n\nDetails on XSS\n-------------------\nThe file `script-loader.php` prepares an array of messages for use later.\n\n```\n\t// error message for both plupload and swfupload\n\t$uploader_l10n = array(\n                ...\n\t\t'file_exceeds_size_limit' =\u003e __('%s  exceeds the maximum upload size for this site.'),\n\t\t'big_upload_failed' =\u003e __('Please try uploading this file with the %1$sbrowser uploader%2$s.'),\n\t\t...\n\t);\n```\n\nThe payload will be injected into the `%s` in the key `file_exceeds_size_limit`.\n\nThis happens because the `$uploader_l10n` is passed to `handlers.min.js` (non minified version shown)\n and interpolated without escaping the value previously.\n\nFirst the value passes trough a error case \n```\n// $uploader_l10n\ncase plupload.FILE_SIZE_ERROR:\n\t\t\tuploadSizeError(uploader, fileObj); // fileObj contains the filename payload in name attribute.\n\t\t\tbreak;\n....\nif ( max \u003e hundredmb \u0026\u0026 fileObj.size \u003e hundredmb )\n\t\t\t\twpFileError( fileObj, pluploadL10n.big_upload_failed.replace('%1$s', '\u003ca class=\"uploader-html\" href=\"#\"\u003e').replace('%2$s', '\u003c/a\u003e') );\n```\n\nand lastely interpolated and appended to the dom.\n\n```\n\nfunction uploadSizeError( up, file, over100mb ) {\n\tvar message;\n\n\tif ( over100mb )\n\t\tmessage = pluploadL10n.big_upload_queued.replace('%s', file.name) + ' ' + pluploadL10n.big_upload_failed.replace('%1$s', '\u003ca class=\"uploader-html\" href=\"#\"\u003e').replace('%2$s', '\u003c/a\u003e');\n\telse\n\t\tmessage = pluploadL10n.file_exceeds_size_limit.replace('%s', file.name);\n\n\n\tjQuery('#media-items').append('\u003cdiv id=\"media-item-' + file.id + '\" class=\"media-item error\"\u003e\u003cp\u003e' + message + '\u003c/p\u003e\u003c/div\u003e');\n\tup.removeFile(file);\n}\n```\n\nThe critical lines are \n```\nmessage = pluploadL10n.big_upload_queued.replace('%s', file.name) + ' ' + pluploadL10n.big_upload_failed.replace('%1$s', '\u003ca class=\"uploader-html\" href=\"#\"\u003e').replace('%2$s', '\u003c/a\u003e');\n\telse\n\t\tmessage = pluploadL10n.file_exceeds_size_limit.replace('%s', file.name);\n```\n\n# Suggested fix:\nRemove the filename or escape safely in context.","vulnerability_information_html":"\u003ch2 id=\"description\"\u003eDescription\u003c/h2\u003e\n\n\u003cp\u003eAn attacker can inject a malicious script in to the filename which a victim tries to upload leading to XSS inside the administrators control panel.\u003c/p\u003e\n\n\u003cp\u003eTwo different \u0026quot;file to large\u0026quot; cases end up in interpolating the file name and appending it into DOM unsanitized leading to XSS.\u003c/p\u003e\n\n\u003cp\u003eI have attached pictures of one of the cases, in the attached case the file was 12.4 MB, in a freshly installed environment. For reproduction note that any file type can be used (.jar whatever) as the vuln happens before the type is validated.\u003c/p\u003e\n\n\u003ch2 id=\"poc\"\u003ePoC\u003c/h2\u003e\n\n\u003cp\u003eCreate a 20MB file called \u003c/p\u003e\n\n\u003cp\u003e\u003ccode\u003eDinosaurs secret life\u0026lt;img src=x  onerror=alert(1)\u0026gt;.png\u003c/code\u003e\u003c/p\u003e\n\n\u003cp\u003eGoto your wordpress site \u003ccode\u003ehttp://127.0.0.1/wp-admin/media-new.php\u003c/code\u003e and drag\u003ccode\u003en\u003c/code\u003edrop or use file manager or choose the file via. the \u0026quot;Select Files\u0026quot; button.\u003c/p\u003e\n\n\u003cp\u003eA error will appear with \u003ccode\u003e... exceeds the maximum upload size for this site.\u003c/code\u003e along with a alert box to display that the payload has been executed.\u003c/p\u003e\n\n\u003ch2 id=\"details-on-xss\"\u003eDetails on XSS\u003c/h2\u003e\n\n\u003cp\u003eThe file \u003ccode\u003escript-loader.php\u003c/code\u003e prepares an array of messages for use later.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e    // error message for both plupload and swfupload\n    $uploader_l10n = array(\n                ...\n        \u0026#39;file_exceeds_size_limit\u0026#39; =\u0026gt; __(\u0026#39;%s  exceeds the maximum upload size for this site.\u0026#39;),\n        \u0026#39;big_upload_failed\u0026#39; =\u0026gt; __(\u0026#39;Please try uploading this file with the %1$sbrowser uploader%2$s.\u0026#39;),\n        ...\n    );\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThe payload will be injected into the \u003ccode\u003e%s\u003c/code\u003e in the key \u003ccode\u003efile_exceeds_size_limit\u003c/code\u003e.\u003c/p\u003e\n\n\u003cp\u003eThis happens because the \u003ccode\u003e$uploader_l10n\u003c/code\u003e is passed to \u003ccode\u003ehandlers.min.js\u003c/code\u003e (non minified version shown)\u003cbr\u003e\n and interpolated without escaping the value previously.\u003c/p\u003e\n\n\u003cp\u003eFirst the value passes trough a error case \u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e// $uploader_l10n\ncase plupload.FILE_SIZE_ERROR:\n            uploadSizeError(uploader, fileObj); // fileObj contains the filename payload in name attribute.\n            break;\n....\nif ( max \u0026gt; hundredmb \u0026amp;\u0026amp; fileObj.size \u0026gt; hundredmb )\n                wpFileError( fileObj, pluploadL10n.big_upload_failed.replace(\u0026#39;%1$s\u0026#39;, \u0026#39;\u0026lt;a class=\u0026quot;uploader-html\u0026quot; href=\u0026quot;#\u0026quot;\u0026gt;\u0026#39;).replace(\u0026#39;%2$s\u0026#39;, \u0026#39;\u0026lt;/a\u0026gt;\u0026#39;) );\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eand lastely interpolated and appended to the dom.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e\nfunction uploadSizeError( up, file, over100mb ) {\n    var message;\n\n    if ( over100mb )\n        message = pluploadL10n.big_upload_queued.replace(\u0026#39;%s\u0026#39;, file.name) + \u0026#39; \u0026#39; + pluploadL10n.big_upload_failed.replace(\u0026#39;%1$s\u0026#39;, \u0026#39;\u0026lt;a class=\u0026quot;uploader-html\u0026quot; href=\u0026quot;#\u0026quot;\u0026gt;\u0026#39;).replace(\u0026#39;%2$s\u0026#39;, \u0026#39;\u0026lt;/a\u0026gt;\u0026#39;);\n    else\n        message = pluploadL10n.file_exceeds_size_limit.replace(\u0026#39;%s\u0026#39;, file.name);\n\n\n    jQuery(\u0026#39;#media-items\u0026#39;).append(\u0026#39;\u0026lt;div id=\u0026quot;media-item-\u0026#39; + file.id + \u0026#39;\u0026quot; class=\u0026quot;media-item error\u0026quot;\u0026gt;\u0026lt;p\u0026gt;\u0026#39; + message + \u0026#39;\u0026lt;/p\u0026gt;\u0026lt;/div\u0026gt;\u0026#39;);\n    up.removeFile(file);\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThe critical lines are \u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003emessage = pluploadL10n.big_upload_queued.replace(\u0026#39;%s\u0026#39;, file.name) + \u0026#39; \u0026#39; + pluploadL10n.big_upload_failed.replace(\u0026#39;%1$s\u0026#39;, \u0026#39;\u0026lt;a class=\u0026quot;uploader-html\u0026quot; href=\u0026quot;#\u0026quot;\u0026gt;\u0026#39;).replace(\u0026#39;%2$s\u0026#39;, \u0026#39;\u0026lt;/a\u0026gt;\u0026#39;);\n    else\n        message = pluploadL10n.file_exceeds_size_limit.replace(\u0026#39;%s\u0026#39;, file.name);\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch1 id=\"suggested-fix\"\u003eSuggested fix:\u003c/h1\u003e\n\n\u003cp\u003eRemove the filename or escape safely in context.\u003c/p\u003e\n","bounty_amount":"350.0","formatted_bounty":"$350","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":157473,"file_name":"payload_effect.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/157/473/398a407dcaa4bbc9543dd26e03116978ffbc150a/payload_effect.png?response-content-disposition=attachment%3B%20filename%3D%22payload_effect.png%22%3B%20filename%2A%3DUTF-8%27%27payload_effect.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQYENXQUKC%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T045428Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHXwr%2Bz%2B7j54GXjIZDeFjE7V4KhtcLVpveDKyRp%2FgHMpAiEA%2FzBLaI4tlPUnNvgzY0X8n68OkDDLSfCBmjTZSd2A%2BM8qtAMIVRABGgwwMTM2MTkyNzQ4NDkiDOLyu53NKIhzdiDnLyqRA1YiznmwUquOZL6cfEwHlrCEbfV1uip5mxrCKpzmpc9DKyYejzEqNMg8%2Fo1XQZiQbQ9Mn8QGMjtqUBvpzsRmfLsdw4KO6Yix26%2Foq9H6jcEfUIX3EyFaY0ofGk42HT5lnakJ%2FUAtv5lyqirA3laDcoq6u60WpxBZh0jLi92Ajs9kGkzDbgWJPXMK2%2FlVglZWa%2BjQNhDftrEqJh4ZV%2FIwfbcJ6s89eju9B4Xkun1IUiVjrUtA5LTMlkDAEwqtGdl3pucepUSB2hZBvbqUfgiT65T%2BpLDNg0LFqEXPPPqqyrYG3%2BqTXIZxR1FfbdXOQjx1UoPwboCHOwSOpOKGaPs6TEM2o6Sg2U%2BGvuy3dMdtNBCfH4SIfBdeUa84eWUftCR4OwBiC0F1Cl6iPIZXa92zkJSAVTz9swPvr%2BghYLYGIjX%2F8jqVGlADsLB1sl%2BqlNRFkwYrvTDOWwnYmDuvQmmhpAQ6Mg%2Fp05v07WKHRsbG%2BAUzVJ3M02i0HIdWCGKjqKXgGZi%2FLBrHUEV9bzaVWmpeFEE3MObUqv8FOusBMEus3670kEKa62xVKQkID%2Fav5Xylzf384wPv9i4fBKmwghqKR67wSDPkErUtnTlN6wJNos0uBd5jibop6zjPh%2BDMaeI%2Bt4z0CbNpMS83WKn2xS%2FvSK0QFyg217PkDWCKklNPmbumtDteHdU2qRRX%2BQwVoTBmoRFgs97OyKXEz2rc7ZIcHuDnAibsNVPNZEuX9m%2B04KKBBkwdIr0sY3zEiVHvTVxPYBSsKfBPuZwzi6W3T3aq%2BF9l860FnFBaV964%2BlbASqZkuTd4cEZ8C2GJad6RyY164GfHgpKnmQ6aYbLhiDTz0xF3adlmhg%3D%3D\u0026X-Amz-Signature=2bb9fafd59295510e295322201b8b41dff15d5e6d5f2e396316d0f64fef42cf9","file_size":86903,"type":"image/png"},{"id":157474,"file_name":"Payload_drop.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/157/474/81f27f31cfd9311974a97b22fc212977d2d08e92/Payload_drop.png?response-content-disposition=attachment%3B%20filename%3D%22Payload_drop.png%22%3B%20filename%2A%3DUTF-8%27%27Payload_drop.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQYENXQUKC%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T045428Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHXwr%2Bz%2B7j54GXjIZDeFjE7V4KhtcLVpveDKyRp%2FgHMpAiEA%2FzBLaI4tlPUnNvgzY0X8n68OkDDLSfCBmjTZSd2A%2BM8qtAMIVRABGgwwMTM2MTkyNzQ4NDkiDOLyu53NKIhzdiDnLyqRA1YiznmwUquOZL6cfEwHlrCEbfV1uip5mxrCKpzmpc9DKyYejzEqNMg8%2Fo1XQZiQbQ9Mn8QGMjtqUBvpzsRmfLsdw4KO6Yix26%2Foq9H6jcEfUIX3EyFaY0ofGk42HT5lnakJ%2FUAtv5lyqirA3laDcoq6u60WpxBZh0jLi92Ajs9kGkzDbgWJPXMK2%2FlVglZWa%2BjQNhDftrEqJh4ZV%2FIwfbcJ6s89eju9B4Xkun1IUiVjrUtA5LTMlkDAEwqtGdl3pucepUSB2hZBvbqUfgiT65T%2BpLDNg0LFqEXPPPqqyrYG3%2BqTXIZxR1FfbdXOQjx1UoPwboCHOwSOpOKGaPs6TEM2o6Sg2U%2BGvuy3dMdtNBCfH4SIfBdeUa84eWUftCR4OwBiC0F1Cl6iPIZXa92zkJSAVTz9swPvr%2BghYLYGIjX%2F8jqVGlADsLB1sl%2BqlNRFkwYrvTDOWwnYmDuvQmmhpAQ6Mg%2Fp05v07WKHRsbG%2BAUzVJ3M02i0HIdWCGKjqKXgGZi%2FLBrHUEV9bzaVWmpeFEE3MObUqv8FOusBMEus3670kEKa62xVKQkID%2Fav5Xylzf384wPv9i4fBKmwghqKR67wSDPkErUtnTlN6wJNos0uBd5jibop6zjPh%2BDMaeI%2Bt4z0CbNpMS83WKn2xS%2FvSK0QFyg217PkDWCKklNPmbumtDteHdU2qRRX%2BQwVoTBmoRFgs97OyKXEz2rc7ZIcHuDnAibsNVPNZEuX9m%2B04KKBBkwdIr0sY3zEiVHvTVxPYBSsKfBPuZwzi6W3T3aq%2BF9l860FnFBaV964%2BlbASqZkuTd4cEZ8C2GJad6RyY164GfHgpKnmQ6aYbLhiDTz0xF3adlmhg%3D%3D\u0026X-Amz-Signature=94b92d8d25140005ea1580167bea3a58db34f180c28381ade172efadbaadf642","file_size":128319,"type":"image/png"}],"allow_singular_disclosure_at":"2017-07-17T23:52:32.310Z","allow_singular_disclosure_after":-108882115.78452568,"singular_disclosure_allowed":true,"vote_count":23,"voters":["bl4de","bogdantcaciuc","s_p_q_r","skansing","ak1","madrobot","eveeez","r3y","vulnh0lic","khizer47","and 13 more..."],"severity":{"rating":"high","author_type":"User"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1463478,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @skansing, thanks for another great report. It made this one easy to reproduce. I'll get to work on this one.","markdown_message":"\u003cp\u003eHey \u003ca href=\"/skansing\"\u003e@skansing\u003c/a\u003e, thanks for another great report. It made this one easy to reproduce. I\u0026#39;ll get to work on this one.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-02-05T03:59:45.080Z","updated_at":"2017-02-05T03:59:45.080Z","actor":{"username":"voldemortensen","cleared":false,"url":"/voldemortensen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/090/577/2f2c151123b2d4917e8791b96987f0fde30d95bc_original.gif/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1463482,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2017-02-05T04:08:04.560Z","updated_at":"2017-02-05T04:08:04.560Z","actor":{"username":"voldemortensen","cleared":false,"url":"/voldemortensen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/090/577/2f2c151123b2d4917e8791b96987f0fde30d95bc_original.gif/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1463716,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @voldemortensen, awesome =)  \n\nThanks for asserting the bug so quickly and the feedback, made my morning extra great. thx","markdown_message":"\u003cp\u003eHey \u003ca href=\"/voldemortensen\"\u003e@voldemortensen\u003c/a\u003e, awesome =)  \u003c/p\u003e\n\n\u003cp\u003eThanks for asserting the bug so quickly and the feedback, made my morning extra great. thx\u003c/p\u003e\n","automated_response":false,"created_at":"2017-02-05T09:32:48.569Z","updated_at":"2017-02-05T09:32:48.569Z","actor":{"username":"skansing","cleared":false,"url":"/skansing","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/039/510/0486a9d2ba97f04a35e587c7483914cb5299c526_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1564407,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@skansing Thanks again for the report. \n\nI have prepared the attached patch to resolve the issue. It uses DOM construction for the `uploadSizeError` error message insertion. After the patch, variable `message` is inserted with jQuery's `.text()` so it is safe regardless of what you pass it as a filename. \n\nCan you test to verify this resolves the issue for you? \n\nThanks. Once we confirm, we'll get this into an upcoming release.\n\nI am also attaching a QUnit test that fails before the patch because the JS in the filename is evaluated. It passes after the patch.","markdown_message":"\u003cp\u003e\u003ca href=\"/skansing\"\u003e@skansing\u003c/a\u003e Thanks again for the report. \u003c/p\u003e\n\n\u003cp\u003eI have prepared the attached patch to resolve the issue. It uses DOM construction for the \u003ccode\u003euploadSizeError\u003c/code\u003e error message insertion. After the patch, variable \u003ccode\u003emessage\u003c/code\u003e is inserted with jQuery\u0026#39;s \u003ccode\u003e.text()\u003c/code\u003e so it is safe regardless of what you pass it as a filename. \u003c/p\u003e\n\n\u003cp\u003eCan you test to verify this resolves the issue for you? \u003c/p\u003e\n\n\u003cp\u003eThanks. Once we confirm, we\u0026#39;ll get this into an upcoming release.\u003c/p\u003e\n\n\u003cp\u003eI am also attaching a QUnit test that fails before the patch because the JS in the filename is evaluated. It passes after the patch.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-03-27T02:58:24.213Z","updated_at":"2017-03-27T02:58:24.213Z","actor":{"username":"adamsilverstein","cleared":false,"url":"/adamsilverstein","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/GQTeB5urRXgocibSBDLWmoE6/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":171471,"filename":"handlers-test.js","type":"text/x-diff","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/171/471/32c3d8d230fcf8c14c3b83c06a4c89f7be2a528d/handlers-test.js?response-content-disposition=attachment%3B%20filename%3D%22handlers-test.js%22%3B%20filename%2A%3DUTF-8%27%27handlers-test.js\u0026response-content-type=text%2Fx-diff\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQYENXQUKC%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T045428Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHXwr%2Bz%2B7j54GXjIZDeFjE7V4KhtcLVpveDKyRp%2FgHMpAiEA%2FzBLaI4tlPUnNvgzY0X8n68OkDDLSfCBmjTZSd2A%2BM8qtAMIVRABGgwwMTM2MTkyNzQ4NDkiDOLyu53NKIhzdiDnLyqRA1YiznmwUquOZL6cfEwHlrCEbfV1uip5mxrCKpzmpc9DKyYejzEqNMg8%2Fo1XQZiQbQ9Mn8QGMjtqUBvpzsRmfLsdw4KO6Yix26%2Foq9H6jcEfUIX3EyFaY0ofGk42HT5lnakJ%2FUAtv5lyqirA3laDcoq6u60WpxBZh0jLi92Ajs9kGkzDbgWJPXMK2%2FlVglZWa%2BjQNhDftrEqJh4ZV%2FIwfbcJ6s89eju9B4Xkun1IUiVjrUtA5LTMlkDAEwqtGdl3pucepUSB2hZBvbqUfgiT65T%2BpLDNg0LFqEXPPPqqyrYG3%2BqTXIZxR1FfbdXOQjx1UoPwboCHOwSOpOKGaPs6TEM2o6Sg2U%2BGvuy3dMdtNBCfH4SIfBdeUa84eWUftCR4OwBiC0F1Cl6iPIZXa92zkJSAVTz9swPvr%2BghYLYGIjX%2F8jqVGlADsLB1sl%2BqlNRFkwYrvTDOWwnYmDuvQmmhpAQ6Mg%2Fp05v07WKHRsbG%2BAUzVJ3M02i0HIdWCGKjqKXgGZi%2FLBrHUEV9bzaVWmpeFEE3MObUqv8FOusBMEus3670kEKa62xVKQkID%2Fav5Xylzf384wPv9i4fBKmwghqKR67wSDPkErUtnTlN6wJNos0uBd5jibop6zjPh%2BDMaeI%2Bt4z0CbNpMS83WKn2xS%2FvSK0QFyg217PkDWCKklNPmbumtDteHdU2qRRX%2BQwVoTBmoRFgs97OyKXEz2rc7ZIcHuDnAibsNVPNZEuX9m%2B04KKBBkwdIr0sY3zEiVHvTVxPYBSsKfBPuZwzi6W3T3aq%2BF9l860FnFBaV964%2BlbASqZkuTd4cEZ8C2GJad6RyY164GfHgpKnmQ6aYbLhiDTz0xF3adlmhg%3D%3D\u0026X-Amz-Signature=393e1a62f257eb0d49a760f5a147988672e09d25c12b1c8dfaed301954e934bb"},{"id":171470,"filename":"249.diff","type":"text/x-diff","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/171/470/bff110eb320425621e57b50fbb5280ed8bef6532/249.diff?response-content-disposition=attachment%3B%20filename%3D%22249.diff%22%3B%20filename%2A%3DUTF-8%27%27249.diff\u0026response-content-type=text%2Fx-diff\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQYENXQUKC%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T045428Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHXwr%2Bz%2B7j54GXjIZDeFjE7V4KhtcLVpveDKyRp%2FgHMpAiEA%2FzBLaI4tlPUnNvgzY0X8n68OkDDLSfCBmjTZSd2A%2BM8qtAMIVRABGgwwMTM2MTkyNzQ4NDkiDOLyu53NKIhzdiDnLyqRA1YiznmwUquOZL6cfEwHlrCEbfV1uip5mxrCKpzmpc9DKyYejzEqNMg8%2Fo1XQZiQbQ9Mn8QGMjtqUBvpzsRmfLsdw4KO6Yix26%2Foq9H6jcEfUIX3EyFaY0ofGk42HT5lnakJ%2FUAtv5lyqirA3laDcoq6u60WpxBZh0jLi92Ajs9kGkzDbgWJPXMK2%2FlVglZWa%2BjQNhDftrEqJh4ZV%2FIwfbcJ6s89eju9B4Xkun1IUiVjrUtA5LTMlkDAEwqtGdl3pucepUSB2hZBvbqUfgiT65T%2BpLDNg0LFqEXPPPqqyrYG3%2BqTXIZxR1FfbdXOQjx1UoPwboCHOwSOpOKGaPs6TEM2o6Sg2U%2BGvuy3dMdtNBCfH4SIfBdeUa84eWUftCR4OwBiC0F1Cl6iPIZXa92zkJSAVTz9swPvr%2BghYLYGIjX%2F8jqVGlADsLB1sl%2BqlNRFkwYrvTDOWwnYmDuvQmmhpAQ6Mg%2Fp05v07WKHRsbG%2BAUzVJ3M02i0HIdWCGKjqKXgGZi%2FLBrHUEV9bzaVWmpeFEE3MObUqv8FOusBMEus3670kEKa62xVKQkID%2Fav5Xylzf384wPv9i4fBKmwghqKR67wSDPkErUtnTlN6wJNos0uBd5jibop6zjPh%2BDMaeI%2Bt4z0CbNpMS83WKn2xS%2FvSK0QFyg217PkDWCKklNPmbumtDteHdU2qRRX%2BQwVoTBmoRFgs97OyKXEz2rc7ZIcHuDnAibsNVPNZEuX9m%2B04KKBBkwdIr0sY3zEiVHvTVxPYBSsKfBPuZwzi6W3T3aq%2BF9l860FnFBaV964%2BlbASqZkuTd4cEZ8C2GJad6RyY164GfHgpKnmQ6aYbLhiDTz0xF3adlmhg%3D%3D\u0026X-Amz-Signature=c284ad680fcffb76c67304e702e017e03230b15f2fcdc730475581d84ae31ce3"}],"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1565814,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey, thanks for the update.\n\nI can confirm the fix works and have been unable to trigger the XSS with the patch supplied.\n\n","markdown_message":"\u003cp\u003eHey, thanks for the update.\u003c/p\u003e\n\n\u003cp\u003eI can confirm the fix works and have been unable to trigger the XSS with the patch supplied.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-03-27T17:57:59.539Z","updated_at":"2017-03-27T17:57:59.539Z","actor":{"username":"skansing","cleared":false,"url":"/skansing","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/039/510/0486a9d2ba97f04a35e587c7483914cb5299c526_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1679826,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi this has been released in 4.7.5, lets the report public.","markdown_message":"\u003cp\u003eHi this has been released in 4.7.5, lets the report public.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-05-17T11:40:28.616Z","updated_at":"2017-05-17T11:40:28.616Z","actor":{"username":"skansing","cleared":false,"url":"/skansing","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/039/510/0486a9d2ba97f04a35e587c7483914cb5299c526_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1680360,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Yes it was @skansing. We're going to be pushing through reports today to update them and note which were fixed and which are still pending.","markdown_message":"\u003cp\u003eYes it was \u003ca href=\"/skansing\"\u003e@skansing\u003c/a\u003e. We\u0026#39;re going to be pushing through reports today to update them and note which were fixed and which are still pending.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-05-17T14:54:13.629Z","updated_at":"2017-05-17T14:54:13.629Z","actor":{"username":"aaroncampbell","cleared":false,"url":"/aaroncampbell","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/020/821/f7e6872e5cd77bbdfb5edb77e7b9b2c91bb6c0c7_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"skansing","url":"/skansing"},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1763592,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-06-17T23:52:32.267Z","updated_at":"2017-06-17T23:52:32.267Z","first_to_agree":true,"actor":{"username":"skansing","cleared":false,"url":"/skansing","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/039/510/0486a9d2ba97f04a35e587c7483914cb5299c526_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1766494,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2017-06-19T20:18:37.246Z","updated_at":"2017-06-19T20:18:37.246Z","actor":{"url":"/wordpress","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/055/f114d1d31f904e3b903cd99a6cf566bb531f8401_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"WordPress"}},"bounty_amount":"300.0","bounty_currency":"usd","bonus_amount":"50.0","genius_execution_id":null,"team_handle":"wordpress","collaborator":{"username":"skansing","url":"/skansing"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1844908,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-07-17T23:52:34.049Z","updated_at":"2017-07-17T23:52:34.049Z","actor":{"url":"/wordpress","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/055/f114d1d31f904e3b903cd99a6cf566bb531f8401_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"WordPress"}},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}