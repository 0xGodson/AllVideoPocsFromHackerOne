{"id":107213,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMDcyMTM=","url":"https://hackerone.com/reports/107213","title":"GlassWireSetup.exe subject to EXE planting attack","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2015-12-28T19:04:26.126Z","submitted_at":"2015-12-28T19:04:26.126Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"ericlaw","url":"/ericlaw","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/012/681/97a3578539afb62f396f9aa2c7cac59a8cadaca9_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":374,"url":"https://hackerone.com/glasswire","handle":"glasswire","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/374/13d3682f5d09f12442bfa7e74e96c1ded88562a7_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/374/13d3682f5d09f12442bfa7e74e96c1ded88562a7_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"GlassWire","twitter_handle":"glasswire","website":"http://www.glasswire.com","about":"GlassWire helps protect your computer and privacy by monitoring your network activity."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2016-02-04T20:46:46.381Z","bug_reporter_agreed_on_going_public_at":"2016-02-04T20:46:46.265Z","team_member_agreed_on_going_public_at":"2016-02-04T17:53:04.231Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"GlassWire recently fixed a DLL hijacking attack whereby trojan DLLs would be loaded from the user's \\Downloads\\ folder.\n\nHowever, it appears that GlasswireSetup.exe still uses an unqualified path when running CertUtil.exe and as a consequence a trojaned CertUtil.exe will execute from the \\Downloads\\ folder. Interestingly, it executes without any security warning that Windows would normally show for a downloaded executable run from the shell (suggesting that CreateProcess was used rather than ShellExecute).\n\nTo fix this, it might make the most sense to set the current working directory to the System folder early in the Setup process.","vulnerability_information_html":"\u003cp\u003eGlassWire recently fixed a DLL hijacking attack whereby trojan DLLs would be loaded from the user\u0026#39;s \\Downloads\\ folder.\u003c/p\u003e\n\n\u003cp\u003eHowever, it appears that GlasswireSetup.exe still uses an unqualified path when running CertUtil.exe and as a consequence a trojaned CertUtil.exe will execute from the \\Downloads\\ folder. Interestingly, it executes without any security warning that Windows would normally show for a downloaded executable run from the shell (suggesting that CreateProcess was used rather than ShellExecute).\u003c/p\u003e\n\n\u003cp\u003eTo fix this, it might make the most sense to set the current working directory to the System folder early in the Setup process.\u003c/p\u003e\n","bounty_amount":"100.0","formatted_bounty":"$100","weakness":{"id":75,"name":"Privilege Escalation"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":67054,"file_name":"TrojanCertUtil.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/067/054/081c2d13acd3efff37d03f0df22582c3cabbd130/TrojanCertUtil.png?response-content-disposition=attachment%3B%20filename%3D%22TrojanCertUtil.png%22%3B%20filename%2A%3DUTF-8%27%27TrojanCertUtil.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQYMVJENU6%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T041458Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJj%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDWBybDR3vqhcsLBSMk4%2B6P70Ud7eobaXGJmgB%2FHdxqCQIhANWsU51SqowXMmzbNIfK2pdim%2BgV3mQKWL%2FoNTr7y%2BXnKrQDCFEQARoMMDEzNjE5Mjc0ODQ5IgwVkuDdHKaHnFcy6foqkQMHSD9Lwk3G5nXNsgTE1I8L%2FxERDRm3%2FwUHGtqbcqWj8jHUHsiWc0cuMBCUgqjP7pOrgAWXPwSKRqGfafgzzyUteQgmLfDIZpwZZO81EZGgAEdp5E%2F2tBncLnh8ZJrCx1P8EmxR6%2Fo8vkF%2FuWOPJHhHJ2lZyEsbjRzNcQVb%2Fs7CNO5bq2zKtHPwg3C2%2Fo93S9si0IG2AHXGWlnAyij4fRQj6uwJQDGyJlOTWttICHGK4AhYMsL%2Fq0aTm792kd%2BkVeyySD0SgMka0Wq%2FLYnfvzpnIr6zq4ci4bh16b3oqaEB2qu%2B8Py2%2FrJqPIWmi9Gr4RYZH66IXOCLUFGFoL7%2FsdCJDHTy96SorDYSjRUAX6AnBb2%2BuQCKobl6A8PqHt6GIkexPyANWYD9UBBSoObzADm0EHpYf92QwrH85lDqfrE2608E%2BimFNYNs837N%2B%2BJ5e%2FLjI8CS4T%2BlvtfQ7gpk51s4g%2BuSdgjxrq11GhXx2Zm9KTkYc%2BazRqrSv12NTkj%2BiVjkzdX6KN6BUov3zndl%2F%2FWJHTC26qn%2FBTrqAa4l0p0G3kOLPeJ6QAhfVAW73vQA4dhMb6NjYVGNoVZWymk4%2BnyrxPSLgH6TjoldACc7Frzg8xwKr8bfp2yW0NADmrnAq%2BU8nVey7H%2FI%2FoXUWj%2FymOC1jAi02%2BBYJGMUz6qpIzeqj9m8H%2Bl96OuDejTKuHxueDmtYdH2wZFcrPixAjJ8zlSb7j2DKlSQCR%2BUjkw0%2Bi1e818DdrHBp%2BPRvDG%2FpIyFaeXaRuomWdaFOSF70HxUwxdFHg7GvBA2pEDNV34SrACAjARy0ifYBTStiJzmvr8mPk%2FH%2FXLhlmkIY1Hw7L%2FyR4lry8ZFSA%3D%3D\u0026X-Amz-Signature=7d0ca9ebf4d4fbe9b65f053c6bc84d56eacb3bc168e7aaf805474540f24d71fc","file_size":29523,"type":"image/png"}],"allow_singular_disclosure_at":"2016-03-05T17:53:04.327Z","allow_singular_disclosure_after":-152014913.82208195,"singular_disclosure_allowed":true,"vote_count":2,"voters":["jackb898","spetr0x"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":734435,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you for your report.  Some of our team is currently unavailable due to the Holidays so we can't work on this as quickly as I'd like, but we will get this investigated ASAP.","markdown_message":"\u003cp\u003eThank you for your report.  Some of our team is currently unavailable due to the Holidays so we can\u0026#39;t work on this as quickly as I\u0026#39;d like, but we will get this investigated ASAP.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-12-28T19:12:58.588Z","updated_at":"2015-12-28T19:14:02.389Z","actor":{"username":"linkyj","cleared":false,"url":"/linkyj","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"glasswire","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":749320,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Our team will be back in full force Monday and we'll continue working on this.  Thanks again for the report.","markdown_message":"\u003cp\u003eOur team will be back in full force Monday and we\u0026#39;ll continue working on this.  Thanks again for the report.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-01-08T15:32:52.476Z","updated_at":"2016-01-08T15:32:52.476Z","actor":{"username":"linkyj","cleared":false,"url":"/linkyj","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"glasswire","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":754939,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"We are working on a solution.","markdown_message":"\u003cp\u003eWe are working on a solution.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-01-12T17:26:02.469Z","updated_at":"2016-01-12T17:26:02.469Z","actor":{"username":"linkyj","cleared":false,"url":"/linkyj","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"glasswire","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":756398,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Please download this test version and let me know if it solves the problem.  https://www.dropbox.com/s/za2g8c5laxodspk/glasswire-setup-1.1.39.exe?dl=0","markdown_message":"\u003cp\u003ePlease download this test version and let me know if it solves the problem.  \u003ca title=\"https://www.dropbox.com/s/za2g8c5laxodspk/glasswire-setup-1.1.39.exe?dl=0\" href=\"/redirect?url=https%3A%2F%2Fwww.dropbox.com%2Fs%2Fza2g8c5laxodspk%2Fglasswire-setup-1.1.39.exe%3Fdl%3D0\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.dropbox.com/s/za2g8c5laxodspk/glasswire-setup-1.1.39.exe?dl=0\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2016-01-13T15:35:05.306Z","updated_at":"2016-01-13T15:35:05.306Z","actor":{"username":"linkyj","cleared":false,"url":"/linkyj","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"glasswire","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":757677,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"This one looks good to me.","markdown_message":"\u003cp\u003eThis one looks good to me.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-01-14T14:09:26.966Z","updated_at":"2016-01-14T14:09:26.966Z","actor":{"username":"ericlaw","cleared":false,"url":"/ericlaw","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/012/681/97a3578539afb62f396f9aa2c7cac59a8cadaca9_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"glasswire","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":757950,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I will close the bug now and this fix will be included with our next software update.  Thank you for taking the time to find this bug and letting us know so we could fix it.  ","markdown_message":"\u003cp\u003eI will close the bug now and this fix will be included with our next software update.  Thank you for taking the time to find this bug and letting us know so we could fix it.  \u003c/p\u003e\n","automated_response":false,"created_at":"2016-01-14T16:46:48.664Z","updated_at":"2016-01-14T16:46:48.664Z","actor":{"username":"linkyj","cleared":false,"url":"/linkyj","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"glasswire","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":757952,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2016-01-14T16:47:13.541Z","updated_at":"2016-01-14T16:47:13.541Z","actor":{"url":"/glasswire","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/374/13d3682f5d09f12442bfa7e74e96c1ded88562a7_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"GlassWire"}},"bounty_amount":"100.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"glasswire","collaborator":{"username":"ericlaw","url":"/ericlaw"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":757953,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2016-01-14T16:47:28.123Z","updated_at":"2016-01-14T16:47:28.123Z","actor":{"username":"linkyj","cleared":false,"url":"/linkyj","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"ericlaw","url":"/ericlaw"},"genius_execution_id":null,"team_handle":"glasswire","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":785005,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-02-04T17:53:04.258Z","updated_at":"2016-02-04T17:53:04.258Z","first_to_agree":true,"actor":{"username":"linkyj","cleared":false,"url":"/linkyj","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"glasswire","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":785314,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Thanks for making this public!","markdown_message":"\u003cp\u003eThanks for making this public!\u003c/p\u003e\n","automated_response":false,"created_at":"2016-02-04T20:46:46.291Z","updated_at":"2016-02-04T20:46:46.291Z","actor":{"username":"ericlaw","cleared":false,"url":"/ericlaw","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/012/681/97a3578539afb62f396f9aa2c7cac59a8cadaca9_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"glasswire","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":785315,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-02-04T20:46:46.402Z","updated_at":"2016-02-04T20:46:46.402Z","actor":{"username":"ericlaw","cleared":false,"url":"/ericlaw","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/012/681/97a3578539afb62f396f9aa2c7cac59a8cadaca9_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"glasswire","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}