{"id":192734,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xOTI3MzQ=","url":"https://hackerone.com/reports/192734","title":"SIGSEGV Null Pointer mrb_str_concat()","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2016-12-20T13:06:20.011Z","submitted_at":"2016-12-20T13:06:20.011Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"ston3","url":"/ston3","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":15668,"url":"https://hackerone.com/shopify-scripts","handle":"shopify-scripts","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/015/668/ebbe467de8ef2fc936053593e1289e30f04c3b06_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/668/ebbe467de8ef2fc936053593e1289e30f04c3b06_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"paused","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"shopify-scripts","twitter_handle":"","website":"","about":""}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-02-10T21:56:48.373Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2017-01-11T21:56:43.923Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Sample\n---------------------\n\nThe following code triggers the bug (attached as mrb_str_concat.rb):\n\n\ta=String.new\n\ta.concat(a)\n\nCrash\n---------------------\n\n\tx@x:~/Desktop/research/mruby-engine/bin$ ./mruby-engine-mirb \n\tmirb - Embeddable Interactive Ruby Shell\n\n\t\u003e a=String.new\n\ta.concat(a)\n\t =\u003e \"\"\n\t\u003e Segmentation fault\n\nDebug\n---------------------\n\n\t(gdb) r mruby-engine-mirb \n\tStarting program: /usr/bin/ruby mruby-engine-mirb\n\t[Thread debugging using libthread_db enabled]\n\tUsing host libthread_db library \"/lib/x86_64-linux-gnu/libthread_db.so.1\".\n\t[New Thread 0x7ffff7ff7700 (LWP 27170)]\n\t[Thread 0x7ffff7ff7700 (LWP 27170) exited]\n\tprocess 27160 is executing new program: /home/x/Desktop/research/mruby-engine/ext/mruby_engine/mruby/build/host/bin/mirb\n\tmirb - Embeddable Interactive Ruby Shell\n\n\t\u003e a=String.new\n\ta.concat(a)\n\t =\u003e \"\"\n\t\u003e \n\tProgram received signal SIGSEGV, Segmentation fault.\n\t0x000000000041baa8 in mrb_str_concat (mrb=mrb@entry=0x6cd010, self=self@entry=..., other=...) at /home/x/Desktop/research/mruby-engine/ext/mruby_engine/mruby/src/string.c:764\n\t764\t  RSTR_PTR(s1)[len] = '\\0';\n\t(gdb) info reg\n\trax            0x0\t0\n\trbx            0x6d4c90\t7163024\n\trcx            0x0\t0\n\trdx            0x0\t0\n\trsi            0x0\t0\n\trdi            0x0\t0\n\trbp            0x6d4c90\t0x6d4c90\n\trsp            0x7fffffffc4c0\t0x7fffffffc4c0\n\tr8             0x48bee6\t4767462\n\tr9             0x1\t1\n\tr10            0x6cd010\t7131152\n\tr11            0x0\t0\n\tr12            0x0\t0\n\tr13            0x6cd010\t7131152\n\tr14            0x2\t2\n\tr15            0x6cd010\t7131152\n\trip            0x41baa8\t0x41baa8 \u003cmrb_str_concat+280\u003e\n\teflags         0x10246\t[ PF ZF IF RF ]\n\tcs             0x33\t51\n\tss             0x2b\t43\n\tds             0x0\t0\n\tes             0x0\t0\n\tfs             0x0\t0\n\tgs             0x0\t0\n\t(gdb) list *$rip\n\t0x41baa8 is in mrb_str_concat (/home/x/Desktop/research/mruby-engine/ext/mruby_engine/mruby/src/string.c:764).\n\t759\t  if (RSTRING_CAPA(self) \u003c len) {\n\t760\t    resize_capa(mrb, s1, len);\n\t761\t  }\n\t762\t  memcpy(RSTR_PTR(s1)+RSTR_LEN(s1), RSTR_PTR(s2), RSTR_LEN(s2));\n\t763\t  RSTR_SET_LEN(s1, len);\n\t764\t  RSTR_PTR(s1)[len] = '\\0';  // Bug is here.\n\t765\t}\n\t766\t\n\t767\t/*\n\t768\t *  call-seq: (Caution! String(\"abcd\") remain)\n\nBacktrace\n---------------------\n\n\t(gdb) bt\n\t#0  0x000000000041baa8 in mrb_str_concat (mrb=mrb@entry=0x6cd010, self=self@entry=..., other=...) at /home/x/Desktop/research/mruby-engine/ext/mruby_engine/mruby/src/string.c:764\n\t#1  0x000000000045a1ec in mrb_str_concat2 (mrb=0x6cd010, self=...) at /home/x/Desktop/research/mruby-engine/ext/mruby_engine/mruby/mrbgems/mruby-string-ext/src/string.c:151\n\t#2  0x0000000000405cf3 in mrb_vm_exec (mrb=mrb@entry=0x6cd010, proc=\u003coptimized out\u003e, proc@entry=0x6d4c30, pc=0x72e098) at /home/x/Desktop/research/mruby-engine/ext/mruby_engine/mruby/src/vm.c:1171\n\t#3  0x000000000040c22c in mrb_vm_run (mrb=mrb@entry=0x6cd010, proc=proc@entry=0x6d4c30, self=..., stack_keep=stack_keep@entry=2) at /home/x/Desktop/research/mruby-engine/ext/mruby_engine/mruby/src/vm.c:772\n\t#4  0x0000000000402dd9 in main (argc=\u003coptimized out\u003e, argv=\u003coptimized out\u003e) at /home/x/Desktop/research/mruby-engine/ext/mruby_engine/mruby/mrbgems/mruby-bin-mirb/tools/mirb/mirb.c:549\n\nImpact\n---------------------\n\nThis vulnerability is caused by NullPointer error. It can not be exploited, but it can cause DoS.","vulnerability_information_html":"\u003ch2 id=\"sample\"\u003eSample\u003c/h2\u003e\n\n\u003cp\u003eThe following code triggers the bug (attached as mrb_str_concat.rb):\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ea=String.new\na.concat(a)\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2 id=\"crash\"\u003eCrash\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ex@x:~/Desktop/research/mruby-engine/bin$ ./mruby-engine-mirb \nmirb - Embeddable Interactive Ruby Shell\n\n\u0026gt; a=String.new\na.concat(a)\n =\u0026gt; \u0026quot;\u0026quot;\n\u0026gt; Segmentation fault\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2 id=\"debug\"\u003eDebug\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e(gdb) r mruby-engine-mirb \nStarting program: /usr/bin/ruby mruby-engine-mirb\n[Thread debugging using libthread_db enabled]\nUsing host libthread_db library \u0026quot;/lib/x86_64-linux-gnu/libthread_db.so.1\u0026quot;.\n[New Thread 0x7ffff7ff7700 (LWP 27170)]\n[Thread 0x7ffff7ff7700 (LWP 27170) exited]\nprocess 27160 is executing new program: /home/x/Desktop/research/mruby-engine/ext/mruby_engine/mruby/build/host/bin/mirb\nmirb - Embeddable Interactive Ruby Shell\n\n\u0026gt; a=String.new\na.concat(a)\n =\u0026gt; \u0026quot;\u0026quot;\n\u0026gt; \nProgram received signal SIGSEGV, Segmentation fault.\n0x000000000041baa8 in mrb_str_concat (mrb=mrb@entry=0x6cd010, self=self@entry=..., other=...) at /home/x/Desktop/research/mruby-engine/ext/mruby_engine/mruby/src/string.c:764\n764   RSTR_PTR(s1)[len] = \u0026#39;\\0\u0026#39;;\n(gdb) info reg\nrax            0x0  0\nrbx            0x6d4c90 7163024\nrcx            0x0  0\nrdx            0x0  0\nrsi            0x0  0\nrdi            0x0  0\nrbp            0x6d4c90 0x6d4c90\nrsp            0x7fffffffc4c0   0x7fffffffc4c0\nr8             0x48bee6 4767462\nr9             0x1  1\nr10            0x6cd010 7131152\nr11            0x0  0\nr12            0x0  0\nr13            0x6cd010 7131152\nr14            0x2  2\nr15            0x6cd010 7131152\nrip            0x41baa8 0x41baa8 \u0026lt;mrb_str_concat+280\u0026gt;\neflags         0x10246  [ PF ZF IF RF ]\ncs             0x33 51\nss             0x2b 43\nds             0x0  0\nes             0x0  0\nfs             0x0  0\ngs             0x0  0\n(gdb) list *$rip\n0x41baa8 is in mrb_str_concat (/home/x/Desktop/research/mruby-engine/ext/mruby_engine/mruby/src/string.c:764).\n759   if (RSTRING_CAPA(self) \u0026lt; len) {\n760     resize_capa(mrb, s1, len);\n761   }\n762   memcpy(RSTR_PTR(s1)+RSTR_LEN(s1), RSTR_PTR(s2), RSTR_LEN(s2));\n763   RSTR_SET_LEN(s1, len);\n764   RSTR_PTR(s1)[len] = \u0026#39;\\0\u0026#39;;  // Bug is here.\n765 }\n766 \n767 /*\n768  *  call-seq: (Caution! String(\u0026quot;abcd\u0026quot;) remain)\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2 id=\"backtrace\"\u003eBacktrace\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e(gdb) bt\n#0  0x000000000041baa8 in mrb_str_concat (mrb=mrb@entry=0x6cd010, self=self@entry=..., other=...) at /home/x/Desktop/research/mruby-engine/ext/mruby_engine/mruby/src/string.c:764\n#1  0x000000000045a1ec in mrb_str_concat2 (mrb=0x6cd010, self=...) at /home/x/Desktop/research/mruby-engine/ext/mruby_engine/mruby/mrbgems/mruby-string-ext/src/string.c:151\n#2  0x0000000000405cf3 in mrb_vm_exec (mrb=mrb@entry=0x6cd010, proc=\u0026lt;optimized out\u0026gt;, proc@entry=0x6d4c30, pc=0x72e098) at /home/x/Desktop/research/mruby-engine/ext/mruby_engine/mruby/src/vm.c:1171\n#3  0x000000000040c22c in mrb_vm_run (mrb=mrb@entry=0x6cd010, proc=proc@entry=0x6d4c30, self=..., stack_keep=stack_keep@entry=2) at /home/x/Desktop/research/mruby-engine/ext/mruby_engine/mruby/src/vm.c:772\n#4  0x0000000000402dd9 in main (argc=\u0026lt;optimized out\u0026gt;, argv=\u0026lt;optimized out\u0026gt;) at /home/x/Desktop/research/mruby-engine/ext/mruby_engine/mruby/mrbgems/mruby-bin-mirb/tools/mirb/mirb.c:549\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eThis vulnerability is caused by NullPointer error. It can not be exploited, but it can cause DoS.\u003c/p\u003e\n","bounty_amount":"800.0","formatted_bounty":"$800","weakness":{"id":48,"name":"Denial of Service"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":145376,"file_name":"mrb_str_concat.rb","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/145/376/819b13af68945cccf81d40bf17f3444ada039c31/mrb_str_concat.rb?response-content-disposition=attachment%3B%20filename%3D%22mrb_str_concat.rb%22%3B%20filename%2A%3DUTF-8%27%27mrb_str_concat.rb\u0026response-content-type=text%2Fplain\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQUOQU5REA%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T045005Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQDKbajvkbgJ0bk%2BBvRtGQ7p5KCzGha%2FVaDDwyFq8CM66wIgaw7%2FMRI5kyRpH%2BnIlLG4ZnmM%2FrLjLjJWrmkX0zZfd9sqtAMIVBABGgwwMTM2MTkyNzQ4NDkiDP91WL002Wbo0XGfnyqRA%2FNt3W4r54Z2Rrjnbzg30AtIqSAaUbiKh6dYPI5iumJt%2FacDVM4CmdTQCSkrpk45DFotrgtd1tIXQUPsAioE3hz70xop4zS0jebfAPdwBp38Mc3YKPYsW1TgWIT19zK4t%2B4eGJVFjPey5O%2FEfBu4XYpGDd%2Fy2VO0kVCb43%2F76mvlk6aWlA01UhpCilK3J%2F7qqZsw4P3jggaBSCjGhssHvqDLjMzfR%2FDpDE7VaotOr3rJmP5ZK66Q9%2BkoG5kaLgKcslwRO9FGLNBY8AuIhUCEMRp9RM9yBIFYe%2FyyvHRriCVGHEgdIJ9wvxaVVvCfEcWZw1dEIriA6BftAk5kML6b8WN8zwMI3cyqbnvBS9PGbEcrzzU67DDkEk0llxEfFqJB1g4ruY5L2BsxjsulOVXWFSQHoykg7EnBFBbQGmuPAyxW942tXfkTyjH7aQIFAbpwURAHEFFcnVcJBzYS%2B6tGyu1ozPdrsFK5Ko2OryeYDFeK8b9JxwAMZqBekNlk1Bn%2BWq2RJZZBgBTV1X9LfuQ%2FLbSAMJq2qv8FOusBgtnFtNPu6rgydFw%2BpCNudbVGZ39p3P2aIl7K%2B6fRTLBImgaGX5r2pXgGjSRb3Co5NHURzMlQWYw9SJdMt5vMsDNtT9otjm5R%2Fz00sRO779VmfaZOO18lLujlVlImBZA%2BY20iW%2B%2FVBR4UOivJTvxApUCo%2BQYZQghLFkO4s17mPPAo6XeP%2BtXjXhn71RPHuwavkbgQ0EuL1pf5gaqdarsB4psJiZ3FphFomE6unCMAErk3vFIwEIi%2Be5%2FjAIsDg6zS3oetmQEMR7IeJadGwnOF7tifKH8X2cyJk2IoG8HLG%2FfDEf2cBUt6EjPoIQ%3D%3D\u0026X-Amz-Signature=5b5f7d5899087a65b222b18f50de592a4b70959aa75897d1e77df0e01845e97c","file_size":25,"type":"text/plain"}],"allow_singular_disclosure_at":"2017-02-10T21:56:43.980Z","allow_singular_disclosure_after":-122453601.06629927,"singular_disclosure_allowed":true,"vote_count":5,"voters":["mpz","eveeez","rbcafe","spetr0x","alkapakaro"],"severity":{"rating":"low","author_type":"Team"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1377507,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thank you for your report. We've reproduced the crash, and opened an issue in the mruby repository: https://github.com/mruby/mruby/issues/3361","markdown_message":"\u003cp\u003eThank you for your report. We\u0026#39;ve reproduced the crash, and opened an issue in the mruby repository: \u003ca title=\"https://github.com/mruby/mruby/issues/3361\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fmruby%2Fmruby%2Fissues%2F3361\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/mruby/mruby/issues/3361\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2016-12-20T18:23:48.344Z","updated_at":"2016-12-20T18:23:48.344Z","actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify-scripts","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1377508,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2016-12-20T18:24:08.050Z","updated_at":"2016-12-20T18:24:08.050Z","additional_data":{"old_severity":null,"new_severity":"Low","old_severity_id":null,"new_severity_id":15133},"actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify-scripts","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1378100,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I worked on this. I ran into new problems.\n\nDebug - mruby\n-----------------------\n\n\tx@x:~/Desktop/research/mruby/bin$ gdb -q ./mruby\n\tReading symbols from ./mruby...done.\n\t(gdb) r mrb_str_concat-2.rb \n\tStarting program: /home/x/Desktop/research/mruby/bin/mruby mrb_str_concat-2.rb\n\n\tProgram received signal SIGSEGV, Segmentation fault.\n\t0x0000000000415cfe in mrb_str_concat (mrb=\u003coptimized out\u003e, self=\u003cerror reading variable: access outside bounds of object referenced via synthetic pointer\u003e, other=...)\n\t\tat /home/x/Desktop/research/mruby/src/string.c:764\n\t764\t  RSTR_PTR(s1)[len] = '\\0';\n\t(gdb) bt\n\t#0  0x0000000000415cfe in mrb_str_concat (mrb=\u003coptimized out\u003e, self=\u003cerror reading variable: access outside bounds of object referenced via synthetic pointer\u003e, other=...)\n\t\tat /home/x/Desktop/research/mruby/src/string.c:764\n\t#1  0x0000000000501bdb in mrb_str_concat2 (mrb=0x755010, self=\u003cerror reading variable: access outside bounds of object referenced via synthetic pointer\u003e)\n\t\tat /home/x/Desktop/research/mruby/mrbgems/mruby-string-ext/src/string.c:151\n\t#2  0x00000000004b842d in mrb_vm_exec (mrb=\u003coptimized out\u003e, proc=0x0, pc=\u003coptimized out\u003e) at /home/x/Desktop/research/mruby/src/vm.c:1171\n\t#3  0x00000000004c1ecd in mrb_vm_run (proc=0x7581e0, self=..., stack_keep=16, mrb=\u003coptimized out\u003e) at /home/x/Desktop/research/mruby/src/vm.c:772\n\t#4  mrb_top_run (mrb=0x755010, proc=0x7581e0, self=..., stack_keep=\u003coptimized out\u003e) at /home/x/Desktop/research/mruby/src/vm.c:2487\n\t#5  0x000000000049472f in mrb_load_exec (mrb=0x755010, p=\u003coptimized out\u003e, c=0x7aff30) at /home/x/Desktop/research/mruby/mrbgems/mruby-compiler/core/parse.y:5755\n\t#6  0x0000000000402c67 in main (argc=\u003coptimized out\u003e, argv=\u003coptimized out\u003e) at /home/x/Desktop/research/mruby/mrbgems/mruby-bin-mruby/tools/mruby/mruby.c:232\n\t(gdb) info reg\n\trax            0x9877\t39031\n\trbx            0xfffffffffffffffc\t-4\n\trcx            0x0\t0\n\trdx            0x744330\t7619376\n\trsi            0x0\t0\n\trdi            0x0\t0\n\trbp            0x0\t0x0\n\trsp            0x7fffffffd780\t0x7fffffffd780\n\tr8             0x10\t16\n\tr9             0x0\t0\n\tr10            0x755010\t7688208\n\tr11            0x8000044000000000\t-9223367363930357760\n\tr12            0x758180\t7700864\n\tr13            0x0\t0\n\tr14            0x758180\t7700864\n\tr15            0x0\t0\n\trip            0x415cfe\t0x415cfe \u003cmrb_str_concat+1246\u003e\n\teflags         0x10202\t[ IF RF ]\n\tcs             0x33\t51\n\tss             0x2b\t43\n\tds             0x0\t0\n\tes             0x0\t0\n\tfs             0x0\t0\n\tgs             0x0\t0\n\n\nSandbox\n-----------------------\nAttached as sandbox.log\n\n\tx@x:~/Desktop/research/mruby/bin$ ../../mruby-engine/bin/sandbox mrb_str_concat-2.rb \n\t../../mruby-engine/bin/sandbox:20: [BUG] Segmentation fault at 0x00000000000000\n\truby 2.2.6p396 (2016-11-15 revision 56800) [x86_64-linux-gnu]\n\n\t-- Control frame information -----------------------------------------------\n\tc:0003 p:---- s:0010 e:000009 CFUNC  :sandbox_eval\n\tc:0002 p:0186 s:0005 E:0000c8 EVAL   ../../mruby-engine/bin/sandbox:20 [FINISH]\n\tc:0001 p:0000 s:0002 E:000f50 TOP    [FINISH]\n\n\t-- Ruby level backtrace information ----------------------------------------\n\t../../mruby-engine/bin/sandbox:20:in `\u003cmain\u003e'\n\t../../mruby-engine/bin/sandbox:20:in `sandbox_eval'\n\n\t-- Machine register context ------------------------------------------------\n\t RIP: 0x00007f2f72f19788 RBP: 0x00007f2f71a940a0 RSP: 0x00007f2f71a8a980\n\t RAX: 0x0000000000000000 RBX: 0x00007f2f71a940a0 RCX: 0x0000000000000000\n\t RDX: 0x0000000000000000 RDI: 0x0000000000000000 RSI: 0x0000000000000000\n\t  R8: 0x00007f2f72f871ee  R9: 0x0000000000000001 R10: 0x00007f2f71a8c4e0\n\t R11: 0x0000000000000000 R12: 0x0000000000000000 R13: 0x00007f2f71a8c4e0\n\t R14: 0x0000000000000002 R15: 0x00007f2f71a8c4e0 EFL: 0x0000000000010246\n\n","markdown_message":"\u003cp\u003eI worked on this. I ran into new problems.\u003c/p\u003e\n\n\u003ch2 id=\"debug-mruby\"\u003eDebug - mruby\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ex@x:~/Desktop/research/mruby/bin$ gdb -q ./mruby\nReading symbols from ./mruby...done.\n(gdb) r mrb_str_concat-2.rb \nStarting program: /home/x/Desktop/research/mruby/bin/mruby mrb_str_concat-2.rb\n\nProgram received signal SIGSEGV, Segmentation fault.\n0x0000000000415cfe in mrb_str_concat (mrb=\u0026lt;optimized out\u0026gt;, self=\u0026lt;error reading variable: access outside bounds of object referenced via synthetic pointer\u0026gt;, other=...)\n    at /home/x/Desktop/research/mruby/src/string.c:764\n764   RSTR_PTR(s1)[len] = \u0026#39;\\0\u0026#39;;\n(gdb) bt\n#0  0x0000000000415cfe in mrb_str_concat (mrb=\u0026lt;optimized out\u0026gt;, self=\u0026lt;error reading variable: access outside bounds of object referenced via synthetic pointer\u0026gt;, other=...)\n    at /home/x/Desktop/research/mruby/src/string.c:764\n#1  0x0000000000501bdb in mrb_str_concat2 (mrb=0x755010, self=\u0026lt;error reading variable: access outside bounds of object referenced via synthetic pointer\u0026gt;)\n    at /home/x/Desktop/research/mruby/mrbgems/mruby-string-ext/src/string.c:151\n#2  0x00000000004b842d in mrb_vm_exec (mrb=\u0026lt;optimized out\u0026gt;, proc=0x0, pc=\u0026lt;optimized out\u0026gt;) at /home/x/Desktop/research/mruby/src/vm.c:1171\n#3  0x00000000004c1ecd in mrb_vm_run (proc=0x7581e0, self=..., stack_keep=16, mrb=\u0026lt;optimized out\u0026gt;) at /home/x/Desktop/research/mruby/src/vm.c:772\n#4  mrb_top_run (mrb=0x755010, proc=0x7581e0, self=..., stack_keep=\u0026lt;optimized out\u0026gt;) at /home/x/Desktop/research/mruby/src/vm.c:2487\n#5  0x000000000049472f in mrb_load_exec (mrb=0x755010, p=\u0026lt;optimized out\u0026gt;, c=0x7aff30) at /home/x/Desktop/research/mruby/mrbgems/mruby-compiler/core/parse.y:5755\n#6  0x0000000000402c67 in main (argc=\u0026lt;optimized out\u0026gt;, argv=\u0026lt;optimized out\u0026gt;) at /home/x/Desktop/research/mruby/mrbgems/mruby-bin-mruby/tools/mruby/mruby.c:232\n(gdb) info reg\nrax            0x9877   39031\nrbx            0xfffffffffffffffc   -4\nrcx            0x0  0\nrdx            0x744330 7619376\nrsi            0x0  0\nrdi            0x0  0\nrbp            0x0  0x0\nrsp            0x7fffffffd780   0x7fffffffd780\nr8             0x10 16\nr9             0x0  0\nr10            0x755010 7688208\nr11            0x8000044000000000   -9223367363930357760\nr12            0x758180 7700864\nr13            0x0  0\nr14            0x758180 7700864\nr15            0x0  0\nrip            0x415cfe 0x415cfe \u0026lt;mrb_str_concat+1246\u0026gt;\neflags         0x10202  [ IF RF ]\ncs             0x33 51\nss             0x2b 43\nds             0x0  0\nes             0x0  0\nfs             0x0  0\ngs             0x0  0\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2 id=\"sandbox\"\u003eSandbox\u003c/h2\u003e\n\n\u003cp\u003eAttached as sandbox.log\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ex@x:~/Desktop/research/mruby/bin$ ../../mruby-engine/bin/sandbox mrb_str_concat-2.rb \n../../mruby-engine/bin/sandbox:20: [BUG] Segmentation fault at 0x00000000000000\nruby 2.2.6p396 (2016-11-15 revision 56800) [x86_64-linux-gnu]\n\n-- Control frame information -----------------------------------------------\nc:0003 p:---- s:0010 e:000009 CFUNC  :sandbox_eval\nc:0002 p:0186 s:0005 E:0000c8 EVAL   ../../mruby-engine/bin/sandbox:20 [FINISH]\nc:0001 p:0000 s:0002 E:000f50 TOP    [FINISH]\n\n-- Ruby level backtrace information ----------------------------------------\n../../mruby-engine/bin/sandbox:20:in `\u0026lt;main\u0026gt;\u0026#39;\n../../mruby-engine/bin/sandbox:20:in `sandbox_eval\u0026#39;\n\n-- Machine register context ------------------------------------------------\n RIP: 0x00007f2f72f19788 RBP: 0x00007f2f71a940a0 RSP: 0x00007f2f71a8a980\n RAX: 0x0000000000000000 RBX: 0x00007f2f71a940a0 RCX: 0x0000000000000000\n RDX: 0x0000000000000000 RDI: 0x0000000000000000 RSI: 0x0000000000000000\n  R8: 0x00007f2f72f871ee  R9: 0x0000000000000001 R10: 0x00007f2f71a8c4e0\n R11: 0x0000000000000000 R12: 0x0000000000000000 R13: 0x00007f2f71a8c4e0\n R14: 0x0000000000000002 R15: 0x00007f2f71a8c4e0 EFL: 0x0000000000010246\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","automated_response":false,"created_at":"2016-12-20T22:10:14.667Z","updated_at":"2016-12-20T22:10:14.667Z","actor":{"username":"ston3","cleared":false,"url":"/ston3","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":145593,"filename":"sandbox.log","type":"text/plain","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/145/593/7464e490205aa472481a79c46f13be4cc4040c43/sandbox.log?response-content-disposition=attachment%3B%20filename%3D%22sandbox.log%22%3B%20filename%2A%3DUTF-8%27%27sandbox.log\u0026response-content-type=text%2Fplain\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQUOQU5REA%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T045005Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQDKbajvkbgJ0bk%2BBvRtGQ7p5KCzGha%2FVaDDwyFq8CM66wIgaw7%2FMRI5kyRpH%2BnIlLG4ZnmM%2FrLjLjJWrmkX0zZfd9sqtAMIVBABGgwwMTM2MTkyNzQ4NDkiDP91WL002Wbo0XGfnyqRA%2FNt3W4r54Z2Rrjnbzg30AtIqSAaUbiKh6dYPI5iumJt%2FacDVM4CmdTQCSkrpk45DFotrgtd1tIXQUPsAioE3hz70xop4zS0jebfAPdwBp38Mc3YKPYsW1TgWIT19zK4t%2B4eGJVFjPey5O%2FEfBu4XYpGDd%2Fy2VO0kVCb43%2F76mvlk6aWlA01UhpCilK3J%2F7qqZsw4P3jggaBSCjGhssHvqDLjMzfR%2FDpDE7VaotOr3rJmP5ZK66Q9%2BkoG5kaLgKcslwRO9FGLNBY8AuIhUCEMRp9RM9yBIFYe%2FyyvHRriCVGHEgdIJ9wvxaVVvCfEcWZw1dEIriA6BftAk5kML6b8WN8zwMI3cyqbnvBS9PGbEcrzzU67DDkEk0llxEfFqJB1g4ruY5L2BsxjsulOVXWFSQHoykg7EnBFBbQGmuPAyxW942tXfkTyjH7aQIFAbpwURAHEFFcnVcJBzYS%2B6tGyu1ozPdrsFK5Ko2OryeYDFeK8b9JxwAMZqBekNlk1Bn%2BWq2RJZZBgBTV1X9LfuQ%2FLbSAMJq2qv8FOusBgtnFtNPu6rgydFw%2BpCNudbVGZ39p3P2aIl7K%2B6fRTLBImgaGX5r2pXgGjSRb3Co5NHURzMlQWYw9SJdMt5vMsDNtT9otjm5R%2Fz00sRO779VmfaZOO18lLujlVlImBZA%2BY20iW%2B%2FVBR4UOivJTvxApUCo%2BQYZQghLFkO4s17mPPAo6XeP%2BtXjXhn71RPHuwavkbgQ0EuL1pf5gaqdarsB4psJiZ3FphFomE6unCMAErk3vFIwEIi%2Be5%2FjAIsDg6zS3oetmQEMR7IeJadGwnOF7tifKH8X2cyJk2IoG8HLG%2FfDEf2cBUt6EjPoIQ%3D%3D\u0026X-Amz-Signature=8d7047d502b922cf4569ddbba0724a1571438293c35e735ced9f45183946b325"}],"genius_execution_id":null,"team_handle":"shopify-scripts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1378101,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Attached as file.","markdown_message":"\u003cp\u003eAttached as file.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-12-20T22:11:03.028Z","updated_at":"2016-12-20T22:11:03.028Z","actor":{"username":"ston3","cleared":false,"url":"/ston3","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":145594,"filename":"mrb_ctr_concat-2.rb","type":"text/plain","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/145/594/bd1e9ed1b654d9a979db5ad56fd2265f5130322d/mrb_ctr_concat-2.rb?response-content-disposition=attachment%3B%20filename%3D%22mrb_ctr_concat-2.rb%22%3B%20filename%2A%3DUTF-8%27%27mrb_ctr_concat-2.rb\u0026response-content-type=text%2Fplain\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQUOQU5REA%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T045005Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQDKbajvkbgJ0bk%2BBvRtGQ7p5KCzGha%2FVaDDwyFq8CM66wIgaw7%2FMRI5kyRpH%2BnIlLG4ZnmM%2FrLjLjJWrmkX0zZfd9sqtAMIVBABGgwwMTM2MTkyNzQ4NDkiDP91WL002Wbo0XGfnyqRA%2FNt3W4r54Z2Rrjnbzg30AtIqSAaUbiKh6dYPI5iumJt%2FacDVM4CmdTQCSkrpk45DFotrgtd1tIXQUPsAioE3hz70xop4zS0jebfAPdwBp38Mc3YKPYsW1TgWIT19zK4t%2B4eGJVFjPey5O%2FEfBu4XYpGDd%2Fy2VO0kVCb43%2F76mvlk6aWlA01UhpCilK3J%2F7qqZsw4P3jggaBSCjGhssHvqDLjMzfR%2FDpDE7VaotOr3rJmP5ZK66Q9%2BkoG5kaLgKcslwRO9FGLNBY8AuIhUCEMRp9RM9yBIFYe%2FyyvHRriCVGHEgdIJ9wvxaVVvCfEcWZw1dEIriA6BftAk5kML6b8WN8zwMI3cyqbnvBS9PGbEcrzzU67DDkEk0llxEfFqJB1g4ruY5L2BsxjsulOVXWFSQHoykg7EnBFBbQGmuPAyxW942tXfkTyjH7aQIFAbpwURAHEFFcnVcJBzYS%2B6tGyu1ozPdrsFK5Ko2OryeYDFeK8b9JxwAMZqBekNlk1Bn%2BWq2RJZZBgBTV1X9LfuQ%2FLbSAMJq2qv8FOusBgtnFtNPu6rgydFw%2BpCNudbVGZ39p3P2aIl7K%2B6fRTLBImgaGX5r2pXgGjSRb3Co5NHURzMlQWYw9SJdMt5vMsDNtT9otjm5R%2Fz00sRO779VmfaZOO18lLujlVlImBZA%2BY20iW%2B%2FVBR4UOivJTvxApUCo%2BQYZQghLFkO4s17mPPAo6XeP%2BtXjXhn71RPHuwavkbgQ0EuL1pf5gaqdarsB4psJiZ3FphFomE6unCMAErk3vFIwEIi%2Be5%2FjAIsDg6zS3oetmQEMR7IeJadGwnOF7tifKH8X2cyJk2IoG8HLG%2FfDEf2cBUt6EjPoIQ%3D%3D\u0026X-Amz-Signature=75a4c9c7a42275a91ef563f1cd9eb185e8e18c6240cd9f8b497619a9783cd44b"}],"genius_execution_id":null,"team_handle":"shopify-scripts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1409742,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks again for your report. This issue has now been resolved upstream, and we are running a patched version in our production environment.\n\nOur next round of bounty decisions will take place within two weeks, so we will be in touch with you again soon.","markdown_message":"\u003cp\u003eThanks again for your report. This issue has now been resolved upstream, and we are running a patched version in our production environment.\u003c/p\u003e\n\n\u003cp\u003eOur next round of bounty decisions will take place within two weeks, so we will be in touch with you again soon.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-01-09T22:12:16.795Z","updated_at":"2017-01-09T22:12:16.795Z","actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"ston3","url":"/ston3"},"genius_execution_id":null,"team_handle":"shopify-scripts","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1414753,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks for helping improve the security of Shopify Scripts and the mruby project!","markdown_message":"\u003cp\u003eThanks for helping improve the security of Shopify Scripts and the mruby project!\u003c/p\u003e\n","automated_response":false,"created_at":"2017-01-11T21:56:38.610Z","updated_at":"2017-01-11T21:56:38.610Z","actor":{"url":"/shopify-scripts","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/668/ebbe467de8ef2fc936053593e1289e30f04c3b06_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"shopify-scripts"}},"bounty_amount":"800.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"shopify-scripts","collaborator":{"username":"ston3","url":"/ston3"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1414755,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-01-11T21:56:43.951Z","updated_at":"2017-01-11T21:56:43.951Z","first_to_agree":true,"actor":{"username":"andrewdunbar","cleared":false,"url":"/andrewdunbar","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/164/5b0e89675ed6dbb9df87223e9f8f58e2125bb56b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify-scripts","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1414851,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for bounty.\nBest Regards,","markdown_message":"\u003cp\u003eThanks for bounty.\u003cbr\u003e\nBest Regards,\u003c/p\u003e\n","automated_response":false,"created_at":"2017-01-11T22:25:02.063Z","updated_at":"2017-01-11T22:25:02.063Z","actor":{"username":"ston3","cleared":false,"url":"/ston3","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify-scripts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1478100,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-02-10T21:56:48.389Z","updated_at":"2017-02-10T21:56:48.389Z","actor":{"url":"/shopify-scripts","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/668/ebbe467de8ef2fc936053593e1289e30f04c3b06_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"shopify-scripts"}},"genius_execution_id":null,"team_handle":"shopify-scripts","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}