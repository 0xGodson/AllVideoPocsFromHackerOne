{"id":50829,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC81MDgyOQ==","url":"https://hackerone.com/reports/50829","title":"A user can post comments on other user's private videos","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2015-03-10T18:13:51.208Z","submitted_at":"2015-03-10T18:13:51.208Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"satishb3","url":"/satishb3","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/170/fc657d5dfd17ac30235e5687c8b2d9b461e0f64e_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":56,"url":"https://hackerone.com/vimeo","handle":"vimeo","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/056/c3188aa0fc4a95fd486b5ee1f4b2d0b90da111d3_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/056/c3188aa0fc4a95fd486b5ee1f4b2d0b90da111d3_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Vimeo","twitter_handle":"vimeo","website":"https://vimeo.com","about":"Make life worth watching"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2015-03-11T14:37:49.514Z","bug_reporter_agreed_on_going_public_at":"2015-03-11T02:47:05.294Z","team_member_agreed_on_going_public_at":"2015-03-11T14:37:48.510Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"It is possible for a user to post comments on other's private videos.\r\n\r\nSteps to verify:\r\n1. Log into www.vimeo.com as Alice and create a video (say, AliceVideo with id - 118026546) with 'Allow anyone to see my videos' setting.\r\n2. Login as Bob and create an album (say, BobAlbum with album id 3295969). \r\n3. From Bob, navigate to the AliceVideo URL - https://vimeo.com/118026546. Click collections and add video to BobAlbum.\r\n4. Navigate to BobAlbum and click the AliceVideo. The URL will looks like, https://vimeo.com/album/3295969/video/118026546\r\n5. Add a new comment and capture the request using burp proxy. Captured request looks like,\r\n\r\n    POST /118026546 HTTP/1.1\r\n    Host: vimeo.com\r\n    [...]\r\n\r\n    text=test\u0026action=add_comment\u0026token=...\u0026version=...\u0026group_id=3295969\u0026context_id=3295969\u0026context_type=album\u0026add_comment=Add%20a%20new%20comment\r\n\r\n6. From Alice account, make AliceVideo as private (check 'only me'-\u003e'apply to all existing videos' setting).\r\n\r\n7. From Bob account, access the AliceVideo URL (https://vimeo.com/album/3295969/video/118026546) and it displays 'permssion denied' message. At this point, Bob can't view the video or leave comments. However, Bob can post comments on the private video by replaying the request captured in step 5.\r\n","vulnerability_information_html":"\u003cp\u003eIt is possible for a user to post comments on other\u0026#39;s private videos.\u003c/p\u003e\n\n\u003cp\u003eSteps to verify:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eLog into \u003ca href=\"/redirect?url=http%3A%2F%2Fwww.vimeo.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ewww.vimeo.com\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e as Alice and create a video (say, AliceVideo with id - 118026546) with \u0026#39;Allow anyone to see my videos\u0026#39; setting.\u003c/li\u003e\n\u003cli\u003eLogin as Bob and create an album (say, BobAlbum with album id 3295969). \u003c/li\u003e\n\u003cli\u003eFrom Bob, navigate to the AliceVideo URL - \u003ca title=\"https://vimeo.com/118026546\" href=\"/redirect?url=https%3A%2F%2Fvimeo.com%2F118026546\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://vimeo.com/118026546\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e. Click collections and add video to BobAlbum.\u003c/li\u003e\n\u003cli\u003eNavigate to BobAlbum and click the AliceVideo. The URL will looks like, \u003ca title=\"https://vimeo.com/album/3295969/video/118026546\" href=\"/redirect?url=https%3A%2F%2Fvimeo.com%2Falbum%2F3295969%2Fvideo%2F118026546\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://vimeo.com/album/3295969/video/118026546\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eAdd a new comment and capture the request using burp proxy. Captured request looks like,\u003c/p\u003e\n\n\u003cp\u003ePOST /118026546 HTTP/1.1\u003cbr\u003e\nHost: vimeo.com\u003cbr\u003e\n[...]\u003c/p\u003e\n\n\u003cp\u003etext=test\u0026amp;action=add_comment\u0026amp;token=...\u0026amp;version=...\u0026amp;group_id=3295969\u0026amp;context_id=3295969\u0026amp;context_type=album\u0026amp;add_comment=Add%20a%20new%20comment\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eFrom Alice account, make AliceVideo as private (check \u0026#39;only me\u0026#39;-\u0026gt;\u0026#39;apply to all existing videos\u0026#39; setting).\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eFrom Bob account, access the AliceVideo URL (\u003ca title=\"https://vimeo.com/album/3295969/video/118026546\" href=\"/redirect?url=https%3A%2F%2Fvimeo.com%2Falbum%2F3295969%2Fvideo%2F118026546\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://vimeo.com/album/3295969/video/118026546\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e) and it displays \u0026#39;permssion denied\u0026#39; message. At this point, Bob can\u0026#39;t view the video or leave comments. However, Bob can post comments on the private video by replaying the request captured in step 5.\u003c/p\u003e\u003c/li\u003e\n\u003c/ol\u003e\n","bounty_amount":"500.0","formatted_bounty":"$500","weakness":{"id":75,"name":"Privilege Escalation"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2015-04-10T02:47:06.023Z","allow_singular_disclosure_after":-180588299.2734036,"singular_disclosure_allowed":true,"vote_count":1,"voters":["eveeez"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":350383,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2015-03-10T19:31:20.607Z","updated_at":"2015-03-10T19:31:20.607Z","actor":{"username":"andrewp","cleared":false,"url":"/andrewp","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/966/b9d700976d0952781d36b6dbd46cb36c8ec59da9_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"satishb3","url":"/satishb3"},"genius_execution_id":null,"team_handle":"vimeo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":350384,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2015-03-10T19:31:35.519Z","updated_at":"2015-03-10T19:31:35.519Z","actor":{"url":"/vimeo","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/056/c3188aa0fc4a95fd486b5ee1f4b2d0b90da111d3_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Vimeo"}},"bounty_amount":"500.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"vimeo","collaborator":{"username":"satishb3","url":"/satishb3"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":350676,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-03-11T02:47:05.336Z","updated_at":"2015-03-11T02:47:05.336Z","first_to_agree":true,"actor":{"username":"satishb3","cleared":true,"url":"/satishb3","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/170/fc657d5dfd17ac30235e5687c8b2d9b461e0f64e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vimeo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":351109,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-03-11T14:37:48.576Z","updated_at":"2015-03-11T14:37:48.576Z","actor":{"username":"andrewp","cleared":false,"url":"/andrewp","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/966/b9d700976d0952781d36b6dbd46cb36c8ec59da9_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vimeo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":351110,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-03-11T14:37:49.582Z","updated_at":"2015-03-11T14:37:49.582Z","actor":{"username":"andrewp","cleared":false,"url":"/andrewp","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/966/b9d700976d0952781d36b6dbd46cb36c8ec59da9_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"vimeo","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}