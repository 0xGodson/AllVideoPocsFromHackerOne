{"id":890272,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC84OTAyNzI=","url":"https://hackerone.com/reports/890272","title":"[H1-2006 2020]  \"Swiss Cheese\" design style leads to helping Mårten Mickos pay poor hackers","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2020-06-03T16:59:48.340Z","submitted_at":"2020-06-03T16:59:48.340Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"al-madjus","url":"/al-madjus","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/340/244/c9666ba3cc7b1d2720860b836b33fdacfa969b78_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":46757,"url":"https://hackerone.com/h1-ctf","handle":"h1-ctf","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/1hYGHKjWZv64FAEYq32nP1EU/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/1hYGHKjWZv64FAEYq32nP1EU/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"h1-ctf","twitter_handle":"Hacker0x01","website":"https://hackyholidays.h1ctf.com","about":"Please help us stop the Grinch!"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2020-06-18T15:30:44.604Z","bug_reporter_agreed_on_going_public_at":"2020-06-18T08:22:02.943Z","team_member_agreed_on_going_public_at":"2020-06-18T15:30:44.520Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"## Summary:\nSeveral vulnerabilities in the bountypay application leads to unauthorised access, information disclosure, SSRF and other fun stuff. \n\n# Steps To Reproduce:\n\nThis is how I helped Mårten Mickos pay the poor hackers who had been waiting so long for their bounties. \n\n## First part: Web \n\nI started by finding all subdomains for challenge: \nhttps://bountypay.h1ctf.com\nhttps://app.bountypay.h1ctf.com\nhttps://staff.bountypay.h1ctf.com\nhttps://api.bountypay.h1ctf.com\nhttps://www.bountypay.h1ctf.com\nhttps://software.bountypay.h1ctf.com\n\nFuzzing the subdomains, I found this: `https://app.bountypay.h1ctf.com/.git/HEAD`\nChecking `/.git/config` showed the link to the github repo and an interesting file: \n`https://github.com/bounty-pay-code/request-logger/blob/master/logger.php`\nwhich referenced the file `bp_web_trace.log` which could be found here: \n`https://app.bountypay.h1ctf.com/bp_web_trace.log`\n\nDecoding the contents of that file gave: \n`{\"IP\":\"192.168.1.1\",\"URI\":\"\\/\",\"METHOD\":\"GET\",\"PARAMS\":{\"GET\":[],\"POST\":[]}}\n{\"IP\":\"192.168.1.1\",\"URI\":\"\\/\",\"METHOD\":\"POST\",\"PARAMS\":{\"GET\":[],\"POST\":{\"username\":\"brian.oliver\",\"password\":\"V7h0inzX\"}}}\n{\"IP\":\"192.168.1.1\",\"URI\":\"\\/\",\"METHOD\":\"POST\",\"PARAMS\":{\"GET\":[],\"POST\":{\"username\":\"brian.oliver\",\"password\":\"V7h0inzX\",\"challenge_answer\":\"bD83Jk27dQ\"}}}\n{\"IP\":\"192.168.1.1\",\"URI\":\"\\/statements\",\"METHOD\":\"GET\",\"PARAMS\":{\"GET\":{\"month\":\"04\",\"year\":\"2020\"},\"POST\":[]}}`\nThis looked like a server log which included credentials for the user 'brian.oliver', plus a challenge_answer. \n\nLogging in to `app.bountypay.h1ctf.com` which this user resulted in a 2fa challenge.\n{F854022}\nSupplying the answer from the log did not pass the 2fa, apparently that answer had expired. \nLooking at the source of the challenge, the `challenge_value` is 32 chars long, which could indicate an MD5sum. Trying to bruteforce this value did not give any result, apparently it is now a common word. \nMaybe it's the MD5sum of the challenge answer? The md5sum of `bD83Jk27dQ` is `5828c689761cce705a1c84d9b1a1ed5e` and intercepting the 2fa POST request and putting those 2 values in resulted in passing the 2fa! \n\nI was now presented with the BountyPay Dashboard. Loading all transactions through the past few years and into the future\nreturned empty responses. However the reply included an API URL that the backend used to look up the transactions. Qeueing the API directly gave \"Missing or invalid Token\", apparently I was not authenticated on that subdomain so I'd have to fuzz the API through `app.bountypay`. \nAt this point I noticed that putting a path traversal in the cookie (which is base64 encoded JSON) like this: \n`{\"account_id\":\"F8gHiqSdpK/../F8gHiqSdpK\",\"hash\":\"de235bffd23df6995ad4e0930baac1a2\"}`\nresulted in the same result as the original cookie. Maybe I could exploit this?\n\nEarlier I had noticed how `api.bountypay` had a redirect function that only allowed redirecting to a limited subset of URLs, including many of the `*.bountypay` subdomains. One of those subdomains, `https://software.bountypay.h1ctf.com` returned `401 Unauthorized` telling me I was not allowed to access it from my IP. Maybe I could use SSRF to access it\nfrom `api.bountypay`? \nAfter some trial and error I constructed the following payload: \n`{\"account_id\":\"F8gHiqSdpK/../../../redirect?url=https://software.bountypay.h1ctf.com/#\",\"hash\":\"de235bffd23df6995ad4e0930baac1a2\"}`\nwhich used path traversal to back up to the index page, redirected to `software.bountypay` and included a trailing `#` to get rid of the `statements` parameter added by the bountypay dashboard. \n\nWith this I could now view the contents of software.bountypay which presented a login portal. \nSeeing no way past this (it only accepted POST requests, GET requests did not work) I resorted to fuzzing the subdomain, writing a quick python script to do this.\nWith this I found an /uploads folder that contained a file called `BountyPay.apk`. \n{F854027}\nLuckily getting this file was possible from any IP, as it wasn't possible to get it via SSRF. \n\n## Second part: Mobile\nThis part presented me with a lot of trouble, mainly because I have very little experience with mobile hacking. \nAfter solving a lot of problems with Android Studio specific to my system I was able to get an Android virtual device running with the BountyPay apk and also attached a logger. \nI also decompiled the apk using `jadx-gui` and found the three main activities for the app. The application uses intents but I was not able to make those work in the virtual device, so I logged into it via `adb` and launched them via the shell. \nLaunching the application and logging in (it didn't seem to matter which username I used) I looked at the decompiled code to see what was required to pass Part One (which presented the hints \"Deep Links\" and \"Params\").\n`if (getIntent() != null \u0026\u0026 getIntent().getData() != null \u0026\u0026 (firstParam =\ngetIntent().getData().getQueryParameter(\"start\")) != null \u0026\u0026\nfirstParam.equals(\"PartTwoActivity\") \u0026\u0026 settings.contains(\"USERNAME\"))`\n\nSo I needed to pass an intent with one parameter containing \"PartTwoActivity\": \n`am start -a android.intent.action.VIEW -d \"one://part?start=PartTwoActivity\"`\nWith this I was presented with Part Two, which gave these hints: \"Currently invisible\" and \"Visible with the right params\". \nAgain from the decompiled code: \n`String firstParam = data.getQueryParameter(\"two\");\nString secondParam = data.getQueryParameter(\"switch\");\n    if (firstParam != null \u0026\u0026 firstParam.equals(\"light\") \u0026\u0026\n      secondParam != null \u0026\u0026 secondParam.equals(\"on\"))`\n\nSo this time we needed 2 parameters, \"two=light\" and \"switch=on\", which I passed like this: \n`am start -a android.intent.action.VIEW -d \"two://part?two=light\u0026switch=on\"`\n\nNow I saw the 'invisible' thing, a hash value and an input box to check a header value (the hash value?). \n{F854035}\nWriting down the hash thinking it would be useful later, I started submitting header values. It wasn't the hash, so I again looked at the decompiled code.  \n`if (str.equals(\"X-\" + ((String) dataSnapshot.getValue())))`\nSo it had to start with \"X-\" and then the value of `dataSnapshot`. I couldn't really identify that value so I just tried different values and happened upon \"X-Token\" - and it worked! I was now on Part Three! \n\nThis part required 3 parameters according to the source code, the first 2 being base64 encoded values and the last the value of the X-Token: \n`if (str != null \u0026\u0026 decodedFirstParam.equals(\"PartThreeActivity\") \u0026\u0026 str2 != null \u0026\u0026 decodedSecondParam.equals(\"on\") \u0026\u0026 (str = secondParam2) != null) {\n                        if (str.equals(\"X-\" + value)) `\nAgain I thought that this token would be the hash leaked before, but no, once again it was just \"X-Token\"! \nPassing that with `adb` the application crashed. I had to go through the process several times, sometimes it would crash, other times it would go back to Part Two instead of advancing until I URL-encoded the equal signs in the base64: \n`am start -a android.intent.action.VIEW -d\n\"three://part?three=UGFydFRocmVlQWN0aXZpdHk%3D\\\u0026switch=b24%3D\\\u0026header=X-Token\"`\n\nWith this I advanced and got a screen asking to input a hash. Again it wasn't the hash from before but looking in the attached logger I saw the following token: \n`X-Token: 8e9998ee3137ca9ade8f372739f062c1`\nPutting this in the input box I was presented with a screen saying I had completed all Android challenges! \n{F854039}\n{F854040}\n\n\n## Third part: PrivEsc\nUsing the newly found X-Token I went to `api.bountypay` where it authorised me. I could now query the API and found the `/api/staff` endpoint which listed staff names and ids. Trying to make a POST request to this endpoint gave `409\nConflict \"Staff Member already has an account\"`. Interesting! \nEarlier an official hint was posted on Twitter for a new staff hire showing her staff card with this staff ID (never do that kids!): `8FJ3KFISL3`\nPutting this in the request with a ficticious name resulted in this: \n{F854043}\nTrying these credentials on the staff login portal worked, I now had staff access! \n\nGoing through the staff application I found 4 important clues: \n+ `website.js` referred to 2 interesting functions: `upgradeToAdmin` and a\nreport URL, plus `#tab{1,4}` which were queried in the location hash. \n+ Using the parameter `username` I could populate the login screen like this: \n`https://staff.bountypay.h1ctf.com/?template=login\u0026username=sandra.allison`\n+ Using arrays, I was able to chain templates together in the same site like\nthis: \n`https://staff.bountypay.h1ctf.com/?template[]=login\u0026template[]=ticket\u0026ticket_id=3582`\n+ There was an injection in the upgrade avatar functionality, but any non-alphanumerics were stripped away. \n\nPlaying around with each of these functionalities didn't really get me anywhere. I was unable to get upgraded to admin just by reporting the upgrade URL, and I couldn't really get XSS or anything else interesting via the injection vulnerability. \n\nFor this step I'd like to credit Clos2100 and Simone Bovi who I was collaborating with; they helped me put all the above clues together. \nTurns out there exists something called \"Event Bubbling\", where by passing one JavaScript event together with another associated function, causes them both to execute. Chaining the above clues together like this resulted in getting\nupgraded to admin privileges: \nInjecting a `tab1` event into the avatar name together with the `upgradeToAdmin` function caused this function to execute too. \n`profile_avatar=tab1+upgradeToAdmin`\nHowever, since `upgradeToAdmin` required a username`'input[name=\"username\"]'` I needed to supply the username via the parameter mentioned earlier, and chain both  pages together (the avatar is reflected in the Support Tickets page) and finally supply the `#tab1` event in the URL:\n`https://staff.bountypay.h1ctf.com/?template[]=login\u0026username=sandra.allison\u0026template[]=ticket\u0026ticket_id=3582#tab1`\n\nSending this link to the admin via the report link, and intercepting the request and adding `#tab1` and again base64 encoding (the #... part gets removed by the report functionality) I was able to get admin privileges. \n\nGoing to the admin area I got Mårten Mickos' login credentials: \n`marten.mickos:h\u0026H5wy2Lggj*kKn4OD\u0026Ype`\n{F854048}\n\n\n## Fourth part: 2FA \nMårten's login credentials worked on `app.bountypay`, which again required me to bypass the same 2fa challenge as before. \nGoing to the dashboard I loaded the transactions for 05/2020 and clicked pay.\nAfter spending hours and hours trying to funnel the 210.300$ into my own account I gave up and instead focused on completing the CTF (hackers gotta be hackers...). \n\nClicking 'Pay' lead to another 2fa (at first I thought it was the same as before and said \"Why do they even bother?\") - but of course this was 1000x more difficult! Loading the challenge caused the client to make a POST request with a css file, I could change the link to the file and have it contact my server (though only HTTPS servers which caused me some trouble). I served a slightly altered css file that simply changed the background colour, but this resulted in no change. Inspecting the file closer lead me to believe it was used server side for the 2fa functionality. Interesting: maybe this was where the codes were displayed? \n\nI started looking into css injection techniques and read an interesting blog post by D0nut. I tried creating a similar attack to extract the challenge codes out-of-band, supposing them to be visible server side. \nOnce again I must credit Clos2100 as well as FersingB for helping me with this step. After a lot of trial and error I came up with a css attack script that queried each character of the code letter for letter, sending back the correct character to my server. The script is attached below (F854056). \nSending this malicious css file to the server and then looking in my server log I saw all 7 characters (though out of order) and had 2 minutes to input them. This passed the final 2fa challenge and all the hackers finally got paid!\n\n^FLAG^736c635d8842751b8aafa556154eb9f3$FLAG$\n\n{F854058}\n\n# Supporting material\nBlog post by D0nut referenced for the css attack: \nhttps://medium.com/@d0nut/better-exfiltration-via-html-injection-31c72a2dae8b\n\n## Impact\n\nHackers could get paid. Who would want that? :-p","vulnerability_information_html":"\u003ch2 id=\"summary\"\u003eSummary:\u003c/h2\u003e\n\n\u003cp\u003eSeveral vulnerabilities in the bountypay application leads to unauthorised access, information disclosure, SSRF and other fun stuff. \u003c/p\u003e\n\n\u003ch1 id=\"steps-to-reproduce\"\u003eSteps To Reproduce:\u003c/h1\u003e\n\n\u003cp\u003eThis is how I helped Mårten Mickos pay the poor hackers who had been waiting so long for their bounties. \u003c/p\u003e\n\n\u003ch2 id=\"first-part-web\"\u003eFirst part: Web\u003c/h2\u003e\n\n\u003cp\u003eI started by finding all subdomains for challenge: \u003cbr\u003e\n\u003ca title=\"https://bountypay.h1ctf.com\" href=\"/redirect?url=https%3A%2F%2Fbountypay.h1ctf.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://bountypay.h1ctf.com\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\n\u003ca title=\"https://app.bountypay.h1ctf.com\" href=\"/redirect?url=https%3A%2F%2Fapp.bountypay.h1ctf.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://app.bountypay.h1ctf.com\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\n\u003ca title=\"https://staff.bountypay.h1ctf.com\" href=\"/redirect?url=https%3A%2F%2Fstaff.bountypay.h1ctf.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://staff.bountypay.h1ctf.com\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\n\u003ca title=\"https://api.bountypay.h1ctf.com\" href=\"/redirect?url=https%3A%2F%2Fapi.bountypay.h1ctf.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://api.bountypay.h1ctf.com\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\n\u003ca title=\"https://www.bountypay.h1ctf.com\" href=\"/redirect?url=https%3A%2F%2Fwww.bountypay.h1ctf.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.bountypay.h1ctf.com\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\n\u003ca title=\"https://software.bountypay.h1ctf.com\" href=\"/redirect?url=https%3A%2F%2Fsoftware.bountypay.h1ctf.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://software.bountypay.h1ctf.com\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eFuzzing the subdomains, I found this: \u003ccode\u003ehttps://app.bountypay.h1ctf.com/.git/HEAD\u003c/code\u003e\u003cbr\u003e\nChecking \u003ccode\u003e/.git/config\u003c/code\u003e showed the link to the github repo and an interesting file: \u003cbr\u003e\n\u003ccode\u003ehttps://github.com/bounty-pay-code/request-logger/blob/master/logger.php\u003c/code\u003e\u003cbr\u003e\nwhich referenced the file \u003ccode\u003ebp_web_trace.log\u003c/code\u003e which could be found here: \u003cbr\u003e\n\u003ccode\u003ehttps://app.bountypay.h1ctf.com/bp_web_trace.log\u003c/code\u003e\u003c/p\u003e\n\n\u003cp\u003eDecoding the contents of that file gave: \u003cbr\u003e\n\u003ccode\u003e{\u0026quot;IP\u0026quot;:\u0026quot;192.168.1.1\u0026quot;,\u0026quot;URI\u0026quot;:\u0026quot;\\/\u0026quot;,\u0026quot;METHOD\u0026quot;:\u0026quot;GET\u0026quot;,\u0026quot;PARAMS\u0026quot;:{\u0026quot;GET\u0026quot;:[],\u0026quot;POST\u0026quot;:[]}}\u003cbr\u003e\n{\u0026quot;IP\u0026quot;:\u0026quot;192.168.1.1\u0026quot;,\u0026quot;URI\u0026quot;:\u0026quot;\\/\u0026quot;,\u0026quot;METHOD\u0026quot;:\u0026quot;POST\u0026quot;,\u0026quot;PARAMS\u0026quot;:{\u0026quot;GET\u0026quot;:[],\u0026quot;POST\u0026quot;:{\u0026quot;username\u0026quot;:\u0026quot;brian.oliver\u0026quot;,\u0026quot;password\u0026quot;:\u0026quot;V7h0inzX\u0026quot;}}}\u003cbr\u003e\n{\u0026quot;IP\u0026quot;:\u0026quot;192.168.1.1\u0026quot;,\u0026quot;URI\u0026quot;:\u0026quot;\\/\u0026quot;,\u0026quot;METHOD\u0026quot;:\u0026quot;POST\u0026quot;,\u0026quot;PARAMS\u0026quot;:{\u0026quot;GET\u0026quot;:[],\u0026quot;POST\u0026quot;:{\u0026quot;username\u0026quot;:\u0026quot;brian.oliver\u0026quot;,\u0026quot;password\u0026quot;:\u0026quot;V7h0inzX\u0026quot;,\u0026quot;challenge_answer\u0026quot;:\u0026quot;bD83Jk27dQ\u0026quot;}}}\u003cbr\u003e\n{\u0026quot;IP\u0026quot;:\u0026quot;192.168.1.1\u0026quot;,\u0026quot;URI\u0026quot;:\u0026quot;\\/statements\u0026quot;,\u0026quot;METHOD\u0026quot;:\u0026quot;GET\u0026quot;,\u0026quot;PARAMS\u0026quot;:{\u0026quot;GET\u0026quot;:{\u0026quot;month\u0026quot;:\u0026quot;04\u0026quot;,\u0026quot;year\u0026quot;:\u0026quot;2020\u0026quot;},\u0026quot;POST\u0026quot;:[]}}\u003c/code\u003e\u003cbr\u003e\nThis looked like a server log which included credentials for the user \u0026#39;brian.oliver\u0026#39;, plus a challenge_answer. \u003c/p\u003e\n\n\u003cp\u003eLogging in to \u003ccode\u003eapp.bountypay.h1ctf.com\u003c/code\u003e which this user resulted in a 2fa challenge.\u003cbr\u003e\n\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"first_2fa.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/yhLbigPMYHSgVMzU4FYHoaR3?response-content-disposition=attachment%3B%20filename%3D%22first_2fa.png%22%3B%20filename%2A%3DUTF-8%27%27first_2fa.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQ7BHOOAHM%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T070649Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIC0rVDoRsFwr%2BrE%2FOgXElPBjXmjW3to5vdwNhP1wFQmHAiEApMYNrLPtv0tUukQAZP%2BpY8D337e343jzGApem%2BwDWNEqtAMIWBABGgwwMTM2MTkyNzQ4NDkiDDFmqN%2FUWM7LS2CP1CqRAzFzlzfQjDdfcQXTdKF4YWe3Ih2IBeY9k3MXIY0WjWW1%2BZAhMyb7GEYkYW7WaHjanGksmLqccSeteVbrBk4Dc4D4uos0j7X%2FwwOLAqc5CxWpZee14Sn1tHeHs2ZMfkvA3vawPIqvRQysMjNVBMuXEH6vEVXtFaHFvHYM1SeTHx2%2ByBwaybyx6rWR7%2Bn2%2BvqhUWOGxa2hRntPYXxf9kc3Ojv83zWw30z%2F5vvBOs7T48%2BkxZGI2%2BwJDIUKtaa1P%2Bvrj%2FHxCVJ%2BXHmtu2gT6QrBPgEzxWDkQk5Fom2jigHSXiG1CDokA%2FtSn%2FMJ%2FofBuj7A1gVYJeXZWmYzDMetXCIN3VwKb92GhW7i3COAtBZhbrqDM5lA6AcEd11a1U8DkhbH5PgpGOPFV2wYTiJzBu6V4ZScxe09zNqfNVIKCa68FIB39HBQ3aFwyKwL1DGho6qzhDO7jyCviTCSPKfyYMFBAVpapptpE%2F%2Fgs2tzO%2FTi7l4DPCDUJuaDRsKdhw%2FfMdazZvg1jGKYMVNHBGA5PFFMduHfMPueq%2F8FOusB9p2zMiXKTd4Y9jgXza23QmD6hmcJ1QuxiF2euCPnZTLjeC4TB5NgQMYQ6kYvq7iqbTvcQRjBRAsofmkvGaFKLtnDIJZKLjv%2FO66tDOnKteRmMVRA5wrgRFEDB%2B6Mhz3VMpTBn0hnZlkIdUq7iSIHbz6jD3FfvwpsFTg%2FW6YTrgpzhatfXl9H9IWEZEOQEJaHO6bAoyd0xyIc7xydfxjcvkvQ5HGvrB5rYN9YJ85lZ3UDur%2B3aD9BpBeipos%2F8ycM7sApkYOlUn4Wp65Kb%2B69FQjBNZGYCUzszuBqIyqc2b1%2F6B63CHEc5HfYrA%3D%3D\u0026amp;X-Amz-Signature=d9fe69bd94abca270e3216f65292a32723e5ec6a50e892bd6be760e8123dfcc9\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/yhLbigPMYHSgVMzU4FYHoaR3?response-content-disposition=attachment%3B%20filename%3D%22first_2fa.png%22%3B%20filename%2A%3DUTF-8%27%27first_2fa.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQ7BHOOAHM%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T070649Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIC0rVDoRsFwr%2BrE%2FOgXElPBjXmjW3to5vdwNhP1wFQmHAiEApMYNrLPtv0tUukQAZP%2BpY8D337e343jzGApem%2BwDWNEqtAMIWBABGgwwMTM2MTkyNzQ4NDkiDDFmqN%2FUWM7LS2CP1CqRAzFzlzfQjDdfcQXTdKF4YWe3Ih2IBeY9k3MXIY0WjWW1%2BZAhMyb7GEYkYW7WaHjanGksmLqccSeteVbrBk4Dc4D4uos0j7X%2FwwOLAqc5CxWpZee14Sn1tHeHs2ZMfkvA3vawPIqvRQysMjNVBMuXEH6vEVXtFaHFvHYM1SeTHx2%2ByBwaybyx6rWR7%2Bn2%2BvqhUWOGxa2hRntPYXxf9kc3Ojv83zWw30z%2F5vvBOs7T48%2BkxZGI2%2BwJDIUKtaa1P%2Bvrj%2FHxCVJ%2BXHmtu2gT6QrBPgEzxWDkQk5Fom2jigHSXiG1CDokA%2FtSn%2FMJ%2FofBuj7A1gVYJeXZWmYzDMetXCIN3VwKb92GhW7i3COAtBZhbrqDM5lA6AcEd11a1U8DkhbH5PgpGOPFV2wYTiJzBu6V4ZScxe09zNqfNVIKCa68FIB39HBQ3aFwyKwL1DGho6qzhDO7jyCviTCSPKfyYMFBAVpapptpE%2F%2Fgs2tzO%2FTi7l4DPCDUJuaDRsKdhw%2FfMdazZvg1jGKYMVNHBGA5PFFMduHfMPueq%2F8FOusB9p2zMiXKTd4Y9jgXza23QmD6hmcJ1QuxiF2euCPnZTLjeC4TB5NgQMYQ6kYvq7iqbTvcQRjBRAsofmkvGaFKLtnDIJZKLjv%2FO66tDOnKteRmMVRA5wrgRFEDB%2B6Mhz3VMpTBn0hnZlkIdUq7iSIHbz6jD3FfvwpsFTg%2FW6YTrgpzhatfXl9H9IWEZEOQEJaHO6bAoyd0xyIc7xydfxjcvkvQ5HGvrB5rYN9YJ85lZ3UDur%2B3aD9BpBeipos%2F8ycM7sApkYOlUn4Wp65Kb%2B69FQjBNZGYCUzszuBqIyqc2b1%2F6B63CHEc5HfYrA%3D%3D\u0026amp;X-Amz-Signature=d9fe69bd94abca270e3216f65292a32723e5ec6a50e892bd6be760e8123dfcc9\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003cbr\u003e\nSupplying the answer from the log did not pass the 2fa, apparently that answer had expired. \u003cbr\u003e\nLooking at the source of the challenge, the \u003ccode\u003echallenge_value\u003c/code\u003e is 32 chars long, which could indicate an MD5sum. Trying to bruteforce this value did not give any result, apparently it is now a common word. \u003cbr\u003e\nMaybe it\u0026#39;s the MD5sum of the challenge answer? The md5sum of \u003ccode\u003ebD83Jk27dQ\u003c/code\u003e is \u003ccode\u003e5828c689761cce705a1c84d9b1a1ed5e\u003c/code\u003e and intercepting the 2fa POST request and putting those 2 values in resulted in passing the 2fa! \u003c/p\u003e\n\n\u003cp\u003eI was now presented with the BountyPay Dashboard. Loading all transactions through the past few years and into the future\u003cbr\u003e\nreturned empty responses. However the reply included an API URL that the backend used to look up the transactions. Qeueing the API directly gave \u0026quot;Missing or invalid Token\u0026quot;, apparently I was not authenticated on that subdomain so I\u0026#39;d have to fuzz the API through \u003ccode\u003eapp.bountypay\u003c/code\u003e. \u003cbr\u003e\nAt this point I noticed that putting a path traversal in the cookie (which is base64 encoded JSON) like this: \u003cbr\u003e\n\u003ccode\u003e{\u0026quot;account_id\u0026quot;:\u0026quot;F8gHiqSdpK/../F8gHiqSdpK\u0026quot;,\u0026quot;hash\u0026quot;:\u0026quot;de235bffd23df6995ad4e0930baac1a2\u0026quot;}\u003c/code\u003e\u003cbr\u003e\nresulted in the same result as the original cookie. Maybe I could exploit this?\u003c/p\u003e\n\n\u003cp\u003eEarlier I had noticed how \u003ccode\u003eapi.bountypay\u003c/code\u003e had a redirect function that only allowed redirecting to a limited subset of URLs, including many of the \u003ccode\u003e*.bountypay\u003c/code\u003e subdomains. One of those subdomains, \u003ccode\u003ehttps://software.bountypay.h1ctf.com\u003c/code\u003e returned \u003ccode\u003e401 Unauthorized\u003c/code\u003e telling me I was not allowed to access it from my IP. Maybe I could use SSRF to access it\u003cbr\u003e\nfrom \u003ccode\u003eapi.bountypay\u003c/code\u003e? \u003cbr\u003e\nAfter some trial and error I constructed the following payload: \u003cbr\u003e\n\u003ccode\u003e{\u0026quot;account_id\u0026quot;:\u0026quot;F8gHiqSdpK/../../../redirect?url=https://software.bountypay.h1ctf.com/#\u0026quot;,\u0026quot;hash\u0026quot;:\u0026quot;de235bffd23df6995ad4e0930baac1a2\u0026quot;}\u003c/code\u003e\u003cbr\u003e\nwhich used path traversal to back up to the index page, redirected to \u003ccode\u003esoftware.bountypay\u003c/code\u003e and included a trailing \u003ccode\u003e#\u003c/code\u003e to get rid of the \u003ccode\u003estatements\u003c/code\u003e parameter added by the bountypay dashboard. \u003c/p\u003e\n\n\u003cp\u003eWith this I could now view the contents of software.bountypay which presented a login portal. \u003cbr\u003e\nSeeing no way past this (it only accepted POST requests, GET requests did not work) I resorted to fuzzing the subdomain, writing a quick python script to do this.\u003cbr\u003e\nWith this I found an /uploads folder that contained a file called \u003ccode\u003eBountyPay.apk\u003c/code\u003e. \u003cbr\u003e\n\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"apkfile.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/bVNKPSJKFbnYXWRSJTACXLSJ?response-content-disposition=attachment%3B%20filename%3D%22apkfile.png%22%3B%20filename%2A%3DUTF-8%27%27apkfile.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQ7BHOOAHM%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T070649Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIC0rVDoRsFwr%2BrE%2FOgXElPBjXmjW3to5vdwNhP1wFQmHAiEApMYNrLPtv0tUukQAZP%2BpY8D337e343jzGApem%2BwDWNEqtAMIWBABGgwwMTM2MTkyNzQ4NDkiDDFmqN%2FUWM7LS2CP1CqRAzFzlzfQjDdfcQXTdKF4YWe3Ih2IBeY9k3MXIY0WjWW1%2BZAhMyb7GEYkYW7WaHjanGksmLqccSeteVbrBk4Dc4D4uos0j7X%2FwwOLAqc5CxWpZee14Sn1tHeHs2ZMfkvA3vawPIqvRQysMjNVBMuXEH6vEVXtFaHFvHYM1SeTHx2%2ByBwaybyx6rWR7%2Bn2%2BvqhUWOGxa2hRntPYXxf9kc3Ojv83zWw30z%2F5vvBOs7T48%2BkxZGI2%2BwJDIUKtaa1P%2Bvrj%2FHxCVJ%2BXHmtu2gT6QrBPgEzxWDkQk5Fom2jigHSXiG1CDokA%2FtSn%2FMJ%2FofBuj7A1gVYJeXZWmYzDMetXCIN3VwKb92GhW7i3COAtBZhbrqDM5lA6AcEd11a1U8DkhbH5PgpGOPFV2wYTiJzBu6V4ZScxe09zNqfNVIKCa68FIB39HBQ3aFwyKwL1DGho6qzhDO7jyCviTCSPKfyYMFBAVpapptpE%2F%2Fgs2tzO%2FTi7l4DPCDUJuaDRsKdhw%2FfMdazZvg1jGKYMVNHBGA5PFFMduHfMPueq%2F8FOusB9p2zMiXKTd4Y9jgXza23QmD6hmcJ1QuxiF2euCPnZTLjeC4TB5NgQMYQ6kYvq7iqbTvcQRjBRAsofmkvGaFKLtnDIJZKLjv%2FO66tDOnKteRmMVRA5wrgRFEDB%2B6Mhz3VMpTBn0hnZlkIdUq7iSIHbz6jD3FfvwpsFTg%2FW6YTrgpzhatfXl9H9IWEZEOQEJaHO6bAoyd0xyIc7xydfxjcvkvQ5HGvrB5rYN9YJ85lZ3UDur%2B3aD9BpBeipos%2F8ycM7sApkYOlUn4Wp65Kb%2B69FQjBNZGYCUzszuBqIyqc2b1%2F6B63CHEc5HfYrA%3D%3D\u0026amp;X-Amz-Signature=abb23bc4ec311183ec8774d5abe117b45cc3b5fe9347332e5cbdab16b221c5ab\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/bVNKPSJKFbnYXWRSJTACXLSJ?response-content-disposition=attachment%3B%20filename%3D%22apkfile.png%22%3B%20filename%2A%3DUTF-8%27%27apkfile.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQ7BHOOAHM%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T070649Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIC0rVDoRsFwr%2BrE%2FOgXElPBjXmjW3to5vdwNhP1wFQmHAiEApMYNrLPtv0tUukQAZP%2BpY8D337e343jzGApem%2BwDWNEqtAMIWBABGgwwMTM2MTkyNzQ4NDkiDDFmqN%2FUWM7LS2CP1CqRAzFzlzfQjDdfcQXTdKF4YWe3Ih2IBeY9k3MXIY0WjWW1%2BZAhMyb7GEYkYW7WaHjanGksmLqccSeteVbrBk4Dc4D4uos0j7X%2FwwOLAqc5CxWpZee14Sn1tHeHs2ZMfkvA3vawPIqvRQysMjNVBMuXEH6vEVXtFaHFvHYM1SeTHx2%2ByBwaybyx6rWR7%2Bn2%2BvqhUWOGxa2hRntPYXxf9kc3Ojv83zWw30z%2F5vvBOs7T48%2BkxZGI2%2BwJDIUKtaa1P%2Bvrj%2FHxCVJ%2BXHmtu2gT6QrBPgEzxWDkQk5Fom2jigHSXiG1CDokA%2FtSn%2FMJ%2FofBuj7A1gVYJeXZWmYzDMetXCIN3VwKb92GhW7i3COAtBZhbrqDM5lA6AcEd11a1U8DkhbH5PgpGOPFV2wYTiJzBu6V4ZScxe09zNqfNVIKCa68FIB39HBQ3aFwyKwL1DGho6qzhDO7jyCviTCSPKfyYMFBAVpapptpE%2F%2Fgs2tzO%2FTi7l4DPCDUJuaDRsKdhw%2FfMdazZvg1jGKYMVNHBGA5PFFMduHfMPueq%2F8FOusB9p2zMiXKTd4Y9jgXza23QmD6hmcJ1QuxiF2euCPnZTLjeC4TB5NgQMYQ6kYvq7iqbTvcQRjBRAsofmkvGaFKLtnDIJZKLjv%2FO66tDOnKteRmMVRA5wrgRFEDB%2B6Mhz3VMpTBn0hnZlkIdUq7iSIHbz6jD3FfvwpsFTg%2FW6YTrgpzhatfXl9H9IWEZEOQEJaHO6bAoyd0xyIc7xydfxjcvkvQ5HGvrB5rYN9YJ85lZ3UDur%2B3aD9BpBeipos%2F8ycM7sApkYOlUn4Wp65Kb%2B69FQjBNZGYCUzszuBqIyqc2b1%2F6B63CHEc5HfYrA%3D%3D\u0026amp;X-Amz-Signature=abb23bc4ec311183ec8774d5abe117b45cc3b5fe9347332e5cbdab16b221c5ab\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003cbr\u003e\nLuckily getting this file was possible from any IP, as it wasn\u0026#39;t possible to get it via SSRF. \u003c/p\u003e\n\n\u003ch2 id=\"second-part-mobile\"\u003eSecond part: Mobile\u003c/h2\u003e\n\n\u003cp\u003eThis part presented me with a lot of trouble, mainly because I have very little experience with mobile hacking. \u003cbr\u003e\nAfter solving a lot of problems with Android Studio specific to my system I was able to get an Android virtual device running with the BountyPay apk and also attached a logger. \u003cbr\u003e\nI also decompiled the apk using \u003ccode\u003ejadx-gui\u003c/code\u003e and found the three main activities for the app. The application uses intents but I was not able to make those work in the virtual device, so I logged into it via \u003ccode\u003eadb\u003c/code\u003e and launched them via the shell. \u003cbr\u003e\nLaunching the application and logging in (it didn\u0026#39;t seem to matter which username I used) I looked at the decompiled code to see what was required to pass Part One (which presented the hints \u0026quot;Deep Links\u0026quot; and \u0026quot;Params\u0026quot;).\u003cbr\u003e\n\u003ccode\u003eif (getIntent() != null \u0026amp;\u0026amp; getIntent().getData() != null \u0026amp;\u0026amp; (firstParam =\u003cbr\u003e\ngetIntent().getData().getQueryParameter(\u0026quot;start\u0026quot;)) != null \u0026amp;\u0026amp;\u003cbr\u003e\nfirstParam.equals(\u0026quot;PartTwoActivity\u0026quot;) \u0026amp;\u0026amp; settings.contains(\u0026quot;USERNAME\u0026quot;))\u003c/code\u003e\u003c/p\u003e\n\n\u003cp\u003eSo I needed to pass an intent with one parameter containing \u0026quot;PartTwoActivity\u0026quot;: \u003cbr\u003e\n\u003ccode\u003eam start -a android.intent.action.VIEW -d \u0026quot;one://part?start=PartTwoActivity\u0026quot;\u003c/code\u003e\u003cbr\u003e\nWith this I was presented with Part Two, which gave these hints: \u0026quot;Currently invisible\u0026quot; and \u0026quot;Visible with the right params\u0026quot;. \u003cbr\u003e\nAgain from the decompiled code: \u003cbr\u003e\n\u003ccode\u003eString firstParam = data.getQueryParameter(\u0026quot;two\u0026quot;);\u003cbr\u003e\nString secondParam = data.getQueryParameter(\u0026quot;switch\u0026quot;);\u003cbr\u003e\n    if (firstParam != null \u0026amp;\u0026amp; firstParam.equals(\u0026quot;light\u0026quot;) \u0026amp;\u0026amp;\u003cbr\u003e\n      secondParam != null \u0026amp;\u0026amp; secondParam.equals(\u0026quot;on\u0026quot;))\u003c/code\u003e\u003c/p\u003e\n\n\u003cp\u003eSo this time we needed 2 parameters, \u0026quot;two=light\u0026quot; and \u0026quot;switch=on\u0026quot;, which I passed like this: \u003cbr\u003e\n\u003ccode\u003eam start -a android.intent.action.VIEW -d \u0026quot;two://part?two=light\u0026amp;switch=on\u0026quot;\u003c/code\u003e\u003c/p\u003e\n\n\u003cp\u003eNow I saw the \u0026#39;invisible\u0026#39; thing, a hash value and an input box to check a header value (the hash value?). \u003cbr\u003e\n\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"parttwo.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/YpJd2yNkMcPXP5yVr9gpRaZM?response-content-disposition=attachment%3B%20filename%3D%22parttwo.png%22%3B%20filename%2A%3DUTF-8%27%27parttwo.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQ7BHOOAHM%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T070649Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIC0rVDoRsFwr%2BrE%2FOgXElPBjXmjW3to5vdwNhP1wFQmHAiEApMYNrLPtv0tUukQAZP%2BpY8D337e343jzGApem%2BwDWNEqtAMIWBABGgwwMTM2MTkyNzQ4NDkiDDFmqN%2FUWM7LS2CP1CqRAzFzlzfQjDdfcQXTdKF4YWe3Ih2IBeY9k3MXIY0WjWW1%2BZAhMyb7GEYkYW7WaHjanGksmLqccSeteVbrBk4Dc4D4uos0j7X%2FwwOLAqc5CxWpZee14Sn1tHeHs2ZMfkvA3vawPIqvRQysMjNVBMuXEH6vEVXtFaHFvHYM1SeTHx2%2ByBwaybyx6rWR7%2Bn2%2BvqhUWOGxa2hRntPYXxf9kc3Ojv83zWw30z%2F5vvBOs7T48%2BkxZGI2%2BwJDIUKtaa1P%2Bvrj%2FHxCVJ%2BXHmtu2gT6QrBPgEzxWDkQk5Fom2jigHSXiG1CDokA%2FtSn%2FMJ%2FofBuj7A1gVYJeXZWmYzDMetXCIN3VwKb92GhW7i3COAtBZhbrqDM5lA6AcEd11a1U8DkhbH5PgpGOPFV2wYTiJzBu6V4ZScxe09zNqfNVIKCa68FIB39HBQ3aFwyKwL1DGho6qzhDO7jyCviTCSPKfyYMFBAVpapptpE%2F%2Fgs2tzO%2FTi7l4DPCDUJuaDRsKdhw%2FfMdazZvg1jGKYMVNHBGA5PFFMduHfMPueq%2F8FOusB9p2zMiXKTd4Y9jgXza23QmD6hmcJ1QuxiF2euCPnZTLjeC4TB5NgQMYQ6kYvq7iqbTvcQRjBRAsofmkvGaFKLtnDIJZKLjv%2FO66tDOnKteRmMVRA5wrgRFEDB%2B6Mhz3VMpTBn0hnZlkIdUq7iSIHbz6jD3FfvwpsFTg%2FW6YTrgpzhatfXl9H9IWEZEOQEJaHO6bAoyd0xyIc7xydfxjcvkvQ5HGvrB5rYN9YJ85lZ3UDur%2B3aD9BpBeipos%2F8ycM7sApkYOlUn4Wp65Kb%2B69FQjBNZGYCUzszuBqIyqc2b1%2F6B63CHEc5HfYrA%3D%3D\u0026amp;X-Amz-Signature=d07aa77290fafa2aa27fc289e5e57bf247a4994e06819ab31410797b626e1b02\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/YpJd2yNkMcPXP5yVr9gpRaZM?response-content-disposition=attachment%3B%20filename%3D%22parttwo.png%22%3B%20filename%2A%3DUTF-8%27%27parttwo.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQ7BHOOAHM%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T070649Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIC0rVDoRsFwr%2BrE%2FOgXElPBjXmjW3to5vdwNhP1wFQmHAiEApMYNrLPtv0tUukQAZP%2BpY8D337e343jzGApem%2BwDWNEqtAMIWBABGgwwMTM2MTkyNzQ4NDkiDDFmqN%2FUWM7LS2CP1CqRAzFzlzfQjDdfcQXTdKF4YWe3Ih2IBeY9k3MXIY0WjWW1%2BZAhMyb7GEYkYW7WaHjanGksmLqccSeteVbrBk4Dc4D4uos0j7X%2FwwOLAqc5CxWpZee14Sn1tHeHs2ZMfkvA3vawPIqvRQysMjNVBMuXEH6vEVXtFaHFvHYM1SeTHx2%2ByBwaybyx6rWR7%2Bn2%2BvqhUWOGxa2hRntPYXxf9kc3Ojv83zWw30z%2F5vvBOs7T48%2BkxZGI2%2BwJDIUKtaa1P%2Bvrj%2FHxCVJ%2BXHmtu2gT6QrBPgEzxWDkQk5Fom2jigHSXiG1CDokA%2FtSn%2FMJ%2FofBuj7A1gVYJeXZWmYzDMetXCIN3VwKb92GhW7i3COAtBZhbrqDM5lA6AcEd11a1U8DkhbH5PgpGOPFV2wYTiJzBu6V4ZScxe09zNqfNVIKCa68FIB39HBQ3aFwyKwL1DGho6qzhDO7jyCviTCSPKfyYMFBAVpapptpE%2F%2Fgs2tzO%2FTi7l4DPCDUJuaDRsKdhw%2FfMdazZvg1jGKYMVNHBGA5PFFMduHfMPueq%2F8FOusB9p2zMiXKTd4Y9jgXza23QmD6hmcJ1QuxiF2euCPnZTLjeC4TB5NgQMYQ6kYvq7iqbTvcQRjBRAsofmkvGaFKLtnDIJZKLjv%2FO66tDOnKteRmMVRA5wrgRFEDB%2B6Mhz3VMpTBn0hnZlkIdUq7iSIHbz6jD3FfvwpsFTg%2FW6YTrgpzhatfXl9H9IWEZEOQEJaHO6bAoyd0xyIc7xydfxjcvkvQ5HGvrB5rYN9YJ85lZ3UDur%2B3aD9BpBeipos%2F8ycM7sApkYOlUn4Wp65Kb%2B69FQjBNZGYCUzszuBqIyqc2b1%2F6B63CHEc5HfYrA%3D%3D\u0026amp;X-Amz-Signature=d07aa77290fafa2aa27fc289e5e57bf247a4994e06819ab31410797b626e1b02\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003cbr\u003e\nWriting down the hash thinking it would be useful later, I started submitting header values. It wasn\u0026#39;t the hash, so I again looked at the decompiled code.\u003cbr\u003e\u003cbr\u003e\n\u003ccode\u003eif (str.equals(\u0026quot;X-\u0026quot; + ((String) dataSnapshot.getValue())))\u003c/code\u003e\u003cbr\u003e\nSo it had to start with \u0026quot;X-\u0026quot; and then the value of \u003ccode\u003edataSnapshot\u003c/code\u003e. I couldn\u0026#39;t really identify that value so I just tried different values and happened upon \u0026quot;X-Token\u0026quot; - and it worked! I was now on Part Three! \u003c/p\u003e\n\n\u003cp\u003eThis part required 3 parameters according to the source code, the first 2 being base64 encoded values and the last the value of the X-Token: \u003cbr\u003e\n\u003ccode\u003eif (str != null \u0026amp;\u0026amp; decodedFirstParam.equals(\u0026quot;PartThreeActivity\u0026quot;) \u0026amp;\u0026amp; str2 != null \u0026amp;\u0026amp; decodedSecondParam.equals(\u0026quot;on\u0026quot;) \u0026amp;\u0026amp; (str = secondParam2) != null) {\u003cbr\u003e\n                        if (str.equals(\u0026quot;X-\u0026quot; + value))\u003c/code\u003e\u003cbr\u003e\nAgain I thought that this token would be the hash leaked before, but no, once again it was just \u0026quot;X-Token\u0026quot;! \u003cbr\u003e\nPassing that with \u003ccode\u003eadb\u003c/code\u003e the application crashed. I had to go through the process several times, sometimes it would crash, other times it would go back to Part Two instead of advancing until I URL-encoded the equal signs in the base64: \u003cbr\u003e\n\u003ccode\u003eam start -a android.intent.action.VIEW -d\u003cbr\u003e\n\u0026quot;three://part?three=UGFydFRocmVlQWN0aXZpdHk%3D\\\u0026amp;switch=b24%3D\\\u0026amp;header=X-Token\u0026quot;\u003c/code\u003e\u003c/p\u003e\n\n\u003cp\u003eWith this I advanced and got a screen asking to input a hash. Again it wasn\u0026#39;t the hash from before but looking in the attached logger I saw the following token: \u003cbr\u003e\n\u003ccode\u003eX-Token: 8e9998ee3137ca9ade8f372739f062c1\u003c/code\u003e\u003cbr\u003e\nPutting this in the input box I was presented with a screen saying I had completed all Android challenges! \u003cbr\u003e\n\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"x-token.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/sgersworBCmTdPWdSDJcnbR8?response-content-disposition=attachment%3B%20filename%3D%22x-token.png%22%3B%20filename%2A%3DUTF-8%27%27x-token.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQ7BHOOAHM%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T070649Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIC0rVDoRsFwr%2BrE%2FOgXElPBjXmjW3to5vdwNhP1wFQmHAiEApMYNrLPtv0tUukQAZP%2BpY8D337e343jzGApem%2BwDWNEqtAMIWBABGgwwMTM2MTkyNzQ4NDkiDDFmqN%2FUWM7LS2CP1CqRAzFzlzfQjDdfcQXTdKF4YWe3Ih2IBeY9k3MXIY0WjWW1%2BZAhMyb7GEYkYW7WaHjanGksmLqccSeteVbrBk4Dc4D4uos0j7X%2FwwOLAqc5CxWpZee14Sn1tHeHs2ZMfkvA3vawPIqvRQysMjNVBMuXEH6vEVXtFaHFvHYM1SeTHx2%2ByBwaybyx6rWR7%2Bn2%2BvqhUWOGxa2hRntPYXxf9kc3Ojv83zWw30z%2F5vvBOs7T48%2BkxZGI2%2BwJDIUKtaa1P%2Bvrj%2FHxCVJ%2BXHmtu2gT6QrBPgEzxWDkQk5Fom2jigHSXiG1CDokA%2FtSn%2FMJ%2FofBuj7A1gVYJeXZWmYzDMetXCIN3VwKb92GhW7i3COAtBZhbrqDM5lA6AcEd11a1U8DkhbH5PgpGOPFV2wYTiJzBu6V4ZScxe09zNqfNVIKCa68FIB39HBQ3aFwyKwL1DGho6qzhDO7jyCviTCSPKfyYMFBAVpapptpE%2F%2Fgs2tzO%2FTi7l4DPCDUJuaDRsKdhw%2FfMdazZvg1jGKYMVNHBGA5PFFMduHfMPueq%2F8FOusB9p2zMiXKTd4Y9jgXza23QmD6hmcJ1QuxiF2euCPnZTLjeC4TB5NgQMYQ6kYvq7iqbTvcQRjBRAsofmkvGaFKLtnDIJZKLjv%2FO66tDOnKteRmMVRA5wrgRFEDB%2B6Mhz3VMpTBn0hnZlkIdUq7iSIHbz6jD3FfvwpsFTg%2FW6YTrgpzhatfXl9H9IWEZEOQEJaHO6bAoyd0xyIc7xydfxjcvkvQ5HGvrB5rYN9YJ85lZ3UDur%2B3aD9BpBeipos%2F8ycM7sApkYOlUn4Wp65Kb%2B69FQjBNZGYCUzszuBqIyqc2b1%2F6B63CHEc5HfYrA%3D%3D\u0026amp;X-Amz-Signature=9bdbbe0188146edc3e096fba12e0618525a63ca4171e784cc41305df73d9661b\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/sgersworBCmTdPWdSDJcnbR8?response-content-disposition=attachment%3B%20filename%3D%22x-token.png%22%3B%20filename%2A%3DUTF-8%27%27x-token.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQ7BHOOAHM%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T070649Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIC0rVDoRsFwr%2BrE%2FOgXElPBjXmjW3to5vdwNhP1wFQmHAiEApMYNrLPtv0tUukQAZP%2BpY8D337e343jzGApem%2BwDWNEqtAMIWBABGgwwMTM2MTkyNzQ4NDkiDDFmqN%2FUWM7LS2CP1CqRAzFzlzfQjDdfcQXTdKF4YWe3Ih2IBeY9k3MXIY0WjWW1%2BZAhMyb7GEYkYW7WaHjanGksmLqccSeteVbrBk4Dc4D4uos0j7X%2FwwOLAqc5CxWpZee14Sn1tHeHs2ZMfkvA3vawPIqvRQysMjNVBMuXEH6vEVXtFaHFvHYM1SeTHx2%2ByBwaybyx6rWR7%2Bn2%2BvqhUWOGxa2hRntPYXxf9kc3Ojv83zWw30z%2F5vvBOs7T48%2BkxZGI2%2BwJDIUKtaa1P%2Bvrj%2FHxCVJ%2BXHmtu2gT6QrBPgEzxWDkQk5Fom2jigHSXiG1CDokA%2FtSn%2FMJ%2FofBuj7A1gVYJeXZWmYzDMetXCIN3VwKb92GhW7i3COAtBZhbrqDM5lA6AcEd11a1U8DkhbH5PgpGOPFV2wYTiJzBu6V4ZScxe09zNqfNVIKCa68FIB39HBQ3aFwyKwL1DGho6qzhDO7jyCviTCSPKfyYMFBAVpapptpE%2F%2Fgs2tzO%2FTi7l4DPCDUJuaDRsKdhw%2FfMdazZvg1jGKYMVNHBGA5PFFMduHfMPueq%2F8FOusB9p2zMiXKTd4Y9jgXza23QmD6hmcJ1QuxiF2euCPnZTLjeC4TB5NgQMYQ6kYvq7iqbTvcQRjBRAsofmkvGaFKLtnDIJZKLjv%2FO66tDOnKteRmMVRA5wrgRFEDB%2B6Mhz3VMpTBn0hnZlkIdUq7iSIHbz6jD3FfvwpsFTg%2FW6YTrgpzhatfXl9H9IWEZEOQEJaHO6bAoyd0xyIc7xydfxjcvkvQ5HGvrB5rYN9YJ85lZ3UDur%2B3aD9BpBeipos%2F8ycM7sApkYOlUn4Wp65Kb%2B69FQjBNZGYCUzszuBqIyqc2b1%2F6B63CHEc5HfYrA%3D%3D\u0026amp;X-Amz-Signature=9bdbbe0188146edc3e096fba12e0618525a63ca4171e784cc41305df73d9661b\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003cbr\u003e\n\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"congrats.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/VjdfZNgv51EYqLeJa8X1AGUp?response-content-disposition=attachment%3B%20filename%3D%22congrats.png%22%3B%20filename%2A%3DUTF-8%27%27congrats.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQ7BHOOAHM%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T070649Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIC0rVDoRsFwr%2BrE%2FOgXElPBjXmjW3to5vdwNhP1wFQmHAiEApMYNrLPtv0tUukQAZP%2BpY8D337e343jzGApem%2BwDWNEqtAMIWBABGgwwMTM2MTkyNzQ4NDkiDDFmqN%2FUWM7LS2CP1CqRAzFzlzfQjDdfcQXTdKF4YWe3Ih2IBeY9k3MXIY0WjWW1%2BZAhMyb7GEYkYW7WaHjanGksmLqccSeteVbrBk4Dc4D4uos0j7X%2FwwOLAqc5CxWpZee14Sn1tHeHs2ZMfkvA3vawPIqvRQysMjNVBMuXEH6vEVXtFaHFvHYM1SeTHx2%2ByBwaybyx6rWR7%2Bn2%2BvqhUWOGxa2hRntPYXxf9kc3Ojv83zWw30z%2F5vvBOs7T48%2BkxZGI2%2BwJDIUKtaa1P%2Bvrj%2FHxCVJ%2BXHmtu2gT6QrBPgEzxWDkQk5Fom2jigHSXiG1CDokA%2FtSn%2FMJ%2FofBuj7A1gVYJeXZWmYzDMetXCIN3VwKb92GhW7i3COAtBZhbrqDM5lA6AcEd11a1U8DkhbH5PgpGOPFV2wYTiJzBu6V4ZScxe09zNqfNVIKCa68FIB39HBQ3aFwyKwL1DGho6qzhDO7jyCviTCSPKfyYMFBAVpapptpE%2F%2Fgs2tzO%2FTi7l4DPCDUJuaDRsKdhw%2FfMdazZvg1jGKYMVNHBGA5PFFMduHfMPueq%2F8FOusB9p2zMiXKTd4Y9jgXza23QmD6hmcJ1QuxiF2euCPnZTLjeC4TB5NgQMYQ6kYvq7iqbTvcQRjBRAsofmkvGaFKLtnDIJZKLjv%2FO66tDOnKteRmMVRA5wrgRFEDB%2B6Mhz3VMpTBn0hnZlkIdUq7iSIHbz6jD3FfvwpsFTg%2FW6YTrgpzhatfXl9H9IWEZEOQEJaHO6bAoyd0xyIc7xydfxjcvkvQ5HGvrB5rYN9YJ85lZ3UDur%2B3aD9BpBeipos%2F8ycM7sApkYOlUn4Wp65Kb%2B69FQjBNZGYCUzszuBqIyqc2b1%2F6B63CHEc5HfYrA%3D%3D\u0026amp;X-Amz-Signature=958345bbc7a39523f790c79a11f1000f2e5834dd5d240b59f486a8886fd56c79\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/VjdfZNgv51EYqLeJa8X1AGUp?response-content-disposition=attachment%3B%20filename%3D%22congrats.png%22%3B%20filename%2A%3DUTF-8%27%27congrats.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQ7BHOOAHM%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T070649Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIC0rVDoRsFwr%2BrE%2FOgXElPBjXmjW3to5vdwNhP1wFQmHAiEApMYNrLPtv0tUukQAZP%2BpY8D337e343jzGApem%2BwDWNEqtAMIWBABGgwwMTM2MTkyNzQ4NDkiDDFmqN%2FUWM7LS2CP1CqRAzFzlzfQjDdfcQXTdKF4YWe3Ih2IBeY9k3MXIY0WjWW1%2BZAhMyb7GEYkYW7WaHjanGksmLqccSeteVbrBk4Dc4D4uos0j7X%2FwwOLAqc5CxWpZee14Sn1tHeHs2ZMfkvA3vawPIqvRQysMjNVBMuXEH6vEVXtFaHFvHYM1SeTHx2%2ByBwaybyx6rWR7%2Bn2%2BvqhUWOGxa2hRntPYXxf9kc3Ojv83zWw30z%2F5vvBOs7T48%2BkxZGI2%2BwJDIUKtaa1P%2Bvrj%2FHxCVJ%2BXHmtu2gT6QrBPgEzxWDkQk5Fom2jigHSXiG1CDokA%2FtSn%2FMJ%2FofBuj7A1gVYJeXZWmYzDMetXCIN3VwKb92GhW7i3COAtBZhbrqDM5lA6AcEd11a1U8DkhbH5PgpGOPFV2wYTiJzBu6V4ZScxe09zNqfNVIKCa68FIB39HBQ3aFwyKwL1DGho6qzhDO7jyCviTCSPKfyYMFBAVpapptpE%2F%2Fgs2tzO%2FTi7l4DPCDUJuaDRsKdhw%2FfMdazZvg1jGKYMVNHBGA5PFFMduHfMPueq%2F8FOusB9p2zMiXKTd4Y9jgXza23QmD6hmcJ1QuxiF2euCPnZTLjeC4TB5NgQMYQ6kYvq7iqbTvcQRjBRAsofmkvGaFKLtnDIJZKLjv%2FO66tDOnKteRmMVRA5wrgRFEDB%2B6Mhz3VMpTBn0hnZlkIdUq7iSIHbz6jD3FfvwpsFTg%2FW6YTrgpzhatfXl9H9IWEZEOQEJaHO6bAoyd0xyIc7xydfxjcvkvQ5HGvrB5rYN9YJ85lZ3UDur%2B3aD9BpBeipos%2F8ycM7sApkYOlUn4Wp65Kb%2B69FQjBNZGYCUzszuBqIyqc2b1%2F6B63CHEc5HfYrA%3D%3D\u0026amp;X-Amz-Signature=958345bbc7a39523f790c79a11f1000f2e5834dd5d240b59f486a8886fd56c79\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2 id=\"third-part-privesc\"\u003eThird part: PrivEsc\u003c/h2\u003e\n\n\u003cp\u003eUsing the newly found X-Token I went to \u003ccode\u003eapi.bountypay\u003c/code\u003e where it authorised me. I could now query the API and found the \u003ccode\u003e/api/staff\u003c/code\u003e endpoint which listed staff names and ids. Trying to make a POST request to this endpoint gave \u003ccode\u003e409\u003cbr\u003e\nConflict \u0026quot;Staff Member already has an account\u0026quot;\u003c/code\u003e. Interesting! \u003cbr\u003e\nEarlier an official hint was posted on Twitter for a new staff hire showing her staff card with this staff ID (never do that kids!): \u003ccode\u003e8FJ3KFISL3\u003c/code\u003e\u003cbr\u003e\nPutting this in the request with a ficticious name resulted in this: \u003cbr\u003e\n\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"staff_created.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/wCwSaDKzb2FomeQfCtgJH3gb?response-content-disposition=attachment%3B%20filename%3D%22staff_created.png%22%3B%20filename%2A%3DUTF-8%27%27staff_created.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQ7BHOOAHM%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T070649Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIC0rVDoRsFwr%2BrE%2FOgXElPBjXmjW3to5vdwNhP1wFQmHAiEApMYNrLPtv0tUukQAZP%2BpY8D337e343jzGApem%2BwDWNEqtAMIWBABGgwwMTM2MTkyNzQ4NDkiDDFmqN%2FUWM7LS2CP1CqRAzFzlzfQjDdfcQXTdKF4YWe3Ih2IBeY9k3MXIY0WjWW1%2BZAhMyb7GEYkYW7WaHjanGksmLqccSeteVbrBk4Dc4D4uos0j7X%2FwwOLAqc5CxWpZee14Sn1tHeHs2ZMfkvA3vawPIqvRQysMjNVBMuXEH6vEVXtFaHFvHYM1SeTHx2%2ByBwaybyx6rWR7%2Bn2%2BvqhUWOGxa2hRntPYXxf9kc3Ojv83zWw30z%2F5vvBOs7T48%2BkxZGI2%2BwJDIUKtaa1P%2Bvrj%2FHxCVJ%2BXHmtu2gT6QrBPgEzxWDkQk5Fom2jigHSXiG1CDokA%2FtSn%2FMJ%2FofBuj7A1gVYJeXZWmYzDMetXCIN3VwKb92GhW7i3COAtBZhbrqDM5lA6AcEd11a1U8DkhbH5PgpGOPFV2wYTiJzBu6V4ZScxe09zNqfNVIKCa68FIB39HBQ3aFwyKwL1DGho6qzhDO7jyCviTCSPKfyYMFBAVpapptpE%2F%2Fgs2tzO%2FTi7l4DPCDUJuaDRsKdhw%2FfMdazZvg1jGKYMVNHBGA5PFFMduHfMPueq%2F8FOusB9p2zMiXKTd4Y9jgXza23QmD6hmcJ1QuxiF2euCPnZTLjeC4TB5NgQMYQ6kYvq7iqbTvcQRjBRAsofmkvGaFKLtnDIJZKLjv%2FO66tDOnKteRmMVRA5wrgRFEDB%2B6Mhz3VMpTBn0hnZlkIdUq7iSIHbz6jD3FfvwpsFTg%2FW6YTrgpzhatfXl9H9IWEZEOQEJaHO6bAoyd0xyIc7xydfxjcvkvQ5HGvrB5rYN9YJ85lZ3UDur%2B3aD9BpBeipos%2F8ycM7sApkYOlUn4Wp65Kb%2B69FQjBNZGYCUzszuBqIyqc2b1%2F6B63CHEc5HfYrA%3D%3D\u0026amp;X-Amz-Signature=01f5fad52ff4718badb462534484462a86fade7432d06d12852bd23ce710ee5b\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/wCwSaDKzb2FomeQfCtgJH3gb?response-content-disposition=attachment%3B%20filename%3D%22staff_created.png%22%3B%20filename%2A%3DUTF-8%27%27staff_created.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQ7BHOOAHM%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T070649Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIC0rVDoRsFwr%2BrE%2FOgXElPBjXmjW3to5vdwNhP1wFQmHAiEApMYNrLPtv0tUukQAZP%2BpY8D337e343jzGApem%2BwDWNEqtAMIWBABGgwwMTM2MTkyNzQ4NDkiDDFmqN%2FUWM7LS2CP1CqRAzFzlzfQjDdfcQXTdKF4YWe3Ih2IBeY9k3MXIY0WjWW1%2BZAhMyb7GEYkYW7WaHjanGksmLqccSeteVbrBk4Dc4D4uos0j7X%2FwwOLAqc5CxWpZee14Sn1tHeHs2ZMfkvA3vawPIqvRQysMjNVBMuXEH6vEVXtFaHFvHYM1SeTHx2%2ByBwaybyx6rWR7%2Bn2%2BvqhUWOGxa2hRntPYXxf9kc3Ojv83zWw30z%2F5vvBOs7T48%2BkxZGI2%2BwJDIUKtaa1P%2Bvrj%2FHxCVJ%2BXHmtu2gT6QrBPgEzxWDkQk5Fom2jigHSXiG1CDokA%2FtSn%2FMJ%2FofBuj7A1gVYJeXZWmYzDMetXCIN3VwKb92GhW7i3COAtBZhbrqDM5lA6AcEd11a1U8DkhbH5PgpGOPFV2wYTiJzBu6V4ZScxe09zNqfNVIKCa68FIB39HBQ3aFwyKwL1DGho6qzhDO7jyCviTCSPKfyYMFBAVpapptpE%2F%2Fgs2tzO%2FTi7l4DPCDUJuaDRsKdhw%2FfMdazZvg1jGKYMVNHBGA5PFFMduHfMPueq%2F8FOusB9p2zMiXKTd4Y9jgXza23QmD6hmcJ1QuxiF2euCPnZTLjeC4TB5NgQMYQ6kYvq7iqbTvcQRjBRAsofmkvGaFKLtnDIJZKLjv%2FO66tDOnKteRmMVRA5wrgRFEDB%2B6Mhz3VMpTBn0hnZlkIdUq7iSIHbz6jD3FfvwpsFTg%2FW6YTrgpzhatfXl9H9IWEZEOQEJaHO6bAoyd0xyIc7xydfxjcvkvQ5HGvrB5rYN9YJ85lZ3UDur%2B3aD9BpBeipos%2F8ycM7sApkYOlUn4Wp65Kb%2B69FQjBNZGYCUzszuBqIyqc2b1%2F6B63CHEc5HfYrA%3D%3D\u0026amp;X-Amz-Signature=01f5fad52ff4718badb462534484462a86fade7432d06d12852bd23ce710ee5b\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003cbr\u003e\nTrying these credentials on the staff login portal worked, I now had staff access! \u003c/p\u003e\n\n\u003cp\u003eGoing through the staff application I found 4 important clues: \u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e\n\u003ccode\u003ewebsite.js\u003c/code\u003e referred to 2 interesting functions: \u003ccode\u003eupgradeToAdmin\u003c/code\u003e and a\nreport URL, plus \u003ccode\u003e#tab{1,4}\u003c/code\u003e which were queried in the location hash. \u003c/li\u003e\n\u003cli\u003eUsing the parameter \u003ccode\u003eusername\u003c/code\u003e I could populate the login screen like this: \n\u003ccode\u003ehttps://staff.bountypay.h1ctf.com/?template=login\u0026amp;username=sandra.allison\u003c/code\u003e\n\u003c/li\u003e\n\u003cli\u003eUsing arrays, I was able to chain templates together in the same site like\nthis: \n\u003ccode\u003ehttps://staff.bountypay.h1ctf.com/?template[]=login\u0026amp;template[]=ticket\u0026amp;ticket_id=3582\u003c/code\u003e\n\u003c/li\u003e\n\u003cli\u003eThere was an injection in the upgrade avatar functionality, but any non-alphanumerics were stripped away. \u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003ePlaying around with each of these functionalities didn\u0026#39;t really get me anywhere. I was unable to get upgraded to admin just by reporting the upgrade URL, and I couldn\u0026#39;t really get XSS or anything else interesting via the injection vulnerability. \u003c/p\u003e\n\n\u003cp\u003eFor this step I\u0026#39;d like to credit Clos2100 and Simone Bovi who I was collaborating with; they helped me put all the above clues together. \u003cbr\u003e\nTurns out there exists something called \u0026quot;Event Bubbling\u0026quot;, where by passing one JavaScript event together with another associated function, causes them both to execute. Chaining the above clues together like this resulted in getting\u003cbr\u003e\nupgraded to admin privileges: \u003cbr\u003e\nInjecting a \u003ccode\u003etab1\u003c/code\u003e event into the avatar name together with the \u003ccode\u003eupgradeToAdmin\u003c/code\u003e function caused this function to execute too. \u003cbr\u003e\n\u003ccode\u003eprofile_avatar=tab1+upgradeToAdmin\u003c/code\u003e\u003cbr\u003e\nHowever, since \u003ccode\u003eupgradeToAdmin\u003c/code\u003e required a username\u003ccode\u003e\u0026#39;input[name=\u0026quot;username\u0026quot;]\u0026#39;\u003c/code\u003e I needed to supply the username via the parameter mentioned earlier, and chain both  pages together (the avatar is reflected in the Support Tickets page) and finally supply the \u003ccode\u003e#tab1\u003c/code\u003e event in the URL:\u003cbr\u003e\n\u003ccode\u003ehttps://staff.bountypay.h1ctf.com/?template[]=login\u0026amp;username=sandra.allison\u0026amp;template[]=ticket\u0026amp;ticket_id=3582#tab1\u003c/code\u003e\u003c/p\u003e\n\n\u003cp\u003eSending this link to the admin via the report link, and intercepting the request and adding \u003ccode\u003e#tab1\u003c/code\u003e and again base64 encoding (the #... part gets removed by the report functionality) I was able to get admin privileges. \u003c/p\u003e\n\n\u003cp\u003eGoing to the admin area I got Mårten Mickos\u0026#39; login credentials: \u003cbr\u003e\n\u003ccode\u003emarten.mickos:h\u0026amp;H5wy2Lggj*kKn4OD\u0026amp;Ype\u003c/code\u003e\u003cbr\u003e\n\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"mickos.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/YnCpmDrh9vUQp2drkdW5BDW3?response-content-disposition=attachment%3B%20filename%3D%22mickos.png%22%3B%20filename%2A%3DUTF-8%27%27mickos.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQ7BHOOAHM%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T070649Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIC0rVDoRsFwr%2BrE%2FOgXElPBjXmjW3to5vdwNhP1wFQmHAiEApMYNrLPtv0tUukQAZP%2BpY8D337e343jzGApem%2BwDWNEqtAMIWBABGgwwMTM2MTkyNzQ4NDkiDDFmqN%2FUWM7LS2CP1CqRAzFzlzfQjDdfcQXTdKF4YWe3Ih2IBeY9k3MXIY0WjWW1%2BZAhMyb7GEYkYW7WaHjanGksmLqccSeteVbrBk4Dc4D4uos0j7X%2FwwOLAqc5CxWpZee14Sn1tHeHs2ZMfkvA3vawPIqvRQysMjNVBMuXEH6vEVXtFaHFvHYM1SeTHx2%2ByBwaybyx6rWR7%2Bn2%2BvqhUWOGxa2hRntPYXxf9kc3Ojv83zWw30z%2F5vvBOs7T48%2BkxZGI2%2BwJDIUKtaa1P%2Bvrj%2FHxCVJ%2BXHmtu2gT6QrBPgEzxWDkQk5Fom2jigHSXiG1CDokA%2FtSn%2FMJ%2FofBuj7A1gVYJeXZWmYzDMetXCIN3VwKb92GhW7i3COAtBZhbrqDM5lA6AcEd11a1U8DkhbH5PgpGOPFV2wYTiJzBu6V4ZScxe09zNqfNVIKCa68FIB39HBQ3aFwyKwL1DGho6qzhDO7jyCviTCSPKfyYMFBAVpapptpE%2F%2Fgs2tzO%2FTi7l4DPCDUJuaDRsKdhw%2FfMdazZvg1jGKYMVNHBGA5PFFMduHfMPueq%2F8FOusB9p2zMiXKTd4Y9jgXza23QmD6hmcJ1QuxiF2euCPnZTLjeC4TB5NgQMYQ6kYvq7iqbTvcQRjBRAsofmkvGaFKLtnDIJZKLjv%2FO66tDOnKteRmMVRA5wrgRFEDB%2B6Mhz3VMpTBn0hnZlkIdUq7iSIHbz6jD3FfvwpsFTg%2FW6YTrgpzhatfXl9H9IWEZEOQEJaHO6bAoyd0xyIc7xydfxjcvkvQ5HGvrB5rYN9YJ85lZ3UDur%2B3aD9BpBeipos%2F8ycM7sApkYOlUn4Wp65Kb%2B69FQjBNZGYCUzszuBqIyqc2b1%2F6B63CHEc5HfYrA%3D%3D\u0026amp;X-Amz-Signature=d50f15fe9b417d81697dce750afb670607321668f6b4e4a3acb8e3a7030daaff\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/YnCpmDrh9vUQp2drkdW5BDW3?response-content-disposition=attachment%3B%20filename%3D%22mickos.png%22%3B%20filename%2A%3DUTF-8%27%27mickos.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQ7BHOOAHM%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T070649Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIC0rVDoRsFwr%2BrE%2FOgXElPBjXmjW3to5vdwNhP1wFQmHAiEApMYNrLPtv0tUukQAZP%2BpY8D337e343jzGApem%2BwDWNEqtAMIWBABGgwwMTM2MTkyNzQ4NDkiDDFmqN%2FUWM7LS2CP1CqRAzFzlzfQjDdfcQXTdKF4YWe3Ih2IBeY9k3MXIY0WjWW1%2BZAhMyb7GEYkYW7WaHjanGksmLqccSeteVbrBk4Dc4D4uos0j7X%2FwwOLAqc5CxWpZee14Sn1tHeHs2ZMfkvA3vawPIqvRQysMjNVBMuXEH6vEVXtFaHFvHYM1SeTHx2%2ByBwaybyx6rWR7%2Bn2%2BvqhUWOGxa2hRntPYXxf9kc3Ojv83zWw30z%2F5vvBOs7T48%2BkxZGI2%2BwJDIUKtaa1P%2Bvrj%2FHxCVJ%2BXHmtu2gT6QrBPgEzxWDkQk5Fom2jigHSXiG1CDokA%2FtSn%2FMJ%2FofBuj7A1gVYJeXZWmYzDMetXCIN3VwKb92GhW7i3COAtBZhbrqDM5lA6AcEd11a1U8DkhbH5PgpGOPFV2wYTiJzBu6V4ZScxe09zNqfNVIKCa68FIB39HBQ3aFwyKwL1DGho6qzhDO7jyCviTCSPKfyYMFBAVpapptpE%2F%2Fgs2tzO%2FTi7l4DPCDUJuaDRsKdhw%2FfMdazZvg1jGKYMVNHBGA5PFFMduHfMPueq%2F8FOusB9p2zMiXKTd4Y9jgXza23QmD6hmcJ1QuxiF2euCPnZTLjeC4TB5NgQMYQ6kYvq7iqbTvcQRjBRAsofmkvGaFKLtnDIJZKLjv%2FO66tDOnKteRmMVRA5wrgRFEDB%2B6Mhz3VMpTBn0hnZlkIdUq7iSIHbz6jD3FfvwpsFTg%2FW6YTrgpzhatfXl9H9IWEZEOQEJaHO6bAoyd0xyIc7xydfxjcvkvQ5HGvrB5rYN9YJ85lZ3UDur%2B3aD9BpBeipos%2F8ycM7sApkYOlUn4Wp65Kb%2B69FQjBNZGYCUzszuBqIyqc2b1%2F6B63CHEc5HfYrA%3D%3D\u0026amp;X-Amz-Signature=d50f15fe9b417d81697dce750afb670607321668f6b4e4a3acb8e3a7030daaff\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2 id=\"fourth-part-2fa\"\u003eFourth part: 2FA\u003c/h2\u003e\n\n\u003cp\u003eMårten\u0026#39;s login credentials worked on \u003ccode\u003eapp.bountypay\u003c/code\u003e, which again required me to bypass the same 2fa challenge as before. \u003cbr\u003e\nGoing to the dashboard I loaded the transactions for 05/2020 and clicked pay.\u003cbr\u003e\nAfter spending hours and hours trying to funnel the 210.300$ into my own account I gave up and instead focused on completing the CTF (hackers gotta be hackers...). \u003c/p\u003e\n\n\u003cp\u003eClicking \u0026#39;Pay\u0026#39; lead to another 2fa (at first I thought it was the same as before and said \u0026quot;Why do they even bother?\u0026quot;) - but of course this was 1000x more difficult! Loading the challenge caused the client to make a POST request with a css file, I could change the link to the file and have it contact my server (though only HTTPS servers which caused me some trouble). I served a slightly altered css file that simply changed the background colour, but this resulted in no change. Inspecting the file closer lead me to believe it was used server side for the 2fa functionality. Interesting: maybe this was where the codes were displayed? \u003c/p\u003e\n\n\u003cp\u003eI started looking into css injection techniques and read an interesting blog post by D0nut. I tried creating a similar attack to extract the challenge codes out-of-band, supposing them to be visible server side. \u003cbr\u003e\nOnce again I must credit Clos2100 as well as FersingB for helping me with this step. After a lot of trial and error I came up with a css attack script that queried each character of the code letter for letter, sending back the correct character to my server. The script is attached below (F854056). \u003cbr\u003e\nSending this malicious css file to the server and then looking in my server log I saw all 7 characters (though out of order) and had 2 minutes to input them. This passed the final 2fa challenge and all the hackers finally got paid!\u003c/p\u003e\n\n\u003cp\u003e^FLAG^736c635d8842751b8aafa556154eb9f3$FLAG$\u003c/p\u003e\n\n\u003cp\u003e\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"flag.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/BWyjndou7ukm1NXofYbXbtSM?response-content-disposition=attachment%3B%20filename%3D%22flag.png%22%3B%20filename%2A%3DUTF-8%27%27flag.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQ7BHOOAHM%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T070649Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIC0rVDoRsFwr%2BrE%2FOgXElPBjXmjW3to5vdwNhP1wFQmHAiEApMYNrLPtv0tUukQAZP%2BpY8D337e343jzGApem%2BwDWNEqtAMIWBABGgwwMTM2MTkyNzQ4NDkiDDFmqN%2FUWM7LS2CP1CqRAzFzlzfQjDdfcQXTdKF4YWe3Ih2IBeY9k3MXIY0WjWW1%2BZAhMyb7GEYkYW7WaHjanGksmLqccSeteVbrBk4Dc4D4uos0j7X%2FwwOLAqc5CxWpZee14Sn1tHeHs2ZMfkvA3vawPIqvRQysMjNVBMuXEH6vEVXtFaHFvHYM1SeTHx2%2ByBwaybyx6rWR7%2Bn2%2BvqhUWOGxa2hRntPYXxf9kc3Ojv83zWw30z%2F5vvBOs7T48%2BkxZGI2%2BwJDIUKtaa1P%2Bvrj%2FHxCVJ%2BXHmtu2gT6QrBPgEzxWDkQk5Fom2jigHSXiG1CDokA%2FtSn%2FMJ%2FofBuj7A1gVYJeXZWmYzDMetXCIN3VwKb92GhW7i3COAtBZhbrqDM5lA6AcEd11a1U8DkhbH5PgpGOPFV2wYTiJzBu6V4ZScxe09zNqfNVIKCa68FIB39HBQ3aFwyKwL1DGho6qzhDO7jyCviTCSPKfyYMFBAVpapptpE%2F%2Fgs2tzO%2FTi7l4DPCDUJuaDRsKdhw%2FfMdazZvg1jGKYMVNHBGA5PFFMduHfMPueq%2F8FOusB9p2zMiXKTd4Y9jgXza23QmD6hmcJ1QuxiF2euCPnZTLjeC4TB5NgQMYQ6kYvq7iqbTvcQRjBRAsofmkvGaFKLtnDIJZKLjv%2FO66tDOnKteRmMVRA5wrgRFEDB%2B6Mhz3VMpTBn0hnZlkIdUq7iSIHbz6jD3FfvwpsFTg%2FW6YTrgpzhatfXl9H9IWEZEOQEJaHO6bAoyd0xyIc7xydfxjcvkvQ5HGvrB5rYN9YJ85lZ3UDur%2B3aD9BpBeipos%2F8ycM7sApkYOlUn4Wp65Kb%2B69FQjBNZGYCUzszuBqIyqc2b1%2F6B63CHEc5HfYrA%3D%3D\u0026amp;X-Amz-Signature=ab7ac45ca4088fa2d4d0e37b69e25a849356cae184dac9bbf018d7498f636c00\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/BWyjndou7ukm1NXofYbXbtSM?response-content-disposition=attachment%3B%20filename%3D%22flag.png%22%3B%20filename%2A%3DUTF-8%27%27flag.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQ7BHOOAHM%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T070649Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIC0rVDoRsFwr%2BrE%2FOgXElPBjXmjW3to5vdwNhP1wFQmHAiEApMYNrLPtv0tUukQAZP%2BpY8D337e343jzGApem%2BwDWNEqtAMIWBABGgwwMTM2MTkyNzQ4NDkiDDFmqN%2FUWM7LS2CP1CqRAzFzlzfQjDdfcQXTdKF4YWe3Ih2IBeY9k3MXIY0WjWW1%2BZAhMyb7GEYkYW7WaHjanGksmLqccSeteVbrBk4Dc4D4uos0j7X%2FwwOLAqc5CxWpZee14Sn1tHeHs2ZMfkvA3vawPIqvRQysMjNVBMuXEH6vEVXtFaHFvHYM1SeTHx2%2ByBwaybyx6rWR7%2Bn2%2BvqhUWOGxa2hRntPYXxf9kc3Ojv83zWw30z%2F5vvBOs7T48%2BkxZGI2%2BwJDIUKtaa1P%2Bvrj%2FHxCVJ%2BXHmtu2gT6QrBPgEzxWDkQk5Fom2jigHSXiG1CDokA%2FtSn%2FMJ%2FofBuj7A1gVYJeXZWmYzDMetXCIN3VwKb92GhW7i3COAtBZhbrqDM5lA6AcEd11a1U8DkhbH5PgpGOPFV2wYTiJzBu6V4ZScxe09zNqfNVIKCa68FIB39HBQ3aFwyKwL1DGho6qzhDO7jyCviTCSPKfyYMFBAVpapptpE%2F%2Fgs2tzO%2FTi7l4DPCDUJuaDRsKdhw%2FfMdazZvg1jGKYMVNHBGA5PFFMduHfMPueq%2F8FOusB9p2zMiXKTd4Y9jgXza23QmD6hmcJ1QuxiF2euCPnZTLjeC4TB5NgQMYQ6kYvq7iqbTvcQRjBRAsofmkvGaFKLtnDIJZKLjv%2FO66tDOnKteRmMVRA5wrgRFEDB%2B6Mhz3VMpTBn0hnZlkIdUq7iSIHbz6jD3FfvwpsFTg%2FW6YTrgpzhatfXl9H9IWEZEOQEJaHO6bAoyd0xyIc7xydfxjcvkvQ5HGvrB5rYN9YJ85lZ3UDur%2B3aD9BpBeipos%2F8ycM7sApkYOlUn4Wp65Kb%2B69FQjBNZGYCUzszuBqIyqc2b1%2F6B63CHEc5HfYrA%3D%3D\u0026amp;X-Amz-Signature=ab7ac45ca4088fa2d4d0e37b69e25a849356cae184dac9bbf018d7498f636c00\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch1 id=\"supporting-material\"\u003eSupporting material\u003c/h1\u003e\n\n\u003cp\u003eBlog post by D0nut referenced for the css attack: \u003cbr\u003e\n\u003ca title=\"https://medium.com/@d0nut/better-exfiltration-via-html-injection-31c72a2dae8b\" href=\"/redirect?url=https%3A%2F%2Fmedium.com%2F%40d0nut%2Fbetter-exfiltration-via-html-injection-31c72a2dae8b\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://medium.com/@d0nut/better-exfiltration-via-html-injection-31c72a2dae8b\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eHackers could get paid. Who would want that? :-p\u003c/p\u003e\n","weakness":{"id":146,"name":"Execution with Unnecessary Privileges"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":854022,"file_name":"first_2fa.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/yhLbigPMYHSgVMzU4FYHoaR3?response-content-disposition=attachment%3B%20filename%3D%22first_2fa.png%22%3B%20filename%2A%3DUTF-8%27%27first_2fa.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ7BHOOAHM%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T070649Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIC0rVDoRsFwr%2BrE%2FOgXElPBjXmjW3to5vdwNhP1wFQmHAiEApMYNrLPtv0tUukQAZP%2BpY8D337e343jzGApem%2BwDWNEqtAMIWBABGgwwMTM2MTkyNzQ4NDkiDDFmqN%2FUWM7LS2CP1CqRAzFzlzfQjDdfcQXTdKF4YWe3Ih2IBeY9k3MXIY0WjWW1%2BZAhMyb7GEYkYW7WaHjanGksmLqccSeteVbrBk4Dc4D4uos0j7X%2FwwOLAqc5CxWpZee14Sn1tHeHs2ZMfkvA3vawPIqvRQysMjNVBMuXEH6vEVXtFaHFvHYM1SeTHx2%2ByBwaybyx6rWR7%2Bn2%2BvqhUWOGxa2hRntPYXxf9kc3Ojv83zWw30z%2F5vvBOs7T48%2BkxZGI2%2BwJDIUKtaa1P%2Bvrj%2FHxCVJ%2BXHmtu2gT6QrBPgEzxWDkQk5Fom2jigHSXiG1CDokA%2FtSn%2FMJ%2FofBuj7A1gVYJeXZWmYzDMetXCIN3VwKb92GhW7i3COAtBZhbrqDM5lA6AcEd11a1U8DkhbH5PgpGOPFV2wYTiJzBu6V4ZScxe09zNqfNVIKCa68FIB39HBQ3aFwyKwL1DGho6qzhDO7jyCviTCSPKfyYMFBAVpapptpE%2F%2Fgs2tzO%2FTi7l4DPCDUJuaDRsKdhw%2FfMdazZvg1jGKYMVNHBGA5PFFMduHfMPueq%2F8FOusB9p2zMiXKTd4Y9jgXza23QmD6hmcJ1QuxiF2euCPnZTLjeC4TB5NgQMYQ6kYvq7iqbTvcQRjBRAsofmkvGaFKLtnDIJZKLjv%2FO66tDOnKteRmMVRA5wrgRFEDB%2B6Mhz3VMpTBn0hnZlkIdUq7iSIHbz6jD3FfvwpsFTg%2FW6YTrgpzhatfXl9H9IWEZEOQEJaHO6bAoyd0xyIc7xydfxjcvkvQ5HGvrB5rYN9YJ85lZ3UDur%2B3aD9BpBeipos%2F8ycM7sApkYOlUn4Wp65Kb%2B69FQjBNZGYCUzszuBqIyqc2b1%2F6B63CHEc5HfYrA%3D%3D\u0026X-Amz-Signature=d9fe69bd94abca270e3216f65292a32723e5ec6a50e892bd6be760e8123dfcc9","file_size":23914,"type":"image/png"},{"id":854027,"file_name":"apkfile.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/bVNKPSJKFbnYXWRSJTACXLSJ?response-content-disposition=attachment%3B%20filename%3D%22apkfile.png%22%3B%20filename%2A%3DUTF-8%27%27apkfile.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ7BHOOAHM%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T070649Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIC0rVDoRsFwr%2BrE%2FOgXElPBjXmjW3to5vdwNhP1wFQmHAiEApMYNrLPtv0tUukQAZP%2BpY8D337e343jzGApem%2BwDWNEqtAMIWBABGgwwMTM2MTkyNzQ4NDkiDDFmqN%2FUWM7LS2CP1CqRAzFzlzfQjDdfcQXTdKF4YWe3Ih2IBeY9k3MXIY0WjWW1%2BZAhMyb7GEYkYW7WaHjanGksmLqccSeteVbrBk4Dc4D4uos0j7X%2FwwOLAqc5CxWpZee14Sn1tHeHs2ZMfkvA3vawPIqvRQysMjNVBMuXEH6vEVXtFaHFvHYM1SeTHx2%2ByBwaybyx6rWR7%2Bn2%2BvqhUWOGxa2hRntPYXxf9kc3Ojv83zWw30z%2F5vvBOs7T48%2BkxZGI2%2BwJDIUKtaa1P%2Bvrj%2FHxCVJ%2BXHmtu2gT6QrBPgEzxWDkQk5Fom2jigHSXiG1CDokA%2FtSn%2FMJ%2FofBuj7A1gVYJeXZWmYzDMetXCIN3VwKb92GhW7i3COAtBZhbrqDM5lA6AcEd11a1U8DkhbH5PgpGOPFV2wYTiJzBu6V4ZScxe09zNqfNVIKCa68FIB39HBQ3aFwyKwL1DGho6qzhDO7jyCviTCSPKfyYMFBAVpapptpE%2F%2Fgs2tzO%2FTi7l4DPCDUJuaDRsKdhw%2FfMdazZvg1jGKYMVNHBGA5PFFMduHfMPueq%2F8FOusB9p2zMiXKTd4Y9jgXza23QmD6hmcJ1QuxiF2euCPnZTLjeC4TB5NgQMYQ6kYvq7iqbTvcQRjBRAsofmkvGaFKLtnDIJZKLjv%2FO66tDOnKteRmMVRA5wrgRFEDB%2B6Mhz3VMpTBn0hnZlkIdUq7iSIHbz6jD3FfvwpsFTg%2FW6YTrgpzhatfXl9H9IWEZEOQEJaHO6bAoyd0xyIc7xydfxjcvkvQ5HGvrB5rYN9YJ85lZ3UDur%2B3aD9BpBeipos%2F8ycM7sApkYOlUn4Wp65Kb%2B69FQjBNZGYCUzszuBqIyqc2b1%2F6B63CHEc5HfYrA%3D%3D\u0026X-Amz-Signature=abb23bc4ec311183ec8774d5abe117b45cc3b5fe9347332e5cbdab16b221c5ab","file_size":37788,"type":"image/png"},{"id":854035,"file_name":"parttwo.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/YpJd2yNkMcPXP5yVr9gpRaZM?response-content-disposition=attachment%3B%20filename%3D%22parttwo.png%22%3B%20filename%2A%3DUTF-8%27%27parttwo.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ7BHOOAHM%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T070649Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIC0rVDoRsFwr%2BrE%2FOgXElPBjXmjW3to5vdwNhP1wFQmHAiEApMYNrLPtv0tUukQAZP%2BpY8D337e343jzGApem%2BwDWNEqtAMIWBABGgwwMTM2MTkyNzQ4NDkiDDFmqN%2FUWM7LS2CP1CqRAzFzlzfQjDdfcQXTdKF4YWe3Ih2IBeY9k3MXIY0WjWW1%2BZAhMyb7GEYkYW7WaHjanGksmLqccSeteVbrBk4Dc4D4uos0j7X%2FwwOLAqc5CxWpZee14Sn1tHeHs2ZMfkvA3vawPIqvRQysMjNVBMuXEH6vEVXtFaHFvHYM1SeTHx2%2ByBwaybyx6rWR7%2Bn2%2BvqhUWOGxa2hRntPYXxf9kc3Ojv83zWw30z%2F5vvBOs7T48%2BkxZGI2%2BwJDIUKtaa1P%2Bvrj%2FHxCVJ%2BXHmtu2gT6QrBPgEzxWDkQk5Fom2jigHSXiG1CDokA%2FtSn%2FMJ%2FofBuj7A1gVYJeXZWmYzDMetXCIN3VwKb92GhW7i3COAtBZhbrqDM5lA6AcEd11a1U8DkhbH5PgpGOPFV2wYTiJzBu6V4ZScxe09zNqfNVIKCa68FIB39HBQ3aFwyKwL1DGho6qzhDO7jyCviTCSPKfyYMFBAVpapptpE%2F%2Fgs2tzO%2FTi7l4DPCDUJuaDRsKdhw%2FfMdazZvg1jGKYMVNHBGA5PFFMduHfMPueq%2F8FOusB9p2zMiXKTd4Y9jgXza23QmD6hmcJ1QuxiF2euCPnZTLjeC4TB5NgQMYQ6kYvq7iqbTvcQRjBRAsofmkvGaFKLtnDIJZKLjv%2FO66tDOnKteRmMVRA5wrgRFEDB%2B6Mhz3VMpTBn0hnZlkIdUq7iSIHbz6jD3FfvwpsFTg%2FW6YTrgpzhatfXl9H9IWEZEOQEJaHO6bAoyd0xyIc7xydfxjcvkvQ5HGvrB5rYN9YJ85lZ3UDur%2B3aD9BpBeipos%2F8ycM7sApkYOlUn4Wp65Kb%2B69FQjBNZGYCUzszuBqIyqc2b1%2F6B63CHEc5HfYrA%3D%3D\u0026X-Amz-Signature=d07aa77290fafa2aa27fc289e5e57bf247a4994e06819ab31410797b626e1b02","file_size":24446,"type":"image/png"},{"id":854039,"file_name":"x-token.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/sgersworBCmTdPWdSDJcnbR8?response-content-disposition=attachment%3B%20filename%3D%22x-token.png%22%3B%20filename%2A%3DUTF-8%27%27x-token.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ7BHOOAHM%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T070649Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIC0rVDoRsFwr%2BrE%2FOgXElPBjXmjW3to5vdwNhP1wFQmHAiEApMYNrLPtv0tUukQAZP%2BpY8D337e343jzGApem%2BwDWNEqtAMIWBABGgwwMTM2MTkyNzQ4NDkiDDFmqN%2FUWM7LS2CP1CqRAzFzlzfQjDdfcQXTdKF4YWe3Ih2IBeY9k3MXIY0WjWW1%2BZAhMyb7GEYkYW7WaHjanGksmLqccSeteVbrBk4Dc4D4uos0j7X%2FwwOLAqc5CxWpZee14Sn1tHeHs2ZMfkvA3vawPIqvRQysMjNVBMuXEH6vEVXtFaHFvHYM1SeTHx2%2ByBwaybyx6rWR7%2Bn2%2BvqhUWOGxa2hRntPYXxf9kc3Ojv83zWw30z%2F5vvBOs7T48%2BkxZGI2%2BwJDIUKtaa1P%2Bvrj%2FHxCVJ%2BXHmtu2gT6QrBPgEzxWDkQk5Fom2jigHSXiG1CDokA%2FtSn%2FMJ%2FofBuj7A1gVYJeXZWmYzDMetXCIN3VwKb92GhW7i3COAtBZhbrqDM5lA6AcEd11a1U8DkhbH5PgpGOPFV2wYTiJzBu6V4ZScxe09zNqfNVIKCa68FIB39HBQ3aFwyKwL1DGho6qzhDO7jyCviTCSPKfyYMFBAVpapptpE%2F%2Fgs2tzO%2FTi7l4DPCDUJuaDRsKdhw%2FfMdazZvg1jGKYMVNHBGA5PFFMduHfMPueq%2F8FOusB9p2zMiXKTd4Y9jgXza23QmD6hmcJ1QuxiF2euCPnZTLjeC4TB5NgQMYQ6kYvq7iqbTvcQRjBRAsofmkvGaFKLtnDIJZKLjv%2FO66tDOnKteRmMVRA5wrgRFEDB%2B6Mhz3VMpTBn0hnZlkIdUq7iSIHbz6jD3FfvwpsFTg%2FW6YTrgpzhatfXl9H9IWEZEOQEJaHO6bAoyd0xyIc7xydfxjcvkvQ5HGvrB5rYN9YJ85lZ3UDur%2B3aD9BpBeipos%2F8ycM7sApkYOlUn4Wp65Kb%2B69FQjBNZGYCUzszuBqIyqc2b1%2F6B63CHEc5HfYrA%3D%3D\u0026X-Amz-Signature=9bdbbe0188146edc3e096fba12e0618525a63ca4171e784cc41305df73d9661b","file_size":86473,"type":"image/png"},{"id":854040,"file_name":"congrats.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/VjdfZNgv51EYqLeJa8X1AGUp?response-content-disposition=attachment%3B%20filename%3D%22congrats.png%22%3B%20filename%2A%3DUTF-8%27%27congrats.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ7BHOOAHM%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T070649Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIC0rVDoRsFwr%2BrE%2FOgXElPBjXmjW3to5vdwNhP1wFQmHAiEApMYNrLPtv0tUukQAZP%2BpY8D337e343jzGApem%2BwDWNEqtAMIWBABGgwwMTM2MTkyNzQ4NDkiDDFmqN%2FUWM7LS2CP1CqRAzFzlzfQjDdfcQXTdKF4YWe3Ih2IBeY9k3MXIY0WjWW1%2BZAhMyb7GEYkYW7WaHjanGksmLqccSeteVbrBk4Dc4D4uos0j7X%2FwwOLAqc5CxWpZee14Sn1tHeHs2ZMfkvA3vawPIqvRQysMjNVBMuXEH6vEVXtFaHFvHYM1SeTHx2%2ByBwaybyx6rWR7%2Bn2%2BvqhUWOGxa2hRntPYXxf9kc3Ojv83zWw30z%2F5vvBOs7T48%2BkxZGI2%2BwJDIUKtaa1P%2Bvrj%2FHxCVJ%2BXHmtu2gT6QrBPgEzxWDkQk5Fom2jigHSXiG1CDokA%2FtSn%2FMJ%2FofBuj7A1gVYJeXZWmYzDMetXCIN3VwKb92GhW7i3COAtBZhbrqDM5lA6AcEd11a1U8DkhbH5PgpGOPFV2wYTiJzBu6V4ZScxe09zNqfNVIKCa68FIB39HBQ3aFwyKwL1DGho6qzhDO7jyCviTCSPKfyYMFBAVpapptpE%2F%2Fgs2tzO%2FTi7l4DPCDUJuaDRsKdhw%2FfMdazZvg1jGKYMVNHBGA5PFFMduHfMPueq%2F8FOusB9p2zMiXKTd4Y9jgXza23QmD6hmcJ1QuxiF2euCPnZTLjeC4TB5NgQMYQ6kYvq7iqbTvcQRjBRAsofmkvGaFKLtnDIJZKLjv%2FO66tDOnKteRmMVRA5wrgRFEDB%2B6Mhz3VMpTBn0hnZlkIdUq7iSIHbz6jD3FfvwpsFTg%2FW6YTrgpzhatfXl9H9IWEZEOQEJaHO6bAoyd0xyIc7xydfxjcvkvQ5HGvrB5rYN9YJ85lZ3UDur%2B3aD9BpBeipos%2F8ycM7sApkYOlUn4Wp65Kb%2B69FQjBNZGYCUzszuBqIyqc2b1%2F6B63CHEc5HfYrA%3D%3D\u0026X-Amz-Signature=958345bbc7a39523f790c79a11f1000f2e5834dd5d240b59f486a8886fd56c79","file_size":37770,"type":"image/png"},{"id":854043,"file_name":"staff_created.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/wCwSaDKzb2FomeQfCtgJH3gb?response-content-disposition=attachment%3B%20filename%3D%22staff_created.png%22%3B%20filename%2A%3DUTF-8%27%27staff_created.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ7BHOOAHM%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T070649Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIC0rVDoRsFwr%2BrE%2FOgXElPBjXmjW3to5vdwNhP1wFQmHAiEApMYNrLPtv0tUukQAZP%2BpY8D337e343jzGApem%2BwDWNEqtAMIWBABGgwwMTM2MTkyNzQ4NDkiDDFmqN%2FUWM7LS2CP1CqRAzFzlzfQjDdfcQXTdKF4YWe3Ih2IBeY9k3MXIY0WjWW1%2BZAhMyb7GEYkYW7WaHjanGksmLqccSeteVbrBk4Dc4D4uos0j7X%2FwwOLAqc5CxWpZee14Sn1tHeHs2ZMfkvA3vawPIqvRQysMjNVBMuXEH6vEVXtFaHFvHYM1SeTHx2%2ByBwaybyx6rWR7%2Bn2%2BvqhUWOGxa2hRntPYXxf9kc3Ojv83zWw30z%2F5vvBOs7T48%2BkxZGI2%2BwJDIUKtaa1P%2Bvrj%2FHxCVJ%2BXHmtu2gT6QrBPgEzxWDkQk5Fom2jigHSXiG1CDokA%2FtSn%2FMJ%2FofBuj7A1gVYJeXZWmYzDMetXCIN3VwKb92GhW7i3COAtBZhbrqDM5lA6AcEd11a1U8DkhbH5PgpGOPFV2wYTiJzBu6V4ZScxe09zNqfNVIKCa68FIB39HBQ3aFwyKwL1DGho6qzhDO7jyCviTCSPKfyYMFBAVpapptpE%2F%2Fgs2tzO%2FTi7l4DPCDUJuaDRsKdhw%2FfMdazZvg1jGKYMVNHBGA5PFFMduHfMPueq%2F8FOusB9p2zMiXKTd4Y9jgXza23QmD6hmcJ1QuxiF2euCPnZTLjeC4TB5NgQMYQ6kYvq7iqbTvcQRjBRAsofmkvGaFKLtnDIJZKLjv%2FO66tDOnKteRmMVRA5wrgRFEDB%2B6Mhz3VMpTBn0hnZlkIdUq7iSIHbz6jD3FfvwpsFTg%2FW6YTrgpzhatfXl9H9IWEZEOQEJaHO6bAoyd0xyIc7xydfxjcvkvQ5HGvrB5rYN9YJ85lZ3UDur%2B3aD9BpBeipos%2F8ycM7sApkYOlUn4Wp65Kb%2B69FQjBNZGYCUzszuBqIyqc2b1%2F6B63CHEc5HfYrA%3D%3D\u0026X-Amz-Signature=01f5fad52ff4718badb462534484462a86fade7432d06d12852bd23ce710ee5b","file_size":66006,"type":"image/png"},{"id":854048,"file_name":"mickos.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/YnCpmDrh9vUQp2drkdW5BDW3?response-content-disposition=attachment%3B%20filename%3D%22mickos.png%22%3B%20filename%2A%3DUTF-8%27%27mickos.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ7BHOOAHM%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T070649Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIC0rVDoRsFwr%2BrE%2FOgXElPBjXmjW3to5vdwNhP1wFQmHAiEApMYNrLPtv0tUukQAZP%2BpY8D337e343jzGApem%2BwDWNEqtAMIWBABGgwwMTM2MTkyNzQ4NDkiDDFmqN%2FUWM7LS2CP1CqRAzFzlzfQjDdfcQXTdKF4YWe3Ih2IBeY9k3MXIY0WjWW1%2BZAhMyb7GEYkYW7WaHjanGksmLqccSeteVbrBk4Dc4D4uos0j7X%2FwwOLAqc5CxWpZee14Sn1tHeHs2ZMfkvA3vawPIqvRQysMjNVBMuXEH6vEVXtFaHFvHYM1SeTHx2%2ByBwaybyx6rWR7%2Bn2%2BvqhUWOGxa2hRntPYXxf9kc3Ojv83zWw30z%2F5vvBOs7T48%2BkxZGI2%2BwJDIUKtaa1P%2Bvrj%2FHxCVJ%2BXHmtu2gT6QrBPgEzxWDkQk5Fom2jigHSXiG1CDokA%2FtSn%2FMJ%2FofBuj7A1gVYJeXZWmYzDMetXCIN3VwKb92GhW7i3COAtBZhbrqDM5lA6AcEd11a1U8DkhbH5PgpGOPFV2wYTiJzBu6V4ZScxe09zNqfNVIKCa68FIB39HBQ3aFwyKwL1DGho6qzhDO7jyCviTCSPKfyYMFBAVpapptpE%2F%2Fgs2tzO%2FTi7l4DPCDUJuaDRsKdhw%2FfMdazZvg1jGKYMVNHBGA5PFFMduHfMPueq%2F8FOusB9p2zMiXKTd4Y9jgXza23QmD6hmcJ1QuxiF2euCPnZTLjeC4TB5NgQMYQ6kYvq7iqbTvcQRjBRAsofmkvGaFKLtnDIJZKLjv%2FO66tDOnKteRmMVRA5wrgRFEDB%2B6Mhz3VMpTBn0hnZlkIdUq7iSIHbz6jD3FfvwpsFTg%2FW6YTrgpzhatfXl9H9IWEZEOQEJaHO6bAoyd0xyIc7xydfxjcvkvQ5HGvrB5rYN9YJ85lZ3UDur%2B3aD9BpBeipos%2F8ycM7sApkYOlUn4Wp65Kb%2B69FQjBNZGYCUzszuBqIyqc2b1%2F6B63CHEc5HfYrA%3D%3D\u0026X-Amz-Signature=d50f15fe9b417d81697dce750afb670607321668f6b4e4a3acb8e3a7030daaff","file_size":31194,"type":"image/png"},{"id":854056,"file_name":"uni_2fa_style.css","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/AVCjQgFwhDaCVpjL163gh1AY?response-content-disposition=attachment%3B%20filename%3D%22uni_2fa_style.css%22%3B%20filename%2A%3DUTF-8%27%27uni_2fa_style.css\u0026response-content-type=text%2Fcss\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ7BHOOAHM%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T070649Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIC0rVDoRsFwr%2BrE%2FOgXElPBjXmjW3to5vdwNhP1wFQmHAiEApMYNrLPtv0tUukQAZP%2BpY8D337e343jzGApem%2BwDWNEqtAMIWBABGgwwMTM2MTkyNzQ4NDkiDDFmqN%2FUWM7LS2CP1CqRAzFzlzfQjDdfcQXTdKF4YWe3Ih2IBeY9k3MXIY0WjWW1%2BZAhMyb7GEYkYW7WaHjanGksmLqccSeteVbrBk4Dc4D4uos0j7X%2FwwOLAqc5CxWpZee14Sn1tHeHs2ZMfkvA3vawPIqvRQysMjNVBMuXEH6vEVXtFaHFvHYM1SeTHx2%2ByBwaybyx6rWR7%2Bn2%2BvqhUWOGxa2hRntPYXxf9kc3Ojv83zWw30z%2F5vvBOs7T48%2BkxZGI2%2BwJDIUKtaa1P%2Bvrj%2FHxCVJ%2BXHmtu2gT6QrBPgEzxWDkQk5Fom2jigHSXiG1CDokA%2FtSn%2FMJ%2FofBuj7A1gVYJeXZWmYzDMetXCIN3VwKb92GhW7i3COAtBZhbrqDM5lA6AcEd11a1U8DkhbH5PgpGOPFV2wYTiJzBu6V4ZScxe09zNqfNVIKCa68FIB39HBQ3aFwyKwL1DGho6qzhDO7jyCviTCSPKfyYMFBAVpapptpE%2F%2Fgs2tzO%2FTi7l4DPCDUJuaDRsKdhw%2FfMdazZvg1jGKYMVNHBGA5PFFMduHfMPueq%2F8FOusB9p2zMiXKTd4Y9jgXza23QmD6hmcJ1QuxiF2euCPnZTLjeC4TB5NgQMYQ6kYvq7iqbTvcQRjBRAsofmkvGaFKLtnDIJZKLjv%2FO66tDOnKteRmMVRA5wrgRFEDB%2B6Mhz3VMpTBn0hnZlkIdUq7iSIHbz6jD3FfvwpsFTg%2FW6YTrgpzhatfXl9H9IWEZEOQEJaHO6bAoyd0xyIc7xydfxjcvkvQ5HGvrB5rYN9YJ85lZ3UDur%2B3aD9BpBeipos%2F8ycM7sApkYOlUn4Wp65Kb%2B69FQjBNZGYCUzszuBqIyqc2b1%2F6B63CHEc5HfYrA%3D%3D\u0026X-Amz-Signature=2242e092eab9741e3a424c2741f183ab198890d52d8b3f60b2bc9116205e0475","file_size":42367,"type":"text/css"},{"id":854058,"file_name":"flag.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/BWyjndou7ukm1NXofYbXbtSM?response-content-disposition=attachment%3B%20filename%3D%22flag.png%22%3B%20filename%2A%3DUTF-8%27%27flag.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ7BHOOAHM%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T070649Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIC0rVDoRsFwr%2BrE%2FOgXElPBjXmjW3to5vdwNhP1wFQmHAiEApMYNrLPtv0tUukQAZP%2BpY8D337e343jzGApem%2BwDWNEqtAMIWBABGgwwMTM2MTkyNzQ4NDkiDDFmqN%2FUWM7LS2CP1CqRAzFzlzfQjDdfcQXTdKF4YWe3Ih2IBeY9k3MXIY0WjWW1%2BZAhMyb7GEYkYW7WaHjanGksmLqccSeteVbrBk4Dc4D4uos0j7X%2FwwOLAqc5CxWpZee14Sn1tHeHs2ZMfkvA3vawPIqvRQysMjNVBMuXEH6vEVXtFaHFvHYM1SeTHx2%2ByBwaybyx6rWR7%2Bn2%2BvqhUWOGxa2hRntPYXxf9kc3Ojv83zWw30z%2F5vvBOs7T48%2BkxZGI2%2BwJDIUKtaa1P%2Bvrj%2FHxCVJ%2BXHmtu2gT6QrBPgEzxWDkQk5Fom2jigHSXiG1CDokA%2FtSn%2FMJ%2FofBuj7A1gVYJeXZWmYzDMetXCIN3VwKb92GhW7i3COAtBZhbrqDM5lA6AcEd11a1U8DkhbH5PgpGOPFV2wYTiJzBu6V4ZScxe09zNqfNVIKCa68FIB39HBQ3aFwyKwL1DGho6qzhDO7jyCviTCSPKfyYMFBAVpapptpE%2F%2Fgs2tzO%2FTi7l4DPCDUJuaDRsKdhw%2FfMdazZvg1jGKYMVNHBGA5PFFMduHfMPueq%2F8FOusB9p2zMiXKTd4Y9jgXza23QmD6hmcJ1QuxiF2euCPnZTLjeC4TB5NgQMYQ6kYvq7iqbTvcQRjBRAsofmkvGaFKLtnDIJZKLjv%2FO66tDOnKteRmMVRA5wrgRFEDB%2B6Mhz3VMpTBn0hnZlkIdUq7iSIHbz6jD3FfvwpsFTg%2FW6YTrgpzhatfXl9H9IWEZEOQEJaHO6bAoyd0xyIc7xydfxjcvkvQ5HGvrB5rYN9YJ85lZ3UDur%2B3aD9BpBeipos%2F8ycM7sApkYOlUn4Wp65Kb%2B69FQjBNZGYCUzszuBqIyqc2b1%2F6B63CHEc5HfYrA%3D%3D\u0026X-Amz-Signature=ab7ac45ca4088fa2d4d0e37b69e25a849356cae184dac9bbf018d7498f636c00","file_size":32400,"type":"image/png"}],"allow_singular_disclosure_at":"2020-07-18T08:22:02.990Z","allow_singular_disclosure_after":-14165086.659251915,"singular_disclosure_allowed":true,"vote_count":4,"voters":["sw33tlie","nytr0gen","brahim_boufakri01","demon_sec"],"structured_scope":{"databaseId":48138,"asset_type":"URL","asset_identifier":"*.bountypay.h1ctf.com","max_severity":"none"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":8236728,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2020-06-08T21:03:41.781Z","updated_at":"2020-06-08T21:03:41.781Z","actor":{"username":"nahamsec","cleared":true,"url":"/nahamsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/413/ab3559068530ebd67a8224a9da7821be178dda07_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"h1-ctf","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":8236838,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2020-06-08T21:16:20.155Z","updated_at":"2020-06-08T21:16:20.155Z","additional_data":{"old_title":"\"Swiss Cheese\" design style leads to helping Mårten Mickos pay poor hackers","new_title":"[H1-2006 2020]  \"Swiss Cheese\" design style leads to helping Mårten Mickos pay poor hackers"},"actor":{"username":"nahamsec","cleared":true,"url":"/nahamsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/413/ab3559068530ebd67a8224a9da7821be178dda07_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"h1-ctf","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":8268339,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello,\n\nI wanted to personally thank you for participating in the #h12006 2020 CTF, I hope you enjoyed the challenge! We received tons of great submission and it definitely made our decision a lot harder than we excepted. Unfortunately, since we only have a limited number of invites available, your write up was not selected for this event. We appreciate your hard work and we hope to see you participate in our next CTF!\n\nWe will send you a request to publicly disclose your submissions next week, so please hold on to your writeups, we'll make sure to let you know when you can publish them on your site!\n\nIf you were one of the first 10 people to submit a write-up,  look out for some private invite in the next few days!","markdown_message":"\u003cp\u003eHello,\u003c/p\u003e\n\n\u003cp\u003eI wanted to personally thank you for participating in the #h12006 2020 CTF, I hope you enjoyed the challenge! We received tons of great submission and it definitely made our decision a lot harder than we excepted. Unfortunately, since we only have a limited number of invites available, your write up was not selected for this event. We appreciate your hard work and we hope to see you participate in our next CTF!\u003c/p\u003e\n\n\u003cp\u003eWe will send you a request to publicly disclose your submissions next week, so please hold on to your writeups, we\u0026#39;ll make sure to let you know when you can publish them on your site!\u003c/p\u003e\n\n\u003cp\u003eIf you were one of the first 10 people to submit a write-up,  look out for some private invite in the next few days!\u003c/p\u003e\n","automated_response":false,"created_at":"2020-06-11T23:03:27.607Z","updated_at":"2020-06-11T23:03:27.607Z","actor":{"username":"nahamsec","cleared":true,"url":"/nahamsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/413/ab3559068530ebd67a8224a9da7821be178dda07_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"h1-ctf","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":8270130,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you! I really didn't expect to win, just having finished the CTF was enough for me. :-)","markdown_message":"\u003cp\u003eThank you! I really didn\u0026#39;t expect to win, just having finished the CTF was enough for me. :-)\u003c/p\u003e\n","automated_response":false,"created_at":"2020-06-12T08:21:36.548Z","updated_at":"2020-06-12T08:21:36.548Z","actor":{"username":"al-madjus","cleared":false,"url":"/al-madjus","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/340/244/c9666ba3cc7b1d2720860b836b33fdacfa969b78_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"h1-ctf","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8324932,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thank you again for participating in the #h12006 CTF! ","markdown_message":"\u003cp\u003eThank you again for participating in the #h12006 CTF! \u003c/p\u003e\n","automated_response":false,"created_at":"2020-06-17T22:27:43.087Z","updated_at":"2020-06-17T22:27:43.087Z","actor":{"username":"nahamsec","cleared":true,"url":"/nahamsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/413/ab3559068530ebd67a8224a9da7821be178dda07_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"reporter":{"username":"al-madjus","url":"/al-madjus"},"genius_execution_id":null,"team_handle":"h1-ctf","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":8328527,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Requesting disclosure. ","markdown_message":"\u003cp\u003eRequesting disclosure. \u003c/p\u003e\n","automated_response":false,"created_at":"2020-06-18T08:22:02.964Z","updated_at":"2020-06-18T08:22:02.964Z","first_to_agree":true,"actor":{"username":"al-madjus","cleared":false,"url":"/al-madjus","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/340/244/c9666ba3cc7b1d2720860b836b33fdacfa969b78_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"h1-ctf","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8332820,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-06-18T15:30:44.547Z","updated_at":"2020-06-18T15:30:44.547Z","actor":{"username":"nahamsec","cleared":true,"url":"/nahamsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/413/ab3559068530ebd67a8224a9da7821be178dda07_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"h1-ctf","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":8332821,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-06-18T15:30:44.633Z","updated_at":"2020-06-18T15:30:44.633Z","actor":{"username":"nahamsec","cleared":true,"url":"/nahamsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/413/ab3559068530ebd67a8224a9da7821be178dda07_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"h1-ctf","actor_is_team_member":true,"actor_is_concealed_member":true}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}