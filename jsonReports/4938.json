{"id":4938,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC80OTM4","url":"https://hackerone.com/reports/4938","title":"page_controls_menu_js can reveal collection version of page","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2014-03-27T18:14:29.271Z","submitted_at":"2014-03-27T18:14:29.271Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"mnkras","url":"/mnkras","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/003/844/ec0ad0d7189e5d34e9b4063ef708e600dca89435_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":60,"url":"https://hackerone.com/concrete5","handle":"concrete5","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/060/c549a89ab4a3550cb9bfdeba1bee6d77e2019c7e_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/060/c549a89ab4a3550cb9bfdeba1bee6d77e2019c7e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"concrete5","twitter_handle":"concrete5","website":"https://www.concrete5.org","about":"A simple and powerful content management system."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2014-03-31T22:35:37.749Z","bug_reporter_agreed_on_going_public_at":"2014-03-31T22:35:37.526Z","team_member_agreed_on_going_public_at":"2014-03-31T22:34:23.762Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"By visiting the url /tools/required/page_controls_menu_js?cID=\u003ccID\u003e\u0026cvID=\u003ccvID\u003e\r\n\r\nWhere cID = page cID and cvID is unknown,\r\n\r\nIf for cvID you start at 1 (and the currently approved version is not the first version) the code `$(function() { ccmAlert.hud('This page is pending approval.', 5000); });` is added to the header.\r\n\r\nIf they increment the cvID to what the current approved version of a page, that line of code will go away. This discloses the currently approved version of a page (cvID of it).\r\n\r\nThis disclosure could be used with another attack to do harm to a site.","vulnerability_information_html":"\u003cp\u003eBy visiting the url /tools/required/page_controls_menu_js?cID=\u0026lt;cID\u0026gt;\u0026amp;cvID=\u0026lt;cvID\u0026gt;\u003c/p\u003e\n\n\u003cp\u003eWhere cID = page cID and cvID is unknown,\u003c/p\u003e\n\n\u003cp\u003eIf for cvID you start at 1 (and the currently approved version is not the first version) the code \u003ccode\u003e$(function() { ccmAlert.hud(\u0026#39;This page is pending approval.\u0026#39;, 5000); });\u003c/code\u003e is added to the header.\u003c/p\u003e\n\n\u003cp\u003eIf they increment the cvID to what the current approved version of a page, that line of code will go away. This discloses the currently approved version of a page (cvID of it).\u003c/p\u003e\n\n\u003cp\u003eThis disclosure could be used with another attack to do harm to a site.\u003c/p\u003e\n","weakness":{"id":18,"name":"Information Disclosure"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2014-04-30T22:34:16.354Z","allow_singular_disclosure_after":-210324807.4694374,"singular_disclosure_allowed":true,"vote_count":1,"voters":["sw33tlie"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":21801,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"This is super minor so a pull request is fine. If you're able to fix it, we'd love to have a patch or a pull request.\n\nBest wishes,\nKorvin","markdown_message":"\u003cp\u003eThis is super minor so a pull request is fine. If you\u0026#39;re able to fix it, we\u0026#39;d love to have a patch or a pull request.\u003c/p\u003e\n\n\u003cp\u003eBest wishes,\u003cbr\u003e\nKorvin\u003c/p\u003e\n","automated_response":false,"created_at":"2014-03-31T17:58:55.884Z","updated_at":"2014-03-31T17:58:55.884Z","actor":{"username":"korvin","cleared":false,"url":"/korvin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/yi9xvfnDmjKpKA1reqNSwGct/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"concrete5","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":21914,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"The code is located at https://github.com/concrete5/concrete5/blob/master/web/concrete/tools/page_controls_menu_js.php#L303-L328\n\nI could move the js inside that JS statement for the can view versions permission, or I can wrap it in a can edit || can view versions permission.\n\nthoughts?","markdown_message":"\u003cp\u003eThe code is located at \u003ca title=\"https://github.com/concrete5/concrete5/blob/master/web/concrete/tools/page_controls_menu_js.php#L303-L328\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fconcrete5%2Fconcrete5%2Fblob%2Fmaster%2Fweb%2Fconcrete%2Ftools%2Fpage_controls_menu_js.php%23L303-L328\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/concrete5/concrete5/blob/master/web/concrete/tools/page_controls_menu_js.php#L303-L328\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eI could move the js inside that JS statement for the can view versions permission, or I can wrap it in a can edit || can view versions permission.\u003c/p\u003e\n\n\u003cp\u003ethoughts?\u003c/p\u003e\n","automated_response":false,"created_at":"2014-03-31T21:19:27.309Z","updated_at":"2014-03-31T21:19:27.309Z","actor":{"username":"mnkras","cleared":false,"url":"/mnkras","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/844/ec0ad0d7189e5d34e9b4063ef708e600dca89435_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"concrete5","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":21945,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"The latter sounds more appropriate to me.","markdown_message":"\u003cp\u003eThe latter sounds more appropriate to me.\u003c/p\u003e\n","automated_response":false,"created_at":"2014-03-31T22:16:25.207Z","updated_at":"2014-03-31T22:16:25.207Z","actor":{"username":"korvin","cleared":false,"url":"/korvin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/yi9xvfnDmjKpKA1reqNSwGct/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"concrete5","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":21966,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Sent: https://github.com/concrete5/concrete5/pull/1688","markdown_message":"\u003cp\u003eSent: \u003ca title=\"https://github.com/concrete5/concrete5/pull/1688\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fconcrete5%2Fconcrete5%2Fpull%2F1688\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/concrete5/concrete5/pull/1688\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2014-03-31T22:32:09.668Z","updated_at":"2014-03-31T22:32:09.668Z","actor":{"username":"mnkras","cleared":false,"url":"/mnkras","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/844/ec0ad0d7189e5d34e9b4063ef708e600dca89435_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"concrete5","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":21968,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Sweet, thanks.","markdown_message":"\u003cp\u003eSweet, thanks.\u003c/p\u003e\n","automated_response":false,"created_at":"2014-03-31T22:34:16.514Z","updated_at":"2014-03-31T22:34:16.514Z","actor":{"username":"korvin","cleared":false,"url":"/korvin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/yi9xvfnDmjKpKA1reqNSwGct/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"mnkras","url":"/mnkras"},"genius_execution_id":null,"team_handle":"concrete5","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":21969,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2014-03-31T22:34:23.777Z","updated_at":"2014-03-31T22:34:23.777Z","first_to_agree":true,"actor":{"username":"korvin","cleared":false,"url":"/korvin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/yi9xvfnDmjKpKA1reqNSwGct/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"concrete5","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":21973,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2014-03-31T22:35:37.547Z","updated_at":"2014-03-31T22:35:37.547Z","actor":{"username":"mnkras","cleared":false,"url":"/mnkras","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/844/ec0ad0d7189e5d34e9b4063ef708e600dca89435_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"concrete5","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":21974,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2014-03-31T22:35:37.765Z","updated_at":"2014-03-31T22:35:37.765Z","actor":{"username":"mnkras","cleared":false,"url":"/mnkras","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/844/ec0ad0d7189e5d34e9b4063ef708e600dca89435_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"concrete5","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}