{"id":203658,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMDM2NTg=","url":"https://hackerone.com/reports/203658","title":"Restricted file access when it exists in old versions of task or wiki document","state":"Closed","substate":"informative","readable_substate":"Informative","created_at":"2017-02-05T20:01:34.759Z","submitted_at":"2017-02-05T20:01:34.759Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"denispugachev","url":"/denispugachev","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/120/171/30e412075c5d11dc8af7dcea30995ae6b611bd7b_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":18,"url":"https://hackerone.com/phabricator","handle":"phabricator","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/018/61446f7e6f0684c8c9f7c36c918b7ecd58183588_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/018/61446f7e6f0684c8c9f7c36c918b7ecd58183588_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Phabricator","twitter_handle":"phabricator","website":"http://phacility.com/phabricator/","about":"Phabricator is a collection of open source web applications that help software companies build better software."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2017-02-06T12:04:20.169Z","bug_reporter_agreed_on_going_public_at":"2017-02-06T12:02:12.489Z","team_member_agreed_on_going_public_at":"2017-02-06T12:04:20.126Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"mongoose\n\nHey! I think there is strange access rules for restricted file.\n\n### Steps to reproduce:\n1. Load by User1 file and set it access level \"No one\" (file Id for example 12)\n2. Make wiki with text `{F12}` by User1\n3. Edit new wiki page (change all text or delete) by User1\n4. Try to access file from User2: http://phabricator.dev/F12 - User2 has access to file even if it has \"No\n one\" access level.\n\nIt happens because `{F12}` exists in old versions of wiki page and User1 can't do anything to hide his file only if he will restrict view access to entire wiki page. I think access level to file should be evaluated by current version of document, not older.\n\nIt can be reproduced also in tasks.","vulnerability_information_html":"\u003cp\u003emongoose\u003c/p\u003e\n\n\u003cp\u003eHey! I think there is strange access rules for restricted file.\u003c/p\u003e\n\n\u003ch3 id=\"steps-to-reproduce\"\u003eSteps to reproduce:\u003c/h3\u003e\n\n\u003col\u003e\n\u003cli\u003eLoad by User1 file and set it access level \u0026quot;No one\u0026quot; (file Id for example 12)\u003c/li\u003e\n\u003cli\u003eMake wiki with text \u003ccode\u003e{F12}\u003c/code\u003e by User1\u003c/li\u003e\n\u003cli\u003eEdit new wiki page (change all text or delete) by User1\u003c/li\u003e\n\u003cli\u003eTry to access file from User2: \u003ca title=\"http://phabricator.dev/F12\" href=\"/redirect?url=http%3A%2F%2Fphabricator.dev%2FF12\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://phabricator.dev/F12\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e - User2 has access to file even if it has \u0026quot;No\none\u0026quot; access level.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eIt happens because \u003ccode\u003e{F12}\u003c/code\u003e exists in old versions of wiki page and User1 can\u0026#39;t do anything to hide his file only if he will restrict view access to entire wiki page. I think access level to file should be evaluated by current version of document, not older.\u003c/p\u003e\n\n\u003cp\u003eIt can be reproduced also in tasks.\u003c/p\u003e\n","weakness":{"id":57,"name":"Violation of Secure Design Principles"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":3,"voters":["denispugachev","spetr0x","mr_seven"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1464165,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"This is expected. Old versions of the wiki page (or task description, or whatever else) can always be viewed, and might not make sense if you couldn't see files embedded on them.\n\nYou can review which objects a file is attached to in the \"Attached\" tab of the file in the Files application.","markdown_message":"\u003cp\u003eThis is expected. Old versions of the wiki page (or task description, or whatever else) can always be viewed, and might not make sense if you couldn\u0026#39;t see files embedded on them.\u003c/p\u003e\n\n\u003cp\u003eYou can review which objects a file is attached to in the \u0026quot;Attached\u0026quot; tab of the file in the Files application.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-02-05T20:17:56.294Z","updated_at":"2017-02-05T20:17:56.294Z","actor":{"username":"epriestley","cleared":false,"url":"/epriestley","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/043/3ebca5250ea5abd54b49ccc9d69c636af4585b2e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"phabricator","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1464353,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for the answer!\n\nWhere can I report the simple bugs (not security) found in Phabricator?","markdown_message":"\u003cp\u003eThanks for the answer!\u003c/p\u003e\n\n\u003cp\u003eWhere can I report the simple bugs (not security) found in Phabricator?\u003c/p\u003e\n","automated_response":false,"created_at":"2017-02-06T05:37:20.220Z","updated_at":"2017-02-06T05:37:20.220Z","actor":{"username":"denispugachev","cleared":false,"url":"/denispugachev","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/120/171/30e412075c5d11dc8af7dcea30995ae6b611bd7b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"phabricator","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1464803,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"On `secure.phabricator.com`: this guide should get you started:\n\nhttps://secure.phabricator.com/book/phabcontrib/article/bug_reports/","markdown_message":"\u003cp\u003eOn \u003ccode\u003esecure.phabricator.com\u003c/code\u003e: this guide should get you started:\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"https://secure.phabricator.com/book/phabcontrib/article/bug_reports/\" href=\"/redirect?url=https%3A%2F%2Fsecure.phabricator.com%2Fbook%2Fphabcontrib%2Farticle%2Fbug_reports%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://secure.phabricator.com/book/phabcontrib/article/bug_reports/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2017-02-06T12:01:43.061Z","updated_at":"2017-02-06T12:01:43.061Z","actor":{"username":"epriestley","cleared":false,"url":"/epriestley","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/043/3ebca5250ea5abd54b49ccc9d69c636af4585b2e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"phabricator","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1464805,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-02-06T12:02:12.506Z","updated_at":"2017-02-06T12:02:12.506Z","first_to_agree":true,"actor":{"username":"denispugachev","cleared":false,"url":"/denispugachev","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/120/171/30e412075c5d11dc8af7dcea30995ae6b611bd7b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"phabricator","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1464813,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-02-06T12:04:20.148Z","updated_at":"2017-02-06T12:04:20.148Z","actor":{"username":"epriestley","cleared":false,"url":"/epriestley","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/043/3ebca5250ea5abd54b49ccc9d69c636af4585b2e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"phabricator","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1464814,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-02-06T12:04:20.209Z","updated_at":"2017-02-06T12:04:20.209Z","actor":{"username":"epriestley","cleared":false,"url":"/epriestley","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/043/3ebca5250ea5abd54b49ccc9d69c636af4585b2e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"phabricator","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}