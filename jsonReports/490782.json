{"id":490782,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC80OTA3ODI=","url":"https://hackerone.com/reports/490782","title":"Mssing Authorization on Private Message replies (BuddyPress)","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2019-02-03T20:07:05.875Z","submitted_at":"2019-02-03T20:07:05.875Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"klmunday","url":"/klmunday","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/480/267/c2322c402151db1b8a6b7474b47bfc4b1c415b4a_original.JPG/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":55,"url":"https://hackerone.com/wordpress","handle":"wordpress","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/055/f114d1d31f904e3b903cd99a6cf566bb531f8401_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/055/f114d1d31f904e3b903cd99a6cf566bb531f8401_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"WordPress","twitter_handle":"wordpress","website":"https://wordpress.org/","about":"Beautiful sites of any kind."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2019-03-08T22:27:35.566Z","bug_reporter_agreed_on_going_public_at":"2019-03-08T20:30:58.946Z","team_member_agreed_on_going_public_at":"2019-03-08T22:27:35.480Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"## Description:\nUsers can reply to private message threads which they are not participants of by changing the `thread_id` parameter in the `messages_send_reply` ajax action. This affects both the Legacy and Nouveau Template packs.\n\n## Steps To Reproduce:\n1. Login to your account\n2. Send the following request (change `Host`/`Cookie`/`nonce`/`thread_id` as needed)\n\n\u003ePOST /wp-admin/admin-ajax.php HTTP/1.1\n\u003eHost: 127.0.0.1\n\u003eUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:64.0) Gecko/20100101 Firefox/64.0\n\u003eAccept: */*\n\u003eAccept-Language: en-GB,en;q=0.5\n\u003eAccept-Encoding: gzip, deflate\n\u003eReferer: http://127.0.0.1/members/test2/messages/view/4/\n\u003eContent-Type: application/x-www-form-urlencoded; charset=UTF-8\n\u003eX-Requested-With: XMLHttpRequest\n\u003eContent-Length: 76\n\u003eConnection: close\n\u003eCookie: \u003ewordpress_ab0994624b8d5b17fddb1aec29329218=test2%7C1549395197%7ClRQfd96VkhuRpR4fpB3MhZOw2SGrl19nFG7wIClGYaf%7C64fbdf07238d2f448b8e53f6f1db7c64b014d7833386229505fefa70c9b2976e; wordpress_test_cookie=WP+Cookie+check; \u003ewordpress_logged_in_ab0994624b8d5b17fddb1aec29329218=test2%7C1549395197%7ClRQfd96VkhuRpR4fpB3MhZOw2SGrl19nFG7wIClGYaf%7Ca309bfd19a1c2e4504e37959bd4ceac28944fce81857c2f7587022a4e6d2b7aa\n\n\u003eaction=messages_send_reply\u0026cookie=\u0026_wpnonce=d037f67211\u0026content=Test+Message\u0026thread_id=1\n\n## Notes:\nEven though an attacker can send a reply to a thread, they cannot view the thread afterwards. The reply they send does not appear in the attackers sentbox (see image below)\n{F417446}\nNor do any future replies appear in the attackers inbox, nor is the attacker able to star the reply. This means that there is no information exposure.\n\nWhen participants view the thread they will see the attackers reply, however the attacker does not appear in the participants list (see images below)\n\n__Inbox:__\n{F417451}\n__View:__\n{F417444}\n\n## Proof of Concept:\nI have developed a small Python (3.6+) script to inject a message into every private message thread. It achieves this by creating a new conversation between the attacker and himself to get the current private message max index and then iterates from 1 -\u003e max index, posting a message into each thread.\n{F417456}\nIt will try to reply to threads that may have been deleted but since thread_id's are sequential, if every thread from 1 to the thread the attacker created is replied to then we can be sure that every thread that exists when the script is ran has been injected into.\n\n## Impact\n\nJust by itself this can only really lead to spam / phishing attacks. However, if the component is vulnerable to other flaws such as #487081 (not public) then it can widen an attack surface and becomes a more serious issue.","vulnerability_information_html":"\u003ch2 id=\"description\"\u003eDescription:\u003c/h2\u003e\n\n\u003cp\u003eUsers can reply to private message threads which they are not participants of by changing the \u003ccode\u003ethread_id\u003c/code\u003e parameter in the \u003ccode\u003emessages_send_reply\u003c/code\u003e ajax action. This affects both the Legacy and Nouveau Template packs.\u003c/p\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps To Reproduce:\u003c/h2\u003e\n\n\u003col\u003e\n\u003cli\u003eLogin to your account\u003c/li\u003e\n\u003cli\u003eSend the following request (change \u003ccode\u003eHost\u003c/code\u003e/\u003ccode\u003eCookie\u003c/code\u003e/\u003ccode\u003enonce\u003c/code\u003e/\u003ccode\u003ethread_id\u003c/code\u003e as needed)\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003ePOST /wp-admin/admin-ajax.php HTTP/1.1\u003cbr\u003e\nHost: 127.0.0.1\u003cbr\u003e\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:64.0) Gecko/20100101 Firefox/64.0\u003cbr\u003e\nAccept: \u003cem\u003e/\u003c/em\u003e\u003cbr\u003e\nAccept-Language: en-GB,en;q=0.5\u003cbr\u003e\nAccept-Encoding: gzip, deflate\u003cbr\u003e\nReferer: \u003ca title=\"http://127.0.0.1/members/test2/messages/view/4/\" href=\"/redirect?url=http%3A%2F%2F127.0.0.1%2Fmembers%2Ftest2%2Fmessages%2Fview%2F4%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://127.0.0.1/members/test2/messages/view/4/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nContent-Type: application/x-www-form-urlencoded; charset=UTF-8\u003cbr\u003e\nX-Requested-With: XMLHttpRequest\u003cbr\u003e\nContent-Length: 76\u003cbr\u003e\nConnection: close\u003cbr\u003e\nCookie: \u0026gt;wordpress_ab0994624b8d5b17fddb1aec29329218=test2%7C1549395197%7ClRQfd96VkhuRpR4fpB3MhZOw2SGrl19nFG7wIClGYaf%7C64fbdf07238d2f448b8e53f6f1db7c64b014d7833386229505fefa70c9b2976e; wordpress_test_cookie=WP+Cookie+check; \u0026gt;wordpress_logged_in_ab0994624b8d5b17fddb1aec29329218=test2%7C1549395197%7ClRQfd96VkhuRpR4fpB3MhZOw2SGrl19nFG7wIClGYaf%7Ca309bfd19a1c2e4504e37959bd4ceac28944fce81857c2f7587022a4e6d2b7aa\u003c/p\u003e\n\n\u003cp\u003eaction=messages_send_reply\u0026amp;cookie=\u0026amp;_wpnonce=d037f67211\u0026amp;content=Test+Message\u0026amp;thread_id=1\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003ch2 id=\"notes\"\u003eNotes:\u003c/h2\u003e\n\n\u003cp\u003eEven though an attacker can send a reply to a thread, they cannot view the thread afterwards. The reply they send does not appear in the attackers sentbox (see image below)\u003cbr\u003e\n\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"message-thread-injection-not-in-sent.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/417/446/5d2ceeceb5df5ed397846ac26f354f2a3ad39362/message-thread-injection-not-in-sent.png?response-content-disposition=attachment%3B%20filename%3D%22message-thread-injection-not-in-sent.png%22%3B%20filename%2A%3DUTF-8%27%27message-thread-injection-not-in-sent.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQ3ORU3ZNE%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T060656Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIBDRduU%2FQiKN2Hy3Cc%2BFdvYldnR%2BI9yQ0JWu5Nd0q2n7AiBT09NYT9NM%2FNa1T7X7mPFfQEFunNsAbPoVngTqyDCvlCq0AwhSEAEaDDAxMzYxOTI3NDg0OSIMjho0%2F2dG4425KWNaKpEDfRP2JVIKEZKe%2Fu1DRJDnMt1hodmiYRHSHxVJXvZvnhQp68RTbgsA5dtRAFzhCl2p7oJWn2DfsUhN61oqH1cme2ydNbTr6cDG5AkVoiUMnjHvkMPTgbPahrduPs%2FdXuwFoyZMuPeBtzUlpjssIk0BfcIUtph2FGwzCuy6d0CQhdl914kkFpuTBp69z2htWslZiifdNkKWK0DIJcK%2FrSurcsk8WEaPiZ7tEJAcfYZS4SddR8orMY%2BhEfGsLc5RSVBGXY0UW6zTNw%2BYg82wPCY1Z9kgrjwVLQPpVTje3rfzRO3UEDh0xbd54m7t%2FSL0yItTAuaGshQmPLuW6S%2F5KOdoWWnwCmkruRqE1ZKMsnSko5gBnNELay%2BWeukQAQ6EyIB%2FWB06%2F%2FaYfBiWUzjgZyKRGg99IBpEO3zShFTod3huOdptlvO4PfWBvrB4632o9feKKn5CXqJUOE%2BTT%2BgjHEdWRLP2W3GZAibuc%2FbOIfOwee7%2Bn9cOimwp8NVS4U08VlgiSfhcWXonWb3aOkvnOfX46QkwoP6p%2FwU67AFSjWFI11fWgLkInKyx6Dx9AePw1c4qVefioOdfVonnQ3dNW7fXwjlRC5F1185jkAwhyCARy9%2F7sIPFHaI%2FEID5osYCwdvVwv0O6pPIknWS%2FVG7rXxUIgYk0xp3ln2eURcIkz%2F20YEsL73kMrgQLn%2BEd3AiGH%2F9wW5PEZOVPNqagqBYtUSWzNl9%2BrKCkhyVg8k79SdRjUkvdYLXtvxU1m6oAu2IjxFOCgwXqn1jFH1Lloh4Gp%2Fkq68ckYZB67%2B%2FdOzejM9ofYNi%2BpJRLwSwwu22w857sj9E%2BbC8Ei9i7KZOZGBCWe81d9lycwAH6Q%3D%3D\u0026amp;X-Amz-Signature=6cd618438d9067b8e66b03492bda56f1a367b2035276ad918538ad29c6baac4e\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/417/446/5d2ceeceb5df5ed397846ac26f354f2a3ad39362/message-thread-injection-not-in-sent.png?response-content-disposition=attachment%3B%20filename%3D%22message-thread-injection-not-in-sent.png%22%3B%20filename%2A%3DUTF-8%27%27message-thread-injection-not-in-sent.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQ3ORU3ZNE%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T060656Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIBDRduU%2FQiKN2Hy3Cc%2BFdvYldnR%2BI9yQ0JWu5Nd0q2n7AiBT09NYT9NM%2FNa1T7X7mPFfQEFunNsAbPoVngTqyDCvlCq0AwhSEAEaDDAxMzYxOTI3NDg0OSIMjho0%2F2dG4425KWNaKpEDfRP2JVIKEZKe%2Fu1DRJDnMt1hodmiYRHSHxVJXvZvnhQp68RTbgsA5dtRAFzhCl2p7oJWn2DfsUhN61oqH1cme2ydNbTr6cDG5AkVoiUMnjHvkMPTgbPahrduPs%2FdXuwFoyZMuPeBtzUlpjssIk0BfcIUtph2FGwzCuy6d0CQhdl914kkFpuTBp69z2htWslZiifdNkKWK0DIJcK%2FrSurcsk8WEaPiZ7tEJAcfYZS4SddR8orMY%2BhEfGsLc5RSVBGXY0UW6zTNw%2BYg82wPCY1Z9kgrjwVLQPpVTje3rfzRO3UEDh0xbd54m7t%2FSL0yItTAuaGshQmPLuW6S%2F5KOdoWWnwCmkruRqE1ZKMsnSko5gBnNELay%2BWeukQAQ6EyIB%2FWB06%2F%2FaYfBiWUzjgZyKRGg99IBpEO3zShFTod3huOdptlvO4PfWBvrB4632o9feKKn5CXqJUOE%2BTT%2BgjHEdWRLP2W3GZAibuc%2FbOIfOwee7%2Bn9cOimwp8NVS4U08VlgiSfhcWXonWb3aOkvnOfX46QkwoP6p%2FwU67AFSjWFI11fWgLkInKyx6Dx9AePw1c4qVefioOdfVonnQ3dNW7fXwjlRC5F1185jkAwhyCARy9%2F7sIPFHaI%2FEID5osYCwdvVwv0O6pPIknWS%2FVG7rXxUIgYk0xp3ln2eURcIkz%2F20YEsL73kMrgQLn%2BEd3AiGH%2F9wW5PEZOVPNqagqBYtUSWzNl9%2BrKCkhyVg8k79SdRjUkvdYLXtvxU1m6oAu2IjxFOCgwXqn1jFH1Lloh4Gp%2Fkq68ckYZB67%2B%2FdOzejM9ofYNi%2BpJRLwSwwu22w857sj9E%2BbC8Ei9i7KZOZGBCWe81d9lycwAH6Q%3D%3D\u0026amp;X-Amz-Signature=6cd618438d9067b8e66b03492bda56f1a367b2035276ad918538ad29c6baac4e\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003cbr\u003e\nNor do any future replies appear in the attackers inbox, nor is the attacker able to star the reply. This means that there is no information exposure.\u003c/p\u003e\n\n\u003cp\u003eWhen participants view the thread they will see the attackers reply, however the attacker does not appear in the participants list (see images below)\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eInbox:\u003c/strong\u003e\u003cbr\u003e\n\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"message-thread-injection-shows-in-inbox.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/417/451/259bd899e5d2816eb44108e5ea9a77619bd838af/message-thread-injection-shows-in-inbox.png?response-content-disposition=attachment%3B%20filename%3D%22message-thread-injection-shows-in-inbox.png%22%3B%20filename%2A%3DUTF-8%27%27message-thread-injection-shows-in-inbox.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQ3ORU3ZNE%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T060656Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIBDRduU%2FQiKN2Hy3Cc%2BFdvYldnR%2BI9yQ0JWu5Nd0q2n7AiBT09NYT9NM%2FNa1T7X7mPFfQEFunNsAbPoVngTqyDCvlCq0AwhSEAEaDDAxMzYxOTI3NDg0OSIMjho0%2F2dG4425KWNaKpEDfRP2JVIKEZKe%2Fu1DRJDnMt1hodmiYRHSHxVJXvZvnhQp68RTbgsA5dtRAFzhCl2p7oJWn2DfsUhN61oqH1cme2ydNbTr6cDG5AkVoiUMnjHvkMPTgbPahrduPs%2FdXuwFoyZMuPeBtzUlpjssIk0BfcIUtph2FGwzCuy6d0CQhdl914kkFpuTBp69z2htWslZiifdNkKWK0DIJcK%2FrSurcsk8WEaPiZ7tEJAcfYZS4SddR8orMY%2BhEfGsLc5RSVBGXY0UW6zTNw%2BYg82wPCY1Z9kgrjwVLQPpVTje3rfzRO3UEDh0xbd54m7t%2FSL0yItTAuaGshQmPLuW6S%2F5KOdoWWnwCmkruRqE1ZKMsnSko5gBnNELay%2BWeukQAQ6EyIB%2FWB06%2F%2FaYfBiWUzjgZyKRGg99IBpEO3zShFTod3huOdptlvO4PfWBvrB4632o9feKKn5CXqJUOE%2BTT%2BgjHEdWRLP2W3GZAibuc%2FbOIfOwee7%2Bn9cOimwp8NVS4U08VlgiSfhcWXonWb3aOkvnOfX46QkwoP6p%2FwU67AFSjWFI11fWgLkInKyx6Dx9AePw1c4qVefioOdfVonnQ3dNW7fXwjlRC5F1185jkAwhyCARy9%2F7sIPFHaI%2FEID5osYCwdvVwv0O6pPIknWS%2FVG7rXxUIgYk0xp3ln2eURcIkz%2F20YEsL73kMrgQLn%2BEd3AiGH%2F9wW5PEZOVPNqagqBYtUSWzNl9%2BrKCkhyVg8k79SdRjUkvdYLXtvxU1m6oAu2IjxFOCgwXqn1jFH1Lloh4Gp%2Fkq68ckYZB67%2B%2FdOzejM9ofYNi%2BpJRLwSwwu22w857sj9E%2BbC8Ei9i7KZOZGBCWe81d9lycwAH6Q%3D%3D\u0026amp;X-Amz-Signature=f2ed4bc4a26405f85182a1159a54fc324be8dd9ca58a159119832a12fdd4a838\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/417/451/259bd899e5d2816eb44108e5ea9a77619bd838af/message-thread-injection-shows-in-inbox.png?response-content-disposition=attachment%3B%20filename%3D%22message-thread-injection-shows-in-inbox.png%22%3B%20filename%2A%3DUTF-8%27%27message-thread-injection-shows-in-inbox.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQ3ORU3ZNE%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T060656Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIBDRduU%2FQiKN2Hy3Cc%2BFdvYldnR%2BI9yQ0JWu5Nd0q2n7AiBT09NYT9NM%2FNa1T7X7mPFfQEFunNsAbPoVngTqyDCvlCq0AwhSEAEaDDAxMzYxOTI3NDg0OSIMjho0%2F2dG4425KWNaKpEDfRP2JVIKEZKe%2Fu1DRJDnMt1hodmiYRHSHxVJXvZvnhQp68RTbgsA5dtRAFzhCl2p7oJWn2DfsUhN61oqH1cme2ydNbTr6cDG5AkVoiUMnjHvkMPTgbPahrduPs%2FdXuwFoyZMuPeBtzUlpjssIk0BfcIUtph2FGwzCuy6d0CQhdl914kkFpuTBp69z2htWslZiifdNkKWK0DIJcK%2FrSurcsk8WEaPiZ7tEJAcfYZS4SddR8orMY%2BhEfGsLc5RSVBGXY0UW6zTNw%2BYg82wPCY1Z9kgrjwVLQPpVTje3rfzRO3UEDh0xbd54m7t%2FSL0yItTAuaGshQmPLuW6S%2F5KOdoWWnwCmkruRqE1ZKMsnSko5gBnNELay%2BWeukQAQ6EyIB%2FWB06%2F%2FaYfBiWUzjgZyKRGg99IBpEO3zShFTod3huOdptlvO4PfWBvrB4632o9feKKn5CXqJUOE%2BTT%2BgjHEdWRLP2W3GZAibuc%2FbOIfOwee7%2Bn9cOimwp8NVS4U08VlgiSfhcWXonWb3aOkvnOfX46QkwoP6p%2FwU67AFSjWFI11fWgLkInKyx6Dx9AePw1c4qVefioOdfVonnQ3dNW7fXwjlRC5F1185jkAwhyCARy9%2F7sIPFHaI%2FEID5osYCwdvVwv0O6pPIknWS%2FVG7rXxUIgYk0xp3ln2eURcIkz%2F20YEsL73kMrgQLn%2BEd3AiGH%2F9wW5PEZOVPNqagqBYtUSWzNl9%2BrKCkhyVg8k79SdRjUkvdYLXtvxU1m6oAu2IjxFOCgwXqn1jFH1Lloh4Gp%2Fkq68ckYZB67%2B%2FdOzejM9ofYNi%2BpJRLwSwwu22w857sj9E%2BbC8Ei9i7KZOZGBCWe81d9lycwAH6Q%3D%3D\u0026amp;X-Amz-Signature=f2ed4bc4a26405f85182a1159a54fc324be8dd9ca58a159119832a12fdd4a838\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003cbr\u003e\n\u003cstrong\u003eView:\u003c/strong\u003e\u003cbr\u003e\n\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"message-thread-injection-injected-thread.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/417/444/19050737a96462c399b0993825198b54dd270107/message-thread-injection-injected-thread.png?response-content-disposition=attachment%3B%20filename%3D%22message-thread-injection-injected-thread.png%22%3B%20filename%2A%3DUTF-8%27%27message-thread-injection-injected-thread.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQ3ORU3ZNE%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T060656Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIBDRduU%2FQiKN2Hy3Cc%2BFdvYldnR%2BI9yQ0JWu5Nd0q2n7AiBT09NYT9NM%2FNa1T7X7mPFfQEFunNsAbPoVngTqyDCvlCq0AwhSEAEaDDAxMzYxOTI3NDg0OSIMjho0%2F2dG4425KWNaKpEDfRP2JVIKEZKe%2Fu1DRJDnMt1hodmiYRHSHxVJXvZvnhQp68RTbgsA5dtRAFzhCl2p7oJWn2DfsUhN61oqH1cme2ydNbTr6cDG5AkVoiUMnjHvkMPTgbPahrduPs%2FdXuwFoyZMuPeBtzUlpjssIk0BfcIUtph2FGwzCuy6d0CQhdl914kkFpuTBp69z2htWslZiifdNkKWK0DIJcK%2FrSurcsk8WEaPiZ7tEJAcfYZS4SddR8orMY%2BhEfGsLc5RSVBGXY0UW6zTNw%2BYg82wPCY1Z9kgrjwVLQPpVTje3rfzRO3UEDh0xbd54m7t%2FSL0yItTAuaGshQmPLuW6S%2F5KOdoWWnwCmkruRqE1ZKMsnSko5gBnNELay%2BWeukQAQ6EyIB%2FWB06%2F%2FaYfBiWUzjgZyKRGg99IBpEO3zShFTod3huOdptlvO4PfWBvrB4632o9feKKn5CXqJUOE%2BTT%2BgjHEdWRLP2W3GZAibuc%2FbOIfOwee7%2Bn9cOimwp8NVS4U08VlgiSfhcWXonWb3aOkvnOfX46QkwoP6p%2FwU67AFSjWFI11fWgLkInKyx6Dx9AePw1c4qVefioOdfVonnQ3dNW7fXwjlRC5F1185jkAwhyCARy9%2F7sIPFHaI%2FEID5osYCwdvVwv0O6pPIknWS%2FVG7rXxUIgYk0xp3ln2eURcIkz%2F20YEsL73kMrgQLn%2BEd3AiGH%2F9wW5PEZOVPNqagqBYtUSWzNl9%2BrKCkhyVg8k79SdRjUkvdYLXtvxU1m6oAu2IjxFOCgwXqn1jFH1Lloh4Gp%2Fkq68ckYZB67%2B%2FdOzejM9ofYNi%2BpJRLwSwwu22w857sj9E%2BbC8Ei9i7KZOZGBCWe81d9lycwAH6Q%3D%3D\u0026amp;X-Amz-Signature=bae03fa25c267241258e9f938685034c873ab5cea548f188f9bd05d87e125ef5\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/417/444/19050737a96462c399b0993825198b54dd270107/message-thread-injection-injected-thread.png?response-content-disposition=attachment%3B%20filename%3D%22message-thread-injection-injected-thread.png%22%3B%20filename%2A%3DUTF-8%27%27message-thread-injection-injected-thread.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQ3ORU3ZNE%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T060656Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIBDRduU%2FQiKN2Hy3Cc%2BFdvYldnR%2BI9yQ0JWu5Nd0q2n7AiBT09NYT9NM%2FNa1T7X7mPFfQEFunNsAbPoVngTqyDCvlCq0AwhSEAEaDDAxMzYxOTI3NDg0OSIMjho0%2F2dG4425KWNaKpEDfRP2JVIKEZKe%2Fu1DRJDnMt1hodmiYRHSHxVJXvZvnhQp68RTbgsA5dtRAFzhCl2p7oJWn2DfsUhN61oqH1cme2ydNbTr6cDG5AkVoiUMnjHvkMPTgbPahrduPs%2FdXuwFoyZMuPeBtzUlpjssIk0BfcIUtph2FGwzCuy6d0CQhdl914kkFpuTBp69z2htWslZiifdNkKWK0DIJcK%2FrSurcsk8WEaPiZ7tEJAcfYZS4SddR8orMY%2BhEfGsLc5RSVBGXY0UW6zTNw%2BYg82wPCY1Z9kgrjwVLQPpVTje3rfzRO3UEDh0xbd54m7t%2FSL0yItTAuaGshQmPLuW6S%2F5KOdoWWnwCmkruRqE1ZKMsnSko5gBnNELay%2BWeukQAQ6EyIB%2FWB06%2F%2FaYfBiWUzjgZyKRGg99IBpEO3zShFTod3huOdptlvO4PfWBvrB4632o9feKKn5CXqJUOE%2BTT%2BgjHEdWRLP2W3GZAibuc%2FbOIfOwee7%2Bn9cOimwp8NVS4U08VlgiSfhcWXonWb3aOkvnOfX46QkwoP6p%2FwU67AFSjWFI11fWgLkInKyx6Dx9AePw1c4qVefioOdfVonnQ3dNW7fXwjlRC5F1185jkAwhyCARy9%2F7sIPFHaI%2FEID5osYCwdvVwv0O6pPIknWS%2FVG7rXxUIgYk0xp3ln2eURcIkz%2F20YEsL73kMrgQLn%2BEd3AiGH%2F9wW5PEZOVPNqagqBYtUSWzNl9%2BrKCkhyVg8k79SdRjUkvdYLXtvxU1m6oAu2IjxFOCgwXqn1jFH1Lloh4Gp%2Fkq68ckYZB67%2B%2FdOzejM9ofYNi%2BpJRLwSwwu22w857sj9E%2BbC8Ei9i7KZOZGBCWe81d9lycwAH6Q%3D%3D\u0026amp;X-Amz-Signature=bae03fa25c267241258e9f938685034c873ab5cea548f188f9bd05d87e125ef5\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2 id=\"proof-of-concept\"\u003eProof of Concept:\u003c/h2\u003e\n\n\u003cp\u003eI have developed a small Python (3.6+) script to inject a message into every private message thread. It achieves this by creating a new conversation between the attacker and himself to get the current private message max index and then iterates from 1 -\u0026gt; max index, posting a message into each thread.\u003cbr\u003e\n\u003ca class=\"markdown-attachment-link markdown-attachment-reference\" data-attachment-filename=\"inject_messages.py\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/417/456/d0e36108a8d5c0fd4c96a313b531d9a180fdedc5/inject_messages.py?response-content-disposition=attachment%3B%20filename%3D%22inject_messages.py%22%3B%20filename%2A%3DUTF-8%27%27inject_messages.py\u0026amp;response-content-type=text%2Fx-python\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQ3ORU3ZNE%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T060656Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIBDRduU%2FQiKN2Hy3Cc%2BFdvYldnR%2BI9yQ0JWu5Nd0q2n7AiBT09NYT9NM%2FNa1T7X7mPFfQEFunNsAbPoVngTqyDCvlCq0AwhSEAEaDDAxMzYxOTI3NDg0OSIMjho0%2F2dG4425KWNaKpEDfRP2JVIKEZKe%2Fu1DRJDnMt1hodmiYRHSHxVJXvZvnhQp68RTbgsA5dtRAFzhCl2p7oJWn2DfsUhN61oqH1cme2ydNbTr6cDG5AkVoiUMnjHvkMPTgbPahrduPs%2FdXuwFoyZMuPeBtzUlpjssIk0BfcIUtph2FGwzCuy6d0CQhdl914kkFpuTBp69z2htWslZiifdNkKWK0DIJcK%2FrSurcsk8WEaPiZ7tEJAcfYZS4SddR8orMY%2BhEfGsLc5RSVBGXY0UW6zTNw%2BYg82wPCY1Z9kgrjwVLQPpVTje3rfzRO3UEDh0xbd54m7t%2FSL0yItTAuaGshQmPLuW6S%2F5KOdoWWnwCmkruRqE1ZKMsnSko5gBnNELay%2BWeukQAQ6EyIB%2FWB06%2F%2FaYfBiWUzjgZyKRGg99IBpEO3zShFTod3huOdptlvO4PfWBvrB4632o9feKKn5CXqJUOE%2BTT%2BgjHEdWRLP2W3GZAibuc%2FbOIfOwee7%2Bn9cOimwp8NVS4U08VlgiSfhcWXonWb3aOkvnOfX46QkwoP6p%2FwU67AFSjWFI11fWgLkInKyx6Dx9AePw1c4qVefioOdfVonnQ3dNW7fXwjlRC5F1185jkAwhyCARy9%2F7sIPFHaI%2FEID5osYCwdvVwv0O6pPIknWS%2FVG7rXxUIgYk0xp3ln2eURcIkz%2F20YEsL73kMrgQLn%2BEd3AiGH%2F9wW5PEZOVPNqagqBYtUSWzNl9%2BrKCkhyVg8k79SdRjUkvdYLXtvxU1m6oAu2IjxFOCgwXqn1jFH1Lloh4Gp%2Fkq68ckYZB67%2B%2FdOzejM9ofYNi%2BpJRLwSwwu22w857sj9E%2BbC8Ei9i7KZOZGBCWe81d9lycwAH6Q%3D%3D\u0026amp;X-Amz-Signature=098dc86589d664056c824053e34b4e0b6950301973a5eb11282afc258fbb1902\" data-attachment-type=\"text/x-python\"\u003einject_messages.py (F417456)\u003c/a\u003e\u003cbr\u003e\nIt will try to reply to threads that may have been deleted but since thread_id\u0026#39;s are sequential, if every thread from 1 to the thread the attacker created is replied to then we can be sure that every thread that exists when the script is ran has been injected into.\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eJust by itself this can only really lead to spam / phishing attacks. However, if the component is vulnerable to other flaws such as \u003ca href=\"/reports/487081\"\u003e#487081\u003c/a\u003e (not public) then it can widen an attack surface and becomes a more serious issue.\u003c/p\u003e\n","bounty_amount":"375.0","formatted_bounty":"$375","weakness":{"id":26,"name":"Improper Access Control - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":417444,"file_name":"message-thread-injection-injected-thread.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/417/444/19050737a96462c399b0993825198b54dd270107/message-thread-injection-injected-thread.png?response-content-disposition=attachment%3B%20filename%3D%22message-thread-injection-injected-thread.png%22%3B%20filename%2A%3DUTF-8%27%27message-thread-injection-injected-thread.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ3ORU3ZNE%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T060656Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIBDRduU%2FQiKN2Hy3Cc%2BFdvYldnR%2BI9yQ0JWu5Nd0q2n7AiBT09NYT9NM%2FNa1T7X7mPFfQEFunNsAbPoVngTqyDCvlCq0AwhSEAEaDDAxMzYxOTI3NDg0OSIMjho0%2F2dG4425KWNaKpEDfRP2JVIKEZKe%2Fu1DRJDnMt1hodmiYRHSHxVJXvZvnhQp68RTbgsA5dtRAFzhCl2p7oJWn2DfsUhN61oqH1cme2ydNbTr6cDG5AkVoiUMnjHvkMPTgbPahrduPs%2FdXuwFoyZMuPeBtzUlpjssIk0BfcIUtph2FGwzCuy6d0CQhdl914kkFpuTBp69z2htWslZiifdNkKWK0DIJcK%2FrSurcsk8WEaPiZ7tEJAcfYZS4SddR8orMY%2BhEfGsLc5RSVBGXY0UW6zTNw%2BYg82wPCY1Z9kgrjwVLQPpVTje3rfzRO3UEDh0xbd54m7t%2FSL0yItTAuaGshQmPLuW6S%2F5KOdoWWnwCmkruRqE1ZKMsnSko5gBnNELay%2BWeukQAQ6EyIB%2FWB06%2F%2FaYfBiWUzjgZyKRGg99IBpEO3zShFTod3huOdptlvO4PfWBvrB4632o9feKKn5CXqJUOE%2BTT%2BgjHEdWRLP2W3GZAibuc%2FbOIfOwee7%2Bn9cOimwp8NVS4U08VlgiSfhcWXonWb3aOkvnOfX46QkwoP6p%2FwU67AFSjWFI11fWgLkInKyx6Dx9AePw1c4qVefioOdfVonnQ3dNW7fXwjlRC5F1185jkAwhyCARy9%2F7sIPFHaI%2FEID5osYCwdvVwv0O6pPIknWS%2FVG7rXxUIgYk0xp3ln2eURcIkz%2F20YEsL73kMrgQLn%2BEd3AiGH%2F9wW5PEZOVPNqagqBYtUSWzNl9%2BrKCkhyVg8k79SdRjUkvdYLXtvxU1m6oAu2IjxFOCgwXqn1jFH1Lloh4Gp%2Fkq68ckYZB67%2B%2FdOzejM9ofYNi%2BpJRLwSwwu22w857sj9E%2BbC8Ei9i7KZOZGBCWe81d9lycwAH6Q%3D%3D\u0026X-Amz-Signature=bae03fa25c267241258e9f938685034c873ab5cea548f188f9bd05d87e125ef5","file_size":52226,"type":"image/png"},{"id":417446,"file_name":"message-thread-injection-not-in-sent.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/417/446/5d2ceeceb5df5ed397846ac26f354f2a3ad39362/message-thread-injection-not-in-sent.png?response-content-disposition=attachment%3B%20filename%3D%22message-thread-injection-not-in-sent.png%22%3B%20filename%2A%3DUTF-8%27%27message-thread-injection-not-in-sent.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ3ORU3ZNE%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T060656Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIBDRduU%2FQiKN2Hy3Cc%2BFdvYldnR%2BI9yQ0JWu5Nd0q2n7AiBT09NYT9NM%2FNa1T7X7mPFfQEFunNsAbPoVngTqyDCvlCq0AwhSEAEaDDAxMzYxOTI3NDg0OSIMjho0%2F2dG4425KWNaKpEDfRP2JVIKEZKe%2Fu1DRJDnMt1hodmiYRHSHxVJXvZvnhQp68RTbgsA5dtRAFzhCl2p7oJWn2DfsUhN61oqH1cme2ydNbTr6cDG5AkVoiUMnjHvkMPTgbPahrduPs%2FdXuwFoyZMuPeBtzUlpjssIk0BfcIUtph2FGwzCuy6d0CQhdl914kkFpuTBp69z2htWslZiifdNkKWK0DIJcK%2FrSurcsk8WEaPiZ7tEJAcfYZS4SddR8orMY%2BhEfGsLc5RSVBGXY0UW6zTNw%2BYg82wPCY1Z9kgrjwVLQPpVTje3rfzRO3UEDh0xbd54m7t%2FSL0yItTAuaGshQmPLuW6S%2F5KOdoWWnwCmkruRqE1ZKMsnSko5gBnNELay%2BWeukQAQ6EyIB%2FWB06%2F%2FaYfBiWUzjgZyKRGg99IBpEO3zShFTod3huOdptlvO4PfWBvrB4632o9feKKn5CXqJUOE%2BTT%2BgjHEdWRLP2W3GZAibuc%2FbOIfOwee7%2Bn9cOimwp8NVS4U08VlgiSfhcWXonWb3aOkvnOfX46QkwoP6p%2FwU67AFSjWFI11fWgLkInKyx6Dx9AePw1c4qVefioOdfVonnQ3dNW7fXwjlRC5F1185jkAwhyCARy9%2F7sIPFHaI%2FEID5osYCwdvVwv0O6pPIknWS%2FVG7rXxUIgYk0xp3ln2eURcIkz%2F20YEsL73kMrgQLn%2BEd3AiGH%2F9wW5PEZOVPNqagqBYtUSWzNl9%2BrKCkhyVg8k79SdRjUkvdYLXtvxU1m6oAu2IjxFOCgwXqn1jFH1Lloh4Gp%2Fkq68ckYZB67%2B%2FdOzejM9ofYNi%2BpJRLwSwwu22w857sj9E%2BbC8Ei9i7KZOZGBCWe81d9lycwAH6Q%3D%3D\u0026X-Amz-Signature=6cd618438d9067b8e66b03492bda56f1a367b2035276ad918538ad29c6baac4e","file_size":27858,"type":"image/png"},{"id":417451,"file_name":"message-thread-injection-shows-in-inbox.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/417/451/259bd899e5d2816eb44108e5ea9a77619bd838af/message-thread-injection-shows-in-inbox.png?response-content-disposition=attachment%3B%20filename%3D%22message-thread-injection-shows-in-inbox.png%22%3B%20filename%2A%3DUTF-8%27%27message-thread-injection-shows-in-inbox.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ3ORU3ZNE%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T060656Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIBDRduU%2FQiKN2Hy3Cc%2BFdvYldnR%2BI9yQ0JWu5Nd0q2n7AiBT09NYT9NM%2FNa1T7X7mPFfQEFunNsAbPoVngTqyDCvlCq0AwhSEAEaDDAxMzYxOTI3NDg0OSIMjho0%2F2dG4425KWNaKpEDfRP2JVIKEZKe%2Fu1DRJDnMt1hodmiYRHSHxVJXvZvnhQp68RTbgsA5dtRAFzhCl2p7oJWn2DfsUhN61oqH1cme2ydNbTr6cDG5AkVoiUMnjHvkMPTgbPahrduPs%2FdXuwFoyZMuPeBtzUlpjssIk0BfcIUtph2FGwzCuy6d0CQhdl914kkFpuTBp69z2htWslZiifdNkKWK0DIJcK%2FrSurcsk8WEaPiZ7tEJAcfYZS4SddR8orMY%2BhEfGsLc5RSVBGXY0UW6zTNw%2BYg82wPCY1Z9kgrjwVLQPpVTje3rfzRO3UEDh0xbd54m7t%2FSL0yItTAuaGshQmPLuW6S%2F5KOdoWWnwCmkruRqE1ZKMsnSko5gBnNELay%2BWeukQAQ6EyIB%2FWB06%2F%2FaYfBiWUzjgZyKRGg99IBpEO3zShFTod3huOdptlvO4PfWBvrB4632o9feKKn5CXqJUOE%2BTT%2BgjHEdWRLP2W3GZAibuc%2FbOIfOwee7%2Bn9cOimwp8NVS4U08VlgiSfhcWXonWb3aOkvnOfX46QkwoP6p%2FwU67AFSjWFI11fWgLkInKyx6Dx9AePw1c4qVefioOdfVonnQ3dNW7fXwjlRC5F1185jkAwhyCARy9%2F7sIPFHaI%2FEID5osYCwdvVwv0O6pPIknWS%2FVG7rXxUIgYk0xp3ln2eURcIkz%2F20YEsL73kMrgQLn%2BEd3AiGH%2F9wW5PEZOVPNqagqBYtUSWzNl9%2BrKCkhyVg8k79SdRjUkvdYLXtvxU1m6oAu2IjxFOCgwXqn1jFH1Lloh4Gp%2Fkq68ckYZB67%2B%2FdOzejM9ofYNi%2BpJRLwSwwu22w857sj9E%2BbC8Ei9i7KZOZGBCWe81d9lycwAH6Q%3D%3D\u0026X-Amz-Signature=f2ed4bc4a26405f85182a1159a54fc324be8dd9ca58a159119832a12fdd4a838","file_size":90848,"type":"image/png"},{"id":417456,"file_name":"inject_messages.py","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/417/456/d0e36108a8d5c0fd4c96a313b531d9a180fdedc5/inject_messages.py?response-content-disposition=attachment%3B%20filename%3D%22inject_messages.py%22%3B%20filename%2A%3DUTF-8%27%27inject_messages.py\u0026response-content-type=text%2Fx-python\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ3ORU3ZNE%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T060656Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIBDRduU%2FQiKN2Hy3Cc%2BFdvYldnR%2BI9yQ0JWu5Nd0q2n7AiBT09NYT9NM%2FNa1T7X7mPFfQEFunNsAbPoVngTqyDCvlCq0AwhSEAEaDDAxMzYxOTI3NDg0OSIMjho0%2F2dG4425KWNaKpEDfRP2JVIKEZKe%2Fu1DRJDnMt1hodmiYRHSHxVJXvZvnhQp68RTbgsA5dtRAFzhCl2p7oJWn2DfsUhN61oqH1cme2ydNbTr6cDG5AkVoiUMnjHvkMPTgbPahrduPs%2FdXuwFoyZMuPeBtzUlpjssIk0BfcIUtph2FGwzCuy6d0CQhdl914kkFpuTBp69z2htWslZiifdNkKWK0DIJcK%2FrSurcsk8WEaPiZ7tEJAcfYZS4SddR8orMY%2BhEfGsLc5RSVBGXY0UW6zTNw%2BYg82wPCY1Z9kgrjwVLQPpVTje3rfzRO3UEDh0xbd54m7t%2FSL0yItTAuaGshQmPLuW6S%2F5KOdoWWnwCmkruRqE1ZKMsnSko5gBnNELay%2BWeukQAQ6EyIB%2FWB06%2F%2FaYfBiWUzjgZyKRGg99IBpEO3zShFTod3huOdptlvO4PfWBvrB4632o9feKKn5CXqJUOE%2BTT%2BgjHEdWRLP2W3GZAibuc%2FbOIfOwee7%2Bn9cOimwp8NVS4U08VlgiSfhcWXonWb3aOkvnOfX46QkwoP6p%2FwU67AFSjWFI11fWgLkInKyx6Dx9AePw1c4qVefioOdfVonnQ3dNW7fXwjlRC5F1185jkAwhyCARy9%2F7sIPFHaI%2FEID5osYCwdvVwv0O6pPIknWS%2FVG7rXxUIgYk0xp3ln2eURcIkz%2F20YEsL73kMrgQLn%2BEd3AiGH%2F9wW5PEZOVPNqagqBYtUSWzNl9%2BrKCkhyVg8k79SdRjUkvdYLXtvxU1m6oAu2IjxFOCgwXqn1jFH1Lloh4Gp%2Fkq68ckYZB67%2B%2FdOzejM9ofYNi%2BpJRLwSwwu22w857sj9E%2BbC8Ei9i7KZOZGBCWe81d9lycwAH6Q%3D%3D\u0026X-Amz-Signature=098dc86589d664056c824053e34b4e0b6950301973a5eb11282afc258fbb1902","file_size":2648,"type":"text/x-python"}],"allow_singular_disclosure_at":"2019-04-07T20:30:59.010Z","allow_singular_disclosure_after":-54552957.10827851,"singular_disclosure_allowed":true,"vote_count":63,"voters":["ibfaruhn","mik317","n0bytes","architect","logicmap","mygf","lordjerry0x01","an0nym0us","khizer47","cr4xerbik4sh","and 53 more..."],"severity":{"rating":"low","author_type":"User"},"structured_scope":{"databaseId":2751,"asset_type":"SOURCE_CODE","asset_identifier":"BuddyPress Core","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":4088348,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello @klmunday,\n\nThanks for your report! We need some more information before we can adequately review this report. Is it possible you could provide a clear step-by-step PoC showing how you found your vulnerability? \n\nHow do we reproduce the attack in our wordpress environment? I have installed the BuddyPress addon but I am unclear as to next steps. Which components do we activate in BuddyPress?\n\n Thanks again for your report and we hope to hear back from you soon.\n\nKind regards.","markdown_message":"\u003cp\u003eHello \u003ca href=\"/klmunday\"\u003e@klmunday\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThanks for your report! We need some more information before we can adequately review this report. Is it possible you could provide a clear step-by-step PoC showing how you found your vulnerability? \u003c/p\u003e\n\n\u003cp\u003eHow do we reproduce the attack in our wordpress environment? I have installed the BuddyPress addon but I am unclear as to next steps. Which components do we activate in BuddyPress?\u003c/p\u003e\n\n\u003cp\u003eThanks again for your report and we hope to hear back from you soon.\u003c/p\u003e\n\n\u003cp\u003eKind regards.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-02-03T22:26:10.223Z","updated_at":"2019-02-03T22:26:10.223Z","actor":{"username":"chrome_balaclava","cleared":false,"url":"/chrome_balaclava","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/429/787/56d955d48a94e8379b63fad7545e30f8c1b74e00_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4088414,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Ah my bad,\nIt requires the Private Message setting to be enabled\n\n1. Log into your account\n2. Find a thread id in your database where your use is NOT in the participants (or just make a new message between two other users)\n3. Using a tool like Postman send a request to `/wp-admin/admin-ajax.php` with the action `messages_send_reply` and set the `thread_id` to the id of the message you want to inject into - this should be one that you are not a participant of.\n4. Send the request\n5. Your message should now be in that thread even though you are not a participant\n\nYou can also use BurpSuite to Intercept a regular reply and just change the thread_id to a thread you can't see (this is what I did when looking into it)\n\nLet me know if this helps","markdown_message":"\u003cp\u003eAh my bad,\u003cbr\u003e\nIt requires the Private Message setting to be enabled\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eLog into your account\u003c/li\u003e\n\u003cli\u003eFind a thread id in your database where your use is NOT in the participants (or just make a new message between two other users)\u003c/li\u003e\n\u003cli\u003eUsing a tool like Postman send a request to \u003ccode\u003e/wp-admin/admin-ajax.php\u003c/code\u003e with the action \u003ccode\u003emessages_send_reply\u003c/code\u003e and set the \u003ccode\u003ethread_id\u003c/code\u003e to the id of the message you want to inject into - this should be one that you are not a participant of.\u003c/li\u003e\n\u003cli\u003eSend the request\u003c/li\u003e\n\u003cli\u003eYour message should now be in that thread even though you are not a participant\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eYou can also use BurpSuite to Intercept a regular reply and just change the thread_id to a thread you can\u0026#39;t see (this is what I did when looking into it)\u003c/p\u003e\n\n\u003cp\u003eLet me know if this helps\u003c/p\u003e\n","automated_response":false,"created_at":"2019-02-03T23:04:45.570Z","updated_at":"2019-02-03T23:04:45.570Z","actor":{"username":"klmunday","cleared":false,"url":"/klmunday","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/480/267/c2322c402151db1b8a6b7474b47bfc4b1c415b4a_original.JPG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4089269,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"This diff seems to work, I have not had time to fully test it but at first glance and initial testing it seems to work","markdown_message":"\u003cp\u003eThis diff seems to work, I have not had time to fully test it but at first glance and initial testing it seems to work\u003c/p\u003e\n","automated_response":false,"created_at":"2019-02-04T08:21:18.245Z","updated_at":"2019-02-04T08:21:53.926Z","actor":{"username":"klmunday","cleared":false,"url":"/klmunday","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/480/267/c2322c402151db1b8a6b7474b47bfc4b1c415b4a_original.JPG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"attachments":[{"id":417635,"filename":"enforce_access_check.diff","type":"text/x-diff","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/417/635/f7168240b710b47a737f80cbfbdce5fdfa11f8ec/enforce_access_check.diff?response-content-disposition=attachment%3B%20filename%3D%22enforce_access_check.diff%22%3B%20filename%2A%3DUTF-8%27%27enforce_access_check.diff\u0026response-content-type=text%2Fx-diff\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ3ORU3ZNE%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T060656Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIBDRduU%2FQiKN2Hy3Cc%2BFdvYldnR%2BI9yQ0JWu5Nd0q2n7AiBT09NYT9NM%2FNa1T7X7mPFfQEFunNsAbPoVngTqyDCvlCq0AwhSEAEaDDAxMzYxOTI3NDg0OSIMjho0%2F2dG4425KWNaKpEDfRP2JVIKEZKe%2Fu1DRJDnMt1hodmiYRHSHxVJXvZvnhQp68RTbgsA5dtRAFzhCl2p7oJWn2DfsUhN61oqH1cme2ydNbTr6cDG5AkVoiUMnjHvkMPTgbPahrduPs%2FdXuwFoyZMuPeBtzUlpjssIk0BfcIUtph2FGwzCuy6d0CQhdl914kkFpuTBp69z2htWslZiifdNkKWK0DIJcK%2FrSurcsk8WEaPiZ7tEJAcfYZS4SddR8orMY%2BhEfGsLc5RSVBGXY0UW6zTNw%2BYg82wPCY1Z9kgrjwVLQPpVTje3rfzRO3UEDh0xbd54m7t%2FSL0yItTAuaGshQmPLuW6S%2F5KOdoWWnwCmkruRqE1ZKMsnSko5gBnNELay%2BWeukQAQ6EyIB%2FWB06%2F%2FaYfBiWUzjgZyKRGg99IBpEO3zShFTod3huOdptlvO4PfWBvrB4632o9feKKn5CXqJUOE%2BTT%2BgjHEdWRLP2W3GZAibuc%2FbOIfOwee7%2Bn9cOimwp8NVS4U08VlgiSfhcWXonWb3aOkvnOfX46QkwoP6p%2FwU67AFSjWFI11fWgLkInKyx6Dx9AePw1c4qVefioOdfVonnQ3dNW7fXwjlRC5F1185jkAwhyCARy9%2F7sIPFHaI%2FEID5osYCwdvVwv0O6pPIknWS%2FVG7rXxUIgYk0xp3ln2eURcIkz%2F20YEsL73kMrgQLn%2BEd3AiGH%2F9wW5PEZOVPNqagqBYtUSWzNl9%2BrKCkhyVg8k79SdRjUkvdYLXtvxU1m6oAu2IjxFOCgwXqn1jFH1Lloh4Gp%2Fkq68ckYZB67%2B%2FdOzejM9ofYNi%2BpJRLwSwwu22w857sj9E%2BbC8Ei9i7KZOZGBCWe81d9lycwAH6Q%3D%3D\u0026X-Amz-Signature=5bba976212601639a8055e0f27f6631b96fc1b9451d0628ad101b3c21abb303c"}],"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4112232,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello (again) @klmunday,\n\nThank you (again) for your help here.\n\nSorry, I hadn't noticed your patch until just now. Our team also worked on their own before I had a chance to reply to you here. I've attached theirs here for your testing \u0026 comparison.\n\nI will also look at yours now, too.\n\nOnce you confirm/approve, our goal is to couple this fix together with the other you've found and release a new version of BuddyPress next week, or early the week after next.\n\nTalk soon,","markdown_message":"\u003cp\u003eHello (again) \u003ca href=\"/klmunday\"\u003e@klmunday\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThank you (again) for your help here.\u003c/p\u003e\n\n\u003cp\u003eSorry, I hadn\u0026#39;t noticed your patch until just now. Our team also worked on their own before I had a chance to reply to you here. I\u0026#39;ve attached theirs here for your testing \u0026amp; comparison.\u003c/p\u003e\n\n\u003cp\u003eI will also look at yours now, too.\u003c/p\u003e\n\n\u003cp\u003eOnce you confirm/approve, our goal is to couple this fix together with the other you\u0026#39;ve found and release a new version of BuddyPress next week, or early the week after next.\u003c/p\u003e\n\n\u003cp\u003eTalk soon,\u003c/p\u003e\n","automated_response":false,"created_at":"2019-02-07T22:58:44.006Z","updated_at":"2019-02-07T22:58:44.006Z","actor":{"username":"jjj","cleared":false,"url":"/jjj","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/007/063/b21324cc7d9861888c1ddd4fa345cda6612361ff_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":420043,"filename":"bp-messages-verify-thread-id_diff.diff","type":"text/x-diff","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/420/043/3d2d6b3e43b5ed66f33ca639f594c6851f5c60e7/bp-messages-verify-thread-id_diff.diff?response-content-disposition=attachment%3B%20filename%3D%22bp-messages-verify-thread-id_diff.diff%22%3B%20filename%2A%3DUTF-8%27%27bp-messages-verify-thread-id_diff.diff\u0026response-content-type=text%2Fx-diff\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ3ORU3ZNE%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T060656Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIBDRduU%2FQiKN2Hy3Cc%2BFdvYldnR%2BI9yQ0JWu5Nd0q2n7AiBT09NYT9NM%2FNa1T7X7mPFfQEFunNsAbPoVngTqyDCvlCq0AwhSEAEaDDAxMzYxOTI3NDg0OSIMjho0%2F2dG4425KWNaKpEDfRP2JVIKEZKe%2Fu1DRJDnMt1hodmiYRHSHxVJXvZvnhQp68RTbgsA5dtRAFzhCl2p7oJWn2DfsUhN61oqH1cme2ydNbTr6cDG5AkVoiUMnjHvkMPTgbPahrduPs%2FdXuwFoyZMuPeBtzUlpjssIk0BfcIUtph2FGwzCuy6d0CQhdl914kkFpuTBp69z2htWslZiifdNkKWK0DIJcK%2FrSurcsk8WEaPiZ7tEJAcfYZS4SddR8orMY%2BhEfGsLc5RSVBGXY0UW6zTNw%2BYg82wPCY1Z9kgrjwVLQPpVTje3rfzRO3UEDh0xbd54m7t%2FSL0yItTAuaGshQmPLuW6S%2F5KOdoWWnwCmkruRqE1ZKMsnSko5gBnNELay%2BWeukQAQ6EyIB%2FWB06%2F%2FaYfBiWUzjgZyKRGg99IBpEO3zShFTod3huOdptlvO4PfWBvrB4632o9feKKn5CXqJUOE%2BTT%2BgjHEdWRLP2W3GZAibuc%2FbOIfOwee7%2Bn9cOimwp8NVS4U08VlgiSfhcWXonWb3aOkvnOfX46QkwoP6p%2FwU67AFSjWFI11fWgLkInKyx6Dx9AePw1c4qVefioOdfVonnQ3dNW7fXwjlRC5F1185jkAwhyCARy9%2F7sIPFHaI%2FEID5osYCwdvVwv0O6pPIknWS%2FVG7rXxUIgYk0xp3ln2eURcIkz%2F20YEsL73kMrgQLn%2BEd3AiGH%2F9wW5PEZOVPNqagqBYtUSWzNl9%2BrKCkhyVg8k79SdRjUkvdYLXtvxU1m6oAu2IjxFOCgwXqn1jFH1Lloh4Gp%2Fkq68ckYZB67%2B%2FdOzejM9ofYNi%2BpJRLwSwwu22w857sj9E%2BbC8Ei9i7KZOZGBCWe81d9lycwAH6Q%3D%3D\u0026X-Amz-Signature=808a700811d163ae34685a75cdf25759aef83165bd0081b2a9cb946d8a7eec25"}],"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4112251,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@klmunday I really like how you've used the first class functions to check thread access, while also using `bp_moderate`. I've shared your patch and my feedback with our team, and I'll reply soon with more feedback if there is any.","markdown_message":"\u003cp\u003e\u003ca href=\"/klmunday\"\u003e@klmunday\u003c/a\u003e I really like how you\u0026#39;ve used the first class functions to check thread access, while also using \u003ccode\u003ebp_moderate\u003c/code\u003e. I\u0026#39;ve shared your patch and my feedback with our team, and I\u0026#39;ll reply soon with more feedback if there is any.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-02-07T23:03:33.398Z","updated_at":"2019-02-07T23:03:33.398Z","actor":{"username":"jjj","cleared":false,"url":"/jjj","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/007/063/b21324cc7d9861888c1ddd4fa345cda6612361ff_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4112253,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2019-02-07T23:03:53.961Z","updated_at":"2019-02-07T23:03:53.961Z","actor":{"username":"jjj","cleared":false,"url":"/jjj","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/007/063/b21324cc7d9861888c1ddd4fa345cda6612361ff_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4112333,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello @jjj \n\nI can confirm your patch works on my tests,\nThe only reason I took into account `bp_moderate` was due to the other functions related to messages using them, I was not sure if it was intended for Moderators to be able to reply.\n\nI don't think my patch handles the error gracefully, I don't think it returns any feedback for the user, I would argue that they shouldn't be able to send that request within a regular browser though.\n\nMore than happy with yours\n\nThanks again for the feedback","markdown_message":"\u003cp\u003eHello \u003ca href=\"/jjj\"\u003e@jjj\u003c/a\u003e \u003c/p\u003e\n\n\u003cp\u003eI can confirm your patch works on my tests,\u003cbr\u003e\nThe only reason I took into account \u003ccode\u003ebp_moderate\u003c/code\u003e was due to the other functions related to messages using them, I was not sure if it was intended for Moderators to be able to reply.\u003c/p\u003e\n\n\u003cp\u003eI don\u0026#39;t think my patch handles the error gracefully, I don\u0026#39;t think it returns any feedback for the user, I would argue that they shouldn\u0026#39;t be able to send that request within a regular browser though.\u003c/p\u003e\n\n\u003cp\u003eMore than happy with yours\u003c/p\u003e\n\n\u003cp\u003eThanks again for the feedback\u003c/p\u003e\n","automated_response":false,"created_at":"2019-02-07T23:36:13.133Z","updated_at":"2019-02-07T23:36:13.133Z","actor":{"username":"klmunday","cleared":false,"url":"/klmunday","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/480/267/c2322c402151db1b8a6b7474b47bfc4b1c415b4a_original.JPG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4168479,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @klmunday - Thanks for working through this issue with us. I'm posting an updated patch, which incorporates your `bp_moderate` check and also uses your `messages_check_thread_access()` call (which I'd forgotten existed :) ). We've put these cap checks in the AJAX handlers rather than in the `messages_send_message()` function, for better separation of business logic.\n\nThe current plan is to ship a security and maintenance release of BuddyPress, including this fix, later this week. Could you please confirm for me how you'd like to be credited in the release notes? See https://buddypress.org/2018/01/buddypress-2-9-3-security-and-maintenance-release/ for an example. Also, if you have a wordpress.org username that you'd like referenced in the changeset, please let me know about that too.","markdown_message":"\u003cp\u003eHi \u003ca href=\"/klmunday\"\u003e@klmunday\u003c/a\u003e - Thanks for working through this issue with us. I\u0026#39;m posting an updated patch, which incorporates your \u003ccode\u003ebp_moderate\u003c/code\u003e check and also uses your \u003ccode\u003emessages_check_thread_access()\u003c/code\u003e call (which I\u0026#39;d forgotten existed :) ). We\u0026#39;ve put these cap checks in the AJAX handlers rather than in the \u003ccode\u003emessages_send_message()\u003c/code\u003e function, for better separation of business logic.\u003c/p\u003e\n\n\u003cp\u003eThe current plan is to ship a security and maintenance release of BuddyPress, including this fix, later this week. Could you please confirm for me how you\u0026#39;d like to be credited in the release notes? See \u003ca title=\"https://buddypress.org/2018/01/buddypress-2-9-3-security-and-maintenance-release/\" href=\"/redirect?url=https%3A%2F%2Fbuddypress.org%2F2018%2F01%2Fbuddypress-2-9-3-security-and-maintenance-release%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://buddypress.org/2018/01/buddypress-2-9-3-security-and-maintenance-release/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e for an example. Also, if you have a wordpress.org username that you\u0026#39;d like referenced in the changeset, please let me know about that too.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-02-18T15:44:49.347Z","updated_at":"2019-02-18T15:44:49.347Z","actor":{"username":"boonebgorges","cleared":false,"url":"/boonebgorges","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4168486,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Attaching diff.","markdown_message":"\u003cp\u003eAttaching diff.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-02-18T15:47:30.729Z","updated_at":"2019-02-18T15:47:30.729Z","actor":{"username":"boonebgorges","cleared":false,"url":"/boonebgorges","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":426069,"filename":"bp-messages-cap-check.diff","type":"text/x-diff","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/426/069/e5a044fca32b88d6b41ab44bd365ed32fadbb805/bp-messages-cap-check.diff?response-content-disposition=attachment%3B%20filename%3D%22bp-messages-cap-check.diff%22%3B%20filename%2A%3DUTF-8%27%27bp-messages-cap-check.diff\u0026response-content-type=text%2Fx-diff\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ3ORU3ZNE%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T060656Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIBDRduU%2FQiKN2Hy3Cc%2BFdvYldnR%2BI9yQ0JWu5Nd0q2n7AiBT09NYT9NM%2FNa1T7X7mPFfQEFunNsAbPoVngTqyDCvlCq0AwhSEAEaDDAxMzYxOTI3NDg0OSIMjho0%2F2dG4425KWNaKpEDfRP2JVIKEZKe%2Fu1DRJDnMt1hodmiYRHSHxVJXvZvnhQp68RTbgsA5dtRAFzhCl2p7oJWn2DfsUhN61oqH1cme2ydNbTr6cDG5AkVoiUMnjHvkMPTgbPahrduPs%2FdXuwFoyZMuPeBtzUlpjssIk0BfcIUtph2FGwzCuy6d0CQhdl914kkFpuTBp69z2htWslZiifdNkKWK0DIJcK%2FrSurcsk8WEaPiZ7tEJAcfYZS4SddR8orMY%2BhEfGsLc5RSVBGXY0UW6zTNw%2BYg82wPCY1Z9kgrjwVLQPpVTje3rfzRO3UEDh0xbd54m7t%2FSL0yItTAuaGshQmPLuW6S%2F5KOdoWWnwCmkruRqE1ZKMsnSko5gBnNELay%2BWeukQAQ6EyIB%2FWB06%2F%2FaYfBiWUzjgZyKRGg99IBpEO3zShFTod3huOdptlvO4PfWBvrB4632o9feKKn5CXqJUOE%2BTT%2BgjHEdWRLP2W3GZAibuc%2FbOIfOwee7%2Bn9cOimwp8NVS4U08VlgiSfhcWXonWb3aOkvnOfX46QkwoP6p%2FwU67AFSjWFI11fWgLkInKyx6Dx9AePw1c4qVefioOdfVonnQ3dNW7fXwjlRC5F1185jkAwhyCARy9%2F7sIPFHaI%2FEID5osYCwdvVwv0O6pPIknWS%2FVG7rXxUIgYk0xp3ln2eURcIkz%2F20YEsL73kMrgQLn%2BEd3AiGH%2F9wW5PEZOVPNqagqBYtUSWzNl9%2BrKCkhyVg8k79SdRjUkvdYLXtvxU1m6oAu2IjxFOCgwXqn1jFH1Lloh4Gp%2Fkq68ckYZB67%2B%2FdOzejM9ofYNi%2BpJRLwSwwu22w857sj9E%2BbC8Ei9i7KZOZGBCWe81d9lycwAH6Q%3D%3D\u0026X-Amz-Signature=159a2b317506638c1077a181a5a9800bc14131691658a90bba3ff5b2e35e0d14"}],"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4169765,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @boonebgorges,\n\nThanks for the update!\nIf possible could I be credited as [Kieran Munday](http://www.klmunday.com/)\nHappy to see this resolved :)","markdown_message":"\u003cp\u003eHi \u003ca href=\"/boonebgorges\"\u003e@boonebgorges\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThanks for the update!\u003cbr\u003e\nIf possible could I be credited as \u003ca href=\"/redirect?url=http%3A%2F%2Fwww.klmunday.com%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eKieran Munday\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nHappy to see this resolved :)\u003c/p\u003e\n","automated_response":false,"created_at":"2019-02-18T20:25:13.668Z","updated_at":"2019-02-18T20:25:13.668Z","actor":{"username":"klmunday","cleared":false,"url":"/klmunday","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/480/267/c2322c402151db1b8a6b7474b47bfc4b1c415b4a_original.JPG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4180666,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you @klmunday! BuddyPress 4.2.0 has been released, and includes this fix https://buddypress.org/2019/02/buddypress-4-2-0-maintenance-and-security-release/\n\nI'll move this ticket along in our bounty queue. Thanks for your cooperation.","markdown_message":"\u003cp\u003eThank you \u003ca href=\"/klmunday\"\u003e@klmunday\u003c/a\u003e! BuddyPress 4.2.0 has been released, and includes this fix \u003ca title=\"https://buddypress.org/2019/02/buddypress-4-2-0-maintenance-and-security-release/\" href=\"/redirect?url=https%3A%2F%2Fbuddypress.org%2F2019%2F02%2Fbuddypress-4-2-0-maintenance-and-security-release%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://buddypress.org/2019/02/buddypress-4-2-0-maintenance-and-security-release/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eI\u0026#39;ll move this ticket along in our bounty queue. Thanks for your cooperation.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-02-20T16:15:18.862Z","updated_at":"2019-02-20T16:15:18.862Z","actor":{"username":"boonebgorges","cleared":false,"url":"/boonebgorges","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4224079,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi Boone\n\nThat's great, thanks again!","markdown_message":"\u003cp\u003eHi Boone\u003c/p\u003e\n\n\u003cp\u003eThat\u0026#39;s great, thanks again!\u003c/p\u003e\n","automated_response":false,"created_at":"2019-02-27T14:13:02.597Z","updated_at":"2019-02-27T14:13:02.597Z","actor":{"username":"klmunday","cleared":false,"url":"/klmunday","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/480/267/c2322c402151db1b8a6b7474b47bfc4b1c415b4a_original.JPG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4224285,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2019-02-27T15:01:02.733Z","updated_at":"2019-02-27T15:01:02.733Z","actor":{"username":"boonebgorges","cleared":false,"url":"/boonebgorges","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"klmunday","url":"/klmunday"},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4288660,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Whoops my bad, only just realized I didn't request disclosure\nAny update on the bounty queues?\n\nHope all is well\nThanks","markdown_message":"\u003cp\u003eWhoops my bad, only just realized I didn\u0026#39;t request disclosure\u003cbr\u003e\nAny update on the bounty queues?\u003c/p\u003e\n\n\u003cp\u003eHope all is well\u003cbr\u003e\nThanks\u003c/p\u003e\n","automated_response":false,"created_at":"2019-03-08T20:30:58.972Z","updated_at":"2019-03-08T20:30:58.972Z","first_to_agree":true,"actor":{"username":"klmunday","cleared":false,"url":"/klmunday","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/480/267/c2322c402151db1b8a6b7474b47bfc4b1c415b4a_original.JPG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4289187,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Bounties are in progress. Thanks for your patience!","markdown_message":"\u003cp\u003eBounties are in progress. Thanks for your patience!\u003c/p\u003e\n","automated_response":false,"created_at":"2019-03-08T22:27:21.490Z","updated_at":"2019-03-08T22:27:21.490Z","actor":{"username":"boonebgorges","cleared":false,"url":"/boonebgorges","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4289189,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-03-08T22:27:35.513Z","updated_at":"2019-03-08T22:27:35.513Z","actor":{"username":"boonebgorges","cleared":false,"url":"/boonebgorges","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4289190,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-03-08T22:27:35.591Z","updated_at":"2019-03-08T22:27:35.591Z","actor":{"username":"boonebgorges","cleared":false,"url":"/boonebgorges","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4367184,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello I hope all is well,\nAre there any further updates to the bug bounties?\nIt's been a month since patch release","markdown_message":"\u003cp\u003eHello I hope all is well,\u003cbr\u003e\nAre there any further updates to the bug bounties?\u003cbr\u003e\nIt\u0026#39;s been a month since patch release\u003c/p\u003e\n","automated_response":false,"created_at":"2019-03-21T15:57:54.751Z","updated_at":"2019-03-21T15:57:54.751Z","actor":{"username":"klmunday","cleared":false,"url":"/klmunday","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/480/267/c2322c402151db1b8a6b7474b47bfc4b1c415b4a_original.JPG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4387772,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2019-03-25T16:56:57.190Z","updated_at":"2019-03-25T16:56:57.190Z","actor":{"url":"/wordpress","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/055/f114d1d31f904e3b903cd99a6cf566bb531f8401_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"WordPress"}},"bounty_amount":"325.0","bounty_currency":"usd","bonus_amount":"50.0","genius_execution_id":null,"team_handle":"wordpress","collaborator":{"username":"klmunday","url":"/klmunday"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4387794,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for the bounty!","markdown_message":"\u003cp\u003eThanks for the bounty!\u003c/p\u003e\n","automated_response":false,"created_at":"2019-03-25T16:59:39.692Z","updated_at":"2019-03-25T16:59:39.692Z","actor":{"username":"klmunday","cleared":false,"url":"/klmunday","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/480/267/c2322c402151db1b8a6b7474b47bfc4b1c415b4a_original.JPG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"wordpress","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}