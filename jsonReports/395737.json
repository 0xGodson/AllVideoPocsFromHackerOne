{"id":395737,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zOTU3Mzc=","url":"https://hackerone.com/reports/395737","title":"`chrome://brave` available for navigation in Release build [-\u003e RCE] + navigation to `chrome://*` using tab_helper [\"Open in new tab\"]","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2018-08-16T04:53:51.685Z","submitted_at":"2018-08-16T04:53:51.685Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"metnew","url":"/metnew","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":15688,"url":"https://hackerone.com/brave","handle":"brave","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/015/688/2aad5641af643ee4f4402896e4747293f6e9c5ca_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/688/2aad5641af643ee4f4402896e4747293f6e9c5ca_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Brave Software","twitter_handle":"brave","website":"https://brave.com","about":""}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2018-09-25T00:23:34.580Z","bug_reporter_agreed_on_going_public_at":"2018-09-19T16:23:44.526Z","team_member_agreed_on_going_public_at":"2018-09-25T00:23:34.427Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"## Summary:\n\n### `chrome://brave` is available for navigation\n\nNavigation to `chrome://brave` + `\u003clocal_file_path\u003e` requires local file at `\u003clocal_file_path\u003e`.\n\nThe file loaded in this context has access to **private Muon APIs** such as `chrome.ipcRenderer/remote/webFrame/webViewRequest`.\n\nMuon API allows executing code on the device. (e.g. with `chrome.remote.require('child_process').exec`)\n\n\u003e In addition, Brave isn't sandboxed (on all OS).\n\nThat's clearly a vulnerability, not a feature:\n1. it's in Release channel, not in Debug builds\n2. Could lead to RCE\n\n\u003e Note: attacker knows the correct `\u003clocal_file_path\u003e` after loading the file from `file://` origin (`window.location.pathname`).\n\n### Navigation to `chrome://brave`\n\nI've already shown the way to navigate to `file://` URLs in  #369218, which was fixed in 0.23.80.\n\n\u003e  I mentioned in the report that it's possible navigating to `chrome://` URLs too in #369218. However, [the fix](https://github.com/brave/browser-laptop/pull/14973) was incomplete. It only works for `about:` and `file:`URLs.\n\n### PoC\n\n1. Shows that `\u003cwebview\u003e` works\n2. Launches `Calculator.app` on macOS\n\n## Products affected: \n \nBrave: 0.23.79 (0.23.80 and 0.23.100 too, where #369218 is patched)\nV8: 6.8.275.24 \nrev: 51b49051a779f0db94fbcfd0df5faca781299ea0 \nMuon: 8.0.7 \nOS Release: 17.7.0 \nUpdate Channel: Release \nOS Architecture: x64 \nOS Platform: macOS \nNode.js: 7.9.0 \nBrave Sync: v1.4.2 \nlibchromiumcontent: 68.0.3440.84\n\n## Steps To Reproduce ||  Attack Scenario:\n\n1. Download `exploit.html`\n2. Open link in the file using \"Open in new tab\"\n3. The new tab opens with private `\u003cwebview\u003e` tag + `Calculator.app` starts\n\n## Patch\n\nPreventing navigation to `chrome://brave` origin seems ok.\n\n### Additional resources\n\nScreencast attached.\n\n## Impact\n\nCrafted HTML file allows executing code on the device. \n\n\u003e Requires user gesture - \"Open in a new tab\". Set impact to \"High\", because requires downloading the file.","vulnerability_information_html":"\u003ch2 id=\"summary\"\u003eSummary:\u003c/h2\u003e\n\n\u003ch3 id=\"chrome-brave-is-available-for-navigation\"\u003e\n\u003ccode\u003echrome://brave\u003c/code\u003e is available for navigation\u003c/h3\u003e\n\n\u003cp\u003eNavigation to \u003ccode\u003echrome://brave\u003c/code\u003e + \u003ccode\u003e\u0026lt;local_file_path\u0026gt;\u003c/code\u003e requires local file at \u003ccode\u003e\u0026lt;local_file_path\u0026gt;\u003c/code\u003e.\u003c/p\u003e\n\n\u003cp\u003eThe file loaded in this context has access to \u003cstrong\u003eprivate Muon APIs\u003c/strong\u003e such as \u003ccode\u003echrome.ipcRenderer/remote/webFrame/webViewRequest\u003c/code\u003e.\u003c/p\u003e\n\n\u003cp\u003eMuon API allows executing code on the device. (e.g. with \u003ccode\u003echrome.remote.require(\u0026#39;child_process\u0026#39;).exec\u003c/code\u003e)\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eIn addition, Brave isn\u0026#39;t sandboxed (on all OS).\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eThat\u0026#39;s clearly a vulnerability, not a feature:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eit\u0026#39;s in Release channel, not in Debug builds\u003c/li\u003e\n\u003cli\u003eCould lead to RCE\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eNote: attacker knows the correct \u003ccode\u003e\u0026lt;local_file_path\u0026gt;\u003c/code\u003e after loading the file from \u003ccode\u003efile://\u003c/code\u003e origin (\u003ccode\u003ewindow.location.pathname\u003c/code\u003e).\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003ch3 id=\"navigation-to-chrome-brave\"\u003eNavigation to \u003ccode\u003echrome://brave\u003c/code\u003e\n\u003c/h3\u003e\n\n\u003cp\u003eI\u0026#39;ve already shown the way to navigate to \u003ccode\u003efile://\u003c/code\u003e URLs in  \u003ca href=\"/reports/369218\"\u003e#369218\u003c/a\u003e, which was fixed in 0.23.80.\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eI mentioned in the report that it\u0026#39;s possible navigating to \u003ccode\u003echrome://\u003c/code\u003e URLs too in \u003ca href=\"/reports/369218\"\u003e#369218\u003c/a\u003e. However, \u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fbrave%2Fbrowser-laptop%2Fpull%2F14973\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ethe fix\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e was incomplete. It only works for \u003ccode\u003eabout:\u003c/code\u003e and \u003ccode\u003efile:\u003c/code\u003eURLs.\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003ch3 id=\"poc\"\u003ePoC\u003c/h3\u003e\n\n\u003col\u003e\n\u003cli\u003eShows that \u003ccode\u003e\u0026lt;webview\u0026gt;\u003c/code\u003e works\u003c/li\u003e\n\u003cli\u003eLaunches \u003ccode\u003eCalculator.app\u003c/code\u003e on macOS\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003ch2 id=\"products-affected\"\u003eProducts affected:\u003c/h2\u003e\n\n\u003cp\u003eBrave: 0.23.79 (0.23.80 and 0.23.100 too, where \u003ca href=\"/reports/369218\"\u003e#369218\u003c/a\u003e is patched)\u003cbr\u003e\nV8: 6.8.275.24 \u003cbr\u003e\nrev: 51b49051a779f0db94fbcfd0df5faca781299ea0 \u003cbr\u003e\nMuon: 8.0.7 \u003cbr\u003e\nOS Release: 17.7.0 \u003cbr\u003e\nUpdate Channel: Release \u003cbr\u003e\nOS Architecture: x64 \u003cbr\u003e\nOS Platform: macOS \u003cbr\u003e\nNode.js: 7.9.0 \u003cbr\u003e\nBrave Sync: v1.4.2 \u003cbr\u003e\nlibchromiumcontent: 68.0.3440.84\u003c/p\u003e\n\n\u003ch2 id=\"steps-to-reproduce-attack-scenario\"\u003eSteps To Reproduce ||  Attack Scenario:\u003c/h2\u003e\n\n\u003col\u003e\n\u003cli\u003eDownload \u003ccode\u003eexploit.html\u003c/code\u003e\n\u003c/li\u003e\n\u003cli\u003eOpen link in the file using \u0026quot;Open in new tab\u0026quot;\u003c/li\u003e\n\u003cli\u003eThe new tab opens with private \u003ccode\u003e\u0026lt;webview\u0026gt;\u003c/code\u003e tag + \u003ccode\u003eCalculator.app\u003c/code\u003e starts\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003ch2 id=\"patch\"\u003ePatch\u003c/h2\u003e\n\n\u003cp\u003ePreventing navigation to \u003ccode\u003echrome://brave\u003c/code\u003e origin seems ok.\u003c/p\u003e\n\n\u003ch3 id=\"additional-resources\"\u003eAdditional resources\u003c/h3\u003e\n\n\u003cp\u003eScreencast attached.\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eCrafted HTML file allows executing code on the device. \u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eRequires user gesture - \u0026quot;Open in a new tab\u0026quot;. Set impact to \u0026quot;High\u0026quot;, because requires downloading the file.\u003c/p\u003e\n\u003c/blockquote\u003e\n","bounty_amount":"2000.0","formatted_bounty":"$2,000","original_report_id":null,"original_report_url":null,"attachments":[{"id":333763,"file_name":"exploit.html","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/333/763/ff81e07fa288eb75c6b3297959814d7cc44a5f5b/exploit.html?response-content-disposition=attachment%3B%20filename%3D%22exploit.html%22%3B%20filename%2A%3DUTF-8%27%27exploit.html\u0026response-content-type=application%2Foctet-stream\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQVI7RRVDA%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T055031Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIBHEDTSDqGCEjCA9tudGP24dm%2BoWjhn4lvjW9Xdc726YAiBAirG3R3v5iCJWiH96kr3xjgtokc99MedveJtrAC4YPCq0AwhWEAEaDDAxMzYxOTI3NDg0OSIMwzXTJ902cIF5s5YBKpED%2BFkmFklYgSPET%2FOjZR761EJeyNuollWMzL6Eqk6fqlOryiQVTtybXJCV%2BiXs4IKZlZhdEUgfEs%2FPAvZuGC8ev7K5oLyJ5QqWwuAl7vab30rE%2Fc%2B6gA7DaaQR7brCfssJN3parouSEln0TFi%2Bl2%2Fg04wp1RCS7aIs4VD3adDyb35qEbpuQ8cAYPCIvI7AkKNaVq%2BKTzAMk3O4%2FJlAqQIXdBSTWxtRmWJxWRq9BCvLGNHYWxUqU5LgJuqWxRkm6nUVp%2BfeYyy0xqpTqdHXt%2BFFP%2BZc%2BJ8Gvv6F4e8%2B7BU9sbfDeQE29%2FbuO0f%2FsPEwM9HdRQFytGHqL%2FkQk%2BpNhsgAok7yxwEi9NustpeRTz5rN3XCfxnTv1EQZDTyf2CMkXPxai9miYEyCqEzm95o%2FWji0UokRhJ7nAAvjnFcZZBhzzAlKgj60zmHVd7RAF9FBoKhJw1L8CzEtzHi8Ub%2Fl%2Ff40q%2BnIJGRvCcsv6s8fwns3Q9x9rNOcNC4%2FvQ2W2tcsXBe898Y2j9dQMjAC8oLXDalQ5kwqemq%2FwU67AHfGUTl%2FYDPxs5VQbVM6YbbQPWpACjCZdWNB1X%2BYlCAg6WTSF6hwm9XlUMal0jLt5Ae9Mby3zeF0kXzzliRlv1djJGT18ZKDRpIb6U%2FYP%2FCOvPcZ%2FUXcp7ogmd1yEm6TQJTAPNpn7lyoOOF9531N%2F%2FztCXqmws2n5HlFZs8iPlP3GWFKjEZRsy5DhmrXa8MUEuD9fcCiZMJW80Aq9nKkHrYB8us1vZYBWwuInvS4cRXLQtFsCvvxSgZ3Pc%2FyIg1f4JiqUaR0lsXYqCV2IcbArgLW3ublxMmtJ5ZRv7klB3LmjKFMu9la06KhhLPzw%3D%3D\u0026X-Amz-Signature=5177dfd546d2dcba5c418aea4f9e01b26dc25229c64345e5cec2cbafbdf96eac","file_size":499,"type":"text/html"},{"id":334043,"file_name":"brave-chrome-brave-new-tab.mp4","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/334/043/5d15c746ef3a4d8b6b816a47b22019293ce356fd/brave-chrome-brave-new-tab.mp4?response-content-disposition=attachment%3B%20filename%3D%22brave-chrome-brave-new-tab.mp4%22%3B%20filename%2A%3DUTF-8%27%27brave-chrome-brave-new-tab.mp4\u0026response-content-type=video%2Fmp4\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQVI7RRVDA%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T055031Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIBHEDTSDqGCEjCA9tudGP24dm%2BoWjhn4lvjW9Xdc726YAiBAirG3R3v5iCJWiH96kr3xjgtokc99MedveJtrAC4YPCq0AwhWEAEaDDAxMzYxOTI3NDg0OSIMwzXTJ902cIF5s5YBKpED%2BFkmFklYgSPET%2FOjZR761EJeyNuollWMzL6Eqk6fqlOryiQVTtybXJCV%2BiXs4IKZlZhdEUgfEs%2FPAvZuGC8ev7K5oLyJ5QqWwuAl7vab30rE%2Fc%2B6gA7DaaQR7brCfssJN3parouSEln0TFi%2Bl2%2Fg04wp1RCS7aIs4VD3adDyb35qEbpuQ8cAYPCIvI7AkKNaVq%2BKTzAMk3O4%2FJlAqQIXdBSTWxtRmWJxWRq9BCvLGNHYWxUqU5LgJuqWxRkm6nUVp%2BfeYyy0xqpTqdHXt%2BFFP%2BZc%2BJ8Gvv6F4e8%2B7BU9sbfDeQE29%2FbuO0f%2FsPEwM9HdRQFytGHqL%2FkQk%2BpNhsgAok7yxwEi9NustpeRTz5rN3XCfxnTv1EQZDTyf2CMkXPxai9miYEyCqEzm95o%2FWji0UokRhJ7nAAvjnFcZZBhzzAlKgj60zmHVd7RAF9FBoKhJw1L8CzEtzHi8Ub%2Fl%2Ff40q%2BnIJGRvCcsv6s8fwns3Q9x9rNOcNC4%2FvQ2W2tcsXBe898Y2j9dQMjAC8oLXDalQ5kwqemq%2FwU67AHfGUTl%2FYDPxs5VQbVM6YbbQPWpACjCZdWNB1X%2BYlCAg6WTSF6hwm9XlUMal0jLt5Ae9Mby3zeF0kXzzliRlv1djJGT18ZKDRpIb6U%2FYP%2FCOvPcZ%2FUXcp7ogmd1yEm6TQJTAPNpn7lyoOOF9531N%2F%2FztCXqmws2n5HlFZs8iPlP3GWFKjEZRsy5DhmrXa8MUEuD9fcCiZMJW80Aq9nKkHrYB8us1vZYBWwuInvS4cRXLQtFsCvvxSgZ3Pc%2FyIg1f4JiqUaR0lsXYqCV2IcbArgLW3ublxMmtJ5ZRv7klB3LmjKFMu9la06KhhLPzw%3D%3D\u0026X-Amz-Signature=96e86274e78fcb820dbf09ed9cd1382292b3a08be4b34ab8873120338901dac8","file_size":1348996,"type":"video/mp4"}],"allow_singular_disclosure_at":null,"vote_count":46,"voters":["foobar7","dawgyg","inhibitor181","bl4de","surfrdan","spam404","base_64","mik317","sameerphad72","otuken","and 36 more..."],"severity":{"rating":"high","author_type":"User"},"structured_scope":{"databaseId":7941,"asset_type":"SOURCE_CODE","asset_identifier":"https://github.com/brave/muon","max_severity":"none"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":3206525,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"triaged to https://github.com/brave/browser-laptop/issues/15045","markdown_message":"\u003cp\u003etriaged to \u003ca title=\"https://github.com/brave/browser-laptop/issues/15045\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fbrave%2Fbrowser-laptop%2Fissues%2F15045\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/brave/browser-laptop/issues/15045\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2018-08-16T21:33:53.117Z","updated_at":"2018-08-16T21:33:53.117Z","actor":{"username":"diracdeltas","cleared":false,"url":"/diracdeltas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/115/616/4e2016543ea3e299dcadd088be7d0225de3419e0_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3211350,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Fixed in: https://github.com/brave/browser-laptop/pull/15047","markdown_message":"\u003cp\u003eFixed in: \u003ca title=\"https://github.com/brave/browser-laptop/pull/15047\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fbrave%2Fbrowser-laptop%2Fpull%2F15047\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/brave/browser-laptop/pull/15047\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2018-08-17T17:20:24.771Z","updated_at":"2018-08-17T17:20:24.771Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3211359,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"\u003e @diracdeltas Are you sure the fix is complete? It still seems possible navigating to \"chrome://brave\" from address bar.","markdown_message":"\u003cblockquote\u003e\n\u003cp\u003e\u003ca href=\"/diracdeltas\"\u003e@diracdeltas\u003c/a\u003e Are you sure the fix is complete? It still seems possible navigating to \u0026quot;chrome://brave\u0026quot; from address bar.\u003c/p\u003e\n\u003c/blockquote\u003e\n","automated_response":false,"created_at":"2018-08-17T17:23:05.964Z","updated_at":"2018-08-17T17:24:07.962Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3214944,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@metnew you're right, i thought we already blocked navigation to chrome:// but turns out we don't","markdown_message":"\u003cp\u003e\u003ca href=\"/metnew\"\u003e@metnew\u003c/a\u003e you\u0026#39;re right, i thought we already blocked navigation to chrome:// but turns out we don\u0026#39;t\u003c/p\u003e\n","automated_response":false,"created_at":"2018-08-19T02:39:28.822Z","updated_at":"2018-08-19T02:39:28.822Z","actor":{"username":"diracdeltas","cleared":false,"url":"/diracdeltas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/115/616/4e2016543ea3e299dcadd088be7d0225de3419e0_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3227152,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"we're also just going to remove the chrome.remote.require API since it's from Electron but we don't use it: https://github.com/brave/muon/pull/644","markdown_message":"\u003cp\u003ewe\u0026#39;re also just going to remove the chrome.remote.require API since it\u0026#39;s from Electron but we don\u0026#39;t use it: \u003ca title=\"https://github.com/brave/muon/pull/644\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fbrave%2Fmuon%2Fpull%2F644\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/brave/muon/pull/644\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2018-08-21T19:04:32.131Z","updated_at":"2018-08-21T19:04:32.131Z","actor":{"username":"diracdeltas","cleared":false,"url":"/diracdeltas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/115/616/4e2016543ea3e299dcadd088be7d0225de3419e0_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3227195,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I think there is an RCE without `chrome.remote`. I'm going to review this case now @diracdeltas","markdown_message":"\u003cp\u003eI think there is an RCE without \u003ccode\u003echrome.remote\u003c/code\u003e. I\u0026#39;m going to review this case now \u003ca href=\"/diracdeltas\"\u003e@diracdeltas\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2018-08-21T19:14:46.616Z","updated_at":"2018-08-21T19:17:24.055Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3227200,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"BTW i still plan on blocking chrome:// loads - just saying we can also remove some of these APIs","markdown_message":"\u003cp\u003eBTW i still plan on blocking chrome:// loads - just saying we can also remove some of these APIs\u003c/p\u003e\n","automated_response":false,"created_at":"2018-08-21T19:16:28.697Z","updated_at":"2018-08-21T19:16:28.697Z","actor":{"username":"diracdeltas","cleared":false,"url":"/diracdeltas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/115/616/4e2016543ea3e299dcadd088be7d0225de3419e0_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3227207,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Removing `Webview` and `chrome.webFrame` in the context of `chrome://brave/*` seems impossible, however, it's possible to leverage these APIs to UXSS. So blocking navigation to `chrome://brave` is still required.","markdown_message":"\u003cp\u003eRemoving \u003ccode\u003eWebview\u003c/code\u003e and \u003ccode\u003echrome.webFrame\u003c/code\u003e in the context of \u003ccode\u003echrome://brave/*\u003c/code\u003e seems impossible, however, it\u0026#39;s possible to leverage these APIs to UXSS. So blocking navigation to \u003ccode\u003echrome://brave\u003c/code\u003e is still required.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-08-21T19:19:40.197Z","updated_at":"2018-08-21T19:22:33.378Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3227215,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@diracdeltas \nBlocking navigation to `chrome://` should work.\nHowever, I'm afraid of debugging capabilities: will `chrome://histograms/` being accessible in this case?","markdown_message":"\u003cp\u003e\u003ca href=\"/diracdeltas\"\u003e@diracdeltas\u003c/a\u003e \u003cbr\u003e\nBlocking navigation to \u003ccode\u003echrome://\u003c/code\u003e should work.\u003cbr\u003e\nHowever, I\u0026#39;m afraid of debugging capabilities: will \u003ccode\u003echrome://histograms/\u003c/code\u003e being accessible in this case?\u003c/p\u003e\n","automated_response":false,"created_at":"2018-08-21T19:21:43.100Z","updated_at":"2018-08-21T19:22:54.334Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3227218,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@metnew good call! i didn't realize we supported chrome://histograms. i guess i can just block chrome://brave","markdown_message":"\u003cp\u003e\u003ca href=\"/metnew\"\u003e@metnew\u003c/a\u003e good call! i didn\u0026#39;t realize we supported chrome://histograms. i guess i can just block chrome://brave\u003c/p\u003e\n","automated_response":false,"created_at":"2018-08-21T19:22:59.555Z","updated_at":"2018-08-21T19:22:59.555Z","actor":{"username":"diracdeltas","cleared":false,"url":"/diracdeltas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/115/616/4e2016543ea3e299dcadd088be7d0225de3419e0_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3227230,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@diracdeltas Also:\nchrome://blob-internals/\nchrome://appcache-internals/\nchrome://serviceworker-internals/\nchrome://webrtc-internals/\nchrome://network-errors/\nchrome://media-internals/\nand something related to USB, AFAIR\n\nI was thinking about local files reading ( #369218 + #375329) from the web with opening a new tab pointing to \"chrome://blob-internals/\u003cblob\u003e\" or something similar. \nI didn't find a way to do this :(","markdown_message":"\u003cp\u003e\u003ca href=\"/diracdeltas\"\u003e@diracdeltas\u003c/a\u003e Also:\u003cbr\u003e\nchrome://blob-internals/\u003cbr\u003e\nchrome://appcache-internals/\u003cbr\u003e\nchrome://serviceworker-internals/\u003cbr\u003e\nchrome://webrtc-internals/\u003cbr\u003e\nchrome://network-errors/\u003cbr\u003e\nchrome://media-internals/\u003cbr\u003e\nand something related to USB, AFAIR\u003c/p\u003e\n\n\u003cp\u003eI was thinking about local files reading ( \u003ca href=\"/reports/369218\"\u003e#369218\u003c/a\u003e + \u003ca href=\"/reports/375329\"\u003e#375329\u003c/a\u003e) from the web with opening a new tab pointing to \u0026quot;chrome://blob-internals/\u0026lt;blob\u0026gt;\u0026quot; or something similar. \u003cbr\u003e\nI didn\u0026#39;t find a way to do this :(\u003c/p\u003e\n","automated_response":false,"created_at":"2018-08-21T19:27:56.583Z","updated_at":"2018-08-21T19:27:56.583Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3227692,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@diracdeltas  I think `https://github.com/brave/muon/pull/644` is not a good patch against RCE since `chrome.ipcRenderer` continues being available in this case.  \n\n\u003e UXSS of course available in any case\n\nBlocked navigation to `chrome://brave/*` is required.","markdown_message":"\u003cp\u003e\u003ca href=\"/diracdeltas\"\u003e@diracdeltas\u003c/a\u003e  I think \u003ccode\u003ehttps://github.com/brave/muon/pull/644\u003c/code\u003e is not a good patch against RCE since \u003ccode\u003echrome.ipcRenderer\u003c/code\u003e continues being available in this case.  \u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eUXSS of course available in any case\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eBlocked navigation to \u003ccode\u003echrome://brave/*\u003c/code\u003e is required.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-08-21T20:14:51.747Z","updated_at":"2018-08-21T20:14:51.747Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3227697,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Seems possible to require `require` using \n\n```js\nipcMain.on('ELECTRON_BROWSER_GET_BUILTIN', function (event, module) {\n  try {\n    event.returnValue = valueToMeta(event.sender, electron[module])\n  } catch (error) {\n    event.returnValue = exceptionToMeta(error)\n  }\n})\n```","markdown_message":"\u003cp\u003eSeems possible to require \u003ccode\u003erequire\u003c/code\u003e using \u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight javascript\"\u003e\u003ccode\u003e\u003cspan class=\"nx\"\u003eipcMain\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eon\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003eELECTRON_BROWSER_GET_BUILTIN\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kd\"\u003efunction\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eevent\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003emodule\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"k\"\u003etry\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"nx\"\u003eevent\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ereturnValue\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003evalueToMeta\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eevent\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003esender\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003eelectron\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"nx\"\u003emodule\u003c/span\u003e\u003cspan class=\"p\"\u003e])\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e}\u003c/span\u003e \u003cspan class=\"k\"\u003ecatch\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eerror\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"nx\"\u003eevent\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ereturnValue\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003eexceptionToMeta\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eerror\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e})\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","automated_response":false,"created_at":"2018-08-21T20:16:44.101Z","updated_at":"2018-08-21T20:16:44.101Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3236858,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"2nd part of the fix: https://github.com/brave/browser-laptop/pull/15076","markdown_message":"\u003cp\u003e2nd part of the fix: \u003ca title=\"https://github.com/brave/browser-laptop/pull/15076\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fbrave%2Fbrowser-laptop%2Fpull%2F15076\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/brave/browser-laptop/pull/15076\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2018-08-23T17:09:34.173Z","updated_at":"2018-08-23T17:09:34.173Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3237435,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"The vulnerability was completely fixed in 0.23.104\n","markdown_message":"\u003cp\u003eThe vulnerability was completely fixed in 0.23.104\u003c/p\u003e\n","automated_response":false,"created_at":"2018-08-23T19:23:37.721Z","updated_at":"2018-08-23T19:23:37.721Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3262065,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"\u003e Hope, you'll consider [my comments](https://hackerone.com/bugs?subject=user\u0026report_id=395737\u0026view=open\u0026substates%5B%5D=new\u0026substates%5B%5D=needs-more-info\u0026substates%5B%5D=triaged\u0026substates%5B%5D=pre-submission\u0026reported_to_team=\u0026text_query=\u0026program_states%5B%5D=2\u0026program_states%5B%5D=3\u0026program_states%5B%5D=4\u0026program_states%5B%5D=5\u0026sort_type=latest_activity\u0026sort_direction=descending\u0026limit=25\u0026page=1#activity-3211359)/activity, when estimating bounty","markdown_message":"\u003cblockquote\u003e\n\u003cp\u003eHope, you\u0026#39;ll consider \u003ca href=\"https://hackerone.com/bugs?subject=user\u0026amp;report_id=395737\u0026amp;view=open\u0026amp;substates%5B%5D=new\u0026amp;substates%5B%5D=needs-more-info\u0026amp;substates%5B%5D=triaged\u0026amp;substates%5B%5D=pre-submission\u0026amp;reported_to_team=\u0026amp;text_query=\u0026amp;program_states%5B%5D=2\u0026amp;program_states%5B%5D=3\u0026amp;program_states%5B%5D=4\u0026amp;program_states%5B%5D=5\u0026amp;sort_type=latest_activity\u0026amp;sort_direction=descending\u0026amp;limit=25\u0026amp;page=1#activity-3211359\"\u003emy comments\u003c/a\u003e/activity, when estimating bounty\u003c/p\u003e\n\u003c/blockquote\u003e\n","automated_response":false,"created_at":"2018-08-29T02:07:28.475Z","updated_at":"2018-08-29T02:08:39.445Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3285058,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @brave, any updates?","markdown_message":"\u003cp\u003eHi \u003ca href=\"/brave\"\u003e@brave\u003c/a\u003e, any updates?\u003c/p\u003e\n","automated_response":false,"created_at":"2018-09-03T12:40:26.137Z","updated_at":"2018-09-03T12:40:26.137Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3291770,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks for the reminder!","markdown_message":"\u003cp\u003eThanks for the reminder!\u003c/p\u003e\n","automated_response":false,"created_at":"2018-09-04T18:27:02.577Z","updated_at":"2018-09-04T18:27:02.577Z","actor":{"url":"/brave","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/688/2aad5641af643ee4f4402896e4747293f6e9c5ca_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Brave Software"}},"bounty_amount":"250.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"brave","collaborator":{"username":"metnew","url":"/metnew"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3291771,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2018-09-04T18:27:16.067Z","updated_at":"2018-09-04T18:27:16.067Z","actor":{"username":"toml","cleared":false,"url":"/toml","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/229/717/56ea9edd04176aa3f29b215291bbc0b656699f67_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"metnew","url":"/metnew"},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3291773,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Great, thanks @brave!","markdown_message":"\u003cp\u003eGreat, thanks \u003ca href=\"/brave\"\u003e@brave\u003c/a\u003e!\u003c/p\u003e\n","automated_response":false,"created_at":"2018-09-04T18:27:41.955Z","updated_at":"2018-09-04T18:27:41.955Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3359091,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-09-19T16:23:44.585Z","updated_at":"2018-09-19T16:23:44.585Z","first_to_agree":true,"actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3370816,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@diracdeltas \n### RCE from the web\n\n #369218 allowed opening a system HTML files to trigger reflected XSS.\nThat vulnerability makes this problem Critical.\n\n### Attack scenario\n\n1. Open `chrome://brave/\u003clocal_file_with_reflected_XSS\u003e`\n2. Trigger RCE.\n\n### Summary\n\nSo, yeah, in some sense, that's RCE from the web.","markdown_message":"\u003cp\u003e\u003ca href=\"/diracdeltas\"\u003e@diracdeltas\u003c/a\u003e \u003c/p\u003e\n\n\u003ch3 id=\"rce-from-the-web\"\u003eRCE from the web\u003c/h3\u003e\n\n\u003cp\u003e\u003ca href=\"/reports/369218\"\u003e#369218\u003c/a\u003e allowed opening a system HTML files to trigger reflected XSS.\u003cbr\u003e\nThat vulnerability makes this problem Critical.\u003c/p\u003e\n\n\u003ch3 id=\"attack-scenario\"\u003eAttack scenario\u003c/h3\u003e\n\n\u003col\u003e\n\u003cli\u003eOpen \u003ccode\u003echrome://brave/\u0026lt;local_file_with_reflected_XSS\u0026gt;\u003c/code\u003e\n\u003c/li\u003e\n\u003cli\u003eTrigger RCE.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003ch3 id=\"summary\"\u003eSummary\u003c/h3\u003e\n\n\u003cp\u003eSo, yeah, in some sense, that\u0026#39;s RCE from the web.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-09-21T20:31:03.544Z","updated_at":"2018-09-21T20:31:03.544Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3383032,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Looking back, we underestimated this.","markdown_message":"\u003cp\u003eLooking back, we underestimated this.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-09-25T00:23:22.893Z","updated_at":"2018-09-25T00:23:22.893Z","actor":{"url":"/brave","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/688/2aad5641af643ee4f4402896e4747293f6e9c5ca_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Brave Software"}},"bounty_amount":"750.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"brave","collaborator":{"username":"metnew","url":"/metnew"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3383033,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-09-25T00:23:34.456Z","updated_at":"2018-09-25T00:23:34.456Z","actor":{"username":"toml","cleared":false,"url":"/toml","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/229/717/56ea9edd04176aa3f29b215291bbc0b656699f67_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3383034,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-09-25T00:23:34.608Z","updated_at":"2018-09-25T00:23:34.608Z","actor":{"username":"toml","cleared":false,"url":"/toml","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/229/717/56ea9edd04176aa3f29b215291bbc0b656699f67_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3383119,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks, @brave!","markdown_message":"\u003cp\u003eThanks, \u003ca href=\"/brave\"\u003e@brave\u003c/a\u003e!\u003c/p\u003e\n","automated_response":false,"created_at":"2018-09-25T01:03:13.327Z","updated_at":"2018-09-25T01:03:13.327Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3389639,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@metnew correctly pointed out in a comment on https://hackerone.com/reports/369218#activity-3388871 that this vuln is pretty easy to trigger if you have MITM access. for instance MacOS apparently loads a file automatically over HTTP (i haven't verified this). or the attacker could just wait for the user to initiate a download over HTTP.\n\nfurthermore, a MITM could redirect any HTTP request in Brave to an attacker site, which would then trigger this exploit. i think this means effectively RCE from MITM with almost no user interaction.\n\ngiven that i think we should consider increasing the bounty yet again. @toml ","markdown_message":"\u003cp\u003e\u003ca href=\"/metnew\"\u003e@metnew\u003c/a\u003e correctly pointed out in a comment on \u003ca title=\"https://hackerone.com/reports/369218#activity-3388871\" href=\"https://hackerone.com/reports/369218#activity-3388871\"\u003ehttps://hackerone.com/reports/369218#activity-3388871\u003c/a\u003e that this vuln is pretty easy to trigger if you have MITM access. for instance MacOS apparently loads a file automatically over HTTP (i haven\u0026#39;t verified this). or the attacker could just wait for the user to initiate a download over HTTP.\u003c/p\u003e\n\n\u003cp\u003efurthermore, a MITM could redirect any HTTP request in Brave to an attacker site, which would then trigger this exploit. i think this means effectively RCE from MITM with almost no user interaction.\u003c/p\u003e\n\n\u003cp\u003egiven that i think we should consider increasing the bounty yet again. \u003ca href=\"/toml\"\u003e@toml\u003c/a\u003e \u003c/p\u003e\n","automated_response":false,"created_at":"2018-09-26T06:41:13.568Z","updated_at":"2018-09-26T06:41:13.568Z","actor":{"username":"diracdeltas","cleared":false,"url":"/diracdeltas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/115/616/4e2016543ea3e299dcadd088be7d0225de3419e0_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3391080,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"\u003cFROM-#369218\u003e\n\nBy default macOS includes `/System/Library/CoreServices/Photo Library Migration Utility.app/Contents/Frameworks/RedRock.framework/Versions/A/Resources/GooglePlaceSearchV3.html` file.\n\nThis file on the local filesystem requires a Google Maps scripts from the web over `http://`. \nThat's unsafe. MITM =\u003e running own scripts on `file://` and `chrome://brave/` origins.\n\nYeah, so that means an attacker with a MITM access can \"level up\" bugs that requires running scripts on `file:///` origin: like #390362, #375329 and #395737 (this report).\n\nTested on the latest High Sierra.\n\n\u003c/FROM-#369218\u003e\n\n### Attack Scenario (via navigation)\n\n1. User (via copypasting URL or #369218) navigates to `chrome://brave/System/Library/CoreServices/Photo Library Migration Utility.app/Contents/Frameworks/RedRock.framework/Versions/A/Resources/GooglePlaceSearchV3.html` - This file is available in default macOS installation (High Sierra)\n\n2. This HTML file loads Google Maps scripts from `http://maps.googleapis.com/maps/api/js?v=3\u0026client=gme-appleinc\u0026libraries=places\u0026sensor=false`\n\n3. Attacker with MITM access could inject own JS \n\n4. RCE\n\n@diracdeltas, the attack vector via MITMing downloaded HTML files is also great, thanks for pointing.","markdown_message":"\u003cp\u003e\u0026lt;FROM-#369218\u0026gt;\u003c/p\u003e\n\n\u003cp\u003eBy default macOS includes \u003ccode\u003e/System/Library/CoreServices/Photo Library Migration Utility.app/Contents/Frameworks/RedRock.framework/Versions/A/Resources/GooglePlaceSearchV3.html\u003c/code\u003e file.\u003c/p\u003e\n\n\u003cp\u003eThis file on the local filesystem requires a Google Maps scripts from the web over \u003ccode\u003ehttp://\u003c/code\u003e. \u003cbr\u003e\nThat\u0026#39;s unsafe. MITM =\u0026gt; running own scripts on \u003ccode\u003efile://\u003c/code\u003e and \u003ccode\u003echrome://brave/\u003c/code\u003e origins.\u003c/p\u003e\n\n\u003cp\u003eYeah, so that means an attacker with a MITM access can \u0026quot;level up\u0026quot; bugs that requires running scripts on \u003ccode\u003efile:///\u003c/code\u003e origin: like \u003ca href=\"/reports/390362\"\u003e#390362\u003c/a\u003e, \u003ca href=\"/reports/375329\"\u003e#375329\u003c/a\u003e and \u003ca href=\"/reports/395737\"\u003e#395737\u003c/a\u003e (this report).\u003c/p\u003e\n\n\u003cp\u003eTested on the latest High Sierra.\u003c/p\u003e\n\n\u003cp\u003e\u0026lt;/FROM-#369218\u0026gt;\u003c/p\u003e\n\n\u003ch3 id=\"attack-scenario-via-navigation\"\u003eAttack Scenario (via navigation)\u003c/h3\u003e\n\n\u003col\u003e\n\u003cli\u003e\u003cp\u003eUser (via copypasting URL or \u003ca href=\"/reports/369218\"\u003e#369218\u003c/a\u003e) navigates to \u003ccode\u003echrome://brave/System/Library/CoreServices/Photo Library Migration Utility.app/Contents/Frameworks/RedRock.framework/Versions/A/Resources/GooglePlaceSearchV3.html\u003c/code\u003e - This file is available in default macOS installation (High Sierra)\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eThis HTML file loads Google Maps scripts from \u003ccode\u003ehttp://maps.googleapis.com/maps/api/js?v=3\u0026amp;client=gme-appleinc\u0026amp;libraries=places\u0026amp;sensor=false\u003c/code\u003e\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eAttacker with MITM access could inject own JS \u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eRCE\u003c/p\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003e\u003ca href=\"/diracdeltas\"\u003e@diracdeltas\u003c/a\u003e, the attack vector via MITMing downloaded HTML files is also great, thanks for pointing.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-09-26T12:19:44.091Z","updated_at":"2018-09-26T12:20:35.360Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3391244,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@diracdeltas, HTTPS everywhere doesn't work on `file:///`, scripts blocking doesn't work on `file:///`.\nDon't know whether it's a separate issue, but this behavior allows MITMing scripts on `file:///` and `chrome://brave/`.","markdown_message":"\u003cp\u003e\u003ca href=\"/diracdeltas\"\u003e@diracdeltas\u003c/a\u003e, HTTPS everywhere doesn\u0026#39;t work on \u003ccode\u003efile:///\u003c/code\u003e, scripts blocking doesn\u0026#39;t work on \u003ccode\u003efile:///\u003c/code\u003e.\u003cbr\u003e\nDon\u0026#39;t know whether it\u0026#39;s a separate issue, but this behavior allows MITMing scripts on \u003ccode\u003efile:///\u003c/code\u003e and \u003ccode\u003echrome://brave/\u003c/code\u003e.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-09-26T13:12:03.779Z","updated_at":"2018-09-26T13:12:03.779Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3397408,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@diracdeltas \nAlso, check https://hackerone.com/reports/415258#activity-3397382\n\n\\\\--Copypasted from #415258--\\\n## MITM vs HTTPSE\n\n`chrome://brave` is always vulnerable to MITM even when HTTPSE is active\n`file://` is vulnerable to MITM, when HTTPSE is inactive\n\n\u003e As far as I know, HTTPS Everywhere isn't enabled by default.","markdown_message":"\u003cp\u003e\u003ca href=\"/diracdeltas\"\u003e@diracdeltas\u003c/a\u003e \u003cbr\u003e\nAlso, check \u003ca title=\"https://hackerone.com/reports/415258#activity-3397382\" href=\"https://hackerone.com/reports/415258#activity-3397382\"\u003ehttps://hackerone.com/reports/415258#activity-3397382\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e\\--Copypasted from \u003ca href=\"/reports/415258\"\u003e#415258\u003c/a\u003e--\\\u003c/p\u003e\n\n\u003ch2 id=\"mitm-vs-httpse\"\u003eMITM vs HTTPSE\u003c/h2\u003e\n\n\u003cp\u003e\u003ccode\u003echrome://brave\u003c/code\u003e is always vulnerable to MITM even when HTTPSE is active\u003cbr\u003e\n\u003ccode\u003efile://\u003c/code\u003e is vulnerable to MITM, when HTTPSE is inactive\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eAs far as I know, HTTPS Everywhere isn\u0026#39;t enabled by default.\u003c/p\u003e\n\u003c/blockquote\u003e\n","automated_response":false,"created_at":"2018-09-27T15:29:39.951Z","updated_at":"2018-09-27T15:29:39.951Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3397955,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"bumping because of https://hackerone.com/reports/395737#activity-3389639\n\nbtw, HTTPS Everywhere is not supposed to upgrade all HTTP requests even when it is functioning (since not all servers support HTTPS).","markdown_message":"\u003cp\u003ebumping because of \u003ca title=\"https://hackerone.com/reports/395737#activity-3389639\" href=\"https://hackerone.com/reports/395737#activity-3389639\"\u003ehttps://hackerone.com/reports/395737#activity-3389639\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003ebtw, HTTPS Everywhere is not supposed to upgrade all HTTP requests even when it is functioning (since not all servers support HTTPS).\u003c/p\u003e\n","automated_response":false,"created_at":"2018-09-27T17:26:48.431Z","updated_at":"2018-09-27T17:26:48.431Z","actor":{"url":"/brave","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/688/2aad5641af643ee4f4402896e4747293f6e9c5ca_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Brave Software"}},"bounty_amount":"1000.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"brave","collaborator":{"username":"metnew","url":"/metnew"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3397986,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Great!\n\nI've considered the most realistic case involving navigation to `chrome://brave` origin. \nRelying on non-default files is not reasonable, so MITM should occur on `maps.googleapis.com`\nHTTPSE correctly handles `maps.googleapis.com` (probably?).\n\nBut from my observations, it doesn't matter since `chrome://brave` origin is always vulnerable to MITM despite the HTTPSE.\n\n\u003e I guess there is no logic mistake in my assumption","markdown_message":"\u003cp\u003eGreat!\u003c/p\u003e\n\n\u003cp\u003eI\u0026#39;ve considered the most realistic case involving navigation to \u003ccode\u003echrome://brave\u003c/code\u003e origin. \u003cbr\u003e\nRelying on non-default files is not reasonable, so MITM should occur on \u003ccode\u003emaps.googleapis.com\u003c/code\u003e\u003cbr\u003e\nHTTPSE correctly handles \u003ccode\u003emaps.googleapis.com\u003c/code\u003e (probably?).\u003c/p\u003e\n\n\u003cp\u003eBut from my observations, it doesn\u0026#39;t matter since \u003ccode\u003echrome://brave\u003c/code\u003e origin is always vulnerable to MITM despite the HTTPSE.\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eI guess there is no logic mistake in my assumption\u003c/p\u003e\n\u003c/blockquote\u003e\n","automated_response":false,"created_at":"2018-09-27T17:33:15.496Z","updated_at":"2018-09-27T17:34:49.527Z","actor":{"username":"metnew","cleared":true,"url":"/metnew","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/544/baa5f77ccb2413a76bf96b3253ba88024ab50a33_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}