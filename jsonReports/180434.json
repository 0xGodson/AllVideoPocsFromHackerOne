{"id":180434,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xODA0MzQ=","url":"https://hackerone.com/reports/180434","title":"cURL / libcURL - CVE-2016-8624 invalid URL parsing with '#'","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2016-11-05T21:31:51.393Z","submitted_at":"2016-11-05T21:31:51.393Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"fms","url":"/fms","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":21653,"url":"https://hackerone.com/ibb-data","handle":"ibb-data","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/021/653/2abb8bf772c4bddda91f5a4744e4b7e74c88675d_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/021/653/2abb8bf772c4bddda91f5a4744e4b7e74c88675d_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Data Processing (IBB)","twitter_handle":"","website":"","about":""}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":["CVE-2016-8624"],"singular_disclosure_disabled":false,"disclosed_at":"2018-01-11T20:41:15.192Z","bug_reporter_agreed_on_going_public_at":"2017-12-12T20:41:12.280Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"invalid URL parsing with '#'\n============================\n\nProject cURL Security Advisory, November 2, 2016 -\n[Permalink] https://curl.haxx.se/docs/adv_20161102J.html\n\nVULNERABILITY\n-------------\n\ncurl doesn't parse the authority component of the URL correctly when the host\nname part ends with a '#' character, and could instead be tricked into\nconnecting to a different host. This may have security implications if you for\nexample use a URL parser that follows the RFC to check for allowed domains\nbefore using curl to request them.\n\nPassing in `http://example.com#@evil.com/x.txt` would wrongly make curl send a\nrequest to evil.com while your browser would connect to example.com given the\nsame URL.\n\nThe problem exists for most protocol schemes.\n\nWe are not aware of any exploit of this flaw.\n\nINFO\n----\n\nThe Common Vulnerabilities and Exposures (CVE) project has assigned the name\nCVE-2016-8624 to this issue.\n\nAFFECTED VERSIONS\n-----------------\n\nThis flaw exists in the following curl versions.\n\n- Affected versions: curl 7.1 to and including 7.50.3\n- Not affected versions: curl \u003e= 7.51.0\n\nlibcurl is used by many applications, but not always advertised as such!\n\nTHE SOLUTION\n------------\n\nIn version 7.51.0, the parser function is fixed.\n\nA [patch for CVE-2016-8624](https://curl.haxx.se/CVE-2016-8624.patch) is\navailable.\n\nRECOMMENDATIONS\n---------------\n\nWe suggest you take one of the following actions immediately, in order of\npreference:\n\n A - Upgrade curl and libcurl to version 7.51.0\n\n B - Apply the patch to your version and rebuild\n\n C - Strip out the parts of the URLs containing '#' before passing them to curl\n\nTIME LINE\n---------\n\nIt was first reported to the curl project on October 10 by Fernando Mu単oz.\n\nWe contacted distros@openwall on October 19.\n\ncurl 7.51.0 was released on November 2 2016, coordinated with the publication\nof this advisory.\n\nCREDITS\n-------\n\nThanks to Fernando Mu単oz!","vulnerability_information_html":"\u003ch1 id=\"invalid-url-parsing-with\"\u003einvalid URL parsing with \u0026#39;#\u0026#39;\u003c/h1\u003e\n\n\u003cp\u003eProject cURL Security Advisory, November 2, 2016 -\u003cbr\u003e\n[Permalink] \u003ca title=\"https://curl.haxx.se/docs/adv_20161102J.html\" href=\"/redirect?url=https%3A%2F%2Fcurl.haxx.se%2Fdocs%2Fadv_20161102J.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://curl.haxx.se/docs/adv_20161102J.html\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2 id=\"vulnerability\"\u003eVULNERABILITY\u003c/h2\u003e\n\n\u003cp\u003ecurl doesn\u0026#39;t parse the authority component of the URL correctly when the host\u003cbr\u003e\nname part ends with a \u0026#39;#\u0026#39; character, and could instead be tricked into\u003cbr\u003e\nconnecting to a different host. This may have security implications if you for\u003cbr\u003e\nexample use a URL parser that follows the RFC to check for allowed domains\u003cbr\u003e\nbefore using curl to request them.\u003c/p\u003e\n\n\u003cp\u003ePassing in \u003ccode\u003ehttp://example.com#@evil.com/x.txt\u003c/code\u003e would wrongly make curl send a\u003cbr\u003e\nrequest to evil.com while your browser would connect to example.com given the\u003cbr\u003e\nsame URL.\u003c/p\u003e\n\n\u003cp\u003eThe problem exists for most protocol schemes.\u003c/p\u003e\n\n\u003cp\u003eWe are not aware of any exploit of this flaw.\u003c/p\u003e\n\n\u003ch2 id=\"info\"\u003eINFO\u003c/h2\u003e\n\n\u003cp\u003eThe Common Vulnerabilities and Exposures (CVE) project has assigned the name\u003cbr\u003e\nCVE-2016-8624 to this issue.\u003c/p\u003e\n\n\u003ch2 id=\"affected-versions\"\u003eAFFECTED VERSIONS\u003c/h2\u003e\n\n\u003cp\u003eThis flaw exists in the following curl versions.\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eAffected versions: curl 7.1 to and including 7.50.3\u003c/li\u003e\n\u003cli\u003eNot affected versions: curl \u0026gt;= 7.51.0\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003elibcurl is used by many applications, but not always advertised as such!\u003c/p\u003e\n\n\u003ch2 id=\"the-solution\"\u003eTHE SOLUTION\u003c/h2\u003e\n\n\u003cp\u003eIn version 7.51.0, the parser function is fixed.\u003c/p\u003e\n\n\u003cp\u003eA \u003ca href=\"/redirect?url=https%3A%2F%2Fcurl.haxx.se%2FCVE-2016-8624.patch\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003epatch for CVE-2016-8624\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e is\u003cbr\u003e\navailable.\u003c/p\u003e\n\n\u003ch2 id=\"recommendations\"\u003eRECOMMENDATIONS\u003c/h2\u003e\n\n\u003cp\u003eWe suggest you take one of the following actions immediately, in order of\u003cbr\u003e\npreference:\u003c/p\u003e\n\n\u003cp\u003eA - Upgrade curl and libcurl to version 7.51.0\u003c/p\u003e\n\n\u003cp\u003eB - Apply the patch to your version and rebuild\u003c/p\u003e\n\n\u003cp\u003eC - Strip out the parts of the URLs containing \u0026#39;#\u0026#39; before passing them to curl\u003c/p\u003e\n\n\u003ch2 id=\"time-line\"\u003eTIME LINE\u003c/h2\u003e\n\n\u003cp\u003eIt was first reported to the curl project on October 10 by Fernando Mu単oz.\u003c/p\u003e\n\n\u003cp\u003eWe contacted distros@openwall on October 19.\u003c/p\u003e\n\n\u003cp\u003ecurl 7.51.0 was released on November 2 2016, coordinated with the publication\u003cbr\u003e\nof this advisory.\u003c/p\u003e\n\n\u003ch2 id=\"credits\"\u003eCREDITS\u003c/h2\u003e\n\n\u003cp\u003eThanks to Fernando Mu単oz!\u003c/p\u003e\n","bounty_amount":"500.0","formatted_bounty":"$500","weakness":{"id":68,"name":"Server-Side Request Forgery (SSRF)"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2018-01-11T20:41:12.343Z","allow_singular_disclosure_after":-93513827.37935343,"singular_disclosure_allowed":true,"vote_count":9,"voters":["eveeez","geeknik","m7mdharoun","cr4xerbik4sh","japz","ghafoorka_larka","peterrollins","falcononrails","hackera"],"severity":{"rating":"medium","score":6.5,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"none","user_interaction":"none","scope":"unchanged","confidentiality":"low","integrity":"low","availability":"none"}},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1557931,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello, is there any update about this issue? Thanks!","markdown_message":"\u003cp\u003eHello, is there any update about this issue? Thanks!\u003c/p\u003e\n","automated_response":false,"created_at":"2017-03-22T19:26:14.944Z","updated_at":"2017-03-22T19:26:14.944Z","actor":{"username":"fms","cleared":false,"url":"/fms","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ibb-data","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1878507,"is_internal":false,"editable":false,"type":"Activities::HackerRequestedMediation","message":"4 months since I asked about an update and no response.\n9 months since this was first reported and no response.","markdown_message":"\u003cp\u003e4 months since I asked about an update and no response.\u003cbr\u003e\n9 months since this was first reported and no response.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-07-30T22:18:27.905Z","updated_at":"2017-07-30T22:18:27.905Z","actor":{"username":"fms","cleared":false,"url":"/fms","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ibb-data","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2216195,"is_internal":false,"editable":false,"type":"Activities::ReassignedToTeam","message":"","markdown_message":"","automated_response":false,"created_at":"2017-12-12T06:17:24.332Z","updated_at":"2017-12-12T06:17:24.332Z","additional_data":{"old_team":"The Internet","new_team":"Data Processing (IBB)"},"actor":{"username":"arice","cleared":false,"url":"/arice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/83152cb2d070f3f6a63c1b61bae47257722b5ad2_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"ibb-data","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2216517,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2017-12-12T07:07:31.946Z","updated_at":"2017-12-12T07:07:31.946Z","additional_data":{"old_severity":"Medium","new_severity":"Medium (6.5)","old_severity_id":6191,"new_severity_id":101081},"actor":{"username":"arice","cleared":false,"url":"/arice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/83152cb2d070f3f6a63c1b61bae47257722b5ad2_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"ibb-data","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2216518,"is_internal":false,"editable":false,"type":"Activities::CveIdAdded","message":"","markdown_message":"","automated_response":false,"created_at":"2017-12-12T07:07:56.501Z","updated_at":"2017-12-12T07:07:56.501Z","cve_ids":["CVE-2016-8624"],"actor":{"username":"arice","cleared":false,"url":"/arice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/83152cb2d070f3f6a63c1b61bae47257722b5ad2_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"ibb-data","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2216519,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2017-12-12T07:08:02.303Z","updated_at":"2017-12-12T07:08:02.303Z","actor":{"url":"/ibb-data","ibb":true,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/021/653/2abb8bf772c4bddda91f5a4744e4b7e74c88675d_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Data Processing (IBB)"}},"bounty_amount":"500.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"ibb-data","collaborator":{"username":"fms","url":"/fms"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2216520,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2017-12-12T07:08:13.682Z","updated_at":"2017-12-12T07:08:13.682Z","actor":{"username":"arice","cleared":false,"url":"/arice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/83152cb2d070f3f6a63c1b61bae47257722b5ad2_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"reporter":{"username":"fms","url":"/fms"},"genius_execution_id":null,"team_handle":"ibb-data","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2218391,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Thanks.","markdown_message":"\u003cp\u003eThanks.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-12-12T20:41:12.303Z","updated_at":"2017-12-12T20:41:12.303Z","first_to_agree":true,"actor":{"username":"fms","cleared":false,"url":"/fms","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ibb-data","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2278757,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-01-11T20:41:15.212Z","updated_at":"2018-01-11T20:41:15.212Z","actor":{"url":"/ibb-data","ibb":true,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/021/653/2abb8bf772c4bddda91f5a4744e4b7e74c88675d_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Data Processing (IBB)"}},"genius_execution_id":null,"team_handle":"ibb-data","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}