{"id":121489,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMjE0ODk=","url":"https://hackerone.com/reports/121489","title":"CRLF injection in https://verkkopalvelu.lahitapiola.fi/","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-03-08T22:19:06.486Z","submitted_at":"2016-03-08T22:19:06.486Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"derision","url":"/derision","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/016/130/200df763f2337b959a1c2f28b7f74e91fd09c63e_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":8416,"url":"https://hackerone.com/localtapiola","handle":"localtapiola","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/008/416/b6fbd7e94497b0ffaee584d2e7096c5d5e2082e2_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/416/b6fbd7e94497b0ffaee584d2e7096c5d5e2082e2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"LocalTapiola","twitter_handle":"","website":"http://www.lahitapiola.fi","about":"LocalTapiolaâ€™s products and services cover non-life, life and pension insurance, as well as investment and saving services."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2016-09-29T20:55:58.028Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2016-08-30T20:55:46.687Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi there,\n\nThere is an HTTP header injection on https://verkkopalvelu.lahitapiola.fi/a6/VerkkokauppaYTWAR/YT/Etusivu.jsf it allow an attacker to set custom cookies and custom content (such as XSS attack) within the response.\n\n**PoC:**\n\nThe parameter `p` is vulnerable.\n\nhttps://verkkopalvelu.lahitapiola.fi/a6/VerkkokauppaYTWAR/YT/Etusivu.jsf?productMode=YT\u0026locale=fi\u0026ltapp=LT_Yksityistapaturmalaskuri\u0026p=1412889500323ew2du7e081azeza%22%27%3E%3C%0D%0A+%0D%0A+%3Csvg/onload=alert%28document.domain%29%3E\u0026selectedLanguage=fi\u0026selectedArea=\n\nScreen: CRLF_poc.png\n\n\n\n","vulnerability_information_html":"\u003cp\u003eHi there,\u003c/p\u003e\n\n\u003cp\u003eThere is an HTTP header injection on \u003ca title=\"https://verkkopalvelu.lahitapiola.fi/a6/VerkkokauppaYTWAR/YT/Etusivu.jsf\" href=\"/redirect?url=https%3A%2F%2Fverkkopalvelu.lahitapiola.fi%2Fa6%2FVerkkokauppaYTWAR%2FYT%2FEtusivu.jsf\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://verkkopalvelu.lahitapiola.fi/a6/VerkkokauppaYTWAR/YT/Etusivu.jsf\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e it allow an attacker to set custom cookies and custom content (such as XSS attack) within the response.\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003ePoC:\u003c/strong\u003e\u003c/p\u003e\n\n\u003cp\u003eThe parameter \u003ccode\u003ep\u003c/code\u003e is vulnerable.\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"https://verkkopalvelu.lahitapiola.fi/a6/VerkkokauppaYTWAR/YT/Etusivu.jsf?productMode=YT\u0026amp;locale=fi\u0026amp;ltapp=LT_Yksityistapaturmalaskuri\u0026amp;p=1412889500323ew2du7e081azeza%22%27%3E%3C%0D%0A+%0D%0A+%3Csvg/onload=alert%28document.domain%29%3E\u0026amp;selectedLanguage=fi\u0026amp;selectedArea=\" href=\"/redirect?url=https%3A%2F%2Fverkkopalvelu.lahitapiola.fi%2Fa6%2FVerkkokauppaYTWAR%2FYT%2FEtusivu.jsf%3FproductMode%3DYT%26locale%3Dfi%26ltapp%3DLT_Yksityistapaturmalaskuri%26p%3D1412889500323ew2du7e081azeza%2522%2527%253E%253C%250D%250A%2B%250D%250A%2B%253Csvg%2Fonload%3Dalert%2528document.domain%2529%253E%26selectedLanguage%3Dfi%26selectedArea%3D\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://verkkopalvelu.lahitapiola.fi/a6/VerkkokauppaYTWAR/YT/Etusivu.jsf?productMode=YT\u0026amp;locale=fi\u0026amp;ltapp=LT_Yksityistapaturmalaskuri\u0026amp;p=1412889500323ew2du7e081azeza%22%27%3E%3C%0D%0A+%0D%0A+%3Csvg/onload=alert%28document.domain%29%3E\u0026amp;selectedLanguage=fi\u0026amp;selectedArea=\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eScreen: CRLF_poc.png\u003c/p\u003e\n","bounty_amount":"400.0","formatted_bounty":"$400","original_report_id":null,"original_report_url":null,"attachments":[{"id":77338,"file_name":"CRLF_poc.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/077/338/a9cb0bb6787a2cb0ac1059021211fd37ee91e4f2/CRLF_poc.png?response-content-disposition=attachment%3B%20filename%3D%22CRLF_poc.png%22%3B%20filename%2A%3DUTF-8%27%27CRLF_poc.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQVN4C5GIR%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T042048Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCICjdrX7ABZ%2BvfX76vY4hAT36HAFa7ABTRFnFNWlME3RsAiA6spUqHGGbpGIJMpDYYPRLrN21uLj3JvPgDLV04KLXWCq0AwhSEAEaDDAxMzYxOTI3NDg0OSIM%2BwbYtZgzO0HRNuilKpED0QRzghA3dQ82LDNvNHg%2F%2Bapjkbzzquj0OQyaslf6lhZ6ae5aaEALaU1htc90%2FTkEnCjK7YAB%2BOOqYauHnXFwgnicH8P2qB1b6qq8ByPdiyv%2F6FeKLaeKEKd1ked0wxhxGILfvv9geWvP9kPkCkrnpW%2Bk3I2nWFhXQ59oSwcUQzXUMoZ0agtptlqAo0vIB0BQ8w3QdM1eyZALy%2Fa2aEoAk0NEEkFhGgVq6y7NSlne0HYNYsnTubU1gtBiWgKFN75WWxAKzP41DZr9biaTv2LpKz%2BS54%2B0D7gM01Pv9DWNFSxduldCjFNWMHaz53TpINKZivByzZ%2FZritkdAHNoYR8NUHdDo4fG9KADtaMgItKYoCYS9dQ3VQKUnEB%2FG5XIqiEWJNuiVPw9Xo1zZJ7ItciKJ%2F2lZOYbSY5IWLtOLK3LAXfBln%2BqWM6KN%2BYSgAqj80OMMoKJozuCJRCLPgT%2BsuXVxgkfPMjWm0msUwRdOuNqAG3PPIFx7Qi20ur1fS33s63LIR24RY3pe1aeEm14DkixQAwqvyp%2FwU67AFUTZKxgkosuC9%2FFnLTDWAcFKkGbWeTSyQlX9WvARJtmEGSKKE3O3RCz4o1fvK2y8cIWG4ZDqIQnnY30DkA5lvQ1S96196eUcIlxUE3IU6WzlYzirsAJvCXzxdcKxl0gn59sA3vLFJkUTgoas7IMyJTtRG6%2B0%2BVBuYKCHqJR1eTwSQxZvSP%2Bzn9VyHRQJZnA1hWcpkteF706gKj%2FXnieX9VW%2FOBOoEUExU1kfEmA0ZpoQRXSm8ma7vzsQoYhwoevAvKutaOvkhM8WM71tgT1%2FjC27FmA%2F%2FsDsAjQs2Rv9IujFElYACO0n6OSheOZw%3D%3D\u0026X-Amz-Signature=213fe44878505f585f75357cc94675871ae1d1e1e68230cfa72446ca4299bf1f","file_size":129988,"type":"image/png"}],"allow_singular_disclosure_at":"2016-09-29T20:55:46.803Z","allow_singular_disclosure_after":-134033101.35426292,"singular_disclosure_allowed":true,"vote_count":10,"voters":["samux","thisishrsh","bugdiscloseguys","powerjacobb1","jens","bb00x","sumit7","spetr0x","nigba","dyabla"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":829894,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Please note that the `selectedArea` parameter is also vulnerable to the same attack.","markdown_message":"\u003cp\u003ePlease note that the \u003ccode\u003eselectedArea\u003c/code\u003e parameter is also vulnerable to the same attack.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-03-08T22:23:56.325Z","updated_at":"2016-03-08T22:23:56.325Z","actor":{"username":"derision","cleared":false,"url":"/derision","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/130/200df763f2337b959a1c2f28b7f74e91fd09c63e_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":840116,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"This finding is valid. We are currently looking into the business impacts to decide on further actions.","markdown_message":"\u003cp\u003eThis finding is valid. We are currently looking into the business impacts to decide on further actions.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-03-15T07:10:08.149Z","updated_at":"2016-03-15T07:10:08.149Z","actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":898056,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @derision - a short status update. We have had \"pre-h1-bugbounty\" reports on similar issues (partially same parameters) and we are looking into both upcoming fixes already in line as well as other reports - hence processing is taking a little longer than usual. ","markdown_message":"\u003cp\u003eHi \u003ca href=\"/derision\"\u003e@derision\u003c/a\u003e - a short status update. We have had \u0026quot;pre-h1-bugbounty\u0026quot; reports on similar issues (partially same parameters) and we are looking into both upcoming fixes already in line as well as other reports - hence processing is taking a little longer than usual. \u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-10T10:14:12.282Z","updated_at":"2016-04-10T10:14:12.282Z","actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":953002,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Hi @derision. There are some issues in fixing this, and due to this the full fix will not be in for many months to come. For this reason, we have decided to award you with at 400$ bounty now, without closing the report. There will be no disclosure until the fix is out.","markdown_message":"\u003cp\u003eHi \u003ca href=\"/derision\"\u003e@derision\u003c/a\u003e. There are some issues in fixing this, and due to this the full fix will not be in for many months to come. For this reason, we have decided to award you with at 400$ bounty now, without closing the report. There will be no disclosure until the fix is out.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-05-12T12:07:01.968Z","updated_at":"2016-05-12T12:07:01.968Z","actor":{"url":"/localtapiola","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/416/b6fbd7e94497b0ffaee584d2e7096c5d5e2082e2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"LocalTapiola"}},"bounty_amount":"400.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"localtapiola","collaborator":{"username":"derision","url":"/derision"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":953018,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I agree on this, thank you.","markdown_message":"\u003cp\u003eI agree on this, thank you.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-05-12T12:14:32.859Z","updated_at":"2016-05-12T12:14:32.859Z","actor":{"username":"derision","cleared":false,"url":"/derision","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/130/200df763f2337b959a1c2f28b7f74e91fd09c63e_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":953025,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for your effort and understanding.","markdown_message":"\u003cp\u003eThanks for your effort and understanding.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-05-12T12:17:19.271Z","updated_at":"2016-05-12T12:17:19.271Z","actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1163006,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi, could you please verify that this is now fully fixed from your point of view. If yes, then we will go ahead and close this one.","markdown_message":"\u003cp\u003eHi, could you please verify that this is now fully fixed from your point of view. If yes, then we will go ahead and close this one.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-30T18:37:59.401Z","updated_at":"2016-08-30T18:37:59.401Z","actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1163106,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @localtapiola-thomas, this issue seems to be fully fixed for me.","markdown_message":"\u003cp\u003eHi \u003ca href=\"/localtapiola-thomas\"\u003e@localtapiola-thomas\u003c/a\u003e, this issue seems to be fully fixed for me.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-30T19:06:27.862Z","updated_at":"2016-08-30T19:06:27.862Z","actor":{"username":"derision","cleared":false,"url":"/derision","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/130/200df763f2337b959a1c2f28b7f74e91fd09c63e_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1163363,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks for your efforts, we will close the report now.","markdown_message":"\u003cp\u003eThanks for your efforts, we will close the report now.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-30T20:55:00.625Z","updated_at":"2016-08-30T20:55:00.625Z","actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"derision","url":"/derision"},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1163367,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Requesting full disclosure.","markdown_message":"\u003cp\u003eRequesting full disclosure.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-30T20:55:46.717Z","updated_at":"2016-08-30T20:55:46.717Z","first_to_agree":true,"actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1224577,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-09-29T20:55:58.108Z","updated_at":"2016-09-29T20:55:58.108Z","actor":{"url":"/localtapiola","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/416/b6fbd7e94497b0ffaee584d2e7096c5d5e2082e2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"LocalTapiola"}},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":2486,"category":"team","content":"##Issue\n\nThe reporter was able to inject http-headers to set custom cookies and custom content (such as as XSS attack) within the response.  The report contained a thorough PoC and appropriate screenshots which assisted the triaging process.\n\n##Fix\n\nThe issue was investigated and found to be valid. The final fix was partly dependent on other fixes.\n\n##Reasoning\n\nThe reported case was valid and within the scope of the bug bounty program. The issue was fixed and the reporter was awarded with a bounty. There were some cross-dependencies with other fixes which led to a postponed disclosure.\n","can_view?":true,"can_edit?":false,"content_html":"\u003ch2 id=\"issue\"\u003eIssue\u003c/h2\u003e\n\n\u003cp\u003eThe reporter was able to inject http-headers to set custom cookies and custom content (such as as XSS attack) within the response.  The report contained a thorough PoC and appropriate screenshots which assisted the triaging process.\u003c/p\u003e\n\n\u003ch2 id=\"fix\"\u003eFix\u003c/h2\u003e\n\n\u003cp\u003eThe issue was investigated and found to be valid. The final fix was partly dependent on other fixes.\u003c/p\u003e\n\n\u003ch2 id=\"reasoning\"\u003eReasoning\u003c/h2\u003e\n\n\u003cp\u003eThe reported case was valid and within the scope of the bug bounty program. The issue was fixed and the reporter was awarded with a bounty. There were some cross-dependencies with other fixes which led to a postponed disclosure.\u003c/p\u003e\n"},{"category":"researcher","can_view?":true,"can_create?":false}]}