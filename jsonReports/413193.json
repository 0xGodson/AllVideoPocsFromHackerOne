{"id":413193,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC80MTMxOTM=","url":"https://hackerone.com/reports/413193","title":"Directory Traversal + HTTP Paramater Pollution leaking SQL/LDAP credentials","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2018-07-17T22:25:59.000Z","submitted_at":"2018-07-17T22:25:59.000Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"bitst0rm","url":"/bitst0rm","profile_picture_urls":{"small":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/2z69a32onqpe873npgt8qfvc7evl/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a?response-content-disposition=inline%3B%20filename%3D%2220201202_035620.jpg%22%3B%20filename%2A%3DUTF-8%27%2720201202_035620.jpg\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQVBWWKZ4H%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T055356Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCmEbZvVQ%2FI1GHRJjrhZK2Y6zh4lCWK725%2FwOpNu%2BnZkAIhAIZlqGHog%2B4PZMdnvhSU5APZbycPDz1wpNXbi5uE94ueKrQDCFUQARoMMDEzNjE5Mjc0ODQ5IgxU5AAHhqo1cPAzbTcqkQOGB5pEHXl6QCBCTSHUmyd%2FF8M3rpTqzp%2BOigrWU%2BrXYHZYm%2BGDawsiXhnqeD9o8Qw0b%2Fr0efVbRmhj5baoPrxgSiY%2B9zsreR3qClZZKnS0%2Brs8OqiMGd3clBbyfOxw2fa2vgQglV4dLF6EXSiGfxOms8eWdw%2F8mPtc81dMxDIlxTs50KUnd6aUjgG5BJs2k%2FL0rOKXYBS%2FdVqIQdN8JcCKMvqDv0u7pvSGEecQXa7pGdf07ufO02E64eU0OnaTeNyoq7WlZzT%2FGyvHjVtIvbXdPW15pwZm2Q4u8%2FW7ksSv4%2BxsESWLLCop0OeGUhtIppCDQlaMPC9JTj0HYKbMEGmZagmLfgHX4DKRg75%2FLNQViGcE%2FRCCaMxd6wrsv0dlz4dekjWvp4mXzLFkuKBM6c%2F%2BAemkmkgOJKnp%2FJUV1zJTe%2BO14GyIigsvxJqvrnKvkmsUrYwar1bX%2Be7UkqGzVbMAlsbRDNIOok7bVRXerhpXnbqFQsLWlqe%2BNfa4gSSfmgu4iIjCRRMdTWsvy2NQHfTsGjDAzar%2FBTrqAcniMm3eG7%2BxDZb9XVqMyQiSNyiuBD8pwO78bO8T3Uu8vSI3S05C6UCutmNkOnjR9D2NZaOgbFO4YujbW%2FY0mhhdjSppvg%2Bzdgu0AfZOou0DDwqm4vwEc0ekiNYUD6KHvD5tZwOaalihV5dSfbzoDyvfsJI6x7RYpBZmwPcshKw3Csz0uZew1JqrbUJVmc9v6q0aXols8bxyDKKPfp6siyzKhHELgTS3XGskds%2BWx5FaWemc%2Bo8QqyIuoOtWjmUwF39ydFOfg%2FyeKdwBxELGLKCSN8MyV6ov7IBrib4UiM%2F6l36ymDoHIX8ohg%3D%3D\u0026X-Amz-Signature=3e77c0c2caa807a1063c9374a27b97562d5f91d6bfdaa80e1afc6ad78c69d52a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":33392,"url":"https://hackerone.com/soleo","handle":"soleo","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/033/392/19f5cb0509cf0e76732f84729a7ceee9485d1a7c_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/033/392/19f5cb0509cf0e76732f84729a7ceee9485d1a7c_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"profile":{"name":"Soleo","twitter_handle":"","website":"https://www.soleo.com/","about":""}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":true,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2018-09-24T16:28:03.288Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":null,"comments_closed?":true,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Upon visiting the login page of a provider’s IP Relay client, we noticed that if someone were to click the “forgot password” link, it would bring them to a URL which appeared as the following: \n\n`https://\u003chost\u003e.\u003ctld\u003e/IPRelayApp/servlet/IPRelay?page=forgotPassword`\n\nWhen attempting to modify the \"page\" GET parameter, a .jsp extension was appended to the inputted value, preventing File Disclosure from taking place. Use of nullbytes to bypass this extension being appended was an unlikely option, so we turned to HTTP parameter poisoning. By including a trailing question mark on the file name, we were able to fool the server\ninto thinking it was about to receive a parameter, effectively truncating the trailing `.jsp` extension, like so:\n\n`https://\u003chost\u003e/IPRelayApp/servlet/IPRelay?page=anyfile.txt?`\n\nAttempting Local File Disclosure resulted in an error, but File Disclosure itself was still an option - the web-app is restricted to only loading files from within a certain directory. This limits us to only loading files within `IPRelayApp/*`. In this scenario, this is what the directory layout looked like, thanks to Tomcat:\n\n`IPRelayApp/\n  |- jsp/\n  |- images/\n  |- html/\n  |- META-INF/\n  |- WEB-INF/\n\t|- classes/\n        |- help/\n        |- logs/\n        |- lib/\n        |- xml/\n        |- files/\n        |- web.xml`\n\nThe `WEB-INF` directory is within the IPRelayApp directory, meaning we could load `web.xml`, an XML document that has a few mappings for Tomcat to understand where to pull certain files from. Attached is proof of the file getting loaded. Here is what the proof-of-concept would look like by this point:\n\n`http://\u003chost\u003e/IPRelayApp/servlet/IPRelay?page=../WEB-INF/web.xml?`\n\nAt this point, we wrote a little proof-of-concept to parse the web.xml file and find the location of the source files. This was purely to confirm the severity of this vulnerability. This was the output of our script:\n\n`[+] connecting to \u003credacted\u003e\nsrc file found @ 'com/soleo/iprelayweb/common/filters/LoggedInFilter.class'\nsrc file found @ 'com/soleo/iprelayweb/common/filters/RedirectionFilter.class'\nsrc file found @ 'com/soleo/iprelayweb/common/filters/HostnameFilter.class'\nsrc file found @ 'com/soleo/iprelayweb/common/filters/SetHeadersFilter.class'\nsrc file found @ 'com/soleo/iprelayweb/common/filters/SetHeadersFilter.class'\nsrc file found @ 'com/soleo/iprelayapp/filters/ChangePasswordFilter.class'\nsrc file found @ 'com/soleo/iprelayweb/common/filters/EncodingFilter.class'\nsrc file found @\n'com/soleo/iprelayapp/filters/PasswordChangeRestrictionFilter.class'\nsrc file found @ 'com/soleo/iprelayapp/filters/SSORedirectFilter.class'\nsrc file found @ 'com/soleo/iprelayapp/common/ContextListener.class'\nsrc file found @ 'com/soleo/iprelayapp/servlets/LoginServlet.class'\nsrc file found @ 'com/soleo/iprelayapp/servlets/SoleoInteractionServlet.class'\nsrc file found @ 'com/soleo/iprelayapp/servlets/CreateUserServlet.class'\nsrc file found @ 'com/soleo/iprelayapp/servlets/CreateCDRServlet.class'\nsrc file found @ 'com/soleo/iprelayapp/servlets/FindSecurityQuestionServlet.class'\nsrc file found @ 'com/soleo/iprelayapp/servlets/ChangePasswordServlet.class'\nsrc file found @ 'com/soleo/iprelayapp/servlets/VerifyAccountServlet.class'\nsrc file found @ 'com/soleo/iprelayapp/servlets/GenerateIPRelayPageServlet.class'\nsrc file found @ 'com/soleo/iprelayapp/servlets/ProfilePageServlet.class'\nsrc file found @ 'com/soleo/iprelayapp/servlets/ProfileServlet.class'\nsrc file found @ 'com/soleo/iprelayapp/servlets/PreferencesPageServlet.class'\nsrc file found @ 'com/soleo/iprelayapp/servlets/RegistrationPageServlet.class'\nsrc file found @ 'com/soleo/iprelayapp/servlets/WelcomeServlet.class'\nsrc file found @ 'com/soleo/iprelayapp/servlets/LogoutServlet.class'\nsrc file found @ 'com/soleo/iprelayapp/servlets/UpdateProfileServlet.class'\nsrc file found @ 'com/soleo/iprelayapp/servlets/UpdatePreferencesServlet.class'\nsrc file found @ 'com/soleo/iprelayapp/servlets/ValidateIPUserStatusServlet.class'\nsrc file found @ 'com/soleo/iprelayapp/servlets/OfflineMessageServlet.class'\nsrc file found @ 'com/soleo/iprelayapp/servlets/AddressBookServlet.class'\nsrc file found @ 'com/soleo/iprelayapp/servlets/SaveIPConversationServlet.class'\nsrc file found @ 'com/soleo/iprelayapp/servlets/SessionPingServlet.class'\nsrc file found @ 'com/soleo/iprelayweb/common/servlet/PingServlet.class'\nsrc file found @ 'com/soleo/iprelayweb/common/servlet/Skinner.class'\nsrc file found @ 'com/soleo/iprelayapp/servlets/FinishLoginServlet.class'\nsrc file found @ 'com/soleo/iprelayapp/servlets/SSOEntryServlet.class'\nsrc file found @ 'com/soleo/iprelayapp/servlets/ShibbolethErrorServlet.class'\nsrc file found @ 'com/soleo/iprelayapp/servlets/MakeCallServlet.class'\nsrc file found @ 'com/soleo/iprelayapp/servlets/ChangeOperatingLanguage.class'`\n\nAll of the following files can be downloaded by loading them from `WEB-INF/classes/*`.  Once again, to confirm severity, we tried to load one of these files, specifically `IPRelay.class` - the attached image shows the file being successfully downloaded.\n\nAfter loading this file into our text editor, it was evident that these classes had been compiled in Java bytecode. However, a determined attacker would easily be able to convert this directly back to source, compromising source code and other sensitive files. Within the source code lies passwords which allow the servlet to communicate with other services, such as SQL/LDAP. An attacker could extract these passwords from within the source files, and further escalate their privileges on the server, or even use said information in a social engineering attack. The end result could be escalated to yield remote code execution, though we were not comfortable attempting to do this before getting in contact with the vendor. Attached you can find a `.class` file which leads to sensitive Information Disclosure.\n\nEssentially every Internet Service Provider in Canada uses Soleo’s IP Relay service. This was not an initial discovery however upon further analysis the impact of this vulnerability kept increasing. By utilizing Google dorks, we were able to determine that there were at least ​ten ​other Internet Service Providers in Canada that wererunning the same vulnerable instance of Soleo’s IP Relay. Interestingly enough six out of the ten vulnerable ISPs were actually the largest telecom providers in Canada.\n\nTo conclude this report, we have confirmed that a determined attacker (APT/foreign entity) could leverage this vulnerability to steal passwords from configuration files across multiple providers, compromise said providers using the stolen passwords, and then ​potentially​ launch a large scale identity theft operation against Canadians. Seeing as Canada’s federal elections are coming up in 2019, this vulnerability could have had detrimental effects for Canadian citizens who confide in these providers to safeguard their identity. Due to our concerns about the social security of Canadian citizens, we decided to compile a list of the providers that were affected by this vulnerability. In total this can ultimately lead to the compromise of over 30 million Canadian records. Here are some major providers that were affected:\n\n`Bell\nSasktel\nTelus\nShaw\nVideotron\nMTS\nRogers (their services are hosted at iprelayservice.net)\nBell Aliant\nCogeco\nFido (their services are hosted at iprelayservice.net)\nKoodo (their services are hosted at iprelayservice.net)\nChatr (their services are hosted at iprelayservice.net)\nAllStream\nEastLink`\n\nThis flaw was remediated on 10th August 2018, roughly three weeks after our initial disclosure.\n\n\n\n","vulnerability_information_html":"\u003cp\u003eUpon visiting the login page of a provider’s IP Relay client, we noticed that if someone were to click the “forgot password” link, it would bring them to a URL which appeared as the following: \u003c/p\u003e\n\n\u003cp\u003e\u003ccode\u003ehttps://\u0026lt;host\u0026gt;.\u0026lt;tld\u0026gt;/IPRelayApp/servlet/IPRelay?page=forgotPassword\u003c/code\u003e\u003c/p\u003e\n\n\u003cp\u003eWhen attempting to modify the \u0026quot;page\u0026quot; GET parameter, a .jsp extension was appended to the inputted value, preventing File Disclosure from taking place. Use of nullbytes to bypass this extension being appended was an unlikely option, so we turned to HTTP parameter poisoning. By including a trailing question mark on the file name, we were able to fool the server\u003cbr\u003e\ninto thinking it was about to receive a parameter, effectively truncating the trailing \u003ccode\u003e.jsp\u003c/code\u003e extension, like so:\u003c/p\u003e\n\n\u003cp\u003e\u003ccode\u003ehttps://\u0026lt;host\u0026gt;/IPRelayApp/servlet/IPRelay?page=anyfile.txt?\u003c/code\u003e\u003c/p\u003e\n\n\u003cp\u003eAttempting Local File Disclosure resulted in an error, but File Disclosure itself was still an option - the web-app is restricted to only loading files from within a certain directory. This limits us to only loading files within \u003ccode\u003eIPRelayApp/*\u003c/code\u003e. In this scenario, this is what the directory layout looked like, thanks to Tomcat:\u003c/p\u003e\n\n\u003cp\u003e\u003ccode\u003eIPRelayApp/\u003cbr\u003e\n  |- jsp/\u003cbr\u003e\n  |- images/\u003cbr\u003e\n  |- html/\u003cbr\u003e\n  |- META-INF/\u003cbr\u003e\n  |- WEB-INF/\u003cbr\u003e\n    |- classes/\u003cbr\u003e\n        |- help/\u003cbr\u003e\n        |- logs/\u003cbr\u003e\n        |- lib/\u003cbr\u003e\n        |- xml/\u003cbr\u003e\n        |- files/\u003cbr\u003e\n        |- web.xml\u003c/code\u003e\u003c/p\u003e\n\n\u003cp\u003eThe \u003ccode\u003eWEB-INF\u003c/code\u003e directory is within the IPRelayApp directory, meaning we could load \u003ccode\u003eweb.xml\u003c/code\u003e, an XML document that has a few mappings for Tomcat to understand where to pull certain files from. Attached is proof of the file getting loaded. Here is what the proof-of-concept would look like by this point:\u003c/p\u003e\n\n\u003cp\u003e\u003ccode\u003ehttp://\u0026lt;host\u0026gt;/IPRelayApp/servlet/IPRelay?page=../WEB-INF/web.xml?\u003c/code\u003e\u003c/p\u003e\n\n\u003cp\u003eAt this point, we wrote a little proof-of-concept to parse the web.xml file and find the location of the source files. This was purely to confirm the severity of this vulnerability. This was the output of our script:\u003c/p\u003e\n\n\u003cp\u003e\u003ccode\u003e[+] connecting to \u0026lt;redacted\u0026gt;\u003cbr\u003e\nsrc file found @ \u0026#39;com/soleo/iprelayweb/common/filters/LoggedInFilter.class\u0026#39;\u003cbr\u003e\nsrc file found @ \u0026#39;com/soleo/iprelayweb/common/filters/RedirectionFilter.class\u0026#39;\u003cbr\u003e\nsrc file found @ \u0026#39;com/soleo/iprelayweb/common/filters/HostnameFilter.class\u0026#39;\u003cbr\u003e\nsrc file found @ \u0026#39;com/soleo/iprelayweb/common/filters/SetHeadersFilter.class\u0026#39;\u003cbr\u003e\nsrc file found @ \u0026#39;com/soleo/iprelayweb/common/filters/SetHeadersFilter.class\u0026#39;\u003cbr\u003e\nsrc file found @ \u0026#39;com/soleo/iprelayapp/filters/ChangePasswordFilter.class\u0026#39;\u003cbr\u003e\nsrc file found @ \u0026#39;com/soleo/iprelayweb/common/filters/EncodingFilter.class\u0026#39;\u003cbr\u003e\nsrc file found @\u003cbr\u003e\n\u0026#39;com/soleo/iprelayapp/filters/PasswordChangeRestrictionFilter.class\u0026#39;\u003cbr\u003e\nsrc file found @ \u0026#39;com/soleo/iprelayapp/filters/SSORedirectFilter.class\u0026#39;\u003cbr\u003e\nsrc file found @ \u0026#39;com/soleo/iprelayapp/common/ContextListener.class\u0026#39;\u003cbr\u003e\nsrc file found @ \u0026#39;com/soleo/iprelayapp/servlets/LoginServlet.class\u0026#39;\u003cbr\u003e\nsrc file found @ \u0026#39;com/soleo/iprelayapp/servlets/SoleoInteractionServlet.class\u0026#39;\u003cbr\u003e\nsrc file found @ \u0026#39;com/soleo/iprelayapp/servlets/CreateUserServlet.class\u0026#39;\u003cbr\u003e\nsrc file found @ \u0026#39;com/soleo/iprelayapp/servlets/CreateCDRServlet.class\u0026#39;\u003cbr\u003e\nsrc file found @ \u0026#39;com/soleo/iprelayapp/servlets/FindSecurityQuestionServlet.class\u0026#39;\u003cbr\u003e\nsrc file found @ \u0026#39;com/soleo/iprelayapp/servlets/ChangePasswordServlet.class\u0026#39;\u003cbr\u003e\nsrc file found @ \u0026#39;com/soleo/iprelayapp/servlets/VerifyAccountServlet.class\u0026#39;\u003cbr\u003e\nsrc file found @ \u0026#39;com/soleo/iprelayapp/servlets/GenerateIPRelayPageServlet.class\u0026#39;\u003cbr\u003e\nsrc file found @ \u0026#39;com/soleo/iprelayapp/servlets/ProfilePageServlet.class\u0026#39;\u003cbr\u003e\nsrc file found @ \u0026#39;com/soleo/iprelayapp/servlets/ProfileServlet.class\u0026#39;\u003cbr\u003e\nsrc file found @ \u0026#39;com/soleo/iprelayapp/servlets/PreferencesPageServlet.class\u0026#39;\u003cbr\u003e\nsrc file found @ \u0026#39;com/soleo/iprelayapp/servlets/RegistrationPageServlet.class\u0026#39;\u003cbr\u003e\nsrc file found @ \u0026#39;com/soleo/iprelayapp/servlets/WelcomeServlet.class\u0026#39;\u003cbr\u003e\nsrc file found @ \u0026#39;com/soleo/iprelayapp/servlets/LogoutServlet.class\u0026#39;\u003cbr\u003e\nsrc file found @ \u0026#39;com/soleo/iprelayapp/servlets/UpdateProfileServlet.class\u0026#39;\u003cbr\u003e\nsrc file found @ \u0026#39;com/soleo/iprelayapp/servlets/UpdatePreferencesServlet.class\u0026#39;\u003cbr\u003e\nsrc file found @ \u0026#39;com/soleo/iprelayapp/servlets/ValidateIPUserStatusServlet.class\u0026#39;\u003cbr\u003e\nsrc file found @ \u0026#39;com/soleo/iprelayapp/servlets/OfflineMessageServlet.class\u0026#39;\u003cbr\u003e\nsrc file found @ \u0026#39;com/soleo/iprelayapp/servlets/AddressBookServlet.class\u0026#39;\u003cbr\u003e\nsrc file found @ \u0026#39;com/soleo/iprelayapp/servlets/SaveIPConversationServlet.class\u0026#39;\u003cbr\u003e\nsrc file found @ \u0026#39;com/soleo/iprelayapp/servlets/SessionPingServlet.class\u0026#39;\u003cbr\u003e\nsrc file found @ \u0026#39;com/soleo/iprelayweb/common/servlet/PingServlet.class\u0026#39;\u003cbr\u003e\nsrc file found @ \u0026#39;com/soleo/iprelayweb/common/servlet/Skinner.class\u0026#39;\u003cbr\u003e\nsrc file found @ \u0026#39;com/soleo/iprelayapp/servlets/FinishLoginServlet.class\u0026#39;\u003cbr\u003e\nsrc file found @ \u0026#39;com/soleo/iprelayapp/servlets/SSOEntryServlet.class\u0026#39;\u003cbr\u003e\nsrc file found @ \u0026#39;com/soleo/iprelayapp/servlets/ShibbolethErrorServlet.class\u0026#39;\u003cbr\u003e\nsrc file found @ \u0026#39;com/soleo/iprelayapp/servlets/MakeCallServlet.class\u0026#39;\u003cbr\u003e\nsrc file found @ \u0026#39;com/soleo/iprelayapp/servlets/ChangeOperatingLanguage.class\u0026#39;\u003c/code\u003e\u003c/p\u003e\n\n\u003cp\u003eAll of the following files can be downloaded by loading them from \u003ccode\u003eWEB-INF/classes/*\u003c/code\u003e.  Once again, to confirm severity, we tried to load one of these files, specifically \u003ccode\u003eIPRelay.class\u003c/code\u003e - the attached image shows the file being successfully downloaded.\u003c/p\u003e\n\n\u003cp\u003eAfter loading this file into our text editor, it was evident that these classes had been compiled in Java bytecode. However, a determined attacker would easily be able to convert this directly back to source, compromising source code and other sensitive files. Within the source code lies passwords which allow the servlet to communicate with other services, such as SQL/LDAP. An attacker could extract these passwords from within the source files, and further escalate their privileges on the server, or even use said information in a social engineering attack. The end result could be escalated to yield remote code execution, though we were not comfortable attempting to do this before getting in contact with the vendor. Attached you can find a \u003ccode\u003e.class\u003c/code\u003e file which leads to sensitive Information Disclosure.\u003c/p\u003e\n\n\u003cp\u003eEssentially every Internet Service Provider in Canada uses Soleo’s IP Relay service. This was not an initial discovery however upon further analysis the impact of this vulnerability kept increasing. By utilizing Google dorks, we were able to determine that there were at least ​ten ​other Internet Service Providers in Canada that wererunning the same vulnerable instance of Soleo’s IP Relay. Interestingly enough six out of the ten vulnerable ISPs were actually the largest telecom providers in Canada.\u003c/p\u003e\n\n\u003cp\u003eTo conclude this report, we have confirmed that a determined attacker (APT/foreign entity) could leverage this vulnerability to steal passwords from configuration files across multiple providers, compromise said providers using the stolen passwords, and then ​potentially​ launch a large scale identity theft operation against Canadians. Seeing as Canada’s federal elections are coming up in 2019, this vulnerability could have had detrimental effects for Canadian citizens who confide in these providers to safeguard their identity. Due to our concerns about the social security of Canadian citizens, we decided to compile a list of the providers that were affected by this vulnerability. In total this can ultimately lead to the compromise of over 30 million Canadian records. Here are some major providers that were affected:\u003c/p\u003e\n\n\u003cp\u003e\u003ccode\u003eBell\u003cbr\u003e\nSasktel\u003cbr\u003e\nTelus\u003cbr\u003e\nShaw\u003cbr\u003e\nVideotron\u003cbr\u003e\nMTS\u003cbr\u003e\nRogers (their services are hosted at iprelayservice.net)\u003cbr\u003e\nBell Aliant\u003cbr\u003e\nCogeco\u003cbr\u003e\nFido (their services are hosted at iprelayservice.net)\u003cbr\u003e\nKoodo (their services are hosted at iprelayservice.net)\u003cbr\u003e\nChatr (their services are hosted at iprelayservice.net)\u003cbr\u003e\nAllStream\u003cbr\u003e\nEastLink\u003c/code\u003e\u003c/p\u003e\n\n\u003cp\u003eThis flaw was remediated on 10th August 2018, roughly three weeks after our initial disclosure.\u003c/p\u003e\n","original_report_id":null,"original_report_url":null,"attachments":[{"id":350125,"file_name":"classfile.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/350/125/1ffa27d7983298a0993f421fb65ae5d3163fc73b/classfile.png?response-content-disposition=attachment%3B%20filename%3D%22classfile.png%22%3B%20filename%2A%3DUTF-8%27%27classfile.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQVBWWKZ4H%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T055356Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCmEbZvVQ%2FI1GHRJjrhZK2Y6zh4lCWK725%2FwOpNu%2BnZkAIhAIZlqGHog%2B4PZMdnvhSU5APZbycPDz1wpNXbi5uE94ueKrQDCFUQARoMMDEzNjE5Mjc0ODQ5IgxU5AAHhqo1cPAzbTcqkQOGB5pEHXl6QCBCTSHUmyd%2FF8M3rpTqzp%2BOigrWU%2BrXYHZYm%2BGDawsiXhnqeD9o8Qw0b%2Fr0efVbRmhj5baoPrxgSiY%2B9zsreR3qClZZKnS0%2Brs8OqiMGd3clBbyfOxw2fa2vgQglV4dLF6EXSiGfxOms8eWdw%2F8mPtc81dMxDIlxTs50KUnd6aUjgG5BJs2k%2FL0rOKXYBS%2FdVqIQdN8JcCKMvqDv0u7pvSGEecQXa7pGdf07ufO02E64eU0OnaTeNyoq7WlZzT%2FGyvHjVtIvbXdPW15pwZm2Q4u8%2FW7ksSv4%2BxsESWLLCop0OeGUhtIppCDQlaMPC9JTj0HYKbMEGmZagmLfgHX4DKRg75%2FLNQViGcE%2FRCCaMxd6wrsv0dlz4dekjWvp4mXzLFkuKBM6c%2F%2BAemkmkgOJKnp%2FJUV1zJTe%2BO14GyIigsvxJqvrnKvkmsUrYwar1bX%2Be7UkqGzVbMAlsbRDNIOok7bVRXerhpXnbqFQsLWlqe%2BNfa4gSSfmgu4iIjCRRMdTWsvy2NQHfTsGjDAzar%2FBTrqAcniMm3eG7%2BxDZb9XVqMyQiSNyiuBD8pwO78bO8T3Uu8vSI3S05C6UCutmNkOnjR9D2NZaOgbFO4YujbW%2FY0mhhdjSppvg%2Bzdgu0AfZOou0DDwqm4vwEc0ekiNYUD6KHvD5tZwOaalihV5dSfbzoDyvfsJI6x7RYpBZmwPcshKw3Csz0uZew1JqrbUJVmc9v6q0aXols8bxyDKKPfp6siyzKhHELgTS3XGskds%2BWx5FaWemc%2Bo8QqyIuoOtWjmUwF39ydFOfg%2FyeKdwBxELGLKCSN8MyV6ov7IBrib4UiM%2F6l36ymDoHIX8ohg%3D%3D\u0026X-Amz-Signature=5e60bdb02480fc2b309e3c756d591f7698d4ffdbd9de9dae5ba6c1864c138987","file_size":805993,"type":"image/png"},{"id":350126,"file_name":"IPRelay.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/350/126/137f924f8082ed99a272fed55e7913a87eeaa0b1/IPRelay.png?response-content-disposition=attachment%3B%20filename%3D%22IPRelay.png%22%3B%20filename%2A%3DUTF-8%27%27IPRelay.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQVBWWKZ4H%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T055356Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCmEbZvVQ%2FI1GHRJjrhZK2Y6zh4lCWK725%2FwOpNu%2BnZkAIhAIZlqGHog%2B4PZMdnvhSU5APZbycPDz1wpNXbi5uE94ueKrQDCFUQARoMMDEzNjE5Mjc0ODQ5IgxU5AAHhqo1cPAzbTcqkQOGB5pEHXl6QCBCTSHUmyd%2FF8M3rpTqzp%2BOigrWU%2BrXYHZYm%2BGDawsiXhnqeD9o8Qw0b%2Fr0efVbRmhj5baoPrxgSiY%2B9zsreR3qClZZKnS0%2Brs8OqiMGd3clBbyfOxw2fa2vgQglV4dLF6EXSiGfxOms8eWdw%2F8mPtc81dMxDIlxTs50KUnd6aUjgG5BJs2k%2FL0rOKXYBS%2FdVqIQdN8JcCKMvqDv0u7pvSGEecQXa7pGdf07ufO02E64eU0OnaTeNyoq7WlZzT%2FGyvHjVtIvbXdPW15pwZm2Q4u8%2FW7ksSv4%2BxsESWLLCop0OeGUhtIppCDQlaMPC9JTj0HYKbMEGmZagmLfgHX4DKRg75%2FLNQViGcE%2FRCCaMxd6wrsv0dlz4dekjWvp4mXzLFkuKBM6c%2F%2BAemkmkgOJKnp%2FJUV1zJTe%2BO14GyIigsvxJqvrnKvkmsUrYwar1bX%2Be7UkqGzVbMAlsbRDNIOok7bVRXerhpXnbqFQsLWlqe%2BNfa4gSSfmgu4iIjCRRMdTWsvy2NQHfTsGjDAzar%2FBTrqAcniMm3eG7%2BxDZb9XVqMyQiSNyiuBD8pwO78bO8T3Uu8vSI3S05C6UCutmNkOnjR9D2NZaOgbFO4YujbW%2FY0mhhdjSppvg%2Bzdgu0AfZOou0DDwqm4vwEc0ekiNYUD6KHvD5tZwOaalihV5dSfbzoDyvfsJI6x7RYpBZmwPcshKw3Csz0uZew1JqrbUJVmc9v6q0aXols8bxyDKKPfp6siyzKhHELgTS3XGskds%2BWx5FaWemc%2Bo8QqyIuoOtWjmUwF39ydFOfg%2FyeKdwBxELGLKCSN8MyV6ov7IBrib4UiM%2F6l36ymDoHIX8ohg%3D%3D\u0026X-Amz-Signature=a32ec42b16268789bcdfca9c018f6242a562062c5a15ede3a3a8f0c649b5180d","file_size":318992,"type":"image/png"},{"id":350127,"file_name":"webinf.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/350/127/3c0cc336044da65545a60a0f5ac2eb616df72772/webinf.png?response-content-disposition=attachment%3B%20filename%3D%22webinf.png%22%3B%20filename%2A%3DUTF-8%27%27webinf.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQVBWWKZ4H%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T055356Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCmEbZvVQ%2FI1GHRJjrhZK2Y6zh4lCWK725%2FwOpNu%2BnZkAIhAIZlqGHog%2B4PZMdnvhSU5APZbycPDz1wpNXbi5uE94ueKrQDCFUQARoMMDEzNjE5Mjc0ODQ5IgxU5AAHhqo1cPAzbTcqkQOGB5pEHXl6QCBCTSHUmyd%2FF8M3rpTqzp%2BOigrWU%2BrXYHZYm%2BGDawsiXhnqeD9o8Qw0b%2Fr0efVbRmhj5baoPrxgSiY%2B9zsreR3qClZZKnS0%2Brs8OqiMGd3clBbyfOxw2fa2vgQglV4dLF6EXSiGfxOms8eWdw%2F8mPtc81dMxDIlxTs50KUnd6aUjgG5BJs2k%2FL0rOKXYBS%2FdVqIQdN8JcCKMvqDv0u7pvSGEecQXa7pGdf07ufO02E64eU0OnaTeNyoq7WlZzT%2FGyvHjVtIvbXdPW15pwZm2Q4u8%2FW7ksSv4%2BxsESWLLCop0OeGUhtIppCDQlaMPC9JTj0HYKbMEGmZagmLfgHX4DKRg75%2FLNQViGcE%2FRCCaMxd6wrsv0dlz4dekjWvp4mXzLFkuKBM6c%2F%2BAemkmkgOJKnp%2FJUV1zJTe%2BO14GyIigsvxJqvrnKvkmsUrYwar1bX%2Be7UkqGzVbMAlsbRDNIOok7bVRXerhpXnbqFQsLWlqe%2BNfa4gSSfmgu4iIjCRRMdTWsvy2NQHfTsGjDAzar%2FBTrqAcniMm3eG7%2BxDZb9XVqMyQiSNyiuBD8pwO78bO8T3Uu8vSI3S05C6UCutmNkOnjR9D2NZaOgbFO4YujbW%2FY0mhhdjSppvg%2Bzdgu0AfZOou0DDwqm4vwEc0ekiNYUD6KHvD5tZwOaalihV5dSfbzoDyvfsJI6x7RYpBZmwPcshKw3Csz0uZew1JqrbUJVmc9v6q0aXols8bxyDKKPfp6siyzKhHELgTS3XGskds%2BWx5FaWemc%2Bo8QqyIuoOtWjmUwF39ydFOfg%2FyeKdwBxELGLKCSN8MyV6ov7IBrib4UiM%2F6l36ymDoHIX8ohg%3D%3D\u0026X-Amz-Signature=cbfc48523ef75a4e26488e64d50d5ba5f9099c9b5822acbd199782945e802b45","file_size":756483,"type":"image/png"}],"allow_singular_disclosure_at":null,"vote_count":41,"voters":["foobar7","sameerphad72","dmatrix","smshrimant","eveeez","pisarenko","what_web","protector47","cryptographer","kaktaktoa","and 31 more..."],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":3376820,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2018-08-10T22:25:59.000Z","updated_at":"2018-08-10T22:25:59.000Z","actor":{"username":"bitst0rm","cleared":false,"url":"/bitst0rm","profile_picture_urls":{"medium":"https://hackerone.com/rails/active_storage/representations/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaHBBNkk2RXc9PSIsImV4cCI6bnVsbCwicHVyIjoiYmxvYl9pZCJ9fQ==--d34cc1dc3b5dd31058aa89aa1012d58b6d5ecedc/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaDdCam9VWTI5dFltbHVaVjl2Y0hScGIyNXpld2c2REdkeVlYWnBkSGxKSWd0RFpXNTBaWElHT2daRlZEb0xjbVZ6YVhwbFNTSUxPREo0T0RKZUJqc0hWRG9KWTNKdmNFa2lEamd5ZURneUt6QXJNQVk3QjFRPSIsImV4cCI6bnVsbCwicHVyIjoidmFyaWF0aW9uIn19--0e71f6791faebe1c35f4452bd21d67fb6decfbc2/20201202_035620.jpg"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"bitst0rm","url":"/bitst0rm"},"genius_execution_id":null,"team_handle":"soleo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3380384,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-09-24T16:28:03.333Z","updated_at":"2018-09-24T16:28:03.333Z","actor":{"username":"bitst0rm","cleared":false,"url":"/bitst0rm","profile_picture_urls":{"medium":"https://hackerone.com/rails/active_storage/representations/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaHBBNkk2RXc9PSIsImV4cCI6bnVsbCwicHVyIjoiYmxvYl9pZCJ9fQ==--d34cc1dc3b5dd31058aa89aa1012d58b6d5ecedc/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaDdCam9VWTI5dFltbHVaVjl2Y0hScGIyNXpld2c2REdkeVlYWnBkSGxKSWd0RFpXNTBaWElHT2daRlZEb0xjbVZ6YVhwbFNTSUxPREo0T0RKZUJqc0hWRG9KWTNKdmNFa2lEamd5ZURneUt6QXJNQVk3QjFRPSIsImV4cCI6bnVsbCwicHVyIjoidmFyaWF0aW9uIn19--0e71f6791faebe1c35f4452bd21d67fb6decfbc2/20201202_035620.jpg"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"soleo","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"id":10730,"category":"researcher","content":"SOLEO IP Relay (by Soleo communications) is a cloud-based IP Relay service for telecommunications providers. It is a solution in compliance with government-mandated service requirements for IP Relay Services, also known as “Remote Interpreting Services”. It is a service that allows people who are deaf, hard of hearing, or have a speech disorder to place calls through a TTY or other assistive telephone device. IP Relay is also commonly known as “TRS”, “relay service” or “IP-Relay”.  \n\nThrough Directory Traversal, a File Disclosure vulnerability was identified in Soleo's IP Relay Application, HTTP parameter poisoning was utilized to bypass the appended `.JSP` file extension, leading to the disclosure of sensitive java `.class` files which contained information such as SQL and LDAP credentials used by the Java Servlet, allowing an attacker to authenticate via these services. Every major Internet Service Provider in Canada was affected by this vulnerability, alongside some US-based providers. \n\nHere you can find one of the articles covering our findings: https://www.securityweek.com/vulnerability-ip-relay-service-impacts-major-canadian-isps","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eSOLEO IP Relay (by Soleo communications) is a cloud-based IP Relay service for telecommunications providers. It is a solution in compliance with government-mandated service requirements for IP Relay Services, also known as “Remote Interpreting Services”. It is a service that allows people who are deaf, hard of hearing, or have a speech disorder to place calls through a TTY or other assistive telephone device. IP Relay is also commonly known as “TRS”, “relay service” or “IP-Relay”.  \u003c/p\u003e\n\n\u003cp\u003eThrough Directory Traversal, a File Disclosure vulnerability was identified in Soleo\u0026#39;s IP Relay Application, HTTP parameter poisoning was utilized to bypass the appended \u003ccode\u003e.JSP\u003c/code\u003e file extension, leading to the disclosure of sensitive java \u003ccode\u003e.class\u003c/code\u003e files which contained information such as SQL and LDAP credentials used by the Java Servlet, allowing an attacker to authenticate via these services. Every major Internet Service Provider in Canada was affected by this vulnerability, alongside some US-based providers. \u003c/p\u003e\n\n\u003cp\u003eHere you can find one of the articles covering our findings: \u003ca title=\"https://www.securityweek.com/vulnerability-ip-relay-service-impacts-major-canadian-isps\" href=\"/redirect?url=https%3A%2F%2Fwww.securityweek.com%2Fvulnerability-ip-relay-service-impacts-major-canadian-isps\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.securityweek.com/vulnerability-ip-relay-service-impacts-major-canadian-isps\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n"}]}