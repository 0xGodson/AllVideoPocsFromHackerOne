{"id":181315,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xODEzMTU=","url":"https://hackerone.com/reports/181315","title":"Not using Binary::safe* functions for substr/strlen function","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-11-10T12:50:45.937Z","submitted_at":"2016-11-10T12:50:45.937Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"e3amn2l","url":"/e3amn2l","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":8539,"url":"https://hackerone.com/paragonie","handle":"paragonie","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/008/539/72f76fed45e5220b47ba2f679371ebf9ccb19c70_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/539/72f76fed45e5220b47ba2f679371ebf9ccb19c70_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Paragon Initiative Enterprises","twitter_handle":"ParagonIE","website":"https://github.com/paragonie","about":"Cryptography and Application Security Consultants - We Produce Various Open Source Libraries"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2016-11-13T00:43:30.432Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2016-11-13T00:35:51.452Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Several places in the code don't use Binary::safe* or CryptoUtil::safe* functions, but use raw functions instead (strlen/substr) which can act as mb_funcname instead (not count bytes for strlen/etc...)\n\n1\\. https://github.com/paragonie/airship/blob/4be7ac0f16b1744255a876a38dbe13fb1c09731a/src/Engine/Security/CSRF.php#L87\n```\n            $lockTo = substr($lockTo, 0, strlen($lockTo) - 1);\n```\n\n2\\. https://github.com/paragonie/airship/blob/58f96aa0e5002b60e74456502d9bfc9483d77b3d/src/Engine/Security/Util.php#L98\ncan be changed to use self::subString which use  Binary::safeSubstr\n```\n                        \\substr($mimeType, $p),\n```\n\n3\\. https://github.com/paragonie/airship/blob/0e9289553cdc538556d362faaee63be6cc534a0c/tools/audit_helper.php#L30\n```\n    if (\\substr($print, 0, 3) === 'tmp' || \\substr($print, 0, 5) === 'files') {\n```\n\n4\\. https://github.com/paragonie/airship/blob/58f96aa0e5002b60e74456502d9bfc9483d77b3d/tools/hangar/src/SessionCommand.php#L23-L24\n```\n            $x = \\strlen($this-\u003esession['dir']);\n            return \\substr($current, $x + 1);\n```\n\n5\\. https://github.com/paragonie/airship/blob/58f96aa0e5002b60e74456502d9bfc9483d77b3d/tools/hangar/src/SessionCommand.php#L46-L47\n```\n            $x = \\strlen($this-\u003esession['dir']);\n            return \\substr($file, $x + 1);\n```\n\n6\\. https://github.com/paragonie/airship/blob/0e9289553cdc538556d362faaee63be6cc534a0c/tools/random_audit.php#L28\n```\necho \\substr($fileList[$choice], $l), \"\\n\";\n```\n\n7\\. https://github.com/paragonie/airship/blob/58f96aa0e5002b60e74456502d9bfc9483d77b3d/src/CommandLine/installer.php#L39\n8\\. https://github.com/paragonie/airship/blob/58f96aa0e5002b60e74456502d9bfc9483d77b3d/src/CommandLine/manual_update.php#L40\n9\\. https://github.com/paragonie/airship/blob/58f96aa0e5002b60e74456502d9bfc9483d77b3d/src/symlinks.php#L48\n10\\. https://github.com/paragonie/airship/blob/4aa579c564383355ad3de111a746f14a07164dba/src/config/logger.php#L28\n11\\. https://github.com/paragonie/airship/blob/0e9289553cdc538556d362faaee63be6cc534a0c/tools/hangar/src/Commands/Add.php#L62\n12\\. https://github.com/paragonie/airship/blob/0e9289553cdc538556d362faaee63be6cc534a0c/tools/hangar/src/Commands/Add.php#L62\n13\\. https://github.com/paragonie/airship/blob/0e9289553cdc538556d362faaee63be6cc534a0c/tools/hangar/src/hangar.php#L68\n14\\. https://github.com/paragonie/airship/blob/7bb8d24487e127b2210ac7f1153df8153208c3b9/tools/hangar/src/Command.php#L168\n\n\nstrlen usage:\n\n1\\. https://github.com/paragonie/airship/blob/ef2d4f725e5af2eae27fd919533d01b625d020b1/src/Cabin/Hull/Blueprint/Blog.php#L1080\n2\\. https://github.com/paragonie/airship/blob/ef2d4f725e5af2eae27fd919533d01b625d020b1/src/Cabin/Hull/Blueprint/Blog.php#L1098\n3\\. https://github.com/paragonie/airship/blob/58f96aa0e5002b60e74456502d9bfc9483d77b3d/src/Cabin/Hull/Landing/IndexPage.php#L43\n4\\. https://github.com/paragonie/airship/blob/0e9289553cdc538556d362faaee63be6cc534a0c/tools/hangar/src/Commands/Help.php#L100\n5\\. https://github.com/paragonie/airship/blob/0e9289553cdc538556d362faaee63be6cc534a0c/tools/hangar/src/Commands/Add.php#L60\n6\\. https://github.com/paragonie/airship/blob/58f96aa0e5002b60e74456502d9bfc9483d77b3d/src/Cabin/Hull/Landing/BlogPosts.php#L85\n7\\. https://github.com/paragonie/airship/blob/58f96aa0e5002b60e74456502d9bfc9483d77b3d/src/Cabin/Hull/Landing/BlogPosts.php#L147\n8\\. https://github.com/paragonie/airship/blob/0e9289553cdc538556d362faaee63be6cc534a0c/tools/hangar/src/Commands/Autorun.php#L61\n9\\. https://github.com/paragonie/airship/blob/0e9289553cdc538556d362faaee63be6cc534a0c/tools/hangar/src/Commands/Autorun.php#L81\n10\\. https://github.com/paragonie/airship/blob/4aa579c564383355ad3de111a746f14a07164dba/src/config/logger.php#L26\n11\\. https://github.com/paragonie/halite/blob/8980974467cd54c6d2bb4dd98b2f0e9838570549/autoload.php#L13\n\n\nfix:\n1. change strlen usage to CryptoUtil::safeStrlen or Util::safeStrlen or Binary::safeStrlen or Util::stringLength across the codebase.\n2. change substr usage to Util::safeSubstr or CryptoUtil::safeSubstr or Binary::safeSubstr across the codebase.","vulnerability_information_html":"\u003cp\u003eSeveral places in the code don\u0026#39;t use Binary::safe* or CryptoUtil::safe* functions, but use raw functions instead (strlen/substr) which can act as mb_funcname instead (not count bytes for strlen/etc...)\u003c/p\u003e\n\n\u003cp\u003e1. \u003ca title=\"https://github.com/paragonie/airship/blob/4be7ac0f16b1744255a876a38dbe13fb1c09731a/src/Engine/Security/CSRF.php#L87\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fparagonie%2Fairship%2Fblob%2F4be7ac0f16b1744255a876a38dbe13fb1c09731a%2Fsrc%2FEngine%2FSecurity%2FCSRF.php%23L87\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/paragonie/airship/blob/4be7ac0f16b1744255a876a38dbe13fb1c09731a/src/Engine/Security/CSRF.php#L87\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e            $lockTo = substr($lockTo, 0, strlen($lockTo) - 1);\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e2. \u003ca title=\"https://github.com/paragonie/airship/blob/58f96aa0e5002b60e74456502d9bfc9483d77b3d/src/Engine/Security/Util.php#L98\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fparagonie%2Fairship%2Fblob%2F58f96aa0e5002b60e74456502d9bfc9483d77b3d%2Fsrc%2FEngine%2FSecurity%2FUtil.php%23L98\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/paragonie/airship/blob/58f96aa0e5002b60e74456502d9bfc9483d77b3d/src/Engine/Security/Util.php#L98\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\ncan be changed to use self::subString which use  Binary::safeSubstr\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e                        \\substr($mimeType, $p),\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e3. \u003ca title=\"https://github.com/paragonie/airship/blob/0e9289553cdc538556d362faaee63be6cc534a0c/tools/audit_helper.php#L30\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fparagonie%2Fairship%2Fblob%2F0e9289553cdc538556d362faaee63be6cc534a0c%2Ftools%2Faudit_helper.php%23L30\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/paragonie/airship/blob/0e9289553cdc538556d362faaee63be6cc534a0c/tools/audit_helper.php#L30\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e    if (\\substr($print, 0, 3) === \u0026#39;tmp\u0026#39; || \\substr($print, 0, 5) === \u0026#39;files\u0026#39;) {\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e4. \u003ca title=\"https://github.com/paragonie/airship/blob/58f96aa0e5002b60e74456502d9bfc9483d77b3d/tools/hangar/src/SessionCommand.php#L23-L24\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fparagonie%2Fairship%2Fblob%2F58f96aa0e5002b60e74456502d9bfc9483d77b3d%2Ftools%2Fhangar%2Fsrc%2FSessionCommand.php%23L23-L24\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/paragonie/airship/blob/58f96aa0e5002b60e74456502d9bfc9483d77b3d/tools/hangar/src/SessionCommand.php#L23-L24\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e            $x = \\strlen($this-\u0026gt;session[\u0026#39;dir\u0026#39;]);\n            return \\substr($current, $x + 1);\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e5. \u003ca title=\"https://github.com/paragonie/airship/blob/58f96aa0e5002b60e74456502d9bfc9483d77b3d/tools/hangar/src/SessionCommand.php#L46-L47\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fparagonie%2Fairship%2Fblob%2F58f96aa0e5002b60e74456502d9bfc9483d77b3d%2Ftools%2Fhangar%2Fsrc%2FSessionCommand.php%23L46-L47\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/paragonie/airship/blob/58f96aa0e5002b60e74456502d9bfc9483d77b3d/tools/hangar/src/SessionCommand.php#L46-L47\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e            $x = \\strlen($this-\u0026gt;session[\u0026#39;dir\u0026#39;]);\n            return \\substr($file, $x + 1);\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e6. \u003ca title=\"https://github.com/paragonie/airship/blob/0e9289553cdc538556d362faaee63be6cc534a0c/tools/random_audit.php#L28\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fparagonie%2Fairship%2Fblob%2F0e9289553cdc538556d362faaee63be6cc534a0c%2Ftools%2Frandom_audit.php%23L28\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/paragonie/airship/blob/0e9289553cdc538556d362faaee63be6cc534a0c/tools/random_audit.php#L28\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eecho \\substr($fileList[$choice], $l), \u0026quot;\\n\u0026quot;;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e7. \u003ca title=\"https://github.com/paragonie/airship/blob/58f96aa0e5002b60e74456502d9bfc9483d77b3d/src/CommandLine/installer.php#L39\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fparagonie%2Fairship%2Fblob%2F58f96aa0e5002b60e74456502d9bfc9483d77b3d%2Fsrc%2FCommandLine%2Finstaller.php%23L39\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/paragonie/airship/blob/58f96aa0e5002b60e74456502d9bfc9483d77b3d/src/CommandLine/installer.php#L39\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\n8. \u003ca title=\"https://github.com/paragonie/airship/blob/58f96aa0e5002b60e74456502d9bfc9483d77b3d/src/CommandLine/manual_update.php#L40\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fparagonie%2Fairship%2Fblob%2F58f96aa0e5002b60e74456502d9bfc9483d77b3d%2Fsrc%2FCommandLine%2Fmanual_update.php%23L40\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/paragonie/airship/blob/58f96aa0e5002b60e74456502d9bfc9483d77b3d/src/CommandLine/manual_update.php#L40\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\n9. \u003ca title=\"https://github.com/paragonie/airship/blob/58f96aa0e5002b60e74456502d9bfc9483d77b3d/src/symlinks.php#L48\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fparagonie%2Fairship%2Fblob%2F58f96aa0e5002b60e74456502d9bfc9483d77b3d%2Fsrc%2Fsymlinks.php%23L48\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/paragonie/airship/blob/58f96aa0e5002b60e74456502d9bfc9483d77b3d/src/symlinks.php#L48\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\n10. \u003ca title=\"https://github.com/paragonie/airship/blob/4aa579c564383355ad3de111a746f14a07164dba/src/config/logger.php#L28\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fparagonie%2Fairship%2Fblob%2F4aa579c564383355ad3de111a746f14a07164dba%2Fsrc%2Fconfig%2Flogger.php%23L28\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/paragonie/airship/blob/4aa579c564383355ad3de111a746f14a07164dba/src/config/logger.php#L28\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\n11. \u003ca title=\"https://github.com/paragonie/airship/blob/0e9289553cdc538556d362faaee63be6cc534a0c/tools/hangar/src/Commands/Add.php#L62\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fparagonie%2Fairship%2Fblob%2F0e9289553cdc538556d362faaee63be6cc534a0c%2Ftools%2Fhangar%2Fsrc%2FCommands%2FAdd.php%23L62\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/paragonie/airship/blob/0e9289553cdc538556d362faaee63be6cc534a0c/tools/hangar/src/Commands/Add.php#L62\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\n12. \u003ca title=\"https://github.com/paragonie/airship/blob/0e9289553cdc538556d362faaee63be6cc534a0c/tools/hangar/src/Commands/Add.php#L62\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fparagonie%2Fairship%2Fblob%2F0e9289553cdc538556d362faaee63be6cc534a0c%2Ftools%2Fhangar%2Fsrc%2FCommands%2FAdd.php%23L62\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/paragonie/airship/blob/0e9289553cdc538556d362faaee63be6cc534a0c/tools/hangar/src/Commands/Add.php#L62\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\n13. \u003ca title=\"https://github.com/paragonie/airship/blob/0e9289553cdc538556d362faaee63be6cc534a0c/tools/hangar/src/hangar.php#L68\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fparagonie%2Fairship%2Fblob%2F0e9289553cdc538556d362faaee63be6cc534a0c%2Ftools%2Fhangar%2Fsrc%2Fhangar.php%23L68\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/paragonie/airship/blob/0e9289553cdc538556d362faaee63be6cc534a0c/tools/hangar/src/hangar.php#L68\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\n14. \u003ca title=\"https://github.com/paragonie/airship/blob/7bb8d24487e127b2210ac7f1153df8153208c3b9/tools/hangar/src/Command.php#L168\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fparagonie%2Fairship%2Fblob%2F7bb8d24487e127b2210ac7f1153df8153208c3b9%2Ftools%2Fhangar%2Fsrc%2FCommand.php%23L168\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/paragonie/airship/blob/7bb8d24487e127b2210ac7f1153df8153208c3b9/tools/hangar/src/Command.php#L168\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003estrlen usage:\u003c/p\u003e\n\n\u003cp\u003e1. \u003ca title=\"https://github.com/paragonie/airship/blob/ef2d4f725e5af2eae27fd919533d01b625d020b1/src/Cabin/Hull/Blueprint/Blog.php#L1080\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fparagonie%2Fairship%2Fblob%2Fef2d4f725e5af2eae27fd919533d01b625d020b1%2Fsrc%2FCabin%2FHull%2FBlueprint%2FBlog.php%23L1080\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/paragonie/airship/blob/ef2d4f725e5af2eae27fd919533d01b625d020b1/src/Cabin/Hull/Blueprint/Blog.php#L1080\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\n2. \u003ca title=\"https://github.com/paragonie/airship/blob/ef2d4f725e5af2eae27fd919533d01b625d020b1/src/Cabin/Hull/Blueprint/Blog.php#L1098\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fparagonie%2Fairship%2Fblob%2Fef2d4f725e5af2eae27fd919533d01b625d020b1%2Fsrc%2FCabin%2FHull%2FBlueprint%2FBlog.php%23L1098\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/paragonie/airship/blob/ef2d4f725e5af2eae27fd919533d01b625d020b1/src/Cabin/Hull/Blueprint/Blog.php#L1098\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\n3. \u003ca title=\"https://github.com/paragonie/airship/blob/58f96aa0e5002b60e74456502d9bfc9483d77b3d/src/Cabin/Hull/Landing/IndexPage.php#L43\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fparagonie%2Fairship%2Fblob%2F58f96aa0e5002b60e74456502d9bfc9483d77b3d%2Fsrc%2FCabin%2FHull%2FLanding%2FIndexPage.php%23L43\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/paragonie/airship/blob/58f96aa0e5002b60e74456502d9bfc9483d77b3d/src/Cabin/Hull/Landing/IndexPage.php#L43\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\n4. \u003ca title=\"https://github.com/paragonie/airship/blob/0e9289553cdc538556d362faaee63be6cc534a0c/tools/hangar/src/Commands/Help.php#L100\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fparagonie%2Fairship%2Fblob%2F0e9289553cdc538556d362faaee63be6cc534a0c%2Ftools%2Fhangar%2Fsrc%2FCommands%2FHelp.php%23L100\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/paragonie/airship/blob/0e9289553cdc538556d362faaee63be6cc534a0c/tools/hangar/src/Commands/Help.php#L100\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\n5. \u003ca title=\"https://github.com/paragonie/airship/blob/0e9289553cdc538556d362faaee63be6cc534a0c/tools/hangar/src/Commands/Add.php#L60\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fparagonie%2Fairship%2Fblob%2F0e9289553cdc538556d362faaee63be6cc534a0c%2Ftools%2Fhangar%2Fsrc%2FCommands%2FAdd.php%23L60\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/paragonie/airship/blob/0e9289553cdc538556d362faaee63be6cc534a0c/tools/hangar/src/Commands/Add.php#L60\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\n6. \u003ca title=\"https://github.com/paragonie/airship/blob/58f96aa0e5002b60e74456502d9bfc9483d77b3d/src/Cabin/Hull/Landing/BlogPosts.php#L85\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fparagonie%2Fairship%2Fblob%2F58f96aa0e5002b60e74456502d9bfc9483d77b3d%2Fsrc%2FCabin%2FHull%2FLanding%2FBlogPosts.php%23L85\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/paragonie/airship/blob/58f96aa0e5002b60e74456502d9bfc9483d77b3d/src/Cabin/Hull/Landing/BlogPosts.php#L85\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\n7. \u003ca title=\"https://github.com/paragonie/airship/blob/58f96aa0e5002b60e74456502d9bfc9483d77b3d/src/Cabin/Hull/Landing/BlogPosts.php#L147\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fparagonie%2Fairship%2Fblob%2F58f96aa0e5002b60e74456502d9bfc9483d77b3d%2Fsrc%2FCabin%2FHull%2FLanding%2FBlogPosts.php%23L147\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/paragonie/airship/blob/58f96aa0e5002b60e74456502d9bfc9483d77b3d/src/Cabin/Hull/Landing/BlogPosts.php#L147\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\n8. \u003ca title=\"https://github.com/paragonie/airship/blob/0e9289553cdc538556d362faaee63be6cc534a0c/tools/hangar/src/Commands/Autorun.php#L61\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fparagonie%2Fairship%2Fblob%2F0e9289553cdc538556d362faaee63be6cc534a0c%2Ftools%2Fhangar%2Fsrc%2FCommands%2FAutorun.php%23L61\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/paragonie/airship/blob/0e9289553cdc538556d362faaee63be6cc534a0c/tools/hangar/src/Commands/Autorun.php#L61\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\n9. \u003ca title=\"https://github.com/paragonie/airship/blob/0e9289553cdc538556d362faaee63be6cc534a0c/tools/hangar/src/Commands/Autorun.php#L81\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fparagonie%2Fairship%2Fblob%2F0e9289553cdc538556d362faaee63be6cc534a0c%2Ftools%2Fhangar%2Fsrc%2FCommands%2FAutorun.php%23L81\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/paragonie/airship/blob/0e9289553cdc538556d362faaee63be6cc534a0c/tools/hangar/src/Commands/Autorun.php#L81\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\n10. \u003ca title=\"https://github.com/paragonie/airship/blob/4aa579c564383355ad3de111a746f14a07164dba/src/config/logger.php#L26\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fparagonie%2Fairship%2Fblob%2F4aa579c564383355ad3de111a746f14a07164dba%2Fsrc%2Fconfig%2Flogger.php%23L26\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/paragonie/airship/blob/4aa579c564383355ad3de111a746f14a07164dba/src/config/logger.php#L26\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\n11. \u003ca title=\"https://github.com/paragonie/halite/blob/8980974467cd54c6d2bb4dd98b2f0e9838570549/autoload.php#L13\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fparagonie%2Fhalite%2Fblob%2F8980974467cd54c6d2bb4dd98b2f0e9838570549%2Fautoload.php%23L13\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/paragonie/halite/blob/8980974467cd54c6d2bb4dd98b2f0e9838570549/autoload.php#L13\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003efix:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003echange strlen usage to CryptoUtil::safeStrlen or Util::safeStrlen or Binary::safeStrlen or Util::stringLength across the codebase.\u003c/li\u003e\n\u003cli\u003echange substr usage to Util::safeSubstr or CryptoUtil::safeSubstr or Binary::safeSubstr across the codebase.\u003c/li\u003e\n\u003c/ol\u003e\n","original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2016-12-13T00:35:51.481Z","allow_singular_disclosure_after":-127627773.97043891,"singular_disclosure_allowed":true,"vote_count":0,"voters":[],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1293275,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for looking through the code. For stuff like this, where there is no security risk (except maybe in extreme corner cases that require extreme creativity to imagine), would you feel comfortable creating a Github issue instead of opening a HackerOne report?","markdown_message":"\u003cp\u003eThanks for looking through the code. For stuff like this, where there is no security risk (except maybe in extreme corner cases that require extreme creativity to imagine), would you feel comfortable creating a Github issue instead of opening a HackerOne report?\u003c/p\u003e\n","automated_response":false,"created_at":"2016-11-10T14:03:10.249Z","updated_at":"2016-11-10T14:03:10.249Z","actor":{"username":"paragonie-scott","cleared":false,"url":"/paragonie-scott","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/051/441/089de22b2f1b80a1e57a2792318dede5cbad81db_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"paragonie","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1293305,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I do open issues that not related to security vulns/risk in any way in Github (from emanuelb)\nin this case I didn't looked in detail for every use-case usage (thus there might be a security risk for some cases, still it's better to fix across the code base (even the non vulnerable code))\nSecurity related issues I prefer to report privately (HackerOne report / email).\nUnfortunately Github don't support private reports (security reports) and all issues reported through it will be public.","markdown_message":"\u003cp\u003eI do open issues that not related to security vulns/risk in any way in Github (from emanuelb)\u003cbr\u003e\nin this case I didn\u0026#39;t looked in detail for every use-case usage (thus there might be a security risk for some cases, still it\u0026#39;s better to fix across the code base (even the non vulnerable code))\u003cbr\u003e\nSecurity related issues I prefer to report privately (HackerOne report / email).\u003cbr\u003e\nUnfortunately Github don\u0026#39;t support private reports (security reports) and all issues reported through it will be public.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-11-10T14:18:26.856Z","updated_at":"2016-11-10T14:20:46.938Z","actor":{"username":"e3amn2l","cleared":false,"url":"/e3amn2l","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"paragonie","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1293316,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Oh, I see.\n\nIn this case, I'm sure there's no danger of `strlen()` or `substr()`. The `Util` functions are meant to provide correctness even with `mbstring.func_overload` enabled. The \"safe\" here isn't about security, rather than a \"you can safely use these functions even in a dangerous configuration setting and get the results you expect\".\n\nSince we're not polyfilling `hash_equals()`, there really aren't many places where an incorrect result could be security critical. See https://github.com/facebook/php-graph-sdk/pull/552#issuecomment-182123879 for one specific scenario.","markdown_message":"\u003cp\u003eOh, I see.\u003c/p\u003e\n\n\u003cp\u003eIn this case, I\u0026#39;m sure there\u0026#39;s no danger of \u003ccode\u003estrlen()\u003c/code\u003e or \u003ccode\u003esubstr()\u003c/code\u003e. The \u003ccode\u003eUtil\u003c/code\u003e functions are meant to provide correctness even with \u003ccode\u003embstring.func_overload\u003c/code\u003e enabled. The \u0026quot;safe\u0026quot; here isn\u0026#39;t about security, rather than a \u0026quot;you can safely use these functions even in a dangerous configuration setting and get the results you expect\u0026quot;.\u003c/p\u003e\n\n\u003cp\u003eSince we\u0026#39;re not polyfilling \u003ccode\u003ehash_equals()\u003c/code\u003e, there really aren\u0026#39;t many places where an incorrect result could be security critical. See \u003ca title=\"https://github.com/facebook/php-graph-sdk/pull/552#issuecomment-182123879\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Ffacebook%2Fphp-graph-sdk%2Fpull%2F552%23issuecomment-182123879\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/facebook/php-graph-sdk/pull/552#issuecomment-182123879\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e for one specific scenario.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-11-10T14:23:21.703Z","updated_at":"2016-11-10T14:23:59.457Z","actor":{"username":"paragonie-scott","cleared":false,"url":"/paragonie-scott","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/051/441/089de22b2f1b80a1e57a2792318dede5cbad81db_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"paragonie","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1293342,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Yeah, I am aware of the mbstring.func_overload mechanism (thanks to reading your comment several months ago :) ), I found other places (not hash_equals related) in other PHP FLOSS projects where incorrect result is security critical, for example which result in following change:\nhttps://github.com/phpmyadmin/phpmyadmin/pull/12616\nthat will refuse to work if mbstring.func_overload enabled, you can do the same for airship (or other projects, but not for libraries (code that other users will reuse))\ncan't share yet the vulnerable place as it's still not patched (above pull request is only in master, next release wasn't released yet)\nregarding paragoinie projects I barely familiar with the code yet (started read it recently) and didn't checked usages, thus can't say for sure (checking = time that will better served for looking into other issues)","markdown_message":"\u003cp\u003eYeah, I am aware of the mbstring.func_overload mechanism (thanks to reading your comment several months ago :) ), I found other places (not hash_equals related) in other PHP FLOSS projects where incorrect result is security critical, for example which result in following change:\u003cbr\u003e\n\u003ca title=\"https://github.com/phpmyadmin/phpmyadmin/pull/12616\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fphpmyadmin%2Fphpmyadmin%2Fpull%2F12616\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/phpmyadmin/phpmyadmin/pull/12616\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nthat will refuse to work if mbstring.func_overload enabled, you can do the same for airship (or other projects, but not for libraries (code that other users will reuse))\u003cbr\u003e\ncan\u0026#39;t share yet the vulnerable place as it\u0026#39;s still not patched (above pull request is only in master, next release wasn\u0026#39;t released yet)\u003cbr\u003e\nregarding paragoinie projects I barely familiar with the code yet (started read it recently) and didn\u0026#39;t checked usages, thus can\u0026#39;t say for sure (checking = time that will better served for looking into other issues)\u003c/p\u003e\n","automated_response":false,"created_at":"2016-11-10T14:44:11.121Z","updated_at":"2016-11-10T14:44:11.121Z","actor":{"username":"e3amn2l","cleared":false,"url":"/e3amn2l","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"paragonie","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1296691,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"\u003e didn't checked usages, thus can't say for sure (checking = time that will better served for looking into other issues)\n\nIndeed. :)\n\nThank you for taking the time to look at all of our code.","markdown_message":"\u003cblockquote\u003e\n\u003cp\u003edidn\u0026#39;t checked usages, thus can\u0026#39;t say for sure (checking = time that will better served for looking into other issues)\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eIndeed. :)\u003c/p\u003e\n\n\u003cp\u003eThank you for taking the time to look at all of our code.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-11-12T23:43:11.461Z","updated_at":"2016-11-12T23:43:11.461Z","actor":{"username":"paragonie-scott","cleared":false,"url":"/paragonie-scott","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/051/441/089de22b2f1b80a1e57a2792318dede5cbad81db_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"paragonie","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1296705,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"The fix for this will be rolled out in 1.4.1.\n\n* https://github.com/paragonie/airship/commit/0344b08f02aab09d49d4db1ed3f6814cc3d9eccc\n* https://github.com/paragonie/airship/commit/eb4293aee5be59e329015520de7e0e44c3593ee6","markdown_message":"\u003cp\u003eThe fix for this will be rolled out in 1.4.1.\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e\u003ca title=\"https://github.com/paragonie/airship/commit/0344b08f02aab09d49d4db1ed3f6814cc3d9eccc\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fparagonie%2Fairship%2Fcommit%2F0344b08f02aab09d49d4db1ed3f6814cc3d9eccc\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/paragonie/airship/commit/0344b08f02aab09d49d4db1ed3f6814cc3d9eccc\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca title=\"https://github.com/paragonie/airship/commit/eb4293aee5be59e329015520de7e0e44c3593ee6\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fparagonie%2Fairship%2Fcommit%2Feb4293aee5be59e329015520de7e0e44c3593ee6\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/paragonie/airship/commit/eb4293aee5be59e329015520de7e0e44c3593ee6\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n","automated_response":false,"created_at":"2016-11-13T00:28:13.278Z","updated_at":"2016-11-13T00:28:13.278Z","actor":{"username":"paragonie-scott","cleared":false,"url":"/paragonie-scott","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/051/441/089de22b2f1b80a1e57a2792318dede5cbad81db_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"e3amn2l","url":"/e3amn2l"},"genius_execution_id":null,"team_handle":"paragonie","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1296715,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-11-13T00:35:51.467Z","updated_at":"2016-11-13T00:35:51.467Z","first_to_agree":true,"actor":{"username":"paragonie-scott","cleared":false,"url":"/paragonie-scott","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/051/441/089de22b2f1b80a1e57a2792318dede5cbad81db_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"paragonie","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1296724,"is_internal":false,"editable":false,"type":"Activities::ManuallyDisclosed","message":"","markdown_message":"","automated_response":false,"created_at":"2016-11-13T00:43:30.403Z","updated_at":"2016-11-13T00:43:30.403Z","actor":{"username":"paragonie-scott","cleared":false,"url":"/paragonie-scott","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/051/441/089de22b2f1b80a1e57a2792318dede5cbad81db_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"paragonie","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1322058,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"for anyone who read my previous comments (as this report is public), regarding the security issue in PHPMyAdmin that exists when mbstring.func_overload is enabled, it's fixed in 4.6.5 by commit:\nhttps://github.com/phpmyadmin/phpmyadmin/pull/12616\nand in Debian package partially (when apache is used) by commit:\nhttps://anonscm.debian.org/git/collab-maint/phpmyadmin.git/commit/?id=e87a428ec42883340708a502407179b4bff0583d\nit enable bypassing the function PMA_safeUnserialize, which introduced as fix for:\nhttps://www.phpmyadmin.net/security/PMASA-2016-43/\nThe latest release contain another bypass of PMA_safeUnserialize which fixed in:\nhttps://www.phpmyadmin.net/security/PMASA-2016-70/\n\nThe bypass when mbstring.func_overload is enabled isn't mentioned in changelog/security advisories, the function PMA_safeUnserialize is still vulnerable as is, but PMA decline to work if mbstring.func_overload is enabled.\nPOC:\nrun:\n```\nphp -d mbstring.func_overload=2 ./poc.php\n```\npoc.php content: (using symbol https://en.wiktionary.org/wiki/%F0%A0%9C%8E)\n```\n\u003c?php\n$safeUnserializeBypass='a:3:{i:0;s:16:\"𠜎𠜎𠜎𠜎\";i:1;O:8:\"stdClass\":0:{}s:4:\"abcd\";s:44:\"abcdefga23hi𠜎qwer𠜎ty𠜎ab𠜎a𠜎;:A\";}';\nvar_dump(PMA_safeUnserialize($safeUnserializeBypass));\n?\u003e","markdown_message":"\u003cp\u003efor anyone who read my previous comments (as this report is public), regarding the security issue in PHPMyAdmin that exists when mbstring.func_overload is enabled, it\u0026#39;s fixed in 4.6.5 by commit:\u003cbr\u003e\n\u003ca title=\"https://github.com/phpmyadmin/phpmyadmin/pull/12616\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fphpmyadmin%2Fphpmyadmin%2Fpull%2F12616\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/phpmyadmin/phpmyadmin/pull/12616\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nand in Debian package partially (when apache is used) by commit:\u003cbr\u003e\n\u003ca title=\"https://anonscm.debian.org/git/collab-maint/phpmyadmin.git/commit/?id=e87a428ec42883340708a502407179b4bff0583d\" href=\"/redirect?url=https%3A%2F%2Fanonscm.debian.org%2Fgit%2Fcollab-maint%2Fphpmyadmin.git%2Fcommit%2F%3Fid%3De87a428ec42883340708a502407179b4bff0583d\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://anonscm.debian.org/git/collab-maint/phpmyadmin.git/commit/?id=e87a428ec42883340708a502407179b4bff0583d\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nit enable bypassing the function PMA_safeUnserialize, which introduced as fix for:\u003cbr\u003e\n\u003ca title=\"https://www.phpmyadmin.net/security/PMASA-2016-43/\" href=\"/redirect?url=https%3A%2F%2Fwww.phpmyadmin.net%2Fsecurity%2FPMASA-2016-43%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.phpmyadmin.net/security/PMASA-2016-43/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nThe latest release contain another bypass of PMA_safeUnserialize which fixed in:\u003cbr\u003e\n\u003ca title=\"https://www.phpmyadmin.net/security/PMASA-2016-70/\" href=\"/redirect?url=https%3A%2F%2Fwww.phpmyadmin.net%2Fsecurity%2FPMASA-2016-70%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.phpmyadmin.net/security/PMASA-2016-70/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eThe bypass when mbstring.func_overload is enabled isn\u0026#39;t mentioned in changelog/security advisories, the function PMA_safeUnserialize is still vulnerable as is, but PMA decline to work if mbstring.func_overload is enabled.\u003cbr\u003e\nPOC:\u003cbr\u003e\nrun:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ephp -d mbstring.func_overload=2 ./poc.php\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003epoc.php content: (using symbol \u003ca title=\"https://en.wiktionary.org/wiki/%F0%A0%9C%8E\" href=\"/redirect?url=https%3A%2F%2Fen.wiktionary.org%2Fwiki%2F%25F0%25A0%259C%258E\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://en.wiktionary.org/wiki/%F0%A0%9C%8E\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e)\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight php\"\u003e\u003ccode\u003e\u003cspan class=\"cp\"\u003e\u0026lt;?php\u003c/span\u003e\n\u003cspan class=\"nv\"\u003e$safeUnserializeBypass\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;a:3:{i:0;s:16:\u0026quot;𠜎𠜎𠜎𠜎\u0026quot;;i:1;O:8:\u0026quot;stdClass\u0026quot;:0:{}s:4:\u0026quot;abcd\u0026quot;;s:44:\u0026quot;abcdefga23hi𠜎qwer𠜎ty𠜎ab𠜎a𠜎;:A\u0026quot;;}\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"nb\"\u003evar_dump\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ePMA_safeUnserialize\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$safeUnserializeBypass\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n\u003cspan class=\"cp\"\u003e?\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","automated_response":false,"created_at":"2016-11-27T23:42:22.704Z","updated_at":"2016-11-27T23:42:22.704Z","actor":{"username":"e3amn2l","cleared":false,"url":"/e3amn2l","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"paragonie","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1653847,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"Not security-affecting in the context of Airship, but better code consistency makes life easier for all parties.","markdown_message":"\u003cp\u003eNot security-affecting in the context of Airship, but better code consistency makes life easier for all parties.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-05-04T14:19:41.575Z","updated_at":"2017-05-04T14:19:41.575Z","actor":{"url":"/paragonie","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/539/72f76fed45e5220b47ba2f679371ebf9ccb19c70_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Paragon Initiative Enterprises"}},"genius_execution_id":null,"team_handle":"paragonie","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}