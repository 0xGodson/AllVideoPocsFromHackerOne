{"id":401483,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC80MDE0ODM=","url":"https://hackerone.com/reports/401483","title":"[chaturbate.com] - CSRF Vulnerability on image upload","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2018-08-28T04:50:16.484Z","submitted_at":"2018-08-28T04:50:16.484Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"corb3nik","url":"/corb3nik","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/wVdvnChZPXG1bBFTnfDMx3zU/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":30475,"url":"https://hackerone.com/chaturbate","handle":"chaturbate","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/030/475/178c32f60a890eb06ce5d698d44b3eafa35ccf8c_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/030/475/178c32f60a890eb06ce5d698d44b3eafa35ccf8c_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Chaturbate","twitter_handle":"chaturbate","website":"https://chaturbate.com","about":"The largest online adult cam site"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2018-09-19T22:40:09.218Z","bug_reporter_agreed_on_going_public_at":"2018-09-19T22:40:09.111Z","team_member_agreed_on_going_public_at":"2018-09-19T22:32:50.809Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"##Summary##\n\nHi guys,\n\nOne of the features available to a Chaturbate user is the ability to upload images into photo sets. The upload functionality does not use any CSRF tokens, allowing attackers to perform CSRF attacks and upload images to a user's profile without the user's consent.\n\n\n## Steps To Reproduce:\n\n1. Login to Chaturbate.\n2. Browse to your profile page and upload an image.\n3. Note the `set` ID of the newly created set (this is available by visiting set in the profile page. It'll be in the URL : `https://chaturbate.com/photo_videos/photoset/detail/[username]/[set_id]/`).\n4. Download the poc.html file attached to this report.\n5. Edit `poc.html` by replacing the number `4771110` by the `set` ID found at step #3.\n6. Open poc.html and click on `Submit request`.\n7. Visit your Chaturbate image set.\n\nYou'll notice that the photo set now inludes an additional image (a blank/white image).\n\n## Impact\n\nIn order for this attack to work, an attacker would need to know the correct photo set ID. Since set IDs are public information, this isn't an issue.\n\nI've set the impact here to medium since this affects the integrity of user accounts.","vulnerability_information_html":"\u003ch2 id=\"summary\"\u003eSummary\u003c/h2\u003e\n\n\u003cp\u003eHi guys,\u003c/p\u003e\n\n\u003cp\u003eOne of the features available to a Chaturbate user is the ability to upload images into photo sets. The upload functionality does not use any CSRF tokens, allowing attackers to perform CSRF attacks and upload images to a user\u0026#39;s profile without the user\u0026#39;s consent.\u003c/p\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps To Reproduce:\u003c/h2\u003e\n\n\u003col\u003e\n\u003cli\u003eLogin to Chaturbate.\u003c/li\u003e\n\u003cli\u003eBrowse to your profile page and upload an image.\u003c/li\u003e\n\u003cli\u003eNote the \u003ccode\u003eset\u003c/code\u003e ID of the newly created set (this is available by visiting set in the profile page. It\u0026#39;ll be in the URL : \u003ccode\u003ehttps://chaturbate.com/photo_videos/photoset/detail/[username]/[set_id]/\u003c/code\u003e).\u003c/li\u003e\n\u003cli\u003eDownload the poc.html file attached to this report.\u003c/li\u003e\n\u003cli\u003eEdit \u003ccode\u003epoc.html\u003c/code\u003e by replacing the number \u003ccode\u003e4771110\u003c/code\u003e by the \u003ccode\u003eset\u003c/code\u003e ID found at step #3.\u003c/li\u003e\n\u003cli\u003eOpen poc.html and click on \u003ccode\u003eSubmit request\u003c/code\u003e.\u003c/li\u003e\n\u003cli\u003eVisit your Chaturbate image set.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eYou\u0026#39;ll notice that the photo set now inludes an additional image (a blank/white image).\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eIn order for this attack to work, an attacker would need to know the correct photo set ID. Since set IDs are public information, this isn\u0026#39;t an issue.\u003c/p\u003e\n\n\u003cp\u003eI\u0026#39;ve set the impact here to medium since this affects the integrity of user accounts.\u003c/p\u003e\n","bounty_amount":"300.0","formatted_bounty":"$300","original_report_id":null,"original_report_url":null,"attachments":[{"id":338757,"file_name":"csrf_poc.html","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/338/757/1933d181e6931d4bd3d8fd90127c8baa7e09cf2e/csrf_poc.html?response-content-disposition=attachment%3B%20filename%3D%22csrf_poc.html%22%3B%20filename%2A%3DUTF-8%27%27csrf_poc.html\u0026response-content-type=application%2Foctet-stream\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQRWTAI2C7%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T055134Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIA4OnjXKFXegILmjBXgWPi%2Bteogg5H0LMBKKhsAnJHN7AiB63uA2f%2F%2F5YDRnlhtKi%2FXhk22EJKrVEePJyA5BB6daFCq0AwhVEAEaDDAxMzYxOTI3NDg0OSIM53ag7gGyZZO8130kKpEDyciZp2ZqDzsBi%2FORe9ONiGdtsWokZ6RNGwhOQ%2FCYjspqizBK8MFrrsG4EhCD7nQo3op7z5QpG4etJhRbGyk9ZMs1Bf11meT%2FBjo9u%2BckMiDjlcIlq5R15HOU7s1EHTqrLA36yUMOeyS29kSrYPqvMoLO2rWkUVucCUcQDlInVAw2uEr44ZvPlLBsyZb0G%2FT2OtLSV2vBgLI8dwRiyR%2B%2FkWbj5vpXWDXwAuLlH42qzINlU8oR6OvGnSCX5MCSpLVFjgxe2PhQ%2BxcvVQajoQ9vfI4lq%2FEF42OjdLcTp7fqirHlY5gZzbp%2B1h9WpBX1bN3bp5CKCkKnLhLqHodDNw6c1AzplZQntDSI7S7QWvohyZhSzrmIQHIVyNLGZgXx6b0918BQ6OX2S%2BdvH5OV4Wb7a7Im2%2FUTY072IM3MaRPN2Rpj1HVuQswZAJU0R8hS1MC9eqfkEttWFx0QKe6oUQCIGOaOP4bGspe1UVDGayXri6eNBeq8XJKWe0GMnG2omCWNNKKzrBDmqhOtnjYVc9W8bFQwytqq%2FwU67AE09XlDlPXYy%2BHJOKHdFHcwWreDNKw1sbWRzs1%2F5NkOvu7lAUwpxtXVP%2BePBhXceOPXQGHu9DsdsNPyO%2BGsOCZ66BYQBtsR104YSbyUKzHudK2y47O8h0exzqJ7%2BP3su6UkIEAf5z9ad88cXbwQThNPl6z3JfRt1ENAowPGLR%2F%2Frhm74kAezWUMRLV2tE7TC7gPDHdvS4bcrFlZ2adOF78IlYHd0DR95sTWHneHqzp4qzlglFCkHtDqf%2BuZWboHX83v76e19laPwMwL5yTDCuQHztQ0TyuFtL%2BCtEsk6OY%2BMny6lDUXH9NnZhbaIw%3D%3D\u0026X-Amz-Signature=b440d172f7849bac2f8bbf2f978e4fce59b09ec838d255dbd70e3a709d9e36b4","file_size":13322,"type":"text/html"}],"allow_singular_disclosure_at":"2018-10-19T22:32:50.993Z","allow_singular_disclosure_after":-69232723.42708687,"singular_disclosure_allowed":true,"vote_count":9,"voters":["ramsexy","mygf","eveeez","mefkan","hkr0x01","cryptographer","mozafer786","v13rsba","mezojm10"],"severity":{"rating":"medium","score":4.3,"author_type":"User","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"none","user_interaction":"required","scope":"unchanged","confidentiality":"none","integrity":"low","availability":"none"}},"structured_scope":{"databaseId":11722,"asset_type":"URL","asset_identifier":"https://chaturbate.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":3256598,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thanks for the report! This is definitely a bug, we'll get it fixed.","markdown_message":"\u003cp\u003eThanks for the report! This is definitely a bug, we\u0026#39;ll get it fixed.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-08-28T05:37:00.799Z","updated_at":"2018-08-28T05:37:00.799Z","actor":{"username":"williammmllc","cleared":false,"url":"/williammmllc","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"chaturbate","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3260814,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2018-08-28T22:43:41.700Z","updated_at":"2018-08-28T22:43:41.700Z","actor":{"url":"/chaturbate","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/030/475/178c32f60a890eb06ce5d698d44b3eafa35ccf8c_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Chaturbate"}},"bounty_amount":"300.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"chaturbate","collaborator":{"username":"corb3nik","url":"/corb3nik"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3265678,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"This has been fixed on our end, could you please confirm @corb3nik?","markdown_message":"\u003cp\u003eThis has been fixed on our end, could you please confirm \u003ca href=\"/corb3nik\"\u003e@corb3nik\u003c/a\u003e?\u003c/p\u003e\n","automated_response":false,"created_at":"2018-08-29T20:55:44.018Z","updated_at":"2018-08-29T20:55:44.018Z","actor":{"username":"pooyammllc","cleared":false,"url":"/pooyammllc","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"corb3nik","url":"/corb3nik"},"genius_execution_id":null,"team_handle":"chaturbate","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3265696,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @pooyammllc! It seems that you have added an `X-CSRFToken` header to the upload request. This fixes the issue :)\n\nThanks for the quick bounty and for the awesome time-to-resolution!","markdown_message":"\u003cp\u003eHi \u003ca href=\"/pooyammllc\"\u003e@pooyammllc\u003c/a\u003e! It seems that you have added an \u003ccode\u003eX-CSRFToken\u003c/code\u003e header to the upload request. This fixes the issue :)\u003c/p\u003e\n\n\u003cp\u003eThanks for the quick bounty and for the awesome time-to-resolution!\u003c/p\u003e\n","automated_response":false,"created_at":"2018-08-29T21:01:32.560Z","updated_at":"2018-08-29T21:01:32.560Z","actor":{"username":"corb3nik","cleared":true,"url":"/corb3nik","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/wVdvnChZPXG1bBFTnfDMx3zU/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"chaturbate","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3360421,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-09-19T22:32:50.839Z","updated_at":"2018-09-19T22:32:50.839Z","first_to_agree":true,"actor":{"username":"williammmllc","cleared":false,"url":"/williammmllc","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"chaturbate","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3360438,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-09-19T22:40:09.141Z","updated_at":"2018-09-19T22:40:09.141Z","actor":{"username":"corb3nik","cleared":true,"url":"/corb3nik","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/wVdvnChZPXG1bBFTnfDMx3zU/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"chaturbate","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3360439,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-09-19T22:40:09.249Z","updated_at":"2018-09-19T22:40:09.249Z","actor":{"username":"corb3nik","cleared":true,"url":"/corb3nik","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/wVdvnChZPXG1bBFTnfDMx3zU/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"chaturbate","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}