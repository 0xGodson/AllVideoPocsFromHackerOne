{"id":121696,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMjE2OTY=","url":"https://hackerone.com/reports/121696","title":"Bypass  two-factor authentication","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-03-09T11:16:26.373Z","submitted_at":"2016-03-09T11:16:26.373Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"kamikaze","url":"/kamikaze","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":69,"url":"https://hackerone.com/slack","handle":"slack","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/069/683fee312381bc46cadc7ea1950abc87944d12c3_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/069/683fee312381bc46cadc7ea1950abc87944d12c3_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Slack","twitter_handle":"slackhq","website":"https://slack.com","about":"All your team communication in one place, instantly searchable, and available wherever you go."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-11-18T12:00:15.780Z","bug_reporter_agreed_on_going_public_at":"2017-10-19T12:00:10.714Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"If a user set 2FA, a user has to enter verification code when a user tries to reset password. \n\nUnder the \"Password Reset\" page, a user can enter wrong two-factor authentication code many times. I said \"many times\" because your bug bounty policy stated...\n\nExclusions\n\nIssues found through automated testing\n\nSo, I may not be allowed to brute force in order to check how many times a user can enter wrong 2FA codes. I didn't use any automated tools and didn't brute force for my testing.\n\nI tested that I could still reset my password after I entered wrong 2FA codes 20 times manually. It seems that a user can brute force 2FA codes.\n\n-----step to reproduce-----\n\n1. A user sends a password reset message to user's registered email.\n\n2. Go to \"Password Reset\" page from #1's message.\n\n3. Set a new password and Brute force two-factor auth code\n\n----------------------------------\n\nAfter a user reset password, a user will go to slack's home page. From that page a user can do anything. \n\nTwo factor authentication is another layer of protection. Even if a user leaked email address and password, a user will be protected by additional security(2FA). \n\nIf an attacker hacked victim's email, an attacker will be able to take over slack's 2FA enabled account by brute forcing 2FA code on password reset page.\n\nRecommendation: If a user entered wrong 2FA codes many times, a user will be blocked temporary.\n","vulnerability_information_html":"\u003cp\u003eIf a user set 2FA, a user has to enter verification code when a user tries to reset password. \u003c/p\u003e\n\n\u003cp\u003eUnder the \u0026quot;Password Reset\u0026quot; page, a user can enter wrong two-factor authentication code many times. I said \u0026quot;many times\u0026quot; because your bug bounty policy stated...\u003c/p\u003e\n\n\u003cp\u003eExclusions\u003c/p\u003e\n\n\u003cp\u003eIssues found through automated testing\u003c/p\u003e\n\n\u003cp\u003eSo, I may not be allowed to brute force in order to check how many times a user can enter wrong 2FA codes. I didn\u0026#39;t use any automated tools and didn\u0026#39;t brute force for my testing.\u003c/p\u003e\n\n\u003cp\u003eI tested that I could still reset my password after I entered wrong 2FA codes 20 times manually. It seems that a user can brute force 2FA codes.\u003c/p\u003e\n\n\u003cp\u003e-----step to reproduce-----\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003e\u003cp\u003eA user sends a password reset message to user\u0026#39;s registered email.\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eGo to \u0026quot;Password Reset\u0026quot; page from #1\u0026#39;s message.\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eSet a new password and Brute force two-factor auth code\u003c/p\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003chr\u003e\n\n\u003cp\u003eAfter a user reset password, a user will go to slack\u0026#39;s home page. From that page a user can do anything. \u003c/p\u003e\n\n\u003cp\u003eTwo factor authentication is another layer of protection. Even if a user leaked email address and password, a user will be protected by additional security(2FA). \u003c/p\u003e\n\n\u003cp\u003eIf an attacker hacked victim\u0026#39;s email, an attacker will be able to take over slack\u0026#39;s 2FA enabled account by brute forcing 2FA code on password reset page.\u003c/p\u003e\n\n\u003cp\u003eRecommendation: If a user entered wrong 2FA codes many times, a user will be blocked temporary.\u003c/p\u003e\n","bounty_amount":"500.0","formatted_bounty":"$500","weakness":{"id":27,"name":"Improper Authentication - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":77484,"file_name":"slack-password.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/077/484/c61f193ecbcaae3a03d44ce958f80c06bfcebec7/slack-password.png?response-content-disposition=attachment%3B%20filename%3D%22slack-password.png%22%3B%20filename%2A%3DUTF-8%27%27slack-password.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQYMVJENU6%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T042048Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJj%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDWBybDR3vqhcsLBSMk4%2B6P70Ud7eobaXGJmgB%2FHdxqCQIhANWsU51SqowXMmzbNIfK2pdim%2BgV3mQKWL%2FoNTr7y%2BXnKrQDCFEQARoMMDEzNjE5Mjc0ODQ5IgwVkuDdHKaHnFcy6foqkQMHSD9Lwk3G5nXNsgTE1I8L%2FxERDRm3%2FwUHGtqbcqWj8jHUHsiWc0cuMBCUgqjP7pOrgAWXPwSKRqGfafgzzyUteQgmLfDIZpwZZO81EZGgAEdp5E%2F2tBncLnh8ZJrCx1P8EmxR6%2Fo8vkF%2FuWOPJHhHJ2lZyEsbjRzNcQVb%2Fs7CNO5bq2zKtHPwg3C2%2Fo93S9si0IG2AHXGWlnAyij4fRQj6uwJQDGyJlOTWttICHGK4AhYMsL%2Fq0aTm792kd%2BkVeyySD0SgMka0Wq%2FLYnfvzpnIr6zq4ci4bh16b3oqaEB2qu%2B8Py2%2FrJqPIWmi9Gr4RYZH66IXOCLUFGFoL7%2FsdCJDHTy96SorDYSjRUAX6AnBb2%2BuQCKobl6A8PqHt6GIkexPyANWYD9UBBSoObzADm0EHpYf92QwrH85lDqfrE2608E%2BimFNYNs837N%2B%2BJ5e%2FLjI8CS4T%2BlvtfQ7gpk51s4g%2BuSdgjxrq11GhXx2Zm9KTkYc%2BazRqrSv12NTkj%2BiVjkzdX6KN6BUov3zndl%2F%2FWJHTC26qn%2FBTrqAa4l0p0G3kOLPeJ6QAhfVAW73vQA4dhMb6NjYVGNoVZWymk4%2BnyrxPSLgH6TjoldACc7Frzg8xwKr8bfp2yW0NADmrnAq%2BU8nVey7H%2FI%2FoXUWj%2FymOC1jAi02%2BBYJGMUz6qpIzeqj9m8H%2Bl96OuDejTKuHxueDmtYdH2wZFcrPixAjJ8zlSb7j2DKlSQCR%2BUjkw0%2Bi1e818DdrHBp%2BPRvDG%2FpIyFaeXaRuomWdaFOSF70HxUwxdFHg7GvBA2pEDNV34SrACAjARy0ifYBTStiJzmvr8mPk%2FH%2FXLhlmkIY1Hw7L%2FyR4lry8ZFSA%3D%3D\u0026X-Amz-Signature=6eb3d9d69bf428d1ea9b3ce6c798ca3028bfd7aaaa4d8ad418edbc547109e736","file_size":113845,"type":"image/png"}],"allow_singular_disclosure_at":"2017-11-18T12:00:10.840Z","allow_singular_disclosure_after":-98209238.14821178,"singular_disclosure_allowed":true,"vote_count":26,"voters":["jokebookservice1","arkaic","jensec","bl4de","eveeez","r3y","khizer47","kamikaze","t-4-y-m","cr4xerbik4sh","and 16 more..."],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":841399,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2016-03-15T17:01:24.861Z","updated_at":"2016-03-15T17:01:24.861Z","actor":{"username":"slacka","cleared":false,"url":"/slacka","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"slack","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":866265,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2016-03-23T23:41:46.985Z","updated_at":"2016-03-23T23:41:46.985Z","actor":{"url":"/slack","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/069/683fee312381bc46cadc7ea1950abc87944d12c3_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Slack"}},"bounty_amount":"500.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"slack","collaborator":{"username":"kamikaze","url":"/kamikaze"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":866269,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hi kamikaze,\n\nWe've made some rate-limiting changes as a result of your report. Thanks for taking the time to test this and best of luck with future bug hunting!\n\n-Leigh","markdown_message":"\u003cp\u003eHi kamikaze,\u003c/p\u003e\n\n\u003cp\u003eWe\u0026#39;ve made some rate-limiting changes as a result of your report. Thanks for taking the time to test this and best of luck with future bug hunting!\u003c/p\u003e\n\n\u003cp\u003e-Leigh\u003c/p\u003e\n","automated_response":false,"created_at":"2016-03-23T23:43:14.530Z","updated_at":"2016-03-23T23:43:14.530Z","actor":{"username":"leighhoneywell","cleared":false,"url":"/leighhoneywell","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/034/411/956aec0fd38fb8e9577a2f87a2d5e33ee4eb8a9e_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"kamikaze","url":"/kamikaze"},"genius_execution_id":null,"team_handle":"slack","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2083919,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-10-19T12:00:10.773Z","updated_at":"2017-10-19T12:00:10.773Z","first_to_agree":true,"actor":{"username":"kamikaze","cleared":false,"url":"/kamikaze","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"slack","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2167342,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-11-18T12:00:15.820Z","updated_at":"2017-11-18T12:00:15.820Z","actor":{"url":"/slack","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/069/683fee312381bc46cadc7ea1950abc87944d12c3_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Slack"}},"genius_execution_id":null,"team_handle":"slack","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}