{"id":116570,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMTY1NzA=","url":"https://hackerone.com/reports/116570","title":"VERY DANGEROUS XSS STORED inside emails ","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-02-15T15:31:02.388Z","submitted_at":"2016-02-15T15:31:02.388Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"seifelsallamy","url":"/seifelsallamy","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/003/804/747fe8def9e5ba028d0fbf0ac755a88ea4992d3f_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":65,"url":"https://hackerone.com/mailru","handle":"mailru","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/065/1ec04a6b87b02422d913b5c53d5247de91d64718_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/065/1ec04a6b87b02422d913b5c53d5247de91d64718_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Mail.ru","twitter_handle":"mailru","website":"https://corp.mail.ru","about":"Building the Internet since 1998"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2016-04-07T10:57:53.633Z","bug_reporter_agreed_on_going_public_at":"2016-04-01T19:32:52.619Z","team_member_agreed_on_going_public_at":"2016-04-07T10:57:53.378Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi guys,\nThis bug is very dangerous you should fix it as fast as you can \n######To reproduce:\nAttach xss.eml file to a message and send it\nwhen a user open the message the javascript will be executed and xss alert box will popup\nthis bug affect tel.mail.ru , m.mail.ru and light.mail.ru\nbut i couldn't reproduce it on e.mail.ru and touch.mail.ru\n######Notes:\nwhen a user attach an email (eml file) to a message \nyour website changes the email file name automatically to the subject content in the email file\nEg:\nif the file name is xss.eml\nand the content is\nSubject: \u003cscript\u003ealert(\"XSS\")\u003c/script\u003e\nyour website will change the file name to\n\u003cscript\u003ealert(\"XSS\")\u003c/script\u003e.eml\nand the javascript will be executed \n######POC:\nI uploaded a video\n\nThank you!!","vulnerability_information_html":"\u003cp\u003eHi guys,\u003cbr\u003e\nThis bug is very dangerous you should fix it as fast as you can \u003c/p\u003e\n\n\u003ch6 id=\"to-reproduce\"\u003eTo reproduce:\u003c/h6\u003e\n\n\u003cp\u003eAttach xss.eml file to a message and send it\u003cbr\u003e\nwhen a user open the message the javascript will be executed and xss alert box will popup\u003cbr\u003e\nthis bug affect tel.mail.ru , m.mail.ru and light.mail.ru\u003cbr\u003e\nbut i couldn\u0026#39;t reproduce it on e.mail.ru and touch.mail.ru\u003c/p\u003e\n\n\u003ch6 id=\"notes\"\u003eNotes:\u003c/h6\u003e\n\n\u003cp\u003ewhen a user attach an email (eml file) to a message \u003cbr\u003e\nyour website changes the email file name automatically to the subject content in the email file\u003cbr\u003e\nEg:\u003cbr\u003e\nif the file name is xss.eml\u003cbr\u003e\nand the content is\u003cbr\u003e\nSubject: \u0026lt;script\u0026gt;alert(\u0026quot;XSS\u0026quot;)\u0026lt;/script\u0026gt;\u003cbr\u003e\nyour website will change the file name to\u003cbr\u003e\n\u0026lt;script\u0026gt;alert(\u0026quot;XSS\u0026quot;)\u0026lt;/script\u0026gt;.eml\u003cbr\u003e\nand the javascript will be executed \u003c/p\u003e\n\n\u003ch6 id=\"poc\"\u003ePOC:\u003c/h6\u003e\n\n\u003cp\u003eI uploaded a video\u003c/p\u003e\n\n\u003cp\u003eThank you!!\u003c/p\u003e\n","bounty_amount":"600.0","formatted_bounty":"$600","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":73590,"file_name":"StoredXSSinMessagesAtMail.RU.avi","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/073/590/46e9f532674566cc5e2d5b3c5a89f7570b9256d4/StoredXSSinMessagesAtMail.RU.avi?response-content-disposition=attachment%3B%20filename%3D%22StoredXSSinMessagesAtMail.RU.avi%22%3B%20filename%2A%3DUTF-8%27%27StoredXSSinMessagesAtMail.RU.avi\u0026response-content-type=video%2Fx-msvideo\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ6SZWJ7EV%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T041841Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQDnUzI%2BFGOFBLAScWuVOL4Lj3JmbbQAzP3Z0CGixtLCuAIgQzjjEEfRLfyvyTUcWPuh1TmLwtvXfhn4Y1cmYaMrO6cqtAMIVRABGgwwMTM2MTkyNzQ4NDkiDGp%2BpnVA5musWTL7NCqRA8%2FtWDfuTNl%2BTEZ8%2F83sOgEjGfhPO7hqas9S5YFvyrG29udKPmtcuewMHQFGoWh6uvbSTE9LPEkFDl6RosJJJY3ZsFaD9BGxtIOBINUPfZd26XnOL01fuCQ8x%2BiErJvv8vHBR5mWXV7L6t7A2%2F5H8dY91iEQFmPdZboRnRed4t2q9jcZCwrkzHwMk8bNRFkfRqzqUB6%2Buk39e4oyKwiyqROwDwnoUxIOrVdA29STuUYzszGBQ%2B3Eg%2Fr4I9Ys7sDaoYDHJAVEt%2F6kVnewTLU3uHfL%2F%2FzDR0ZnJa5Oo%2BmValn4%2Fn34Ke7o7csnn3piiGYIK4mihEWUVtJZnq0bZ%2BEU14q4ZLfb79tvTTKy5%2B9XC3vM1tWdFU6K%2F2PISAY5LoVEscNgJL0aQIq7sAX0f00Uyo2TeQTR%2B9TUOeUvW40metpNAt6ZQ8u0%2BuTZij%2FLNaYEe6v5RA7Fg8wzm%2Bu7IVusddMT4HgUuba3afxdFVj8x9iXROa6QZZ%2BdlHYNGywE8eJxO3jkpwbaZpUg8PZ17ztcb5%2BMLHSqv8FOusBshs3Z1RNetRK0o6yVAL2zGdldUlxbnMrusEP31v5WyfcSXKYrW1oJGSAAOlTEHZOawyDOEVKZdmLftLsa7vpv4NkkvDc0MjvNZjQrLWiuTmEalVC704buBLYftchmedTLOrsCMIpwWkxoPJnEqO2VZwPnup4B1lMH%2B%2FHO0btRwbDEfX1bZu7nae%2FPoCvN9o%2FT1iQ8GcaSv5OUJxppuy2cagjSuiUWEkOXPhYiBKpxTQMFIMtd6%2FpRtJ2YeCQgmRXXl1K6ayBDQAQxWFeKQPM5vtrAzDrzE9Adaqtb3AdlxqDjg74xdcM9YFdyg%3D%3D\u0026X-Amz-Signature=7aa9fea8cb9b7ddac50425c4374b3dc185b543f131376152876b73f229796d6e","file_size":4161872,"type":"video/x-msvideo"},{"id":73594,"file_name":"xss.eml","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/073/594/462348320f9994f0dad05e114991c7e6c4ed3b64/xss.eml?response-content-disposition=attachment%3B%20filename%3D%22xss.eml%22%3B%20filename%2A%3DUTF-8%27%27xss.eml\u0026response-content-type=application%2Foctet-stream\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ6SZWJ7EV%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T041841Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQDnUzI%2BFGOFBLAScWuVOL4Lj3JmbbQAzP3Z0CGixtLCuAIgQzjjEEfRLfyvyTUcWPuh1TmLwtvXfhn4Y1cmYaMrO6cqtAMIVRABGgwwMTM2MTkyNzQ4NDkiDGp%2BpnVA5musWTL7NCqRA8%2FtWDfuTNl%2BTEZ8%2F83sOgEjGfhPO7hqas9S5YFvyrG29udKPmtcuewMHQFGoWh6uvbSTE9LPEkFDl6RosJJJY3ZsFaD9BGxtIOBINUPfZd26XnOL01fuCQ8x%2BiErJvv8vHBR5mWXV7L6t7A2%2F5H8dY91iEQFmPdZboRnRed4t2q9jcZCwrkzHwMk8bNRFkfRqzqUB6%2Buk39e4oyKwiyqROwDwnoUxIOrVdA29STuUYzszGBQ%2B3Eg%2Fr4I9Ys7sDaoYDHJAVEt%2F6kVnewTLU3uHfL%2F%2FzDR0ZnJa5Oo%2BmValn4%2Fn34Ke7o7csnn3piiGYIK4mihEWUVtJZnq0bZ%2BEU14q4ZLfb79tvTTKy5%2B9XC3vM1tWdFU6K%2F2PISAY5LoVEscNgJL0aQIq7sAX0f00Uyo2TeQTR%2B9TUOeUvW40metpNAt6ZQ8u0%2BuTZij%2FLNaYEe6v5RA7Fg8wzm%2Bu7IVusddMT4HgUuba3afxdFVj8x9iXROa6QZZ%2BdlHYNGywE8eJxO3jkpwbaZpUg8PZ17ztcb5%2BMLHSqv8FOusBshs3Z1RNetRK0o6yVAL2zGdldUlxbnMrusEP31v5WyfcSXKYrW1oJGSAAOlTEHZOawyDOEVKZdmLftLsa7vpv4NkkvDc0MjvNZjQrLWiuTmEalVC704buBLYftchmedTLOrsCMIpwWkxoPJnEqO2VZwPnup4B1lMH%2B%2FHO0btRwbDEfX1bZu7nae%2FPoCvN9o%2FT1iQ8GcaSv5OUJxppuy2cagjSuiUWEkOXPhYiBKpxTQMFIMtd6%2FpRtJ2YeCQgmRXXl1K6ayBDQAQxWFeKQPM5vtrAzDrzE9Adaqtb3AdlxqDjg74xdcM9YFdyg%3D%3D\u0026X-Amz-Signature=4d5ee852e360da260c9abac341afd8968aeb39ddba99c7dca1c9d4c3b06b07b4","file_size":40,"type":"text/html"}],"allow_singular_disclosure_at":"2016-05-01T19:32:52.887Z","allow_singular_disclosure_after":-147084348.1351743,"singular_disclosure_allowed":true,"vote_count":6,"voters":["sodium_","its_afolic","spetr0x","dyabla","imim","fvv"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":798482,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thank you for reporting your bug to Mail.Ru Group!   We appreciate your time for helping us to make our web services safer.\nWe are currently reviewing your submission and will be back in touch soon.","markdown_message":"\u003cp\u003eThank you for reporting your bug to Mail.Ru Group!   We appreciate your time for helping us to make our web services safer.\u003cbr\u003e\nWe are currently reviewing your submission and will be back in touch soon.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-02-15T15:38:10.119Z","updated_at":"2016-02-15T15:38:10.119Z","actor":{"username":"3apa3a","cleared":false,"url":"/3apa3a","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/836/57b93fd96b524d0ed13eef717ecd070ad8468f86_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":801398,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Hello, \n\nbug bounty reward is transferred to your account. You can set payment options and request payout via\nhttps://hackerone.com/settings/bounties\n\nThanks again,\nwaiting for new bug reports from you.\n\nP.S. we are still working to resolve this problem","markdown_message":"\u003cp\u003eHello, \u003c/p\u003e\n\n\u003cp\u003ebug bounty reward is transferred to your account. You can set payment options and request payout via\u003cbr\u003e\n\u003ca title=\"https://hackerone.com/settings/bounties\" href=\"https://hackerone.com/settings/bounties\"\u003ehttps://hackerone.com/settings/bounties\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eThanks again,\u003cbr\u003e\nwaiting for new bug reports from you.\u003c/p\u003e\n\n\u003cp\u003eP.S. we are still working to resolve this problem\u003c/p\u003e\n","automated_response":false,"created_at":"2016-02-17T14:15:05.279Z","updated_at":"2016-02-17T14:15:05.279Z","actor":{"url":"/mailru","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/065/1ec04a6b87b02422d913b5c53d5247de91d64718_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Mail.ru"}},"bounty_amount":"600.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"mailru","collaborator":{"username":"seifelsallamy","url":"/seifelsallamy"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":882559,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Your bug has been fixed! \nPlease confirm that you are no longer able to reproduce the issue. ","markdown_message":"\u003cp\u003eYour bug has been fixed! \u003cbr\u003e\nPlease confirm that you are no longer able to reproduce the issue. \u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-01T13:09:28.822Z","updated_at":"2016-04-01T13:09:28.822Z","actor":{"username":"kpebetka","cleared":false,"url":"/kpebetka","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/152/f71d69995e3032fd2225ed83dd75c81e8158a865_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"seifelsallamy","url":"/seifelsallamy"},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":883684,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"yes, i'm no longer able to reproduce,\nright now ; I uploaded a POC video on youtube (it's unlisted)\ncan you please confirm the public disclosure to let me make the youtube video public ?\nhttps://youtu.be/PEQeFYrSV-8\n\nand do you allow me to show your website in my video?\n\nthank you","markdown_message":"\u003cp\u003eyes, i\u0026#39;m no longer able to reproduce,\u003cbr\u003e\nright now ; I uploaded a POC video on youtube (it\u0026#39;s unlisted)\u003cbr\u003e\ncan you please confirm the public disclosure to let me make the youtube video public ?\u003cbr\u003e\n\u003ca title=\"https://youtu.be/PEQeFYrSV-8\" href=\"/redirect?url=https%3A%2F%2Fyoutu.be%2FPEQeFYrSV-8\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://youtu.be/PEQeFYrSV-8\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eand do you allow me to show your website in my video?\u003c/p\u003e\n\n\u003cp\u003ethank you\u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-01T19:32:52.649Z","updated_at":"2016-04-01T19:32:52.649Z","first_to_agree":true,"actor":{"username":"seifelsallamy","cleared":false,"url":"/seifelsallamy","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/804/747fe8def9e5ba028d0fbf0ac755a88ea4992d3f_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":893650,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-04-07T10:57:53.398Z","updated_at":"2016-04-07T10:57:53.398Z","actor":{"username":"3apa3a","cleared":false,"url":"/3apa3a","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/836/57b93fd96b524d0ed13eef717ecd070ad8468f86_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":893651,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-04-07T10:57:53.650Z","updated_at":"2016-04-07T10:57:53.650Z","actor":{"username":"3apa3a","cleared":false,"url":"/3apa3a","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/836/57b93fd96b524d0ed13eef717ecd070ad8468f86_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"id":1632,"category":"researcher","content":"I uploaded the POC video to youtube\nhttps://youtu.be/PEQeFYrSV-8\n\nThank you!","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eI uploaded the POC video to youtube\u003cbr\u003e\n\u003ca title=\"https://youtu.be/PEQeFYrSV-8\" href=\"/redirect?url=https%3A%2F%2Fyoutu.be%2FPEQeFYrSV-8\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://youtu.be/PEQeFYrSV-8\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eThank you!\u003c/p\u003e\n"}]}