{"id":241503,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yNDE1MDM=","url":"https://hackerone.com/reports/241503","title":"Possible subdomain takeover at openapi.starbucks.com","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2017-06-19T22:15:43.530Z","submitted_at":"2017-06-19T22:15:43.530Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"benoculars","url":"/benoculars","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/062/040/af3c152d4a456b1187dbd51db3d96b9d6e9ee432_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1989,"url":"https://hackerone.com/starbucks","handle":"starbucks","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/989/c9aa38cf3b1a91daa085d31e23d23f34cd1874df_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/989/c9aa38cf3b1a91daa085d31e23d23f34cd1874df_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Starbucks","twitter_handle":"Starbucks","website":"http://www.starbucks.com","about":"Inspiring and nurturing the human spirit -- one person, one cup, one neighborhood at a time."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"no-content","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-08-15T04:48:56.125Z","bug_reporter_agreed_on_going_public_at":"2017-08-15T04:48:56.032Z","team_member_agreed_on_going_public_at":"2017-08-15T02:06:15.899Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"","vulnerability_information_html":"","bounty_amount":"2000.0","formatted_bounty":"$2,000","original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2017-09-14T02:06:15.944Z","allow_singular_disclosure_after":-103863714.77556041,"singular_disclosure_allowed":true,"vote_count":23,"voters":["sp1d3rs","jensec","bogdantcaciuc","spam404","cuso4","eveeez","r3y","harry_mg","benoculars","atruba","and 13 more..."],"severity":{"rating":"high","author_type":"User"},"structured_scope":{"databaseId":13008,"asset_type":"OTHER","asset_identifier":"Other non domain specific items","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1767012,"is_internal":false,"editable":false,"type":"Activities::BugDuplicate","message":"","markdown_message":"","automated_response":false,"created_at":"2017-06-19T23:20:56.145Z","updated_at":"2017-06-19T23:20:56.145Z","original_report_id":196070,"actor":{"username":"sharpie","cleared":false,"url":"/sharpie","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/093/272/b7429121474103e01ac6fabf477ddb52ed91556d_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1767022,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2017-06-19T23:24:57.121Z","updated_at":"2017-06-19T23:24:57.121Z","actor":{"username":"benoculars","cleared":false,"url":"/benoculars","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/062/040/af3c152d4a456b1187dbd51db3d96b9d6e9ee432_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1767072,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2017-06-20T00:10:15.695Z","updated_at":"2017-06-20T00:10:15.695Z","actor":{"username":"sharpie","cleared":false,"url":"/sharpie","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/093/272/b7429121474103e01ac6fabf477ddb52ed91556d_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1767164,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2017-06-20T00:59:49.632Z","updated_at":"2017-06-20T00:59:49.632Z","actor":{"username":"benoculars","cleared":false,"url":"/benoculars","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/062/040/af3c152d4a456b1187dbd51db3d96b9d6e9ee432_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1767175,"is_internal":false,"editable":false,"type":"Activities::BugReopened","message":"","markdown_message":"","automated_response":false,"created_at":"2017-06-20T01:09:35.358Z","updated_at":"2017-06-20T01:09:35.358Z","actor":{"username":"sharpie","cleared":false,"url":"/sharpie","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/093/272/b7429121474103e01ac6fabf477ddb52ed91556d_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1767176,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2017-06-20T01:09:52.919Z","updated_at":"2017-06-20T01:09:52.919Z","actor":{"username":"sharpie","cleared":false,"url":"/sharpie","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/093/272/b7429121474103e01ac6fabf477ddb52ed91556d_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1767187,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2017-06-20T01:15:34.554Z","updated_at":"2017-06-20T01:15:34.554Z","actor":{"username":"benoculars","cleared":false,"url":"/benoculars","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/062/040/af3c152d4a456b1187dbd51db3d96b9d6e9ee432_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1768746,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2017-06-20T16:10:05.932Z","updated_at":"2017-06-20T16:10:05.932Z","actor":{"username":"siren","cleared":false,"url":"/siren","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/043/496/422aa228af5a54db16d191c4bed22c984a6429f2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":1769854,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2017-06-20T22:19:35.108Z","updated_at":"2017-06-20T22:19:35.108Z","actor":{"username":"benoculars","cleared":false,"url":"/benoculars","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/062/040/af3c152d4a456b1187dbd51db3d96b9d6e9ee432_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1777559,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2017-06-23T19:39:52.112Z","updated_at":"2017-06-23T19:39:52.112Z","actor":{"username":"siren","cleared":false,"url":"/siren","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/043/496/422aa228af5a54db16d191c4bed22c984a6429f2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":1809637,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2017-07-06T04:07:13.292Z","updated_at":"2017-07-06T04:07:13.292Z","actor":{"username":"benoculars","cleared":false,"url":"/benoculars","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/062/040/af3c152d4a456b1187dbd51db3d96b9d6e9ee432_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1809925,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2017-07-06T07:05:37.403Z","updated_at":"2017-07-06T07:05:37.403Z","actor":{"username":"coffeecup","cleared":false,"url":"/coffeecup","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/163/756/b715ab701f6ba35c13cf00277bf23f9ab1a5e1cb_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1835771,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2017-07-14T14:33:25.254Z","updated_at":"2017-07-14T14:33:25.254Z","actor":{"username":"siren","cleared":false,"url":"/siren","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/043/496/422aa228af5a54db16d191c4bed22c984a6429f2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"benoculars","url":"/benoculars"},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":1835772,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2017-07-14T14:33:41.608Z","updated_at":"2017-07-14T14:33:41.608Z","actor":{"url":"/starbucks","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/989/c9aa38cf3b1a91daa085d31e23d23f34cd1874df_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Starbucks"}},"bounty_amount":"2000.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"starbucks","collaborator":{"username":"benoculars","url":"/benoculars"},"actor_is_team_member":true,"actor_is_concealed_member":true},{"id":1837011,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-07-14T22:04:24.383Z","updated_at":"2017-07-14T22:04:24.383Z","first_to_agree":true,"actor":{"username":"benoculars","cleared":false,"url":"/benoculars","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/062/040/af3c152d4a456b1187dbd51db3d96b9d6e9ee432_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1925037,"is_internal":false,"editable":false,"type":"Activities::BugReopened","message":"","markdown_message":"","automated_response":false,"created_at":"2017-08-13T21:00:29.706Z","updated_at":"2017-08-13T21:00:29.706Z","actor":{"username":"siren","cleared":false,"url":"/siren","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/043/496/422aa228af5a54db16d191c4bed22c984a6429f2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":1925038,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2017-08-13T21:01:00.928Z","updated_at":"2017-08-13T21:01:00.928Z","actor":{"username":"siren","cleared":false,"url":"/siren","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/043/496/422aa228af5a54db16d191c4bed22c984a6429f2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"benoculars","url":"/benoculars"},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":1929352,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2017-08-15T02:04:20.010Z","updated_at":"2017-08-15T02:04:20.010Z","additional_data":{},"actor":{"username":"siren","cleared":false,"url":"/siren","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/043/496/422aa228af5a54db16d191c4bed22c984a6429f2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":1929354,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-08-15T02:06:15.913Z","updated_at":"2017-08-15T02:06:37.986Z","first_to_agree":true,"actor":{"username":"siren","cleared":false,"url":"/siren","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/043/496/422aa228af5a54db16d191c4bed22c984a6429f2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":1929484,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-08-15T04:48:56.059Z","updated_at":"2017-08-15T04:48:56.059Z","actor":{"username":"benoculars","cleared":false,"url":"/benoculars","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/062/040/af3c152d4a456b1187dbd51db3d96b9d6e9ee432_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1929485,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-08-15T04:48:56.149Z","updated_at":"2017-08-15T04:48:56.149Z","actor":{"username":"benoculars","cleared":false,"url":"/benoculars","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/062/040/af3c152d4a456b1187dbd51db3d96b9d6e9ee432_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3694214,"is_internal":false,"editable":false,"type":"Activities::ChangedScope","message":"","markdown_message":"","automated_response":false,"created_at":"2018-11-21T19:12:01.363Z","updated_at":"2018-11-21T19:12:01.363Z","actor":{"username":"overice","cleared":false,"url":"/overice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/161/018/993b2d44b7dea7bd979efa3030b9456f04690408_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"old_scope":"None","new_scope":"Other non domain specific items","genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":5056,"category":"team","content":"@benoculars was able to take advantage of a process flaw to use some of the space provided for openapi.starbucks.com.  While we were still securely serving content from this domain and it did not impact users or operations, it would have been possible for @benoculars to serve content from unique URLs not in use by our apps \u0026 services.\n\nIn the past, others have reported that they suspected this to be vulnerable for subdomain takeover but no one had provided evidence.  Similarly, we initially closed this report, considering it a false positive.  \n\n@benoculars then went one step further to provide a non-destructive PoC demonstrating his ability to serve content from our domain. Based on the PoC \u0026 repro steps provided, a flaw was identified in the approval process which required human interaction.  This was unique in that, given the root cause, it may not have always resulted in a successful takeover.\nTo resolve the issue, operational and platform code changes were introduced.\n\nThanks @benoculars for going the extra step to create that PoC \u0026 answer our questions about repro steps.  Nice work!","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003e\u003ca href=\"/benoculars\"\u003e@benoculars\u003c/a\u003e was able to take advantage of a process flaw to use some of the space provided for openapi.starbucks.com.  While we were still securely serving content from this domain and it did not impact users or operations, it would have been possible for \u003ca href=\"/benoculars\"\u003e@benoculars\u003c/a\u003e to serve content from unique URLs not in use by our apps \u0026amp; services.\u003c/p\u003e\n\n\u003cp\u003eIn the past, others have reported that they suspected this to be vulnerable for subdomain takeover but no one had provided evidence.  Similarly, we initially closed this report, considering it a false positive.  \u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"/benoculars\"\u003e@benoculars\u003c/a\u003e then went one step further to provide a non-destructive PoC demonstrating his ability to serve content from our domain. Based on the PoC \u0026amp; repro steps provided, a flaw was identified in the approval process which required human interaction.  This was unique in that, given the root cause, it may not have always resulted in a successful takeover.\u003cbr\u003e\nTo resolve the issue, operational and platform code changes were introduced.\u003c/p\u003e\n\n\u003cp\u003eThanks \u003ca href=\"/benoculars\"\u003e@benoculars\u003c/a\u003e for going the extra step to create that PoC \u0026amp; answer our questions about repro steps.  Nice work!\u003c/p\u003e\n"},{"category":"researcher","can_view?":true,"can_create?":false}]}