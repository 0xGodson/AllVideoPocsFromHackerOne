{"id":135283,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMzUyODM=","url":"https://hackerone.com/reports/135283","title":"Email Authentication Bypass","state":"Closed","substate":"not-applicable","readable_substate":"N/A","created_at":"2016-04-29T00:49:05.985Z","submitted_at":"2016-04-29T00:49:05.985Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"khoujaahmed","url":"/khoujaahmed","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":8539,"url":"https://hackerone.com/paragonie","handle":"paragonie","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/008/539/72f76fed45e5220b47ba2f679371ebf9ccb19c70_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/539/72f76fed45e5220b47ba2f679371ebf9ccb19c70_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Paragon Initiative Enterprises","twitter_handle":"ParagonIE","website":"https://github.com/paragonie","about":"Cryptography and Application Security Consultants - We Produce Various Open Source Libraries"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2016-05-16T17:45:47.784Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2016-04-29T00:51:16.172Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi,\n\nI was able to bypass you email authentication. You have not published \"DMARC [Domain-based Message Authentication, Reporting, and Conformance]\" for the domain paragonie.com more information :-\n\nhttp://dmarc.org/\n----------------------------------------------------------------------\u003e\nwhat is DMARC ?\n\nDMARC, which stands for “Domain-based Message Authentication, Reporting \u0026 Conformance”, is a technical specification created by a group of organizations that want to help reduce the potential for email-based abuse by solving a couple of long-standing operational, deployment, and reporting issues \nrelated to email authentication protocols.DMARC standardizes how email receivers perform\nemail authentication using the well-known SPF and DKIM mechanisms. This means that senders will experience consistent authentication results for their messages at AOL, Gmail, Hotmail, Yahoo! and any \nother email receiver implementing DMARC. We hope this will encourage senders to more broadly authenticate their outbound email which can make email a more reliable way to communicate.\n\nDMARC was aimed at:\n\nReducing false negatives\nProvide authentication reporting\nApply sender policies at the receiving end\nReduce phishing\nBe scalable\nIn order to get started with DMARC, the sending domain needs to have an SPF and DKIM record published. Once the SPF and DKIM records are in place, you can ure DMARC by adding policies to your domain's TXT records (the same way in which you published your SPF and DKIM records). Your TXT record name should read something similar to \"dmarc.your_domain.com.\" Please replace the \"yourdomain.com\" with your own domain.\n\nAs DMARC policies are published as TXT records, it defines what an email receiver should do with non-aligned mail it receives.\n\nYou can read more about creating DMARC records and their uses here:https://support.sendgrid.com/hc/en-us/articles/200182958-Everything-about-DMARC-\n\nWhy should you implement this\n\nWhen I try to send a spoofed email from your domain to anyone like from\n\nscott@paragonie.com or security@paragonie.com\nto abcd@example.com`\n\nwhen a domain has DMARC record then they get this\n\nhttp://i.gyazo.com/59c6acf761ff010bb16aa93d19c6fc39.png\n\nThe main point here is that DMARC prevents spoofing by adding this line:\nIt has a from address in mailjet.com but has failed mailjet.com's required tests for authentication.\n\nNow, thats how DMARC comes to rescue\n\nThe following site https://dmarcian.com/dmarc-inspector/paragonie.com\n\nGive the follwong detail:\nNo DMARC record published.\n\nWhich shows that you are missing this security feature.\n\nYou should publish a valid DMARC record for your domain to prevent any misunderstanding and to prevent hackers from using your email.\n\nThank you!","vulnerability_information_html":"\u003cp\u003eHi,\u003c/p\u003e\n\n\u003cp\u003eI was able to bypass you email authentication. You have not published \u0026quot;DMARC [Domain-based Message Authentication, Reporting, and Conformance]\u0026quot; for the domain paragonie.com more information :-\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"http://dmarc.org/\" href=\"/redirect?url=http%3A%2F%2Fdmarc.org%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://dmarc.org/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\n----------------------------------------------------------------------\u0026gt;\u003cbr\u003e\nwhat is DMARC ?\u003c/p\u003e\n\n\u003cp\u003eDMARC, which stands for “Domain-based Message Authentication, Reporting \u0026amp; Conformance”, is a technical specification created by a group of organizations that want to help reduce the potential for email-based abuse by solving a couple of long-standing operational, deployment, and reporting issues \u003cbr\u003e\nrelated to email authentication protocols.DMARC standardizes how email receivers perform\u003cbr\u003e\nemail authentication using the well-known SPF and DKIM mechanisms. This means that senders will experience consistent authentication results for their messages at AOL, Gmail, Hotmail, Yahoo! and any \u003cbr\u003e\nother email receiver implementing DMARC. We hope this will encourage senders to more broadly authenticate their outbound email which can make email a more reliable way to communicate.\u003c/p\u003e\n\n\u003cp\u003eDMARC was aimed at:\u003c/p\u003e\n\n\u003cp\u003eReducing false negatives\u003cbr\u003e\nProvide authentication reporting\u003cbr\u003e\nApply sender policies at the receiving end\u003cbr\u003e\nReduce phishing\u003cbr\u003e\nBe scalable\u003cbr\u003e\nIn order to get started with DMARC, the sending domain needs to have an SPF and DKIM record published. Once the SPF and DKIM records are in place, you can ure DMARC by adding policies to your domain\u0026#39;s TXT records (the same way in which you published your SPF and DKIM records). Your TXT record name should read something similar to \u0026quot;dmarc.your_domain.com.\u0026quot; Please replace the \u0026quot;yourdomain.com\u0026quot; with your own domain.\u003c/p\u003e\n\n\u003cp\u003eAs DMARC policies are published as TXT records, it defines what an email receiver should do with non-aligned mail it receives.\u003c/p\u003e\n\n\u003cp\u003eYou can read more about creating DMARC records and their uses here:\u003ca title=\"https://support.sendgrid.com/hc/en-us/articles/200182958-Everything-about-DMARC-\" href=\"/redirect?url=https%3A%2F%2Fsupport.sendgrid.com%2Fhc%2Fen-us%2Farticles%2F200182958-Everything-about-DMARC-\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://support.sendgrid.com/hc/en-us/articles/200182958-Everything-about-DMARC-\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eWhy should you implement this\u003c/p\u003e\n\n\u003cp\u003eWhen I try to send a spoofed email from your domain to anyone like from\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"scott@paragonie.com\" href=\"mailto:scott@paragonie.com\" rel=\"nofollow noopener noreferrer\"\u003escott@paragonie.com\u003c/a\u003e or \u003ca title=\"security@paragonie.com\" href=\"mailto:security@paragonie.com\" rel=\"nofollow noopener noreferrer\"\u003esecurity@paragonie.com\u003c/a\u003e\u003cbr\u003e\nto \u003ca title=\"abcd@example.com\" href=\"mailto:abcd@example.com\" rel=\"nofollow noopener noreferrer\"\u003eabcd@example.com\u003c/a\u003e`\u003c/p\u003e\n\n\u003cp\u003ewhen a domain has DMARC record then they get this\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"http://i.gyazo.com/59c6acf761ff010bb16aa93d19c6fc39.png\" href=\"/redirect?url=http%3A%2F%2Fi.gyazo.com%2F59c6acf761ff010bb16aa93d19c6fc39.png\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://i.gyazo.com/59c6acf761ff010bb16aa93d19c6fc39.png\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eThe main point here is that DMARC prevents spoofing by adding this line:\u003cbr\u003e\nIt has a from address in mailjet.com but has failed mailjet.com\u0026#39;s required tests for authentication.\u003c/p\u003e\n\n\u003cp\u003eNow, thats how DMARC comes to rescue\u003c/p\u003e\n\n\u003cp\u003eThe following site \u003ca title=\"https://dmarcian.com/dmarc-inspector/paragonie.com\" href=\"/redirect?url=https%3A%2F%2Fdmarcian.com%2Fdmarc-inspector%2Fparagonie.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://dmarcian.com/dmarc-inspector/paragonie.com\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eGive the follwong detail:\u003cbr\u003e\nNo DMARC record published.\u003c/p\u003e\n\n\u003cp\u003eWhich shows that you are missing this security feature.\u003c/p\u003e\n\n\u003cp\u003eYou should publish a valid DMARC record for your domain to prevent any misunderstanding and to prevent hackers from using your email.\u003c/p\u003e\n\n\u003cp\u003eThank you!\u003c/p\u003e\n","weakness":{"id":2,"name":"Memory Corruption - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2016-05-29T00:51:16.240Z","allow_singular_disclosure_after":-144732884.22142068,"singular_disclosure_allowed":true,"vote_count":1,"voters":["dyabla"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":932923,"is_internal":false,"editable":false,"type":"Activities::BugNotApplicable","message":"Hi,\n\nPlease re-read the **[Quick Answers](https://hackerone.com/paragonie)** section of our HackerOne page. Our website is strictly not in scope.\n\nThanks,\nScott","markdown_message":"\u003cp\u003eHi,\u003c/p\u003e\n\n\u003cp\u003ePlease re-read the \u003cstrong\u003e\u003ca href=\"https://hackerone.com/paragonie\"\u003eQuick Answers\u003c/a\u003e\u003c/strong\u003e section of our HackerOne page. Our website is strictly not in scope.\u003c/p\u003e\n\n\u003cp\u003eThanks,\u003cbr\u003e\nScott\u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-29T00:51:07.661Z","updated_at":"2016-04-29T00:51:37.952Z","actor":{"username":"paragonie-scott","cleared":false,"url":"/paragonie-scott","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/051/441/089de22b2f1b80a1e57a2792318dede5cbad81db_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"paragonie","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":932924,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-04-29T00:51:16.198Z","updated_at":"2016-04-29T00:51:16.198Z","first_to_agree":true,"actor":{"username":"paragonie-scott","cleared":false,"url":"/paragonie-scott","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/051/441/089de22b2f1b80a1e57a2792318dede5cbad81db_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"paragonie","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":944231,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I see that your site is in scope \n===\u003e #113112","markdown_message":"\u003cp\u003eI see that your site is in scope \u003cbr\u003e\n===\u0026gt; \u003ca href=\"/reports/113112\"\u003e#113112\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2016-05-06T16:25:14.856Z","updated_at":"2016-05-06T16:29:50.819Z","actor":{"username":"khoujaahmed","cleared":false,"url":"/khoujaahmed","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"paragonie","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":959577,"is_internal":false,"editable":false,"type":"Activities::ManuallyDisclosed","message":"No, our website is not in scope. You can't count on bugs that were closed-with-reward once upon a time to determine what today's policies are.\n\nWhen we first launched, the scope wasn't sufficiently specified in the HackerOne page, and that came in before we specified it, so it got grandfathered in.\n\nWe're only concerned about the security of the code we produce, not *someone can spoof `From:` headers*. We use GPG for authenticity. From one perspective, lack of authenticity without a GPG signature is a feature (deniability), not a deficit.","markdown_message":"\u003cp\u003eNo, our website is not in scope. You can\u0026#39;t count on bugs that were closed-with-reward once upon a time to determine what today\u0026#39;s policies are.\u003c/p\u003e\n\n\u003cp\u003eWhen we first launched, the scope wasn\u0026#39;t sufficiently specified in the HackerOne page, and that came in before we specified it, so it got grandfathered in.\u003c/p\u003e\n\n\u003cp\u003eWe\u0026#39;re only concerned about the security of the code we produce, not \u003cem\u003esomeone can spoof \u003ccode\u003eFrom:\u003c/code\u003e headers\u003c/em\u003e. We use GPG for authenticity. From one perspective, lack of authenticity without a GPG signature is a feature (deniability), not a deficit.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-05-16T17:45:47.735Z","updated_at":"2016-05-16T17:45:47.735Z","actor":{"username":"paragonie-scott","cleared":false,"url":"/paragonie-scott","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/051/441/089de22b2f1b80a1e57a2792318dede5cbad81db_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"paragonie","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":961695,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"you are cracking my mind ","markdown_message":"\u003cp\u003eyou are cracking my mind \u003c/p\u003e\n","automated_response":false,"created_at":"2016-05-17T17:12:34.041Z","updated_at":"2016-05-17T17:12:34.041Z","actor":{"username":"khoujaahmed","cleared":false,"url":"/khoujaahmed","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"paragonie","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}