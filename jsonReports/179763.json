{"id":179763,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNzk3NjM=","url":"https://hackerone.com/reports/179763","title":"Suspicious browser fingerprinting(?) scripts on http://www.lahitapiola.fi/ redirector","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2016-11-02T20:41:19.721Z","submitted_at":"2016-11-02T20:41:19.721Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"eeko","url":"/eeko","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/121/907/22f48591921f6d2bb4371af8fe7ab7f272c8b58c_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":8416,"url":"https://hackerone.com/localtapiola","handle":"localtapiola","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/008/416/b6fbd7e94497b0ffaee584d2e7096c5d5e2082e2_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/416/b6fbd7e94497b0ffaee584d2e7096c5d5e2082e2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"LocalTapiola","twitter_handle":"","website":"http://www.lahitapiola.fi","about":"LocalTapiolaâ€™s products and services cover non-life, life and pension insurance, as well as investment and saving services."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2017-02-03T18:13:49.693Z","bug_reporter_agreed_on_going_public_at":"2017-02-03T18:13:49.640Z","team_member_agreed_on_going_public_at":"2017-02-03T15:56:39.408Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"I was doing some routine scanning of my Internet traffic at work (I work as a Security Researcher for Forcepoint) and noticed that my IDS popped up alarms of a ton of suspicious behaviour when I was trying to access http://www.lahitapiola.fi/ front page. It turned out that there seems to be a lot of (probably) irrelevant javascript in the front-page redirector HTML with a number of odd strings and tricks commonly treated as indicators of compromise in html content.\n\nE.g. There is evaluation of multiple encrypted strings, SQL commands used by browser's websql database, ActiveX object references and a number of hidden form fields with suspicious autogenerated names triggered by obfuscated and encrypted javascript. All in a site that only serves a 301 Moved Permanently redirect within HTTP headers is bound to trigger a number of IDS heuristics and alert rules for apparently no good reason.\n\nI didn't look into the javascript very deeply, but it does not appear to load external content or perform anything actually malicious by itself. Most browsers probably won't even evaluate the content as they get immediately redirected to https://www.lahitapiola.fi/henkilo instead. Yet the content still gets transferred and can be seen by e.g. running `curl http://www.lahitapiola.fi/`. It's notable that if one loads the redirector through https, there's no content served. So I'm lead to believe this is probably a server configuration issue with some legacy tracking or anti-crawler code left somewhere along the index-page served by the http server at port 80. So it's likely nothing very serious and possibly even intentional for some reason.\n\nHowever, there could be some issues that arises from that thing lying in there. At least it will trigger anti-virus and IDS heuristics potentially causing your site to be unreachable for users behind strict security policies. If it is some kind of anti-crawler measure, it's kind of useless to be kept there as the crawlers will get redirected out from the script anyway to the other landing page without the scripts.","vulnerability_information_html":"\u003cp\u003eI was doing some routine scanning of my Internet traffic at work (I work as a Security Researcher for Forcepoint) and noticed that my IDS popped up alarms of a ton of suspicious behaviour when I was trying to access \u003ca title=\"http://www.lahitapiola.fi/\" href=\"/redirect?url=http%3A%2F%2Fwww.lahitapiola.fi%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://www.lahitapiola.fi/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e front page. It turned out that there seems to be a lot of (probably) irrelevant javascript in the front-page redirector HTML with a number of odd strings and tricks commonly treated as indicators of compromise in html content.\u003c/p\u003e\n\n\u003cp\u003eE.g. There is evaluation of multiple encrypted strings, SQL commands used by browser\u0026#39;s websql database, ActiveX object references and a number of hidden form fields with suspicious autogenerated names triggered by obfuscated and encrypted javascript. All in a site that only serves a 301 Moved Permanently redirect within HTTP headers is bound to trigger a number of IDS heuristics and alert rules for apparently no good reason.\u003c/p\u003e\n\n\u003cp\u003eI didn\u0026#39;t look into the javascript very deeply, but it does not appear to load external content or perform anything actually malicious by itself. Most browsers probably won\u0026#39;t even evaluate the content as they get immediately redirected to \u003ca title=\"https://www.lahitapiola.fi/henkilo\" href=\"/redirect?url=https%3A%2F%2Fwww.lahitapiola.fi%2Fhenkilo\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.lahitapiola.fi/henkilo\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e instead. Yet the content still gets transferred and can be seen by e.g. running \u003ccode\u003ecurl http://www.lahitapiola.fi/\u003c/code\u003e. It\u0026#39;s notable that if one loads the redirector through https, there\u0026#39;s no content served. So I\u0026#39;m lead to believe this is probably a server configuration issue with some legacy tracking or anti-crawler code left somewhere along the index-page served by the http server at port 80. So it\u0026#39;s likely nothing very serious and possibly even intentional for some reason.\u003c/p\u003e\n\n\u003cp\u003eHowever, there could be some issues that arises from that thing lying in there. At least it will trigger anti-virus and IDS heuristics potentially causing your site to be unreachable for users behind strict security policies. If it is some kind of anti-crawler measure, it\u0026#39;s kind of useless to be kept there as the crawlers will get redirected out from the script anyway to the other landing page without the scripts.\u003c/p\u003e\n","bounty_amount":"100.0","formatted_bounty":"$100","weakness":{"id":57,"name":"Violation of Secure Design Principles"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2017-03-05T15:56:39.461Z","allow_singular_disclosure_after":-120487678.60528737,"singular_disclosure_allowed":true,"vote_count":2,"voters":["eveeez","spetr0x"],"severity":{"rating":"low","author_type":"User"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1281860,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks a lot for reporting this potential issue back to us. LocalTapiola takes security very seriously and would appreciate if you would not share any information about this report until we have determined whether this is a bug and what any potential impact (or fix) will be.\n\nOur security team will take a look at this issue as soon as possible. The pages you mention have undergone changes in the past days, so we might be seeing some effects of that. Anyway, we will look into it.","markdown_message":"\u003cp\u003eThanks a lot for reporting this potential issue back to us. LocalTapiola takes security very seriously and would appreciate if you would not share any information about this report until we have determined whether this is a bug and what any potential impact (or fix) will be.\u003c/p\u003e\n\n\u003cp\u003eOur security team will take a look at this issue as soon as possible. The pages you mention have undergone changes in the past days, so we might be seeing some effects of that. Anyway, we will look into it.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-11-03T08:39:59.985Z","updated_at":"2016-11-03T08:39:59.985Z","actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1299961,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"any update on this? there's no changes on the site so far.","markdown_message":"\u003cp\u003eany update on this? there\u0026#39;s no changes on the site so far.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-11-15T08:34:36.923Z","updated_at":"2016-11-15T08:34:36.923Z","actor":{"username":"eeko","cleared":false,"url":"/eeko","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/121/907/22f48591921f6d2bb4371af8fe7ab7f272c8b58c_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1299969,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"No updates - well, we have pinpointed the most likely reason for this behavior, but it is still being analyzed by the service provider. I will keep you posted.","markdown_message":"\u003cp\u003eNo updates - well, we have pinpointed the most likely reason for this behavior, but it is still being analyzed by the service provider. I will keep you posted.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-11-15T08:43:02.787Z","updated_at":"2016-11-15T08:43:02.787Z","actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1365899,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I tested the curl command again and it seems that you have fixed this issue. Maybe this issue should get closed?","markdown_message":"\u003cp\u003eI tested the curl command again and it seems that you have fixed this issue. Maybe this issue should get closed?\u003c/p\u003e\n","automated_response":false,"created_at":"2016-12-15T07:29:54.826Z","updated_at":"2016-12-15T07:29:54.826Z","actor":{"username":"eeko","cleared":false,"url":"/eeko","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/121/907/22f48591921f6d2bb4371af8fe7ab7f272c8b58c_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1365901,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Cancel that. Actually now it seems like the suspicious script pops up at the httos site instead. o_O Try `curl https://www.lahitapiola.fi/`","markdown_message":"\u003cp\u003eCancel that. Actually now it seems like the suspicious script pops up at the httos site instead. o_O Try \u003ccode\u003ecurl https://www.lahitapiola.fi/\u003c/code\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2016-12-15T07:34:40.717Z","updated_at":"2016-12-15T07:34:40.717Z","actor":{"username":"eeko","cleared":false,"url":"/eeko","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/121/907/22f48591921f6d2bb4371af8fe7ab7f272c8b58c_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1385192,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Obviously triaged.","markdown_message":"\u003cp\u003eObviously triaged.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-12-25T11:44:06.948Z","updated_at":"2016-12-25T11:44:06.948Z","actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1421549,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"This should be fixed now, please retest.","markdown_message":"\u003cp\u003eThis should be fixed now, please retest.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-01-15T16:54:18.496Z","updated_at":"2017-01-15T16:54:18.496Z","actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1421623,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Looks good to me.","markdown_message":"\u003cp\u003eLooks good to me.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-01-15T18:14:06.321Z","updated_at":"2017-01-15T18:14:06.321Z","actor":{"username":"eeko","cleared":false,"url":"/eeko","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/121/907/22f48591921f6d2bb4371af8fe7ab7f272c8b58c_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1461022,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2017-02-03T15:30:01.983Z","updated_at":"2017-02-03T15:30:01.983Z","actor":{"url":"/localtapiola","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/416/b6fbd7e94497b0ffaee584d2e7096c5d5e2082e2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"LocalTapiola"}},"bounty_amount":"100.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"localtapiola","collaborator":{"username":"eeko","url":"/eeko"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1461023,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thank you for the effort.","markdown_message":"\u003cp\u003eThank you for the effort.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-02-03T15:30:34.142Z","updated_at":"2017-02-03T15:30:34.142Z","actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"eeko","url":"/eeko"},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1461098,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Requesting full disclosure.","markdown_message":"\u003cp\u003eRequesting full disclosure.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-02-03T15:56:39.425Z","updated_at":"2017-02-03T15:56:39.425Z","first_to_agree":true,"actor":{"username":"localtapiola-thomas","cleared":false,"url":"/localtapiola-thomas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1461351,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-02-03T18:13:49.660Z","updated_at":"2017-02-03T18:13:49.660Z","actor":{"username":"eeko","cleared":false,"url":"/eeko","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/121/907/22f48591921f6d2bb4371af8fe7ab7f272c8b58c_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1461352,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-02-03T18:13:49.708Z","updated_at":"2017-02-03T18:13:49.708Z","actor":{"username":"eeko","cleared":false,"url":"/eeko","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/121/907/22f48591921f6d2bb4371af8fe7ab7f272c8b58c_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"localtapiola","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":3292,"category":"team","content":"##Issue\n\nThe reporter found an unexpected issue on www.lahitapiola.fi where scripts where injected by a network device into the http-response. \n\n##Fix\n\nThe issue was investigated and found to be valid. The issue had no practical impact, but it was still decided to investigate and eventually fix the issue. Scripts are no longer injected into responses.\n\n##Reasoning\n\nThe reported case was valid and the domain was within the scope of the bug bounty program. The issue was fixed and the reporter was awarded with a bounty. ","can_view?":true,"can_edit?":false,"content_html":"\u003ch2 id=\"issue\"\u003eIssue\u003c/h2\u003e\n\n\u003cp\u003eThe reporter found an unexpected issue on \u003ca href=\"/redirect?url=http%3A%2F%2Fwww.lahitapiola.fi\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ewww.lahitapiola.fi\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e where scripts where injected by a network device into the http-response. \u003c/p\u003e\n\n\u003ch2 id=\"fix\"\u003eFix\u003c/h2\u003e\n\n\u003cp\u003eThe issue was investigated and found to be valid. The issue had no practical impact, but it was still decided to investigate and eventually fix the issue. Scripts are no longer injected into responses.\u003c/p\u003e\n\n\u003ch2 id=\"reasoning\"\u003eReasoning\u003c/h2\u003e\n\n\u003cp\u003eThe reported case was valid and the domain was within the scope of the bug bounty program. The issue was fixed and the reporter was awarded with a bounty. \u003c/p\u003e\n"},{"category":"researcher","can_view?":true,"can_create?":false}]}