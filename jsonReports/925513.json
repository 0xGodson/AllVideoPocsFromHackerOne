{"id":925513,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC85MjU1MTM=","url":"https://hackerone.com/reports/925513","title":"Unrestricted File Upload in Chat Window","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2020-07-16T16:12:54.368Z","submitted_at":"2020-07-16T16:12:54.368Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"ant_pyne","url":"/ant_pyne","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/geDQ2VPMg1r6HdpJ7jNuR6Lp/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":12633,"url":"https://hackerone.com/owox","handle":"owox","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/012/633/b14ae8476ac40405c091161f2338c091b5fecdc4_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/012/633/b14ae8476ac40405c091161f2338c091b5fecdc4_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"OWOX, Inc.","twitter_handle":"owoxbi","website":"https://bi.owox.com","about":"Get more advantages from Google Analytics and complete control over your data in Google BigQuery"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2020-08-16T06:35:33.740Z","bug_reporter_agreed_on_going_public_at":"2020-07-17T06:35:28.925Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"#Summary:\nThe application allows the attacker to upload dangerous file types that can be automatically processed within the product's environment.\n\n#Steps To Reproduce:\n- Hit the browser and navigate to https://bi.owox.com and sign in.\n- Open The Chat window.\n- Upload any .rb or .php file .\n- Click on send button.\n\n## Impact\n\n-\u003e The impact of this vulnerability is high, supposed code can be executed in the server context or on the client side. The likelihood of detection for the\nattacker is high. The prevalence is common. As a result the severity of this type of vulnerability is high.\n-\u003eIt is important to check a file upload module’s access controls to examine the risks properly.\n-\u003e Server-side attacks: The web server can be compromised by uploading and executing a web-shell which can run commands, browse system files,\nbrowse local resources, attack other servers, or exploit the local vulnerabilities, and so forth.\n-\u003eClient-side attacks: Uploading malicious files can make the website vulnerable to client-side attacks such as XSS or Cross-site Content Hijacking.\n-\u003eUploaded files can be abused to exploit other vulnerable sections of an application when a file on the same or a trusted server is needed (can again\nlead to client-side or server-side attacks)\n-\u003eUploaded files might trigger vulnerabilities in broken libraries/applications on the client side (e.g. iPhone MobileSafari LibTIFF Buffer Overflow).\n-\u003eUploaded files might trigger vulnerabilities in broken libraries/applications on the server side (e.g. ImageMagick flaw that called ImageTragick!).\n-\u003eUploaded files might trigger vulnerabilities in broken real-time monitoring tools (e.g. Symantec antivirus exploit by unpacking a RAR file)\n-\u003eA malicious file such as a Unix shell script, a windows virus, an Excel file with a dangerous formula, or a reverse shell can be uploaded on the server in\norder to execute code by an administrator or webmaster later – on the victim’s machine.\n-\u003eAn attacker might be able to put a phishing page into the website or deface the website.\n-\u003eThe file storage server might be abused to host troublesome files including malwares, illegal software, or adult contents. Uploaded files might also\ncontain malwares’ command and control data, violence and harassment messages, or steganographic data that can be used by criminal organisations.\n-\u003eUploaded sensitive files might be accessible by unauthorised people.\n-\u003eFile uploaders may disclose internal information such as server internal paths in their error messages.","vulnerability_information_html":"\u003ch1 id=\"summary\"\u003eSummary:\u003c/h1\u003e\n\n\u003cp\u003eThe application allows the attacker to upload dangerous file types that can be automatically processed within the product\u0026#39;s environment.\u003c/p\u003e\n\n\u003ch1 id=\"steps-to-reproduce\"\u003eSteps To Reproduce:\u003c/h1\u003e\n\n\u003cul\u003e\n\u003cli\u003eHit the browser and navigate to \u003ca title=\"https://bi.owox.com\" href=\"/redirect?url=https%3A%2F%2Fbi.owox.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://bi.owox.com\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e and sign in.\u003c/li\u003e\n\u003cli\u003eOpen The Chat window.\u003c/li\u003e\n\u003cli\u003eUpload any .rb or .php file .\u003c/li\u003e\n\u003cli\u003eClick on send button.\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003e-\u0026gt; The impact of this vulnerability is high, supposed code can be executed in the server context or on the client side. The likelihood of detection for the\u003cbr\u003e\nattacker is high. The prevalence is common. As a result the severity of this type of vulnerability is high.\u003cbr\u003e\n-\u0026gt;It is important to check a file upload module’s access controls to examine the risks properly.\u003cbr\u003e\n-\u0026gt; Server-side attacks: The web server can be compromised by uploading and executing a web-shell which can run commands, browse system files,\u003cbr\u003e\nbrowse local resources, attack other servers, or exploit the local vulnerabilities, and so forth.\u003cbr\u003e\n-\u0026gt;Client-side attacks: Uploading malicious files can make the website vulnerable to client-side attacks such as XSS or Cross-site Content Hijacking.\u003cbr\u003e\n-\u0026gt;Uploaded files can be abused to exploit other vulnerable sections of an application when a file on the same or a trusted server is needed (can again\u003cbr\u003e\nlead to client-side or server-side attacks)\u003cbr\u003e\n-\u0026gt;Uploaded files might trigger vulnerabilities in broken libraries/applications on the client side (e.g. iPhone MobileSafari LibTIFF Buffer Overflow).\u003cbr\u003e\n-\u0026gt;Uploaded files might trigger vulnerabilities in broken libraries/applications on the server side (e.g. ImageMagick flaw that called ImageTragick!).\u003cbr\u003e\n-\u0026gt;Uploaded files might trigger vulnerabilities in broken real-time monitoring tools (e.g. Symantec antivirus exploit by unpacking a RAR file)\u003cbr\u003e\n-\u0026gt;A malicious file such as a Unix shell script, a windows virus, an Excel file with a dangerous formula, or a reverse shell can be uploaded on the server in\u003cbr\u003e\norder to execute code by an administrator or webmaster later – on the victim’s machine.\u003cbr\u003e\n-\u0026gt;An attacker might be able to put a phishing page into the website or deface the website.\u003cbr\u003e\n-\u0026gt;The file storage server might be abused to host troublesome files including malwares, illegal software, or adult contents. Uploaded files might also\u003cbr\u003e\ncontain malwares’ command and control data, violence and harassment messages, or steganographic data that can be used by criminal organisations.\u003cbr\u003e\n-\u0026gt;Uploaded sensitive files might be accessible by unauthorised people.\u003cbr\u003e\n-\u0026gt;File uploaders may disclose internal information such as server internal paths in their error messages.\u003c/p\u003e\n","weakness":{"id":57,"name":"Violation of Secure Design Principles"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":909873,"file_name":"Screenshot_2020-07-16_at_9.40.43_PM.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/duiC3pEKfQCGieJqH89E4xyF?response-content-disposition=attachment%3B%20filename%3D%22Screenshot_2020-07-16_at_9.40.43_PM.png%22%3B%20filename%2A%3DUTF-8%27%27Screenshot_2020-07-16_at_9.40.43_PM.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ7QN6LLNY%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T071158Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIDM1JyApHNNmH4vO03zxsAWcipwL4MDtIAyn7g0fijjmAiEAnL%2FkVA1yhxpCx%2Fx9lHBd4rAGu6CY%2Fn9tosAByxi0NdwqtAMIWBABGgwwMTM2MTkyNzQ4NDkiDJ4HAZ%2FcsoMqFU%2FX%2BCqRA3aBtK7Qo6gw5zfx%2FcJTFbcER7Nl3REDzUDbHDhmm9afcBNxXjTEI8R4JUV8o6K6%2F6GJ1ogMagg7QVNBuFgZrkztzceMkWkj%2BSNWD9OTwRWoIbb1K0pZ%2F67SjXWlKf9MoUEpcugk7HwZg4MrUNDjOo2MW7sHP7Rd43C9ceBmHGRgXxPalw%2Bx5B7H3zKaVX2tOB2Jr8fldEtL40KYQUTyEn7hnlKah12HmyZnZ8b0Ja5y9XOBLIFXj24n0mYNE1EC1YVy1m4u4q7c%2BGVQqYfHQtsWPgD84qdtgB0bFFe1ZS7DL%2BvacC8IcdW3iCMVz7pQr6e0mQ5D64b01GscWF4dZh%2F4vVb22Sy5KULG4Mr7e7nFgCqwM26Mskcgag6UZzrNEYx3dtFbYjdd2PzJJjFU1i0eNZZdH1hIyDd7GD91WF6Jdg4yg6gVDtQcBcgzZJx718P%2FWLkvPMtSJFm9refNzuMeaHr9oOLujZO0XUUH5gff03C6KQz3sqDAOiaGYXOPW5NNSeGNXddDNZuI3wWbJ%2Fw4MOipq%2F8FOusBUJmJMpxfTvaIkpANRXx3yEvOWcOywnKNYGswV3fQvmzDJ8xuKRwG1VN0dCR8Qg26AIRYFOsmIPHJRTWUoFRAdiDLiSZRq7CzuIFeYWCkxShMNY7rU447%2Fet37wHsTdnfYajGxXq1n73s8R6eWHxA%2F%2FBmE82S1tuPd4Kem3yQ4WOE5R9ZLv%2B6%2BTJXNVZLvAKBEVF2zgFZh2kkO0eKbFjcZNUY12GTH1ANLNd5dStZT00G%2F61GvUG%2Fx1T06qs9P%2FqIq0LL333nZM8vmB%2F%2Bx7AjckigYH7IBx9HsP1KFVQzn5NmZX%2BxryLch3pmlg%3D%3D\u0026X-Amz-Signature=b0f075f30e1dfb65386a47b3476651df917395e862a499dfa5e449a12cf7c8a2","file_size":852125,"type":"image/png"}],"allow_singular_disclosure_at":"2020-08-16T06:35:28.975Z","allow_singular_disclosure_after":-11666189.288307913,"singular_disclosure_allowed":true,"vote_count":13,"voters":["mygf","what_web","assassin_marcos","sheerwood","ant_pyne","sa1tama0","muqduq","yuvikepa","thesudo2","gr3yr0n1n","and 3 more..."],"severity":{"rating":"medium","author_type":"User"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":8623940,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@ant_pyne  thanks for the report!  Since we use Intercom as a third-party solution to communicate with our customers,  all files that are sent to the chat cannot be executed because ones are not part of the application.  We may configure the files extension list in Intercom if will needed","markdown_message":"\u003cp\u003e\u003ca href=\"/ant_pyne\"\u003e@ant_pyne\u003c/a\u003e  thanks for the report!  Since we use Intercom as a third-party solution to communicate with our customers,  all files that are sent to the chat cannot be executed because ones are not part of the application.  We may configure the files extension list in Intercom if will needed\u003c/p\u003e\n","automated_response":false,"created_at":"2020-07-16T22:47:28.769Z","updated_at":"2020-07-16T22:47:28.769Z","actor":{"username":"dubovyi","cleared":false,"url":"/dubovyi","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"owox","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8625221,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello @dubovyi,\n\nExactly what is needed. A whitelisting of the file extensions that should be allowed.\n\nThanks,\nDipmalya","markdown_message":"\u003cp\u003eHello \u003ca href=\"/dubovyi\"\u003e@dubovyi\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eExactly what is needed. A whitelisting of the file extensions that should be allowed.\u003c/p\u003e\n\n\u003cp\u003eThanks,\u003cbr\u003e\nDipmalya\u003c/p\u003e\n","automated_response":false,"created_at":"2020-07-17T05:49:12.869Z","updated_at":"2020-07-17T05:49:12.869Z","actor":{"username":"ant_pyne","cleared":false,"url":"/ant_pyne","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/geDQ2VPMg1r6HdpJ7jNuR6Lp/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"owox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8625421,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"@ant_pyne thanks for the report! We have configured restrict attachment types at Intercom.","markdown_message":"\u003cp\u003e\u003ca href=\"/ant_pyne\"\u003e@ant_pyne\u003c/a\u003e thanks for the report! We have configured restrict attachment types at Intercom.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-07-17T06:32:07.009Z","updated_at":"2020-07-17T06:32:07.009Z","actor":{"username":"maxvoloshin","cleared":false,"url":"/maxvoloshin","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"ant_pyne","url":"/ant_pyne"},"genius_execution_id":null,"team_handle":"owox","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8625435,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Thank you.. Disclosure?","markdown_message":"\u003cp\u003eThank you.. Disclosure?\u003c/p\u003e\n","automated_response":false,"created_at":"2020-07-17T06:35:28.939Z","updated_at":"2020-07-17T06:35:28.939Z","first_to_agree":true,"actor":{"username":"ant_pyne","cleared":false,"url":"/ant_pyne","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/geDQ2VPMg1r6HdpJ7jNuR6Lp/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"owox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8639277,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello, this has not been solved? Should I provide a separate report as I can still upload html files and dmg executables.","markdown_message":"\u003cp\u003eHello, this has not been solved? Should I provide a separate report as I can still upload html files and dmg executables.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-07-18T08:04:38.657Z","updated_at":"2020-07-18T08:04:38.657Z","actor":{"username":"ant_pyne","cleared":false,"url":"/ant_pyne","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/geDQ2VPMg1r6HdpJ7jNuR6Lp/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"owox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8649209,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"There????","markdown_message":"\u003cp\u003eThere????\u003c/p\u003e\n","automated_response":false,"created_at":"2020-07-20T08:21:17.328Z","updated_at":"2020-07-20T08:21:17.328Z","actor":{"username":"ant_pyne","cleared":false,"url":"/ant_pyne","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/geDQ2VPMg1r6HdpJ7jNuR6Lp/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"owox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8649836,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@ant_pyne Intercom allows uploading files of all types but restricts an ability to download them (screenshot is attached).","markdown_message":"\u003cp\u003e\u003ca href=\"/ant_pyne\"\u003e@ant_pyne\u003c/a\u003e Intercom allows uploading files of all types but restricts an ability to download them (screenshot is attached).\u003c/p\u003e\n","automated_response":false,"created_at":"2020-07-20T09:07:35.275Z","updated_at":"2020-07-20T09:07:35.275Z","actor":{"username":"maxvoloshin","cleared":false,"url":"/maxvoloshin","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":913779,"filename":"Screenshot_2020-07-20_at_12.04.16.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/AHFDL9WrYM2GNbF9e1gfFtx2?response-content-disposition=attachment%3B%20filename%3D%22Screenshot_2020-07-20_at_12.04.16.png%22%3B%20filename%2A%3DUTF-8%27%27Screenshot_2020-07-20_at_12.04.16.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ7QN6LLNY%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T071158Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIDM1JyApHNNmH4vO03zxsAWcipwL4MDtIAyn7g0fijjmAiEAnL%2FkVA1yhxpCx%2Fx9lHBd4rAGu6CY%2Fn9tosAByxi0NdwqtAMIWBABGgwwMTM2MTkyNzQ4NDkiDJ4HAZ%2FcsoMqFU%2FX%2BCqRA3aBtK7Qo6gw5zfx%2FcJTFbcER7Nl3REDzUDbHDhmm9afcBNxXjTEI8R4JUV8o6K6%2F6GJ1ogMagg7QVNBuFgZrkztzceMkWkj%2BSNWD9OTwRWoIbb1K0pZ%2F67SjXWlKf9MoUEpcugk7HwZg4MrUNDjOo2MW7sHP7Rd43C9ceBmHGRgXxPalw%2Bx5B7H3zKaVX2tOB2Jr8fldEtL40KYQUTyEn7hnlKah12HmyZnZ8b0Ja5y9XOBLIFXj24n0mYNE1EC1YVy1m4u4q7c%2BGVQqYfHQtsWPgD84qdtgB0bFFe1ZS7DL%2BvacC8IcdW3iCMVz7pQr6e0mQ5D64b01GscWF4dZh%2F4vVb22Sy5KULG4Mr7e7nFgCqwM26Mskcgag6UZzrNEYx3dtFbYjdd2PzJJjFU1i0eNZZdH1hIyDd7GD91WF6Jdg4yg6gVDtQcBcgzZJx718P%2FWLkvPMtSJFm9refNzuMeaHr9oOLujZO0XUUH5gff03C6KQz3sqDAOiaGYXOPW5NNSeGNXddDNZuI3wWbJ%2Fw4MOipq%2F8FOusBUJmJMpxfTvaIkpANRXx3yEvOWcOywnKNYGswV3fQvmzDJ8xuKRwG1VN0dCR8Qg26AIRYFOsmIPHJRTWUoFRAdiDLiSZRq7CzuIFeYWCkxShMNY7rU447%2Fet37wHsTdnfYajGxXq1n73s8R6eWHxA%2F%2FBmE82S1tuPd4Kem3yQ4WOE5R9ZLv%2B6%2BTJXNVZLvAKBEVF2zgFZh2kkO0eKbFjcZNUY12GTH1ANLNd5dStZT00G%2F61GvUG%2Fx1T06qs9P%2FqIq0LL333nZM8vmB%2F%2Bx7AjckigYH7IBx9HsP1KFVQzn5NmZX%2BxryLch3pmlg%3D%3D\u0026X-Amz-Signature=874fe9fe27005289f00ec8cb837015f1f59234fe6b0756a3c1721b84ab61e5ba"}],"genius_execution_id":null,"team_handle":"owox","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8948278,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-08-16T06:35:33.768Z","updated_at":"2020-08-16T06:35:33.768Z","actor":{"url":"/owox","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/012/633/b14ae8476ac40405c091161f2338c091b5fecdc4_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"OWOX, Inc."}},"genius_execution_id":null,"team_handle":"owox","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}