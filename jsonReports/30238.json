{"id":30238,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zMDIzOA==","url":"https://hackerone.com/reports/30238","title":"New Device confirmation tokens are not properly validated.","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2014-10-06T19:06:07.299Z","submitted_at":"2014-10-06T19:06:07.299Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"born2hack","url":"/born2hack","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":104,"url":"https://hackerone.com/coinbase","handle":"coinbase","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/104/b151e01a4adbf5ad9067fc30fb2dfe5d5997fa5c_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/104/b151e01a4adbf5ad9067fc30fb2dfe5d5997fa5c_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Coinbase","twitter_handle":"","website":"https://coinbase.com/security","about":"Creating an open financial system for the world"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2015-05-25T18:36:59.890Z","bug_reporter_agreed_on_going_public_at":"2015-05-25T03:54:50.389Z","team_member_agreed_on_going_public_at":"2015-05-25T18:36:59.246Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi, team\r\nI noticed that the new device confirmation code sent by your server is not validated .\r\nPOC:\r\n1) Login to a new computer and ask for confirmation code two times.\r\nSay around at 12.00 PM and at 12.01 PM\r\n2) Now verify the device with the confirmation token which arrived at 12.01 PM\r\nand after doing your work\r\ngo to https://www.coinbase.com/settings/security_settings\r\nand remove that device .\r\nsay around 12.30 PM\r\n3) Now you need to confirm the device once again and your server will send the new device confirmation code to user's email address at 12.30 PM\r\n4) Here this time  use the confirmation code which arrived at 12.00 PM and u can see that , your device is confirmed.\r\n\r\nFix:\r\nInvalidate all the previous confirmation tokens as soon as new token is generated.","vulnerability_information_html":"\u003cp\u003eHi, team\u003cbr\u003e\nI noticed that the new device confirmation code sent by your server is not validated .\u003cbr\u003e\nPOC:\u003cbr\u003e\n1) Login to a new computer and ask for confirmation code two times.\u003cbr\u003e\nSay around at 12.00 PM and at 12.01 PM\u003cbr\u003e\n2) Now verify the device with the confirmation token which arrived at 12.01 PM\u003cbr\u003e\nand after doing your work\u003cbr\u003e\ngo to \u003ca title=\"https://www.coinbase.com/settings/security_settings\" href=\"/redirect?url=https%3A%2F%2Fwww.coinbase.com%2Fsettings%2Fsecurity_settings\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.coinbase.com/settings/security_settings\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nand remove that device .\u003cbr\u003e\nsay around 12.30 PM\u003cbr\u003e\n3) Now you need to confirm the device once again and your server will send the new device confirmation code to user\u0026#39;s email address at 12.30 PM\u003cbr\u003e\n4) Here this time  use the confirmation code which arrived at 12.00 PM and u can see that , your device is confirmed.\u003c/p\u003e\n\n\u003cp\u003eFix:\u003cbr\u003e\nInvalidate all the previous confirmation tokens as soon as new token is generated.\u003c/p\u003e\n","bounty_amount":"100.0","formatted_bounty":"$100","weakness":{"id":27,"name":"Improper Authentication - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2015-06-24T03:54:50.926Z","allow_singular_disclosure_after":-174101688.06710216,"singular_disclosure_allowed":true,"vote_count":3,"voters":["mygf","bountyoverflow","0x08"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":144520,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"Thanks for the report but I don't see any security issues arising from this behavior.","markdown_message":"\u003cp\u003eThanks for the report but I don\u0026#39;t see any security issues arising from this behavior.\u003c/p\u003e\n","automated_response":false,"created_at":"2014-10-18T00:40:07.414Z","updated_at":"2014-10-18T00:40:07.414Z","actor":{"username":"coinbase2","cleared":false,"url":"/coinbase2","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":144744,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi,\nIn case of password reset as soon as new reset link is generated , previous link is getting expired, but here in case of confirmation of code , it's not like that.\nAs you are expiring reset tokens due to security issue, same as the case of confirmation code exist.\nAnd can you explain how it's not a  security issue?\n","markdown_message":"\u003cp\u003eHi,\u003cbr\u003e\nIn case of password reset as soon as new reset link is generated , previous link is getting expired, but here in case of confirmation of code , it\u0026#39;s not like that.\u003cbr\u003e\nAs you are expiring reset tokens due to security issue, same as the case of confirmation code exist.\u003cbr\u003e\nAnd can you explain how it\u0026#39;s not a  security issue?\u003c/p\u003e\n","automated_response":false,"created_at":"2014-10-18T15:21:28.414Z","updated_at":"2014-10-18T15:21:28.414Z","actor":{"username":"born2hack","cleared":false,"url":"/born2hack","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":190347,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi, team\n\nNow this is disgusting .\n\nSee the report number #36594 .\n\nMine report is same as that of the above report.\nI was the first person to report it , but you people marked me as won't fix  .\nAnd fixed the report of researcher who reported after me.\n\nThis is really not fair.\n\n\n\n","markdown_message":"\u003cp\u003eHi, team\u003c/p\u003e\n\n\u003cp\u003eNow this is disgusting .\u003c/p\u003e\n\n\u003cp\u003eSee the report number \u003ca href=\"/reports/36594\"\u003e#36594\u003c/a\u003e .\u003c/p\u003e\n\n\u003cp\u003eMine report is same as that of the above report.\u003cbr\u003e\nI was the first person to report it , but you people marked me as won\u0026#39;t fix  .\u003cbr\u003e\nAnd fixed the report of researcher who reported after me.\u003c/p\u003e\n\n\u003cp\u003eThis is really not fair.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-01-02T21:38:40.280Z","updated_at":"2015-01-02T21:38:40.280Z","actor":{"username":"born2hack","cleared":false,"url":"/born2hack","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":26329,"filename":"coinbase.PNG","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/026/329/0596814f1149a670cb307780d50ae3d406898256/coinbase.PNG?response-content-disposition=attachment%3B%20filename%3D%22coinbase.PNG%22%3B%20filename%2A%3DUTF-8%27%27coinbase.PNG\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ4I2F3ZKM%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T052939Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJj%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIDUHxZHanlYRSlGPWCM5VffusuDKM5vHXDdIB%2F7JzkbGAiAoWTIT0mF8JINRkIxC8mQbzytm5E2BAjIgE%2B3MmrjAECq0AwhQEAEaDDAxMzYxOTI3NDg0OSIMbhRmnkDNUYXH9R7DKpEDpA4jTDOjlGq73V1v2TUhSglp89Np0O83TA8RCG8D7RiDhlUpBeJtYQFIc3HPVAMSY%2FstiYYucp8o1TS87Sb2LRHgJvUq%2BaSVjhHv7HfYe34wTcVz2uaB%2B07%2FVcpMDfcTHl13jyygC2OBk2%2FrLPaI4iWUA0w4eag9etj8rFy8Wcq2k1fJe6x4DLRj%2BYMFQNuiCb%2BoiIwl5OG19WI1FXfkFXAItu6v1zgK2NF7OXKL8nZe5gNBw1cLFzvmJjIlJXFdaFaJGrxqOixTEVcNzXorh1vOGMsg9qQ7esrdP%2Bn1Qv7FLKJuMyq%2BcR%2Frw5E0HVkRAywDYCcRuVml%2BucnNKkoVLaE3POe%2FdTwmIlI5M4K%2BJubU%2FFyPTLW%2BkWq786t4bUW7He04O09UTb43ubdNr%2FHCtaMwRbxTwmUDG7bGJMxnDojrrchW9x144uzow%2F5avo5AkYj8%2BWpF30IsOtpsCmuLGoQjuU90O330IVGAj5Ov37QS7y5iAICWdeKfDrr8F%2F4o%2F%2FIRHtSkPUUarw0lkzl6WEwrtWp%2FwU67AFR8oCEi3F3HybCC4iDRQUp5CiEybl%2FI%2FGljQelfM%2BGtRCvb1baaWt4qIhQcY24H0URsEcigo7BU2WCVljx8h8sddWnEJsDEXnOPYcwFkJWEZp%2FEjZZx1477ndW7zmQIX03bFtg92kqLQ6GSc8gNg4SBIuWpVQVZPFW035Ji%2FpJ9PTL5A4B2eaNS3on8pfXuw1fMfiZ10%2F4OFNYutRJ0N%2BU8DA5yrnvzlz4wnxAfFpQeWvZDDd8yLMGBav%2BkzNPVuPishbPgTL977GNUbs2LsSN5kDVZH%2FRxSAHKrcDqLBjyNhhg%2BmwZeQGX3qQNA%3D%3D\u0026X-Amz-Signature=c9893271f66bb185d8d20bf2f09263fe2da735e91b49ad927c3386f7803f0bed"}],"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":190616,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Sorry @mohdhaji87, this was my mistake. I read them as two separate issues.","markdown_message":"\u003cp\u003eSorry \u003ca href=\"/mohdhaji87\"\u003e@mohdhaji87\u003c/a\u003e, this was my mistake. I read them as two separate issues.\u003c/p\u003e\n","automated_response":false,"created_at":"2015-01-03T16:43:18.652Z","updated_at":"2015-01-03T16:43:18.652Z","actor":{"username":"coinbase2","cleared":false,"url":"/coinbase2","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":190618,"is_internal":false,"editable":false,"type":"Activities::BugReopened","message":"","markdown_message":"","automated_response":false,"created_at":"2015-01-03T16:43:27.358Z","updated_at":"2015-01-03T16:43:27.358Z","actor":{"username":"coinbase2","cleared":false,"url":"/coinbase2","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":190620,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2015-01-03T16:43:32.680Z","updated_at":"2015-01-03T16:43:32.680Z","actor":{"username":"coinbase2","cleared":false,"url":"/coinbase2","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"born2hack","url":"/born2hack"},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":190621,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2015-01-03T16:43:46.287Z","updated_at":"2015-01-03T16:43:46.287Z","actor":{"url":"/coinbase","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/104/b151e01a4adbf5ad9067fc30fb2dfe5d5997fa5c_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Coinbase"}},"bounty_amount":"100.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"coinbase","collaborator":{"username":"born2hack","url":"/born2hack"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":427828,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-05-25T03:54:50.511Z","updated_at":"2015-05-25T03:54:50.511Z","first_to_agree":true,"actor":{"username":"born2hack","cleared":false,"url":"/born2hack","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":428090,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-05-25T18:36:59.291Z","updated_at":"2015-05-25T18:36:59.291Z","actor":{"username":"coinbase2","cleared":false,"url":"/coinbase2","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":428091,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-05-25T18:36:59.916Z","updated_at":"2015-05-25T18:36:59.916Z","actor":{"username":"coinbase2","cleared":false,"url":"/coinbase2","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}