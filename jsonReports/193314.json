{"id":193314,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xOTMzMTQ=","url":"https://hackerone.com/reports/193314","title":"SMTP user enumeration via mail.zendesk.com","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2016-12-22T08:40:44.150Z","submitted_at":"2016-12-22T08:40:44.150Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"geeknik","url":"/geeknik","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/7xfGZCKCxUuGLYGfuUZM3XyY/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":205,"url":"https://hackerone.com/zendesk","handle":"zendesk","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/205/1f7838d9b4201d122e0a7fbacc8ff3e90f57fa0c_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/205/1f7838d9b4201d122e0a7fbacc8ff3e90f57fa0c_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Zendesk","twitter_handle":"","website":"https://www.zendesk.com","about":"Zendesk is a leading cloud-based customer service software solution. Over 100,000 customer accounts use Zendesk to increase customer satisfaction."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2019-10-25T20:04:13.133Z","bug_reporter_agreed_on_going_public_at":"2019-10-04T16:05:23.013Z","team_member_agreed_on_going_public_at":"2019-10-25T20:04:12.997Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Several methods exist that can be used to ██████████ SMTP to enumerate valid usernames and addresses; namely VRFY, EXPN, and RCPT TO. `mail.zendesk.com` does not reply to `EXPN` or `RCPT TO` so we will concentrate on `VRFY` in this report.\n\nThe VRFY command will request that the receiving SMTP server verify that a given email username is valid. The SMTP server will reply with the login name of the user. This feature can be turned off in sendmail, because allowing it can be a security hole. VRFY commands can be used to probe for login names on a system.\n\nAn example of this using VRFY is given below, where this list of users\n\n```\nadmin\n█████████\n███\nsupport\n████\n████████\nsecurity\ntest\ntest________________________1\n```\n\nis enumerated:\n\n```\n ----------------------------------------------------------\n|                   Scan Information                       |\n ----------------------------------------------------------\n\nMode ..................... VRFY\nWorker Processes ......... 5\nUsernames file ........... names.txt\nTarget count ............. 1\nUsername count ........... 9\nTarget TCP port .......... 25\nQuery timeout ............ 5 secs\nTarget domain ............\n\n######## Scan started at Thu Dec 22 08:29:37 2016 #########\nmail.zendesk.com: ███████ exists\nmail.zendesk.com: ██████ exists\nmail.zendesk.com: █████████ exists\nmail.zendesk.com: ██████ exists\nmail.zendesk.com: ███\n######## Scan completed at Thu Dec 22 08:29:38 2016 #########\n5 results.\n\n9 queries in 1 seconds (9.0 queries / sec)\n```\n\nThis can also be manually verified:\n\n```\n███:~$ telnet mail.zendesk.com 25\nTrying 192.161.153.1...\nConnected to mail.zendesk.com.\nEscape character is '^]'.\n220 █████████ ESMTP\nVRFY █████\n252 2.0.0 ███████\nVRFY test___________________1\n550 5.1.1 \u003ctest___________________1\u003e: Recipient address rejected: User unknown in local recipient table\nquit\n221 2.0.0 Bye\nConnection closed by foreign host.\n```\n\nThe `252 2.0.0 █████` message indicates success, while the `550 5.1.1` message indicates failure when the username does not exist on this server. \n\n**Mitigation**\nDisable the `VRFY` command in your SMTP server configuration.","vulnerability_information_html":"\u003cp\u003eSeveral methods exist that can be used to ██████████ SMTP to enumerate valid usernames and addresses; namely VRFY, EXPN, and RCPT TO. \u003ccode\u003email.zendesk.com\u003c/code\u003e does not reply to \u003ccode\u003eEXPN\u003c/code\u003e or \u003ccode\u003eRCPT TO\u003c/code\u003e so we will concentrate on \u003ccode\u003eVRFY\u003c/code\u003e in this report.\u003c/p\u003e\n\n\u003cp\u003eThe VRFY command will request that the receiving SMTP server verify that a given email username is valid. The SMTP server will reply with the login name of the user. This feature can be turned off in sendmail, because allowing it can be a security hole. VRFY commands can be used to probe for login names on a system.\u003c/p\u003e\n\n\u003cp\u003eAn example of this using VRFY is given below, where this list of users\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eadmin\n█████████\n███\nsupport\n████\n████████\nsecurity\ntest\ntest________________________1\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eis enumerated:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e ----------------------------------------------------------\n|                   Scan Information                       |\n ----------------------------------------------------------\n\nMode ..................... VRFY\nWorker Processes ......... 5\nUsernames file ........... names.txt\nTarget count ............. 1\nUsername count ........... 9\nTarget TCP port .......... 25\nQuery timeout ............ 5 secs\nTarget domain ............\n\n######## Scan started at Thu Dec 22 08:29:37 2016 #########\nmail.zendesk.com: ███████ exists\nmail.zendesk.com: ██████ exists\nmail.zendesk.com: █████████ exists\nmail.zendesk.com: ██████ exists\nmail.zendesk.com: ███\n######## Scan completed at Thu Dec 22 08:29:38 2016 #########\n5 results.\n\n9 queries in 1 seconds (9.0 queries / sec)\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThis can also be manually verified:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e███:~$ telnet mail.zendesk.com 25\nTrying 192.161.153.1...\nConnected to mail.zendesk.com.\nEscape character is \u0026#39;^]\u0026#39;.\n220 █████████ ESMTP\nVRFY █████\n252 2.0.0 ███████\nVRFY test___________________1\n550 5.1.1 \u0026lt;test___________________1\u0026gt;: Recipient address rejected: User unknown in local recipient table\nquit\n221 2.0.0 Bye\nConnection closed by foreign host.\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThe \u003ccode\u003e252 2.0.0 █████\u003c/code\u003e message indicates success, while the \u003ccode\u003e550 5.1.1\u003c/code\u003e message indicates failure when the username does not exist on this server. \u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eMitigation\u003c/strong\u003e\u003cbr\u003e\nDisable the \u003ccode\u003eVRFY\u003c/code\u003e command in your SMTP server configuration.\u003c/p\u003e\n","bounty_amount":"50.0","formatted_bounty":"$50","weakness":{"id":18,"name":"Information Disclosure"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":16,"voters":["sameerphad72","brodie_codie","geeknik","cr4xerbik4sh","cryptographer","spetr0x","abhiunix","try_to_bug","teknofile","random53","and 6 more..."],"severity":{"rating":"medium","author_type":"User"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1387755,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello @geeknik,\n\nThank you for reporting this issue. The Zendesk Security Team will begin investigating the details of your report. If the issue is verified as a security vulnerability, we will contact you with a timeline for remediation and the amount awarded for the submitted issue.\n\nRegards,\n[Zendesk Security](https://www.zendesk.com/product/features/zendesk-security/)","markdown_message":"\u003cp\u003eHello \u003ca href=\"/geeknik\"\u003e@geeknik\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThank you for reporting this issue. The Zendesk Security Team will begin investigating the details of your report. If the issue is verified as a security vulnerability, we will contact you with a timeline for remediation and the amount awarded for the submitted issue.\u003c/p\u003e\n\n\u003cp\u003eRegards,\u003cbr\u003e\n\u003ca href=\"/redirect?url=https%3A%2F%2Fwww.zendesk.com%2Fproduct%2Ffeatures%2Fzendesk-security%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eZendesk Security\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2016-12-27T19:31:34.263Z","updated_at":"2016-12-27T19:31:34.263Z","actor":{"username":"noops43","cleared":false,"url":"/noops43","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"zendesk","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1389865,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @geeknik,\n\nI've validated the issue and filed a ticket with our teams. I'll award the bounty after our promotion is completed later this week. \n\nRegards,\n[Zendesk Security](https://www.zendesk.com/product/features/zendesk-security/)","markdown_message":"\u003cp\u003eHi \u003ca href=\"/geeknik\"\u003e@geeknik\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eI\u0026#39;ve validated the issue and filed a ticket with our teams. I\u0026#39;ll award the bounty after our promotion is completed later this week. \u003c/p\u003e\n\n\u003cp\u003eRegards,\u003cbr\u003e\n\u003ca href=\"/redirect?url=https%3A%2F%2Fwww.zendesk.com%2Fproduct%2Ffeatures%2Fzendesk-security%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eZendesk Security\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2016-12-29T01:30:06.418Z","updated_at":"2016-12-29T01:30:06.418Z","actor":{"username":"noops43","cleared":false,"url":"/noops43","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"zendesk","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1392935,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Hello @geeknik,\n\nThank you for participating in our Hunting Santa’s Sleigh Bug Bounty promotion. Your submitted vulnerability has been validated and is in process for remediation. \n\nUnfortunately, this report was not selected for the promotional bounties; however, this submission will still be awarded the non-promotional bounty reflecting the presented exploitation risk.\n\nYou will be awarded $50 and publicly thanked for the responsible disclosure on our Hall of Fame. \n\nRegards,\n[Zendesk Security](https://www.zendesk.com/product/features/zendesk-security/)","markdown_message":"\u003cp\u003eHello \u003ca href=\"/geeknik\"\u003e@geeknik\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThank you for participating in our Hunting Santa’s Sleigh Bug Bounty promotion. Your submitted vulnerability has been validated and is in process for remediation. \u003c/p\u003e\n\n\u003cp\u003eUnfortunately, this report was not selected for the promotional bounties; however, this submission will still be awarded the non-promotional bounty reflecting the presented exploitation risk.\u003c/p\u003e\n\n\u003cp\u003eYou will be awarded $50 and publicly thanked for the responsible disclosure on our Hall of Fame. \u003c/p\u003e\n\n\u003cp\u003eRegards,\u003cbr\u003e\n\u003ca href=\"/redirect?url=https%3A%2F%2Fwww.zendesk.com%2Fproduct%2Ffeatures%2Fzendesk-security%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eZendesk Security\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2016-12-31T05:23:37.100Z","updated_at":"2016-12-31T05:23:37.100Z","actor":{"url":"/zendesk","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/205/1f7838d9b4201d122e0a7fbacc8ff3e90f57fa0c_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Zendesk"}},"bounty_amount":"50.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"zendesk","collaborator":{"username":"geeknik","url":"/geeknik"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1392936,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2016-12-31T05:23:46.431Z","updated_at":"2016-12-31T05:23:46.431Z","actor":{"username":"noops43","cleared":false,"url":"/noops43","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"zendesk","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1392938,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for the bounty!","markdown_message":"\u003cp\u003eThanks for the bounty!\u003c/p\u003e\n","automated_response":false,"created_at":"2016-12-31T05:25:04.076Z","updated_at":"2016-12-31T05:25:04.076Z","actor":{"username":"geeknik","cleared":true,"url":"/geeknik","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/7xfGZCKCxUuGLYGfuUZM3XyY/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"zendesk","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1400153,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello @geeknik,\n\nYour submitted issue has been remediated. Can you also verify the fix before we resolve this bug?\n\nRegards,\n[Zendesk Security](https://www.zendesk.com/product/features/zendesk-security/)","markdown_message":"\u003cp\u003eHello \u003ca href=\"/geeknik\"\u003e@geeknik\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eYour submitted issue has been remediated. Can you also verify the fix before we resolve this bug?\u003c/p\u003e\n\n\u003cp\u003eRegards,\u003cbr\u003e\n\u003ca href=\"/redirect?url=https%3A%2F%2Fwww.zendesk.com%2Fproduct%2Ffeatures%2Fzendesk-security%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eZendesk Security\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2017-01-05T00:03:26.363Z","updated_at":"2017-01-05T00:03:26.363Z","actor":{"username":"noops43","cleared":false,"url":"/noops43","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"zendesk","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1400160,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Confirmed fixed:\n\n```\ntelnet mail.zendesk.com 25\nTrying 192.161.153.1...\nConnected to mail.zendesk.com.\nEscape character is '^]'.\n220 ███ ESMTP\nvrfy █████████\n502 5.5.1 VRFY command is disabled\n```","markdown_message":"\u003cp\u003eConfirmed fixed:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003etelnet mail.zendesk.com 25\nTrying 192.161.153.1...\nConnected to mail.zendesk.com.\nEscape character is \u0026#39;^]\u0026#39;.\n220 ███ ESMTP\nvrfy █████████\n502 5.5.1 VRFY command is disabled\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","automated_response":false,"created_at":"2017-01-05T00:05:23.349Z","updated_at":"2019-10-25T20:02:13.677Z","actor":{"username":"geeknik","cleared":true,"url":"/geeknik","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/7xfGZCKCxUuGLYGfuUZM3XyY/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"zendesk","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1401872,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thank you for participating in the [Zendesk Bug Bounty program](https://hackerone.com/zendesk). Please feel free to reach out if you have any questions or concerns.\n\nRegards,\n[Zendesk Security](https://www.zendesk.com/product/features/zendesk-security/)","markdown_message":"\u003cp\u003eThank you for participating in the \u003ca href=\"https://hackerone.com/zendesk\"\u003eZendesk Bug Bounty program\u003c/a\u003e. Please feel free to reach out if you have any questions or concerns.\u003c/p\u003e\n\n\u003cp\u003eRegards,\u003cbr\u003e\n\u003ca href=\"/redirect?url=https%3A%2F%2Fwww.zendesk.com%2Fproduct%2Ffeatures%2Fzendesk-security%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eZendesk Security\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2017-01-05T16:38:57.784Z","updated_at":"2017-01-05T16:38:57.784Z","actor":{"username":"noops43","cleared":false,"url":"/noops43","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"geeknik","url":"/geeknik"},"genius_execution_id":null,"team_handle":"zendesk","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5960497,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-10-04T16:05:23.041Z","updated_at":"2019-10-04T16:05:23.041Z","first_to_agree":true,"actor":{"username":"geeknik","cleared":true,"url":"/geeknik","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/7xfGZCKCxUuGLYGfuUZM3XyY/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"zendesk","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6140911,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-10-25T20:04:13.019Z","updated_at":"2019-10-25T20:04:13.019Z","actor":{"username":"thepomerium","cleared":false,"url":"/thepomerium","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/sMJZc5YhRen9pFb2p3JCLqMP/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zendesk","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6140912,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-10-25T20:04:13.171Z","updated_at":"2019-10-25T20:04:13.171Z","actor":{"username":"thepomerium","cleared":false,"url":"/thepomerium","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/sMJZc5YhRen9pFb2p3JCLqMP/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zendesk","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":18663,"category":"team","content":"Around three years ago, @geeknik found the `VRFY` method was enabled at `mail.zendesk.com` allowing for user enumeration. ","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eAround three years ago, \u003ca href=\"/geeknik\"\u003e@geeknik\u003c/a\u003e found the \u003ccode\u003eVRFY\u003c/code\u003e method was enabled at \u003ccode\u003email.zendesk.com\u003c/code\u003e allowing for user enumeration. \u003c/p\u003e\n"},{"category":"researcher","can_view?":true,"can_create?":false}]}