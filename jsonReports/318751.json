{"id":318751,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zMTg3NTE=","url":"https://hackerone.com/reports/318751","title":"Access to Private Photos of Apps in App section(IDOR)","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2018-02-22T20:01:57.103Z","submitted_at":"2018-02-22T20:01:57.103Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"indoappsec","url":"/indoappsec","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/QUAjqUf576QNBhxg691WB8YG/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1382,"url":"https://hackerone.com/shopify","handle":"shopify","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Shopify","twitter_handle":"","website":"https://www.shopify.com","about":"Shopify is a multi-channel commerce platform that helps people sell online, in-store, and everywhere in between."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2018-03-05T19:34:35.107Z","bug_reporter_agreed_on_going_public_at":"2018-03-05T19:34:34.994Z","team_member_agreed_on_going_public_at":"2018-03-05T18:57:49.033Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"##Bug location :\n https://[MyShop].myshopify.com/admin/apps\n\n##Description : \nPreviewing the Photo In App section Request is vulnerable to IDOR attack where changing the ID leads to Disclose Link of Private photos. Also It discloses the Shop Domain details also. The request goes through exchange.shopify.com. \n\n##Vulnerable Request : \nGET /listings/hackeronevg1110/shop_screenshots/85952 HTTP/1.1\nHost: exchange.shopify.com\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.11; rv:57.0) Gecko/20100101 Firefox/57.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nCookie: [Cookies]\nConnection: close\nUpgrade-Insecure-Requests: 1\n\n\nLet me know if you need more info.\n\nRegards,\nVijay Kumar\n\n## Impact\n\nInformation disclosure.","vulnerability_information_html":"\u003ch2 id=\"bug-location\"\u003eBug location :\u003c/h2\u003e\n\n\u003cp\u003ehttps://[MyShop].myshopify.com/admin/apps\u003c/p\u003e\n\n\u003ch2 id=\"description\"\u003eDescription :\u003c/h2\u003e\n\n\u003cp\u003ePreviewing the Photo In App section Request is vulnerable to IDOR attack where changing the ID leads to Disclose Link of Private photos. Also It discloses the Shop Domain details also. The request goes through exchange.shopify.com. \u003c/p\u003e\n\n\u003ch2 id=\"vulnerable-request\"\u003eVulnerable Request :\u003c/h2\u003e\n\n\u003cp\u003eGET /listings/hackeronevg1110/shop_screenshots/85952 HTTP/1.1\u003cbr\u003e\nHost: exchange.shopify.com\u003cbr\u003e\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.11; rv:57.0) Gecko/20100101 Firefox/57.0\u003cbr\u003e\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,\u003cem\u003e/\u003c/em\u003e;q=0.8\u003cbr\u003e\nAccept-Language: en-US,en;q=0.5\u003cbr\u003e\nAccept-Encoding: gzip, deflate\u003cbr\u003e\nCookie: [Cookies]\u003cbr\u003e\nConnection: close\u003cbr\u003e\nUpgrade-Insecure-Requests: 1\u003c/p\u003e\n\n\u003cp\u003eLet me know if you need more info.\u003c/p\u003e\n\n\u003cp\u003eRegards,\u003cbr\u003e\nVijay Kumar\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eInformation disclosure.\u003c/p\u003e\n","bounty_amount":"500.0","formatted_bounty":"$500","weakness":{"id":55,"name":"Insecure Direct Object Reference (IDOR)"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":13,"voters":["bl4de","eveeez","indoappsec","akhilmm","vulnh0lic","cr4xerbik4sh","bb00x","sumit7","namansahore","0x08","and 3 more..."],"severity":{"rating":"medium","score":4.6,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"none","user_interaction":"none","scope":"unchanged","confidentiality":"low","integrity":"none","availability":"none"}},"structured_scope":{"databaseId":6663,"asset_type":"URL","asset_identifier":"https://exchangemarketplace.com/","max_severity":"medium"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":2423114,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @vijay_kumar1110,\nthanks for your report. I'm having trouble reproducing, if I try to access your listing, I'm redirected to the app installation screen despite having the app installed on my store {F265958} Please provide clear steps to reproduce the issue or a video of the behaviour.\n\nAlso, please note that Exchange is currently not in scope of our program so this may not be eligible for a bounty.\n\nThanks\nPete","markdown_message":"\u003cp\u003eHi \u003ca href=\"/vijay_kumar1110\"\u003e@vijay_kumar1110\u003c/a\u003e,\u003cbr\u003e\nthanks for your report. I\u0026#39;m having trouble reproducing, if I try to access your listing, I\u0026#39;m redirected to the app installation screen despite having the app installed on my store \u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"Screen_Shot_2018-02-22_at_3.49.52_PM.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/265/958/6050ce472113063535e2706e41896ee029eae8ac/Screen_Shot_2018-02-22_at_3.49.52_PM.png?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2018-02-22_at_3.49.52_PM.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2018-02-22_at_3.49.52_PM.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQ6NMQGJ6E%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T053403Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCJPJ3IXoQNPAbQsg0bSSDfaJAZgsDgYrylclk1ric%2BkwIgDMmyHsdGD2jlH3d3dln%2FDB9m9n5i6VO9V2BpF6r0awgqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDCkjwEt6QlasbvM7ZiqRA8ipmJh0c%2Fct0msibE3n%2BnRShysnYAR7o%2FZb%2FNOpmlF41MYM4vnJx%2BKnhTDzjqB75T669Dmp%2FumbZJRIrhxgKJdSS92b6LQmv9XRjqyLPfQsEclw5qtwUJW48f0o0jPTkAA4Oc%2BOTznto%2FOC5dkeM5uzkchKTgv5sWyez3jHbO7YDmRMySDgSE0WkHBXhPZQyAnXHSKzrXWN4GxrsWDdDySlVvWJsjrqXJKYAL2xPI5%2FjSILjkUZ9kuALSA0BMOHlFfmOR9rXay9ZlJsKpIxq9W0g1cPU3rH2nhREBGoWjmO0zL5UzdA7mwH0emOB4l8od6kgtXvLqzikrqRZmjMafaJ4rwl7m%2F7kPi1mAWR01Xv4I7g6KRnBZoinRfFyi2aIRNmob0mp4O8dYWiI1UFCKekGmxdeEXsT%2B%2FfnOI6%2FAtmxCqBeZUB9WYcY7kMDIvIEvzHxMtG1QwLQB%2BkEanZgNJjUMVu%2BvkfnJq5ZFHRe1C33%2Bq7yApHokLx%2FpLKVFcbwIWj3IdU3SreS0T7b9NvUTUDMJrwqv8FOusBw2IadTH8jjyfIyLkG4%2BNkdrwzFLtfIjsHPdVpCkbbFU1ZYFUCT0auJmrX%2FxO31nzBV099ZiTIwmiaOXiEjREOeewBAYJIv2hxCC3PImV9Eo0xANYmEhG2QXnopWMla2LfC9A6LxCjHun0xukJwsfGjUNY%2BDMADaaUMtUItG63%2FF90r5a633HiieX5u6juKS9PEtljaKdlyfR86kZEzrXCfQmIoLh2OFdNeX0ArfbPO0PDWdVEi5auyGRhX3N1wchgL501NrEkDSpnVLS%2BEE5kKFufTTZUhelsnV4VtqdHW410LhjtT2ub2vVDA%3D%3D\u0026amp;X-Amz-Signature=3172e2b7da31f97c418832b1ad36052d0334c6a771506326b21368564de30d9a\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/265/958/6050ce472113063535e2706e41896ee029eae8ac/Screen_Shot_2018-02-22_at_3.49.52_PM.png?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2018-02-22_at_3.49.52_PM.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2018-02-22_at_3.49.52_PM.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQ6NMQGJ6E%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T053403Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCJPJ3IXoQNPAbQsg0bSSDfaJAZgsDgYrylclk1ric%2BkwIgDMmyHsdGD2jlH3d3dln%2FDB9m9n5i6VO9V2BpF6r0awgqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDCkjwEt6QlasbvM7ZiqRA8ipmJh0c%2Fct0msibE3n%2BnRShysnYAR7o%2FZb%2FNOpmlF41MYM4vnJx%2BKnhTDzjqB75T669Dmp%2FumbZJRIrhxgKJdSS92b6LQmv9XRjqyLPfQsEclw5qtwUJW48f0o0jPTkAA4Oc%2BOTznto%2FOC5dkeM5uzkchKTgv5sWyez3jHbO7YDmRMySDgSE0WkHBXhPZQyAnXHSKzrXWN4GxrsWDdDySlVvWJsjrqXJKYAL2xPI5%2FjSILjkUZ9kuALSA0BMOHlFfmOR9rXay9ZlJsKpIxq9W0g1cPU3rH2nhREBGoWjmO0zL5UzdA7mwH0emOB4l8od6kgtXvLqzikrqRZmjMafaJ4rwl7m%2F7kPi1mAWR01Xv4I7g6KRnBZoinRfFyi2aIRNmob0mp4O8dYWiI1UFCKekGmxdeEXsT%2B%2FfnOI6%2FAtmxCqBeZUB9WYcY7kMDIvIEvzHxMtG1QwLQB%2BkEanZgNJjUMVu%2BvkfnJq5ZFHRe1C33%2Bq7yApHokLx%2FpLKVFcbwIWj3IdU3SreS0T7b9NvUTUDMJrwqv8FOusBw2IadTH8jjyfIyLkG4%2BNkdrwzFLtfIjsHPdVpCkbbFU1ZYFUCT0auJmrX%2FxO31nzBV099ZiTIwmiaOXiEjREOeewBAYJIv2hxCC3PImV9Eo0xANYmEhG2QXnopWMla2LfC9A6LxCjHun0xukJwsfGjUNY%2BDMADaaUMtUItG63%2FF90r5a633HiieX5u6juKS9PEtljaKdlyfR86kZEzrXCfQmIoLh2OFdNeX0ArfbPO0PDWdVEi5auyGRhX3N1wchgL501NrEkDSpnVLS%2BEE5kKFufTTZUhelsnV4VtqdHW410LhjtT2ub2vVDA%3D%3D\u0026amp;X-Amz-Signature=3172e2b7da31f97c418832b1ad36052d0334c6a771506326b21368564de30d9a\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e Please provide clear steps to reproduce the issue or a video of the behaviour.\u003c/p\u003e\n\n\u003cp\u003eAlso, please note that Exchange is currently not in scope of our program so this may not be eligible for a bounty.\u003c/p\u003e\n\n\u003cp\u003eThanks\u003cbr\u003e\nPete\u003c/p\u003e\n","automated_response":false,"created_at":"2018-02-22T20:51:27.081Z","updated_at":"2018-02-22T20:51:27.081Z","actor":{"username":"shopify-peteryaworski","cleared":false,"url":"/shopify-peteryaworski","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/175/526/7ba4844078e290c91c4c46a345b4f9e7666f3ed4_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"attachments":[{"id":265958,"filename":"Screen_Shot_2018-02-22_at_3.49.52_PM.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/265/958/6050ce472113063535e2706e41896ee029eae8ac/Screen_Shot_2018-02-22_at_3.49.52_PM.png?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2018-02-22_at_3.49.52_PM.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2018-02-22_at_3.49.52_PM.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ6NMQGJ6E%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T053403Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCJPJ3IXoQNPAbQsg0bSSDfaJAZgsDgYrylclk1ric%2BkwIgDMmyHsdGD2jlH3d3dln%2FDB9m9n5i6VO9V2BpF6r0awgqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDCkjwEt6QlasbvM7ZiqRA8ipmJh0c%2Fct0msibE3n%2BnRShysnYAR7o%2FZb%2FNOpmlF41MYM4vnJx%2BKnhTDzjqB75T669Dmp%2FumbZJRIrhxgKJdSS92b6LQmv9XRjqyLPfQsEclw5qtwUJW48f0o0jPTkAA4Oc%2BOTznto%2FOC5dkeM5uzkchKTgv5sWyez3jHbO7YDmRMySDgSE0WkHBXhPZQyAnXHSKzrXWN4GxrsWDdDySlVvWJsjrqXJKYAL2xPI5%2FjSILjkUZ9kuALSA0BMOHlFfmOR9rXay9ZlJsKpIxq9W0g1cPU3rH2nhREBGoWjmO0zL5UzdA7mwH0emOB4l8od6kgtXvLqzikrqRZmjMafaJ4rwl7m%2F7kPi1mAWR01Xv4I7g6KRnBZoinRfFyi2aIRNmob0mp4O8dYWiI1UFCKekGmxdeEXsT%2B%2FfnOI6%2FAtmxCqBeZUB9WYcY7kMDIvIEvzHxMtG1QwLQB%2BkEanZgNJjUMVu%2BvkfnJq5ZFHRe1C33%2Bq7yApHokLx%2FpLKVFcbwIWj3IdU3SreS0T7b9NvUTUDMJrwqv8FOusBw2IadTH8jjyfIyLkG4%2BNkdrwzFLtfIjsHPdVpCkbbFU1ZYFUCT0auJmrX%2FxO31nzBV099ZiTIwmiaOXiEjREOeewBAYJIv2hxCC3PImV9Eo0xANYmEhG2QXnopWMla2LfC9A6LxCjHun0xukJwsfGjUNY%2BDMADaaUMtUItG63%2FF90r5a633HiieX5u6juKS9PEtljaKdlyfR86kZEzrXCfQmIoLh2OFdNeX0ArfbPO0PDWdVEi5auyGRhX3N1wchgL501NrEkDSpnVLS%2BEE5kKFufTTZUhelsnV4VtqdHW410LhjtT2ub2vVDA%3D%3D\u0026X-Amz-Signature=3172e2b7da31f97c418832b1ad36052d0334c6a771506326b21368564de30d9a"}],"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2423116,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"","markdown_message":"","automated_response":false,"created_at":"2018-02-22T20:52:01.166Z","updated_at":"2018-02-22T20:52:01.166Z","actor":{"username":"shopify-peteryaworski","cleared":false,"url":"/shopify-peteryaworski","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/175/526/7ba4844078e290c91c4c46a345b4f9e7666f3ed4_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2423155,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"@shopify-peteryaworski : Apologies for the Less details here. I am providing Steps to reproduce the issue.\n\n##Steps :\n1.Create new shopify Account and create your development store. \n2.Now go to https://exchange.shopify.com and Add new business with your shopify account. \nLink : https://exchange.shopify.com/create-a-listing ( Choose my business on shopify)\n3.This will redirect you to your my shopify account where you can add new listing on exchange .\n4.In the Detail Section you will find \"Store screenshots\" option where you can upload images which will be shown to your listing on exchange. \n5.Upload new Image and you will see Preview option . \n6.When you click to this preview option then the  image will be Displayed.\n7.If you intercept this request it would look something like above mentioned request. It gives response with Uploaded image on Shopify server.\n Ex: https://shopify-exchange.s3.amazonaws.com/screenshots/hackeronevg1110.myshopify.com-928eb3774d8ca27a.jpeg\nBy this you can have access to the images and also it shows Shopify Domain of other users. \n8.Here Shop \"shop_screenshots\" ID is vulnerable to IDOR attack.\n9.If you change this to any other ShopID , you will get Photos and the my shopify domain name of users.\nI am attaching a screenshot for help. \n\nLet me know if you Require more information or Video POC for this issue.\n\nRegards,\nVijay Kumar ","markdown_message":"\u003cp\u003e\u003ca href=\"/shopify-peteryaworski\"\u003e@shopify-peteryaworski\u003c/a\u003e : Apologies for the Less details here. I am providing Steps to reproduce the issue.\u003c/p\u003e\n\n\u003ch2 id=\"steps\"\u003eSteps :\u003c/h2\u003e\n\n\u003cp\u003e1.Create new shopify Account and create your development store. \u003cbr\u003e\n2.Now go to \u003ca title=\"https://exchange.shopify.com\" href=\"/redirect?url=https%3A%2F%2Fexchange.shopify.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://exchange.shopify.com\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e and Add new business with your shopify account. \u003cbr\u003e\nLink : \u003ca title=\"https://exchange.shopify.com/create-a-listing\" href=\"/redirect?url=https%3A%2F%2Fexchange.shopify.com%2Fcreate-a-listing\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://exchange.shopify.com/create-a-listing\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e ( Choose my business on shopify)\u003cbr\u003e\n3.This will redirect you to your my shopify account where you can add new listing on exchange .\u003cbr\u003e\n4.In the Detail Section you will find \u0026quot;Store screenshots\u0026quot; option where you can upload images which will be shown to your listing on exchange. \u003cbr\u003e\n5.Upload new Image and you will see Preview option . \u003cbr\u003e\n6.When you click to this preview option then the  image will be Displayed.\u003cbr\u003e\n7.If you intercept this request it would look something like above mentioned request. It gives response with Uploaded image on Shopify server.\u003cbr\u003e\n Ex: \u003ca title=\"https://shopify-exchange.s3.amazonaws.com/screenshots/hackeronevg1110.myshopify.com-928eb3774d8ca27a.jpeg\" href=\"/redirect?url=https%3A%2F%2Fshopify-exchange.s3.amazonaws.com%2Fscreenshots%2Fhackeronevg1110.myshopify.com-928eb3774d8ca27a.jpeg\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://shopify-exchange.s3.amazonaws.com/screenshots/hackeronevg1110.myshopify.com-928eb3774d8ca27a.jpeg\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nBy this you can have access to the images and also it shows Shopify Domain of other users. \u003cbr\u003e\n8.Here Shop \u0026quot;shop_screenshots\u0026quot; ID is vulnerable to IDOR attack.\u003cbr\u003e\n9.If you change this to any other ShopID , you will get Photos and the my shopify domain name of users.\u003cbr\u003e\nI am attaching a screenshot for help. \u003c/p\u003e\n\n\u003cp\u003eLet me know if you Require more information or Video POC for this issue.\u003c/p\u003e\n\n\u003cp\u003eRegards,\u003cbr\u003e\nVijay Kumar \u003c/p\u003e\n","automated_response":false,"created_at":"2018-02-22T21:09:51.197Z","updated_at":"2018-02-22T21:09:51.197Z","actor":{"username":"indoappsec","cleared":true,"url":"/indoappsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/QUAjqUf576QNBhxg691WB8YG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":265963,"filename":"Screen_Shot_2018-02-23_at_2.53.41_AM.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/265/963/f577fddde15afd48d37207070dc4246e319b96c2/Screen_Shot_2018-02-23_at_2.53.41_AM.png?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2018-02-23_at_2.53.41_AM.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2018-02-23_at_2.53.41_AM.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ6NMQGJ6E%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T053403Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCJPJ3IXoQNPAbQsg0bSSDfaJAZgsDgYrylclk1ric%2BkwIgDMmyHsdGD2jlH3d3dln%2FDB9m9n5i6VO9V2BpF6r0awgqtAMIVhABGgwwMTM2MTkyNzQ4NDkiDCkjwEt6QlasbvM7ZiqRA8ipmJh0c%2Fct0msibE3n%2BnRShysnYAR7o%2FZb%2FNOpmlF41MYM4vnJx%2BKnhTDzjqB75T669Dmp%2FumbZJRIrhxgKJdSS92b6LQmv9XRjqyLPfQsEclw5qtwUJW48f0o0jPTkAA4Oc%2BOTznto%2FOC5dkeM5uzkchKTgv5sWyez3jHbO7YDmRMySDgSE0WkHBXhPZQyAnXHSKzrXWN4GxrsWDdDySlVvWJsjrqXJKYAL2xPI5%2FjSILjkUZ9kuALSA0BMOHlFfmOR9rXay9ZlJsKpIxq9W0g1cPU3rH2nhREBGoWjmO0zL5UzdA7mwH0emOB4l8od6kgtXvLqzikrqRZmjMafaJ4rwl7m%2F7kPi1mAWR01Xv4I7g6KRnBZoinRfFyi2aIRNmob0mp4O8dYWiI1UFCKekGmxdeEXsT%2B%2FfnOI6%2FAtmxCqBeZUB9WYcY7kMDIvIEvzHxMtG1QwLQB%2BkEanZgNJjUMVu%2BvkfnJq5ZFHRe1C33%2Bq7yApHokLx%2FpLKVFcbwIWj3IdU3SreS0T7b9NvUTUDMJrwqv8FOusBw2IadTH8jjyfIyLkG4%2BNkdrwzFLtfIjsHPdVpCkbbFU1ZYFUCT0auJmrX%2FxO31nzBV099ZiTIwmiaOXiEjREOeewBAYJIv2hxCC3PImV9Eo0xANYmEhG2QXnopWMla2LfC9A6LxCjHun0xukJwsfGjUNY%2BDMADaaUMtUItG63%2FF90r5a633HiieX5u6juKS9PEtljaKdlyfR86kZEzrXCfQmIoLh2OFdNeX0ArfbPO0PDWdVEi5auyGRhX3N1wchgL501NrEkDSpnVLS%2BEE5kKFufTTZUhelsnV4VtqdHW410LhjtT2ub2vVDA%3D%3D\u0026X-Amz-Signature=65f28de5d3e0c4a003b3507e17e4330e319e5214b61669dc4c5c1f7015323324"}],"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2423236,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2018-02-22T22:10:16.308Z","updated_at":"2018-02-22T22:10:16.308Z","additional_data":{"old_severity":"High","new_severity":"Low","old_severity_id":121631,"new_severity_id":121648},"actor":{"username":"shopify-peteryaworski","cleared":false,"url":"/shopify-peteryaworski","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/175/526/7ba4844078e290c91c4c46a345b4f9e7666f3ed4_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2423242,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thank you for the added steps. I was able to reproduce and am triaging. \n\nPlease note, I assume you are testing exchange because of the email you received. We asked that you include `████████` so we can easily differentiate eligible/non-eligible reports for bounties. If you have additional reports to submit, please ensure to include that to ensure you are paid.","markdown_message":"\u003cp\u003eThank you for the added steps. I was able to reproduce and am triaging. \u003c/p\u003e\n\n\u003cp\u003ePlease note, I assume you are testing exchange because of the email you received. We asked that you include \u003ccode\u003e████████\u003c/code\u003e so we can easily differentiate eligible/non-eligible reports for bounties. If you have additional reports to submit, please ensure to include that to ensure you are paid.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-02-22T22:10:56.530Z","updated_at":"2018-02-23T20:05:20.544Z","actor":{"username":"shopify-peteryaworski","cleared":false,"url":"/shopify-peteryaworski","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/175/526/7ba4844078e290c91c4c46a345b4f9e7666f3ed4_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2423255,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@shopify-peteryaworski : I think i forgot to mentioned \"████████\" . Do you want me to update in Summery or you can update report title including this ??","markdown_message":"\u003cp\u003e\u003ca href=\"/shopify-peteryaworski\"\u003e@shopify-peteryaworski\u003c/a\u003e : I think i forgot to mentioned \u0026quot;████████\u0026quot; . Do you want me to update in Summery or you can update report title including this ??\u003c/p\u003e\n","automated_response":false,"created_at":"2018-02-22T22:17:16.649Z","updated_at":"2018-02-23T20:05:20.531Z","actor":{"username":"indoappsec","cleared":true,"url":"/indoappsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/QUAjqUf576QNBhxg691WB8YG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2425781,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2018-02-23T14:27:12.177Z","updated_at":"2018-02-23T14:27:12.177Z","actor":{"url":"/shopify","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Shopify"}},"bounty_amount":"500.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"shopify","collaborator":{"username":"indoappsec","url":"/indoappsec"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2425790,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @vijay_kumar1110, yes we were looking for that. It's fine, you don't have to update anything. But if you submit additional reports, please include it the report body.\n\nThanks again for this report, I'm looking forward to more from you.\nPete","markdown_message":"\u003cp\u003eHi \u003ca href=\"/vijay_kumar1110\"\u003e@vijay_kumar1110\u003c/a\u003e, yes we were looking for that. It\u0026#39;s fine, you don\u0026#39;t have to update anything. But if you submit additional reports, please include it the report body.\u003c/p\u003e\n\n\u003cp\u003eThanks again for this report, I\u0026#39;m looking forward to more from you.\u003cbr\u003e\nPete\u003c/p\u003e\n","automated_response":false,"created_at":"2018-02-23T14:30:16.703Z","updated_at":"2018-02-23T14:30:16.703Z","actor":{"username":"shopify-peteryaworski","cleared":false,"url":"/shopify-peteryaworski","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/175/526/7ba4844078e290c91c4c46a345b4f9e7666f3ed4_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2426058,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thank you again for your report. We have deployed a fix for this issue and you should no longer be able to access screenshots on unlisted shops.\n\nWe have decided to reward a $500 bounty for this report because screenshots are intended to become public when the shop listing is approved.","markdown_message":"\u003cp\u003eThank you again for your report. We have deployed a fix for this issue and you should no longer be able to access screenshots on unlisted shops.\u003c/p\u003e\n\n\u003cp\u003eWe have decided to reward a $500 bounty for this report because screenshots are intended to become public when the shop listing is approved.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-02-23T16:13:10.842Z","updated_at":"2018-02-23T16:13:10.842Z","actor":{"username":"no-longer-with-company","cleared":false,"url":"/no-longer-with-company","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/072/324/c6fb0a069a32f1e9f503089aa18807ad593549e0_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"indoappsec","url":"/indoappsec"},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2426697,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@juanbroullon : Thanks a lot for the quick Resolution and Reward. I apologise i couldn't mention the Impact and severity of the issue. Actually In exchange Admin can add multiple photos but only one Photo can be displayed on exchange listing. Example : Admin of listing can add 10 photos but he can only display one photo on exchange listing. So all other Photos should be private to admin only but with this issue Attacker has ability to disclose all the private photos . Also when the Listing is Unpublished then Listing is not available to Public but still the attacker can have access to the Photos of any Unpublished listing . Also The Attack Complexity is very low which leads to easily access to all the photos of Shopify without any much efforts. \nA very important point you missed here is it's also Disclosing a Domain names of All shopify Stores. \nEx: https://exchange.shopifycdn.com/screenshots/vijaykumar007hackeronestore.myshopify.com-e782cc44893e386a.jpg\nHere \" vijaykumar007hackeronestore.myshopify.com\" is my Domain name . I am getting Domain names for all the Shopify Stores with this. \nAdditionally the issue is in Shopify Core and Direct . So according to me the reward amount should be higher then this. I request you to Re look into the above mentioned Points and Help me out here if possible. Finally Decision is yours and Respected. \n@shopify-peteryaworski : Started Testing Shopify After a long time. I am hoping to find and report more issues :) \n\nRegards,\nVijay Kumar ","markdown_message":"\u003cp\u003e\u003ca href=\"/juanbroullon\"\u003e@juanbroullon\u003c/a\u003e : Thanks a lot for the quick Resolution and Reward. I apologise i couldn\u0026#39;t mention the Impact and severity of the issue. Actually In exchange Admin can add multiple photos but only one Photo can be displayed on exchange listing. Example : Admin of listing can add 10 photos but he can only display one photo on exchange listing. So all other Photos should be private to admin only but with this issue Attacker has ability to disclose all the private photos . Also when the Listing is Unpublished then Listing is not available to Public but still the attacker can have access to the Photos of any Unpublished listing . Also The Attack Complexity is very low which leads to easily access to all the photos of Shopify without any much efforts. \u003cbr\u003e\nA very important point you missed here is it\u0026#39;s also Disclosing a Domain names of All shopify Stores. \u003cbr\u003e\nEx: \u003ca title=\"https://exchange.shopifycdn.com/screenshots/vijaykumar007hackeronestore.myshopify.com-e782cc44893e386a.jpg\" href=\"/redirect?url=https%3A%2F%2Fexchange.shopifycdn.com%2Fscreenshots%2Fvijaykumar007hackeronestore.myshopify.com-e782cc44893e386a.jpg\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://exchange.shopifycdn.com/screenshots/vijaykumar007hackeronestore.myshopify.com-e782cc44893e386a.jpg\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nHere \u0026quot; vijaykumar007hackeronestore.myshopify.com\u0026quot; is my Domain name . I am getting Domain names for all the Shopify Stores with this. \u003cbr\u003e\nAdditionally the issue is in Shopify Core and Direct . So according to me the reward amount should be higher then this. I request you to Re look into the above mentioned Points and Help me out here if possible. Finally Decision is yours and Respected. \u003cbr\u003e\n\u003ca href=\"/shopify-peteryaworski\"\u003e@shopify-peteryaworski\u003c/a\u003e : Started Testing Shopify After a long time. I am hoping to find and report more issues :) \u003c/p\u003e\n\n\u003cp\u003eRegards,\u003cbr\u003e\nVijay Kumar \u003c/p\u003e\n","automated_response":false,"created_at":"2018-02-23T18:40:31.941Z","updated_at":"2018-02-23T18:40:31.941Z","actor":{"username":"indoappsec","cleared":true,"url":"/indoappsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/QUAjqUf576QNBhxg691WB8YG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2426928,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you for the further information. All the screenshots for a given shop will be displayed once the listing is approved and published, you will be able to see the rest of the them at the bottom of the page.\n\nAlthough I didn't mention it on my response, the bounty decision was taken keeping in mind the shop domains were also accessible. We don't think retrieving the domain name in the response increases the severity of this issue as they are as well meant to be public once the listings are approved.\n\nExchange is an embedded app. Embedded apps or some of their sections can be rendered within Shopify Core, so even though screenshots were being shown in the Shopify admin area the logic behind what screenshots should be shown resides in the code of Exchange.\n\nThe bounty amount won't be increased unless a wider impact or alternative ways to exploit this issue are proven. ","markdown_message":"\u003cp\u003eThank you for the further information. All the screenshots for a given shop will be displayed once the listing is approved and published, you will be able to see the rest of the them at the bottom of the page.\u003c/p\u003e\n\n\u003cp\u003eAlthough I didn\u0026#39;t mention it on my response, the bounty decision was taken keeping in mind the shop domains were also accessible. We don\u0026#39;t think retrieving the domain name in the response increases the severity of this issue as they are as well meant to be public once the listings are approved.\u003c/p\u003e\n\n\u003cp\u003eExchange is an embedded app. Embedded apps or some of their sections can be rendered within Shopify Core, so even though screenshots were being shown in the Shopify admin area the logic behind what screenshots should be shown resides in the code of Exchange.\u003c/p\u003e\n\n\u003cp\u003eThe bounty amount won\u0026#39;t be increased unless a wider impact or alternative ways to exploit this issue are proven. \u003c/p\u003e\n","automated_response":false,"created_at":"2018-02-23T19:59:12.291Z","updated_at":"2018-02-23T19:59:12.291Z","actor":{"username":"no-longer-with-company","cleared":false,"url":"/no-longer-with-company","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/072/324/c6fb0a069a32f1e9f503089aa18807ad593549e0_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2461144,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-03-05T18:57:49.072Z","updated_at":"2018-03-05T18:57:49.072Z","first_to_agree":true,"actor":{"username":"no-longer-with-company","cleared":false,"url":"/no-longer-with-company","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/072/324/c6fb0a069a32f1e9f503089aa18807ad593549e0_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2461281,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"@juanbroullon : Happy to work with you guys :)","markdown_message":"\u003cp\u003e\u003ca href=\"/juanbroullon\"\u003e@juanbroullon\u003c/a\u003e : Happy to work with you guys :)\u003c/p\u003e\n","automated_response":false,"created_at":"2018-03-05T19:34:35.027Z","updated_at":"2018-03-05T19:34:35.027Z","actor":{"username":"indoappsec","cleared":true,"url":"/indoappsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/QUAjqUf576QNBhxg691WB8YG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2461282,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-03-05T19:34:35.137Z","updated_at":"2018-03-05T19:34:35.137Z","actor":{"username":"indoappsec","cleared":true,"url":"/indoappsec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/QUAjqUf576QNBhxg691WB8YG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2889875,"is_internal":false,"editable":false,"type":"Activities::ChangedScope","message":"","markdown_message":"","automated_response":false,"created_at":"2018-06-15T17:53:13.540Z","updated_at":"2018-06-15T17:53:13.540Z","actor":{"username":"shopify-peteryaworski","cleared":false,"url":"/shopify-peteryaworski","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/175/526/7ba4844078e290c91c4c46a345b4f9e7666f3ed4_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"old_scope":"your-store.myshopify.com","new_scope":"https://exchangemarketplace.com/","genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2889876,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2018-06-15T17:53:26.348Z","updated_at":"2018-06-15T17:53:26.348Z","additional_data":{"old_severity":"Low","new_severity":"Medium (4.6)","old_severity_id":121648,"new_severity_id":168632},"actor":{"username":"shopify-peteryaworski","cleared":false,"url":"/shopify-peteryaworski","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/175/526/7ba4844078e290c91c4c46a345b4f9e7666f3ed4_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":6689,"category":"team","content":"@vijay_kumar1110 reported an Insecure Direct Object Reference vulnerability on our Exchange app. This issue could have allowed an attacker to iterate over the shops' screenshot IDs in order to enumerate them and obtain a public accessible URL for all the shop screenshots hosted on Exchange, regardless of whether the listings were public or private.\n\nWe have fixed the issue by checking whether the shop accessing the screenshots is the owner of them.","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003e\u003ca href=\"/vijay_kumar1110\"\u003e@vijay_kumar1110\u003c/a\u003e reported an Insecure Direct Object Reference vulnerability on our Exchange app. This issue could have allowed an attacker to iterate over the shops\u0026#39; screenshot IDs in order to enumerate them and obtain a public accessible URL for all the shop screenshots hosted on Exchange, regardless of whether the listings were public or private.\u003c/p\u003e\n\n\u003cp\u003eWe have fixed the issue by checking whether the shop accessing the screenshots is the owner of them.\u003c/p\u003e\n"},{"category":"researcher","can_view?":true,"can_create?":false}]}