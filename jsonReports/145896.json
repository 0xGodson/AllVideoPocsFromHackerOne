{"id":145896,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNDU4OTY=","url":"https://hackerone.com/reports/145896","title":"Password reset link remains valid after email change","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-06-19T17:40:12.035Z","submitted_at":"2016-06-19T17:40:12.035Z","is_member_of_team?":false,"reporter":{"disabled":true,"username":"rootxflood","url":"/rootxflood","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13291,"url":"https://hackerone.com/nextcloud","handle":"nextcloud","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Nextcloud","twitter_handle":"nextclouders","website":"https://nextcloud.com","about":"Access, share and protect your files, calendars, contacts, communication \u0026 more at home and in your enterprise."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2016-12-13T16:12:16.461Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2016-11-13T16:12:00.466Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hey!\nI found a token miss configuration flaw in Nextcloud 9.0.50 [Latest version], When we reset password for a user a link is sent to the registered email address but incase it remain unused and email is updated by user from control panel then too that old token [reset link] sent at old email address remains valid.\n\nA better explanation\n-\n1- User use reset feature to get reset link [Email : abc@x.com]\n2- User came to know about his old password so remain the link unused and the token not expires \n3- Now User changes his email from control panel [New email : abcd@z.com]\n4- But the old reset still remains valid after email change\n\nIn-case an attacker able to get access to user's old email account he can hack his Nextcloud account too via that link, so expiring the token at email change will be a better practice","vulnerability_information_html":"\u003cp\u003eHey!\u003cbr\u003e\nI found a token miss configuration flaw in Nextcloud 9.0.50 [Latest version], When we reset password for a user a link is sent to the registered email address but incase it remain unused and email is updated by user from control panel then too that old token [reset link] sent at old email address remains valid.\u003c/p\u003e\n\n\u003ch2 id=\"a-better-explanation\"\u003eA better explanation\u003c/h2\u003e\n\n\u003cp\u003e1- User use reset feature to get reset link [Email : \u003ca title=\"abc@x.com\" href=\"mailto:abc@x.com\" rel=\"nofollow noopener noreferrer\"\u003eabc@x.com\u003c/a\u003e]\u003cbr\u003e\n2- User came to know about his old password so remain the link unused and the token not expires \u003cbr\u003e\n3- Now User changes his email from control panel [New email : \u003ca title=\"abcd@z.com\" href=\"mailto:abcd@z.com\" rel=\"nofollow noopener noreferrer\"\u003eabcd@z.com\u003c/a\u003e]\u003cbr\u003e\n4- But the old reset still remains valid after email change\u003c/p\u003e\n\n\u003cp\u003eIn-case an attacker able to get access to user\u0026#39;s old email account he can hack his Nextcloud account too via that link, so expiring the token at email change will be a better practice\u003c/p\u003e\n","weakness":{"id":27,"name":"Improper Authentication - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2016-12-13T16:12:00.516Z","allow_singular_disclosure_after":-127570719.96674964,"singular_disclosure_allowed":true,"vote_count":4,"voters":["realtess","spetr0x","royal_coder","sonisahil665"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1023504,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks a lot for reporting this potential issue back to us!\n\nOur security team will take a look at this issue as soon as possible. We will reply to your report within 72 hours, usually much faster. For obvious reasons we'd like to ask you to not disclose this issue to any other party.","markdown_message":"\u003cp\u003eThanks a lot for reporting this potential issue back to us!\u003c/p\u003e\n\n\u003cp\u003eOur security team will take a look at this issue as soon as possible. We will reply to your report within 72 hours, usually much faster. For obvious reasons we\u0026#39;d like to ask you to not disclose this issue to any other party.\u003c/p\u003e\n","automated_response":true,"created_at":"2016-06-19T17:40:12.279Z","updated_at":"2016-06-19T17:40:12.279Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Nextcloud"}},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1023521,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thanks a lot for your report. While reset tokens do expire after 12 hours, this seems in fact like a sensible security hardening.","markdown_message":"\u003cp\u003eThanks a lot for your report. While reset tokens do expire after 12 hours, this seems in fact like a sensible security hardening.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-06-19T17:54:39.581Z","updated_at":"2016-06-19T17:54:39.581Z","actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1023531,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for quick reply! cheers u guys working on weekends too :D ","markdown_message":"\u003cp\u003eThanks for quick reply! cheers u guys working on weekends too :D \u003c/p\u003e\n","automated_response":false,"created_at":"2016-06-19T18:03:09.372Z","updated_at":"2016-06-19T18:03:09.372Z","actor":{"username":"rootxflood","cleared":false,"url":"/rootxflood","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1028322,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@lukasreschke whatsup ? any update ? ","markdown_message":"\u003cp\u003e\u003ca href=\"/lukasreschke\"\u003e@lukasreschke\u003c/a\u003e whatsup ? any update ? \u003c/p\u003e\n","automated_response":false,"created_at":"2016-06-22T14:18:09.022Z","updated_at":"2016-06-22T14:18:09.022Z","actor":{"username":"rootxflood","cleared":false,"url":"/rootxflood","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1030300,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello ? My friend got rewarded even after he reported after me :/ ","markdown_message":"\u003cp\u003eHello ? My friend got rewarded even after he reported after me :/ \u003c/p\u003e\n","automated_response":false,"created_at":"2016-06-23T15:39:59.146Z","updated_at":"2016-06-23T15:39:59.146Z","actor":{"username":"rootxflood","cleared":false,"url":"/rootxflood","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1030303,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Please stay tuned. This is on the roadmap to be fixed within the very near future. With regard to any potential bounty this has not yet been decided on this report.\n\nI'll keep you in the loop and let you know as soon as the bounty panel has decided.","markdown_message":"\u003cp\u003ePlease stay tuned. This is on the roadmap to be fixed within the very near future. With regard to any potential bounty this has not yet been decided on this report.\u003c/p\u003e\n\n\u003cp\u003eI\u0026#39;ll keep you in the loop and let you know as soon as the bounty panel has decided.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-06-23T15:45:19.836Z","updated_at":"2016-06-23T15:45:19.836Z","actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1040602,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I can see that 9.0.51 is released  so any update","markdown_message":"\u003cp\u003eI can see that 9.0.51 is released  so any update\u003c/p\u003e\n","automated_response":false,"created_at":"2016-06-27T13:00:25.667Z","updated_at":"2016-06-27T13:00:25.667Z","actor":{"username":"rootxflood","cleared":false,"url":"/rootxflood","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1041579,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"9.0.51 does not contain any changes with regard to this, this requires some bigger changes. Thanks a lot for your continued patience.","markdown_message":"\u003cp\u003e9.0.51 does not contain any changes with regard to this, this requires some bigger changes. Thanks a lot for your continued patience.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-06-27T20:15:31.723Z","updated_at":"2016-06-27T20:15:31.723Z","actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1062639,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Any update ? ","markdown_message":"\u003cp\u003eAny update ? \u003c/p\u003e\n","automated_response":false,"created_at":"2016-07-11T12:09:55.163Z","updated_at":"2016-07-11T12:09:55.163Z","actor":{"username":"rootxflood","cleared":false,"url":"/rootxflood","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1064779,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Not yet.","markdown_message":"\u003cp\u003eNot yet.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-07-12T10:32:40.108Z","updated_at":"2016-07-12T10:32:40.108Z","actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1101426,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@lukasreschke  Its 2nd of august :p ","markdown_message":"\u003cp\u003e\u003ca href=\"/lukasreschke\"\u003e@lukasreschke\u003c/a\u003e  Its 2nd of august :p \u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-02T04:17:54.161Z","updated_at":"2016-08-02T04:17:54.161Z","actor":{"username":"rootxflood","cleared":false,"url":"/rootxflood","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1127654,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@lukasreschke  isn't it taking a long ? ","markdown_message":"\u003cp\u003e\u003ca href=\"/lukasreschke\"\u003e@lukasreschke\u003c/a\u003e  isn\u0026#39;t it taking a long ? \u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-15T19:09:13.960Z","updated_at":"2016-08-15T19:09:13.960Z","actor":{"username":"rootxflood","cleared":false,"url":"/rootxflood","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1155225,"is_internal":false,"editable":false,"type":"Activities::HackerRequestedMediation","message":"It's been months on the triage state and company have not been even replying to my comments over it.\nPlease review it.","markdown_message":"\u003cp\u003eIt\u0026#39;s been months on the triage state and company have not been even replying to my comments over it.\u003cbr\u003e\nPlease review it.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-26T06:23:24.375Z","updated_at":"2016-08-26T06:23:24.375Z","actor":{"username":"rootxflood","cleared":false,"url":"/rootxflood","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1155233,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@rootxflood Repeatedly asking for updates won't make it go faster. Please refrain from doing so. This has been added to the roadmap as hardening and we'll take care of it.","markdown_message":"\u003cp\u003e\u003ca href=\"/rootxflood\"\u003e@rootxflood\u003c/a\u003e Repeatedly asking for updates won\u0026#39;t make it go faster. Please refrain from doing so. This has been added to the roadmap as hardening and we\u0026#39;ll take care of it.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-26T06:33:40.134Z","updated_at":"2016-08-26T06:33:40.134Z","actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1161719,"is_internal":false,"editable":false,"type":"Activities::ExternalUserJoined","message":"","markdown_message":"","automated_response":false,"created_at":"2016-08-30T07:36:57.387Z","updated_at":"2016-08-30T07:36:57.387Z","additional_data":{"duplicate_report_id":164359},"actor":{"username":"vulnh0lic","cleared":true,"url":"/vulnh0lic","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/V8AtqfzpPRN15h1YzEnoBJpf/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1257368,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Its been like months now. Please update it.","markdown_message":"\u003cp\u003eIts been like months now. Please update it.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-10-20T08:37:20.173Z","updated_at":"2016-10-20T08:37:20.173Z","actor":{"username":"rootxflood","cleared":false,"url":"/rootxflood","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1297062,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks a lot for your report again. This will be resolved in our next major release.\n\nWe do consider this rather a security hardening instead of a security vulnerability but will be happy to mark this as Resolved so that you get some HackerOne points for this.\n\nThis has been added at https://github.com/nextcloud/server/pull/1109 and will be included in our next major release Nextcloud 11. Apologize for our delays on adding this.","markdown_message":"\u003cp\u003eThanks a lot for your report again. This will be resolved in our next major release.\u003c/p\u003e\n\n\u003cp\u003eWe do consider this rather a security hardening instead of a security vulnerability but will be happy to mark this as Resolved so that you get some HackerOne points for this.\u003c/p\u003e\n\n\u003cp\u003eThis has been added at \u003ca title=\"https://github.com/nextcloud/server/pull/1109\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fnextcloud%2Fserver%2Fpull%2F1109\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/nextcloud/server/pull/1109\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e and will be included in our next major release Nextcloud 11. Apologize for our delays on adding this.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-11-13T16:11:32.889Z","updated_at":"2016-11-13T16:12:10.053Z","actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"rootxflood","url":"/rootxflood"},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1297063,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"As we consider that rather a hardening we have decided not to award any monetary reward on that.","markdown_message":"\u003cp\u003eAs we consider that rather a hardening we have decided not to award any monetary reward on that.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-11-13T16:11:56.128Z","updated_at":"2016-11-13T16:11:56.128Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Nextcloud"}},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1297064,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-11-13T16:12:00.488Z","updated_at":"2016-11-13T16:12:00.488Z","first_to_agree":true,"actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1361810,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-12-13T16:12:16.488Z","updated_at":"2016-12-13T16:12:16.488Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Nextcloud"}},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}