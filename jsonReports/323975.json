{"id":323975,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zMjM5NzU=","url":"https://hackerone.com/reports/323975","title":"CSRF in Inviting users","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2018-03-09T19:33:21.827Z","submitted_at":"2018-03-09T19:33:21.827Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"rijalrojan","url":"/rijalrojan","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/fBoPSSRSdMDTghBJexdu4AwG/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":25188,"url":"https://hackerone.com/pingidentity","handle":"pingidentity","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/025/188/95e54845d1cd7b8af42716695136b86fd11d0cf1_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/025/188/95e54845d1cd7b8af42716695136b86fd11d0cf1_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Ping Identity","twitter_handle":"pingidentity","website":"https://www.pingidentity.com/","about":""}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2019-03-26T20:41:09.075Z","bug_reporter_agreed_on_going_public_at":"2019-03-26T20:35:57.285Z","team_member_agreed_on_going_public_at":"2019-03-26T20:41:08.918Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"\u003e NOTE! Thanks for submitting a report! Please replace *all* the [square] sections below with the pertinent details. Remember, the more detail you provide, the easier it is for us to triage and respond quickly, so be sure to take your time filling out the report!\n\n**Summary:** [add summary of the vulnerability]\nWhen a user is invited, a GET request is made. This can be used with a CSRF attack. \n\n**Description:** [add more details about this vulnerability]\nUser invitations usually should be done through a POST request. In this case the app uses a GET request. For example: https://ort-admin.pingone.com/web-portal/ajax/user/directory/inviteuser/?alternate_email=rojan@netsecurity.tech\u0026email=rojan@securifyinc.com\nWhich allows inviting another user easily. \n\n## Steps To Reproduce:\n\n(Add details for how we can reproduce the issue)\n\n  1. Download the attached html. \n  2. Open it in a logged in browser. \n  3. It should invite my email to the website. \n## Supporting Material/References:\n\n  * List any additional material (e.g. screenshots, logs, etc.)\n\n## Impact\n\nAdding other users easily. Gives internal access.\n\nThe hacker selected the **Cross-Site Request Forgery (CSRF)** weakness. This vulnerability type requires contextual information from the hacker. They provided the following answers:\n\n**URL**\nhttps://ort-admin.pingone.com/web-portal/usermanagement#/\n\n**Verified**\nYes\n\n**Can a victim be forced to perform a sensitive state-change operation unknowningly?**\nYes\n\n**What state-change operation can be performed?**\nAdding users.","vulnerability_information_html":"\u003cblockquote\u003e\n\u003cp\u003eNOTE! Thanks for submitting a report! Please replace \u003cem\u003eall\u003c/em\u003e the [square] sections below with the pertinent details. Remember, the more detail you provide, the easier it is for us to triage and respond quickly, so be sure to take your time filling out the report!\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003e\u003cstrong\u003eSummary:\u003c/strong\u003e [add summary of the vulnerability]\u003cbr\u003e\nWhen a user is invited, a GET request is made. This can be used with a CSRF attack. \u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eDescription:\u003c/strong\u003e [add more details about this vulnerability]\u003cbr\u003e\nUser invitations usually should be done through a POST request. In this case the app uses a GET request. For example: \u003ca title=\"https://ort-admin.pingone.com/web-portal/ajax/user/directory/inviteuser/?alternate_email=rojan@netsecurity.tech\u0026amp;email=rojan@securifyinc.com\" href=\"/redirect?url=https%3A%2F%2Fort-admin.pingone.com%2Fweb-portal%2Fajax%2Fuser%2Fdirectory%2Finviteuser%2F%3Falternate_email%3Drojan%40netsecurity.tech%26email%3Drojan%40securifyinc.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://ort-admin.pingone.com/web-portal/ajax/user/directory/inviteuser/?alternate_email=rojan@netsecurity.tech\u0026amp;email=rojan@securifyinc.com\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nWhich allows inviting another user easily. \u003c/p\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps To Reproduce:\u003c/h2\u003e\n\n\u003cp\u003e(Add details for how we can reproduce the issue)\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eDownload the attached html. \u003c/li\u003e\n\u003cli\u003eOpen it in a logged in browser. \u003c/li\u003e\n\u003cli\u003eIt should invite my email to the website. \n## Supporting Material/References:\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cul\u003e\n\u003cli\u003eList any additional material (e.g. screenshots, logs, etc.)\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eAdding other users easily. Gives internal access.\u003c/p\u003e\n\n\u003cp\u003eThe hacker selected the \u003cstrong\u003eCross-Site Request Forgery (CSRF)\u003c/strong\u003e weakness. This vulnerability type requires contextual information from the hacker. They provided the following answers:\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eURL\u003c/strong\u003e\u003cbr\u003e\n\u003ca title=\"https://ort-admin.pingone.com/web-portal/usermanagement#/\" href=\"/redirect?url=https%3A%2F%2Fort-admin.pingone.com%2Fweb-portal%2Fusermanagement%23%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://ort-admin.pingone.com/web-portal/usermanagement#/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eVerified\u003c/strong\u003e\u003cbr\u003e\nYes\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eCan a victim be forced to perform a sensitive state-change operation unknowningly?\u003c/strong\u003e\u003cbr\u003e\nYes\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eWhat state-change operation can be performed?\u003c/strong\u003e\u003cbr\u003e\nAdding users.\u003c/p\u003e\n","bounty_amount":"1250.0","formatted_bounty":"$1,250","weakness":{"id":45,"name":"Cross-Site Request Forgery (CSRF)"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":271054,"file_name":"csrf.html","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/271/054/539d4f01759dfb55bcfaefabced1858992f0285d/csrf.html?response-content-disposition=attachment%3B%20filename%3D%22csrf.html%22%3B%20filename%2A%3DUTF-8%27%27csrf.html\u0026response-content-type=text%2Fplain\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQWS7SVX5C%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T053520Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCICTltBX5kZS78yzw3IUUt%2Fa035OzgQ2vLu8U1ZxOKGilAiEAqT8jxmclsgLwaEL5fi7C70iqLwP7J3SWF5ypfn%2Fn%2BdUqtAMIVBABGgwwMTM2MTkyNzQ4NDkiDGRWkSc4Hmgq8mMXKCqRA0Pq%2Bzgh6dptjyRB4GzYO9sir45RVm0RyvFSB8lDBYTBiDIVL0nR3Ah5epkHqGDZZEh0G%2BfKYu%2FWpfgxJl7qllLzKg%2BOA0izVs9KPgQdxk0VWwW%2FPKL2ZT4v%2FSNRvF7rPUbZ7WhGTZqx0%2BinzKM%2BO6lDyXZKNKMzhjRnIFdI7Th01c4ma39imTXQDmxc%2FNzHFK40lrkAbTZoTlcq%2BsnIcIRSB0h4GHasXhR5OHx8rifULR7sVKHDcZMCzSYjrtagaKs9I81LEzlSbEGxIQar2MK%2BZBwmpT57aT%2F1nIOoa%2FlH5nfP4Ihcv4Mqfp19pFx8mlVoMe%2FTEx0pqNuC4lGQXowSDJKBcSjrYM6ouddZWfwY6R4O8X69XqZawGSrmBiXyAVG%2BDj895xbDJhiOXMvqkvSfsEzIfvcaHAzshzNZjFT3yiN4h81wfUF3QuLc6DHCTt1MPDYiUB8I7UCQ8wJxW4pg3xTnHqSwUeqww3YY8RFfsgvfp9PzGJ1s4vReFrzuzYVanpT22oz4w33z29yMPmMMO21qv8FOusBOsYr4rmEPt9wYTc2WNI63vM9u2VUhGNHafH2%2Fh3q6i%2BwJ0u2HLCQd44aqHfWZ%2Bc8hzInEQnRNrZf7owYuE4cHiraWaOsNJjfOEJBZu5nzzun4JSk7801NfOqa1zcgLMWOwyWJCtalb9fGn6qhwTWTBMzsOFHc661yyW%2FaqejCIRf6%2BwNOGhO8kc%2BEhEIq0iydp5k4rlMRKlFJPFlphrQYGeZgYr9TM%2FVgHlN%2Bx4Oxtcg1UwCGXMGiV%2BqXzeMEmO%2FdxKETdJJvF%2BEaJSsF0r1i7s8g61czrgyi9MKMpia%2Fg6ovVFkrvHOejV96g%3D%3D\u0026X-Amz-Signature=b593ca30bc86ddfa176450644ce23ff039b151e7ecd5772e2021ccb8b268b2bd","file_size":162,"type":"text/plain"}],"allow_singular_disclosure_at":"2019-04-25T20:35:57.367Z","allow_singular_disclosure_after":-52995562.968988694,"singular_disclosure_allowed":true,"vote_count":4,"voters":["mashoud1122","0-1","aksl337","exception"],"severity":{"rating":"high","author_type":"Team"},"structured_scope":{"databaseId":6162,"asset_type":"URL","asset_identifier":"https://ort-admin.pingone.com/*","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":2479875,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @uranium238,\n\nThanks for the report. We'll be looking into it and get back to you shortly.\n\nRegards,\n@bagofchips","markdown_message":"\u003cp\u003eHey \u003ca href=\"/uranium238\"\u003e@uranium238\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThanks for the report. We\u0026#39;ll be looking into it and get back to you shortly.\u003c/p\u003e\n\n\u003cp\u003eRegards,\u003cbr\u003e\n\u003ca href=\"/bagofchips\"\u003e@bagofchips\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2018-03-10T19:34:04.486Z","updated_at":"2018-03-10T19:34:04.486Z","actor":{"username":"bagofchips","cleared":false,"url":"/bagofchips","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/218/557/6f0d25b588bc8483b7161b46181ee9d14d62b1db_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"pingidentity","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2479883,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"We were able to validate your report, and we have submitted it to the appropriate remediation team for review. They will let us know the final ruling on this report, and if/when a fix will be implemented. We will follow-up after the remediation team has assessed the impact of this report. Please note that the status and severity are subject to change.","markdown_message":"\u003cp\u003eWe were able to validate your report, and we have submitted it to the appropriate remediation team for review. They will let us know the final ruling on this report, and if/when a fix will be implemented. We will follow-up after the remediation team has assessed the impact of this report. Please note that the status and severity are subject to change.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-03-10T19:37:53.447Z","updated_at":"2018-03-10T19:37:53.447Z","actor":{"username":"bagofchips","cleared":false,"url":"/bagofchips","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/218/557/6f0d25b588bc8483b7161b46181ee9d14d62b1db_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"pingidentity","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2480099,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Sounds good. Thanks @bagofchips \n","markdown_message":"\u003cp\u003eSounds good. Thanks \u003ca href=\"/bagofchips\"\u003e@bagofchips\u003c/a\u003e \u003c/p\u003e\n","automated_response":false,"created_at":"2018-03-10T21:53:45.626Z","updated_at":"2018-03-10T21:53:45.626Z","actor":{"username":"rijalrojan","cleared":true,"url":"/rijalrojan","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fBoPSSRSdMDTghBJexdu4AwG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"pingidentity","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2484250,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"By the way, I forgot to give reasoning on why it was marked Critical:\n\nWhen a user is added, they can use the SSO platform to easily login to any internal application of a company. This can be exploited easily and has a major impact on company's integrity so the CVSS reflects that.","markdown_message":"\u003cp\u003eBy the way, I forgot to give reasoning on why it was marked Critical:\u003c/p\u003e\n\n\u003cp\u003eWhen a user is added, they can use the SSO platform to easily login to any internal application of a company. This can be exploited easily and has a major impact on company\u0026#39;s integrity so the CVSS reflects that.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-03-12T16:34:33.978Z","updated_at":"2018-03-12T16:34:33.978Z","actor":{"username":"rijalrojan","cleared":true,"url":"/rijalrojan","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fBoPSSRSdMDTghBJexdu4AwG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"pingidentity","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2511957,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2018-03-20T21:11:24.394Z","updated_at":"2018-03-20T21:11:24.394Z","additional_data":{"old_severity":"Critical (9.7)","new_severity":"Critical (9.7)","old_severity_id":126971,"new_severity_id":130642},"actor":{"username":"glassofbeer","cleared":false,"url":"/glassofbeer","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/166/997/bf60ed9bb749786ae3f68f25703bf0528699cda7_original.JPG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"pingidentity","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2515889,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2018-03-21T20:54:35.724Z","updated_at":"2018-03-21T20:54:35.724Z","actor":{"url":"/pingidentity","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/025/188/95e54845d1cd7b8af42716695136b86fd11d0cf1_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Ping Identity"}},"bounty_amount":"1250.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"pingidentity","collaborator":{"username":"rijalrojan","url":"/rijalrojan"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2763883,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2018-05-18T19:42:02.799Z","updated_at":"2018-05-18T19:42:02.799Z","additional_data":{"old_severity":"Critical (9.7)","new_severity":"High","old_severity_id":130642,"new_severity_id":156086},"actor":{"username":"joaquinh1","cleared":false,"url":"/joaquinh1","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/188/197/274b02be7185c009932f1a8035f3dc8c8ad9349b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"pingidentity","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3349914,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2018-09-17T17:08:24.414Z","updated_at":"2018-09-17T17:08:24.414Z","actor":{"username":"richardcardona","cleared":false,"url":"/richardcardona","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"rijalrojan","url":"/rijalrojan"},"genius_execution_id":null,"team_handle":"pingidentity","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4395986,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-03-26T20:35:57.315Z","updated_at":"2019-03-26T20:35:57.315Z","first_to_agree":true,"actor":{"username":"rijalrojan","cleared":true,"url":"/rijalrojan","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fBoPSSRSdMDTghBJexdu4AwG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"pingidentity","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4396008,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-03-26T20:41:08.961Z","updated_at":"2019-03-26T20:41:08.961Z","actor":{"username":"joaquinh1","cleared":false,"url":"/joaquinh1","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/188/197/274b02be7185c009932f1a8035f3dc8c8ad9349b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"pingidentity","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4396009,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-03-26T20:41:09.099Z","updated_at":"2019-03-26T20:41:09.099Z","actor":{"username":"joaquinh1","cleared":false,"url":"/joaquinh1","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/188/197/274b02be7185c009932f1a8035f3dc8c8ad9349b_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"pingidentity","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}