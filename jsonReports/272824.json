{"id":272824,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yNzI4MjQ=","url":"https://hackerone.com/reports/272824","title":"client_secret Token disclosure ","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2017-09-28T20:16:49.764Z","submitted_at":"2017-09-28T20:16:49.764Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"yumi","url":"/yumi","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/ohxMGGTWoaQLuq1edUFYw94u/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":9520,"url":"https://hackerone.com/aspen","handle":"aspen","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/009/520/f7b32b7e3ac40975de7a2e718dcecb2c59c229cd_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/009/520/f7b32b7e3ac40975de7a2e718dcecb2c59c229cd_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Aspen","twitter_handle":"aspen_io","website":"http://aspen.io/","about":"A python web framework based on filesystem dispatch and simplates."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-09-28T21:07:49.028Z","bug_reporter_agreed_on_going_public_at":"2017-09-28T21:07:48.950Z","team_member_agreed_on_going_public_at":"2017-09-28T21:06:52.196Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Greetings, \n\nI think I've discovered a ```client_secret``` token disclosure. \n\n**_Proof of concept:_**\n\n**1.** Go to https://github.com/AspenWeb/experimental-javascript-version/blob/master/www/blog/index.html\n\n\n**2.** At the line 6, a client_secret token it's disclosed. \n\n```\nrequest('https://api.github.com/repos/zetaweb/aspen/issues?client_id=f58e3c865648d1eae132\u0026client_secret=b1e49a627a30e3d41568ecaf976436f4bfbbefba', function (error, response, body) {\n```\n\nThanks for your attention and let me know if you need anything. \nRegards, Yumi","vulnerability_information_html":"\u003cp\u003eGreetings, \u003c/p\u003e\n\n\u003cp\u003eI think I\u0026#39;ve discovered a \u003ccode\u003eclient_secret\u003c/code\u003e token disclosure. \u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003e\u003cu\u003eProof of concept:\u003c/u\u003e\u003c/strong\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003e1.\u003c/strong\u003e Go to \u003ca title=\"https://github.com/AspenWeb/experimental-javascript-version/blob/master/www/blog/index.html\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2FAspenWeb%2Fexperimental-javascript-version%2Fblob%2Fmaster%2Fwww%2Fblog%2Findex.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/AspenWeb/experimental-javascript-version/blob/master/www/blog/index.html\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003e2.\u003c/strong\u003e At the line 6, a client_secret token it\u0026#39;s disclosed. \u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003erequest(\u0026#39;https://api.github.com/repos/zetaweb/aspen/issues?client_id=f58e3c865648d1eae132\u0026amp;client_secret=b1e49a627a30e3d41568ecaf976436f4bfbbefba\u0026#39;, function (error, response, body) {\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThanks for your attention and let me know if you need anything. \u003cbr\u003e\nRegards, Yumi\u003c/p\u003e\n","original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2017-10-28T21:06:52.234Z","allow_singular_disclosure_after":-99994373.09611417,"singular_disclosure_allowed":true,"vote_count":12,"voters":["sp1d3rs","jensec","edoverflow","eveeez","r3y","luckydivino","mr_r3boot","m7mdharoun","japz","sumit7","and 2 more..."],"structured_scope":{"databaseId":1921,"asset_type":"SOURCE_CODE","asset_identifier":"https://github.com/AspenWeb","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":2031264,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hi @yumi,\n\nThank you for the report. I have triggered incident response in order to properly investigate the impact of this issue.","markdown_message":"\u003cp\u003eHi \u003ca href=\"/yumi\"\u003e@yumi\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThank you for the report. I have triggered incident response in order to properly investigate the impact of this issue.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-09-28T20:24:55.376Z","updated_at":"2017-09-28T20:24:55.376Z","actor":{"username":"edoverflow","cleared":true,"url":"/edoverflow","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/116/374/9a3cf4d62b2f507a0d33808aacbad863ec4455ac_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"aspen","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2031349,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"The investigation determined that: \n- This `client_secret` is no longer valid.\n- No developer accounts had the OAuth app enabled on their account (https://github.com/settings/developers).\n- No further `client_secret` tokens were found in older commits.\n\nThe following precautionary steps could be taken in order to prevent a similar incident in future:\n- Store `client_secret` tokens as environment variables.\n- [Require GPG signing of commits](https://github.com/gratipay/inside.gratipay.com/issues/971).\n- Run tools such as [truffleHog](https://github.com/dxa4481/truffleHog) on a regular basis.\n- Restrict AspenWeb and Gratipay's organization access.\n\nThank you very much for bringing this to our attention, @yumi. We look forward to working with you again in future.","markdown_message":"\u003cp\u003eThe investigation determined that: \u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eThis \u003ccode\u003eclient_secret\u003c/code\u003e is no longer valid.\u003c/li\u003e\n\u003cli\u003eNo developer accounts had the OAuth app enabled on their account (\u003ca title=\"https://github.com/settings/developers\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fsettings%2Fdevelopers\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/settings/developers\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e).\u003c/li\u003e\n\u003cli\u003eNo further \u003ccode\u003eclient_secret\u003c/code\u003e tokens were found in older commits.\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eThe following precautionary steps could be taken in order to prevent a similar incident in future:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eStore \u003ccode\u003eclient_secret\u003c/code\u003e tokens as environment variables.\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fgratipay%2Finside.gratipay.com%2Fissues%2F971\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eRequire GPG signing of commits\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e.\u003c/li\u003e\n\u003cli\u003eRun tools such as \u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fdxa4481%2FtruffleHog\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003etruffleHog\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e on a regular basis.\u003c/li\u003e\n\u003cli\u003eRestrict AspenWeb and Gratipay\u0026#39;s organization access.\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eThank you very much for bringing this to our attention, \u003ca href=\"/yumi\"\u003e@yumi\u003c/a\u003e. We look forward to working with you again in future.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-09-28T21:05:43.960Z","updated_at":"2017-09-28T21:05:43.960Z","actor":{"username":"edoverflow","cleared":true,"url":"/edoverflow","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/116/374/9a3cf4d62b2f507a0d33808aacbad863ec4455ac_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"yumi","url":"/yumi"},"genius_execution_id":null,"team_handle":"aspen","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2031352,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-09-28T21:06:52.211Z","updated_at":"2017-09-28T21:06:52.211Z","first_to_agree":true,"actor":{"username":"edoverflow","cleared":true,"url":"/edoverflow","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/116/374/9a3cf4d62b2f507a0d33808aacbad863ec4455ac_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"aspen","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2031355,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-09-28T21:07:48.979Z","updated_at":"2017-09-28T21:07:48.979Z","actor":{"username":"yumi","cleared":false,"url":"/yumi","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ohxMGGTWoaQLuq1edUFYw94u/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"aspen","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2031356,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-09-28T21:07:49.049Z","updated_at":"2017-09-28T21:07:49.049Z","actor":{"username":"yumi","cleared":false,"url":"/yumi","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/ohxMGGTWoaQLuq1edUFYw94u/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"aspen","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}