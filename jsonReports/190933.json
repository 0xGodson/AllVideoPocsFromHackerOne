{"id":190933,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xOTA5MzM=","url":"https://hackerone.com/reports/190933","title":"Invalid parameter in memcpy function trough openssl_pbkdf2","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2016-12-13T20:43:44.109Z","submitted_at":"2016-12-13T20:43:44.109Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"emyei","url":"/emyei","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":29,"url":"https://hackerone.com/ibb-php","handle":"ibb-php","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/029/99087dbbdf52fc3ce3acbf16aa33a5c4f5e2c111_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/029/99087dbbdf52fc3ce3acbf16aa33a5c4f5e2c111_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"paused","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"PHP (IBB)","twitter_handle":"","website":"http://www.php.net","about":""}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-02-08T17:01:52.502Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2017-02-08T17:01:38.283Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Upstream: https://bugs.php.net/bug.php?id=72776\n\nSummary:\n------------\nWhen key_length parameter is greater than 0x7fffffff, size parameter is interpreted as negative in memcpy, inside PKCS5_PBKDF2_HMAC function (libcrypto.so).\n\nThis issue happens only in PHP 5.6 branch. PHP 7.0 avoids this issue trough PHP_OPENSSL_CHECK_NUMBER_CONVERSION macro: https://github.com/php/php-src/blob/PHP-7.0.10/ext/openssl/openssl.c#L541\n\n==11421==ERROR: AddressSanitizer: negative-size-param: (size=-1)\n    #0 0x7f919d1029a1 in __asan_memcpy (/usr/lib/x86_64-linux-gnu/libasan.so.2+0x8c9a1)\n    #1 0x7f919b2c87e9 in PKCS5_PBKDF2_HMAC (/lib/x86_64-linux-gnu/libcrypto.so.1.0.0+0x1317e9)\n    #2 0x5be33e in zif_openssl_pbkdf2 /home/operac/build2/php-src-56/ext/openssl/openssl.c:4080\n    #3 0x1d5b393 in zend_do_fcall_common_helper_SPEC /home/operac/build2/php-src-56/Zend/zend_vm_execute.h:558\n    #4 0x1c0463c in execute_ex /home/operac/build2/php-src-56/Zend/zend_vm_execute.h:363\n    #5 0x194c382 in zend_execute_scripts /home/operac/build2/php-src-56/Zend/zend.c:1341\n    #6 0x169a2df in php_execute_script /home/operac/build2/php-src-56/main/main.c:2613\n    #7 0x1d64366 in do_cli /home/operac/build2/php-src-56/sapi/cli/php_cli.c:994\n    #8 0x4550a0 in main /home/operac/build2/php-src-56/sapi/cli/php_cli.c:1378\n    #9 0x7f919ab4482f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2082f)\n    #10 0x4556b8 in _start (/home/operac/build2/bin/php+0x4556b8)\n\nAddress 0x7ffd544616b0 is located in stack of thread T0\nSUMMARY: AddressSanitizer: negative-size-param ??:0 __asan_memcpy\n==11421==ABORTING\n\n\nPatch:  https://github.com/php/php-src/commit/493b2bff02531b0ead233177a2a0846c75e94777\n\n\nFixed for PHP 5.6.29","vulnerability_information_html":"\u003cp\u003eUpstream: \u003ca title=\"https://bugs.php.net/bug.php?id=72776\" href=\"/redirect?url=https%3A%2F%2Fbugs.php.net%2Fbug.php%3Fid%3D72776\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://bugs.php.net/bug.php?id=72776\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2 id=\"summary\"\u003eSummary:\u003c/h2\u003e\n\n\u003cp\u003eWhen key_length parameter is greater than 0x7fffffff, size parameter is interpreted as negative in memcpy, inside PKCS5_PBKDF2_HMAC function (libcrypto.so).\u003c/p\u003e\n\n\u003cp\u003eThis issue happens only in PHP 5.6 branch. PHP 7.0 avoids this issue trough PHP_OPENSSL_CHECK_NUMBER_CONVERSION macro: \u003ca title=\"https://github.com/php/php-src/blob/PHP-7.0.10/ext/openssl/openssl.c#L541\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fphp%2Fphp-src%2Fblob%2FPHP-7.0.10%2Fext%2Fopenssl%2Fopenssl.c%23L541\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/php/php-src/blob/PHP-7.0.10/ext/openssl/openssl.c#L541\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003cmark\u003e11421\u003c/mark\u003eERROR: AddressSanitizer: negative-size-param: (size=-1)\u003cbr\u003e\n    #0 0x7f919d1029a1 in __asan_memcpy (/usr/lib/x86_64-linux-gnu/libasan.so.2+0x8c9a1)\u003cbr\u003e\n    #1 0x7f919b2c87e9 in PKCS5_PBKDF2_HMAC (/lib/x86_64-linux-gnu/libcrypto.so.1.0.0+0x1317e9)\u003cbr\u003e\n    #2 0x5be33e in zif_openssl_pbkdf2 /home/operac/build2/php-src-56/ext/openssl/openssl.c:4080\u003cbr\u003e\n    #3 0x1d5b393 in zend_do_fcall_common_helper_SPEC /home/operac/build2/php-src-56/Zend/zend_vm_execute.h:558\u003cbr\u003e\n    #4 0x1c0463c in execute_ex /home/operac/build2/php-src-56/Zend/zend_vm_execute.h:363\u003cbr\u003e\n    #5 0x194c382 in zend_execute_scripts /home/operac/build2/php-src-56/Zend/zend.c:1341\u003cbr\u003e\n    #6 0x169a2df in php_execute_script /home/operac/build2/php-src-56/main/main.c:2613\u003cbr\u003e\n    #7 0x1d64366 in do_cli /home/operac/build2/php-src-56/sapi/cli/php_cli.c:994\u003cbr\u003e\n    #8 0x4550a0 in main /home/operac/build2/php-src-56/sapi/cli/php_cli.c:1378\u003cbr\u003e\n    #9 0x7f919ab4482f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2082f)\u003cbr\u003e\n    #10 0x4556b8 in _start (/home/operac/build2/bin/php+0x4556b8)\u003c/p\u003e\n\n\u003cp\u003eAddress 0x7ffd544616b0 is located in stack of thread T0\u003cbr\u003e\nSUMMARY: AddressSanitizer: negative-size-param ??:0 __asan_memcpy\u003cbr\u003e\n\u003cmark\u003e11421\u003c/mark\u003eABORTING\u003c/p\u003e\n\n\u003cp\u003ePatch:  \u003ca title=\"https://github.com/php/php-src/commit/493b2bff02531b0ead233177a2a0846c75e94777\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fphp%2Fphp-src%2Fcommit%2F493b2bff02531b0ead233177a2a0846c75e94777\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/php/php-src/commit/493b2bff02531b0ead233177a2a0846c75e94777\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eFixed for PHP 5.6.29\u003c/p\u003e\n","bounty_amount":"500.0","formatted_bounty":"$500","weakness":{"id":2,"name":"Memory Corruption - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2017-03-10T17:01:38.311Z","allow_singular_disclosure_after":-120052050.2864045,"singular_disclosure_allowed":true,"vote_count":4,"voters":["bl4de","icanthack","eveeez","spetr0x"],"severity":{"rating":"low","author_type":"Team"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1467818,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2017-02-07T07:36:08.953Z","updated_at":"2017-02-07T07:36:08.953Z","additional_data":{"old_severity":null,"new_severity":"Low","old_severity_id":null,"new_severity_id":24022},"actor":{"username":"arice","cleared":false,"url":"/arice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/83152cb2d070f3f6a63c1b61bae47257722b5ad2_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"ibb-php","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1467819,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2017-02-07T07:36:15.046Z","updated_at":"2017-02-07T07:36:15.046Z","actor":{"username":"arice","cleared":false,"url":"/arice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/83152cb2d070f3f6a63c1b61bae47257722b5ad2_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"reporter":{"username":"emyei","url":"/emyei"},"genius_execution_id":null,"team_handle":"ibb-php","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1467821,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"","markdown_message":"","automated_response":false,"created_at":"2017-02-07T07:36:27.517Z","updated_at":"2017-02-07T07:36:27.517Z","actor":{"url":"/ibb-php","ibb":true,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/029/99087dbbdf52fc3ce3acbf16aa33a5c4f5e2c111_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"PHP (IBB)"}},"genius_execution_id":null,"team_handle":"ibb-php","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1468609,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello Alex, I submitted this before the IBB PHP program updated the policy regarding low impact security bugs, I think it would be fair to honor the previous one as It has happened already in other programs.\n\n","markdown_message":"\u003cp\u003eHello Alex, I submitted this before the IBB PHP program updated the policy regarding low impact security bugs, I think it would be fair to honor the previous one as It has happened already in other programs.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-02-07T15:33:34.760Z","updated_at":"2017-02-07T15:33:34.760Z","actor":{"username":"emyei","cleared":false,"url":"/emyei","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ibb-php","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1469055,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"That's fair. Thanks for keeping us honest!","markdown_message":"\u003cp\u003eThat\u0026#39;s fair. Thanks for keeping us honest!\u003c/p\u003e\n","automated_response":false,"created_at":"2017-02-07T17:59:01.027Z","updated_at":"2017-02-07T17:59:01.027Z","actor":{"username":"arice","cleared":false,"url":"/arice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/83152cb2d070f3f6a63c1b61bae47257722b5ad2_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"ibb-php","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1469230,"is_internal":false,"editable":false,"type":"Activities::BugReopened","message":"","markdown_message":"","automated_response":false,"created_at":"2017-02-07T18:54:27.777Z","updated_at":"2017-02-07T18:54:27.777Z","actor":{"username":"arice","cleared":false,"url":"/arice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/83152cb2d070f3f6a63c1b61bae47257722b5ad2_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"ibb-php","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1469232,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2017-02-07T18:54:37.028Z","updated_at":"2017-02-07T18:54:37.028Z","actor":{"url":"/ibb-php","ibb":true,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/029/99087dbbdf52fc3ce3acbf16aa33a5c4f5e2c111_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"PHP (IBB)"}},"bounty_amount":"500.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"ibb-php","collaborator":{"username":"emyei","url":"/emyei"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1469233,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2017-02-07T18:54:43.808Z","updated_at":"2017-02-07T18:54:43.808Z","actor":{"username":"arice","cleared":false,"url":"/arice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/83152cb2d070f3f6a63c1b61bae47257722b5ad2_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"reporter":{"username":"emyei","url":"/emyei"},"genius_execution_id":null,"team_handle":"ibb-php","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1471752,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Very thanks arice.","markdown_message":"\u003cp\u003eVery thanks arice.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-02-08T16:45:57.718Z","updated_at":"2017-02-08T16:45:57.718Z","actor":{"username":"emyei","cleared":false,"url":"/emyei","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ibb-php","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1471768,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Do you can disclose (public visibility) this report?","markdown_message":"\u003cp\u003eDo you can disclose (public visibility) this report?\u003c/p\u003e\n","automated_response":false,"created_at":"2017-02-08T16:50:30.154Z","updated_at":"2017-02-08T16:50:30.154Z","actor":{"username":"emyei","cleared":false,"url":"/emyei","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ibb-php","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1471819,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-02-08T17:01:38.296Z","updated_at":"2017-02-08T17:01:38.296Z","first_to_agree":true,"actor":{"username":"arice","cleared":false,"url":"/arice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/83152cb2d070f3f6a63c1b61bae47257722b5ad2_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"ibb-php","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1471822,"is_internal":false,"editable":false,"type":"Activities::ManuallyDisclosed","message":"","markdown_message":"","automated_response":false,"created_at":"2017-02-08T17:01:52.476Z","updated_at":"2017-02-08T17:01:52.476Z","actor":{"username":"arice","cleared":false,"url":"/arice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/83152cb2d070f3f6a63c1b61bae47257722b5ad2_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"ibb-php","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}