{"id":15166,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNTE2Ng==","url":"https://hackerone.com/reports/15166","title":"Password reset token not expiring","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2014-06-05T01:44:26.837Z","submitted_at":"2014-06-05T01:44:26.837Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"siddiki","url":"/siddiki","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/003/502/cf522f55c77430ca80c9ff947d022eb7e3d79350_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":48,"url":"https://hackerone.com/mavenlink","handle":"mavenlink","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/048/f0b795a31dcd39219030322524224cd0b61cc45e_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/048/f0b795a31dcd39219030322524224cd0b61cc45e_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"paused","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Mavenlink","twitter_handle":"","website":"https://www.mavenlink.com","about":"Mavenlink provides sophisticated software and services to help organizations conduct business online, improve productivity, and grow profitably."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2014-07-10T18:23:38.608Z","bug_reporter_agreed_on_going_public_at":"2014-07-09T17:12:09.688Z","team_member_agreed_on_going_public_at":"2014-07-10T18:23:38.463Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"\r\n\r\nOld unused Password reset tokens are not expiring on mail.ru after the issuance of a new token.\r\n**Explaination**\r\nSuppose at 09:00 hrs I used password reset options of mavenlink and got a token on my email.Lets call it token01.But i didnot use it.\r\nAnd at 09:04 hrs I used again the password reset option and got a new token,which is token02.\r\nNow generally after the issuance of token02,the previous unused token should expire.But in case of mavenlink  its not happening.Both the tokens are remaining usable at the same time.\r\n\r\n**Attack Scenario**\r\nSuppose I am an attacker and I got access to the recovery email option of your mavenlink  account.I logged in to ur recovery email (suppose that is user@gmail.com).Then I used the forget password option of your mavenlink  email.I will get one password reset token.\r\nI noted the token and then deleted the email from user@gmail.com.\r\nIn the meantime u understood that someone got access to ur account.They you reset the password of mavenlink  by issuing new token and also u changed the password of ur user@gmail.com so that any one cant hack again ur mavenlink  account.\r\nNow its time for my exploitation.\r\nI will use my token which is live even after your issuance of new token.and I will hack into ur mavenlink  account.\r\n\r\n**Mitigation**\r\n1. Use a certain living span for a token.Suppose,a token will remain valid upto 12 hours after being issued.\r\n2. All unused tokens should expire automatically after the issuance of a new token.","vulnerability_information_html":"\u003cp\u003eOld unused Password reset tokens are not expiring on mail.ru after the issuance of a new token.\u003cbr\u003e\n\u003cstrong\u003eExplaination\u003c/strong\u003e\u003cbr\u003e\nSuppose at 09:00 hrs I used password reset options of mavenlink and got a token on my email.Lets call it token01.But i didnot use it.\u003cbr\u003e\nAnd at 09:04 hrs I used again the password reset option and got a new token,which is token02.\u003cbr\u003e\nNow generally after the issuance of token02,the previous unused token should expire.But in case of mavenlink  its not happening.Both the tokens are remaining usable at the same time.\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eAttack Scenario\u003c/strong\u003e\u003cbr\u003e\nSuppose I am an attacker and I got access to the recovery email option of your mavenlink  account.I logged in to ur recovery email (suppose that is \u003ca title=\"user@gmail.com\" href=\"mailto:user@gmail.com\" rel=\"nofollow noopener noreferrer\"\u003euser@gmail.com\u003c/a\u003e).Then I used the forget password option of your mavenlink  email.I will get one password reset token.\u003cbr\u003e\nI noted the token and then deleted the email from \u003ca title=\"user@gmail.com\" href=\"mailto:user@gmail.com\" rel=\"nofollow noopener noreferrer\"\u003euser@gmail.com\u003c/a\u003e.\u003cbr\u003e\nIn the meantime u understood that someone got access to ur account.They you reset the password of mavenlink  by issuing new token and also u changed the password of ur \u003ca title=\"user@gmail.com\" href=\"mailto:user@gmail.com\" rel=\"nofollow noopener noreferrer\"\u003euser@gmail.com\u003c/a\u003e so that any one cant hack again ur mavenlink  account.\u003cbr\u003e\nNow its time for my exploitation.\u003cbr\u003e\nI will use my token which is live even after your issuance of new token.and I will hack into ur mavenlink  account.\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eMitigation\u003c/strong\u003e\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eUse a certain living span for a token.Suppose,a token will remain valid upto 12 hours after being issued.\u003c/li\u003e\n\u003cli\u003eAll unused tokens should expire automatically after the issuance of a new token.\u003c/li\u003e\n\u003c/ol\u003e\n","bounty_amount":"100.0","formatted_bounty":"$100","weakness":{"id":27,"name":"Improper Authentication - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2014-08-08T17:12:09.834Z","allow_singular_disclosure_after":-201698474.6915494,"singular_disclosure_allowed":true,"vote_count":0,"voters":[],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":68349,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you for contacting us!\nWe are investigating this report and will be back to you soon.","markdown_message":"\u003cp\u003eThank you for contacting us!\u003cbr\u003e\nWe are investigating this report and will be back to you soon.\u003c/p\u003e\n","automated_response":false,"created_at":"2014-06-06T21:59:14.051Z","updated_at":"2014-06-06T21:59:14.051Z","actor":{"username":"michels","cleared":false,"url":"/michels","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mavenlink","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":70359,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2014-06-09T17:47:12.484Z","updated_at":"2014-06-09T17:47:12.484Z","actor":{"username":"michels","cleared":false,"url":"/michels","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mavenlink","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":73802,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Do you have any update ?","markdown_message":"\u003cp\u003eDo you have any update ?\u003c/p\u003e\n","automated_response":false,"created_at":"2014-06-16T11:38:17.393Z","updated_at":"2014-06-16T11:38:17.393Z","actor":{"username":"siddiki","cleared":true,"url":"/siddiki","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/502/cf522f55c77430ca80c9ff947d022eb7e3d79350_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mavenlink","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":75002,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"Our password reset tokens expire after 48 hours.","markdown_message":"\u003cp\u003eOur password reset tokens expire after 48 hours.\u003c/p\u003e\n","automated_response":false,"created_at":"2014-06-17T23:14:13.498Z","updated_at":"2014-06-17T23:14:13.498Z","actor":{"username":"tectonic","cleared":false,"url":"/tectonic","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/980/26aa4e12a7ad70832a0893b4b263cd1abd9267c2_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mavenlink","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":75003,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you very much for your report!","markdown_message":"\u003cp\u003eThank you very much for your report!\u003c/p\u003e\n","automated_response":false,"created_at":"2014-06-17T23:14:22.630Z","updated_at":"2014-06-17T23:14:22.630Z","actor":{"username":"tectonic","cleared":false,"url":"/tectonic","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/980/26aa4e12a7ad70832a0893b4b263cd1abd9267c2_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mavenlink","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":75046,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Did You even Read the report?\nI said,If two password reset token is issued,the old one should be destroyed after the issuance of new one.But in the case of mavenlink both are staying live.I demonstrated an attack scenario on this behavior.\n","markdown_message":"\u003cp\u003eDid You even Read the report?\u003cbr\u003e\nI said,If two password reset token is issued,the old one should be destroyed after the issuance of new one.But in the case of mavenlink both are staying live.I demonstrated an attack scenario on this behavior.\u003c/p\u003e\n","automated_response":false,"created_at":"2014-06-18T03:16:04.730Z","updated_at":"2014-06-18T03:20:39.407Z","actor":{"username":"siddiki","cleared":true,"url":"/siddiki","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/502/cf522f55c77430ca80c9ff947d022eb7e3d79350_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mavenlink","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":75048,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2014-06-18T03:20:45.847Z","updated_at":"2014-06-18T03:20:45.847Z","first_to_agree":true,"actor":{"username":"siddiki","cleared":true,"url":"/siddiki","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/502/cf522f55c77430ca80c9ff947d022eb7e3d79350_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mavenlink","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":85433,"is_internal":false,"editable":false,"type":"Activities::BugReopened","message":"siddiki, thanks for your explanation. We agree that a new token should invalidate the old one. We will fix this.","markdown_message":"\u003cp\u003esiddiki, thanks for your explanation. We agree that a new token should invalidate the old one. We will fix this.\u003c/p\u003e\n","automated_response":false,"created_at":"2014-07-07T17:03:03.786Z","updated_at":"2014-07-07T17:03:03.786Z","actor":{"username":"natec","cleared":false,"url":"/natec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/007/432/7cb16ccfae82daba2a96b373897e18f731ab4ecd_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mavenlink","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":85435,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2014-07-07T17:06:51.419Z","updated_at":"2014-07-07T17:06:51.419Z","actor":{"username":"natec","cleared":false,"url":"/natec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/007/432/7cb16ccfae82daba2a96b373897e18f731ab4ecd_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mavenlink","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":86516,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"siddiki, this is now resolved. Requesting a new password reset invalidates previous requests now. Thanks for the report!","markdown_message":"\u003cp\u003esiddiki, this is now resolved. Requesting a new password reset invalidates previous requests now. Thanks for the report!\u003c/p\u003e\n","automated_response":false,"created_at":"2014-07-09T16:40:15.154Z","updated_at":"2014-07-09T16:40:15.154Z","actor":{"username":"natec","cleared":false,"url":"/natec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/007/432/7cb16ccfae82daba2a96b373897e18f731ab4ecd_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"siddiki","url":"/siddiki"},"genius_execution_id":null,"team_handle":"mavenlink","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":86535,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2014-07-09T17:12:09.703Z","updated_at":"2014-07-09T17:12:09.703Z","first_to_agree":true,"actor":{"username":"siddiki","cleared":true,"url":"/siddiki","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/502/cf522f55c77430ca80c9ff947d022eb7e3d79350_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mavenlink","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":87191,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Requesting a new password reset invalidates previous requests now.  Additionally, all password resets expire after 48 hours.","markdown_message":"\u003cp\u003eRequesting a new password reset invalidates previous requests now.  Additionally, all password resets expire after 48 hours.\u003c/p\u003e\n","automated_response":false,"created_at":"2014-07-10T18:23:38.477Z","updated_at":"2014-07-10T18:23:38.477Z","actor":{"username":"natec","cleared":false,"url":"/natec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/007/432/7cb16ccfae82daba2a96b373897e18f731ab4ecd_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mavenlink","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":87192,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2014-07-10T18:23:38.622Z","updated_at":"2014-07-10T18:23:38.622Z","actor":{"username":"natec","cleared":false,"url":"/natec","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/007/432/7cb16ccfae82daba2a96b373897e18f731ab4ecd_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mavenlink","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":93551,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2014-07-22T17:14:03.024Z","updated_at":"2014-07-22T17:14:03.024Z","actor":{"url":"/mavenlink","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/048/f0b795a31dcd39219030322524224cd0b61cc45e_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Mavenlink"}},"bounty_amount":"100.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"mavenlink","collaborator":{"username":"siddiki","url":"/siddiki"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":93557,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Explanation: Password resets have always expired after 48 hours.  This change also invalidates old tokens immediately when a new one is issued.","markdown_message":"\u003cp\u003eExplanation: Password resets have always expired after 48 hours.  This change also invalidates old tokens immediately when a new one is issued.\u003c/p\u003e\n","automated_response":false,"created_at":"2014-07-22T17:18:02.419Z","updated_at":"2014-07-22T17:18:02.419Z","actor":{"username":"tectonic","cleared":false,"url":"/tectonic","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/980/26aa4e12a7ad70832a0893b4b263cd1abd9267c2_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mavenlink","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}