{"id":206877,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMDY4Nzc=","url":"https://hackerone.com/reports/206877","title":"HTML injection in Desktop Client","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2017-02-16T13:01:16.695Z","submitted_at":"2017-02-16T13:01:16.695Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"lukasreschke","url":"/lukasreschke","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":3059,"url":"https://hackerone.com/owncloud","handle":"owncloud","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/003/059/d31dc64427bbbf2e428a0b0b97bce59b98d2ba0d_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/059/d31dc64427bbbf2e428a0b0b97bce59b98d2ba0d_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"ownCloud","twitter_handle":"ownCloud","website":"https://www.owncloud.com","about":"ownCloud GmbH is the company behind the ownCloud Project - the most downloaded open source project for data and file sync, share and view."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-05-23T07:29:33.250Z","bug_reporter_agreed_on_going_public_at":"2017-05-22T21:54:43.884Z","team_member_agreed_on_going_public_at":"2017-05-23T07:29:33.199Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"#Problem\n\nThere are HTML injections throughout the ownCloud desktop client. A good example of this can be seen in [accountsettings.cpp line 641 to 705](https://github.com/owncloud/client/blob/172689d35cfae5137a316dfdee7dacc9667e1dcc/src/gui/accountsettings.cpp#L641-L705). For reference purposes this is a trimmed down and slightly commented version of the code:\n\n```cpp\nvoid AccountSettings::refreshSelectiveSyncStatus()\n{\n    QString msg;\n    int cnt = 0;\n    foreach (Folder *folder, FolderMan::instance()-\u003emap().values()) {\n    ...\n        foreach(const auto \u0026it, undecidedList) {\n            ...\n            QString myFolder = (it);\n            ...\n            QModelIndex theIndx = _model-\u003eindexForPath(folder, myFolder);\n            if(theIndx.isValid()) {\n                // User supplied content is appended to msg\n                msg += QString::fromLatin1(\"\u003ca href=\\\"%1?folder=%2\\\"\u003e%1\u003c/a\u003e\").arg(myFolder).arg(folder-\u003ealias());\n            } else {\n                msg += myFolder; // no link because we do not know the index yet.\n            }\n        }\n    }\n\n    if (msg.isEmpty()) {\n       ...\n    } else {\n        ConfigFile cfg;\n        QString info =\n            !cfg.confirmExternalStorage() ? tr(\"There are folders that were not synchronized because they are too big: \") :\n            !cfg.newBigFolderSizeLimit().first ? tr(\"There are folders that were not synchronized because they are external storages: \") :\n            tr(\"There are folders that were not synchronized because they are too big or external storages: \");\n\n        ui-\u003eselectiveSyncNotification-\u003esetText(info + msg);\n        ui-\u003eselectiveSyncButtons-\u003esetVisible(false);\n        ui-\u003ebigFolderUi-\u003esetVisible(true);\n        shouldBeVisible = true;\n    }\n   ...\n}\n```\n\n`msg` is assigned `QString::fromLatin1(\"\u003ca href=\\\"%1?folder=%2\\\"\u003e%1\u003c/a\u003e\").arg(myFolder).arg(folder-\u003ealias());` whereas `myFolder` and `folder-\u003ealias()` are user-controlled content.\n\nIf an adversary on the instance now shares a folder with someone else that exceeds the \"ask for confirmation before synchronising limit\" (default: 500MB) this will lead into above execution path.  An example malicious folder name would be:\n\n\u003e `\"\u003e\u003c\u0026#x2f;a\u003e\u003cp\u003e\u003ccenter\u003e\u003ch1\u003e\u003cstrong\u003eImportant!\u003c\u0026#x2f;strong\u003e Please go to nextcloud.com and relogin!\u003c\u0026#x2f;center\u003e\u003c\u0026#x2f;h1\u003e\u003c\u0026#x2f;p\u003e\u003c!-- ` \n\nIn the user interface this will lead to following view in the 2.3.x client:\n\n{F161217}\n\n*Note that this is also exploitable on 2.2.x. For simplicity, I went with the 2.3.x client as this is the currently developed branch. Exploit has been tested on OS X and may need adjustments for other operating systems.*\n\n#Patch proposal\n\nThis kind of vulnerability can be addressed by escaping user-supplied content, in this case one approach to patch it would be:\n\n```diff\ndiff --git src/gui/accountsettings.cpp src/gui/accountsettings.cpp\nindex 0fb32cfbf..9c46ce9c1 100644\n--- src/gui/accountsettings.cpp\n+++ src/gui/accountsettings.cpp\n@@ -664,7 +664,7 @@ void AccountSettings::refreshSelectiveSyncStatus()\n             }\n             QModelIndex theIndx = _model-\u003eindexForPath(folder, myFolder);\n             if(theIndx.isValid()) {\n-                msg += QString::fromLatin1(\"\u003ca href=\\\"%1?folder=%2\\\"\u003e%1\u003c/a\u003e\").arg(myFolder).arg(folder-\u003ealias());\n+                msg += QString::fromLatin1(\"\u003ca href=\\\"%1?folder=%2\\\"\u003e%1\u003c/a\u003e\").arg(myFolder.toHtmlEscaped()).arg(folder-\u003ealias().toHtmlEscaped());\n             } else {\n                 msg += myFolder; // no link because we do not know the index yet.\n             }\n```\n\n#General recommendation\n\nA quick research on the client application shows that similar vulnerabilities can be found throughout the application. For example when hovering file names as can be seen in F161223. \n\nI'd highly recommend thus to review the whole codebase for similar vulnerabilities.","vulnerability_information_html":"\u003ch1 id=\"problem\"\u003eProblem\u003c/h1\u003e\n\n\u003cp\u003eThere are HTML injections throughout the ownCloud desktop client. A good example of this can be seen in \u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fowncloud%2Fclient%2Fblob%2F172689d35cfae5137a316dfdee7dacc9667e1dcc%2Fsrc%2Fgui%2Faccountsettings.cpp%23L641-L705\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eaccountsettings.cpp line 641 to 705\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e. For reference purposes this is a trimmed down and slightly commented version of the code:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight cpp\"\u003e\u003ccode\u003e\u003cspan class=\"kt\"\u003evoid\u003c/span\u003e \u003cspan class=\"n\"\u003eAccountSettings\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"n\"\u003erefreshSelectiveSyncStatus\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eQString\u003c/span\u003e \u003cspan class=\"n\"\u003emsg\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003ecnt\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eforeach\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eFolder\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"n\"\u003efolder\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eFolderMan\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"n\"\u003einstance\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"n\"\u003emap\u003c/span\u003e\u003cspan class=\"p\"\u003e().\u003c/span\u003e\u003cspan class=\"n\"\u003evalues\u003c/span\u003e\u003cspan class=\"p\"\u003e())\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e...\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eforeach\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003econst\u003c/span\u003e \u003cspan class=\"k\"\u003eauto\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026amp;\u003c/span\u003e\u003cspan class=\"n\"\u003eit\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eundecidedList\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e...\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eQString\u003c/span\u003e \u003cspan class=\"n\"\u003emyFolder\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eit\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e...\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eQModelIndex\u003c/span\u003e \u003cspan class=\"n\"\u003etheIndx\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003e_model\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"n\"\u003eindexForPath\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003efolder\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003emyFolder\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eif\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003etheIndx\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eisValid\u003c/span\u003e\u003cspan class=\"p\"\u003e())\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"c1\"\u003e// User supplied content is appended to msg\u003c/span\u003e\n                \u003cspan class=\"n\"\u003emsg\u003c/span\u003e \u003cspan class=\"o\"\u003e+=\u003c/span\u003e \u003cspan class=\"n\"\u003eQString\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"n\"\u003efromLatin1\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;\u0026lt;a href=\u003c/span\u003e\u003cspan class=\"se\"\u003e\\\u0026quot;\u003c/span\u003e\u003cspan class=\"s\"\u003e%1?folder=%2\u003c/span\u003e\u003cspan class=\"se\"\u003e\\\u0026quot;\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026gt;%1\u0026lt;/a\u0026gt;\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"n\"\u003earg\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003emyFolder\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"n\"\u003earg\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003efolder\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"n\"\u003ealias\u003c/span\u003e\u003cspan class=\"p\"\u003e());\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e}\u003c/span\u003e \u003cspan class=\"k\"\u003eelse\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"n\"\u003emsg\u003c/span\u003e \u003cspan class=\"o\"\u003e+=\u003c/span\u003e \u003cspan class=\"n\"\u003emyFolder\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"c1\"\u003e// no link because we do not know the index yet.\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003emsg\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eisEmpty\u003c/span\u003e\u003cspan class=\"p\"\u003e())\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n       \u003cspan class=\"p\"\u003e...\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e \u003cspan class=\"k\"\u003eelse\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eConfigFile\u003c/span\u003e \u003cspan class=\"n\"\u003ecfg\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eQString\u003c/span\u003e \u003cspan class=\"n\"\u003einfo\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e\n            \u003cspan class=\"o\"\u003e!\u003c/span\u003e\u003cspan class=\"n\"\u003ecfg\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003econfirmExternalStorage\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"o\"\u003e?\u003c/span\u003e \u003cspan class=\"n\"\u003etr\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;There are folders that were not synchronized because they are too big: \u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e:\u003c/span\u003e\n            \u003cspan class=\"o\"\u003e!\u003c/span\u003e\u003cspan class=\"n\"\u003ecfg\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003enewBigFolderSizeLimit\u003c/span\u003e\u003cspan class=\"p\"\u003e().\u003c/span\u003e\u003cspan class=\"n\"\u003efirst\u003c/span\u003e \u003cspan class=\"o\"\u003e?\u003c/span\u003e \u003cspan class=\"n\"\u003etr\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;There are folders that were not synchronized because they are external storages: \u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e:\u003c/span\u003e\n            \u003cspan class=\"n\"\u003etr\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;There are folders that were not synchronized because they are too big or external storages: \u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n        \u003cspan class=\"n\"\u003eui\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"n\"\u003eselectiveSyncNotification\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"n\"\u003esetText\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003einfo\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"n\"\u003emsg\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eui\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"n\"\u003eselectiveSyncButtons\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"n\"\u003esetVisible\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nb\"\u003efalse\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eui\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"n\"\u003ebigFolderUi\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"n\"\u003esetVisible\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nb\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eshouldBeVisible\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nb\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n   \u003cspan class=\"p\"\u003e...\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e\u003ccode\u003emsg\u003c/code\u003e is assigned \u003ccode\u003eQString::fromLatin1(\u0026quot;\u0026lt;a href=\\\u0026quot;%1?folder=%2\\\u0026quot;\u0026gt;%1\u0026lt;/a\u0026gt;\u0026quot;).arg(myFolder).arg(folder-\u0026gt;alias());\u003c/code\u003e whereas \u003ccode\u003emyFolder\u003c/code\u003e and \u003ccode\u003efolder-\u0026gt;alias()\u003c/code\u003e are user-controlled content.\u003c/p\u003e\n\n\u003cp\u003eIf an adversary on the instance now shares a folder with someone else that exceeds the \u0026quot;ask for confirmation before synchronising limit\u0026quot; (default: 500MB) this will lead into above execution path.  An example malicious folder name would be:\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003e\u003ccode\u003e\u0026quot;\u0026gt;\u0026lt;\u0026amp;#x2f;a\u0026gt;\u0026lt;p\u0026gt;\u0026lt;center\u0026gt;\u0026lt;h1\u0026gt;\u0026lt;strong\u0026gt;Important!\u0026lt;\u0026amp;#x2f;strong\u0026gt; Please go to nextcloud.com and relogin!\u0026lt;\u0026amp;#x2f;center\u0026gt;\u0026lt;\u0026amp;#x2f;h1\u0026gt;\u0026lt;\u0026amp;#x2f;p\u0026gt;\u0026lt;!--\u003c/code\u003e \u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eIn the user interface this will lead to following view in the 2.3.x client:\u003c/p\u003e\n\n\u003cp\u003e\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"spoofed-error-message.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/161/217/a4c068bd8471848048c19b04cb47c4abac4bf1fa/spoofed-error-message.png?response-content-disposition=attachment%3B%20filename%3D%22spoofed-error-message.png%22%3B%20filename%2A%3DUTF-8%27%27spoofed-error-message.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQSFCZ3AEE%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T045525Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJFMEMCIHWigdtf4V6jrDm66WbPrvAwAjkDkGwq6jJxHgkhTBQkAh8Pm59QJ1DW90Nm%2BqUZrqPeSIGh%2B3OcvgtVLmg10uTMKrQDCFQQARoMMDEzNjE5Mjc0ODQ5IgwfS9%2FiGaxXJhRExaMqkQM%2FioQKCRd2GEb49HBlLXjeVg1H%2FoNlCjm1k0hMZ2xM%2B0x4lmIPMnshxiw4gyq5WOKYTVNGzovcoxlJKVWJ0J8ot8jIAdBOEwL1e8YBnNwskpBMy96aUxeRhk0v3RC6PmoKg5jI4Qx3q41XFLoVNJzGZBMLXknGm%2FL%2F3r3TBQO0a%2Bho9Lw4jX%2FmwWvHj8d64twZuZ4naqUS%2FC5%2FMe%2BCb7di7nj2LrLyNCU3mwVZhuZqaKYU7%2BmpmzDXhPe6vg3i0Ag1ETmf%2B4HHFKIzD1arTf4NVMuk53Qk2BUuVm8UMmZQPvicVaLBXLt7ccHpSlZil%2FS4s09xyNkmhqsb4joFjYvki4ZCYJgj6f2HgZ9j5I5jB%2BkNBEx91sV072LTXsJZGus5vwgFqmgq6%2FLSGoCBv5WZ1%2FGuoZfgjyzvsmoBX8uKpu1MK2cCSfK2OOw%2BdQcJ893qtedMSb3E%2FljNUxJf3ge6DsNwKlGjDwu7tV2CwK5eoC8nnGnfgTFitfIQRa0%2BQ7r2Yiwaq1V%2FfpNlnllKKKKFFDD1uar%2FBTrtAcWSVbs%2BpUxv20hwqIlkNrNvMi6wkgf%2BLXOkTSYmrhZJiEvr012n0TMdj9Lpp5lSBvt%2BFmQOWfNxpY3OJBDwcWAiZ%2F2ed9lHQZ21qGQ3nsQfbuRvBliy0SDSXu3rFk%2F2YIvbptRB1WpaAx7N%2FhS0S%2Bs17TOirrod7lqA3UzbN3XBtY1r%2BegR7%2FcG%2BpTuKL1SZFmW4odML8bsKnPb2rSlOtAfW6UI5KEpZRuNPIpftSdXrAErjdLnGLehSWx7Q2Iysd3y2wS8%2BnA6TfU%2Fr7xOl0wvkOaOhwXKDLm%2BA5oHA3Mxg%2F%2FTNCq8BPNgEALt%2FQ%3D%3D\u0026amp;X-Amz-Signature=bde0cae1b329ae11a358f98894acd7dda1ee74ebddfc052579987cb6d5985cc5\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/161/217/a4c068bd8471848048c19b04cb47c4abac4bf1fa/spoofed-error-message.png?response-content-disposition=attachment%3B%20filename%3D%22spoofed-error-message.png%22%3B%20filename%2A%3DUTF-8%27%27spoofed-error-message.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQSFCZ3AEE%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T045525Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJFMEMCIHWigdtf4V6jrDm66WbPrvAwAjkDkGwq6jJxHgkhTBQkAh8Pm59QJ1DW90Nm%2BqUZrqPeSIGh%2B3OcvgtVLmg10uTMKrQDCFQQARoMMDEzNjE5Mjc0ODQ5IgwfS9%2FiGaxXJhRExaMqkQM%2FioQKCRd2GEb49HBlLXjeVg1H%2FoNlCjm1k0hMZ2xM%2B0x4lmIPMnshxiw4gyq5WOKYTVNGzovcoxlJKVWJ0J8ot8jIAdBOEwL1e8YBnNwskpBMy96aUxeRhk0v3RC6PmoKg5jI4Qx3q41XFLoVNJzGZBMLXknGm%2FL%2F3r3TBQO0a%2Bho9Lw4jX%2FmwWvHj8d64twZuZ4naqUS%2FC5%2FMe%2BCb7di7nj2LrLyNCU3mwVZhuZqaKYU7%2BmpmzDXhPe6vg3i0Ag1ETmf%2B4HHFKIzD1arTf4NVMuk53Qk2BUuVm8UMmZQPvicVaLBXLt7ccHpSlZil%2FS4s09xyNkmhqsb4joFjYvki4ZCYJgj6f2HgZ9j5I5jB%2BkNBEx91sV072LTXsJZGus5vwgFqmgq6%2FLSGoCBv5WZ1%2FGuoZfgjyzvsmoBX8uKpu1MK2cCSfK2OOw%2BdQcJ893qtedMSb3E%2FljNUxJf3ge6DsNwKlGjDwu7tV2CwK5eoC8nnGnfgTFitfIQRa0%2BQ7r2Yiwaq1V%2FfpNlnllKKKKFFDD1uar%2FBTrtAcWSVbs%2BpUxv20hwqIlkNrNvMi6wkgf%2BLXOkTSYmrhZJiEvr012n0TMdj9Lpp5lSBvt%2BFmQOWfNxpY3OJBDwcWAiZ%2F2ed9lHQZ21qGQ3nsQfbuRvBliy0SDSXu3rFk%2F2YIvbptRB1WpaAx7N%2FhS0S%2Bs17TOirrod7lqA3UzbN3XBtY1r%2BegR7%2FcG%2BpTuKL1SZFmW4odML8bsKnPb2rSlOtAfW6UI5KEpZRuNPIpftSdXrAErjdLnGLehSWx7Q2Iysd3y2wS8%2BnA6TfU%2Fr7xOl0wvkOaOhwXKDLm%2BA5oHA3Mxg%2F%2FTNCq8BPNgEALt%2FQ%3D%3D\u0026amp;X-Amz-Signature=bde0cae1b329ae11a358f98894acd7dda1ee74ebddfc052579987cb6d5985cc5\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003cem\u003eNote that this is also exploitable on 2.2.x. For simplicity, I went with the 2.3.x client as this is the currently developed branch. Exploit has been tested on OS X and may need adjustments for other operating systems.\u003c/em\u003e\u003c/p\u003e\n\n\u003ch1 id=\"patch-proposal\"\u003ePatch proposal\u003c/h1\u003e\n\n\u003cp\u003eThis kind of vulnerability can be addressed by escaping user-supplied content, in this case one approach to patch it would be:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight diff\"\u003e\u003ccode\u003e\u003cspan class=\"gh\"\u003ediff --git src/gui/accountsettings.cpp src/gui/accountsettings.cpp\nindex 0fb32cfbf..9c46ce9c1 100644\n\u003c/span\u003e\u003cspan class=\"gd\"\u003e--- src/gui/accountsettings.cpp\n\u003c/span\u003e\u003cspan class=\"gi\"\u003e+++ src/gui/accountsettings.cpp\n\u003c/span\u003e\u003cspan class=\"p\"\u003e@@ -664,7 +664,7 @@\u003c/span\u003e void AccountSettings::refreshSelectiveSyncStatus()\n             }\n             QModelIndex theIndx = _model-\u0026gt;indexForPath(folder, myFolder);\n             if(theIndx.isValid()) {\n\u003cspan class=\"gd\"\u003e-                msg += QString::fromLatin1(\u0026quot;\u0026lt;a href=\\\u0026quot;%1?folder=%2\\\u0026quot;\u0026gt;%1\u0026lt;/a\u0026gt;\u0026quot;).arg(myFolder).arg(folder-\u0026gt;alias());\n\u003c/span\u003e\u003cspan class=\"gi\"\u003e+                msg += QString::fromLatin1(\u0026quot;\u0026lt;a href=\\\u0026quot;%1?folder=%2\\\u0026quot;\u0026gt;%1\u0026lt;/a\u0026gt;\u0026quot;).arg(myFolder.toHtmlEscaped()).arg(folder-\u0026gt;alias().toHtmlEscaped());\n\u003c/span\u003e             } else {\n                 msg += myFolder; // no link because we do not know the index yet.\n             }\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch1 id=\"general-recommendation\"\u003eGeneral recommendation\u003c/h1\u003e\n\n\u003cp\u003eA quick research on the client application shows that similar vulnerabilities can be found throughout the application. For example when hovering file names as can be seen in \u003ca class=\"markdown-attachment-link markdown-attachment-reference\" data-attachment-filename=\"font-exploit.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/161/223/dd22834d5b4e602a7af623b0cc26ac76ae794163/font-exploit.png?response-content-disposition=attachment%3B%20filename%3D%22font-exploit.png%22%3B%20filename%2A%3DUTF-8%27%27font-exploit.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQSFCZ3AEE%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T045525Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJFMEMCIHWigdtf4V6jrDm66WbPrvAwAjkDkGwq6jJxHgkhTBQkAh8Pm59QJ1DW90Nm%2BqUZrqPeSIGh%2B3OcvgtVLmg10uTMKrQDCFQQARoMMDEzNjE5Mjc0ODQ5IgwfS9%2FiGaxXJhRExaMqkQM%2FioQKCRd2GEb49HBlLXjeVg1H%2FoNlCjm1k0hMZ2xM%2B0x4lmIPMnshxiw4gyq5WOKYTVNGzovcoxlJKVWJ0J8ot8jIAdBOEwL1e8YBnNwskpBMy96aUxeRhk0v3RC6PmoKg5jI4Qx3q41XFLoVNJzGZBMLXknGm%2FL%2F3r3TBQO0a%2Bho9Lw4jX%2FmwWvHj8d64twZuZ4naqUS%2FC5%2FMe%2BCb7di7nj2LrLyNCU3mwVZhuZqaKYU7%2BmpmzDXhPe6vg3i0Ag1ETmf%2B4HHFKIzD1arTf4NVMuk53Qk2BUuVm8UMmZQPvicVaLBXLt7ccHpSlZil%2FS4s09xyNkmhqsb4joFjYvki4ZCYJgj6f2HgZ9j5I5jB%2BkNBEx91sV072LTXsJZGus5vwgFqmgq6%2FLSGoCBv5WZ1%2FGuoZfgjyzvsmoBX8uKpu1MK2cCSfK2OOw%2BdQcJ893qtedMSb3E%2FljNUxJf3ge6DsNwKlGjDwu7tV2CwK5eoC8nnGnfgTFitfIQRa0%2BQ7r2Yiwaq1V%2FfpNlnllKKKKFFDD1uar%2FBTrtAcWSVbs%2BpUxv20hwqIlkNrNvMi6wkgf%2BLXOkTSYmrhZJiEvr012n0TMdj9Lpp5lSBvt%2BFmQOWfNxpY3OJBDwcWAiZ%2F2ed9lHQZ21qGQ3nsQfbuRvBliy0SDSXu3rFk%2F2YIvbptRB1WpaAx7N%2FhS0S%2Bs17TOirrod7lqA3UzbN3XBtY1r%2BegR7%2FcG%2BpTuKL1SZFmW4odML8bsKnPb2rSlOtAfW6UI5KEpZRuNPIpftSdXrAErjdLnGLehSWx7Q2Iysd3y2wS8%2BnA6TfU%2Fr7xOl0wvkOaOhwXKDLm%2BA5oHA3Mxg%2F%2FTNCq8BPNgEALt%2FQ%3D%3D\u0026amp;X-Amz-Signature=d7ad2c47fbf1fd181144671b2287953fd5d2cd3c08c96a923f4240caf276c804\" data-attachment-type=\"image/png\"\u003efont-exploit.png (F161223)\u003c/a\u003e. \u003c/p\u003e\n\n\u003cp\u003eI\u0026#39;d highly recommend thus to review the whole codebase for similar vulnerabilities.\u003c/p\u003e\n","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":161217,"file_name":"spoofed-error-message.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/161/217/a4c068bd8471848048c19b04cb47c4abac4bf1fa/spoofed-error-message.png?response-content-disposition=attachment%3B%20filename%3D%22spoofed-error-message.png%22%3B%20filename%2A%3DUTF-8%27%27spoofed-error-message.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSFCZ3AEE%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T045525Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJFMEMCIHWigdtf4V6jrDm66WbPrvAwAjkDkGwq6jJxHgkhTBQkAh8Pm59QJ1DW90Nm%2BqUZrqPeSIGh%2B3OcvgtVLmg10uTMKrQDCFQQARoMMDEzNjE5Mjc0ODQ5IgwfS9%2FiGaxXJhRExaMqkQM%2FioQKCRd2GEb49HBlLXjeVg1H%2FoNlCjm1k0hMZ2xM%2B0x4lmIPMnshxiw4gyq5WOKYTVNGzovcoxlJKVWJ0J8ot8jIAdBOEwL1e8YBnNwskpBMy96aUxeRhk0v3RC6PmoKg5jI4Qx3q41XFLoVNJzGZBMLXknGm%2FL%2F3r3TBQO0a%2Bho9Lw4jX%2FmwWvHj8d64twZuZ4naqUS%2FC5%2FMe%2BCb7di7nj2LrLyNCU3mwVZhuZqaKYU7%2BmpmzDXhPe6vg3i0Ag1ETmf%2B4HHFKIzD1arTf4NVMuk53Qk2BUuVm8UMmZQPvicVaLBXLt7ccHpSlZil%2FS4s09xyNkmhqsb4joFjYvki4ZCYJgj6f2HgZ9j5I5jB%2BkNBEx91sV072LTXsJZGus5vwgFqmgq6%2FLSGoCBv5WZ1%2FGuoZfgjyzvsmoBX8uKpu1MK2cCSfK2OOw%2BdQcJ893qtedMSb3E%2FljNUxJf3ge6DsNwKlGjDwu7tV2CwK5eoC8nnGnfgTFitfIQRa0%2BQ7r2Yiwaq1V%2FfpNlnllKKKKFFDD1uar%2FBTrtAcWSVbs%2BpUxv20hwqIlkNrNvMi6wkgf%2BLXOkTSYmrhZJiEvr012n0TMdj9Lpp5lSBvt%2BFmQOWfNxpY3OJBDwcWAiZ%2F2ed9lHQZ21qGQ3nsQfbuRvBliy0SDSXu3rFk%2F2YIvbptRB1WpaAx7N%2FhS0S%2Bs17TOirrod7lqA3UzbN3XBtY1r%2BegR7%2FcG%2BpTuKL1SZFmW4odML8bsKnPb2rSlOtAfW6UI5KEpZRuNPIpftSdXrAErjdLnGLehSWx7Q2Iysd3y2wS8%2BnA6TfU%2Fr7xOl0wvkOaOhwXKDLm%2BA5oHA3Mxg%2F%2FTNCq8BPNgEALt%2FQ%3D%3D\u0026X-Amz-Signature=bde0cae1b329ae11a358f98894acd7dda1ee74ebddfc052579987cb6d5985cc5","file_size":301670,"type":"image/png"},{"id":161223,"file_name":"font-exploit.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/161/223/dd22834d5b4e602a7af623b0cc26ac76ae794163/font-exploit.png?response-content-disposition=attachment%3B%20filename%3D%22font-exploit.png%22%3B%20filename%2A%3DUTF-8%27%27font-exploit.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSFCZ3AEE%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T045525Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJFMEMCIHWigdtf4V6jrDm66WbPrvAwAjkDkGwq6jJxHgkhTBQkAh8Pm59QJ1DW90Nm%2BqUZrqPeSIGh%2B3OcvgtVLmg10uTMKrQDCFQQARoMMDEzNjE5Mjc0ODQ5IgwfS9%2FiGaxXJhRExaMqkQM%2FioQKCRd2GEb49HBlLXjeVg1H%2FoNlCjm1k0hMZ2xM%2B0x4lmIPMnshxiw4gyq5WOKYTVNGzovcoxlJKVWJ0J8ot8jIAdBOEwL1e8YBnNwskpBMy96aUxeRhk0v3RC6PmoKg5jI4Qx3q41XFLoVNJzGZBMLXknGm%2FL%2F3r3TBQO0a%2Bho9Lw4jX%2FmwWvHj8d64twZuZ4naqUS%2FC5%2FMe%2BCb7di7nj2LrLyNCU3mwVZhuZqaKYU7%2BmpmzDXhPe6vg3i0Ag1ETmf%2B4HHFKIzD1arTf4NVMuk53Qk2BUuVm8UMmZQPvicVaLBXLt7ccHpSlZil%2FS4s09xyNkmhqsb4joFjYvki4ZCYJgj6f2HgZ9j5I5jB%2BkNBEx91sV072LTXsJZGus5vwgFqmgq6%2FLSGoCBv5WZ1%2FGuoZfgjyzvsmoBX8uKpu1MK2cCSfK2OOw%2BdQcJ893qtedMSb3E%2FljNUxJf3ge6DsNwKlGjDwu7tV2CwK5eoC8nnGnfgTFitfIQRa0%2BQ7r2Yiwaq1V%2FfpNlnllKKKKFFDD1uar%2FBTrtAcWSVbs%2BpUxv20hwqIlkNrNvMi6wkgf%2BLXOkTSYmrhZJiEvr012n0TMdj9Lpp5lSBvt%2BFmQOWfNxpY3OJBDwcWAiZ%2F2ed9lHQZ21qGQ3nsQfbuRvBliy0SDSXu3rFk%2F2YIvbptRB1WpaAx7N%2FhS0S%2Bs17TOirrod7lqA3UzbN3XBtY1r%2BegR7%2FcG%2BpTuKL1SZFmW4odML8bsKnPb2rSlOtAfW6UI5KEpZRuNPIpftSdXrAErjdLnGLehSWx7Q2Iysd3y2wS8%2BnA6TfU%2Fr7xOl0wvkOaOhwXKDLm%2BA5oHA3Mxg%2F%2FTNCq8BPNgEALt%2FQ%3D%3D\u0026X-Amz-Signature=d7ad2c47fbf1fd181144671b2287953fd5d2cd3c08c96a923f4240caf276c804","file_size":300070,"type":"image/png"}],"allow_singular_disclosure_at":"2017-06-21T21:54:43.966Z","allow_singular_disclosure_after":-111135641.21082127,"singular_disclosure_allowed":true,"vote_count":5,"voters":["ysx","eveeez","japz","demo--hacker","spetr0x"],"severity":{"rating":"low","score":3.5,"author_type":"User","metrics":{"attack_vector":"network","attack_complexity":"high","privileges_required":"low","user_interaction":"none","scope":"changed","confidentiality":"none","integrity":"low","availability":"none"}},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1489102,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks a lot for reporting this potential issue back to us. We take security very seriously and would appreciate if you would not share any information about this bug until we have determined a potential patch.\r\n \r\nOur security team will take a look at this issue as soon as possible. We will reply to your report within 72 hours, usually much faster.","markdown_message":"\u003cp\u003eThanks a lot for reporting this potential issue back to us. We take security very seriously and would appreciate if you would not share any information about this bug until we have determined a potential patch.\u003c/p\u003e\n\n\u003cp\u003eOur security team will take a look at this issue as soon as possible. We will reply to your report within 72 hours, usually much faster.\u003c/p\u003e\n","automated_response":true,"created_at":"2017-02-16T13:01:16.906Z","updated_at":"2017-02-16T13:01:16.906Z","actor":{"url":"/owncloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/059/d31dc64427bbbf2e428a0b0b97bce59b98d2ba0d_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"ownCloud"}},"genius_execution_id":null,"team_handle":"owncloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1499717,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Looks like a valid report.\n\nNote that the patch does not work with Qt4.   (one need to call Utility::escape(...)  instead)\n\n(Also, the mult-arg veriant of arg should be used because the folder could contain a '%1'","markdown_message":"\u003cp\u003eLooks like a valid report.\u003c/p\u003e\n\n\u003cp\u003eNote that the patch does not work with Qt4.   (one need to call Utility::escape(...)  instead)\u003c/p\u003e\n\n\u003cp\u003e(Also, the mult-arg veriant of arg should be used because the folder could contain a \u0026#39;%1\u0026#39;\u003c/p\u003e\n","automated_response":false,"created_at":"2017-02-22T17:24:36.048Z","updated_at":"2017-02-22T17:24:36.048Z","actor":{"username":"ogoffart","cleared":false,"url":"/ogoffart","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"owncloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1501456,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for the update, @ogoffart. We do certainly appreciate it! :-)\n\nAs stated via mail, if you require any help in addressing this me and @rullzer would be happy to help as well as review any Pull Request.","markdown_message":"\u003cp\u003eThanks for the update, \u003ca href=\"/ogoffart\"\u003e@ogoffart\u003c/a\u003e. We do certainly appreciate it! :-)\u003c/p\u003e\n\n\u003cp\u003eAs stated via mail, if you require any help in addressing this me and \u003ca href=\"/rullzer\"\u003e@rullzer\u003c/a\u003e would be happy to help as well as review any Pull Request.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-02-23T14:37:49.991Z","updated_at":"2017-02-23T14:37:49.991Z","actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"owncloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1502929,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"The issue should be fixed now:  https://github.com/owncloud/client/pull/5558\n(yes, it is public, I considered it is fine because the security implications of adding some formating glitches to the UI are quite low).\n\nI don't know how to proceed with hackerone for the bounty or so. maybe @pprochaska can help.\nThe issue is valid and was fixed. But i think the security implications are low.  An authenticated user sharing files can add or mess the formating of some messages in the client.","markdown_message":"\u003cp\u003eThe issue should be fixed now:  \u003ca title=\"https://github.com/owncloud/client/pull/5558\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fowncloud%2Fclient%2Fpull%2F5558\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/owncloud/client/pull/5558\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\n(yes, it is public, I considered it is fine because the security implications of adding some formating glitches to the UI are quite low).\u003c/p\u003e\n\n\u003cp\u003eI don\u0026#39;t know how to proceed with hackerone for the bounty or so. maybe \u003ca href=\"/pprochaska\"\u003e@pprochaska\u003c/a\u003e can help.\u003cbr\u003e\nThe issue is valid and was fixed. But i think the security implications are low.  An authenticated user sharing files can add or mess the formating of some messages in the client.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-02-24T08:52:34.893Z","updated_at":"2017-02-24T08:52:34.893Z","actor":{"username":"ogoffart","cleared":false,"url":"/ogoffart","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"owncloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1537088,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for the patch on that, @ogoffart. Much appreciated.\n\nCan I ask you to close the issue as resolved? This can be done by choosing \"Close report\" in the select box on the top left and then select \"Resolved\" and then pressing the green \"Close Report\" button.\n\n{F168414}","markdown_message":"\u003cp\u003eThanks for the patch on that, \u003ca href=\"/ogoffart\"\u003e@ogoffart\u003c/a\u003e. Much appreciated.\u003c/p\u003e\n\n\u003cp\u003eCan I ask you to close the issue as resolved? This can be done by choosing \u0026quot;Close report\u0026quot; in the select box on the top left and then select \u0026quot;Resolved\u0026quot; and then pressing the green \u0026quot;Close Report\u0026quot; button.\u003c/p\u003e\n\n\u003cp\u003e\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"mark_as_resolved.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/168/414/f7c5ffa4c0c0e86a2fdd9143a2861062bed9f5ba/mark_as_resolved.png?response-content-disposition=attachment%3B%20filename%3D%22mark_as_resolved.png%22%3B%20filename%2A%3DUTF-8%27%27mark_as_resolved.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQSFCZ3AEE%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T045525Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJFMEMCIHWigdtf4V6jrDm66WbPrvAwAjkDkGwq6jJxHgkhTBQkAh8Pm59QJ1DW90Nm%2BqUZrqPeSIGh%2B3OcvgtVLmg10uTMKrQDCFQQARoMMDEzNjE5Mjc0ODQ5IgwfS9%2FiGaxXJhRExaMqkQM%2FioQKCRd2GEb49HBlLXjeVg1H%2FoNlCjm1k0hMZ2xM%2B0x4lmIPMnshxiw4gyq5WOKYTVNGzovcoxlJKVWJ0J8ot8jIAdBOEwL1e8YBnNwskpBMy96aUxeRhk0v3RC6PmoKg5jI4Qx3q41XFLoVNJzGZBMLXknGm%2FL%2F3r3TBQO0a%2Bho9Lw4jX%2FmwWvHj8d64twZuZ4naqUS%2FC5%2FMe%2BCb7di7nj2LrLyNCU3mwVZhuZqaKYU7%2BmpmzDXhPe6vg3i0Ag1ETmf%2B4HHFKIzD1arTf4NVMuk53Qk2BUuVm8UMmZQPvicVaLBXLt7ccHpSlZil%2FS4s09xyNkmhqsb4joFjYvki4ZCYJgj6f2HgZ9j5I5jB%2BkNBEx91sV072LTXsJZGus5vwgFqmgq6%2FLSGoCBv5WZ1%2FGuoZfgjyzvsmoBX8uKpu1MK2cCSfK2OOw%2BdQcJ893qtedMSb3E%2FljNUxJf3ge6DsNwKlGjDwu7tV2CwK5eoC8nnGnfgTFitfIQRa0%2BQ7r2Yiwaq1V%2FfpNlnllKKKKFFDD1uar%2FBTrtAcWSVbs%2BpUxv20hwqIlkNrNvMi6wkgf%2BLXOkTSYmrhZJiEvr012n0TMdj9Lpp5lSBvt%2BFmQOWfNxpY3OJBDwcWAiZ%2F2ed9lHQZ21qGQ3nsQfbuRvBliy0SDSXu3rFk%2F2YIvbptRB1WpaAx7N%2FhS0S%2Bs17TOirrod7lqA3UzbN3XBtY1r%2BegR7%2FcG%2BpTuKL1SZFmW4odML8bsKnPb2rSlOtAfW6UI5KEpZRuNPIpftSdXrAErjdLnGLehSWx7Q2Iysd3y2wS8%2BnA6TfU%2Fr7xOl0wvkOaOhwXKDLm%2BA5oHA3Mxg%2F%2FTNCq8BPNgEALt%2FQ%3D%3D\u0026amp;X-Amz-Signature=367d5e3edba5254957702b942f552b6125731477b98787ee56a311276a137762\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/168/414/f7c5ffa4c0c0e86a2fdd9143a2861062bed9f5ba/mark_as_resolved.png?response-content-disposition=attachment%3B%20filename%3D%22mark_as_resolved.png%22%3B%20filename%2A%3DUTF-8%27%27mark_as_resolved.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQSFCZ3AEE%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T045525Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJFMEMCIHWigdtf4V6jrDm66WbPrvAwAjkDkGwq6jJxHgkhTBQkAh8Pm59QJ1DW90Nm%2BqUZrqPeSIGh%2B3OcvgtVLmg10uTMKrQDCFQQARoMMDEzNjE5Mjc0ODQ5IgwfS9%2FiGaxXJhRExaMqkQM%2FioQKCRd2GEb49HBlLXjeVg1H%2FoNlCjm1k0hMZ2xM%2B0x4lmIPMnshxiw4gyq5WOKYTVNGzovcoxlJKVWJ0J8ot8jIAdBOEwL1e8YBnNwskpBMy96aUxeRhk0v3RC6PmoKg5jI4Qx3q41XFLoVNJzGZBMLXknGm%2FL%2F3r3TBQO0a%2Bho9Lw4jX%2FmwWvHj8d64twZuZ4naqUS%2FC5%2FMe%2BCb7di7nj2LrLyNCU3mwVZhuZqaKYU7%2BmpmzDXhPe6vg3i0Ag1ETmf%2B4HHFKIzD1arTf4NVMuk53Qk2BUuVm8UMmZQPvicVaLBXLt7ccHpSlZil%2FS4s09xyNkmhqsb4joFjYvki4ZCYJgj6f2HgZ9j5I5jB%2BkNBEx91sV072LTXsJZGus5vwgFqmgq6%2FLSGoCBv5WZ1%2FGuoZfgjyzvsmoBX8uKpu1MK2cCSfK2OOw%2BdQcJ893qtedMSb3E%2FljNUxJf3ge6DsNwKlGjDwu7tV2CwK5eoC8nnGnfgTFitfIQRa0%2BQ7r2Yiwaq1V%2FfpNlnllKKKKFFDD1uar%2FBTrtAcWSVbs%2BpUxv20hwqIlkNrNvMi6wkgf%2BLXOkTSYmrhZJiEvr012n0TMdj9Lpp5lSBvt%2BFmQOWfNxpY3OJBDwcWAiZ%2F2ed9lHQZ21qGQ3nsQfbuRvBliy0SDSXu3rFk%2F2YIvbptRB1WpaAx7N%2FhS0S%2Bs17TOirrod7lqA3UzbN3XBtY1r%2BegR7%2FcG%2BpTuKL1SZFmW4odML8bsKnPb2rSlOtAfW6UI5KEpZRuNPIpftSdXrAErjdLnGLehSWx7Q2Iysd3y2wS8%2BnA6TfU%2Fr7xOl0wvkOaOhwXKDLm%2BA5oHA3Mxg%2F%2FTNCq8BPNgEALt%2FQ%3D%3D\u0026amp;X-Amz-Signature=367d5e3edba5254957702b942f552b6125731477b98787ee56a311276a137762\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2017-03-13T11:58:22.805Z","updated_at":"2017-03-13T11:58:22.805Z","actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":168414,"filename":"mark_as_resolved.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/168/414/f7c5ffa4c0c0e86a2fdd9143a2861062bed9f5ba/mark_as_resolved.png?response-content-disposition=attachment%3B%20filename%3D%22mark_as_resolved.png%22%3B%20filename%2A%3DUTF-8%27%27mark_as_resolved.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSFCZ3AEE%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T045525Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJFMEMCIHWigdtf4V6jrDm66WbPrvAwAjkDkGwq6jJxHgkhTBQkAh8Pm59QJ1DW90Nm%2BqUZrqPeSIGh%2B3OcvgtVLmg10uTMKrQDCFQQARoMMDEzNjE5Mjc0ODQ5IgwfS9%2FiGaxXJhRExaMqkQM%2FioQKCRd2GEb49HBlLXjeVg1H%2FoNlCjm1k0hMZ2xM%2B0x4lmIPMnshxiw4gyq5WOKYTVNGzovcoxlJKVWJ0J8ot8jIAdBOEwL1e8YBnNwskpBMy96aUxeRhk0v3RC6PmoKg5jI4Qx3q41XFLoVNJzGZBMLXknGm%2FL%2F3r3TBQO0a%2Bho9Lw4jX%2FmwWvHj8d64twZuZ4naqUS%2FC5%2FMe%2BCb7di7nj2LrLyNCU3mwVZhuZqaKYU7%2BmpmzDXhPe6vg3i0Ag1ETmf%2B4HHFKIzD1arTf4NVMuk53Qk2BUuVm8UMmZQPvicVaLBXLt7ccHpSlZil%2FS4s09xyNkmhqsb4joFjYvki4ZCYJgj6f2HgZ9j5I5jB%2BkNBEx91sV072LTXsJZGus5vwgFqmgq6%2FLSGoCBv5WZ1%2FGuoZfgjyzvsmoBX8uKpu1MK2cCSfK2OOw%2BdQcJ893qtedMSb3E%2FljNUxJf3ge6DsNwKlGjDwu7tV2CwK5eoC8nnGnfgTFitfIQRa0%2BQ7r2Yiwaq1V%2FfpNlnllKKKKFFDD1uar%2FBTrtAcWSVbs%2BpUxv20hwqIlkNrNvMi6wkgf%2BLXOkTSYmrhZJiEvr012n0TMdj9Lpp5lSBvt%2BFmQOWfNxpY3OJBDwcWAiZ%2F2ed9lHQZ21qGQ3nsQfbuRvBliy0SDSXu3rFk%2F2YIvbptRB1WpaAx7N%2FhS0S%2Bs17TOirrod7lqA3UzbN3XBtY1r%2BegR7%2FcG%2BpTuKL1SZFmW4odML8bsKnPb2rSlOtAfW6UI5KEpZRuNPIpftSdXrAErjdLnGLehSWx7Q2Iysd3y2wS8%2BnA6TfU%2Fr7xOl0wvkOaOhwXKDLm%2BA5oHA3Mxg%2F%2FTNCq8BPNgEALt%2FQ%3D%3D\u0026X-Amz-Signature=367d5e3edba5254957702b942f552b6125731477b98787ee56a311276a137762"}],"genius_execution_id":null,"team_handle":"owncloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1537479,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks for the hint :-)","markdown_message":"\u003cp\u003eThanks for the hint :-)\u003c/p\u003e\n","automated_response":false,"created_at":"2017-03-13T14:16:30.137Z","updated_at":"2017-03-13T14:16:30.137Z","actor":{"username":"pprochaska","cleared":false,"url":"/pprochaska","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"lukasreschke","url":"/lukasreschke"},"genius_execution_id":null,"team_handle":"owncloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1572360,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"","markdown_message":"","automated_response":false,"created_at":"2017-03-30T07:50:14.041Z","updated_at":"2017-03-30T07:50:14.041Z","actor":{"url":"/owncloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/059/d31dc64427bbbf2e428a0b0b97bce59b98d2ba0d_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"ownCloud"}},"genius_execution_id":null,"team_handle":"owncloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1693177,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-05-22T21:54:43.926Z","updated_at":"2017-05-22T21:54:43.926Z","first_to_agree":true,"actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"owncloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1694107,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-05-23T07:29:33.223Z","updated_at":"2017-05-23T07:29:33.223Z","actor":{"username":"pprochaska","cleared":false,"url":"/pprochaska","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"owncloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1694108,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-05-23T07:29:33.276Z","updated_at":"2017-05-23T07:29:33.276Z","actor":{"username":"pprochaska","cleared":false,"url":"/pprochaska","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"owncloud","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}