{"id":386116,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zODYxMTY=","url":"https://hackerone.com/reports/386116","title":"CSV Injection with the CSV export feature","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2018-07-24T06:11:19.552Z","submitted_at":"2018-07-24T06:11:19.552Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"ninjajuju","url":"/ninjajuju","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/TCbEApShJd4AbMpztwQPK2CU/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":30475,"url":"https://hackerone.com/chaturbate","handle":"chaturbate","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/030/475/178c32f60a890eb06ce5d698d44b3eafa35ccf8c_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/030/475/178c32f60a890eb06ce5d698d44b3eafa35ccf8c_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Chaturbate","twitter_handle":"chaturbate","website":"https://chaturbate.com","about":"The largest online adult cam site"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2018-09-20T00:05:50.076Z","bug_reporter_agreed_on_going_public_at":"2018-09-20T00:05:49.952Z","team_member_agreed_on_going_public_at":"2018-09-19T22:16:31.029Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi there,\n\nhope you are well,\n\nThe \"Download as a CSV\" feature of ``` does not properly \"escape\" fields. So that particular field is vulnerable to CSV injection.\n\n**Steps of POC**\n\nStep 1 : Go to any chat room and donate any token to some and in note insert ```=4+4```.\nStep 2 : Now go to on this link and download transaction history. \nStep 3 : Download file as CSV and open it you can =4+4 become 8 so it's prove CSV injection.\n\n**POC video**\n███\n\nMalicious user can take big advantage of this vulnerability because from that vulnerability we can run base OS command on any anonymous user account.\n\n**Prevention**\nStrip \"=\" only, it's not foolproof fix, see this report [#72785](https://hackerone.com/reports/72785) you have to strip +/-/@ and | as well.\n\nReference,\n\nhttps://hackerone.com/reports/72785\nhttps://hackerone.com/reports/223344\nhttps://hackerone.com/reports/244292\n\nPlease let me know if you want more information regarding this report.\n\nCheers, \nNinjan\n\n## Impact\n\nThis vulnerability can be harm for normal user because if malicious user injected any malicious script in token note and when customer user download CSV file then inserted command directly runs when CSV file open.","vulnerability_information_html":"\u003cp\u003eHi there,\u003c/p\u003e\n\n\u003cp\u003ehope you are well,\u003c/p\u003e\n\n\u003cp\u003eThe \u0026quot;Download as a CSV\u0026quot; feature of ``` does not properly \u0026quot;escape\u0026quot; fields. So that particular field is vulnerable to CSV injection.\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eSteps of POC\u003c/strong\u003e\u003c/p\u003e\n\n\u003cp\u003eStep 1 : Go to any chat room and donate any token to some and in note insert \u003ccode\u003e=4+4\u003c/code\u003e.\u003cbr\u003e\nStep 2 : Now go to on this link and download transaction history. \u003cbr\u003e\nStep 3 : Download file as CSV and open it you can =4+4 become 8 so it\u0026#39;s prove CSV injection.\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003ePOC video\u003c/strong\u003e\u003cbr\u003e\n███\u003c/p\u003e\n\n\u003cp\u003eMalicious user can take big advantage of this vulnerability because from that vulnerability we can run base OS command on any anonymous user account.\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003ePrevention\u003c/strong\u003e\u003cbr\u003e\nStrip \u0026quot;=\u0026quot; only, it\u0026#39;s not foolproof fix, see this report \u003ca href=\"https://hackerone.com/reports/72785\"\u003e#72785\u003c/a\u003e you have to strip +/-/@ and | as well.\u003c/p\u003e\n\n\u003cp\u003eReference,\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"https://hackerone.com/reports/72785\" href=\"https://hackerone.com/reports/72785\"\u003ehttps://hackerone.com/reports/72785\u003c/a\u003e\u003cbr\u003e\n\u003ca title=\"https://hackerone.com/reports/223344\" href=\"https://hackerone.com/reports/223344\"\u003ehttps://hackerone.com/reports/223344\u003c/a\u003e\u003cbr\u003e\n\u003ca title=\"https://hackerone.com/reports/244292\" href=\"https://hackerone.com/reports/244292\"\u003ehttps://hackerone.com/reports/244292\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003ePlease let me know if you want more information regarding this report.\u003c/p\u003e\n\n\u003cp\u003eCheers, \u003cbr\u003e\nNinjan\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eThis vulnerability can be harm for normal user because if malicious user injected any malicious script in token note and when customer user download CSV file then inserted command directly runs when CSV file open.\u003c/p\u003e\n","bounty_amount":"150.0","formatted_bounty":"$150","weakness":{"id":59,"name":"OS Command Injection"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2018-10-19T22:16:31.155Z","allow_singular_disclosure_after":-69233491.52248274,"singular_disclosure_allowed":true,"vote_count":9,"voters":["mygf","eveeez","mrd7","mefkan","cryptographer","rootacce55","0ximak","jatacheers","v13rsba"],"severity":{"rating":"low","score":3.1,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"high","privileges_required":"none","user_interaction":"required","scope":"unchanged","confidentiality":"none","integrity":"low","availability":"none"}},"structured_scope":{"databaseId":11722,"asset_type":"URL","asset_identifier":"https://chaturbate.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":3089325,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"**Steps of POC**\n\nStep 1 : Go to any chat room and donate any token to some and in note insert =4+4.\nStep 2 : Now go to ```token state``` and download transaction history. \nStep 3 : Download file as CSV and open it you can see =4+4 become 8 so it's prove CSV injection.","markdown_message":"\u003cp\u003e\u003cstrong\u003eSteps of POC\u003c/strong\u003e\u003c/p\u003e\n\n\u003cp\u003eStep 1 : Go to any chat room and donate any token to some and in note insert =4+4.\u003cbr\u003e\nStep 2 : Now go to \u003ccode\u003etoken state\u003c/code\u003e and download transaction history. \u003cbr\u003e\nStep 3 : Download file as CSV and open it you can see =4+4 become 8 so it\u0026#39;s prove CSV injection.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-07-24T06:26:24.377Z","updated_at":"2018-07-24T06:26:24.377Z","actor":{"username":"ninjajuju","cleared":true,"url":"/ninjajuju","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/TCbEApShJd4AbMpztwQPK2CU/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"chaturbate","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3092906,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @ninjan,\n\nThanks for your submission. We are currently reviewing your report and will get back to you once we have additional information to share.\n\nKind regards,\n@chessmast3r ","markdown_message":"\u003cp\u003eHi \u003ca href=\"/ninjan\"\u003e@ninjan\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThanks for your submission. We are currently reviewing your report and will get back to you once we have additional information to share.\u003c/p\u003e\n\n\u003cp\u003eKind regards,\u003cbr\u003e\n\u003ca href=\"/chessmast3r\"\u003e@chessmast3r\u003c/a\u003e \u003c/p\u003e\n","automated_response":false,"created_at":"2018-07-24T16:56:55.749Z","updated_at":"2018-07-24T16:56:55.749Z","actor":{"username":"chessmast3r","cleared":false,"url":"/chessmast3r","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/220/459/6b3c5fca9df9cde7fe36b55238b13d2cea86ea80_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"chaturbate","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3093223,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2018-07-24T18:37:07.428Z","updated_at":"2018-07-24T18:37:07.428Z","additional_data":{"old_severity":"High","new_severity":"Low (3.1)","old_severity_id":187551,"new_severity_id":187766},"actor":{"username":"williammmllc","cleared":false,"url":"/williammmllc","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"chaturbate","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3093252,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thanks for the report. Normally reports like this are classed as a non vulnerability, see  https://sites.google.com/site/bughunteruniversity/nonvuln/csv-excel-formula-injection\n\nHowever due to the nature of the users on our site, we wish to protect them from such attacks, as such we will class this as a valid bug and resolve it. ","markdown_message":"\u003cp\u003eThanks for the report. Normally reports like this are classed as a non vulnerability, see  \u003ca title=\"https://sites.google.com/site/bughunteruniversity/nonvuln/csv-excel-formula-injection\" href=\"/redirect?url=https%3A%2F%2Fsites.google.com%2Fsite%2Fbughunteruniversity%2Fnonvuln%2Fcsv-excel-formula-injection\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://sites.google.com/site/bughunteruniversity/nonvuln/csv-excel-formula-injection\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eHowever due to the nature of the users on our site, we wish to protect them from such attacks, as such we will class this as a valid bug and resolve it. \u003c/p\u003e\n","automated_response":false,"created_at":"2018-07-24T18:44:54.587Z","updated_at":"2018-07-24T18:44:54.587Z","actor":{"username":"williammmllc","cleared":false,"url":"/williammmllc","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"chaturbate","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3093256,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2018-07-24T18:45:13.346Z","updated_at":"2018-07-24T18:45:13.346Z","actor":{"url":"/chaturbate","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/030/475/178c32f60a890eb06ce5d698d44b3eafa35ccf8c_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Chaturbate"}},"bounty_amount":"150.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"chaturbate","collaborator":{"username":"ninjajuju","url":"/ninjajuju"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3099604,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"This has been resolved. Thanks again for your report!","markdown_message":"\u003cp\u003eThis has been resolved. Thanks again for your report!\u003c/p\u003e\n","automated_response":false,"created_at":"2018-07-26T04:02:06.408Z","updated_at":"2018-07-26T04:02:06.408Z","actor":{"username":"williammmllc","cleared":false,"url":"/williammmllc","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"ninjajuju","url":"/ninjajuju"},"genius_execution_id":null,"team_handle":"chaturbate","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3360360,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-09-19T22:16:31.074Z","updated_at":"2018-09-19T22:16:31.074Z","first_to_agree":true,"actor":{"username":"williammmllc","cleared":false,"url":"/williammmllc","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"chaturbate","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3360648,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-09-20T00:05:50.004Z","updated_at":"2018-09-20T00:05:50.004Z","actor":{"username":"ninjajuju","cleared":true,"url":"/ninjajuju","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/TCbEApShJd4AbMpztwQPK2CU/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"chaturbate","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3360649,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-09-20T00:05:50.119Z","updated_at":"2018-09-20T00:05:50.119Z","actor":{"username":"ninjajuju","cleared":true,"url":"/ninjajuju","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/TCbEApShJd4AbMpztwQPK2CU/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"chaturbate","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}