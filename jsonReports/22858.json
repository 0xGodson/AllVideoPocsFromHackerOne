{"id":22858,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMjg1OA==","url":"https://hackerone.com/reports/22858","title":"Password Reset Links Not Expiring","state":"Closed","substate":"informative","readable_substate":"Informative","created_at":"2014-08-07T10:06:56.686Z","submitted_at":"2014-08-07T10:06:56.686Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"andi_r","url":"/andi_r","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":18,"url":"https://hackerone.com/phabricator","handle":"phabricator","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/018/61446f7e6f0684c8c9f7c36c918b7ecd58183588_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/018/61446f7e6f0684c8c9f7c36c918b7ecd58183588_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Phabricator","twitter_handle":"phabricator","website":"http://phacility.com/phabricator/","about":"Phabricator is a collection of open source web applications that help software companies build better software."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2014-09-06T10:37:00.297Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2014-08-07T10:36:54.277Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Old unused Password reset tokens are not expiring on phabricator after the issuance of a new reset link.\r\nExplaination\r\nSuppose at 09:00 o'clock I used password forgot password option and got a reset link on my email. Lets call it reset_1. But i didnot use it.\r\nAnd at 09:04 o'clock  I used again the forgot password option and got a new reset_link,which is reset_2.\r\nNow generally after the issuance of reset_2,the previous unused reset link should expire.But in case of phabricator its not happening.Both the reset links are remaining usable at the same time.","vulnerability_information_html":"\u003cp\u003eOld unused Password reset tokens are not expiring on phabricator after the issuance of a new reset link.\u003cbr\u003e\nExplaination\u003cbr\u003e\nSuppose at 09:00 o\u0026#39;clock I used password forgot password option and got a reset link on my email. Lets call it reset_1. But i didnot use it.\u003cbr\u003e\nAnd at 09:04 o\u0026#39;clock  I used again the forgot password option and got a new reset_link,which is reset_2.\u003cbr\u003e\nNow generally after the issuance of reset_2,the previous unused reset link should expire.But in case of phabricator its not happening.Both the reset links are remaining usable at the same time.\u003c/p\u003e\n","weakness":{"id":27,"name":"Improper Authentication - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2014-09-06T10:36:54.370Z","allow_singular_disclosure_after":-199218410.5729131,"singular_disclosure_allowed":true,"vote_count":1,"voters":["wargsec"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":101902,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"This is intentional. If the mail takes a few minutes to arrive, users might issue another request. There's no particular benefit to expiring the previous link. If an attacker has access to the user's email, they can simply request another reset link.","markdown_message":"\u003cp\u003eThis is intentional. If the mail takes a few minutes to arrive, users might issue another request. There\u0026#39;s no particular benefit to expiring the previous link. If an attacker has access to the user\u0026#39;s email, they can simply request another reset link.\u003c/p\u003e\n","automated_response":false,"created_at":"2014-08-07T10:15:34.502Z","updated_at":"2014-08-07T10:15:34.502Z","actor":{"username":"epriestley","cleared":false,"url":"/epriestley","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/043/3ebca5250ea5abd54b49ccc9d69c636af4585b2e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"phabricator","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":101907,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Suppose I am an attacker and I got access to the recovery email option of your phabricator account.I logged in to your recovery email (suppose that is user@gmail.com).Then I used the forget password option of your phabricator email. I will get one password reset link.\nI noted the reset link and then deleted the email from user@gmail.com.\nIn the meantime you understood that someone got access to your account.They you reset the password of their phabricator account by issuing new reset link and you also changed the password of your user@gmail.com so that any one cant hack again your phabricator account.\n\nNow its time for my exploitation.\nI will use my reset link which is live even after your issuance of new reset link and I will hack into phabricator account.\n\nA Suggestion to fix this issue :\nUse a certain living span for a reset link. For example a reset link will remain valid up to 12 hours after being issued.\nAll unused reset links should expire automatically after the issuance of a new reset link.","markdown_message":"\u003cp\u003eSuppose I am an attacker and I got access to the recovery email option of your phabricator account.I logged in to your recovery email (suppose that is \u003ca title=\"user@gmail.com\" href=\"mailto:user@gmail.com\" rel=\"nofollow noopener noreferrer\"\u003euser@gmail.com\u003c/a\u003e).Then I used the forget password option of your phabricator email. I will get one password reset link.\u003cbr\u003e\nI noted the reset link and then deleted the email from \u003ca title=\"user@gmail.com\" href=\"mailto:user@gmail.com\" rel=\"nofollow noopener noreferrer\"\u003euser@gmail.com\u003c/a\u003e.\u003cbr\u003e\nIn the meantime you understood that someone got access to your account.They you reset the password of their phabricator account by issuing new reset link and you also changed the password of your \u003ca title=\"user@gmail.com\" href=\"mailto:user@gmail.com\" rel=\"nofollow noopener noreferrer\"\u003euser@gmail.com\u003c/a\u003e so that any one cant hack again your phabricator account.\u003c/p\u003e\n\n\u003cp\u003eNow its time for my exploitation.\u003cbr\u003e\nI will use my reset link which is live even after your issuance of new reset link and I will hack into phabricator account.\u003c/p\u003e\n\n\u003cp\u003eA Suggestion to fix this issue :\u003cbr\u003e\nUse a certain living span for a reset link. For example a reset link will remain valid up to 12 hours after being issued.\u003cbr\u003e\nAll unused reset links should expire automatically after the issuance of a new reset link.\u003c/p\u003e\n","automated_response":false,"created_at":"2014-08-07T10:25:12.437Z","updated_at":"2014-08-07T10:25:12.437Z","actor":{"username":"andi_r","cleared":false,"url":"/andi_r","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"phabricator","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":101909,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"The reset link remains valid for 24 hours.\nUsers can explicitly manage outstanding reset links in Settings \u003e Temporary Tokens.","markdown_message":"\u003cp\u003eThe reset link remains valid for 24 hours.\u003cbr\u003e\nUsers can explicitly manage outstanding reset links in Settings \u0026gt; Temporary Tokens.\u003c/p\u003e\n","automated_response":false,"created_at":"2014-08-07T10:26:17.402Z","updated_at":"2014-08-07T10:26:17.402Z","actor":{"username":"epriestley","cleared":false,"url":"/epriestley","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/043/3ebca5250ea5abd54b49ccc9d69c636af4585b2e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"phabricator","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":101911,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Yeah, but do you understand that someone can get access to your account even with an unused token ? This has to be fixed !!!","markdown_message":"\u003cp\u003eYeah, but do you understand that someone can get access to your account even with an unused token ? This has to be fixed !!!\u003c/p\u003e\n","automated_response":false,"created_at":"2014-08-07T10:28:56.950Z","updated_at":"2014-08-07T10:28:56.950Z","actor":{"username":"andi_r","cleared":false,"url":"/andi_r","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"phabricator","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":101912,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"We are satisfied with this behavior as-is.","markdown_message":"\u003cp\u003eWe are satisfied with this behavior as-is.\u003c/p\u003e\n","automated_response":false,"created_at":"2014-08-07T10:29:47.881Z","updated_at":"2014-08-07T10:29:47.881Z","actor":{"username":"epriestley","cleared":false,"url":"/epriestley","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/043/3ebca5250ea5abd54b49ccc9d69c636af4585b2e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"phabricator","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":101916,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Do you mind if i make the bug public to my blog ?","markdown_message":"\u003cp\u003eDo you mind if i make the bug public to my blog ?\u003c/p\u003e\n","automated_response":false,"created_at":"2014-08-07T10:35:03.787Z","updated_at":"2014-08-07T10:35:03.787Z","actor":{"username":"andi_r","cleared":false,"url":"/andi_r","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"phabricator","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":101918,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Sure, that's fine.","markdown_message":"\u003cp\u003eSure, that\u0026#39;s fine.\u003c/p\u003e\n","automated_response":false,"created_at":"2014-08-07T10:36:54.292Z","updated_at":"2014-08-07T10:36:54.292Z","actor":{"username":"epriestley","cleared":false,"url":"/epriestley","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/043/3ebca5250ea5abd54b49ccc9d69c636af4585b2e_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"phabricator","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":122339,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2014-09-06T10:37:00.330Z","updated_at":"2014-09-06T10:37:00.330Z","actor":{"url":"/phabricator","ibb":true,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/018/61446f7e6f0684c8c9f7c36c918b7ecd58183588_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Phabricator"}},"genius_execution_id":null,"team_handle":"phabricator","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}