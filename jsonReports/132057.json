{"id":132057,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMzIwNTc=","url":"https://hackerone.com/reports/132057","title":"Reputation Manipulation (Theoretical)","state":"Closed","substate":"not-applicable","readable_substate":"N/A","created_at":"2016-04-18T17:35:28.658Z","submitted_at":"2016-04-18T17:35:28.658Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"paulos_","url":"/paulos_","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/008/601/abf2077609ef0546be8676abd1bec49aaefc9ff2_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13,"url":"https://hackerone.com/security","handle":"security","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"HackerOne","twitter_handle":"Hacker0x01","website":"https://hackerone.com","about":"Vulnerability disclosure should be safe, transparent, and rewarding."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2016-04-19T23:08:54.105Z","bug_reporter_agreed_on_going_public_at":"2016-04-19T21:42:40.706Z","team_member_agreed_on_going_public_at":"2016-04-19T23:08:54.025Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi,\n\nI really would appreciate if you are transparent with this or does not close the bug quickly as N/A or something similar because of being purely theoretical.\nI am assuming HackerOne runs an x86 System. and the INT_MAX is **2,147,483,648**. (I know this because https://hackerone.com/reports/2147483647 returns 404 but https://hackerone.com/reports/2147483649 returns Error)\n\nWhile https://hackerone.com/reports/-2147483645 returns 404\nhttps://hackerone.com/reports/-2147483649 returns Error\n\nTo try this bug, I need to have a verified program. because I can't do that (not sandbox to manipulate rep), I am reporting to you about why I think this works.\n\n- Integers can be from -2,147,483,648 to 2,147,483,647 (~ ± 2 billion)\n\nIn any programming language, there should be an INT MAX limit. long, short, double... there is. In short:\n```if(INT_MAX+1 \u003e 0)``` is usually true. In your case:\n```if (int(-2147483648) \u003e 0)``` should return **false** which may be a WTF! \n\n-2147483648 is actually an expression: a positive literal value 2147483648 with unary - operator in front of it. Value 2147483648 is apparently too large for the positive side of int range on your platform.\n\nIn short: 2147483647 + 1 is actually -2147483648 and vice versa. **when you pass the MAX in int, it will become negative. and when you pass the negative limit, the number will become posetive**\n\nI am sure by now you are seeing where I am going with this. when an attacker submits too much vulnerabilities and if all are closed by the program as Spam (-10rep) that will give the user a negative reputation. \n\nIf he manages to get enough Spam (can write a script to automate reporting and closing as Spam) he will eventually have enough negative points that pass the int limit and be considered positive.\n\nSo if an attacker manages to do -2147483648 (consider his reputation) - 10 (another report closed as spam) = Positive. *My numbers may not be accurate because of a number of factors* \n\nThis is the oldest trick in the hat while stealing money from banks and sometimes even referenced as Integer Overflow (dont confuse it with the popular c++ bug)\n\nAnyway, take a look and there is more you didnt patch this and I may be right, if so: horry! if not: well, it was a fun writing this.\n\nThanks,\nPaulos","vulnerability_information_html":"\u003cp\u003eHi,\u003c/p\u003e\n\n\u003cp\u003eI really would appreciate if you are transparent with this or does not close the bug quickly as N/A or something similar because of being purely theoretical.\u003cbr\u003e\nI am assuming HackerOne runs an x86 System. and the INT_MAX is \u003cstrong\u003e2,147,483,648\u003c/strong\u003e. (I know this because \u003ca title=\"https://hackerone.com/reports/2147483647\" href=\"https://hackerone.com/reports/2147483647\"\u003ehttps://hackerone.com/reports/2147483647\u003c/a\u003e returns 404 but \u003ca title=\"https://hackerone.com/reports/2147483649\" href=\"https://hackerone.com/reports/2147483649\"\u003ehttps://hackerone.com/reports/2147483649\u003c/a\u003e returns Error)\u003c/p\u003e\n\n\u003cp\u003eWhile \u003ca title=\"https://hackerone.com/reports/-2147483645\" href=\"https://hackerone.com/reports/-2147483645\"\u003ehttps://hackerone.com/reports/-2147483645\u003c/a\u003e returns 404\u003cbr\u003e\n\u003ca title=\"https://hackerone.com/reports/-2147483649\" href=\"https://hackerone.com/reports/-2147483649\"\u003ehttps://hackerone.com/reports/-2147483649\u003c/a\u003e returns Error\u003c/p\u003e\n\n\u003cp\u003eTo try this bug, I need to have a verified program. because I can\u0026#39;t do that (not sandbox to manipulate rep), I am reporting to you about why I think this works.\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eIntegers can be from -2,147,483,648 to 2,147,483,647 (~ ± 2 billion)\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eIn any programming language, there should be an INT MAX limit. long, short, double... there is. In short:\u003cbr\u003e\n\u003ccode\u003eif(INT_MAX+1 \u0026gt; 0)\u003c/code\u003e is usually true. In your case:\u003cbr\u003e\n\u003ccode\u003eif (int(-2147483648) \u0026gt; 0)\u003c/code\u003e should return \u003cstrong\u003efalse\u003c/strong\u003e which may be a WTF! \u003c/p\u003e\n\n\u003cp\u003e-2147483648 is actually an expression: a positive literal value 2147483648 with unary - operator in front of it. Value 2147483648 is apparently too large for the positive side of int range on your platform.\u003c/p\u003e\n\n\u003cp\u003eIn short: 2147483647 + 1 is actually -2147483648 and vice versa. \u003cstrong\u003ewhen you pass the MAX in int, it will become negative. and when you pass the negative limit, the number will become posetive\u003c/strong\u003e\u003c/p\u003e\n\n\u003cp\u003eI am sure by now you are seeing where I am going with this. when an attacker submits too much vulnerabilities and if all are closed by the program as Spam (-10rep) that will give the user a negative reputation. \u003c/p\u003e\n\n\u003cp\u003eIf he manages to get enough Spam (can write a script to automate reporting and closing as Spam) he will eventually have enough negative points that pass the int limit and be considered positive.\u003c/p\u003e\n\n\u003cp\u003eSo if an attacker manages to do -2147483648 (consider his reputation) - 10 (another report closed as spam) = Positive. \u003cem\u003eMy numbers may not be accurate because of a number of factors\u003c/em\u003e \u003c/p\u003e\n\n\u003cp\u003eThis is the oldest trick in the hat while stealing money from banks and sometimes even referenced as Integer Overflow (dont confuse it with the popular c++ bug)\u003c/p\u003e\n\n\u003cp\u003eAnyway, take a look and there is more you didnt patch this and I may be right, if so: horry! if not: well, it was a fun writing this.\u003c/p\u003e\n\n\u003cp\u003eThanks,\u003cbr\u003e\nPaulos\u003c/p\u003e\n","weakness":{"id":57,"name":"Violation of Secure Design Principles"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2016-05-19T21:42:40.785Z","allow_singular_disclosure_after":-145521750.5466995,"singular_disclosure_allowed":true,"vote_count":6,"voters":["is-","powerjacobb1","mr_sharma_","paulos_","spetr0x","dyabla"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":913160,"is_internal":false,"editable":false,"type":"Activities::BugNotApplicable","message":"Hey @paulos_,\n\nI'm guessing you've never bumped into this, but we actually have a hard submission limit of 128 reports per day, which there is no way for a hacker to bypass. This means that even if a user were allowed to submit, unfettered, the maximum number of reports per day and all of them were closed as spam, AND we didn't notice and close down their account, it would still take more than 4,596 years to execute this exploit. \n\nThanks for the report! I hope you understand why I'm closing this as N/A.\n\nHappy hacking!\n\n\nEvan","markdown_message":"\u003cp\u003eHey \u003ca href=\"/paulos_\"\u003e@paulos_\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eI\u0026#39;m guessing you\u0026#39;ve never bumped into this, but we actually have a hard submission limit of 128 reports per day, which there is no way for a hacker to bypass. This means that even if a user were allowed to submit, unfettered, the maximum number of reports per day and all of them were closed as spam, AND we didn\u0026#39;t notice and close down their account, it would still take more than 4,596 years to execute this exploit. \u003c/p\u003e\n\n\u003cp\u003eThanks for the report! I hope you understand why I\u0026#39;m closing this as N/A.\u003c/p\u003e\n\n\u003cp\u003eHappy hacking!\u003c/p\u003e\n\n\u003cp\u003eEvan\u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-18T21:00:03.247Z","updated_at":"2016-04-18T21:00:03.247Z","actor":{"username":"ebrynne","cleared":false,"url":"/ebrynne","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/191/f333df32e9b61845f5c823b77d968fa6d246d336_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":913181,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@ebrynne I specifically asked not to close this N/A because I am actually reporting a theoretical bug and you couldve closed it as Informative. You know, most of us are just trying to help. stop ruining our reps for trying.\n\nAnyway, even if it takes billions of years, the report is targeting possibility not exploitability. there could be other factors like Race Condition bugs that may allow an attacker to submit more than 128 reports/day. \n\nThis is a bug not considering such factors however. I hope you understand what I am saying. and yes, I understand why you closed it as N/A. ","markdown_message":"\u003cp\u003e\u003ca href=\"/ebrynne\"\u003e@ebrynne\u003c/a\u003e I specifically asked not to close this N/A because I am actually reporting a theoretical bug and you couldve closed it as Informative. You know, most of us are just trying to help. stop ruining our reps for trying.\u003c/p\u003e\n\n\u003cp\u003eAnyway, even if it takes billions of years, the report is targeting possibility not exploitability. there could be other factors like Race Condition bugs that may allow an attacker to submit more than 128 reports/day. \u003c/p\u003e\n\n\u003cp\u003eThis is a bug not considering such factors however. I hope you understand what I am saying. and yes, I understand why you closed it as N/A. \u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-18T21:07:16.181Z","updated_at":"2016-04-18T21:07:16.181Z","actor":{"username":"paulos_","cleared":false,"url":"/paulos_","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/601/abf2077609ef0546be8676abd1bec49aaefc9ff2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":913423,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@ebrynne \n\nThinking about it, it is actually possible. even with just a single report. Luckly, when a report is set the state \"Needs More Info\" it will make -1 from the user point. and a user can reopen it with a reply. and the program can close it as \"needs more info\"... with unlimited attempts. even if limited, with our 128reports/day, I believe I have widened the range.\n\nThanks,","markdown_message":"\u003cp\u003e\u003ca href=\"/ebrynne\"\u003e@ebrynne\u003c/a\u003e \u003c/p\u003e\n\n\u003cp\u003eThinking about it, it is actually possible. even with just a single report. Luckly, when a report is set the state \u0026quot;Needs More Info\u0026quot; it will make -1 from the user point. and a user can reopen it with a reply. and the program can close it as \u0026quot;needs more info\u0026quot;... with unlimited attempts. even if limited, with our 128reports/day, I believe I have widened the range.\u003c/p\u003e\n\n\u003cp\u003eThanks,\u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-18T22:19:50.429Z","updated_at":"2016-04-18T22:19:50.429Z","actor":{"username":"paulos_","cleared":false,"url":"/paulos_","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/601/abf2077609ef0546be8676abd1bec49aaefc9ff2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":915977,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @paulos_!\n\nThe way I look at it it's kinda like brute forcing a password. Sure there might be ways to get around our rate limiting, but with things as they are it would only be possible given thousands of years of effort. Just the same, the exploit we would be interested in would be the one that gets around our reputation-oriented rate limiting, rather than just the fact that an integer could hypothetically overflow. Just adding an additional couple of extra points of negative reputation by abusing NMI (which requires the participation of a team) doesn't really go far enough.\n\nAs for closing as not-applicable, I can see where you're coming from. It's a hard decision every time we see a report like this one. I really appreciate the time and effort you put into your write-up, it's well composed, friendly, and articulate. I'm honestly really looking forward to your next report. But on the other hand given the enormous amount of time this would require to be exploited (and even then it's a pretty big if), I think this report is pretty unambiguously not applicable to our program. We get a lot of reports along the line of \"here's a hypothetical but unexploitable vulnerability\", and we want to make sure that we encourage our users to think twice before they submit that kind or report. \n\nUltimately, I hope you'll understand where we're coming from. You have an excellent account, with lots of reputation and a strong signal, so this shouldn't have any significant impact on your overall success.\n\nThanks!\n\n\nEvan","markdown_message":"\u003cp\u003eHey \u003ca href=\"/paulos_\"\u003e@paulos_\u003c/a\u003e!\u003c/p\u003e\n\n\u003cp\u003eThe way I look at it it\u0026#39;s kinda like brute forcing a password. Sure there might be ways to get around our rate limiting, but with things as they are it would only be possible given thousands of years of effort. Just the same, the exploit we would be interested in would be the one that gets around our reputation-oriented rate limiting, rather than just the fact that an integer could hypothetically overflow. Just adding an additional couple of extra points of negative reputation by abusing NMI (which requires the participation of a team) doesn\u0026#39;t really go far enough.\u003c/p\u003e\n\n\u003cp\u003eAs for closing as not-applicable, I can see where you\u0026#39;re coming from. It\u0026#39;s a hard decision every time we see a report like this one. I really appreciate the time and effort you put into your write-up, it\u0026#39;s well composed, friendly, and articulate. I\u0026#39;m honestly really looking forward to your next report. But on the other hand given the enormous amount of time this would require to be exploited (and even then it\u0026#39;s a pretty big if), I think this report is pretty unambiguously not applicable to our program. We get a lot of reports along the line of \u0026quot;here\u0026#39;s a hypothetical but unexploitable vulnerability\u0026quot;, and we want to make sure that we encourage our users to think twice before they submit that kind or report. \u003c/p\u003e\n\n\u003cp\u003eUltimately, I hope you\u0026#39;ll understand where we\u0026#39;re coming from. You have an excellent account, with lots of reputation and a strong signal, so this shouldn\u0026#39;t have any significant impact on your overall success.\u003c/p\u003e\n\n\u003cp\u003eThanks!\u003c/p\u003e\n\n\u003cp\u003eEvan\u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-19T21:33:34.003Z","updated_at":"2016-04-19T21:33:34.003Z","actor":{"username":"ebrynne","cleared":false,"url":"/ebrynne","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/191/f333df32e9b61845f5c823b77d968fa6d246d336_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":915995,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@ebrynne thanks man. it really means a lot. all this effort is to get that awesome hackerone hoodie haha. I am sure one day I will find something significant enough to deserve it. and yes, I fully understand your decision.\n\nUntil next time, ;)","markdown_message":"\u003cp\u003e\u003ca href=\"/ebrynne\"\u003e@ebrynne\u003c/a\u003e thanks man. it really means a lot. all this effort is to get that awesome hackerone hoodie haha. I am sure one day I will find something significant enough to deserve it. and yes, I fully understand your decision.\u003c/p\u003e\n\n\u003cp\u003eUntil next time, ;)\u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-19T21:40:42.843Z","updated_at":"2016-04-19T21:40:42.843Z","actor":{"username":"paulos_","cleared":false,"url":"/paulos_","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/601/abf2077609ef0546be8676abd1bec49aaefc9ff2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":916002,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"@ebrynne also may I request a public disclosure assuming someone with better experience with this kind of bugs will see this bug and maybe report a feasible poc? ","markdown_message":"\u003cp\u003e\u003ca href=\"/ebrynne\"\u003e@ebrynne\u003c/a\u003e also may I request a public disclosure assuming someone with better experience with this kind of bugs will see this bug and maybe report a feasible poc? \u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-19T21:42:40.735Z","updated_at":"2016-04-19T21:42:40.735Z","first_to_agree":true,"actor":{"username":"paulos_","cleared":false,"url":"/paulos_","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/008/601/abf2077609ef0546be8676abd1bec49aaefc9ff2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":916143,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Sure, public disclosure approved. :)","markdown_message":"\u003cp\u003eSure, public disclosure approved. :)\u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-19T23:08:54.052Z","updated_at":"2016-04-19T23:08:54.052Z","actor":{"username":"reed","cleared":false,"url":"/reed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":916144,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-04-19T23:08:54.135Z","updated_at":"2016-04-19T23:08:54.135Z","actor":{"username":"reed","cleared":false,"url":"/reed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":1721,"category":"team","content":"A potential abuse of reputation by means of an integer overflow. However, given that the attack would take approximately 4,596 years to execute we opted to close the report as Not Applicable.\n\nKudos to @paulos_ for his top notch communication and creative thinking!","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eA potential abuse of reputation by means of an integer overflow. However, given that the attack would take approximately 4,596 years to execute we opted to close the report as Not Applicable.\u003c/p\u003e\n\n\u003cp\u003eKudos to \u003ca href=\"/paulos_\"\u003e@paulos_\u003c/a\u003e for his top notch communication and creative thinking!\u003c/p\u003e\n"},{"category":"researcher","can_view?":true,"can_create?":false}]}