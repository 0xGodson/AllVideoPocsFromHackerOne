{"id":263662,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yNjM2NjI=","url":"https://hackerone.com/reports/263662","title":"Cross-Site Request Forgery on the Federalist API (all endpoints), using Flash file on the attacker's host","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2017-08-26T18:18:35.773Z","submitted_at":"2017-08-26T18:18:35.773Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"sp1d3rs","url":"/sp1d3rs","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/079/690/6853ada3e124bdd8616b1be752223b558de38195_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":21499,"url":"https://hackerone.com/tts","handle":"tts","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/021/499/a8abb6c9702d454ed2bcfa55bb077ac2e49988b9_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/021/499/a8abb6c9702d454ed2bcfa55bb077ac2e49988b9_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"TTS Bug Bounty","twitter_handle":"gsa_tts","website":"https://18f.gsa.gov","about":"The First Civilian Agency Public Bug Bounty Program"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"no-content","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2017-09-27T23:11:52.530Z","bug_reporter_agreed_on_going_public_at":"2017-09-27T23:11:52.454Z","team_member_agreed_on_going_public_at":"2017-09-18T06:43:00.954Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"","vulnerability_information_html":"","bounty_amount":"300.0","formatted_bounty":"$300","weakness":{"id":45,"name":"Cross-Site Request Forgery (CSRF)"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":32,"voters":["jensec","bogdantcaciuc","flashdisk","yumi","johndoe1492","fa1rlight","cuso4","asad0x01_","eveeez","leet-boy","and 22 more..."],"severity":{"rating":"medium","author_type":"Team"},"structured_scope":{"databaseId":978,"asset_type":"SOURCE_CODE","asset_identifier":"https://github.com/18F/federalist","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1957473,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2017-08-26T22:32:03.739Z","updated_at":"2017-08-26T22:32:03.739Z","actor":{"username":"sp1d3rs","cleared":true,"url":"/sp1d3rs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/079/690/6853ada3e124bdd8616b1be752223b558de38195_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1959373,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2017-08-28T11:13:39.154Z","updated_at":"2017-08-28T11:13:39.154Z","actor":{"username":"rubikcube","cleared":false,"url":"/rubikcube","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/112/037/07ab876d3c8a79046085764c245ca1793dcf1d57_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":1959628,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2017-08-28T12:57:23.293Z","updated_at":"2017-08-28T13:00:36.724Z","actor":{"username":"sp1d3rs","cleared":true,"url":"/sp1d3rs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/079/690/6853ada3e124bdd8616b1be752223b558de38195_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1960035,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2017-08-28T14:39:15.089Z","updated_at":"2017-08-28T14:46:23.695Z","actor":{"username":"sp1d3rs","cleared":true,"url":"/sp1d3rs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/079/690/6853ada3e124bdd8616b1be752223b558de38195_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1973606,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2017-09-03T12:24:17.522Z","updated_at":"2017-09-03T12:24:17.522Z","actor":{"username":"rubikcube","cleared":false,"url":"/rubikcube","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/112/037/07ab876d3c8a79046085764c245ca1793dcf1d57_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":1973619,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2017-09-03T12:32:39.204Z","updated_at":"2017-09-03T12:32:39.204Z","actor":{"username":"sp1d3rs","cleared":true,"url":"/sp1d3rs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/079/690/6853ada3e124bdd8616b1be752223b558de38195_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1973622,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2017-09-03T12:36:46.371Z","updated_at":"2017-09-03T12:49:17.135Z","actor":{"username":"sp1d3rs","cleared":true,"url":"/sp1d3rs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/079/690/6853ada3e124bdd8616b1be752223b558de38195_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1973640,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2017-09-03T12:56:07.086Z","updated_at":"2017-09-03T12:59:06.946Z","actor":{"username":"sp1d3rs","cleared":true,"url":"/sp1d3rs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/079/690/6853ada3e124bdd8616b1be752223b558de38195_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1973834,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2017-09-03T17:20:48.183Z","updated_at":"2017-09-03T17:35:24.503Z","actor":{"username":"sp1d3rs","cleared":true,"url":"/sp1d3rs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/079/690/6853ada3e124bdd8616b1be752223b558de38195_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1979131,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2017-09-06T07:50:55.354Z","updated_at":"2017-09-06T07:50:55.354Z","actor":{"username":"rubikcube","cleared":false,"url":"/rubikcube","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/112/037/07ab876d3c8a79046085764c245ca1793dcf1d57_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":true,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":1988060,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2017-09-11T02:54:01.463Z","updated_at":"2017-09-11T02:54:01.463Z","actor":{"username":"wslack","cleared":false,"url":"/wslack","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/177/495/0f325c9db6586788cf1fd586777192815ef1d496_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1995501,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2017-09-13T21:53:23.082Z","updated_at":"2017-09-13T21:53:23.082Z","actor":{"username":"wslack","cleared":false,"url":"/wslack","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/177/495/0f325c9db6586788cf1fd586777192815ef1d496_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1995509,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2017-09-13T22:09:08.114Z","updated_at":"2017-09-13T22:09:48.316Z","actor":{"username":"sp1d3rs","cleared":true,"url":"/sp1d3rs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/079/690/6853ada3e124bdd8616b1be752223b558de38195_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1995514,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2017-09-13T22:13:54.721Z","updated_at":"2017-09-13T22:13:54.721Z","actor":{"username":"wslack","cleared":false,"url":"/wslack","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/177/495/0f325c9db6586788cf1fd586777192815ef1d496_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1997905,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2017-09-14T20:54:31.895Z","updated_at":"2017-09-14T20:54:31.895Z","additional_data":{},"actor":{"username":"coffeecup","cleared":false,"url":"/coffeecup","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/163/756/b715ab701f6ba35c13cf00277bf23f9ab1a5e1cb_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1999737,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2017-09-15T16:31:14.078Z","updated_at":"2017-09-15T16:32:33.671Z","actor":{"username":"wslack","cleared":false,"url":"/wslack","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/177/495/0f325c9db6586788cf1fd586777192815ef1d496_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"sp1d3rs","url":"/sp1d3rs"},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1999745,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2017-09-15T16:34:13.727Z","updated_at":"2017-09-15T16:34:13.727Z","actor":{"username":"sp1d3rs","cleared":true,"url":"/sp1d3rs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/079/690/6853ada3e124bdd8616b1be752223b558de38195_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2001686,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2017-09-16T22:11:49.392Z","updated_at":"2017-09-16T22:18:08.050Z","actor":{"username":"sp1d3rs","cleared":true,"url":"/sp1d3rs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/079/690/6853ada3e124bdd8616b1be752223b558de38195_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2002765,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-09-18T06:43:00.981Z","updated_at":"2017-09-18T06:43:00.981Z","first_to_agree":true,"actor":{"username":"wslack","cleared":false,"url":"/wslack","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/177/495/0f325c9db6586788cf1fd586777192815ef1d496_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2007752,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2017-09-20T00:24:10.673Z","updated_at":"2017-09-20T00:24:10.673Z","actor":{"username":"wslack","cleared":false,"url":"/wslack","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/177/495/0f325c9db6586788cf1fd586777192815ef1d496_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2007755,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2017-09-20T00:29:51.970Z","updated_at":"2017-09-20T00:29:51.970Z","actor":{"username":"sp1d3rs","cleared":true,"url":"/sp1d3rs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/079/690/6853ada3e124bdd8616b1be752223b558de38195_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2007759,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2017-09-20T00:37:57.777Z","updated_at":"2017-09-20T00:37:57.777Z","actor":{"username":"wslack","cleared":false,"url":"/wslack","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/177/495/0f325c9db6586788cf1fd586777192815ef1d496_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2011384,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2017-09-21T13:31:49.837Z","updated_at":"2017-09-21T13:31:49.837Z","actor":{"username":"sp1d3rs","cleared":true,"url":"/sp1d3rs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/079/690/6853ada3e124bdd8616b1be752223b558de38195_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2024106,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2017-09-26T12:45:23.024Z","updated_at":"2017-09-26T12:45:23.024Z","actor":{"username":"sp1d3rs","cleared":true,"url":"/sp1d3rs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/079/690/6853ada3e124bdd8616b1be752223b558de38195_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2028650,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2017-09-27T23:09:32.050Z","updated_at":"2017-09-27T23:09:32.050Z","actor":{"url":"/tts","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/021/499/a8abb6c9702d454ed2bcfa55bb077ac2e49988b9_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"TTS Bug Bounty"}},"bounty_amount":"300.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"tts","collaborator":{"username":"sp1d3rs","url":"/sp1d3rs"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2028654,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-09-27T23:11:52.480Z","updated_at":"2017-09-27T23:11:52.480Z","actor":{"username":"sp1d3rs","cleared":true,"url":"/sp1d3rs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/079/690/6853ada3e124bdd8616b1be752223b558de38195_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2028655,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-09-27T23:11:52.557Z","updated_at":"2017-09-27T23:11:52.557Z","actor":{"username":"sp1d3rs","cleared":true,"url":"/sp1d3rs","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/079/690/6853ada3e124bdd8616b1be752223b558de38195_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"tts","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":5341,"category":"team","content":"We endorse sp1d3rs's summary! The PR fixing this ticket is here: https://github.com/18F/federalist/pull/1157\n\n","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eWe endorse sp1d3rs\u0026#39;s summary! The PR fixing this ticket is here: \u003ca title=\"https://github.com/18F/federalist/pull/1157\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2F18F%2Ffederalist%2Fpull%2F1157\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/18F/federalist/pull/1157\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n"},{"id":5339,"category":"researcher","content":"*Thanks to the 18F team for the great experience, fast fix, and the bounty!*\n*The report details (i requested the limited disclosure due to lot of sensitive info in the attachments and report itself, and possibility to use a Summary as a kind of structured write-up):*\n\nHello. At the beginning of my work with TTS Bug Bounty program, I noticed, that Federalist API does not have any CSRF protection - but was unable to make proper POC, since data had JSON format, and the Content-Type header was correctly checked.\n\nHowever, I was able to forge valid Content-Type header using flash file now, after reading some articles of other researchers.\n\nI recommend to read this article first to fully understand the issue:\nhttp://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/\nhttp://resources.infosecinstitute.com/bypassing-csrf-protections-fun-profit/#gref\n\nIt means that JSON data without any CSRF protection is not so safe, as supposed to be.\n\n##Why it works\nTo clarify, the SOP/CORS are failing in the case of 307 redirect trick (due to that fact, that during 307 redirect crossdomain.xml on the target host will be called after the POST request for some reason - so POST request will reach the destination), and can only prevent the response reading by the Flash application, but not prevent the CSRF attack itself (it can be the Flash fault, or the way how the browsers are handling 307 redirects of the requests, initialized by Flash applications).\n\nSo it does not actually matter, does Access-Control-Allow-Origin header exist or not on the target host (Flash ignores it), same as crossdomain.xml.\n\nTested HTTP methods on Federalist API:\n\n**GET - CSRF possible**\n**POST - CSRF possible**\nPUT - CSRF not possible\nDELETE - CSRF not possible\n\n##POC\nYou can use live POC *(host was redacted in this Summary due to security reasons 【ツ】)*:\n```\nhttp://[REDACTED]/test.swf?jsonData={\"site\":1,\"branch\":\"master\"}\u0026php_url=http://[REDACTED]/test.php\u0026endpoint=http://localhost:1337/v0/build/\n```\nYou can specify the jsonData (for example, if you need to change siteID param), and endpoint by different Federalist endpoint (in case you are testing not on the localhost)\n\nThis POC will work on the Federalist staging site:\n```\nhttp://[REDACTED]/test.swf?jsonData={\"site\":1,\"branch\":\"master\"}\u0026php_url=http://[REDACTED]/test.php\u0026endpoint=https://federalist.fr.cloud.gov/v0/build\n```\nand this will work on the Federalist production site:\n```\nhttp://[REDACTED]/test.swf?jsonData={\"site\":1,\"branch\":\"master\"}\u0026php_url=http://[REDACTED]/test.php\u0026endpoint=https://federalist.18f.gov/v0/build\n```\nThe only conditions for this:\n1) Flash must be enabled in the browser.\n2) User must be logged in.\n3) User must have access to the site with ID 1.\n\nIn other case, change the payload from\n```\n{\"site\":1,\"branch\":\"master\"}\n```\nto\n```\n{\"site\":[siteID you have access to],\"branch\":\"master\"}\n```\nfor successful testing.\n\n\nThe SWF file will send JSON data to the http://[REDACTED]/test.php, which then will be 307-redirected to the Federalist with correct Content-Type.\n\nThe result will be restarting the build of the site with ID 1 (if exist, and the current user is the owner).\nOn the screen below I did this with site ID 35 on my test instance.\n[SCREENS REMOVED]\n\n\n##Reproduction steps:\nIf you want to reproduce it on your own servers, you need the host, specially crafted SWF file, PHP file with 307 redirect, and crossdomain.xml file (in case PHP and SWF files are not on same-origin). It should also work locally.\nI created GitHub repo to simplify the CSRF testing process:\nhttps://github.com/sp1d3r/swf_json_csrf\n\n\n## Impact\nThe attacker can call any POST API action on behalf of Federalist user, who will visit the specially crafted page with SWF file. The attacker can trigger the build, add the site (if the repository name is known), etc - basically, all possible POST API actions which the user can do. Still, because the attacker does not know private repo names - he can't easily do the worst actions, so this issue has `Medium` impact.\n\n##Suggested fix\nThe fix can actually be the one of (order is determined by safety):\n1) Implementing anti-CSRF tokens protection (header-based). *[This one was chosen as fix]*\n2) Switching the POST method on the API endpoints to the PUT- we can leave GET API endpoints as is, because these endpoints are only informational, and their responses can't be read by the Flash application - so I think we are safe here, and JSON Hijacking is not possible for now (if no bypass will be discovered).\n3) Check the Referer/Origin header - at this moment we can't set arbitrary headers using Flash - so it can be considered as the fix too. \nHowever, due to weird things discovered on regular basis with Flash - all can happen in the future.\n\n##References\n* Special thanks to the [@emgeekboy](https://twitter.com/emgeekboy) and his blogpost: \nhttp://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/\n* https://hackerone.com/reports/44146 by @avlidienbrunn\n* http://www.appsecweekly.com/flash-same-origin-policy-bypass-with-307/\n* http://research.rootme.in/forging-content-type-header-with-flash/\n* http://resources.infosecinstitute.com/bypassing-csrf-protections-fun-profit/#gref\n* https://github.com/sp1d3r/swf_json_csrf - SWF JSON CSRF exploitation tool\n\n","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003e\u003cem\u003eThanks to the 18F team for the great experience, fast fix, and the bounty!\u003c/em\u003e\u003cbr\u003e\n\u003cem\u003eThe report details (i requested the limited disclosure due to lot of sensitive info in the attachments and report itself, and possibility to use a Summary as a kind of structured write-up):\u003c/em\u003e\u003c/p\u003e\n\n\u003cp\u003eHello. At the beginning of my work with TTS Bug Bounty program, I noticed, that Federalist API does not have any CSRF protection - but was unable to make proper POC, since data had JSON format, and the Content-Type header was correctly checked.\u003c/p\u003e\n\n\u003cp\u003eHowever, I was able to forge valid Content-Type header using flash file now, after reading some articles of other researchers.\u003c/p\u003e\n\n\u003cp\u003eI recommend to read this article first to fully understand the issue:\u003cbr\u003e\n\u003ca title=\"http://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/\" href=\"/redirect?url=http%3A%2F%2Fwww.geekboy.ninja%2Fblog%2Fexploiting-json-cross-site-request-forgery-csrf-using-flash%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\n\u003ca title=\"http://resources.infosecinstitute.com/bypassing-csrf-protections-fun-profit/#gref\" href=\"/redirect?url=http%3A%2F%2Fresources.infosecinstitute.com%2Fbypassing-csrf-protections-fun-profit%2F%23gref\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://resources.infosecinstitute.com/bypassing-csrf-protections-fun-profit/#gref\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eIt means that JSON data without any CSRF protection is not so safe, as supposed to be.\u003c/p\u003e\n\n\u003ch2 id=\"why-it-works\"\u003eWhy it works\u003c/h2\u003e\n\n\u003cp\u003eTo clarify, the SOP/CORS are failing in the case of 307 redirect trick (due to that fact, that during 307 redirect crossdomain.xml on the target host will be called after the POST request for some reason - so POST request will reach the destination), and can only prevent the response reading by the Flash application, but not prevent the CSRF attack itself (it can be the Flash fault, or the way how the browsers are handling 307 redirects of the requests, initialized by Flash applications).\u003c/p\u003e\n\n\u003cp\u003eSo it does not actually matter, does Access-Control-Allow-Origin header exist or not on the target host (Flash ignores it), same as crossdomain.xml.\u003c/p\u003e\n\n\u003cp\u003eTested HTTP methods on Federalist API:\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eGET - CSRF possible\u003c/strong\u003e\u003cbr\u003e\n\u003cstrong\u003ePOST - CSRF possible\u003c/strong\u003e\u003cbr\u003e\nPUT - CSRF not possible\u003cbr\u003e\nDELETE - CSRF not possible\u003c/p\u003e\n\n\u003ch2 id=\"poc\"\u003ePOC\u003c/h2\u003e\n\n\u003cp\u003eYou can use live POC \u003cem\u003e(host was redacted in this Summary due to security reasons 【ツ】)\u003c/em\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ehttp://[REDACTED]/test.swf?jsonData={\u0026quot;site\u0026quot;:1,\u0026quot;branch\u0026quot;:\u0026quot;master\u0026quot;}\u0026amp;php_url=http://[REDACTED]/test.php\u0026amp;endpoint=http://localhost:1337/v0/build/\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eYou can specify the jsonData (for example, if you need to change siteID param), and endpoint by different Federalist endpoint (in case you are testing not on the localhost)\u003c/p\u003e\n\n\u003cp\u003eThis POC will work on the Federalist staging site:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ehttp://[REDACTED]/test.swf?jsonData={\u0026quot;site\u0026quot;:1,\u0026quot;branch\u0026quot;:\u0026quot;master\u0026quot;}\u0026amp;php_url=http://[REDACTED]/test.php\u0026amp;endpoint=https://federalist.fr.cloud.gov/v0/build\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eand this will work on the Federalist production site:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ehttp://[REDACTED]/test.swf?jsonData={\u0026quot;site\u0026quot;:1,\u0026quot;branch\u0026quot;:\u0026quot;master\u0026quot;}\u0026amp;php_url=http://[REDACTED]/test.php\u0026amp;endpoint=https://federalist.18f.gov/v0/build\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThe only conditions for this:\u003cbr\u003e\n1) Flash must be enabled in the browser.\u003cbr\u003e\n2) User must be logged in.\u003cbr\u003e\n3) User must have access to the site with ID 1.\u003c/p\u003e\n\n\u003cp\u003eIn other case, change the payload from\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e{\u0026quot;site\u0026quot;:1,\u0026quot;branch\u0026quot;:\u0026quot;master\u0026quot;}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eto\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e{\u0026quot;site\u0026quot;:[siteID you have access to],\u0026quot;branch\u0026quot;:\u0026quot;master\u0026quot;}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003efor successful testing.\u003c/p\u003e\n\n\u003cp\u003eThe SWF file will send JSON data to the http://[REDACTED]/test.php, which then will be 307-redirected to the Federalist with correct Content-Type.\u003c/p\u003e\n\n\u003cp\u003eThe result will be restarting the build of the site with ID 1 (if exist, and the current user is the owner).\u003cbr\u003e\nOn the screen below I did this with site ID 35 on my test instance.\u003cbr\u003e\n[SCREENS REMOVED]\u003c/p\u003e\n\n\u003ch2 id=\"reproduction-steps\"\u003eReproduction steps:\u003c/h2\u003e\n\n\u003cp\u003eIf you want to reproduce it on your own servers, you need the host, specially crafted SWF file, PHP file with 307 redirect, and crossdomain.xml file (in case PHP and SWF files are not on same-origin). It should also work locally.\u003cbr\u003e\nI created GitHub repo to simplify the CSRF testing process:\u003cbr\u003e\n\u003ca title=\"https://github.com/sp1d3r/swf_json_csrf\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fsp1d3r%2Fswf_json_csrf\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/sp1d3r/swf_json_csrf\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eThe attacker can call any POST API action on behalf of Federalist user, who will visit the specially crafted page with SWF file. The attacker can trigger the build, add the site (if the repository name is known), etc - basically, all possible POST API actions which the user can do. Still, because the attacker does not know private repo names - he can\u0026#39;t easily do the worst actions, so this issue has \u003ccode\u003eMedium\u003c/code\u003e impact.\u003c/p\u003e\n\n\u003ch2 id=\"suggested-fix\"\u003eSuggested fix\u003c/h2\u003e\n\n\u003cp\u003eThe fix can actually be the one of (order is determined by safety):\u003cbr\u003e\n1) Implementing anti-CSRF tokens protection (header-based). \u003cem\u003e[This one was chosen as fix]\u003c/em\u003e\u003cbr\u003e\n2) Switching the POST method on the API endpoints to the PUT- we can leave GET API endpoints as is, because these endpoints are only informational, and their responses can\u0026#39;t be read by the Flash application - so I think we are safe here, and JSON Hijacking is not possible for now (if no bypass will be discovered).\u003cbr\u003e\n3) Check the Referer/Origin header - at this moment we can\u0026#39;t set arbitrary headers using Flash - so it can be considered as the fix too. \u003cbr\u003e\nHowever, due to weird things discovered on regular basis with Flash - all can happen in the future.\u003c/p\u003e\n\n\u003ch2 id=\"references\"\u003eReferences\u003c/h2\u003e\n\n\u003cul\u003e\n\u003cli\u003eSpecial thanks to the \u003ca href=\"/redirect?url=https%3A%2F%2Ftwitter.com%2Femgeekboy\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003e@emgeekboy\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e and his blogpost: \n\u003ca title=\"http://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/\" href=\"/redirect?url=http%3A%2F%2Fwww.geekboy.ninja%2Fblog%2Fexploiting-json-cross-site-request-forgery-csrf-using-flash%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca title=\"https://hackerone.com/reports/44146\" href=\"https://hackerone.com/reports/44146\"\u003ehttps://hackerone.com/reports/44146\u003c/a\u003e by \u003ca href=\"/avlidienbrunn\"\u003e@avlidienbrunn\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003ca title=\"http://www.appsecweekly.com/flash-same-origin-policy-bypass-with-307/\" href=\"/redirect?url=http%3A%2F%2Fwww.appsecweekly.com%2Fflash-same-origin-policy-bypass-with-307%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://www.appsecweekly.com/flash-same-origin-policy-bypass-with-307/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca title=\"http://research.rootme.in/forging-content-type-header-with-flash/\" href=\"/redirect?url=http%3A%2F%2Fresearch.rootme.in%2Fforging-content-type-header-with-flash%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://research.rootme.in/forging-content-type-header-with-flash/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca title=\"http://resources.infosecinstitute.com/bypassing-csrf-protections-fun-profit/#gref\" href=\"/redirect?url=http%3A%2F%2Fresources.infosecinstitute.com%2Fbypassing-csrf-protections-fun-profit%2F%23gref\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://resources.infosecinstitute.com/bypassing-csrf-protections-fun-profit/#gref\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\n\u003ca title=\"https://github.com/sp1d3r/swf_json_csrf\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fsp1d3r%2Fswf_json_csrf\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/sp1d3r/swf_json_csrf\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e - SWF JSON CSRF exploitation tool\u003c/li\u003e\n\u003c/ul\u003e\n"}]}