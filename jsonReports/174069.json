{"id":174069,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNzQwNjk=","url":"https://hackerone.com/reports/174069","title":"Buffer overflow in HTTP parse_hostinfo(), parse_userinfo() and parse_scheme()","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2016-10-05T12:08:41.367Z","submitted_at":"2016-10-05T12:08:41.367Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"rc0r","url":"/rc0r","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/017/153/304e6c45c12b1b9dec0c6c0f2ebd67341d234566_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":29,"url":"https://hackerone.com/ibb-php","handle":"ibb-php","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/029/99087dbbdf52fc3ce3acbf16aa33a5c4f5e2c111_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/029/99087dbbdf52fc3ce3acbf16aa33a5c4f5e2c111_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"paused","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"PHP (IBB)","twitter_handle":"","website":"http://www.php.net","about":""}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-05-30T15:13:49.305Z","bug_reporter_agreed_on_going_public_at":"2017-05-06T08:21:38.003Z","team_member_agreed_on_going_public_at":"2017-05-30T15:13:49.241Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Since the original report is still marked as private in the PHP bug tracker please find the copy \u0026 pasted bug report below (edited for readability and to include correct bug tracker id). See the references section for a link to the issue in the PHP bug tracker!\n\nThe maintainer already fixed the issue in the public git repo using the proposed patch included in the original report. Fixed versions 3.1.0RC1 and 2.6.0RC1 of the pecl-http extension have been released as well.\n\nMitre assigned **CVE-2016-7961** for this issue.\n\n# Description\n\nThe parsing functions of the PECL HTTP extension allow overflowing a buffer with data originating from an arbitrary HTTP request. Affected are the `parse_hostinfo()`, `parse_userinfo()` and `parse_scheme()` functions in `php_http_url.c` that may get called when instantiating/initializing an HTTP message object. The problem occurs because in the main processing loop `char *ptr` may get incremented past the corresponding end pointer `char *end` used as the end marker. Thus the parser loop may continue to execute and buffer `state-\u003ebuffer` may overflow.  \n\nRelevant code snippet from `php_http_url.c:1096`:\n\n```c\nstatic ZEND_RESULT_CODE parse_hostinfo(struct parse_state *state, const char *ptr)\n{\n[...]\n    if (ptr != end) do {\n        switch (*ptr) {\n            [...]\n            case '0': case '1': case '2': case '3': case '4': case '5': case '6':\n            case '7': case '8': case '9':\n                /* allowed */\n                if (port) {\n                    state-\u003eurl.port *= 10;\n                    state-\u003eurl.port += *ptr - '0';\n                } else {\n                    label = ptr;\n                    state-\u003ebuffer[state-\u003eoffset++] = *ptr;\n                }\n                break;\n            [...]\n            default:\n            [...]\n                } else if (!(mb = parse_mb(state, PARSE_HOSTINFO, ptr, end, tmp, state-\u003eflags \u0026 PHP_HTTP_URL_SILENT_ERRORS))) {\n                    if (!(state-\u003eflags \u0026 PHP_HTTP_URL_IGNORE_ERRORS)) {\n                        return FAILURE;\n                    }\n                    break;\n                }\n                label = ptr;\n                ptr += mb - 1;  // ptr increased here as in various other locations\n        }\n    } while (++ptr != end);     // ptr pre-incremented -\u003e check condition may be missed!\n[...]\n```\n\n# Security impact and PoC\n\nSince this bug allows to overwrite quite large parts of memory arbitrary code execution seems very likely. In [1] you'll find a malformed HTTP request that demonstrates the issue:\n\n```php\n$ cat http_message_parse.php\n/*\n        http_message_parse.php\n        bug73185.bin\n        http://hlt99.blinkenshell.org/php/bug73185.bin\n*/\n\u003c?php\n    $http_msg = new http\\Message(file_get_contents(\"bug73185.bin\"), false);\n?\u003e\n```\n\n```\n$ ./configure --enable-raphf --enable-propro --with-http \u0026\u0026 make\n$ gdb ./sapi/cli/php\ngdb\u003e r http_message_parse.php\n[...]\nFatal error: Uncaught http\\Exception\\BadMessageException: http\\Message::__construct(): Could not parse HTTP protocol version 'HTTP/1.rdrd-vvv5:##HT\n[...] // garbled output\n85:#~t? HTT in http_message_parse.php on line 7\n\nProgram received signal SIGSEGV, Segmentation fault.\n0x00000000006d6ef3 in _php_stream_free (stream=\u003coptimized out\u003e, close_options=11)\n    at /home/rc0r/tmp/php-src/main/streams/streams.c:467\n467\t\t\tret = stream-\u003eops-\u003eclose(stream, preserve_handle ? 0 : 1);\ngdb\u003e i r\nrax            0x4142434445464748\t4702394921427289928\nrbx            0xb\t11\nrcx            0x1\t1\nrdx            0x0\t0\nrsi            0x1\t1\nrdi            0x7ffff42ad300\t140737289835264\nrbp            0x7ffff42ad300\t0x7ffff42ad300\nrsp            0x7fffffffb150\t0x7fffffffb150\nr8             0x0\t0\nr9             0x1\t1\nr10            0x3d3\t979\nr11            0x7ffff58ad760\t140737312905056\nr12            0x0\t0\nr13            0x1\t1\nr14            0x0\t0\nr15            0x0\t0\nrip            0x6d6ef3\t0x6d6ef3 \u003c_php_stream_free+307\u003e\neflags         0x10202\t[ IF RF ]\ncs             0x33\t51\nss             0x2b\t43\nds             0x0\t0\nes             0x0\t0\nfs             0x0\t0\ngs             0x0\t0\ngdb\u003e x/i $rip\n=\u003e 0x6d6ef3 \u003c_php_stream_free+307\u003e:\tcallq  *0x10(%rax)\n```\n\nThe attempt to parse the supplied HTTP request fails at some point and used resources are freed by the extension. It was possible to overwrite a `php_stream` structure including its pointer to a `php_stream_ops` structure containing function pointers that are about to be called from within `_php_stream_free()` as shown above. Register `rax` contains data from the malformed HTTP request starting at offset 0x2139. \n\n[1] http://hlt99.blinkenshell.org/php/005-bug73185.bin\n\n# Patch\n\nAfter careful review by the project maintainers the following patch may be used to fix the reported issue.  \n\n```c\nFrom ec2d2e1648127b2a0bb15f10144daca59bc6f03c Mon Sep 17 00:00:00 2001\nFrom: rc0r \u003chlt99@blinkenshell.org\u003e\nDate: Mon, 26 Sep 2016 21:34:29 +0200\nSubject: [PATCH] Buffer overflow in parse_hostinfo() fixed\n\n---\n src/php_http_url.c | 4 ++--\n 1 file changed, 2 insertions(+), 2 deletions(-)\n\ndiff --git a/src/php_http_url.c b/src/php_http_url.c\nindex 2332fb5..70e4c2c 100644\n--- a/src/php_http_url.c\n+++ b/src/php_http_url.c\n@@ -1107,7 +1107,7 @@ static ZEND_RESULT_CODE parse_hostinfo(struct parse_state *state, const char *pt\n    }\n #endif\n \n-\tif (ptr != end) do {\n+\tif (ptr \u003c end) do {\n        switch (*ptr) {\n        case ':':\n            if (port) {\n@@ -1235,7 +1235,7 @@ static ZEND_RESULT_CODE parse_hostinfo(struct parse_state *state, const char *pt\n            label = ptr;\n            ptr += mb - 1;\n        }\n-\t} while (++ptr != end);\n+\t} while (++ptr \u003c end);\n \n    if (!state-\u003eurl.host) {\n        len = state-\u003eoffset - len;\n-- \n2.10.0\n```\n\n# Versions known to be affected\n\npecl-http extension versions up to and including:\n\n* 3.1.0beta2 (PHP 7)\n* 2.6.0beta2 (PHP 5)\n\n# Timeline\n\n2016-09-27  Initial report to PHP bug tracker (#73185)\n2016-10-04  Issue fixed in git repository, CVE requested\n2016-10-04  Maintainer released fixed pecl-http extensions 3.1.0RC1 and 2.6.0RC1\n2016-10-05  Mitre assigned CVE-2016-7961\n\n# References\n\nhttps://bugs.php.net/bug.php?id=73185\nhttps://github.com/m6w6/ext-http/commit/e096f45ff30a46d6a8e96da7bc6334d2ac5ab7c2\n\nhttps://pecl.php.net/package/pecl_http/3.1.0RC1\nhttps://pecl.php.net/package/pecl_http/2.6.0RC1\n\nhttp://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-7961","vulnerability_information_html":"\u003cp\u003eSince the original report is still marked as private in the PHP bug tracker please find the copy \u0026amp; pasted bug report below (edited for readability and to include correct bug tracker id). See the references section for a link to the issue in the PHP bug tracker!\u003c/p\u003e\n\n\u003cp\u003eThe maintainer already fixed the issue in the public git repo using the proposed patch included in the original report. Fixed versions 3.1.0RC1 and 2.6.0RC1 of the pecl-http extension have been released as well.\u003c/p\u003e\n\n\u003cp\u003eMitre assigned \u003cstrong\u003eCVE-2016-7961\u003c/strong\u003e for this issue.\u003c/p\u003e\n\n\u003ch1 id=\"description\"\u003eDescription\u003c/h1\u003e\n\n\u003cp\u003eThe parsing functions of the PECL HTTP extension allow overflowing a buffer with data originating from an arbitrary HTTP request. Affected are the \u003ccode\u003eparse_hostinfo()\u003c/code\u003e, \u003ccode\u003eparse_userinfo()\u003c/code\u003e and \u003ccode\u003eparse_scheme()\u003c/code\u003e functions in \u003ccode\u003ephp_http_url.c\u003c/code\u003e that may get called when instantiating/initializing an HTTP message object. The problem occurs because in the main processing loop \u003ccode\u003echar *ptr\u003c/code\u003e may get incremented past the corresponding end pointer \u003ccode\u003echar *end\u003c/code\u003e used as the end marker. Thus the parser loop may continue to execute and buffer \u003ccode\u003estate-\u0026gt;buffer\u003c/code\u003e may overflow.  \u003c/p\u003e\n\n\u003cp\u003eRelevant code snippet from \u003ccode\u003ephp_http_url.c:1096\u003c/code\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight c\"\u003e\u003ccode\u003e\u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"n\"\u003eZEND_RESULT_CODE\u003c/span\u003e \u003cspan class=\"nf\"\u003eparse_hostinfo\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003estruct\u003c/span\u003e \u003cspan class=\"n\"\u003eparse_state\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"n\"\u003estate\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003econst\u003c/span\u003e \u003cspan class=\"kt\"\u003echar\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"n\"\u003eptr\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003cspan class=\"p\"\u003e[...]\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eptr\u003c/span\u003e \u003cspan class=\"o\"\u003e!=\u003c/span\u003e \u003cspan class=\"n\"\u003eend\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eswitch\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"n\"\u003eptr\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e[...]\u003c/span\u003e\n            \u003cspan class=\"k\"\u003ecase\u003c/span\u003e \u003cspan class=\"sc\"\u003e\u0026#39;0\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"k\"\u003ecase\u003c/span\u003e \u003cspan class=\"sc\"\u003e\u0026#39;1\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"k\"\u003ecase\u003c/span\u003e \u003cspan class=\"sc\"\u003e\u0026#39;2\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"k\"\u003ecase\u003c/span\u003e \u003cspan class=\"sc\"\u003e\u0026#39;3\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"k\"\u003ecase\u003c/span\u003e \u003cspan class=\"sc\"\u003e\u0026#39;4\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"k\"\u003ecase\u003c/span\u003e \u003cspan class=\"sc\"\u003e\u0026#39;5\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"k\"\u003ecase\u003c/span\u003e \u003cspan class=\"sc\"\u003e\u0026#39;6\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n            \u003cspan class=\"k\"\u003ecase\u003c/span\u003e \u003cspan class=\"sc\"\u003e\u0026#39;7\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"k\"\u003ecase\u003c/span\u003e \u003cspan class=\"sc\"\u003e\u0026#39;8\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"k\"\u003ecase\u003c/span\u003e \u003cspan class=\"sc\"\u003e\u0026#39;9\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n                \u003cspan class=\"cm\"\u003e/* allowed */\u003c/span\u003e\n                \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eport\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                    \u003cspan class=\"n\"\u003estate\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"n\"\u003eurl\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eport\u003c/span\u003e \u003cspan class=\"o\"\u003e*=\u003c/span\u003e \u003cspan class=\"mi\"\u003e10\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                    \u003cspan class=\"n\"\u003estate\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"n\"\u003eurl\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eport\u003c/span\u003e \u003cspan class=\"o\"\u003e+=\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"n\"\u003eptr\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e \u003cspan class=\"sc\"\u003e\u0026#39;0\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e}\u003c/span\u003e \u003cspan class=\"k\"\u003eelse\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                    \u003cspan class=\"n\"\u003elabel\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eptr\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                    \u003cspan class=\"n\"\u003estate\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"n\"\u003ebuffer\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003estate\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"n\"\u003eoffset\u003c/span\u003e\u003cspan class=\"o\"\u003e++\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"n\"\u003eptr\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n                \u003cspan class=\"k\"\u003ebreak\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e[...]\u003c/span\u003e\n            \u003cspan class=\"nl\"\u003edefault:\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e[...]\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e}\u003c/span\u003e \u003cspan class=\"k\"\u003eelse\u003c/span\u003e \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"o\"\u003e!\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003emb\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eparse_mb\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003estate\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ePARSE_HOSTINFO\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eptr\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eend\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003etmp\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003estate\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"n\"\u003eflags\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026amp;\u003c/span\u003e \u003cspan class=\"n\"\u003ePHP_HTTP_URL_SILENT_ERRORS\u003c/span\u003e\u003cspan class=\"p\"\u003e)))\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"o\"\u003e!\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003estate\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"n\"\u003eflags\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026amp;\u003c/span\u003e \u003cspan class=\"n\"\u003ePHP_HTTP_URL_IGNORE_ERRORS\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003eFAILURE\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n                    \u003cspan class=\"k\"\u003ebreak\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n                \u003cspan class=\"n\"\u003elabel\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eptr\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n                \u003cspan class=\"n\"\u003eptr\u003c/span\u003e \u003cspan class=\"o\"\u003e+=\u003c/span\u003e \u003cspan class=\"n\"\u003emb\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e \u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e  \u003cspan class=\"c1\"\u003e// ptr increased here as in various other locations\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e \u003cspan class=\"k\"\u003ewhile\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"o\"\u003e++\u003c/span\u003e\u003cspan class=\"n\"\u003eptr\u003c/span\u003e \u003cspan class=\"o\"\u003e!=\u003c/span\u003e \u003cspan class=\"n\"\u003eend\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e     \u003cspan class=\"c1\"\u003e// ptr pre-incremented -\u0026gt; check condition may be missed!\u003c/span\u003e\n\u003cspan class=\"p\"\u003e[...]\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch1 id=\"security-impact-and-poc\"\u003eSecurity impact and PoC\u003c/h1\u003e\n\n\u003cp\u003eSince this bug allows to overwrite quite large parts of memory arbitrary code execution seems very likely. In [1] you\u0026#39;ll find a malformed HTTP request that demonstrates the issue:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight php\"\u003e\u003ccode\u003e\u003cspan class=\"err\"\u003e$\u003c/span\u003e \u003cspan class=\"nx\"\u003ecat\u003c/span\u003e \u003cspan class=\"nx\"\u003ehttp_message_parse\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ephp\u003c/span\u003e\n\u003cspan class=\"cm\"\u003e/*\n        http_message_parse.php\n        bug73185.bin\n        http://hlt99.blinkenshell.org/php/bug73185.bin\n*/\u003c/span\u003e\n\u003cspan class=\"o\"\u003e\u0026lt;?\u003c/span\u003e\u003cspan class=\"nx\"\u003ephp\u003c/span\u003e\n    \u003cspan class=\"nv\"\u003e$http_msg\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nx\"\u003ehttp\\Message\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nb\"\u003efile_get_contents\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026quot;bug73185.bin\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e \u003cspan class=\"kc\"\u003efalse\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"cp\"\u003e?\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e$ ./configure --enable-raphf --enable-propro --with-http \u0026amp;\u0026amp; make\n$ gdb ./sapi/cli/php\ngdb\u0026gt; r http_message_parse.php\n[...]\nFatal error: Uncaught http\\Exception\\BadMessageException: http\\Message::__construct(): Could not parse HTTP protocol version \u0026#39;HTTP/1.rdrd-vvv5:##HT\n[...] // garbled output\n85:#~t? HTT in http_message_parse.php on line 7\n\nProgram received signal SIGSEGV, Segmentation fault.\n0x00000000006d6ef3 in _php_stream_free (stream=\u0026lt;optimized out\u0026gt;, close_options=11)\n    at /home/rc0r/tmp/php-src/main/streams/streams.c:467\n467         ret = stream-\u0026gt;ops-\u0026gt;close(stream, preserve_handle ? 0 : 1);\ngdb\u0026gt; i r\nrax            0x4142434445464748   4702394921427289928\nrbx            0xb  11\nrcx            0x1  1\nrdx            0x0  0\nrsi            0x1  1\nrdi            0x7ffff42ad300   140737289835264\nrbp            0x7ffff42ad300   0x7ffff42ad300\nrsp            0x7fffffffb150   0x7fffffffb150\nr8             0x0  0\nr9             0x1  1\nr10            0x3d3    979\nr11            0x7ffff58ad760   140737312905056\nr12            0x0  0\nr13            0x1  1\nr14            0x0  0\nr15            0x0  0\nrip            0x6d6ef3 0x6d6ef3 \u0026lt;_php_stream_free+307\u0026gt;\neflags         0x10202  [ IF RF ]\ncs             0x33 51\nss             0x2b 43\nds             0x0  0\nes             0x0  0\nfs             0x0  0\ngs             0x0  0\ngdb\u0026gt; x/i $rip\n=\u0026gt; 0x6d6ef3 \u0026lt;_php_stream_free+307\u0026gt;: callq  *0x10(%rax)\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThe attempt to parse the supplied HTTP request fails at some point and used resources are freed by the extension. It was possible to overwrite a \u003ccode\u003ephp_stream\u003c/code\u003e structure including its pointer to a \u003ccode\u003ephp_stream_ops\u003c/code\u003e structure containing function pointers that are about to be called from within \u003ccode\u003e_php_stream_free()\u003c/code\u003e as shown above. Register \u003ccode\u003erax\u003c/code\u003e contains data from the malformed HTTP request starting at offset 0x2139. \u003c/p\u003e\n\n\u003cp\u003e[1] \u003ca title=\"http://hlt99.blinkenshell.org/php/005-bug73185.bin\" href=\"/redirect?url=http%3A%2F%2Fhlt99.blinkenshell.org%2Fphp%2F005-bug73185.bin\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://hlt99.blinkenshell.org/php/005-bug73185.bin\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch1 id=\"patch\"\u003ePatch\u003c/h1\u003e\n\n\u003cp\u003eAfter careful review by the project maintainers the following patch may be used to fix the reported issue.  \u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight c\"\u003e\u003ccode\u003e\u003cspan class=\"n\"\u003eFrom\u003c/span\u003e \u003cspan class=\"n\"\u003eec2d2e1648127b2a0bb15f10144daca59bc6f03c\u003c/span\u003e \u003cspan class=\"n\"\u003eMon\u003c/span\u003e \u003cspan class=\"n\"\u003eSep\u003c/span\u003e \u003cspan class=\"mi\"\u003e17\u003c/span\u003e \u003cspan class=\"mo\"\u003e00\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"mo\"\u003e00\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"mo\"\u003e00\u003c/span\u003e \u003cspan class=\"mi\"\u003e2001\u003c/span\u003e\n\u003cspan class=\"n\"\u003eFrom\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003erc0r\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003ehlt99\u003c/span\u003e\u003cspan class=\"err\"\u003e@\u003c/span\u003e\u003cspan class=\"n\"\u003eblinkenshell\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eorg\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"n\"\u003eDate\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eMon\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e26\u003c/span\u003e \u003cspan class=\"n\"\u003eSep\u003c/span\u003e \u003cspan class=\"mi\"\u003e2016\u003c/span\u003e \u003cspan class=\"mi\"\u003e21\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"mi\"\u003e34\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"mi\"\u003e29\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e\u003cspan class=\"mo\"\u003e0200\u003c/span\u003e\n\u003cspan class=\"n\"\u003eSubject\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003ePATCH\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"n\"\u003eBuffer\u003c/span\u003e \u003cspan class=\"n\"\u003eoverflow\u003c/span\u003e \u003cspan class=\"n\"\u003ein\u003c/span\u003e \u003cspan class=\"nf\"\u003eparse_hostinfo\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"n\"\u003efixed\u003c/span\u003e\n\n\u003cspan class=\"o\"\u003e---\u003c/span\u003e\n \u003cspan class=\"n\"\u003esrc\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"n\"\u003ephp_http_url\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ec\u003c/span\u003e \u003cspan class=\"o\"\u003e|\u003c/span\u003e \u003cspan class=\"mi\"\u003e4\u003c/span\u003e \u003cspan class=\"o\"\u003e++--\u003c/span\u003e\n \u003cspan class=\"mi\"\u003e1\u003c/span\u003e \u003cspan class=\"n\"\u003efile\u003c/span\u003e \u003cspan class=\"n\"\u003echanged\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e2\u003c/span\u003e \u003cspan class=\"n\"\u003einsertions\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"o\"\u003e+\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e \u003cspan class=\"mi\"\u003e2\u003c/span\u003e \u003cspan class=\"n\"\u003edeletions\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"n\"\u003ediff\u003c/span\u003e \u003cspan class=\"o\"\u003e--\u003c/span\u003e\u003cspan class=\"n\"\u003egit\u003c/span\u003e \u003cspan class=\"n\"\u003ea\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"n\"\u003esrc\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"n\"\u003ephp_http_url\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ec\u003c/span\u003e \u003cspan class=\"n\"\u003eb\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"n\"\u003esrc\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"n\"\u003ephp_http_url\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ec\u003c/span\u003e\n\u003cspan class=\"n\"\u003eindex\u003c/span\u003e \u003cspan class=\"mi\"\u003e2332\u003c/span\u003e\u003cspan class=\"n\"\u003efb5\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"mf\"\u003e.70e4\u003c/span\u003e\u003cspan class=\"n\"\u003ec2c\u003c/span\u003e \u003cspan class=\"mi\"\u003e100644\u003c/span\u003e\n\u003cspan class=\"o\"\u003e---\u003c/span\u003e \u003cspan class=\"n\"\u003ea\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"n\"\u003esrc\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"n\"\u003ephp_http_url\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ec\u003c/span\u003e\n\u003cspan class=\"o\"\u003e+++\u003c/span\u003e \u003cspan class=\"n\"\u003eb\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"n\"\u003esrc\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"n\"\u003ephp_http_url\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ec\u003c/span\u003e\n\u003cspan class=\"err\"\u003e@@\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"mi\"\u003e1107\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"mi\"\u003e7\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e\u003cspan class=\"mi\"\u003e1107\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"mi\"\u003e7\u003c/span\u003e \u003cspan class=\"err\"\u003e@@\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"n\"\u003eZEND_RESULT_CODE\u003c/span\u003e \u003cspan class=\"n\"\u003eparse_hostinfo\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003estruct\u003c/span\u003e \u003cspan class=\"n\"\u003eparse_state\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"n\"\u003estate\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003econst\u003c/span\u003e \u003cspan class=\"kt\"\u003echar\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"n\"\u003ept\u003c/span\u003e\n    \u003cspan class=\"err\"\u003e}\u003c/span\u003e\n \u003cspan class=\"cp\"\u003e#endif\n\u003c/span\u003e\n\u003cspan class=\"o\"\u003e-\u003c/span\u003e   \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eptr\u003c/span\u003e \u003cspan class=\"o\"\u003e!=\u003c/span\u003e \u003cspan class=\"n\"\u003eend\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003cspan class=\"o\"\u003e+\u003c/span\u003e   \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eptr\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"n\"\u003eend\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eswitch\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"n\"\u003eptr\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"k\"\u003ecase\u003c/span\u003e \u003cspan class=\"sc\"\u003e\u0026#39;:\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eport\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003cspan class=\"err\"\u003e@@\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"mi\"\u003e1235\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"mi\"\u003e7\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e\u003cspan class=\"mi\"\u003e1235\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"mi\"\u003e7\u003c/span\u003e \u003cspan class=\"err\"\u003e@@\u003c/span\u003e \u003cspan class=\"k\"\u003estatic\u003c/span\u003e \u003cspan class=\"n\"\u003eZEND_RESULT_CODE\u003c/span\u003e \u003cspan class=\"n\"\u003eparse_hostinfo\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003estruct\u003c/span\u003e \u003cspan class=\"n\"\u003eparse_state\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"n\"\u003estate\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003econst\u003c/span\u003e \u003cspan class=\"kt\"\u003echar\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"n\"\u003ept\u003c/span\u003e\n            \u003cspan class=\"n\"\u003elabel\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eptr\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"n\"\u003eptr\u003c/span\u003e \u003cspan class=\"o\"\u003e+=\u003c/span\u003e \u003cspan class=\"n\"\u003emb\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e \u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"o\"\u003e-\u003c/span\u003e   \u003cspan class=\"p\"\u003e}\u003c/span\u003e \u003cspan class=\"k\"\u003ewhile\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"o\"\u003e++\u003c/span\u003e\u003cspan class=\"n\"\u003eptr\u003c/span\u003e \u003cspan class=\"o\"\u003e!=\u003c/span\u003e \u003cspan class=\"n\"\u003eend\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"o\"\u003e+\u003c/span\u003e   \u003cspan class=\"err\"\u003e}\u003c/span\u003e \u003cspan class=\"k\"\u003ewhile\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"o\"\u003e++\u003c/span\u003e\u003cspan class=\"n\"\u003eptr\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"n\"\u003eend\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"o\"\u003e!\u003c/span\u003e\u003cspan class=\"n\"\u003estate\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"n\"\u003eurl\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ehost\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"n\"\u003elen\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003estate\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"n\"\u003eoffset\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e \u003cspan class=\"n\"\u003elen\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"o\"\u003e--\u003c/span\u003e \n\u003cspan class=\"mi\"\u003e2\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"mi\"\u003e10\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"mi\"\u003e0\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch1 id=\"versions-known-to-be-affected\"\u003eVersions known to be affected\u003c/h1\u003e\n\n\u003cp\u003epecl-http extension versions up to and including:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e3.1.0beta2 (PHP 7)\u003c/li\u003e\n\u003cli\u003e2.6.0beta2 (PHP 5)\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch1 id=\"timeline\"\u003eTimeline\u003c/h1\u003e\n\n\u003cp\u003e2016-09-27  Initial report to PHP bug tracker (#73185)\u003cbr\u003e\n2016-10-04  Issue fixed in git repository, CVE requested\u003cbr\u003e\n2016-10-04  Maintainer released fixed pecl-http extensions 3.1.0RC1 and 2.6.0RC1\u003cbr\u003e\n2016-10-05  Mitre assigned CVE-2016-7961\u003c/p\u003e\n\n\u003ch1 id=\"references\"\u003eReferences\u003c/h1\u003e\n\n\u003cp\u003e\u003ca title=\"https://bugs.php.net/bug.php?id=73185\" href=\"/redirect?url=https%3A%2F%2Fbugs.php.net%2Fbug.php%3Fid%3D73185\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://bugs.php.net/bug.php?id=73185\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\n\u003ca title=\"https://github.com/m6w6/ext-http/commit/e096f45ff30a46d6a8e96da7bc6334d2ac5ab7c2\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fm6w6%2Fext-http%2Fcommit%2Fe096f45ff30a46d6a8e96da7bc6334d2ac5ab7c2\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/m6w6/ext-http/commit/e096f45ff30a46d6a8e96da7bc6334d2ac5ab7c2\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"https://pecl.php.net/package/pecl_http/3.1.0RC1\" href=\"/redirect?url=https%3A%2F%2Fpecl.php.net%2Fpackage%2Fpecl_http%2F3.1.0RC1\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://pecl.php.net/package/pecl_http/3.1.0RC1\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\n\u003ca title=\"https://pecl.php.net/package/pecl_http/2.6.0RC1\" href=\"/redirect?url=https%3A%2F%2Fpecl.php.net%2Fpackage%2Fpecl_http%2F2.6.0RC1\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://pecl.php.net/package/pecl_http/2.6.0RC1\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-7961\" href=\"/redirect?url=http%3A%2F%2Fcve.mitre.org%2Fcgi-bin%2Fcvename.cgi%3Fname%3DCVE-2016-7961\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-7961\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","bounty_amount":"1000.0","formatted_bounty":"$1,000","weakness":{"id":2,"name":"Memory Corruption - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2017-06-05T08:21:38.049Z","allow_singular_disclosure_after":-112566034.0606939,"singular_disclosure_allowed":true,"vote_count":3,"voters":["eveeez","0xspade","spetr0x"],"severity":{"rating":"medium","author_type":"Team"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1339066,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Thanks @rc0r! Sorry for the delay, and thanks for the patience. The IBB typically doesn't cover non-bundled extensions but this pecl_http likely warrants an exception. Is there a reason why the original bug report is still private? Has this been cleared for public release?","markdown_message":"\u003cp\u003eThanks \u003ca href=\"/rc0r\"\u003e@rc0r\u003c/a\u003e! Sorry for the delay, and thanks for the patience. The IBB typically doesn\u0026#39;t cover non-bundled extensions but this pecl_http likely warrants an exception. Is there a reason why the original bug report is still private? Has this been cleared for public release?\u003c/p\u003e\n","automated_response":false,"created_at":"2016-12-03T20:54:08.805Z","updated_at":"2016-12-03T20:55:46.387Z","actor":{"username":"arice","cleared":false,"url":"/arice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/83152cb2d070f3f6a63c1b61bae47257722b5ad2_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"ibb-php","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1339190,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Michael Wallner (mike@php.net) already fixed this issue and released a fixed version of the pecl_http extension version 3.1.0RC1 / 2.6.0RC1 respective. However neither him nor I do have the proper permissions on the PHP bug tracker to mark the report public. He already tried to degrade it to non-security (which is not the right thing) but this didn't make the bug public. I sent an email regarding this issue to johannes@php.net but never received an answer. I could try to mail another core dev of the PHP project to resolve this issue. Please let me know, if you want me to try to resolve the bug tracker issue by contacting another core dev!\n\nFrom my POV this issue can be publicly disclosed since it has been fixed and follow-up releases of the extensions have been released.","markdown_message":"\u003cp\u003eMichael Wallner (\u003ca title=\"mike@php.net\" href=\"mailto:mike@php.net\" rel=\"nofollow noopener noreferrer\"\u003emike@php.net\u003c/a\u003e) already fixed this issue and released a fixed version of the pecl_http extension version 3.1.0RC1 / 2.6.0RC1 respective. However neither him nor I do have the proper permissions on the PHP bug tracker to mark the report public. He already tried to degrade it to non-security (which is not the right thing) but this didn\u0026#39;t make the bug public. I sent an email regarding this issue to \u003ca title=\"johannes@php.net\" href=\"mailto:johannes@php.net\" rel=\"nofollow noopener noreferrer\"\u003ejohannes@php.net\u003c/a\u003e but never received an answer. I could try to mail another core dev of the PHP project to resolve this issue. Please let me know, if you want me to try to resolve the bug tracker issue by contacting another core dev!\u003c/p\u003e\n\n\u003cp\u003eFrom my POV this issue can be publicly disclosed since it has been fixed and follow-up releases of the extensions have been released.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-12-03T21:57:13.763Z","updated_at":"2016-12-03T21:57:13.763Z","actor":{"username":"rc0r","cleared":false,"url":"/rc0r","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/153/304e6c45c12b1b9dec0c6c0f2ebd67341d234566_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ibb-php","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1339223,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2016-12-03T22:16:14.035Z","updated_at":"2016-12-03T22:16:14.035Z","additional_data":{"old_severity":null,"new_severity":"Medium","old_severity_id":null,"new_severity_id":11398},"actor":{"username":"arice","cleared":false,"url":"/arice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/83152cb2d070f3f6a63c1b61bae47257722b5ad2_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"ibb-php","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1339224,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2016-12-03T22:16:41.953Z","updated_at":"2016-12-03T22:16:41.953Z","actor":{"username":"arice","cleared":false,"url":"/arice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/83152cb2d070f3f6a63c1b61bae47257722b5ad2_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"reporter":{"username":"rc0r","url":"/rc0r"},"genius_execution_id":null,"team_handle":"ibb-php","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1339225,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2016-12-03T22:16:51.277Z","updated_at":"2016-12-03T22:16:51.277Z","actor":{"url":"/ibb-php","ibb":true,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/029/99087dbbdf52fc3ce3acbf16aa33a5c4f5e2c111_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"PHP (IBB)"}},"bounty_amount":"1000.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"ibb-php","collaborator":{"username":"rc0r","url":"/rc0r"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1657980,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-05-06T08:21:38.024Z","updated_at":"2017-05-06T08:21:38.024Z","first_to_agree":true,"actor":{"username":"rc0r","cleared":false,"url":"/rc0r","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/153/304e6c45c12b1b9dec0c6c0f2ebd67341d234566_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ibb-php","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1709814,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-05-30T15:13:49.264Z","updated_at":"2017-05-30T15:13:49.264Z","actor":{"username":"arice","cleared":false,"url":"/arice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/83152cb2d070f3f6a63c1b61bae47257722b5ad2_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"ibb-php","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1709815,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-05-30T15:13:49.323Z","updated_at":"2017-05-30T15:13:49.323Z","actor":{"username":"arice","cleared":false,"url":"/arice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/83152cb2d070f3f6a63c1b61bae47257722b5ad2_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"ibb-php","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}