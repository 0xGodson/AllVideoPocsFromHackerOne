{"id":122050,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMjIwNTA=","url":"https://hackerone.com/reports/122050","title":"Mapbox API Access Token with No Scope Can Read Styles","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-03-10T14:09:16.649Z","submitted_at":"2016-03-10T14:09:16.649Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"bugs3ra","url":"/bugs3ra","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/031/877/979f1b2f975110612d4cab7336f0d594e4afb678_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1366,"url":"https://hackerone.com/mapbox","handle":"mapbox","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/366/d4dfa3c8752e3849cdfb22fea49c17bd37f03850_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/366/d4dfa3c8752e3849cdfb22fea49c17bd37f03850_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Mapbox","twitter_handle":"mapbox","website":"https://www.mapbox.com/security","about":"Mapbox is an open source mapping platform, providing building blocks for developers to integrate location into any mobile or online application."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2016-05-31T22:03:00.657Z","bug_reporter_agreed_on_going_public_at":"2016-05-04T04:40:48.490Z","team_member_agreed_on_going_public_at":"2016-05-31T22:03:00.482Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"HI \nI created one api token with 0 scope.\nThen I sent the following request to server\n\nGET /styles/v1/katilthe?access_token=pk.eyJ1Ijoia2F0aWx0aGUiLCJhIjoiY2lsbWJwcWpjNjhmNnZubWNhYXdwZm5obyJ9.2cPnaIiXcFnDRFMfrD1TRw HTTP/1.1\nHost: api.mapbox.com\nUser-Agent: Mozilla/5.0 (Windows NT 6.3; WOW64; rv:44.0) Gecko/20100101 Firefox/44.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate, br\nReferer: https://www.mapbox.com/studio/styles/fonts/\nOrigin: https://www.mapbox.com\nConnection: keep-alive\n\nI Got 200 OK in response and my styles.\n\n[{\"version\":8,\"name\":\"test\\\"\u003e\u003csvg/onload=alert(2)\u003e-copy-copy\",\"center\":[-78.90145050000001,33.70101199999998],\"zoom\":12,\"bearing\":0,\"pitch\":0,\"created\":\"2016-03-10T13:45:51.193Z\",\"id\":\"cilmbusls00cvc6m23qpi69gg\",\"modified\":\"2016-03-10T13:45:51.193Z\",\"owner\":\"katilthe\"},{\"version\":8,\"name\":\"test\\\"\u003e\u003csvg/onload=alert(2)\u003e-copy\",\"center\":[0,-1.1368683772161603e-13],\"zoom\":0.3106126682923422,\"bearing\":0,\"pitch\":0,\"created\":\"2016-03-10T13:43:58.005Z\",\"id\":\"cilmbsd9s00cfc7mcl1m7nnrz\",\"modified\":\"2016-03-10T13:43:58.005Z\",\"owner\":\"katilthe\"}]\n\n\n\n","vulnerability_information_html":"\u003cp\u003eHI \u003cbr\u003e\nI created one api token with 0 scope.\u003cbr\u003e\nThen I sent the following request to server\u003c/p\u003e\n\n\u003cp\u003eGET /styles/v1/katilthe?access_token=pk.eyJ1Ijoia2F0aWx0aGUiLCJhIjoiY2lsbWJwcWpjNjhmNnZubWNhYXdwZm5obyJ9.2cPnaIiXcFnDRFMfrD1TRw HTTP/1.1\u003cbr\u003e\nHost: api.mapbox.com\u003cbr\u003e\nUser-Agent: Mozilla/5.0 (Windows NT 6.3; WOW64; rv:44.0) Gecko/20100101 Firefox/44.0\u003cbr\u003e\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,\u003cem\u003e/\u003c/em\u003e;q=0.8\u003cbr\u003e\nAccept-Language: en-US,en;q=0.5\u003cbr\u003e\nAccept-Encoding: gzip, deflate, br\u003cbr\u003e\nReferer: \u003ca title=\"https://www.mapbox.com/studio/styles/fonts/\" href=\"/redirect?url=https%3A%2F%2Fwww.mapbox.com%2Fstudio%2Fstyles%2Ffonts%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.mapbox.com/studio/styles/fonts/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nOrigin: \u003ca title=\"https://www.mapbox.com\" href=\"/redirect?url=https%3A%2F%2Fwww.mapbox.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.mapbox.com\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nConnection: keep-alive\u003c/p\u003e\n\n\u003cp\u003eI Got 200 OK in response and my styles.\u003c/p\u003e\n\n\u003cp\u003e[{\u0026quot;version\u0026quot;:8,\u0026quot;name\u0026quot;:\u0026quot;test\\\u0026quot;\u0026gt;\u0026lt;svg/onload=alert(2)\u0026gt;-copy-copy\u0026quot;,\u0026quot;center\u0026quot;:[-78.90145050000001,33.70101199999998],\u0026quot;zoom\u0026quot;:12,\u0026quot;bearing\u0026quot;:0,\u0026quot;pitch\u0026quot;:0,\u0026quot;created\u0026quot;:\u0026quot;2016-03-10T13:45:51.193Z\u0026quot;,\u0026quot;id\u0026quot;:\u0026quot;cilmbusls00cvc6m23qpi69gg\u0026quot;,\u0026quot;modified\u0026quot;:\u0026quot;2016-03-10T13:45:51.193Z\u0026quot;,\u0026quot;owner\u0026quot;:\u0026quot;katilthe\u0026quot;},{\u0026quot;version\u0026quot;:8,\u0026quot;name\u0026quot;:\u0026quot;test\\\u0026quot;\u0026gt;\u0026lt;svg/onload=alert(2)\u0026gt;-copy\u0026quot;,\u0026quot;center\u0026quot;:[0,-1.1368683772161603e-13],\u0026quot;zoom\u0026quot;:0.3106126682923422,\u0026quot;bearing\u0026quot;:0,\u0026quot;pitch\u0026quot;:0,\u0026quot;created\u0026quot;:\u0026quot;2016-03-10T13:43:58.005Z\u0026quot;,\u0026quot;id\u0026quot;:\u0026quot;cilmbsd9s00cfc7mcl1m7nnrz\u0026quot;,\u0026quot;modified\u0026quot;:\u0026quot;2016-03-10T13:43:58.005Z\u0026quot;,\u0026quot;owner\u0026quot;:\u0026quot;katilthe\u0026quot;}]\u003c/p\u003e\n","bounty_amount":"200.0","formatted_bounty":"$200","weakness":{"id":27,"name":"Improper Authentication - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":77764,"file_name":"api.JPG","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/077/764/ecd712865ee61e5182afe754d7a620f7b5a0ea1c/api.JPG?response-content-disposition=attachment%3B%20filename%3D%22api.JPG%22%3B%20filename%2A%3DUTF-8%27%27api.JPG\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQYMVJENU6%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T042054Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJj%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDWBybDR3vqhcsLBSMk4%2B6P70Ud7eobaXGJmgB%2FHdxqCQIhANWsU51SqowXMmzbNIfK2pdim%2BgV3mQKWL%2FoNTr7y%2BXnKrQDCFEQARoMMDEzNjE5Mjc0ODQ5IgwVkuDdHKaHnFcy6foqkQMHSD9Lwk3G5nXNsgTE1I8L%2FxERDRm3%2FwUHGtqbcqWj8jHUHsiWc0cuMBCUgqjP7pOrgAWXPwSKRqGfafgzzyUteQgmLfDIZpwZZO81EZGgAEdp5E%2F2tBncLnh8ZJrCx1P8EmxR6%2Fo8vkF%2FuWOPJHhHJ2lZyEsbjRzNcQVb%2Fs7CNO5bq2zKtHPwg3C2%2Fo93S9si0IG2AHXGWlnAyij4fRQj6uwJQDGyJlOTWttICHGK4AhYMsL%2Fq0aTm792kd%2BkVeyySD0SgMka0Wq%2FLYnfvzpnIr6zq4ci4bh16b3oqaEB2qu%2B8Py2%2FrJqPIWmi9Gr4RYZH66IXOCLUFGFoL7%2FsdCJDHTy96SorDYSjRUAX6AnBb2%2BuQCKobl6A8PqHt6GIkexPyANWYD9UBBSoObzADm0EHpYf92QwrH85lDqfrE2608E%2BimFNYNs837N%2B%2BJ5e%2FLjI8CS4T%2BlvtfQ7gpk51s4g%2BuSdgjxrq11GhXx2Zm9KTkYc%2BazRqrSv12NTkj%2BiVjkzdX6KN6BUov3zndl%2F%2FWJHTC26qn%2FBTrqAa4l0p0G3kOLPeJ6QAhfVAW73vQA4dhMb6NjYVGNoVZWymk4%2BnyrxPSLgH6TjoldACc7Frzg8xwKr8bfp2yW0NADmrnAq%2BU8nVey7H%2FI%2FoXUWj%2FymOC1jAi02%2BBYJGMUz6qpIzeqj9m8H%2Bl96OuDejTKuHxueDmtYdH2wZFcrPixAjJ8zlSb7j2DKlSQCR%2BUjkw0%2Bi1e818DdrHBp%2BPRvDG%2FpIyFaeXaRuomWdaFOSF70HxUwxdFHg7GvBA2pEDNV34SrACAjARy0ifYBTStiJzmvr8mPk%2FH%2FXLhlmkIY1Hw7L%2FyR4lry8ZFSA%3D%3D\u0026X-Amz-Signature=e9b244e0ff606ff79ce27e09de8ddce1527c078eccdeee652815ee1512633f16","file_size":17027,"type":"image/jpeg"},{"id":77765,"file_name":"req_response.JPG","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/077/765/4595139a161916f40f28c8352fcc0f628fb06fcc/req_response.JPG?response-content-disposition=attachment%3B%20filename%3D%22req_response.JPG%22%3B%20filename%2A%3DUTF-8%27%27req_response.JPG\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQYMVJENU6%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T042054Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJj%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDWBybDR3vqhcsLBSMk4%2B6P70Ud7eobaXGJmgB%2FHdxqCQIhANWsU51SqowXMmzbNIfK2pdim%2BgV3mQKWL%2FoNTr7y%2BXnKrQDCFEQARoMMDEzNjE5Mjc0ODQ5IgwVkuDdHKaHnFcy6foqkQMHSD9Lwk3G5nXNsgTE1I8L%2FxERDRm3%2FwUHGtqbcqWj8jHUHsiWc0cuMBCUgqjP7pOrgAWXPwSKRqGfafgzzyUteQgmLfDIZpwZZO81EZGgAEdp5E%2F2tBncLnh8ZJrCx1P8EmxR6%2Fo8vkF%2FuWOPJHhHJ2lZyEsbjRzNcQVb%2Fs7CNO5bq2zKtHPwg3C2%2Fo93S9si0IG2AHXGWlnAyij4fRQj6uwJQDGyJlOTWttICHGK4AhYMsL%2Fq0aTm792kd%2BkVeyySD0SgMka0Wq%2FLYnfvzpnIr6zq4ci4bh16b3oqaEB2qu%2B8Py2%2FrJqPIWmi9Gr4RYZH66IXOCLUFGFoL7%2FsdCJDHTy96SorDYSjRUAX6AnBb2%2BuQCKobl6A8PqHt6GIkexPyANWYD9UBBSoObzADm0EHpYf92QwrH85lDqfrE2608E%2BimFNYNs837N%2B%2BJ5e%2FLjI8CS4T%2BlvtfQ7gpk51s4g%2BuSdgjxrq11GhXx2Zm9KTkYc%2BazRqrSv12NTkj%2BiVjkzdX6KN6BUov3zndl%2F%2FWJHTC26qn%2FBTrqAa4l0p0G3kOLPeJ6QAhfVAW73vQA4dhMb6NjYVGNoVZWymk4%2BnyrxPSLgH6TjoldACc7Frzg8xwKr8bfp2yW0NADmrnAq%2BU8nVey7H%2FI%2FoXUWj%2FymOC1jAi02%2BBYJGMUz6qpIzeqj9m8H%2Bl96OuDejTKuHxueDmtYdH2wZFcrPixAjJ8zlSb7j2DKlSQCR%2BUjkw0%2Bi1e818DdrHBp%2BPRvDG%2FpIyFaeXaRuomWdaFOSF70HxUwxdFHg7GvBA2pEDNV34SrACAjARy0ifYBTStiJzmvr8mPk%2FH%2FXLhlmkIY1Hw7L%2FyR4lry8ZFSA%3D%3D\u0026X-Amz-Signature=87019728c10536295c820bc04e973d1f3073afb7158e317ebd21565d67b1aa13","file_size":103658,"type":"image/jpeg"}],"allow_singular_disclosure_at":"2016-06-03T04:40:48.577Z","allow_singular_disclosure_after":-144286806.2487272,"singular_disclosure_allowed":true,"vote_count":1,"voters":["dyabla"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":834605,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"According to API documentation, for this request the API token requires \"Style:Read\" Scope enabled. If you face any issue reproducing this please let me know.","markdown_message":"\u003cp\u003eAccording to API documentation, for this request the API token requires \u0026quot;Style:Read\u0026quot; Scope enabled. If you face any issue reproducing this please let me know.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-03-11T07:01:14.194Z","updated_at":"2016-03-11T07:01:14.194Z","actor":{"username":"bugs3ra","cleared":false,"url":"/bugs3ra","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/031/877/979f1b2f975110612d4cab7336f0d594e4afb678_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mapbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":839580,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"@bugs3ra - this appears to be a bug in our documentation instead of a security issue. A public access token with no scope has all three public scopes by default - `\"styles:tiles\"`,`\"styles:read\"`, and `\"fonts:read\"`. The default public access token for a Mapbox account has the same three scopes. This was missing from our documentation and we appreciate your report as it made us aware of the issue.\n\nSince there is no security issue this report will not be eligible for a monetary bounty, but it will be eligible for reputation points. If you can provide a proof of concept or exploit that shows how this can harm a user or our products we will reconsider, otherwise we will be triaging and fixing this as a documentation issue.","markdown_message":"\u003cp\u003e\u003ca href=\"/bugs3ra\"\u003e@bugs3ra\u003c/a\u003e - this appears to be a bug in our documentation instead of a security issue. A public access token with no scope has all three public scopes by default - \u003ccode\u003e\u0026quot;styles:tiles\u0026quot;\u003c/code\u003e,\u003ccode\u003e\u0026quot;styles:read\u0026quot;\u003c/code\u003e, and \u003ccode\u003e\u0026quot;fonts:read\u0026quot;\u003c/code\u003e. The default public access token for a Mapbox account has the same three scopes. This was missing from our documentation and we appreciate your report as it made us aware of the issue.\u003c/p\u003e\n\n\u003cp\u003eSince there is no security issue this report will not be eligible for a monetary bounty, but it will be eligible for reputation points. If you can provide a proof of concept or exploit that shows how this can harm a user or our products we will reconsider, otherwise we will be triaging and fixing this as a documentation issue.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-03-14T22:43:23.721Z","updated_at":"2016-03-14T22:43:39.595Z","actor":{"username":"alulsh","cleared":false,"url":"/alulsh","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/039/856/496b75e2cc4a4ce5798ef27243d139b9dd38fea5_original.JPG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mapbox","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":839587,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2016-03-14T22:45:14.403Z","updated_at":"2016-03-14T22:45:14.403Z","additional_data":{"old_title":"Styles can be read using API Token with no scope set","new_title":"Mapbox API Access Token with No Scope Can Read Styles"},"actor":{"username":"alulsh","cleared":false,"url":"/alulsh","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/039/856/496b75e2cc4a4ce5798ef27243d139b9dd38fea5_original.JPG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mapbox","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":840129,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi, thanks for triaging.\nBut I can see, if you click on edit option. It will show all these as unselected in application but still these scopes are enabled by default. This seems security issue to me.","markdown_message":"\u003cp\u003eHi, thanks for triaging.\u003cbr\u003e\nBut I can see, if you click on edit option. It will show all these as unselected in application but still these scopes are enabled by default. This seems security issue to me.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-03-15T07:18:29.215Z","updated_at":"2016-03-15T07:18:29.215Z","actor":{"username":"bugs3ra","cleared":false,"url":"/bugs3ra","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/031/877/979f1b2f975110612d4cab7336f0d594e4afb678_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mapbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":891236,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Any Updates","markdown_message":"\u003cp\u003eAny Updates\u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-06T06:15:49.893Z","updated_at":"2016-04-06T06:15:49.893Z","actor":{"username":"bugs3ra","cleared":false,"url":"/bugs3ra","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/031/877/979f1b2f975110612d4cab7336f0d594e4afb678_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mapbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":898887,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @alulsh , I have a scenario for security issue in this.\n\nRefering the Documentation, end user configures api key that have no scope enabled thinking nothing can be accessed with this token. However, due to mistake in your documentation, some scopes are already selected. And other user will be able to access things with same key which end user has created with no scopes enabled.\n\nAlso IN UI, the application should tell the end user that default scope will be enabled even if no scopes are selected.","markdown_message":"\u003cp\u003eHi \u003ca href=\"/alulsh\"\u003e@alulsh\u003c/a\u003e , I have a scenario for security issue in this.\u003c/p\u003e\n\n\u003cp\u003eRefering the Documentation, end user configures api key that have no scope enabled thinking nothing can be accessed with this token. However, due to mistake in your documentation, some scopes are already selected. And other user will be able to access things with same key which end user has created with no scopes enabled.\u003c/p\u003e\n\n\u003cp\u003eAlso IN UI, the application should tell the end user that default scope will be enabled even if no scopes are selected.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-11T08:50:35.418Z","updated_at":"2016-04-11T08:50:35.418Z","actor":{"username":"bugs3ra","cleared":false,"url":"/bugs3ra","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/031/877/979f1b2f975110612d4cab7336f0d594e4afb678_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mapbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":910940,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@alulsh please have a look at my last comment \n\n\"_Refering the Documentation, end user configures api key that have no scope enabled thinking nothing can be accessed with this token. However, due to mistake in your documentation, some scopes are already selected. And other user will be able to access things with same key which end user has created with no scopes enabled._\"\n\n\"_Also IN UI, the application should tell the end user that default scope will be enabled even if no scopes are selected._\"","markdown_message":"\u003cp\u003e\u003ca href=\"/alulsh\"\u003e@alulsh\u003c/a\u003e please have a look at my last comment \u003c/p\u003e\n\n\u003cp\u003e\u0026quot;\u003cu\u003eRefering the Documentation, end user configures api key that have no scope enabled thinking nothing can be accessed with this token. However, due to mistake in your documentation, some scopes are already selected. And other user will be able to access things with same key which end user has created with no scopes enabled.\u003c/u\u003e\u0026quot;\u003c/p\u003e\n\n\u003cp\u003e\u0026quot;\u003cu\u003eAlso IN UI, the application should tell the end user that default scope will be enabled even if no scopes are selected.\u003c/u\u003e\u0026quot;\u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-18T06:03:24.390Z","updated_at":"2016-04-18T06:04:17.577Z","actor":{"username":"bugs3ra","cleared":false,"url":"/bugs3ra","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/031/877/979f1b2f975110612d4cab7336f0d594e4afb678_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mapbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":915973,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@bugs3ra - thank you for the updated proof of concept and additional analysis. We will be taking your comments into consideration when we triage and fix the issue.","markdown_message":"\u003cp\u003e\u003ca href=\"/bugs3ra\"\u003e@bugs3ra\u003c/a\u003e - thank you for the updated proof of concept and additional analysis. We will be taking your comments into consideration when we triage and fix the issue.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-19T21:31:36.277Z","updated_at":"2016-04-19T21:31:36.277Z","actor":{"username":"alulsh","cleared":false,"url":"/alulsh","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/039/856/496b75e2cc4a4ce5798ef27243d139b9dd38fea5_original.JPG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mapbox","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":916616,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"The report is already triaged here...and also if you can confirm whether my report is eligible for bounty as I have tried to explain the security weakness here.","markdown_message":"\u003cp\u003eThe report is already triaged here...and also if you can confirm whether my report is eligible for bounty as I have tried to explain the security weakness here.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-20T05:18:32.277Z","updated_at":"2016-04-20T05:18:32.277Z","actor":{"username":"bugs3ra","cleared":false,"url":"/bugs3ra","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/031/877/979f1b2f975110612d4cab7336f0d594e4afb678_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mapbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":928478,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Any news....do you consider this now eligible for monetary reward\n","markdown_message":"\u003cp\u003eAny news....do you consider this now eligible for monetary reward\u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-26T11:09:18.288Z","updated_at":"2016-04-26T11:10:27.370Z","actor":{"username":"bugs3ra","cleared":false,"url":"/bugs3ra","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/031/877/979f1b2f975110612d4cab7336f0d594e4afb678_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mapbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":939284,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"@bugs3ra - thank you for your patience. We were deciding between changes to our token scopes or a change to the UI in Mapbox Studio. \n\nWe decided to make a change to the UI in Mapbox Studio. We changed \"No scopes\" to \"Public token (all public scopes)\". This makes it clear to the user that a default token actually has all public scopes.","markdown_message":"\u003cp\u003e\u003ca href=\"/bugs3ra\"\u003e@bugs3ra\u003c/a\u003e - thank you for your patience. We were deciding between changes to our token scopes or a change to the UI in Mapbox Studio. \u003c/p\u003e\n\n\u003cp\u003eWe decided to make a change to the UI in Mapbox Studio. We changed \u0026quot;No scopes\u0026quot; to \u0026quot;Public token (all public scopes)\u0026quot;. This makes it clear to the user that a default token actually has all public scopes.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-05-03T21:40:56.743Z","updated_at":"2016-05-03T21:40:56.743Z","actor":{"username":"alulsh","cleared":false,"url":"/alulsh","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/039/856/496b75e2cc4a4ce5798ef27243d139b9dd38fea5_original.JPG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"bugs3ra","url":"/bugs3ra"},"genius_execution_id":null,"team_handle":"mapbox","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":939285,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2016-05-03T21:41:17.956Z","updated_at":"2016-05-03T21:41:17.956Z","actor":{"url":"/mapbox","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/366/d4dfa3c8752e3849cdfb22fea49c17bd37f03850_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Mapbox"}},"bounty_amount":"200.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"mapbox","collaborator":{"username":"bugs3ra","url":"/bugs3ra"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":939671,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"thanks for bounty.... ","markdown_message":"\u003cp\u003ethanks for bounty.... \u003c/p\u003e\n","automated_response":false,"created_at":"2016-05-04T04:40:48.529Z","updated_at":"2016-05-04T04:40:48.529Z","first_to_agree":true,"actor":{"username":"bugs3ra","cleared":false,"url":"/bugs3ra","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/031/877/979f1b2f975110612d4cab7336f0d594e4afb678_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mapbox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":993899,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-05-31T22:03:00.546Z","updated_at":"2016-05-31T22:03:00.546Z","actor":{"username":"alulsh","cleared":false,"url":"/alulsh","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/039/856/496b75e2cc4a4ce5798ef27243d139b9dd38fea5_original.JPG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mapbox","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":993900,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-05-31T22:03:00.685Z","updated_at":"2016-05-31T22:03:00.685Z","actor":{"username":"alulsh","cleared":false,"url":"/alulsh","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/039/856/496b75e2cc4a4ce5798ef27243d139b9dd38fea5_original.JPG/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"mapbox","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":2018,"category":"team","content":"On March 10th, 2016, @bugs3ra reported that a public Mapbox API access token with no explicitly declared scopes could read public map styles. This meant that a token with no scopes had the `styles:read` scope. In fact, the no scope token had all three public scopes associated with a user's default public access token - `styles:tiles`, `styles:read`, and `fonts:read`. \n\nTo fix this issue, we updated the UI in Studio to make token scopes more clear. We updated the text \"No scopes\" to \"Public token (all public scopes)\" in the token creation modal dialog.\n\nWe decided to award a bounty for this report since granting more scopes than expected is unexpected for the user and represents a minor violation of the principle of least privilege. ","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eOn March 10th, 2016, \u003ca href=\"/bugs3ra\"\u003e@bugs3ra\u003c/a\u003e reported that a public Mapbox API access token with no explicitly declared scopes could read public map styles. This meant that a token with no scopes had the \u003ccode\u003estyles:read\u003c/code\u003e scope. In fact, the no scope token had all three public scopes associated with a user\u0026#39;s default public access token - \u003ccode\u003estyles:tiles\u003c/code\u003e, \u003ccode\u003estyles:read\u003c/code\u003e, and \u003ccode\u003efonts:read\u003c/code\u003e. \u003c/p\u003e\n\n\u003cp\u003eTo fix this issue, we updated the UI in Studio to make token scopes more clear. We updated the text \u0026quot;No scopes\u0026quot; to \u0026quot;Public token (all public scopes)\u0026quot; in the token creation modal dialog.\u003c/p\u003e\n\n\u003cp\u003eWe decided to award a bounty for this report since granting more scopes than expected is unexpected for the user and represents a minor violation of the principle of least privilege. \u003c/p\u003e\n"},{"category":"researcher","can_view?":true,"can_create?":false}]}