{"id":985150,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC85ODUxNTA=","url":"https://hackerone.com/reports/985150","title":"Privilege Escalation in Point Of Sale Application from POS Manage Staff Role to potentially Store Owner","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2020-09-18T06:33:28.728Z","submitted_at":"2020-09-18T06:33:28.990Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"francisbeaudoin","url":"/francisbeaudoin","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/apkjpoNQK4P5JD7rCFCB2hcf/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1382,"url":"https://hackerone.com/shopify","handle":"shopify","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Shopify","twitter_handle":"","website":"https://www.shopify.com","about":"Shopify is a multi-channel commerce platform that helps people sell online, in-store, and everywhere in between."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2020-11-19T16:23:26.769Z","bug_reporter_agreed_on_going_public_at":"2020-11-19T16:23:26.720Z","team_member_agreed_on_going_public_at":"2020-10-22T17:42:24.822Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"I was playing a bit with the Point Of Sale application and it came to my attention that it is possible to navigate from the Point Of Sale Application up to the Plan \u0026 Permission in the admin. I am not sure if this is  intentional, but since it leads to potentially take over a shop, I'm reporting it.\n\nWithin he Point Of Sale application, a staff with full admin permissions can open the Point Of Sale channel using the embedded **Magage POS roles** link. By doing so and by using some nested links, it is possible to navigate up to the Plan \u0026 Permissions admin view giving him access to some store owner permissions:\n 1. Add staff account\n 1. Manage staff account\n 1. Update login service\n 1. Transfer ownership (requires the shop owner password but could be used to bypass the 2FA protection)\n\nGiven that, a POS staff with only Manage Role could escalate his privileges up to Full Permissions and potentially even take over the shop if knows the admin password.\n\n## Steps to reproduce\n1. Create a Staff with Full Permissions\n1. Create a POS user with only Manage Staff permissions\n1. From the Point Of Sale Application, log-in with the admin user then enter the PIN of the POS User from Step 2\n1. Go to **Staff**, select the staff with Full Permissions from Step 1 and change its PIN to 1234\n1. Lock the application screen and log back in using the 1234 PIN, giving you Full Permissions access within the Application\n1. Go to **Staff**, select any staff, edit its **POS APP ACCESS** and click on **Manage POS Roles**\n1. From the Roles listing page, open the Full Permissions staff's role and scroll at the bottom down so you can see the **Assigned Staff** section and click on the Staff\n1. Scroll at the bottom again and click on **Manage Shopify admin access**, this is opening up the staff page from **Plan and Permissions**.\n1. At the top of the page, click on breadcrumb navigation **Plan and Permissions** link bringing you to the `https://shop.myshopify.com/admin/settings/account`\n\nAt this point, as the Point Of Sale application is using the physically authenticated user, you're given access to store owner features as mentioned earlier.\n\n## Impact\n\nA staff with **Manager Staff Role** within the Point Of Sale application can escalate his privilege to a Full Permission staff and could potentially transfer the shop ownership by using the **Transfer ownership** link within the **Plans \u0026 Permissions** page.","vulnerability_information_html":"\u003cp\u003eI was playing a bit with the Point Of Sale application and it came to my attention that it is possible to navigate from the Point Of Sale Application up to the Plan \u0026amp; Permission in the admin. I am not sure if this is  intentional, but since it leads to potentially take over a shop, I\u0026#39;m reporting it.\u003c/p\u003e\n\n\u003cp\u003eWithin he Point Of Sale application, a staff with full admin permissions can open the Point Of Sale channel using the embedded \u003cstrong\u003eMagage POS roles\u003c/strong\u003e link. By doing so and by using some nested links, it is possible to navigate up to the Plan \u0026amp; Permissions admin view giving him access to some store owner permissions:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eAdd staff account\u003c/li\u003e\n\u003cli\u003eManage staff account\u003c/li\u003e\n\u003cli\u003eUpdate login service\u003c/li\u003e\n\u003cli\u003eTransfer ownership (requires the shop owner password but could be used to bypass the 2FA protection)\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eGiven that, a POS staff with only Manage Role could escalate his privileges up to Full Permissions and potentially even take over the shop if knows the admin password.\u003c/p\u003e\n\n\u003ch2 id=\"steps-to-reproduce\"\u003eSteps to reproduce\u003c/h2\u003e\n\n\u003col\u003e\n\u003cli\u003eCreate a Staff with Full Permissions\u003c/li\u003e\n\u003cli\u003eCreate a POS user with only Manage Staff permissions\u003c/li\u003e\n\u003cli\u003eFrom the Point Of Sale Application, log-in with the admin user then enter the PIN of the POS User from Step 2\u003c/li\u003e\n\u003cli\u003eGo to \u003cstrong\u003eStaff\u003c/strong\u003e, select the staff with Full Permissions from Step 1 and change its PIN to 1234\u003c/li\u003e\n\u003cli\u003eLock the application screen and log back in using the 1234 PIN, giving you Full Permissions access within the Application\u003c/li\u003e\n\u003cli\u003eGo to \u003cstrong\u003eStaff\u003c/strong\u003e, select any staff, edit its \u003cstrong\u003ePOS APP ACCESS\u003c/strong\u003e and click on \u003cstrong\u003eManage POS Roles\u003c/strong\u003e\n\u003c/li\u003e\n\u003cli\u003eFrom the Roles listing page, open the Full Permissions staff\u0026#39;s role and scroll at the bottom down so you can see the \u003cstrong\u003eAssigned Staff\u003c/strong\u003e section and click on the Staff\u003c/li\u003e\n\u003cli\u003eScroll at the bottom again and click on \u003cstrong\u003eManage Shopify admin access\u003c/strong\u003e, this is opening up the staff page from \u003cstrong\u003ePlan and Permissions\u003c/strong\u003e.\u003c/li\u003e\n\u003cli\u003eAt the top of the page, click on breadcrumb navigation \u003cstrong\u003ePlan and Permissions\u003c/strong\u003e link bringing you to the \u003ccode\u003ehttps://shop.myshopify.com/admin/settings/account\u003c/code\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eAt this point, as the Point Of Sale application is using the physically authenticated user, you\u0026#39;re given access to store owner features as mentioned earlier.\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eA staff with \u003cstrong\u003eManager Staff Role\u003c/strong\u003e within the Point Of Sale application can escalate his privilege to a Full Permission staff and could potentially transfer the shop ownership by using the \u003cstrong\u003eTransfer ownership\u003c/strong\u003e link within the \u003cstrong\u003ePlans \u0026amp; Permissions\u003c/strong\u003e page.\u003c/p\u003e\n","bounty_amount":"1000.0","formatted_bounty":"$1,000","original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":6,"voters":["kapkan","th4nu_0x0","owneip","th3hidd3nmist","xplicit","hackmastro"],"severity":{"rating":"medium","author_type":"User"},"structured_scope":{"databaseId":37198,"asset_type":"OTHER","asset_identifier":"Shopify Developed Apps","max_severity":"medium"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":9255726,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I was thinking about my report this morning and just wanted to bring up that I consider this one to be a different issue than [927146](https://hackerone.com/bugs?subject=user\u0026report_id=927146) as it demonstrates that there's actually no need to intercept the `X-Shopify-Access-Token` header value to achieve privilege escalation.","markdown_message":"\u003cp\u003eI was thinking about my report this morning and just wanted to bring up that I consider this one to be a different issue than \u003ca href=\"https://hackerone.com/bugs?subject=user\u0026amp;report_id=927146\"\u003e927146\u003c/a\u003e as it demonstrates that there\u0026#39;s actually no need to intercept the \u003ccode\u003eX-Shopify-Access-Token\u003c/code\u003e header value to achieve privilege escalation.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-09-18T11:44:01.952Z","updated_at":"2020-09-18T11:44:01.952Z","actor":{"username":"francisbeaudoin","cleared":false,"url":"/francisbeaudoin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/apkjpoNQK4P5JD7rCFCB2hcf/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9256020,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Hi @francisbeaudoin!\nJust to clarify - which account-owner only actions you were able to take through this method?\nThanks! ","markdown_message":"\u003cp\u003eHi \u003ca href=\"/francisbeaudoin\"\u003e@francisbeaudoin\u003c/a\u003e!\u003cbr\u003e\nJust to clarify - which account-owner only actions you were able to take through this method?\u003cbr\u003e\nThanks! \u003c/p\u003e\n","automated_response":false,"created_at":"2020-09-18T12:19:16.522Z","updated_at":"2020-09-18T12:19:16.522Z","actor":{"username":"jenn-shopify","cleared":false,"url":"/jenn-shopify","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9256336,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Hey @jenn-shopify,\n\nAs it stands, I can only access the **Plans \u0026 Permissions** page from the admin. Thus, the following actions are available:\n1. Create a staff account (hence the staff whom only has POS access can create a Full Permissions account)\n1. Update current staff permissions\n1. Transfer Ownership (requires admin password)\n1. Delete staff (requires admin password)\n1. Update Login Service domain name\n\nI attached a quick demo showing that, however the **Transfer Ownership** fails as my store is somehow locked).\n\nIn my demo, this is what store has as staff users:\n1. **POS User** is the one with only **Manage Staff Role** (no admin access)\n1. **Victim Account** is the staff with **Full Permissions**\n1. **Francis Beaudoin** is the shop owner\n\n{F993192}\n\nAs you can see, I firstly use PIN of POS User and escalate this to sending an invite to create a full permissions user to `█████`. \n\nIf I get time later on this afternoon, I'll be looking if I could somehow end up navigating to other part of the admin.","markdown_message":"\u003cp\u003eHey \u003ca href=\"/jenn-shopify\"\u003e@jenn-shopify\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eAs it stands, I can only access the \u003cstrong\u003ePlans \u0026amp; Permissions\u003c/strong\u003e page from the admin. Thus, the following actions are available:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eCreate a staff account (hence the staff whom only has POS access can create a Full Permissions account)\u003c/li\u003e\n\u003cli\u003eUpdate current staff permissions\u003c/li\u003e\n\u003cli\u003eTransfer Ownership (requires admin password)\u003c/li\u003e\n\u003cli\u003eDelete staff (requires admin password)\u003c/li\u003e\n\u003cli\u003eUpdate Login Service domain name\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eI attached a quick demo showing that, however the \u003cstrong\u003eTransfer Ownership\u003c/strong\u003e fails as my store is somehow locked).\u003c/p\u003e\n\n\u003cp\u003eIn my demo, this is what store has as staff users:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003e\n\u003cstrong\u003ePOS User\u003c/strong\u003e is the one with only \u003cstrong\u003eManage Staff Role\u003c/strong\u003e (no admin access)\u003c/li\u003e\n\u003cli\u003e\n\u003cstrong\u003eVictim Account\u003c/strong\u003e is the staff with \u003cstrong\u003eFull Permissions\u003c/strong\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cstrong\u003eFrancis Beaudoin\u003c/strong\u003e is the shop owner\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003e{F993192}\u003c/p\u003e\n\n\u003cp\u003eAs you can see, I firstly use PIN of POS User and escalate this to sending an invite to create a full permissions user to \u003ccode\u003e█████\u003c/code\u003e. \u003c/p\u003e\n\n\u003cp\u003eIf I get time later on this afternoon, I\u0026#39;ll be looking if I could somehow end up navigating to other part of the admin.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-09-18T13:01:37.157Z","updated_at":"2020-10-22T18:18:17.562Z","actor":{"username":"francisbeaudoin","cleared":false,"url":"/francisbeaudoin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/apkjpoNQK4P5JD7rCFCB2hcf/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9258096,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Hi @francisbeaudoin,\nThank you for following up! \nI am not quite able to reproduce this, unless I log into the device as the account owner (when providing the initial username/password to POS). Can you confirm that you did in fact login to the device with the admin credentials for a Full Permissions user and not the account owner? From our logs, it appears that the account owner was associated with that invite request, which would be the case if the account owner was the one who logged into the terminal.","markdown_message":"\u003cp\u003eHi \u003ca href=\"/francisbeaudoin\"\u003e@francisbeaudoin\u003c/a\u003e,\u003cbr\u003e\nThank you for following up! \u003cbr\u003e\nI am not quite able to reproduce this, unless I log into the device as the account owner (when providing the initial username/password to POS). Can you confirm that you did in fact login to the device with the admin credentials for a Full Permissions user and not the account owner? From our logs, it appears that the account owner was associated with that invite request, which would be the case if the account owner was the one who logged into the terminal.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-09-18T15:16:41.823Z","updated_at":"2020-09-18T15:16:41.823Z","actor":{"username":"jenn-shopify","cleared":false,"url":"/jenn-shopify","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9258685,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Just tested and you're right. To get access shop owner only actions from the **Plans \u0026 Permissions** page, the shop owner must have been the one logged into the terminal.\n\nTherefore, the following report is limited by the fact that the shop owner must be the one logged into the terminal.\n\nSorry for confusion\n","markdown_message":"\u003cp\u003eJust tested and you\u0026#39;re right. To get access shop owner only actions from the \u003cstrong\u003ePlans \u0026amp; Permissions\u003c/strong\u003e page, the shop owner must have been the one logged into the terminal.\u003c/p\u003e\n\n\u003cp\u003eTherefore, the following report is limited by the fact that the shop owner must be the one logged into the terminal.\u003c/p\u003e\n\n\u003cp\u003eSorry for confusion\u003c/p\u003e\n","automated_response":false,"created_at":"2020-09-18T15:44:11.491Z","updated_at":"2020-09-18T15:54:33.394Z","actor":{"username":"francisbeaudoin","cleared":false,"url":"/francisbeaudoin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/apkjpoNQK4P5JD7rCFCB2hcf/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9261821,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hey @francisbeaudoin,\nThanks for confirming that! I've looked into this issue and chatted with our engineering team. \n\nThough this same result could be obtained by stealing the access token used by POS (known behaviour, as discussed previously), we think you're right that this situation is a bit different. In this case the UI itself has a flow that allows this kind of abuse during regular use in POS. For this reason, we've decided to triage this issue and prevent this flow from within POS.\n\nNote though that this issue has some mitigating factors that lessen the severity:\n* The user logged into the POS terminal must be the account owner\n* The POS user exploiting this issue must have the Staff Management retail permission\n* A persistent attacker with physical access to the device could achieve a similar result by stealing the access token being used by POS\n\nWe'll be in touch early next week with a decision regarding bounty eligibility.","markdown_message":"\u003cp\u003eHey \u003ca href=\"/francisbeaudoin\"\u003e@francisbeaudoin\u003c/a\u003e,\u003cbr\u003e\nThanks for confirming that! I\u0026#39;ve looked into this issue and chatted with our engineering team. \u003c/p\u003e\n\n\u003cp\u003eThough this same result could be obtained by stealing the access token used by POS (known behaviour, as discussed previously), we think you\u0026#39;re right that this situation is a bit different. In this case the UI itself has a flow that allows this kind of abuse during regular use in POS. For this reason, we\u0026#39;ve decided to triage this issue and prevent this flow from within POS.\u003c/p\u003e\n\n\u003cp\u003eNote though that this issue has some mitigating factors that lessen the severity:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eThe user logged into the POS terminal must be the account owner\u003c/li\u003e\n\u003cli\u003eThe POS user exploiting this issue must have the Staff Management retail permission\u003c/li\u003e\n\u003cli\u003eA persistent attacker with physical access to the device could achieve a similar result by stealing the access token being used by POS\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eWe\u0026#39;ll be in touch early next week with a decision regarding bounty eligibility.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-09-18T21:18:41.487Z","updated_at":"2020-09-18T21:18:41.487Z","actor":{"username":"jenn-shopify","cleared":false,"url":"/jenn-shopify","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9299881,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks again for your report. After taking into consideration the security impact and mitigating factors mentioned in our previous response, we've decided to award a $1,000 bounty for this issue.\n\nWe'll be in touch again once the issue is resolved.","markdown_message":"\u003cp\u003eThanks again for your report. After taking into consideration the security impact and mitigating factors mentioned in our previous response, we\u0026#39;ve decided to award a $1,000 bounty for this issue.\u003c/p\u003e\n\n\u003cp\u003eWe\u0026#39;ll be in touch again once the issue is resolved.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-09-22T20:40:47.164Z","updated_at":"2020-09-22T20:40:47.164Z","actor":{"url":"/shopify","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Shopify"}},"bounty_amount":"1000.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"shopify","collaborator":{"username":"francisbeaudoin","url":"/francisbeaudoin"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9300056,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Awesome, thanks!","markdown_message":"\u003cp\u003eAwesome, thanks!\u003c/p\u003e\n","automated_response":false,"created_at":"2020-09-22T21:08:13.515Z","updated_at":"2020-09-22T21:08:13.515Z","actor":{"username":"francisbeaudoin","cleared":false,"url":"/francisbeaudoin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/apkjpoNQK4P5JD7rCFCB2hcf/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9575942,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks again for your report. We removed the \"Manage POS roles\" button in version 6.21.0 of Point of Sale, so we now consider this issue resolved.\n\nWe look forward to hearing from you again soon. Happy hacking!","markdown_message":"\u003cp\u003eThanks again for your report. We removed the \u0026quot;Manage POS roles\u0026quot; button in version 6.21.0 of Point of Sale, so we now consider this issue resolved.\u003c/p\u003e\n\n\u003cp\u003eWe look forward to hearing from you again soon. Happy hacking!\u003c/p\u003e\n","automated_response":false,"created_at":"2020-10-20T13:10:02.005Z","updated_at":"2020-10-20T13:10:02.005Z","actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"francisbeaudoin","url":"/francisbeaudoin"},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9605441,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-10-22T17:42:24.853Z","updated_at":"2020-10-22T17:42:24.853Z","first_to_agree":true,"actor":{"username":"alex_richter","cleared":false,"url":"/alex_richter","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9605724,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Could you please redact any email (*@fb...) and remove the attachment (demo) before we disclose ?","markdown_message":"\u003cp\u003eCould you please redact any email (*@fb...) and remove the attachment (demo) before we disclose ?\u003c/p\u003e\n","automated_response":false,"created_at":"2020-10-22T18:16:40.177Z","updated_at":"2020-10-22T18:16:40.177Z","actor":{"username":"francisbeaudoin","cleared":false,"url":"/francisbeaudoin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/apkjpoNQK4P5JD7rCFCB2hcf/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9869949,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-11-19T16:23:26.739Z","updated_at":"2020-11-19T16:23:26.739Z","actor":{"username":"francisbeaudoin","cleared":false,"url":"/francisbeaudoin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/apkjpoNQK4P5JD7rCFCB2hcf/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9869950,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-11-19T16:23:26.795Z","updated_at":"2020-11-19T16:23:26.795Z","actor":{"username":"francisbeaudoin","cleared":false,"url":"/francisbeaudoin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/apkjpoNQK4P5JD7rCFCB2hcf/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":24966,"category":"team","content":"@francisbeaudoin reported an issue where a malicious staff member on a Point of Sale device was able to add staff members to the Shopify admin of the store.\n\nThough this same result could be obtained by stealing the access token used by POS (known behaviour), in this case the UI itself has a flow that allows a user who would normally only have access to point of sale to access the web administrative interface.\n\nMitigating factors for this issue included:\n\n* The user logged into the POS terminal must be the account owner\n* The POS user exploiting this issue must have the Staff Management retail permission\n* A persistent attacker with physical access to the device could achieve a similar result by stealing the access token being used by POS","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003e\u003ca href=\"/francisbeaudoin\"\u003e@francisbeaudoin\u003c/a\u003e reported an issue where a malicious staff member on a Point of Sale device was able to add staff members to the Shopify admin of the store.\u003c/p\u003e\n\n\u003cp\u003eThough this same result could be obtained by stealing the access token used by POS (known behaviour), in this case the UI itself has a flow that allows a user who would normally only have access to point of sale to access the web administrative interface.\u003c/p\u003e\n\n\u003cp\u003eMitigating factors for this issue included:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eThe user logged into the POS terminal must be the account owner\u003c/li\u003e\n\u003cli\u003eThe POS user exploiting this issue must have the Staff Management retail permission\u003c/li\u003e\n\u003cli\u003eA persistent attacker with physical access to the device could achieve a similar result by stealing the access token being used by POS\u003c/li\u003e\n\u003c/ul\u003e\n"},{"category":"researcher","can_view?":true,"can_create?":false}]}