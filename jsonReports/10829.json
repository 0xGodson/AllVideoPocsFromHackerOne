{"id":10829,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMDgyOQ==","url":"https://hackerone.com/reports/10829","title":"CSRF in function \"Set as primary\" on  accounts page","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2014-05-03T19:46:07.517Z","submitted_at":"2014-05-03T19:46:07.517Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"0ctac0der","url":"/0ctac0der","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/002/591/9d53addf5673c04320d3f2de23c800faf96b5d65_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":104,"url":"https://hackerone.com/coinbase","handle":"coinbase","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/104/b151e01a4adbf5ad9067fc30fb2dfe5d5997fa5c_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/104/b151e01a4adbf5ad9067fc30fb2dfe5d5997fa5c_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Coinbase","twitter_handle":"","website":"https://coinbase.com/security","about":"Creating an open financial system for the world"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2014-06-06T04:56:45.797Z","bug_reporter_agreed_on_going_public_at":"2014-05-07T14:20:24.273Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"I would like to report this CSRF vulnerability in coinbase on function \"set as primary\" for a account in accounts page. \r\n\r\nSteps:\r\n1) Login to your coinbase account (which atleast has two accounts)\r\n2) Go to \"accounts\" page and out of the two accounts click \"set as primary\" link for one of the accounts which is not primary.\r\n3) Capturing the request in proxy, you will find that there are no anti CSRF token used for this function. \r\n\r\nIssue: Attacker simply send a link of a page to the victim with a iframe running something like this \"https://coinbase.com/accounts/535e52d301c95bda2100005b/set_as_primary\". When the victim will click the link of coinbase will get executed in the back without victims consent. \r\n\r\nNOTE: In the POC video attached, i have tried to show that for the delete account function there is an \"authenticity token\" sent but for set as primary function there is no token used, which might cause a CSRF on this. ","vulnerability_information_html":"\u003cp\u003eI would like to report this CSRF vulnerability in coinbase on function \u0026quot;set as primary\u0026quot; for a account in accounts page. \u003c/p\u003e\n\n\u003cp\u003eSteps:\u003cbr\u003e\n1) Login to your coinbase account (which atleast has two accounts)\u003cbr\u003e\n2) Go to \u0026quot;accounts\u0026quot; page and out of the two accounts click \u0026quot;set as primary\u0026quot; link for one of the accounts which is not primary.\u003cbr\u003e\n3) Capturing the request in proxy, you will find that there are no anti CSRF token used for this function. \u003c/p\u003e\n\n\u003cp\u003eIssue: Attacker simply send a link of a page to the victim with a iframe running something like this \u0026quot;\u003ca title=\"https://coinbase.com/accounts/535e52d301c95bda2100005b/set_as_primary\" href=\"/redirect?url=https%3A%2F%2Fcoinbase.com%2Faccounts%2F535e52d301c95bda2100005b%2Fset_as_primary\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://coinbase.com/accounts/535e52d301c95bda2100005b/set_as_primary\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u0026quot;. When the victim will click the link of coinbase will get executed in the back without victims consent. \u003c/p\u003e\n\n\u003cp\u003eNOTE: In the POC video attached, i have tried to show that for the delete account function there is an \u0026quot;authenticity token\u0026quot; sent but for set as primary function there is no token used, which might cause a CSRF on this. \u003c/p\u003e\n","bounty_amount":"100.0","formatted_bounty":"$100","weakness":{"id":45,"name":"Cross-Site Request Forgery (CSRF)"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2014-06-06T04:56:33.948Z","allow_singular_disclosure_after":-207184720.71513548,"singular_disclosure_allowed":true,"vote_count":0,"voters":[],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":43826,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Sorry about the quality of video, i had to compress it because of upload size limit in hackerone. ","markdown_message":"\u003cp\u003eSorry about the quality of video, i had to compress it because of upload size limit in hackerone. \u003c/p\u003e\n","automated_response":false,"created_at":"2014-05-03T19:52:53.865Z","updated_at":"2014-05-03T19:52:53.865Z","actor":{"username":"0ctac0der","cleared":false,"url":"/0ctac0der","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/591/9d53addf5673c04320d3f2de23c800faf96b5d65_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":45433,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hi - Confirm fix please?","markdown_message":"\u003cp\u003eHi - Confirm fix please?\u003c/p\u003e\n","automated_response":false,"created_at":"2014-05-07T02:54:47.602Z","updated_at":"2014-05-07T02:54:47.602Z","actor":{"username":"magoo","cleared":false,"url":"/magoo","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/044/c5a0272bf5bace329125da5217384d22c444edb3_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":45460,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Yes, its fixed as i see... everything in cookie plus a _ok value does all. \n\nThanks for a prompt action. :)","markdown_message":"\u003cp\u003eYes, its fixed as i see... everything in cookie plus a _ok value does all. \u003c/p\u003e\n\n\u003cp\u003eThanks for a prompt action. :)\u003c/p\u003e\n","automated_response":false,"created_at":"2014-05-07T03:47:20.697Z","updated_at":"2014-05-07T03:47:20.697Z","actor":{"username":"0ctac0der","cleared":false,"url":"/0ctac0der","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/591/9d53addf5673c04320d3f2de23c800faf96b5d65_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":45531,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Closing. Since this isn't really exploitable in any deeply harmful way, we'll be rewarding the defense in depth bounty.","markdown_message":"\u003cp\u003eClosing. Since this isn\u0026#39;t really exploitable in any deeply harmful way, we\u0026#39;ll be rewarding the defense in depth bounty.\u003c/p\u003e\n","automated_response":false,"created_at":"2014-05-07T04:56:33.985Z","updated_at":"2014-05-07T04:56:33.985Z","actor":{"username":"magoo","cleared":false,"url":"/magoo","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/044/c5a0272bf5bace329125da5217384d22c444edb3_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"0ctac0der","url":"/0ctac0der"},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":45532,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2014-05-07T04:56:42.797Z","updated_at":"2014-05-07T04:56:42.797Z","actor":{"url":"/coinbase","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/104/b151e01a4adbf5ad9067fc30fb2dfe5d5997fa5c_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Coinbase"}},"bounty_amount":"100.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"coinbase","collaborator":{"username":"0ctac0der","url":"/0ctac0der"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":45557,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for the reward, but i was expecting a better reward for A8 in owasp top 10. Can't say much about the harm, but its very easily exploitable as i can see . \n\n:) I appreciate the prompt action and responses. Its my first bounty :)","markdown_message":"\u003cp\u003eThanks for the reward, but i was expecting a better reward for A8 in owasp top 10. Can\u0026#39;t say much about the harm, but its very easily exploitable as i can see . \u003c/p\u003e\n\n\u003cp\u003e:) I appreciate the prompt action and responses. Its my first bounty :)\u003c/p\u003e\n","automated_response":false,"created_at":"2014-05-07T05:17:18.739Z","updated_at":"2014-05-07T05:17:18.739Z","actor":{"username":"0ctac0der","cleared":false,"url":"/0ctac0der","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/591/9d53addf5673c04320d3f2de23c800faf96b5d65_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":45935,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2014-05-07T14:20:24.291Z","updated_at":"2014-05-07T14:20:24.291Z","actor":{"username":"0ctac0der","cleared":false,"url":"/0ctac0der","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/591/9d53addf5673c04320d3f2de23c800faf96b5d65_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":67724,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2014-06-06T04:56:45.854Z","updated_at":"2014-06-06T04:56:45.854Z","actor":{"url":"/coinbase","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/104/b151e01a4adbf5ad9067fc30fb2dfe5d5997fa5c_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Coinbase"}},"genius_execution_id":null,"team_handle":"coinbase","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}