{"id":129992,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMjk5OTI=","url":"https://hackerone.com/reports/129992","title":"Missing Certificate Authority Authorization rule","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-04-12T08:02:44.567Z","submitted_at":"2016-04-12T08:02:44.567Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"ericlaw","url":"/ericlaw","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/012/681/97a3578539afb62f396f9aa2c7cac59a8cadaca9_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13,"url":"https://hackerone.com/security","handle":"security","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"HackerOne","twitter_handle":"Hacker0x01","website":"https://hackerone.com","about":"Vulnerability disclosure should be safe, transparent, and rewarding."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-08-17T02:55:24.775Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2017-07-18T02:55:10.038Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Certificate Authority Authorization (supported by LetsEncrypt and other CAs) allows a domain owner to specify which Certificate Authorities should be allowed to issue certificates for the domain. All CAA-compliant certificate authorities should refuse to issue a certificate unless they are the CA of record for the target site. This helps reduce the threat of a bad guy tricking a Certificate Authority into issuing a phony certificate for your site.\n\nThe CAA rule is stored as a DNS resource record of type 257. You can view a domain’s CAA rule using a DNS lookup service:\n\nhttps://dns.google.com/query?name=hackerone.com\u0026type=257\u0026dnssec=true\n\nHackerone should set a CAA record to help prevent misissuance of a certificate for its domains.","vulnerability_information_html":"\u003cp\u003eCertificate Authority Authorization (supported by LetsEncrypt and other CAs) allows a domain owner to specify which Certificate Authorities should be allowed to issue certificates for the domain. All CAA-compliant certificate authorities should refuse to issue a certificate unless they are the CA of record for the target site. This helps reduce the threat of a bad guy tricking a Certificate Authority into issuing a phony certificate for your site.\u003c/p\u003e\n\n\u003cp\u003eThe CAA rule is stored as a DNS resource record of type 257. You can view a domain’s CAA rule using a DNS lookup service:\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"https://dns.google.com/query?name=hackerone.com\u0026amp;type=257\u0026amp;dnssec=true\" href=\"/redirect?url=https%3A%2F%2Fdns.google.com%2Fquery%3Fname%3Dhackerone.com%26type%3D257%26dnssec%3Dtrue\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://dns.google.com/query?name=hackerone.com\u0026amp;type=257\u0026amp;dnssec=true\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eHackerone should set a CAA record to help prevent misissuance of a certificate for its domains.\u003c/p\u003e\n","weakness":{"id":32,"name":"Cryptographic Issues - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2017-08-17T02:55:10.073Z","allow_singular_disclosure_after":-106277363.32769154,"singular_disclosure_allowed":true,"vote_count":18,"voters":["cuso4","gamliel","eveeez","r3y","apapedulimu","gujjuboy10x00","mr_r3boot","jackb898","silv3rpoision","japz","and 8 more..."],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":901489,"is_internal":false,"editable":false,"type":"Activities::BugDuplicate","message":"@ericlaw -- sadly, CloudFlare does not support CAA records (RFC 6844), and we're at their mercy for DNS with our current setup. I've asked them before about this, and I just raised it again with them. They confirmed it's not supported and have no ETA for when it will be added. Guess just not many customers asking for this, so it's not prioritized. :(\n\nGoing to mark this as a duplicate, as I was already tracking it internally, and once support is added, we definitely will be using it.\n\nAs a side note, we are testing HPKP and will be rolling that out in enforcement mode shortly. We'll also be getting HPKP pinned in the browsers as well, so should help against rogue CA certs.","markdown_message":"\u003cp\u003e\u003ca href=\"/ericlaw\"\u003e@ericlaw\u003c/a\u003e -- sadly, CloudFlare does not support CAA records (RFC 6844), and we\u0026#39;re at their mercy for DNS with our current setup. I\u0026#39;ve asked them before about this, and I just raised it again with them. They confirmed it\u0026#39;s not supported and have no ETA for when it will be added. Guess just not many customers asking for this, so it\u0026#39;s not prioritized. :(\u003c/p\u003e\n\n\u003cp\u003eGoing to mark this as a duplicate, as I was already tracking it internally, and once support is added, we definitely will be using it.\u003c/p\u003e\n\n\u003cp\u003eAs a side note, we are testing HPKP and will be rolling that out in enforcement mode shortly. We\u0026#39;ll also be getting HPKP pinned in the browsers as well, so should help against rogue CA certs.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-12T14:46:56.127Z","updated_at":"2016-04-12T14:46:56.127Z","actor":{"username":"reed","cleared":false,"url":"/reed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1845157,"is_internal":false,"editable":false,"type":"Activities::BugReopened","message":"CAA for `hackerone.com` was configured a few weeks ago. Reopening this and re-closing it as resolved.","markdown_message":"\u003cp\u003eCAA for \u003ccode\u003ehackerone.com\u003c/code\u003e was configured a few weeks ago. Reopening this and re-closing it as resolved.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-07-18T02:54:42.473Z","updated_at":"2017-07-18T02:54:42.473Z","actor":{"username":"reed","cleared":false,"url":"/reed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1845158,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2017-07-18T02:54:57.563Z","updated_at":"2017-07-18T02:54:57.563Z","actor":{"username":"reed","cleared":false,"url":"/reed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"reporter":{"username":"ericlaw","url":"/ericlaw"},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1845159,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"","markdown_message":"","automated_response":false,"created_at":"2017-07-18T02:55:03.216Z","updated_at":"2017-07-18T02:55:03.216Z","actor":{"url":"/security","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"HackerOne"}},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1845160,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-07-18T02:55:10.056Z","updated_at":"2017-07-18T02:55:10.056Z","first_to_agree":true,"actor":{"username":"reed","cleared":false,"url":"/reed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1935101,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-08-17T02:55:24.806Z","updated_at":"2017-08-17T02:55:24.806Z","actor":{"url":"/security","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"HackerOne"}},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}