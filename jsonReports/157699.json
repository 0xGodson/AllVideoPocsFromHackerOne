{"id":157699,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNTc2OTk=","url":"https://hackerone.com/reports/157699","title":"Disclosure of external users invited to a specific report","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-08-08T19:39:31.359Z","submitted_at":"2016-08-08T19:39:31.359Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"kirils","url":"/kirils","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/044/102/0ce8761f69a2583941a773f913880a5dbf0eb068_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13,"url":"https://hackerone.com/security","handle":"security","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"HackerOne","twitter_handle":"Hacker0x01","website":"https://hackerone.com","about":"Vulnerability disclosure should be safe, transparent, and rewarding."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2016-09-01T07:21:43.727Z","bug_reporter_agreed_on_going_public_at":"2016-08-19T12:24:10.753Z","team_member_agreed_on_going_public_at":"2016-09-01T07:21:43.603Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"It is possible to verify whether a specific user is invited to participate _as an external user_ to a specific report.\nThus it is possible to enumerate all external users added to a specific (non-public) report of interest.\n\n**PoC:**\n```curl 'https://hackerone.com/reports/(**report_id**)/external_users/(**user_id**)' -X DELETE -H 'User-Agent: Mozilla/5.0' -H 'Accept: application/json, text/javascript, */*; q=0.01' -H 'X-CSRF-Token: (**session**)' -H 'X-Requested-With: XMLHttpRequest' -H 'Cookie: (**session**)' -D-```\n\n```session``` parameters must be copied from a recent request in legitimate user's session.\n\nDifferent HTTP status codes will be returned depending on whether the user is participating as an external user for a specific report:\n - HTTP/1.1 404 Not Found =\u003e **yes**\n - HTTP/1.1 500 Internal Server Error =\u003e **no**\n - (HTTP/1.1 412 Precondition Failed means you provided invalid session parameters)\n\n\n```user_id``` can either be enumerated from 1000 up, or for a more realistic scenario, user ID can be gathered from https://hackerone.com/leaderboard/all-time or https://hackerone.com/hacktivity/new.\nID of a specific username can of course be pulled by any visitor even without authentication: ```curl 'https://hackerone.com/(**username**)' -H 'Accept: application/json, text/javascript, */*; q=0.01' -H 'X-Requested-With: XMLHttpRequest'``` \n\n**Impact:**\nThis vulnerability may prove critical for non-resolved reports. This basically provides an attacker a list of researchers who know about an existing 0day and are not getting paid.\n\nUnfortunately more and more of the researchers on h1 are proving to be greedy (see #154096 et al.) or at least \"in-for-the-money\". These people could easily succumb to a black market offer from the attacker and you've just given him the list of researchers to contact.\n\n**Suggested fix:**\nCheck access rights to the report_id first and make sure to return the same status code and content in both cases. For extra measure make sure to drop out of execution flow at a single location to curb timing side channel attacks.","vulnerability_information_html":"\u003cp\u003eIt is possible to verify whether a specific user is invited to participate \u003cu\u003eas an external user\u003c/u\u003e to a specific report.\u003cbr\u003e\nThus it is possible to enumerate all external users added to a specific (non-public) report of interest.\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003ePoC:\u003c/strong\u003e\u003cbr\u003e\n\u003ccode\u003ecurl \u0026#39;https://hackerone.com/reports/(**report_id**)/external_users/(**user_id**)\u0026#39; -X DELETE -H \u0026#39;User-Agent: Mozilla/5.0\u0026#39; -H \u0026#39;Accept: application/json, text/javascript, */*; q=0.01\u0026#39; -H \u0026#39;X-CSRF-Token: (**session**)\u0026#39; -H \u0026#39;X-Requested-With: XMLHttpRequest\u0026#39; -H \u0026#39;Cookie: (**session**)\u0026#39; -D-\u003c/code\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003ccode\u003esession\u003c/code\u003e parameters must be copied from a recent request in legitimate user\u0026#39;s session.\u003c/p\u003e\n\n\u003cp\u003eDifferent HTTP status codes will be returned depending on whether the user is participating as an external user for a specific report:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eHTTP/1.1 404 Not Found =\u0026gt; \u003cstrong\u003eyes\u003c/strong\u003e\n\u003c/li\u003e\n\u003cli\u003eHTTP/1.1 500 Internal Server Error =\u0026gt; \u003cstrong\u003eno\u003c/strong\u003e\n\u003c/li\u003e\n\u003cli\u003e(HTTP/1.1 412 Precondition Failed means you provided invalid session parameters)\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003e\u003ccode\u003euser_id\u003c/code\u003e can either be enumerated from 1000 up, or for a more realistic scenario, user ID can be gathered from \u003ca title=\"https://hackerone.com/leaderboard/all-time\" href=\"https://hackerone.com/leaderboard/all-time\"\u003ehttps://hackerone.com/leaderboard/all-time\u003c/a\u003e or \u003ca title=\"https://hackerone.com/hacktivity/new\" href=\"https://hackerone.com/hacktivity/new\"\u003ehttps://hackerone.com/hacktivity/new\u003c/a\u003e.\u003cbr\u003e\nID of a specific username can of course be pulled by any visitor even without authentication: \u003ccode\u003ecurl \u0026#39;https://hackerone.com/(**username**)\u0026#39; -H \u0026#39;Accept: application/json, text/javascript, */*; q=0.01\u0026#39; -H \u0026#39;X-Requested-With: XMLHttpRequest\u0026#39;\u003c/code\u003e \u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eImpact:\u003c/strong\u003e\u003cbr\u003e\nThis vulnerability may prove critical for non-resolved reports. This basically provides an attacker a list of researchers who know about an existing 0day and are not getting paid.\u003c/p\u003e\n\n\u003cp\u003eUnfortunately more and more of the researchers on h1 are proving to be greedy (see \u003ca href=\"/reports/154096\"\u003e#154096\u003c/a\u003e et al.) or at least \u0026quot;in-for-the-money\u0026quot;. These people could easily succumb to a black market offer from the attacker and you\u0026#39;ve just given him the list of researchers to contact.\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eSuggested fix:\u003c/strong\u003e\u003cbr\u003e\nCheck access rights to the report_id first and make sure to return the same status code and content in both cases. For extra measure make sure to drop out of execution flow at a single location to curb timing side channel attacks.\u003c/p\u003e\n","bounty_amount":"500.0","formatted_bounty":"$500","weakness":{"id":18,"name":"Information Disclosure"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2016-09-18T12:24:10.951Z","allow_singular_disclosure_after":-135015085.67906883,"singular_disclosure_allowed":true,"vote_count":8,"voters":["r3y","ymy","japz","spetr0x","0619","jrobot0x7","dyabla","hackirwanchosen1"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1113715,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey kirils!\n\nInteresting find. A few questions:\n- This requires the attacker to acquire valid session information from a victim's current log in. Correct?\n- Can this victim be any person, or does the victim have to have any relation to the report/team/reporter?\n\nAlso realistically: \n- Is there a way to differentiate if it is a valid report or an NA or informative report?\n\nThanks!\n\n-vwv","markdown_message":"\u003cp\u003eHey kirils!\u003c/p\u003e\n\n\u003cp\u003eInteresting find. A few questions:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eThis requires the attacker to acquire valid session information from a victim\u0026#39;s current log in. Correct?\u003c/li\u003e\n\u003cli\u003eCan this victim be any person, or does the victim have to have any relation to the report/team/reporter?\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eAlso realistically: \u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eIs there a way to differentiate if it is a valid report or an NA or informative report?\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eThanks!\u003c/p\u003e\n\n\u003cp\u003e-vwv\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-08T22:13:20.738Z","updated_at":"2016-08-08T22:13:20.738Z","actor":{"username":"vwv","cleared":false,"url":"/vwv","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/018/657/6013b6e14358165515258ba7cb8c1597c7901062_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1114248,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"No, we do not need victims session. That would be...not a hack. This requires an attacker to simply have valid session information, so registering a fresh user would suffice.\n\nIn my tests \"victim\" is anyone who's been added as an _external_user_ to a report regardless of any relationship.\n\nOn the execution part:\nThere are two separate scenarios to realistically learn of users with knowledge of legit reports.\n1. When compiling a list of external_users on a report, check the signal of those users. Apply some trivial statistical methods and you've got yourself a solid probability if a report is valid. (A way to explain this without math — You've got two users who are rarely wrong as external users to a report? You've probably got yourself a valid issue.)\n1. Rather then enumerating users per report, enumerate reports for each of the users of interest. Find the users who have been added as external users to the highest number of reports. Talk to them and you might get yourself a deal.","markdown_message":"\u003cp\u003eNo, we do not need victims session. That would be...not a hack. This requires an attacker to simply have valid session information, so registering a fresh user would suffice.\u003c/p\u003e\n\n\u003cp\u003eIn my tests \u0026quot;victim\u0026quot; is anyone who\u0026#39;s been added as an \u003cu\u003eexternal_user\u003c/u\u003e to a report regardless of any relationship.\u003c/p\u003e\n\n\u003cp\u003eOn the execution part:\u003cbr\u003e\nThere are two separate scenarios to realistically learn of users with knowledge of legit reports.\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eWhen compiling a list of external_users on a report, check the signal of those users. Apply some trivial statistical methods and you\u0026#39;ve got yourself a solid probability if a report is valid. (A way to explain this without math — You\u0026#39;ve got two users who are rarely wrong as external users to a report? You\u0026#39;ve probably got yourself a valid issue.)\u003c/li\u003e\n\u003cli\u003eRather then enumerating users per report, enumerate reports for each of the users of interest. Find the users who have been added as external users to the highest number of reports. Talk to them and you might get yourself a deal.\u003c/li\u003e\n\u003c/ol\u003e\n","automated_response":false,"created_at":"2016-08-09T07:05:28.437Z","updated_at":"2016-08-09T07:05:28.437Z","actor":{"username":"kirils","cleared":false,"url":"/kirils","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/044/102/0ce8761f69a2583941a773f913880a5dbf0eb068_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1116258,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello kirils,\n\nI haven't been able to reproduce a 500 error code. Do you have an example by any chance?\n\n-vwv","markdown_message":"\u003cp\u003eHello kirils,\u003c/p\u003e\n\n\u003cp\u003eI haven\u0026#39;t been able to reproduce a 500 error code. Do you have an example by any chance?\u003c/p\u003e\n\n\u003cp\u003e-vwv\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-10T01:39:19.080Z","updated_at":"2016-08-10T01:39:19.080Z","actor":{"username":"vwv","cleared":false,"url":"/vwv","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/018/657/6013b6e14358165515258ba7cb8c1597c7901062_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1116648,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Sure. Here are the detailed steps to reproduce:\n1. Register and confirm a new test user.\n1. Log in.\n1. Grab the parameters of a recent XML request. Extract X-CSRF-Token and the Cookies from it:\n```\n'X-CSRF-Token: ███'\n'Cookie: __cfduid=████████; __Host-session=██████████'\n```\n1. Close the browser without logging out.\n1. Run ```curl -D- 'https://hackerone.com/reports/█████/external_users/███████' -X DELETE -H 'Host: hackerone.com' -H 'User-Agent: Mozilla/5.0' -H 'Accept: application/json, text/javascript, */*; q=0.01' -H 'X-Requested-With: XMLHttpRequest' -H 'X-CSRF-Token: ███' -H 'Cookie: __cfduid=███████; __Host-session=████████'``` -\u003e **404**\n1. Run ```curl -D- 'https://hackerone.com/reports/██████████/external_users/███' -X DELETE -H 'Host: hackerone.com' -H 'User-Agent: Mozilla/5.0' -H 'Accept: application/json, text/javascript, */*; q=0.01' -H 'X-Requested-With: XMLHttpRequest' -H 'X-CSRF-Token: ██████████' -H 'Cookie: __cfduid=█████; __Host-session=████████'``` -\u003e **500**\n\nLet me know if you need me to create a screencast.\nIt would be great if you could anonymize the data in this comment later on.\n","markdown_message":"\u003cp\u003eSure. Here are the detailed steps to reproduce:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eRegister and confirm a new test user.\u003c/li\u003e\n\u003cli\u003eLog in.\u003c/li\u003e\n\u003cli\u003eGrab the parameters of a recent XML request. Extract X-CSRF-Token and the Cookies from it:\n\u003ccode\u003e\n\u0026#39;X-CSRF-Token: ███\u0026#39;\n\u0026#39;Cookie: __cfduid=████████; __Host-session=██████████\u0026#39;\n\u003c/code\u003e\n\u003c/li\u003e\n\u003cli\u003eClose the browser without logging out.\u003c/li\u003e\n\u003cli\u003eRun \u003ccode\u003ecurl -D- \u0026#39;https://hackerone.com/reports/█████/external_users/███████\u0026#39; -X DELETE -H \u0026#39;Host: hackerone.com\u0026#39; -H \u0026#39;User-Agent: Mozilla/5.0\u0026#39; -H \u0026#39;Accept: application/json, text/javascript, */*; q=0.01\u0026#39; -H \u0026#39;X-Requested-With: XMLHttpRequest\u0026#39; -H \u0026#39;X-CSRF-Token: ███\u0026#39; -H \u0026#39;Cookie: __cfduid=███████; __Host-session=████████\u0026#39;\u003c/code\u003e -\u0026gt; \u003cstrong\u003e404\u003c/strong\u003e\n\u003c/li\u003e\n\u003cli\u003eRun \u003ccode\u003ecurl -D- \u0026#39;https://hackerone.com/reports/██████████/external_users/███\u0026#39; -X DELETE -H \u0026#39;Host: hackerone.com\u0026#39; -H \u0026#39;User-Agent: Mozilla/5.0\u0026#39; -H \u0026#39;Accept: application/json, text/javascript, */*; q=0.01\u0026#39; -H \u0026#39;X-Requested-With: XMLHttpRequest\u0026#39; -H \u0026#39;X-CSRF-Token: ██████████\u0026#39; -H \u0026#39;Cookie: __cfduid=█████; __Host-session=████████\u0026#39;\u003c/code\u003e -\u0026gt; \u003cstrong\u003e500\u003c/strong\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eLet me know if you need me to create a screencast.\u003cbr\u003e\nIt would be great if you could anonymize the data in this comment later on.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-10T09:01:59.198Z","updated_at":"2016-08-19T07:45:08.366Z","actor":{"username":"kirils","cleared":false,"url":"/kirils","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/044/102/0ce8761f69a2583941a773f913880a5dbf0eb068_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1116971,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @kirils,\n\nThank you for your detailed description, I've managed to reproduce this, and have redacted the information from the report. (I will redact the report ID and external user ID from before disclosure)\n\nWe're going to do a root cause analysis of this to see if there are any mitigating factors in play, but it looks like you're on to something!\n\nKind regards,\n@dirk","markdown_message":"\u003cp\u003eHey \u003ca href=\"/kirils\"\u003e@kirils\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThank you for your detailed description, I\u0026#39;ve managed to reproduce this, and have redacted the information from the report. (I will redact the report ID and external user ID from before disclosure)\u003c/p\u003e\n\n\u003cp\u003eWe\u0026#39;re going to do a root cause analysis of this to see if there are any mitigating factors in play, but it looks like you\u0026#39;re on to something!\u003c/p\u003e\n\n\u003cp\u003eKind regards,\u003cbr\u003e\n\u003ca href=\"/dirk\"\u003e@dirk\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-10T12:28:06.018Z","updated_at":"2016-08-10T12:28:06.018Z","actor":{"username":"dirk","cleared":false,"url":"/dirk","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/067/f9785240873663ec965b04e725871ed0f69616e7_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1117068,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Good to hear that and thanks!\nKeep me posted.","markdown_message":"\u003cp\u003eGood to hear that and thanks!\u003cbr\u003e\nKeep me posted.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-10T13:45:55.143Z","updated_at":"2016-08-10T13:45:55.143Z","actor":{"username":"kirils","cleared":false,"url":"/kirils","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/044/102/0ce8761f69a2583941a773f913880a5dbf0eb068_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1117196,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2016-08-10T14:56:23.840Z","updated_at":"2016-08-10T14:56:23.840Z","actor":{"username":"dirk","cleared":false,"url":"/dirk","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/067/f9785240873663ec965b04e725871ed0f69616e7_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1130869,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @kirils,\n\nWe're working on a fix for this, so we should hopefully have something for you to test soon. Thank you for your patience!","markdown_message":"\u003cp\u003eHi \u003ca href=\"/kirils\"\u003e@kirils\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eWe\u0026#39;re working on a fix for this, so we should hopefully have something for you to test soon. Thank you for your patience!\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-17T00:56:18.905Z","updated_at":"2016-08-17T00:56:18.905Z","actor":{"username":"andrewone","cleared":false,"url":"/andrewone","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/236/a5d3675b5d06cc936fbcc467cc8643e779371f3a_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1135117,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"@kirils, a fix has been released. You shouldn't be able to see any differences in server response anymore. Can you verify that this is the case?","markdown_message":"\u003cp\u003e\u003ca href=\"/kirils\"\u003e@kirils\u003c/a\u003e, a fix has been released. You shouldn\u0026#39;t be able to see any differences in server response anymore. Can you verify that this is the case?\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-18T18:46:26.957Z","updated_at":"2016-08-18T18:46:26.957Z","actor":{"username":"andrewone","cleared":false,"url":"/andrewone","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/236/a5d3675b5d06cc936fbcc467cc8643e779371f3a_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"kirils","url":"/kirils"},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1139410,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@andrewone, **fix is confirmed**.\nI diffed ```|cut -d : -f 1|grep \\  |cut -d \\  -f 2-|uniq``` and the only difference was these headers:\n```\nDate\nCf-Railgun\nSet-Cookie\nX-Request-Id\nCF-RAY\n```\nso we're good.\n\n@dirk, did you find any mitigating factors?","markdown_message":"\u003cp\u003e\u003ca href=\"/andrewone\"\u003e@andrewone\u003c/a\u003e, \u003cstrong\u003efix is confirmed\u003c/strong\u003e.\u003cbr\u003e\nI diffed \u003ccode\u003e|cut -d : -f 1|grep \\  |cut -d \\  -f 2-|uniq\u003c/code\u003e and the only difference was these headers:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eDate\nCf-Railgun\nSet-Cookie\nX-Request-Id\nCF-RAY\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eso we\u0026#39;re good.\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"/dirk\"\u003e@dirk\u003c/a\u003e, did you find any mitigating factors?\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-19T04:18:07.396Z","updated_at":"2016-08-19T04:18:07.396Z","actor":{"username":"kirils","cleared":false,"url":"/kirils","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/044/102/0ce8761f69a2583941a773f913880a5dbf0eb068_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1139635,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @kirils,\n\nGiven enough time, you would have been able to grab every external user id on any report on H1.\n\nExploiting this would be pretty tricky, due to two factors: The absence of state info (no use going after `resolved` reports), and the high-risk approach of cold-calling a white-hat hacker and trying to convince them to join the dark side.\n\nAs an aside: I've redacted the report and external user ID from the report, so we should be ready to disclose!\n\n","markdown_message":"\u003cp\u003eHey \u003ca href=\"/kirils\"\u003e@kirils\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eGiven enough time, you would have been able to grab every external user id on any report on H1.\u003c/p\u003e\n\n\u003cp\u003eExploiting this would be pretty tricky, due to two factors: The absence of state info (no use going after \u003ccode\u003eresolved\u003c/code\u003e reports), and the high-risk approach of cold-calling a white-hat hacker and trying to convince them to join the dark side.\u003c/p\u003e\n\n\u003cp\u003eAs an aside: I\u0026#39;ve redacted the report and external user ID from the report, so we should be ready to disclose!\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-19T07:58:53.430Z","updated_at":"2016-08-19T07:58:53.430Z","actor":{"username":"dirk","cleared":false,"url":"/dirk","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/067/f9785240873663ec965b04e725871ed0f69616e7_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1139994,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"My two cents regarding exportability (or rather applicability) in addition to what has already been said before:\n1. Using statistics it might be possible to try and probabilistically correlate your suspect report  [with a \nlist of closed reports](https://hackerone.com/hacktivity?sort_type=latest_disclosable_activity_at\u0026page=1\u0026filter=type%3Aall) to see if it is likely to be closed (even though the IDs are hashed). _On a side note it takes just one another small slip up to disclose unhashed IDs of unresolved reports somewhere_. Security in depth is good and I am glad that I do not have to convince you of that.\n2. So what exactly is so risky about an anonymous person cold-calling somebody with a public profile on the internet? Just get a new persona and try the next target. See attachment. :) \n\n\nLet's go public!","markdown_message":"\u003cp\u003eMy two cents regarding exportability (or rather applicability) in addition to what has already been said before:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eUsing statistics it might be possible to try and probabilistically correlate your suspect report  \u003ca href=\"https://hackerone.com/hacktivity?sort_type=latest_disclosable_activity_at\u0026amp;page=1\u0026amp;filter=type%3Aall\"\u003ewith a \nlist of closed reports\u003c/a\u003e to see if it is likely to be closed (even though the IDs are hashed). \u003cu\u003eOn a side note it takes just one another small slip up to disclose unhashed IDs of unresolved reports somewhere\u003c/u\u003e. Security in depth is good and I am glad that I do not have to convince you of that.\u003c/li\u003e\n\u003cli\u003eSo what exactly is so risky about an anonymous person cold-calling somebody with a public profile on the internet? Just get a new persona and try the next target. See attachment. :) \u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eLet\u0026#39;s go public!\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-19T12:24:10.810Z","updated_at":"2016-08-19T12:24:10.810Z","first_to_agree":true,"actor":{"username":"kirils","cleared":false,"url":"/kirils","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/044/102/0ce8761f69a2583941a773f913880a5dbf0eb068_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":113297,"filename":"d.jpg","type":"image/jpeg","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/113/297/ee3ca38c34673aaacc953f00f3f7acc9d948d2ab/d.jpg?response-content-disposition=attachment%3B%20filename%3D%22d.jpg%22%3B%20filename%2A%3DUTF-8%27%27d.jpg\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQW2BAZGD3%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T043536Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDf7CC1janFXxWWF6QZ1Z6X6%2F6j0WDhv4gDyzEWu%2BScUAIhAOhgsmE64VangXFyIz5AGmDMLeT8sYG2vBQ4PwiaYS%2FZKrQDCFUQARoMMDEzNjE5Mjc0ODQ5Igy754oCq3nK3vWmRbMqkQM98qKdRlMDTd4bBwR4jJMppOWz7EU3ySwJK1geVZm7GvrSHyp8wAx03nVbAIisdh9q5SCYJs%2FJTXi%2Fsm9znfJcHgIy1DUYcyZol0zQmN4hQAlOUZZ6AJANKMjzew6Gbci4hpgZqkt7kMNinONmzU36EDiWMOc0y0LBIMMe8ckWdal2vM1amkx9g4%2B7jkxStLKe4Ry%2FVeqOEFeDj5B3%2Fim8atXFDPnaA6ZctYC0kADebiu9zFF1dQsSdkzsLG93dLAMR0ARXm0vun9nbqpp5oxDQafvSrdE7oDp0yem%2B391K5yvQ%2FVkTdyMd797ooD1IAYqUdwlX0lVblqv9ErzI2EUbOnFhO5widZFoU8s5JQDxyTzDlNAHHPnQpU8XD7uIRyR%2Bh43I9VvsEn1pERJ2rOM57I1PkAM8vesvdhiNkLY7KsmmB1q5drdmKxzSDeK5uPJY%2F7b6ZdCcYzDgNfX18d6h0A0FHbvXn7qPH9NQWGUsNXamCikRs9AA%2BK%2BzqwxI%2FlZdCdkUBJNbFqefOmuHA6y4DCuw6r%2FBTrqAZ4iBH5JOWBgJ5BPglFYT1gWFkwyMqq8gmMxb5SeS%2FjunuR9x9HhadmGfzTt7avXh7ra%2BbCbT8G5EBTHekw5tLrBpYwkzmLiedzIpJ4pJqrAXmk%2B6qfKdpUFGOfE%2FoOdzhIkM32hFOTOwwCcLwfUCOQXCXHweJlGlDZdV%2FgvnAv5llJv80AS6mRncqu5cTdZ6kwskL6mtLuZx022Hs9iVQEhZVcVFVxWNFIMlrPZufuNWFtnv13RkAoiqYOJgDn3UWRAP9lucn7OMZs0NyqKFy1iLho2FCO%2BegcGHVqDf%2FVxOtLAlnkhjmFRxg%3D%3D\u0026X-Amz-Signature=e58f3819f4afa0fbed3ac8459915fc16a39d6355d6566723757c076914250db1"}],"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1140006,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"P.S. Correlation with a list of closed reports could be done based on votes, I would propose.","markdown_message":"\u003cp\u003eP.S. Correlation with a list of closed reports could be done based on votes, I would propose.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-19T12:28:15.486Z","updated_at":"2016-08-19T12:28:15.486Z","actor":{"username":"kirils","cleared":false,"url":"/kirils","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/044/102/0ce8761f69a2583941a773f913880a5dbf0eb068_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1152472,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2016-08-24T19:23:18.352Z","updated_at":"2016-08-24T19:23:18.352Z","actor":{"url":"/security","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"HackerOne"}},"bounty_amount":"500.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"security","collaborator":{"username":"kirils","url":"/kirils"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1160307,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you kindly for the bounty.\n\nJust checking in to see, if the **impact** (being \"able to grab every external user id on any report on H1\" — @dirk) and my additional comments on the **attack scenario** (which could lead to disclosure of confidential bug descriptions) **were taken into account when deciding the bounty amount** to be the lowest possible for the program.","markdown_message":"\u003cp\u003eThank you kindly for the bounty.\u003c/p\u003e\n\n\u003cp\u003eJust checking in to see, if the \u003cstrong\u003eimpact\u003c/strong\u003e (being \u0026quot;able to grab every external user id on any report on H1\u0026quot; — \u003ca href=\"/dirk\"\u003e@dirk\u003c/a\u003e) and my additional comments on the \u003cstrong\u003eattack scenario\u003c/strong\u003e (which could lead to disclosure of confidential bug descriptions) \u003cstrong\u003ewere taken into account when deciding the bounty amount\u003c/strong\u003e to be the lowest possible for the program.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-29T17:11:56.012Z","updated_at":"2016-08-29T17:11:56.012Z","actor":{"username":"kirils","cleared":false,"url":"/kirils","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/044/102/0ce8761f69a2583941a773f913880a5dbf0eb068_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1164785,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @kirils,\n\nWe determine a bounty amount based on a number of things, among which: \n\n- Criticality of the data being exposed\n- Feasibility of the suggested attack\n- Impact of the suggested attack\n\n(These factors are based on the CVSSv3 severity calculation)\n\nThe factors that heavily influenced the decision to award a $500 bounty, are the feasibility and impact of the attack. You suggested using the data to contact white-hat hackers to try to convince them to sell you vulnerabilities (turning them to grey- or blackhats, low feasibility) that were already known to the vendor (no 0-days, medium impact). \n\nAn approach that you could take with the same feasibility, and a higher impact, is just cold-calling the hackers and asking them to sell you vulnerabilities. You would run the same kinds of risks, and you'd get actual 0-days instead of having to race the team. \n\nThe reason we awarded a bounty is that we appreciate you calling our attention to the exposure of the data. However, we do not feel that the issue does not warrant a heightened bounty amount.\n\nI hope this answers your question,\nKind regards,\nDirk","markdown_message":"\u003cp\u003eHey \u003ca href=\"/kirils\"\u003e@kirils\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eWe determine a bounty amount based on a number of things, among which: \u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eCriticality of the data being exposed\u003c/li\u003e\n\u003cli\u003eFeasibility of the suggested attack\u003c/li\u003e\n\u003cli\u003eImpact of the suggested attack\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003e(These factors are based on the CVSSv3 severity calculation)\u003c/p\u003e\n\n\u003cp\u003eThe factors that heavily influenced the decision to award a $500 bounty, are the feasibility and impact of the attack. You suggested using the data to contact white-hat hackers to try to convince them to sell you vulnerabilities (turning them to grey- or blackhats, low feasibility) that were already known to the vendor (no 0-days, medium impact). \u003c/p\u003e\n\n\u003cp\u003eAn approach that you could take with the same feasibility, and a higher impact, is just cold-calling the hackers and asking them to sell you vulnerabilities. You would run the same kinds of risks, and you\u0026#39;d get actual 0-days instead of having to race the team. \u003c/p\u003e\n\n\u003cp\u003eThe reason we awarded a bounty is that we appreciate you calling our attention to the exposure of the data. However, we do not feel that the issue does not warrant a heightened bounty amount.\u003c/p\u003e\n\n\u003cp\u003eI hope this answers your question,\u003cbr\u003e\nKind regards,\u003cbr\u003e\nDirk\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-31T13:54:22.521Z","updated_at":"2016-08-31T13:54:22.521Z","actor":{"username":"dirk","cleared":false,"url":"/dirk","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/067/f9785240873663ec965b04e725871ed0f69616e7_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1164805,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you very much for the extensive reply.\n\nI fully trust your team's judgement. Just wanted to make sure that this was not a blanket award and thought was put into making the decision. The award was not accompanied by a comment at all and that's why I decided to enquire.\n\nAgain, you've done more than I asked. Thanks.\n\n","markdown_message":"\u003cp\u003eThank you very much for the extensive reply.\u003c/p\u003e\n\n\u003cp\u003eI fully trust your team\u0026#39;s judgement. Just wanted to make sure that this was not a blanket award and thought was put into making the decision. The award was not accompanied by a comment at all and that\u0026#39;s why I decided to enquire.\u003c/p\u003e\n\n\u003cp\u003eAgain, you\u0026#39;ve done more than I asked. Thanks.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-31T14:00:50.893Z","updated_at":"2016-08-31T14:00:50.893Z","actor":{"username":"kirils","cleared":false,"url":"/kirils","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/044/102/0ce8761f69a2583941a773f913880a5dbf0eb068_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1164943,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @kirils,\n\nThank you for your understanding, and our apologies for not being clearer in our awarding! We discussed the bounty amount in some internal comments, and we forgot to post a proper response publicly.\n\nI'm going to request public disclosure in a sec, do you agree with me that all confidential information has been redacted from this report?\n\nKind regards,\nDirk","markdown_message":"\u003cp\u003eHey \u003ca href=\"/kirils\"\u003e@kirils\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThank you for your understanding, and our apologies for not being clearer in our awarding! We discussed the bounty amount in some internal comments, and we forgot to post a proper response publicly.\u003c/p\u003e\n\n\u003cp\u003eI\u0026#39;m going to request public disclosure in a sec, do you agree with me that all confidential information has been redacted from this report?\u003c/p\u003e\n\n\u003cp\u003eKind regards,\u003cbr\u003e\nDirk\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-31T14:54:42.378Z","updated_at":"2016-08-31T14:54:42.378Z","actor":{"username":"dirk","cleared":false,"url":"/dirk","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/067/f9785240873663ec965b04e725871ed0f69616e7_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1165646,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Sure seems that it's redacted all right. Good to go.","markdown_message":"\u003cp\u003eSure seems that it\u0026#39;s redacted all right. Good to go.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-08-31T17:58:55.231Z","updated_at":"2016-08-31T17:58:55.231Z","actor":{"username":"kirils","cleared":false,"url":"/kirils","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/044/102/0ce8761f69a2583941a773f913880a5dbf0eb068_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1166940,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-09-01T07:21:43.684Z","updated_at":"2016-09-01T07:21:43.684Z","actor":{"username":"dirk","cleared":false,"url":"/dirk","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/067/f9785240873663ec965b04e725871ed0f69616e7_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1166941,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-09-01T07:21:43.768Z","updated_at":"2016-09-01T07:21:43.768Z","actor":{"username":"dirk","cleared":false,"url":"/dirk","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/067/f9785240873663ec965b04e725871ed0f69616e7_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}