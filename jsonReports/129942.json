{"id":129942,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMjk5NDI=","url":"https://hackerone.com/reports/129942","title":"Insecure Payment System Integration","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-04-12T00:23:52.302Z","submitted_at":"2016-04-12T00:23:52.302Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"benteveo","url":"/benteveo","profile_picture_urls":{"small":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/i6qg857vt38um0nbl9nfgjpd7r5d/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a?response-content-disposition=inline%3B%20filename%3D%22benteveo-angry-sinletras.png%22%3B%20filename%2A%3DUTF-8%27%27benteveo-angry-sinletras.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ2UMPB2FX%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T042432Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJr%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIEq9neBunEjsdY7f8cNZfYtjkYnfx7sYXIBk82UycrktAiEA5w10R4CJv%2FQIiYTXv1ZP8q%2BbScvvzy7qwcG%2BmPmKCXMqtAMIUxABGgwwMTM2MTkyNzQ4NDkiDKX6CTSGAGf6Bt5yHyqRA9qW1WRQYe7JztYb6rdSeSRyzKgf4LxEu42JMoyPyy0VqqdaIdaW%2F5Oe%2FZcBqKJkPjfrnsLv1E3Cttn6QZ2fsMawdDGLyKyEEvAx6LbD4TYD1QOy0YJIw6j32Nt3V4psvzyU384FsJYLymiqMGAqTzIuUS4QNvTcHn%2BFoOZvS%2F06fP5YWj%2BxpW%2BELDyBb5CFIWqKXYmkW%2BPv4IxFiMVfFF4KM80ZKVGfyJ7nRaRwvjM5YUJYHOlvXjFuPBSC3IYIgEZYlopEqTolZ1OQ2zbi1yDB%2FWl1rx7i7cbCVK6zJwPdLcPRBOa7jlMN0jlHdNPzjyKxdEaNBy7Cyflyw%2FZCl7X1dB7yuSBF8YK2st4h%2FZchseLh%2BjukipjtpVl5nDjO8BSu5evt1V1lFzADomlTKShrSgjmej1gvXmULpbdNuEwc3vMl328MfuwtHHSSvzZo5xxP0U1cq9fhM0Ztcea1ZRpQDZR4DB1jRqdjeMIXNuuwv3G7Uotj1VrvA87zW9Og6gQ9VN7fQSdOpurQFAV2WvRMIuSqv8FOusB%2B%2BEh7xquKUpKrZEfrLl0yLcAZyezk5OlnVLaoE%2BCU7%2F1YWDwq4fJ%2Fzqx58r%2Ffgzx%2FRuGFLAoCPIl7GI47ntqpCuRo5kjknXh3Vhm0Ds%2B9y0Uo9mgVKhl6XjEqADeRJOm5JpIvTZkPibWah%2FFXooiOsIWnpbe3xZbkrh62wdx0iVuonbBNy6Z0vYXXREkzeNyKh%2Fx0i0DwAehfYiLehqkIm1GqvDnaSiQ0dTRzOsrEnXwNhRtDRaBDDLvFXHGy3Xm8ucb70jki0U1otEIUfIG%2Fnfsrs7zhSOcLfi6%2B4aytuy%2FrSFLmVnwIpfIzQ%3D%3D\u0026X-Amz-Signature=47b525024773aa44bb3852e81e17ecfffc1b4afde9199a1de379e666d2be8a79"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":218,"url":"https://hackerone.com/xero","handle":"xero","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/218/336874c31197e768d6c7b2898ce53f45f3178dbc_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/218/336874c31197e768d6c7b2898ce53f45f3178dbc_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"disabled","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Xero","twitter_handle":"xero","website":"https://www.xero.com","about":"Beautiful accounting software"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"no-content","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2016-05-20T06:52:04.190Z","bug_reporter_agreed_on_going_public_at":"2016-04-20T23:26:49.569Z","team_member_agreed_on_going_public_at":"2016-05-20T06:52:03.995Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"","vulnerability_information_html":"","weakness":{"id":32,"name":"Cryptographic Issues - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2016-05-20T23:26:49.634Z","allow_singular_disclosure_after":-145429063.0928886,"singular_disclosure_allowed":true,"vote_count":2,"voters":["silv3rpoision","dyabla"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":900633,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2016-04-12T01:39:03.523Z","updated_at":"2016-04-12T01:39:03.523Z","actor":{"username":"amit","cleared":false,"url":"/amit","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/007/246/7718c5f538fcfd278a496b252b6ceb67e614a552_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"xero","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":914044,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2016-04-19T05:44:48.624Z","updated_at":"2016-04-19T05:44:48.624Z","actor":{"username":"amit","cleared":false,"url":"/amit","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/007/246/7718c5f538fcfd278a496b252b6ceb67e614a552_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"xero","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":914071,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","markdown_message":"","automated_response":false,"created_at":"2016-04-19T06:24:11.008Z","updated_at":"2016-04-19T06:24:11.008Z","actor":{"username":"benteveo","cleared":true,"url":"/benteveo","profile_picture_urls":{"medium":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/i6qg857vt38um0nbl9nfgjpd7r5d/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5?response-content-disposition=inline%3B%20filename%3D%22benteveo-angry-sinletras.png%22%3B%20filename%2A%3DUTF-8%27%27benteveo-angry-sinletras.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ2UMPB2FX%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T042432Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJr%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIEq9neBunEjsdY7f8cNZfYtjkYnfx7sYXIBk82UycrktAiEA5w10R4CJv%2FQIiYTXv1ZP8q%2BbScvvzy7qwcG%2BmPmKCXMqtAMIUxABGgwwMTM2MTkyNzQ4NDkiDKX6CTSGAGf6Bt5yHyqRA9qW1WRQYe7JztYb6rdSeSRyzKgf4LxEu42JMoyPyy0VqqdaIdaW%2F5Oe%2FZcBqKJkPjfrnsLv1E3Cttn6QZ2fsMawdDGLyKyEEvAx6LbD4TYD1QOy0YJIw6j32Nt3V4psvzyU384FsJYLymiqMGAqTzIuUS4QNvTcHn%2BFoOZvS%2F06fP5YWj%2BxpW%2BELDyBb5CFIWqKXYmkW%2BPv4IxFiMVfFF4KM80ZKVGfyJ7nRaRwvjM5YUJYHOlvXjFuPBSC3IYIgEZYlopEqTolZ1OQ2zbi1yDB%2FWl1rx7i7cbCVK6zJwPdLcPRBOa7jlMN0jlHdNPzjyKxdEaNBy7Cyflyw%2FZCl7X1dB7yuSBF8YK2st4h%2FZchseLh%2BjukipjtpVl5nDjO8BSu5evt1V1lFzADomlTKShrSgjmej1gvXmULpbdNuEwc3vMl328MfuwtHHSSvzZo5xxP0U1cq9fhM0Ztcea1ZRpQDZR4DB1jRqdjeMIXNuuwv3G7Uotj1VrvA87zW9Og6gQ9VN7fQSdOpurQFAV2WvRMIuSqv8FOusB%2B%2BEh7xquKUpKrZEfrLl0yLcAZyezk5OlnVLaoE%2BCU7%2F1YWDwq4fJ%2Fzqx58r%2Ffgzx%2FRuGFLAoCPIl7GI47ntqpCuRo5kjknXh3Vhm0Ds%2B9y0Uo9mgVKhl6XjEqADeRJOm5JpIvTZkPibWah%2FFXooiOsIWnpbe3xZbkrh62wdx0iVuonbBNy6Z0vYXXREkzeNyKh%2Fx0i0DwAehfYiLehqkIm1GqvDnaSiQ0dTRzOsrEnXwNhRtDRaBDDLvFXHGy3Xm8ucb70jki0U1otEIUfIG%2Fnfsrs7zhSOcLfi6%2B4aytuy%2FrSFLmVnwIpfIzQ%3D%3D\u0026X-Amz-Signature=697f26b89dfae04e15296b7a907a56a6f97d5266319301c59246a10c915e2c29"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"xero","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":916098,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2016-04-19T22:42:22.364Z","updated_at":"2016-04-19T22:42:22.364Z","actor":{"username":"amit","cleared":false,"url":"/amit","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/007/246/7718c5f538fcfd278a496b252b6ceb67e614a552_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"benteveo","url":"/benteveo"},"genius_execution_id":null,"team_handle":"xero","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":919123,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-04-20T23:26:49.591Z","updated_at":"2016-04-20T23:26:49.591Z","first_to_agree":true,"actor":{"username":"benteveo","cleared":true,"url":"/benteveo","profile_picture_urls":{"medium":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/i6qg857vt38um0nbl9nfgjpd7r5d/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5?response-content-disposition=inline%3B%20filename%3D%22benteveo-angry-sinletras.png%22%3B%20filename%2A%3DUTF-8%27%27benteveo-angry-sinletras.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ2UMPB2FX%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T042432Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJr%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIEq9neBunEjsdY7f8cNZfYtjkYnfx7sYXIBk82UycrktAiEA5w10R4CJv%2FQIiYTXv1ZP8q%2BbScvvzy7qwcG%2BmPmKCXMqtAMIUxABGgwwMTM2MTkyNzQ4NDkiDKX6CTSGAGf6Bt5yHyqRA9qW1WRQYe7JztYb6rdSeSRyzKgf4LxEu42JMoyPyy0VqqdaIdaW%2F5Oe%2FZcBqKJkPjfrnsLv1E3Cttn6QZ2fsMawdDGLyKyEEvAx6LbD4TYD1QOy0YJIw6j32Nt3V4psvzyU384FsJYLymiqMGAqTzIuUS4QNvTcHn%2BFoOZvS%2F06fP5YWj%2BxpW%2BELDyBb5CFIWqKXYmkW%2BPv4IxFiMVfFF4KM80ZKVGfyJ7nRaRwvjM5YUJYHOlvXjFuPBSC3IYIgEZYlopEqTolZ1OQ2zbi1yDB%2FWl1rx7i7cbCVK6zJwPdLcPRBOa7jlMN0jlHdNPzjyKxdEaNBy7Cyflyw%2FZCl7X1dB7yuSBF8YK2st4h%2FZchseLh%2BjukipjtpVl5nDjO8BSu5evt1V1lFzADomlTKShrSgjmej1gvXmULpbdNuEwc3vMl328MfuwtHHSSvzZo5xxP0U1cq9fhM0Ztcea1ZRpQDZR4DB1jRqdjeMIXNuuwv3G7Uotj1VrvA87zW9Og6gQ9VN7fQSdOpurQFAV2WvRMIuSqv8FOusB%2B%2BEh7xquKUpKrZEfrLl0yLcAZyezk5OlnVLaoE%2BCU7%2F1YWDwq4fJ%2Fzqx58r%2Ffgzx%2FRuGFLAoCPIl7GI47ntqpCuRo5kjknXh3Vhm0Ds%2B9y0Uo9mgVKhl6XjEqADeRJOm5JpIvTZkPibWah%2FFXooiOsIWnpbe3xZbkrh62wdx0iVuonbBNy6Z0vYXXREkzeNyKh%2Fx0i0DwAehfYiLehqkIm1GqvDnaSiQ0dTRzOsrEnXwNhRtDRaBDDLvFXHGy3Xm8ucb70jki0U1otEIUfIG%2Fnfsrs7zhSOcLfi6%2B4aytuy%2FrSFLmVnwIpfIzQ%3D%3D\u0026X-Amz-Signature=697f26b89dfae04e15296b7a907a56a6f97d5266319301c59246a10c915e2c29"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"xero","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":965947,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-05-20T06:52:04.112Z","updated_at":"2016-05-20T06:52:04.112Z","actor":{"username":"amit","cleared":false,"url":"/amit","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/007/246/7718c5f538fcfd278a496b252b6ceb67e614a552_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"xero","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":965948,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-05-20T06:52:04.233Z","updated_at":"2016-05-20T06:52:04.233Z","actor":{"username":"amit","cleared":false,"url":"/amit","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/007/246/7718c5f538fcfd278a496b252b6ceb67e614a552_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"xero","actor_is_team_member":true,"actor_is_concealed_member":true}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":1967,"category":"team","content":"A flaw in our Credit Card Verification process was reported that could have allowed an attacker to avail themselves of a Xero Subscription without paying for it, for a month at most. This was rated as non-critical and was quickly fixed.  Mitigation measures were in place to detect any abuse and we have no reports of this flaw ever being exploited.","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eA flaw in our Credit Card Verification process was reported that could have allowed an attacker to avail themselves of a Xero Subscription without paying for it, for a month at most. This was rated as non-critical and was quickly fixed.  Mitigation measures were in place to detect any abuse and we have no reports of this flaw ever being exploited.\u003c/p\u003e\n"},{"id":3087,"category":"researcher","content":"While reviewing the application, I identified that there was functionality that was restricted to paying users, such as adding unlimited users, file storage, bank feeds, multiple currencies, etc. In order to access these features and continue usage after a trial period a user must complete a credit card payment through paymentexpress. I identified that paymentexpress integration is insecure and allows an authenticated attacker to obtain access to a premium account, thereby affecting the integrity of the system and possibly internal Xero accounting systems.\n\nI did not verify at the time whether this also allowed users to abuse other sections of the application, such as paying for invoices.\n\nAfter a failed payment, paymentexpress redirected users to `/!xkcD/Dps/Authority/Fail?result=XX\u0026userid=XX`. Exploitation of this issue was triggered by changing the URL so that it pointed to \"Success\" instead of \"Fail\":  `/!xkcD/Dps/Authority/Success?result=XX\u0026userid=XX`. ","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eWhile reviewing the application, I identified that there was functionality that was restricted to paying users, such as adding unlimited users, file storage, bank feeds, multiple currencies, etc. In order to access these features and continue usage after a trial period a user must complete a credit card payment through paymentexpress. I identified that paymentexpress integration is insecure and allows an authenticated attacker to obtain access to a premium account, thereby affecting the integrity of the system and possibly internal Xero accounting systems.\u003c/p\u003e\n\n\u003cp\u003eI did not verify at the time whether this also allowed users to abuse other sections of the application, such as paying for invoices.\u003c/p\u003e\n\n\u003cp\u003eAfter a failed payment, paymentexpress redirected users to \u003ccode\u003e/!xkcD/Dps/Authority/Fail?result=XX\u0026amp;userid=XX\u003c/code\u003e. Exploitation of this issue was triggered by changing the URL so that it pointed to \u0026quot;Success\u0026quot; instead of \u0026quot;Fail\u0026quot;:  \u003ccode\u003e/!xkcD/Dps/Authority/Success?result=XX\u0026amp;userid=XX\u003c/code\u003e. \u003c/p\u003e\n"}]}