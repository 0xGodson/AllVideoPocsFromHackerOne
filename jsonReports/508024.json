{"id":508024,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC81MDgwMjQ=","url":"https://hackerone.com/reports/508024","title":"Public and secret api key leaked via omise github repo(owned by omise)","state":"Closed","substate":"informative","severity_rating":"none","readable_substate":"Informative","created_at":"2019-03-11T18:10:36.138Z","submitted_at":"2019-03-11T18:10:36.138Z","is_member_of_team?":false,"reporter":{"disabled":true,"username":"noobwalid","url":"/noobwalid","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":21045,"url":"https://hackerone.com/omise","handle":"omise","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/021/045/124b85928203caaec29c4eb44ef525ca0ddd0fe8_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/021/045/124b85928203caaec29c4eb44ef525ca0ddd0fe8_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Omise","twitter_handle":"omise","website":"https://www.omise.co","about":"Next generation of payment Platform"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2019-03-25T09:41:37.301Z","bug_reporter_agreed_on_going_public_at":"2019-03-13T08:16:28.162Z","team_member_agreed_on_going_public_at":"2019-03-25T09:41:37.240Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Found secret key of particular omise accounts!\nFunctionality of the public and secret keys are described below:\n\nPublic key\n\nThe public key can be used to create tokens via javascript from your customers browsers. This key can be safely exposed to the outside world.\n\nSecret key\n\nThe secret key can be used to create customers, cards and charges and to retrieve information about your account, such as its balance. You must keep this key from prying eyes.\n\nI have got both public and secret key on omise github repo.**But not sure if they were created only for testing purpose**\n\n##Go to :\nhttps://github.com/omise/omise-php/blob/1158aeceb83c55d4b2188b75ae0f899d7af3881a/README.md\nscroll down.and you will see leaked keys!!\n\n```\n\u003c?php\nrequire_once dirname(__FILE__).'/vendor/autoload.php';\n\ndefine('OMISE_PUBLIC_KEY', 'pkey_test_54ot96fkr3i2op60cng');\ndefine('OMISE_SECRET_KEY', 'skey_test_54ot96fkr3i2op60cng');\ndefine('OMISE_API_VERSION', '2017-11-02');\n```\n\nthank you\n\n## Impact\n\nAttacker can use the secret key to create customers,cards and charges and to retrieve info about the particular account,such as its balance.","vulnerability_information_html":"\u003cp\u003eFound secret key of particular omise accounts!\u003cbr\u003e\nFunctionality of the public and secret keys are described below:\u003c/p\u003e\n\n\u003cp\u003ePublic key\u003c/p\u003e\n\n\u003cp\u003eThe public key can be used to create tokens via javascript from your customers browsers. This key can be safely exposed to the outside world.\u003c/p\u003e\n\n\u003cp\u003eSecret key\u003c/p\u003e\n\n\u003cp\u003eThe secret key can be used to create customers, cards and charges and to retrieve information about your account, such as its balance. You must keep this key from prying eyes.\u003c/p\u003e\n\n\u003cp\u003eI have got both public and secret key on omise github repo.\u003cstrong\u003eBut not sure if they were created only for testing purpose\u003c/strong\u003e\u003c/p\u003e\n\n\u003ch2 id=\"go-to\"\u003eGo to :\u003c/h2\u003e\n\n\u003cp\u003e\u003ca title=\"https://github.com/omise/omise-php/blob/1158aeceb83c55d4b2188b75ae0f899d7af3881a/README.md\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fomise%2Fomise-php%2Fblob%2F1158aeceb83c55d4b2188b75ae0f899d7af3881a%2FREADME.md\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/omise/omise-php/blob/1158aeceb83c55d4b2188b75ae0f899d7af3881a/README.md\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nscroll down.and you will see leaked keys!!\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight php\"\u003e\u003ccode\u003e\u003cspan class=\"cp\"\u003e\u0026lt;?php\u003c/span\u003e\n\u003cspan class=\"k\"\u003erequire_once\u003c/span\u003e \u003cspan class=\"nb\"\u003edirname\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003e__FILE__\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;/vendor/autoload.php\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"nb\"\u003edefine\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;OMISE_PUBLIC_KEY\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;pkey_test_54ot96fkr3i2op60cng\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"nb\"\u003edefine\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;OMISE_SECRET_KEY\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;skey_test_54ot96fkr3i2op60cng\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"nb\"\u003edefine\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;OMISE_API_VERSION\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;2017-11-02\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003ethank you\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eAttacker can use the secret key to create customers,cards and charges and to retrieve info about the particular account,such as its balance.\u003c/p\u003e\n","weakness":{"id":18,"name":"Information Disclosure"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":6,"voters":["checkm50","khizer47","walidhossain","7azimo","noobwalid","reddmist"],"severity":{"rating":"none","author_type":"User"},"structured_scope":{"databaseId":16435,"asset_type":"URL","asset_identifier":"dashboard.omise.co","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":4303566,"is_internal":false,"editable":false,"type":"Activities::BugNotApplicable","message":"Thanks for the report! Unfortunately, your submission is out of scope as outlined in the security policy.\n\n\u003e - Rolling keys will expire the old keys after 1 hour and still be shown for 15 minutes (You can revoke expiring keys to make them unusable immediately); \n\nYour effort is nonetheless appreciated, and we wish that you'll continue to research and submit any future security issues you find.\n\nKind Regards.","markdown_message":"\u003cp\u003eThanks for the report! Unfortunately, your submission is out of scope as outlined in the security policy.\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cul\u003e\n\u003cli\u003eRolling keys will expire the old keys after 1 hour and still be shown for 15 minutes (You can revoke expiring keys to make them unusable immediately); \u003c/li\u003e\n\u003c/ul\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eYour effort is nonetheless appreciated, and we wish that you\u0026#39;ll continue to research and submit any future security issues you find.\u003c/p\u003e\n\n\u003cp\u003eKind Regards.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-03-11T22:35:19.856Z","updated_at":"2019-03-11T22:35:19.856Z","actor":{"username":"exc3lsior","cleared":false,"url":"/exc3lsior","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"omise","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4305029,"is_internal":false,"editable":false,"type":"Activities::BugReopened","message":"","markdown_message":"","automated_response":false,"created_at":"2019-03-12T08:20:00.967Z","updated_at":"2019-03-12T08:20:00.967Z","actor":{"username":"noobwalid","cleared":false,"url":"/noobwalid","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"omise","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4305030,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"hello thanks for replying. however I have read the bounty brief\n\nRolling keys will expire the old keys after 1 hour and still be shown for 15 minutes (You can revoke expiring keys to make them unusable immediately\n\nHere I have reported the issue whether the key is rolled I do not know.**The issue is valid for unrolled keys!!In case the key leaked in omise github repo can be valid I think.Please re-check the issue again.If the key gets rolled please mark the report as informative ** \n\n","markdown_message":"\u003cp\u003ehello thanks for replying. however I have read the bounty brief\u003c/p\u003e\n\n\u003cp\u003eRolling keys will expire the old keys after 1 hour and still be shown for 15 minutes (You can revoke expiring keys to make them unusable immediately\u003c/p\u003e\n\n\u003cp\u003eHere I have reported the issue whether the key is rolled I do not know.*\u003cem\u003eThe issue is valid for unrolled keys!!In case the key leaked in omise github repo can be valid I think.Please re-check the issue again.If the key gets rolled please mark the report as informative *\u003c/em\u003e \u003c/p\u003e\n","automated_response":false,"created_at":"2019-03-12T08:20:01.030Z","updated_at":"2019-03-12T08:20:01.030Z","actor":{"username":"noobwalid","cleared":false,"url":"/noobwalid","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"omise","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4312865,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello @noobwalid,\n\nThese are not valid keys, they are there as placeholder. Real public and secret keys have different values (unlike those on that page).\n\nWe appreciate your report though! \nThank you.","markdown_message":"\u003cp\u003eHello \u003ca href=\"/noobwalid\"\u003e@noobwalid\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThese are not valid keys, they are there as placeholder. Real public and secret keys have different values (unlike those on that page).\u003c/p\u003e\n\n\u003cp\u003eWe appreciate your report though! \u003cbr\u003e\nThank you.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-03-13T01:28:32.586Z","updated_at":"2019-03-13T01:28:32.586Z","actor":{"username":"francois-omise","cleared":false,"url":"/francois-omise","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/500/569/e0ad9edc8085da29d40bfbca105064ea59af3167_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"omise","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4312881,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"closing report.","markdown_message":"\u003cp\u003eclosing report.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-03-13T01:37:03.758Z","updated_at":"2019-03-13T01:37:03.758Z","actor":{"username":"hardymansen","cleared":false,"url":"/hardymansen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/268/510/a5be384b5218b68c9ed291e2649c3a659f9baeb5_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"omise","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4313676,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Can we??","markdown_message":"\u003cp\u003eCan we??\u003c/p\u003e\n","automated_response":false,"created_at":"2019-03-13T08:16:28.187Z","updated_at":"2019-03-13T08:16:28.187Z","first_to_agree":true,"actor":{"username":"noobwalid","cleared":false,"url":"/noobwalid","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"omise","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4384125,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Hi @noobwalid,\n\nThank you for your research and time and patience\n\nOmise Security","markdown_message":"\u003cp\u003eHi \u003ca href=\"/noobwalid\"\u003e@noobwalid\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThank you for your research and time and patience\u003c/p\u003e\n\n\u003cp\u003eOmise Security\u003c/p\u003e\n","automated_response":false,"created_at":"2019-03-25T09:41:37.261Z","updated_at":"2019-03-25T09:41:37.261Z","actor":{"username":"dhawal","cleared":false,"url":"/dhawal","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/j4yvJanSocvjrrhmHnoi2s1M/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"omise","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4384126,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-03-25T09:41:37.320Z","updated_at":"2019-03-25T09:41:37.320Z","actor":{"username":"dhawal","cleared":false,"url":"/dhawal","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/j4yvJanSocvjrrhmHnoi2s1M/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"omise","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}