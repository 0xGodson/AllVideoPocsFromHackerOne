{"id":30567,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zMDU2Nw==","url":"https://hackerone.com/reports/30567","title":"Adobe Flash Player MP4 Use-After-Free Vulnerability","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2014-10-08T02:03:48.260Z","submitted_at":"2014-10-08T02:03:48.260Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"hhj4ck","url":"/hhj4ck","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":46,"url":"https://hackerone.com/ibb-flash","handle":"ibb-flash","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/046/1483b151cc84e0ff54b32196809ca3bf945812f2_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/046/1483b151cc84e0ff54b32196809ca3bf945812f2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"disabled","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Flash (IBB)","twitter_handle":"","website":"","about":""}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2015-03-11T04:19:40.947Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2015-02-09T04:19:22.764Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"I. Summary\r\nAdobe Flash Player is prone to a vulnerability which leads to Use-After-Free. After parsing a malformed mp4 file, Flash will keep on accessing a block of memory for timing. Such memory block is still accessed even the page containing Flash is closed, which leads to a memory crash. \r\n------------------------------------------------------------------\r\nII. Description\r\nAdobe Flash is a multimedia and software platform used for authoring of vector graphics, animation, games and rich Internet applications (RIAs) that can be viewed, played and executed in Adobe Flash Player. NetStream object can load and play an external mp4 file. \r\nAfter playing a mp4 file, Flash will keep on updating a counter that saves the current frame and duration. A malformed mp4 file will trick the Flash to believe that this film never ends. The counter will not stop updating even the web page containing Flash is closing. Closing the page release Flash from the memory space, while the counter is still updated by a standalone thread. \r\nThere are two possible types of crash depending on the order of different blocks' release:\r\n1. If the counter memory is freed first, then the memory crash is caused by accessing freed memory.\r\n2. If the code snippets that update the counter is freed first, then the crash is caused by executing freed memory.\r\nEach of the two possible types of crash may by exploited by carefully crafted mp4 file which could lead to code execution.\r\n\r\nPOC and its source code are attached.   \r\nPrevious and lastest version of Adobe Flash Player has been tested under both Windows 7 and Windows XP.\r\n------------------------------------------------------------------\r\nIII. Impact\r\nUse-After-Free\r\n------------------------------------------------------------------\r\nIV. Affected\r\nAdobe Flash Player (verion \u003e10) under Windows XP and Windows 7.\r\nOther versions of windows may also be affected.\r\n------------------------------------------------------------------\r\nV. Reference\r\nFix: http://helpx.adobe.com/security/products/flash-player/apsb14-21.html\r\nIt has been asigned as CVE-2014-0553\r\n------------------------------------------------------------------\r\nVI. Credit\r\nLiu Jincheng and Wen Guanxing from Venustech ADLAB are credited for this vulnerability.","vulnerability_information_html":"\u003cp\u003eI. Summary\u003c/p\u003e\n\n\u003ch2 id=\"adobe-flash-player-is-prone-to-a-vulnerability-which-leads-to-use-after-free-after-parsing-a-malformed-mp4-file-flash-will-keep-on-accessing-a-block-of-memory-for-timing-such-memory-block-is-still-accessed-even-the-page-containing-flash-is-closed-which-leads-to-a-memory-crash\"\u003eAdobe Flash Player is prone to a vulnerability which leads to Use-After-Free. After parsing a malformed mp4 file, Flash will keep on accessing a block of memory for timing. Such memory block is still accessed even the page containing Flash is closed, which leads to a memory crash. \u003c/h2\u003e\n\n\u003cp\u003eII. Description\u003cbr\u003e\nAdobe Flash is a multimedia and software platform used for authoring of vector graphics, animation, games and rich Internet applications (RIAs) that can be viewed, played and executed in Adobe Flash Player. NetStream object can load and play an external mp4 file. \u003cbr\u003e\nAfter playing a mp4 file, Flash will keep on updating a counter that saves the current frame and duration. A malformed mp4 file will trick the Flash to believe that this film never ends. The counter will not stop updating even the web page containing Flash is closing. Closing the page release Flash from the memory space, while the counter is still updated by a standalone thread. \u003cbr\u003e\nThere are two possible types of crash depending on the order of different blocks\u0026#39; release:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eIf the counter memory is freed first, then the memory crash is caused by accessing freed memory.\u003c/li\u003e\n\u003cli\u003eIf the code snippets that update the counter is freed first, then the crash is caused by executing freed memory.\nEach of the two possible types of crash may by exploited by carefully crafted mp4 file which could lead to code execution.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003ePOC and its source code are attached.   \u003c/p\u003e\n\n\u003ch2 id=\"previous-and-lastest-version-of-adobe-flash-player-has-been-tested-under-both-windows-7-and-windows-xp\"\u003ePrevious and lastest version of Adobe Flash Player has been tested under both Windows 7 and Windows XP.\u003c/h2\u003e\n\n\u003cp\u003eIII. Impact\u003c/p\u003e\n\n\u003ch2 id=\"use-after-free\"\u003eUse-After-Free\u003c/h2\u003e\n\n\u003cp\u003eIV. Affected\u003cbr\u003e\nAdobe Flash Player (verion \u0026gt;10) under Windows XP and Windows 7.\u003c/p\u003e\n\n\u003ch2 id=\"other-versions-of-windows-may-also-be-affected\"\u003eOther versions of windows may also be affected.\u003c/h2\u003e\n\n\u003cp\u003eV. Reference\u003cbr\u003e\nFix: \u003ca title=\"http://helpx.adobe.com/security/products/flash-player/apsb14-21.html\" href=\"/redirect?url=http%3A%2F%2Fhelpx.adobe.com%2Fsecurity%2Fproducts%2Fflash-player%2Fapsb14-21.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://helpx.adobe.com/security/products/flash-player/apsb14-21.html\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2 id=\"it-has-been-asigned-as-cve-2014-0553\"\u003eIt has been asigned as CVE-2014-0553\u003c/h2\u003e\n\n\u003cp\u003eVI. Credit\u003cbr\u003e\nLiu Jincheng and Wen Guanxing from Venustech ADLAB are credited for this vulnerability.\u003c/p\u003e\n","bounty_amount":"2000.0","formatted_bounty":"$2,000","weakness":{"id":2,"name":"Memory Corruption - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":18402,"file_name":"mp4uaf_.rar","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/018/402/833592faffe07d08a1245c67c9e9c5bbcb19f972/mp4uaf_.rar?response-content-disposition=attachment%3B%20filename%3D%22mp4uaf_.rar%22%3B%20filename%2A%3DUTF-8%27%27mp4uaf_.rar\u0026response-content-type=application%2Fx-rar\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ2UMPB2FX%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T053023Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJr%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIEq9neBunEjsdY7f8cNZfYtjkYnfx7sYXIBk82UycrktAiEA5w10R4CJv%2FQIiYTXv1ZP8q%2BbScvvzy7qwcG%2BmPmKCXMqtAMIUxABGgwwMTM2MTkyNzQ4NDkiDKX6CTSGAGf6Bt5yHyqRA9qW1WRQYe7JztYb6rdSeSRyzKgf4LxEu42JMoyPyy0VqqdaIdaW%2F5Oe%2FZcBqKJkPjfrnsLv1E3Cttn6QZ2fsMawdDGLyKyEEvAx6LbD4TYD1QOy0YJIw6j32Nt3V4psvzyU384FsJYLymiqMGAqTzIuUS4QNvTcHn%2BFoOZvS%2F06fP5YWj%2BxpW%2BELDyBb5CFIWqKXYmkW%2BPv4IxFiMVfFF4KM80ZKVGfyJ7nRaRwvjM5YUJYHOlvXjFuPBSC3IYIgEZYlopEqTolZ1OQ2zbi1yDB%2FWl1rx7i7cbCVK6zJwPdLcPRBOa7jlMN0jlHdNPzjyKxdEaNBy7Cyflyw%2FZCl7X1dB7yuSBF8YK2st4h%2FZchseLh%2BjukipjtpVl5nDjO8BSu5evt1V1lFzADomlTKShrSgjmej1gvXmULpbdNuEwc3vMl328MfuwtHHSSvzZo5xxP0U1cq9fhM0Ztcea1ZRpQDZR4DB1jRqdjeMIXNuuwv3G7Uotj1VrvA87zW9Og6gQ9VN7fQSdOpurQFAV2WvRMIuSqv8FOusB%2B%2BEh7xquKUpKrZEfrLl0yLcAZyezk5OlnVLaoE%2BCU7%2F1YWDwq4fJ%2Fzqx58r%2Ffgzx%2FRuGFLAoCPIl7GI47ntqpCuRo5kjknXh3Vhm0Ds%2B9y0Uo9mgVKhl6XjEqADeRJOm5JpIvTZkPibWah%2FFXooiOsIWnpbe3xZbkrh62wdx0iVuonbBNy6Z0vYXXREkzeNyKh%2Fx0i0DwAehfYiLehqkIm1GqvDnaSiQ0dTRzOsrEnXwNhRtDRaBDDLvFXHGy3Xm8ucb70jki0U1otEIUfIG%2Fnfsrs7zhSOcLfi6%2B4aytuy%2FrSFLmVnwIpfIzQ%3D%3D\u0026X-Amz-Signature=f93227e26e9d68d009c6408451894cb74b8dceaeda7f9ba8e6d291bc72cf5b6c","file_size":1014498,"type":"application/x-rar"}],"allow_singular_disclosure_at":"2015-03-11T04:19:22.994Z","allow_singular_disclosure_after":-183172260.21700403,"singular_disclosure_allowed":true,"vote_count":2,"voters":["sw33tlie","xhzeem"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":328032,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2015-02-09T04:19:13.700Z","updated_at":"2015-02-09T04:19:13.700Z","actor":{"username":"arice","cleared":false,"url":"/arice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/83152cb2d070f3f6a63c1b61bae47257722b5ad2_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"reporter":{"username":"hhj4ck","url":"/hhj4ck"},"genius_execution_id":null,"team_handle":"ibb-flash","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":328033,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2015-02-09T04:19:18.634Z","updated_at":"2015-02-09T04:19:18.634Z","actor":{"url":"/ibb-flash","ibb":true,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/046/1483b151cc84e0ff54b32196809ca3bf945812f2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Flash (IBB)"}},"bounty_amount":"2000.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"ibb-flash","collaborator":{"username":"hhj4ck","url":"/hhj4ck"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":328034,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-02-09T04:19:22.798Z","updated_at":"2015-02-09T04:19:22.798Z","first_to_agree":true,"actor":{"username":"arice","cleared":false,"url":"/arice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/020/83152cb2d070f3f6a63c1b61bae47257722b5ad2_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":true},"genius_execution_id":null,"team_handle":"ibb-flash","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":350731,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2015-03-11T04:19:40.984Z","updated_at":"2015-03-11T04:19:40.984Z","actor":{"url":"/ibb-flash","ibb":true,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/046/1483b151cc84e0ff54b32196809ca3bf945812f2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Flash (IBB)"}},"genius_execution_id":null,"team_handle":"ibb-flash","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}