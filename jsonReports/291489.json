{"id":291489,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yOTE0ODk=","url":"https://hackerone.com/reports/291489","title":"Kovri: potential buffer over-read in garlic clove handling + I2NP message creation","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2017-11-18T12:42:53.852Z","submitted_at":"2017-11-18T12:42:53.852Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"aerodudrizzt","url":"/aerodudrizzt","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/098/646/ebd692682f9cff0731c0021d35f72330a3c88a8c_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":7731,"url":"https://hackerone.com/monero","handle":"monero","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/007/731/55634f7fcd917725c7a5771cc6e7c9b4d5fe0c22_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/007/731/55634f7fcd917725c7a5771cc6e7c9b4d5fe0c22_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Monero","twitter_handle":"monero","website":"https://getmonero.org","about":" Monero: the secure, private, untraceable cryptocurrency"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-12-05T06:09:37.460Z","bug_reporter_agreed_on_going_public_at":"2017-12-05T06:09:37.360Z","team_member_agreed_on_going_public_at":"2017-12-05T02:22:03.101Z","comments_closed?":true,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Brief\n-----\nThere is a lack of sanitation checks when handling Garlic messages in the kovri I2P router. Sending a specially crafted Garlic message can cause the router to send onward an I2P message containing leaked RAM data, triggering a massive information leakage.\n\nTechnical Details:\n===========\n* Code Version: Taken from Github on the 18th of November 2017 - commit 5aafe6608519d31e537c97b24ea7b23aa372dd5b\n* Vulnerable File: src\\core\\router\\garlic.h\n* Vulnerable Function: GarlicDestination::HandleGarlicPayload\n\nThe function is responsible to parse and handle Garlic Payloads: several independent Garlic Cloves.\nWhen handling a clove with a delivery type of \"DeliveryTypeTunnel\" there are insufficient checks on the message, before it is wrapped and sent onward:\n```cpp\n    GarlicDeliveryType delivery_type = (GarlicDeliveryType)((flag \u003e\u003e 5) \u0026 0x03);\n    switch (delivery_type) {\n      case eGarlicDeliveryTypeLocal:\n        LOG(debug) \u003c\u003c \"GarlicDestination: Garlic type local\";\n        HandleI2NPMessage(buf, len, from);\n      break;\n      case eGarlicDeliveryTypeDestination:\n        LOG(debug) \u003c\u003c \"GarlicDestination: Garlic type destination\";\n        buf += 32;  // destination. check it later or for multiple destinations\n        HandleI2NPMessage(buf, len, from);\n      break;\n      case eGarlicDeliveryTypeTunnel: {\n        LOG(debug) \u003c\u003c \"GarlicDestination: Garlic type tunnel\";\n        // gateway_hash and gateway_tunnel sequence is reverted\n        std::uint8_t* gateway_hash = buf;\n        buf += 32;\n        std::uint32_t gateway_tunnel = bufbe32toh(buf);\n        buf += 4;\n        std::shared_ptr\u003ckovri::core::OutboundTunnel\u003e tunnel;\n        if (from \u0026\u0026 from-\u003eGetTunnelPool())\n          tunnel = from-\u003eGetTunnelPool()-\u003eGetNextOutboundTunnel();\n        // EI [BUG-TRACE] : The payload length is based on an unchecked length field\n        // EI             : from the just found I2NP message contained in the clove.\n        // EI\t          : When creating and sending this message onward we may leak\n        // EI             : heap memory data to the destination node [18/11/2017]\n        if (tunnel) {  // we have send it through an outbound tunnel\n          auto msg = CreateI2NPMessage(buf, kovri::core::GetI2NPMessageLength(buf), from);\n          tunnel-\u003eSendTunnelDataMsg(gateway_hash, gateway_tunnel, msg);\n        } else {\n          LOG(debug)\n            \u003c\u003c \"GarlicDestination: no outbound tunnels available for garlic clove\";\n        }\n        break;\n      }\n      case eGarlicDeliveryTypeRouter:\n        LOG(warning) \u003c\u003c \"GarlicDestination: Garlic type router not supported\";\n        buf += 32;\n      break;\n      default:\n        LOG(error)\n          \u003c\u003c \"GarlicDestination: unknown garlic delivery type \"\n          \u003c\u003c static_cast\u003cint\u003e(delivery_type);\n    }\n    buf += kovri::core::GetI2NPMessageLength(buf);  // I2NP\n    buf += 4;  // CloveID\n    buf += 8;  // Date\n    buf += 3;  // Certificate\n    // EI [BUG_TRACE] : This check is too late since the I2NP message was already sent. [18/11/2017]\n    if (buf - buf1  \u003e static_cast\u003cint\u003e(len)) {\n      LOG(error) \u003c\u003c \"GarlicDestination: clove is too long\";\n      break;\n    }\n```\n\nProposed Fix\n---------------\nThe inner I2NP message is parsed and forwarded using it's own length field BEFORE this field is checked for consistency. There is a good sanitation check in the bottom of the function, but the check is preformed only AFTER the message is sent.\n\nThe proposed fix is to copy the current code check to the vulnerable case, and to preform it before the new message is created:\n```cpp\n    case eGarlicDeliveryTypeTunnel: {\n        LOG(debug) \u003c\u003c \"GarlicDestination: Garlic type tunnel\";\n        // gateway_hash and gateway_tunnel sequence is reverted\n        std::uint8_t* gateway_hash = buf;\n        buf += 32;\n        std::uint32_t gateway_tunnel = bufbe32toh(buf);\n        buf += 4;\n        std::shared_ptr\u003ckovri::core::OutboundTunnel\u003e tunnel;\n        if (from \u0026\u0026 from-\u003eGetTunnelPool())\n          tunnel = from-\u003eGetTunnelPool()-\u003eGetNextOutboundTunnel();\n        // EI [BUG-FIX] : added this new check\n        if (buf + kovri::core::GetI2NPMessageLength(buf) + 4 + 8 + 3 - buf1  \u003e static_cast\u003cint\u003e(len)) {\n          LOG(error) \u003c\u003c \"GarlicDestination: clove is too long\";\n          break;\n        }\n        if (tunnel) {  // we have send it through an outbound tunnel\n          auto msg = CreateI2NPMessage(buf, kovri::core::GetI2NPMessageLength(buf), from);\n          tunnel-\u003eSendTunnelDataMsg(gateway_hash, gateway_tunnel, msg);\n        } else {\n          LOG(debug)\n            \u003c\u003c \"GarlicDestination: no outbound tunnels available for garlic clove\";\n        }\n        break;\n      }\n```\n\nImplications\n--------------\nSince the original message is allocated on the heap, this message can **leak massive amounts of heap data** to the receiving node (message lengths can be even 32KB). This data contains previous messages, currently treated messages, and many other sensitive data-structures of the I2P router.\n\nIn case there are any questions regarding my findings I will be more than happy to help.","vulnerability_information_html":"\u003ch2 id=\"brief\"\u003eBrief\u003c/h2\u003e\n\n\u003cp\u003eThere is a lack of sanitation checks when handling Garlic messages in the kovri I2P router. Sending a specially crafted Garlic message can cause the router to send onward an I2P message containing leaked RAM data, triggering a massive information leakage.\u003c/p\u003e\n\n\u003ch1 id=\"technical-details\"\u003eTechnical Details:\u003c/h1\u003e\n\n\u003cul\u003e\n\u003cli\u003eCode Version: Taken from Github on the 18th of November 2017 - commit 5aafe6608519d31e537c97b24ea7b23aa372dd5b\u003c/li\u003e\n\u003cli\u003eVulnerable File: src\\core\\router\\garlic.h\u003c/li\u003e\n\u003cli\u003eVulnerable Function: GarlicDestination::HandleGarlicPayload\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eThe function is responsible to parse and handle Garlic Payloads: several independent Garlic Cloves.\u003cbr\u003e\nWhen handling a clove with a delivery type of \u0026quot;DeliveryTypeTunnel\u0026quot; there are insufficient checks on the message, before it is wrapped and sent onward:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight cpp\"\u003e\u003ccode\u003e    \u003cspan class=\"n\"\u003eGarlicDeliveryType\u003c/span\u003e \u003cspan class=\"n\"\u003edelivery_type\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eGarlicDeliveryType\u003c/span\u003e\u003cspan class=\"p\"\u003e)((\u003c/span\u003e\u003cspan class=\"n\"\u003eflag\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026gt;\u0026gt;\u003c/span\u003e \u003cspan class=\"mi\"\u003e5\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026amp;\u003c/span\u003e \u003cspan class=\"mh\"\u003e0x03\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eswitch\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003edelivery_type\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"k\"\u003ecase\u003c/span\u003e \u003cspan class=\"n\"\u003eeGarlicDeliveryTypeLocal\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eLOG\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003edebug\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026lt;\u0026lt;\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026quot;GarlicDestination: Garlic type local\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eHandleI2NPMessage\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ebuf\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003elen\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003efrom\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n      \u003cspan class=\"k\"\u003ebreak\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n      \u003cspan class=\"k\"\u003ecase\u003c/span\u003e \u003cspan class=\"n\"\u003eeGarlicDeliveryTypeDestination\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eLOG\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003edebug\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026lt;\u0026lt;\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026quot;GarlicDestination: Garlic type destination\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"n\"\u003ebuf\u003c/span\u003e \u003cspan class=\"o\"\u003e+=\u003c/span\u003e \u003cspan class=\"mi\"\u003e32\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e  \u003cspan class=\"c1\"\u003e// destination. check it later or for multiple destinations\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eHandleI2NPMessage\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ebuf\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003elen\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003efrom\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n      \u003cspan class=\"k\"\u003ebreak\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n      \u003cspan class=\"k\"\u003ecase\u003c/span\u003e \u003cspan class=\"n\"\u003eeGarlicDeliveryTypeTunnel\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eLOG\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003edebug\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026lt;\u0026lt;\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026quot;GarlicDestination: Garlic type tunnel\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e// gateway_hash and gateway_tunnel sequence is reverted\u003c/span\u003e\n        \u003cspan class=\"n\"\u003estd\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"kt\"\u003euint8_t\u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003egateway_hash\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ebuf\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"n\"\u003ebuf\u003c/span\u003e \u003cspan class=\"o\"\u003e+=\u003c/span\u003e \u003cspan class=\"mi\"\u003e32\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"n\"\u003estd\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"kt\"\u003euint32_t\u003c/span\u003e \u003cspan class=\"n\"\u003egateway_tunnel\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ebufbe32toh\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ebuf\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"n\"\u003ebuf\u003c/span\u003e \u003cspan class=\"o\"\u003e+=\u003c/span\u003e \u003cspan class=\"mi\"\u003e4\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"n\"\u003estd\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"n\"\u003eshared_ptr\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003ekovri\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"n\"\u003ecore\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"n\"\u003eOutboundTunnel\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003etunnel\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003efrom\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e \u003cspan class=\"n\"\u003efrom\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"n\"\u003eGetTunnelPool\u003c/span\u003e\u003cspan class=\"p\"\u003e())\u003c/span\u003e\n          \u003cspan class=\"n\"\u003etunnel\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003efrom\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"n\"\u003eGetTunnelPool\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"n\"\u003eGetNextOutboundTunnel\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e// EI [BUG-TRACE] : The payload length is based on an unchecked length field\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e// EI             : from the just found I2NP message contained in the clove.\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e// EI             : When creating and sending this message onward we may leak\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e// EI             : heap memory data to the destination node [18/11/2017]\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003etunnel\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e  \u003cspan class=\"c1\"\u003e// we have send it through an outbound tunnel\u003c/span\u003e\n          \u003cspan class=\"k\"\u003eauto\u003c/span\u003e \u003cspan class=\"n\"\u003emsg\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eCreateI2NPMessage\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ebuf\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ekovri\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"n\"\u003ecore\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"n\"\u003eGetI2NPMessageLength\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ebuf\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e \u003cspan class=\"n\"\u003efrom\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n          \u003cspan class=\"n\"\u003etunnel\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"n\"\u003eSendTunnelDataMsg\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003egateway_hash\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003egateway_tunnel\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003emsg\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e \u003cspan class=\"k\"\u003eelse\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n          \u003cspan class=\"n\"\u003eLOG\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003edebug\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"o\"\u003e\u0026lt;\u0026lt;\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026quot;GarlicDestination: no outbound tunnels available for garlic clove\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n        \u003cspan class=\"k\"\u003ebreak\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n      \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n      \u003cspan class=\"k\"\u003ecase\u003c/span\u003e \u003cspan class=\"n\"\u003eeGarlicDeliveryTypeRouter\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eLOG\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ewarning\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026lt;\u0026lt;\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026quot;GarlicDestination: Garlic type router not supported\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"n\"\u003ebuf\u003c/span\u003e \u003cspan class=\"o\"\u003e+=\u003c/span\u003e \u003cspan class=\"mi\"\u003e32\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n      \u003cspan class=\"k\"\u003ebreak\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n      \u003cspan class=\"nl\"\u003edefault:\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eLOG\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eerror\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n          \u003cspan class=\"o\"\u003e\u0026lt;\u0026lt;\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026quot;GarlicDestination: unknown garlic delivery type \u0026quot;\u003c/span\u003e\n          \u003cspan class=\"o\"\u003e\u0026lt;\u0026lt;\u003c/span\u003e \u003cspan class=\"k\"\u003estatic_cast\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003edelivery_type\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"n\"\u003ebuf\u003c/span\u003e \u003cspan class=\"o\"\u003e+=\u003c/span\u003e \u003cspan class=\"n\"\u003ekovri\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"n\"\u003ecore\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"n\"\u003eGetI2NPMessageLength\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ebuf\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e  \u003cspan class=\"c1\"\u003e// I2NP\u003c/span\u003e\n    \u003cspan class=\"n\"\u003ebuf\u003c/span\u003e \u003cspan class=\"o\"\u003e+=\u003c/span\u003e \u003cspan class=\"mi\"\u003e4\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e  \u003cspan class=\"c1\"\u003e// CloveID\u003c/span\u003e\n    \u003cspan class=\"n\"\u003ebuf\u003c/span\u003e \u003cspan class=\"o\"\u003e+=\u003c/span\u003e \u003cspan class=\"mi\"\u003e8\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e  \u003cspan class=\"c1\"\u003e// Date\u003c/span\u003e\n    \u003cspan class=\"n\"\u003ebuf\u003c/span\u003e \u003cspan class=\"o\"\u003e+=\u003c/span\u003e \u003cspan class=\"mi\"\u003e3\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e  \u003cspan class=\"c1\"\u003e// Certificate\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e// EI [BUG_TRACE] : This check is too late since the I2NP message was already sent. [18/11/2017]\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ebuf\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e \u003cspan class=\"n\"\u003ebuf1\u003c/span\u003e  \u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"k\"\u003estatic_cast\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003elen\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"n\"\u003eLOG\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eerror\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026lt;\u0026lt;\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026quot;GarlicDestination: clove is too long\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n      \u003cspan class=\"k\"\u003ebreak\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2 id=\"proposed-fix\"\u003eProposed Fix\u003c/h2\u003e\n\n\u003cp\u003eThe inner I2NP message is parsed and forwarded using it\u0026#39;s own length field BEFORE this field is checked for consistency. There is a good sanitation check in the bottom of the function, but the check is preformed only AFTER the message is sent.\u003c/p\u003e\n\n\u003cp\u003eThe proposed fix is to copy the current code check to the vulnerable case, and to preform it before the new message is created:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight cpp\"\u003e\u003ccode\u003e    \u003cspan class=\"k\"\u003ecase\u003c/span\u003e \u003cspan class=\"n\"\u003eeGarlicDeliveryTypeTunnel\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eLOG\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003edebug\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026lt;\u0026lt;\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026quot;GarlicDestination: Garlic type tunnel\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e// gateway_hash and gateway_tunnel sequence is reverted\u003c/span\u003e\n        \u003cspan class=\"n\"\u003estd\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"kt\"\u003euint8_t\u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003egateway_hash\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ebuf\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"n\"\u003ebuf\u003c/span\u003e \u003cspan class=\"o\"\u003e+=\u003c/span\u003e \u003cspan class=\"mi\"\u003e32\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"n\"\u003estd\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"kt\"\u003euint32_t\u003c/span\u003e \u003cspan class=\"n\"\u003egateway_tunnel\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ebufbe32toh\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ebuf\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"n\"\u003ebuf\u003c/span\u003e \u003cspan class=\"o\"\u003e+=\u003c/span\u003e \u003cspan class=\"mi\"\u003e4\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"n\"\u003estd\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"n\"\u003eshared_ptr\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003ekovri\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"n\"\u003ecore\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"n\"\u003eOutboundTunnel\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003etunnel\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003efrom\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e \u003cspan class=\"n\"\u003efrom\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"n\"\u003eGetTunnelPool\u003c/span\u003e\u003cspan class=\"p\"\u003e())\u003c/span\u003e\n          \u003cspan class=\"n\"\u003etunnel\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003efrom\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"n\"\u003eGetTunnelPool\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"n\"\u003eGetNextOutboundTunnel\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e// EI [BUG-FIX] : added this new check\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ebuf\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"n\"\u003ekovri\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"n\"\u003ecore\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"n\"\u003eGetI2NPMessageLength\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ebuf\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"mi\"\u003e4\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"mi\"\u003e8\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"mi\"\u003e3\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e \u003cspan class=\"n\"\u003ebuf1\u003c/span\u003e  \u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"k\"\u003estatic_cast\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003elen\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n          \u003cspan class=\"n\"\u003eLOG\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eerror\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026lt;\u0026lt;\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026quot;GarlicDestination: clove is too long\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n          \u003cspan class=\"k\"\u003ebreak\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003etunnel\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e  \u003cspan class=\"c1\"\u003e// we have send it through an outbound tunnel\u003c/span\u003e\n          \u003cspan class=\"k\"\u003eauto\u003c/span\u003e \u003cspan class=\"n\"\u003emsg\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eCreateI2NPMessage\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ebuf\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ekovri\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"n\"\u003ecore\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"n\"\u003eGetI2NPMessageLength\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ebuf\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e \u003cspan class=\"n\"\u003efrom\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n          \u003cspan class=\"n\"\u003etunnel\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"n\"\u003eSendTunnelDataMsg\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003egateway_hash\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003egateway_tunnel\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003emsg\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e \u003cspan class=\"k\"\u003eelse\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n          \u003cspan class=\"n\"\u003eLOG\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003edebug\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"o\"\u003e\u0026lt;\u0026lt;\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026quot;GarlicDestination: no outbound tunnels available for garlic clove\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n        \u003cspan class=\"k\"\u003ebreak\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n      \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2 id=\"implications\"\u003eImplications\u003c/h2\u003e\n\n\u003cp\u003eSince the original message is allocated on the heap, this message can \u003cstrong\u003eleak massive amounts of heap data\u003c/strong\u003e to the receiving node (message lengths can be even 32KB). This data contains previous messages, currently treated messages, and many other sensitive data-structures of the I2P router.\u003c/p\u003e\n\n\u003cp\u003eIn case there are any questions regarding my findings I will be more than happy to help.\u003c/p\u003e\n","weakness":{"id":18,"name":"Information Disclosure"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2018-01-04T02:22:03.443Z","allow_singular_disclosure_after":-94186998.37768348,"singular_disclosure_allowed":true,"vote_count":14,"voters":["jokebookservice1","heeeeen","corb3nik","theraz0r","soiax","eveeez","geeknik","r3y","ronak_9889","cr4xerbik4sh","and 4 more..."],"severity":{"rating":"high","score":7.7,"author_type":"User","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"low","user_interaction":"none","scope":"changed","confidentiality":"high","integrity":"none","availability":"none"}},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":2171766,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi Eyal,\n\nFirstly, welcome to the Monero community - and thank you for your report! If I may ask, how did you find out about Kovri and HackerOne? We're glad to see you.\n\nSecondly, important disclaimers:\n\n- Kovri is pre-alpha, and pre-alpha for a reason. This is not my code nor have I given it my seal of approval. Much of Kovri development has been mostly rewriting the spaghetti code anti-pattern raw pointer nightmare of i2pd.\n- This is not the first time a raw leaks have arose from the pre-forked code nor will it be the last case until QA is complete. See [here](https://github.com/monero-project/kovri/issues/65), [here](https://github.com/monero-project/kovri/issues/64), and [here](https://github.com/monero-project/kovri/commit/82650a25de708bd4cc34608cf200bb58fb2e42bc).\n- I have not ensured any QA on tunnel/I2NP as noted [in this issue](https://github.com/monero-project/kovri/issues/511) (garlic is implied though I should probably update the issue for verbosity) and, with the exception of at least two small commits, I've literally not done any *directly-related* work on the garlic implementation nor have I sat down with the implementation to make all the necessary changes.\n- Though I understand the appeal of your issue title, do note that:\n  - OpenSSL was initially released in 1998 and has had continous releases since then.\n  - OpenSSL has become the crux of the internet's security and safety backbone for what's possibly been trillions of dollars of e-commerce since browser https was first implemented.\n  - OpenSSL has had 100's if not 1000's of contributors/reviewers since 1998. Kovri has only 1 full-time developer since last year and only a handful of contributors.\n- Months ago, we discussed the need to have HackerOne reports for Kovri only apply to crypto and research because of the massive amount of known issues that have yet to be resolved e.g., if we release bounty for everyone of these kinds of reports, the bounty fund would go broke. These types reports are literally \"like shooting fish in a barrel\" because the code we forked from was so poorly designed and written - and there is still much more core code review needed. Unfortunately, this discussion never made it to HackerOne and there is still a [meta issue](https://github.com/monero-project/meta/issues/83) for this. As such, we'll have to discuss internally how to resolve the bounty situation but **I'm sure you will receive a reward** because, in this case, we haven't accurately reported Kovri guidelines (I can only do much on my own).\n\nWith that said, let's elaborate on the issue and take a look deeper (the issue is not endemic to just tunnel delivery type):\n\n```diff\ndiff --git a/src/core/router/i2np.cc b/src/core/router/i2np.cc\nindex 55a7d123..d2c97626 100644\n--- a/src/core/router/i2np.cc\n+++ b/src/core/router/i2np.cc\n@@ -107,14 +107,25 @@ std::unique_ptr\u003cI2NPMessage\u003e CreateI2NPMessage(\n     msg-\u003elen += len;\n   } else {\n     LOG(error) \u003c\u003c \"I2NPMessage: message length \" \u003c\u003c len \u003c\u003c \" exceeds max length\";\n+    // TODO(anonimal): ...then don't return the message...\n   }\n   msg-\u003eFillI2NPMessageHeader(msg_type, reply_msg_ID);\n   return msg;\n }\n \n+// TDDO(anonimal):                                                                                                                                                                                               \n+//   Theoretically, and despite the signed type, len passed has the potential to be 64k (value given in 2 bytes 0xffff)                                                                                          \n+//   but, because of I2NP fragmentation + alignment, the max should be no more than 62708 bytes (61.2k for tunnel delivery mode).                                                                                \n+//                                                                                                                                                                                                               \n+//   Now, msg-\u003emax_len is at a minimum 4k (\"short\" message) or at most 32k depending on message type.                                                                                                            \n+//   The below sanity test ensures that passed len is \u003c (4k || 32k) *BUT* that still leaves potential for copying over                                                                                           \n+//   ((msg-\u003emax_len - 1) - len) amount of memory (memory after payload, potentially uninitialized) into the message buffer                                                                                       \n+//   which is then sent through the tunnel.  TODO(anonimal): ensure callers never send incorrect length to begin with.                                                                                           \n+//                                                                                                                                                                                                               \n+//   Note: NTCP limits message size to to 16378 bytes and SSU limits (should) to 32k.                                                                                                                            \n std::shared_ptr\u003cI2NPMessage\u003e CreateI2NPMessage(                                                                                                                                                                  \n     const std::uint8_t* buf,                                                                                                                                                                                     \n-    int len,                                                                                                                                                                                                     \n+    int len,  // TODO(anonimal): uint16_t, and caller should ensure no overflow                                                                                                                                  \n     std::shared_ptr\u003ckovri::core::InboundTunnel\u003e from) {                                                                                                                                                          \n   std::unique_ptr\u003cI2NPMessage\u003e msg = NewI2NPMessage();\n   if (msg-\u003eoffset + len \u003c msg-\u003emax_len) {\n@@ -123,6 +134,7 @@ std::shared_ptr\u003cI2NPMessage\u003e CreateI2NPMessage(\n     msg-\u003efrom = from;\n   } else {\n     LOG(error) \u003c\u003c \"I2NPMessage: message length \" \u003c\u003c len \u003c\u003c \" exceeds max length\";\n+    // TODO(anonimal): now why would we want to send an empty message?!...\n   }\n   return ToSharedI2NPMessage(std::move(msg));\n }\n@@ -644,6 +656,7 @@ std::unique_ptr\u003cI2NPMessage\u003e CreateTunnelGatewayMsg(\n   return msg;\n }\n \n+// TODO(anonimal): s/size_t/uint16_t/\n std::size_t GetI2NPMessageLength(\n     const std::uint8_t* msg) {\n   return bufbe16toh(msg + I2NP_HEADER_SIZE_OFFSET) + I2NP_HEADER_SIZE;\n```\n\nNow, let's elaborate more on this patch (also note the TODOs and another raw memory leak that I've marked in all caps):\n\n\n```diff\ndiff --git a/src/core/router/garlic.cc b/src/core/router/garlic.cc\nindex b6c9ad23..86e8cf0e 100644\n--- a/src/core/router/garlic.cc\n+++ b/src/core/router/garlic.cc\n@@ -264,7 +264,7 @@ std::size_t GarlicRoutingSession::CreateAESBlock(\n   block_size += len;\n   std::size_t rem = block_size % 16;\n   if (rem)\n-    block_size += (16-rem);  // padding\n+    block_size += (16-rem);  // TODO(anonimal): MUST BE RANDOM PADDING!\n   // TODO(anonimal): this try block should be larger or handled entirely by caller\n   try {\n     m_Encryption.Encrypt(buf, block_size, buf);\n@@ -571,11 +571,49 @@ void GarlicDestination::HandleAESBlock(\n   }\n }\n \n+// TODO(anonimal): this may be the only caller that checks received garlic message payload length\n void GarlicDestination::HandleGarlicPayload(\n     std::uint8_t* buf,\n     std::size_t len,\n-    std::shared_ptr\u003ckovri::core::InboundTunnel\u003e from) {\n+    std::shared_ptr\u003ckovri::core::InboundTunnel\u003e from)\n+{\n+  LOG(trace) \u003c\u003c \"GarlicDestination: \" \u003c\u003c __func__\n+             \u003c\u003c \": inbound tunnel ID: \" \u003c\u003c from-\u003eGetTunnelID()\n+             \u003c\u003c \": purported length: \" \u003c\u003c len \u003c\u003c GetFormattedHex(buf, len);\n+\n+  // Save state\n   const std::uint8_t* buf1 = buf;\n+\n+  // Payload offset after I2NP message\n+  enum Clove : std::uint8_t\n+  {                                                                                                                                                                                                              \n+    ID = 4,                                                                                                                                                                                                      \n+    Date = 8,                                                                                                                                                                                                    \n+    Cert = 3                                                                                                                                                                                                     \n+  };                                                                                                                                                                                                             \n+                                                                                                                                                                                                                 \n+  // Validate clove length after processing but before creating message / sending through tunnel                                                                                                                 \n+  auto check_clove_len = [buf1, len](std::uint8_t*\u0026 buf, bool increment) {                                                                                                                                       \n+    // I2NP length                                                                                                                                                                                               \n+    const std::uint16_t msg_len = GetI2NPMessageLength(buf);                                                                                                                                                     \n+    LOG(debug) \u003c\u003c \"GarlicDestination: I2NP message len=\" \u003c\u003c msg_len;                                                                                                                                             \n+                                                                                                                                                                                                                 \n+    const std::uint16_t offset =                                                                                                                                                                                 \n+        msg_len + Clove::ID + Clove::Date + Clove::Cert;                                                                                                                                                         \n+    LOG(debug) \u003c\u003c \"GarlicDestination: garlic payload offset=\" \u003c\u003c offset;                                                                                                                                         \n+\n+    // Sanity test\n+    if ((buf + offset) - buf1 \u003e static_cast\u003cint\u003e(len))\n+      // TODO(anonimal): in this case, do we want to throw out the entire payload? If not, don't throw.\n+      throw std::runtime_error(\"GarlicDestination: clove is too long\");\n+\n+    // Increment to ensure all given cloves are checked\n+    if (increment)\n+      buf += offset;\n+\n+    return msg_len;\n+  };\n+\n   std::size_t num_cloves = buf[0];\n   LOG(debug) \u003c\u003c \"GarlicDestination: \" \u003c\u003c num_cloves \u003c\u003c \" cloves\";\n   buf++;\n@@ -609,8 +647,8 @@ void GarlicDestination::HandleGarlicPayload(\n         std::shared_ptr\u003ckovri::core::OutboundTunnel\u003e tunnel;\n         if (from \u0026\u0026 from-\u003eGetTunnelPool())\n           tunnel = from-\u003eGetTunnelPool()-\u003eGetNextOutboundTunnel();\n-        if (tunnel) {  // we have send it through an outbound tunnel\n-          auto msg = CreateI2NPMessage(buf, kovri::core::GetI2NPMessageLength(buf), from);\n+        if (tunnel) {  // we must send it through an outbound tunnel\n+          auto msg = CreateI2NPMessage(buf, check_clove_len(buf, false), from);\n           tunnel-\u003eSendTunnelDataMsg(gateway_hash, gateway_tunnel, msg);\n         } else {\n           LOG(debug)\n@@ -626,15 +664,9 @@ void GarlicDestination::HandleGarlicPayload(\n         LOG(error)\n           \u003c\u003c \"GarlicDestination: unknown garlic delivery type \"\n           \u003c\u003c static_cast\u003cint\u003e(delivery_type);\n+        // TODO(anonimal): we should throw, pending responsible callers\n     }\n-    buf += kovri::core::GetI2NPMessageLength(buf);  // I2NP\n-    buf += 4;  // CloveID\n-    buf += 8;  // Date\n-    buf += 3;  // Certificate\n-    if (buf - buf1  \u003e static_cast\u003cint\u003e(len)) {\n-      LOG(error) \u003c\u003c \"GarlicDestination: clove is too long\";\n-      break;\n-    }\n+    check_clove_len(buf, true);\n   }\n }\n \n@@ -691,6 +723,7 @@ void GarlicDestination::DeliveryStatusSent(\n   m_CreatedSessions[msg_ID] = session;\n }\n \n+// TODO(anonimal): at worst, the message isn't ACKd\n void GarlicDestination::HandleDeliveryStatusMessage(\n     std::shared_ptr\u003cI2NPMessage\u003e msg) {\n     std::uint32_t msg_ID = bufbe32toh(msg-\u003eGetPayload()); {\n```\n\nThis performs the sanity test while improving maintainability, documentation, and logging (though throwing may break things that shouldn't break nor should be able to break in the first place if a callee throws). Like your patch, the only fallback to this patch is that the check is called twice for 2 cloves or more but, again, this is a patch. Improvements are welcome.\n\n\u003eSending a specially crafted Garlic message can cause the router to send onward an I2P message containing leaked RAM data, triggering a massive information leakage.\n\nCan you provide a PoC exploit? Looking at this function alone and at no other controls, the potential leak is obvious - but ultimately the claim is still speculative. Without a PoC exploit, this report merely points out already-documented design issues. Also note that transport/tunnel/garlic message handling in I2P is convoluted and has many caveats. Though we could theoretically conjure any 2 byte size for payload length or any size \u003e actual clove length (and the memory does appear to be uninitialized), are you certain that no other checks are in place in any of the callers or clove creation functions? Hint: look in the surrounding areas around all calls to htobe16buf(buf, len). And, mind you, this would need to be exploited *before* payload hash is created or else verify will fail (AFAICT).\n\nThis report came at an odd time since I had plans to be AFK all week after Monday and, as such, I can't look further into the issue or even my own questions until the weekend or next Monday at the latest. Despite being pre-alpha, without a release, and the lack of a PoC exploit, a patch should be applied regardless - so I will check-in this week before the weekend to ensure that this issue is resolved in a timely manner.\n\nThanks again, Eyal","markdown_message":"\u003cp\u003eHi Eyal,\u003c/p\u003e\n\n\u003cp\u003eFirstly, welcome to the Monero community - and thank you for your report! If I may ask, how did you find out about Kovri and HackerOne? We\u0026#39;re glad to see you.\u003c/p\u003e\n\n\u003cp\u003eSecondly, important disclaimers:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eKovri is pre-alpha, and pre-alpha for a reason. This is not my code nor have I given it my seal of approval. Much of Kovri development has been mostly rewriting the spaghetti code anti-pattern raw pointer nightmare of i2pd.\u003c/li\u003e\n\u003cli\u003eThis is not the first time a raw leaks have arose from the pre-forked code nor will it be the last case until QA is complete. See \u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fmonero-project%2Fkovri%2Fissues%2F65\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehere\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e, \u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fmonero-project%2Fkovri%2Fissues%2F64\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehere\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e, and \u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fmonero-project%2Fkovri%2Fcommit%2F82650a25de708bd4cc34608cf200bb58fb2e42bc\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehere\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e.\u003c/li\u003e\n\u003cli\u003eI have not ensured any QA on tunnel/I2NP as noted \u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fmonero-project%2Fkovri%2Fissues%2F511\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ein this issue\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e (garlic is implied though I should probably update the issue for verbosity) and, with the exception of at least two small commits, I\u0026#39;ve literally not done any \u003cem\u003edirectly-related\u003c/em\u003e work on the garlic implementation nor have I sat down with the implementation to make all the necessary changes.\u003c/li\u003e\n\u003cli\u003eThough I understand the appeal of your issue title, do note that:\n\n\u003cul\u003e\n\u003cli\u003eOpenSSL was initially released in 1998 and has had continous releases since then.\u003c/li\u003e\n\u003cli\u003eOpenSSL has become the crux of the internet\u0026#39;s security and safety backbone for what\u0026#39;s possibly been trillions of dollars of e-commerce since browser https was first implemented.\u003c/li\u003e\n\u003cli\u003eOpenSSL has had 100\u0026#39;s if not 1000\u0026#39;s of contributors/reviewers since 1998. Kovri has only 1 full-time developer since last year and only a handful of contributors.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eMonths ago, we discussed the need to have HackerOne reports for Kovri only apply to crypto and research because of the massive amount of known issues that have yet to be resolved e.g., if we release bounty for everyone of these kinds of reports, the bounty fund would go broke. These types reports are literally \u0026quot;like shooting fish in a barrel\u0026quot; because the code we forked from was so poorly designed and written - and there is still much more core code review needed. Unfortunately, this discussion never made it to HackerOne and there is still a \u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fmonero-project%2Fmeta%2Fissues%2F83\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003emeta issue\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e for this. As such, we\u0026#39;ll have to discuss internally how to resolve the bounty situation but \u003cstrong\u003eI\u0026#39;m sure you will receive a reward\u003c/strong\u003e because, in this case, we haven\u0026#39;t accurately reported Kovri guidelines (I can only do much on my own).\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eWith that said, let\u0026#39;s elaborate on the issue and take a look deeper (the issue is not endemic to just tunnel delivery type):\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight diff\"\u003e\u003ccode\u003e\u003cspan class=\"gh\"\u003ediff --git a/src/core/router/i2np.cc b/src/core/router/i2np.cc\nindex 55a7d123..d2c97626 100644\n\u003c/span\u003e\u003cspan class=\"gd\"\u003e--- a/src/core/router/i2np.cc\n\u003c/span\u003e\u003cspan class=\"gi\"\u003e+++ b/src/core/router/i2np.cc\n\u003c/span\u003e\u003cspan class=\"p\"\u003e@@ -107,14 +107,25 @@\u003c/span\u003e std::unique_ptr\u0026lt;I2NPMessage\u0026gt; CreateI2NPMessage(\n     msg-\u0026gt;len += len;\n   } else {\n     LOG(error) \u0026lt;\u0026lt; \u0026quot;I2NPMessage: message length \u0026quot; \u0026lt;\u0026lt; len \u0026lt;\u0026lt; \u0026quot; exceeds max length\u0026quot;;\n\u003cspan class=\"gi\"\u003e+    // TODO(anonimal): ...then don\u0026#39;t return the message...\n\u003c/span\u003e   }\n   msg-\u0026gt;FillI2NPMessageHeader(msg_type, reply_msg_ID);\n   return msg;\n }\n\n+// TDDO(anonimal):                                                                                                                                                                                               \n\u003cspan class=\"gi\"\u003e+//   Theoretically, and despite the signed type, len passed has the potential to be 64k (value given in 2 bytes 0xffff)                                                                                          \n+//   but, because of I2NP fragmentation + alignment, the max should be no more than 62708 bytes (61.2k for tunnel delivery mode).                                                                                \n+//                                                                                                                                                                                                               \n+//   Now, msg-\u0026gt;max_len is at a minimum 4k (\u0026quot;short\u0026quot; message) or at most 32k depending on message type.                                                                                                            \n+//   The below sanity test ensures that passed len is \u0026lt; (4k || 32k) *BUT* that still leaves potential for copying over                                                                                           \n+//   ((msg-\u0026gt;max_len - 1) - len) amount of memory (memory after payload, potentially uninitialized) into the message buffer                                                                                       \n+//   which is then sent through the tunnel.  TODO(anonimal): ensure callers never send incorrect length to begin with.                                                                                           \n+//                                                                                                                                                                                                               \n+//   Note: NTCP limits message size to to 16378 bytes and SSU limits (should) to 32k.                                                                                                                            \n\u003c/span\u003e std::shared_ptr\u0026lt;I2NPMessage\u0026gt; CreateI2NPMessage(                                                                                                                                                                  \n     const std::uint8_t* buf,                                                                                                                                                                                     \n\u003cspan class=\"gd\"\u003e-    int len,                                                                                                                                                                                                     \n\u003c/span\u003e\u003cspan class=\"gi\"\u003e+    int len,  // TODO(anonimal): uint16_t, and caller should ensure no overflow                                                                                                                                  \n\u003c/span\u003e     std::shared_ptr\u0026lt;kovri::core::InboundTunnel\u0026gt; from) {                                                                                                                                                          \n   std::unique_ptr\u0026lt;I2NPMessage\u0026gt; msg = NewI2NPMessage();\n   if (msg-\u0026gt;offset + len \u0026lt; msg-\u0026gt;max_len) {\n\u003cspan class=\"p\"\u003e@@ -123,6 +134,7 @@\u003c/span\u003e std::shared_ptr\u0026lt;I2NPMessage\u0026gt; CreateI2NPMessage(\n     msg-\u0026gt;from = from;\n   } else {\n     LOG(error) \u0026lt;\u0026lt; \u0026quot;I2NPMessage: message length \u0026quot; \u0026lt;\u0026lt; len \u0026lt;\u0026lt; \u0026quot; exceeds max length\u0026quot;;\n\u003cspan class=\"gi\"\u003e+    // TODO(anonimal): now why would we want to send an empty message?!...\n\u003c/span\u003e   }\n   return ToSharedI2NPMessage(std::move(msg));\n }\n\u003cspan class=\"p\"\u003e@@ -644,6 +656,7 @@\u003c/span\u003e std::unique_ptr\u0026lt;I2NPMessage\u0026gt; CreateTunnelGatewayMsg(\n   return msg;\n }\n\n+// TODO(anonimal): s/size_t/uint16_t/\n std::size_t GetI2NPMessageLength(\n     const std::uint8_t* msg) {\n   return bufbe16toh(msg + I2NP_HEADER_SIZE_OFFSET) + I2NP_HEADER_SIZE;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eNow, let\u0026#39;s elaborate more on this patch (also note the TODOs and another raw memory leak that I\u0026#39;ve marked in all caps):\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight diff\"\u003e\u003ccode\u003e\u003cspan class=\"gh\"\u003ediff --git a/src/core/router/garlic.cc b/src/core/router/garlic.cc\nindex b6c9ad23..86e8cf0e 100644\n\u003c/span\u003e\u003cspan class=\"gd\"\u003e--- a/src/core/router/garlic.cc\n\u003c/span\u003e\u003cspan class=\"gi\"\u003e+++ b/src/core/router/garlic.cc\n\u003c/span\u003e\u003cspan class=\"p\"\u003e@@ -264,7 +264,7 @@\u003c/span\u003e std::size_t GarlicRoutingSession::CreateAESBlock(\n   block_size += len;\n   std::size_t rem = block_size % 16;\n   if (rem)\n\u003cspan class=\"gd\"\u003e-    block_size += (16-rem);  // padding\n\u003c/span\u003e\u003cspan class=\"gi\"\u003e+    block_size += (16-rem);  // TODO(anonimal): MUST BE RANDOM PADDING!\n\u003c/span\u003e   // TODO(anonimal): this try block should be larger or handled entirely by caller\n   try {\n     m_Encryption.Encrypt(buf, block_size, buf);\n\u003cspan class=\"p\"\u003e@@ -571,11 +571,49 @@\u003c/span\u003e void GarlicDestination::HandleAESBlock(\n   }\n }\n\n+// TODO(anonimal): this may be the only caller that checks received garlic message payload length\n void GarlicDestination::HandleGarlicPayload(\n     std::uint8_t* buf,\n     std::size_t len,\n\u003cspan class=\"gd\"\u003e-    std::shared_ptr\u0026lt;kovri::core::InboundTunnel\u0026gt; from) {\n\u003c/span\u003e\u003cspan class=\"gi\"\u003e+    std::shared_ptr\u0026lt;kovri::core::InboundTunnel\u0026gt; from)\n+{\n+  LOG(trace) \u0026lt;\u0026lt; \u0026quot;GarlicDestination: \u0026quot; \u0026lt;\u0026lt; __func__\n+             \u0026lt;\u0026lt; \u0026quot;: inbound tunnel ID: \u0026quot; \u0026lt;\u0026lt; from-\u0026gt;GetTunnelID()\n+             \u0026lt;\u0026lt; \u0026quot;: purported length: \u0026quot; \u0026lt;\u0026lt; len \u0026lt;\u0026lt; GetFormattedHex(buf, len);\n+\n+  // Save state\n\u003c/span\u003e   const std::uint8_t* buf1 = buf;\n\u003cspan class=\"gi\"\u003e+\n+  // Payload offset after I2NP message\n+  enum Clove : std::uint8_t\n+  {                                                                                                                                                                                                              \n+    ID = 4,                                                                                                                                                                                                      \n+    Date = 8,                                                                                                                                                                                                    \n+    Cert = 3                                                                                                                                                                                                     \n+  };                                                                                                                                                                                                             \n+                                                                                                                                                                                                                 \n+  // Validate clove length after processing but before creating message / sending through tunnel                                                                                                                 \n+  auto check_clove_len = [buf1, len](std::uint8_t*\u0026amp; buf, bool increment) {                                                                                                                                       \n+    // I2NP length                                                                                                                                                                                               \n+    const std::uint16_t msg_len = GetI2NPMessageLength(buf);                                                                                                                                                     \n+    LOG(debug) \u0026lt;\u0026lt; \u0026quot;GarlicDestination: I2NP message len=\u0026quot; \u0026lt;\u0026lt; msg_len;                                                                                                                                             \n+                                                                                                                                                                                                                 \n+    const std::uint16_t offset =                                                                                                                                                                                 \n+        msg_len + Clove::ID + Clove::Date + Clove::Cert;                                                                                                                                                         \n+    LOG(debug) \u0026lt;\u0026lt; \u0026quot;GarlicDestination: garlic payload offset=\u0026quot; \u0026lt;\u0026lt; offset;                                                                                                                                         \n+\n+    // Sanity test\n+    if ((buf + offset) - buf1 \u0026gt; static_cast\u0026lt;int\u0026gt;(len))\n+      // TODO(anonimal): in this case, do we want to throw out the entire payload? If not, don\u0026#39;t throw.\n+      throw std::runtime_error(\u0026quot;GarlicDestination: clove is too long\u0026quot;);\n+\n+    // Increment to ensure all given cloves are checked\n+    if (increment)\n+      buf += offset;\n+\n+    return msg_len;\n+  };\n+\n\u003c/span\u003e   std::size_t num_cloves = buf[0];\n   LOG(debug) \u0026lt;\u0026lt; \u0026quot;GarlicDestination: \u0026quot; \u0026lt;\u0026lt; num_cloves \u0026lt;\u0026lt; \u0026quot; cloves\u0026quot;;\n   buf++;\n\u003cspan class=\"p\"\u003e@@ -609,8 +647,8 @@\u003c/span\u003e void GarlicDestination::HandleGarlicPayload(\n         std::shared_ptr\u0026lt;kovri::core::OutboundTunnel\u0026gt; tunnel;\n         if (from \u0026amp;\u0026amp; from-\u0026gt;GetTunnelPool())\n           tunnel = from-\u0026gt;GetTunnelPool()-\u0026gt;GetNextOutboundTunnel();\n\u003cspan class=\"gd\"\u003e-        if (tunnel) {  // we have send it through an outbound tunnel\n-          auto msg = CreateI2NPMessage(buf, kovri::core::GetI2NPMessageLength(buf), from);\n\u003c/span\u003e\u003cspan class=\"gi\"\u003e+        if (tunnel) {  // we must send it through an outbound tunnel\n+          auto msg = CreateI2NPMessage(buf, check_clove_len(buf, false), from);\n\u003c/span\u003e           tunnel-\u0026gt;SendTunnelDataMsg(gateway_hash, gateway_tunnel, msg);\n         } else {\n           LOG(debug)\n\u003cspan class=\"p\"\u003e@@ -626,15 +664,9 @@\u003c/span\u003e void GarlicDestination::HandleGarlicPayload(\n         LOG(error)\n           \u0026lt;\u0026lt; \u0026quot;GarlicDestination: unknown garlic delivery type \u0026quot;\n           \u0026lt;\u0026lt; static_cast\u0026lt;int\u0026gt;(delivery_type);\n\u003cspan class=\"gi\"\u003e+        // TODO(anonimal): we should throw, pending responsible callers\n\u003c/span\u003e     }\n\u003cspan class=\"gd\"\u003e-    buf += kovri::core::GetI2NPMessageLength(buf);  // I2NP\n-    buf += 4;  // CloveID\n-    buf += 8;  // Date\n-    buf += 3;  // Certificate\n-    if (buf - buf1  \u0026gt; static_cast\u0026lt;int\u0026gt;(len)) {\n-      LOG(error) \u0026lt;\u0026lt; \u0026quot;GarlicDestination: clove is too long\u0026quot;;\n-      break;\n-    }\n\u003c/span\u003e\u003cspan class=\"gi\"\u003e+    check_clove_len(buf, true);\n\u003c/span\u003e   }\n }\n\n@@ -691,6 +723,7 @@ void GarlicDestination::DeliveryStatusSent(\n   m_CreatedSessions[msg_ID] = session;\n }\n\n+// TODO(anonimal): at worst, the message isn\u0026#39;t ACKd\n void GarlicDestination::HandleDeliveryStatusMessage(\n     std::shared_ptr\u0026lt;I2NPMessage\u0026gt; msg) {\n     std::uint32_t msg_ID = bufbe32toh(msg-\u0026gt;GetPayload()); {\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThis performs the sanity test while improving maintainability, documentation, and logging (though throwing may break things that shouldn\u0026#39;t break nor should be able to break in the first place if a callee throws). Like your patch, the only fallback to this patch is that the check is called twice for 2 cloves or more but, again, this is a patch. Improvements are welcome.\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eSending a specially crafted Garlic message can cause the router to send onward an I2P message containing leaked RAM data, triggering a massive information leakage.\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eCan you provide a PoC exploit? Looking at this function alone and at no other controls, the potential leak is obvious - but ultimately the claim is still speculative. Without a PoC exploit, this report merely points out already-documented design issues. Also note that transport/tunnel/garlic message handling in I2P is convoluted and has many caveats. Though we could theoretically conjure any 2 byte size for payload length or any size \u0026gt; actual clove length (and the memory does appear to be uninitialized), are you certain that no other checks are in place in any of the callers or clove creation functions? Hint: look in the surrounding areas around all calls to htobe16buf(buf, len). And, mind you, this would need to be exploited \u003cem\u003ebefore\u003c/em\u003e payload hash is created or else verify will fail (AFAICT).\u003c/p\u003e\n\n\u003cp\u003eThis report came at an odd time since I had plans to be AFK all week after Monday and, as such, I can\u0026#39;t look further into the issue or even my own questions until the weekend or next Monday at the latest. Despite being pre-alpha, without a release, and the lack of a PoC exploit, a patch should be applied regardless - so I will check-in this week before the weekend to ensure that this issue is resolved in a timely manner.\u003c/p\u003e\n\n\u003cp\u003eThanks again, Eyal\u003c/p\u003e\n","automated_response":false,"created_at":"2017-11-21T00:02:40.517Z","updated_at":"2017-11-21T00:02:40.517Z","actor":{"username":"anonimal","cleared":false,"url":"/anonimal","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/040/857/f23cc3be09a21e17bc43975987c10ba2b6427239_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"monero","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2171769,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"","markdown_message":"","automated_response":false,"created_at":"2017-11-21T00:03:38.633Z","updated_at":"2017-11-21T00:03:38.633Z","actor":{"username":"anonimal","cleared":false,"url":"/anonimal","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/040/857/f23cc3be09a21e17bc43975987c10ba2b6427239_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"monero","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2172232,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"First thing first, I saw your project through hackerOne and decided to check if I can found something interesting in it.\n\nRegarding your fix: I personally would use unt32_t for the types in the check to avoid a possible integer-overflow in the assignment into offset. Such overflow will cause the size checks to pass with a possible length of ~0xFFFF.\n\nRegarding the PoC, since I didn't use a model to check my findings, I looked very carefully on all of the rellevant code. From the buffer allocation / free, to the entire message handling flow. In addition, this message was just decrypted and so no one else could have checked this length field before the vulnerable function. Again, I point to an attack by a node that properly signed and encrypted a hostile clove, and so the hash won't be a problem, nor does the message needs to be just as the source node should have created it.\n\nCode trail:\n* HandleAESBlock: decrypts into \"buf\" and advances it beyond the tags, key, hash and flags. Calls the payload handling with buf.\n* HandleGarlicPayload: parses \"num_cloves\" and runs in a loop to parse each clove from \"buf\". Creating the message according to the length field.\n* GetI2PMessageLength: bufbe16toh() + header size\n* bufbe16toh: be16toh(buf16toh(buf))\nAnd none of these last two function has any check / can validate this parsed value against the real message length. If the message length will be 1000 than even a length field of 2000 will leak ~1000 bytes and none of these functions can check it.\n\nLater on, inside CreateI2PMessage \"len\" just needs to be smaller the max message length of I2P, and the data will be copied to the buffer of the newly created message.\n\nP.S. I should prefer to demonstrate a full PoC but I don't think I have the knowledge needed to bring up a functioning model including two nodes properly communicating with each other.\n\nHope this answers the questions.","markdown_message":"\u003cp\u003eFirst thing first, I saw your project through hackerOne and decided to check if I can found something interesting in it.\u003c/p\u003e\n\n\u003cp\u003eRegarding your fix: I personally would use unt32_t for the types in the check to avoid a possible integer-overflow in the assignment into offset. Such overflow will cause the size checks to pass with a possible length of ~0xFFFF.\u003c/p\u003e\n\n\u003cp\u003eRegarding the PoC, since I didn\u0026#39;t use a model to check my findings, I looked very carefully on all of the rellevant code. From the buffer allocation / free, to the entire message handling flow. In addition, this message was just decrypted and so no one else could have checked this length field before the vulnerable function. Again, I point to an attack by a node that properly signed and encrypted a hostile clove, and so the hash won\u0026#39;t be a problem, nor does the message needs to be just as the source node should have created it.\u003c/p\u003e\n\n\u003cp\u003eCode trail:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eHandleAESBlock: decrypts into \u0026quot;buf\u0026quot; and advances it beyond the tags, key, hash and flags. Calls the payload handling with buf.\u003c/li\u003e\n\u003cli\u003eHandleGarlicPayload: parses \u0026quot;num_cloves\u0026quot; and runs in a loop to parse each clove from \u0026quot;buf\u0026quot;. Creating the message according to the length field.\u003c/li\u003e\n\u003cli\u003eGetI2PMessageLength: bufbe16toh() + header size\u003c/li\u003e\n\u003cli\u003ebufbe16toh: be16toh(buf16toh(buf))\nAnd none of these last two function has any check / can validate this parsed value against the real message length. If the message length will be 1000 than even a length field of 2000 will leak ~1000 bytes and none of these functions can check it.\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eLater on, inside CreateI2PMessage \u0026quot;len\u0026quot; just needs to be smaller the max message length of I2P, and the data will be copied to the buffer of the newly created message.\u003c/p\u003e\n\n\u003cp\u003eP.S. I should prefer to demonstrate a full PoC but I don\u0026#39;t think I have the knowledge needed to bring up a functioning model including two nodes properly communicating with each other.\u003c/p\u003e\n\n\u003cp\u003eHope this answers the questions.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-11-21T08:12:20.410Z","updated_at":"2017-11-21T08:12:20.410Z","actor":{"username":"aerodudrizzt","cleared":false,"url":"/aerodudrizzt","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/098/646/ebd692682f9cff0731c0021d35f72330a3c88a8c_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"monero","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2181336,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"PoC\n====\nI managed to bring up a test environment, and added debug traces to the kovri router I compiled:\n* My traces starts with \"EI-DEBUG\"\n* After building the new I2NP message with the leaked information, I also traced the message according to it''s (hostile) length\nHere is the relevant (textual) trace:\n\n```\n[2017.11.24 22:56:53.218001] [0xb12f9b40] [debug]   GarlicDestination: 2 cloves\n[2017.11.24 22:56:53.218038] [0xb12f9b40] [debug]   GarlicDestination: Garlic type tunnel\n[2017.11.24 22:56:53.218074] [0xb12f9b40] [trace]   EI-DEBUG: eGarlicDeliveryTypeTunnel original length:1333\n[2017.11.24 22:56:53.218113] [0xb12f9b40] [trace]   EI-DEBUG: I2NPMessage using length:16400\n[2017.11.24 22:56:53.218152] [0xb12f9b40] [trace]   EI-DEBUG: PutI2NPMsg() with eGarlicDeliveryTypeTunnel:\n```\nSince the formatting of the markdown messes up the log traces, I uploaded it as a picture. The trace itself prints the entire 16400 bytes of the message, however I though it won't be effective to load more screenshots of the message dump.","markdown_message":"\u003ch1 id=\"poc\"\u003ePoC\u003c/h1\u003e\n\n\u003cp\u003eI managed to bring up a test environment, and added debug traces to the kovri router I compiled:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eMy traces starts with \u0026quot;EI-DEBUG\u0026quot;\u003c/li\u003e\n\u003cli\u003eAfter building the new I2NP message with the leaked information, I also traced the message according to it\u0026#39;\u0026#39;s (hostile) length\nHere is the relevant (textual) trace:\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e[2017.11.24 22:56:53.218001] [0xb12f9b40] [debug]   GarlicDestination: 2 cloves\n[2017.11.24 22:56:53.218038] [0xb12f9b40] [debug]   GarlicDestination: Garlic type tunnel\n[2017.11.24 22:56:53.218074] [0xb12f9b40] [trace]   EI-DEBUG: eGarlicDeliveryTypeTunnel original length:1333\n[2017.11.24 22:56:53.218113] [0xb12f9b40] [trace]   EI-DEBUG: I2NPMessage using length:16400\n[2017.11.24 22:56:53.218152] [0xb12f9b40] [trace]   EI-DEBUG: PutI2NPMsg() with eGarlicDeliveryTypeTunnel:\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eSince the formatting of the markdown messes up the log traces, I uploaded it as a picture. The trace itself prints the entire 16400 bytes of the message, however I though it won\u0026#39;t be effective to load more screenshots of the message dump.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-11-24T23:21:45.069Z","updated_at":"2017-11-24T23:21:45.069Z","actor":{"username":"aerodudrizzt","cleared":false,"url":"/aerodudrizzt","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/098/646/ebd692682f9cff0731c0021d35f72330a3c88a8c_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":242132,"filename":"kovri_info-leak_PoC.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/242/132/699946df8fca4b245540453e64542ecf72df1978/kovri_info-leak_PoC.png?response-content-disposition=attachment%3B%20filename%3D%22kovri_info-leak_PoC.png%22%3B%20filename%2A%3DUTF-8%27%27kovri_info-leak_PoC.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQW2BAZGD3%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T052521Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDf7CC1janFXxWWF6QZ1Z6X6%2F6j0WDhv4gDyzEWu%2BScUAIhAOhgsmE64VangXFyIz5AGmDMLeT8sYG2vBQ4PwiaYS%2FZKrQDCFUQARoMMDEzNjE5Mjc0ODQ5Igy754oCq3nK3vWmRbMqkQM98qKdRlMDTd4bBwR4jJMppOWz7EU3ySwJK1geVZm7GvrSHyp8wAx03nVbAIisdh9q5SCYJs%2FJTXi%2Fsm9znfJcHgIy1DUYcyZol0zQmN4hQAlOUZZ6AJANKMjzew6Gbci4hpgZqkt7kMNinONmzU36EDiWMOc0y0LBIMMe8ckWdal2vM1amkx9g4%2B7jkxStLKe4Ry%2FVeqOEFeDj5B3%2Fim8atXFDPnaA6ZctYC0kADebiu9zFF1dQsSdkzsLG93dLAMR0ARXm0vun9nbqpp5oxDQafvSrdE7oDp0yem%2B391K5yvQ%2FVkTdyMd797ooD1IAYqUdwlX0lVblqv9ErzI2EUbOnFhO5widZFoU8s5JQDxyTzDlNAHHPnQpU8XD7uIRyR%2Bh43I9VvsEn1pERJ2rOM57I1PkAM8vesvdhiNkLY7KsmmB1q5drdmKxzSDeK5uPJY%2F7b6ZdCcYzDgNfX18d6h0A0FHbvXn7qPH9NQWGUsNXamCikRs9AA%2BK%2BzqwxI%2FlZdCdkUBJNbFqefOmuHA6y4DCuw6r%2FBTrqAZ4iBH5JOWBgJ5BPglFYT1gWFkwyMqq8gmMxb5SeS%2FjunuR9x9HhadmGfzTt7avXh7ra%2BbCbT8G5EBTHekw5tLrBpYwkzmLiedzIpJ4pJqrAXmk%2B6qfKdpUFGOfE%2FoOdzhIkM32hFOTOwwCcLwfUCOQXCXHweJlGlDZdV%2FgvnAv5llJv80AS6mRncqu5cTdZ6kwskL6mtLuZx022Hs9iVQEhZVcVFVxWNFIMlrPZufuNWFtnv13RkAoiqYOJgDn3UWRAP9lucn7OMZs0NyqKFy1iLho2FCO%2BegcGHVqDf%2FVxOtLAlnkhjmFRxg%3D%3D\u0026X-Amz-Signature=1d31e712760f8b56785845090002f6b64e5650d661ef564a45ae8ce214d01c93"}],"genius_execution_id":null,"team_handle":"monero","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2181924,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Since I am experienced with the process of issuing a CVE, with multiple CNAs, should I issue the CVE to help you with the process? The CVE itself will be private (marked as \"reserved\" CVE) until a public disclosure will happen, and the public disclosure will only happen after your approve it (For example, after the patches will be committed to the git repo).\n\nIn any case I am waiting for your reply, and will like to know if there is a specific CNA you prefer/recommend for this process.\n\nThanks again for your attention and fast response.","markdown_message":"\u003cp\u003eSince I am experienced with the process of issuing a CVE, with multiple CNAs, should I issue the CVE to help you with the process? The CVE itself will be private (marked as \u0026quot;reserved\u0026quot; CVE) until a public disclosure will happen, and the public disclosure will only happen after your approve it (For example, after the patches will be committed to the git repo).\u003c/p\u003e\n\n\u003cp\u003eIn any case I am waiting for your reply, and will like to know if there is a specific CNA you prefer/recommend for this process.\u003c/p\u003e\n\n\u003cp\u003eThanks again for your attention and fast response.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-11-25T18:02:48.937Z","updated_at":"2017-11-25T18:02:48.937Z","actor":{"username":"aerodudrizzt","cleared":false,"url":"/aerodudrizzt","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/098/646/ebd692682f9cff0731c0021d35f72330a3c88a8c_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"monero","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2185506,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"\u003eFirst thing first, I saw your project through hackerOne and decided to check if I can found something interesting in it.\n\nGreat, thank you. There are plenty more issues to find - that will be certain.\n\n\u003eRegarding your fix: I personally would use unt32_t for the types in the check to avoid a possible integer-overflow in the assignment into offset. Such overflow will cause the size checks to pass with a possible length of ~0xFFFF.\n\nCan you prove **with code** that this is even possible? IIRC, this was not possible in our current implementation as I explicitly discussed the issue in my first response. I'm now getting back to this issue though after being AFK, so I can review further this week in case I missed something. In the meantime, *please* provide **code** PoC for any claims.\n\n\u003eCode trail:\n\u003eAnd none of these last two function has any check / can validate this parsed value against the real message length\n\nYes, I know, this was already implied/discussed in my first response - but this is not a **code** PoC exploit.\n\n\u003ekovri_info-leak_PoC.png\n\nThis is not a **code** PoC exploit. A scenario (and screenshot) has the potential to be manipulated to fit this control. That is why we require an *actual* **code** PoC exploit. Where is the **code** PoC exploit?\n\n\u003eSince I am experienced with the process of issuing a CVE, with multiple CNAs, should I issue the CVE to help you with the process?\n\nNo. This is not CVE worthy as we have **no** releases. *Please* read my first response again regarding release/development status/state. Also, there is no **code** PoC exploit to confirm the hypotheticals. We need a reproducible **code** PoC exploit. Once we start having releases, we can then discuss CVE requirements for potential *future* issues, but not this one. Also, bounty cannot be released without at first seeing a **code** PoC exploit.\n\n\u003eIn any case I am waiting for your reply, and will like to know if there is a specific CNA you prefer/recommend for this process.\n\nPlease read our [Vulnerability Response Process](https://github.com/monero-project/kovri#vulnerability-response). If anything is not clear, please feel free to ask.\n\nNote: please provide any **code PoC** as a git-diff. You can paste inline or attach as a patch.","markdown_message":"\u003cblockquote\u003e\n\u003cp\u003eFirst thing first, I saw your project through hackerOne and decided to check if I can found something interesting in it.\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eGreat, thank you. There are plenty more issues to find - that will be certain.\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eRegarding your fix: I personally would use unt32_t for the types in the check to avoid a possible integer-overflow in the assignment into offset. Such overflow will cause the size checks to pass with a possible length of ~0xFFFF.\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eCan you prove \u003cstrong\u003ewith code\u003c/strong\u003e that this is even possible? IIRC, this was not possible in our current implementation as I explicitly discussed the issue in my first response. I\u0026#39;m now getting back to this issue though after being AFK, so I can review further this week in case I missed something. In the meantime, \u003cem\u003eplease\u003c/em\u003e provide \u003cstrong\u003ecode\u003c/strong\u003e PoC for any claims.\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eCode trail:\u003cbr\u003e\nAnd none of these last two function has any check / can validate this parsed value against the real message length\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eYes, I know, this was already implied/discussed in my first response - but this is not a \u003cstrong\u003ecode\u003c/strong\u003e PoC exploit.\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003ekovri_info-leak_PoC.png\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eThis is not a \u003cstrong\u003ecode\u003c/strong\u003e PoC exploit. A scenario (and screenshot) has the potential to be manipulated to fit this control. That is why we require an \u003cem\u003eactual\u003c/em\u003e \u003cstrong\u003ecode\u003c/strong\u003e PoC exploit. Where is the \u003cstrong\u003ecode\u003c/strong\u003e PoC exploit?\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eSince I am experienced with the process of issuing a CVE, with multiple CNAs, should I issue the CVE to help you with the process?\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eNo. This is not CVE worthy as we have \u003cstrong\u003eno\u003c/strong\u003e releases. \u003cem\u003ePlease\u003c/em\u003e read my first response again regarding release/development status/state. Also, there is no \u003cstrong\u003ecode\u003c/strong\u003e PoC exploit to confirm the hypotheticals. We need a reproducible \u003cstrong\u003ecode\u003c/strong\u003e PoC exploit. Once we start having releases, we can then discuss CVE requirements for potential \u003cem\u003efuture\u003c/em\u003e issues, but not this one. Also, bounty cannot be released without at first seeing a \u003cstrong\u003ecode\u003c/strong\u003e PoC exploit.\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eIn any case I am waiting for your reply, and will like to know if there is a specific CNA you prefer/recommend for this process.\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003ePlease read our \u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fmonero-project%2Fkovri%23vulnerability-response\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eVulnerability Response Process\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e. If anything is not clear, please feel free to ask.\u003c/p\u003e\n\n\u003cp\u003eNote: please provide any \u003cstrong\u003ecode PoC\u003c/strong\u003e as a git-diff. You can paste inline or attach as a patch.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-11-28T01:29:17.189Z","updated_at":"2017-11-28T01:29:17.189Z","actor":{"username":"anonimal","cleared":false,"url":"/anonimal","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/040/857/f23cc3be09a21e17bc43975987c10ba2b6427239_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"monero","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2185667,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I don't understand why the harsh tones are needed in this discussion. If this is the first post you mention **code** PoC then there is no need to \"yell\" it with bold 8 times... And regarding the CVE, I did read your vulnerability response process and that is the reason I offered to help you in the process, you cant ignore my offer if you don't think it is rellevant.\n\nThis is the first time a project blames me of fabricating a PoC, and I have a long record with many IBB projects and major companies. Normally when one explains the code path in a complex system like yours, the developers try to help from their side in bringing up a test model, a job that took me more than 12 hours on last friday, and was done so I won't interfere with the live kovri network.\n\nI understood your stand, and now you request an additional code PoC that your fix does suffer from an IoF vulnerability, so I will organize my setup scripts and will send you the code for:\n1. A hostile kovri client that triggers the attack on a compiled regular kovri router\n2. A hostile kovri client that triggers the attack on your proposed patched kovri router\nBoth will be in a cloned kovri version of the repo at my git account. I just don't understand yet how the git dif on the attacker side will help you anyway.\n\nSince this is the middle of a work week, I will try to deliver all of this until Sunday, as I work full time and can't work on this seriously before the weekend.\n","markdown_message":"\u003cp\u003eI don\u0026#39;t understand why the harsh tones are needed in this discussion. If this is the first post you mention \u003cstrong\u003ecode\u003c/strong\u003e PoC then there is no need to \u0026quot;yell\u0026quot; it with bold 8 times... And regarding the CVE, I did read your vulnerability response process and that is the reason I offered to help you in the process, you cant ignore my offer if you don\u0026#39;t think it is rellevant.\u003c/p\u003e\n\n\u003cp\u003eThis is the first time a project blames me of fabricating a PoC, and I have a long record with many IBB projects and major companies. Normally when one explains the code path in a complex system like yours, the developers try to help from their side in bringing up a test model, a job that took me more than 12 hours on last friday, and was done so I won\u0026#39;t interfere with the live kovri network.\u003c/p\u003e\n\n\u003cp\u003eI understood your stand, and now you request an additional code PoC that your fix does suffer from an IoF vulnerability, so I will organize my setup scripts and will send you the code for:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eA hostile kovri client that triggers the attack on a compiled regular kovri router\u003c/li\u003e\n\u003cli\u003eA hostile kovri client that triggers the attack on your proposed patched kovri router\nBoth will be in a cloned kovri version of the repo at my git account. I just don\u0026#39;t understand yet how the git dif on the attacker side will help you anyway.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eSince this is the middle of a work week, I will try to deliver all of this until Sunday, as I work full time and can\u0026#39;t work on this seriously before the weekend.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-11-28T04:07:04.672Z","updated_at":"2017-11-28T04:07:04.672Z","actor":{"username":"aerodudrizzt","cleared":false,"url":"/aerodudrizzt","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/098/646/ebd692682f9cff0731c0021d35f72330a3c88a8c_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"monero","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2187688,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"\u003eI don't understand why the harsh tones are needed in this discussion.\n\nI think you're misinterpreting my English. As a native speaker, I can assure you that there was no harsh tone. Because you overlooked what I had originally said, highlighting important words in bold usually helps with the visual aspect of skimming text.\n\n\u003eIf this is the first post you mention code PoC\n\nWe've had no problems with any other reports providing code PoC. Code PoC is implied but some people miss this fact. We will provided an addendum to the VRP.\n\n\u003eThis is the first time a project blames me of fabricating a PoC\n\nNo one blamed you for fabricating anything. We specifically said *\"A scenario (and screenshot) has the potential to be manipulated to fit this control. That is why we require an actual code PoC exploit.\"* In vulnerability response, a person's word means nothing: only the code matters. This applies to me or anyone else. We've received actual code PoC for nearly every other Monero project report, so I don't see why you or anyone else (including myself) should be any exception to the rule.\n\n\u003eNormally when one explains the code path in a complex system like yours, the developers try to help from their side in bringing up a test model\n\n1. You had originally said *\"Sending a specially crafted Garlic message can cause the router to send onward an I2P message containing leaked RAM data, triggering a massive information leakage.\"* which implies that you were successfully able to do so. If you were successfully able to do so, you wouldn't need me to explain the code path as you would have demonstrated that you understood the components and concepts involved.\n\n2. How am I to know that you need help if you don't ask questions? AFAICT, a majority of your response has been assumptions and accusations.\n\n3. You missed some very, *very*, important parts of my original message:\n\n\u003e\u003eKovri is pre-alpha\n\u003e\u003eI have not ensured any QA on tunnel/I2NP as noted in this issue (garlic is implied though I should probably update the issue for verbosity)\n\nSo, any work that we do will almost certainly be rewritten or thrown out. It's not cost-effective to dwell on an area of a pre-Alpha codebase that needs more than just patches.\n\n\u003eyou cant ignore my offer if you don't think it is rellevant.\n\n\"Relevant\". And no one ignored your offer. We simply corrected your invalid assumption that a CVE was required.\n\n\u003enow you request an additional code PoC that your fix does suffer from an IoF vulnerability, \n\nBy my patch you mean yours because ultimately what I provided is simple a wrapper for your patch... ?\n\n\u003eI just don't understand yet how the git dif on the attacker side will help you anyway.\n\nThen you don't understand how this network works. If you want to learn more about Kovri and I2P, you're welcome to come ask questions in our [support section](https://github.com/monero-project/kovri#support).\n\n\u003eSince this is the middle of a work week, I will try to deliver all of this until Sunday, as I work full time and can't work on this seriously before the weekend.\n\nGreat, we appreciate your contributions. At this point we would like to move on the following:\n\n1. Apply the single-line patch that you first proposed. Though the patch doesn't solve all problems of this area, this area of Kovri needs official review beyond the scope of this report.\n2. Because we have no official releases, the remaining portions of the Monero VRP after point 6 are not applicable. For internal use only, we will classify this issue as MEDIUM as defined in the Monero VRP: *\"or must be carefully exploited\"*.\n3. Give you credit in the git-log for your single-line patch. While your further work in this area will be appreciated, your patch is sufficient enough to close the report while we continue pre-Alpha development in this area. The remaining issues can be addressed with the TODOs in my patch. Any future related issues - while we're in pre-Alpha - can be resolved directly on github.\n4. Even though we don't intend to provide bounty before a Beta release, we will send you a complimentary XMR for your effort. Because HackerOne doesn't distribute XMR bounty through their service (and we don't offer fiat bounties), you will need to provide an XMR address for us to send XMR to (if you wish to have the bounty). Note: [this VRP caveat](https://github.com/monero-project/kovri/issues/630) will be implemented effective immediately for future H1 issues (as I mentioned in my original response). Future bounty will also only be available (a much larger amount of bounty) after [this](https://github.com/monero-project/meta/issues/83) is resolved.\n\n\nOn a sidenote: if you would like to make a steady, significant amount of XMR (either during our pre-Alpha and Alpha stages or beyond), you can create an [FFS proposal](https://github.com/monero-project/meta/issues/63) to work part time on Kovri. For an example FFS proposal, see [here](https://forum.getmonero.org/9/work-in-progress/86967/anonimal-s-kovri-full-time-development-funding-thread).\n\nPlease feel free to ask any questions if any of the aforementioned was not clear. You can also visit https://getmonero.org and reddit's /r/Monero for more information on how to use and trade Monero. Thank you.","markdown_message":"\u003cblockquote\u003e\n\u003cp\u003eI don\u0026#39;t understand why the harsh tones are needed in this discussion.\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eI think you\u0026#39;re misinterpreting my English. As a native speaker, I can assure you that there was no harsh tone. Because you overlooked what I had originally said, highlighting important words in bold usually helps with the visual aspect of skimming text.\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eIf this is the first post you mention code PoC\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eWe\u0026#39;ve had no problems with any other reports providing code PoC. Code PoC is implied but some people miss this fact. We will provided an addendum to the VRP.\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eThis is the first time a project blames me of fabricating a PoC\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eNo one blamed you for fabricating anything. We specifically said \u003cem\u003e\u0026quot;A scenario (and screenshot) has the potential to be manipulated to fit this control. That is why we require an actual code PoC exploit.\u0026quot;\u003c/em\u003e In vulnerability response, a person\u0026#39;s word means nothing: only the code matters. This applies to me or anyone else. We\u0026#39;ve received actual code PoC for nearly every other Monero project report, so I don\u0026#39;t see why you or anyone else (including myself) should be any exception to the rule.\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eNormally when one explains the code path in a complex system like yours, the developers try to help from their side in bringing up a test model\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003col\u003e\n\u003cli\u003e\u003cp\u003eYou had originally said \u003cem\u003e\u0026quot;Sending a specially crafted Garlic message can cause the router to send onward an I2P message containing leaked RAM data, triggering a massive information leakage.\u0026quot;\u003c/em\u003e which implies that you were successfully able to do so. If you were successfully able to do so, you wouldn\u0026#39;t need me to explain the code path as you would have demonstrated that you understood the components and concepts involved.\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eHow am I to know that you need help if you don\u0026#39;t ask questions? AFAICT, a majority of your response has been assumptions and accusations.\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eYou missed some very, \u003cem\u003every\u003c/em\u003e, important parts of my original message:\u003c/p\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cblockquote\u003e\n\u003cblockquote\u003e\n\u003cp\u003eKovri is pre-alpha\u003cbr\u003e\nI have not ensured any QA on tunnel/I2NP as noted in this issue (garlic is implied though I should probably update the issue for verbosity)\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eSo, any work that we do will almost certainly be rewritten or thrown out. It\u0026#39;s not cost-effective to dwell on an area of a pre-Alpha codebase that needs more than just patches.\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eyou cant ignore my offer if you don\u0026#39;t think it is rellevant.\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003e\u0026quot;Relevant\u0026quot;. And no one ignored your offer. We simply corrected your invalid assumption that a CVE was required.\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003enow you request an additional code PoC that your fix does suffer from an IoF vulnerability, \u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eBy my patch you mean yours because ultimately what I provided is simple a wrapper for your patch... ?\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eI just don\u0026#39;t understand yet how the git dif on the attacker side will help you anyway.\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eThen you don\u0026#39;t understand how this network works. If you want to learn more about Kovri and I2P, you\u0026#39;re welcome to come ask questions in our \u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fmonero-project%2Fkovri%23support\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003esupport section\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e.\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eSince this is the middle of a work week, I will try to deliver all of this until Sunday, as I work full time and can\u0026#39;t work on this seriously before the weekend.\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eGreat, we appreciate your contributions. At this point we would like to move on the following:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eApply the single-line patch that you first proposed. Though the patch doesn\u0026#39;t solve all problems of this area, this area of Kovri needs official review beyond the scope of this report.\u003c/li\u003e\n\u003cli\u003eBecause we have no official releases, the remaining portions of the Monero VRP after point 6 are not applicable. For internal use only, we will classify this issue as MEDIUM as defined in the Monero VRP: \u003cem\u003e\u0026quot;or must be carefully exploited\u0026quot;\u003c/em\u003e.\u003c/li\u003e\n\u003cli\u003eGive you credit in the git-log for your single-line patch. While your further work in this area will be appreciated, your patch is sufficient enough to close the report while we continue pre-Alpha development in this area. The remaining issues can be addressed with the TODOs in my patch. Any future related issues - while we\u0026#39;re in pre-Alpha - can be resolved directly on github.\u003c/li\u003e\n\u003cli\u003eEven though we don\u0026#39;t intend to provide bounty before a Beta release, we will send you a complimentary XMR for your effort. Because HackerOne doesn\u0026#39;t distribute XMR bounty through their service (and we don\u0026#39;t offer fiat bounties), you will need to provide an XMR address for us to send XMR to (if you wish to have the bounty). Note: \u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fmonero-project%2Fkovri%2Fissues%2F630\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ethis VRP caveat\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e will be implemented effective immediately for future H1 issues (as I mentioned in my original response). Future bounty will also only be available (a much larger amount of bounty) after \u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fmonero-project%2Fmeta%2Fissues%2F83\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ethis\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e is resolved.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eOn a sidenote: if you would like to make a steady, significant amount of XMR (either during our pre-Alpha and Alpha stages or beyond), you can create an \u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fmonero-project%2Fmeta%2Fissues%2F63\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eFFS proposal\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e to work part time on Kovri. For an example FFS proposal, see \u003ca href=\"/redirect?url=https%3A%2F%2Fforum.getmonero.org%2F9%2Fwork-in-progress%2F86967%2Fanonimal-s-kovri-full-time-development-funding-thread\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehere\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e.\u003c/p\u003e\n\n\u003cp\u003ePlease feel free to ask any questions if any of the aforementioned was not clear. You can also visit \u003ca title=\"https://getmonero.org\" href=\"/redirect?url=https%3A%2F%2Fgetmonero.org\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://getmonero.org\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e and reddit\u0026#39;s /r/Monero for more information on how to use and trade Monero. Thank you.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-11-28T22:24:04.007Z","updated_at":"2017-11-28T22:24:04.007Z","actor":{"username":"anonimal","cleared":false,"url":"/anonimal","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/040/857/f23cc3be09a21e17bc43975987c10ba2b6427239_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"monero","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2187846,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2017-11-29T00:20:21.619Z","updated_at":"2017-11-29T00:20:21.619Z","additional_data":{"old_title":"Kovri heartbleed-style vulnerability","new_title":"Kovri: potential buffer over-read in garlic clove handling + I2NP message creation"},"actor":{"username":"anonimal","cleared":false,"url":"/anonimal","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/040/857/f23cc3be09a21e17bc43975987c10ba2b6427239_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"monero","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2187879,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Note: @aerodudrizzt, we will also mark this issue with \"Set Award\" -\u003e \"Swag\" once you provide an XMR address and after we send the funds.","markdown_message":"\u003cp\u003eNote: \u003ca href=\"/aerodudrizzt\"\u003e@aerodudrizzt\u003c/a\u003e, we will also mark this issue with \u0026quot;Set Award\u0026quot; -\u0026gt; \u0026quot;Swag\u0026quot; once you provide an XMR address and after we send the funds.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-11-29T00:45:19.348Z","updated_at":"2017-11-29T00:45:19.348Z","actor":{"username":"anonimal","cleared":false,"url":"/anonimal","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/040/857/f23cc3be09a21e17bc43975987c10ba2b6427239_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"aerodudrizzt","url":"/aerodudrizzt"},"genius_execution_id":null,"team_handle":"monero","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2193879,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"First thing first, I apologize for the language I used in this conversation. After all we both want to know that the vulnerability is indeed exploitable, and a code PoC is the best way for it. In addition, we both want the vulnerability to be properly patched, and so there is no need to argue.\n\nCode PoC\n-----------\nAs promised, I am now attaching the code PoC for the reported vulnerability.\nMy full documented test setup can be found in an encrypted compressed zip folder in my website:\nhttp://www.cs.tau.ac.il/~eyalitki/Upload/HackerOne/PoC.zip\nThe password for the archive is: \"kovrianonimal\".\n\nMore Info\n-----------\nThe PoC includes the victim kovri router, and my modified attacker router. The submission includes the entire project, including:\n* Full code for both routers (including the compiled binaries that I've used in my demo)\n* Configuration folders for each router - the setup was on an isolated test i2p network, with only these two nodes\n* Logs of both routers, produced during the exploit demonstration\n\nVulnerability Impact (Severity)\n---------------------------------\n* Since the vulnerability was demonstrated in a live setup, which you can re-create using the code PoC I attached, I ask that the ticket's description will reflect that the vulnerability is more than \"potential\".\n* Since this is an exploitable major information-leak I hope you will find it qualified to the 500 XMR minimum bounty you mentioned in your FFS.\n\nProposed Patch\n-----------------\nThe patch you proposed will indeed block the attack, more info can be found in the README.txt in the archive.\n\nLogistics:\n----------\nMy monero wallet address is:\n49q5B492UgjJMPQ3j2Zs246LzMmVvdNxoj3VGnBCQf2pAKt2rmQ6fag8jwFG7QUfmT1iDVmnmNVAUKNvNeYhYQxhCXeYRRE\nIn case there is any problem with it I will be more than happy to help.\n\nThanks for the very fast replies, especially relative to other bug bounty projects, and for the time you dedicated to my ticket.\nEyal Itkin.\n","markdown_message":"\u003cp\u003eFirst thing first, I apologize for the language I used in this conversation. After all we both want to know that the vulnerability is indeed exploitable, and a code PoC is the best way for it. In addition, we both want the vulnerability to be properly patched, and so there is no need to argue.\u003c/p\u003e\n\n\u003ch2 id=\"code-poc\"\u003eCode PoC\u003c/h2\u003e\n\n\u003cp\u003eAs promised, I am now attaching the code PoC for the reported vulnerability.\u003cbr\u003e\nMy full documented test setup can be found in an encrypted compressed zip folder in my website:\u003cbr\u003e\n\u003ca title=\"http://www.cs.tau.ac.il/~eyalitki/Upload/HackerOne/PoC.zip\" href=\"/redirect?url=http%3A%2F%2Fwww.cs.tau.ac.il%2F~eyalitki%2FUpload%2FHackerOne%2FPoC.zip\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://www.cs.tau.ac.il/~eyalitki/Upload/HackerOne/PoC.zip\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nThe password for the archive is: \u0026quot;kovrianonimal\u0026quot;.\u003c/p\u003e\n\n\u003ch2 id=\"more-info\"\u003eMore Info\u003c/h2\u003e\n\n\u003cp\u003eThe PoC includes the victim kovri router, and my modified attacker router. The submission includes the entire project, including:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eFull code for both routers (including the compiled binaries that I\u0026#39;ve used in my demo)\u003c/li\u003e\n\u003cli\u003eConfiguration folders for each router - the setup was on an isolated test i2p network, with only these two nodes\u003c/li\u003e\n\u003cli\u003eLogs of both routers, produced during the exploit demonstration\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch2 id=\"vulnerability-impact-severity\"\u003eVulnerability Impact (Severity)\u003c/h2\u003e\n\n\u003cul\u003e\n\u003cli\u003eSince the vulnerability was demonstrated in a live setup, which you can re-create using the code PoC I attached, I ask that the ticket\u0026#39;s description will reflect that the vulnerability is more than \u0026quot;potential\u0026quot;.\u003c/li\u003e\n\u003cli\u003eSince this is an exploitable major information-leak I hope you will find it qualified to the 500 XMR minimum bounty you mentioned in your FFS.\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch2 id=\"proposed-patch\"\u003eProposed Patch\u003c/h2\u003e\n\n\u003cp\u003eThe patch you proposed will indeed block the attack, more info can be found in the README.txt in the archive.\u003c/p\u003e\n\n\u003ch2 id=\"logistics\"\u003eLogistics:\u003c/h2\u003e\n\n\u003cp\u003eMy monero wallet address is:\u003cbr\u003e\n49q5B492UgjJMPQ3j2Zs246LzMmVvdNxoj3VGnBCQf2pAKt2rmQ6fag8jwFG7QUfmT1iDVmnmNVAUKNvNeYhYQxhCXeYRRE\u003cbr\u003e\nIn case there is any problem with it I will be more than happy to help.\u003c/p\u003e\n\n\u003cp\u003eThanks for the very fast replies, especially relative to other bug bounty projects, and for the time you dedicated to my ticket.\u003cbr\u003e\nEyal Itkin.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-12-01T15:27:09.539Z","updated_at":"2017-12-01T15:27:09.539Z","actor":{"username":"aerodudrizzt","cleared":false,"url":"/aerodudrizzt","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/098/646/ebd692682f9cff0731c0021d35f72330a3c88a8c_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"monero","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2195112,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"\u003eMy full documented test setup can be found in an encrypted compressed zip folder in my website\n\nPlease don't link to your website. If you wish to share any files, please upload them to HackerOne. This is for security and accountability purposes. Also, you do not need to upload any binaries.\n\n\u003ethe setup was on an isolated test i2p network, with only these two nodes\n\u003eSince the vulnerability was demonstrated in a live setup, which you can re-create using the code PoC I attached, I ask that the ticket's description will reflect that the vulnerability is more than \"potential\".\n\nOnly two nodes? You cannot reproduce the network with simply two nodes. I can't verify if you indeed only used two nodes (see above about uploading files) but if you wish to prove this issue as *not* potential, you'll need to make your case using real tunnels with real hops - preferably using the testnet we already have in place (modifications are welcome).\n\n\u003eSince this is an exploitable major information-leak I hope you will find it qualified to the 500 XMR minimum bounty you mentioned in your FFS\n\nI'm afraid you're terribly confused. 500 XMR was for the minimum bounty **fund** - not for a minimum bug bounty **payout**. Nowhere in the FFS does it state that a *single* bug will be rewarded 500 XMR. In fact, nowhere in our policy or VRP does it state that any pre-Alpha kovri bug will receive *any* XMR. This is because we've only recently started using HackerOne and had yet to finish working out [the details](https://github.com/monero-project/meta/pull/142). Please review those details for future bug bounty payout.\n\nOur offer of 1 XMR was a token of appreciation. We will be able to send that XMR no later than the end of next week.\n\nWe look forward to future reports. Happy hacking!","markdown_message":"\u003cblockquote\u003e\n\u003cp\u003eMy full documented test setup can be found in an encrypted compressed zip folder in my website\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003ePlease don\u0026#39;t link to your website. If you wish to share any files, please upload them to HackerOne. This is for security and accountability purposes. Also, you do not need to upload any binaries.\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003ethe setup was on an isolated test i2p network, with only these two nodes\u003cbr\u003e\nSince the vulnerability was demonstrated in a live setup, which you can re-create using the code PoC I attached, I ask that the ticket\u0026#39;s description will reflect that the vulnerability is more than \u0026quot;potential\u0026quot;.\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eOnly two nodes? You cannot reproduce the network with simply two nodes. I can\u0026#39;t verify if you indeed only used two nodes (see above about uploading files) but if you wish to prove this issue as \u003cem\u003enot\u003c/em\u003e potential, you\u0026#39;ll need to make your case using real tunnels with real hops - preferably using the testnet we already have in place (modifications are welcome).\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eSince this is an exploitable major information-leak I hope you will find it qualified to the 500 XMR minimum bounty you mentioned in your FFS\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eI\u0026#39;m afraid you\u0026#39;re terribly confused. 500 XMR was for the minimum bounty \u003cstrong\u003efund\u003c/strong\u003e - not for a minimum bug bounty \u003cstrong\u003epayout\u003c/strong\u003e. Nowhere in the FFS does it state that a \u003cem\u003esingle\u003c/em\u003e bug will be rewarded 500 XMR. In fact, nowhere in our policy or VRP does it state that any pre-Alpha kovri bug will receive \u003cem\u003eany\u003c/em\u003e XMR. This is because we\u0026#39;ve only recently started using HackerOne and had yet to finish working out \u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fmonero-project%2Fmeta%2Fpull%2F142\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ethe details\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e. Please review those details for future bug bounty payout.\u003c/p\u003e\n\n\u003cp\u003eOur offer of 1 XMR was a token of appreciation. We will be able to send that XMR no later than the end of next week.\u003c/p\u003e\n\n\u003cp\u003eWe look forward to future reports. Happy hacking!\u003c/p\u003e\n","automated_response":false,"created_at":"2017-12-02T00:18:43.547Z","updated_at":"2017-12-02T00:18:43.547Z","actor":{"username":"anonimal","cleared":false,"url":"/anonimal","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/040/857/f23cc3be09a21e17bc43975987c10ba2b6427239_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"monero","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2195681,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey,\n\nI just want to clarify our current standing point:\n\n1. The vulnerability I found is a trivial code vulnerability and not a protocol vulnerability. This means that by definition the size of the network means nothing - as any rogue user on the network with a modified client can trigger the execution. The size of the network simply doesn't mean anything.\n\n1. This is one of the first projects I encounter that not only has no clear guidelines on how much are different bugs worth, but you also acknowledge yourself that the bounty definitions are not explicit and therefore you actually edited the description text while we were working on this bug: [Monero HackerOne policy change](https://hackerone.com/monero/policy_versions?change=3564319#), [Kovri bounty readme policy change](https://github.com/monero-project/kovri/commit/4ae89fc5ae002a08e1ecb44b201caf2e3ca34899), [Monero projects bug bounty declaration]( https://github.com/monero-project/meta/issues/39#issuecomment-289310019). I think that this acknowledgement does mean that there is a problem here at least to some extent.\n\n1. In order for future researchers (not only me) to know we are putting our efforts towards the benefits of the project in an ideal way, it would help if you would respond on what you actually need for it to be considered a PoC. In the comment on November 28 I outlined what I were proposing for the PoC (setting up a rouge client and router which enables the vulnerability to be easily seen). At no point whatsoever you said it's insufficient (due to network size) - you only said that after I already had put a significant amount of time on showing that.\n\n    To some extent, when a researcher is working to improve your project and describes in advance what and how he is going to provide, any reservation to the proposed PoC method shall be defined in advance rather than \"that this is not enough\", once the work is already done.\n\n    As long as I don't get clear definitive criterias on what needs to be done to prove the vulnerability, I have no reason to continue working on this. So far you did not show that you tried verifying that the PoC code works. Your offer of 1 XMR for this entire effort is simply not respecting the time I have put so far nor your published policy.\n\n1. I do believe that at this point it should be trivial to any core worker on the project to reproduce this on the test network. I'd be more than happy to provide any help you need and answer questions, but at this point what remains is engineering testing to verify the required fix on the network and not a security research.\n\n    Just for a reference, i2pd needed less than 12 hours from my report on this issue, to realize the problem and deploy a fix - so if you don't want to build the setup yourself, you can probably rely on the good folks there to see the vulnerability is real. Their fix can be tracked using CVE 2017-17066, and it will be published soon under version 2.17.\n\n1. The code PoC was uploaded as an encrypted archive to my site since it is unresponsible for any security researcher to uploaded a full exploit script into a ticket that might be publicly published someday. The archive was encrypted with a password that I gave you, such that your project would be able to use the PoC and not everyone on the internet. Once you confirm that you have downloaded my test environment I can remove it from my website, so the exploit won't be available to third parties from harming unpatched clients while the vulnerability will be a 1-day. Please explain why this form of submission has any accountability problems.\n\n1. Finally, it's unfortunate the guidelines regarding the part that my report is not \"bounty worth\" were blurry and that it was further updated after my report. I think there's real justification to reward my work per the published information as I showed in the above links.","markdown_message":"\u003cp\u003eHey,\u003c/p\u003e\n\n\u003cp\u003eI just want to clarify our current standing point:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003e\u003cp\u003eThe vulnerability I found is a trivial code vulnerability and not a protocol vulnerability. This means that by definition the size of the network means nothing - as any rogue user on the network with a modified client can trigger the execution. The size of the network simply doesn\u0026#39;t mean anything.\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eThis is one of the first projects I encounter that not only has no clear guidelines on how much are different bugs worth, but you also acknowledge yourself that the bounty definitions are not explicit and therefore you actually edited the description text while we were working on this bug: \u003ca href=\"https://hackerone.com/monero/policy_versions?change=3564319\"\u003eMonero HackerOne policy change\u003c/a\u003e, \u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fmonero-project%2Fkovri%2Fcommit%2F4ae89fc5ae002a08e1ecb44b201caf2e3ca34899\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eKovri bounty readme policy change\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e, \u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fmonero-project%2Fmeta%2Fissues%2F39%23issuecomment-289310019\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eMonero projects bug bounty declaration\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e. I think that this acknowledgement does mean that there is a problem here at least to some extent.\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eIn order for future researchers (not only me) to know we are putting our efforts towards the benefits of the project in an ideal way, it would help if you would respond on what you actually need for it to be considered a PoC. In the comment on November 28 I outlined what I were proposing for the PoC (setting up a rouge client and router which enables the vulnerability to be easily seen). At no point whatsoever you said it\u0026#39;s insufficient (due to network size) - you only said that after I already had put a significant amount of time on showing that.\u003c/p\u003e\n\n\u003cp\u003eTo some extent, when a researcher is working to improve your project and describes in advance what and how he is going to provide, any reservation to the proposed PoC method shall be defined in advance rather than \u0026quot;that this is not enough\u0026quot;, once the work is already done.\u003c/p\u003e\n\n\u003cp\u003eAs long as I don\u0026#39;t get clear definitive criterias on what needs to be done to prove the vulnerability, I have no reason to continue working on this. So far you did not show that you tried verifying that the PoC code works. Your offer of 1 XMR for this entire effort is simply not respecting the time I have put so far nor your published policy.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eI do believe that at this point it should be trivial to any core worker on the project to reproduce this on the test network. I\u0026#39;d be more than happy to provide any help you need and answer questions, but at this point what remains is engineering testing to verify the required fix on the network and not a security research.\u003c/p\u003e\n\n\u003cp\u003eJust for a reference, i2pd needed less than 12 hours from my report on this issue, to realize the problem and deploy a fix - so if you don\u0026#39;t want to build the setup yourself, you can probably rely on the good folks there to see the vulnerability is real. Their fix can be tracked using CVE 2017-17066, and it will be published soon under version 2.17.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eThe code PoC was uploaded as an encrypted archive to my site since it is unresponsible for any security researcher to uploaded a full exploit script into a ticket that might be publicly published someday. The archive was encrypted with a password that I gave you, such that your project would be able to use the PoC and not everyone on the internet. Once you confirm that you have downloaded my test environment I can remove it from my website, so the exploit won\u0026#39;t be available to third parties from harming unpatched clients while the vulnerability will be a 1-day. Please explain why this form of submission has any accountability problems.\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eFinally, it\u0026#39;s unfortunate the guidelines regarding the part that my report is not \u0026quot;bounty worth\u0026quot; were blurry and that it was further updated after my report. I think there\u0026#39;s real justification to reward my work per the published information as I showed in the above links.\u003c/p\u003e\u003c/li\u003e\n\u003c/ol\u003e\n","automated_response":false,"created_at":"2017-12-02T11:17:54.722Z","updated_at":"2017-12-02T11:17:54.722Z","actor":{"username":"aerodudrizzt","cleared":false,"url":"/aerodudrizzt","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/098/646/ebd692682f9cff0731c0021d35f72330a3c88a8c_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"monero","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2200742,"is_internal":false,"editable":false,"type":"Activities::CommentsClosed","message":"\u003eThe vulnerability I found is a trivial code vulnerability and not a protocol vulnerability.\n\nNo one contested this.\n\n\u003eThis means that by definition the size of the network means nothing - as any rogue user on the network with a modified client can trigger the execution. The size of the network simply doesn't mean anything.\n\n1. Interesting, because earlier you had said `After all we both want to know that the vulnerability is indeed exploitable, and a code PoC is the best way for it.` So, since you refuse to attach PoC exploit code to this issue, how can either of those statements have be validated (rhetorical question)?\n\n\u003eThe vulnerability I found is a trivial code vulnerability and not a protocol vulnerability. This means that by definition the size of the network means nothing\n\n1. Yes, trivial code vulnerability. Yes, not a protocol vulnerability. No, size matters. If a vulnerability **requires** tunnels to first be built using a tunnel pool built from a set of routers, this requires a myriad of other checks and factors to successfully pass throughout tunnel/I2NP and transports which, in this case, would need to pass messages of certain sizes. Since we haven't implemented 0 hop tunnels yet, your test setup sounds very inaccurate. Again, I cannot confirm because you've refused to upload PoC to HackerOne.\n\n2. Again, I've never claimed that this wasn't a vulnerability nor that it wasn't exploitable but since you kept making demands that X was Y, I asked that you prove Y, not X. A simple code-diff would've proven the claim but instead you've chosen to run around in circles.\n\n\u003eThis is one of the first projects I encounter that not only has no clear guidelines on how much are different bugs worth\n\n1. Monero is not a company nor is it a government entity. Monero is built entirely by the community. Monero is not governed by any single person. This also applies to Kovri. If you want to add guidelines, then add them.\n\n2. Monero developers have realized that there time is more fruitfully spent being paid for actual work instead of ad-hoc bug-bounty hunting. If you need a more granular tier, contribute to the open pull request that I linked above.\n\n\u003eYour offer of 1 XMR for this entire effort is simply not respecting the time I have put so far nor your published policy.\n\nYou've not respected your own time by making assumptions instead of doing basic research. You haven't asked questions nor have you become involved with the community. In this report, you've only asked one question! Look at your responses! **All this whining and complaining... and demanding any bug-bounty reward for a one-line patch to unreleased pre-Alpha software in an area that has yet to undergo official QA - it's laughable!**.\n\nIf you're ever unsure about your \"reward\", look at a project's policy before reporting. If what you desire is not explicitly noted then ask questions and get involved before living on assumptions. How foolish to do otherwise. Never in our VRP was a bounty amount of any kind ever explicitly stated. This was because we had yet to collaborate on the question of bounty. Now that we bounty in place, once the aforementioned PR is merged, you and everyone else can benefit from a wealth of bounty potential.\n\n\u003eThe code PoC was uploaded as an encrypted archive to my site since it is unresponsible for any security researcher to uploaded a full exploit script into a ticket that might be publicly published someday. The archive was encrypted with a password that I gave you, such that your project would be able to use the PoC and not everyone on the internet. \n\n**This is exactly why HackerOne was invented**: to protect their users from each other and to act as a mitigating entity between two or more parties. If you don't want to **use** HackerOne, then don't use it! Ironically, anonymity networks defend against the very targeted surveillance that you are endorsing we succumb to.\n\n\u003eless than 12 hours from my report on this issue, to realize the problem and deploy a fix\n\n1. Interesting, earlier you said `Thanks again for your attention and fast response.`\n\n2. You submitted your report over the weekend. The VRP specifically says \"no more than 3 working days\". If you don't understand what most of the world understands as \"working days\" (no one else has misunderstood), then I can't help you.\n\n3. To quote myself, because you continue to slide this discussion: `This report came at an odd time since I had plans to be AFK all week after Monday and, as such, I can't look further into the issue or even my own questions until the weekend or next Monday at the latest. Despite being pre-alpha, without a release, and the lack of a PoC exploit, a patch should be applied regardless - so I will check-in this week before the weekend to ensure that this issue is resolved in a timely manner.` And it has been resolved in a timely manner. **Read the VRP**. These are industry-standard bullet points.\n\n\u003egood folks\n\nWas that before or after they watermarked their routers for months after releasing (rhetorical question)?\n\n\u003eto see the vulnerability is real.\n\nNo one contested that the vulnerability wasn't real. For the Nth time, for this report, said reality of functional exploitation has yet to be proven with a HackerOne attached code PoC exploit. As discussed earlier, we both addressed the need for the patch and that it should be promptly applied. **The patch was promptly applied, and this is no longer an issue**. Have you actually read anything I've written in any detail (rhetorical question)?\n\nAs promised, we will send the 1 XMR to the address you gave and, as promised, we will send the transaction this week. Should you be interested, links to find various market values are in the aforementioned VRP github PR link.\n\nGet involved in the community: the Monero community is large and growing. We can help you understand the value of cryptocurrency. Visit us on IRC or on /r/Monero if you have any further questions.\n\nTo clarify, again: this issue is no longer an issue and thus will be locked. Defer to github for any subsequent pre-Alpha reports and the VRP for bounty details.\n\nHappy hacking!","markdown_message":"\u003cblockquote\u003e\n\u003cp\u003eThe vulnerability I found is a trivial code vulnerability and not a protocol vulnerability.\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eNo one contested this.\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eThis means that by definition the size of the network means nothing - as any rogue user on the network with a modified client can trigger the execution. The size of the network simply doesn\u0026#39;t mean anything.\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003col\u003e\n\u003cli\u003eInteresting, because earlier you had said \u003ccode\u003eAfter all we both want to know that the vulnerability is indeed exploitable, and a code PoC is the best way for it.\u003c/code\u003e So, since you refuse to attach PoC exploit code to this issue, how can either of those statements have be validated (rhetorical question)?\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eThe vulnerability I found is a trivial code vulnerability and not a protocol vulnerability. This means that by definition the size of the network means nothing\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003col\u003e\n\u003cli\u003e\u003cp\u003eYes, trivial code vulnerability. Yes, not a protocol vulnerability. No, size matters. If a vulnerability \u003cstrong\u003erequires\u003c/strong\u003e tunnels to first be built using a tunnel pool built from a set of routers, this requires a myriad of other checks and factors to successfully pass throughout tunnel/I2NP and transports which, in this case, would need to pass messages of certain sizes. Since we haven\u0026#39;t implemented 0 hop tunnels yet, your test setup sounds very inaccurate. Again, I cannot confirm because you\u0026#39;ve refused to upload PoC to HackerOne.\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eAgain, I\u0026#39;ve never claimed that this wasn\u0026#39;t a vulnerability nor that it wasn\u0026#39;t exploitable but since you kept making demands that X was Y, I asked that you prove Y, not X. A simple code-diff would\u0026#39;ve proven the claim but instead you\u0026#39;ve chosen to run around in circles.\u003c/p\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eThis is one of the first projects I encounter that not only has no clear guidelines on how much are different bugs worth\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003col\u003e\n\u003cli\u003e\u003cp\u003eMonero is not a company nor is it a government entity. Monero is built entirely by the community. Monero is not governed by any single person. This also applies to Kovri. If you want to add guidelines, then add them.\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eMonero developers have realized that there time is more fruitfully spent being paid for actual work instead of ad-hoc bug-bounty hunting. If you need a more granular tier, contribute to the open pull request that I linked above.\u003c/p\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eYour offer of 1 XMR for this entire effort is simply not respecting the time I have put so far nor your published policy.\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eYou\u0026#39;ve not respected your own time by making assumptions instead of doing basic research. You haven\u0026#39;t asked questions nor have you become involved with the community. In this report, you\u0026#39;ve only asked one question! Look at your responses! \u003cstrong\u003eAll this whining and complaining... and demanding any bug-bounty reward for a one-line patch to unreleased pre-Alpha software in an area that has yet to undergo official QA - it\u0026#39;s laughable!\u003c/strong\u003e.\u003c/p\u003e\n\n\u003cp\u003eIf you\u0026#39;re ever unsure about your \u0026quot;reward\u0026quot;, look at a project\u0026#39;s policy before reporting. If what you desire is not explicitly noted then ask questions and get involved before living on assumptions. How foolish to do otherwise. Never in our VRP was a bounty amount of any kind ever explicitly stated. This was because we had yet to collaborate on the question of bounty. Now that we bounty in place, once the aforementioned PR is merged, you and everyone else can benefit from a wealth of bounty potential.\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eThe code PoC was uploaded as an encrypted archive to my site since it is unresponsible for any security researcher to uploaded a full exploit script into a ticket that might be publicly published someday. The archive was encrypted with a password that I gave you, such that your project would be able to use the PoC and not everyone on the internet. \u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003e\u003cstrong\u003eThis is exactly why HackerOne was invented\u003c/strong\u003e: to protect their users from each other and to act as a mitigating entity between two or more parties. If you don\u0026#39;t want to \u003cstrong\u003euse\u003c/strong\u003e HackerOne, then don\u0026#39;t use it! Ironically, anonymity networks defend against the very targeted surveillance that you are endorsing we succumb to.\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eless than 12 hours from my report on this issue, to realize the problem and deploy a fix\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003col\u003e\n\u003cli\u003e\u003cp\u003eInteresting, earlier you said \u003ccode\u003eThanks again for your attention and fast response.\u003c/code\u003e\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eYou submitted your report over the weekend. The VRP specifically says \u0026quot;no more than 3 working days\u0026quot;. If you don\u0026#39;t understand what most of the world understands as \u0026quot;working days\u0026quot; (no one else has misunderstood), then I can\u0026#39;t help you.\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eTo quote myself, because you continue to slide this discussion: \u003ccode\u003eThis report came at an odd time since I had plans to be AFK all week after Monday and, as such, I can\u0026#39;t look further into the issue or even my own questions until the weekend or next Monday at the latest. Despite being pre-alpha, without a release, and the lack of a PoC exploit, a patch should be applied regardless - so I will check-in this week before the weekend to ensure that this issue is resolved in a timely manner.\u003c/code\u003e And it has been resolved in a timely manner. \u003cstrong\u003eRead the VRP\u003c/strong\u003e. These are industry-standard bullet points.\u003c/p\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003egood folks\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eWas that before or after they watermarked their routers for months after releasing (rhetorical question)?\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eto see the vulnerability is real.\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eNo one contested that the vulnerability wasn\u0026#39;t real. For the Nth time, for this report, said reality of functional exploitation has yet to be proven with a HackerOne attached code PoC exploit. As discussed earlier, we both addressed the need for the patch and that it should be promptly applied. \u003cstrong\u003eThe patch was promptly applied, and this is no longer an issue\u003c/strong\u003e. Have you actually read anything I\u0026#39;ve written in any detail (rhetorical question)?\u003c/p\u003e\n\n\u003cp\u003eAs promised, we will send the 1 XMR to the address you gave and, as promised, we will send the transaction this week. Should you be interested, links to find various market values are in the aforementioned VRP github PR link.\u003c/p\u003e\n\n\u003cp\u003eGet involved in the community: the Monero community is large and growing. We can help you understand the value of cryptocurrency. Visit us on IRC or on /r/Monero if you have any further questions.\u003c/p\u003e\n\n\u003cp\u003eTo clarify, again: this issue is no longer an issue and thus will be locked. Defer to github for any subsequent pre-Alpha reports and the VRP for bounty details.\u003c/p\u003e\n\n\u003cp\u003eHappy hacking!\u003c/p\u003e\n","automated_response":false,"created_at":"2017-12-05T01:21:32.280Z","updated_at":"2017-12-05T01:21:32.280Z","actor":{"url":"/monero","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/007/731/55634f7fcd917725c7a5771cc6e7c9b4d5fe0c22_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Monero"}},"genius_execution_id":null,"team_handle":"monero","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2200820,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"JFTR:\n\n\u003eWas that before or after they watermarked their routers for months after releasing (rhetorical question)?\n\nThis is in reference to a pre-Kovri incident where they argued *against* the dangers of raw-memory leaks. Such leaks were fixed in the aforementioned links that I posted earlier in this report.","markdown_message":"\u003cp\u003eJFTR:\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eWas that before or after they watermarked their routers for months after releasing (rhetorical question)?\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eThis is in reference to a pre-Kovri incident where they argued \u003cem\u003eagainst\u003c/em\u003e the dangers of raw-memory leaks. Such leaks were fixed in the aforementioned links that I posted earlier in this report.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-12-05T02:18:39.812Z","updated_at":"2017-12-05T02:19:40.360Z","actor":{"username":"anonimal","cleared":false,"url":"/anonimal","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/040/857/f23cc3be09a21e17bc43975987c10ba2b6427239_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"monero","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2200821,"is_internal":false,"editable":false,"type":"Activities::SwagAwarded","message":"1 XMR sent to address 49q5B492UgjJMPQ3j2Zs246LzMmVvdNxoj3VGnBCQf2pAKt2rmQ6fag8jwFG7QUfmT1iDVmnmNVAUKNvNeYhYQxhCXeYRRE\n\n```\nTransaction successfully submitted, transaction \u003c547f1db38774e7fa41720bfb55d7fbe712bf37a07123fe1bf30c964f9bc1a5d1\u003e\n```","markdown_message":"\u003cp\u003e1 XMR sent to address 49q5B492UgjJMPQ3j2Zs246LzMmVvdNxoj3VGnBCQf2pAKt2rmQ6fag8jwFG7QUfmT1iDVmnmNVAUKNvNeYhYQxhCXeYRRE\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eTransaction successfully submitted, transaction \u0026lt;547f1db38774e7fa41720bfb55d7fbe712bf37a07123fe1bf30c964f9bc1a5d1\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","automated_response":false,"created_at":"2017-12-05T02:19:54.722Z","updated_at":"2017-12-05T02:23:58.361Z","actor":{"url":"/monero","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/007/731/55634f7fcd917725c7a5771cc6e7c9b4d5fe0c22_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Monero"}},"reporter":{"username":"aerodudrizzt","url":"/aerodudrizzt"},"genius_execution_id":null,"team_handle":"monero","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2200822,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-12-05T02:22:03.142Z","updated_at":"2017-12-05T02:22:03.142Z","first_to_agree":true,"actor":{"username":"anonimal","cleared":false,"url":"/anonimal","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/040/857/f23cc3be09a21e17bc43975987c10ba2b6427239_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"monero","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2200980,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"I agree to a public disclosure. We will let the world decide if 1 XMR for GarlicRust is reasonable or not.\nThe PoC details are still attached, in case any reasercher will want to recreate the setup.","markdown_message":"\u003cp\u003eI agree to a public disclosure. We will let the world decide if 1 XMR for GarlicRust is reasonable or not.\u003cbr\u003e\nThe PoC details are still attached, in case any reasercher will want to recreate the setup.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-12-05T06:09:37.406Z","updated_at":"2017-12-05T06:09:37.406Z","actor":{"username":"aerodudrizzt","cleared":false,"url":"/aerodudrizzt","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/098/646/ebd692682f9cff0731c0021d35f72330a3c88a8c_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"monero","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2200981,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-12-05T06:09:37.500Z","updated_at":"2017-12-05T06:09:37.500Z","actor":{"username":"aerodudrizzt","cleared":false,"url":"/aerodudrizzt","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/098/646/ebd692682f9cff0731c0021d35f72330a3c88a8c_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"monero","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2201358,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"\u003eWe will let the world decide if 1 XMR for GarlicRust is reasonable or not.\n\nAs a member of the world, for a pre-Alpha *unreleased* software, with **no VRP bug bounty in place at the time of report** (as mentioned many times so far), in an area with no QA completed, and a reporter (you) who still refuses to attach PoC to HackerOne in a responsible manner, and among the myriad of other provable points that I have made in this report (and of which you continue to ignore); I think the 1 XMR token of appreciation is more than reasonable. Any more tokens of appreciation would be a disservice to other potential researchers who knew the state of the VRP and have instead chosen to wait before beginning their research.\n\nImportant note: I have been in talks with HackerOne since December of 2015. They are fully aware that we do not provide cash bounty and are also fully aware that we provide only \"swag\" as a bug bounty (they explicitly do not support offering monero bounty). If you have a problem with the HackerOne interface not reporting this information to you, and seeing as you continue to not ask questions, take up the issue with them. Otherwise, **read and abide by the VRP as it is the official document of which we also abide by; regardless of its state in development**.\n\nThank you, and happy hacking.","markdown_message":"\u003cblockquote\u003e\n\u003cp\u003eWe will let the world decide if 1 XMR for GarlicRust is reasonable or not.\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eAs a member of the world, for a pre-Alpha \u003cem\u003eunreleased\u003c/em\u003e software, with \u003cstrong\u003eno VRP bug bounty in place at the time of report\u003c/strong\u003e (as mentioned many times so far), in an area with no QA completed, and a reporter (you) who still refuses to attach PoC to HackerOne in a responsible manner, and among the myriad of other provable points that I have made in this report (and of which you continue to ignore); I think the 1 XMR token of appreciation is more than reasonable. Any more tokens of appreciation would be a disservice to other potential researchers who knew the state of the VRP and have instead chosen to wait before beginning their research.\u003c/p\u003e\n\n\u003cp\u003eImportant note: I have been in talks with HackerOne since December of 2015. They are fully aware that we do not provide cash bounty and are also fully aware that we provide only \u0026quot;swag\u0026quot; as a bug bounty (they explicitly do not support offering monero bounty). If you have a problem with the HackerOne interface not reporting this information to you, and seeing as you continue to not ask questions, take up the issue with them. Otherwise, \u003cstrong\u003eread and abide by the VRP as it is the official document of which we also abide by; regardless of its state in development\u003c/strong\u003e.\u003c/p\u003e\n\n\u003cp\u003eThank you, and happy hacking.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-12-05T10:56:04.150Z","updated_at":"2017-12-05T10:56:04.150Z","actor":{"username":"anonimal","cleared":false,"url":"/anonimal","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/040/857/f23cc3be09a21e17bc43975987c10ba2b6427239_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"monero","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}