{"id":146336,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNDYzMzY=","url":"https://hackerone.com/reports/146336","title":"XSS vulnerable parameter in a location hash","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-06-22T00:31:15.340Z","submitted_at":"2016-06-22T00:31:15.340Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"virtualhunter","url":"/virtualhunter","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/052/708/b5875aa5a0697c2e10bf492467cc239e882c7a49_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":69,"url":"https://hackerone.com/slack","handle":"slack","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/069/683fee312381bc46cadc7ea1950abc87944d12c3_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/069/683fee312381bc46cadc7ea1950abc87944d12c3_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Slack","twitter_handle":"slackhq","website":"https://slack.com","about":"All your team communication in one place, instantly searchable, and available wherever you go."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2019-10-16T09:47:48.170Z","bug_reporter_agreed_on_going_public_at":"2019-09-16T09:47:39.369Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi!\n\nThere is a vulnerability on your pages, using convertro.\n\nVulnerable parameter from location hash (cvo_sid1), used in your live.js to call convertro code without sanitizing. On the convertro side it is sanitized, but with help of this parameter you could push another parameter (typ), that leads to generating malformed javascript answer with XSS injection ability. Like this : cvo_sid1=111\\u0026;typ=[code injection] , where \\u0026; is an ampersand symbol.\nSee screenshots below.\nThere is a restriction on a semicolon use, so i replaced it with %3b.\n\nTo reproduce vulnerability, you could try this safe example:\nhttps://slack.com/is#?cvo_sid1=111\\u0026;typ=55577]\")%3balert(document.cookie)%3b//\n\nThis vulnerability provides a great opportunity for victim to lose not only cookies, but also control over the account after stealth forwarding to porposely generated link like this. I think, you know ;)","vulnerability_information_html":"\u003cp\u003eHi!\u003c/p\u003e\n\n\u003cp\u003eThere is a vulnerability on your pages, using convertro.\u003c/p\u003e\n\n\u003cp\u003eVulnerable parameter from location hash (cvo_sid1), used in your live.js to call convertro code without sanitizing. On the convertro side it is sanitized, but with help of this parameter you could push another parameter (typ), that leads to generating malformed javascript answer with XSS injection ability. Like this : cvo_sid1=111\\u0026;typ=[code injection] , where \\u0026; is an ampersand symbol.\u003cbr\u003e\nSee screenshots below.\u003cbr\u003e\nThere is a restriction on a semicolon use, so i replaced it with %3b.\u003c/p\u003e\n\n\u003cp\u003eTo reproduce vulnerability, you could try this safe example:\u003cbr\u003e\n\u003ca title=\"https://slack.com/is#?cvo_sid1=111/u0026;typ=55577%5D%22)%3balert(document.cookie)%3b//\" href=\"/redirect?url=https%3A%2F%2Fslack.com%2Fis%23%3Fcvo_sid1%3D111%2Fu0026%3Btyp%3D55577%255D%2522%29%253balert%28document.cookie%29%253b%2F%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://slack.com/is#?cvo_sid1=111/u0026;typ=55577%5D%22)%3balert(document.cookie)%3b//\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eThis vulnerability provides a great opportunity for victim to lose not only cookies, but also control over the account after stealth forwarding to porposely generated link like this. I think, you know ;)\u003c/p\u003e\n","bounty_amount":"1100.0","formatted_bounty":"$1,100","weakness":{"id":60,"name":"Cross-site Scripting (XSS) - Generic"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":100875,"file_name":"slack1.jpg","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/100/875/274d9a48441ad6393ca382dc81f1d2c8c11e5c9d/slack1.jpg?response-content-disposition=attachment%3B%20filename%3D%22slack1.jpg%22%3B%20filename%2A%3DUTF-8%27%27slack1.jpg\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQYBTYHVYS%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T043100Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIDaKSTb3EChMgDTnysheqj5DhaFkWfkkLg9bprhKLUhsAiB3C00GsGWPJ6DuGLnGT1QsFSaZNKPdgtEXvXm4QoYLsiq0AwhUEAEaDDAxMzYxOTI3NDg0OSIMAKVqIapKAKzPexnZKpEDp%2BNLAgbgUlhwrBi93XL5W8aXKcuP8OoU9PT5BjU3pGUUI3g8Hu%2F4mjuBIaaRGbLvV8UJpkO9TBUEHIaEDIs8rZ0mDIch3ncHlvNBW0BE%2FAMSLnWUINOrehikB0g2I0AasjVirqQ%2Fy2nzZDpofkxR%2FnfplnvAu337WSH5xyBgStfPxaD3qFE2SJgAQ6%2F8CsellltNw75POpRTlwBIeEZNjx3vJt1S9NN9jBHfQDYE%2FG0RZztV8Ec04hd%2BavbhCYzWtNl5pM8XtLOu7eDGWx2LHgHrrw0sNu7KMo%2Fp9Ti6b5H%2BlVa7TqU3NHJAcKPLuXNKPToWZYkFz45uFMB4g49BETD5Qseg7cz1z3ASfisMuXItKhc3Wmk28p7pggGcPnQTY7dJJ1LOUwWwHH69oX3qS2kKv%2BRk5swcc6rM4X8l2IXKvY3TS3Pd9kLaOdn5k2lcjiOZ0A2fpyl1be4XYY5v65Yow%2B53d7KYx2VAJ12oxjuILMh8DCI4mZ34lyPZeYXi0qlROqXDnv%2BzvnFHwIc8bjwwzrKq%2FwU67AFH0q5LeEdp6jxUg8gumwG55ojw09a8k8VkzxfdxIdWlGrCsAnv14Smo%2FTwIgFKRYc60KggUSXjAAOqVWkA5PD1%2BbOiqWpsghnC0p4DGK9tO3b4L0fZDKknZWHAzHsgOhycQDfPnrOZ6Cd00JV3ty2KQPAz2OXd%2BmldNq%2BOnR0lQXMZ8pOk4qqZMoDjQJnqG0TJup6wH%2FAuy9Ul6b9OZxeVGUeTP1hXpi7GP86nRctZDdbWYqP0KLrV7tO537fAinbfxIHlQMC0gJCGfRBDPpP4lR4OSKuI%2BEjkVpBN%2B1%2FaR3XrMykMIrZSkbFlcA%3D%3D\u0026X-Amz-Signature=79b64d848be54932d47048f20bea2ec7a3c8d4472603aab2e2b787d255863167","file_size":187681,"type":"image/jpeg"},{"id":100876,"file_name":"slack2.jpg","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/100/876/ea786da4f2b5449c82485cfa6b1fcbe730bf7124/slack2.jpg?response-content-disposition=attachment%3B%20filename%3D%22slack2.jpg%22%3B%20filename%2A%3DUTF-8%27%27slack2.jpg\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQYBTYHVYS%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T043100Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIDaKSTb3EChMgDTnysheqj5DhaFkWfkkLg9bprhKLUhsAiB3C00GsGWPJ6DuGLnGT1QsFSaZNKPdgtEXvXm4QoYLsiq0AwhUEAEaDDAxMzYxOTI3NDg0OSIMAKVqIapKAKzPexnZKpEDp%2BNLAgbgUlhwrBi93XL5W8aXKcuP8OoU9PT5BjU3pGUUI3g8Hu%2F4mjuBIaaRGbLvV8UJpkO9TBUEHIaEDIs8rZ0mDIch3ncHlvNBW0BE%2FAMSLnWUINOrehikB0g2I0AasjVirqQ%2Fy2nzZDpofkxR%2FnfplnvAu337WSH5xyBgStfPxaD3qFE2SJgAQ6%2F8CsellltNw75POpRTlwBIeEZNjx3vJt1S9NN9jBHfQDYE%2FG0RZztV8Ec04hd%2BavbhCYzWtNl5pM8XtLOu7eDGWx2LHgHrrw0sNu7KMo%2Fp9Ti6b5H%2BlVa7TqU3NHJAcKPLuXNKPToWZYkFz45uFMB4g49BETD5Qseg7cz1z3ASfisMuXItKhc3Wmk28p7pggGcPnQTY7dJJ1LOUwWwHH69oX3qS2kKv%2BRk5swcc6rM4X8l2IXKvY3TS3Pd9kLaOdn5k2lcjiOZ0A2fpyl1be4XYY5v65Yow%2B53d7KYx2VAJ12oxjuILMh8DCI4mZ34lyPZeYXi0qlROqXDnv%2BzvnFHwIc8bjwwzrKq%2FwU67AFH0q5LeEdp6jxUg8gumwG55ojw09a8k8VkzxfdxIdWlGrCsAnv14Smo%2FTwIgFKRYc60KggUSXjAAOqVWkA5PD1%2BbOiqWpsghnC0p4DGK9tO3b4L0fZDKknZWHAzHsgOhycQDfPnrOZ6Cd00JV3ty2KQPAz2OXd%2BmldNq%2BOnR0lQXMZ8pOk4qqZMoDjQJnqG0TJup6wH%2FAuy9Ul6b9OZxeVGUeTP1hXpi7GP86nRctZDdbWYqP0KLrV7tO537fAinbfxIHlQMC0gJCGfRBDPpP4lR4OSKuI%2BEjkVpBN%2B1%2FaR3XrMykMIrZSkbFlcA%3D%3D\u0026X-Amz-Signature=e5d5254e9d98d51d227e1ac414c399177e6da2432cd9b3da8965231be6b5a58b","file_size":199285,"type":"image/jpeg"}],"allow_singular_disclosure_at":"2019-10-16T09:47:39.451Z","allow_singular_disclosure_after":-37997001.04806048,"singular_disclosure_allowed":true,"vote_count":432,"voters":["angu_","env","k0z3r0","nohats","lyinq","kapytein","w31rd0","mashoud1122","bl4de","v0lck3r","and 422 more..."],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1027558,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thanks @virtualhunter! We've validated this and are taking a look internally. Awesome find!","markdown_message":"\u003cp\u003eThanks \u003ca href=\"/virtualhunter\"\u003e@virtualhunter\u003c/a\u003e! We\u0026#39;ve validated this and are taking a look internally. Awesome find!\u003c/p\u003e\n","automated_response":false,"created_at":"2016-06-22T02:23:36.653Z","updated_at":"2016-06-22T02:23:36.653Z","actor":{"username":"maxfeldman","cleared":false,"url":"/maxfeldman","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/613/37b54dbac5da0a42db471713959c8bf2de89a12d_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"slack","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1027718,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @virtualhunter,\n\nWe believe we've patched this - would you mind making sure the fix has propagated to your environment?\n\nThanks!\nMax","markdown_message":"\u003cp\u003eHey \u003ca href=\"/virtualhunter\"\u003e@virtualhunter\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eWe believe we\u0026#39;ve patched this - would you mind making sure the fix has propagated to your environment?\u003c/p\u003e\n\n\u003cp\u003eThanks!\u003cbr\u003e\nMax\u003c/p\u003e\n","automated_response":false,"created_at":"2016-06-22T06:34:32.281Z","updated_at":"2016-06-22T06:34:32.281Z","actor":{"username":"maxfeldman","cleared":false,"url":"/maxfeldman","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/613/37b54dbac5da0a42db471713959c8bf2de89a12d_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"slack","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1028647,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Yes. I see, all ok now! Fast work!","markdown_message":"\u003cp\u003eYes. I see, all ok now! Fast work!\u003c/p\u003e\n","automated_response":false,"created_at":"2016-06-22T16:17:37.438Z","updated_at":"2016-06-22T16:17:37.438Z","actor":{"username":"virtualhunter","cleared":false,"url":"/virtualhunter","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/052/708/b5875aa5a0697c2e10bf492467cc239e882c7a49_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"slack","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1028826,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2016-06-22T17:38:55.581Z","updated_at":"2016-06-22T17:38:55.581Z","actor":{"username":"maxfeldman","cleared":false,"url":"/maxfeldman","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/016/613/37b54dbac5da0a42db471713959c8bf2de89a12d_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"virtualhunter","url":"/virtualhunter"},"genius_execution_id":null,"team_handle":"slack","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1028830,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks for an interesting finding! Please keep up the good work!\n\nThe Slack Security Team","markdown_message":"\u003cp\u003eThanks for an interesting finding! Please keep up the good work!\u003c/p\u003e\n\n\u003cp\u003eThe Slack Security Team\u003c/p\u003e\n","automated_response":false,"created_at":"2016-06-22T17:39:38.954Z","updated_at":"2016-06-22T17:39:38.954Z","actor":{"url":"/slack","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/069/683fee312381bc46cadc7ea1950abc87944d12c3_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Slack"}},"bounty_amount":"1100.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"slack","collaborator":{"username":"virtualhunter","url":"/virtualhunter"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1029315,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you! Was glad to help!","markdown_message":"\u003cp\u003eThank you! Was glad to help!\u003c/p\u003e\n","automated_response":false,"created_at":"2016-06-22T22:18:48.690Z","updated_at":"2016-06-22T22:18:48.690Z","actor":{"username":"virtualhunter","cleared":false,"url":"/virtualhunter","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/052/708/b5875aa5a0697c2e10bf492467cc239e882c7a49_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"slack","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5814062,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-09-16T09:47:39.391Z","updated_at":"2019-09-16T09:47:39.391Z","first_to_agree":true,"actor":{"username":"virtualhunter","cleared":false,"url":"/virtualhunter","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/052/708/b5875aa5a0697c2e10bf492467cc239e882c7a49_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"slack","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6053566,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-10-16T09:47:49.277Z","updated_at":"2019-10-16T09:47:49.277Z","actor":{"url":"/slack","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/069/683fee312381bc46cadc7ea1950abc87944d12c3_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Slack"}},"genius_execution_id":null,"team_handle":"slack","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}