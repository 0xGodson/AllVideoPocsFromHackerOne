{"id":6370,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC82Mzcw","url":"https://hackerone.com/reports/6370","title":"Possible clickjacking at shop.khanacademy.org","state":"Closed","substate":"informative","readable_substate":"Informative","created_at":"2014-04-08T00:35:32.249Z","submitted_at":"2014-04-08T00:35:32.249Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"internetwache","url":"/internetwache","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/637/e5a294547160a5c885e21dacc358769675c8b0e9_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":134,"url":"https://hackerone.com/khanacademy","handle":"khanacademy","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/134/e62a822e39ad039f23a0b89bfaaaf7bf97c5f11f_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/134/e62a822e39ad039f23a0b89bfaaaf7bf97c5f11f_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Khan Academy","twitter_handle":"","website":"https://www.khanacademy.org/","about":"Start learning now. Completely free, forever."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2014-05-08T03:33:17.909Z","bug_reporter_agreed_on_going_public_at":"2014-04-15T19:04:03.924Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hello there,\r\n\r\nthe website at shop.khanacademy.org isn't protected against clickjacking properly.\r\n\r\n###PoC\r\n\r\n```\r\ncurl -L -I http://shop.khanacademy.org/ \r\nHTTP/1.1 200 OK\r\nServer: nginx\r\nDate: Tue, 08 Apr 2014 00:33:39 GMT\r\nContent-Type: text/html; charset=utf-8\r\nVary: Accept-Encoding\r\nStatus: 200 OK\r\nX-XSS-Protection: 1; mode=block\r\nX-Content-Type-Options: nosniff\r\nX-UA-Compatible: chrome=1\r\nX-ShopId: 1494466\r\nX-ShardId: 0\r\nX-Stats-Unique-Token: 2dd016682529fa6dc0ac02f03b41cb145bdeb1906793867d2f763e05dad4a464\r\nX-Stats-Visit-Token: d52a2198c1a197fb3535f0ea5db92ee9381f41ad8a910d9997859a4a7d21a6bb\r\nETag: cacheable:8709c7da7c24e09f7f45bab2c9d17d6a\r\nX-Alternate-Cache-Key: cacheable:214f21e7ce7fcc794113ab6ec2eac291\r\nX-Cache: miss\r\nSet-Cookie: _shopify_y=2dd016682529fa6dc0ac02f03b41cb145bdeb1906793867d2f763e05dad4a464; path=/; expires=Sat, 08 Apr 2034 00:33:39 -0000\r\nSet-Cookie: _shopify_s=d52a2198c1a197fb3535f0ea5db92ee9381f41ad8a910d9997859a4a7d21a6bb; path=/; expires=Tue, 08 Apr 2014 01:03:39 -0000\r\nSet-Cookie: request_method=HEAD; path=/\r\nSet-Cookie: _session_id=289a218d076bea034b85e5e807e00aa9; path=/; HttpOnly\r\nX-Request-Id: 6a3f8d62-4d9d-4303-af04-12e201856770\r\nP3P: CP=\"NOI DSP COR NID ADMa OPTa OUR NOR\"\r\n\r\n```\r\n\r\n\r\nYou should add the ```X-Frame-Origin: sameorigin``` header to the server http responses. Otherwise you're vulnerable to clickjacking attacks.\r\n\r\n\r\nBest regards,\r\nSebastian","vulnerability_information_html":"\u003cp\u003eHello there,\u003c/p\u003e\n\n\u003cp\u003ethe website at shop.khanacademy.org isn\u0026#39;t protected against clickjacking properly.\u003c/p\u003e\n\n\u003ch3 id=\"poc\"\u003ePoC\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003ecurl -L -I http://shop.khanacademy.org/ \nHTTP/1.1 200 OK\nServer: nginx\nDate: Tue, 08 Apr 2014 00:33:39 GMT\nContent-Type: text/html; charset=utf-8\nVary: Accept-Encoding\nStatus: 200 OK\nX-XSS-Protection: 1; mode=block\nX-Content-Type-Options: nosniff\nX-UA-Compatible: chrome=1\nX-ShopId: 1494466\nX-ShardId: 0\nX-Stats-Unique-Token: 2dd016682529fa6dc0ac02f03b41cb145bdeb1906793867d2f763e05dad4a464\nX-Stats-Visit-Token: d52a2198c1a197fb3535f0ea5db92ee9381f41ad8a910d9997859a4a7d21a6bb\nETag: cacheable:8709c7da7c24e09f7f45bab2c9d17d6a\nX-Alternate-Cache-Key: cacheable:214f21e7ce7fcc794113ab6ec2eac291\nX-Cache: miss\nSet-Cookie: _shopify_y=2dd016682529fa6dc0ac02f03b41cb145bdeb1906793867d2f763e05dad4a464; path=/; expires=Sat, 08 Apr 2034 00:33:39 -0000\nSet-Cookie: _shopify_s=d52a2198c1a197fb3535f0ea5db92ee9381f41ad8a910d9997859a4a7d21a6bb; path=/; expires=Tue, 08 Apr 2014 01:03:39 -0000\nSet-Cookie: request_method=HEAD; path=/\nSet-Cookie: _session_id=289a218d076bea034b85e5e807e00aa9; path=/; HttpOnly\nX-Request-Id: 6a3f8d62-4d9d-4303-af04-12e201856770\nP3P: CP=\u0026quot;NOI DSP COR NID ADMa OPTa OUR NOR\u0026quot;\n\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eYou should add the \u003ccode\u003eX-Frame-Origin: sameorigin\u003c/code\u003e header to the server http responses. Otherwise you\u0026#39;re vulnerable to clickjacking attacks.\u003c/p\u003e\n\n\u003cp\u003eBest regards,\u003cbr\u003e\nSebastian\u003c/p\u003e\n","weakness":{"id":74,"name":"UI Redressing (Clickjacking)"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2014-05-08T03:33:14.122Z","allow_singular_disclosure_after":-209703540.36367476,"singular_disclosure_allowed":true,"vote_count":1,"voters":["cryptographer"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":26141,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"As with the other shop bug, I'm going to mark this as won't fix, but thanks for finding this!","markdown_message":"\u003cp\u003eAs with the other shop bug, I\u0026#39;m going to mark this as won\u0026#39;t fix, but thanks for finding this!\u003c/p\u003e\n","automated_response":false,"created_at":"2014-04-08T03:33:14.351Z","updated_at":"2014-04-08T03:33:14.351Z","actor":{"username":"spicyj","cleared":false,"url":"/spicyj","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/004/585/3f134f71564b24606ab7b994abef5dc9ca334878_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"khanacademy","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":26272,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi,\nalright :)\n\nThanks,\nSebastian","markdown_message":"\u003cp\u003eHi,\u003cbr\u003e\nalright :)\u003c/p\u003e\n\n\u003cp\u003eThanks,\u003cbr\u003e\nSebastian\u003c/p\u003e\n","automated_response":false,"created_at":"2014-04-08T07:27:37.616Z","updated_at":"2014-04-08T07:27:37.616Z","actor":{"username":"internetwache","cleared":false,"url":"/internetwache","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/637/e5a294547160a5c885e21dacc358769675c8b0e9_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"khanacademy","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":31015,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2014-04-15T19:04:03.944Z","updated_at":"2014-04-15T19:04:03.944Z","actor":{"username":"internetwache","cleared":false,"url":"/internetwache","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/637/e5a294547160a5c885e21dacc358769675c8b0e9_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"khanacademy","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":46727,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2014-05-08T03:33:17.920Z","updated_at":"2014-05-08T03:33:17.920Z","actor":{"url":"/khanacademy","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/134/e62a822e39ad039f23a0b89bfaaaf7bf97c5f11f_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Khan Academy"}},"genius_execution_id":null,"team_handle":"khanacademy","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}