{"id":752353,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC83NTIzNTM=","url":"https://hackerone.com/reports/752353","title":"Anonymous file drop page ignores user profile visibility restrictions","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2019-12-06T00:32:20.074Z","submitted_at":"2019-12-06T00:32:20.074Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"pshknst","url":"/pshknst","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13291,"url":"https://hackerone.com/nextcloud","handle":"nextcloud","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Nextcloud","twitter_handle":"nextclouders","website":"https://nextcloud.com","about":"Access, share and protect your files, calendars, contacts, communication \u0026 more at home and in your enterprise."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2020-08-03T08:27:43.603Z","bug_reporter_agreed_on_going_public_at":"2020-08-03T08:27:43.527Z","team_member_agreed_on_going_public_at":"2020-08-03T07:53:51.263Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"User profile on Nextcloud server by url like https://\u003cserver.domain\u003e/index.php/settings/user includes personal information: photo, name, email address. For each listed fields user can select the visibility settings: local, contacts, public. It is expected that these settings will work in all places of the Nextcloud server.\n\nBut if you use an anonymous download folder as written in documentation\nhttps://docs.nextcloud.com/server/stable/user_manual/files/file_drop.html\nthen the profile visibility settings on upload page are ignored.\nFor example, if you specify the photo and fullname to be shown only for local or contacts Nextcloud server users, they will still be displayed on the upload page available publicly by the link.\nEven in the documentation itself, the name is covered with black mask because it refers to a specific user.\n\nThis is not the behavior of the application that is expected when the settings for visibility of photo and fullname only to local users are selected. In order to not disclose this information to anonymous public users, it is better to use the profile parameter on the file upload page too: hide non-public user info; show, for example, only the name of the folder without a photo and name of owner of folder.\nDisclosure of personal data can occur even without knowledge of owner of folder, because if he provided access to his folder for other registered Nextcloud users of the same server, they can next share folder for upload by share link without his participation and knowledge. No too good for enterprise uses where Nextcloud can sync user profiles with company's directory services which usually should be restricted for public access.\n\n## Impact\n\nInformation disclosure of user profile data","vulnerability_information_html":"\u003cp\u003eUser profile on Nextcloud server by url like https://\u0026lt;server.domain\u0026gt;/index.php/settings/user includes personal information: photo, name, email address. For each listed fields user can select the visibility settings: local, contacts, public. It is expected that these settings will work in all places of the Nextcloud server.\u003c/p\u003e\n\n\u003cp\u003eBut if you use an anonymous download folder as written in documentation\u003cbr\u003e\n\u003ca title=\"https://docs.nextcloud.com/server/stable/user_manual/files/file_drop.html\" href=\"/redirect?url=https%3A%2F%2Fdocs.nextcloud.com%2Fserver%2Fstable%2Fuser_manual%2Ffiles%2Ffile_drop.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://docs.nextcloud.com/server/stable/user_manual/files/file_drop.html\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cbr\u003e\nthen the profile visibility settings on upload page are ignored.\u003cbr\u003e\nFor example, if you specify the photo and fullname to be shown only for local or contacts Nextcloud server users, they will still be displayed on the upload page available publicly by the link.\u003cbr\u003e\nEven in the documentation itself, the name is covered with black mask because it refers to a specific user.\u003c/p\u003e\n\n\u003cp\u003eThis is not the behavior of the application that is expected when the settings for visibility of photo and fullname only to local users are selected. In order to not disclose this information to anonymous public users, it is better to use the profile parameter on the file upload page too: hide non-public user info; show, for example, only the name of the folder without a photo and name of owner of folder.\u003cbr\u003e\nDisclosure of personal data can occur even without knowledge of owner of folder, because if he provided access to his folder for other registered Nextcloud users of the same server, they can next share folder for upload by share link without his participation and knowledge. No too good for enterprise uses where Nextcloud can sync user profiles with company\u0026#39;s directory services which usually should be restricted for public access.\u003c/p\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eInformation disclosure of user profile data\u003c/p\u003e\n","weakness":{"id":18,"name":"Information Disclosure"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2020-09-02T07:53:51.331Z","allow_singular_disclosure_after":-10191166.105972264,"singular_disclosure_allowed":true,"vote_count":4,"voters":["foobar7","sa1tama0","gatz5225","kelly-blinks"],"structured_scope":{"databaseId":13,"asset_type":"SOURCE_CODE","asset_identifier":"nextcloud/server","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":6477572,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks a lot for reporting this potential issue back to us!\n\nOur security team will take a look at this issue as soon as possible. We will reply to your report within 72 hours, usually much faster. For obvious reasons we'd like to ask you to not disclose this issue to any other party.","markdown_message":"\u003cp\u003eThanks a lot for reporting this potential issue back to us!\u003c/p\u003e\n\n\u003cp\u003eOur security team will take a look at this issue as soon as possible. We will reply to your report within 72 hours, usually much faster. For obvious reasons we\u0026#39;d like to ask you to not disclose this issue to any other party.\u003c/p\u003e\n","automated_response":true,"created_at":"2019-12-06T00:32:20.376Z","updated_at":"2019-12-06T00:32:20.376Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Nextcloud"}},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6480009,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"That sounds unintended, indeed","markdown_message":"\u003cp\u003eThat sounds unintended, indeed\u003c/p\u003e\n","automated_response":false,"created_at":"2019-12-06T08:59:40.669Z","updated_at":"2019-12-06T08:59:40.669Z","actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6480059,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","markdown_message":"","automated_response":false,"created_at":"2019-12-06T09:00:08.576Z","updated_at":"2019-12-06T09:00:08.576Z","actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7355531,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"hi, any news? will no changes?","markdown_message":"\u003cp\u003ehi, any news? will no changes?\u003c/p\u003e\n","automated_response":false,"created_at":"2020-03-18T13:14:37.081Z","updated_at":"2020-03-18T13:14:37.081Z","actor":{"username":"pshknst","cleared":false,"url":"/pshknst","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7356152,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"We have a patch at https://github.com/nextcloud/server/pull/19913\n\nThere is one open issue with the patch, but then at least for files drop it will be respected.","markdown_message":"\u003cp\u003eWe have a patch at \u003ca title=\"https://github.com/nextcloud/server/pull/19913\" href=\"/redirect?url=https%3A%2F%2Fgithub.com%2Fnextcloud%2Fserver%2Fpull%2F19913\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://github.com/nextcloud/server/pull/19913\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eThere is one open issue with the patch, but then at least for files drop it will be respected.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-03-18T14:25:16.888Z","updated_at":"2020-03-18T14:25:16.888Z","actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7974883,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks a lot for your report again. This has been resolved in our next major release and we're working on the advisories at the moment.\n\nPlease let us know how you'd like to be credited in our official advisory. We require the following information:\n\n- Name / Pseudonym\n- Email address (optional)\n- Website (optional)\n- Company (optional)\n","markdown_message":"\u003cp\u003eThanks a lot for your report again. This has been resolved in our next major release and we\u0026#39;re working on the advisories at the moment.\u003c/p\u003e\n\n\u003cp\u003ePlease let us know how you\u0026#39;d like to be credited in our official advisory. We require the following information:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eName / Pseudonym\u003c/li\u003e\n\u003cli\u003eEmail address (optional)\u003c/li\u003e\n\u003cli\u003eWebsite (optional)\u003c/li\u003e\n\u003cli\u003eCompany (optional)\u003c/li\u003e\n\u003c/ul\u003e\n","automated_response":false,"created_at":"2020-05-12T12:50:11.650Z","updated_at":"2020-05-12T12:50:11.650Z","actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"pshknst","url":"/pshknst"},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8813949,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"hello, just seen previous comment. \nif not too late, you can use pseudonym pshknst in advisory.\nthanks!","markdown_message":"\u003cp\u003ehello, just seen previous comment. \u003cbr\u003e\nif not too late, you can use pseudonym pshknst in advisory.\u003cbr\u003e\nthanks!\u003c/p\u003e\n","automated_response":false,"created_at":"2020-07-31T11:25:45.188Z","updated_at":"2020-07-31T11:25:45.188Z","actor":{"username":"pshknst","cleared":false,"url":"/pshknst","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8831839,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Since this was only considered a hardening we didn't write a SA yet. In the meantime the description and meaning of the privacy settings was adjusted as well, making this a non-issue on the technical side.","markdown_message":"\u003cp\u003eSince this was only considered a hardening we didn\u0026#39;t write a SA yet. In the meantime the description and meaning of the privacy settings was adjusted as well, making this a non-issue on the technical side.\u003c/p\u003e\n","automated_response":false,"created_at":"2020-08-03T07:53:30.431Z","updated_at":"2020-08-03T07:53:30.431Z","actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8831840,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"See above","markdown_message":"\u003cp\u003eSee above\u003c/p\u003e\n","automated_response":false,"created_at":"2020-08-03T07:53:43.971Z","updated_at":"2020-08-03T07:53:43.971Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Nextcloud"}},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8831842,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-08-03T07:53:51.285Z","updated_at":"2020-08-03T07:53:51.285Z","first_to_agree":true,"actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8832069,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"okay thanks","markdown_message":"\u003cp\u003eokay thanks\u003c/p\u003e\n","automated_response":false,"created_at":"2020-08-03T08:27:43.550Z","updated_at":"2020-08-03T08:27:43.550Z","actor":{"username":"pshknst","cleared":false,"url":"/pshknst","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8832070,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2020-08-03T08:27:43.631Z","updated_at":"2020-08-03T08:27:43.631Z","actor":{"username":"pshknst","cleared":false,"url":"/pshknst","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}