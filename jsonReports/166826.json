{"id":166826,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNjY4MjY=","url":"https://hackerone.com/reports/166826","title":"Potential Subdomain Takeover Possible","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-09-08T12:40:24.378Z","submitted_at":"2016-09-08T12:40:24.378Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"zephrfish","url":"/zephrfish","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/037/729/4eac1816de4904419d50defddc5e90a852a4d290_original.jpeg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1453,"url":"https://hackerone.com/boozt","handle":"boozt","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/453/17d9f47114907532c0e0433b43eb1e01e426043e_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/453/17d9f47114907532c0e0433b43eb1e01e426043e_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"paused","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Boozt Fashion AB","twitter_handle":"","website":"http://www.boozt.com","about":"E-Commerce shop"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2016-10-22T10:38:42.787Z","bug_reporter_agreed_on_going_public_at":"2016-09-22T10:38:38.650Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"###Issue Description\nThe researcher identified that the affected url points to sendgrid.net, via a DNS CNAME record. As a result of this an attacker could potentially initate a subdomain take over by registering the subdomain sendgrid.boozt.com on sendgrid and consiquently leverage this for further attacks. Additionally it has been noted that sendgrid is a service for email marketing so theoretically should an attacker be able to gain access to the subdomain they could potentially gain access to emails too. \n\n###DNS Proof\n\n    \u003e $ dig ns sendgrid.boozt.com                                                                                      \n    sendgrid.boozt.com.     20792   IN      CNAME   sendgrid.net.     \n\n                      \n###Affected URLs\nsendgrid.boozt.com \n \n###Risk Breakdown\nRisk: **Medium**\nDifficulty to Exploit: **Medium** \nAuthentication: **None**\n\n\n###Recommended Fix \nCheck your DNS-configuration for subdomains pointing to services not in use.\nSet up your external service so it fully listens to your wildcard DNS. \n\n\n","vulnerability_information_html":"\u003ch3 id=\"issue-description\"\u003eIssue Description\u003c/h3\u003e\n\n\u003cp\u003eThe researcher identified that the affected url points to sendgrid.net, via a DNS CNAME record. As a result of this an attacker could potentially initate a subdomain take over by registering the subdomain sendgrid.boozt.com on sendgrid and consiquently leverage this for further attacks. Additionally it has been noted that sendgrid is a service for email marketing so theoretically should an attacker be able to gain access to the subdomain they could potentially gain access to emails too. \u003c/p\u003e\n\n\u003ch3 id=\"dns-proof\"\u003eDNS Proof\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e\u0026gt; $ dig ns sendgrid.boozt.com                                                                                      \nsendgrid.boozt.com.     20792   IN      CNAME   sendgrid.net.     \n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch3 id=\"affected-urls\"\u003eAffected URLs\u003c/h3\u003e\n\n\u003cp\u003esendgrid.boozt.com \u003c/p\u003e\n\n\u003ch3 id=\"risk-breakdown\"\u003eRisk Breakdown\u003c/h3\u003e\n\n\u003cp\u003eRisk: \u003cstrong\u003eMedium\u003c/strong\u003e\u003cbr\u003e\nDifficulty to Exploit: \u003cstrong\u003eMedium\u003c/strong\u003e \u003cbr\u003e\nAuthentication: \u003cstrong\u003eNone\u003c/strong\u003e\u003c/p\u003e\n\n\u003ch3 id=\"recommended-fix\"\u003eRecommended Fix\u003c/h3\u003e\n\n\u003cp\u003eCheck your DNS-configuration for subdomains pointing to services not in use.\u003cbr\u003e\nSet up your external service so it fully listens to your wildcard DNS. \u003c/p\u003e\n","bounty_amount":"120.0","formatted_bounty":"$120","original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2016-10-22T10:38:38.850Z","allow_singular_disclosure_after":-132084040.66483356,"singular_disclosure_allowed":true,"vote_count":12,"voters":["zephrfish","seifelsallamy","satishpk1","silv3rpoision","spetr0x","humayunalikhan","nigba","scept1c","dyabla","satish2421","and 2 more..."],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1184492,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi,\nThanks for the report. At the moment we are dealing with a high volume of reports as we just went public with our program. We will try to review and get back to you on this within an upcoming week. \nThanks for your patience.","markdown_message":"\u003cp\u003eHi,\u003cbr\u003e\nThanks for the report. At the moment we are dealing with a high volume of reports as we just went public with our program. We will try to review and get back to you on this within an upcoming week. \u003cbr\u003e\nThanks for your patience.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-09-09T13:28:31.086Z","updated_at":"2016-09-09T13:28:31.086Z","actor":{"username":"aurelijus","cleared":false,"url":"/aurelijus","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/644/e3476b79be6c1636a8294f104b63d0f3a910bac4_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"boozt","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1184967,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Hi,\nCan you please provide more info on this. How are you able to add subdomain on sendgrid that already exists, or even if it doesn't - don't you need to verify that you own the domain/subdomain?","markdown_message":"\u003cp\u003eHi,\u003cbr\u003e\nCan you please provide more info on this. How are you able to add subdomain on sendgrid that already exists, or even if it doesn\u0026#39;t - don\u0026#39;t you need to verify that you own the domain/subdomain?\u003c/p\u003e\n","automated_response":false,"created_at":"2016-09-09T16:37:31.567Z","updated_at":"2016-09-09T16:37:31.567Z","actor":{"username":"aurelijus","cleared":false,"url":"/aurelijus","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/644/e3476b79be6c1636a8294f104b63d0f3a910bac4_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"boozt","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1185116,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Actually upon further inspection it is not possible due to send grid's white label feature blocking the subliminal auth","markdown_message":"\u003cp\u003eActually upon further inspection it is not possible due to send grid\u0026#39;s white label feature blocking the subliminal auth\u003c/p\u003e\n","automated_response":false,"created_at":"2016-09-09T17:58:38.976Z","updated_at":"2016-09-09T17:58:38.976Z","actor":{"username":"zephrfish","cleared":true,"url":"/zephrfish","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/729/4eac1816de4904419d50defddc5e90a852a4d290_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"boozt","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1185117,"is_internal":false,"editable":false,"type":"Activities::BugNotApplicable","message":"Meant to say subdomain ","markdown_message":"\u003cp\u003eMeant to say subdomain \u003c/p\u003e\n","automated_response":false,"created_at":"2016-09-09T17:59:09.166Z","updated_at":"2016-09-09T17:59:09.166Z","actor":{"username":"zephrfish","cleared":true,"url":"/zephrfish","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/729/4eac1816de4904419d50defddc5e90a852a4d290_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"boozt","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1202697,"is_internal":false,"editable":false,"type":"Activities::BugReopened","message":"","markdown_message":"","automated_response":false,"created_at":"2016-09-18T13:24:51.307Z","updated_at":"2016-09-18T13:24:51.307Z","actor":{"username":"aurelijus","cleared":false,"url":"/aurelijus","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/644/e3476b79be6c1636a8294f104b63d0f3a910bac4_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"boozt","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1202700,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hi,\nWe actually found a way to take over subdomain for inbound emails (even though we don't use them). This was the report that made us look again more deeply: http://blog.pentestnepal.tech/post/149985438982/reading-ubers-internal-emails-uber-bug-bounty","markdown_message":"\u003cp\u003eHi,\u003cbr\u003e\nWe actually found a way to take over subdomain for inbound emails (even though we don\u0026#39;t use them). This was the report that made us look again more deeply: \u003ca title=\"http://blog.pentestnepal.tech/post/149985438982/reading-ubers-internal-emails-uber-bug-bounty\" href=\"/redirect?url=http%3A%2F%2Fblog.pentestnepal.tech%2Fpost%2F149985438982%2Freading-ubers-internal-emails-uber-bug-bounty\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttp://blog.pentestnepal.tech/post/149985438982/reading-ubers-internal-emails-uber-bug-bounty\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2016-09-18T13:26:07.832Z","updated_at":"2016-09-18T13:26:07.832Z","actor":{"username":"aurelijus","cleared":false,"url":"/aurelijus","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/644/e3476b79be6c1636a8294f104b63d0f3a910bac4_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"zephrfish","url":"/zephrfish"},"genius_execution_id":null,"team_handle":"boozt","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1202701,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2016-09-18T13:26:18.327Z","updated_at":"2016-09-18T13:26:18.327Z","actor":{"url":"/boozt","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/453/17d9f47114907532c0e0433b43eb1e01e426043e_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Boozt Fashion AB"}},"bounty_amount":"120.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"boozt","collaborator":{"username":"zephrfish","url":"/zephrfish"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1202705,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for reopening and the bounty, that was very kind of you!","markdown_message":"\u003cp\u003eThanks for reopening and the bounty, that was very kind of you!\u003c/p\u003e\n","automated_response":false,"created_at":"2016-09-18T13:29:00.301Z","updated_at":"2016-09-18T13:29:00.301Z","actor":{"username":"zephrfish","cleared":true,"url":"/zephrfish","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/729/4eac1816de4904419d50defddc5e90a852a4d290_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"boozt","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1210481,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"would it be possible to disclose this?","markdown_message":"\u003cp\u003ewould it be possible to disclose this?\u003c/p\u003e\n","automated_response":false,"created_at":"2016-09-22T10:38:38.705Z","updated_at":"2016-09-22T10:38:38.705Z","first_to_agree":true,"actor":{"username":"zephrfish","cleared":true,"url":"/zephrfish","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/729/4eac1816de4904419d50defddc5e90a852a4d290_original.jpeg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"boozt","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1261923,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-10-22T10:38:42.805Z","updated_at":"2016-10-22T10:38:42.805Z","actor":{"url":"/boozt","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/453/17d9f47114907532c0e0433b43eb1e01e426043e_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Boozt Fashion AB"}},"genius_execution_id":null,"team_handle":"boozt","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}