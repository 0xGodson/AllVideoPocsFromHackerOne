{"id":257119,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yNTcxMTk=","url":"https://hackerone.com/reports/257119","title":"Impersonation of Wakatime user using Invitation functionality.","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2017-08-05T17:48:46.378Z","submitted_at":"2017-08-05T17:48:46.378Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"asaxena2190","url":"/asaxena2190","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/110/801/b6414fd918230bc0a3e27f0811b8711594da6fdb_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":21801,"url":"https://hackerone.com/wakatime","handle":"wakatime","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/021/801/c3af6aa265b9b7d7d6e5fd52bb768e43b06d4a44_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/021/801/c3af6aa265b9b7d7d6e5fd52bb768e43b06d4a44_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"WakaTime","twitter_handle":"wakatime","website":"https://wakatime.com","about":"Automated metrics about your programming from text editor plugins."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-08-06T16:20:38.921Z","bug_reporter_agreed_on_going_public_at":"2017-08-06T16:20:38.878Z","team_member_agreed_on_going_public_at":"2017-08-06T07:02:53.985Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi wakatime team,\n\nI have found a vulnerability in your leaderboard invitation functionality which can be used to trick the victims on the name of wakatime. \n\nAnyone can sign up with any email id and use the leadersboard invitation to invite anyone. This loophole can be leveraged for impersonation of any user to the victims. \n\nEg. If bob steave is the name of Alice's boss. Then Attacker can create a wakatime account with his Bob's real id like bob.steave@gmail.com and without confirming his this email address he can send the invitation to Alice. Now there is no doubt Alice will accept the invitation as well as he will perform the all steps provided by that invitation mail. Which can be done by the above vulnerability.\n\n**Description:** Wakatime have a feature in which a user can invite anyone to his leaderboard. There are 3 fields Name , Email Id and role. But the Name field should be restricted to maximum 20 words. But wakatime is allowing 200 characters to this field. Which can be enough to construct a completely different mail.\n\n**Steps to reproduce:**\n1. Login into the account.\n2. Create a leaderboard.\n3. Invite a victim without verifying email address.\n4. Invitation email will be successfully sent.(Vulnerability 1)\n4. In name field write some social engineering message.\n5. Input victim's Email Id \n6. Invite him.\n7. He will receive the mail which is constructed by attacker with some social engineering method on the name of wakatime.\n8. If victim is already a member of wakatime, he can be tricked to steal his information. (Vulnerability 2)\n\n**Browser:** Tried on three browser.\n\n**Fix:** \nLimit the name field to max 20 or 25.\n\nScreen shot is attached.\nPlease check it.\n\nThanks,\nAkash Saxena","vulnerability_information_html":"\u003cp\u003eHi wakatime team,\u003c/p\u003e\n\n\u003cp\u003eI have found a vulnerability in your leaderboard invitation functionality which can be used to trick the victims on the name of wakatime. \u003c/p\u003e\n\n\u003cp\u003eAnyone can sign up with any email id and use the leadersboard invitation to invite anyone. This loophole can be leveraged for impersonation of any user to the victims. \u003c/p\u003e\n\n\u003cp\u003eEg. If bob steave is the name of Alice\u0026#39;s boss. Then Attacker can create a wakatime account with his Bob\u0026#39;s real id like \u003ca title=\"bob.steave@gmail.com\" href=\"mailto:bob.steave@gmail.com\" rel=\"nofollow noopener noreferrer\"\u003ebob.steave@gmail.com\u003c/a\u003e and without confirming his this email address he can send the invitation to Alice. Now there is no doubt Alice will accept the invitation as well as he will perform the all steps provided by that invitation mail. Which can be done by the above vulnerability.\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eDescription:\u003c/strong\u003e Wakatime have a feature in which a user can invite anyone to his leaderboard. There are 3 fields Name , Email Id and role. But the Name field should be restricted to maximum 20 words. But wakatime is allowing 200 characters to this field. Which can be enough to construct a completely different mail.\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eSteps to reproduce:\u003c/strong\u003e\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eLogin into the account.\u003c/li\u003e\n\u003cli\u003eCreate a leaderboard.\u003c/li\u003e\n\u003cli\u003eInvite a victim without verifying email address.\u003c/li\u003e\n\u003cli\u003eInvitation email will be successfully sent.(Vulnerability 1)\u003c/li\u003e\n\u003cli\u003eIn name field write some social engineering message.\u003c/li\u003e\n\u003cli\u003eInput victim\u0026#39;s Email Id \u003c/li\u003e\n\u003cli\u003eInvite him.\u003c/li\u003e\n\u003cli\u003eHe will receive the mail which is constructed by attacker with some social engineering method on the name of wakatime.\u003c/li\u003e\n\u003cli\u003eIf victim is already a member of wakatime, he can be tricked to steal his information. (Vulnerability 2)\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003e\u003cstrong\u003eBrowser:\u003c/strong\u003e Tried on three browser.\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eFix:\u003c/strong\u003e \u003cbr\u003e\nLimit the name field to max 20 or 25.\u003c/p\u003e\n\n\u003cp\u003eScreen shot is attached.\u003cbr\u003e\nPlease check it.\u003c/p\u003e\n\n\u003cp\u003eThanks,\u003cbr\u003e\nAkash Saxena\u003c/p\u003e\n","weakness":{"id":57,"name":"Violation of Secure Design Principles"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":210048,"file_name":"Screenshot_20170804-232946.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/210/048/741815f07d0d8bc4b04d8820bb94af16aac21e6b/Screenshot_20170804-232946.png?response-content-disposition=attachment%3B%20filename%3D%22Screenshot_20170804-232946.png%22%3B%20filename%2A%3DUTF-8%27%27Screenshot_20170804-232946.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQWS7SVX5C%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T051343Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCICTltBX5kZS78yzw3IUUt%2Fa035OzgQ2vLu8U1ZxOKGilAiEAqT8jxmclsgLwaEL5fi7C70iqLwP7J3SWF5ypfn%2Fn%2BdUqtAMIVBABGgwwMTM2MTkyNzQ4NDkiDGRWkSc4Hmgq8mMXKCqRA0Pq%2Bzgh6dptjyRB4GzYO9sir45RVm0RyvFSB8lDBYTBiDIVL0nR3Ah5epkHqGDZZEh0G%2BfKYu%2FWpfgxJl7qllLzKg%2BOA0izVs9KPgQdxk0VWwW%2FPKL2ZT4v%2FSNRvF7rPUbZ7WhGTZqx0%2BinzKM%2BO6lDyXZKNKMzhjRnIFdI7Th01c4ma39imTXQDmxc%2FNzHFK40lrkAbTZoTlcq%2BsnIcIRSB0h4GHasXhR5OHx8rifULR7sVKHDcZMCzSYjrtagaKs9I81LEzlSbEGxIQar2MK%2BZBwmpT57aT%2F1nIOoa%2FlH5nfP4Ihcv4Mqfp19pFx8mlVoMe%2FTEx0pqNuC4lGQXowSDJKBcSjrYM6ouddZWfwY6R4O8X69XqZawGSrmBiXyAVG%2BDj895xbDJhiOXMvqkvSfsEzIfvcaHAzshzNZjFT3yiN4h81wfUF3QuLc6DHCTt1MPDYiUB8I7UCQ8wJxW4pg3xTnHqSwUeqww3YY8RFfsgvfp9PzGJ1s4vReFrzuzYVanpT22oz4w33z29yMPmMMO21qv8FOusBOsYr4rmEPt9wYTc2WNI63vM9u2VUhGNHafH2%2Fh3q6i%2BwJ0u2HLCQd44aqHfWZ%2Bc8hzInEQnRNrZf7owYuE4cHiraWaOsNJjfOEJBZu5nzzun4JSk7801NfOqa1zcgLMWOwyWJCtalb9fGn6qhwTWTBMzsOFHc661yyW%2FaqejCIRf6%2BwNOGhO8kc%2BEhEIq0iydp5k4rlMRKlFJPFlphrQYGeZgYr9TM%2FVgHlN%2Bx4Oxtcg1UwCGXMGiV%2BqXzeMEmO%2FdxKETdJJvF%2BEaJSsF0r1i7s8g61czrgyi9MKMpia%2Fg6ovVFkrvHOejV96g%3D%3D\u0026X-Amz-Signature=1dd35b8cc0d423d3a9b9a150e623ec1a819112b6305b90afd90d5910421942fa","file_size":233726,"type":"image/png"},{"id":210052,"file_name":"Screenshot_20170804-231952.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/210/052/17ca8fda37ef77cf9b27a243869ed81d680444cd/Screenshot_20170804-231952.png?response-content-disposition=attachment%3B%20filename%3D%22Screenshot_20170804-231952.png%22%3B%20filename%2A%3DUTF-8%27%27Screenshot_20170804-231952.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQWS7SVX5C%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T051343Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCICTltBX5kZS78yzw3IUUt%2Fa035OzgQ2vLu8U1ZxOKGilAiEAqT8jxmclsgLwaEL5fi7C70iqLwP7J3SWF5ypfn%2Fn%2BdUqtAMIVBABGgwwMTM2MTkyNzQ4NDkiDGRWkSc4Hmgq8mMXKCqRA0Pq%2Bzgh6dptjyRB4GzYO9sir45RVm0RyvFSB8lDBYTBiDIVL0nR3Ah5epkHqGDZZEh0G%2BfKYu%2FWpfgxJl7qllLzKg%2BOA0izVs9KPgQdxk0VWwW%2FPKL2ZT4v%2FSNRvF7rPUbZ7WhGTZqx0%2BinzKM%2BO6lDyXZKNKMzhjRnIFdI7Th01c4ma39imTXQDmxc%2FNzHFK40lrkAbTZoTlcq%2BsnIcIRSB0h4GHasXhR5OHx8rifULR7sVKHDcZMCzSYjrtagaKs9I81LEzlSbEGxIQar2MK%2BZBwmpT57aT%2F1nIOoa%2FlH5nfP4Ihcv4Mqfp19pFx8mlVoMe%2FTEx0pqNuC4lGQXowSDJKBcSjrYM6ouddZWfwY6R4O8X69XqZawGSrmBiXyAVG%2BDj895xbDJhiOXMvqkvSfsEzIfvcaHAzshzNZjFT3yiN4h81wfUF3QuLc6DHCTt1MPDYiUB8I7UCQ8wJxW4pg3xTnHqSwUeqww3YY8RFfsgvfp9PzGJ1s4vReFrzuzYVanpT22oz4w33z29yMPmMMO21qv8FOusBOsYr4rmEPt9wYTc2WNI63vM9u2VUhGNHafH2%2Fh3q6i%2BwJ0u2HLCQd44aqHfWZ%2Bc8hzInEQnRNrZf7owYuE4cHiraWaOsNJjfOEJBZu5nzzun4JSk7801NfOqa1zcgLMWOwyWJCtalb9fGn6qhwTWTBMzsOFHc661yyW%2FaqejCIRf6%2BwNOGhO8kc%2BEhEIq0iydp5k4rlMRKlFJPFlphrQYGeZgYr9TM%2FVgHlN%2Bx4Oxtcg1UwCGXMGiV%2BqXzeMEmO%2FdxKETdJJvF%2BEaJSsF0r1i7s8g61czrgyi9MKMpia%2Fg6ovVFkrvHOejV96g%3D%3D\u0026X-Amz-Signature=6eaf71c55bd01f308a1f165737f44907005a76a1df576aa66535ae8311f77a0a","file_size":124271,"type":"image/png"}],"allow_singular_disclosure_at":"2017-09-05T07:02:54.021Z","allow_singular_disclosure_after":-104623849.36833699,"singular_disclosure_allowed":true,"vote_count":8,"voters":["eveeez","vulnh0lic","ronygigi","asaxena2190","zerotoone","japz","thejaguar","siddkhan"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":1907465,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thanks for the report, will fix this soon!","markdown_message":"\u003cp\u003eThanks for the report, will fix this soon!\u003c/p\u003e\n","automated_response":false,"created_at":"2017-08-05T19:20:47.422Z","updated_at":"2017-08-05T19:20:47.422Z","actor":{"username":"alanhamlett","cleared":false,"url":"/alanhamlett","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/175/849/7d4d213b7dc7d636a5abae089f1aa907e074bcdb_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"wakatime","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1907491,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","markdown_message":"","automated_response":false,"created_at":"2017-08-05T19:51:58.172Z","updated_at":"2017-08-05T19:51:58.172Z","actor":{"username":"alanhamlett","cleared":false,"url":"/alanhamlett","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/175/849/7d4d213b7dc7d636a5abae089f1aa907e074bcdb_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"asaxena2190","url":"/asaxena2190"},"genius_execution_id":null,"team_handle":"wakatime","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1907700,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@alanhamlett , this report consist two vulnerability. Can you please provide me 14 reputation points for this report??","markdown_message":"\u003cp\u003e\u003ca href=\"/alanhamlett\"\u003e@alanhamlett\u003c/a\u003e , this report consist two vulnerability. Can you please provide me 14 reputation points for this report??\u003c/p\u003e\n","automated_response":false,"created_at":"2017-08-06T04:36:01.463Z","updated_at":"2017-08-06T04:36:01.463Z","actor":{"username":"asaxena2190","cleared":false,"url":"/asaxena2190","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/110/801/b6414fd918230bc0a3e27f0811b8711594da6fdb_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wakatime","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1907782,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I don't have the ability to change reputation points.","markdown_message":"\u003cp\u003eI don\u0026#39;t have the ability to change reputation points.\u003c/p\u003e\n","automated_response":false,"created_at":"2017-08-06T07:02:41.988Z","updated_at":"2017-08-06T07:02:41.988Z","actor":{"username":"alanhamlett","cleared":false,"url":"/alanhamlett","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/175/849/7d4d213b7dc7d636a5abae089f1aa907e074bcdb_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"wakatime","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1907783,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-08-06T07:02:54.003Z","updated_at":"2017-08-06T07:02:54.003Z","first_to_agree":true,"actor":{"username":"alanhamlett","cleared":false,"url":"/alanhamlett","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/175/849/7d4d213b7dc7d636a5abae089f1aa907e074bcdb_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"wakatime","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1907798,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Ok.thanks. I hope fixed has been deployed. ","markdown_message":"\u003cp\u003eOk.thanks. I hope fixed has been deployed. \u003c/p\u003e\n","automated_response":false,"created_at":"2017-08-06T07:19:21.382Z","updated_at":"2017-08-06T07:19:21.382Z","actor":{"username":"asaxena2190","cleared":false,"url":"/asaxena2190","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/110/801/b6414fd918230bc0a3e27f0811b8711594da6fdb_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wakatime","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1908161,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Yes, the fix was deployed. Thanks again for your report!","markdown_message":"\u003cp\u003eYes, the fix was deployed. Thanks again for your report!\u003c/p\u003e\n","automated_response":false,"created_at":"2017-08-06T15:38:30.228Z","updated_at":"2017-08-06T15:39:00.371Z","actor":{"username":"alanhamlett","cleared":false,"url":"/alanhamlett","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/175/849/7d4d213b7dc7d636a5abae089f1aa907e074bcdb_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"wakatime","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1908213,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-08-06T16:20:38.898Z","updated_at":"2017-08-06T16:20:38.898Z","actor":{"username":"asaxena2190","cleared":false,"url":"/asaxena2190","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/110/801/b6414fd918230bc0a3e27f0811b8711594da6fdb_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wakatime","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1908214,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2017-08-06T16:20:38.940Z","updated_at":"2017-08-06T16:20:38.940Z","actor":{"username":"asaxena2190","cleared":false,"url":"/asaxena2190","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/110/801/b6414fd918230bc0a3e27f0811b8711594da6fdb_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"wakatime","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}